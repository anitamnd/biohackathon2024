<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1009343.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8452072</article-id>
    <article-id pub-id-type="pmid">34495960</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009343</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-21-00585</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical Microbiology</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Microbiome</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Species Interactions</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Microbial Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Microbial Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Ecology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Ecological Metrics</subject>
            <subj-group>
              <subject>Biomass</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Ecological Metrics</subject>
            <subj-group>
              <subject>Biomass</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Ecological Metrics</subject>
            <subj-group>
              <subject>Carrying Capacity</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Ecological Metrics</subject>
            <subj-group>
              <subject>Carrying Capacity</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Population Biology</subject>
          <subj-group>
            <subject>Population Metrics</subject>
            <subj-group>
              <subject>Carrying Capacity</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Community Ecology</subject>
            <subj-group>
              <subject>Community Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Ecology</subject>
          <subj-group>
            <subject>Community Ecology</subject>
            <subj-group>
              <subject>Community Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Interaction Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BEEM-Static: Accurate inference of ecological interactions from cross-sectional microbiome data</article-title>
      <alt-title alt-title-type="running-head">Accurate inference of interactions from cross-sectional microbiome data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1182-6804</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Chenhao</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5786-7762</contrib-id>
        <name>
          <surname>Av-Shalom</surname>
          <given-names>Tamar V.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3131-0274</contrib-id>
        <name>
          <surname>Tan</surname>
          <given-names>Jun Wei Gerald</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kwah</surname>
          <given-names>Junmei Samantha</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2746-9880</contrib-id>
        <name>
          <surname>Chng</surname>
          <given-names>Kern Rei</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nagarajan</surname>
          <given-names>Niranjan</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Laboratory of Metagenomic Technologies and Microbial Systems, Genome Institute of Singapore, Singapore, Singapore</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Center for Computational and Integrative Biology, Massachusetts General Hospital, Boston, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Cell &amp; Systems Biology, University of Toronto, Toronto, Canada</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>School of Computing, National University of Singapore, Singapore, Singapore</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Yong Loo Lin School of Medicine, National University of Singapore, Singapore, Singapore</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Segata</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Trento, ITALY</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>cli40@mgh.harvard.edu</email> (CL); <email>nagarajann@gis.a-star.edu.sg</email> (NN)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>9</issue>
    <elocation-id>e1009343</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Li et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Li et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pdf" xlink:href="pcbi.1009343.pdf"/>
    <abstract>
      <p>The structure and function of diverse microbial communities is underpinned by ecological interactions that remain uncharacterized. With rapid adoption of next-generation sequencing for studying microbiomes, data-driven inference of microbial interactions based on abundance correlations is widely used, but with the drawback that ecological interpretations may not be possible. Leveraging cross-sectional microbiome datasets for unravelling ecological structure in a scalable manner thus remains an open problem. We present an expectation-maximization algorithm (BEEM-Static) that can be applied to cross-sectional datasets to infer interaction networks based on an ecological model (generalized Lotka-Volterra). The method exhibits robustness to violations in model assumptions by using statistical filters to identify and remove corresponding samples. Benchmarking against 10 state-of-the-art correlation based methods showed that BEEM-Static can infer presence and directionality of ecological interactions even with relative abundance data (AUC-ROC&gt;0.85), a task that other methods struggle with (AUC-ROC&lt;0.63). In addition, BEEM-Static can tolerate a high fraction of samples (up to 40%) being not at steady state or coming from an alternate model. Applying BEEM-Static to a large public dataset of human gut microbiomes (n = 4,617) identified multiple stable equilibria that better reflect ecological enterotypes with distinct carrying capacities and interactions for key species.</p>
      <sec id="sec002">
        <title>Conclusion</title>
        <p>BEEM-Static provides new opportunities for mining ecologically interpretable interactions and systems insights from the growing corpus of microbiome data.</p>
      </sec>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Characterizing the ecological interactions among microbial members is an important step towards understanding the structure and function of diverse microbial communities. Widely used correlation based approaches for inferring interactions from cross-sectional microbiome sequencing data are not able to predict the directionality of interactions, and their results may not be interpretable. We developed an expectation-maximization algorithm (BEEM-Static) that can infer directed interaction networks from cross-sectional data based on an ecological model. Our benchmarking results showed that BEEM-Static inferred presence and directionality of interactions accurately, while correlation based methods had performance slightly better than random guesses. In addition, BEEM-Static was robust to various types of noises using statistical filters to identify and remove data points violating its assumptions. Applying BEEM-Static to a large public dataset of human gut microbiomes, we were able to identify multiple stable equilibria with distinct ecological properties.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>agency for science, technology and research (a*star)</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Nagarajan</surname>
            <given-names>Niranjan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100012415</institution-id>
            <institution>Biomedical Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>H18/01/a0/016</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nagarajan</surname>
            <given-names>Niranjan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>CL, TVAS, JWGT, JSK, KRC and NN are supported by Agency for Science, Technology and Research (A*STAR) and an Industry Alignment Fund - Prepositioning Programs (IAF-PP) grant (H18/01/a0/016) from the Biomedical Research Council (BMRC). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="1"/>
      <page-count count="16"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-09-20</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>BEEM-Static is available as an R package at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/CSB5/BEEM-static" ext-link-type="uri">https://github.com/CSB5/BEEM-static</ext-link> under the MIT license.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>BEEM-Static is available as an R package at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/CSB5/BEEM-static" ext-link-type="uri">https://github.com/CSB5/BEEM-static</ext-link> under the MIT license.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec003">
    <title>1. Introduction</title>
    <p>Microbial communities represent complex systems that impact various aspects related to human health, e.g. agriculture [<xref rid="pcbi.1009343.ref001" ref-type="bibr">1</xref>], food processing [<xref rid="pcbi.1009343.ref002" ref-type="bibr">2</xref>], disease biology [<xref rid="pcbi.1009343.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1009343.ref004" ref-type="bibr">4</xref>] and healthcare [<xref rid="pcbi.1009343.ref005" ref-type="bibr">5</xref>]. Interactions between members of a microbial community determine emergent phenomena such as homeostasis in the ecosystem [<xref rid="pcbi.1009343.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1009343.ref007" ref-type="bibr">7</xref>] and overall function of the microbiome [<xref rid="pcbi.1009343.ref008" ref-type="bibr">8</xref>]. Ecological interactions can be grouped into six major categories including mutualism (positive-positive), competition (negative-negative), antagonism (positive-negative, further includes predation and parasitism), commensalism (positive-neutral), amensalism (negative-neutral) and neutralism (neutral-neutral) [<xref rid="pcbi.1009343.ref009" ref-type="bibr">9</xref>]. Correspondingly, ecological modeling of microbiomes taking into account such interactions is a key step towards understanding community function [<xref rid="pcbi.1009343.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1009343.ref011" ref-type="bibr">11</xref>], forecasting dynamics [<xref rid="pcbi.1009343.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1009343.ref013" ref-type="bibr">13</xref>] and rationally designing interventions that alter community structure and function [<xref rid="pcbi.1009343.ref014" ref-type="bibr">14</xref>].</p>
    <p>Advances in high-throughput sequencing and metagenomics have enabled several data-driven approaches to infer microbial interactions, bypassing limitations of experimental approaches in terms of time, resources and cultivability [<xref rid="pcbi.1009343.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1009343.ref015" ref-type="bibr">15</xref>]. In particular, correlation-based methods are widely used for their convenient applicability to cross-sectional datasets [<xref rid="pcbi.1009343.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1009343.ref016" ref-type="bibr">16</xref>], despite their inability to capture directionality of ecological interactions such as predation and parasitism [<xref rid="pcbi.1009343.ref009" ref-type="bibr">9</xref>]. Recent studies have also highlighted other pitfalls in correlational analysis, particularly the accuracy of interactions identified even when the data reflects known modes of microbial interactions [<xref rid="pcbi.1009343.ref017" ref-type="bibr">17</xref>, <xref rid="pcbi.1009343.ref018" ref-type="bibr">18</xref>].</p>
    <p>Predictive and dynamic modeling of microbiomes based on first-order differential equations (e.g. with generalized Lotka-Volterra models or gLVMs) has found increasing usage and provided useful insights into microbial interactions and dynamics [<xref rid="pcbi.1009343.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1009343.ref019" ref-type="bibr">19</xref>, <xref rid="pcbi.1009343.ref020" ref-type="bibr">20</xref>]. Wider adoption of such techniques has been hampered by the need for large datasets (as the number of parameters grows quadratically with the number of species) and dense longitudinal sampling to adequately capture fine-grained dynamics [<xref rid="pcbi.1009343.ref021" ref-type="bibr">21</xref>]. Theoretical assumptions such as the availability of data where all species are at equilibrium (i.e. abundances of species will not change without external perturbation), and where absolute abundances are accurately known, make the determination of gLVM parameters from cross-sectional data solvable in principle [<xref rid="pcbi.1009343.ref022" ref-type="bibr">22</xref>]. In practice, microbiome data generated from high-throughput sequencing (16S rRNA gene amplicon or whole metagenomic sequencing) provides relative abundances and scaling these accurately enough for gLVM parameter estimation can be challenging [<xref rid="pcbi.1009343.ref023" ref-type="bibr">23</xref>]. Furthermore, real-world datasets often contain a mixture of perturbed and unperturbed microbiomes where the equilibrium status is unknown, and where data may even come from multiple models [<xref rid="pcbi.1009343.ref024" ref-type="bibr">24</xref>].</p>
    <p>We have previously introduced an expectation maximization (EM) algorithm which couples gLVM parameter and scaling factor estimation (BEEM), specifically for longitudinal microbiome data [<xref rid="pcbi.1009343.ref023" ref-type="bibr">23</xref>]. Here we transform this EM algorithm to work with cross-sectional data from communities that are at or near equilibrium (BEEM-Static; <bold><xref rid="pcbi.1009343.g001" ref-type="fig">Fig 1</xref></bold>). In benchmarking comparisons with simulated communities against 10 other methods that infer microbial interactions from cross-sectional data, we noted that while all other methods only improved slightly over random predictions (AUC-ROC&lt;0.63), BEEM-Static exhibited high accuracy similar to estimation using true scaling values (AUC-ROC&gt;0.88). Similar observations were made with synthetic communities based on all-pair co-culture experiments, where BEEM-Static accurately recapitulated nearly all known interactions and their directionality. Based on statistical filters to identify non-model and/or non-equilibrium samples in real and simulated datasets, we show that BEEM-Static can be robust to up to 40% of data violating these assumptions. Applying BEEM-Static to a large public collection of human gut microbiome profiles (n = 4,617) identified multiple stable equilibria that appear to better reflect ecological enterotypes with distinct carrying capacities and interactions for key species (e.g. <italic toggle="yes">Prevotella copri</italic>) compared to prior clustering based definitions [<xref rid="pcbi.1009343.ref024" ref-type="bibr">24</xref>]. BEEM-Static thus provides new opportunities for mining ecologically interpretable interactions and systems insights from the growing corpus of microbiome data in the public domain.</p>
    <fig position="float" id="pcbi.1009343.g001">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1009343.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Schematic overview for the BEEM-Static algorithm.</title>
        <p>BEEM-Static takes relative abundances from a cross-sectional microbiome dataset (A), and runs an expectation-maximization algorithm (B) to estimate both biomass values (C), the interaction network (D) and carrying capacities (E).</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.g001" position="float"/>
    </fig>
  </sec>
  <sec sec-type="materials|methods" id="sec004">
    <title>2. Methods</title>
    <sec id="sec005">
      <title>2.1 Estimating biomass and gLVM parameters with cross-sectional data</title>
      <p>The gLVM model is a set of differential equations describing the instantaneous growth rate of each species (<italic toggle="yes">dx</italic><sub><italic toggle="yes">i</italic></sub>(<italic toggle="yes">t</italic>)/dt) as a function of absolute cell densities (<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>(<italic toggle="yes">t</italic>)) of the <italic toggle="yes">p</italic> species in a community:
<disp-formula id="pcbi.1009343.e001"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e001.jpg" id="pcbi.1009343.e001g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
where <italic toggle="yes">μ</italic><sub><italic toggle="yes">i</italic></sub> is the intrinsic growth rate of species <italic toggle="yes">i</italic> and <italic toggle="yes">β</italic><sub><italic toggle="yes">ij</italic></sub> are interaction terms that define the strength of the influence of species <italic toggle="yes">j</italic>’s abundance on species <italic toggle="yes">i</italic>’s growth. In general, estimating gLVM parameters (<italic toggle="yes">μ</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">β</italic><sub><italic toggle="yes">ij</italic></sub>) requires longitudinal data to measure <italic toggle="yes">dx</italic><sub><italic toggle="yes">i</italic></sub>(<italic toggle="yes">t</italic>)/<italic toggle="yes">dt</italic>. However, at the non-trivial equilibrium (<italic toggle="yes">dx</italic><sub><italic toggle="yes">i</italic></sub>(<italic toggle="yes">t</italic>)/<italic toggle="yes">dt</italic> = 0 and <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>&gt;0):
<disp-formula id="pcbi.1009343.e002"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e002.jpg" id="pcbi.1009343.e002g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where the time parameter <italic toggle="yes">t</italic> now becomes implicit in the equation. Dividing both sides by -<italic toggle="yes">β</italic><sub><italic toggle="yes">ii</italic></sub> and the biomass <italic toggle="yes">m</italic>, rearranging terms, and re-parameterizing the equation we get:
<disp-formula id="pcbi.1009343.e003"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e003.jpg" id="pcbi.1009343.e003g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where <italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic></sub> = −<italic toggle="yes">μ</italic><sub><italic toggle="yes">i</italic></sub>/<italic toggle="yes">β</italic><sub><italic toggle="yes">ii</italic></sub>, <italic toggle="yes">b</italic><sub><italic toggle="yes">ij</italic></sub> = −<italic toggle="yes">β</italic><sub><italic toggle="yes">ij</italic></sub>/<italic toggle="yes">β</italic><sub><italic toggle="yes">ii</italic></sub> and <inline-formula id="pcbi.1009343.e004"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e004.jpg" id="pcbi.1009343.e004g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the relative abundance of species <italic toggle="yes">i</italic> at equilibrium (<italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic></sub> is also known as the carrying capacity of the species). This equation allows us to estimate gLVM parameters (through <italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">b</italic><sub><italic toggle="yes">ij</italic></sub>) from cross-sectional data, assuming that samples are at equilibrium, and absolute abundances are known (<inline-formula id="pcbi.1009343.e005"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e005.jpg" id="pcbi.1009343.e005g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>). To account for the fact that microbiome data provides relative abundances and biomass is typically not measured, BEEM-Static extends an EM framework to jointly estimate model parameters and biomass (<bold><xref rid="pcbi.1009343.s009" ref-type="supplementary-material">S1 Text</xref></bold>; [<xref rid="pcbi.1009343.ref023" ref-type="bibr">23</xref>]):</p>
      <p><bold>Estimating biomass (E-step):</bold> for a sample, the equation for each species <italic toggle="yes">i</italic> provides an estimate for the biomass, and BEEM-Static takes the median of estimates across species as a robust estimator for the biomass of the sample:
<disp-formula id="pcbi.1009343.e006"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e006.jpg" id="pcbi.1009343.e006g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" display="block" overflow="scroll"><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula></p>
      <p><bold>Estimating model parameters (M-step)</bold>: BEEM-Static estimates model parameters (<inline-formula id="pcbi.1009343.e007"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e007.jpg" id="pcbi.1009343.e007g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009343.e008"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e008.jpg" id="pcbi.1009343.e008g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) for each species <italic toggle="yes">i</italic> with sparse regression (implemented with the ‘glmnet’ package in R) in iteration <italic toggle="yes">T</italic>:
<disp-formula id="pcbi.1009343.e009"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e009.jpg" id="pcbi.1009343.e009g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>∙</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula></p>
      <p><bold>Initialization and termination:</bold> BEEM-Static initializes biomass values based on normalization factors from cumulative sum scaling (CSS [<xref rid="pcbi.1009343.ref025" ref-type="bibr">25</xref>]), with a user defined scaling constant as the median of biomass values (kept constant through EM iterations). The EM process is then run until the maximum number of iterations specified (200 by default) or until convergence when the median of relative changes in biomass values is &lt;10<sup>−3</sup>. Confidence values (Z-scores) for the final interaction matrix (non-zero off-diagonal entries) were calculated for each species <italic toggle="yes">i</italic> using forward stepwise regression (implemented in R package “selectiveInference”; version 1.2.5; Akaike information criterion as the stopping criterion).</p>
    </sec>
    <sec id="sec006">
      <title>2.2 Statistical filters to detect violations of modeling assumptions</title>
      <p>BEEM-Static uses the following filters to identify and remove samples that violate modeling assumptions and could thus impact model inference:</p>
      <p><bold>Equilibrium filter</bold>: to identify samples that may not be at equilibrium, BEEM-Static first predicts the abundances of species at equilibrium (based on the current model) for all species that are present:
<disp-formula id="pcbi.1009343.e010"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e010.jpg" id="pcbi.1009343.e010g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" display="block" overflow="scroll"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where <bold><italic toggle="yes">B</italic></bold> is the matrix form of <inline-formula id="pcbi.1009343.e011"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e011.jpg" id="pcbi.1009343.e011g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (= estimate for <inline-formula id="pcbi.1009343.e012"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e012.jpg" id="pcbi.1009343.e012g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>), <bold><italic toggle="yes">a</italic></bold> is a column vector taking the value of <inline-formula id="pcbi.1009343.e013"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e013.jpg" id="pcbi.1009343.e013g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (= estimate for <inline-formula id="pcbi.1009343.e014"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e014.jpg" id="pcbi.1009343.e014g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) and <inline-formula id="pcbi.1009343.e015"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e015.jpg" id="pcbi.1009343.e015g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> is a vector of predicted relative abundances at equilibrium for each species (<inline-formula id="pcbi.1009343.e016"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e016.jpg" id="pcbi.1009343.e016g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> is set to 0 if species <italic toggle="yes">i</italic> is not present). Samples with median relative deviation above a user defined threshold (<italic toggle="yes">ϵ</italic><sub>1</sub>) from these equilibrium values were then excluded as being potentially not at equilibrium (<inline-formula id="pcbi.1009343.e017"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e017.jpg" id="pcbi.1009343.e017g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">median</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula> and <italic toggle="yes">ϵ</italic><sub>1</sub> = 20% by default).</p>
      <p><bold>Model filter</bold>: to account for cases where some samples may come from an alternate gLVM, BEEM-Static calculates the median of squared errors for each sample <italic toggle="yes">k</italic> with respect to the current model parameter estimates (<inline-formula id="pcbi.1009343.e018"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e018.jpg" id="pcbi.1009343.e018g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009343.e019"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e019.jpg" id="pcbi.1009343.e019g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>):
<disp-formula id="pcbi.1009343.e020"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e020.jpg" id="pcbi.1009343.e020g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">median</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>∙</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>This is done in the M-step for each iteration and samples with large median squared error, i.e. (<italic toggle="yes">e</italic><sub><italic toggle="yes">k</italic></sub>−median(<italic toggle="yes">e</italic><sub><italic toggle="yes">k</italic></sub>))/IQR(<italic toggle="yes">e</italic><sub><italic toggle="yes">k</italic></sub>)&gt;<italic toggle="yes">ϵ</italic><sub>2</sub> where IQR is the inter-quartile range and <italic toggle="yes">ϵ</italic><sub>2</sub> is a user defined parameter (default value of 3), are then removed for the next iteration’s M-step.</p>
    </sec>
    <sec id="sec007">
      <title>2.3 Selecting shrinkage parameters for sparse regression</title>
      <p>The shrinkage parameter λ in the sparse regression penalizes the number of parameters to avoid overfitting and is selected based on five-fold cross-validation in each iteration (selecting the value one standard error away from the best λ [<xref rid="pcbi.1009343.ref026" ref-type="bibr">26</xref>]). In the M-step of iteration <italic toggle="yes">T</italic>, a crude selection of <inline-formula id="pcbi.1009343.e021"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e021.jpg" id="pcbi.1009343.e021g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is made in BEEM-Static from a large range from 10<sup>−10</sup> to 10<sup>−1</sup>, and then refined with a fine-grained sequence from <inline-formula id="pcbi.1009343.e022"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e022.jpg" id="pcbi.1009343.e022g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:mn>10</mml:mn></mml:math></alternatives></inline-formula> to <inline-formula id="pcbi.1009343.e023"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e023.jpg" id="pcbi.1009343.e023g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mn>10</mml:mn><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
    </sec>
    <sec id="sec008">
      <title>2.4 Generating simulated datasets</title>
      <p>Simulated gLVM data was generated based on previously described procedures [<xref rid="pcbi.1009343.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1009343.ref019" ref-type="bibr">19</xref>]. Specifically, to parameterize distributions for generating model parameters, MDSINE [<xref rid="pcbi.1009343.ref019" ref-type="bibr">19</xref>] was used to estimate the mean and standard deviations of growth rates and inter-/intra-species interaction parameters from the <italic toggle="yes">C</italic>. <italic toggle="yes">difficile</italic> infection experiment data provided with the software. Growth rates and intra-species interactions were sampled from normal distributions (forced to be positive and negative respectively to model logistic growth). The interaction network structure was generated by randomly adding edges from one species to another (with probability ranging from 0.1 to 0.5) and the magnitude of the interactions was sampled from a normal distribution (with 0 mean and standard deviation estimated from real data as noted above). Initial abundances of <italic toggle="yes">p</italic> (30) species were sampled from a uniform distribution (from 0.001 to the mean carrying capacity <italic toggle="yes">μ</italic><sub><italic toggle="yes">i</italic></sub>/<italic toggle="yes">β</italic><sub><italic toggle="yes">ii</italic></sub> of all the <italic toggle="yes">p</italic> species), with each species having a probability of π to be absent from a sample (π was estimated as the average rate of absence for the top <italic toggle="yes">p</italic> most prevalent species in all healthy gut microbiome profiles from the database curatedMetagenomicData [<xref rid="pcbi.1009343.ref027" ref-type="bibr">27</xref>]). A dataset with <italic toggle="yes">n</italic> samples was generated by numerically integrating the gLVM with the same parameters until equilibrium, starting with <italic toggle="yes">n</italic> different initial abundance profiles. The abundances of a random time point along the numerical integration (&gt;20% away from the abundance at equilibrium for &gt;50% of the species) was selected as a sample not at equilibrium. Poisson noise was added to the abundance of each species to simulate experimental variability.</p>
    </sec>
    <sec id="sec009">
      <title>2.5 Generating datasets based on growth curves and co-culture experiments</title>
      <p>Microbiome profiles for co-culture experiments were taken from a previous study [<xref rid="pcbi.1009343.ref020" ref-type="bibr">20</xref>] and the relative abundances were scaled using the corresponding biomass measurements (OD600). Six species pairs were randomly selected, and one of the three conditions were randomly picked for each pair in each sample: (1) only the first species was present, (2) only the second species was present and (3) both species were present. For the first two cases, a random timepoint (last 6 timepoints near the equilibrium) was taken from the growth curve (measured by OD600) of species present. For the last case, the scaled abundances of the two species near the steady state (randomly taken from the three replicates) were used. Abundances were re-scaled to relative abundances and the process repeated to generate a dataset with 500 samples. The interaction matrix reported in Venturelli <italic toggle="yes">et al</italic> [<xref rid="pcbi.1009343.ref020" ref-type="bibr">20</xref>] was treated as the ground truth (“M-PW1-PW2”).</p>
    </sec>
    <sec id="sec010">
      <title>2.6 Evaluation metrics</title>
      <p>We computed the median of relative errors to assess the accuracy of predicted parameters as:
<disp-formula id="pcbi.1009343.e024"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e024.jpg" id="pcbi.1009343.e024g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" display="block" overflow="scroll"><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1009343.e025"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e025.jpg" id="pcbi.1009343.e025g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <italic toggle="yes">θ</italic> are the estimated and true parameters (<bold><italic toggle="yes">a</italic></bold>, <bold><italic toggle="yes">b</italic></bold> and <bold><italic toggle="yes">m</italic></bold>) respectively. The area under the receiver operating characteristic curve (AUC-ROC) was computed for the interaction matrix. Z-scores were used to rank interactions (off-diagonal entries only) predicted by BEEM-Static. Sensitivity for predicting the signs of interaction was calculated as the fraction of interactions with correctly predicted signs in the true interaction matrix (non-zero off-diagonal entries only). Sign precision was computed as the fraction of interactions with correctly predicted signs.</p>
    </sec>
    <sec id="sec011">
      <title>2.7 Benchmarking with correlation-based methods</title>
      <p>The following correlation-based methods (<bold><xref rid="pcbi.1009343.t001" ref-type="table">Table 1</xref></bold>) for inferring interactions from microbiome data were tested.</p>
      <table-wrap position="float" id="pcbi.1009343.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009343.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Correlation methods tested.</title>
        </caption>
        <alternatives>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.t001" id="pcbi.1009343.t001g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Algorithm</th>
                <th align="left" rowspan="1" colspan="1">Version</th>
                <th align="left" rowspan="1" colspan="1">Parameters</th>
                <th align="left" rowspan="1" colspan="1">Note</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Pearson and Spearman correlation</bold>
                </td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Directly calculated from relative abundances</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>CCREPE</bold> [<xref rid="pcbi.1009343.ref028" ref-type="bibr">28</xref>]</td>
                <td align="left" rowspan="1" colspan="1">v1.2.0</td>
                <td align="left" rowspan="1" colspan="1">1000 iterations</td>
                <td align="left" rowspan="1" colspan="1">Correction done for both Pearson and Spearman correlations</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>SparCC</bold> [<xref rid="pcbi.1009343.ref029" ref-type="bibr">29</xref>]</td>
                <td align="left" rowspan="1" colspan="1">commit id: 9a1142c</td>
                <td align="left" rowspan="1" colspan="1">Default</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>CCLasso</bold> [<xref rid="pcbi.1009343.ref030" ref-type="bibr">30</xref>]</td>
                <td align="left" rowspan="1" colspan="1">v1.0</td>
                <td align="left" rowspan="1" colspan="1">Default</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>REBACCA</bold> [<xref rid="pcbi.1009343.ref031" ref-type="bibr">31</xref>]</td>
                <td align="left" rowspan="1" colspan="1">
                  <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://tinyurl.com/ymdts4wy" ext-link-type="uri">https://tinyurl.com/ymdts4wy</ext-link>
                </td>
                <td align="left" rowspan="1" colspan="1">nbootstrap = 50, B = 500, FWER = 0.01</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>MInt</bold> [<xref rid="pcbi.1009343.ref032" ref-type="bibr">32</xref>]</td>
                <td align="left" rowspan="1" colspan="1">v1.0.1</td>
                <td align="left" rowspan="1" colspan="1">Default</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>SPIEC-EASI</bold> [<xref rid="pcbi.1009343.ref033" ref-type="bibr">33</xref>]</td>
                <td align="left" rowspan="1" colspan="1">v0.1.4</td>
                <td align="left" rowspan="1" colspan="1">lambda.min.ratio = 0.01, nlambda = 20, rep.num = 50</td>
                <td align="left" rowspan="1" colspan="1">Both “mb” and “glasso” algorithms</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>BAnOCC</bold> [<xref rid="pcbi.1009343.ref034" ref-type="bibr">34</xref>]</td>
                <td align="left" rowspan="1" colspan="1">v1.0.1</td>
                <td align="left" rowspan="1" colspan="1">Default</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>gCoda</bold> [<xref rid="pcbi.1009343.ref035" ref-type="bibr">35</xref>]</td>
                <td align="left" rowspan="1" colspan="1">commit id: 584bd07</td>
                <td align="left" rowspan="1" colspan="1">Default</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The -log(p-value) or edge stability were used to rank CCREPE and SPIEC-EASI correlations, respectively, while the absolute values of correlation coefficients were used for the other methods. AUC-ROC was calculated from the lower triangle of the inferred correlation matrix (an inference was considered correct if there was an interaction between the corresponding species regardless of the interaction direction). Sensitivity and precision of signs were calculated as described above, excluding positive-negative interactions as they cannot be differentiated from positive-positive and negative-negative interactions using correlation analysis.</p>
    </sec>
    <sec id="sec012">
      <title>2.8 Analysis of gut microbiome data</title>
      <p>Healthy gut microbiome profiles from the database curatedMetagenomicData were preprocessed and used as the standard dataset for learning gLVMs by removing (1) replicate samples, (2) timepoints other than the first timepoint in longitudinal studies, (3) samples under antibiotic treatment and (4) samples from infants. In addition, we included two validation datasets to evaluate different aspects of the model learned by BEEM-Static: (1) all samples from Raymond <italic toggle="yes">et al</italic> [<xref rid="pcbi.1009343.ref036" ref-type="bibr">36</xref>] to validate BEEM-Static’s estimated growth and (2) samples from healthy infants (only the first timepoint for each subject) with ages below 12 months to evaluate BEEM-Static’s biomass estimation. Both datasets were also used to validate BEEM-Static’s ability to filter out samples violating model assumptions. To make the number of parameters tractable with the number of data points available, we only kept core species that were present (relative abundance &gt;0.1%) in more than 30% of samples and subsequently removed samples where none of the core species were found, resulting in 42 core species (<bold><xref rid="pcbi.1009343.s006" ref-type="supplementary-material">S6 Fig</xref></bold>) and 4,617 samples overall. BEEM-Static was applied with the “model filter” (<italic toggle="yes">ϵ</italic><sub>2</sub> = 0.9) to learn two models (1,995 and 1,145 samples for each model) in two iterations, in which samples violating the filter were removed (1,477 samples removed in total). BEEM-Static was then rerun without the filter on samples assigned to each model separately to re-learn parameters.</p>
    </sec>
    <sec id="sec013">
      <title>2.9 Estimating <italic toggle="yes">in situ</italic> growth using BEEM-Static and GRiD</title>
      <p>With BEEM-Static, <italic toggle="yes">in situ</italic> growth can be estimated as the deviation from equilibrium:
<disp-formula id="pcbi.1009343.e026"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e026.jpg" id="pcbi.1009343.e026g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1009343.e027"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e027.jpg" id="pcbi.1009343.e027g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009343.e028"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.e028.jpg" id="pcbi.1009343.e028g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> are estimated parameters. In addition, species replication rates for samples not under antibiotic treatment in Raymond <italic toggle="yes">et al</italic> [<xref rid="pcbi.1009343.ref036" ref-type="bibr">36</xref>] were estimated with the high-throughput mode of GRiD (v1.2.0; default parameters) [<xref rid="pcbi.1009343.ref037" ref-type="bibr">37</xref>]. Gut microbiome associated genomes provided with GRiD were used as references and read reassignment using pathoscope2 [<xref rid="pcbi.1009343.ref038" ref-type="bibr">38</xref>] was enabled (parameter “-p”) to resolve ambiguous mappings.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec014">
    <title>3. Results</title>
    <sec id="sec015">
      <title>3.1 Accurate inference of ecological interactions from cross-sectional microbiome data</title>
      <p>To evaluate if ecological interactions can be inferred from cross-sectional microbiome data (16S rRNA gene amplicon or whole metagenomic sequencing) we first began by conducting extensive benchmarks on complex simulated communities where the truth is known (using gLVMs, number of species = 30, equilibrium conditions; <bold>Methods</bold>). Consistent with prior reports [<xref rid="pcbi.1009343.ref017" ref-type="bibr">17</xref>, <xref rid="pcbi.1009343.ref018" ref-type="bibr">18</xref>], we noted that all 10 state-of-the-art correlation-based methods provided performances that were only slightly better than random predictions in identifying true interactions, even while ignoring directionality (AUC-ROC&lt;0.63; <bold>Figs <xref rid="pcbi.1009343.g002" ref-type="fig">2A</xref></bold> and <bold><xref rid="pcbi.1009343.s001" ref-type="supplementary-material">S1</xref></bold>). The ability to correct for compositionality of microbiome data (CCREPE, SparCC, CCLasso, REBACCA), or reduce false positives from transitive correlations (MInt, SPIEC-EASI, BAnOCC and gCoda), did not notably change performance compared to naïve correlation calculations (Pearson or Spearman) when inferring ecological interactions. In contrast, BEEM-Static was able to infer the interactions with notably higher sensitivity and specificity than all correlation-based methods (AUC-ROC = 0.88; <bold>Figs <xref rid="pcbi.1009343.g002" ref-type="fig">2A</xref></bold> and <bold><xref rid="pcbi.1009343.s001" ref-type="supplementary-material">S1</xref></bold>). Although BEEM-Static only used noisy relative abundances for gLVM inference, its performance matched that of a positive control that assumes noise-free biomass values to scale relative abundances to absolute abundances (<bold>Figs <xref rid="pcbi.1009343.g002" ref-type="fig">2A</xref></bold> and <bold><xref rid="pcbi.1009343.s001" ref-type="supplementary-material">S1</xref></bold>, BEEM-Static vs. true biomass), an assumption that is unlikely to be met in realistic settings [<xref rid="pcbi.1009343.ref023" ref-type="bibr">23</xref>].</p>
      <fig position="float" id="pcbi.1009343.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009343.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Benchmarking performance for network structure and edge directionality.</title>
          <p>Note that CCREPE has two versions with Pearson and Spearman correlations (CCREPE.P and CCREPE.S), while SPIEC-EASI using “mb” and “glasso” algorithms is represented as SE.mb and SE.glasso, respectively. (A) ROC curves for different correlation based methods, the regression method using true biomass values and BEEM-Static for one simulated dataset with 30 species and 500 samples. (B) Boxplots showing precision and recall for directionality/sign of interactions for 30 different simulated communities with 30 species and 500 samples each. (C) True interaction network for a synthetic community based on all-pair co-culture data (Ground truth), inferred correlation network by BAnOCC and inferred interaction network by BEEM-Static (numbers on edges represent gLVM parameter values or correlation coefficients). PC: <italic toggle="yes">Prevotella copri</italic>, BV: <italic toggle="yes">Bacteroides vulgatus</italic>, BU: <italic toggle="yes">Bacteroides uniformis</italic>, BO: <italic toggle="yes">Bacteroides ovatus</italic>, BT: <italic toggle="yes">Bacteroides thetaiotaomicron</italic>, FP: <italic toggle="yes">Faecalibacterium prausnitzii</italic>, BH: <italic toggle="yes">Blautia hydrogenotrophica</italic>, ER: <italic toggle="yes">Eubacterium rectale</italic>, CA: <italic toggle="yes">Collinsella aerofaciens</italic>, EL: <italic toggle="yes">Eggerthella lenta</italic>, DP: <italic toggle="yes">Desulfovibrio piger</italic>, CH: <italic toggle="yes">Clostridium hiranonis</italic>.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.g002" position="float"/>
      </fig>
      <p>In addition to knowing that two species are interacting, a key aspect of ecological interactions is the directionality/sign of interactions, with correlation-based methods either exhibiting low sensitivity (REBACCA, SPIEC-EASI) or low precision (Pearson, Spearman, CCREPE, SparCC, CCLasso, MInt, BAnOCC, gCoda) despite the exclusion of predatory interactions (positive-negative) when calculating their performance (<bold><xref rid="pcbi.1009343.g002" ref-type="fig">Fig 2B</xref></bold>; <bold>Methods</bold>). BEEM-Static addresses this issue by providing high sensitivity (&gt;80%) and precision (nearly 100%) using cross-sectional microbiome data (<bold><xref rid="pcbi.1009343.g002" ref-type="fig">Fig 2B</xref></bold>). These observations were recapitulated in a wide range of simulated datasets with varying network structure and edge sparsity, highlighting BEEM-Static’s robustness (<bold><xref rid="pcbi.1009343.s002" ref-type="supplementary-material">S2</xref></bold> and <bold><xref rid="pcbi.1009343.s003" ref-type="supplementary-material">S3</xref> Figs</bold>). Furthermore, BEEM-Static provides estimates for biomass values that were found to be consistently accurate (relative error &lt;10%) and can be used to provide meaningful biological insights [<xref rid="pcbi.1009343.ref023" ref-type="bibr">23</xref>].</p>
      <p>We extended the evaluations to experimental data, using all-pair co-culture and isolate growth curves for 12 species [<xref rid="pcbi.1009343.ref020" ref-type="bibr">20</xref>] to create synthetic communities where the interaction network is known, albeit sparse (<bold><xref rid="pcbi.1009343.g002" ref-type="fig">Fig 2C</xref></bold>; Ground truth). Not surprisingly, recapitulating the structure of such a simple interaction network was not difficult for most correlation-based methods, with BAnOCC having the best performance overall (AUC-ROC = 0.9, <bold><xref rid="pcbi.1009343.s004" ref-type="supplementary-material">S4 Fig</xref></bold>). However, determining directionality of interactions was still a challenge, despite the simplicity of the network. For example, in the case of BAnOCC the commensalistic interaction between DP and FP was captured as a negative correlation, while the predatory interaction between BH and ER was captured as a positive correlation (<bold><xref rid="pcbi.1009343.g002" ref-type="fig">Fig 2C</xref></bold>; BAnOCC). BEEM-Static, on the other hand, was able to capture all interactions and their directionality correctly, except for one false positive (FP to DP) and one false negative (BT to EL) involving interactions with weak strength (<bold><xref rid="pcbi.1009343.g002" ref-type="fig">Fig 2C</xref></bold>; BEEM-Static). BEEM-Static’s utility in such datasets was consistently observed in comparison to correlation-based methods with AUC-ROC close to 1 (<bold><xref rid="pcbi.1009343.s004" ref-type="supplementary-material">S4 Fig</xref></bold>).</p>
    </sec>
    <sec id="sec016">
      <title>3.2 Statistical filters in BEEM-Static provide robustness to violations in modeling assumptions</title>
      <p>While the simulations in the previous section account for experimental errors, they assume that all samples come from equilibrium states, an unlikely situation for most real datasets. Relaxing this assumption, we noted that with as little as 5% non-equilibrium samples, AUC-ROC decreased by &gt;10%, and with 15% non-equilibrium samples AUC-ROC performance degraded to match that of correlation-based methods (Naïve algorithm, <bold>Figs <xref rid="pcbi.1009343.g003" ref-type="fig">3A</xref></bold> and <bold><xref rid="pcbi.1009343.s005" ref-type="supplementary-material">S5A</xref></bold>; <bold>Methods</bold>). Incorporating a statistical filter in BEEM-Static that compares estimated species relative abundances at equilibrium with observed abundances (equilibrium filter; <bold>Methods</bold>) helped identify samples that were not at equilibrium with high sensitivity and specificity (<bold><xref rid="pcbi.1009343.s005" ref-type="supplementary-material">S5A Fig</xref></bold>). This in turn allowed BEEM-Static to be robust to having nearly half of the samples (45%) in the dataset being at a non-equilibrium state (performance reduction &lt;5%; <bold>Figs <xref rid="pcbi.1009343.g003" ref-type="fig">3A</xref></bold> and <bold><xref rid="pcbi.1009343.s005" ref-type="supplementary-material">S5A</xref></bold>, BEEM-Static).</p>
      <fig position="float" id="pcbi.1009343.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009343.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>BEEM-Static robustly filters samples violating modeling assumption in simulated and real datasets.</title>
          <p>(A-B) Performance reduction for BEEM-Static (with filters) and the naïve algorithm (without filtering of samples) as the percentage of samples at (A) equilibrium or (B) generated from the main model, decreases. Reduction is measured relative to BEEM-Static with no filters and all data from the model and at equilibrium. Points denote the means while error bars denote the standard deviation across 30 simulations each. (C-D) Principal coordinates plots (Bray-Curtis dissimilarity) representing gut microbiome taxonomic profiles from 4,617 samples. Points represent samples from individuals taking antibiotics (C) or from newborn infants (D), while crosses represent samples from adults who are not undergoing antibiotic treatment. Points that were filtered by BEEM-Static are colored blue and red otherwise.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.g003" position="float"/>
      </fig>
      <p>We next investigated the impact of relaxing the “universal model” assumption i.e. that all samples have the same ecological conditions and model parameters. This assumption may not hold true in many real-world settings (e.g. gut microbiome samples from different enterotypes [<xref rid="pcbi.1009343.ref024" ref-type="bibr">24</xref>]), and as expected relaxing it had a strong impact (30% reduction in AUC-ROC) even with slight deviations (5%, Naïve algorithm; <bold>Figs <xref rid="pcbi.1009343.g003" ref-type="fig">3B</xref></bold> and <bold><xref rid="pcbi.1009343.s005" ref-type="supplementary-material">S5B</xref></bold>; <bold>Methods</bold>). In addition, AUC-ROC performance continued to decrease beyond 60% even after nearly half the samples (40–45%) were derived from a different model. To address this, BEEM-Static implements a filter that identifies samples that have poor goodness-of-fit to the current model (model filter; <bold>Methods</bold>) and excludes them in subsequent iterations of model inference. This approach was found to provide robustness to up to ~40% of samples from a different model (performance reduction &lt;20%, BEEM-Static; <bold>Figs <xref rid="pcbi.1009343.g003" ref-type="fig">3B</xref></bold> and <bold><xref rid="pcbi.1009343.s005" ref-type="supplementary-material">S5B</xref></bold>).</p>
      <p>Finally, we employed real microbiome datasets to test BEEM-Static’s robustness where a subset of samples is known to violate modeling assumptions i.e. some subjects undergoing oral antibiotic treatment or samples from newborn infants, where the majority of samples are from adults who are not undergoing antibiotic treatment. BEEM-Static was able to identify such samples with high sensitivity (&gt;80%) using its model filter (<bold><xref rid="pcbi.1009343.g003" ref-type="fig">Fig 3C</xref></bold> and <bold><xref rid="pcbi.1009343.g003" ref-type="fig">3D</xref></bold>), and the filtered samples were significantly enriched for those from antibiotic-treated adults and infants (Fisher’s Exact test p-value&lt;10<sup>−22</sup>).</p>
    </sec>
    <sec id="sec017">
      <title>3.3 BEEM-Static analysis of human gut microbiomes identifies distinct ecological configurations</title>
      <p>To further assess BEEM-Static’s utility we evaluated the concordance of parameters learnt during the training process with orthogonal information for a large human gut microbiome dataset (N = 4,617; <bold>Methods</bold>). In particular, we noted that biomass estimates from BEEM-Static were significantly higher for adults versus newborn infants (~2×; Wilcoxon test p-value &lt;10<sup>−15</sup>; <bold><xref rid="pcbi.1009343.g004" ref-type="fig">Fig 4A</xref></bold>), consistent with our understanding of a maturing gut microbiome [<xref rid="pcbi.1009343.ref039" ref-type="bibr">39</xref>, <xref rid="pcbi.1009343.ref040" ref-type="bibr">40</xref>]. Additionally, we used deviations from equilibrium (<italic toggle="yes">dx</italic><sub><italic toggle="yes">i</italic></sub>(<italic toggle="yes">t</italic>)/<italic toggle="yes">dt</italic> = 0) to estimate instantaneous growth (population increase or decrease) of each species in each sample (<bold>Methods</bold>), and assessed concordance with an <italic toggle="yes">in silico</italic> approach to estimate DNA replication rates [<xref rid="pcbi.1009343.ref037" ref-type="bibr">37</xref>]. Despite the fact that growth rates are also impacted by death rates, we observed that species predicted to grow based on BEEM-Static analysis were also found to have significantly higher DNA replication rates (GRiD values; Wilcoxon test p-value = 3×10<sup>−4</sup>; <bold><xref rid="pcbi.1009343.g004" ref-type="fig">Fig 4B</xref></bold>).</p>
      <fig position="float" id="pcbi.1009343.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009343.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Analysis of human gut microbiomes with BEEM-Static.</title>
          <p>(A) Violin plots showing the significant difference in BEEM-Static biomass estimates for adults and newborn infants. (B) Boxplots showing differences in DNA replication rates (GRiD estimates) for species predicted to decrease and increase in population size, respectively, by BEEM-Static. Each point represents one species in a sample. (C) Scatter plot showing the first two components from a principal component analysis of equilibrium abundances for samples (as predicted by BEEM-Static). (D) Predicted carrying capacities (square root transformed) of species in the two models. Species with divergent carrying capacities (ratio is &gt;2 standard deviations from 1) in the two models are marked with stars.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.g004" position="float"/>
      </fig>
      <p>Using an iterative approach to train a new model on samples excluded from the first model, we observed that BEEM-Static classifies a majority of the samples to two models (1995 for model 1 and 1145 for model 2; <bold><xref rid="pcbi.1009343.s008" ref-type="supplementary-material">S1 Table</xref></bold>). Visualizing the expected microbial composition for each sample at equilibrium, we noted three distinct clusters in a principal component analysis plot (<bold><xref rid="pcbi.1009343.g004" ref-type="fig">Fig 4C</xref></bold>), where samples in clusters 1 and 2 largely correspond to profiles from models 1 and 2, respectively. Analysis of carrying capacities highlighted that the clusters were defined by <italic toggle="yes">Prevotella copri</italic>, which has higher carrying capacity in cluster 1 vs 2 and is absent in samples from cluster 3 (<bold><xref rid="pcbi.1009343.g004" ref-type="fig">Fig 4D</xref></bold>). Several other species were also found to have divergent carrying capacities in the two models, including <italic toggle="yes">Bifidobacterium adolescentis</italic>, <italic toggle="yes">Collinsella aerofaciens</italic> and <italic toggle="yes">Coprococcus comes</italic> (enriched in model 2), some of which have been shown to be associated with fiber intake [<xref rid="pcbi.1009343.ref041" ref-type="bibr">41</xref>, <xref rid="pcbi.1009343.ref042" ref-type="bibr">42</xref>]. Overall the ecological models identified here have distinct sets of interactions (<bold><xref rid="pcbi.1009343.s008" ref-type="supplementary-material">S1 Table</xref></bold>) and do not appear to match earlier definitions of enterotypes [<xref rid="pcbi.1009343.ref024" ref-type="bibr">24</xref>] based on principal coordinate analysis and clustering (S<bold><xref rid="pcbi.1009343.s007" ref-type="supplementary-material">7 Fig</xref></bold>).</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec018">
    <title>4. Discussion</title>
    <p>As microbiome research increasingly moves from descriptive studies to those that seek to provide a mechanistic understanding of microbial communities, the ability to infer microbial interactions from microbiome data is an important capability. In particular, the directionality and sign of interactions provide biologically interpretable information that is missed by correlation-based approaches. BEEM-Static provides an alternative avenue to infer this, with the caveats that it assumes a specific model (generalized Lotka-Volterra) for community dynamics and removes rare and low abundance species with limited number of samples in practice. In addition, as we show here, other values obtained from BEEM-Static models can have utility, including the strength of interactions, biomass estimates, deviation from equilibrium, and fit to model.</p>
    <p>In addition to accounting for relative abundance estimates from microbiome data, the statistical filters employed by BEEM-Static make it robust to some of the violations in model assumptions that can be expected in real datasets. These features make BEEM-Static widely applicable, and also extends the use of ecological models with microbiome data. For instance, our analysis of large public microbiome datasets provides an alternate perspective to the discussion on microbial enterotypes [<xref rid="pcbi.1009343.ref024" ref-type="bibr">24</xref>] and universality of microbiome dynamics [<xref rid="pcbi.1009343.ref043" ref-type="bibr">43</xref>]. The ecological types observed here are characterized by distinct carrying capacities that might be a function of the environment (e.g. host factors or diet). Fiber rich diets are known to have a strong impact on the gut microbiome [<xref rid="pcbi.1009343.ref042" ref-type="bibr">42</xref>] and have been linked to some of the species with differential carrying capacities in our models [<xref rid="pcbi.1009343.ref041" ref-type="bibr">41</xref>]. We anticipate that the incorporation of such environmental factors into future models would be an exciting avenue to study their influence on microbial community structure <italic toggle="yes">in vivo</italic>. Finally, hybrid methods that learn models from both longitudinal and cross-sectional data represent another promising direction to explore for studying general and individual specific microbiome dynamics [<xref rid="pcbi.1009343.ref023" ref-type="bibr">23</xref>].</p>
  </sec>
  <sec id="sec019" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1009343.s001" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Performance comparison for determining interaction network structure.</title>
        <p>Boxplots show AUC-ROC values for 30 different simulated communities with 30 species and 500 samples each.</p>
        <p>(TIFF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.s001.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009343.s002" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Robustness of BEEM-Static performance across different network structures.</title>
        <p>Boxplots showing relative error for (A) parameter estimates for biomass (scaled to have the same median as the ground truth) and carrying capacity, and (B) interaction network AUC-ROC as well as sign recall and precision, based on 30 simulations. Diamonds mark median performance using true biomass values. Different network structures (except “random”) were generated with the SPIEC-EASI R package.</p>
        <p>(TIFF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.s002.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009343.s003" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Robustness of BEEM-Static performance with varying edge densities.</title>
        <p>Boxplots showing relative error for (A) parameter estimates for biomass (scaled to have the same median as the ground truth) and carrying capacity, and (B) interaction network AUC-ROC as well as sign recall and precision, based on 30 simulations. Diamonds mark median performance using true biomass values.</p>
        <p>(TIFF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.s003.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009343.s004" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Benchmarking on synthetic communities created based on co-growth experimental data.</title>
        <p>Boxplots show the performance of various methods based on 30 replicates that use randomly selected interacting pairs.</p>
        <p>(TIFF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.s004.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009343.s005" position="float" content-type="local-data">
      <label>S5 Fig</label>
      <caption>
        <title>Utility of BEEM-Static filters for avoiding performance reduction in the presence of model violations.</title>
        <p>Results are shown for increasing proportion of samples that are, (A) not at equilibrium or (B) not from the main model. The naïve algorithm is without filtering of samples and performance reduction is measured relative to BEEM-Static with no model violations for the data. Points show means while error bars show standard deviation across 30 simulations.</p>
        <p>(TIFF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.s005.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009343.s006" position="float" content-type="local-data">
      <label>S6 Fig</label>
      <caption>
        <title>Percentage of the gut microbiome represented by the 42 core species used by BEEM-Static for modeling with the curatedMetagenomicData dataset.</title>
        <p>(TIFF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.s006.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009343.s007" position="float" content-type="local-data">
      <label>S7 Fig</label>
      <caption>
        <title>Ecological models from BEEM-static represent distinct configurations from enterotypes.</title>
        <p>Principal coordinates plot (Bray-Curtis dissimilarity) based on gut microbiome taxonomic profiles. The contour lines highlight the two different regions where points aggregate. Points are colored by the BEEM-static models that they belong to (unassigned samples not shown), showing that while there appears to be some enrichment, model ids and enterotypes do not show a 1–1 correspondence.</p>
        <p>(TIFF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.s007.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009343.s008" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Parameters estimated by BEEM-Static for the two models learned from the curatedMetagenomicData dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.s008.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009343.s009" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Derivation of the expectation-maximization algorithm and training convergence.</title>
        <p>(PDF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Dr. Swaine Chen, Dr. Rohan Williams and Dr. Jonathan Teo for their constructive comments and feedback on this work.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1009343.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Mohanram</surname><given-names>S</given-names></name>, <name><surname>Kumar</surname><given-names>P</given-names></name>. <article-title>Rhizosphere microbiome: revisiting the synergy of plant-microbe interactions.</article-title><source>Annals of Microbiology.</source> Springer Verlag; <year>2019</year>. pp. <fpage>307</fpage>–<lpage>320</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s13213-019-01448-9</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>De Filippis</surname><given-names>F</given-names></name>, <name><surname>Parente</surname><given-names>E</given-names></name>, <name><surname>Ercolini</surname><given-names>D</given-names></name>. <article-title>Recent Past, Present, and Future of the Food Microbiome.</article-title><source>Annu Rev Food Sci Technol</source>. <year>2018</year>;<volume>9</volume>: <fpage>589</fpage>–<lpage>608</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev-food-030117-012312</pub-id><?supplied-pmid 29350561?><pub-id pub-id-type="pmid">29350561</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Chng</surname><given-names>KR</given-names></name>, <name><surname>Tay</surname><given-names>ASL</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Ng</surname><given-names>AHQ</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Suri</surname><given-names>BK</given-names></name>, <etal>et al</etal>. <article-title>Whole metagenome profiling reveals skin microbiome-dependent susceptibility to atopic dermatitis flare.</article-title><source>Nat Microbiol</source>. <year>2016</year>;<volume>1</volume>: <fpage>16106</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.106</pub-id><?supplied-pmid 27562258?><pub-id pub-id-type="pmid">27562258</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Clemente</surname><given-names>JC</given-names></name>, <name><surname>Ursell</surname><given-names>LK</given-names></name>, <name><surname>Parfrey</surname><given-names>LW</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name>. <article-title>The impact of the gut microbiota on human health: An integrative view.</article-title><source>Cell.</source> Cell Press; <year>2012</year>. pp. <fpage>1258</fpage>–<lpage>1270</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2012.01.035</pub-id>
<?supplied-pmid 22424233?><pub-id pub-id-type="pmid">22424233</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Chng</surname><given-names>KR</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Bertrand</surname><given-names>D</given-names></name>, <name><surname>Ng</surname><given-names>AHQ</given-names></name>, <name><surname>Kwah</surname><given-names>JS</given-names></name>, <name><surname>Low</surname><given-names>HM</given-names></name>, <etal>et al</etal>. <article-title>Cartography of opportunistic pathogens and antibiotic resistance genes in a tertiary hospital environment</article-title>. <source>Nat Med</source> 2020 266. <year>2020</year>;<volume>26</volume>: <fpage>941</fpage>–<lpage>951</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41591-020-0894-4</pub-id>
<?supplied-pmid 32514171?><pub-id pub-id-type="pmid">32514171</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Gould</surname><given-names>AL</given-names></name>, <name><surname>Zhang</surname><given-names>V</given-names></name>, <name><surname>Lamberti</surname><given-names>L</given-names></name>, <name><surname>Jones</surname><given-names>EW</given-names></name>, <name><surname>Obadia</surname><given-names>B</given-names></name>, <name><surname>Korasidis</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Microbiome interactions shape host fitness</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2018</year>;<volume>115</volume>: <fpage>E11951</fpage>–<lpage>E11960</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1809349115</pub-id><?supplied-pmid 30510004?><pub-id pub-id-type="pmid">30510004</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Cordero</surname><given-names>OX</given-names></name>, <name><surname>Datta</surname><given-names>MS</given-names></name>. <article-title>Microbial interactions and community assembly at microscales</article-title>. <source>Curr Opin Microbiol</source>. <year>2016</year>;<volume>31</volume>: <fpage>227</fpage>–<lpage>234</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.mib.2016.03.015</pub-id><?supplied-pmid 27232202?><pub-id pub-id-type="pmid">27232202</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Fraune</surname><given-names>S</given-names></name>, <name><surname>Anton-Erxleben</surname><given-names>F</given-names></name>, <name><surname>Augustin</surname><given-names>R</given-names></name>, <name><surname>Franzenburg</surname><given-names>S</given-names></name>, <name><surname>Knop</surname><given-names>M</given-names></name>, <name><surname>Schröder</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Bacteria–bacteria interactions within the microbiota of the ancestral metazoan Hydra contribute to fungal resistance.</article-title><source>ISME J</source>. <year>2015</year>;<volume>9</volume>: <fpage>1543</fpage>–<lpage>1556</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ismej.2014.239</pub-id><?supplied-pmid 25514534?><pub-id pub-id-type="pmid">25514534</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Faust</surname><given-names>K</given-names></name>, <name><surname>Raes</surname><given-names>J</given-names></name>. <article-title>Microbial interactions: from networks to models</article-title>. <source>Nat Rev Microbiol</source>. <year>2012</year>;<volume>10</volume>: <fpage>538</fpage>–<lpage>50</lpage>. Available: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/22796884" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/22796884</ext-link><comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrmicro2832</pub-id><?supplied-pmid 22796884?><pub-id pub-id-type="pmid">22796884</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Buffie</surname><given-names>CG</given-names></name>, <name><surname>Bucci</surname><given-names>V</given-names></name>, <name><surname>Stein</surname><given-names>RR</given-names></name>, <name><surname>McKenney</surname><given-names>PT</given-names></name>, <name><surname>Ling</surname><given-names>L</given-names></name>, <name><surname>Gobourne</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Precision microbiome reconstitution restores bile acid mediated resistance to Clostridium difficile</article-title>. <source>Nature</source>. <year>2014</year>;<volume>517</volume>: <fpage>205</fpage>–<lpage>208</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature13828</pub-id><?supplied-pmid 25337874?><pub-id pub-id-type="pmid">25337874</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Röttjers</surname><given-names>L</given-names></name>, <name><surname>Faust</surname><given-names>K</given-names></name>. <article-title>From hairballs to hypotheses–biological insights from microbial networks</article-title>. <source>FEMS Microbiology Reviews</source>. Oxford University Press; <year>2018</year>. pp. <fpage>761</fpage>–<lpage>780</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/femsre/fuy030</pub-id><?supplied-pmid 30085090?><pub-id pub-id-type="pmid">30085090</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Xiao</surname><given-names>Y</given-names></name>, <name><surname>Angulo</surname><given-names>MT</given-names></name>, <name><surname>Lao</surname><given-names>S</given-names></name>, <name><surname>Weiss</surname><given-names>ST</given-names></name>, <name><surname>Liu</surname><given-names>YY</given-names></name>. <article-title>An ecological framework to understand the efficacy of fecal microbiota transplantation</article-title>. <source>Nat Commun</source>. <year>2020</year>;<volume>11</volume>: <fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-019-13993-7</pub-id><?supplied-pmid 31911652?><pub-id pub-id-type="pmid">31911652</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Angulo</surname><given-names>MT</given-names></name>, <name><surname>Moog</surname><given-names>CH</given-names></name>, <name><surname>Liu</surname><given-names>Y-Y</given-names></name>. <article-title>A theoretical framework for controlling complex microbial communities.</article-title><source>Nat Commun</source>. <year>2019</year>;<volume>10</volume>: <fpage>1045</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-019-08890-y</pub-id><?supplied-pmid 30837457?><pub-id pub-id-type="pmid">30837457</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Stein</surname><given-names>RR</given-names></name>, <name><surname>Tanoue</surname><given-names>T</given-names></name>, <name><surname>Szabady</surname><given-names>RL</given-names></name>, <name><surname>Bhattarai</surname><given-names>SK</given-names></name>, <name><surname>Olle</surname><given-names>B</given-names></name>, <name><surname>Norman</surname><given-names>JM</given-names></name>, <etal>et al</etal>. <article-title>Computer-guided design of optimal microbial consortia for immune system modulation.</article-title><source>Elife</source>. <year>2018</year>;<volume>7</volume>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.30916</pub-id><?supplied-pmid 29664397?><pub-id pub-id-type="pmid">29664397</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Kenneth</surname><given-names>LKM</given-names></name>, <name><surname>Chng</surname><given-names>KR</given-names></name>, <name><surname>Nagarajan</surname><given-names>N</given-names></name>. <article-title>Predicting Microbial Interactions through Computational Approaches.</article-title><source>Methods</source>. <year>2016</year> [cited 31 Mar 2016]. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ymeth.2016.02.019</pub-id>
<?supplied-pmid 27025964?><pub-id pub-id-type="pmid">27025964</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Berry</surname><given-names>D</given-names></name>, <name><surname>Widder</surname><given-names>S</given-names></name>. <article-title>Deciphering microbial interactions and detecting keystone species with co-occurrence networks.</article-title><source>Front Microbiol</source>. <year>2014</year>;<volume>5</volume>: <fpage>219</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fmicb.2014.00219</pub-id><?supplied-pmid 24904535?><pub-id pub-id-type="pmid">24904535</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Hirano</surname><given-names>H</given-names></name>, <name><surname>Takemoto</surname><given-names>K</given-names></name>. <article-title>Difficulty in inferring microbial community structure based on co-occurrence network approaches</article-title>. <source>BMC Bioinformatics</source>. <year>2019</year>;<volume>20</volume>: <fpage>329</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12859-019-2915-1</pub-id><?supplied-pmid 31195956?><pub-id pub-id-type="pmid">31195956</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Carr</surname><given-names>A</given-names></name>, <name><surname>Diener</surname><given-names>C</given-names></name>, <name><surname>Baliga</surname><given-names>NS</given-names></name>, <name><surname>Gibbons</surname><given-names>SM</given-names></name>. <article-title>Use and abuse of correlation analyses in microbial ecology</article-title>. <source>ISME J</source>. <year>2019</year>; <volume>1</volume>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41396-019-0459-z</pub-id><?supplied-pmid 31253856?><pub-id pub-id-type="pmid">31253856</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Bucci</surname><given-names>V</given-names></name>, <name><surname>Tzen</surname><given-names>B</given-names></name>, <name><surname>Li</surname><given-names>N</given-names></name>, <name><surname>Simmons</surname><given-names>M</given-names></name>, <name><surname>Tanoue</surname><given-names>T</given-names></name>, <name><surname>Bogart</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>MDSINE: Microbial Dynamical Systems INference Engine for microbiome time-series analyses</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>: <fpage>121</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-016-0980-6</pub-id><?supplied-pmid 27259475?><pub-id pub-id-type="pmid">27259475</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Venturelli</surname><given-names>OS</given-names></name>, <name><surname>Carr</surname><given-names>AC</given-names></name>, <name><surname>Fisher</surname><given-names>G</given-names></name>, <name><surname>Hsu</surname><given-names>RH</given-names></name>, <name><surname>Lau</surname><given-names>R</given-names></name>, <name><surname>Bowen</surname><given-names>BP</given-names></name>, <etal>et al</etal>. <article-title>Deciphering microbial interactions in synthetic human gut microbiome communities</article-title>. <source>Mol Syst Biol</source>. <year>2018</year>;<volume>14</volume>: <fpage>e8157</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.15252/msb.20178157</pub-id><?supplied-pmid 29930200?><pub-id pub-id-type="pmid">29930200</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Silverman</surname><given-names>JD</given-names></name>, <name><surname>Durand</surname><given-names>HK</given-names></name>, <name><surname>Bloom</surname><given-names>RJ</given-names></name>, <name><surname>Mukherjee</surname><given-names>S</given-names></name>, <name><surname>David</surname><given-names>LA</given-names></name>. <article-title>Dynamic linear models guide design and analysis of microbiota studies within artificial human guts.</article-title><source>Microbiome</source>. <year>2018</year>;<volume>6</volume>: <fpage>202</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-018-0584-3</pub-id><?supplied-pmid 30419949?><pub-id pub-id-type="pmid">30419949</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Xiao</surname><given-names>Y</given-names></name>, <name><surname>Angulo</surname><given-names>MT</given-names></name>, <name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Waldor</surname><given-names>MK</given-names></name>, <name><surname>Weiss</surname><given-names>ST</given-names></name>, <name><surname>Liu</surname><given-names>Y-Y</given-names></name>. <article-title>Mapping the ecological networks of microbial communities.</article-title><source>Nat Commun.</source><year>2017</year>;<volume>8</volume>: <fpage>2042</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-017-02090-2</pub-id><?supplied-pmid 29229902?><pub-id pub-id-type="pmid">29229902</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Chng</surname><given-names>KR</given-names></name>, <name><surname>Kwah</surname><given-names>JS</given-names></name>, <name><surname>Av-Shalom T</surname><given-names>V</given-names></name>., <name><surname>Tucker-Kellogg</surname><given-names>L</given-names></name>, <name><surname>Nagarajan</surname><given-names>N</given-names></name>. <article-title>An expectation-maximization algorithm enables accurate ecological modeling using longitudinal microbiome sequencing data.</article-title><source>Microbiome.</source><year>2019</year>;<volume>7</volume>: <fpage>118</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-019-0729-z</pub-id><?supplied-pmid 31439018?><pub-id pub-id-type="pmid">31439018</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Arumugam</surname><given-names>M</given-names></name>, <name><surname>Raes</surname><given-names>J</given-names></name>, <name><surname>Pelletier</surname><given-names>E</given-names></name>, <name><surname>Le Paslier</surname><given-names>D</given-names></name>, <name><surname>Yamada</surname><given-names>T</given-names></name>, <name><surname>Mende</surname><given-names>DR</given-names></name>, <etal>et al</etal>. <article-title>Enterotypes of the human gut microbiome</article-title>. <source>Nature</source>. <year>2011</year>;<volume>473</volume>: <fpage>174</fpage>–<lpage>80</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature09944</pub-id><?supplied-pmid 21508958?><pub-id pub-id-type="pmid">21508958</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Paulson</surname><given-names>JN</given-names></name>, <name><surname>Stine</surname><given-names>OC</given-names></name>, <name><surname>Bravo</surname><given-names>HC</given-names></name>, <name><surname>Pop</surname><given-names>M</given-names></name>. <article-title>Differential abundance analysis for microbial marker-gene surveys.</article-title><source>Nat Methods</source>. <year>2013</year>;<volume>10</volume>: <fpage>1200</fpage>–<lpage>1202</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.2658</pub-id><?supplied-pmid 24076764?><pub-id pub-id-type="pmid">24076764</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Regularization Paths for Generalized Linear Models via Coordinate Descent.</article-title><source>J Stat Softw.</source><year>2010</year>;<volume>33</volume>: <fpage>1</fpage>–<lpage>22</lpage>. Available: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20808728" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/20808728</ext-link><?supplied-pmid 20808728?><pub-id pub-id-type="pmid">20808728</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Pasolli</surname><given-names>E</given-names></name>, <name><surname>Schiffer</surname><given-names>L</given-names></name>, <name><surname>Manghi</surname><given-names>P</given-names></name>, <name><surname>Renson</surname><given-names>A</given-names></name>, <name><surname>Obenchain</surname><given-names>V</given-names></name>, <name><surname>Truong</surname><given-names>DT</given-names></name>, <etal>et al</etal>. <article-title>Accessible, curated metagenomic data through ExperimentHub.</article-title><source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>: <fpage>1023</fpage>–<lpage>1024</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.4468</pub-id><?supplied-pmid 29088129?><pub-id pub-id-type="pmid">29088129</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Faust</surname><given-names>K</given-names></name>, <name><surname>Sathirapongsasuti</surname><given-names>JF</given-names></name>, <name><surname>Izard</surname><given-names>J</given-names></name>, <name><surname>Segata</surname><given-names>N</given-names></name>, <name><surname>Gevers</surname><given-names>D</given-names></name>, <name><surname>Raes</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Microbial co-occurrence relationships in the human microbiome.</article-title><source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>: <fpage>e1002606</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002606</pub-id><?supplied-pmid 22807668?><pub-id pub-id-type="pmid">22807668</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Alm</surname><given-names>EJ</given-names></name>. <article-title>Inferring Correlation Networks from Genomic Survey Data.</article-title><name><surname>von Mering</surname><given-names>C</given-names></name>, editor. <source>PLoS Comput Biol.</source><year>2012</year>;<volume>8</volume>: <fpage>e1002687</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002687</pub-id><?supplied-pmid 23028285?><pub-id pub-id-type="pmid">23028285</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Fang</surname><given-names>H</given-names></name>, <name><surname>Huang</surname><given-names>C</given-names></name>, <name><surname>Zhao</surname><given-names>H</given-names></name>, <name><surname>Deng</surname><given-names>M</given-names></name>. <article-title>CCLasso: Correlation Inference for Compositional Data through Lasso</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>: <fpage>btv349</fpage>–. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btv349</pub-id><?supplied-pmid 26048598?><pub-id pub-id-type="pmid">26048598</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Ban</surname><given-names>Y</given-names></name>, <name><surname>An</surname><given-names>L</given-names></name>, <name><surname>Jiang</surname><given-names>H</given-names></name>. <article-title>Investigating microbial co-occurrence patterns based on metagenomic compositional data</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>: <fpage>btv364</fpage>–. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btv364</pub-id><?supplied-pmid 26079350?><pub-id pub-id-type="pmid">26079350</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Biswas</surname><given-names>S</given-names></name>, <name><surname>McDonald</surname><given-names>M</given-names></name>, <name><surname>Lundberg</surname><given-names>DS</given-names></name>, <name><surname>Dangl</surname><given-names>JL</given-names></name>, <name><surname>Jojic</surname><given-names>V</given-names></name>. <article-title>Learning microbial interaction networks from metagenomic count data</article-title>. <source>J Comput Biol</source>. <year>2014</year>;<volume>23</volume>: <fpage>526</fpage>–<lpage>535</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/cmb.2016.0061</pub-id><?supplied-pmid 27267776?><pub-id pub-id-type="pmid">27267776</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Kurtz</surname><given-names>ZD</given-names></name>, <name><surname>Müller</surname><given-names>CL</given-names></name>, <name><surname>Miraldi</surname><given-names>ER</given-names></name>, <name><surname>Littman</surname><given-names>DR</given-names></name>, <name><surname>Blaser</surname><given-names>MJ</given-names></name>, <name><surname>Bonneau</surname><given-names>RA</given-names></name>. <article-title>Sparse and Compositionally Robust Inference of Microbial Ecological Networks.</article-title><source>PLoS Comput Biol.</source><year>2015</year>;<volume>11</volume>: <fpage>e1004226</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004226</pub-id><?supplied-pmid 25950956?><pub-id pub-id-type="pmid">25950956</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Schwager</surname><given-names>E</given-names></name>, <name><surname>Mallick</surname><given-names>H</given-names></name>, <name><surname>Ventz</surname><given-names>S</given-names></name>, <name><surname>Huttenhower</surname><given-names>C</given-names></name>. <article-title>A Bayesian method for detecting pairwise associations in compositional data.</article-title><name><surname>Blekhman</surname><given-names>R</given-names></name>, editor. <source>PLOS Comput Biol</source>. <year>2017</year>;<volume>13</volume>: <fpage>e1005852</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005852</pub-id><?supplied-pmid 29140991?><pub-id pub-id-type="pmid">29140991</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Fang</surname><given-names>H</given-names></name>, <name><surname>Huang</surname><given-names>C</given-names></name>, <name><surname>Zhao</surname><given-names>H</given-names></name>, <name><surname>Deng</surname><given-names>M</given-names></name>. <article-title>gCoda: Conditional Dependence Network Inference for Compositional Data</article-title>. <source>J Comput Biol</source>. <year>2017</year>;<volume>24</volume>: <fpage>699</fpage>–<lpage>708</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1089/cmb.2017.0054</pub-id><?supplied-pmid 28489411?><pub-id pub-id-type="pmid">28489411</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Raymond</surname><given-names>F</given-names></name>, <name><surname>Ouameur</surname><given-names>AA</given-names></name>, <name><surname>Déraspe</surname><given-names>M</given-names></name>, <name><surname>Iqbal</surname><given-names>N</given-names></name>, <name><surname>Gingras</surname><given-names>H</given-names></name>, <name><surname>Dridi</surname><given-names>B</given-names></name>, <etal>et al</etal>. <article-title>The initial state of the human gut microbiome determines its reshaping by antibiotics</article-title>. <source>ISME J</source>. <year>2016</year>;<volume>10</volume>: <fpage>707</fpage>–<lpage>720</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ismej.2015.148</pub-id><?supplied-pmid 26359913?><pub-id pub-id-type="pmid">26359913</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Emiola</surname><given-names>A</given-names></name>, <name><surname>Oh</surname><given-names>J</given-names></name>. <article-title>High throughput in situ metagenomic measurement of bacterial replication at ultra-low sequencing coverage.</article-title><source>Nat Commun</source>. <year>2018</year>;<volume>9</volume>: <fpage>4956</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-018-07240-8</pub-id><?supplied-pmid 30470746?><pub-id pub-id-type="pmid">30470746</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Hong</surname><given-names>C</given-names></name>, <name><surname>Manimaran</surname><given-names>S</given-names></name>, <name><surname>Shen</surname><given-names>Y</given-names></name>, <name><surname>Perez-Rogers</surname><given-names>JF</given-names></name>, <name><surname>Byrd</surname><given-names>AL</given-names></name>, <name><surname>Castro-Nallar</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>PathoScope 2.0: a complete computational framework for strain identification in environmental or clinical sequencing samples.</article-title><source>Microbiome</source>. <year>2014</year>;<volume>2</volume>: <fpage>33</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/2049-2618-2-33</pub-id><?supplied-pmid 25225611?><pub-id pub-id-type="pmid">25225611</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Tsuji</surname><given-names>H</given-names></name>, <name><surname>Matsuda</surname><given-names>K</given-names></name>, <name><surname>Nomoto</surname><given-names>K</given-names></name>. <article-title>Counting the Countless: Bacterial Quantification by Targeting rRNA Molecules to Explore the Human Gut Microbiota in Health and Disease.</article-title><source>Front Microbiol</source>. <year>2018</year>;<volume>9</volume>: <fpage>1417</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fmicb.2018.01417</pub-id><?supplied-pmid 30008707?><pub-id pub-id-type="pmid">30008707</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Hopkins</surname><given-names>MJ</given-names></name>, <name><surname>Macfarlane</surname><given-names>GT</given-names></name>, <name><surname>Furrie</surname><given-names>E</given-names></name>, <name><surname>Fite</surname><given-names>A</given-names></name>, <name><surname>Macfarlane</surname><given-names>S</given-names></name>. <article-title>Characterisation of intestinal bacteria in infant stools using real-time PCR and northern hybridisation analyses</article-title>. <source>FEMS Microbiol Ecol</source>. <year>2005</year>;<volume>54</volume>: <fpage>77</fpage>–<lpage>85</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.femsec.2005.03.001</pub-id><?supplied-pmid 16329974?><pub-id pub-id-type="pmid">16329974</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Adamberg</surname><given-names>K</given-names></name>, <name><surname>Jaagura</surname><given-names>M</given-names></name>, <name><surname>Aaspõllu</surname><given-names>A</given-names></name>, <name><surname>Nurk</surname><given-names>E</given-names></name>, <name><surname>Adamberg</surname><given-names>S</given-names></name>. <article-title>The composition of faecal microbiota is related to the amount and variety of dietary fibres</article-title>. <source>Int J Food Sci Nutr</source>. <year>2020</year>;<volume>71</volume>: <fpage>845</fpage>–<lpage>855</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/09637486.2020.1727864</pub-id><?supplied-pmid 32083496?><pub-id pub-id-type="pmid">32083496</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>GD</given-names></name>, <name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Hoffmann</surname><given-names>C</given-names></name>, <name><surname>Bittinger</surname><given-names>K</given-names></name>, <name><surname>Chen</surname><given-names>YY</given-names></name>, <name><surname>Keilbaugh</surname><given-names>SA</given-names></name>, <etal>et al</etal>. <article-title>Linking long-term dietary patterns with gut microbial enterotypes</article-title>. <source>Science (80-).</source><year>2011</year>;<volume>334</volume>: <fpage>105</fpage>–<lpage>108</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1208344</pub-id><?supplied-pmid 21885731?><pub-id pub-id-type="pmid">21885731</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009343.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Bashan</surname><given-names>A</given-names></name>, <name><surname>Gibson</surname><given-names>TE</given-names></name>, <name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Carey</surname><given-names>VJ</given-names></name>, <name><surname>Weiss</surname><given-names>ST</given-names></name>, <name><surname>Hohmann</surname><given-names>EL</given-names></name>, <etal>et al</etal>. <article-title>Universality of human microbial dynamics</article-title>. <source>Nature</source>. <year>2016</year>;<volume>534</volume>: <fpage>259</fpage>–<lpage>262</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature18301</pub-id><?supplied-pmid 27279224?><pub-id pub-id-type="pmid">27279224</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009343.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009343.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Papin</surname>
          <given-names>Jason A.</given-names>
        </name>
        <role>Editor-in-Chief</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Segata</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Papin, Segata</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Papin, Segata</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009343" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">10 May 2021</named-content>
    </p>
    <p>Dear Dr. Nagarajan,</p>
    <p>Thank you very much for submitting your manuscript "BEEM-Static: Accurate inference of ecological interactions from cross-sectional metagenomic data" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Nicola Segata</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Jason Papin</p>
    <p>Editor-in-Chief</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Li et al. developed a tool called "BEEM-Static" to infer microbial interactions from cross-sectional metagenomic data. These interactions are inferred using a generalized Lotka-Volterra model (gLVM). The authors highlight that in contrast to correlation-based methods BEEM-Static is able to infer directionality in addition to presence of the interactions. Further, they provide estimates of the sample biomass. They benchmarked their algorithm against 10 correlation-based methods using simulated datasets, simple pairwise experimental co-culture data and a large cross-sectional metagenomic dataset. BEEM-Static was robust to violations of model assumptions (equilibrium states and model differences) in these tests. While their method is interesting and the benchmarking results show improvements over other tools, I have several concerns:</p>
    <p>Major concerns</p>
    <p>• What is the main difference to the original BEEM algorithm? The filter functions? Please add more details on that to the introduction.</p>
    <p>• Further details about model training should be provided. For example, additional figures showing how well the model converged by the end of training.</p>
    <p>• The parameter inference method used in the paper is a coordinate descent algorithm, a general form of EM-algorithm. For the EM algorithm, it is necessary to write the log-likelihood function and formulate the E-step and M-step in this framework. That way, the M-step is maximizing the lower bound of the log-likelihood function which is an essential guarantee for the model to converge. In the general coordinate descent, it is necessary to prove that the function is bounded in order to show that the algorithm will converge. This is missing currently.</p>
    <p>• In the large-scale metagenomic dataset, only 42 species passed the filtering. This number is very small for human gut microbial communities and a large fraction of the microbial community is not considered in many samples. I would suggest the authors provide a barplot showing the fraction of considered microbes in each sample.</p>
    <p>• The authors didn't report how many samples are found invalid in the large-scale metagenomic dataset. They showed that the model still works well when up to 40% of samples are at non-equilibrium. Without the number of how many samples are predicted as "invalid" in the metagenomic dataset, it is uncertain if this criteria is met for the large metagenomic dataset.</p>
    <p>• I would recommend a graphical overview of BEEM-static as one of the first figures, including input, output and potential conclusions that can be inferred from the results.</p>
    <p>• I’m curious what the rationale is behind the biomass estimation. Why should it be possible to infer biomass based on relative abundances?</p>
    <p>• Last paragraph of results section: Why do you point out fibre might play a role here? Without the context from the cohort, this seems a bit random. Please describe the real world datasets you used briefly (Healty cohort? Disease?) and why fibre is relevant.</p>
    <p>• Why did you expect that enterotypes play a role in this or are affected by interactions?</p>
    <p>Minor concerns:</p>
    <p>• I don’t see why their approach is only applicable to metagenomic data. The abundance profiles from 16S data should work equally well.</p>
    <p>• It would be interesting to verify the model's prediction on the equilibrium state of the metagenomic samples from the other time points. Does the next timepoint deviate from the current one? Does the second time point of the samples predicted as invalid deviate more than those predicted as valid? That would provide further confidence for the model's performance.</p>
    <p>• Given a model, there will be multiple equilibrium states (the eigenvectors of the state matrix). It would be interesting to show how these equilibrium states are distributed in the large cohort.</p>
    <p>• Some terms should be defined in the introduction, such as equilibrium. Examples for bacterial interactions of the different types would be helpful too (pos-pos, neg-neg, pos-neg).</p>
    <p>• p. 15 (on my version): Define the abbreviation for the species involved in the interaction (DP, FP, ...).</p>
    <p>• Fig 1C: Explain in the legend what those numbers in connection with the interactions mean.</p>
    <p>• Fig 3C: The axis relative to the origin would make more sense to me. Also, I’m curious why the first PC explains so much variance? How were the clusters computed?</p>
    <p>Reviewer #2: This manuscript introduces a new bioinformatics algorithm,</p>
    <p>"BEEM-Static", to infer ecological interactions from cross-sectional</p>
    <p>metagenomic data. The work is motivated by the current needs in</p>
    <p>obtaining deeper ecological understanding of the systems underlying</p>
    <p>observation in microbiome research in general, and in microbial</p>
    <p>metagenomics in particular. Currently popular methods for</p>
    <p>computational inference of microbial interactions are based on</p>
    <p>observed co-abundance patterns but often lacking ecological</p>
    <p>insight. This paper aims to demonstrate that ecological structure can</p>
    <p>be recovered from cross-sectional metagenomic data. The method is an</p>
    <p>EM algorithm (BEEM-Static) that utilizes a standard ecological (gLV)</p>
    <p>interaction model. Application requires sample filtering but this is</p>
    <p>justified based on the modeling assumptions: in particular, the</p>
    <p>authors show that gLV parameters can estimated directly from</p>
    <p>cross-sectional data, when it is being assumed that 1) the system is</p>
    <p>close to equilibrium, and 2) absolute abundances are known. This has</p>
    <p>considerable practical value because it helps to obtain ecologically</p>
    <p>relevant insights from dynamical systems in a setting where the lack</p>
    <p>of long and dense time series has so far limited the</p>
    <p>investigations. Comparison with relevant alternatives demonstrates</p>
    <p>remarkable improvements in the ability to detect interaction and its</p>
    <p>directionality reliably (based on AUC/ROC scores). It is also shown</p>
    <p>that the method is relatively robust to outliers and deviations from</p>
    <p>stationarity or model assumptions, so that the first assumption seems</p>
    <p>feasible. The second assumption is not generally available but the</p>
    <p>authors propose a way to estimate this computationally, and advances</p>
    <p>in measurement techniques may improve this further over time; the main</p>
    <p>contribution in this work is the method itself. An interesting</p>
    <p>demonstration of the model performance is provided by analysing</p>
    <p>community stability in a well-known public human gut microbiome data</p>
    <p>set, and the proposed model is potentially applicable to studying key</p>
    <p>aspects of community dynamics across a vast spectrum of microbiome</p>
    <p>data sets, and the results can be experimentally testable in many</p>
    <p>cases if suitable experimental time series can be collected.</p>
    <p>The manuscript is technically sound and written in a fluent and easily</p>
    <p>understandable English. Experiments and statistical analyses have been</p>
    <p>conducted rigorously and the conclusions are supported by the</p>
    <p>data. Relevant literature is cited, and the relevant recent methods</p>
    <p>have been included in the comparisons.</p>
    <p>All data and code are fully available but I have not tried to</p>
    <p>replicated the analysis. The associated R package seems good quality</p>
    <p>and implemented according to prevailing standards for R package</p>
    <p>development.</p>
    <p>I only have the following minor notes:</p>
    <p>* Minor</p>
    <p>- The ecological models do not correspond to previously reported</p>
    <p>enterotypes (in particular Fig S6). However, enterotypes - as</p>
    <p>visualized on 2D PCoA space - are very broad community-level</p>
    <p>clusters. It is possible that there are more refined subcommunities</p>
    <p>that would be better visible on further PCoA dimensions or in a</p>
    <p>focused subcommunity analysis and these might correspond better with</p>
    <p>the previously reported enterotypes that are said to be driven by</p>
    <p>specific bacterial groups. It would be informative to include some</p>
    <p>more discussion on the possible connections. In particular,</p>
    <p>Prevotella has been shown to have bimodal/bistable abundance</p>
    <p>distribution at the population level, and if the BEEM-Static model</p>
    <p>does not match this finding, this would be somewhat unexpected and</p>
    <p>potentially indicate problems in the BEEM-Static model.</p>
    <p>- The method is promoted as a new method for metagenomic data; but it</p>
    <p>seems to me that this applies more generally to ecological community</p>
    <p>profiling data, including 16S and potentially not even limited to</p>
    <p>microbial ecological communities. Some discussion on the wider scope</p>
    <p>might be warranted.</p>
    <p>- The model is applied for core species that are abundant and</p>
    <p>prevalent; applicability to lower abundance and rare groups is a</p>
    <p>possible limitation and could be more clearly stated in Discussion.</p>
    <p>- It would be informative and helpful to show how the term in M-step</p>
    <p>inside the median (a / \\Sigma bx) can be derived for estimating</p>
    <p>absolute abundances.</p>
    <p>- The "EM framework" is not exactly the classical EM algorithm</p>
    <p>although very close conceptually; reconsider naming e.g. "iterative</p>
    <p>EM-type framework" or otherwise acknowledging the difference.</p>
    <p>- The bullet point list in 2.7 might be better written out as text or</p>
    <p>incorporated as a table?</p>
    <p>- principle component analysis (common misspelling) -&gt; should be:</p>
    <p>principal component analysis; same for principal coordinate analysis</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: <bold>Yes: </bold>Leo Lahti</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1009343.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009343.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009343" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">19 Jul 2021</named-content>
    </p>
    <supplementary-material id="pcbi.1009343.s010" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response letter.pdf</named-content></p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009343.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1009343.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009343.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Papin</surname>
          <given-names>Jason A.</given-names>
        </name>
        <role>Editor-in-Chief</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Segata</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Papin, Segata</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Papin, Segata</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009343" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">11 Aug 2021</named-content>
    </p>
    <p>Dear Dr. Nagarajan,</p>
    <p>We are pleased to inform you that your manuscript 'BEEM-Static: Accurate inference of ecological interactions from cross-sectional microbiome data' has been provisionally accepted for publication in PLOS Computational Biology. There are a couple of minor points still highlighted by one of the reviewer, but I trust you will address them in the final version of the manuscript.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Nicola Segata</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Jason Papin</p>
    <p>Editor-in-Chief</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed my concerns and I have no further comments.</p>
    <p>Reviewer #2: The manuscript has improved, and the responses are adequate.</p>
    <p>The remaining comments:</p>
    <p>- In review responses the authors cite the Remien et al. preprint (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.biorxiv.org/content/10.1101/463372v1.full" ext-link-type="uri">https://www.biorxiv.org/content/10.1101/463372v1.full</ext-link>) discussing the estimation of absolute abundances; in fact Remien et al. show the expected result that absolute abundances cannot be fully identified from compositional data. This is in contrast with the approach in BEEM-Static, which provides an estimate of absolute abundances based on compositional data. The authors have mentioned, however, that this is only an approximation. It is important to make sure that the inability to fully estimate absolute abundances from compositional data are mentioned clearly when discussing the limitations of the method. Better estimates may become available as absolute quantification methods are developing, further increasing the potential value of this method. therefore I do not consider the inaccessibility of absolute estimates a major limitation in this case.</p>
    <p>- Text is understandable but I suggest to pay attention to final proof-reading and figure quality</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: <bold>Yes: </bold>Leo Lahti</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1009343.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009343.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Papin</surname>
          <given-names>Jason A.</given-names>
        </name>
        <role>Editor-in-Chief</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Segata</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Papin, Segata</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Papin, Segata</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1009343" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">1 Sep 2021</named-content>
    </p>
    <p>PCOMPBIOL-D-21-00585R1 </p>
    <p>BEEM-Static: Accurate inference of ecological interactions from cross-sectional microbiome data</p>
    <p>Dear Dr Nagarajan,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Andrea Szabo</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
