<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_XPRO100875 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEgr8 jpg ?>
<?FILEgr9 jpg ?>
<?FILEgr10 jpg ?>
<?FILEgr11 jpg ?>
<?FILEgr12 jpg ?>
<?FILEgr13 jpg ?>
<?FILEgr14 jpg ?>
<?FILEfx1 jpg ?>
<?FILEfx2 jpg ?>
<?FILEfx3 jpg ?>
<?FILEfx4 jpg ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">STAR Protoc</journal-id>
    <journal-id journal-id-type="iso-abbrev">STAR Protoc</journal-id>
    <journal-title-group>
      <journal-title>STAR Protocols</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2666-1667</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8551247</article-id>
    <article-id pub-id-type="pii">S2666-1667(21)00581-5</article-id>
    <article-id pub-id-type="doi">10.1016/j.xpro.2021.100875</article-id>
    <article-id pub-id-type="publisher-id">100875</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Protocol</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RHybridFinder: An R package to process immunopeptidomic data for putative hybrid peptide discovery</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Saab</surname>
          <given-names>Frederic</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="fn1" ref-type="fn">5</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Hamelin</surname>
          <given-names>David J.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Ma</surname>
          <given-names>Qing</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">4</xref>
      </contrib>
      <contrib contrib-type="author" id="au4">
        <name>
          <surname>Kovalchik</surname>
          <given-names>Kevin A.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au5">
        <name>
          <surname>Sirois</surname>
          <given-names>Isabelle</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au6">
        <name>
          <surname>Faridi</surname>
          <given-names>Pouya</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au7">
        <name>
          <surname>Li</surname>
          <given-names>Chen</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au8">
        <name>
          <surname>Purcell</surname>
          <given-names>Anthony W.</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au9">
        <name>
          <surname>Kubiniok</surname>
          <given-names>Peter</given-names>
        </name>
        <email>peterkubiniok@gmail.com</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="fn1" ref-type="fn">5</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <contrib contrib-type="author" id="au10">
        <name>
          <surname>Caron</surname>
          <given-names>Etienne</given-names>
        </name>
        <email>etienne.caron@umontreal.ca</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="aff3" ref-type="aff">3</xref>
        <xref rid="fn2" ref-type="fn">6</xref>
        <xref rid="cor2" ref-type="corresp">∗∗</xref>
      </contrib>
      <aff id="aff1"><label>1</label>CHU Sainte-Justine Research Center, Montreal, QC H3T 1C5, Canada</aff>
      <aff id="aff2"><label>2</label>Infection and Immunity Program and Department of Biochemistry and Molecular Biology, Biomedicine Discovery Institute, Monash University, Clayton, VIC 3800, Australia</aff>
      <aff id="aff3"><label>3</label>Department of Pathology and Cellular Biology, Faculty of Medicine, Université de Montréal, Montreal, QC H3T 1J4, Canada</aff>
      <aff id="aff4"><label>4</label>School of Electrical Engineering and Computer Science, Faculty of Engineering, University of Ottawa, Ottawa, ON K1N 6N5, Canada</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>peterkubiniok@gmail.com</email></corresp>
      <corresp id="cor2"><label>∗∗</label>Corresponding author <email>etienne.caron@umontreal.ca</email></corresp>
      <fn id="fn1">
        <label>5</label>
        <p id="ntpara0010">Technical contact</p>
      </fn>
      <fn id="fn2">
        <label>6</label>
        <p id="ntpara0015">Lead contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>17</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <volume>2</volume>
    <issue>4</issue>
    <elocation-id>100875</elocation-id>
    <permissions>
      <copyright-statement>Crown Copyright © 2021.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder/>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>Identification of proteasomal spliced peptides (PSPs) by mass spectrometry (MS) is not possible with traditional search engines. Here, we provide a protocol for running RHybridFinder (RHF), an R package for the computational inference of putative PSPs detected by MS. RHF extracts high confidence scored de novo sequenced peptides identified by PEAKS software. Those peptides are then matched to protein databases to infer cis- or trans-spliced major histocompatibility complex (MHC)-associated peptides. RHF is relatively fast and straightforward. PSPs have to be validated experimentally.</p>
      <p>For complete details on the use and execution of the original protocol, please refer to <xref rid="bib5" ref-type="bibr">Faridi et al. (2018)</xref>.</p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical abstract</title>
      <fig id="undfig1" position="anchor">
        <graphic xlink:href="fx1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">RHybridFinder (RHF) is an improved R package for the discovery of spliced peptides</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">RHF builds upon the algorithm published in <xref rid="bib5" ref-type="bibr">Faridi et al. (2018)</xref></p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">RHF uses MS data analyzed in PEAKS</p>
          </list-item>
          <list-item id="u0025">
            <label>•</label>
            <p id="p0025">The spliced peptide candidates generated by RHF need to be validated experimentally</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0025">
      <p>Identification of proteasomal spliced peptides (PSPs) by mass spectrometry (MS) is not possible with traditional search engines. Here, we provide a protocol for running RHybridFinder (RHF), an R package for the computational inference of putative PSPs detected by MS. RHF extracts high confidence scored de novo sequenced peptides identified by PEAKS software. Those peptides are then matched to protein databases to infer cis- or trans-spliced MHC-associated peptides. RHF is relatively fast and straightforward. PSPs have to be validated experimentally.</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Subject areas</title>
      <kwd>Bioinformatics</kwd>
      <kwd>Cancer</kwd>
      <kwd>Computer sciences</kwd>
      <kwd>Immunology</kwd>
      <kwd>Mass Spectrometry</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Before you begin</title>
    <p id="p0035">The proteasome is recognized as the core enzymatic machinery of the antigen processing and presentation pathway wherein peptides derived from proteasomal proteolysis are selectively presented on the cell surface by MHC (major histocompatibility complex)-I molecules (<xref rid="bib14" ref-type="bibr">Neefjes et al., 2011</xref>). In 2004, Hanada et al. discovered that the proteasome could cleave and splice peptide fragments to generate immunogenic epitopes presented by MHC class I molecules (<xref rid="bib6" ref-type="bibr">Hanada et al., 2004</xref>). Following this groundbreaking discovery, other research groups have been able to uncover additional T cell spliced epitopes generated by the proteosome, referred in this protocol as proteasomal spliced peptides (PSPs) (<xref rid="bib1" ref-type="bibr">Berkers et al., 2015</xref>; <xref rid="bib3" ref-type="bibr">Dalet et al., 2011</xref>; <xref rid="bib4" ref-type="bibr">Ebstein et al., 2016</xref>; <xref rid="bib12" ref-type="bibr">Michaux et al., 2014</xref>; <xref rid="bib18" ref-type="bibr">Vigneron et al., 2004</xref>).</p>
    <p id="p0040">More recently, MS-based immunopeptidomics has been used to expedite the identification of PSPs in a systematic manner, including cis- and trans-spliced peptides (<xref rid="bib1" ref-type="bibr">Berkers et al., 2015</xref>; <xref rid="bib5" ref-type="bibr">Faridi et al., 2018</xref>; <xref rid="bib9" ref-type="bibr">Liepe et al., 2010</xref>, <xref rid="bib10" ref-type="bibr">2016</xref>; <xref rid="bib16" ref-type="bibr">Rolfs et al., 2019</xref>; <xref rid="bib17" ref-type="bibr">Specht et al., 2020</xref>). However, MS-based studies using different computational approaches have led to a debate around the proportion of those PSPs in the MHC class I immunopeptidome (<xref rid="bib8" ref-type="bibr">Lichti, 2021</xref>; <xref rid="bib13" ref-type="bibr">Mylonas et al., 2018</xref>; <xref rid="bib19" ref-type="bibr">Wilhelm et al., 2021</xref>).</p>
    <p id="p0045">Here, we provide a protocol to run RHybridFinder (RHF), an open access and improved R package built upon the computational workflow developed by <xref rid="bib5" ref-type="bibr">Faridi et al. (2018)</xref> for the analysis of MS data to systematically identify putative PSPs (<xref rid="bib5" ref-type="bibr">Faridi et al., 2018</xref>). High speed performance is the main strength of RHF in addition to be relatively straightforward to run. The main limitation is that the PSPs identified by RHF may not be genuily spliced by the proteasome in vivo. Their source and presentation should therefore be validated experimentally to move the debate forward (<xref rid="fig1" ref-type="fig">Figure 1</xref>).<fig id="fig1"><label>Figure 1</label><caption><p>Overview of suggested workflow for the discovery of PSPs</p><p>We propose a four-step workflow for the identification of PSPs. The first three steps (blue squares: sample preparation, MS data acquisition and RHbridFinder enable computational exploration of putative PSPs followed by experimental validations (green square). A non-exhaustive list of possible experiments is shown for validating/gaining confidence in the identification of MHC-I peptides that are genuinely catalyzed by proteasomal splicing.</p></caption><graphic xlink:href="gr1"/></fig><fig id="fig2"><label>Figure 2</label><caption><p>Recommended folder structure</p><p>The parent folder includes two child folders. The child folders include the various files that are necessary for running RHybridFinder. The dotted line (second_run) indicates that the DB search psm.csv file is added after the second DB search.</p></caption><graphic xlink:href="gr2"/></fig></p>
    <p id="p0050">RHybridFinder is available on CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=RHybridFinder" id="intref0015">https://cran.r-project.org/package=RHybridFinder</ext-link>) to enable more researchers to explore those debated peptides.</p>
    <sec id="sec1.1">
      <title>Data collection</title>
      <p id="p0055">For demonstration of the output of the different RHybridFinder functions, we have used datasets from the HLA Ligand Atlas (<xref rid="bib11" ref-type="bibr">Marcu et al., 2021</xref>) deposited in PRIDE (Proteomics IDentification Database) <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/pride/archive/projects/PXD019643" id="intref0020">PXD019643</ext-link>.<list list-type="simple" id="olist0010"><list-item id="o0010"><label>1.</label><p id="p0060">Download the following mzML files and analyzed them in PEAKS:</p><p id="p0065">171002_AM_AUT01-DN17_Liver_W6-32_10%_DDA_3_400-650mz_msms4, 171002_AM_AUT01-DN17_Liver_W6-32_10%_DDA_3_400-650mz_msms5, 171002_AM_AUT01-DN17_Liver_W6-32_10%_DDA_3_400-650mz_msms6.</p></list-item><list-item id="o0015"><label>2.</label><p id="p0070">Analyze these files in PEAKS.</p></list-item></list></p>
    </sec>
    <sec id="sec1.2">
      <title>Installing Rstudio/R</title>
      <p id="p0075">RHybridFinder package has been developed in RStudio and implemented in R programming language.<list list-type="simple" id="olist0015"><list-item id="o0020"><label>3.</label><p id="p0080">Download &amp; install Rstudio if not already installed: (<ext-link ext-link-type="uri" xlink:href="https://www.rstudio.com/products/rstudio/download/" id="intref0025">https://www.rstudio.com/products/rstudio/download/</ext-link>).</p></list-item></list></p>
    </sec>
    <sec id="sec1.3">
      <title>Installing and loading RHybridFinder</title>
      <p id="p0085">Below are the lines needed to install the RHybridFinder package from CRAN (the Comprehensive R Archive Network) and then load it.<list list-type="simple" id="olist0020"><list-item id="o0025"><label>4.</label><p id="p0090">Install and load RHybridFinder by typing “install.packages(“RHybridFinder”) in the R console.</p></list-item></list><boxed-text id="dtbox1"><p id="p0095">&gt; install.packages(“RHybridFinder“)</p></boxed-text><list list-type="simple" id="olist0025"><list-item id="o0030"><label>5.</label><p id="p0100">Load RHybridFinder by typing “library(RHybridFinder)” in the R console</p></list-item></list><boxed-text id="dtbox2"><p id="p0105">&gt; library(RHybridFinder)</p></boxed-text><disp-quote><p><inline-graphic xlink:href="fx2.gif"/><bold>CRITICAL:</bold> if you copy the lines of code from here, keep in mind that you might have to re-write the quotation marks yourself.</p></disp-quote></p>
    </sec>
  </sec>
  <sec id="sec8">
    <title>Key resources table</title>
    <p id="p0480">
      <table-wrap position="float" id="undtbl1">
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th>REAGENT or RESOURCE</th>
              <th>SOURCE</th>
              <th>IDENTIFIER</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="3">
                <bold>Deposited data</bold>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td>Human liver sample from autologous donor 17 - HLA Ligand Atlas</td>
              <td>(<xref rid="bib11" ref-type="bibr">Marcu et al., 2021</xref>)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/pride/archive/projects/PXD019643" id="intref0045">PXD019643</ext-link>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <bold>Software and algorithms</bold>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td>RStudio (version 1.3.1093)</td>
              <td>RStudio website <ext-link ext-link-type="uri" xlink:href="https://www.rstudio.com/" id="intref0050">https://www.rstudio.com</ext-link></td>
              <td>SCR_000432</td>
            </tr>
            <tr>
              <td>R (&gt;3.5.0)</td>
              <td>R statistical software (<ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/" id="intref0055">https://www.r-project.org/</ext-link>)</td>
              <td>SCR_001905</td>
            </tr>
            <tr>
              <td>PEAKS (PEAKS X studio)</td>
              <td>PEAKS website: <ext-link ext-link-type="uri" xlink:href="https://www.bioinfor.com//" id="intref0060">https://www.bioinfor.com//</ext-link></td>
              <td>N/A</td>
            </tr>
            <tr>
              <td>RHybridFinder (v.0.2.0)</td>
              <td>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/RHybridFinder/index.html" id="intref3410">https://cran.r-project.org/web/packages/RHybridFinder/index.html</ext-link>
              </td>
              <td>N/A</td>
            </tr>
            <tr>
              <td>seqinr (v. 4.2-5)</td>
              <td>CRAN - (<xref rid="bib2" ref-type="bibr">Charif and Lobry, 2007</xref>)</td>
              <td>N/A</td>
            </tr>
            <tr>
              <td>foreach (v.1.5.1), doParallel (v. 1.0.16)</td>
              <td>CRAN</td>
              <td>N/A</td>
            </tr>
            <tr>
              <td>netMHCpan (v. 4.0 &amp;4.1)</td>
              <td>DTU health tech: <ext-link ext-link-type="uri" xlink:href="https://services.healthtech.dtu.dk/" id="intref0070">https://services.healthtech.dtu.dk</ext-link> (<xref rid="bib15" ref-type="bibr">Reynisson et al., 2020</xref>)</td>
              <td>SCR_018182</td>
            </tr>
            <tr>
              <td>hybrid finder</td>
              <td><xref rid="bib5" ref-type="bibr">Faridi et al. (2018)</xref> (workflow on which the package is based)</td>
              <td>N/A</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </p>
  </sec>
  <sec id="sec2">
    <title>Step-by-step method details</title>
    <sec id="sec2.1">
      <title>Step 1: Load inputs into R</title>
      <p id="p0110">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx3.gif"/>
            <bold>Timing: 1 min</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0115">Before running HybridFinder, the inputs need to be loaded into R. We propose the following way of loading the files into R in order to facilitate the process <xref rid="fig2" ref-type="fig">Figure 2</xref>.<list list-type="simple" id="olist0030"><list-item id="o0035"><label>1.</label><p id="p0120">Create an object (folder_Exp1) for the path to the parent folder (Mel_Exp1) (but both can be named otherwise).</p></list-item></list><boxed-text id="dtbox3"><p id="p0125">&gt; folder_Exp1 &lt;- file.path(“/Users/YOURUSERNAME/Desktop/Mel_Exp1”)</p></boxed-text><list list-type="simple" id="olist0035"><list-item id="o0040"><label>2.</label><p id="p0130">Import the <italic>de novo</italic> sequencing as well as the database results, both of which are located in the first_run child folder.<list list-type="simple" id="olist0040"><list-item id="o0045"><label>a.</label><p id="p0135"><italic>de novo</italic> sequencing results file<boxed-text id="dtbox4"><p id="p0140">&gt; denovo_Exp1 &lt;- read.csv(file = file.path(folder_Exp1, “first_run”, "all_denovo_candidates.csv"), header=TRUE, sep=",", stringsAsFactors = FALSE)</p></boxed-text></p></list-item><list-item id="o0050"><label>b.</label><p id="p0150">database search results file</p></list-item></list></p></list-item></list><boxed-text id="dtbox6"><p id="p0155">&gt; db_search_Exp1&lt;- read.csv (file=file.path(folder_Exp1, “first_run”,“DB seach psm.csv”), header=TRUE, sep=“,”, stringsAsFactors=FALSE)</p></boxed-text><list list-type="simple" id="olist0045"><list-item id="o0055"><label>3.</label><p id="p0160">Create an object for the path to the proteome file, located in the parent folder (folder_Exp1) (see refproteome_Exp1, in the example below). The fasta proteome will be imported in R during the HybridFinder function.</p></list-item></list><boxed-text id="dtbox7"><p id="p0165">&gt; refproteome_Exp1 &lt;- file.path(folder_Exp1, “uniprothuman-20379entries-Nov2019_validated.fasta”)</p></boxed-text><disp-quote><p><inline-graphic xlink:href="fx2.gif"/><bold>CRITICAL:</bold> Please note that if you copy the file access path (in windows), you will need to switch the backslash (“\”) to a normal slash ( “/”).</p></disp-quote></p>
      <sec id="sec2.1.1">
        <title>
          <bold>Access the datasets included in the R package</bold>
        </title>
        <p id="p0170">The RHybridFinder package also includes demonstration datasets from the HLA Ligand Atlas that have already been analyzed in PEAKS. These datasets include PEAKS de novo sequencing results and PEAKS database search results.<boxed-text id="dtbox8"><p id="p0175"># access denovo dataset</p><p id="p0180">&gt; data(package= “RHybridFinder”, “denovo_Human_Liver_AUTD17”)</p><p id="p0185"># access database search dataset</p><p id="p0190">&gt; data(package=”RHybridFinder”, “db_Human_Liver_AUTD17”)</p></boxed-text><disp-quote><p><bold><italic>Note:</italic></bold> that due to size constraints the proteome database (.fasta) file is not included in the package. It can be downloaded from the <ext-link ext-link-type="uri" xlink:href="https://www.uniprot.org/proteomes/UP000005640" id="intref0030">Uniprot database</ext-link>.</p></disp-quote><disp-quote><p><bold><italic>Note:</italic></bold> In the environment tab, the denovo_Human_Liver_AUTD17 and db_Human_Liver_AUTD17 should appear. Note that if you see &lt;promise&gt;, after clicking on the objects, the data would appear.</p></disp-quote></p>
      </sec>
    </sec>
    <sec id="sec2.2">
      <title>Step 2: Run HybridFinder</title>
      <p id="p0195">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx3.gif"/>
            <bold>Timing: 2–5 min (with parallelism, 8 cores) - 10–15 min (without parallelism)</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0200">In order to have a relatively short runtime, we have implemented an option to use parallel computing. However, please note that because parallel computing requires a certain amount of processing units for proper functioning, it has been made possible to also run HybridFinder without parallel computing.</p>
      <p id="p0205">Based on default parameters in the HybridFinder function, the “all de novo candidates.csv” file contains 16,286 peptide sequences and the runtime (parallelism with 8 cores) is of 2 min 17 s ∼5 min are required for double the number of peptides. Without parallelism, the runtime ranged between 10 and 15 min for 16,286 peptide sequences.<list list-type="simple" id="olist0050"><list-item id="o0060"><label>4.</label><p id="p0210">Run Hybridfinder (Please refer to <xref rid="tbl1" ref-type="table">Table 1</xref> in order to know more about the inputs needed) and export the results in the parent folder.<table-wrap position="float" id="tbl1"><label>Table 1</label><caption><p>HybridFinder function parameters</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>Description</th><th>Default value</th></tr></thead><tbody><tr><td>de novo_candidates</td><td>the dataframe containing the <italic>de novo</italic> sequencing results</td><td>No defaults. Necessary input.</td></tr><tr><td>db_search</td><td>the data frame containing the database search results</td><td>No defaults. Necessary input.</td></tr><tr><td>db_search</td><td>the data frame containing the database search results</td><td>No defaults. Necessary input.</td></tr><tr><td>proteome_db</td><td>the file path to the proteome used for the database search</td><td>No defaults. Necessary input.</td></tr><tr><td>(Optional) customALCcutoff</td><td>A custom score cutoff that can be set by the user as long as it would be at least 85</td><td>NULL. (ALC cutoff calculated automatically as median of matching peptide sequences of assigned spectra). If set manually, minimum is 85.</td></tr><tr><td>with_parallel : boolean (True or False)</td><td>representing whether parallel computing should be employed for running the function.</td><td>TRUE</td></tr><tr><td>(Optional) customCores</td><td>If with_parallel is set to TRUE and the PC has &gt;5 cores, the user can set a custom amount of cores to be used by the function.</td><td>6</td></tr><tr><td>(Optional) export_files : boolean (True or False)</td><td>by default it is set to False, however, if set to True, then the following input is essential.</td><td>FALSE</td></tr><tr><td>(Optional) export_dir</td><td>file path to the directory where the output files should be stored. This parameter is necessary for the export.</td><td>NULL</td></tr></tbody></table></table-wrap></p></list-item></list><boxed-text id="dtbox9"><p id="p0215">&gt; HybridFinder_results_Exp1&lt;- HybridFinder(denovo_candidates = denovo_Exp1, db_search = db_search_Exp1, proteome_db = refproteome_Exp1,customALCcutoff = NULL, with_parallel=TRUE, customCores = 8, export_files= TRUE, export_dir = folder_Exp1)</p></boxed-text><disp-quote><p><inline-graphic xlink:href="fx2.gif"/><bold>CRITICAL:</bold> if you use the datasets included in the package, please note that they are named differently so for instance the “denovo_candidates” and “db_search” parameters should be set to the datasets loaded from the package: denovo_Human_Liver_AUTD17 and db_Human_Liver_AUTD17, respectively.</p></disp-quote><disp-quote><p><inline-graphic xlink:href="fx2.gif"/><bold>CRITICAL:</bold> Make sure to store the HybridFinder results in an object (i.e HybridFinder_results_Exp1), as the HybridFinder output dataframe will come in handy in the second function.</p></disp-quote><disp-quote><p><bold><italic>Note:</italic></bold> At the end of the hybrid proteome will be the concatenated hybrid fake proteins with the name pattern ‘sp|denovo_HF_fake_protein_[#]’.</p></disp-quote><disp-quote><p><bold><italic>Note:</italic></bold> with_parallel is activated if set to true and if the PC has more than 5 cores.</p></disp-quote><disp-quote><p><inline-graphic xlink:href="fx2.gif"/><bold>CRITICAL:</bold> Please ensure to have a minimal number of other windows open and to save any work in other softwares prior to using HybridFinder with parallelism.</p></disp-quote></p>
      <p id="p0220">The function will output a list (<xref rid="fig3" ref-type="fig">Figure 3</xref>) containing: (1) the HybridFinder output containing all the denovo peptides along with their potential splice type explanation cis-/trans-, (2) a list of the step1 hybrid candidate peptides, (3) the hybrid proteome (merged proteome: the original user proteome along with the hybrid proteome composed of the concatenated candidate hybrid peptide sequences).<disp-quote><p><bold><italic>Note:</italic></bold> In the example above, export_files have been set to TRUE and the export_dir has been defined which means that the files are also automatically exported. If these two parameters were not specified or were set to FALSE &amp; NULL, the results are only stored in the Exp1_HybridFinder_results. In this case, you can still use “export_HybridFinder_results” as in the code below, where HybridFinder_results_Exp1 is the object created above for the storage of HybridFinder results.</p></disp-quote><boxed-text id="dtbox10"><p id="p0225">&gt; export_HybridFinder_results(HybridFinder_results_Exp1, export_dir= folder_Exp1)</p></boxed-text><disp-quote><p><inline-graphic xlink:href="fx4.gif"/><bold>Pause point:</bold> If you would like to conduct the rest of the protocol at a later time, either use the export functionality and then load the HybridFinder output in order to use it for the second step. Alternatively, save the objects in R in a .rda file as follows and once you want to use it again for the step 4, load checknetMHCpan inputs into R.</p></disp-quote><boxed-text id="dtbox11"><p id="p0230">&gt; save (HybridFinder_results_Exp1, file=file.path(folder_Exp1, ”HybridFinder_results_Exp1.rda”)</p><p id="p0235">&gt;load (file.path(folder_Exp1, ”HybridFinder_results_Exp1.rda”))</p></boxed-text><fig id="fig3"><label>Figure 3</label><caption><p>Screenshot of the HybridFinder function results</p><p>In the results list you will find 3 items: 1) a dataframe containing the HybridFinder output. 2) a character vector containing the candidate spliced peptides. 3) a list which is in a seqinr class (<xref rid="bib2" ref-type="bibr">Charif and Lobry, 2007</xref>) containing the merged hybrid proteome.</p></caption><graphic xlink:href="gr3"/></fig></p>
    </sec>
    <sec id="sec2.3">
      <title>Step 3: Database search using hybrid Fasta</title>
      <p id="p0240">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx3.gif"/>
            <bold>Timing: 1 h</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0245">An essential interim step must follow the HybridFinder function and consists of running a database search in PEAKS with the merged proteome. Importantly, now that a merged hybrid proteome has been obtained from the HybridFinder function, it can be used to obtain potential PSPs whose quality is comparable with all other database search peptides while filtering all peptides at the same FDR (False Discovery Rate) cutoff which can be adjusted by the users in PEAKS. In the original workflow by <xref rid="bib5" ref-type="bibr">Faridi et al. (2018)</xref>, the database search peptides in both runs were filtered in PEAKS at a 1% FDR.<list list-type="simple" id="olist0055"><list-item id="o0065"><label>5.</label><p id="p0250">Perform a database search in PEAKS using the original raw MS file (while using the same settings as in the beginning) however, this time while using the merged hybrid proteome (.fasta) file generated with the HybridFinder function.</p></list-item></list></p>
    </sec>
    <sec id="sec2.4">
      <title>Step 4: Load checknetMHCpan inputs into R</title>
      <p id="p0255">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx3.gif"/>
            <bold>Timing: 1 min</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0260">Prior to running checknetMHCpan, please ensure that netMHCpan (versions 4.0 or 4.1) is installed. checknetMHCpan is the last step of the hybrid finder workflow, the function uses the database search results from the second PEAKS analysis and provides the binding affinity results of all the peptides along with their categorizations.<list list-type="simple" id="olist0060"><list-item id="o0070"><label>6.</label><p id="p0265">Create an object for the location of the netMHCpan executable</p></list-item></list><boxed-text id="dtbox12"><p id="p0270">&gt; netmhcpan_dir &lt;- file.path(“/usr/local/bin”)</p></boxed-text><list list-type="simple" id="olist0065"><list-item id="o0075"><label>7.</label><p id="p0275">Create an object (vector) for storing the HLA-I alleles that you would like to have binding affinity predictions for.</p></list-item></list><boxed-text id="dtbox13"><p id="p0280">&gt; alleles_Exp1 &lt;- c(“HLA-A∗02:01”, “HLA-A∗03:01”, “HLA-B∗07:02”)</p></boxed-text><list list-type="simple" id="olist0070"><list-item id="o0080"><label>8.</label><p id="p0285">Retrieve the HybridFinder output from the HybridFinder function results</p></list-item></list><boxed-text id="dtbox14"><p id="p0290">&gt; HF_output_Exp1 &lt;- HybridFinder_results_Exp1[[1]]</p></boxed-text><list list-type="simple" id="olist0075"><list-item id="o0085"><label>9.</label><p id="p0295">Import the database search results (from step 3: Database search using hybrid fasta)</p></list-item></list><boxed-text id="dtbox15"><p id="p0300">&gt; rerun_db_search_Exp1 &lt;- read.csv(file.path(folder_Exp1, “second_run”, “DB search psm.csv”), sep=“,”, head = TRUE, stringsAsFactors = FALSE)</p></boxed-text><disp-quote><p><bold><italic>Note:</italic></bold> in case your computer’s OS is “Windows” (netMHCpan is not compatible with Windows) the web version of netMHCpan (<ext-link ext-link-type="uri" xlink:href="http://www.cbs.dtu.dk/services/NetMHCpan-4.1/instructions.php" id="intref0035">http://www.cbs.dtu.dk/services/NetMHCpan-4.1/instructions.php</ext-link>) would come in handy. In this case, we propose to use a separate function from this package instead (step2_wo_netmhcpan) which outputs a netMHCpan-ready input of sequences in .pep format.</p></disp-quote></p>
      <sec id="sec2.4.1">
        <title>
          <bold>Access the datasets included in the R package</bold>
        </title>
        <p id="p0305">The demonstration datasets from the HLA Ligand Atlas included in this package also include datasets for the checknetMHCpan/step2_wo_netMHCpan functions. After having run the HybridFinder function and stored the results in HyrbidFinder_results_Exp1, PEAKS was run using the merged hybrid proteome. Below is a way to retrieve the second PEAKS run dataset included in the package:<boxed-text id="dtbox16"><p id="p0310">&gt; data(package= “RHybridFinder”, “db_rerun_Human_Liver_AUTD17”)</p></boxed-text><disp-quote><p><bold><italic>Note:</italic></bold> The merged proteome used for the second database search is based on the customALCcutoff being set to NULL (default parameter value).</p></disp-quote><disp-quote><p><inline-graphic xlink:href="fx2.gif"/><bold>CRITICAL:</bold> The merged proteome database would change between different samples, and if the customALCcutoff parameter is changed. The same merged hybrid proteome cannot be used for separate analyses.</p></disp-quote></p>
      </sec>
    </sec>
    <sec id="sec2.5">
      <title>Step 5: Run checknetMHCpan</title>
      <p id="p0315">
        <disp-quote>
          <p>
            <inline-graphic xlink:href="fx3.gif"/>
            <bold>Timing: ∼ 1 min</bold>
          </p>
        </disp-quote>
      </p>
      <p id="p0320">The checknetMHCpan function embodies the second major step of the workflow. The categorizations of the hybrid peptides from the HybridFinder output are retrieved for matched peptides found in the second PEAKS database results. Then, peptide-MHC class I binding predictions for the entire database search results (for peptides between 9 and 12 amino acids) are computed using netMHCpan and are tidied in order to summarize the results.<list list-type="simple" id="olist0080"><list-item id="o0090"><label>10.</label><p id="p0325">Run checknetMHCpan using the code below (Please refer to <xref rid="tbl2" ref-type="table">Table 2</xref> in order to know more about the inputs needed) and export the results in the same folder:<table-wrap position="float" id="tbl2"><label>Table 2</label><caption><p>checknetMHCpan function parameters</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>Description</th><th>Default value</th></tr></thead><tbody><tr><td>netmhcpan_directory</td><td>the directory where netMHCpan is installed (i.e., ‘/usr/bin’ or ‘/usr/local/bin’, depending on where you have it installed)</td><td>No defaults. Necessary input.</td></tr><tr><td>netmhcpan_alleles</td><td>a vector composed of the alleles the peptides will be tested against.</td><td>No defaults. Necessary input.</td></tr><tr><td>peptide_rerun</td><td>the database search results from the second peaks run</td><td>No defaults. Necessary input.</td></tr><tr><td>HF_step1_output</td><td>the data frame from the HybridFinder function of the containing the spliced peptide potential explanations as well as RT, m/z, ALC, Scan &amp; Fraction</td><td>No defaults. Necessary input.</td></tr><tr><td>(Optional) export_files : boolean (True or False)</td><td>by default it is set to False, however, if set to True, then the following input is essential.</td><td>FALSE</td></tr><tr><td>(Optional) export_dir</td><td>file path to the directory where the output files should be stored. This parameter is necessary for the export.</td><td>NULL</td></tr></tbody></table></table-wrap></p></list-item></list><boxed-text id="dtbox17"><p id="p0330">&gt; checknetMHCpan_results_Exp1 &lt;- checknetMHCpan(netmhcpan_directory = netmhcpan_dir, netmhcpan_alleles = alleles_Exp1, peptide_rerun = rerun_db_search_Exp1, HF_step1_output = HF_output_Exp1, export_files= TRUE, export_dir = folder_Exp1)</p></boxed-text><disp-quote><p><bold><italic>Note:</italic></bold> checknetMHCpan is compatible with the exports from both netMHCpan 4.0 &amp; netMHCpan 4.1.</p></disp-quote><disp-quote><p><inline-graphic xlink:href="fx2.gif"/><bold>CRITICAL:</bold> if you use the datasets included in the package, please note that they are named differently so for instance the “peptide_rerun” parameter should be set to dataset loaded from the package db_rerun_Human_Liver_AUTD17.</p></disp-quote></p>
      <p id="p0335">After running the code above, a results list should be returned (<xref rid="fig4" ref-type="fig">Figure 4</xref>).<fig id="fig4"><label>Figure 4</label><caption><p>Screenshot of the checknetMHCpan results list</p><p>In the results list you will find 3 items: 1) a dataframe containing the netMHCpan results. 2) a dataframe containing the tidied netMHCpan results. 3) the database search results with the “Potential_spliceType” for the hybrid peptides retrieved from step1.</p></caption><graphic xlink:href="gr4"/></fig></p>
      <p id="p0340">These results are also exportable with the export_checknetMHCpan_results function.<boxed-text id="dtbox18"><p id="p0345">&gt; export_checknetMHCpan_results(step2_RHF_results_Exp1 , export_dir = folder_Exp1)</p></boxed-text><disp-quote><p><bold><italic>Note:</italic></bold> If you intend on using the web version of netMHCpan (especially useful for windows OS users) or another software for peptide binding affinity, the step2_wo_netMHCpan function does the same as checknetMHCpan but without running netMHCpan. The function should return a list (<xref rid="fig5" ref-type="fig">Figure 5</xref>) containing the updated database search results as well as a list of the peptides which can be used as input in the web version of netMHCpan.</p></disp-quote></p>
      <p id="p0350">
        <fig id="fig5">
          <label>Figure 5</label>
          <caption>
            <p>Screenshot of the step2_wo_netMHCpan results list</p>
            <p>In the results list you will find 2 items: 1) a character vector containing the netMHCpan-ready input. 2) the database search results with the “Potential_spliceType” for the hybrid peptides retrieved from step1.</p>
          </caption>
          <graphic xlink:href="gr5"/>
        </fig>
      </p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Expected outcomes</title>
    <sec id="sec3.1">
      <title>HybridFinder</title>
      <p id="p0355">The HybridFinder function follows the same rationale as indicated in <xref rid="bib5" ref-type="bibr">Faridi et al. (2018)</xref>. After high-confidence <italic>de novo</italic> peptides are extracted, these are searched sequentially for an exact hit, followed by a search of pair fragments within one protein and then within two proteins (<xref rid="fig6" ref-type="fig">Figure 6</xref>). Finally, the sequences of all hybrid peptides are concatenated to create fake proteins, which are added at the bottom of the proteome database in order to constitute a merged hybrid proteome.<fig id="fig6"><label>Figure 6</label><caption><p>HybridFinder function</p><p>HybridFinder extracts high confidence <italic>de novo</italic> peptides by using a ALC cutoff based on the median ALC of common spectrum groups &amp; sequence of peptides between the <italic>de novo</italic> and the database search. The ALC cutoff is used to filter unassigned <italic>de novo</italic> spectrum groups in order to obtain high confidence <italic>de novo</italic> spectra. All sequences are then searched in the proteome for the entire sequence, those that match are filtered and considered “Linear”, the remainder of the peptide spectrum groups are “cut” in order to create peptide fragment combinations. These are then searched in the proteome for whether fragment combinations exist within a same protein, matches are considered as cis-spliced and further filtered. Finally, fragment combinations are created from those that didn’t match in the previous step and are searched whether they exist in two proteins. If there is a match, these are considered as trans-spliced peptides. The remaining uncategorized spectrum groups are considered not to have a biological explanation (NBE) and are therefore discarded.</p></caption><graphic xlink:href="gr6"/></fig></p>
      <p id="p0360">Typically, when the HybridFinder function is run, 3 messages are printed representing each major stage of the algorithm and finally ‘Done!’ is printed once the processing is finished. The function returns a list containing 3 items: the HybridFinder output (<xref rid="fig7" ref-type="fig">Figure 7</xref>) where the predicted splice type is displayed, a character vector containing only the list of hybrid candidates (<xref rid="fig8" ref-type="fig">Figure 8</xref>) and finally the merged hybrid proteome (<xref rid="fig9" ref-type="fig">Figure 9</xref>) where the hybrid peptide candidates have been concatenated as fake proteins.<fig id="fig7"><label>Figure 7</label><caption><p>Screenshot of the HybridFinder output dataframe</p><p>(5 rows), The <italic>Fraction</italic> column represents the LC-MS run, the <italic>Scan</italic> column is a number representing a unique index for the tandem mass spectra (F[Fraction#]:Scan#), <italic>m/z</italic> is the precursor mass-to-charge ratio, <italic>RT</italic> is the Retention Time (elution time) for the spectrum, <italic>Peptide</italic> corresponds to the peptide sequences. The <italic>Length</italic> column represents the number of amino acids for a given peptide, <italic>ALC</italic> (Average Local Confidence), is a score calculated in PEAKS as the total of the residue local confidence scores in the peptide divided by the peptide length. These columns are not provided by the HybridFinder function, they are columns found in any PEAKS <italic>de novo</italic> sequencing export. For more information, please visit the PEAKS user manual. The <italic>Potential_spliceType</italic> corresponds to the resulting categorization from the HybridFinder function. Finally, the <italic>proteome_database_used</italic> is the filename of the fasta proteome provided by the user (this column is mainly for helping the user keep track of the proteome used) in the HybridFinder function.</p></caption><graphic xlink:href="gr7"/></fig><fig id="fig8"><label>Figure 8</label><caption><p>Screenshot of the HybridFinder hybrid peptide candidates vector (5 rows)</p></caption><graphic xlink:href="gr8"/></fig><fig id="fig9"><label>Figure 9</label><caption><p>Screenshot of the bottom of the HybridFinder merged hybrid proteome (5 proteins)</p></caption><graphic xlink:href="gr9"/></fig></p>
      <p id="p0365">The results might differ if the customALCcutoff score parameter is changed. If the results are exported, these are stored in a folder as .csv files and the merged proteome database is saved as .fasta file. The peptide sequences predicted as spliced are considered as preliminary candidates. Performing the rest of the steps is essential in order to obtain the final list.</p>
    </sec>
    <sec id="sec3.2">
      <title>checknetMHCpan and step2_wo_netMHCpan</title>
      <p id="p0370">The checknetMHCpan &amp; step2_wo_netMHCpan functions represent the last step in <xref rid="bib5" ref-type="bibr">Faridi et al.’s (2018)</xref> workflow. After a database search is performed using the merged hybrid proteome in step 1, these two functions can be used. Both of these functions retrieve the potential splice type categorization established in step 1. However, with checknetMHCpan the user can directly obtain MHC-I binding affinity predictions computed for all peptides between 9 and 12 amino acids using netMHCpan (<xref rid="bib7" ref-type="bibr">Jurtz et al., 2017</xref>; <xref rid="bib15" ref-type="bibr">Reynisson et al., 2020</xref>).</p>
      <p id="p0375">The checknetMHCpan function returns two formats of the netMHCpan results and the updated database search results from the second run with the potential splice type. The first format of the netMHCpan represents the results as they are (<xref rid="fig10" ref-type="fig">Figure 10</xref>). The second format is a tidied version of the netMHCpan results (<xref rid="fig11" ref-type="fig">Figure 11</xref>), where the rows are summarized into different columns, to allow quick analysis of the netMHCpan results (especially when more than one HLA-I allele is used); in these columns are summed the number of HLA-I alleles that a given peptide is a strong or weak binder to as well as the corresponding alleles. Finally, the database search results dataframe (from the second PEAKS run) updated with the potential splice type determined in the HybridFinder function for each peptide (<xref rid="fig12" ref-type="fig">Figure 12</xref>). Additionally, any sequence not identified in the HybridFinder output and solely attributed to the fake proteins created is removed. If exported, these are stored in a folder containing 2 .csv files and a .tsv (tab-separated values) corresponding to these different outputs.<fig id="fig10"><label>Figure 10</label><caption><p>Screenshot of the checknetMHCpan netMHCpan results</p><p>(5 rows) <italic>HLA/MHC</italic> is the allele, <italic>Peptide</italic> is the amino acid sequence of the potential ligand, <italic>Core</italic> is the minimal 9 amino acid sequence core to enable HLA binding, <italic>Of</italic> is the starting position of the Core within the peptide, <italic>Gp</italic> and <italic>Gl</italic> are the position and the length of the deletions (respectively), if any. <italic>Ip</italic> and <italic>Il</italic> are the position and the length of the insertions (respectively), if any. <italic>Icore</italic> is the interaction core<italic>, Identity</italic> is PEPLIST (which indicates that peptides were used as input as opposed to proteins in fasta-format). <italic>Score</italic> is the raw prediction, <italic>Aff(nM)</italic> is the predicted IC50 value in nanoMolar units, <italic>%Rank</italic> is the percentile rank of the predicted affinity compared to a set of random natural ligands. <italic>BindLevel</italic> is designated by 3 qualifiers: Strong binder, Weak binder, None binder. <italic>Potential_spliceType</italic> is the categorization retrieved from the HybridFinder output on the potential splice type explanation of the peptide (i.e., linear, cis, trans).</p></caption><graphic xlink:href="gr10"/></fig><fig id="fig11"><label>Figure 11</label><caption><p>Screenshot of the checknetMHCpan tidied netMHCpan results</p><p>(5 rows) <italic>Peptide</italic> is the amino acid sequence of the potential ligand, the <italic>strongBinder, weakBinder, noneBinder</italic> (this column not shown in this figure) columns correspond to the alleles to which a given peptide is a strong/weak/none binder to, respectively. If more than one allele, these are separated by commas. For each peptide, there will be %Rank columns per allele (e.g., If 3 alleles were specified in the checknetMHCpan command, then each peptide will have 3%Rank columns). <italic>strongBinder_count, weakBinder_count, noneBinder_count</italic> represent the number of alleles to which a peptide is a strong/weak/none binder to. Lastly, the <italic>Potential_spliceType</italic> column is the categorization retrieved from the HybridFinder output on the potential splice type explanation of the peptide (i.e., linear, cis, trans).</p></caption><graphic xlink:href="gr11"/></fig><fig id="fig12"><label>Figure 12</label><caption><p>Screenshot of the checknetMHCpan database search results updated with the Potential_spliceType column</p><p>(5 rows) <italic>Peptide</italic> is the amino acid sequence of the potential ligand, <italic>X.log10P</italic> represents the best -10logP identification score for the corresponding peptide. <italic>Mass</italic> represents the monoisotopic mass of the peptide, <italic>Length</italic> is the number of amino acid residues that constitute the given peptide, <italic>ppm</italic> is the precursor mass error, the <italic>m.z</italic> is the precursor mass-to-charge ratio, <italic>Z</italic> is the precursor charge, <italic>RT</italic> is the Retention Time (elution time) for the spectrum, <italic>Area</italic> represents the area underthe curve of the peptide feature found at the same m/z and retention time as the MS/MS scan, <italic>Fraction</italic> is the LC-MS run, <italic>id</italic> represents the precursor ID associated with the PSM, <italic>Scan</italic> is a number representing a unique index for tandem mass spectra (F[Fraction#]:Scan#), <italic>from.Chimera</italic> (this column is not shown in this figure) displays whether the identified peptide is from chimeric spectra, <italic>Source.File</italic> is the mzML/mzXML file used in the PEAKS analysis, <italic>PTM</italic> is the type of the post-translational modification, <italic>Ascore</italic> is the localization score assigned to modifications on the peptide, <italic>Found.By</italic> represents the analysis (in this case PEAKS DB). <italic>Peptide_no_mods</italic> represents the peptide sequence without modifications, <italic>Potential_spliceType</italic> is linear, cis or trans and is retrieved from the HybridFinder function.</p></caption><graphic xlink:href="gr12"/></fig></p>
      <p id="p0380">The step2_wo_netMHCpan is the equivalent of checknetMHCpan with the exception of computing binding affinity. The function returns a netMHCpan-ready list of peptides (<xref rid="fig13" ref-type="fig">Figure 13</xref>), as well as the updated the database search results (<xref rid="fig14" ref-type="fig">Figure 14</xref>). If exported, the results are exported into a folder containing a .pep file and a .csv file.<fig id="fig13"><label>Figure 13</label><caption><p>Screenshot of the step2_wo_netMHCpan netMHCpan-ready input (5 rows)</p></caption><graphic xlink:href="gr13"/></fig><fig id="fig14"><label>Figure 14</label><caption><p>Screenshot of the checknetMHCpan database search results updated with the Potential_spliceType column</p><p>(5 rows) The dataframe contains the same columns as in <xref rid="fig13" ref-type="fig">Figure 13</xref></p></caption><graphic xlink:href="gr14"/></fig></p>
      <p id="p0385">After running checknetMHCpan or step2_wo_netMHCpan the final list of hybrid candidate peptides should be explored for further experimental validation (<xref rid="fig1" ref-type="fig">Figure 1</xref>).</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>Limitations</title>
    <p id="p0390">The presented package was developed and optimized for exports from PEAKS software. Therefore, results from other search engines or <italic>de novo</italic> sequencing softwares might not work while using this package. Limitations related to the workflow include the possible introduction of bias towards having results containing a higher proportion of Leucine residues. This is due to the workaround proposed by <xref rid="bib5" ref-type="bibr">Faridi et al. (2018)</xref> which is also used in this package, entailing a switch of all Isoleucines to Leucines in the database search and the proteome since <italic>de novo</italic> sequencing does not differentiate between Isoleucine and leucine. As mentioned above, it is also important to emphasize that this protocol does not enable the direct identification of high-confidence PSPs that are genuinely spliced by the proteasome in vivo. However, this protocol enables the computational identification of putative PSPs, which should then be validated experimentally in a rigorous manner as shown in <xref rid="fig1" ref-type="fig">Figure 1</xref>.</p>
  </sec>
  <sec id="sec5">
    <title>Troubleshooting</title>
    <sec id="sec5.1">
      <title>Problem 1</title>
      <p id="p0395">While installing the .tar.gz file for the package, in case you run into the following error: ”Error in install.packages : type == ”both” cannot be used with ’repos = NULL’”</p>
    </sec>
    <sec id="sec5.2">
      <title>Potential solution</title>
      <p id="p0400">The solution would be to simply invoke the install.packages function while specifying where the package is located, setting the repository (repos) to NULL and setting the type as source (source package).<boxed-text id="dtbox19"><p id="p0405">&gt; install.packages("∼/Downloads/RHybridFinder_0.1.0.tar", repos = NULL, Type="source")</p></boxed-text></p>
    </sec>
    <sec id="sec5.3">
      <title>Problem 2</title>
      <p id="p0410">While running HybridFinder, in case you run into the following error: ”Error in prepare_input_for_HF(de novo_candidates, db_search): Please make sure you have the right input. N.B: The <italic>de novo</italic> results data frame should be the first input”</p>
    </sec>
    <sec id="sec5.4">
      <title>Potential solution</title>
      <p id="p0415">Verify the <italic>de novo</italic> data frame has been correctly imported. Since the <italic>de novo</italic> results file is in .csv format, the separator should be a comma “,”, stringsAsFactors should be set to FALSE and lastly the header should be set to TRUE. Please refer to step1: Loading inputs into R.</p>
      <p id="p0420">Verify that the HybridFinder parameters are properly typed. The <italic>de novo</italic> sequencing results data frame is indicated first and then the database search results. Alternatively, write the parameters and assigned them their appropriate objects (i.e., de novo_candidates = de novo_results_human_liver_Exp1). Please refer to step2: Run HybridFinder.</p>
    </sec>
    <sec id="sec5.5">
      <title>Problem 3</title>
      <p id="p0425">While running HybridFinder, in case you run into the following error: ”Error in $&lt;-.dataframe`(`∗tmp`, “db_id”, value = character ( 0 ) ) : replacement has 0 rows, data has[…]”</p>
    </sec>
    <sec id="sec5.6">
      <title>Potential solution</title>
      <p id="p0430">Verify the database search data frame, make sure it has been correctly imported. Since the database search results file is in .csv format the separator should be a comma “,”, stringsAsFactors should be set to FALSE and lastly the header should be set to TRUE. Please refer to step1: Loading inputs into R.</p>
    </sec>
    <sec id="sec5.7">
      <title>Problem 4</title>
      <p id="p0435">While running checknetMHCpan, if the following error is displayed: ”Error in checknetMHCpan[…]:Please provide the proper input”</p>
    </sec>
    <sec id="sec5.8">
      <title>Potential solution</title>
      <p id="p0440">Verify that the <italic>de novo</italic> and database search data frames are not switched. Please refer to step 5: Run checknetMHCpan.</p>
    </sec>
    <sec id="sec5.9">
      <title>Problem 5</title>
      <p id="p0445">While running checknetMHCpan, if the following error is displayed: ”Please check the input alleles: […]”</p>
    </sec>
    <sec id="sec5.10">
      <title>Potential solution</title>
      <p id="p0450">Ensure that the alleles are in the right format, or that the allele is written correctly (i.e., HLA-A03<bold>:</bold>01, HLA-A∗03:01). Please refer to step 4: Load checknetMHCpan inputs into R.</p>
    </sec>
    <sec id="sec5.11">
      <title>Problem 6</title>
      <p id="p0455">While running checknetMHCpan, if the path to netMHCpan is not correct, the following error might appear: sh: 1: [/temporary directory/netMHCpan]: not found error in running command</p>
    </sec>
    <sec id="sec5.12">
      <title>Potential solution</title>
      <p id="p0460">The issue could either be that the directory does not contains the netMHCpan file or that the directory was not well written I.e(‘usr/bin/' vs. ‘/usr/bin’ or ‘/usr/bin/, where the first example is wrong and the other two are correct). Please refer to step 4: Load checknetMHCpan inputs into R</p>
    </sec>
  </sec>
  <sec id="sec6">
    <title>Resource availability</title>
    <sec id="sec6.1">
      <title>Lead contact</title>
      <p id="p0465">Further information and requests for resources should be directed to and will be fulfilled by the lead contact, Etienne Caron <ext-link ext-link-type="uri" xlink:href="mailto:etienne.caron@umontreal.ca" id="intref0040">etienne.caron@umontreal.ca</ext-link>.</p>
    </sec>
    <sec id="sec6.2">
      <title>Materials availability</title>
      <p id="p0470">This study did not generate new unique reagents.</p>
    </sec>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Berkers</surname>
            <given-names>C.R.</given-names>
          </name>
          <name>
            <surname>Jong</surname>
            <given-names>A. de</given-names>
          </name>
          <name>
            <surname>Schuurman</surname>
            <given-names>K.G.</given-names>
          </name>
          <name>
            <surname>Linnemann</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Geenevasen</surname>
            <given-names>J.A.J.</given-names>
          </name>
          <name>
            <surname>Schumacher</surname>
            <given-names>T.N.M.</given-names>
          </name>
          <name>
            <surname>Rodenko</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Ovaa</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Peptide splicing in the proteasome creates a novel type of antigen with an isopeptide linkage</article-title>
        <source>J. Immunol.</source>
        <volume>195</volume>
        <year>2015</year>
        <fpage>4075</fpage>
        <lpage>4084</lpage>
        <pub-id pub-id-type="pmid">26401000</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <element-citation publication-type="book" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Charif</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Lobry</surname>
            <given-names>J.R.</given-names>
          </name>
        </person-group>
        <part-title>SeqinR 1.0-2: a contributed package to the R project for statistical computing devoted to biological sequences retrieval and analysis</part-title>
        <person-group person-group-type="editor">
          <name>
            <surname>Bastolla</surname>
            <given-names>Ugo</given-names>
          </name>
          <name>
            <surname>Porto</surname>
            <given-names>Markus</given-names>
          </name>
          <name>
            <surname>Roman</surname>
            <given-names>H. Eduardo</given-names>
          </name>
          <name>
            <surname>Vendruscolo</surname>
            <given-names>Michele</given-names>
          </name>
        </person-group>
        <source>Structural Approaches to Sequence Evolution, Molecules, Networks, Populations</source>
        <year>2007</year>
        <publisher-name>Springer Verlag)</publisher-name>
        <fpage>207</fpage>
        <lpage>232</lpage>
      </element-citation>
    </ref>
    <ref id="bib3">
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Dalet</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Robbins</surname>
            <given-names>P.F.</given-names>
          </name>
          <name>
            <surname>Stroobant</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Vigneron</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y.F.</given-names>
          </name>
          <name>
            <surname>El-Gamil</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hanada</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Eynde</surname>
            <given-names>B.J.V. den</given-names>
          </name>
        </person-group>
        <article-title>An antigenic peptide produced by reverse splicing and double asparagine deamidation</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <volume>108</volume>
        <year>2011</year>
        <fpage>E323</fpage>
        <lpage>E331</lpage>
        <pub-id pub-id-type="pmid">21670269</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Ebstein</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Textoris-Taube</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Golnik</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Vigneron</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Eynde</surname>
            <given-names>B.J.V. den</given-names>
          </name>
          <name>
            <surname>Schuler-Thurner</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Schadendorf</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Lorenz</surname>
            <given-names>F.K.M.</given-names>
          </name>
          <name>
            <surname>Uckert</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>Proteasomes generate spliced epitopes by two different mechanisms and as efficiently as non-spliced epitopes</article-title>
        <source>Sci. Rep.</source>
        <volume>6</volume>
        <year>2016</year>
        <fpage>24032</fpage>
        <pub-id pub-id-type="pmid">27049119</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Faridi</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Ramarathinam</surname>
            <given-names>S.H.</given-names>
          </name>
          <name>
            <surname>Vivian</surname>
            <given-names>J.P.</given-names>
          </name>
          <name>
            <surname>Illing</surname>
            <given-names>P.T.</given-names>
          </name>
          <name>
            <surname>Mifsud</surname>
            <given-names>N.A.</given-names>
          </name>
          <name>
            <surname>Ayala</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Gearing</surname>
            <given-names>L.J.</given-names>
          </name>
          <name>
            <surname>Hertzog</surname>
            <given-names>P.J.</given-names>
          </name>
        </person-group>
        <article-title>A subset of HLA-I peptides are not genomically templated: Evidence for cis- and trans-spliced peptide ligands</article-title>
        <source>Sci. Immunol.</source>
        <volume>3</volume>
        <year>2018</year>
        <fpage>eaar3947</fpage>
        <pub-id pub-id-type="pmid">30315122</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Hanada</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Yewdell</surname>
            <given-names>J.W.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J.C.</given-names>
          </name>
        </person-group>
        <article-title>Immune recognition of a human renal cancer antigen through post-translational protein splicing</article-title>
        <source>Nature</source>
        <volume>427</volume>
        <year>2004</year>
        <fpage>252</fpage>
        <lpage>256</lpage>
        <pub-id pub-id-type="pmid">14724640</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Jurtz</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Andreatta</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Marcatili</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>NetMHCpan-4.0: improved peptide–MHC class I interaction predictions integrating eluted ligand and peptide binding affinity data</article-title>
        <source>J. Immunol.</source>
        <volume>199</volume>
        <year>2017</year>
        <fpage>3360</fpage>
        <lpage>3368</lpage>
        <pub-id pub-id-type="pmid">28978689</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Lichti</surname>
            <given-names>C.F.</given-names>
          </name>
        </person-group>
        <article-title>Identification of spliced peptides in pancreatic islets uncovers errors leading to false assignments</article-title>
        <source>Proteomics</source>
        <volume>21</volume>
        <year>2021</year>
        <fpage>e2000176</fpage>
        <pub-id pub-id-type="pmid">33548107</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <name>
            <surname>Liepe</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Mishto</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Textoris-Taube</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Janek</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Henklein</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Kloetzel</surname>
            <given-names>P.M.</given-names>
          </name>
          <name>
            <surname>Zaikin</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>The 20S proteasome splicing activity discovered by SpliceMet</article-title>
        <source>Plos. Comput. Biol.</source>
        <volume>6</volume>
        <year>2010</year>
        <fpage>e1000830</fpage>
        <pub-id pub-id-type="pmid">20613855</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <element-citation publication-type="journal" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Liepe</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Marino</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Sidney</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Jeko</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bunting</surname>
            <given-names>D.E.</given-names>
          </name>
          <name>
            <surname>Sette</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kloetzel</surname>
            <given-names>P.M.</given-names>
          </name>
          <name>
            <surname>Stumpf</surname>
            <given-names>M.P.H.</given-names>
          </name>
          <name>
            <surname>Heck</surname>
            <given-names>A.J.R.</given-names>
          </name>
          <name>
            <surname>Mishto</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>A large fraction of HLA class I ligands are proteasome-generated spliced peptides</article-title>
        <source>Science</source>
        <volume>354</volume>
        <year>2016</year>
        <fpage>354</fpage>
        <lpage>358</lpage>
        <pub-id pub-id-type="pmid">27846572</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Marcu</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bichmann</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Kuchenbecker</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Kowalewski</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Freudenmann</surname>
            <given-names>L.K.</given-names>
          </name>
          <name>
            <surname>Backert</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Mühlenbruch</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Szolek</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lübke</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>HLA Ligand Atlas: a benign reference of HLA-presented peptides to improve T-cell-based cancer immunotherapy</article-title>
        <source>J. Immunother. Cancer</source>
        <volume>9</volume>
        <year>2021</year>
        <fpage>e002071</fpage>
        <pub-id pub-id-type="pmid">33858848</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <element-citation publication-type="journal" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>Michaux</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Larrieu</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Stroobant</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Fonteneau</surname>
            <given-names>J.-F.</given-names>
          </name>
          <name>
            <surname>Jotereau</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Eynde</surname>
            <given-names>B.J.V. den</given-names>
          </name>
          <name>
            <surname>Moreau-Aubry</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Vigneron</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>A spliced antigenic peptide comprising a single spliced amino acid is produced in the proteasome by reverse splicing of a longer peptide fragment followed by trimming</article-title>
        <source>J. Immunol.</source>
        <volume>192</volume>
        <year>2014</year>
        <fpage>1962</fpage>
        <lpage>1971</lpage>
        <pub-id pub-id-type="pmid">24453253</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <element-citation publication-type="journal" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Mylonas</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Beer</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Iseli</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Chong</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Pak</surname>
            <given-names>H.-S.</given-names>
          </name>
          <name>
            <surname>Gfeller</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Coukos</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Xenarios</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bassani-Sternberg</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Estimating the contribution of proteasomal spliced peptides to the HLA-I Ligandome</article-title>
        <source>Mol. Cell. Proteomics</source>
        <volume>17</volume>
        <year>2018</year>
        <fpage>2347</fpage>
        <lpage>2357</lpage>
        <pub-id pub-id-type="pmid">30171158</pub-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <element-citation publication-type="journal" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Neefjes</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Jongsma</surname>
            <given-names>M.L.M.</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Bakke</surname>
            <given-names>O.</given-names>
          </name>
        </person-group>
        <article-title>Towards a systems understanding of MHC class I and MHC class II antigen presentation</article-title>
        <source>Nat. Rev. Immunol.</source>
        <volume>11</volume>
        <year>2011</year>
        <fpage>823</fpage>
        <lpage>836</lpage>
        <pub-id pub-id-type="pmid">22076556</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <element-citation publication-type="journal" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Reynisson</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Alvarez</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>NetMHCpan-4.1 and NetMHCIIpan-4.0: improved predictions of MHC antigen presentation by concurrent motif deconvolution and integration of MS MHC eluted ligand data</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>48</volume>
        <year>2020</year>
        <fpage>W449</fpage>
        <lpage>W454</lpage>
        <pub-id pub-id-type="pmid">32406916</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <element-citation publication-type="journal" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Rolfs</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Shortreed</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>L.M.</given-names>
          </name>
          <name>
            <surname>Bassani-Sternberg</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Comment on “A subset of HLA-I peptides are not genomically templated: Evidence for cis- and trans-spliced peptide ligands</article-title>
        <source>Sci. Immunol.</source>
        <volume>4</volume>
        <year>2019</year>
        <fpage>eaaw1622</fpage>
        <pub-id pub-id-type="pmid">31420320</pub-id>
      </element-citation>
    </ref>
    <ref id="bib17">
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>Specht</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Roetschke</surname>
            <given-names>H.P.</given-names>
          </name>
          <name>
            <surname>Mansurkhodzhaev</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Henklein</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Textoris-Taube</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Urlaub</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Mishto</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Liepe</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Large database for the analysis and prediction of spliced and non-spliced peptide generation by proteasomes</article-title>
        <source>Sci. Data</source>
        <volume>7</volume>
        <year>2020</year>
        <fpage>146</fpage>
        <pub-id pub-id-type="pmid">32415162</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <element-citation publication-type="journal" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Vigneron</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Stroobant</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Chapiro</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Ooms</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Degiovanni</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Morel</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Bruggen</surname>
            <given-names>P. van der</given-names>
          </name>
          <name>
            <surname>Boon</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Eynde</surname>
            <given-names>B.J.V. den</given-names>
          </name>
        </person-group>
        <article-title>An antigenic peptide produced by peptide splicing in the proteasome</article-title>
        <source>Science</source>
        <volume>304</volume>
        <year>2004</year>
        <fpage>587</fpage>
        <lpage>590</lpage>
        <pub-id pub-id-type="pmid">15001714</pub-id>
      </element-citation>
    </ref>
    <ref id="bib19">
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>Wilhelm</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zolg</surname>
            <given-names>D.P.</given-names>
          </name>
          <name>
            <surname>Graber</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Gessulat</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Schnatbaum</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Schwencke-Westphal</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Seifert</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Krätzig</surname>
            <given-names>N. de A.</given-names>
          </name>
          <name>
            <surname>Zerweck</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Deep learning boosts sensitivity of mass spectrometry-based immunopeptidomics</article-title>
        <source>Nat. Commun.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>3346</fpage>
        <pub-id pub-id-type="pmid">34099720</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec sec-type="data-availability">
    <title>Data and code availability</title>
    <p id="p0030">The package is available on CRAN and includes data (PEAKS analyses) from HLA Ligand Atlas (<xref rid="bib11" ref-type="bibr">Marcu et al., 2021</xref>) deposited in PRIDE (Proteomics IDentification Database) <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/pride/archive/projects/PXD019643" id="intref0010">PXD019643</ext-link> (were analyzed in PEAKS and used in this protocol for demonstration purposes only).</p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p0485">This work was supported by funding from the <funding-source id="gs1">Funds de recherche du Québec - Santé</funding-source> (FRQS), the <funding-source id="gs2">Cole Foundation</funding-source>, <funding-source id="gs3"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100010779</institution-id><institution>CHU Sainte-Justine</institution></institution-wrap></funding-source> and the <funding-source id="gs4">Charles-Bruneau Foundations</funding-source>, <funding-source id="gs5"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100000196</institution-id><institution>Canada Foundation for Innovation</institution></institution-wrap></funding-source>, the <funding-source id="gs6"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100000038</institution-id><institution>National Sciences and Engineering Research Council</institution></institution-wrap></funding-source> (NSERC) (#RGPIN-2020-05232), and the Canadian Institutes of Health Research (CIHR) (#174924). K.A.K. is a recipient of IVADO’s postdoctoral scholarship (#3879287150). C.L. is currently supported by a <funding-source id="gs7"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100000925</institution-id><institution>National Health and Medicine Research Council</institution></institution-wrap></funding-source> (NHMRC) of Australia CJ Martin Early Career Research Fellowship (1143366). A.W.P. is supported by a <funding-source id="gs8"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100000925</institution-id><institution>NHMRC</institution></institution-wrap></funding-source> Principal Research fellowship (1137739). P.F. is supported by a <funding-source id="gs9"><institution-wrap><institution-id institution-id-type="doi">10.13039/100008018</institution-id><institution>Victorian Cancer Agency</institution></institution-wrap></funding-source> (Australia) Mid-Career Fellowship.</p>
    <sec id="sec9">
      <title>Author contributions</title>
      <p id="p0490">R code, conceptualization, and authorship, F.S. and P.K.; validation and conceptualization, Q.M., D.J.H., K.A.K., and I.S.; conceptualization and authors of the original workflow, P.F., C.L., and A.W.P.; conceptualization and authorship, E.C.</p>
    </sec>
    <sec sec-type="COI-statement" id="sec10">
      <title>Declaration of interests</title>
      <p id="p0495">The authors declare no competing interests.</p>
    </sec>
  </ack>
</back>
