<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10438955</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad103</article-id>
    <article-id pub-id-type="publisher-id">vbad103</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AliGater: a framework for the development of bioinformatic pipelines for large-scale, high-dimensional cytometry data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4257-7284</contrib-id>
        <name>
          <surname>Ekdahl</surname>
          <given-names>Ludvig</given-names>
        </name>
        <aff><institution>Lund Stem Cell Center, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Laboratory Medicine, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <xref rid="vbad103-cor1" ref-type="corresp"/>
        <!--ludvig.ekdahl@med.lu.se-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arrizabalaga</surname>
          <given-names>Antton Lamarca</given-names>
        </name>
        <aff><institution>Lund Stem Cell Center, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Laboratory Medicine, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ali</surname>
          <given-names>Zain</given-names>
        </name>
        <aff><institution>Lund Stem Cell Center, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Laboratory Medicine, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cafaro</surname>
          <given-names>Caterina</given-names>
        </name>
        <aff><institution>Lund Stem Cell Center, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Laboratory Medicine, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>de Lapuente Portilla</surname>
          <given-names>Aitzkoa Lopez</given-names>
        </name>
        <aff><institution>Lund Stem Cell Center, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Laboratory Medicine, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nilsson</surname>
          <given-names>Björn</given-names>
        </name>
        <aff><institution>Lund Stem Cell Center, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Laboratory Medicine, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Broad Institute</institution>, Cambridge, MA 02142, <country country="US">United States</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Bateman</surname>
          <given-names>Alex</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad103-cor1">Corresponding author. Department of Laboratory Medicine, Lund University, Lund 221 84, Sweden. E-mail: <email>ludvig.ekdahl@med.lu.se</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-04">
      <day>04</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad103</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>18</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad103.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>AliGater is an open-source framework to accelerate the development of bioinformatic pipelines for the analysis of large-scale, high-dimensional flow cytometry data. AliGater provides a Python package for automatic feature extraction workflows, as well as building blocks to construct analysis pipelines.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We illustrate the use of AliGater in a high-resolution flow cytometry-based genome-wide association study on 46 immune cell populations in 14 288 individuals.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Source code and documentation at <ext-link xlink:href="https://github.com/LudvigEk/aligater" ext-link-type="uri">https://github.com/LudvigEk/aligater</ext-link> and <ext-link xlink:href="https://aligater.readthedocs.io" ext-link-type="uri">https://aligater.readthedocs.io</ext-link></p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/100010663</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>CoG-770992</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Knut and Alice Wallenberg Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004063</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017.0436</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004359</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017-02023</award-id>
        <award-id>2018-00424</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Cancer Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002794</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017/265</award-id>
        <award-id>20.0694</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Children's Cancer Fund</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PR2018-0118</award-id>
        <award-id>TJ2017-0042</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Flow cytometry allows quantitative and qualitative analysis of thousands to millions of cells or microparticles. Newer generations of cytometers with high-throughput capacity and an expanded array of lasers and detectors have enabled the generation of rich, high-dimensional flow cytometry data sets (<xref rid="vbad103-B22" ref-type="bibr">Sahir <italic toggle="yes">et al.</italic> 2020</xref>). Such data sets often reach thousands of samples, hundreds of thousands to millions of data points (‘events’) per sample, and tens of fluorescence measurements per data point. For example, in genome-wide association studies (GWAS), high-throughput flow cytometry is being employed to identify DNA sequence variants that influence cellular traits (e.g. blood and immune cell levels or levels of expression of cellular marker molecules) (<xref rid="vbad103-B16" ref-type="bibr">Orrù <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="vbad103-B15" ref-type="bibr">2020, Patin <italic toggle="yes">et al.</italic> 2018</xref>). Another example is high-throughput flow cytometry-based drug screening (<xref rid="vbad103-B3" ref-type="bibr">Black <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="vbad103-B6" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2017</xref>).</p>
    <p>Performing complex gating of thousands of samples is time-consuming and sensitive to variation in how the operator gates the data (<xref rid="vbad103-B17" ref-type="bibr">Pachón <italic toggle="yes">et al.</italic> 2012</xref>).</p>
    <p>Commonly used analysis tools (<xref rid="vbad103-B2" ref-type="bibr">Becton &amp; Company, 2023</xref>; <xref rid="vbad103-B5" ref-type="bibr">de Novo Software, 2023</xref>) are designed for manual analysis of limited numbers of samples and are impractical for data sets with large amounts of samples with many events and complex gating strategies.</p>
    <p>In such situations, custom computational pipelines need to be developed to allow automated analysis (<xref rid="vbad103-B21" ref-type="bibr">Rahim <italic toggle="yes">et al.</italic> 2018</xref>). This not only reduces the gating workload but also eliminates any operator bias and enables rapid comparison of different gating strategies. A number of computational tools have been previously developed to address those issues. <xref rid="vbad103-B9" ref-type="bibr">Hahne <italic toggle="yes">et al.</italic> (2009)</xref> presented <italic toggle="yes">FlowCore</italic>, a foundational R/Bioconductor package that enabled high-throughput FCM gating with both traditional static gates as well as dynamic, data-driven gates. Later, <xref rid="vbad103-B7" ref-type="bibr">Finak <italic toggle="yes">et al.</italic> (2014)</xref> introduced <italic toggle="yes">OpenCyto</italic>, which re-implemented and extended the then-available Bioconductor flow cytometry packages (including <italic toggle="yes">FlowCore</italic>). <italic toggle="yes">OpenCyto</italic> focused on the automation of hierarchical gating strategies similar to those employed when performing gating manually. More recently, <xref rid="vbad103-B4" ref-type="bibr">Burton <italic toggle="yes">et al.</italic> (2021)</xref> and <xref rid="vbad103-B24" ref-type="bibr">White <italic toggle="yes">et al.</italic> (2021)</xref> have put forward powerful and feature-rich Python packages (<italic toggle="yes">CytoPy</italic> and <italic toggle="yes">FlowKit</italic>, respectively) that further expand the offer of computational FCM gating tools. <italic toggle="yes">CytoPy</italic> incorporates classes from the popular SciKit-Learn machine learning library (<xref rid="vbad103-B20" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>) and allows for batch effect corrections and high-dimensional clustering, while <italic toggle="yes">FlowKit</italic> offers a wide set of robust features, including partial compatibility with standardized file formats that define gating strategies and interactive visualizations. Beyond those, several additional software tools and packages have been published in recent years that offer some or all functionalities needed for complete flow cytometry analysis, including compensation, gating, visualization, and statistics (<xref rid="vbad103-B25" ref-type="bibr">Yurtsev <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="vbad103-B12" ref-type="bibr">Malek <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="vbad103-B10" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="vbad103-B14" ref-type="bibr">Opzoomer <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="vbad103-B1" ref-type="bibr">Ashhurst <italic toggle="yes">et al.</italic> 2022</xref>). Additionally, standalone tools for quality control and cleanup of FCM data have also been released (<xref rid="vbad103-B8" ref-type="bibr">Fletez-Brant <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="vbad103-B13" ref-type="bibr">Monaco <italic toggle="yes">et al.</italic> 2016</xref>).</p>
    <p>We developed an open-source computational framework (‘AliGater’) to accelerate the development of analysis pipelines for large-scale flow cytometry data sets. Similar to <italic toggle="yes">OpenCyto</italic>, AliGater has been developed primarily with hierarchical 1D- or 2D-based gating strategies in mind. This closely resembles how manual gating strategies are carried out and is in contrast with multi-dimensional or clustering-based approaches popular in automated flow cytometry gating. AliGater provides access to a number of static and dynamic gates that allow it to perform a thorough analysis of FCM data. Additionally, Aligater offers an integrated quality control functionality particularly useful for high-throughput projects. It is written in Python and Cython and supports multiprocessing to facilitate application to large sample sets once gating strategies have been designed. In all, AliGater provides an easily accessible foundation to build complex adaptive gating strategies similar to OpenCyto, FlowKit and CytoPy while also providing tools for quality control and scalability. It has been tested in projects with tens of thousands of samples (<xref rid="vbad103-B11" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic> 2021</xref>).</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>Recognizing that the analysis of flow cytometry data sets is focused on feature extraction, usually achieved by selecting (‘gating’) data points that satisfy certain criteria, we designed AliGater with the following main functionalities in mind. AliGater contains general methods to parse, gate, and visualize raw data from flow cytometry experiments, with low level parsing partly adapted from FlowCytometryTool (<xref rid="vbad103-B25" ref-type="bibr">Yurtsev <italic toggle="yes">et al.</italic> 2015</xref>). The core of AliGater functionality is in allowing for efficient plug-in custom pattern recognition solutions for automatic gating and, finally, general methods to support quality control.</p>
    <p>AliGater provides software functionality to parse large batches of flow cytometry data (.fcs) files, apply compensation matrices and visualize data as dot plots, including implementations of Bilog and Logicle scales (<xref rid="vbad103-B18" ref-type="bibr">Parks <italic toggle="yes">et al.</italic> 2006</xref>). To facilitate the creation of gating strategies, AliGater lets users mix, match and extend pattern recognition functions. AliGater not only provides a selection of basic pattern recognition primitives (e.g. thresholding, threshold selection functions, and various gating shapes) but also the use of pattern recognition functions from external libraries (e.g. SciPy; <xref rid="vbad103-B23" ref-type="bibr">Virtanen <italic toggle="yes">et al.</italic> 2020</xref>). During analysis, AliGater can also output compressed down-sampled images of gates, structured to be parsed by image segmentation methods and libraries such as SciKit-learn (<xref rid="vbad103-B20" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>) for quality control or machine learning.</p>
    <p>Structurally, AliGater provides a set of hierarchical objects to organize data on an experiment (AGExperiment), sample (AGSample), and individual gate (AGGate) level, while post-gating quality control is handled by an additional object (AGQC). The AGExperiment object handles the overall workflow, including file parsing, pre-gate processing (e.g. compensation and checking file content). Additionally, during analysis, AGExperiment is responsible for collecting and saving gating results across all samples (as text files and diagnostic images). The AGSample object is a container object for the input data and for collecting gating results belonging to an individual sample. End users write custom code to apply pattern recognition routines on AGSample objects resulting in AGGate objects that annotate desired populations and subsequently update the AGSample object. AliGater provides basic pattern recognition functions that primarily operate on one- and two-dimensional gating views. These functions output AGGate objects. After the sample has been gated, the AGSample object will contain all AGGate objects, which are then returned to AGExperiment.</p>
    <p>Utilizing AliGater’s AGQC object, gating pipelines can be validated through clustering of down-sampled images to identify sets of samples where gating failed. By inspecting such visual outliers combined with statistical outliers, the gating process can be fine-tuned until scientific quality is achieved.</p>
    <p>For the flow cytometry experiments, sample processing and preparation were performed in the same way for all three stages (described in detail <xref rid="vbad103-B11" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic> 2021</xref>). Instrument settings and compensation were optimized for each of the cytometers used. Throughout the study, instrument quality control was performed daily by running quality control beads (CS&amp;T research beads<sup>®</sup>, catalog number 650621; BD Biosciences, California, USA, or ZE-Series QC Beads<sup>®</sup>, catalog number 12004403; BioRad, USA) to ensure consistent data quality over time. In Phases 1 and 2, three 8-color antibody panels were used per sample (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1a</xref>), while in Phase 3, two antibody panels of up to 15 colors were used (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2b</xref>). All cell populations detected in Phases 1 and 2 were also measured in Phase 3, while the more comprehensive panels in Phase 3 allowed for detection of additional subpopulations. For most cell populations measured in all three phases, the gating was performed in the same way, based on the same set of markers. There are a few cases where the populations in Phases 1 and 2 were subdivided into Phase 3. In these cases, the total number of cells in a population defined in Phases 1 and 2 was calculated by adding the number of cells in its subpopulations in Phase 3. For the purposes of this study, and to ensure maximum comparability, we only took into account the cell populations that were gated in the same way across phases.</p>
    <p>To use AliGater in large-scale flow cytometry association studies, we have employed the following methodology. First, a gating strategy was defined for each antibody panel. Because AliGater is designed to recapitulate human gating, images from a few manually gated samples (analysed with FlowJo) were used as examples to design AliGater pattern recognition approaches. Based on the type of clusters occurring in these gates we picked from available pattern recognition algorithms available in AliGater to delineate each target population cluster. Sometimes multiple approaches were used sequentially for the same cluster, i.e. first shortest path algorithms followed by mixed-models or principal component clustering. For each gate, AliGater was run in a subset of randomly selected samples and the resulting images were verified together with flow cytometry experts. Once each gate was established, we proceeded with the gate(s) immediately below in the hierarchy, until the full gating strategy was completed.</p>
    <p>Once the gating strategy was defined, all samples were run in AliGater and subjected to strict quality control: we first used a clustering approach based on down-sampled image data to detect subsets of samples with substantially different visual aspect, being more likely to fail any pattern recognition approach. Outliers detected in this way were handled by either discarding the sample if the quality of the .fcs file turned out to be poor or adjusting the gate by fine-tuning settings in AliGater. Following handling outliers detected this way, we inspected samples in the low and high percentiles of each reported flow cytometry statistic, since sparsity is another hallmark for harder pattern recognition problems. For the samples where visual inspection indicated a need for fine-tuning the gating, AliGater was re-run with slightly modified settings. Once quality control was performed for all gates and all samples, the resulting cell percentages were used as phenotypes for the genetic association analysis. For the association tests, we included phase as a covariate to correct for the different flow cytometers and antibody batches that were used in each phase. For cross-phase repeat donor correlations (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>), no such correction was made.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We applied AliGater to a large-scale, flow cytometry-based GWAS aimed at identifying DNA sequence variants that influence the abundance of circulating immune cell populations in blood at high cell type resolution (<xref rid="vbad103-B11" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic> 2021</xref>). In this study, we collected and phenotyped 17,072 adult peripheral blood samples in three phases (‘Phase I’, <italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>3333; ‘Phase II’, <italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>7040; and ‘Phase III’, <italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>6699). Each sample was analyzed by high-throughput, high-resolution flow cytometry (Phase 1 using a BD Canto II; Phase 2 using a BD LSRFortessa; Phase 3 using a BioRad ZE5) with multiple antibody panels, each containing up to 15 markers (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). To ensure accurate quantification of small cell populations, up to 1 million events were analyzed in each sample (median 438 215 in Phase 1; 253 146 in Phase 2; 1 000 000 in Phase 3). The samples were genotyped using single-nucleotide polymorphism microarrays and imputation with reference whole-genome sequencing data to a resolution of millions of DNA sequence variants (<xref rid="vbad103-B11" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic> 2021</xref>).</p>
    <p>We gated 46 cell populations, with a focus on B-cell, T-cell, NK-cell, and stem and progenitor cell subpopulations. In total, we generated 40 095 flow cytometry data files (.fcs). Because gating 46 cell populations in such a number of files would be daunting, we created an AliGater pipeline to facilitate the analysis. In essence, we developed a pipeline that recapitulates the gating steps a human operator would use.</p>
    <p>To test our pipeline, an independent expert gated Phase 1 samples manually (1379–3087 samples from three antibody panels). These data contain repeated measurements for a significant subset and analyzing the correlation of gating results of repeated samples is a common way of assessing reproducibility in clinical and scientific flow cytometry analysis. Comparing manual gating to AliGater gating for Phase 1, we found equal or improved overall repeat donor correlation across all antibody panels for AliGater-gated samples (<xref rid="vbad103-F1" ref-type="fig">Fig. 1</xref>), individual cell population repeat donor correlations are comparable but do not always favor AliGater (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). This is likely due to either more sparse cell numbers in such populations or high and irregular variability across samples for some populations, or a combination of the two. Further comparisons of AliGater against manually gated populations are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. S1–S3</xref>. Following the implementation and evaluation of the Phase 1 gating, strategies were adopted into Phases 2 and 3 with minor modifications to account for changes in protocols and instrumentation.</p>
    <fig position="float" id="vbad103-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Plots showing cumulative density functions (CDF) of the overall correlation in samples that were analyzed multiple times in the (a) B-cell panel (<italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>259), (b) lineage panel (<italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>88), and (c) T-cell panel (<italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>190). Sample sizes are number of repeat sample pairs. Correlation for manually gated samples in black and AliGater-gated samples in blue.</p>
      </caption>
      <graphic xlink:href="vbad103f1" position="float"/>
    </fig>
    <p>We calculated repeat measurement correlations within each phase and from Phase 1 to Phases 2 and 3 for the AliGater-gated samples (<xref rid="sup1" ref-type="supplementary-material">Supplemental Table S2</xref>). As a final quality control step before association testing, all images were manually inspected.</p>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Large-scale, high-dimensional flow cytometry data sets are being generated at an increasing pace in several areas of biomedical research. The complexity and wide variability of these data pose novel analytic challenges. Unlike many genomics applications, where similar solutions can often be applied across biological domains, flow cytometry data usually exhibit highly domain-specific characteristics. Therefore, domain-specific analysis pipelines are usually needed.</p>
    <p>Here, we developed AliGater as an open-source software package to accelerate the development of analysis pipelines for large-scale flow cytometry data. AliGater implements a framework for the general workflow (e.g. file handling, visualization, and quality control), and allows users to focus on the development of the specific pattern recognition routines needed to extract desired features from their specific data sets. AliGater is suitable for large-scale data sets that require automated analysis of thousands of samples using complex gating strategies.</p>
    <p>In the example study, we use AliGater to quantify 46 well-established immune cell populations, defined by consensus cell surface markers. By using AliGater, we achieve two things: (i) the study becomes logistically feasible as gating these cell populations manually across 40 095 fcs files would otherwise be an enormous undertaking and (ii) we achieve a better consistency between measurements, as the quantification becomes operator independent. The increase in consistency does not translate to the discovery of novel cell populations. However, it is likely that this does translate to increased statistical power in the downstream genome-wide association analysis, and thereby the identification of more genomic loci influencing the circulating levels of the gated cell population in peripheral blood. Strategies could be designed to use AliGater for unsupervised clustering approaches to try to discover novel cell populations; however, this has not been a main goal in AliGater development.</p>
    <p>While the example study contains gating panels based on 15 marker data, AliGater does not have a limit on the number of markers it can parse for a given analysis. In addition, while AliGater was developed and designed for high-throughput conventional flow cytometry experiments, there is no reason to believe that AliGater should not work with adequately unmixed fcs files from spectral cytometry data or mass cytometry (CyTOF) data. AliGater does not have methods to compute compensation matrices or spectral unmixing, it either applies compensation matrices already present inside the fcs file or, alternatively, it can apply separately provided compensation matrices calculated elsewhere. I.e. AliGater should work with any standard fcs files, such as files from spectral flow cytometry experiments, provided that these have been unmixed using separate software. AliGater is implemented in Python and is platform independent.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad103_Supplementary_Data</label>
      <media xlink:href="vbad103_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by grants from the European Research Council [CoG-770992], the Knut and Alice Wallenberg Foundation [2014.0071 and 2017.0436], the Swedish Research Council [2017-02023 and 2018-00424], the Swedish Cancer Society [2017/265 and 20.0694], the Swedish Children's Cancer Fund [PR2018-0118 and TJ2017-0042], the Inga Britt &amp; Arne Lundberg Research Foundation [2017-0055], and EU-MSCA-COFUND 754299 CanFaster.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad103-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashhurst</surname><given-names>TM</given-names></string-name>, <string-name><surname>Marsh-Wakefield</surname><given-names>F</given-names></string-name>, <string-name><surname>Putri</surname><given-names>GH</given-names></string-name></person-group><etal>et al</etal><article-title>Integration, exploration, and analysis of high-dimensional single-cell cytometry data using Spectre</article-title>. <source>Cytometry A</source><year>2022</year>;<volume>101</volume>:<fpage>237</fpage>–<lpage>53</lpage>. <pub-id pub-id-type="doi">10.1002/CYTO.A.24350</pub-id><pub-id pub-id-type="pmid">33840138</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B2">
      <mixed-citation publication-type="other"><collab>Becton &amp; Company</collab>. <italic toggle="yes">FlowJo</italic>, <year>2023</year>. <ext-link xlink:href="https://www.flowjo.com" ext-link-type="uri">https://www.flowjo.com</ext-link>.</mixed-citation>
    </ref>
    <ref id="vbad103-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Black</surname><given-names>CB</given-names></string-name>, <string-name><surname>Duensing</surname><given-names>TD</given-names></string-name>, <string-name><surname>Trinkle</surname><given-names>LS</given-names></string-name></person-group><etal>et al</etal><article-title>Cell-Based screening using High-Throughput flow cytometry</article-title>. <source>Assay Drug Dev Technol</source><year>2011</year>;<volume>9</volume>:<fpage>13</fpage>–<lpage>20</lpage>. <pub-id pub-id-type="doi">10.1089/adt.2010.0308</pub-id><pub-id pub-id-type="pmid">21050072</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burton</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Ahmed</surname><given-names>R</given-names></string-name>, <string-name><surname>Cuff</surname><given-names>SM</given-names></string-name></person-group><etal>et al</etal><article-title>CytoPy: an autonomous cytometry analysis framework</article-title>. <source>PLoS Comput Biol</source><year>2021</year>;<volume>17</volume>:<fpage>e1009071</fpage>. <pub-id pub-id-type="doi">10.1371/JOURNAL.PCBI.1009071</pub-id><pub-id pub-id-type="pmid">34101722</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B5">
      <mixed-citation publication-type="other"><collab>de Novo Software</collab>. <italic toggle="yes">FCSExpress</italic>, <year>2023</year>. <ext-link xlink:href="https://denovosoftware.com/" ext-link-type="uri">https://denovosoftware.com/</ext-link>.</mixed-citation>
    </ref>
    <ref id="vbad103-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>M</given-names></string-name>, <string-name><surname>Kaspersson</surname><given-names>K</given-names></string-name>, <string-name><surname>Murray</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>High-throughput flow cytometry for drug discovery: principles, applications, and case studies</article-title>. <source>Drug Discov Today</source><year>2017</year>;<volume>22</volume>:<fpage>1844</fpage>–<lpage>50</lpage>. <pub-id pub-id-type="doi">10.1016/j.drudis.2017.09.005</pub-id><pub-id pub-id-type="pmid">28916303</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finak</surname><given-names>G</given-names></string-name>, <string-name><surname>Frelinger</surname><given-names>J</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>OpenCyto: an open source infrastructure for scalable, robust, reproducible, and automated, end-to-end flow cytometry data analysis</article-title>. <source>PLoS Comput Biol</source><year>2014</year>;<volume>10</volume>:<fpage>e1003806</fpage>. <pub-id pub-id-type="doi">10.1371/JOURNAL.PCBI.1003806</pub-id><pub-id pub-id-type="pmid">25167361</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fletez-Brant</surname><given-names>K</given-names></string-name>, <string-name><surname>Špidlen</surname><given-names>J</given-names></string-name>, <string-name><surname>Brinkman</surname><given-names>RR</given-names></string-name></person-group><etal>et al</etal><article-title>flowClean: automated identification and removal of fluorescence anomalies in flow cytometry data</article-title>. <source>Cytometry A</source><year>2016</year>;<volume>89</volume>:<fpage>461</fpage>–<lpage>71</lpage>. <pub-id pub-id-type="doi">10.1002/CYTO.A.22837</pub-id><pub-id pub-id-type="pmid">26990501</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hahne</surname><given-names>F</given-names></string-name>, <string-name><surname>LeMeur</surname><given-names>N</given-names></string-name>, <string-name><surname>Brinkman</surname><given-names>RR</given-names></string-name></person-group><etal>et al</etal><article-title>flowCore: a bioconductor package for high throughput flow cytometry</article-title>. <source>BMC Bioinformatics</source><year>2009</year>;<volume>10</volume>:106. <pub-id pub-id-type="doi">10.1186/1471-2105-10-106</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Jujjavarapu</surname><given-names>C</given-names></string-name>, <string-name><surname>Hughey</surname><given-names>JJ</given-names></string-name></person-group><etal>et al</etal><article-title>MetaCyto: a tool for automated meta-analysis of mass and flow cytometry data</article-title>. <source>Cell Rep</source><year>2018</year>;<volume>24</volume>:<fpage>1377</fpage>–<lpage>88</lpage>. <pub-id pub-id-type="doi">10.1016/J.CELREP.2018.07.003</pub-id><pub-id pub-id-type="pmid">30067990</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>A</given-names></string-name>, <string-name><surname>Ekdahl</surname><given-names>L</given-names></string-name>, <string-name><surname>Cafaro</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal> Genome-wide association study on 13,167 individuals identifies regulators of hematopoietic stem and progenitor cell levels in human blood. <italic toggle="yes">BioRxiv</italic>, <year>2021</year>. <pub-id pub-id-type="doi">10.1101/2021.03.31.437808</pub-id>.</mixed-citation>
    </ref>
    <ref id="vbad103-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Malek</surname><given-names>M</given-names></string-name>, <string-name><surname>Taghiyar</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Chong</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>flowDensity: reproducing manual gating of flow cytometry data by automated density-based cell population identification</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>606</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTU677</pub-id><pub-id pub-id-type="pmid">25378466</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Monaco</surname><given-names>G</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H</given-names></string-name>, <string-name><surname>Poidinger</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>flowAI: automatic and interactive anomaly discerning tools for flow cytometry data</article-title>. <source>Bioinformatics (Oxford, England)</source><year>2016</year>;<volume>32</volume>:<fpage>2473</fpage>–<lpage>80</lpage>. <pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTW191</pub-id><pub-id pub-id-type="pmid">27153628</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Opzoomer</surname><given-names>JW</given-names></string-name>, <string-name><surname>Timms</surname><given-names>JA</given-names></string-name>, <string-name><surname>Blighe</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Immunocluster provides a computational framework for the nonspecialist to profile high-dimensional cytometry data</article-title>. <source>ELife</source><year>2021</year>;<volume>10</volume>:e62915. <pub-id pub-id-type="doi">10.7554/ELIFE.62915</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Orrù</surname><given-names>V</given-names></string-name>, <string-name><surname>Steri</surname><given-names>M</given-names></string-name>, <string-name><surname>Sidore</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Complex genetic signatures in immune cells underlie autoimmunity and inform therapy</article-title>. <source>Nat Genet</source><year>2020</year>;<volume>52</volume>:<fpage>1036</fpage>–<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1038/s41588-020-0684-4</pub-id><pub-id pub-id-type="pmid">32929287</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Orrù</surname><given-names>V</given-names></string-name>, <string-name><surname>Steri</surname><given-names>M</given-names></string-name>, <string-name><surname>Sole</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Genetic variants regulating immune cell levels in health and disease</article-title>. <source>Cell</source><year>2013</year>;<volume>155</volume>:<fpage>242</fpage>–<lpage>56</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2013.08.041</pub-id><pub-id pub-id-type="pmid">24074872</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pachón</surname><given-names>G</given-names></string-name>, <string-name><surname>Caragol</surname><given-names>I</given-names></string-name>, <string-name><surname>Petriz</surname><given-names>J.</given-names></string-name></person-group><article-title>Subjectivity and flow cytometric variability</article-title>. <source>Nat Rev Immunol</source><year>2012</year>;<volume>12</volume>:<fpage>396; author reply 396</fpage>. <pub-id pub-id-type="doi">10.1038/nri3158-c1</pub-id><pub-id pub-id-type="pmid">22531327</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parks</surname><given-names>DR</given-names></string-name>, <string-name><surname>Roederer</surname><given-names>M</given-names></string-name>, <string-name><surname>Moore</surname><given-names>WA.</given-names></string-name></person-group><article-title>A new “logicle” display method avoids deceptive effects of logarithmic scaling for low signals and compensated data</article-title>. <source>Cytometry A</source><year>2006</year>;<volume>69</volume>:<fpage>541</fpage>–<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1002/cyto.a.20258</pub-id><pub-id pub-id-type="pmid">16604519</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patin</surname><given-names>E</given-names></string-name>, <string-name><surname>Hasan</surname><given-names>M</given-names></string-name>, <string-name><surname>Bergstedt</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal>; <collab>The Milieu Intérieur Consortium</collab>. <article-title>Natural variation in the parameters of innate immune cells is preferentially driven by genetic factors resource</article-title>. <source>Nat Immunol</source><year>2018</year>;<volume>19</volume>:<fpage>302</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1038/s41590-018-0049-7</pub-id><pub-id pub-id-type="pmid">29476184</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Scikit-learn: machine learning in python</article-title>. <source>Journal of Machine Learning Research</source><year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>30</lpage>. <ext-link xlink:href="http://jmlr.org/papers/v12/pedregosa11a.html" ext-link-type="uri">http://jmlr.org/papers/v12/pedregosa11a.html</ext-link></mixed-citation>
    </ref>
    <ref id="vbad103-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rahim</surname><given-names>A</given-names></string-name>, <string-name><surname>Meskas</surname><given-names>J</given-names></string-name>, <string-name><surname>Drissler</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>High throughput automated analysis of big flow cytometry data</article-title>. <source>Methods (San Diego, Calif.)</source><year>2018</year>;<volume>134–135</volume>:<fpage>164</fpage>–<lpage>76</lpage>. <pub-id pub-id-type="doi">10.1016/J.YMETH.2017.12.015</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B22">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Sahir</surname><given-names>F</given-names></string-name>, <string-name><surname>Mateo</surname><given-names>JM</given-names></string-name>, <string-name><surname>Steinhoff</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal> Development of a 43 color panel for the characterization of conventional and unconventional T-cell subsets, B cells, NK cells, monocytes, dendritic cells, and innate lymphoid cells using spectral flow cytometry. <italic toggle="yes">Cytometry A</italic><year>2020</year>. <pub-id pub-id-type="doi">10.1002/cyto.a.24288</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Virtanen</surname><given-names>P</given-names></string-name>, <string-name><surname>Gommers</surname><given-names>R</given-names></string-name>, <string-name><surname>Oliphant</surname><given-names>TE</given-names></string-name></person-group><etal>et al</etal>; <collab>SciPy 1.0 Contributors</collab>. <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source>Nat Methods</source><year>2020</year>;<volume>17</volume>:<fpage>261</fpage>–<lpage>72</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id><pub-id pub-id-type="pmid">32015543</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>White</surname><given-names>S</given-names></string-name>, <string-name><surname>Quinn</surname><given-names>J</given-names></string-name>, <string-name><surname>Enzor</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>FlowKit: a python toolkit for integrated manual and automated cytometry analysis workflows</article-title>. <source>Front Immunol</source><year>2021</year>;<volume>12</volume>:<fpage>768541</fpage>. <pub-id pub-id-type="doi">10.3389/FIMMU.2021.768541/BIBTEX</pub-id><pub-id pub-id-type="pmid">34804056</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Yurtsev</surname><given-names>E</given-names></string-name>, <string-name><surname>Friedman</surname><given-names>J</given-names></string-name>, <string-name><surname>Gore</surname><given-names>J.</given-names></string-name></person-group><italic toggle="yes">FlowCytometryTools: Version 0.4.5</italic>, <year>2015</year>. <pub-id pub-id-type="doi">10.5281/ZENODO.32991</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10438955</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad103</article-id>
    <article-id pub-id-type="publisher-id">vbad103</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AliGater: a framework for the development of bioinformatic pipelines for large-scale, high-dimensional cytometry data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4257-7284</contrib-id>
        <name>
          <surname>Ekdahl</surname>
          <given-names>Ludvig</given-names>
        </name>
        <aff><institution>Lund Stem Cell Center, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Laboratory Medicine, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <xref rid="vbad103-cor1" ref-type="corresp"/>
        <!--ludvig.ekdahl@med.lu.se-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arrizabalaga</surname>
          <given-names>Antton Lamarca</given-names>
        </name>
        <aff><institution>Lund Stem Cell Center, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Laboratory Medicine, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ali</surname>
          <given-names>Zain</given-names>
        </name>
        <aff><institution>Lund Stem Cell Center, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Laboratory Medicine, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cafaro</surname>
          <given-names>Caterina</given-names>
        </name>
        <aff><institution>Lund Stem Cell Center, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Laboratory Medicine, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>de Lapuente Portilla</surname>
          <given-names>Aitzkoa Lopez</given-names>
        </name>
        <aff><institution>Lund Stem Cell Center, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Laboratory Medicine, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nilsson</surname>
          <given-names>Björn</given-names>
        </name>
        <aff><institution>Lund Stem Cell Center, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Department of Laboratory Medicine, Lund University</institution>, Lund 221 84, <country country="SE">Sweden</country></aff>
        <aff><institution>Broad Institute</institution>, Cambridge, MA 02142, <country country="US">United States</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Bateman</surname>
          <given-names>Alex</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad103-cor1">Corresponding author. Department of Laboratory Medicine, Lund University, Lund 221 84, Sweden. E-mail: <email>ludvig.ekdahl@med.lu.se</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-04">
      <day>04</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad103</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>18</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad103.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>AliGater is an open-source framework to accelerate the development of bioinformatic pipelines for the analysis of large-scale, high-dimensional flow cytometry data. AliGater provides a Python package for automatic feature extraction workflows, as well as building blocks to construct analysis pipelines.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We illustrate the use of AliGater in a high-resolution flow cytometry-based genome-wide association study on 46 immune cell populations in 14 288 individuals.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Source code and documentation at <ext-link xlink:href="https://github.com/LudvigEk/aligater" ext-link-type="uri">https://github.com/LudvigEk/aligater</ext-link> and <ext-link xlink:href="https://aligater.readthedocs.io" ext-link-type="uri">https://aligater.readthedocs.io</ext-link></p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/100010663</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>CoG-770992</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Knut and Alice Wallenberg Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004063</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017.0436</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004359</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017-02023</award-id>
        <award-id>2018-00424</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Cancer Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002794</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017/265</award-id>
        <award-id>20.0694</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Children's Cancer Fund</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PR2018-0118</award-id>
        <award-id>TJ2017-0042</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Flow cytometry allows quantitative and qualitative analysis of thousands to millions of cells or microparticles. Newer generations of cytometers with high-throughput capacity and an expanded array of lasers and detectors have enabled the generation of rich, high-dimensional flow cytometry data sets (<xref rid="vbad103-B22" ref-type="bibr">Sahir <italic toggle="yes">et al.</italic> 2020</xref>). Such data sets often reach thousands of samples, hundreds of thousands to millions of data points (‘events’) per sample, and tens of fluorescence measurements per data point. For example, in genome-wide association studies (GWAS), high-throughput flow cytometry is being employed to identify DNA sequence variants that influence cellular traits (e.g. blood and immune cell levels or levels of expression of cellular marker molecules) (<xref rid="vbad103-B16" ref-type="bibr">Orrù <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="vbad103-B15" ref-type="bibr">2020, Patin <italic toggle="yes">et al.</italic> 2018</xref>). Another example is high-throughput flow cytometry-based drug screening (<xref rid="vbad103-B3" ref-type="bibr">Black <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="vbad103-B6" ref-type="bibr">Ding <italic toggle="yes">et al.</italic> 2017</xref>).</p>
    <p>Performing complex gating of thousands of samples is time-consuming and sensitive to variation in how the operator gates the data (<xref rid="vbad103-B17" ref-type="bibr">Pachón <italic toggle="yes">et al.</italic> 2012</xref>).</p>
    <p>Commonly used analysis tools (<xref rid="vbad103-B2" ref-type="bibr">Becton &amp; Company, 2023</xref>; <xref rid="vbad103-B5" ref-type="bibr">de Novo Software, 2023</xref>) are designed for manual analysis of limited numbers of samples and are impractical for data sets with large amounts of samples with many events and complex gating strategies.</p>
    <p>In such situations, custom computational pipelines need to be developed to allow automated analysis (<xref rid="vbad103-B21" ref-type="bibr">Rahim <italic toggle="yes">et al.</italic> 2018</xref>). This not only reduces the gating workload but also eliminates any operator bias and enables rapid comparison of different gating strategies. A number of computational tools have been previously developed to address those issues. <xref rid="vbad103-B9" ref-type="bibr">Hahne <italic toggle="yes">et al.</italic> (2009)</xref> presented <italic toggle="yes">FlowCore</italic>, a foundational R/Bioconductor package that enabled high-throughput FCM gating with both traditional static gates as well as dynamic, data-driven gates. Later, <xref rid="vbad103-B7" ref-type="bibr">Finak <italic toggle="yes">et al.</italic> (2014)</xref> introduced <italic toggle="yes">OpenCyto</italic>, which re-implemented and extended the then-available Bioconductor flow cytometry packages (including <italic toggle="yes">FlowCore</italic>). <italic toggle="yes">OpenCyto</italic> focused on the automation of hierarchical gating strategies similar to those employed when performing gating manually. More recently, <xref rid="vbad103-B4" ref-type="bibr">Burton <italic toggle="yes">et al.</italic> (2021)</xref> and <xref rid="vbad103-B24" ref-type="bibr">White <italic toggle="yes">et al.</italic> (2021)</xref> have put forward powerful and feature-rich Python packages (<italic toggle="yes">CytoPy</italic> and <italic toggle="yes">FlowKit</italic>, respectively) that further expand the offer of computational FCM gating tools. <italic toggle="yes">CytoPy</italic> incorporates classes from the popular SciKit-Learn machine learning library (<xref rid="vbad103-B20" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>) and allows for batch effect corrections and high-dimensional clustering, while <italic toggle="yes">FlowKit</italic> offers a wide set of robust features, including partial compatibility with standardized file formats that define gating strategies and interactive visualizations. Beyond those, several additional software tools and packages have been published in recent years that offer some or all functionalities needed for complete flow cytometry analysis, including compensation, gating, visualization, and statistics (<xref rid="vbad103-B25" ref-type="bibr">Yurtsev <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="vbad103-B12" ref-type="bibr">Malek <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="vbad103-B10" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="vbad103-B14" ref-type="bibr">Opzoomer <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="vbad103-B1" ref-type="bibr">Ashhurst <italic toggle="yes">et al.</italic> 2022</xref>). Additionally, standalone tools for quality control and cleanup of FCM data have also been released (<xref rid="vbad103-B8" ref-type="bibr">Fletez-Brant <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="vbad103-B13" ref-type="bibr">Monaco <italic toggle="yes">et al.</italic> 2016</xref>).</p>
    <p>We developed an open-source computational framework (‘AliGater’) to accelerate the development of analysis pipelines for large-scale flow cytometry data sets. Similar to <italic toggle="yes">OpenCyto</italic>, AliGater has been developed primarily with hierarchical 1D- or 2D-based gating strategies in mind. This closely resembles how manual gating strategies are carried out and is in contrast with multi-dimensional or clustering-based approaches popular in automated flow cytometry gating. AliGater provides access to a number of static and dynamic gates that allow it to perform a thorough analysis of FCM data. Additionally, Aligater offers an integrated quality control functionality particularly useful for high-throughput projects. It is written in Python and Cython and supports multiprocessing to facilitate application to large sample sets once gating strategies have been designed. In all, AliGater provides an easily accessible foundation to build complex adaptive gating strategies similar to OpenCyto, FlowKit and CytoPy while also providing tools for quality control and scalability. It has been tested in projects with tens of thousands of samples (<xref rid="vbad103-B11" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic> 2021</xref>).</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>Recognizing that the analysis of flow cytometry data sets is focused on feature extraction, usually achieved by selecting (‘gating’) data points that satisfy certain criteria, we designed AliGater with the following main functionalities in mind. AliGater contains general methods to parse, gate, and visualize raw data from flow cytometry experiments, with low level parsing partly adapted from FlowCytometryTool (<xref rid="vbad103-B25" ref-type="bibr">Yurtsev <italic toggle="yes">et al.</italic> 2015</xref>). The core of AliGater functionality is in allowing for efficient plug-in custom pattern recognition solutions for automatic gating and, finally, general methods to support quality control.</p>
    <p>AliGater provides software functionality to parse large batches of flow cytometry data (.fcs) files, apply compensation matrices and visualize data as dot plots, including implementations of Bilog and Logicle scales (<xref rid="vbad103-B18" ref-type="bibr">Parks <italic toggle="yes">et al.</italic> 2006</xref>). To facilitate the creation of gating strategies, AliGater lets users mix, match and extend pattern recognition functions. AliGater not only provides a selection of basic pattern recognition primitives (e.g. thresholding, threshold selection functions, and various gating shapes) but also the use of pattern recognition functions from external libraries (e.g. SciPy; <xref rid="vbad103-B23" ref-type="bibr">Virtanen <italic toggle="yes">et al.</italic> 2020</xref>). During analysis, AliGater can also output compressed down-sampled images of gates, structured to be parsed by image segmentation methods and libraries such as SciKit-learn (<xref rid="vbad103-B20" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>) for quality control or machine learning.</p>
    <p>Structurally, AliGater provides a set of hierarchical objects to organize data on an experiment (AGExperiment), sample (AGSample), and individual gate (AGGate) level, while post-gating quality control is handled by an additional object (AGQC). The AGExperiment object handles the overall workflow, including file parsing, pre-gate processing (e.g. compensation and checking file content). Additionally, during analysis, AGExperiment is responsible for collecting and saving gating results across all samples (as text files and diagnostic images). The AGSample object is a container object for the input data and for collecting gating results belonging to an individual sample. End users write custom code to apply pattern recognition routines on AGSample objects resulting in AGGate objects that annotate desired populations and subsequently update the AGSample object. AliGater provides basic pattern recognition functions that primarily operate on one- and two-dimensional gating views. These functions output AGGate objects. After the sample has been gated, the AGSample object will contain all AGGate objects, which are then returned to AGExperiment.</p>
    <p>Utilizing AliGater’s AGQC object, gating pipelines can be validated through clustering of down-sampled images to identify sets of samples where gating failed. By inspecting such visual outliers combined with statistical outliers, the gating process can be fine-tuned until scientific quality is achieved.</p>
    <p>For the flow cytometry experiments, sample processing and preparation were performed in the same way for all three stages (described in detail <xref rid="vbad103-B11" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic> 2021</xref>). Instrument settings and compensation were optimized for each of the cytometers used. Throughout the study, instrument quality control was performed daily by running quality control beads (CS&amp;T research beads<sup>®</sup>, catalog number 650621; BD Biosciences, California, USA, or ZE-Series QC Beads<sup>®</sup>, catalog number 12004403; BioRad, USA) to ensure consistent data quality over time. In Phases 1 and 2, three 8-color antibody panels were used per sample (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1a</xref>), while in Phase 3, two antibody panels of up to 15 colors were used (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2b</xref>). All cell populations detected in Phases 1 and 2 were also measured in Phase 3, while the more comprehensive panels in Phase 3 allowed for detection of additional subpopulations. For most cell populations measured in all three phases, the gating was performed in the same way, based on the same set of markers. There are a few cases where the populations in Phases 1 and 2 were subdivided into Phase 3. In these cases, the total number of cells in a population defined in Phases 1 and 2 was calculated by adding the number of cells in its subpopulations in Phase 3. For the purposes of this study, and to ensure maximum comparability, we only took into account the cell populations that were gated in the same way across phases.</p>
    <p>To use AliGater in large-scale flow cytometry association studies, we have employed the following methodology. First, a gating strategy was defined for each antibody panel. Because AliGater is designed to recapitulate human gating, images from a few manually gated samples (analysed with FlowJo) were used as examples to design AliGater pattern recognition approaches. Based on the type of clusters occurring in these gates we picked from available pattern recognition algorithms available in AliGater to delineate each target population cluster. Sometimes multiple approaches were used sequentially for the same cluster, i.e. first shortest path algorithms followed by mixed-models or principal component clustering. For each gate, AliGater was run in a subset of randomly selected samples and the resulting images were verified together with flow cytometry experts. Once each gate was established, we proceeded with the gate(s) immediately below in the hierarchy, until the full gating strategy was completed.</p>
    <p>Once the gating strategy was defined, all samples were run in AliGater and subjected to strict quality control: we first used a clustering approach based on down-sampled image data to detect subsets of samples with substantially different visual aspect, being more likely to fail any pattern recognition approach. Outliers detected in this way were handled by either discarding the sample if the quality of the .fcs file turned out to be poor or adjusting the gate by fine-tuning settings in AliGater. Following handling outliers detected this way, we inspected samples in the low and high percentiles of each reported flow cytometry statistic, since sparsity is another hallmark for harder pattern recognition problems. For the samples where visual inspection indicated a need for fine-tuning the gating, AliGater was re-run with slightly modified settings. Once quality control was performed for all gates and all samples, the resulting cell percentages were used as phenotypes for the genetic association analysis. For the association tests, we included phase as a covariate to correct for the different flow cytometers and antibody batches that were used in each phase. For cross-phase repeat donor correlations (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>), no such correction was made.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We applied AliGater to a large-scale, flow cytometry-based GWAS aimed at identifying DNA sequence variants that influence the abundance of circulating immune cell populations in blood at high cell type resolution (<xref rid="vbad103-B11" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic> 2021</xref>). In this study, we collected and phenotyped 17,072 adult peripheral blood samples in three phases (‘Phase I’, <italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>3333; ‘Phase II’, <italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>7040; and ‘Phase III’, <italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>6699). Each sample was analyzed by high-throughput, high-resolution flow cytometry (Phase 1 using a BD Canto II; Phase 2 using a BD LSRFortessa; Phase 3 using a BioRad ZE5) with multiple antibody panels, each containing up to 15 markers (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). To ensure accurate quantification of small cell populations, up to 1 million events were analyzed in each sample (median 438 215 in Phase 1; 253 146 in Phase 2; 1 000 000 in Phase 3). The samples were genotyped using single-nucleotide polymorphism microarrays and imputation with reference whole-genome sequencing data to a resolution of millions of DNA sequence variants (<xref rid="vbad103-B11" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic> 2021</xref>).</p>
    <p>We gated 46 cell populations, with a focus on B-cell, T-cell, NK-cell, and stem and progenitor cell subpopulations. In total, we generated 40 095 flow cytometry data files (.fcs). Because gating 46 cell populations in such a number of files would be daunting, we created an AliGater pipeline to facilitate the analysis. In essence, we developed a pipeline that recapitulates the gating steps a human operator would use.</p>
    <p>To test our pipeline, an independent expert gated Phase 1 samples manually (1379–3087 samples from three antibody panels). These data contain repeated measurements for a significant subset and analyzing the correlation of gating results of repeated samples is a common way of assessing reproducibility in clinical and scientific flow cytometry analysis. Comparing manual gating to AliGater gating for Phase 1, we found equal or improved overall repeat donor correlation across all antibody panels for AliGater-gated samples (<xref rid="vbad103-F1" ref-type="fig">Fig. 1</xref>), individual cell population repeat donor correlations are comparable but do not always favor AliGater (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). This is likely due to either more sparse cell numbers in such populations or high and irregular variability across samples for some populations, or a combination of the two. Further comparisons of AliGater against manually gated populations are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. S1–S3</xref>. Following the implementation and evaluation of the Phase 1 gating, strategies were adopted into Phases 2 and 3 with minor modifications to account for changes in protocols and instrumentation.</p>
    <fig position="float" id="vbad103-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Plots showing cumulative density functions (CDF) of the overall correlation in samples that were analyzed multiple times in the (a) B-cell panel (<italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>259), (b) lineage panel (<italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>88), and (c) T-cell panel (<italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>190). Sample sizes are number of repeat sample pairs. Correlation for manually gated samples in black and AliGater-gated samples in blue.</p>
      </caption>
      <graphic xlink:href="vbad103f1" position="float"/>
    </fig>
    <p>We calculated repeat measurement correlations within each phase and from Phase 1 to Phases 2 and 3 for the AliGater-gated samples (<xref rid="sup1" ref-type="supplementary-material">Supplemental Table S2</xref>). As a final quality control step before association testing, all images were manually inspected.</p>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Large-scale, high-dimensional flow cytometry data sets are being generated at an increasing pace in several areas of biomedical research. The complexity and wide variability of these data pose novel analytic challenges. Unlike many genomics applications, where similar solutions can often be applied across biological domains, flow cytometry data usually exhibit highly domain-specific characteristics. Therefore, domain-specific analysis pipelines are usually needed.</p>
    <p>Here, we developed AliGater as an open-source software package to accelerate the development of analysis pipelines for large-scale flow cytometry data. AliGater implements a framework for the general workflow (e.g. file handling, visualization, and quality control), and allows users to focus on the development of the specific pattern recognition routines needed to extract desired features from their specific data sets. AliGater is suitable for large-scale data sets that require automated analysis of thousands of samples using complex gating strategies.</p>
    <p>In the example study, we use AliGater to quantify 46 well-established immune cell populations, defined by consensus cell surface markers. By using AliGater, we achieve two things: (i) the study becomes logistically feasible as gating these cell populations manually across 40 095 fcs files would otherwise be an enormous undertaking and (ii) we achieve a better consistency between measurements, as the quantification becomes operator independent. The increase in consistency does not translate to the discovery of novel cell populations. However, it is likely that this does translate to increased statistical power in the downstream genome-wide association analysis, and thereby the identification of more genomic loci influencing the circulating levels of the gated cell population in peripheral blood. Strategies could be designed to use AliGater for unsupervised clustering approaches to try to discover novel cell populations; however, this has not been a main goal in AliGater development.</p>
    <p>While the example study contains gating panels based on 15 marker data, AliGater does not have a limit on the number of markers it can parse for a given analysis. In addition, while AliGater was developed and designed for high-throughput conventional flow cytometry experiments, there is no reason to believe that AliGater should not work with adequately unmixed fcs files from spectral cytometry data or mass cytometry (CyTOF) data. AliGater does not have methods to compute compensation matrices or spectral unmixing, it either applies compensation matrices already present inside the fcs file or, alternatively, it can apply separately provided compensation matrices calculated elsewhere. I.e. AliGater should work with any standard fcs files, such as files from spectral flow cytometry experiments, provided that these have been unmixed using separate software. AliGater is implemented in Python and is platform independent.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad103_Supplementary_Data</label>
      <media xlink:href="vbad103_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by grants from the European Research Council [CoG-770992], the Knut and Alice Wallenberg Foundation [2014.0071 and 2017.0436], the Swedish Research Council [2017-02023 and 2018-00424], the Swedish Cancer Society [2017/265 and 20.0694], the Swedish Children's Cancer Fund [PR2018-0118 and TJ2017-0042], the Inga Britt &amp; Arne Lundberg Research Foundation [2017-0055], and EU-MSCA-COFUND 754299 CanFaster.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad103-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashhurst</surname><given-names>TM</given-names></string-name>, <string-name><surname>Marsh-Wakefield</surname><given-names>F</given-names></string-name>, <string-name><surname>Putri</surname><given-names>GH</given-names></string-name></person-group><etal>et al</etal><article-title>Integration, exploration, and analysis of high-dimensional single-cell cytometry data using Spectre</article-title>. <source>Cytometry A</source><year>2022</year>;<volume>101</volume>:<fpage>237</fpage>–<lpage>53</lpage>. <pub-id pub-id-type="doi">10.1002/CYTO.A.24350</pub-id><pub-id pub-id-type="pmid">33840138</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B2">
      <mixed-citation publication-type="other"><collab>Becton &amp; Company</collab>. <italic toggle="yes">FlowJo</italic>, <year>2023</year>. <ext-link xlink:href="https://www.flowjo.com" ext-link-type="uri">https://www.flowjo.com</ext-link>.</mixed-citation>
    </ref>
    <ref id="vbad103-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Black</surname><given-names>CB</given-names></string-name>, <string-name><surname>Duensing</surname><given-names>TD</given-names></string-name>, <string-name><surname>Trinkle</surname><given-names>LS</given-names></string-name></person-group><etal>et al</etal><article-title>Cell-Based screening using High-Throughput flow cytometry</article-title>. <source>Assay Drug Dev Technol</source><year>2011</year>;<volume>9</volume>:<fpage>13</fpage>–<lpage>20</lpage>. <pub-id pub-id-type="doi">10.1089/adt.2010.0308</pub-id><pub-id pub-id-type="pmid">21050072</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burton</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Ahmed</surname><given-names>R</given-names></string-name>, <string-name><surname>Cuff</surname><given-names>SM</given-names></string-name></person-group><etal>et al</etal><article-title>CytoPy: an autonomous cytometry analysis framework</article-title>. <source>PLoS Comput Biol</source><year>2021</year>;<volume>17</volume>:<fpage>e1009071</fpage>. <pub-id pub-id-type="doi">10.1371/JOURNAL.PCBI.1009071</pub-id><pub-id pub-id-type="pmid">34101722</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B5">
      <mixed-citation publication-type="other"><collab>de Novo Software</collab>. <italic toggle="yes">FCSExpress</italic>, <year>2023</year>. <ext-link xlink:href="https://denovosoftware.com/" ext-link-type="uri">https://denovosoftware.com/</ext-link>.</mixed-citation>
    </ref>
    <ref id="vbad103-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>M</given-names></string-name>, <string-name><surname>Kaspersson</surname><given-names>K</given-names></string-name>, <string-name><surname>Murray</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>High-throughput flow cytometry for drug discovery: principles, applications, and case studies</article-title>. <source>Drug Discov Today</source><year>2017</year>;<volume>22</volume>:<fpage>1844</fpage>–<lpage>50</lpage>. <pub-id pub-id-type="doi">10.1016/j.drudis.2017.09.005</pub-id><pub-id pub-id-type="pmid">28916303</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finak</surname><given-names>G</given-names></string-name>, <string-name><surname>Frelinger</surname><given-names>J</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>OpenCyto: an open source infrastructure for scalable, robust, reproducible, and automated, end-to-end flow cytometry data analysis</article-title>. <source>PLoS Comput Biol</source><year>2014</year>;<volume>10</volume>:<fpage>e1003806</fpage>. <pub-id pub-id-type="doi">10.1371/JOURNAL.PCBI.1003806</pub-id><pub-id pub-id-type="pmid">25167361</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fletez-Brant</surname><given-names>K</given-names></string-name>, <string-name><surname>Špidlen</surname><given-names>J</given-names></string-name>, <string-name><surname>Brinkman</surname><given-names>RR</given-names></string-name></person-group><etal>et al</etal><article-title>flowClean: automated identification and removal of fluorescence anomalies in flow cytometry data</article-title>. <source>Cytometry A</source><year>2016</year>;<volume>89</volume>:<fpage>461</fpage>–<lpage>71</lpage>. <pub-id pub-id-type="doi">10.1002/CYTO.A.22837</pub-id><pub-id pub-id-type="pmid">26990501</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hahne</surname><given-names>F</given-names></string-name>, <string-name><surname>LeMeur</surname><given-names>N</given-names></string-name>, <string-name><surname>Brinkman</surname><given-names>RR</given-names></string-name></person-group><etal>et al</etal><article-title>flowCore: a bioconductor package for high throughput flow cytometry</article-title>. <source>BMC Bioinformatics</source><year>2009</year>;<volume>10</volume>:106. <pub-id pub-id-type="doi">10.1186/1471-2105-10-106</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Jujjavarapu</surname><given-names>C</given-names></string-name>, <string-name><surname>Hughey</surname><given-names>JJ</given-names></string-name></person-group><etal>et al</etal><article-title>MetaCyto: a tool for automated meta-analysis of mass and flow cytometry data</article-title>. <source>Cell Rep</source><year>2018</year>;<volume>24</volume>:<fpage>1377</fpage>–<lpage>88</lpage>. <pub-id pub-id-type="doi">10.1016/J.CELREP.2018.07.003</pub-id><pub-id pub-id-type="pmid">30067990</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>A</given-names></string-name>, <string-name><surname>Ekdahl</surname><given-names>L</given-names></string-name>, <string-name><surname>Cafaro</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal> Genome-wide association study on 13,167 individuals identifies regulators of hematopoietic stem and progenitor cell levels in human blood. <italic toggle="yes">BioRxiv</italic>, <year>2021</year>. <pub-id pub-id-type="doi">10.1101/2021.03.31.437808</pub-id>.</mixed-citation>
    </ref>
    <ref id="vbad103-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Malek</surname><given-names>M</given-names></string-name>, <string-name><surname>Taghiyar</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Chong</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>flowDensity: reproducing manual gating of flow cytometry data by automated density-based cell population identification</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>606</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTU677</pub-id><pub-id pub-id-type="pmid">25378466</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Monaco</surname><given-names>G</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H</given-names></string-name>, <string-name><surname>Poidinger</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>flowAI: automatic and interactive anomaly discerning tools for flow cytometry data</article-title>. <source>Bioinformatics (Oxford, England)</source><year>2016</year>;<volume>32</volume>:<fpage>2473</fpage>–<lpage>80</lpage>. <pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTW191</pub-id><pub-id pub-id-type="pmid">27153628</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Opzoomer</surname><given-names>JW</given-names></string-name>, <string-name><surname>Timms</surname><given-names>JA</given-names></string-name>, <string-name><surname>Blighe</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Immunocluster provides a computational framework for the nonspecialist to profile high-dimensional cytometry data</article-title>. <source>ELife</source><year>2021</year>;<volume>10</volume>:e62915. <pub-id pub-id-type="doi">10.7554/ELIFE.62915</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Orrù</surname><given-names>V</given-names></string-name>, <string-name><surname>Steri</surname><given-names>M</given-names></string-name>, <string-name><surname>Sidore</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Complex genetic signatures in immune cells underlie autoimmunity and inform therapy</article-title>. <source>Nat Genet</source><year>2020</year>;<volume>52</volume>:<fpage>1036</fpage>–<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1038/s41588-020-0684-4</pub-id><pub-id pub-id-type="pmid">32929287</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Orrù</surname><given-names>V</given-names></string-name>, <string-name><surname>Steri</surname><given-names>M</given-names></string-name>, <string-name><surname>Sole</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Genetic variants regulating immune cell levels in health and disease</article-title>. <source>Cell</source><year>2013</year>;<volume>155</volume>:<fpage>242</fpage>–<lpage>56</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2013.08.041</pub-id><pub-id pub-id-type="pmid">24074872</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pachón</surname><given-names>G</given-names></string-name>, <string-name><surname>Caragol</surname><given-names>I</given-names></string-name>, <string-name><surname>Petriz</surname><given-names>J.</given-names></string-name></person-group><article-title>Subjectivity and flow cytometric variability</article-title>. <source>Nat Rev Immunol</source><year>2012</year>;<volume>12</volume>:<fpage>396; author reply 396</fpage>. <pub-id pub-id-type="doi">10.1038/nri3158-c1</pub-id><pub-id pub-id-type="pmid">22531327</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parks</surname><given-names>DR</given-names></string-name>, <string-name><surname>Roederer</surname><given-names>M</given-names></string-name>, <string-name><surname>Moore</surname><given-names>WA.</given-names></string-name></person-group><article-title>A new “logicle” display method avoids deceptive effects of logarithmic scaling for low signals and compensated data</article-title>. <source>Cytometry A</source><year>2006</year>;<volume>69</volume>:<fpage>541</fpage>–<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1002/cyto.a.20258</pub-id><pub-id pub-id-type="pmid">16604519</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patin</surname><given-names>E</given-names></string-name>, <string-name><surname>Hasan</surname><given-names>M</given-names></string-name>, <string-name><surname>Bergstedt</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal>; <collab>The Milieu Intérieur Consortium</collab>. <article-title>Natural variation in the parameters of innate immune cells is preferentially driven by genetic factors resource</article-title>. <source>Nat Immunol</source><year>2018</year>;<volume>19</volume>:<fpage>302</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1038/s41590-018-0049-7</pub-id><pub-id pub-id-type="pmid">29476184</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Scikit-learn: machine learning in python</article-title>. <source>Journal of Machine Learning Research</source><year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>30</lpage>. <ext-link xlink:href="http://jmlr.org/papers/v12/pedregosa11a.html" ext-link-type="uri">http://jmlr.org/papers/v12/pedregosa11a.html</ext-link></mixed-citation>
    </ref>
    <ref id="vbad103-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rahim</surname><given-names>A</given-names></string-name>, <string-name><surname>Meskas</surname><given-names>J</given-names></string-name>, <string-name><surname>Drissler</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>High throughput automated analysis of big flow cytometry data</article-title>. <source>Methods (San Diego, Calif.)</source><year>2018</year>;<volume>134–135</volume>:<fpage>164</fpage>–<lpage>76</lpage>. <pub-id pub-id-type="doi">10.1016/J.YMETH.2017.12.015</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B22">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Sahir</surname><given-names>F</given-names></string-name>, <string-name><surname>Mateo</surname><given-names>JM</given-names></string-name>, <string-name><surname>Steinhoff</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal> Development of a 43 color panel for the characterization of conventional and unconventional T-cell subsets, B cells, NK cells, monocytes, dendritic cells, and innate lymphoid cells using spectral flow cytometry. <italic toggle="yes">Cytometry A</italic><year>2020</year>. <pub-id pub-id-type="doi">10.1002/cyto.a.24288</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Virtanen</surname><given-names>P</given-names></string-name>, <string-name><surname>Gommers</surname><given-names>R</given-names></string-name>, <string-name><surname>Oliphant</surname><given-names>TE</given-names></string-name></person-group><etal>et al</etal>; <collab>SciPy 1.0 Contributors</collab>. <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source>Nat Methods</source><year>2020</year>;<volume>17</volume>:<fpage>261</fpage>–<lpage>72</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id><pub-id pub-id-type="pmid">32015543</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>White</surname><given-names>S</given-names></string-name>, <string-name><surname>Quinn</surname><given-names>J</given-names></string-name>, <string-name><surname>Enzor</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>FlowKit: a python toolkit for integrated manual and automated cytometry analysis workflows</article-title>. <source>Front Immunol</source><year>2021</year>;<volume>12</volume>:<fpage>768541</fpage>. <pub-id pub-id-type="doi">10.3389/FIMMU.2021.768541/BIBTEX</pub-id><pub-id pub-id-type="pmid">34804056</pub-id></mixed-citation>
    </ref>
    <ref id="vbad103-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Yurtsev</surname><given-names>E</given-names></string-name>, <string-name><surname>Friedman</surname><given-names>J</given-names></string-name>, <string-name><surname>Gore</surname><given-names>J.</given-names></string-name></person-group><italic toggle="yes">FlowCytometryTools: Version 0.4.5</italic>, <year>2015</year>. <pub-id pub-id-type="doi">10.5281/ZENODO.32991</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
