<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version v40?>
<?ConverterInfo.XSLTName bmc2nlm.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2696452</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-10-161</article-id>
    <article-id pub-id-type="pmid">19473525</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-10-161</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GAGE: generally applicable gene set enrichment for pathway analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Luo</surname>
          <given-names>Weijun</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>luo@cshl.edu</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Friedman</surname>
          <given-names>Michael S</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>mfriedman@thermogenesis.com</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Shedden</surname>
          <given-names>Kerby</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>kshedden@umich.edu</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Hankenson</surname>
          <given-names>Kurt D</given-names>
        </name>
        <xref ref-type="aff" rid="I5">5</xref>
        <email>kdhank@vet.upenn.edu</email>
      </contrib>
      <contrib id="A5" corresp="yes" contrib-type="author">
        <name>
          <surname>Woolf</surname>
          <given-names>Peter J</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I6">6</xref>
        <xref ref-type="aff" rid="I7">7</xref>
        <email>pwoolf@umich.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Biomedical Engineering, University of Michigan, Ann Arbor, MI 48109, USA</aff>
    <aff id="I2"><label>2</label>Bioinformatics Shared Resource, Cold Spring Harbor Laboratory, Cold Spring Harbor, NY 11724, USA</aff>
    <aff id="I3"><label>3</label>Thermogenesis Corporation, Rancho Cordova CA, 95742, USA</aff>
    <aff id="I4"><label>4</label>Department of Statistics, University of Michigan, Ann Arbor, MI 48109, USA</aff>
    <aff id="I5"><label>5</label>Department of Animal Biology, University of Pennsylvania, Philadelphia, PA 19104, USA</aff>
    <aff id="I6"><label>6</label>Bioinformatics Program, University of Michigan, Ann Arbor, MI 48109, USA</aff>
    <aff id="I7"><label>7</label>Department of Chemical Engineering, University of Michigan, Ann Arbor, MI 48109, USA</aff>
    <pub-date pub-type="collection">
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>5</month>
      <year>2009</year>
    </pub-date>
    <volume>10</volume>
    <fpage>161</fpage>
    <lpage>161</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/161"/>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>6</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>5</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2009 Luo et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <copyright-holder>Luo et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Luo
               Weijun
               
               
               luo@cshl.edu
            </dc:author><dc:title>
            GAGE: generally applicable gene set enrichment for pathway analysis
         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(1): 161-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:1&#x0003c;161&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Gene set analysis (GSA) is a widely used strategy for gene expression data analysis based on pathway knowledge. GSA focuses on sets of related genes and has established major advantages over individual gene analyses, including greater robustness, sensitivity and biological relevance. However, previous GSA methods have limited usage as they cannot handle datasets of different sample sizes or experimental designs.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>To address these limitations, we present a new GSA method called Generally Applicable Gene-set Enrichment (GAGE). We successfully apply GAGE to multiple microarray datasets with different sample sizes, experimental designs and profiling techniques. GAGE shows significantly better results when compared to two other commonly used GSA methods of GSEA and PAGE. We demonstrate this improvement in the following three aspects: (1) consistency across repeated studies/experiments; (2) sensitivity and specificity; (3) biological relevance of the regulatory mechanisms inferred.</p>
        <p>GAGE reveals novel and relevant regulatory mechanisms from both published and previously unpublished microarray studies. From two published lung cancer data sets, GAGE derived a more cohesive and predictive mechanistic scheme underlying lung cancer progress and metastasis. For a previously unpublished BMP6 study, GAGE predicted novel regulatory mechanisms for BMP6 induced osteoblast differentiation, including the canonical BMP-TGF beta signaling, JAK-STAT signaling, Wnt signaling, and estrogen signaling pathways–all of which are supported by the experimental literature.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>GAGE is generally applicable to gene expression datasets with different sample sizes and experimental designs. GAGE consistently outperformed two most frequently used GSA methods and inferred statistically and biologically more relevant regulatory pathways. The GAGE method is implemented in R in the "gage" package, available under the GNU GPL from <ext-link ext-link-type="uri" xlink:href="http://sysbio.engin.umich.edu/~luow/downloads.php"/>.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>A central goal of biomedical research is to define mechanistic causes for cellular behavior and disease. High throughput technologies such as gene expression profiling provide a rich starting point to identify mechanistic causes, e.g. de novo network inference [<xref ref-type="bibr" rid="B1">1</xref>]. Ideally we would like to contextualize gene expression patterns with the known biochemical processes and regulatory signaling pathways. This approach provides us with a more systems level and informative view (compared to individual gene based interpretation) of the biological states that have been perturbed, which in turn allows us to identify points where we could intervene to change cellular behavior.</p>
    <p>Gene set analysis (GSA) is a widely used strategy for gene expression data analysis based on pathway knowledge [<xref ref-type="bibr" rid="B2">2</xref>-<xref ref-type="bibr" rid="B12">12</xref>]. Unlike previous strategies which focus on individual or a limited number of genes, GSA focuses on sets of related genes and has demonstrated three major advantages. First, GSA methods are better able to detect biologically relevant signals and give more coherent results across different studies [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B5">5</xref>]. Second, GSA uses all of the available gene expression data (cutoff-free) instead of prefiltering the data for a short list of strongly differentially expressed genes (cutoff-based). (Note that cutoff-based tools such as WebGestalt [<xref ref-type="bibr" rid="B13">13</xref>] and FatiScan [<xref ref-type="bibr" rid="B14">14</xref>] that apply Fisher's test and Hypergeometric test are sometimes denoted as gene set analysis tools.) Indeed, small coordinated gene expression changes in a pathway can have a major biological effect even if these changes are not statistically significant for any individual gene [<xref ref-type="bibr" rid="B3">3</xref>]. Third, GSA incorporates prior knowledge of biological pathways and other experimental results in the form of gene sets [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>]. These gene sets are constantly updated in the literature and represent a significant repository of useful biological knowledge. Although, knowledge dependency can be also considered a limitation of GSA strategy: our findings are restricted by current knowledge.</p>
    <p>There are two categories of GSA based on the statistical tests used: sample randomization and gene randomization [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B15">15</xref>]. Sample randomization methods test significance of gene sets based on permutation of sample labels, with GSEA [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>], SAFE [<xref ref-type="bibr" rid="B10">10</xref>] and SAM-GS [<xref ref-type="bibr" rid="B9">9</xref>] as representatives. In contrast, gene randomization methods test the significance of gene sets based on permutations of gene labels or a parametric distribution over genes, with PAGE [<xref ref-type="bibr" rid="B5">5</xref>], T-Profiler [<xref ref-type="bibr" rid="B7">7</xref>] and Random-set [<xref ref-type="bibr" rid="B6">6</xref>] as representatives. Sample randomization maintains the correlation structure among genes but only applies to large expression datasets with multiple samples per experimental condition. For a two-state comparison, a minimum of 8 chips for each state is required for 1000 balanced (presence of the two sample states) permutation or 6 chips for 1000 unbalanced permutation. Gene randomization has no limitation on sample size, but may break the correlation structure among genes [<xref ref-type="bibr" rid="B11">11</xref>]–an issue that may or may not be a problem (detailed in discussion) [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>]. Sample randomization and gene randomization test different but related null hypotheses, Tian <italic>et al</italic>. [<xref ref-type="bibr" rid="B8">8</xref>] and Nam <italic>et al</italic>. [<xref ref-type="bibr" rid="B15">15</xref>] proposed combinatory procedures to achieve more robust results.</p>
    <p>All these methods established GSA as a powerful strategy for gene expression data analysis. In spite of its advantages, GSA as a whole strategy still suffers from three major limitations.</p>
    <p>First, currently available GSA methods do not handle small datasets effectively, yet most gene expression datasets fall into this category. As mentioned above, the sample randomization strategy used by methods such as GSEA is not appropriate for studies with under 8 gene chips per state, thus gene randomization remains to be the only feasible option [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B15">15</xref>]. Gene randomization methods such as PAGE have been applied to small dataset [<xref ref-type="bibr" rid="B5">5</xref>], but these methods tend to make large number of (false) positive calls with extremely small p-values [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>] (also see the results). T-profiler targets datasets with one sample pair [<xref ref-type="bibr" rid="B7">7</xref>], however, it can't combine results from multiple paired experiments nor can it be applied to studies with non-paired studies [<xref ref-type="bibr" rid="B7">7</xref>].</p>
    <p>Second, no GSA method currently available handles datasets with different sample sizes and experiment designs consistently. For datasets with few or no replicates, t-test statistics, signal to noise ratios, or their corresponding p-values are not robust estimates of differential expression for genes or simply not applicable. Therefore, fold change (log based) is frequently used as more versatile per gene statistics [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B5">5</xref>-<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B18">18</xref>]. The use of fold change gives rise to two issues that have been largely neglected so far. First, the average fold change does not account for different experimental designs, i.e. pair-matched samples or non-paired samples. The per gene statistics such as t-test statistics may vary significantly depending on if the samples are paired or not, yet there is no difference in fold change. Second, average fold change does not contain any information for the sample size. Sample size largely determines the confidence or significance level of our inference, yet is dropped when using fold change. Fold change makes sense in one-on-one paired comparison, as in T-profiler [<xref ref-type="bibr" rid="B7">7</xref>]. However for datasets with replicate samples, the test power or the significance of relevant gene sets would be underestimated.</p>
    <p>Third, most GSA methods only consider transcriptional regulation in one direction (e.g. all up or all down) in a gene set. This directional bias makes sense for experimentally derived gene sets, but not for gene sets based on canonical signaling pathways, which frequently show reciprocal gene regulation in both directions upon perturbation [<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B20">20</xref>]. Thus it is advisable to consider both cases for an inclusive analysis for regulatory mechanisms.</p>
    <p>To address these issues, we have developed a novel method called Generally Applicable Gene-set Enrichment (GAGE) (Figure <xref ref-type="fig" rid="F1">1</xref>). GAGE applies to datasets with any number of samples and is based on a parametric gene randomization procedure. Similar to Parametric Analysis of Gene Set Enrichment (PAGE) [<xref ref-type="bibr" rid="B5">5</xref>] (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Figure 1) and T-profiler [<xref ref-type="bibr" rid="B7">7</xref>], GAGE uses log-based fold changes as per gene statistics. However, GAGE differs from PAGE and T-profiler in three significant ways. First, GAGE assumes a gene set comes from a different distribution than the background and uses two-sample t-test to account for the gene set specific variance as well as the background variance. In contrast, PAGE assumes gene sets comes from the same distribution as the background and uses one-sample z-test that only considers the background variance [<xref ref-type="bibr" rid="B5">5</xref>]. T-profiler also employs two-sample t-test, but it is essentially a one-sample z-test since the sample size of a gene set is not comparable to its complementary set [<xref ref-type="bibr" rid="B7">7</xref>] (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Note 1 and Methods). Second, GAGE adjusts for different microarray experimental designs (paired or non-paired) and sample sizes by decomposing group-on-group comparisons into one-on-one comparisons between samples from different groups. GAGE derives a global p-value using a meta-test on the p-values from these comparisons for each gene set. Third, GAGE separates experimentally perturbed gene sets (from literature) and canonical pathways (from pathway databases). Experimental sets are taken as genes coregulated towards a single direction, whereas canonical pathways allowed changes in both directions. This gene set separation strategy give GAGE more test power in detecting relevant biological signals.</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>A schematic overview of the GAGE algorithm. GAGE has three major steps</bold>. (a) Step 1: input preparation. Separate gene sets into two categories: experimental sets and canonical pathways, for differential treatment in significant test. (b) Step 2: gene set differential expression tests based on one-on-one comparison between samples from the two experimental conditions. For each experiment-control pair, calculate differential expression in log based fold change for all genes. Test whether specific gene sets are significantly differentially expressed relative to the background whole set using two-sample t-test. (c) Step 3: summarization. For each gene set, derive a global p-value based on a meta-test on the negative log sum of p-values from all one-on-one comparisons. More details of GAGE are given in the Methods. Variables <italic>m</italic>, <italic>s </italic>and <italic>n </italic>are the mean fold change, standard deviation and number of genes in a gene set, <italic>M</italic>, <italic>S </italic>and <italic>N </italic>are those for the whole set. A similar schematic overview of the PAGE algorithm is shown in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Figure 1.</p>
      </caption>
      <graphic xlink:href="1471-2105-10-161-1"/>
    </fig>
    <p>In this work, we show that GAGE is generally applicable to datasets with different sample sizes and experimental designs. We first apply GAGE to two lung cancer datasets [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>] and one type 2 diabetes dataset [<xref ref-type="bibr" rid="B4">4</xref>], which has been analyzed by GSEA [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>] and PAGE [<xref ref-type="bibr" rid="B5">5</xref>] as example cases. These are representatives for large datasets with tens of samples per condition frequently seen in large clinical or experimental studies. We then analyze a smaller, previously unpublished dataset describing mesenchymal stem cell response to BMP6 treatment. This is a typical small dataset with as few as two samples per condition like in most experimental studies. BMP6 treated samples and controls are one-on-one matched, which is a frequently used experiment design particularly for all the two-channel microarray studies. In each case, we compare GAGE to GSEA and PAGE. To compare the performance of GAGE vs GSEA and PAGE in a more controllable setting, we conducted simulation study using the type 2 diabetes dataset and synthetic gene sets. Finally, we also detail the major strategies employed by GAGE.</p>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Application to large datasets with the GSEA and PAGE as control methods</title>
      <p>As a test case, we applied GAGE, PAGE and GSEA to two lung cancer datasets [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>] which were originally analyzed and compared by GSEA [<xref ref-type="bibr" rid="B3">3</xref>]. These two datasets were generated by two independent studies done in Boston [<xref ref-type="bibr" rid="B22">22</xref>] and Michigan [<xref ref-type="bibr" rid="B21">21</xref>], containing gene expression profiles of lung adenocarcinomas samples from patients. Patients were classified as having "good" or "poor" clinical outcomes. For each dataset, we defined the control set as patient profiles with good clinic outcomes, and selected the most differentially regulated gene sets associated with poor outcomes. Note that we used the updated curated gene set collection c2 from MSigDB [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B23">23</xref>] for both methods. For a fair comparison, experimental sets and the canonical pathways were separated for all three methods.</p>
      <p>We compared the top 10 most significant gene sets inferred by the three methods (Table <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>, Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 1–3) and identified evident differences in four aspects. First, the top experimental gene sets selected by GAGE and PAGE overlapped significantly, but the canonical pathways identified by GAGE, PAGE, and GSEA did not (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 3). The lack of overlap for the canonical pathways is expected because GAGE allows perturbations in both directions in canonical pathways. Second, GAGE derived modest p-values and numbers of significant gene sets compared to GSEA and PAGE (Table <xref ref-type="table" rid="T2">2</xref>). While others have suggested that GSEA suffers from low sensitivity [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>], our results suggest that PAGE is overly sensitive (low specificity). Third, the top 10 gene sets inferred by GAGE are more consistent between the two studies: 4 experimental sets and 5 canonical pathways are the same for GAGE results, 4 and 4 for PAGE and 1 and 0 for GSEA respectively (Table <xref ref-type="table" rid="T2">2</xref>). Fourth, the top 10 gene sets inferred by GAGE better describe poor outcomes of lung cancer mechanistically (Table <xref ref-type="table" rid="T2">2</xref>). Canonical pathways inferred by GAGE are by far the most indicative of tumor occurrence and metastasis. Experimental sets inferred by GAGE and by PAGE are similarly indicative of tumor occurrence and prognostic of metastasis or poor clinical outcomes, and both are better than those inferred by GSEA.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>GAGE applied to the two lung cancer datasets of large sample sizes</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="center" colspan="4">Boston study</td>
              <td align="center" colspan="4">Michigan study</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Experimental Sets</td>
              <td align="left">p-val</td>
              <td align="left">q-val</td>
              <td align="left">Notes</td>
              <td align="left">Experimental Sets</td>
              <td align="left">p-val</td>
              <td align="left">q-val</td>
              <td align="left">Notes</td>
            </tr>
            <tr>
              <td colspan="8">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">
                <bold>Tarte_Plasma_Blastic</bold>
              </td>
              <td align="left">1.8E-64</td>
              <td align="left">1.1E-61</td>
              <td align="left">c</td>
              <td align="left">
                <bold>Tarte_Plasma_Blastic</bold>
              </td>
              <td align="left">5.6E-42</td>
              <td align="left">4.1E-39</td>
              <td align="left">c</td>
            </tr>
            <tr>
              <td align="left">
                <bold>Uvb_Nhek3_All</bold>
              </td>
              <td align="left">1.2E-59</td>
              <td align="left">3.6E-57</td>
              <td align="left">t</td>
              <td align="left">
                <bold>Cancer_Undifferentiat</bold>
              </td>
              <td align="left">1.0E-22</td>
              <td align="left">3.8E-20</td>
              <td align="left">bt</td>
            </tr>
            <tr>
              <td align="left">Peng_Glutamine_Dn</td>
              <td align="left">3.7E-59</td>
              <td align="left">7.6E-57</td>
              <td align="left">c</td>
              <td align="left">
                <bold>Brca_Er_Neg</bold>
              </td>
              <td align="left">8.3E-19</td>
              <td align="left">2.0E-16</td>
              <td align="left">bt</td>
            </tr>
            <tr>
              <td align="left">Lei_Myb_Regulated_G</td>
              <td align="left">5.8E-55</td>
              <td align="left">8.8E-53</td>
              <td align="left">bt, c</td>
              <td align="left">Serum_Fibroblast_Cell</td>
              <td align="left">3.2E-18</td>
              <td align="left">5.9E-16</td>
              <td align="left">bt, c</td>
            </tr>
            <tr>
              <td align="left">Peng_Leucine_Dn</td>
              <td align="left">4.0E-42</td>
              <td align="left">4.8E-40</td>
              <td align="left">c</td>
              <td align="left">
                <bold>Uvb_Nhek3_All</bold>
              </td>
              <td align="left">5.3E-17</td>
              <td align="left">7.7E-15</td>
              <td align="left">t</td>
            </tr>
            <tr>
              <td align="left">
                <bold>Cancer_Undifferentiat</bold>
              </td>
              <td align="left">3.0E-41</td>
              <td align="left">3.0E-39</td>
              <td align="left">bt</td>
              <td align="left">Caries_Pulp_Up</td>
              <td align="left">4.7E-16</td>
              <td align="left">4.6E-13</td>
              <td/>
            </tr>
            <tr>
              <td align="left">
                <bold>Brca_Er_Neg</bold>
              </td>
              <td align="left">2.0E-40</td>
              <td align="left">1.7E-38</td>
              <td align="left">bt</td>
              <td align="left">Zhan_Mm_Cd138_Pr_</td>
              <td align="left">8.3E-15</td>
              <td align="left">1.0E-12</td>
              <td align="left">bt</td>
            </tr>
            <tr>
              <td align="left">Peng_Rapamycin_Dn</td>
              <td align="left">3.5E-38</td>
              <td align="left">2.7E-36</td>
              <td align="left">c</td>
              <td align="left">Li_Fetal_Vs_Wt_Kidne</td>
              <td align="left">3.7E-14</td>
              <td align="left">3.8E-12</td>
              <td align="left">t</td>
            </tr>
            <tr>
              <td align="left">Rcc_Nl_Up</td>
              <td align="left">5.2E-36</td>
              <td align="left">3.5E-34</td>
              <td align="left">t</td>
              <td align="left">Dox_Resist_Gastric_Up</td>
              <td align="left">1.2E-13</td>
              <td align="left">1.1E-11</td>
              <td align="left">bt</td>
            </tr>
            <tr>
              <td align="left">Cancer_Neoplastic_Me</td>
              <td align="left">4.2E-35</td>
              <td align="left">2.6E-33</td>
              <td align="left">t</td>
              <td align="left">Idx_Tsa_Up_Cluster3</td>
              <td align="left">2.4E-13</td>
              <td align="left">1.9E-11</td>
              <td align="left">c</td>
            </tr>
            <tr>
              <td colspan="8">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">Canonical Pathways</td>
              <td align="left">p-val</td>
              <td align="left">q-val</td>
              <td align="left">Notes</td>
              <td align="left">Canonical Pathways</td>
              <td align="left">p-val</td>
              <td align="left">q-val</td>
              <td align="left">Notes</td>
            </tr>
            <tr>
              <td colspan="8">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">
                <bold>Gpcrs_Class_A_Rhod</bold>
              </td>
              <td align="left">9.2E-23</td>
              <td align="left">3.1E-20</td>
              <td align="left">bt</td>
              <td align="left">
                <bold>Gpcrs_Class_A_Rhod</bold>
              </td>
              <td align="left">3.1E-10</td>
              <td align="left">1.0E-07</td>
              <td align="left">bt</td>
            </tr>
            <tr>
              <td align="left">
                <bold>Gpcrdb_Class_A_Rho</bold>
              </td>
              <td align="left">4.7E-21</td>
              <td align="left">7.8E-19</td>
              <td align="left">bt</td>
              <td align="left">
                <bold>Gpcrdb_Class_A_Rho</bold>
              </td>
              <td align="left">1.1E-09</td>
              <td align="left">1.9E-07</td>
              <td align="left">bt</td>
            </tr>
            <tr>
              <td align="left">
                <bold>Blood_Clotting_Casca</bold>
              </td>
              <td align="left">5.1E-15</td>
              <td align="left">4.7E-13</td>
              <td align="left">bt</td>
              <td align="left">Androgen_Genes</td>
              <td align="left">5.2E-08</td>
              <td align="left">5.8E-06</td>
              <td align="left">bt</td>
            </tr>
            <tr>
              <td align="left">
                <bold>Intrinsicpathway</bold>
              </td>
              <td align="left">6.3E-15</td>
              <td align="left">5.3E-13</td>
              <td align="left">bt</td>
              <td align="left">Cytokinepathway</td>
              <td align="left">1.9E-07</td>
              <td align="left">1.6E-05</td>
              <td align="left">bt</td>
            </tr>
            <tr>
              <td align="left">Fibrinolysispathway</td>
              <td align="left">1.1E-12</td>
              <td align="left">9.1E-11</td>
              <td align="left">bt</td>
              <td align="left">Prostaglandin_And_Le</td>
              <td align="left">2.9E-05</td>
              <td align="left">2.4E-03</td>
              <td align="left">bt</td>
            </tr>
            <tr>
              <td align="left">
                <bold>Peptide_Gpcrs</bold>
              </td>
              <td align="left">1.9E-12</td>
              <td align="left">1.6E-10</td>
              <td align="left">bt</td>
              <td align="left">Proliferation_Genes</td>
              <td align="left">5.1E-05</td>
              <td align="left">4.3E-03</td>
              <td align="left">c</td>
            </tr>
            <tr>
              <td align="left">Tyrosine_Metabolism</td>
              <td align="left">8.7E-09</td>
              <td align="left">7.3E-07</td>
              <td align="left">bt</td>
              <td align="left">
                <bold>Peptide_Gpcrs</bold>
              </td>
              <td align="left">5.8E-05</td>
              <td align="left">4.8E-03</td>
              <td align="left">bt</td>
            </tr>
            <tr>
              <td align="left">Extrinsicpathway</td>
              <td align="left">5.5E-07</td>
              <td align="left">4.6E-05</td>
              <td align="left">bt</td>
              <td align="left">
                <bold>Intrinsicpathway</bold>
              </td>
              <td align="left">9.1E-05</td>
              <td align="left">7.6E-03</td>
              <td align="left">bt</td>
            </tr>
            <tr>
              <td align="left">Gpcrdb_Other</td>
              <td align="left">5.2E-06</td>
              <td align="left">4.4E-04</td>
              <td align="left">bt</td>
              <td align="left">Androgen_And_Estrog</td>
              <td align="left">4.2E-04</td>
              <td align="left">3.4E-02</td>
              <td align="left">bt</td>
            </tr>
            <tr>
              <td align="left">Small_Ligand_Gpcrs</td>
              <td align="left">6.7E-06</td>
              <td align="left">5.6E-04</td>
              <td align="left">bt</td>
              <td align="left">
                <bold>Blood_Clotting_Casca</bold>
              </td>
              <td align="left">7.5E-04</td>
              <td align="left">5.9E-02</td>
              <td align="left">bt</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Top 10 most significantly enriched experimental sets and canonical pathways in poor clinical outcomes vs good outcomes were inferred by GAGE from two published lung adenocarcinoma data sets used in the GSEA paper [<xref ref-type="bibr" rid="B3">3</xref>]. Both positively and negatively regulated gene sets were collected and ranking by the p-value, and by absolute value of average t-statistics (data not shown) for ties. FDR q-values were estimated to correct the p-values for the multiple testing issue. Consistencies between the two data sets are shown in bold font. Notes show the connections of the gene sets to cancer related topics: t for tumor related; bt for tumor metastasis and bad outcome; c for cell growth and proliferation related; and blank represents no evident connection. These annotations came from the original studies for experimental sets, or made based on more than three independent literature works for the canonical pathway.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Comparison between GAGE, PAGE and GSEA results from the two lung cancer datasets</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Gene Sets &amp; Methods</td>
              <td/>
              <td align="left">Overlap</td>
              <td align="left">Top 10 p-values</td>
              <td align="left">Metastasis</td>
              <td align="left">Tumor</td>
              <td align="left">Sign. Sets</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Experimental Sets</td>
              <td align="left">GAGE</td>
              <td align="left">4</td>
              <td align="left">4.2E-35, 2.4E-13</td>
              <td align="left">3, 5</td>
              <td align="left">6, 7</td>
              <td align="left">242 (283), 120 (124)</td>
            </tr>
            <tr>
              <td/>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">PAGE</td>
              <td align="left">4</td>
              <td align="left">1.0E-170, 2.0E-85</td>
              <td align="left">6, 4</td>
              <td align="left">8, 6</td>
              <td align="left">698 (757), 585 (655)</td>
            </tr>
            <tr>
              <td/>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">GSEA</td>
              <td align="left">1</td>
              <td align="left">5.7E-3, 6.4E-3</td>
              <td align="left">1, 2</td>
              <td align="left">6, 4</td>
              <td align="left">3 (0), 4 (0)</td>
            </tr>
            <tr>
              <td colspan="7">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">Canonical Pathways</td>
              <td align="left">GAGE</td>
              <td align="left">5</td>
              <td align="left">6.7E-6, 7.5E-4</td>
              <td align="left">10, 9</td>
              <td align="left">10, 9</td>
              <td align="left">20 (16), 10 (8)</td>
            </tr>
            <tr>
              <td/>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">PAGE</td>
              <td align="left">4</td>
              <td align="left">4.2E-26, 3.7E-27</td>
              <td align="left">2, 3</td>
              <td align="left">4, 3</td>
              <td align="left">170 (202), 153 (186)</td>
            </tr>
            <tr>
              <td/>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">GSEA</td>
              <td align="left">0</td>
              <td align="left">1.1E-2, 1.4E-2</td>
              <td align="left">1, 1</td>
              <td align="left">5, 5</td>
              <td align="left">2 (0), 4 (0)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The top 10 most significantly enriched experimental sets and canonical pathways in poor clinical outcomes vs good outcomes were inferred by GAGE, PAGE, and GSEA from two published lung adenocarcinoma data sets used in the GSEA paper [<xref ref-type="bibr" rid="B3">3</xref>]. Data columns are overlap between top 10 gene sets for the two studies, top 10 p-values, number of top 10 gene sets related to metastasis (bt) and tumor (t and bt), and numbers of significant gene sets with p-value ≤ 0.001 (or FDR q-value ≤ 0. 01).</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Several major mechanistic themes predictive of poor clinical outcomes emerged from the list of top gene sets inferred by GAGE. These themes included G-protein coupled receptors (GPCRS) associated signals (sets 1, 2, 6, 9, 10 of Boston and sets 1, 2, 7 of Michigan in Table <xref ref-type="table" rid="T1">1</xref>), thrombosis or blood coagulation activation (sets 3, 4, 5, 8 of Boston and set 8, 10 of Michigan in Table <xref ref-type="table" rid="T1">1</xref>), and hormone and cytokine (sets ranking &gt;10 of Boston not shown, and set 3, 4, 9 of Michigan in Table <xref ref-type="table" rid="T1">1</xref>). Indeed, G-protein-coupled receptors, the largest family of cell-surface molecules involved in signal transmission, have emerged as crucial players in the growth and metastasis of multiple human cancers [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B25">25</xref>]. Thrombosis or blood coagulation activation has been implicated in the disease and is an predictor for poor survival rates for lung cancer patients [<xref ref-type="bibr" rid="B26">26</xref>,<xref ref-type="bibr" rid="B27">27</xref>]. Androgen level and cytokine profiles influence clinic outcomes of non-small cell lung cancer [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B29">29</xref>]. All these factors are likely the major causal or contributing mechanisms for non-small cell lung cancer progress and metastasis.</p>
      <p>We also applied GAGE, PAGE and GSEA to another large dataset describing type 2 diabetes progression that was analyzed by GSEA [<xref ref-type="bibr" rid="B4">4</xref>] and PAGE [<xref ref-type="bibr" rid="B5">5</xref>] previously (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 6–7 and Supplementary Note 2). This comparison performed similarly to the cancer study mentioned above. In particular, GAGE pinpointed multiple experimental sets and canonical pathways which are directly involved in type 2 diabetes or closely related metabolism processes.</p>
    </sec>
    <sec>
      <title>Application to small datasets with PAGE and GSEA-g (GSEA with gene permutation option) as control methods</title>
      <p>We applied GAGE and PAGE to a microarray dataset generated by our group to select the most differentially expressed gene sets in human mesenchymal stem cells (MSC) upon BMP6 treatment (Table <xref ref-type="table" rid="T3">3</xref> and <xref ref-type="table" rid="T4">4</xref>, Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 8). The dataset contains a total of 4 gene chip measurements from duplicate experiments each with paired measurements of human MSC with or without 8 hours BMP6 treatment. Note that GSEA by default is not applicable to this dataset because the sample size is too small for permutation based inference. However, GSEA with gene labels permutation option (GSEA-g) works. Since GSEA-g does not implement the sample randomization strategy recommended by the authors [<xref ref-type="bibr" rid="B3">3</xref>], we focus on comparing GAGE to PAGE here (Table <xref ref-type="table" rid="T4">4</xref>, Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 9–10). GAGE conducts one-on-one comparisons, hence was applied to each of the two BMP6 experiments individually (Table <xref ref-type="table" rid="T3">3</xref>). For an exact comparison, PAGE was slightly modified to enable one-on-one comparisons (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 8). The GSEA software took multiple samples per condition hence not applicable to the experiments individually (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 9).</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>GAGE applied to the BMP6-MSC dataset of small sample size</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Experimental Sets</td>
              <td align="left">t-statistic</td>
              <td align="left">p-value</td>
              <td align="left">q-value</td>
              <td align="left">P.exp1</td>
              <td align="left">P.exp2</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Ifna_Hcmv_6hrs_Up</td>
              <td align="left">-3.80</td>
              <td align="left">2.9E-07</td>
              <td align="left">2.9E-04</td>
              <td align="left">3.7E-04</td>
              <td align="left">1.6E-04</td>
            </tr>
            <tr>
              <td align="left">Der_Ifnb_Up</td>
              <td align="left">-3.47</td>
              <td align="left">1.6E-06</td>
              <td align="left">8.1E-04</td>
              <td align="left">3.3E-03</td>
              <td align="left">1.1E-04</td>
            </tr>
            <tr>
              <td align="left">Baf57_Bt549_Dn</td>
              <td align="left">-3.09</td>
              <td align="left">1.4E-05</td>
              <td align="left">0.005</td>
              <td align="left">7.2E-03</td>
              <td align="left">5.2E-04</td>
            </tr>
            <tr>
              <td align="left">Ifn_Beta_Up</td>
              <td align="left">-2.92</td>
              <td align="left">5.4E-05</td>
              <td align="left">0.012</td>
              <td align="left">1.2E-02</td>
              <td align="left">1.3E-03</td>
            </tr>
            <tr>
              <td align="left">Sana_Ifng_Endothelial_Up</td>
              <td align="left">-2.88</td>
              <td align="left">6.6E-05</td>
              <td align="left">0.014</td>
              <td align="left">1.2E-02</td>
              <td align="left">1.7E-03</td>
            </tr>
            <tr>
              <td align="left">Ifn_Any_Up</td>
              <td align="left">-2.76</td>
              <td align="left">1.1E-04</td>
              <td align="left">0.019</td>
              <td align="left">2.4E-02</td>
              <td align="left">1.4E-03</td>
            </tr>
            <tr>
              <td align="left">Dac_Bladder_Up</td>
              <td align="left">-2.65</td>
              <td align="left">2.8E-04</td>
              <td align="left">0.036</td>
              <td align="left">2.4E-03</td>
              <td align="left">4.0E-02</td>
            </tr>
            <tr>
              <td align="left">Grandvaux_Ifn_Not_Irf3_Up</td>
              <td align="left">-2.76</td>
              <td align="left">2.8E-04</td>
              <td align="left">0.037</td>
              <td align="left">3.8E-02</td>
              <td align="left">2.6E-03</td>
            </tr>
            <tr>
              <td align="left">Ifna_Uv-Cmv_Common_Hc</td>
              <td align="left">-2.55</td>
              <td align="left">5.1E-04</td>
              <td align="left">0.056</td>
              <td align="left">1.6E-02</td>
              <td align="left">1.1E-02</td>
            </tr>
            <tr>
              <td align="left">Bennett_Sle_Up</td>
              <td align="left">-2.48</td>
              <td align="left">7.3E-04</td>
              <td align="left">0.071</td>
              <td align="left">1.4E-02</td>
              <td align="left">2.0E-02</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">Canonical Pathways</td>
              <td align="left">t-statistic</td>
              <td align="left">p-value</td>
              <td align="left">q-value</td>
              <td align="left">P.exp1</td>
              <td align="left">P.exp2</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">Tgf_Beta_Signaling_Pathway</td>
              <td align="left">3.15</td>
              <td align="left">2.2E-05</td>
              <td align="left">0.009</td>
              <td align="left">1.2E-03</td>
              <td align="left">1.3E-03</td>
            </tr>
            <tr>
              <td align="left">Wnt_Signaling</td>
              <td align="left">2.47</td>
              <td align="left">5.9E-04</td>
              <td align="left">0.099</td>
              <td align="left">3.2E-03</td>
              <td align="left">1.7E-02</td>
            </tr>
            <tr>
              <td align="left">Alkpathway</td>
              <td align="left">2.46</td>
              <td align="left">8.8E-04</td>
              <td align="left">0.11</td>
              <td align="left">9.8E-03</td>
              <td align="left">8.7E-03</td>
            </tr>
            <tr>
              <td align="left">Proliferation_Genes</td>
              <td align="left">2.27</td>
              <td align="left">1.3E-03</td>
              <td align="left">0.13</td>
              <td align="left">6.8E-03</td>
              <td align="left">1.9E-02</td>
            </tr>
            <tr>
              <td align="left">Cell_Proliferation</td>
              <td align="left">2.24</td>
              <td align="left">1.5E-03</td>
              <td align="left">0.15</td>
              <td align="left">2.1E-02</td>
              <td align="left">7.5E-03</td>
            </tr>
            <tr>
              <td align="left">Hematopoesis_Related_Trans</td>
              <td align="left">2.05</td>
              <td align="left">3.9E-03</td>
              <td align="left">0.31</td>
              <td align="left">1.8E-02</td>
              <td align="left">2.5E-02</td>
            </tr>
            <tr>
              <td align="left">Erythpathway</td>
              <td align="left">1.98</td>
              <td align="left">7.5E-03</td>
              <td align="left">0.46</td>
              <td align="left">2.7E-02</td>
              <td align="left">3.5E-02</td>
            </tr>
            <tr>
              <td align="left">Smooth_Muscle_Contraction</td>
              <td align="left">1.79</td>
              <td align="left">1.0E-02</td>
              <td align="left">0.54</td>
              <td align="left">2.7E-02</td>
              <td align="left">5.2E-02</td>
            </tr>
            <tr>
              <td align="left">Apoptosis</td>
              <td align="left">1.73</td>
              <td align="left">1.3E-02</td>
              <td align="left">0.60</td>
              <td align="left">7.1E-02</td>
              <td align="left">2.5E-02</td>
            </tr>
            <tr>
              <td align="left">Breast_Cancer_Estrogen_Signaling</td>
              <td align="left">1.61</td>
              <td align="left">2.0E-02</td>
              <td align="left">0.69</td>
              <td align="left">8.1E-02</td>
              <td align="left">3.6E-02</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Top 10 most significantly differentially expressed experimental sets and canonical pathways were inferred by GAGE from human MSCs following an 8 hour BMP6 treatment. Two replicate experiments were done, each with BMP6 treated sample and control. Therefore GAGE was applied to each experiment and derived corresponding p-values (P.exp1–2). Gene sets were ranked based on global p-values from both experiments. FDR q-values were estimated to correct the global p-values for the multiple testing issue.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T4">
        <label>Table 4</label>
        <caption>
          <p>Comparison between GAGE, PAGE and GSEA-g results from the BMP6-MSC dataset</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Gene Sets &amp; Methods</td>
              <td/>
              <td align="left">Top 10 abs(T/Z)</td>
              <td align="left">Top 10 p-values</td>
              <td align="left">Sign. Sets</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Experiment Sets</td>
              <td align="left">GAGE</td>
              <td align="left">2.48</td>
              <td align="left">7.3E-04</td>
              <td align="left">39 (13)</td>
            </tr>
            <tr>
              <td/>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">PAGE</td>
              <td align="left">24.6</td>
              <td align="left">1.3E-131</td>
              <td align="left">864 (940)</td>
            </tr>
            <tr>
              <td/>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">GSEA-g</td>
              <td align="left">1.97</td>
              <td align="left">&lt;1.0E-3</td>
              <td align="left">86 (77)</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">Canonical Pathways</td>
              <td align="left">GAGE</td>
              <td align="left">1.61</td>
              <td align="left">2.0E-2</td>
              <td align="left">7 (2)</td>
            </tr>
            <tr>
              <td/>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">PAGE</td>
              <td align="left">10.9</td>
              <td align="left">8.8E-28</td>
              <td align="left">248 (297)</td>
            </tr>
            <tr>
              <td/>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">GSEA-g</td>
              <td align="left">1.53</td>
              <td align="left">6.8E-2</td>
              <td align="left">6 (0)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The significantly enriched experimental sets and canonical pathways in human MSC following 8 hour BMP6 treatment were inferred by GAGE, PAGE and GSEA-g (permutation of gene labels). Top 10 t- (GAGE) or z- (PAGE) statistics or NES (GSEA) and p-values and the numbers of significant gene sets were shown with p-value ≤ 0.01 (or FDR q-value ≤ 0.10). Note that GSEA-g results shown were based on nominal p-values (or FDR q-values).</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Using a p-value cutoff of &lt;0.01, GAGE identified fewer gene sets than PAGE (Table <xref ref-type="table" rid="T4">4</xref>). GAGE identified 39 significant experimental sets and 7 canonical pathways (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). There were only 17 significant experimental sets and 4 canonical pathways (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>) after removing the redundancy among gene sets, which is reasonable number of pathways triggered by a single perturbation in a single cell line. In contrast, PAGE called 745 significant experimental sets and 187 significant canonical pathways. Most significant genes sets selected by PAGE were not significant according to GAGE using the same cutoff p-value (full result tables not shown). After removing the redundancy in these sets, there were more than 200 and 40 non-redundant experimental sets and canonical pathways respectively (not shown, Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Note 3). Presumably, PAGE made a large number of false positive calls. Similar differences between GAGE and PAGE were observed for the two lung cancer datasets and the type 2 diabetes dataset (Table <xref ref-type="table" rid="T2">2</xref> and Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 7). This difference came from the different statistical tests used by GAGE and PAGE, i.e. two-sample t-test vs one-sample z-test (detailed in the subsection of 'Dissection of major strategies employed by GAGE'). GSEA-g gave p-values and a predicted number of significant gene sets comparable to GAGE when nominal p-values were used (Table <xref ref-type="table" rid="T4">4</xref> and Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 9, full Table not shown).</p>
      <p>Biologically, GAGE gene sets were mechanistically more relevant for BMP6 effects compared to those sets selected by PAGE. 9 out of 10 experimental sets inferred by GAGE (Table <xref ref-type="table" rid="T3">3</xref>) are directly related to interferon or STAT pathway [<xref ref-type="bibr" rid="B30">30</xref>], which is a target of BMP signaling [<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B32">32</xref>]. The experimental sets selected by PAGE alone have less connection to BMP (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 8). GAGE and PAGE differed in 8 entries of the top 10 canonical pathways. Of GAGE predictions (Table <xref ref-type="table" rid="T3">3</xref>), Wnt signaling [<xref ref-type="bibr" rid="B33">33</xref>,<xref ref-type="bibr" rid="B34">34</xref>], proliferation [<xref ref-type="bibr" rid="B35">35</xref>,<xref ref-type="bibr" rid="B36">36</xref>] are all known pathways or processes regulated by BMPs in MSC or osteoblastic cell lineages. BMPs regulate hematopoiesis and erythrocyte differentiation [<xref ref-type="bibr" rid="B37">37</xref>,<xref ref-type="bibr" rid="B38">38</xref>]. Breast cancer estrogen signaling interacts with BMP signal [<xref ref-type="bibr" rid="B39">39</xref>,<xref ref-type="bibr" rid="B40">40</xref>]. None of these pathways were significant according to PAGE (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 8, full result table not shown). The GSEA-g top experimental sets overlapped with GAGE, but the canonical pathways were more similar to PAGE (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 10).</p>
      <p>Significant gene sets inferred by GAGE were consistent across replicate experiments and within the top 10 lists. The top 10 gene sets are almost the same if we used either one of the two experiments only (Table <xref ref-type="table" rid="T3">3</xref>). The difference between the p-values from the two experiments almost never exceeded one order of magnitude. On the other hand, the top 10 gene set lists inferred by the PAGE and corresponding p-values are more different across the two experiments (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 8, not all top sets for individual experiments included). There was also high level of internal consistency in the top 10 gene sets inferred by GAGE (Table <xref ref-type="table" rid="T3">3</xref>). For example, 9 out of 10 experimental sets were directly related to interferon signal. Among the canonical pathways, there were two proliferation and two hematopoietic differentiation related pathways. In addition the high scoring Alk pathway overlapped with TGF beta and Wnt signaling pathways. In contrast, the PAGE and GSEA-g top gene sets had lower internal consistencies (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 8–9). These results indicate that GAGE is a method robust against the heterogeneity in experiments or gene set definition. Notice that redundant gene sets representative of the same effect or pathway were kept here for exact comparison between methods, but they can be differentiated and combined by GAGE program if needed (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>).</p>
    </sec>
    <sec>
      <title>A microarray data based simulation study</title>
      <p>We conducted simulation study to compare the performance of GAGE vs GSEA and PAGE in a more controllable setting. To minimize the potential artifact of using synthetic data, we used the type 2 diabetes dataset which has been analyzed in the first part of the Results. We chose this large clinical dataset so that all methods including the sample randomization based GSEA are applicable. Also, to make the simulation tractable for GSEA, we employed a sub-dataset with 2000 randomly sampled genes from the full set of 17000 genes. While the dataset is real microarray data, we synthesized the testing gene sets with controlled levels of differential expression (or degrees of enrichment in up- or down- regulated genes, details described in Methods). We then applied GAGE, PAGE or GSEA to score these testing gene sets, and evaluated whether the enrichment scores reasonably reflect the differential expression levels of these testing gene sets.</p>
      <p>Similar to the analysis results described above, while GAGE and GSEA gave more sensible p-values in the simulation, PAGE resulted in unrealistically small p-values on the order of 10<sup>-324</sup>. (Figure <xref ref-type="fig" rid="F2">2c</xref>). The fact that p-values started from 10<sup>-11 </sup>(n = 10) or 10<sup>-15 </sup>(n = 50) for gene sets with no up-regulation at all (β = α = 1) shows that PAGE suffers from low specificity. In other words, the extremely small p-values did not indicate high sensitivity but rather a high false positive rate for PAGE. On the other hand, GAGE and GSEA are selective and started from insignificant p-values for the negative control gene sets with β = α = 1. Compared to GSEA, GAGE gave smaller p-value for gene sets with different levels of up-regulation (Figure <xref ref-type="fig" rid="F2">2a–b</xref>). In other words, GAGE is more sensitive than GSEA. This improvement does not come at the cost of lower specificity (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Figure 2a-b and detailed next). Note that GSEA reached sensitivity cap (around β = 7 for n = 10 and β = 4 for n = 50, Figure <xref ref-type="fig" rid="F2">2a–b</xref>). Out of all three methods, only GAGE produced strictly monotonically decreasing p-value curves that closely reflected the increasing up-regulation levels of the testing gene sets with increasing β.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>A simulation study using microarray data and synthetic testing gene sets</bold>. (a-c) p-values on the differential expression of testing gene sets with increasing levels of enrichment of up-regulated genes, when GAGE (a, b), GSEA (a, b) and PAGE (c) were applied. (d) The series of beta distribution curves with 1 ≤ β ≤ 10 and fixed α = 1 used to sample the testing gene sets with increasing levels of up-regulation from a sorted whole gene list. For each β value, we generated testing gene sets of two different size n = 10 genes (small sets) and n = 50 genes (large sets), 100 gene sets each. We then applied GAGE, PAGE or GSEA to test the overall expression level up-regulation in these gene sets. Mean p-values plus with standard error were shown. See Methods and Results for details. Note that GAGE with both 1-on-1 and 1-on-grp options produces similar results, although only the former is shown here.</p>
        </caption>
        <graphic xlink:href="1471-2105-10-161-2"/>
      </fig>
      <p>We further compared the p-values inferred by these three methods under null condition by using testing gene sets with strictly no up-regulation (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Figure 2). GAGE with 1-on-1 and grp-on-grp options and GAGE-r (details in Methods) derived null p-values closely following a uniform distribution. This further confirmed the theoretical soundness of GAGE, and that the improved sensitivity of GAGE (Figure <xref ref-type="fig" rid="F2">2a–b</xref>) compared to GSEA does not rely on a bias in the null distribution (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Figure 2a-b). The null simulation indicates that both GAGE and GSEA are equally selective against false positive (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Figure 2a-b). However, simulation with different levels of up-regulated gene sets shows GAGE is more sensitive to true positive (i.e. real difference) (Figure <xref ref-type="fig" rid="F2">2a–b</xref>). GAGE with the 1-on-grp option (details in Methods) derived null p-values that are slightly different from the uniform distribution, and is more likely to produce false positive results compared to GAGE with the default 1-on-1 option. However, the GAGE 1-on-grp comparison would still work reasonably well as a computationally fast option based on our results using experimental data (Table <xref ref-type="table" rid="T5">5</xref>). In contrast, PAGE derived an extremely biased null p-value distribution. Over 40% of the p-values are essentially 0, another 40–50% are 1. Clearly, in consistent with all our earlier observations, PAGE produces a high false positive rate.</p>
      <table-wrap position="float" id="T5">
        <label>Table 5</label>
        <caption>
          <p>The three comparison schemes of GAGE, 1-on-1, 1-on-grp and grp-on-grp</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Gene Sets &amp; Methods</td>
              <td/>
              <td align="left">Overlap</td>
              <td align="left">Top 10 p-values</td>
              <td align="left">Metastasis</td>
              <td align="left">Tumor</td>
              <td align="left">Sign. Sets</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Experimental Sets</td>
              <td align="left">1-on-1</td>
              <td align="left">4</td>
              <td align="left">1.3E-28, 1.2–9</td>
              <td align="left">2, 3</td>
              <td align="left">5, 5</td>
              <td align="left">201 (254), 55 (47)</td>
            </tr>
            <tr>
              <td/>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">1-on-grp</td>
              <td align="left">4</td>
              <td align="left">4.2E-35, 2.4E-13</td>
              <td align="left">3, 5</td>
              <td align="left">6, 7</td>
              <td align="left">242 (283), 120 (124)</td>
            </tr>
            <tr>
              <td/>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">grp-on-grp</td>
              <td align="left">3</td>
              <td align="left">6.5E-8, 1.8E-4</td>
              <td align="left">3, 4</td>
              <td align="left">6, 8</td>
              <td align="left">52 (69), 17 (0)</td>
            </tr>
            <tr>
              <td colspan="7">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">Canonical Pathways</td>
              <td align="left">1-on-1</td>
              <td align="left">6</td>
              <td align="left">7.2E-5, 3.7E-03</td>
              <td align="left">9, 9</td>
              <td align="left">9, 9</td>
              <td align="left">18 (12), 8 (5)</td>
            </tr>
            <tr>
              <td/>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">1-on-grp</td>
              <td align="left">5</td>
              <td align="left">6.7E-6, 7.5E-4</td>
              <td align="left">10, 9</td>
              <td align="left">10, 9</td>
              <td align="left">20 (16), 10 (8)</td>
            </tr>
            <tr>
              <td/>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="left">grp-on-grp</td>
              <td align="left">0</td>
              <td align="left">1.1E-1, 6.1E-2</td>
              <td align="left">4, 5</td>
              <td align="left">6, 5</td>
              <td align="left">0 (0), 0 (0)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Top 10 significantly enriched experimental sets and canonical pathways in poor clinical outcomes vs good outcomes were inferred by GAGE using these three different comparison schemes from two published lung adenocarcinoma data sets [<xref ref-type="bibr" rid="B3">3</xref>]. Data columns are overlap between top 10 gene sets for the two studies, top 10 p-values, number of top 10 gene sets related to metastasis (bt) and tumor (t and bt), and numbers of significant gene sets with p-value ≤ 0.001 (or with FDR q-value ≤ 0.01).</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Impact of GAGE strategies: gene set separation, two-sample t-test, and one-on-one comparisons</title>
      <p>Compared to PAGE and GSEA, GAGE employs three different strategies: 1) gene set separation, 2) two-sample t-test, and 3) one-on-one comparisons between experiment and control samples. In this section, we show the impact of each of these three strategies in representative analyses, although these strategies have been consistently effective when applied to multiple datasets covered or not covered in this paper. We compare GAGE to PAGE on these aspects if possible, or to GAGE variants which ensembles PAGE in each one of these three aspects for exact comparison. GSEA is either not or less comparable in these aspects.</p>
      <sec>
        <title>Gene set separation</title>
        <p>In contrast to PAGE and GSEA, GAGE separates canonical pathways from experimental sets and considers potential perturbations in both directions (i.e. up and down regulation simultaneously) in canonical pathways. Expression data directly showed that genes in the most relevant canonical pathways are regulated in both directions (Figure <xref ref-type="fig" rid="F3">3</xref>). Figure <xref ref-type="fig" rid="F3">3a</xref> shows the gene expression level changes following BMP6 treatment in top 3 different significant canonical pathways inferred by GAGE and PAGE (Table <xref ref-type="table" rid="T3">3</xref> and Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 8). These canonical pathways inferred by GAGE are directly related to BMP induced osteoblast differentiation [<xref ref-type="bibr" rid="B34">34</xref>,<xref ref-type="bibr" rid="B35">35</xref>] (Alk pathway is essentially TGF Beta signaling + Wnt signaling). Figure <xref ref-type="fig" rid="F3">3b</xref> shows the gene expression level changes in the TGF beta-BMP signaling pathway following BMP6 treatment. This pathway is a presumable gold standard as it is the primary signal triggered directly by BMPs (KEGG). The changes of gene expression are not uniform. The TGF-beta pathway includes both positive effectors such as BMPs, BMPR1–2, SMAD1/5/8, ID1–4, and THBS, and negative effectors such as NOG, SMAD2/3, and SMAD6/7. Clearly, both types of effectors were regulated up and down. Genes are regulated in both directions not only for the whole pathway but also within the sub-pathways like BMP or TGF-beta signaling branches. These results demonstrate that genes in canonical pathways are frequently up- and down-regulated simultaneously because 1) they play positive or negative roles [<xref ref-type="bibr" rid="B20">20</xref>] and 2) homeostatic mechanisms tend to bring a certain level of balance back to the system when it is perturbed [<xref ref-type="bibr" rid="B19">19</xref>]. Therefore, it is necessary to treat canonical pathways differently from experimental sets and count both up and down regulation when doing gene set analyses.</p>
        <fig position="float" id="F3">
          <label>Figure 3</label>
          <caption>
            <p><bold>GAGE captured canonical pathways which are significantly perturbed towards both directions following 8 h BMP6 treatment in human MSC</bold>. (a) Gene expression level changes in the top 3 different significant canonical pathways inferred by GAGE and PAGE. (b) Gene expression level changes in the canonical TGF beta signaling pathway and (c) plotted in pseudo-color on the pathway topology derived from KEGG database. The solid horizontal line and dashed lines in (a-b) mark the mean fold changes of all genes and the positive/negative two times standard deviation from the mean respectively. Note that in (c), one KEGG node may correspond to multiple closely related genes with the same function, and the maximum fold changes among these genes are plotted as the color of the node.</p>
          </caption>
          <graphic xlink:href="1471-2105-10-161-3"/>
        </fig>
        <p>Compared to the top 10 canonical pathways assuming one-way changes, the top 10 canonical pathways allowing two-way changes better described BMP induced osteoblast differentiation mechanistically (Table <xref ref-type="table" rid="T3">3</xref> and Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 11). TGF beta signaling, Wnt signaling and cell proliferation are all known essential signals or processes for osteoblast differentiation [<xref ref-type="bibr" rid="B34">34</xref>,<xref ref-type="bibr" rid="B35">35</xref>], yet they are not significant in the one-way changing list (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 11, full Table not shown). One-way assumption tends to select metabolism pathways (6 out of 10 canonical pathways in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 11), which are likely to be tightly coregulated as relative simple functional group. In other words, top canonical pathways with one-way changes are still interesting if they are not complicated regulatory pathways.</p>
      </sec>
      <sec>
        <title>Two-sample t-test</title>
        <p>GAGE uses a two-sample t-test to compare expression level changes of a gene sets to the whole set background, whereas PAGE uses a one-sample z-test. GAGE's use of a two-sample t-test has three effects. First, two-sample t-test considers the variance for both the target gene set distribution as well as the background distribution (Formula 1), while a one-sample z-test only considers the variance for the background distribution and ignores the effect of specific target gene set distribution (Formula 2). The background variance is small and often negligible compared to the within gene set variance, hence PAGE can produce unrealistically large z-scores and small p-values (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 8) in contrast to GAGE (Table <xref ref-type="table" rid="T3">3</xref>). Second, the two-sample t-test used by GAGE identifies gene sets with modest but consistent changes in gene expression level, whereas PAGE tends to identify gene sets with a few extremely changed outliers (Figure <xref ref-type="fig" rid="F4">4</xref>, more comments in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Note 4). In other words, GAGE is more robust to experimental noise or variations in gene set definitions than PAGE. Many top gene sets selected by PAGE were not significant according to GAGE (Table <xref ref-type="table" rid="T3">3</xref>, Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 8, full tables not shown) because the within gene set variance is too large (Figure <xref ref-type="fig" rid="F5">5</xref>). On the other hand, significant gene sets inferred by GAGE are almost always selected as significant by PAGE (Table <xref ref-type="table" rid="T3">3</xref>, Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 8, full tables not shown). Said another way, GAGE is as sensitive (high true positive calls) as PAGE, but more specific (low false positive calls) than PAGE (also see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Figure 2a-b). Third, there is higher level of consistency within the top 10 gene sets inferred by GAGE (Table <xref ref-type="table" rid="T3">3</xref>) than by PAGE (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 8), and between the top 10 gene sets across experiments (Table <xref ref-type="table" rid="T3">3</xref> vs Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 8). This consistency is because the two-sample t-test is more robust than one-sample z-test for gene set analysis. All these observations for PAGE also apply to GAGE-z (GAGE variant doing one-sample z-test, Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 12).</p>
        <fig position="float" id="F4">
          <label>Figure 4</label>
          <caption>
            <p><bold>Differential gene expression in the top 2 significant experimental sets inferred by GAGE or PAGE</bold>. Gene expression levels are log 2 based, and compared between human MSC with 8 hour BMP6 treatment vs control. Results for the first experiment are shown, and the second replicate experiment is similar.</p>
          </caption>
          <graphic xlink:href="1471-2105-10-161-4"/>
        </fig>
        <fig position="float" id="F5">
          <label>Figure 5</label>
          <caption>
            <p><bold>Gene expression fold changes (log 2 based) in the top 3 significant experimental sets inferred by GAGE or PAGE</bold>. For each gene set, the bar height represents mean and error bar represent standard error of gene expression fold changes induced by 8 hour BMP6 treatment in human MSC. GAGE uses two-sample t-test and PAGE does one-sample z-test. PAGE frequently selected gene sets with extreme up or down regulation in a few genes and almost no changes in the rest. Such gene sets have too large within-group variances to be called significantly different from the background based on two-sample t-test, even though their mean fold changes are big.</p>
          </caption>
          <graphic xlink:href="1471-2105-10-161-5"/>
        </fig>
        <p>With the classical two-sample t-test as the default of GAGE, we also looked at a rank-based two-sample t-test as an alternative (GAGE-r), which is potentially less sensitive to the violation of normal distribution assumption and expression outliers. GAGE-r gave similar results (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 13) in terms of the significant gene set list, the number of significant gene sets (not shown), p-values and q-values. This result further confirmed the robustness of GAGE method and validated two-sample t-test as the default option.</p>
      </sec>
      <sec>
        <title>One-on-one comparisons</title>
        <p>GAGE carries out one-on-one comparisons between experiments and controls, whereas PAGE compares experiments and controls as two groups together. One-on-one comparisons are natural when the experiment samples and controls are paired. This one-on-one pairing is still preferred over group-on-group comparison even though experiments are not pair-matched for two reasons. First, multiple tests on all experiment-control pairs are more statistically powerful than single test on group averages, as the p-values (hence FDR q-values) would be orders of magnitude smaller for the one-on-one comparisons versus the group comparisons (Table <xref ref-type="table" rid="T5">5</xref>, and Table <xref ref-type="table" rid="T3">3</xref> vs Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 14). Second, comparisons between two specific samples makes sense but not between two sample groups when the net effect of the whole gene set is non-additive, for instance, being expressed as mean of the absolute fold changes for canonical pathways (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Note 5). As expected, a one-on-one comparison approach produced more consistent and biologically meaningful results across independent studies (Table <xref ref-type="table" rid="T5">5</xref>). The enumeration of all one-on-one comparisons is not always advantageous as it can be relative slow for datasets with large number of replicates. To speed up the analysis of larger datasets, we can take the average gene expression levels for all controls as a single reference state and do gene set analysis on each experiment sample vs this reference state, because controls are often more homogenous than experiments. Correspondingly, GAGE has the options for three-way comparison schemes specified as 1-on-1, 1-on-grp and grp-on-grp. The option 1-on-grp produces similar results to 1-on-1 but different results to grp-on-grp (Table <xref ref-type="table" rid="T5">5</xref> and Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 15). The difference between these three options is better shown when the sample conditions are complicated as in the large clinical datasets above.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>In this work we have presented a new gene set analysis method GAGE that is generally applicable to gene expression datasets of all sample sizes and experimental designs and in general performs better than two most frequently used methods. We have demonstrated GAGE's performance by comparing it to GSEA and PAGE extensively in the following three aspects: (1) consistency across parallel studies or experiments; (2) sensitivity and specificity of the pathway inference; (3) biological relevance of the pathways identified.</p>
    <p>Our results show a significant impact of separating gene sets into pathway and experimentally derived gene sets as is shown in Figure <xref ref-type="fig" rid="F3">3</xref>. We showed that two-way perturbations commonly occur in regulatory pathways (Figure <xref ref-type="fig" rid="F3">3</xref> and Table <xref ref-type="table" rid="T1">1</xref>, also in Table <xref ref-type="table" rid="T3">3</xref> and Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 6), which would otherwise be overlooked (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 11). However, pathway derived gene sets do not always show regulation in both directions. For example, we see that metabolic pathways or functional groups such as GO term categories tend to be coregulated toward one direction (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 11). Strictly speaking, many of these gene sets are not signaling pathways and could be further separated from canonical signaling pathways (such as in MSigDB collection c2). In response to this observation, GAGE provides the option for two rounds of screening on MSigDB pathway sets. The first round assumes two-way regulation for regulatory signaling pathways while the second round assumes one-way for coregulated functional groups.</p>
    <p>GAGE made two assumptions in conducting two sample t-tests on the log based fold changes of target gene set and control sets. The first assumption is approximate normal distribution for the mean fold change of the two sets. The central limit theorem states that the distribution of an average of sampled observations is normal regardless of the nature of parent distribution when sampling size is large enough. Indeed, the mean of fold change values for gene sets with ≥ 10 genes are close to normal distribution as shown by q-q plot previously [<xref ref-type="bibr" rid="B5">5</xref>]. The second assumption is that the fold changes of genes are independent and identically distributed (IID). Dependency between genes has been a concern for all gene randomization methods [<xref ref-type="bibr" rid="B11">11</xref>]. However, Netwon et al [<xref ref-type="bibr" rid="B6">6</xref>] argued that dependency is not necessarily an issue when GSA was conditioned on the differential expression analysis results (like fold changes). Moreover, we think dependency (coregulation) is rare for randomly sampled control gene sets. For most curated gene sets there is no coregulation under the specific condition of the microarray study (even though they might be under certain other condition), and the null hypothesis holds. For the few interesting gene sets where genes are coregulated, there will be a significant difference in expression between these sets and random control sets, hence the null hypothesis gets rejected. Therefore, gene sets which violate the IID assumption are the few significant sets and will be captured this way [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>]. GAGE results clearly showed that our arguments work. The same logic has also been quite successful in well established gene randomization methods [<xref ref-type="bibr" rid="B5">5</xref>-<xref ref-type="bibr" rid="B7">7</xref>].</p>
    <p>The one-on-one comparison scheme is generally applicable to datasets of all sample sizes and experiment designs. We used a meta-test to infer a global p-value for all the individual comparison p-values. The global p-values and the number of significant gene sets we derived are sensible. As in common statistical tests, these p-values tend to decrease when the sample size increases, and can become small for large datasets like the lung cancer datasets (Table <xref ref-type="table" rid="T1">1</xref>), hence the number of significant gene sets can be large especially when all the redundant gene sets are kept (Table <xref ref-type="table" rid="T2">2</xref> and Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 7). This result is still sensible because large clinical datasets (like the lung cancer studies) are generally more heterogeneous than small experimental datasets (like the BMP6 study).</p>
    <p>There are frequently multiple significant gene sets that share multiple genes or represent the same regulatory mechanism, especially for experimental gene sets. This redundant gene sets problem has been discussed elsewhere in detail [<xref ref-type="bibr" rid="B41">41</xref>]. In response to this issue, GAGE has the option to combine redundant gene sets and give more concise significant gene set lists (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). In this work, we chose not to combine these redundant gene sets for exact comparison between methods. As a benefit of not merging these sets, we took these overlapping sets as an internal control to validate the internal consistency of the predictions.</p>
    <p>There is also a multiple testing issue, i.e. gene sets may become significant when the gene set number is large. Classical FDR procedures like Benjamini-Hochberg (BH) [<xref ref-type="bibr" rid="B42">42</xref>] and Bonferroni [<xref ref-type="bibr" rid="B43">43</xref>] corrections tends to be conservative. Such adjustment is further complicated when gene sets contain different numbers of genes (not exactly the same null hypothesis test for different gene sets). Hence gene randomization based GSA methods like PAGE [<xref ref-type="bibr" rid="B5">5</xref>] and T-Profiler [<xref ref-type="bibr" rid="B7">7</xref>] do not consider this adjustment (we added the FDR procedure to PAGE in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 1, 6 and 8 for comparison purpose). Sample randomization based GSA methods like GSEA suffer from conflicting ordering between FDR q-values and nominal p-values (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplementary Table 2, 6 and 9). In GAGE, the one-on-one comparison and one-on-group comparison schemes not only gives us more testing power and robustness, but also provides the framework to conduct a unified and rigorous FDR procedure for gene sets of different sizes. Because the meta-test on <italic>K </italic>p-values (Formula 5, see methods for details) is the same (with the same null hypothesis) for all gene sets despite of their different size.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>In this work, we present a novel method GAGE for gene set analysis (GSA). GAGE is generally applicable to gene expression datasets with different sample sizes and experimental designs, hence greatly expands the applicability of GSA. In both simulation experiments and multiple microarray data analyses, GAGE consistently outperformed two most frequently used GSA methods, GSEA and PAGE in three major aspects: (1) consistency across repeated studies/experiments; (2) sensitivity and specificity; (3) biological relevance of the regulatory mechanisms inferred. GAGE reveals novel and relevant regulatory mechanisms from both published and previously unpublished microarray studies.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>A schematic overview of GAGE procedure is shown in Figure <xref ref-type="fig" rid="F1">1</xref>. Here we describe the major steps of GAGE.</p>
    <sec>
      <title>Gene sets separation</title>
      <p>GAGE uses curated gene sets [<xref ref-type="bibr" rid="B3">3</xref>] collected from individual studies or pathway databases for regulatory mechanisms inference. In contrast to other gene set analysis approaches, GAGE requires that each curated gene set be identified as either a pathway set (canonical pathways) or an experimentally derived differential expression set (experiment sets). GAGE treats these two categories differently. Genes in an experimental set are assumed to be regulated in the same direction, either all up or all down, as they were in the original study. In contrast, genes associated with a pathway gene set may be heterogeneously regulated in either direction. This separation better reflects the origin of the gene set and is therefore expected to produce better results.</p>
      <p>For an experimental set the test statistic (score) used in GAGE is the average of the per-gene test statistics–similar to the scoring scheme used by other gene set analysis methods. However, for canonical pathways GAGE uses the average of the absolute values of the per gene test statistics to account for both up- and down-regulation.</p>
    </sec>
    <sec>
      <title>Significance test</title>
      <p>To test whether a gene set is significantly correlated with a phenotype or an experiment condition, we exam the fold changes of gene expression level in the experiment condition (or phenotype) vs control condition. Correspondingly, we want to test whether the mean fold changes of a target gene set is significantly different from that of the background set (the whole gene set of the microarray). This is a prototype two-sample t-test, as shown in Formula 1, in contrast to the one-sample z-test used in PAGE [<xref ref-type="bibr" rid="B5">5</xref>] shown in Formula 2.</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <graphic xlink:href="1471-2105-10-161-i1.gif"/>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <graphic xlink:href="1471-2105-10-161-i2.gif"/>
        </disp-formula>
      </p>
      <p>Where m, s and n are the mean fold change (log ratio of expression levels), standard deviation, and number of genes in a particular gene set, and M and S are the mean fold change and standard deviation for all of the genes in the dataset. Notice that this is a two sample t-test between the interesting gene set containing n genes and a virtual random set of the same size derived from the background (comparable to the one-sample z-test control set in Formula 2). Two sample t-test would be inaccurate when the two sample sizes are not comparable [<xref ref-type="bibr" rid="B44">44</xref>]. The degree of freedom (df) for this two-sample t-test (Formula 1) with unequal variance is given in Formula 3. The common range for df would be n-1 (when s&gt;&gt;S) to 2n-2 (when s = S). Actually df has little effect on the p-values when n is large enough (for most gene sets), where t-distribution is nearly normal. The assumptions we made for the two-sample t-test are described in the Discussion section in detail.</p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <graphic xlink:href="1471-2105-10-161-i3.gif"/>
        </disp-formula>
      </p>
      <p>With the classical two-sample t-test as the default of GAGE, we also implement a rank-based two-sample t-test [<xref ref-type="bibr" rid="B45">45</xref>] as an alternative (GAGE-r). This rank based t-test is equivalent to the non-parametric Wilcoxon Mann-Whitney test [<xref ref-type="bibr" rid="B45">45</xref>]. These rank based alternatives do not assume normal distribution of the samples and are potentially less prone to outliers compared to the classical parametric two-sample t-test. To conduct the rank test, we transform the data to ranks and then performing the two-sample t-test on the transformed data.</p>
      <sec>
        <title>One-on-one comparison between microarray experiment and control samples</title>
        <p>For microarray studies with one-on-one paired experiment and control samples, we calculate fold changes and carried out gene set significance tests for each experiment versus control sample pair. For microarray studies with multiple unpaired experimental and control samples, GAGE has two options: 1-on-1 and 1-on-grp. In 1-on-1 we enumerate all pairs of experiment-control and do gene set significance tests. In the 1-on-grp option we take the average gene expression level for all control samples as the sole reference, compare each experimental sample against this reference and do gene set significance tests. 1-on-1 is more rigorous theoretically. Our experiment showed that 1-on-grp gives nearly identical results and is much faster when the sample size is large. We take 1-on-1 as our standard, and leave 1-on-grp as a computationally fast option (default for unpaired experiments in this paper). We also implemented the commonly used comparison between experiment group and control group as the grp-on-grp option.</p>
      </sec>
      <sec>
        <title>Combination of multiple comparisons or experiments</title>
        <p>GAGE derived multiple t-statistics and p-values from Formula 1 when doing 1-on-1 or 1-on-grp comparison for datasets with replicate samples. We derive a global p-value by combining these individual p-values. Individual p-value follows a Uniform(0,1) distribution under the null hypothesis of the two-sample t-test and the negative log sum of <italic>K </italic>independent p-values follows a Gamma(<italic>K</italic>,1) distribution. Hence we can do a meta-test for all the p-values of a gene set across multiple samples (Formula 4–5).</p>
        <p>
          <disp-formula id="bmcM4">
            <label>(4)</label>
            <graphic xlink:href="1471-2105-10-161-i4.gif"/>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="bmcM5">
            <label>(5)</label>
            <graphic xlink:href="1471-2105-10-161-i5.gif"/>
          </disp-formula>
        </p>
        <p>Note that this analysis assumes that individual p-values come from independent comparisons. However, the 1-on-1 comparisons are not all independent for unpaired studies (with <italic>k </italic>= 1,., <italic>K </italic>experiments and <italic>l </italic>= 1,., <italic>L </italic>controls), thus we need to take the average of the p-values for all <italic>L </italic>comparisons of a experiment to different controls as the p-value for that experiment (Formula 6) and then apply Formula 5 to these <italic>K </italic>independent p-values.</p>
        <p>
          <disp-formula id="bmcM6">
            <label>(6)</label>
            <graphic xlink:href="1471-2105-10-161-i6.gif"/>
          </disp-formula>
        </p>
        <p>To correct the p-values for the multiple testing issue, we estimate FDR by using fdrtool [<xref ref-type="bibr" rid="B46">46</xref>], a unified approach recently established. Compared to the traditional FDR procedures, fdrtool estimates FDR based on the empirical null distribution, hence allow more realistic and less conservative correction of p-values [<xref ref-type="bibr" rid="B46">46</xref>]. In rare cases, fdrtool may perform less ideal likely due to the extreme distribution of input p-values. We provide the classical Benjamini-Hochberg (BH) [<xref ref-type="bibr" rid="B42">42</xref>] procedure as a backup option.</p>
      </sec>
    </sec>
    <sec>
      <title>Implementation of GAGE</title>
      <p>GAGE is implemented in the statistical computing language R and is freely available online [<xref ref-type="bibr" rid="B47">47</xref>]. The gene sets used in this paper are from the Molecular Signature Database of GSEA website [<xref ref-type="bibr" rid="B23">23</xref>]. From this site, we used the curated gene sets (collection c2), and treat the two sub-collections experimental sets (CGP: chemical and genetic perturbations) and canonical pathways differently. There are 16966 unique gene symbols in c2, 3834 of them are nonstandard. Among these nonstandard symbols, 1190 were converted standard symbols automatically by using GAIQ database [<xref ref-type="bibr" rid="B48">48</xref>]. Database access and scripts for the gene symbol standardization is available upon request.</p>
    </sec>
    <sec>
      <title>Comparison software</title>
      <p>GAGE was compared to two widely used gene set analysis software packages: PAGE and GSEA. GSEA-P-R.1.0 was downloaded form GSEA website [<xref ref-type="bibr" rid="B49">49</xref>], and PAGE is implemented in R as part of GAGE package based on description of the authors [<xref ref-type="bibr" rid="B5">5</xref>] and source codes in PGSEA package [<xref ref-type="bibr" rid="B50">50</xref>].</p>
    </sec>
    <sec>
      <title>Datasets</title>
      <p>The gene set analysis software was compared using three datasets including two large studies and one small one.</p>
      <p>The two large studies included a lung cancer set was provided with GSEA-R package [<xref ref-type="bibr" rid="B49">49</xref>] and a type 2 diabetes dataset comes from ChipperDB [<xref ref-type="bibr" rid="B51">51</xref>]. These datasets were chosen because they were originally used to validate and/or compare GSEA [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>] and PAGE [<xref ref-type="bibr" rid="B5">5</xref>]</p>
      <p>The small dataset is a gene expression study from our group describing human MSC response to 8 hours of exposure to the signaling molecule BMP6. This dataset includes two experimental groups each with paired treatment and control samples, resulting in a total of 4 gene chips. We have deposited the dataset into Gene Expression Omnibus (GEO) repository (accession number GSE13604). For the use in this paper, the raw data were processed by using RMA implemented in the Bioconductor Affy package [<xref ref-type="bibr" rid="B52">52</xref>] with up-to-date probe set definition (.CDF file) based on Entrez Gene sequence, Hs133P_Hs_ENTREZG_8 [<xref ref-type="bibr" rid="B53">53</xref>]. Annotation data were retrieved from the GAIQ website [<xref ref-type="bibr" rid="B48">48</xref>]. The type 2 diabetes dataset was processed similarly from raw data files.</p>
    </sec>
    <sec>
      <title>Synthesize the testing gene sets with controlled levels of differential expression</title>
      <p>While the dataset for simulations study is real microarray data, we synthesized the testing gene sets with controlled levels of differential expression (or degrees of enrichment). We ranked all genes based on average fold change between the two sample groups (i.e. type 2 diabetes samples and controls) from most up-regulated to most down-regulated. We then sampled gene sets following a series of different Beta-distributions in gene ranks. One of the two parameters, α is fixed to 1, and the other parameters β takes values from integer 1 to 10 (Figure <xref ref-type="fig" rid="F2">2d</xref>), which control the shape of Beta distribution (Figure <xref ref-type="fig" rid="F2">2d</xref>) hence the degree of enrichment of the up-regulated genes (or the level of up-regulation of the gene set): the uniform distribution at β = 1 corresponds to no enrichment at all and the highly skewed distribution at β = 10 corresponds to highest enrichment of up-regulated genes (Figure <xref ref-type="fig" rid="F2">2d</xref>). For each β value, we generated 100 testing gene sets of 10 genes (small sets) and 100 sets of 50 genes (large sets). We then applied GAGE, PAGE or GSEA to score these testing gene sets, and evaluated whether the enrichment scores reason ably reflect the differential expression levels of these testing gene sets. Note that α and β are symmetric parameters. When we exchange them, the simulation remains the same except that the gene sets were enriched with down-regulated genes.</p>
    </sec>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>WL and PJW conceived and designed the study; WL and KS designed the statistical procedure; WL conducted the research and wrote the computer program; MSF and KDH conducted the BMP6-MSC microarray experiment. WL, MSF, KS, KDH and PJW drafted the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p>
          <bold>Supplementary tables, figures and notes.</bold>
        </p>
      </caption>
      <media xlink:href="1471-2105-10-161-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional File 2</title>
        <p>
          <bold>Full and non-redundant lists of significant gene sets inferred by GAGE when applied to the BMP6-MSC dataset.</bold>
        </p>
      </caption>
      <media xlink:href="1471-2105-10-161-S2.xls" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>WL, MSF, KDH, and PJW are supported by NIH grant R01 DE017471. In addition, PJW is supported by NIH grant U54-DA-021519 and KDH is supported by NIH grants R01 AR054714 and R01 AR049682.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hankenson</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Woolf</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Learning transcriptional regulatory networks from high throughput gene expression data using continuous three-way mutual information</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>467</fpage>
        <pub-id pub-id-type="pmid">18980677</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-467</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nam</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SY</given-names>
          </name>
        </person-group>
        <article-title>Gene-set approach for expression pattern analysis</article-title>
        <source>Brief Bioinform</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>189</fpage>
        <lpage>97</lpage>
        <pub-id pub-id-type="pmid">18202032</pub-id>
        <pub-id pub-id-type="doi">10.1093/bib/bbn001</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Paulovich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pomeroy</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>15545</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="pmid">16199517</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Lindgren</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Eriksson</surname>
            <given-names>KF</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sihag</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lehar</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Puigserver</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carlsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ridderstrale</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Laurila</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PGC-1alpha-responsive genes involved in oxidative phosphorylation are coordinately downregulated in human diabetes</article-title>
        <source>Nat Genet</source>
        <year>2003</year>
        <volume>34</volume>
        <fpage>267</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="pmid">12808457</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1180</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Volsky</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>PAGE: parametric analysis of gene set enrichment</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>144</fpage>
        <pub-id pub-id-type="pmid">15941488</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-144</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newton</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Quintana</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Den Boon</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sengupta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ahlquist</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Random-set methods identify distinct aspects of the enrichment signal in gene-set analysis</article-title>
        <source>Ann Appl Stat</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>85</fpage>
        <lpage>106</lpage>
        <pub-id pub-id-type="doi">10.1214/07-AOAS104</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boorsma</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Foat</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Vis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Klis</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bussemaker</surname>
            <given-names>HJ</given-names>
          </name>
        </person-group>
        <article-title>T-profiler: scoring the activity of predefined groups of genes using gene expression data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>W592</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="pmid">15980543</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gki484</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Greenberg</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Kong</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Altschuler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kohane</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Discovering statistically significant pathways in expression profiling studies</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>13544</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">16174746</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.0506577102</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dinu</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Adewale</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Jhangri</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Einecke</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Famulski</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Halloran</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yasui</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Improving gene set analysis of microarray data by SAM-GS</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>242</fpage>
        <pub-id pub-id-type="pmid">17612399</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-242</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barry</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Nobel</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>FA</given-names>
          </name>
        </person-group>
        <article-title>Significance analysis of functional categories in gene expression studies: a structured permutation approach</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>1943</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">15647293</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti260</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goeman</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Buhlmann</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Analyzing gene expression data in terms of gene sets: methodological issues</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>980</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">17303618</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm051</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Dinu</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Adewale</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Yasui</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Comparative evaluation of gene-set analysis methods</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>431</fpage>
        <pub-id pub-id-type="pmid">17988400</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-431</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kirov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Snoddy</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>WebGestalt: an integrated system for exploring gene sets in various biological contexts</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>W741</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">15980575</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gki475</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al-Shahrour</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Arbiza</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dopazo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Minguez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Montaner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dopazo</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>From genes to functional classes in the study of biological systems</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>114</fpage>
        <pub-id pub-id-type="pmid">17407596</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-114</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nam</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SY</given-names>
          </name>
        </person-group>
        <article-title>Gene-set approach for expression pattern analysis</article-title>
        <source>Brief Bioinform</source>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18202032</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bussemaker</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Boorsma</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Dissecting complex transcriptional responses using pathway-level scores based on prior information</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>S6</fpage>
        <pub-id pub-id-type="pmid">17903287</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-S6-S6</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baur</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Pearson</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Jamieson</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Lerin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kalra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Prabhu</surname>
            <given-names>VV</given-names>
          </name>
          <name>
            <surname>Allard</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Lopez-Lluch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Resveratrol improves health and survival of mice on a high-calorie diet</article-title>
        <source>Nature</source>
        <year>2006</year>
        <volume>444</volume>
        <fpage>337</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="pmid">17086191</pub-id>
        <pub-id pub-id-type="doi">10.1038/nature05354</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smid</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dorssers</surname>
            <given-names>LC</given-names>
          </name>
        </person-group>
        <article-title>GO-Mapper: functional analysis of gene expression data using the expression level as a score to evaluate Gene Ontology terms</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>2618</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="pmid">15130934</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth293</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saxena</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Orgill</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kohane</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Absolute enrichment: gene set enrichment analysis for homeostatic systems</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>e151</fpage>
        <pub-id pub-id-type="pmid">17130162</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkl766</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kemp</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Nirmala</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Szustakowski</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Extending the pathway analysis framework with a test for transcriptional variance implicates novel pathway modulation during myogenic differentiation</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>1356</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="pmid">17392327</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm116</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beer</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Kardia</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Giordano</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Misek</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gharib</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>DG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene-expression profiles predict survival of patients with lung adenocarcinoma</article-title>
        <source>Nat Med</source>
        <year>2002</year>
        <volume>8</volume>
        <fpage>816</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="pmid">12118244</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bhattacharjee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Richards</surname>
            <given-names>WG</given-names>
          </name>
          <name>
            <surname>Staunton</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Monti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vasa</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ladd</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Beheshti</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bueno</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Classification of human lung carcinomas by mRNA expression profiling reveals distinct adenocarcinoma subclasses</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>13790</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="pmid">11707567</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.191502998</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="other">
        <article-title>The Molecular Signature Database</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.broad.mit.edu/gsea/msigdb/"/>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dorsam</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Gutkind</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>G-protein-coupled receptors and cancer</article-title>
        <source>Nat Rev Cancer</source>
        <year>2007</year>
        <volume>7</volume>
        <fpage>79</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="pmid">17251915</pub-id>
        <pub-id pub-id-type="doi">10.1038/nrc2069</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>SB</given-names>
          </name>
        </person-group>
        <article-title>Overexpression of G protein-coupled receptors in cancer cells: involvement in tumor progression</article-title>
        <source>Int J Oncol</source>
        <year>2005</year>
        <volume>27</volume>
        <fpage>1329</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="pmid">16211229</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altiay</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ciftci</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Demir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kocak</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sut</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tabakoglu</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hatipoglu</surname>
            <given-names>ON</given-names>
          </name>
          <name>
            <surname>Caglar</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>High plasma D-dimer level is associated with decreased survival in patients with lung cancer</article-title>
        <source>Clin Oncol (R Coll Radiol)</source>
        <year>2007</year>
        <volume>19</volume>
        <fpage>494</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">17513096</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Antoniou</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pavlakou</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Stathopoulos</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Karydis</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chondrou</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Papageorgiou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dariotaki</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Chaimala</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Veslemes</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Predictive value of D-dimer plasma levels in response and progressive disease in patients with lung cancer</article-title>
        <source>Lung Cancer</source>
        <year>2006</year>
        <volume>53</volume>
        <fpage>205</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">16769149</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.lungcan.2006.03.015</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Montgrain</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Quintana</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rascon</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Deftos</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Casillas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hastings</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>Parathyroid hormone-related protein varies with sex and androgen status in nonsmall cell lung cancer</article-title>
        <source>Cancer</source>
        <year>2007</year>
        <volume>110</volume>
        <fpage>1313</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="pmid">17676588</pub-id>
        <pub-id pub-id-type="doi">10.1002/cncr.22922</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hidalgo</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Doherty</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Hirschowitz</surname>
            <given-names>EA</given-names>
          </name>
        </person-group>
        <article-title>Plasma PGE-2 levels and altered cytokine profiles in adherent peripheral blood mononuclear cells in non-small cell lung cancer (NSCLC)</article-title>
        <source>Mol Cancer</source>
        <year>2002</year>
        <volume>1</volume>
        <fpage>5</fpage>
        <pub-id pub-id-type="pmid">12459041</pub-id>
        <pub-id pub-id-type="doi">10.1186/1476-4598-1-5</pub-id>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darnell</surname>
            <given-names>JE</given-names>
            <suffix>Jr</suffix>
          </name>
          <name>
            <surname>Kerr</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>GR</given-names>
          </name>
        </person-group>
        <article-title>Jak-STAT pathways and transcriptional activation in response to IFNs and other extracellular signaling proteins</article-title>
        <source>Science</source>
        <year>1994</year>
        <volume>264</volume>
        <fpage>1415</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="pmid">8197455</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.8197455</pub-id>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kristof</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Marks-Konczalik</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Billings</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Moss</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Stimulation of signal transducer and activator of transcription-1 (STAT1)-dependent gene transcription by lipopolysaccharide and interferon-gamma is regulated by mammalian target of rapamycin</article-title>
        <source>J Biol Chem</source>
        <year>2003</year>
        <volume>278</volume>
        <fpage>33637</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="pmid">12807916</pub-id>
        <pub-id pub-id-type="doi">10.1074/jbc.M301053200</pub-id>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rajan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Panchision</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Newell</surname>
            <given-names>LF</given-names>
          </name>
          <name>
            <surname>McKay</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>BMPs signal alternately through a SMAD or FRAP-STAT pathway to regulate fate choice in CNS stem cells</article-title>
        <source>J Cell Biol</source>
        <year>2003</year>
        <volume>161</volume>
        <fpage>911</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="pmid">12796477</pub-id>
        <pub-id pub-id-type="doi">10.1083/jcb.200211021</pub-id>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fujita</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Janz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Attenuation of WNT signaling by DKK-1 and -2 regulates BMP2-induced osteoblast differentiation and expression of OPG, RANKL and M-CSF</article-title>
        <source>Mol Cancer</source>
        <year>2007</year>
        <volume>6</volume>
        <fpage>71</fpage>
        <pub-id pub-id-type="pmid">17971207</pub-id>
        <pub-id pub-id-type="doi">10.1186/1476-4598-6-71</pub-id>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rawadi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Vayssiere</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Baron</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Roman-Roman</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>BMP-2 controls alkaline phosphatase expression and osteoblast mineralization by a Wnt autocrine loop</article-title>
        <source>J Bone Miner Res</source>
        <year>2003</year>
        <volume>18</volume>
        <fpage>1842</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="pmid">14584895</pub-id>
        <pub-id pub-id-type="doi">10.1359/jbmr.2003.18.10.1842</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kulterer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Friedl</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jandrositz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sanchez-Cabo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Prokesch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Paar</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Scheideler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Windhager</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Preisegger</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Trajanoski</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Gene expression profiling of human mesenchymal stem cells derived from bone marrow during expansion and osteoblast differentiation</article-title>
        <source>BMC Genomics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>70</fpage>
        <pub-id pub-id-type="pmid">17352823</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2164-8-70</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Balint</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lapointe</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Drissi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Meijden</surname>
            <given-names>C van der</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>van Wijnen</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Lian</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Phenotype discovery by gene expression profiling: mapping of biological processes linked to BMP-2-mediated osteoblast differentiation</article-title>
        <source>J Cell Biochem</source>
        <year>2003</year>
        <volume>89</volume>
        <fpage>401</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="pmid">12704803</pub-id>
        <pub-id pub-id-type="doi">10.1002/jcb.10515</pub-id>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Larsson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karlsson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The role of Smad signaling in hematopoiesis</article-title>
        <source>Oncogene</source>
        <year>2005</year>
        <volume>24</volume>
        <fpage>5676</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="pmid">16123801</pub-id>
        <pub-id pub-id-type="doi">10.1038/sj.onc.1208920</pub-id>
      </citation>
    </ref>
    <ref id="B38">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maguer-Satta</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bartholin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jeanpierre</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ffrench</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Magaud</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Rimokh</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Regulation of human erythropoiesis by activin A, BMP2, and BMP4, members of the TGFbeta family</article-title>
        <source>Exp Cell Res</source>
        <year>2003</year>
        <volume>282</volume>
        <fpage>110</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="pmid">12531697</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0014-4827(02)00013-7</pub-id>
      </citation>
    </ref>
    <ref id="B39">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Helms</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Packeisen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>August</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schittek</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Boecker</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Brandt</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Buerger</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>First evidence supporting a potential role for the BMP/SMAD pathway in the progression of oestrogen receptor-positive breast cancer</article-title>
        <source>J Pathol</source>
        <year>2005</year>
        <volume>206</volume>
        <fpage>366</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="pmid">15892165</pub-id>
        <pub-id pub-id-type="doi">10.1002/path.1785</pub-id>
      </citation>
    </ref>
    <ref id="B40">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ong</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Colley</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Norman</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Kitazawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tobias</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Transcriptional regulation of a BMP-6 promoter by estrogen receptor alpha</article-title>
        <source>J Bone Miner Res</source>
        <year>2004</year>
        <volume>19</volume>
        <fpage>447</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="pmid">15040833</pub-id>
        <pub-id pub-id-type="doi">10.1359/JBMR.0301249</pub-id>
      </citation>
    </ref>
    <ref id="B41">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Extensions to gene set enrichment</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>306</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="pmid">17127676</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl599</pub-id>
      </citation>
    </ref>
    <ref id="B42">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the False Discovery Rate – a Practical and Powerful Approach to Multiple Testing</article-title>
        <source>Journal of the Royal Statistical Society Series B-Methodological</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </citation>
    </ref>
    <ref id="B43">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shaffer</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Multiple Hypothesis-Testing</article-title>
        <source>Annu Rev Psychol</source>
        <year>1995</year>
        <volume>46</volume>
        <fpage>561</fpage>
        <lpage>584</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.ps.46.020195.003021</pub-id>
      </citation>
    </ref>
    <ref id="B44">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stonehouse</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Forrester</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Robustness of the t and U tests under combined assumption violations</article-title>
        <source>Journal of Applied Statistics</source>
        <year>1998</year>
        <volume>25</volume>
        <fpage>63</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1080/02664769823304</pub-id>
      </citation>
    </ref>
    <ref id="B45">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conover</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Iman</surname>
            <given-names>RL</given-names>
          </name>
        </person-group>
        <article-title>Rank Transformations as a Bridge between Parametric and Nonparametric Statistics</article-title>
        <source>American Statistician</source>
        <year>1981</year>
        <volume>35</volume>
        <fpage>124</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="doi">10.2307/2683975</pub-id>
      </citation>
    </ref>
    <ref id="B46">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A unified approach to false discovery rate estimation</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>303</fpage>
        <pub-id pub-id-type="pmid">18613966</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-303</pub-id>
      </citation>
    </ref>
    <ref id="B47">
      <citation citation-type="other">
        <article-title>GAGE R package</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://sysbio.engin.umich.edu/~luow/downloads.php"/>
      </citation>
    </ref>
    <ref id="B48">
      <citation citation-type="other">
        <article-title>Gene Annotation &amp; Information Query (GAIQ)</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://sysbio.engin.umich.edu/~luow/project/geneInfo.php"/>
      </citation>
    </ref>
    <ref id="B49">
      <citation citation-type="other">
        <article-title>GSEA software</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.broad.mit.edu/gsea/downloads.jsp"/>
      </citation>
    </ref>
    <ref id="B50">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Furge</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Koeman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Swiatek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dykema</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lucin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kahnoski</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>XJ</given-names>
          </name>
          <name>
            <surname>Teh</surname>
            <given-names>BT</given-names>
          </name>
        </person-group>
        <article-title>Detection of DNA copy number changes and oncogenic signaling abnormalities from gene expression data reveals MYC activation in high-grade papillary renal cell carcinoma</article-title>
        <source>Cancer Res</source>
        <year>2007</year>
        <volume>67</volume>
        <fpage>3171</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="pmid">17409424</pub-id>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-06-4571</pub-id>
      </citation>
    </ref>
    <ref id="B51">
      <citation citation-type="other">
        <article-title>ChipperDB type 2 diabetes data set</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.diabetesgenome.org/chipperdb/expt.cgi?id=54"/>
      </citation>
    </ref>
    <ref id="B52">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gautier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cope</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>affy–analysis of Affymetrix GeneChip data at the probe level</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>307</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="pmid">14960456</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg405</pub-id>
      </citation>
    </ref>
    <ref id="B53">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dai</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Boyd</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Kostov</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Athey</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Bunney</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Akil</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolving gene/transcript definitions significantly alter the interpretation of GeneChip data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>e175</fpage>
        <pub-id pub-id-type="pmid">16284200</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gni179</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
