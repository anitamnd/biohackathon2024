<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9710622</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbac075</article-id>
    <article-id pub-id-type="publisher-id">vbac075</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Article</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data Visualization</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Evidente—a visual analytics tool for data enrichment in SNP-based phylogenetic trees</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8113-4139</contrib-id>
        <name>
          <surname>Witte Paz</surname>
          <given-names>Mathias</given-names>
        </name>
        <xref rid="vbac075-cor1" ref-type="corresp"/>
        <!--mathias-alexander.witte-paz@uni-tuebingen.de-->
        <aff><institution>Institute for Bioinformatics and Medical Informatics, University of Tübingen</institution>, Tübingen 72076, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8716-5788</contrib-id>
        <name>
          <surname>Harbig</surname>
          <given-names>Theresa A</given-names>
        </name>
        <aff><institution>Institute for Bioinformatics and Medical Informatics, University of Tübingen</institution>, Tübingen 72076, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Nieselt</surname>
          <given-names>Kay</given-names>
        </name>
        <xref rid="vbac075-cor1" ref-type="corresp"/>
        <!--kay.nieselt@uni-tuebingen.de-->
        <aff><institution>Institute for Bioinformatics and Medical Informatics, University of Tübingen</institution>, Tübingen 72076, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbac075-cor1">To whom correspondence should be addressed. <email>mathias-alexander.witte-paz@uni-tuebingen.de</email> or <email>kay.nieselt@uni-tuebingen.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-10-12">
      <day>12</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <volume>2</volume>
    <issue>1</issue>
    <elocation-id>vbac075</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>05</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>28</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbac075.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>A common practice in the analysis of pathogens and their strains is using single-nucleotide polymorphisms (SNPs) to reconstruct their evolutionary history. However, genome-wide SNP-based phylogenetic trees are rarely analyzed without any further information. Including the underlying SNP data together with further metadata on the respective samples in the exploration process can facilitate linking the genomic and phenotypic properties of the samples.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce Efficient VIsual analytics tool for Data ENrichment in phylogenetic TreEs (Evidente), a web-application that provides an interactive visual analysis interface for the simultaneous interrogation of phylogenetic relationships, genome-wide SNP data and metadata for samples of an organism. Besides visualizing the phylogenetic tree, Evidente classifies SNPs as supporting or non-supporting of the tree structures and shows the distribution of both types of SNPs among samples and clades of interest. Furthermore, additional metadata can be included in the visualization. Lastly, Evidente includes an enrichment analysis to identify over-represented genomic features encoded by GO-terms within the clades of the tree. We demonstrate the usability of Evidente with the data of the pathogens <italic toggle="yes">Treponema pallidum</italic> and <italic toggle="yes">Mycobacterium leprae</italic>.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Evidente is available at the TueVis visualization web server at <ext-link xlink:href="https://evidente-tuevis.cs.uni-tuebingen.de/" ext-link-type="uri">https://evidente-tuevis.cs.uni-tuebingen.de/</ext-link>, it can also be run locally.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Controlling Microbes to Fight Infections</institution>
          </institution-wrap>
        </funding-source>
        <award-id>390838134</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Deutsche Forschungsgemeinschaft</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001659</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>398967434</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Open Access Publishing Fund of the University of Tübingen</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The rise of next-generation sequencing (NGS) techniques allows faster and more efficient procedures for the sequencing of genomes (<xref rid="vbac075-B9" ref-type="bibr">Goodwin <italic toggle="yes">et al.</italic>, 2016</xref>). This has not only lead to the sequencing of thousands of different species across all kingdoms but also to the deciphering of the variability of genomes within a species. In particular, the massive sequencing of microbial and viral genomes now offers exciting abilities to query the variability of different strains within a bacterial or viral species. Many fields, in particular that of molecular epidemiology but also the field of ancient pathogenomics [see <xref rid="vbac075-B29" ref-type="bibr">Spyrou <italic toggle="yes">et al.</italic> (2019)</xref> for a review], have made enormous progress and created amazing insight in the evolutionary history of human pathogens. NGS techniques in particular have enabled the study of point mutations called <italic toggle="yes">single-nucleotide polymorphisms</italic> (SNPs) or <italic toggle="yes">variants</italic> depending on the frequencies in the populations (SNPs/SNVs, from this point on SNPs) in strains within a species. SNPs are then often used e.g. to reconstruct the evolutionary relationship of the individuals. For this, a common procedure is to first map the NGS data to a common reference genome, followed by the SNP-calling step using a genotyping method. An alternative approach is to align sample genomes with a reference genome and to identify all positions where a sample differs by a mutation from the reference with respect to the coordinate system of the reference genome. The detected SNPs of all samples can be summarized into one <italic toggle="yes">SNP-table</italic> (see e.g. <xref rid="vbac075-F1" ref-type="fig">Fig. 1a</xref>). A SNP-table, and hence the underlying identified SNPs, can then be used as a basis for the evolutionary reconstruction to compute a SNP-based phylogenetic tree using, e.g. a maximum parsimony approach.</p>
    <fig position="float" id="vbac075-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>a</bold>) Example of a SNP-table with toy data on genomes of six strains. Each row describes a position with SNPs at the strains when compared to the reference allele. A dot character indicates that no mutation appears within the given strain, while any character indicates the presence of a SNP. (<bold>b</bold>) The SNPs at Positions 1 and 2 are aligned to the leaves of the phylogenetic tree. (<bold>c</bold>) When using CLASSICO, the SNP at Position 1 propagates up to the lowest common ancestor (LCA) of <italic toggle="yes">S</italic><sub>1</sub>, <italic toggle="yes">S</italic><sub>2</sub> and <italic toggle="yes">S</italic><sub>3</sub>. Since the SNP is found only in one clade, it is clade-specific, thus supporting. The SNP found at Position 2 is found after propagation to the LCA of <italic toggle="yes">S</italic><sub>1</sub> and <italic toggle="yes">S</italic><sub>2</sub>, as well as in the clades formed only by <italic toggle="yes">S</italic><sub>4</sub> and <italic toggle="yes">S</italic><sub>5</sub>, respectively. Hence, this SNP is not clade-specific, i.e. non-supporting</p>
      </caption>
      <graphic xlink:href="vbac075f1" position="float"/>
    </fig>
    <p>However, the evolutionary reconstruction does not provide a direct relationship between the reconstructed phylogenetic tree and the underlying SNPs. One way of linking these two datasets and also providing a measurement of accuracy of the tree is to compute the clade-specificity of the SNPs. A clade-specific or clade-unique SNP appears only and in all samples of the clade’s leaf-nodes. Hence, clade-specific SNPs support the choice for the reconstructed phylogeny and therefore can be called supporting SNPs. An example for a clade-specific, i.e. supporting SNP, is the SNP found at Position 1 in <xref rid="vbac075-F1" ref-type="fig">Figure 1b</xref>. If a SNP appears in many clades, we refer to it as a non-supporting SNP. An example for a non-supporting SNP is the SNP found at Position 2 in <xref rid="vbac075-F1" ref-type="fig">Figure 1b</xref>.</p>
    <p>SNP-based phylogenetic trees are often used for the analysis of pathogens and their strains (<xref rid="vbac075-B5" ref-type="bibr">Filliol <italic toggle="yes">et al.</italic>, 2006</xref>; <xref rid="vbac075-B7" ref-type="bibr">Foster <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="vbac075-B21" ref-type="bibr">Pandya <italic toggle="yes">et al.</italic>, 2009</xref>). For example, SNP-based phylogenies were used in the analysis of the spread of the pathogen <italic toggle="yes">Mycobacterium leprae</italic> (<xref rid="vbac075-B26" ref-type="bibr">Schuenemann <italic toggle="yes">et al.</italic>, 2018</xref>) as well as in the analysis of the rise of antibiotic resistance of <italic toggle="yes">Treponema pallidum</italic> (<xref rid="vbac075-B1" ref-type="bibr">Arora <italic toggle="yes">et al.</italic>, 2016</xref>). In these studies, the analysis required the inclusion of the identified SNP data as well as further metadata (e.g. the origin place of the sample or its antibiotic resistance) to identify significant correlations among the datasets. To simultaneously interact with the phylogenetic data, the identified genome-wide SNPs and further metadata within one visualization interface can help in identifying possible correlations. Furthermore, the underlying genomic data are often analyzed from the functional perspective or to classify, e.g. microbial samples after disease outbreaks. A prominent example for this is Nextstrain (<xref rid="vbac075-B11" ref-type="bibr">Hadfield <italic toggle="yes">et al.</italic>, 2018</xref>), a visual analytics platform to track the evolution of viruses. It integrates genome sequence data with phylogenetic reconstruction of the strains and metadata, such as geographic origin or host species. Nextstrain has been instrumental in understanding the evolution and spread of SARS-CoV-2, the virus that has caused the COVID-19 pandemic.</p>
    <p>There are many pipelines for the phylogenetic reconstruction from SNP data, such as snpTree (<xref rid="vbac075-B17" ref-type="bibr">Leekitcharoenphon <italic toggle="yes">et al.</italic>, 2012</xref>), PhyloSNP (<xref rid="vbac075-B4" ref-type="bibr">Faison <italic toggle="yes">et al.</italic>, 2014</xref>), SNPhylo (<xref rid="vbac075-B16" ref-type="bibr">Lee <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="vbac075-B33" ref-type="bibr">Yang <italic toggle="yes">et al.</italic>, 2018</xref>) or SNVPhyl (<xref rid="vbac075-B23" ref-type="bibr">Petkau <italic toggle="yes">et al.</italic>, 2017</xref>). However, they either do not offer any kind of visualization or they lack essential interactivity for a subsequent exploration process. On the other hand, tools, such as Evolview (<xref rid="vbac075-B31" ref-type="bibr">Subramanian <italic toggle="yes">et al.</italic>, 2019</xref>), iTOL (<xref rid="vbac075-B18" ref-type="bibr">Letunic and Bork, 2019</xref>) or PhyD3 (<xref rid="vbac075-B14" ref-type="bibr">Kreft <italic toggle="yes">et al.</italic>, 2017</xref>), provide the visualization of phylogenetic data with additional metadata for the analyzed samples. Still, these tools do not focus on SNP-based trees and hence they neither provide an intuitive interaction with available SNP data nor allow the identification of enriched molecular features, such as Gene Ontology (GO) terms, in genes with either clade-specific SNPs or non-clade-specific SNPs.</p>
    <p>To cover this gap of a visual analytics tool, this article presents Efficient VIsual analytics tool for Data ENrichment in phylogenetic TreEs (Evidente). Evidente enables a simultaneous visualization of genome-wide SNP data and phylogenetic data. Furthermore, Evidente allows to integrate additional metadata on the analyzed samples into the visualization. By providing an interactive visual interface, Evidente facilitates the identification of correlations between the phylogenetic clades, their respective SNPs and metadata. Moreover, Evidente allows the user to run an enrichment analysis on the GO (<xref rid="vbac075-B2" ref-type="bibr">Ashburner <italic toggle="yes">et al.</italic>, 2000</xref>) terms associated with the genes in which SNPs occur.</p>
    <p>We demonstrate the effectiveness of our approach through an analysis of two case studies using the pathogens <italic toggle="yes">T.pallidum</italic> and <italic toggle="yes">M.leprae</italic>, and thereby show how Evidente can be used to identify clade-specific SNPs as well as visually identify possible correlations between the genotype and metadata.</p>
  </sec>
  <sec>
    <title>2 Approach</title>
    <p>Before we developed the visual interface of Evidente, we first identified four main tasks for the analysis of SNP data together with metadata in a phylogenetic context in collaboration with two domain experts.</p>
    <p>Task <italic toggle="yes">T</italic><sub>1</sub><bold>Find clade-specific SNPs</bold>: analyze how well the SNPs support the tree structure since the tree structure itself does not give insights into the underlying SNP distribution. By viewing SNPs specific for a clade users can tell how well it is supported by SNPs.</p>
    <p>Task <italic toggle="yes">T</italic><sub>2</sub><bold>Analyze the underlying SNP/Metadata distribution of a clade</bold>: it is not always of interest to visualize the SNPs and metadata for all individual strains separately, but summarize the data for a clade of interest to see how often the different alleles appear at a position or how the metadata is distributed.</p>
    <p>Task <italic toggle="yes">T</italic><sub>3</sub><bold>Link Metadata and non-supporting SNPs</bold>: visually identify correlations that are not supporting the tree. Non-supporting SNPs by definition do not correlate perfectly with the tree structure. However, they might correlate with metadata. For instance, a correlation could hint at a connection between genotype and environmental factors.</p>
    <p>Task <italic toggle="yes">T</italic><sub>4</sub><bold>Analyze a clade functionally</bold>: find out if any gene functions are over-represented in a clade compared to other clades. For example, one can conduct a GO enrichment analysis to find out if any GO-terms linked to genes with identified SNPs are significantly over-represented in a clade compared to the rest of the tree.</p>
    <p>With the design of Evidente, we aim to enable the tasks defined above and allow simultaneous interrogation of phylogenetic and genotype relationships, with additional metadata expressed through colorings. To achieve this, Evidente visualizes a phylogenetic tree that has been computed from a set of samples from a single species together with the underlying SNPs and additional metadata aligned to the leaves of the tree. In the following the design and functionalities offered in Evidente are described in detail.</p>
    <sec>
      <title>2.1 Data preprocessing and input data</title>
      <p>The minimum requirement to run Evidente are two input files, which need to be provided by the user: a SNP-table in tsv-format and a Newick file representing the phylogenetic tree of the same samples as represented in the SNP-table. An example pipeline that computes a SNP-table from NGS data is EAGER (<xref rid="vbac075-B22" ref-type="bibr">Peltzer <italic toggle="yes">et al.</italic>, 2016</xref>) in conjunction with the multi-sample analyzer MUSIAL (<ext-link xlink:href="https://github.com/Integrative-Transcriptomics/MUSIAL" ext-link-type="uri">https://github.com/Integrative-Transcriptomics/MUSIAL</ext-link>). The columns of the SNP-table (see <xref rid="vbac075-F1" ref-type="fig">Fig. 1a</xref>) represent each strain or analyzed sample. The rows represent the positions in the genome where a SNP has been found in at least one sample. Each entry containing a nucleotide in IUPAC-code indicates the presence of a SNP in the corresponding position. An <italic toggle="yes">N</italic> character represents an unresolved base. A dot symbol symbolizes that the corresponding sample shares the same base with the reference at the given position.</p>
      <p>The phylogenetic tree on the same samples as used for the SNP-table can be computed by any method of choice. For example, we use the SNP data and a maximum parsimony approach for this step. In the two use-cases presented below, this has been done using MEGAX (<xref rid="vbac075-B15" ref-type="bibr">Kumar <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
      <p>In addition to the phylogenetic tree and the SNP data, Evidente is able to visualize metadata provided by the user. This information should be encoded in a CSV or a TSV-file, with the columns representing the metadata and the rows containing the name of the analyzed samples. For a correct interpretation and visualization of the metadata features, the second row of the metadata file needs to assign each column to a data type category. For this classification, the data types presented by <xref rid="vbac075-B20" ref-type="bibr">Munzner (2014)</xref> were chosen, and should therefore be labeled as <italic toggle="yes">Categorical</italic>, <italic toggle="yes">Ordinal</italic> or <italic toggle="yes">Numerical</italic>. Evidente orders categorical values by their frequency. Ordinal values are sorted alphabetically by default, though the user can re-sort them in Evidente.</p>
      <p>Further optional input files are an annotation file of the reference organism in GFF format and a list of the genes with their corresponding GO-terms. The usage of these files will be explained below in the Section 2.3.3.</p>
    </sec>
    <sec>
      <title>2.2 Computation of the SNP clade-specificity</title>
      <p>The goal of Evidente is to link the phylogenetic data and the genome-wide SNP data by an interactive visualization. Therefore, for each SNP Evidente assesses if it is clade-specific, i.e. the SNP appears only in the respective samples of the clade’s descendant leaf-nodes. For the calculation of the clade-specificity Evidente includes a module called CLASSICO (CLAde-Specific Snp IdentifiCatOr), which computes the distribution of the SNPs from the input files with respect to the lowest common ancestors (LCAs) that define a clade in the phylogenetic tree (<xref rid="vbac075-F1" ref-type="fig">Fig. 1c</xref>). The algorithm first distributes the SNPs within the reconstructed clades by the following method: the identified SNPs are propagated from the leaves toward the root. An internal node receives a SNP from its children, as long as the SNP is present among all descendants with the same allele. This process is repeated through post-ordering of the nodes up to the root of the tree. It is important to note that some SNPs might not propagate at all and will be allocated only to one of the leaves of the phylogenetic tree. If a SNP is allocated to only one node, meaning it is a clade-specific SNP, then it is labeled as supporting of the tree structure, otherwise as non-supporting. Unresolved bases <italic toggle="yes">N</italic> do not undergo this process but are directly labeled as non-supporting SNPs, since they could be labeled as any base which prevents a clear classification. CLASSICO produces two lists of SNPs, one for the supporting and one for the non-supporting SNPs, which are used for the visualizations in Evidente.</p>
    </sec>
    <sec>
      <title>2.3 Design and features</title>
      <p>In this section, the main visual interface as well as design choices of Evidente is described. To illustrate this, we have chosen an artificial phylogeny and exemplary toy SNP and metadata. The corresponding input data can be found in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref>).</p>
      <sec>
        <label>2.3.1</label>
        <title>Evidente’s graphical user interface</title>
        <p>The key feature of Evidente is to interactively and simultaneously view and explore a phylogenetic tree and whole-genome SNP data as well as metadata of the samples of one organism. The central part of the graphical user interface of Evidente consists of three visualization components that are horizontally aligned: a horizontal dendrogram and two heat map-like visualizations of SNP and metadata (see <xref rid="vbac075-F2" ref-type="fig">Fig. 2I–III</xref>). In addition, the user interface includes a sidebar with graphical control elements for access to various functions as well as a settings panel for the color encoding of the SNP data and metadata (see <xref rid="vbac075-F2" ref-type="fig">Fig. 2IV</xref>).</p>
        <fig position="float" id="vbac075-F2">
          <label>Fig. 2.</label>
          <caption>
            <p>Data visualization using Evidente. The view consists of the main visualization panel (I, II, III) and the sidebar (IV). The main panel visualizes the phylogenetic tree (I), and selected SNPs (II) and metadata (III) as heat maps. The tool’s sidebar (IV) visualizes the legend for the color scales used and further tool menus for the interaction. (<bold>a</bold>) The main visualization shows some SNPs (here: five SNPs from <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>) and metadata (here: three columns from <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>) of the toy dataset. A clade node (emphasized internal node) has been selected. The first SNP (Position 30) corresponds to a supporting SNP that can be found in all leaves of the selected clade, while the supporting SNPs in the next two positions (Positions 10 and 850) appear only in a subset of leaves under the selected clade. The last two visualized SNPs (Positions 15 and 20) are non-supporting SNPs. In a side bar element (<bold>b</bold>) clade SNPs for the currently selected node are summarized and can be added to the visualization. (<bold>c</bold>) Aggregation functionality of Evidente. The subtree containing all samples with the class <italic toggle="yes">Wild-Type</italic> has been aggregated into one node and interactively been renamed as <italic toggle="yes">WILDTYPES</italic>. The end node of a collapsed node is emphasized by a specific glyph (a shaded triangle). The metadata in an aggregated node replaces the heat map cell with box plots (for numerical values) or bar plots for all other data types, including SNP data. Moreover, the filter group ‘All but experimental’ was created as seen in the corresponding menu. It filters out all samples not belonging to the classes <italic toggle="yes">Wild-Type</italic> or <italic toggle="yes">Clinical</italic>. Hence, the strain <italic toggle="yes">Toy_strain_1</italic> and its data have been hidden</p>
          </caption>
          <graphic xlink:href="vbac075f2" position="float"/>
        </fig>
        <p>For the visualization of the phylogenetic tree, we chose a horizontal linear dendrogram. It is created using a modified version of the D3-based library Phylotree (<xref rid="vbac075-B27" ref-type="bibr">Shank <italic toggle="yes">et al.</italic>, 2018</xref>). The resulting interactive dendrogram provides typical interactions for phylogenetic trees, such as selection of branches or nodes, collapsing subtrees on clade-nodes and the hiding of subtrees or leaves. This is described in more detail in Section 2.3.2.</p>
        <p>As a horizontal dendrogram was chosen, screen space is used efficiently since heat map-like visualizations of sample-specific data can be aligned horizontally to the leaves (see <xref rid="vbac075-F2" ref-type="fig">Fig. 2I</xref>). Two separate heat map-like visualizations are aligned to the tree encoding SNPs and metadata using color (see <xref rid="vbac075-F2" ref-type="fig">Fig. 2II and III</xref>). Separating SNPs and metadata facilitates differentiating the used color scales within both components more easily and helps finding patterns in the SNP data. The heat map visualizing the SNPs shows one position of the genome per column and a rectangle encodes the presence of a SNP in the corresponding sample (see <xref rid="vbac075-F2" ref-type="fig">Fig. 2II</xref>). The nucleotide of the SNP is visualized using a different color. Cells encoding supporting SNPs receive a full color fill, while non-supporting SNPs are encoded by cells only with a colored frame instead of a fill. Blank spaces encode the absence of a SNP at the given position, i.e. the sample in question showing the reference allele. In the metadata visualization each column of the heat map shows different sample-specific information that can be either of the numerical, ordinal or categorical data type (see <xref rid="vbac075-F2" ref-type="fig">Fig. 2III</xref>). For numerical data, a continuous sequential color scale was chosen. Similarly, the ordinal data has a sequential color scale as default. Lastly, the categorical values get a default color scale of 20 colors defined by D3 (<xref rid="vbac075-B3" ref-type="bibr">Bostock <italic toggle="yes">et al.</italic>, 2011</xref>). An overview of the color scales of currently displayed data can be found in the legend component (see <xref rid="vbac075-F2" ref-type="fig">Fig. 2IV</xref>). The color scales can be changed interactively.</p>
        <p>Since the distances between leaves, their labels and the heat maps can be too large to easily identify the rows corresponding to the leaves, guiding-lines connect the different visual components. Via hovering interactions of any element, the guiding-lines are highlighted to underline the connection between associated elements. Similarly, vertical guiding-lines are displayed when a user hovers over a cell in one of the heat maps. Furthermore, users can highlight branches in the phylogenetic tree to emphasize their corresponding elements in the heat maps.</p>
      </sec>
      <sec>
        <label>2.3.2</label>
        <title>Functionalities</title>
        <p>Interactive functionalities of Evidente are offered both in the dendrogram itself as well as in the sidebar (see <xref rid="vbac075-F2" ref-type="fig">Fig. 2IV</xref>). Initially no SNPs or metadata is selected and only the dendrogram is displayed after loading the files. Though the default view uses a dendrogram (i.e. a tree visualization that includes the branch lengths in the visualization), the user can interactively visualize the data as a cladogram, a visualization of the tree that focuses only in the descendent–ancestor relationship without including distances. SNPs belonging to a clade of interest can be explored and added to the view by selecting a node. This interaction is the key for the simultaneous exploration of the SNP and phylogenetic data (<italic toggle="yes">T</italic><sub>1</sub>). <xref rid="vbac075-F2" ref-type="fig">Figure 2a</xref> shows such an interaction. After selecting a node, the SNPs corresponding to the clade are listed in a table in the sidebar (<xref rid="vbac075-F2" ref-type="fig">Fig. 2b</xref>) categorized by their clade-specificity and the presence of the SNP among the leaves of the clade (either present in all leaves or only in a subset of them). The selected node and the respective side bar elements for the clade SNPs are visually linked. Specific SNPs or all SNPs can be selected to be visualized from the clade of interest. Alternatively, using the sidebar, SNPs can be selected by their position and also metadata can be added to the visualization. With the simultaneous visualization of both data sources, it is possible to visually link SNP and metadata patterns (<italic toggle="yes">T</italic><sub>3</sub>).</p>
        <p>Besides the extraction of SNPs for specific clades, further interactions, such as the aggregation and filtering of the data are possible. Any internal node can be collapsed and afterwards labeled as the user desires. This functionality is helpful to get an overview of the characteristics within a summarized clade (<italic toggle="yes">T</italic><sub>2</sub>) or to simplify the visualization by summarizing clades with similar characteristics into one element depending on their data type. Numerical values are summarized into horizontal box plots, while SNP, categorical and ordinal data are transformed into bar plots. All aggregated plots are scaled to the maximal value within each column to facilitate the comparison of aggregated data. An example for aggregation can be seen in <xref rid="vbac075-F2" ref-type="fig">Figure 2c</xref>.</p>
        <p>On the other hand, the filtering function allows the user to focus the exploration to only a subset of data. For example, when a research question focuses only on a specific strain of the species or that not all available samples have metadata at one’s disposal. There are two alternative filtering strategies for this: either directly from the phylogenetic tree or by using available metadata. For the first option, any node but the root can be selected to be hidden together with all its descendants. The latter option is used from the corresponding section of the side bar by selecting the metadata categories that should be considered for the filtering. For each of the selected categories, the user specifies the desired characteristics of the nodes, i.e. the required range for values within the selected numerical data, or the categories from ordinal or categorical data. With this information the user defines a filter group that can be annotated at will. Every condition within a filter group needs to be fulfilled by a node in order for it to be shown. If many filter groups are created, a node needs to fulfill only one of them in order to be shown. <xref rid="vbac075-F2" ref-type="fig">Figure 2c</xref> shows an example of the results of a filtering process.</p>
        <p>The phylogenetic tree as well as the heat maps allows dragging and zooming both vertically as well as horizontally, which is especially useful for viewing cells of collapsed clades in more detail when a large tree is displayed. The visualizations and legends produced with Evidente can be exported in PNG or PDF format.</p>
      </sec>
      <sec>
        <label>2.3.3</label>
        <title>GO enrichment analysis</title>
        <p>Besides the interactive features mentioned above, Evidente offers an analysis of GO-terms associated with the genes with detected SNPs to identify significantly enriched terms within a clade of the phylogenetic tree (<italic toggle="yes">T</italic><sub>4</sub>). Before running an enrichment analysis, each SNP that is found within a gene needs to be linked with the GO-terms corresponding to the gene. This is achieved by using the annotation GFF file together with the file containing the GO-terms relationships. Since GO-terms are modeled in a directed acyclic graph (<xref rid="vbac075-B2" ref-type="bibr">Ashburner <italic toggle="yes">et al.</italic>, 2000</xref>), each gene with one or more detected SNPs is not only annotated with the corresponding term but also with all ancestor terms. This propagation is achieved by using the library GOATOOLS (<xref rid="vbac075-B13" ref-type="bibr">Klopfenstein <italic toggle="yes">et al.</italic>, 2018</xref>) and an up-to-date GO hierarchy. The enrichment analysis can be run for a selected clade or for all clades that contain at least one supporting SNP. The enrichment analysis runs independently for each clade as follows: Evidente first extracts all GO-terms that are associated with genes affected by any kind of SNP within the selected clade. For every GO-term a right-sided Fisher’s Exact Test (<xref rid="vbac075-B6" ref-type="bibr">Fisher, 1922</xref>) is conducted. A scheme of the contingency table can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>. The sum of all cells of the contingency table is equal to the total number of SNPs found within annotated genes. Bonferroni’s method (<xref rid="vbac075-B12" ref-type="bibr">Holm, 1979</xref>) is applied to correct the resulting <italic toggle="yes">P</italic>-values from the statistical tests, using the number of GO-terms identified within the selected clade as the parameter for the correction.</p>
        <p>All clades that contain enriched GO-terms after the correction are reported within a <italic toggle="yes">pop-up</italic> modal dialogue with the enriched terms, their description and their respective <italic toggle="yes">P</italic>-value. Using this modal the user is able to highlight the analyzed clade and add SNPs related with each over-represented GO-term to the visualization. Furthermore, the significantly enriched GO-terms can be exported as a CSV file.</p>
      </sec>
      <sec>
        <label>2.3.4</label>
        <title>Implementation and availability</title>
        <p>Evidente is a client–server application that uses established libraries in the backend and the frontend. The frontend of Evidente is written in JavaScript using React (<ext-link xlink:href="https://reactjs.org/" ext-link-type="uri">https://reactjs.org/</ext-link>) as a structural framework and the library D3 (<xref rid="vbac075-B3" ref-type="bibr">Bostock <italic toggle="yes">et al.</italic>, 2011</xref>) for the rendering of the visualizations. Evidente uses a python server based on Flask (<xref rid="vbac075-B10" ref-type="bibr">Grinberg, 2018</xref>) for data-parsing and the computation of the enrichment statistics. In order to create the background used for the GO enrichment Evidente makes use of GOATOOLS (<xref rid="vbac075-B13" ref-type="bibr">Klopfenstein <italic toggle="yes">et al.</italic>, 2018</xref>). The module CLASSICO for the calculation of SNP clade-specificity is written in Java and is run as a python subprocess.</p>
        <p>Evidente is available on the TueVis server (<ext-link xlink:href="https://evidente-tuevis.cs.uni-tuebingen.de/" ext-link-type="uri">https://evidente-tuevis.cs.uni-tuebingen.de/</ext-link>), but can also be run locally. The stand-alone version requires NodeJS (<xref rid="vbac075-B32" ref-type="bibr">Tilkov and Vinoski, 2010</xref>) and npm (<ext-link xlink:href="https://www.npmjs.com/" ext-link-type="uri">https://www.npmjs.com/</ext-link>) to be installed.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>The goal of the case studies is to demonstrate how the proposed visual analysis approach enables users to execute the four tasks described in Section 2. For this, Evidente is used to visualize the data of two studies analyzing pathogens: <italic toggle="yes">M. leprae</italic>, which causes Hansen’s disease also known as leprosy (<xref rid="vbac075-B19" ref-type="bibr">Monot <italic toggle="yes">et al.</italic>, 2009</xref>), and <italic toggle="yes">T.pallidum</italic>, which causes the syphilis (subspecies TPA), yaws (subspecies TPE) or bejel (subspecies TEN) disease (<xref rid="vbac075-B8" ref-type="bibr">Fraser <italic toggle="yes">et al.</italic>, 1998</xref>).</p>
    <p>The first use-case was performed on the data of the study by <xref rid="vbac075-B26" ref-type="bibr">Schuenemann <italic toggle="yes">et al.</italic> (2018)</xref>, which analyzed modern and ancient samples of <italic toggle="yes">M. leprae</italic> extracted from different species around the world. The data consist of a total of 159 samples with 3124 identified SNP positions. The metadata file was manually created with the information provided by the authors in the original publication. To explore the tree with the SNP data and metadata, we used Evidente to first collapse all clades except one clade (labeled 2<italic toggle="yes">F</italic>, see <xref rid="vbac075-F3" ref-type="fig">Fig. 3a</xref>) according to the branch structures presented in the original paper of Schuenemann <italic toggle="yes">et al.</italic> These branches represent clades of <italic toggle="yes">M.leprae</italic> strains based on different SNP (sub)types. The collapsing allows a detailed inspection of the most ancient clade of <italic toggle="yes">M. leprae</italic>. One of the findings of Schuenemann <italic toggle="yes">et al.</italic> was that the ancient <italic toggle="yes">M.leprae</italic> strains are not present in one common clade, but that they can be found in several branches. <xref rid="vbac075-F3" ref-type="fig">Figure 3a</xref> shows this distribution by aggregating the metadata. The box plots representing the origin date of the samples indicate that ancient samples also appear in Branches 4, 0 and 3. The bar plots reveal that no clade contains samples from one specific continent of origin. This analysis of the metadata distribution is a typical task in the field, as described in Task <italic toggle="yes">T</italic><sub>2</sub>.</p>
    <fig position="float" id="vbac075-F3">
      <label>Fig. 3.</label>
      <caption>
        <p>Use-case for Evidente with <italic toggle="yes">M.leprae</italic>’s data presented by <xref rid="vbac075-B26" ref-type="bibr">Schuenemann <italic toggle="yes">et al.</italic> (2018)</xref>. (<bold>a</bold>) Visualization of the phylogenetic tree with collapsed branches as presented in the original paper. Only the clade 2<italic toggle="yes">F</italic> (red node) has been left uncollapsed for detailed visualization. (<bold>b</bold>) Detailed analysis of clades found within Branch 2 (B2—purple node). The rest of the clades have been hidden. Using the root of each clade containing only Ethiopian samples (internal nodes emphasized with open circles), the supporting SNPs allocated to them were selected and visualized. The last two SNPs represent those SNPs supporting the clade 2<italic toggle="yes">F</italic> (red node)</p>
      </caption>
      <graphic xlink:href="vbac075f3" position="float"/>
    </fig>
    <p>Next, a specific branch (labeled B2) has been analyzed in detail (see <xref rid="vbac075-F3" ref-type="fig">Fig. 3b</xref>). The results of the study of <xref rid="vbac075-B26" ref-type="bibr">Schuenemann <italic toggle="yes">et al.</italic> (2018)</xref> suggest that B2 should be split into three different branches (branches 2E/F/H). For a detailed analysis of the branches below B2, all other subtrees were hidden. In order to further analyze the novel branch splits discussed in the paper, the root of clade B2 is selected to identify any SNPs supporting the original split, which is an example for Task <italic toggle="yes">T</italic><sub>1</sub> (identifying clade-specific SNPs). For the root of the clade B2, Evidente returns that no SNP is supporting this split. This speaks in favor of the decision of splitting this branch into three different subbranches.</p>
    <p>Furthermore, <xref rid="vbac075-F3" ref-type="fig">Figure 3b</xref> shows that within this clade, Ethiopian samples are not found within a common clade, but are distributed across the subtree. To understand which SNPs support the splits of these clades, we used Evidente to select the root nodes of each clade containing only Ethiopian samples to identify and visualize these SNPs. <xref rid="vbac075-F3" ref-type="fig">Figure 3b</xref> shows that the first upper two Ethiopian clades have more SNPs supporting this arrangement when compared to the rest of the clades. Finally, we selected the root of the branch 2<italic toggle="yes">F</italic> to identify SNPs supporting this branch that surprisingly consists of two modern Ethiopian samples and many ancient samples. Evidente lists only two supporting SNPs, which underlines the heterogeneity of the strains. These two SNPs could be analyzed in detail to identify their location in the respective genomes and analyze their possible effects.</p>
    <p>The data of the second use-case consists of 75 <italic toggle="yes">T. pallidum</italic> samples with a total of 2550 different SNP positions (<xref rid="vbac075-B24" ref-type="bibr">Pla-Díaz <italic toggle="yes">et al.</italic>, 2022</xref>). In addition, we used metadata regarding the antibiotic resistance of some samples against the macrolide azithromycin (<xref rid="vbac075-B1" ref-type="bibr">Arora <italic toggle="yes">et al.</italic>, 2016</xref>) as well as geographical origin, year of isolation and subspecies classification (TPA, TPE or TEN). The original phylogenetic tree contains a long branch that makes the visualization difficult to visualize as a dendrogram. Hence, the data are visualized instead as a cladogram (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
    <p>When visualizing the <italic toggle="yes">macrolide resistant</italic> data, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1a</xref> shows how resistant samples are distributed among the phylogenetic tree. In order to find a possible correlation of this metadata with SNPs, the non-supporting SNPs can be visualized, as stated in Task <italic toggle="yes">T</italic><sub>3</sub>. By selecting, e.g. the leaf labeled <italic toggle="yes">NE20</italic>, Evidente returns a list of 38 non-supporting SNPs. All SNPs that visually correlate only with the samples with macrolide resistance were kept in the visualization. We tolerated the correlation with unresolved bases (<italic toggle="yes">N</italic>), since they could refer to any allele at the position. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1a</xref> shows two SNPs having a clear correlation with resistant samples, since all sensitive samples show the reference allele at these positions. These two SNPs are the only ones of the 38 identified SNPs that show a correlation with the resistant samples. These positions (genomic positions 235 204 and 283 649) are found within the 23S rRNA operon, whose modification is associated with the resistance against azithromycin (<xref rid="vbac075-B30" ref-type="bibr">Stamm, 2010</xref>). With this finding, researchers could now test the samples for which the macrolide resistance data are not available but show these SNPs for resistance.</p>
    <p>Finally, to demonstrate how Evidente can be used to fulfill task <italic toggle="yes">T</italic><sub>4</sub>, the clade SS14 of <italic toggle="yes">T.pallidum</italic> was analyzed to identify enriched GO-terms within the clade. The GFF annotation file of the Nichols strain (RefSeq NC_021490) was used, since this reference genome was used to compute the SNP-table (<xref rid="vbac075-B24" ref-type="bibr">Pla-Díaz <italic toggle="yes">et al.</italic>, 2022</xref>). The GO-term IDs related to the coding genes were predicted using FACoP (<ext-link xlink:href="http://facop.molgenrug.nl/" ext-link-type="uri">http://facop.molgenrug.nl/</ext-link>). This analysis returned 61 significantly enriched GO-terms within the SS14 clade. The four most significant results were related to the cell’s membrane (GO: 0061024, GO: 0019867, GO: 0071709, GO: 0009279, <italic toggle="yes">P</italic>-value = 6.29 × 10<sup>−31</sup>). Evidente also allows the user to visualize the distribution of (supporting or non-supporting) SNPs found within genes labeled with the GO-term of interest. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1b</xref> shows the distribution of all SNPs in those genes that are associated with the GO-term <italic toggle="yes">membrane organization</italic> (GO: 0061024). However, the SNP distribution hints that the over-representation is not unique for clade SS14, since a second clade (with the TPE/TEN samples) also shows SNPs in genes associated with this GO-term.</p>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Evidente is designed to simultaneously visualize the phylogenetic information, genome-wide SNP data and further aspects of an evolutionary reconstruction of different samples or strains from a single species. As a true visual analytics tool, it does not only provide a visual link by aligning the SNPs to the dendrogram, but it also links them computationally with its module CLASSICO, which adds the structural information ‘supporting of the tree structure’ and ‘non-supporting of the structure’ to the SNPs. Moreover, this type of tree visualization is one of the most commonly used in related work and therefore is easy to interpret for users. Another layer of information is added with the GO-term enrichment analysis, which aims to find significantly enriched functions for genes affected by SNPs in a clade of interest. Further features, such as filtering, aggregation and selection, facilitate the interaction with the tool.</p>
    <p>With the two case studies, we showed that the simultaneous visualization of SNP data and metadata, and the integration of an enrichment analysis provided in Evidente supports the identification of interesting patterns, within analyses focused on the spread of a pathogen or in antibiotic resistance development. In the first case study, where modern and ancient samples of the <italic toggle="yes">M. leprae</italic> were analyzed, we showed that Evidente can effectively be used to summarize metadata by collapsing clades. Moreover, we analyzed how strongly a certain clade is supported by the SNPs. This distinction helps finding SNPs that are unique to a clade, which might be candidates for a closer inspection by a domain expert.</p>
    <p>In the second case study, an exploration process was shown for finding SNPs that are non-supporting for the tree structure but correlate with metadata for samples of <italic toggle="yes">T.pallidum</italic>. Such correlations can, e.g. indicate convergent evolution, where strains in different clades in the tree develop similar mutation due to a shared environmental factor. Furthermore, we were able to show how SNPs in genes associated with a specific GO-term are distributed in the tree to find GO-terms specific for the genes affected by SNPs in two of the three main clades in the phylogenetic tree of <italic toggle="yes">T. pallidum</italic>.</p>
    <p>In both case studies, phylogenies of bacterial strains were used. While this data source is suitable since SNP-based phylogenetic trees are often used for the analysis of the evolution of (bacterial but also viral) pathogens and their strains, the interest on eukaryotic pangenomes has started to increase in the last years (<xref rid="vbac075-B25" ref-type="bibr">Richard, 2020</xref>). Due to the simple data formats, Evidente can be applied to any properly formatted phylogenetic tree and SNP data table and thus also deal with eukaryotic pangenomes.</p>
    <p>In our use-cases, the phylogenetic tree was based on the SNPs themselves, but it might also be interesting to use the tool for analyzing a tree that is not SNP-based to investigate how well, for instance, a tree reconstructed using the whole genome is supported by SNPs. Currently, the usage of Evidente is restricted to the analysis of samples with a common genomic coordinate system. Hence, insertions and deletions are not considered.</p>
    <p>In the current implementation, only SNPs that are found uniquely in clades, i.e. monophyletic groups are considered supporting in order to ensure clade-conformation. However, a further category, which could be considered supporting are SNPs found within a paraphyletic group. Such a third category of SNPs will be a future work for Evidente’s preprocessing module CLASSICO.</p>
    <p>Presently, Evidente provides a user-friendly interaction with phylogenetic trees up to a couple of hundred genomes, like the examples shown here on a laptop screen. The largest phylogenetic tree visualized so far in Evidente is the one of <italic toggle="yes">M. leprae</italic>. An overview of the data that consists of 159 samples is provided due to the possibility of collapsing clades. To facilitate the visualization of even larger trees, we plan to work on enhancing the tree scalability. For such trees, one future implementation could provide automatic collapsing of clades to reduce the number of nodes shown. With this, the user is first shown an overview of the data, before having the possibility of decollapsing clades to zoom in and interact with more detailed data, thus implementing the visual information seeking mantra by <xref rid="vbac075-B28" ref-type="bibr">Shneiderman (1996)</xref>. With respect to the scalability of the SNPs, as there is a fixed minimum width for the rectangles displaying them, the number of SNPs that can be displayed at the same time depends on the screen width. For the <italic toggle="yes">M. leprae</italic>’s use-case, around 100 SNPs were studied simultaneously. Further SNPs can be explored by horizontally dragging the SNP heat map.</p>
    <p>With the inclusion of GO-terms in the analysis, Evidente offers already the exploration of a wide range of functions. Further future work will expand the statistical computations of Evidente, such as e.g. by integrating KEGG pathways as another resource for an enrichment analysis. Moreover, we will provide further methods for statistical correction. In addition, we plan to include the metadata into the computational analysis, by either conducting an enrichment based on the metadata, or by automatically identifying SNP patterns that correlate with metadata.</p>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>We have presented Evidente, a web-application that enables an interactive and simultaneous visualization of phylogenetic, genome-wide SNP data and further metadata. The linked dendrogram of the phylogenetic tree with the two heat map-like table visualizations make the visual assessment of clade-specific or non-clade-specific SNPs and the connection of SNPs with specific metadata as well as enriched GO-terms straight-forward. With these visualization approaches and the functionalities implemented in Evidente, the identified tasks required for the interaction with the underlying data could be addressed successfully as demonstrated in the case studies. Hence, Evidente allows the exploration and identification of possible associations that may not be immediately evident in the data.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbac075_Supplementary_Data</label>
      <media xlink:href="vbac075_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank Sophie Pesch for the implementation of the statistical methods for Evidente. Furthermore, thanks to Katrin Fisher for the development of CLASSICO and Alexander Seitz for the joint work in Evidente’s first prototype. We thank our two domain experts Natasha Arora and Marta Pla-Díaz.</p>
    <sec>
      <title>Author contributions</title>
      <p>M.W.P. and K.N. conceived and presented the idea. M.W.P. and T.A.H. worked out the technical details and carried out the implementation. M.W.P. created the figures. All authors wrote and reviewed the manuscript.</p>
    </sec>
    <sec>
      <title>Funding</title>
      <p>This work was supported by infrastructural funding from the Cluster of Excellence EXC 2124 ‘Controlling Microbes to Fight Infections’ [project ID 390838134 to M.W.P. and K.N.] from the DFG. T.A.H. is supported by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation)—TRR261 [project ID 398967434]. We acknowledge support by the Open Access Publishing Fund of the University of Tübingen.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>The data underlying this article are available in the article and in its online supplementary material.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbac075-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arora</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Origin of modern syphilis and emergence of a pandemic <italic toggle="yes">Treponema pallidum</italic> cluster</article-title>. <source>Nat. Microbiol</source>., <volume>2</volume>, <fpage>1</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac075-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashburner</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2000</year>) <article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium</article-title>. <source>Nat. Genet</source>., <volume>25</volume>, <fpage>25</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bostock</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>D<sup>3</sup> data-driven documents</article-title>. <source>IEEE Trans. Vis. Comput. Graph</source>., <volume>17</volume>, <fpage>2301</fpage>–<lpage>2309</lpage>.<pub-id pub-id-type="pmid">22034350</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Faison</surname><given-names>W.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Whole genome single-nucleotide variation profile-based phylogenetic tree building methods for analysis of viral, bacterial and human genomes</article-title>. <source>Genomics</source>, <volume>104</volume>, <fpage>1</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">24930720</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Filliol</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2006</year>) <article-title>Global phylogeny of Mycobacterium tuberculosis based on single nucleotide polymorphism (SNP) analysis: insights into tuberculosis evolution, phylogenetic accuracy of other DNA fingerprinting systems, and recommendations for a minimal standard SNP set</article-title>. <source>J. Bacteriol</source>., <volume>188</volume>, <fpage>759</fpage>–<lpage>772</lpage>.<pub-id pub-id-type="pmid">16385065</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fisher</surname><given-names>R.A.</given-names></string-name></person-group> (<year>1922</year>) <article-title>On the interpretation of <italic toggle="yes">χ</italic>2 from contingency tables, and the calculation of P</article-title>. <source>J. R. Stat. Soc</source>., <volume>85</volume>, <fpage>87</fpage>–<lpage>94</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac075-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Foster</surname><given-names>J.T.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Whole-genome-based phylogeny and divergence of the genus Brucella</article-title>. <source>J. Bacteriol</source>., <volume>191</volume>, <fpage>2864</fpage>–<lpage>2870</lpage>.<pub-id pub-id-type="pmid">19201792</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fraser</surname><given-names>C.M.</given-names></string-name></person-group><etal>et al</etal> (<year>1998</year>) <article-title>Complete genome sequence of <italic toggle="yes">Treponema pallidum</italic>, the syphilis spirochete</article-title>. <source>Science</source>, <volume>281</volume>, <fpage>375</fpage>–<lpage>388</lpage>.<pub-id pub-id-type="pmid">9665876</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goodwin</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Coming of age: ten years of next-generation sequencing technologies</article-title>. <source>Nat. Rev. Genet</source>., <volume>17</volume>, <fpage>333</fpage>–<lpage>351</lpage>.<pub-id pub-id-type="pmid">27184599</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Grinberg</surname><given-names>M.</given-names></string-name></person-group> (<year>2018</year>) <source>Flask Web Development: Developing Web Applications with Python</source>. <publisher-name>O’Reilly Media, Inc., Sebastopol, California, USA</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbac075-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hadfield</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Nextstrain: real-time tracking of pathogen evolution</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>4121</fpage>–<lpage>4123</lpage>.<pub-id pub-id-type="pmid">29790939</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Holm</surname><given-names>S.</given-names></string-name></person-group> (<year>1979</year>) <article-title>A simple sequentially rejective multiple test procedure</article-title>. <source>Scand. J. Stat</source>., <volume>6</volume>, <fpage>65</fpage>–<lpage>70</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac075-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klopfenstein</surname><given-names>D.V.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>GOATOOLS: a python library for gene ontology analyses</article-title>. <source>Sci. Rep</source>., <volume>8</volume>, <fpage>10872</fpage>.<pub-id pub-id-type="pmid">30022098</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kreft</surname><given-names>Ł.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>PhyD3: a phylogenetic tree viewer with extended phyloXML support for functional genomics data visualization</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>2946</fpage>–<lpage>2947</lpage>.<pub-id pub-id-type="pmid">28525531</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>MEGA X: molecular evolutionary genetics analysis across computing platforms</article-title>. <source>Mol. Biol. Evol</source>., <volume>35</volume>, <fpage>1547</fpage>–<lpage>1549</lpage>.<pub-id pub-id-type="pmid">29722887</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>T.-H.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>SNPhylo: a pipeline to construct a phylogenetic tree from huge SNP data</article-title>. <source>BMC Genomics</source>, <volume>15</volume>, <fpage>162</fpage>.<pub-id pub-id-type="pmid">24571581</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leekitcharoenphon</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>snpTree-a web-server to identify and construct SNP trees from whole genome sequence data</article-title>. <source>BMC Genomics</source>, <volume>13</volume>, <fpage>S6</fpage>–<lpage>S8</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac075-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Letunic</surname><given-names>I.</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Interactive tree of life (iTOL) v4: recent updates and new developments</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>W256</fpage>–<lpage>W259</lpage>.<pub-id pub-id-type="pmid">30931475</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Monot</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Comparative genomic and phylogeographic analysis of <italic toggle="yes">Mycobacterium leprae</italic></article-title>. <source>Nat. Genet</source>., <volume>41</volume>, <fpage>1282</fpage>–<lpage>1289</lpage>.<pub-id pub-id-type="pmid">19881526</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B20">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Munzner</surname><given-names>T.</given-names></string-name></person-group> (<year>2014</year>) <source>Visualization Analysis and Design: Abstraction, Principles and Methods</source>. <publisher-name>CRC Press, Boca Raton, Florida, USA</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbac075-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pandya</surname><given-names>G.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Whole genome single nucleotide polymorphism based phylogeny of <italic toggle="yes">Francisella tularensis</italic> and its application to the development of a strain typing assay</article-title>. <source>BMC Microbiol</source>., <volume>9</volume>, <fpage>213</fpage>.<pub-id pub-id-type="pmid">19811647</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peltzer</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>EAGER: efficient ancient genome reconstruction</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">26753840</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Petkau</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>SNVPhyl: a single nucleotide variant phylogenomics pipeline for microbial genomic epidemiology</article-title>. <source>Microb. Genom</source>., <volume>3</volume>, <fpage>e000116</fpage>.<pub-id pub-id-type="pmid">29026651</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pla-Díaz</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Evolutionary processes in the emergence and recent spread of the syphilis agent, <italic toggle="yes">Treponema pallidum</italic></article-title>. <source>Mol. Biol. Evol</source>., <volume>39</volume>, <fpage>msab318</fpage>.<pub-id pub-id-type="pmid">34791386</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B25">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Richard</surname><given-names>G.-F.</given-names></string-name></person-group> (<year>2020</year>) <part-title>Eukaryotic pangenomes</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Tettelin</surname><given-names>H.</given-names></string-name>, <string-name><surname>Medini</surname><given-names>D.</given-names></string-name></person-group> (eds) <source>The Pangenome: Diversity, Dynamics and Evolution of Genomes</source>. <publisher-name>Springer Nature Switzerland AG, Switzerland, pp. 253–291</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbac075-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schuenemann</surname><given-names>V.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Ancient genomes reveal a high diversity of <italic toggle="yes">Mycobacterium leprae</italic> in medieval Europe</article-title>. <source>PLoS Pathog</source>., <volume>14</volume>, <fpage>e1006997</fpage>.<pub-id pub-id-type="pmid">29746563</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shank</surname><given-names>S.D.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Phylotree. js-a JavaScript library for application development and interactive data visualization in phylogenetics</article-title>. <source>BMC Bioinformatics</source>, <volume>19</volume>, <fpage>276</fpage>.<pub-id pub-id-type="pmid">30045713</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shneiderman</surname><given-names>B.</given-names></string-name></person-group> (<year>1996</year>) The eyes have it: a task by data type taxonomy for information visualizations. In: <italic toggle="yes">Proceedings of IEEE Symposium on Visual Languages</italic>, Vol. <volume>96</volume>. Boulder, CO, USA.</mixed-citation>
    </ref>
    <ref id="vbac075-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Spyrou</surname><given-names>M.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Ancient pathogen genomics as an emerging tool for infectious disease research</article-title>. <source>Nat. Rev. Genet</source>., <volume>20</volume>, <fpage>323</fpage>–<lpage>340</lpage>.<pub-id pub-id-type="pmid">30953039</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stamm</surname><given-names>L.V.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Global challenge of antibiotic-resistant <italic toggle="yes">Treponema pallidum</italic></article-title>. <source>Antimicrob. Agents Chemother</source>., <volume>54</volume>, <fpage>583</fpage>–<lpage>589</lpage>.<pub-id pub-id-type="pmid">19805553</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Evolview v3: a webserver for visualization, annotation, and management of phylogenetic trees</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>W270</fpage>–<lpage>W275</lpage>.<pub-id pub-id-type="pmid">31114888</pub-id></mixed-citation>
    </ref>
    <ref id="vbac075-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tilkov</surname><given-names>S.</given-names></string-name>, <string-name><surname>Vinoski</surname><given-names>S.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Node.js: using JavaScript to build high-performance network programs</article-title>. <source>IEEE Internet Comput</source>., <volume>14</volume>, <fpage>80</fpage>–<lpage>83</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac075-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>H-l.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>A simple way to visualize detailed phylogenetic tree of huge genome-wide SNP data constructed by SNPhylo</article-title>. <source>J. Integr. Agric</source>., <volume>17</volume>, <fpage>1972</fpage>–<lpage>1978</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
