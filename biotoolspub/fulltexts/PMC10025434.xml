<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10025434</article-id>
    <article-id pub-id-type="pmid">36847692</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbad061</article-id>
    <article-id pub-id-type="publisher-id">bbad061</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>IBRAP: integrated benchmarking single-cell RNA-sequencing analytical pipeline</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Knight</surname>
          <given-names>Connor H</given-names>
        </name>
        <!--c.h.knight@qmul.ac.uk-->
        <aff><institution>Centre for Cancer Genomics and Computational Biology, Barts Cancer Institute, Queen Mary University of London</institution>, London EC1M 6BQ</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Khan</surname>
          <given-names>Faraz</given-names>
        </name>
        <!--faraz.khan@qmul.ac.uk-->
        <aff><institution>Centre for Cancer Genomics and Computational Biology, Barts Cancer Institute, Queen Mary University of London</institution>, London EC1M 6BQ</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Patel</surname>
          <given-names>Ankit</given-names>
        </name>
        <!--ankit.patel@qmul.ac.uk-->
        <aff><institution>Centre for Cancer Genomics and Computational Biology, Barts Cancer Institute, Queen Mary University of London</institution>, London EC1M 6BQ</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gill</surname>
          <given-names>Upkar S</given-names>
        </name>
        <!--u.gill@qmul.ac.uk-->
        <aff><institution>Centre for Immunobiology, Blizard Institute, Faculty of Medicine and Dentistry Medicine &amp; Dentistry, Queen Mary University of London</institution>, London E1 2AT, United Kingdom</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Okosun</surname>
          <given-names>Jessica</given-names>
        </name>
        <!--j.okosun@qmul.ac.uk-->
        <aff><institution>Centre for Haemato-Oncology, Barts Cancer Institute, Queen Mary University of London</institution>, London EC1M 6BQ</aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2509-9599</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Jun</given-names>
        </name>
        <!--j.a.wang@qmul.ac.uk-->
        <aff><institution>Centre for Cancer Genomics and Computational Biology, Barts Cancer Institute, Queen Mary University of London</institution>, London EC1M 6BQ</aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding author: Jun Wang, Centre for Cancer Genomics and Computational Biology, Barts Cancer Institute, Queen Mary University of London, London EC1M 6BQ, UK. E-mail: <email>j.a.wang@qmul.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-02-27">
      <day>27</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <issue>2</issue>
    <elocation-id>bbad061</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bbad061.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Single-cell ribonucleic acid (RNA)-sequencing (scRNA-seq) is a powerful tool to study cellular heterogeneity. The high dimensional data generated from this technology are complex and require specialized expertise for analysis and interpretation. The core of scRNA-seq data analysis contains several key analytical steps, which include pre-processing, quality control, normalization, dimensionality reduction, integration and clustering. Each step often has many algorithms developed with varied underlying assumptions and implications. With such a diverse choice of tools available, benchmarking analyses have compared their performances and demonstrated that tools operate differentially according to the data types and complexity. Here, we present Integrated Benchmarking scRNA-seq Analytical Pipeline (IBRAP), which contains a suite of analytical components that can be interchanged throughout the pipeline alongside multiple benchmarking metrics that enable users to compare results and determine the optimal pipeline combinations for their data. We apply IBRAP to single- and multi-sample integration analysis using primary pancreatic tissue, cancer cell line and simulated data accompanied with ground truth cell labels, demonstrating the interchangeable and benchmarking functionality of IBRAP. Our results confirm that the optimal pipelines are dependent on individual samples and studies, further supporting the rationale and necessity of our tool. We then compare reference-based cell annotation with unsupervised analysis, both included in IBRAP, and demonstrate the superiority of the reference-based method in identifying robust major and minor cell types. Thus, IBRAP presents a valuable tool to integrate multiple samples and studies to create reference maps of normal and diseased tissues, facilitating novel biological discovery using the vast volume of scRNA-seq data available.</p>
    </abstract>
    <kwd-group>
      <kwd>single-cell RNA-seq</kwd>
      <kwd>analytical pipeline</kwd>
      <kwd>benchmarking</kwd>
      <kwd>data integration</kwd>
      <kwd>cell annotation</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Cancer Research UK</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000289</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>C355/A26819</award-id>
        <award-id>C57432/A22742</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Fundación Científica de la Asociación Española Contra el Cáncer and Fondazione AIRC per la Ricerca sul Cancro</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Cancer Research UK Centre of Excellence Award to Barts Cancer Centre</institution>
          </institution-wrap>
        </funding-source>
        <award-id>C16420/A18066</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Medical Research Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100009187</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>MRF-044-0004-F-GILL-C0823</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Academy of Medical Sciences Springboard Award</institution>
          </institution-wrap>
        </funding-source>
        <award-id>SBF003\1025</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec3">
    <title>Introduction</title>
    <p>Single-cell ribonucleic acid (RNA)-sequencing (scRNA-seq) has innovated transcriptome characterization, enabling high-resolution investigation into heterogeneous cell populations in health and disease. The work stream starts from library preparation procedures, broadly categorized into plate- and droplet-based methods. Each approach is distinguished by different technical variations within the protocol, including how the single cells are isolated, the extent of transcript coverage, whether unique molecular identifiers are incorporated and more [<xref rid="ref1" ref-type="bibr">1</xref>]. Regardless, all platforms downstream result in raw scRNA-seq data that align against transcriptomes with alignment software that generate count matrices representing individual cells, genes and the number of corresponding transcripts. Post-alignment bioinformatic processing predominantly encompasses the following stages: pre-processing, quality control (QC), normalization, integration, clustering and differential expression analysis (DEA) [<xref rid="ref2" ref-type="bibr">2</xref>]. Numerous analytical packages and components are available for each of these steps with an exponential increase in scRNA-seq packages, from just 84 (in 2017) to 1192 different packages (18 March 2022) across both Python (39.7%) and R (58.1%) programming languages. With numerous algorithm choices, it is difficult for the growing community of users to decide which application(s) is best for their data and bespoke pipeline development, especially considering that each algorithm has its own set of strengths and limitations [<xref rid="ref3" ref-type="bibr">3</xref>].</p>
    <p>Several benchmarking studies have been performed for either individual aspects of scRNA-seq bioinformatics (i.e. normalization, integration and clustering) or as pipelines as a whole. Unsurprisingly, there remains no singular approach to gain the best results across every different dataset scenario, which leads to multiple tool recommendations or case-by-case recommendations [<xref rid="ref2" ref-type="bibr">2</xref>, <xref rid="ref4" ref-type="bibr">4–11</xref>]. Since tools are not integrated, custom pipeline coding is required which is tedious with inevitable room for errors. Thus, there is a need for a comprehensive tool that already combines different pipelines and tools, with interchangeability and capable of distinguishing pipeline performance.</p>
    <p>Other well-established pipelines, including Seurat [<xref rid="ref12" ref-type="bibr">12</xref>], Scanpy [<xref rid="ref13" ref-type="bibr">13</xref>] and Pegasus [<xref rid="ref14" ref-type="bibr">14</xref>], lack a variety of methodology for users to interchange, leaving the users with relatively linear approaches to their analyses (<xref rid="TB1" ref-type="table">Table 1</xref>). ASAP [<xref rid="ref15" ref-type="bibr">15</xref>], a web-based analytical pipeline, sought to integrate a range of analytical methods but is missing a large variety of single-cell-specific methods for single-cell data; a further limitation of ASAP is that it lacks a variety of benchmarking capabilities to distinguish performances.</p>
    <table-wrap position="float" id="TB1">
      <label>Table 1</label>
      <caption>
        <p>Table of leading scRNA-seq pipelines for comparison to IBRAP</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th align="left" rowspan="1" colspan="1">Droplet pre-processing</th>
            <th align="left" rowspan="1" colspan="1">Normalization</th>
            <th align="left" rowspan="1" colspan="1">Integration</th>
            <th align="left" rowspan="1" colspan="1">Reduction</th>
            <th align="left" rowspan="1" colspan="1">Clustering</th>
            <th align="left" rowspan="1" colspan="1">Trajectory inference</th>
            <th align="left" rowspan="1" colspan="1">Benchmarking</th>
            <th align="left" rowspan="1" colspan="1">Platform</th>
            <th align="left" rowspan="1" colspan="1">
              <bold>Misc</bold>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" rowspan="1" colspan="1">IBRAP</td>
            <td align="left" rowspan="1" colspan="1">Scrublet DecontX</td>
            <td align="left" rowspan="1" colspan="1">Scanpy (CPM), TPM, Scran, SCTransform</td>
            <td align="left" rowspan="1" colspan="1">BBKNN, Scanorama, CCA, Harmony</td>
            <td align="left" rowspan="1" colspan="1">PCA, diffusion maps, t-SNE, UMAP, LargeVis</td>
            <td align="left" rowspan="1" colspan="1">Kmeans, PAM, SC3, Louvain, Louvain with multilevel refinement, smart local moving, Leiden, singleR, scType</td>
            <td align="left" rowspan="1" colspan="1">Slingshot</td>
            <td align="left" rowspan="1" colspan="1">ASW (biological and batch), ARI, NMI, connectivity, Dunn index</td>
            <td align="left" rowspan="1" colspan="1">R</td>
            <td align="left" rowspan="1" colspan="1">CellTalker (cell–cell communication) ssGSEA (Gene Set Enrichment)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">ASAP</td>
            <td align="left" rowspan="1" colspan="1">None</td>
            <td align="left" rowspan="1" colspan="1">CPM, DESeq2, voom, log2, SCTransform</td>
            <td align="left" rowspan="1" colspan="1">ComBat, fastMNN, Limma</td>
            <td align="left" rowspan="1" colspan="1">PCA, UMAP, t-SNE</td>
            <td align="left" rowspan="1" colspan="1">Kmeans, PAM, SC3, Louvain, Louvain with multilevel refinement, smart local moving, Leiden</td>
            <td align="left" rowspan="1" colspan="1">None</td>
            <td align="left" rowspan="1" colspan="1">None</td>
            <td align="left" rowspan="1" colspan="1">Web</td>
            <td align="left" rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">scCancer</td>
            <td align="left" rowspan="1" colspan="1">SoupX, Scds</td>
            <td align="left" rowspan="1" colspan="1">Lognorm</td>
            <td align="left" rowspan="1" colspan="1">CCA, Harmony, Liger</td>
            <td align="left" rowspan="1" colspan="1">PCA, t-SNE, UMAP</td>
            <td align="left" rowspan="1" colspan="1">Louvain</td>
            <td align="left" rowspan="1" colspan="1">None</td>
            <td align="left" rowspan="1" colspan="1">None</td>
            <td align="left" rowspan="1" colspan="1">R</td>
            <td align="left" rowspan="1" colspan="1">GSVA (Gene Set Enrichment) NMF custom cell interaction analysis</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Scanpy</td>
            <td align="left" rowspan="1" colspan="1">Scrublet</td>
            <td align="left" rowspan="1" colspan="1">CPM</td>
            <td align="left" rowspan="1" colspan="1">ComBat, BBKNN, Scanorama, MNN</td>
            <td align="left" rowspan="1" colspan="1">PCA, diffusion maps. T-SNE, UMAP</td>
            <td align="left" rowspan="1" colspan="1">Louvain, Leiden, ingest</td>
            <td align="left" rowspan="1" colspan="1">PAGA</td>
            <td align="left" rowspan="1" colspan="1">None</td>
            <td align="left" rowspan="1" colspan="1">Python</td>
            <td align="left" rowspan="1" colspan="1">Differential Expression Enrichment</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Seurat</td>
            <td align="left" rowspan="1" colspan="1">None</td>
            <td align="left" rowspan="1" colspan="1">Lognorm, SCTransform</td>
            <td align="left" rowspan="1" colspan="1">CCA</td>
            <td align="left" rowspan="1" colspan="1">PCA, ICA, t-SNE, UMAP</td>
            <td align="left" rowspan="1" colspan="1">Louvain, Louvain with multilevel refinement, smart local moving, Leiden</td>
            <td align="left" rowspan="1" colspan="1">None</td>
            <td align="left" rowspan="1" colspan="1">None</td>
            <td align="left" rowspan="1" colspan="1">R</td>
            <td align="left" rowspan="1" colspan="1">None</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Pegasus</td>
            <td align="left" rowspan="1" colspan="1">None</td>
            <td align="left" rowspan="1" colspan="1">Counts per 100 000</td>
            <td align="left" rowspan="1" colspan="1">Harmony, Scanorama</td>
            <td align="left" rowspan="1" colspan="1">PCA, diffusion maps, FLE</td>
            <td align="left" rowspan="1" colspan="1">Louvain, Leiden</td>
            <td align="left" rowspan="1" colspan="1">FLE-based</td>
            <td align="left" rowspan="1" colspan="1">kBET, kSIM</td>
            <td align="left" rowspan="1" colspan="1">Python/ Web</td>
            <td align="left" rowspan="1" colspan="1">None</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>Here we present Integrated Benchmarking scRNA-seq Analytical Pipeline (IBRAP), a wrapper package that contains unique combinations of several pipelines (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S1</xref>) by interchanging normalization (the number of methods, <italic toggle="yes">n</italic> = 4), integration (<italic toggle="yes">n</italic> = 4) and clustering (<italic toggle="yes">n</italic> = 7) components to create a unique workflow, which includes pre-processing, QC, normalization, integration, clustering and DEA in a dataset-specific manner to maximize sensitivity and specificity of identifying the accurate cell (sub-)types. Furthermore, we include five benchmarking metrics that can be applied to distinguish clustering performance and a metric for users to assess batch effect removal. We enlisted 15 publicly available datasets and generated 4 and 6 simulated datasets using splatter [<xref rid="ref16" ref-type="bibr">16</xref>] and SymSim [<xref rid="ref17" ref-type="bibr">17</xref>], respectively. We applied all possible pipelines (adjusting parameter changes for expected clusters), to demonstrate the functionality of IBRAP and benchmark individual and integrated analysis. We further investigated the reference-based cell annotation compared with the unsupervised analysis in their ability to identify robust major and rare cell types and demonstrated the potential usage of IBRAP in a reference map or atlas like projects.</p>
    <fig position="float" id="f1">
      <label>Figure 1</label>
      <caption>
        <p>A workflow for scRNA-seq analyses in IBRAP. IBRAP accepts droplet- and non-droplet-based scRNA-seq counts. If the user has processed their cells with droplet-based infrastructure, they may use our droplet-based cleaning packages that we included (DecontX and Scrublet). Otherwise, the user may continue to data transformation encompassed with normalization, highly variable gene selection and, when required, sample integration. After this has been performed, a user then proceeds to inference, where a user will identify cell clusters, identify developmental trajectories, label their cell types using a reference-based package singleR, or a canonical marker-based cell annotation package scType, or infer cell–cell communication. The user can then use our Rshiny application to investigate their results in an easier fashion than using the terminal. Finally, if the user opts for finding cell clusters from the unsupervised clustering, they must uncover the biology driving the clusters to identify their cell types. For this, the user can produce a range of different gene expression plots, differential expression and a Gene Set Enrichment Analysis using ssGSEA.</p>
      </caption>
      <graphic xlink:href="bbad061f1" position="float"/>
    </fig>
  </sec>
  <sec id="sec4">
    <title>Materials and methods</title>
    <sec id="sec5">
      <title>Workflow overview</title>
      <p>IBRAP consists of four main modules, namely data transformation, inference, Rshiny application and biological analysis (<xref rid="f1" ref-type="fig">Figure 1</xref>). Within the data transformation module, data QC is performed, including doublet (libraries mistakenly generated from two or more cells) removal and ambient RNA (mRNA derived from non-barcoded lysed cells) decontamination (if needed) followed by normalization, highly variable gene (HVG) selection and dimensionality reduction. Within the normalization step, four leading methods are contained, including Scanpy (CPM, counts per million) [<xref rid="ref13" ref-type="bibr">13</xref>], SCTransform [<xref rid="ref12" ref-type="bibr">12</xref>], Scran [<xref rid="ref18" ref-type="bibr">18</xref>] and TPM (transcripts per kilobase million). For dimensionality reduction, five different techniques, PCA [<xref rid="ref19" ref-type="bibr">19</xref>], Diffusion Maps [<xref rid="ref20" ref-type="bibr">20</xref>], t-SNE [<xref rid="ref21" ref-type="bibr">21</xref>], Largevis [<xref rid="ref21" ref-type="bibr">21</xref>] and UMAP [<xref rid="ref12" ref-type="bibr">12</xref>], were incorporated (<xref rid="TB1" ref-type="table">Table 1</xref>). In addition to single sample analysis, IBRAP also incorporated four commonly used multi-sample integration methods, needed to remove unwanted technical and biological variability, that showed good performances in benchmarking studies, including BBKNN [<xref rid="ref22" ref-type="bibr">22</xref>], Harmony [<xref rid="ref23" ref-type="bibr">23</xref>], Seurat CCA [<xref rid="ref12" ref-type="bibr">12</xref>] and Scanorama [<xref rid="ref24" ref-type="bibr">24</xref>] which allows users to perform integration and compare performances for their samples.</p>
      <p>Within the inference module, IBRAP can perform clustering, automated cell labelling, trajectory inference (e.g. Slingshot [<xref rid="ref25" ref-type="bibr">25</xref>]), and cell–cell communication (e.g. CellTalker [<xref rid="ref26" ref-type="bibr">26</xref>] analyses (<xref rid="f1" ref-type="fig">Figure 1</xref>). Within the clustering step, a selection of popular clustering techniques was integrated, including k-means, PAM, SC3, Louvain, Louvain with multilevel refinement (louvainMLR), smart local moving (SLM) and Leiden. To annotate cell types that are contained within clusters, a novel marker gene-based method scType [<xref rid="ref27" ref-type="bibr">27</xref>] was implemented, which uses a comprehensive canonical marker database of 115 cells present in six different tissue types as reference information. SingleR [<xref rid="ref28" ref-type="bibr">28</xref>] was also included in the inference module which allows users to perform supervised clustering based on a reference dataset to achieve automated cell annotation. By allowing the interchange of a diverse selection of methods within key analytic steps, e.g. normalization, integration, reduction and clustering, IBRAP can create a large number of method combinations (pipelines) and subsequent results. Indeed, IBRAP contains up to four normalization, five visualization and seven clustering methods for individual samples and four methods for integration analyses. Given the large number of method combinations (i.e. pipelines) produced, we created the benchmarking function within IBRAP that produces and visualizes benchmarking matrices and distinguish optimal results for individual samples and studies. Consequently, IBRAP produces a large volume of data, hence we designed object orientated functions around a novel S4 class object in <italic toggle="yes">R</italic>.</p>
    </sec>
    <sec id="sec6">
      <title>Case study samples</title>
      <sec id="sec7">
        <title>Pancreas</title>
        <p>All eight datasets (cells = 14 890) derived from normal pancreas tissue were available from the package SeuratData containing 13 cell-type ground truth labels. Datasets were derived from four individual studies [<xref rid="ref29" ref-type="bibr">29–32</xref>] using five different library preparation technologies: CELseq, CELseq2, SmartSeq2, Fluidigmc1 and InDrop. Further information can be seen in <xref rid="sup2" ref-type="supplementary-material">Supplementary Table S2</xref>.</p>
      </sec>
      <sec id="sec8">
        <title>Cell lines</title>
        <p>Seven mixed cell line samples (cells = 6228), consisting of five human lung adenocarcinoma cell lines (HCC827, H1975, A549, H838 and H2228), were acquired for a previously performed mixture control study [<xref rid="ref7" ref-type="bibr">7</xref>]. Three of these samples contain cell lines: HCC827, H1975 and H2228, and four samples contain cell lines: HCC827, H1975, H2228, H838 and A549. These samples were processed with 10x Genomics, Dropseq, CELseq2. Further information detailed in <xref rid="sup2" ref-type="supplementary-material">Supplementary Table S2</xref>.</p>
      </sec>
      <sec id="sec9">
        <title>Simulations</title>
        <p>Four individual simulation samples (cells = 4000) were created using the R package, Splatter. Each sample contained 20 000 genes. The four samples created were categorized as (i) four cell types with the number of cells were split equally among the clusters, (ii) four cell types and the number of cells were unequally distributed among the clusters, (iii) eight cell types and the number of cells were equally spread among clusters and (iv) eight cell types and the number of cells were unequally spread among clusters. Other parameter settings deviated from the default including mean.shape = 0.5, de.prob = 0.2, lib.loc = 12,lib.scale = 0.7. Further information is detailed in <xref rid="sup2" ref-type="supplementary-material">Supplementary Table S2</xref>.</p>
        <p>Four individual samples (cells = 4000) and two samples containing batch effects (cells = 6000 in total) were also simulated using the R package, SymSim. Briefly, samples were simulated to contain varying numbers of clusters and have different sequencing depths among individual samples. The parameters used in the SymSim simulation can be seen in <xref rid="sup2" ref-type="supplementary-material">Supplementary Table S2</xref> and our GitHub page.</p>
      </sec>
    </sec>
    <sec id="sec10">
      <title>Core analysis</title>
      <p>We performed three analyses, one analysing 23 samples individually; a second integrating datasets from the pancreas, cell line and the SymSim simulated cohort; and a third using supervised cell state annotation using references and cell-type labels on query datasets. All analyses were used with IBRAP’s framework and closely followed default settings. In terms of filtration, cells were removed from the datasets if they contained over a calculated number of genes:<disp-formula id="deqn01"><tex-math notation="LaTeX" id="DmEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ \begin{align*} \mathrm{Maximum}\ \mathrm{Feature}\ \mathrm{cut}-\mathrm{off}&amp;=\mathrm{sd}\left(\mathrm{genes}\ \mathrm{per}\ \mathrm{cell}\right)\times 3 \\ &amp;+\mathrm{median}\left(\mathrm{genes}\ \mathrm{per}\ \mathrm{cell}\right) \end{align*} $$\end{document}</tex-math></disp-formula></p>
      <p>We additionally removed cells with less than 200 genes, any cells containing greater than 8% mitochondrial genes detected and any genes that were expressed in less than three cells were also removed.</p>
      <p>For the individual analyses, we implemented SCTransform, Scran and Scanpy for normalization methods with default parameters, regressing out total counts with Scanpy and Scran (note we did not do this for SCTransform since this is already included in the algorithm). We applied graph-based clustering algorithms: Louvain, louvainMLR, SLM and the Leiden algorithms; we also applied older clustering methods including kmeans, PAM and SC3. For all clustering methods, we adjusted cluster diversity by adjusting either the resolution or expected clusters parameters. Following the single sample analysis, we next performed multi-sample integration using the same normalization and clustering methods as the individual samples but using Seurat CCA, BBKNN, Harmony and Scanorama to combine samples from different studies. Finally, to distinguish pipeline performance, we employed Average Silhouette Width (ASW), Adjusted Rand Index (ARI) and normalized Mutual Information (NMI) benchmarking metrics. ASW compares the distance of cell labels in a UMAP projection to assess separateness, and ARI and NMI compare clustered cell labels against a ground truth list. We summarized these scores by ranking them individually, taking the average rank and then scaling from 0 to 100 with 0 and 100 being the worst and best ranking, respectively (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S3</xref>). To benchmark integration results, we applied ASW using batch labels, with a lower score indicating a lower level of batch effects.</p>
      <p>We next sought to assess the efficacy of supervised cell-type annotation versus unsupervised clustering using SingleR, relative to their ground truth labels. We took the eight pancreas samples (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S2</xref>) and used each sample as a query and the remaining seven samples as a reference using their ground truth labels as their annotations. To demonstrate the usage of scType in cell annotation, we also used this package to annotate cell clusters/types identified from the integrated map of the seven pancreas samples and one individual sample of Smartseq2.</p>
    </sec>
  </sec>
  <sec id="sec11">
    <title>Results</title>
    <sec id="sec12">
      <title>Overview of IBRAP</title>
      <p>IBRAP is the most comprehensive scRNA-seq analysis R-based wrapper toolkit that includes a range of single-cell analytical tools across R and Python, compiled into R. To aid users, we produced an installation of 100+ packages and their dependencies, and an S4 class object in R to store large volumes of results. IBRAP enables users to interchange normalization, integration and clustering methods throughout the analytical work stream to tailor pipelines to their specific dataset. Benchmarking metrics are also included which can help guide users to select the best pipeline and parameter choices. In comparison to other methods, IBRAP provides the highest number of scRNA-seq-specific normalization, dimensionality reduction and clustering methods (<xref rid="TB1" ref-type="table">Table 1</xref>), which enables numerous different pipelines and associated results. Furthermore, several benchmarking metrics were included into our benchmarking function, allowing for a detailed inspection and comparison of different results. To facilitate the exploration and comparison of the large volume of results, IBRAP also provides an ease-of-use Rshiny interface.</p>
      <sec id="sec13">
        <title>Rshiny application</title>
        <p>Even with integration benchmarking and a summary of clustering scores, assessing each component through a terminal would be tedious. Thus, we build an ease-of-use Rshiny application called IBRAP Exploration. IBRAP Exploration contains three key areas: interactive reduction visualization (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1<bold>A</bold></xref>), benchmarking visualization (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1<bold>B</bold></xref>) and gene expression visualization (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1<bold>C</bold></xref>). Interactive reduction visualization contains an interactive plot for displaying reduced dimensions and interchanging cell labels from clustering to important metadata such as sequencing depth and mitochondrial fractions. Benchmarking visualization is used for examining benchmarking metrics that explain clustering and benchmarking performance to aid users in selecting best clustering results. Finally, gene expression visualization for dissecting gene expression that may have driven the clustering and can describe cell types contained in clusters. This tool will enable users to interactively and swiftly visualize their results.</p>
      </sec>
    </sec>
    <sec id="sec14">
      <title>Case studies</title>
      <p>To demonstrate the effectiveness of the tools in IBRAP, we applied all possible pipelines within IBRAP and performed benchmarking on these results to ascertain their effectiveness. We analysed 15 samples (of 21 029 cells) from publicly available sources and eight simulated datasets (n = 8000) constructed with splatter and Symsim accompanied with ground truth cell annotations, covering a range of biological and technical backgrounds (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S2</xref>). The sample collection included (ii) 8 normal pancreatic samples (cell range: 638–3605 per sample, 13 cell types; technologies: CELseq, CELseq2, SmartSeq2, Fluidigmc1, inDrop); (ii) 7 cell line samples (cell range: 225–3818 per sample, 3–5 cell lines; technologies: 10x, CELseq2, Dropseq); (iii) 4 simulated samples using splatter [<xref rid="ref16" ref-type="bibr">16</xref>] (cells: 1000 per sample, 4–8 cell types) and (iv) 4 individual samples (cells: 1000 per samples, 3–5 cell types) simulated using SymSim [<xref rid="ref17" ref-type="bibr">17</xref>]. Additional two samples containing batch effects (cells: 3000 per sample, three batch effects, five cell types) were also simulated for the integration analysis. For these studies, we applied all normalization (SCTransform; Scanpy; Scran), integration (Scanorama; BBKNN; Seurat CCA; Harmony) and clustering methods (louvain; louvainMLR; SLM; Leiden; SC3; Kmeans; PAM).</p>
      <sec id="sec15">
        <title>Individual sample: unsupervised analysis</title>
        <p>We first applied IBRAP to assess pipeline performance for individual samples. A total of 21 unique pipelines were produced for each sample. After parameter adjustments for the clustering components (e.g. resolution and expected number of clusters), 225–237 different clustering results were generated per sample, and their performance was assessed and compared (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S4</xref>). The average (ARI, NMI and ASW) values for all pancreas, cell line, splatter and SymSim simulation samples were (0.585, 0.694 and 0.512), (0.741, 0.751 and 0.656), (0.912, 0.923 and 0.791) and (0.757, 0.748 and 0.545), respectively (<xref rid="f2" ref-type="fig">Figure 2<bold>A</bold></xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>). Compared to pancreatic samples, cell lines and simulated data often have lower level of cellular complexity, which leads to the requirement of simpler analytical tasks, reflected by the higher average benchmarking scores. However, it seemed that SymSim generated more complex cell mixture in its simulations compared to splatter, and the benchmarking matrices of SymSim samples were close to those of cell lines.</p>
        <fig position="float" id="f2">
          <label>Figure 2</label>
          <caption>
            <p>Individual sample analysis clustering results. (<bold>A</bold>) Benchmarking metrices: ARI, NMI and ASW for pancreas samples. A higher score indicates a better cluster assignment while a lower score is less favourable. (<bold>B</bold>) A heatmap showing the highest and lowest performance scores for each possible pipeline combination (x-axis) compared against each sample (y-axis). A higher (100) score is better, while a lower (0) score is worse.</p>
          </caption>
          <graphic xlink:href="bbad061f2" position="float"/>
        </fig>
        <p>We first assessed how different normalization techniques affected subsequent clustering performances (<xref rid="f2" ref-type="fig">Figure 2</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>). For pancreas samples, the average ARI, NMI and ASW values from results generated by SCTransform (ARI = 0.618, NMI = 0.713, ASW = 0.541) were higher than those by Scran (ARI = 0.609, NMI = 0.701, ASW = 0.526) and Scanpy (ARI = 0.533, NMI = 0.669, ASW = 0.470), indicating that pipelines implementing SCTransform produced superior clustering performance on average. Indeed, when identifying the best performing pipelines benchmarked with the ground truth cell labels, pipelines with SCTransform as the normalization component produced the best clustering performance for seven out of eight pancreatic samples while Scanpy performed best for one (sample = indrop4). For cell line samples, the average ARI, NMI and ASW values generated by Scran (ARI = 0.772, NMI = 0.772, ASW = 0.712) were higher than SCTransform (ARI = 0.766, NMI = 0.774, ASW = 0.683) and Scanpy (ARI = 0.685, NMI = 0.709, ASW = 0.680). Scran achieved the best result for four out of seven (samples = sc_10x, sc_10x_5cl, sc_CELseq2 and scCelseq2_5cl_p3) cell lines, while SCTransfom gave the best clustering performance score for three out of seven samples (samples = scDropseq, scCelseq2_5cl_p1 and scCelseq2_5cl_p2) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>; <xref rid="sup2" ref-type="supplementary-material">Supplementary Table S4</xref>). For SymSim individual samples, SCTransform gave the best clustering results on average with (ARI = 0.824, NMI = 0.810 and ASW = 0.557), followed by Scanpy (ARI = 0.768, NMI = 0.776 and ASW = 0.542) and finally Scran (ARI = 0.679, NMI = 0.660 and ASW = 0.537). However, although SCTransform resulted in the best results on average, Scanpy achieved the best clustering result for all SymSim samples. For Splatter simulated samples, ~49% of the pipelines produced perfect clustering scores regardless of normalization choices due to simplicity of the samples (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>; <xref rid="sup2" ref-type="supplementary-material">Supplementary Table S4</xref>).</p>
        <p>Next, we investigated how clustering algorithm choice affected the overall performance of the pipelines. For pancreas and simulated samples, pipelines consisting of graph-based clustering (Louvain, louvainMLR, SLM and Leiden) produced the best clustering performance in relation to the ground truth cell labels. For cell line samples, there was no consistency in clustering methods incorporated into the highest performing pipelines (<xref rid="f2" ref-type="fig">Figure 2</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>; <xref rid="sup2" ref-type="supplementary-material">Supplementary Table S4</xref>). It is worth noting that the combination of SCTransform with graph-based clustering methods typically achieved better clustering performances in pancreas samples. Overall, our results of normalization and clustering methods comparison still demonstrated that there remains no single gold-standard approach for single sample analysis, therefore necessitating a tool such as IBRAP that has the capacity to build the best combinations for the supplied samples.</p>
        <p>To further demonstrate the utility of results generated by IBRAP, we compared the best and worst performing pipeline generated for one pancreatic sample: Smartseq2 (2394 cells). The best performing pipeline consisted of SCTransform normalization and SLM (resolution = 0.1) clustering (rank score = 100, ARI = 0.739, NMI = 0.803, ASW = 0.753) (<xref rid="f3" ref-type="fig">Figure 3<bold>A</bold></xref>). Eight clusters were identified compared to 13 cell-type ground truth labels (<xref rid="f3" ref-type="fig">Figure 3<bold>B</bold></xref>). Major cell types (including alpha, beta, delta, acinar, ductal and gamma) were mostly clustered correctly; however, minor populations, including epsilon, mast, macrophage, activated and quiescent stellate, schwann and endothelial cells were grouped into a single cluster (cluster 7; <xref rid="f3" ref-type="fig">Figure 3<bold>A</bold></xref> and <bold>B</bold>). This is due to very low numbers of these cell types being present in this sample. The worst performing pipeline consists of Scanpy normalization and SLM (resolution = 0.4) clustering (score = 0, ARI = 0.377, NMI = 0.581, ASW = 0.533) (<xref rid="f3" ref-type="fig">Figure 3<bold>C</bold></xref> and <bold>D</bold>). Seventeen clusters were identified for 13 cell types, major cell types were broken into smaller clusters (i.e. alpha cells into five clusters) and smaller populations such as mast, activated stellate and endothelial cells were still clustered together. It is worth noting that non-graph-based clustering methods such as k-means, PAM and SC3 failed to generate any of the best scores for all pancreas samples (<xref rid="f2" ref-type="fig">Figure 2</xref>).</p>
        <fig position="float" id="f3">
          <label>Figure 3</label>
          <caption>
            <p>Individual sample cluster assignments. (<bold>A</bold>, <bold>B</bold>) UMAP projection for smartseq2 showing good performing cluster assignments compared against their ground truth. (<bold>C</bold>, <bold>D</bold>) UMAP projection for smartseq2 showing poor performing cluster assignments compared against their ground truth.</p>
          </caption>
          <graphic xlink:href="bbad061f3" position="float"/>
        </fig>
        <p>For the 10x cell line sample (3918 cells), the best performing pipeline consisted of Scran normalization and PAM clustering (k = 5) (rank score = 100, ARI = 0.963, NMI = 0.942, ASW = 0.813) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3<bold>A</bold></xref> and <xref rid="sup1" ref-type="supplementary-material"><bold>B</bold></xref>). Evidently, all cell line samples benefitted from non-graph-based clustering with a defined number of expected clusters, which reproduced ground truth labels to an almost perfect accuracy. For one of the worst performing pipelines, it consisted of SCTransform normalization and Louvain (resolution = 0.5) clustering (score = 15.1, ARI = 0.685, NMI = 0.664, ASW = 0.493) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3<bold>C</bold></xref> and <xref rid="sup1" ref-type="supplementary-material"><bold>D</bold></xref>). This pipeline resulted in multiple cluster assignment for single cell lines that did not reflect the ground truth labels. Our results further demonstrate that no single pipeline combination is appropriate for all samples, showing the necessity for an integrated tool, such as IBRAP to construct pipelines and compare their performances.</p>
      </sec>
      <sec id="sec16">
        <title>Integrating samples: unsupervised analysis</title>
        <p>We next evaluated pipelines that required integration methods. We performed five multisample integration analyses, including Analysis 1: 8 pancreatic samples (total cells = 14 739; technologies = SmartSeq2, CELseq, CELse2, Fluidigmc1, InDrop), Analysis 2: 3 samples with the same cell lines (total cells = 1401; technology = CELseq2, 10x, DropSeq), Analysis 3: 3 samples that contain 3 of the same cell lines but one sample containing two extra and different cell lines (total cells = 4416; technologies = CELseq2, 10x, Dropseq), Analysis 4: SymSim simulation sample (cells = 3000) comprised three cell types and three overt batch effect simulations, and Analysis 5: SymSim simulation sample (cells = 3000) comprised three cell types and three minor batch effect simulations. A total of 102 unique pipeline combinations were assembled; once we adjusted parameters (resolution or numbers of expected clusters), 1172 sets of cluster assignments were produced per sample. We then applied our benchmarking metrics to these cell assignments, to compare performances across different pipelines (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S5</xref>).</p>
        <p>We first assessed the effect that changing normalization methods would affect the final clustering results (<xref rid="f4" ref-type="fig">Figure 4</xref>). Across all five integration analyses, the average (ARI, NMI and ASW) values for SCTransform (blue boxes), Scran (green boxes) and Scanpy (red boxes) (<xref rid="f4" ref-type="fig">Figure 4</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>) were (0.463, 0.537 and 0.501), (0.416, 0.493 and 0.438) and (0.315, 0.392 and 0.337), respectively. These results show that SCTransform normalization gained better clustering results across all analyses on average during integration tasks. We then compared the effect normalization methods had on batch effect removal, and we also calculated batch effect removal without using an integration method as a baseline comparison. SCTransform, Scran and Scanpy normalization without using batch correction achieved an ASW of 0.318, 0.308 and 0.314, respectively. We then compared the normalization methods with applying an integration method show that SCTransform, Scran and Scanpy achieved an ASW of 0.080, 0.021 and 0.046, respectively. These results suggest that Scran works best at removing most of the batch effect with and without an integration method. Interestingly, the combination of Scran normalization and BBKNN integration achieved the best batch removal on average across the five integration analyses (average ASW = –0.17, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>).</p>
        <fig position="float" id="f4">
          <label>Figure 4</label>
          <caption>
            <p>Benchmarks of multi-sample integration analyses. The analyses included Analysis 1: 8 pancreatic samples, Analysis 2: 3 samples with the same cell lines, Analysis 3: 3 samples that contain 3 of the same cell lines but one sample containing two extra and different cell lines and Analysis 4: 1 SymSim simulated sample that contains 3 simulated overt batch effects and five cell types. Benchmarking matrices, ARI, NMI and ASW, calculated based on ground truth cell labels, were shown for the combinations of normalization (Scanpy, Scran and SCTransform) and integration methods (BBKNN, Harmony, Scanorama, Seurat CCA and uncorrected), adjusting other clustering methods and parameters.</p>
          </caption>
          <graphic xlink:href="bbad061f4" position="float"/>
        </fig>
        <p>For Analysis 1, the top performing pipeline (score = 100, ARI = 0.965, NMI = 0.927, ASW = 0.636) used Scran normalization. For Analysis 2, the optimal pipeline (score = 100, ARI = 0.509, NMI = 0.506, ASW = 0.794) gained superior cell assignments using Scanpy normalization. For Analysis 3, the leading pipeline (score = 100, ARI = 0.860, NMI = 0.803, ASW = 0.788) produced greater clustering scores from using SCTransform normalization. Analysis 4 achieved the best clustering results using Scanpy (score = 100, ARI = 0.627, NMI = 0.625, ASW = 0.608). Finally, Analysis 5 gained its highest scores using SCTransform (score = 100, ARI = 0.713, NMI = 0.751, ASW = 0.742). These findings suggest that different normalization methods play an influential role in batch effect removal and must be selected carefully.</p>
        <p>Next, we investigated the influence of different integration methods (<xref rid="f4" ref-type="fig">Figure 4</xref> separated on the x-axis) on subsequently produced cell annotations in relation to the ground truth labels, and observed differing performances on cluster assignments for uncorrected (an average of ARI = 0.324, NMI = 0.431, ASW = 0.530), Harmony (an average of ARI = 0.411, NMI = 0.484, ASW = 0.424), Scanorama (an average of ARI = 0.430, NMI = 0.500, ASW = 0.477), BBKNN (an average of ARI = 0.386, NMI = 0.466, ASW = 0.406) and Seurat CCA (an average of ARI = 0.440, NMI = 0.491, ASW = 0.290). These benchmarking metrics showed that Scanorama-integrated data resulted in the best cell annotations downstream on average, followed by Harmony and Seurat CCA. We next applied ASW to assess the presence of batch effects in the combined datasets and how well integration methods removed them, with a lower ASW value indicating better performance in batch effect. The average ASW for the uncorrected, Harmony, Scanorama, BBKNN and Seurat CCA was 0.313, 0.169, 0.053, 0.025 and − 0.050, respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>). These findings suggest that Seurat CCA was the most effective method for batch effect removal on average. However, Seurat CCA did not produce the best overall pipeline for clustering performance for all analyses, suggesting that a higher batch correction does not necessarily lead to the most accurate clustering. In Analysis 1, Scran normalized counts with BBKNN integration generated the best clustering results (score = 100, ARI = 0.965, NMI = 0.927, ASW = 0.636) (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S5</xref>). Analysis 2 gained its best results using Scanpy normalized counts and Harmony integration (score = 100, ARI = 0.509, NMI = 0.506, ASW = 0.794), while Analysis 3 obtained the best clustering performance from SCTransform normalization and Scanorama integration (score = 100, ARI = 0.859, NMI = 0.803, ASW = 0.788). Analysis 4 gained the best results using Scanpy normalization with Seurat CCA (score = 100, ARI = 0.627, NMI = 0.625, ASW = 0.608). Lastly, Analysis 5 gained the best results while using SCTransform with Scanorama (score = 100, ARI = 0.713, NMI = 0.751, ASW = 0.742).</p>
        <p>Finally, we observed the performance of different clustering performances for integration analyses. On average, non-graph-based clustering (an average of ARI = 0.402, NMI = 0.450, ASW = 0.496) yielded superior clustering results compared to graph-based methods (an average of ARI = 0.397, NMI = 0.482, ASW = 0.405) across the five analyses. Indeed, this was also the case when the analyses were broken down individually (i.e. Analysis 1–5). Nonetheless, Analysis 1 gained its best results from Louvain clustering with resolution 0.2 (score = 100, ARI = 0.965, NMI = 0.927, ASW = 0.636), while Analyses 2 (score = 100, ARI = 0.509, NMI = 0.506, ASW = 0.794) and 3 (score = 100, ARI = 0.859, NMI = 0.803, ASW = 0.788) gained their best results from PAM clustering with expected clusters as 6, which matches the findings from the individual sample analysis (<xref rid="f4" ref-type="fig">Figure 4</xref>; <xref rid="sup2" ref-type="supplementary-material">Supplementary Table S5</xref>). In simulation Analyses 4 and 5, they gained their best results from non-graph-based methods k-means (score = 100, ARI = 0.627, NMI = 0.625, ASW = 0.608) and PAM (score = 100, ARI = 0.713, NMI = 0.751, ASW = 0.742), respectively. These findings are similar to individual sample analysis, where pancreas samples benefitted from graph-based clustering, and cell lines and simulation samples more with non-graph-based methodology in the multi-sample integration.</p>
        <p>We then visually inspected a good and poor pipeline performance for Analysis 1. The best clustering results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6<bold>A</bold></xref>) compared against the ground truth (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6<bold>B</bold></xref>) for pancreatic samples were Scran normalization, BBKNN integration and Louvain clustering with the resolution set at 0.2 (score = 100, ARI = 0.965, NMI = 0.927, ASW = 0.636). Major cell types were all clustered accurately, although small clusters 8, 7 and 5 contained multiple cell types, including mast and macrophage, endothelial and schwann, and quiescent and activated stellate, respectively. In contrast, the worst clustering performance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6<bold>C</bold></xref>) in comparison to ground truth labels (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6<bold>D</bold></xref>) was gained from Scanpy normalization, Seurat CCA integration and Leiden clustering with resolution 0.2 (score = 0, ARI = 0.281, NMI = 0.462, ASW = –0.287). Clusters appeared distributed across the UMAP and were overlapping each other significantly. This is represented in the ASW value of −0.287 showing that clusters are very poorly separated which has led to poor subsequent clustering. Cell types ductal, beta, gamma, acinar, endothelial, delta and quiescent stellate have mostly been assigned to cluster 0 with some of the cells being assigned to other clusters. This may be due to a substandard combination of methodologies that has led to this, which shows that caution must be taken when integrating new methodologies, even when individual methods are among the most widely used, like the case above.</p>
      </sec>
      <sec id="sec17">
        <title>Supervised versus unsupervised cell-type annotation</title>
        <p>One of the major challenges that scRNA-seq downstream analysis faces is cell annotation, i.e. how to identify each major and minor/rare cell populations accurately. The standard cell annotation involves unsupervised clustering followed by differential expression and cluster annotation using top differentially expressed genes for each cluster. Cell annotation using reference-based maps (i.e. supervised cell annotation) has, however, been shown to cluster imbalanced cellular proportions (with rare cell types) more effectively compared to unsupervised methods [<xref rid="ref6" ref-type="bibr">6</xref>]. As both unsupervised and supervised clustering functions were included in IBRAP, we wanted to investigate how the performance varies between the two in cell clustering and annotation, using the eight pancreatic samples from the individual analysis all with ground truth labels. For supervised clustering, we applied SingleR to each sample individually by using one sample from the total of eight as a query and using the remaining seven as a reference based on the ground truth labels (<xref rid="f5" ref-type="fig">Figure 5<bold>A</bold></xref>). For the unsupervised analysis, we selected the best performing pipeline results generated from the individual sample analysis (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S4</xref>). We compared the number of failed clusters between the supervised and unsupervised analyses. We defined a failed cluster with two criteria in relation to the ground truth labels. Firstly, a cell type must reasonably be the dominant cell type in a cluster. Secondly, a cell type cannot be clustered together in similar proportion to other cell types. On average, there were 1.6 and 5.9 failed clusters for the supervised and unsupervised analyses (<xref rid="f5" ref-type="fig">Figure 5<bold>A</bold></xref>), respectively. For comparison, we generated several UMAP projections: the seven samples used as a reference for the singleR analysis (<xref rid="f5" ref-type="fig">Figure 5<bold>B</bold></xref>), the labels for the supervised analysis for smartseq2 (<xref rid="f5" ref-type="fig">Figure 5<bold>C</bold></xref>), the optimal unsupervised clustering labels from the first case study (<xref rid="f5" ref-type="fig">Figure 5<bold>D</bold></xref>) and the ground truth cell-type labels for smartseq2 (<xref rid="f5" ref-type="fig">Figure 5<bold>E</bold></xref>). The supervised analysis (<xref rid="f5" ref-type="fig">Figure 5<bold>C</bold></xref>) identified all cell types except for activated stellate cells. However, during the optimal unsupervised analysis, rarer populations (quiescent and activated stellate, mast, macrophage, etc.) were merged into the same cluster (labelled mixed_minor_celltypes in <xref rid="f5" ref-type="fig">Figure 5<bold>D</bold></xref>). These results suggest that rarer populations are more readily captured in supervised analyses compared to unsupervised methods in this case study. This is because the reference map based on seven samples (consisting of 12 496 cells in total) had optimal enough resolution to differentiate rarer populations, such as quiescent versus activated stellate cells (<xref rid="f5" ref-type="fig">Figure 5<bold>B</bold></xref>). These differential expression profiles of cells provided a priori knowledge to separate cells even if the differences were subtle in a single query sample of 2395 cells in this example (Smartseq2, <xref rid="f5" ref-type="fig">Figure 5<bold>C</bold></xref>). However, these subtle differences among related, but different, cell types could not be resolved by unsupervised clustering analysis alone, especially when the cell numbers were low. It is worth noting that supervised methods are heavily constrained by the quality and the bandwidth of cell types in the supplied reference. If the reference is low in resolution, it would be very difficult to identify rare and novel populations as previously described [<xref rid="ref6" ref-type="bibr">6</xref>].</p>
        <fig position="float" id="f5">
          <label>Figure 5</label>
          <caption>
            <p>A comparison between unsupervised and supervised clustering. (<bold>A</bold>) Bar plot containing the number of cell types that were not captured well during supervised and unsupervised clustering analyses. (<bold>B</bold>) UMAP projection of the reference datasets (celseq, celseq2, fluidigmc1, indrop1, indrop2, indrop3, indrop4) integrated using BBKNN. (<bold>C</bold>–<bold>E</bold>) UMAP projections of the pancreatic samples sequenced using SmartSeq2. (<bold>C</bold>) Cell labels derived from singleR supervised analysis using a reference dataset in panel B. (<bold>D</bold>) smartseq2 cells labelled with cluster assignments that generated the highest score during the unsupervised clustering. (<bold>E</bold>) Ground truth labels for comparison to the supervised and unsupervised labelling. (<bold>F</bold>) scType annotation for the optimal clustering for the reference integrated map of seven pancreas samples shown in panel B. (<bold>G</bold>) scType annotation for the optimal clustering for the smartseq2 sample shown in panels (<bold>C</bold>–<bold>E</bold>).</p>
          </caption>
          <graphic xlink:href="bbad061f5" position="float"/>
        </fig>
        <p>We next demonstrated the usability of scType [<xref rid="ref27" ref-type="bibr">27</xref>], a novel algorithm to annotate cell clusters / types derived from the unsupervised clustering based on a comprehensive cell marker database as background information, using the integrated map of seven pancreatic samples and one individual sample (Smartseq2) above as an example. scType performed well in identifying all major cell types, but did not accurately label minor cell (sub)types, such as endothelial, mast, epsilon and schwann cells (<xref rid="f5" ref-type="fig">Figure 5<bold>F</bold></xref> and <bold>G</bold>). It should be noted that scType is reliant on the unsupervised clustering and therefore if the quality or resolution of such clustering is low with mixed cell-type clusters, it is likely to deliver inaccurate labelling of many minor cell types labelled together. Nevertheless, scType provides a promising method for labelling cell clusters when lacking a high-quality count-based reference that singleR relies on, and marker-based cell annotation methods such as scType are useful to facilitate and validate manual annotation of cell clusters using established marker genes.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec18">
    <title>Discussion</title>
    <p>Single-cell studies are becoming more popular in the understanding of cellular heterogeneity and interaction in health and disease. Subsequently, a large body of dry-lab analytical methods are becoming available for bioinformaticians to use. Our results demonstrate that different pipelines yielded varying efficacy according to the combination of tools used throughout the pipeline and the input data, which supports previous findings [<xref rid="ref2" ref-type="bibr">2</xref>, <xref rid="ref4" ref-type="bibr">4–11</xref>]. Therefore, we demonstrated the requirement for a tool that facilitates different interchangeable combinations of methods to enhance sensitivity and specificity of data outcomes.</p>
    <p>IBRAP is a wrapper package that is fit for this purpose and an attractive alternative for bioinformaticians to implement and expand their pipeline possibilities beyond the constraints of current analytical packages for scRNA-seq. To aid users, we have included benchmarking metrics that helps guide users to ascertain the effectiveness of different pipelines. Thus, IBRAP can enhance scRNA-seq pipelines and encourage bioinformaticians to explore other pipeline combinations and generate more accurate results, which may not be possible using single package tools/pipelines. IBRAP allows for cell filtration, normalization, QC, dimensionality reduction, integration, clustering, differential expression analysis, cell annotation, trajectory inference and cell–cell communication analysis. Although IBRAP is limited by the requirement to maintain the package alongside dependency updates, this is somewhat overcome by IBRAP being available as a docker image to use in singularity.</p>
    <p>In our case studies, we benchmarked pipelines that were generated for individual sample and integration-based analyses based on 25 samples from different biological conditions and technical platforms, and can provide some guidance for future studies. During the normalization stage, we found that on average SCTransform and Scran led to the best clustering results when analysing samples individually and integrating them, respectively. In terms of integration, we discovered that Scanorama, followed by Harmony and Seurat CCA, led to the most accurate cell-type label annotations on average, but Seurat CCA eliminated the most batch effects on average. Here, we identified that higher batch effect removal did not correlate with a higher clustering accuracy, which could indicate that some integration methods over-correct the data which leads to reduced clustering effectiveness [<xref rid="ref9" ref-type="bibr">9</xref>]. Finally, we identified a trend in clustering algorithms, where pancreas samples benefitted from graph-based methods and cell lines gained their best results from non-graph-based methods across all samples. For example, SCTransform normalization and Louvain clustering performed well for most pancreas samples, while SCTransform and PAM clustering performed well for most cell line samples.</p>
    <p>We also demonstrated in our case study that unsupervised clustering methods innately clustered rarer and transcriptional related cell populations together or into larger cell populations, especially when their cell numbers were very low. In contrast, fully supervised (reference-based) methods such as singleR are more capable of identifying these minor populations together with other cellular compositions even with low cell numbers. Our results further highlighted the advantages of reference-based cell annotation; however, such analysis heavily relies on the resolution and bandwidth of cell types annotated within the reference. Since there has been a huge body of scRNA-seq data sets available from a wide range of health and disease settings, exemplified by Single Cell Portal (<ext-link xlink:href="https://singlecell.broadinstitute.org/single_cell" ext-link-type="uri">https://singlecell.broadinstitute.org/single_cell</ext-link>) and the human cell atlas [<xref rid="ref33" ref-type="bibr">33</xref>], such rich resources have made it possible to construct accurate and high-resolution references across many biomedical settings, and this has become the priority of current scRNA-seq research, as shown by recent efforts with celltypist [<xref rid="ref34" ref-type="bibr">34</xref>], HuBMAP [<xref rid="ref35" ref-type="bibr">35</xref>] and CAP, a Human Cell Atlas led reference map initiative [<xref rid="ref36" ref-type="bibr">36</xref>]. However, high-quality reference maps are still lacking in many settings, and more work is needed with valid underlying research questions.</p>
    <p>It is worth noting that when assembling a range of data sets to build a reference or comparable counterparts, unsupervised analysis and manual cell annotation have to be conducted first; thus, it is important to use homogenized pipelines to analyse all the data sets together. IBRAP’s components, specifically pipeline benchmarking and integration methods, were carefully selected to be scalable to reference and Atlas-sized projects, followed by supervised clustering to analyse new samples also formed as part of IBRAP. Therefore, IBRAP presents the community with an attractive, valid and easy-to-use analytic platform, not only for single sample analysis, but also for multisample and cross study integration.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec28a">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>IBRAP contains a range of analytical components that can be interchanged throughout the pipeline alongside multiple benchmarking metrics that enables users to compare results and determine the optimal pipeline combinations for their data.</p>
          </list-item>
          <list-item>
            <p>The optimal pipelines are dependent on individual samples and studies, further supporting the rationale and necessity of IBRAP.</p>
          </list-item>
          <list-item>
            <p>IBRAP presents the community with an attractive, valid and easy-to-use analytic platform, not only for single sample analysis, but also for multi-sample and cross study integration.</p>
          </list-item>
          <list-item>
            <p>IBRAP offers the option of reference-based cell annotation to increase the accuracy of identifying rarer populations.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>Supplementary_figures_revision_bbad061</label>
      <media xlink:href="supplementary_figures_revision_bbad061.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup2" position="float" content-type="local-data">
      <label>Supplementary_Tables_1-5_revision_bbad061</label>
      <media xlink:href="supplementary_tables_1-5_revision_bbad061.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="data-availability" id="sec23">
    <title>Data availability</title>
    <p>The 8 pancreatic samples used in <xref rid="f2" ref-type="fig">Figure 2</xref>,3, and 5, can be downloaded in R following the instructions in the SeuratData package (<ext-link xlink:href="https://github.com/satijalab/seurat-data" ext-link-type="uri">https://github.com/satijalab/seurat-data</ext-link>) downloading the panc8.SeuratData dataset. The 7 cell line datasets can be downloaded from <ext-link xlink:href="https://github.com/LuyiTian/sc_mixology" ext-link-type="uri">https://github.com/LuyiTian/sc_mixology</ext-link>. The Splatter and SymSim datasets can be simulated using the following scripts downloaded from <ext-link xlink:href="https://github.com/connorhknight/IBRAP_codes/blob/main/gathering_data.R" ext-link-type="uri">https://github.com/connorhknight/IBRAP_codes/blob/main/gathering_data.R</ext-link>.</p>
  </sec>
  <sec id="sec24">
    <title>Funding</title>
    <p>Accelerator Award Program [Cancer Research UK (C355/A26819) and Fundación Científica de la Asociación Española Contra el Cáncer and Fondazione AIRC per la Ricerca sul Cancro]; Cancer Research UK Centre of Excellence Award to Barts Cancer Centre (C16420/A18066). The Medical Research Foundation (MRF-044-0004-F-GILL-C0823 to U.S.G.); Cancer Research UK (C57432/A22742 to J.O.); Academy of Medical Sciences Springboard Award (SBF003\1025 to J.W.).</p>
  </sec>
  <sec id="sec25">
    <title>Authors’ contributions</title>
    <p>C.K. built the tool, co-designed, wrote the tutorials, gathered the data and analysed it. J.W. conceived and supervised the project. C.K. and J.W. wrote the manuscript. F.K. co-designed, tested the tools and co-wrote the tutorial. A.P. contributed to the scType implementation and the test of IBRAP. U.G. contributed to the test of the software. J.O. co-supervised the project and contributed to the revision. All authors critically reviewed the manuscript.</p>
  </sec>
  <sec id="sec26">
    <title>Code availability</title>
    <p>IBRAPs code is publicly available and can be found on GitHub alongside any appropriate tutorials - <ext-link xlink:href="https://github.com/connorhknight/IBRAP" ext-link-type="uri">https://github.com/connorhknight/IBRAP</ext-link>. The codes used to generate these data and figures is available at: <ext-link xlink:href="https://github.com/connorhknight/IBRAP_codes" ext-link-type="uri">https://github.com/connorhknight/IBRAP_codes</ext-link>.</p>
  </sec>
  <notes id="bio3">
    <title>Author Biographies</title>
    <p><bold>Connor H. Knight</bold> is a PhD student in bioinformatics at the Centre for Cancer Genomics and Computational Biology, Barts Cancer Institute, Queen Mary University of London.</p>
    <sec sec-type="author-bio" id="sec25a">
      <p><bold>Faraz Khan</bold> is a postdoctoral bioinformatician at the Centre for Cancer Genomics and Computational Biology, Barts Cancer Institute, Queen Mary University of London.</p>
    </sec>
    <sec sec-type="author-bio" id="sec26a">
      <p><bold>Ankit Patel</bold> is postdoctoral bioinformatician at the Centre for Cancer Genomics and Computational Biology, Barts Cancer Institute, Queen Mary University of London.</p>
    </sec>
    <sec sec-type="author-bio" id="sec27a">
      <p><bold>Upkar S. Gill</bold> is a clinical lecturer and honorary consultant hepatologist at the Centre for Immunobiology at Barts &amp; The School of Medicine &amp; Dentistry, Queen Mary University of London.</p>
    </sec>
    <sec sec-type="author-bio" id="sec28u">
      <p><bold>Jessica Okosun</bold> is a clinical senior lecturer and principal investigator at the Centre for Haemato-Oncology, Barts Cancer Institute, Queen Mary University of London.</p>
    </sec>
    <sec sec-type="author-bio" id="sec29a">
      <p><bold>Jun Wang</bold> is a senior lecturer in bioinformatics and principal investigator at the Centre for Cancer Genomics and Computational Biology, Barts Cancer Institute, Queen Mary University of London.</p>
    </sec>
  </notes>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ziegenhain</surname><given-names>C</given-names></string-name>, <string-name><surname>Vieth</surname><given-names>B</given-names></string-name>, <string-name><surname>Parekh</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Comparative analysis of single-cell RNA sequencing methods</article-title>. <source>Mol Cell</source><year>2017</year>;<volume>65</volume>:<fpage>631</fpage>–<lpage>643.e4</lpage>.<pub-id pub-id-type="pmid">28212749</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vieth</surname><given-names>B</given-names></string-name>, <string-name><surname>Parekh</surname><given-names>S</given-names></string-name>, <string-name><surname>Ziegenhain</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A systematic evaluation of single cell RNA-seq analysis pipelines</article-title>. <source>Nat Commun</source><year>2019</year>;<volume>10</volume>:<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">30602773</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zappia</surname><given-names>L</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ</given-names></string-name></person-group>. <article-title>Over 1000 tools reveal trends in the single-cell RNA-seq analysis landscape</article-title>. <source>Genome Biol</source><year>2021</year>;<volume>22</volume>:<fpage>301</fpage>.<pub-id pub-id-type="pmid">34715899</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luecken</surname><given-names>MD</given-names></string-name>, <string-name><surname>Büttner</surname><given-names>M</given-names></string-name>, <string-name><surname>Chaichoompu</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Benchmarking atlas-level data integration in single-cell genomics</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>41</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">34949812</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Su</surname><given-names>S</given-names></string-name>, <string-name><surname>Tian</surname><given-names>L</given-names></string-name>, <string-name><surname>Dong</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>CellBench: R/Bioconductor software for comparing single-cell RNA-seq analysis methods</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>2288</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">31778143</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>X</given-names></string-name>, <string-name><surname>Lin</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A comprehensive comparison of supervised and unsupervised methods for cell type identification in single-cell RNA-seq</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbab567</fpage>.<pub-id pub-id-type="pmid">35021202</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname><given-names>L</given-names></string-name>, <string-name><surname>Dong</surname><given-names>X</given-names></string-name>, <string-name><surname>Freytag</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Benchmarking single cell RNA-sequencing analysis pipelines using mixture control experiments</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>479</fpage>–<lpage>87</lpage>.<pub-id pub-id-type="pmid">31133762</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Germain</surname><given-names>PL</given-names></string-name>, <string-name><surname>Sonrel</surname><given-names>A</given-names></string-name>, <string-name><surname>Robinson</surname><given-names>MD</given-names></string-name></person-group>. <article-title>PipeComp, a general framework for the evaluation of computational pipelines, reveals performant single cell RNA-seq preprocessing tools</article-title>. <source>Genome Biol</source><year>2020</year>;<volume>21</volume>:<fpage>1</fpage>–<lpage>28</lpage>.</mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Tyler</surname><given-names>SR</given-names></string-name>, <string-name><surname>Bunyavanich</surname><given-names>S</given-names></string-name>, <string-name><surname>Schadt</surname><given-names>EE</given-names></string-name></person-group>. <article-title>PMD uncovers widespread cell-state erasure by scRNAseq batch correction methods</article-title>. <comment>bioRxiv</comment>. <year>2021</year>; <comment>2021.11.15.468733</comment>.</mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tran</surname><given-names>HTN</given-names></string-name>, <string-name><surname>Ang</surname><given-names>KS</given-names></string-name>, <string-name><surname>Chevrier</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A benchmark of batch-effect correction methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol</source><year>2020</year>;<volume>21</volume>:<fpage>12</fpage>.<pub-id pub-id-type="pmid">31948481</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tsuyuzaki</surname><given-names>K</given-names></string-name>, <string-name><surname>Sato</surname><given-names>H</given-names></string-name>, <string-name><surname>Sato</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Benchmarking principal component analysis for large-scale single-cell RNA-sequencing</article-title>. <source>Genome Biol</source><year>2020</year>;<volume>21</volume>:<fpage>9</fpage>.<pub-id pub-id-type="pmid">31955711</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Hao</surname><given-names>S</given-names></string-name>, <string-name><surname>Andersen-Nissen</surname><given-names>E</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source><year>2021</year>;<volume>184</volume>:<fpage>3573</fpage>–<lpage>3587.e29</lpage>.<pub-id pub-id-type="pmid">34062119</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ</given-names></string-name></person-group>. <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Gould</surname><given-names>J</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Cumulus provides cloud-based data analysis for large-scale single-cell and single-nucleus RNA-seq</article-title>. <source>Nat Methods</source><year>2020</year>;<volume>17</volume>:<fpage>793</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">32719530</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gardeux</surname><given-names>V</given-names></string-name>, <string-name><surname>David</surname><given-names>FPA</given-names></string-name>, <string-name><surname>Shajkofci</surname><given-names>A</given-names></string-name>, <etal>et al.</etal></person-group><article-title>ASAP: a web-based platform for the analysis and interactive visualization of single-cell RNA-seq data</article-title>. <source>Bioinformatics</source><year>2017</year>;<volume>33</volume>:<fpage>3123</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">28541377</pub-id></mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zappia</surname><given-names>L</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B</given-names></string-name>, <string-name><surname>Oshlack</surname><given-names>A</given-names></string-name></person-group>. <article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>. <source>Genome Biol</source><year>2017</year>;<volume>18</volume>:<fpage>174</fpage>.<pub-id pub-id-type="pmid">28899397</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X</given-names></string-name>, <string-name><surname>Xu</surname><given-names>C</given-names></string-name>, <string-name><surname>Yosef</surname><given-names>N</given-names></string-name></person-group>. <article-title>Simulating multiple faceted variability in single cell RNA sequencing</article-title>. <source>Nat Commun</source><year>2019</year>;<volume>10</volume>:<fpage>2611</fpage>.<pub-id pub-id-type="pmid">31197158</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lun</surname><given-names>ATL</given-names></string-name>, <string-name><surname>Bach</surname><given-names>K</given-names></string-name>, <string-name><surname>Marioni</surname><given-names>JC</given-names></string-name></person-group>. <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">26753840</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="other">Blighe K, Lun A. (2022). PCAtools: PCAtools: Everything Principal Components Analysis. <source>R package version 2.10.0</source>, <ext-link xlink:href="https://github.com/kevinblighe/PCAtools" ext-link-type="uri">https://github.com/kevinblighe/PCAtools</ext-link>.</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Haghverdi</surname><given-names>L</given-names></string-name>, <string-name><surname>Büttner</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Destiny: diffusion maps for large-scale single-cell data in R</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>32</volume>:<fpage>1243</fpage>.</mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thrun</surname><given-names>MC</given-names></string-name>, <string-name><surname>Ultsch</surname><given-names>A</given-names></string-name></person-group>. <article-title>Using projection-based clustering to find distance- and density-based clusters in high-dimensional data</article-title>. <source>J Classif</source><year>2021</year>;<volume>38</volume>:<fpage>280</fpage>–<lpage>312</lpage>.</mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Polański</surname><given-names>K</given-names></string-name>, <string-name><surname>Young</surname><given-names>MD</given-names></string-name>, <string-name><surname>Miao</surname><given-names>Z</given-names></string-name>, <etal>et al.</etal></person-group><article-title>BBKNN: fast batch alignment of single cell transcriptomes</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>964</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">31400197</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korsunsky</surname><given-names>I</given-names></string-name>, <string-name><surname>Millard</surname><given-names>N</given-names></string-name>, <string-name><surname>Fan</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Fast, sensitive and accurate integration of single-cell data with Harmony</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>1289</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">31740819</pub-id></mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hie</surname><given-names>B</given-names></string-name>, <string-name><surname>Bryson</surname><given-names>B</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B</given-names></string-name></person-group>. <article-title>Efficient integration of heterogeneous single-cell transcriptomes using Scanorama</article-title>. <source>Nat Biotechnol</source><year>2019</year>;<volume>37</volume>:<fpage>685</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">31061482</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Street</surname><given-names>K</given-names></string-name>, <string-name><surname>Risso</surname><given-names>D</given-names></string-name>, <string-name><surname>Fletcher</surname><given-names>RB</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics</article-title>. <source>BMC Genom</source><year>2018</year>;<volume>19</volume>:<fpage>477</fpage>.</mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Armingol</surname><given-names>E</given-names></string-name>, <string-name><surname>Officer</surname><given-names>A</given-names></string-name>, <string-name><surname>Harismendy</surname><given-names>O</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Deciphering cell–cell interactions and communication from gene expression</article-title>. <source>Nat Rev Genet</source><year>2021</year>;<volume>22</volume>:<fpage>71</fpage>–<lpage>88</lpage>.<pub-id pub-id-type="pmid">33168968</pub-id></mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ianevski</surname><given-names>A</given-names></string-name>, <string-name><surname>Giri</surname><given-names>AK</given-names></string-name>, <string-name><surname>Aittokallio</surname><given-names>T</given-names></string-name></person-group>. <article-title>Fully-automated and ultra-fast cell-type identification using specific marker combinations from single-cell transcriptomic data</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1246</fpage>.<pub-id pub-id-type="pmid">35273156</pub-id></mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D</given-names></string-name>, <string-name><surname>Looney</surname><given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source><year>2019</year>;<volume>20</volume>:<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>YJ</given-names></string-name>, <string-name><surname>Schug</surname><given-names>J</given-names></string-name>, <string-name><surname>Won</surname><given-names>K-J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell transcriptomics of the human endocrine pancreas</article-title>. <source>Diabetes</source><year>2016</year>;<volume>65</volume>:<fpage>3028</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">27364731</pub-id></mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muraro</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Dharmadhikari</surname><given-names>G</given-names></string-name>, <string-name><surname>Grün</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell transcriptome atlas of the human pancreas</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>3</volume>:<fpage>385</fpage>–<lpage>394.e3</lpage>.<pub-id pub-id-type="pmid">27693023</pub-id></mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Segerstolpe</surname><given-names>Å</given-names></string-name>, <string-name><surname>Palasantza</surname><given-names>A</given-names></string-name>, <string-name><surname>Eliasson</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>. <source>Cell Metab</source><year>2016</year>;<volume>24</volume>:<fpage>593</fpage>–<lpage>607</lpage>.<pub-id pub-id-type="pmid">27667667</pub-id></mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname><given-names>M</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>SL</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>3</volume>:<fpage>346</fpage>–<lpage>360.e4</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="ref33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hon</surname><given-names>CC</given-names></string-name>, <string-name><surname>Shin</surname><given-names>JW</given-names></string-name>, <string-name><surname>Carninci</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The human cell atlas: technical approaches and challenges</article-title>. <source>Brief Funct Genom</source><year>2018</year>;<volume>17</volume>:<fpage>283</fpage>–<lpage>94</lpage>.</mixed-citation>
    </ref>
    <ref id="ref34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Conde</surname><given-names>CD</given-names></string-name>, <string-name><surname>Xu</surname><given-names>C</given-names></string-name>, <string-name><surname>Jarvis</surname><given-names>LB</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Cross-tissue immune cell analysis reveals tissue-specific features in humans</article-title>. <source>Science (1979)</source><year>2022</year>;<volume>376</volume>:<fpage>eabl5197</fpage>.</mixed-citation>
    </ref>
    <ref id="ref35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Snyder</surname><given-names>MP</given-names></string-name>, <string-name><surname>Lin</surname><given-names>S</given-names></string-name>, <string-name><surname>Posgai</surname><given-names>A</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The human body at cellular resolution: the NIH Human Biomolecular Atlas Program</article-title>. <source>Nature</source><year>2019</year>;<volume>574</volume>:<fpage>187</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">31597973</pub-id></mixed-citation>
    </ref>
    <ref id="ref36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Regev</surname><given-names>A</given-names></string-name>, <string-name><surname>Teichmann</surname><given-names>SA</given-names></string-name>, <string-name><surname>Lander</surname><given-names>ES</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The Human Cell Atlas</article-title>. <source>Elife</source><year>2017</year>;<volume>6</volume>:<fpage>e27041</fpage>.<pub-id pub-id-type="pmid">29206104</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
