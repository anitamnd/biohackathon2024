<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3694664</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btt209</article-id>
    <article-id pub-id-type="publisher-id">btt209</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2013 Proceedings Papers Committee July 21 to July 23, 2013, Berlin, Germany</subject>
        <subj-group>
          <subject>Original Papers</subject>
          <subj-group>
            <subject>Protein Structure and Function</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ThreaDom: extracting protein domain boundary information from multiple threading alignments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Xue</surname>
          <given-names>Zhidong</given-names>
        </name>
        <xref ref-type="aff" rid="btt209-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btt209-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Dong</given-names>
        </name>
        <xref ref-type="aff" rid="btt209-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Yan</given-names>
        </name>
        <xref ref-type="aff" rid="btt209-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btt209-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Yang</given-names>
        </name>
        <xref ref-type="aff" rid="btt209-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btt209-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="btt209-AFF1"><sup>1</sup>Department of Computational Medicine and Bioinformatics, University of Michigan, Ann Arbor, MI 48109, USA, <sup>2</sup>School of Software Engineering, Huazhong University of Science and Technology, Wuhan, Hubei 430074, China and <sup>3</sup>School of Life Science and Technology, Huazhong University of Science and Technology, Wuhan, Hubei 430074, China</aff>
    <author-notes>
      <corresp id="btt209-COR1">*To whom correspondence should be addressed.</corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>7</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>6</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>6</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>29</volume>
    <issue>13</issue>
    <fpage>i247</fpage>
    <lpage>i256</lpage>
    <permissions>
      <copyright-statement>© The Author 2013. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Protein domains are subunits that can fold and evolve independently. Identification of domain boundary locations is often the first step in protein folding and function annotations. Most of the current methods deduce domain boundaries by sequence-based analysis, which has low accuracy. There is no efficient method for predicting discontinuous domains that consist of segments from separated sequence regions. As template-based methods are most efficient for protein 3D structure modeling, combining multiple threading alignment information should increase the accuracy and reliability of computational domain predictions.</p>
      <p><bold>Result:</bold> We developed a new protein domain predictor, ThreaDom, which deduces domain boundary locations based on multiple threading alignments. The core of the method development is the derivation of a domain conservation score that combines information from template domain structures and terminal and internal alignment gaps. Tested on 630 non-redundant sequences, without using homologous templates, ThreaDom generates correct single- and multi-domain classifications in 81% of cases, where 78% have the domain linker assigned within ±20 residues. In a second test on 486 proteins with discontinuous domains, ThreaDom achieves an average precision 84% and recall 65% in domain boundary prediction. Finally, ThreaDom was examined on 56 targets from CASP8 and had a domain overlap rate 73, 87 and 85% with the target for Free Modeling, Hard multiple-domain and discontinuous domain proteins, respectively, which are significantly higher than most domain predictors in the CASP8. Similar results were achieved on the targets from the most recently CASP9 and CASP10 experiments.</p>
      <p><bold>Availability:</bold><ext-link ext-link-type="uri" xlink:href="http://zhanglab.ccmb.med.umich.edu/ThreaDom/">http://zhanglab.ccmb.med.umich.edu/ThreaDom/</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>zhng@umich.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Protein molecules are composed of domains that fold, function and evolve autonomously. The definition of protein domains is, however, not absolute. Recent studies have shown that protein domains within the same family or superfamily can vary significantly in both structure and function (<xref ref-type="bibr" rid="btt209-B3">Dessailly <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="btt209-B18">Reeves <italic>et al.</italic>, 2006</xref>). Nevertheless, correct assignment of boundaries of the protein domains is essential for the efficient elucidations of protein function and evolutionary mechanisms.</p>
    <p>The most accurate characterization of protein domains is through the analysis of the 3D structures. However, the experimental determination of protein structures is often time and manpower expensive and some proteins are even impossible to solve currently. The computational domain prediction from the amino acid sequence is, therefore, highly demanded. A variety of methods have been recently developed in this regard that can be roughly categorized into three groups: statistical and machine-learning based, homology-based and 3D model-based methods.</p>
    <p>The statistical and machine-learning-based methods are probably the most frequently used approaches to protein domain predictions, with examples including DGS (<xref ref-type="bibr" rid="btt209-B27">Wheelan <italic>et al.</italic>, 2000</xref>), DomCut (<xref ref-type="bibr" rid="btt209-B22">Suyama and Ohara, 2003</xref>), Armadillo (<xref ref-type="bibr" rid="btt209-B4">Dumontier <italic>et al.</italic>, 2005</xref>), PPRODO (<xref ref-type="bibr" rid="btt209-B21">Sim <italic>et al.</italic>, 2005</xref>), DOMPro (<xref ref-type="bibr" rid="btt209-B2">Cheng <italic>et al.</italic>, 2006</xref>), DomNet (<xref ref-type="bibr" rid="btt209-B34">Yoo <italic>et al.</italic>, 2008</xref>), DROP (<xref ref-type="bibr" rid="btt209-B5">Ebina <italic>et al.</italic>, 2011</xref>), DOBO (<xref ref-type="bibr" rid="btt209-B6">Eickholt <italic>et al.</italic>, 2011</xref>), PRODOM (<xref ref-type="bibr" rid="btt209-B20">Servant <italic>et al.</italic>, 2002</xref>), ADDA (<xref ref-type="bibr" rid="btt209-B11">Heger <italic>et al.</italic>, 2005</xref>) and EVEREST (<xref ref-type="bibr" rid="btt209-B17">Portugaly <italic>et al.</italic>, 2006</xref>). In the DGS, DomCut and Armadillo programs, the statistical regularities seen in the Protein Data Bank (PDB) structures, including domain size distribution and residue propensities, are used to deduce the domain linker and boundary predictions. In PRODOM, ADDA and EVEREST, the domain boundaries are derived by large-scale sequence comparisons followed by clustering analyses. In the rest examples (PPRODO, DOMPro, DomNet, DROP and DOBO), the residue-based statistical features, together with the position-specific scoring matrix from PSI-BLAST search, are trained by machine-learning techniques, including neural network, support vector machine and random forest classifiers. These methods deduce boundary information from sequence only, which can in principle be applied to any proteins. But the overall accuracy is low compared with the homology-based approaches.</p>
    <p>In the homology-based methods, e.g. Pfam (<xref ref-type="bibr" rid="btt209-B8">Finn <italic>et al.</italic>, 2010</xref>), CHOP (<xref ref-type="bibr" rid="btt209-B14">Liu and Rost, 2004</xref>) and FIEFDOM (<xref ref-type="bibr" rid="btt209-B1">Bondugula <italic>et al.</italic>, 2009</xref>), target sequences are searched through known protein structure or family libraries by hidden Markov model (HMM) or PSI-BLAST programs. The domain boundary information is then obtained by mapping the domain information from the homologous templates or families following the sequence alignments. The homology-based methods can have a high accuracy of predictions when close templates are identified, but the accuracy decreases sharply when the sequence identity of target and template is low (e.g. &lt;30%).</p>
    <p>In the 3D model-based methods, e.g. SnapDRAGON (<xref ref-type="bibr" rid="btt209-B9">George and Heringa, 2002</xref>), RosettaDom (<xref ref-type="bibr" rid="btt209-B13">Kim <italic>et al.</italic>, 2005</xref>) and OPUS-DOM (<xref ref-type="bibr" rid="btt209-B31">Wu <italic>et al.</italic>, 2009</xref>), the authors first construct tertiary structure models of the target by either <italic>ab initio</italic> folding or knowledge-based coarse-grained modeling simulations. Domain parser tools are then used to assign the domain information on the predicted 3D models. The accuracy of domain assignments relies on the quality of the tertiary models, which usually decreases with the size of the target proteins because of the limited ability of <italic>ab initio</italic> folding simulations (<xref ref-type="bibr" rid="btt209-B36">Zhang, 2008</xref>).</p>
    <p>Having in mind the improved power of the template-based protein structure predictions and the increasing size of PDB, we propose a new algorithm ThreaDom based on multiple threading algorithms, which aims to significantly improve the reliability of domain predictions in the category of distantly homologous protein targets. Although the threading-based algorithms have been successfully used in the CASP experiments for modeling multiple-domain protein structures where the domain boundaries are usually decided by human-intervened views and interpretations of multiple-threading alignment profiles (<xref ref-type="bibr" rid="btt209-B35">Zhang, 2007</xref>, <xref ref-type="bibr" rid="btt209-B37">2009</xref>), this is the first time to integrate the multiple threading algorithms into an automated pipeline for domain boundary determinations. The key to the algorithm is the development of a sensitive domain boundary profile that can calibrate composite structural and sequence alignment information from the multiple threading templates for precise domain assignment. The method will be systematically benchmarked on large-scale proteins, to examine the weaknesses and strengths in comparison with other widely used domain prediction approaches.</p>
  </sec>
  <sec id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 Data sets</title>
      <p>We collect a non-redundant protein set from PISCES (<xref ref-type="bibr" rid="btt209-B26">Wang and Dunbrack, 2003</xref>), with the sequence identity cut-off at 25%, resolution &lt;3.0 Å and R-factor &lt;1.0. The domain definitions of these proteins are taken from CATH 3.4 (<xref ref-type="bibr" rid="btt209-B16">Orengo <italic>et al.</italic>, 1997</xref>). If the template protein does not exist in the CATH, the domain structure is defined by DomainParser (<xref ref-type="bibr" rid="btt209-B33">Xu <italic>et al.</italic>, 2000</xref>).</p>
      <p>All proteins with a chain length &lt;80 residues or domain length &lt;40 residues are removed, which results in a protein set containing 715 multi-domain and 2524 single-domain chains. The 715 multi-domain proteins are divided into training and testing sets, including 400 and 315 chains, respectively. The 2524 single-domain chains are randomly divided into two sets, paired with multi-domain proteins in the training and testing sets.</p>
      <p>Based on the significance of threading alignments, the protein chains are categorized into ‘Easy’, ‘Medium’ and ‘Hard’ proteins (see later in the text). Thus, our training set includes 331 × 2 ‘Easy’, 46 × 2 ‘Medium’ and 23 × 2 ‘Hard’ protein sequences, and the testing set contains 261 × 2 ‘Easy’, 36 × 2 ‘Medium’ and 18 × 2 ‘Hard’ non-redundant sequences, where ‘×2’ refers to two sets of single and multiple-domain proteins.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Multiple template identification by LOMETS</title>
      <p>In ThreaDom, LOMETS (<xref ref-type="bibr" rid="btt209-B30">Wu and Zhang, 2007</xref>) will be used to thread the target sequences through the PDB for structural template identifications. LOMETS contains eight threading programs of complementary approaches, including HHSEARCH (<xref ref-type="bibr" rid="btt209-B19">Söding, 2005</xref>), MUSTER (<xref ref-type="bibr" rid="btt209-B29">Wu and Zhang, 2008</xref>), PROSPECT2 (<xref ref-type="bibr" rid="btt209-B32">Xu and Xu, 2000</xref>), PPA-I (<xref ref-type="bibr" rid="btt209-B28">Wu <italic>et al.</italic>, 2007</xref>), SAM-T02 (<xref ref-type="bibr" rid="btt209-B12">Karplus <italic>et al.</italic>, 1998</xref>), SPARKS2 and SP3 (<xref ref-type="bibr" rid="btt209-B38">Zhou and Zhou, 2005</xref>). In HHSEARCH, we implemented two versions of global and local HMMs, HHSEARCH-1 and HHSEARCH-2. These eight threading programs are displayed in <xref ref-type="fig" rid="btt209-F1">Figure 1</xref> as the LOMETS-based threading server layer.
<fig id="btt209-F1" position="float"><label>Fig. 1.</label><caption><p>Architecture of ThreaDom. It consists of a library layer, a meta-server threading layer and a domain decision layer from the bottom. Eight threading programs in the meta-server layer access three structure libraries in the library layer to provide alignments for the domain decision layer. Threading Library Map-Adapter calls libraries in the library layer and provides a unified order map. In the decision layer, data flow from A to F</p></caption><graphic xlink:href="btt209f1p"/></fig></p>
      <p>Three independent template libraries are used. First, MUSTER, PPI-1, SAM-T02 and PROSPECT2 use an internal I-TASSER template library with sequence identity &lt;70% from <ext-link ext-link-type="uri" xlink:href="http://zhanglab.ccmb.med.umich.edu/library/">http://zhanglab.ccmb.med.umich.edu/library/</ext-link>; SPARKS2 and SP3 use another internal library of sequence identity &lt;40%; HHSEARCH uses the library downloaded from <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.tuebingen.mpg.de/pub/protevo/HHsearch/databases">ftp://ftp.tuebingen.mpg.de/pub/protevo/HHsearch/databases</ext-link>, which has also a 70% sequence identity cut-off. The domain boundaries for all templates are pre-calculated based on CATH3.4 or DomainParser. As residues in the template structures were re-ordered in threading libraries, a map-adapter is established to map all the template libraries into the original entries in the PDB library so that CATH domain definitions can be exploited.</p>
      <p>For each LOMETS program, a <italic>Z</italic>-score cut-off (<italic>Z</italic><sub>0</sub>) is assigned, based on the threading results data of 1190 independent training proteins, so that the well-defined alignments with an average TM-score &gt;0.6 can be achieved when <italic>Z</italic>-score &gt; <italic>Z<sub>0</sub></italic>. Here, <italic>Z</italic>-score is a measure of the significance of the target-template alignment, defined as the score difference to the mean in the unit of standard deviation. A protein target is categorized as ‘Easy’ if each of the LOMETS threading programs have at least one template with <italic>Z</italic>-score &gt; <italic>Z<sub>0</sub></italic>; it is a ‘Hard’ target if there is no template hit with <italic>Z</italic>-score &gt; <italic>Z<sub>0</sub></italic> by any programs. Otherwise, it is assigned as a ‘Medium’ target.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Outline of ThreaDom procedure</title>
      <p>Domain predictions in ThreaDom are based on two assumptions: (i) homologous proteins have similar domain structures; (ii) residues in the core regions of domain structures are evolutionally more conserved than that in the boundary (or linker) regions between domains. Following the assumptions, the ThreaDom procedure contains three steps as displayed in <xref ref-type="fig" rid="btt209-F1">Figure 1</xref>.
<list list-type="roman-lower"><list-item><p>Target sequences are threaded through the PDB by eight LOMETS programs, and a multiple sequence alignment is constructed based on the target sequence (with external inserts/gaps shaved).</p></list-item><list-item><p>A domain conservation score (DCS) is calculated for each residue position based on the LOMETS multiple sequence alignments, which counts for the balance of conservation and gap penalty scores.</p></list-item><list-item><p>Domain boundaries are assigned based on the DCS profile using a target-specific scoring cut-off.</p></list-item></list>
</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Domain conservation score</title>
      <p>In ThreaDom, the domains of the target sequence are specified by the location and size of linker regions between two domains (e.g. A and B):
<disp-formula id="btt209-M1"><label>(1)</label><graphic xlink:href="btt209m1"/></disp-formula>
where <italic>i</italic> is the residue number, <italic>start</italic><sup>(</sup><italic><sup>L</sup></italic><sup>)</sup> is the residue position of the last residue in domain A along the sequence, <italic>end</italic>
<sup>(</sup><italic><sup>L</sup></italic><sup>)</sup> is the position of the first residue in domain B and <italic>Start</italic><sup>(</sup><italic><sup>L</sup></italic><sup>)</sup><italic>&lt;end</italic>
<sup>(</sup><italic><sup>L</sup></italic><sup>)</sup>. In ThreaDom, we consider two contributions of template domain boundary structure and target-template alignment gaps, which are used to decide the location and size of the domain linkers of the target sequences.</p>
      <sec id="SEC2.4.1">
        <title>2.4.1 Template domain linker score</title>
        <p>ThreaDom considers <italic>T</italic> template alignments obtained by LOMETS, where <italic>T<sub>good</sub></italic> is the number of templates with a <italic>Z</italic>-score ≥ Z<sub>0</sub>, and <italic>T<sub>bad</sub></italic> is that with a <italic>Z</italic>-score &lt; <italic>Z<sub>0</sub></italic>. Following CATH (or DomainParser) domain definition, the <italic>j</italic>th template has a domain split specified by the linker structure <inline-formula><inline-graphic xlink:href="btt209i1.jpg"/></inline-formula>:
<disp-formula id="btt209-M2"><label>(2)</label><graphic xlink:href="btt209m2"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="btt209i2.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btt209i3.jpg"/></inline-formula> are the starting and ending positions of the linkers on <italic>j</italic>th template. Considering the alignment error that may result in linker shift, we introduce a distance allowance <italic>d</italic> to increase the size of template linkers.</p>
        <p>For residue <italic>i</italic>, the template domain linker score from the <italic>T</italic> template alignments is calculated by
<disp-formula id="btt209-M3"><label>(3)</label><graphic xlink:href="btt209m3"/></disp-formula>
where <italic>w<sub>1</sub></italic> and <italic>w<sub>2</sub></italic> are the weight parameters on ‘good’ or ‘bad’ templates. <italic>a<sub>ij</sub></italic> counts for whether the <italic>i</italic>th residue on the target is aligned with the linker regions of <italic>j</italic>th template, i.e.
<disp-formula id="btt209-M4"><label>(4)</label><graphic xlink:href="btt209m4"/></disp-formula>
Here, <italic>m</italic> counts for the confidence of domain assignment of template structures. In our benchmark test, there is an agreement between DomainParser and CATH for ∼80% proteins. We set <italic>m = </italic>0.8 if the template domain is assigned by DomainParser, and <italic>m</italic> = 1.0 if by CATH, as the latter is assisted by human intervention and of a higher accuracy in domain assignment.</p>
      </sec>
      <sec id="SEC2.4.2">
        <title>2.4.2 Gap penalty score</title>
        <p>ThreaDom specifies two types of gap penalties from threading alignments: terminal gap <italic>G<sub>term</sub></italic> and internal gap <italic>G<sub>int</sub></italic>. The terminal gaps on <italic>j</italic>th template are defined by
<disp-formula id="btt209-M5"><label>(5)</label><graphic xlink:href="btt209m5"/></disp-formula>
where <italic>j<sub>N</sub></italic> and <italic>j<sub>C</sub></italic> are the N- and C-terminal positions of the first and last aligned residues on <italic>j</italic>th template. The internal gap is defined by
<disp-formula id="btt209-M6"><label>(6)</label><graphic xlink:href="btt209m6"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="btt209i4.jpg"/></inline-formula> denotes the middle point of the internal gaps, and <italic>start<sub>G</sub></italic>(<italic>j</italic>) and <italic>end<sub>G</sub></italic>(<italic>j</italic>) are the starting and ending locations of the gaps. To rule out alignment noise, we only consider the gaps with a size longer than <italic>l</italic>, i.e. <inline-formula><inline-graphic xlink:href="btt209i5.jpg"/></inline-formula>.</p>
        <p>The total gap penalty score for the residue <italic>i</italic> is calculated by:
<disp-formula id="btt209-M7"><label>(7)</label><graphic xlink:href="btt209m7"/></disp-formula>
where <italic>w<sub>3</sub></italic> and <italic>w<sub>4</sub></italic> are the weight parameters; <italic>b<sub>ij</sub></italic> and <italic>c</italic><sub>ij</sub> are the binary values representing whether the <italic>i</italic>th residue locates in the gap regions of the <italic>j</italic>th template alignment:
<disp-formula id="btt209-M8"><label>(8)</label><graphic xlink:href="btt209m8"/></disp-formula>
</p>
      </sec>
      <sec id="SEC2.4.3">
        <title>2.4.3 Domain conservation score</title>
        <p>The template domain linker score and gap penalty score indicate the degree of variations of multiple threading alignments at the position <italic>i</italic>. Accordingly, the domain conservation score, <italic>S</italic>(<italic>i</italic>), is calculated by
<disp-formula id="btt209-M9"><label>(9)</label><graphic xlink:href="btt209m9"/></disp-formula>
where <italic>1 &lt; i &lt; N</italic>, <italic>N</italic> is the length of the target sequence.</p>
        <p>To reduce noise in the DCS assignment that may result in artificial domains with very short length, we smooth the domain conservation score using a 19-residue window:
<disp-formula id="btt209-M10"><label>(10)</label><graphic xlink:href="btt209m10"/></disp-formula>
Meanwhile, <italic>S</italic>(<italic>k</italic>) is set to 0 if <italic>S</italic>(<italic>k</italic>) &lt;0. Thus, the smoothed domain conservation score <italic>S</italic>’(<italic>i</italic>) has a value in (0,1).</p>
      </sec>
      <sec id="SEC2.4.4">
        <title>2.4.4 Deciding domain linkers by DCS profiles</title>
        <p>A putative domain linker <italic>L</italic><sup>(</sup><italic><sup>k</sup></italic><sup>)</sup> in ThreaDom is an aggregation of the continuous residues that have the conservation score below a certain cut-off <italic>S<sub>c</sub></italic>, i.e.
<disp-formula id="btt209-M11"><label>(11)</label><graphic xlink:href="btt209m11"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="btt209i6.jpg"/></inline-formula> represents the number of linkers. The middle point of the linker, <inline-formula><inline-graphic xlink:href="btt209i7.jpg"/></inline-formula>, is noted as the predicted boundary to the linker <italic>L</italic><sup>(</sup><italic><sup>k</sup></italic><sup>)</sup> in the ThreaDom program.</p>
        <p>As the majority of protein domains in the PDB have a length longer than 40 residues, we consider two length-based domain filters. First, if the distance from <inline-formula><inline-graphic xlink:href="btt209i8.jpg"/></inline-formula> to the terminal of sequence is &lt;40, the <italic>L</italic><sup>(</sup><italic><sup>k</sup></italic><sup>)</sup> is removed from the putative linker list (i.e. set <italic>L</italic><sup>(</sup><italic><sup>k</sup></italic><sup>)</sup> = 0). Second, if the distance between two neighboring linkers is too close, i.e. <inline-formula><inline-graphic xlink:href="btt209i9.jpg"/></inline-formula>, the linkers will be merged into one linker. The boundary position of the merged linkers is calculated by
<disp-formula id="btt209-M12"><label>(12)</label><graphic xlink:href="btt209m12"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="btt209i10.jpg"/></inline-formula> is associated with the confidence of the linker assignment on <inline-formula><inline-graphic xlink:href="btt209i11.jpg"/></inline-formula>. Based on <xref ref-type="disp-formula" rid="btt209-M12">Equation 12</xref>, if the linkers have similar confidence, i.e. <inline-formula><inline-graphic xlink:href="btt209i12.jpg"/></inline-formula>, the boundary position of the merged linker is at the middle of the two linkers, <inline-formula><inline-graphic xlink:href="btt209i13.jpg"/></inline-formula>. Otherwise, the boundary of the merged linkers will be biased to the position of the linker with a higher confidence score.</p>
        <p>The final continuous domain assignment in the ThreaDom is represented in the form of <inline-formula><inline-graphic xlink:href="btt209i14.jpg"/></inline-formula>, and the residue range in each pair of parenthesis represents an individual domain. One example of the ThreaDom protein domain prediction is given in <xref ref-type="fig" rid="btt209-F2">Figure 2</xref>, where four individual domains are separated by three linkers <italic>L</italic><sup>(1)</sup>, <italic>L</italic><sup>(2)</sup> and <italic>L</italic><sup>(3)</sup>, with the cutoff <italic>S<sub>c</sub></italic> = 0.60.
<fig id="btt209-F2" position="float"><label>Fig. 2.</label><caption><p>An illustration of the domain decision in ThreaDom based on the domain conservation score profile. Four individual domains are separated by three linkers defined by the valleys of the DCS distribution. The vertical dotted lines indicate the start and end locations of each putative linker. The vertical solid lines denote the predicted boundary at the middle of the linkers (<inline-formula><inline-graphic xlink:href="btt209i15.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="btt209i16.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btt209i17.jpg"/></inline-formula>)</p></caption><graphic xlink:href="btt209f2p"/></fig></p>
        <p><xref ref-type="disp-formula" rid="btt209-M1 btt209-M2 btt209-M3 btt209-M4 btt209-M5 btt209-M6 btt209-M7 btt209-M8 btt209-M9 btt209-M10 btt209-M11 btt209-M12">Equations 1–12</xref> have eight free parameters (<italic>w<sub>1</sub></italic>, <italic>w<sub>2</sub></italic>, <italic>w<sub>3</sub></italic>, <italic>w<sub>4</sub></italic>, <italic>d</italic>, <italic>l</italic>, <italic>T</italic> and <italic>S<sub>c</sub></italic>), which will be trained on our training proteins of various classes (see later in the text).</p>
      </sec>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Strategy for detecting discontinuous domains</title>
      <p>The term discontinuous domain refers to a domain that contains two or more segments from separated regions of target sequence. ThreaDom detects discontinuous domains based on the DCS profile and the pre-defined domain boundaries of the threading templates, which contains three steps:
<list list-type="simple"><list-item><p>Step I: Detecting discontinuous domain sequence. A target is considered to have discontinuous domains if it has &gt;30% templates that have discontinuous domain structure in the LOMETS template collection.</p></list-item><list-item><p>Step II: Clustering the discontinuous domain templates. The discontinuous domain templates are clustered based on their domain boundary locations and domain assignments. The discontinuous templates are clustered into one category if they have the same number of domains with same domain segments number and similar boundaries, where ‘similar boundary’ means that the difference in boundary positions is within ±5 residues after structure alignment of the two templates.</p></list-item><list-item><p>Step III: Boundary refinement and discontinuous domain substitution. After clustering, the DCS-based domain prediction and the domain structure in the first template cluster are combined, i.e. if the domain boundary difference between the DCS prediction and the first template cluster is within ±20 residues, the separated domains in the DCS prediction will be merged into a single domain following the assignment in the first template cluster. Meanwhile, if the number of domains in the DCS prediction is &gt;3 but less than that in the first cluster, we substitute the DCS prediction with the domain information of the first cluster when the domain boundaries in &gt;50% of templates are consistent (i.e. differences are ±20 residues).</p></list-item></list>
</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Evaluation criteria</title>
      <p>We evaluate the ability of ThreaDom on both the domain number and the domain boundary predictions. The domain number prediction is assessed by counting the accuracy of single- or multi-domain protein classifications. We use specificity, sensitivity and Matthew’s correlation coefficient (MCC) to assess the domain number prediction:
<disp-formula id="btt209-M13"><label>(13)</label><graphic xlink:href="btt209m13"/></disp-formula>
<disp-formula id="btt209-M14"><label>(14)</label><graphic xlink:href="btt209m14"/></disp-formula>
<disp-formula id="btt209-M15"><label>(15)</label><graphic xlink:href="btt209m15"/></disp-formula>
where <italic>TP</italic>, <italic>FP</italic>, <italic>TN</italic> and <italic>FN</italic> are true positive, false positive, true negative and false negative rates of the classifications, respectively.</p>
      <p>To assess the quality of domain boundary predictions, we calculate precision and recall rates, the normalized domain overlap (NDO)-score (<xref ref-type="bibr" rid="btt209-B24">Tai <italic>et al.</italic>, 2005</xref>) and the domain boundary distance (DBD) score (<xref ref-type="bibr" rid="btt209-B25">Tress <italic>et al.</italic>, 2007</xref>). The precision has a similar definition to specificity as defined in <xref ref-type="disp-formula" rid="btt209-M13">Equation 13</xref>, but boundary prediction is designated as ‘TP’ if it is within ±20 residues of the true boundary; otherwise it is an ‘FP’ prediction. Recall is similar to the sensitivity in <xref ref-type="disp-formula" rid="btt209-M14">Equation 14</xref>, which represents the fraction of the target boundaries that are correctly retrieved in the domain predictions. The NDO-score is defined as the normalized overlap rate of all predicted domain and linker regions with the true assignments of the target structure. The DBD-score measures the distance of the predicted boundaries from the true target domain boundaries.</p>
      <p>To avoid the contamination of homologous templates that are easy to predict in ThreaDom, we exclude all the templates that have a sequence identity &gt;30% to the target protein or that are detectable by PSI-BLAST with an E-value &lt;0.05. As a control, we implemented five publicly available domain predictors, including FIEFDom (<xref ref-type="bibr" rid="btt209-B1">Bondugula <italic>et al.</italic>, 2009</xref>), Pfam (<xref ref-type="bibr" rid="btt209-B8">Finn <italic>et al.</italic>, 2010</xref>), DomPro (<xref ref-type="bibr" rid="btt209-B2">Cheng <italic>et al.</italic>, 2006</xref>), DROP (<xref ref-type="bibr" rid="btt209-B5">Ebina <italic>et al.</italic>, 2011</xref>) and PPRODO (<xref ref-type="bibr" rid="btt209-B21">Sim <italic>et al.</italic>, 2005</xref>), which represent different type of homology- and machine-learning-based methods. These methods are run on the same test set of proteins.</p>
    </sec>
    <sec id="SEC2.7">
      <title>2.7 Parameter training</title>
      <p>There are eight free parameters in the ThreaDom scoring <xref ref-type="disp-formula" rid="btt209-M2 btt209-M3 btt209-M4 btt209-M5 btt209-M6 btt209-M7 btt209-M8 btt209-M9 btt209-M10 btt209-M11">Equations (2–11)</xref>, including four weight parameters (<italic>w<sub>1</sub></italic>, <italic>w<sub>2</sub></italic>, <italic>w<sub>3</sub></italic> and <italic>w<sub>4</sub></italic>), the linker shift <italic>d</italic>, the length cut-off of internal gaps <italic>l</italic>, the number of threading templates <italic>T</italic> and the DCS cut-off <italic>S<sub>c</sub></italic>. We trained the parameters by maximizing the precision, recall and NDO scores on the 800 training proteins (400 single-domain + 400 multi-domain proteins, see <xref ref-type="sec" rid="SEC2.1">Section 2.1</xref>). The parameters are tuned separately for Easy and Medium/Hard proteins. To increase the efficiency, we projected the parameter values on an 8D system and enumerate various values on the lattices. Parameter values corresponding to the optimal results were selected with results summarized in <xref ref-type="table" rid="btt209-T1">Table 1</xref>. For the 331 × 2 ‘Easy’ targets in our training set, the optimal NDO, precision and recall scores are 0.919, 0.836 and 0.77, respectively, and those for the 69 × 2 ‘Medium/Hard’ targets are 0.821, 0.476 and 0.32, respectively.
<table-wrap id="btt209-T1" position="float"><label>Table 1.</label><caption><p>The optimized parameters in ThreaDom</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Parameters</th><th rowspan="1" colspan="1">Easy</th><th rowspan="1" colspan="1">Medium/ Hard</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Weight of good templates (<italic>w<sub>1</sub></italic>)</td><td rowspan="1" colspan="1">2.0</td><td rowspan="1" colspan="1">2.0</td></tr><tr><td rowspan="1" colspan="1">Weight of bad templates (<italic>w<sub>2</sub></italic>)</td><td rowspan="1" colspan="1">0.6</td><td rowspan="1" colspan="1">0.5</td></tr><tr><td rowspan="1" colspan="1">Weight of terminal gaps (<italic>w<sub>3</sub></italic>)</td><td rowspan="1" colspan="1">0.8</td><td rowspan="1" colspan="1">1.4</td></tr><tr><td rowspan="1" colspan="1">Weight of internal gaps (<italic>w<sub>4</sub></italic>)</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">0.5</td></tr><tr><td rowspan="1" colspan="1">Shift of linkers or gaps (<italic>d</italic>)</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">10</td></tr><tr><td rowspan="1" colspan="1">Minimum length of internal gaps (<italic>l</italic>)</td><td rowspan="1" colspan="1">15</td><td rowspan="1" colspan="1">15</td></tr><tr><td rowspan="1" colspan="1">Number of used templates (<italic>T</italic>)</td><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">50</td></tr><tr><td rowspan="1" colspan="1">DCS cut-off (<italic>S<sub>c</sub></italic>)</td><td rowspan="1" colspan="1">0.6</td><td rowspan="1" colspan="1">0.76</td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 RESULTS AND DISCUSSION</title>
    <sec id="SEC3.1">
      <title>3.1 Domain classification prediction</title>
      <p>A sequence is considered to be a multi-domain protein if it includes one or more domain linkers. In the test on the 315 × 2 non-homologous proteins that are also non-homologous to the training protein set, ThreaDom correctly classifies proteins as being either single- or multi-domain proteins in 81% of the cases. For the ‘Easy’ protein set, the accuracy is 84.7%, and for ‘Medium/Hard’ test set, the accuracy is 68.5%.</p>
      <p><xref ref-type="table" rid="btt209-T2">Table 2</xref> shows a summary of ThreaDom performance in control with the other five methods on the single-domain or multi-domain classification. For all the three categories of ‘All’, ‘Easy’ and ‘Medium/Hard’, ThreaDom produces the highest MCC among the five predictors. The MCC values are 54, 60 and 41%, respectively, higher than that by the second best predictor FIEFDom, which is a homologous method-based on PSI-BLAST search. Pfam, a standard HMM-based domain assignment program, has a slightly lower average MCC than FIEFDom.
<table-wrap id="btt209-T2" position="float"><label>Table 2.</label><caption><p>Single- or multi-domain classifications on CATH domains</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="2" colspan="1">Type</th><th rowspan="2" colspan="1">Predictor</th><th rowspan="2" colspan="1">MCC</th><th colspan="2" rowspan="1">Single-domain</th><th colspan="2" rowspan="1">Multi-domain</th></tr><tr><th rowspan="1" colspan="1">Spec.</th><th rowspan="1" colspan="1">Sens.</th><th rowspan="1" colspan="1">Spec.</th><th rowspan="1" colspan="1">Sens.</th></tr></thead><tbody align="left"><tr><td rowspan="6" colspan="1">All</td><td rowspan="1" colspan="1">ThreaDom</td><td rowspan="1" colspan="1"><bold>0.682</bold></td><td rowspan="1" colspan="1"><bold>0.800</bold></td><td rowspan="1" colspan="1">0.902</td><td rowspan="1" colspan="1"><bold>0.887</bold></td><td rowspan="1" colspan="1">0.775</td></tr><tr><td rowspan="1" colspan="1">FIEFDom</td><td rowspan="1" colspan="1">0.443</td><td rowspan="1" colspan="1">0.724</td><td rowspan="1" colspan="1">0.683</td><td rowspan="1" colspan="1">0.700</td><td rowspan="1" colspan="1">0.740</td></tr><tr><td rowspan="1" colspan="1">Pfam</td><td rowspan="1" colspan="1">0.378</td><td rowspan="1" colspan="1">0.645</td><td rowspan="1" colspan="1">0.813</td><td rowspan="1" colspan="1">0.747</td><td rowspan="1" colspan="1">0.552</td></tr><tr><td rowspan="1" colspan="1">DROP</td><td rowspan="1" colspan="1">−0.019</td><td rowspan="1" colspan="1">0.491</td><td rowspan="1" colspan="1">0.517</td><td rowspan="1" colspan="1">0.490</td><td rowspan="1" colspan="1">0.463</td></tr><tr><td rowspan="1" colspan="1">DomPro</td><td rowspan="1" colspan="1">0.287</td><td rowspan="1" colspan="1">0.571</td><td rowspan="1" colspan="1"><bold>0.917</bold></td><td rowspan="1" colspan="1">0.790</td><td rowspan="1" colspan="1">0.311</td></tr><tr><td rowspan="1" colspan="1">PPRODO</td><td rowspan="1" colspan="1">0.076</td><td rowspan="1" colspan="1"><bold>0.800</bold></td><td rowspan="1" colspan="1">0.025</td><td rowspan="1" colspan="1">0.505</td><td rowspan="1" colspan="1"><bold>0.994</bold></td></tr><tr><td rowspan="6" colspan="1">Easy</td><td rowspan="1" colspan="1">ThreaDom</td><td rowspan="1" colspan="1"><bold>0.734</bold></td><td rowspan="1" colspan="1">0.837</td><td rowspan="1" colspan="1">0.908</td><td rowspan="1" colspan="1"><bold>0.900</bold></td><td rowspan="1" colspan="1">0.824</td></tr><tr><td rowspan="1" colspan="1">FIEFDom</td><td rowspan="1" colspan="1">0.458</td><td rowspan="1" colspan="1">0.768</td><td rowspan="1" colspan="1">0.648</td><td rowspan="1" colspan="1">0.695</td><td rowspan="1" colspan="1">0.805</td></tr><tr><td rowspan="1" colspan="1">Pfam</td><td rowspan="1" colspan="1">0.420</td><td rowspan="1" colspan="1">0.676</td><td rowspan="1" colspan="1">0.793</td><td rowspan="1" colspan="1">0.750</td><td rowspan="1" colspan="1">0.621</td></tr><tr><td rowspan="1" colspan="1">DROP</td><td rowspan="1" colspan="1">−0.019</td><td rowspan="1" colspan="1">0.490</td><td rowspan="1" colspan="1">0.479</td><td rowspan="1" colspan="1">0.491</td><td rowspan="1" colspan="1">0.502</td></tr><tr><td rowspan="1" colspan="1">DomPro</td><td rowspan="1" colspan="1">0.304</td><td rowspan="1" colspan="1">0.579</td><td rowspan="1" colspan="1"><bold>0.912</bold></td><td rowspan="1" colspan="1">0.793</td><td rowspan="1" colspan="1">0.337</td></tr><tr><td rowspan="1" colspan="1">PPRODO</td><td rowspan="1" colspan="1">0.076</td><td rowspan="1" colspan="1"><bold>1.000</bold></td><td rowspan="1" colspan="1">0.011</td><td rowspan="1" colspan="1">0.503</td><td rowspan="1" colspan="1"><bold>1.000</bold></td></tr><tr><td rowspan="6" colspan="1">Medium/Hard</td><td rowspan="1" colspan="1">ThreaDom</td><td rowspan="1" colspan="1"><bold>0.432</bold></td><td rowspan="1" colspan="1">0.653</td><td rowspan="1" colspan="1">0.870</td><td rowspan="1" colspan="1"><bold>0.806</bold></td><td rowspan="1" colspan="1">0.537</td></tr><tr><td rowspan="1" colspan="1">FIEFDom</td><td rowspan="1" colspan="1">0.307</td><td rowspan="1" colspan="1">0.597</td><td rowspan="1" colspan="1">0.852</td><td rowspan="1" colspan="1">0.742</td><td rowspan="1" colspan="1">0.426</td></tr><tr><td rowspan="1" colspan="1">Pfam</td><td rowspan="1" colspan="1">0.178</td><td rowspan="1" colspan="1">0.538</td><td rowspan="1" colspan="1">0.907</td><td rowspan="1" colspan="1">0.706</td><td rowspan="1" colspan="1">0.222</td></tr><tr><td rowspan="1" colspan="1">DROP</td><td rowspan="1" colspan="1">−0.020</td><td rowspan="1" colspan="1">0.494</td><td rowspan="1" colspan="1">0.704</td><td rowspan="1" colspan="1">0.484</td><td rowspan="1" colspan="1">0.278</td></tr><tr><td rowspan="1" colspan="1">DomPro</td><td rowspan="1" colspan="1">0.199</td><td rowspan="1" colspan="1">0.537</td><td rowspan="1" colspan="1"><bold>0.944</bold></td><td rowspan="1" colspan="1">0.769</td><td rowspan="1" colspan="1">0.185</td></tr><tr><td rowspan="1" colspan="1">PPRODO</td><td rowspan="1" colspan="1">0.113</td><td rowspan="1" colspan="1"><bold>0.714</bold></td><td rowspan="1" colspan="1">0.093</td><td rowspan="1" colspan="1">0.515</td><td rowspan="1" colspan="1"><bold>0.963</bold></td></tr></tbody></table><table-wrap-foot><fn id="btt209-TF1"><p><italic>Note</italic>: Bold values denote the best performance in each category.</p><p>MCC, Matthew’s correlation coefficient; Spec., specificity; Sens., sensitivity.</p></fn></table-wrap-foot></table-wrap></p>
      <p>Interestingly, the two machine-learning-based methods, DomPro and PPRODO, have top specificity or sensitive values in some categories, but they have a low MCC because of unbalanced classifications. For example, in the ‘Easy’ set, PPRODO has a sensitivity of 100% for multi-domain classification but only 1.1% for single-domain, whereas the corresponding specificity values were 50.3 and 100%, respectively. These data imply that PPRODO classifies almost all sequences as multi-domain protein, which, therefore, leads to a low MCC value of 0.076. Similarly, DomPro tends to classify most chains as being single-domain chains that also results in a modest MCC value, although it has a better balance than PPRODO. In other words, DomPro is an underpredicting method for multiple-domain, whereas PPRODO is overpredicting. DROP, another machine-learning method, has a negative MCC in all three categories of targets because of the low assignment accuracy.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Domain boundary prediction</title>
      <p>For the proteins in the ‘All’, ‘Easy’ and ‘Medium/Hard’ sets, the domain boundary predictions by ThreaDom has the NDO-scores of 0.893, 0.905 and 0.832, DBD-scores of 0.861, 0.887 and 0.737, precisions of 0.784, 0.814 and 0.562 and recalls of 0.670, 0.708 and 0.425, respectively. <xref ref-type="fig" rid="btt209-F3">Figure 3</xref> presents the ThreaDom prediction results together with that by other five control methods, where the <italic>y</italic>-axis is the value of NDO, DBD, boundary precision and recall scores, and <italic>x</italic>-axis denotes the categories of protein sets in ‘All’, ‘Easy’ or ‘Medium/Hard’. For proteins in all the three categories, ThreaDom achieves the highest value in NDO-score, DBD-score and boundary precision. ThreaDom also has the highest score in boundary recall for ‘All’ and ‘Easy’ categories, and the second highest score in boundary recall for the ‘Medium/Hard’ proteins.
<fig id="btt209-F3" position="float"><label>Fig. 3.</label><caption><p>Summary of domain boundary predictions by ThreaDom and the control predictors. (<bold>A</bold>) Normalized Domain Overlap score; (<bold>B</bold>) Domain Boundary Distance Score; (<bold>C</bold>) Precision of predicted boundaries; (<bold>D</bold>) Recall of pre-defined boundaries</p></caption><graphic xlink:href="btt209f3p"/></fig></p>
      <p>As shown in <xref ref-type="fig" rid="btt209-F3">Figure 3</xref>D, PPRODO has a slightly higher recall value than ThreaDom for the ‘Medium/Hard’ targets. This is partly because of the overprediction of PPRODO that predicts most of the single-domain proteins as multi-domain and has, therefore, on average more boundary linkers assigned. This leads to a worse precision value (26.7%) in comparison with that by ThreaDom (56.2%). Because of the unbalanced recall and precision, PPRODO has overall a poor performance when assessed by the NDO- and DBD-scores (<xref ref-type="fig" rid="btt209-F3">Fig. 3</xref>A and B).</p>
      <p>Different methods have different sensitivities on the category of protein targets. As shown in <xref ref-type="fig" rid="btt209-F3">Figure 3</xref>, the predictions by the statistical and machine-learning-based methods (DomPro, DROP and PPRODO) have similar performances in both ‘Easy’ and ‘Medium/Hard’ categories, as these predictions are from sequence only. The HMM-based method, Pfam, also does not show difference between Easy and Hard targets because the domains in Pfam were retrieved from UniProt and ADDA sequence clustering (<xref ref-type="bibr" rid="btt209-B10">Heger and Holm, 2003</xref>), which are not directly associated with template structures in the PDB library. However, the two template-based methods, ThreaDom and FIEFDom, have an obvious difference between ‘Easy’ and ‘Medium/Hard’ proteins because of the different availability of the template hits in the two category of proteins. Nevertheless, ThreaDom identified much more accurate boundary predictions than FIEFDom in both ‘Easy’ and ‘Medium/Hard’ categories. Particularly in the ‘Medium/Hard’ protein set, the precision and recall are three and five times higher than that in FIEFDom. These improvements are mainly because of (i) the better identification of templates by LOMETS than that by PSI-BLAST or HMM searches and (ii) the sensitive calibration of gaps and alignments by the domain conservation score as designed by ThreaDom. These advantages are essential for ThreaDom to detect efficient domain structures for the weakly- or non-homologous proteins.</p>
      <p>In general, for the ‘Easy’ proteins, there are a large number of ‘good’ templates with a high <italic>Z</italic>-score as detected by various threading programs in ThreaDom. The consensus domain assignments of the template structures dominate the boundary predictions. For the ‘Medium/Hard’ targets, however, there are few consensus ‘good’ templates, and the identification of consensus terminal and internal alignment gaps becomes sensitive. This explains the reason that the weighting parameters of gap penalty score (w<sub>3</sub> and w<sub>4</sub> in <xref ref-type="disp-formula" rid="btt209-M7">Equation 7</xref>) become larger for the ‘Medium/Hard’ targets than that for the ‘Easy’ targets (<xref ref-type="table" rid="btt209-T1">Table 1</xref>). In <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Table S1</ext-link> of <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Materials</ext-link>, we separated the contributions of template alignment and gap penalty scores in ThreaDom. Although the gap penalty score tends to make more important contribution for Hard targets, a combination of template and gap penalty scores outperforms individual scores in all categories of targets. Thus, using a balanced consensus of template domain assignment and the internal and terminal gaps from multiple template alignments, the DCS system helps erase the incident errors from single template alignment by individual threading programs that are often less reliable.</p>
      <p>In <xref ref-type="fig" rid="btt209-F4">Figure 4</xref>, we show an illustrative example from the GTP cyclohydrolase I (PDB ID: 1wurA), which is a hard target for which none of the LOMETS threading program has a strong template alignment with <italic>Z</italic>-score &gt; Z<sub>0</sub>. The chain is classified as a two-domain protein with boundary structure of (1–55) (56–185) in the CATH database (<xref ref-type="fig" rid="btt209-F4">Fig. 4</xref>E). In the control programs, both FIEFDom and DROP incorrectly predicted the protein as a single-domain chain, whereas PPRODO and DomPro correctly assigned it as a multi-domain protein, but the assigned domain boundary is 35 and 45 residues away from the CATH assignment, respectively.
<fig id="btt209-F4" position="float"><label>Fig. 4.</label><caption><p>An illustrative example of ThreaDom prediction on ‘Hard’ target from the GTP cyclohydrolase I (PDB ID: 1wurA). (<bold>A</bold>) DCS score distribution. (<bold>B–D</bold>) Counts of templates with terminal gap, internal gap and template domain assignment along the sequence in the total 50 selected templates. (<bold>E</bold>) X-ray structure of the target protein with CATH and ThreaDom domain boundaries labeled</p></caption><graphic xlink:href="btt209f4p"/></fig></p>
      <p>As shown in <xref ref-type="fig" rid="btt209-F4">Figure 4</xref>D, the alignments among the 50 selected threading templates are divergent and not conclusive: four templates at residue 46, two at residues 65, 69 and 102 and others with domains almost evenly distributed along the sequence. Similarly in <xref ref-type="fig" rid="btt209-F4">Figure 4</xref>B and C, the internal and terminal alignment gaps are nearly even-distributed. However, when we combine the contributions from the domain and gap assignments as described in <xref ref-type="disp-formula" rid="btt209-M9">Equations 9</xref> and <xref ref-type="disp-formula" rid="btt209-M10">10</xref>, the overall DCS profile has an obvious valley around residue 60 (<xref ref-type="fig" rid="btt209-F4">Fig. 4</xref>A), which is due to the weak but consistent tendency of gap and domain assignments in the multiple threading alignments. Although there are two other valleys in the N- and C-terminals, the locations are &lt;40 residues away from the sequence ends and are ruled out by the default length filter. Finally, the ThreaDom boundary prediction is (1–60) (61–185), which shift by only five residues from the CATH assignment. This example highlights the power of ThreaDom in extracting correct domain information from distantly homologous threading alignments by combining multiple domain and alignment gap/insertion information.</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Domain prediction assessed by alternative domain definitions</title>
      <p>One concern of the aforementioned data analyses is on the possible bias of distinctive domain definitions of the training and test proteins, as some methods (e.g. FIEFDom) were trained by domains defined in the SCOP database (<xref ref-type="bibr" rid="btt209-B15">Murzin <italic>et al.</italic>, 1995</xref>), but the analyses are mainly on CATH definitions, which is what ThreaDom was trained on. In <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Table S2</ext-link>, we present a quantitative analysis of the domain predictions on the 315 test protein pairs with the domains defined by SCOP1.75. Similarly, if a protein cannot be seen in the SCOP library, a definition from DomainParser is used instead. Although some small variations are seen in specific score values, there is no qualitative difference between <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Table S2</ext-link> and the data shown in <xref ref-type="table" rid="btt209-T1">Table 1</xref> and <xref ref-type="fig" rid="btt209-F3">Figure 3</xref>. These results demonstrate that the distinctive domain definitions of different databases have no impact on the training and testing procedures of domain predictions.</p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 Discontinuous domain prediction</title>
      <p>Domain assignment for the proteins that have domains consisting of segments from separated locations, called discontinuous domains, is a long-standing unsolved problem. Despite the significant importance of discontinuous domains in protein structural determination and function annotations, there is so far no efficient method available for discontinuous domain prediction.</p>
      <p>To test the ability of ThreaDom in discontinuous domain prediction, we collect 486 non-homologous multi-domain proteins from CATH 3.4 that include at least one domain with discontinuous segments. These protein domains/segments have &gt;40 residues with a pairwise sequence identity &lt;40%.</p>
      <p>Overall, the automated ThreaDom procedure correctly identified 88.9% of the proteins as multi-domain proteins. For the domain boundary prediction, the precision and recall are 83.9 and 64.5%, respectively, which are comparable with that for the continuous domain protein samples (78.4 and 67.0% in precision and recall), although we did not separately train ThreaDom on the discontinuous domain proteins. The success rates of the predictions demonstrate that the segment assembly procedure has efficiently combined the identified domain linkers from separated positions into the discontinuous domains.</p>
      <p>To illustrate the procedure, we present in <xref ref-type="fig" rid="btt209-F5">Figure 5</xref> an example of a discontinuous domain protein from the aminopeptidase I in <italic>Clostridium acetobutylicum</italic> (PDB ID: 2gljE). The domain structure in CATH assignment is (1–105;244–455) (106–243), where the first domain <italic>D<sub>1</sub></italic> (1–105;244–455) contains two segments <italic>S<sub>11</sub></italic> (1–105) and <italic>S<sub>12</sub></italic> (244–455). The second domain <italic>D<sub>2</sub></italic> is a continuous domain containing one segment <italic>S<sub>21</sub></italic> from 105 to 243. In <xref ref-type="fig" rid="btt209-F5">Figure 5</xref>, the domain boundary residues PRO105 and LYS244 are labeled in blue, ARG106 and GLY243 in magenta. P<sub>1</sub> and P<sub>2</sub> indicate the positions that split the sequence into the two domains.
<fig id="btt209-F5" position="float"><label>Fig. 5.</label><caption><p>Illustration of ThreaDom on discontinuous domain prediction for the aminopeptidase I protein (PDB ID: 2gljE). The segments assigned by ThreaDom, <italic>s<sub>1</sub></italic> (1–103), <italic>s<sub>2</sub></italic> (104–243) and <italic>s<sub>3</sub></italic> (244–455), are marked in red, green and yellow, respectively. The separated segments (<italic>s<sub>1</sub></italic> and <italic>s<sub>2</sub></italic>) are merged into a single domain following the clusters of the discontinuous domain templates. P<sub>1</sub> and P<sub>2</sub> denote the domain boundary position according to CATH 3.4, and P<sub>2</sub> and P<sub>3</sub> are that predicted by ThreaDom</p></caption><graphic xlink:href="btt209f5p"/></fig></p>
      <p>As most of the top templates by LOMETS have discontinuous domain structure, ThreaDom classified the target as a discontinuous domain protein. Following the multiple template alignments, the sequence is split into three segments of <italic>s<sub>1</sub></italic> (1–103), <italic>s<sub>2</sub></italic> (104–243) and <italic>s<sub>3</sub></italic> (244–455), which are marked in red, green and yellow, respectively, in <xref ref-type="fig" rid="btt209-F5">Figure 5</xref>, where P3 and P2 indicate the splitting positions of the segments. These segments are highly consistent with the first cluster of discontinuous-domain templates that have a domain structure of (27–104;247–454) (105–246). Therefore, the segments of <italic>s<sub>1</sub></italic> and <italic>s<sub>3</sub></italic> were merged in a single domain with <italic>s<sub>2</sub></italic> assigned as the second domain. As a result, there is only a two-residue shift in the domain boundary by the ThreaDom prediction compared with the CATH assignment in this example.</p>
    </sec>
    <sec id="SEC3.5">
      <title>3.5 Benchmark on CASP targets</title>
      <p>As publicly available domain predictors are limited, to have a more extensive benchmark with the state-of-the-art methods, we test ThreaDom on the protein targets in CASP8 (<xref ref-type="bibr" rid="btt209-B7">Ezkurdia <italic>et al.</italic>, 2009</xref>), which is the last community-wide blind experiment on protein domain prediction (DP). The DP section in CASP8 contains seven multi-domain Free Modeling (FM) targets, 29 Multi-Domain Hard (MD-Hard) targets and 20 DisContinuous Domain (DCD) targets. To mimic the CASP procedure, all template proteins, which were solved after the CASP8 experiment, were excluded from the LOMETS threading library when implementing ThreaDom.</p>
      <p>In <xref ref-type="fig" rid="btt209-F6">Figure 6</xref>, we present the average NDO-score of ThreaDom predictions in the three categories, in control with the seven severs in the CASP8 DP section, which submitted predictions for all the targets (five other servers, which submitted only partial targets, were not shown in the figure). Overall, ThreaDom has an average NDO-score of 0.738, 0.868 and 0.854 for the FM, MD-Hard and DCD targets, respectively. For the entire set of 56 targets, the average NDO-score is 0.847, which is higher than all the predictors in the CASP8 experiment.
<fig id="btt209-F6" position="float"><label>Fig. 6.</label><caption><p>Average normalized domain overlap (NDO)-score of ThreaDom predictions on the CASP8 domain prediction targets, in comparison with the CASP8 servers that submitted prediction for all 56 DP targets</p></caption><graphic xlink:href="btt209f6p"/></fig></p>
      <p>In <xref ref-type="fig" rid="btt209-F7">Figure 7</xref>, we present three typical examples of ThreaDom predictions for the CASP8 targets. First, T0496 and T0397 in <xref ref-type="fig" rid="btt209-F7">Figure 7</xref>A and B have the domain boundary defined as (4–123) (124–178) and (1–82) (83–150), respectively, based on the experimental structures. Both targets are FM targets that have no obvious template hit by LOMETS. ThreaDom combined the consensus of template alignments and gap penalty scores, which generated a domain prediction as (1–113) (114–178) and (1–75) (76–150) for the two targets; these correspond to NDO-scores of 0.889 and 0.907, respectively. All the predicted boundaries are within ±10 residues from the native domain definition.
<fig id="btt209-F7" position="float"><label>Fig. 7.</label><caption><p>Illustrative examples of domain prediction by ThreaDom on CASP8 targets: (<bold>A</bold>) FM target T0496; (<bold>B</bold>) FM target T0397; (<bold>C</bold>) DCD target T0490. The domain boundary from the native structures is labeled by the cutting pars P1–P6 with the adjacent residues marked in blue and magenta. The domain segments predicted by ThreaDom are marked in different colors. In T0490, the neighboring segments are correctly merged into two individual domains</p></caption><graphic xlink:href="btt209f7p"/></fig></p>
      <p>T0490 in <xref ref-type="fig" rid="btt209-F7">Figure 7</xref>C is also an FM target but with DCD structure, (5–87|143–227|319–368) (88–142|228–318). The first step of the DCS scan split the target sequence into five segments, i.e. (1–84) (85–142) (143–223) (224–319) (320–369), shown in red, green, orange, cyan and yellow, respectively. After the template domain structure clustering and boundary refinement, the first, third and fifth segments are merged into the first domain and the rest into the second domain. The final prediction (1–85|143–225|319–368) (86–142|226–318) has a DNO-score of 0.97, which is close to the native structure not only in the domain number and boundary but also in the DCD components (<xref ref-type="fig" rid="btt209-F7">Fig. 7</xref>C).</p>
      <p>Domain prediction tests were not included in the most recent CASP experiments (CASP9 and 10). The FM/Hard targets in the experiments, however, represent a set of well-defined real-time proteins free of homologous contaminations. In <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Table S3</ext-link>, we list the performance of ThreaDom, in control with FIEFDom, Pfam, DROP, Dompro and PPRODO, on 46 FM/MD-Hard targets with 22 from CASP9 and 24 from CASP10. Similarly, all protein templates solved after the CASP experiments were excluded. To examine the impact of different steps of procedures, we implemented two version of ThreaDom, i.e. ThreaDom1 used the Domain Conservation score without linker refinement and DCD detection procedures, whereas ThreaDom2 is a complete ThreaDom implementation, including both procedures.</p>
      <p>As shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Table S3</ext-link>, ThreaDom2 obviously outperforms ThreaDom1 in all criteria of precision, recall, DNO- and DBD-scores, which demonstrates the importance of the refinement procedures. Overall, the two ThreaDom programs are ranked as the top two methods in most of the assessments for the CASP9 and CASP10 targets, except for that the DBD-score, and the boundary recall of the ThreaDom programs are slightly lower than that of a few other methods for the CASP9 targets.</p>
    </sec>
    <sec id="SEC3.6">
      <title>3.6 Drawbacks of ThreaDom</title>
      <p>ThreaDom is a threading-based method, and the quality of the threading template alignments has a major impact on the performance of the domain predictions. Generally, the success rate for Easy targets with a strong hit is higher than that of Hard/Medium targets. However, there are also cases that strong templates hits can result in incorrect domain assignments. The major sources of errors in ThreaDom come from (i) inconsistent domain order of homologous proteins; (ii) non-specific DCS cut-offs; and (iii) unmatched sequence size between target and templates.</p>
      <p><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Figure S1</ext-link> shows two examples of the incorrect ThreaDom predictions because of inconsistent domain orders, one from the Talin-1 (PDBID: 3dyjA) and one from the DNA polymerase III subunit β (PDBID: 3d1gA). Target 3dyjA is a two-domain protein with boundary at 164 according to CATH (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Fig. S1A</ext-link>). LOMETS identified the top template from 2 × 0cA, which has the same architecture to the target but with domains containing swapped segments (<xref ref-type="bibr" rid="btt209-B23">Szilagyi <italic>et al.</italic>, 2012</xref>) (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Fig. S1B</ext-link>); this results in an incorrect split (1–98) (99–162) (163–241) (242–311) by ThreaDom (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Fig. S1C</ext-link>). ThreaDom did not merge the separate segments, as the fraction of hits on 2 × 0cA is below the cut-off (30%) in this example. Target 3d1gA consists of three domains: (1–123) (124–247) (248–366) in CATH (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Fig. S1D</ext-link>). It has the dominant template alignments from 2awaB with a high TM-score to the target (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Fig. S1E</ext-link>). However, 2awaB contains discontinuous domain structures (1–138|205–244) (139–204|245–375) in CATH, which results in an incorrect domain assignment (1–123|195–241) (124–194|242–366) following threading mapping (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt209/-/DC1">Supplementary Fig. S1F</ext-link>), despite the fact that the overall topology of the two proteins is close.</p>
      <p>The domain linker regions in ThreaDom are decided by the interplay of DCS profile and threshold cut-offs. To increase the specificity, the DCS cutoff parameter has been trained in two sets of Easy and Medium/Hard proteins. Nevertheless, a single cut-off score might be still too general, which can result in over- or underprediction of protein domains. <xref ref-type="fig" rid="btt209-F8">Figure 8</xref>A is an example of overprediction on 3-methyladenine DNA glycosylase I (PDBID: 2ofkA), which is a single-domain protein target. LOMETS considers it as a Hard target, as no significant template was identified. Among the top 35 template hits, 19 are multiple-domain proteins and 10 have the terminal gap near the residue 120. The DCS profile has, therefore, an artificial valley lower than the DCS threshold 0.76 for Hard/Medium target, which results in an overprediction of (1–120) (121–182) for this target. If the DCS threshold for Easy target (0.6) was taken, this artificial valley could have been ignored.
<fig id="btt209-F8" position="float"><label>Fig. 8.</label><caption><p>Inappropriate DCS thresholds and template sizes can result in incorrect domain predictions. (<bold>A–C</bold>) DCS score for 2ofkA, 1sauA and 1e8yA, respectively; (<bold>D</bold>) histogram of template alignment coverages for 1e8yA</p></caption><graphic xlink:href="btt209f8p"/></fig></p>
      <p><xref ref-type="fig" rid="btt209-F8">Figure 8</xref>B is an example of underprediction because of the inappropriate DCS cut-offs. This protein is from the γ subunit of the dissimilatory sulfite reductase (DsrC) (PDBID: 1sauA), which is a two-domain Hard protein with domain assignment as (1–44) (45–114) in CATH. Although the DCS profile has a well-shaped valley at the correct domain boundary region, ThreaDom mis-predicted it as a single-domain protein because the N-terminal peak of DCS-score is lower than the threshold cut-off 0.76, and the N-terminal domain boundary is, therefore, overseen by ThreaDom. Again, if the DCS threshold for Easy target (0.6) was taken, this valley could have been picked up. The major reason for the low DCS peak is that the domain segment is short, and nearly all the residues undergo a gap penalty because they are too close to the two terminal and internal gaps. As shown in Equations (<xref ref-type="disp-formula" rid="btt209-M2">2</xref>, <xref ref-type="disp-formula" rid="btt209-M5">5</xref> and <xref ref-type="disp-formula" rid="btt209-M6">6</xref>), a distance allowance <italic>d</italic> (=10/12) was introduced to tolerate the alignment/gap uncertainty; but it also introduces overpenalty for small domains. Generally, ThreaDom is unable to predict small domains with size &lt;20 residues. To enhance the sensitivity for small domains, a size-dependent threshold cut-off might be needed for ThreaDom.</p>
      <p>As ThreaDom derives domain information from templates, insufficient coverage of template alignments is another source of errors in ThreaDom prediction. This is particularly a problem for big proteins, such as the armadillo and heat repeats and β-propellers etc, when the solved template proteins cover only part of the repeats. <xref ref-type="fig" rid="btt209-F8">Figure 8</xref>C shows the DCS profile of an example of such big proteins from the phosphatidylinositol 3-kinase catalytic subunit (PDBID: 1e8yA), which contains 841 residues with five domains assigned in CATH: (1–166) (168–302) (303–488) (489–646) (647–841). There are overall 31 strong template hits in LOMETS but most of them have a length &lt;550 residues as seen in <xref ref-type="fig" rid="btt209-F8">Figure 8</xref>D. As a result, ThreaDom generates a prediction of three domains (1–165) (166–303) (304–841) with only the first two domains correctly assigned. We did notice that there are weak valleys in the third and fourth domain boundary linkers that are from the alignment shifts in the C-terminal region, but they are too weak to pick-up by the current DCS cut-offs (0.6 for Easy proteins). This example highlights on one hand the importance of fine-tuning DCS threshold parameters. On the other hand, the domain prediction for big proteins may be further improved by an iterative threading procedure, i.e. repeating threading on the large single-domain sequences. In this example, if we run LOMETS on the remaining big domain (304–841) recursively, correct domain assignment can be obtained for the third, fourth and fifth domains.</p>
    </sec>
  </sec>
  <sec id="SEC4">
    <title>4 CONCLUSION</title>
    <p>We developed a multiple-threading-based method, ThreaDom, for protein domain boundary prediction. For a given target, it first threads the sequence through the PDB library to identify homologous and analogous templates. The profile distribution of the DCS, which combines the composite information of template domain structure and terminal/internal alignment gaps, is then derived for identifying the domain boundary locations. If DCDs are detected in the threading alignments, segments from separated sequences will be merged into single domains under the guide of the top template domain clusters and the target-template alignments.</p>
    <p>There are several distinct advantages of ThreaDom over the current domain methods in literature. First, for the proteins of homologous templates, the domain assignment from threading alignments achieves a significantly higher accuracy than that from <italic>ab initio</italic> statistical or machine-learning approaches (<xref ref-type="fig" rid="btt209-F3">Fig. 3</xref>). For proteins without close homologies, the LOMETS threading programs often identify multiple alignments or super-secondary structure segments from weakly homologous templates, where the DCS profile can help pull out consensus information between domain structure and alignment gaps. This enables ThreaDom to generate useful domain information for the targets that traditional homology-based approaches have difficulty with. It has also the advantage over the structural modeling-based approaches, as no lengthy modeling simulations are needed, and the approach has basically no limit on the size of protein targets.</p>
    <p>ThreaDom was tested on three independent sets of proteins. For the first set of 315 single- and multi-domain protein pairs, ThreaDom achieves MCCs of 0.734 and 0.432 in single-/multi-domain classification compared with the CATH definition for ‘Easy’ and ‘Medium/Hard’ targets, respectively, which are significantly higher than the control methods from homology and machine-learning-based approaches. Similar results are obtained when using an alternative domain definition from SCOP, which demonstrates the reliability of the data analysis. Second, in the test of 486 DCD proteins, ThreaDom has a similar domain assignment accuracy as that in continuous domains with a precision and recall 83.9 and 64.5%, respectively, in the domain boundary prediction. Finally, when tested on the 56 CASP8 targets, ThreaDom has NDO-scores 0.761, 0.868 and 0.854 for the FM, MD-Hard and DCD targets, respectively. The average NDO-score for all targets is 0.847 that is the highest among all CASP8 servers from different categories of homology, machine-learning and <italic>ab initio</italic> folding-based approaches. Similar achievements are obtained for targets in the CASP9 and CASP10 experiments.</p>
    <p>Overall, these data demonstrate a new promising approach that fills up the gaps between the sequence-based and the homology-based methods, which can achieve reliable domain assignments in all categories of template-based and template-free modeling protein targets. Nevertheless, fine-tuning on DCS profile cut-offs and iterative threading are needed for further improvement on small domain recognition and long sequence covering, respectively.</p>
    <p>Although ThreaDom uses template-based modeling approach, it is much faster than the normal protein folding simulations, as the threading procedure involves only the sequence alignment search through a subset of the PDB library, which takes ∼20 min for one target protein. This speed makes it fairly feasible to genome-wide applications, as a single threading scan for a middle-size genome of 5000 genes takes &lt;1 day on a 100-core cluster and that using multiple threading programs, such as LOMETS, should take &lt;1 week. An online server, as well as the source code package of ThreaDom, is freely available for academic users at <ext-link ext-link-type="uri" xlink:href="http://zhanglab.ccmb.med.umich.edu/ThreaDom/">http://zhanglab.ccmb.med.umich.edu/ThreaDom/</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_29_13_i247__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btt209_Zhang_232_sup_1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENT</title>
    <p>The authors are grateful to G. Brandon and Dr J. Yang for discussion, Dr J. Virtanen for reading the manuscript and Dr J. Eichholt, Dr J. Cheng, Dr A. Heger and Dr Y. Kuroda for help in using their software.</p>
    <p><italic>Funding</italic>: <funding-source>National Science Foundation Career Award</funding-source> (<award-id>DBI 1027394</award-id>); <funding-source>National Institute of General Medical Sciences</funding-source> (<award-id>GM083107</award-id> and <award-id>GM084222</award-id>); <funding-source>National Natural Science Foundation of China</funding-source> (<award-id>30700162</award-id>,<award-id>61073095</award-id>).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btt209-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bondugula</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>FIEFDom: a transparent domain boundary recognition system using a fuzzy mean operator</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>452</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="pmid">19056827</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DOMpro: protein domain prediction using profiles, secondary structure, relative solvent accessibility, and recursive neural networks</article-title>
        <source>Data Min. Knowl. Discov.</source>
        <year>2006</year>
        <volume>13</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
      </element-citation>
    </ref>
    <ref id="btt209-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dessailly</surname>
            <given-names>BH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detailed analysis of function divergence in a large and diverse domain superfamily: toward a refined protocol of function classification</article-title>
        <source>Structure</source>
        <year>2010</year>
        <volume>18</volume>
        <fpage>1522</fpage>
        <lpage>1535</lpage>
        <pub-id pub-id-type="pmid">21070951</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dumontier</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Armadillo: domain boundary prediction by amino acid composition</article-title>
        <source>J. Mol. Biol.</source>
        <year>2005</year>
        <volume>350</volume>
        <fpage>1061</fpage>
        <lpage>1073</lpage>
        <pub-id pub-id-type="pmid">15978619</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ebina</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DROP: an SVM domain linker predictor trained with optimal features selected by random forest</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>487</fpage>
        <lpage>494</lpage>
        <pub-id pub-id-type="pmid">21169376</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eickholt</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DoBo: protein domain boundary prediction by integrating evolutionary signals and machine learning</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>43</fpage>
        <pub-id pub-id-type="pmid">21284866</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ezkurdia</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assessment of domain boundary predictions and the prediction of intramolecular contacts in CASP8</article-title>
        <source>Proteins</source>
        <year>2009</year>
        <volume>77</volume>
        <issue>Suppl. 9</issue>
        <fpage>196</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="pmid">19714769</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finn</surname>
            <given-names>RD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Pfam protein families database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>D211</fpage>
        <lpage>D222</lpage>
        <pub-id pub-id-type="pmid">19920124</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>George</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Heringa</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>SnapDRAGON: a method to delineate protein structural domains from sequence data</article-title>
        <source>J. Mol. Biol.</source>
        <year>2002</year>
        <volume>316</volume>
        <fpage>839</fpage>
        <lpage>851</lpage>
        <pub-id pub-id-type="pmid">11866536</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holm</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Exhaustive enumeration of protein domain families</article-title>
        <source>J. Mol. Biol.</source>
        <year>2003</year>
        <volume>328</volume>
        <fpage>749</fpage>
        <lpage>767</lpage>
        <pub-id pub-id-type="pmid">12706730</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heger</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ADDA: a domain database with global coverage of the protein universe</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>D188</fpage>
        <lpage>D191</lpage>
        <pub-id pub-id-type="pmid">15608174</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karplus</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Hidden Markov models for detecting remote protein homologies</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>846</fpage>
        <lpage>856</lpage>
        <pub-id pub-id-type="pmid">9927713</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>DE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated prediction of domain boundaries in CASP6 targets using Ginzu and RosettaDOM</article-title>
        <source>Proteins</source>
        <year>2005</year>
        <volume>61</volume>
        <issue>Suppl. 7</issue>
        <fpage>193</fpage>
        <lpage>200</lpage>
        <pub-id pub-id-type="pmid">16187362</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rost</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>CHOP proteins into structural domain-like fragments</article-title>
        <source>Proteins</source>
        <year>2004</year>
        <volume>55</volume>
        <fpage>678</fpage>
        <lpage>688</lpage>
        <pub-id pub-id-type="pmid">15103630</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murzin</surname>
            <given-names>AG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures</article-title>
        <source>J. Mol. Biol.</source>
        <year>1995</year>
        <volume>247</volume>
        <fpage>536</fpage>
        <lpage>540</lpage>
        <pub-id pub-id-type="pmid">7723011</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Orengo</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CATH—a hierarchic classification of protein domain structures</article-title>
        <source>Structure</source>
        <year>1997</year>
        <volume>5</volume>
        <fpage>1093</fpage>
        <lpage>1108</lpage>
        <pub-id pub-id-type="pmid">9309224</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Portugaly</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EVEREST: automatic identification and classification of protein domains in all protein sequences</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>277</fpage>
        <pub-id pub-id-type="pmid">16749920</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reeves</surname>
            <given-names>GA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structural diversity of domain superfamilies in the CATH database</article-title>
        <source>J. Mol. Biol.</source>
        <year>2006</year>
        <volume>360</volume>
        <fpage>725</fpage>
        <lpage>741</lpage>
        <pub-id pub-id-type="pmid">16780872</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Protein homology detection by HMM-HMM comparison</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>951</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="pmid">15531603</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Servant</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ProDom: automated clustering of homologous domains</article-title>
        <source>Brief. Bioinform.</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>246</fpage>
        <lpage>251</lpage>
        <pub-id pub-id-type="pmid">12230033</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sim</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PPRODO: prediction of protein domain boundaries using neural networks</article-title>
        <source>Proteins</source>
        <year>2005</year>
        <volume>59</volume>
        <fpage>627</fpage>
        <lpage>632</lpage>
        <pub-id pub-id-type="pmid">15789433</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suyama</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ohara</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>DomCut: prediction of inter-domain linker regions in amino acid sequences</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>673</fpage>
        <lpage>674</lpage>
        <pub-id pub-id-type="pmid">12651735</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Szilagyi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Intra-chain 3D segment swapping spawns the evolution of new multidomain protein architectures</article-title>
        <source>J. Mol. Biol.</source>
        <year>2012</year>
        <volume>415</volume>
        <fpage>221</fpage>
        <lpage>235</lpage>
        <pub-id pub-id-type="pmid">22079367</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tai</surname>
            <given-names>CH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation of domain prediction in CASP6</article-title>
        <source>Proteins</source>
        <year>2005</year>
        <volume>61</volume>
        <issue>Suppl. 7</issue>
        <fpage>183</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="pmid">16187361</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tress</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assessment of predictions submitted for the CASP7 domain prediction category</article-title>
        <source>Proteins</source>
        <year>2007</year>
        <volume>69</volume>
        <issue>Suppl. 8</issue>
        <fpage>137</fpage>
        <lpage>151</lpage>
        <pub-id pub-id-type="pmid">17680686</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dunbrack</surname>
            <given-names>RL</given-names>
          </name>
        </person-group>
        <article-title>PISCES: a protein sequence culling server</article-title>
        <source>Biopolymers</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>1589</fpage>
        <lpage>1591</lpage>
      </element-citation>
    </ref>
    <ref id="btt209-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wheelan</surname>
            <given-names>SJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Domain size distributions can predict domain boundaries</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>613</fpage>
        <lpage>618</lpage>
        <pub-id pub-id-type="pmid">11038331</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ab initio modeling of small proteins by iterative TASSER simulations</article-title>
        <source>BMC Biol.</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>17</fpage>
        <pub-id pub-id-type="pmid">17488521</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>MUSTER: improving protein sequence profile-profile alignments by using multiple sources of structure information</article-title>
        <source>Proteins</source>
        <year>2008</year>
        <volume>72</volume>
        <fpage>547</fpage>
        <lpage>556</lpage>
        <pub-id pub-id-type="pmid">18247410</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>LOMETS: a local meta-threading-server for protein structure prediction</article-title>
        <source>Nucleic Acids. Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>3375</fpage>
        <lpage>3382</lpage>
        <pub-id pub-id-type="pmid">17478507</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>OPUS-Dom: applying the folding-based method VECFOLD to determine protein domain boundaries</article-title>
        <source>J. Mol. Biol.</source>
        <year>2009</year>
        <volume>385</volume>
        <fpage>1314</fpage>
        <lpage>1329</lpage>
        <pub-id pub-id-type="pmid">19026662</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Protein threading using PROSPECT: design and evaluation</article-title>
        <source>Proteins</source>
        <year>2000</year>
        <volume>40</volume>
        <fpage>343</fpage>
        <lpage>354</lpage>
        <pub-id pub-id-type="pmid">10861926</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Protein domain decomposition using a graph-theoretic approach</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>1091</fpage>
        <lpage>1104</lpage>
        <pub-id pub-id-type="pmid">11159328</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yoo</surname>
            <given-names>PD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DomNet: protein domain boundary prediction using enhanced general regression network and new profiles</article-title>
        <source>IEEE Trans. Nanobiosci.</source>
        <year>2008</year>
        <volume>7</volume>
        <fpage>172</fpage>
        <lpage>181</lpage>
      </element-citation>
    </ref>
    <ref id="btt209-B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Template-based modeling and free modeling by I-TASSER in CASP7</article-title>
        <source>Proteins</source>
        <year>2007</year>
        <volume>69</volume>
        <fpage>108</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="pmid">17894355</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Progress and challenges in protein structure prediction</article-title>
        <source>Curr. Opin. Struct. Biol.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>342</fpage>
        <lpage>348</lpage>
        <pub-id pub-id-type="pmid">18436442</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>I-TASSER: Fully automated protein structure prediction in CASP8</article-title>
        <source>Proteins</source>
        <year>2009</year>
        <volume>77</volume>
        <fpage>100</fpage>
        <lpage>113</lpage>
        <pub-id pub-id-type="pmid">19768687</pub-id>
      </element-citation>
    </ref>
    <ref id="btt209-B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Fold recognition by combining sequence profiles derived from evolution and from depth-dependent structural alignment of fragments</article-title>
        <source>Proteins</source>
        <year>2005</year>
        <volume>58</volume>
        <fpage>321</fpage>
        <lpage>328</lpage>
        <pub-id pub-id-type="pmid">15523666</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
