<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7869254</article-id>
    <article-id pub-id-type="publisher-id">3948</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03948-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DRPnet: automated particle picking in cryo-electron micrographs using deep regression</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nguyen</surname>
          <given-names>Nguyen Phuoc</given-names>
        </name>
        <address>
          <email>npntz3@mail.missouri.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ersoy</surname>
          <given-names>Ilker</given-names>
        </name>
        <address>
          <email>ersoyi@health.missouri.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gotberg</surname>
          <given-names>Jacob</given-names>
        </name>
        <address>
          <email>gotbergj@missouri.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bunyak</surname>
          <given-names>Filiz</given-names>
        </name>
        <address>
          <email>bunyak@missouri.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7283-3755</contrib-id>
        <name>
          <surname>White</surname>
          <given-names>Tommi A.</given-names>
        </name>
        <address>
          <email>whiteto@missouri.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.134936.a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2162 3504</institution-id><institution>Department of Electrical Engineering and Computer Science, </institution><institution>University of Missouri, </institution></institution-wrap>Columbia, MO USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.134936.a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2162 3504</institution-id><institution>Institute for Data Science and Informatics, </institution><institution>University of Missouri, </institution></institution-wrap>Columbia, MO USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.134936.a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2162 3504</institution-id><institution>Research Computing Support Services, </institution><institution>University of Missouri, </institution></institution-wrap>Columbia, MO USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.134936.a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2162 3504</institution-id><institution>Department of Biochemistry, </institution><institution>University of Missouri, </institution></institution-wrap>Columbia, MO USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.134936.a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2162 3504</institution-id><institution>Electron Microscopy Core, </institution><institution>University of Missouri, </institution></institution-wrap>Columbia, MO USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>55</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>12</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Identification and selection of protein particles in cryo-electron micrographs is an important step in single particle analysis.
In this study, we developed a deep learning-based particle picking network to automatically detect particle centers from cryoEM micrographs. This is a challenging task due to the nature of cryoEM data, having low signal-to-noise ratios with variable particle sizes, shapes, distributions, grayscale variations as well as other undesirable artifacts.
</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose a double convolutional neural network (CNN) cascade for automated detection of particles in cryo-electron micrographs. This approach, entitled Deep Regression Picker Network or “DRPnet”, is simple but very effective in recognizing different particle sizes, shapes, distributions and grayscale patterns corresponding to 2D views of 3D particles. Particles are detected by the first network, a fully convolutional regression network (FCRN), which maps the particle image to a continuous distance map that acts like a probability density function of particle centers. Particles identified by FCRN are further refined to reduce false particle detections by the second classification CNN. DRPnet’s first CNN pretrained with only a single cryoEM dataset can be used to detect particles from different datasets without retraining. Compared to RELION template-based autopicking, DRPnet results in better particle picking performance with drastically reduced user interactions and processing time. DRPnet also outperforms the state-of-the-art particle picking networks in terms of the supervised detection evaluation metrics recall, precision, and F-measure. To further highlight quality of the picked particle sets, we compute and present additional performance metrics assessing the resulting 3D reconstructions such as number of 2D class averages, efficiency/angular coverage, Rosenthal-Henderson plots and local/global 3D reconstruction resolution.
</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">DRPnet shows greatly improved time-savings to generate an initial particle dataset compared to manual picking, followed by template-based autopicking. Compared to other networks, DRPnet has equivalent or better performance. DRPnet excels on cryoEM datasets that have low contrast or clumped particles. Evaluating other performance metrics, DRPnet is useful for higher resolution 3D reconstructions with decreased particle numbers or unknown symmetry, detecting particles with better angular orientation coverage.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Convolutional neural network</kwd>
      <kwd>Regression</kwd>
      <kwd>Deep learning</kwd>
      <kwd>Electron microscopy</kwd>
      <kwd>Image segmentation</kwd>
      <kwd>Particle picking</kwd>
      <kwd>CryoEM</kwd>
      <kwd>Autopicking</kwd>
      <kwd>Single particle reconstruction</kwd>
      <kwd>Single particle analysis</kwd>
      <kwd>3D reconstruction</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Office of Research, Graduate Studies and Economic Development, University of Missouri (US)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Electron Microscopy Core</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Interdisciplinary Pilot Studies award</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par12">Although high resolution 3D protein structure determination via single particle analysis (also known as single particle reconstruction) using cryo-electron microscopy (cryoEM) is becoming more widely used, it still remains to be a challenging technique because of the resulting noisy and often low contrast micrographs [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. In these cryoEM experiments, a purified, homogeneous protein is vitreously frozen in a thin film of solution to form a glass-like ice, which is then imaged under cryogenic temperatures (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,170\,^\circ \hbox {C}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:mn>170</mml:mn><mml:msup><mml:mspace width="0.166667em"/><mml:mo>∘</mml:mo></mml:msup><mml:mtext>C</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq1.gif"/></alternatives></inline-formula>) in a transmission electron microscope (TEM) [<xref ref-type="bibr" rid="CR3">3</xref>]. Many cryoEM micrographs are collected, with protein “particles” imaged in different orientations in 2D. Many 2D particle views (also known as “projections”) are collected and used to reconstruct an atomic 3D reconstruction [<xref ref-type="bibr" rid="CR4">4</xref>] by iterative alignment, classification and averaging. The resulting micrographs are extremely noisy; the low signal is due to a number of causes—microscope-related aberrations, low doses of electron exposure applied to the radiation sensitive protein specimen [<xref ref-type="bibr" rid="CR5">5</xref>], movement of the specimen upon imaging [<xref ref-type="bibr" rid="CR6">6</xref>], and the process of high resolution image formation in the TEM [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. Thus, the protein particles of interest are sometimes challenging to identify in these 2D cryoEM micrographs, especially certain orientations of the particles (see Fig. <xref rid="Fig1" ref-type="fig">1</xref> for examples and artifacts). Several software solutions have been developed to reconstruct 3D protein structures. These solutions require large numbers of particles to accurately estimate the relative angular orientations of these protein particles in 3D, which is then used to create 3D reconstructions of averaged protein particle structures.<fig id="Fig1"><label>Fig. 1</label><caption><p>Artifacts and challenges in cryoEM images. <bold>a</bold> Low contrast image (EMPIAR-10061) <bold>b</bold> Green region: non-vitreous ice contamination (EMPIAR-10005) <bold>c</bold> Green region: non-vitreous ice contamination; Yellow region: carbon film (EMPIAR-10017) <bold>d</bold> Green region: non-vitreous ice contamination; Overlapped particles (EMPIAR-10017)</p></caption><graphic xlink:href="12859_2020_3948_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par13">One solution, the widely adopted RELION software [<xref ref-type="bibr" rid="CR9">9</xref>], employs a likelihood-based approach and expectation maximization algorithm to determine each protein particle’s orientation, and then classifies and averages those similarly oriented particles together to generate a high resolution 3D reconstruction of the protein’s structure—or a map representing the Coulombic potential [<xref ref-type="bibr" rid="CR10">10</xref>]. RELION’s workflow allows users to manually identify and select (“picking”) particles in 2D cryoEM micrographs; these selected particles are then aligned, classified, and averaged to produce 2D class averages. Suitable 2D class averages are manually selected as templates for automated particle selection (“autopicking”) which assesses correlation of image patches to the template particles [<xref ref-type="bibr" rid="CR11">11</xref>]. We further refer to this as Template Based Autopicking (TBA). After obtaining 2D class average templates from manually picked particles, these software packages rely on two main methods to automatically select particles: template matching by cross-correlation, or pattern recognition by a simple deep neural network. Template matching is sensitive to noise and may suffer from strong bias [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par14">Recent advances in machine learning, specifically in deep learning, have led to great improvements in automated biomedical image analysis [<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref>]. For microscopic image analysis, [<xref ref-type="bibr" rid="CR15">15</xref>] many machine learning approaches have been utilized from support vector machines (SVM) to convolutional neural networks (CNN). A recent study of Shin <italic>et al.</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] has employed deep learning models to learn semantics in MRI scans, and to extract features to detect different organs. Xie [<xref ref-type="bibr" rid="CR17">17</xref>] proposed a novel deep neural network for robust nucleus localization, where, instead of using a pixel-wise classifier or a regressor, they combined CNN with a nonlinear voting transformation. Inspired by the success of these examples, we sought to apply deep learning methods to cryoEM image analysis, specifically to particle picking, which is the most tedious step in most cryoEM image analysis workflows.</p>
    <sec id="Sec2">
      <title>Machine learning applied to cryoEM particle picking</title>
      <p id="Par15">Numerous software solutions to date have implemented deep learning approaches to decrease time involved in manual particle picking, however a robust solution for a majority cryo-EM datasets is lacking due to the variety of reasons (protein shapes and sizes, grayscale variations, particle distributions and clumping, ice thickness differences, crystalline ice contamination, presences of support films, changes in illumination) as observed in cryoEM datasets (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). We provide a brief overview of some of these networks; however an exhaustive list and subsequent descriptions are not appropriate here.</p>
      <p id="Par16">DeepPicker [<xref ref-type="bibr" rid="CR18">18</xref>] is one of the earliest fully automated particle picking tools. It slides a window (box) across the micrographs with a default step size of four pixels to collect candidate image patches. Extracted image patches are normalized and fed into a convolutional neural network to determine whether they belong to a qualified class of particles or not. In the fully automated mode, DeepPicker has a pretrained network to pick particles for the first time as positive training samples. The negative samples are randomly selected far from the positive samples using a spatial distance threshold. The positive and negative samples are then used to train a fresh convolutional network to pick the final particles.</p>
      <p id="Par17">Recently, three particle picking packages using deep learning have gained popularity; TOPAZ [<xref ref-type="bibr" rid="CR19">19</xref>], WARP [<xref ref-type="bibr" rid="CR20">20</xref>] and crYOLO [<xref ref-type="bibr" rid="CR21">21</xref>]. Similar to DeepPicker [<xref ref-type="bibr" rid="CR18">18</xref>], TOPAZ [<xref ref-type="bibr" rid="CR19">19</xref>] is a deep learning-based particle picking software. It examines micrograph patches and uses non-maxima suppression to select the patches with highest scores as the most likely particle instances. One major difference between TOPAZ and typical deep learning pickers is that TOPAZ can be trained with a small number of positive and unlabeled samples, versus of positive and negative samples. WARP [<xref ref-type="bibr" rid="CR20">20</xref>], relies on residual neural network (ResNet) architecture [<xref ref-type="bibr" rid="CR22">22</xref>] that uses skip connections, or shortcuts to jump over some layers for improved performance. WARP was trained with multiple EMPIAR raw and simulated data. As a result, it can pick properly many types of particles and can mask out the artifact regions. WARP also supports network re-training with custom data. crYOLO [<xref ref-type="bibr" rid="CR21">21</xref>] utilizes a general purpose, single-stage, deep object detector YOLO [<xref ref-type="bibr" rid="CR23">23</xref>] to detect particles. YOLO detection is based on a fixed-grid regression method that makes it faster compared to other detection networks [<xref ref-type="bibr" rid="CR24">24</xref>]. crYOLO was trained with 45 datasets and is able to auto-pick particles from previously unseen datasets. Its detection performance was fast, up to five micrographs per second with image dimensions of <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1024 \times 1024$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mn>1024</mml:mn><mml:mo>×</mml:mo><mml:mn>1024</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq2.gif"/></alternatives></inline-formula> pixels [<xref ref-type="bibr" rid="CR21">21</xref>] and reached higher accuracy (recall, precision, and AUC) compared to the original YOLO model when working with small objects as particles.</p>
      <p id="Par18">We present below a deep learning algorithm entitled, Deep Regression Picker network (or “DRPnet”), for greatly improving the time taken to manually select particles from cryoEM micrographs. This solution also seeks to improve the accuracy of particle picking using a cascade of convolutional neural networks—the first uses deep regression to identify particles, the second uses a classification network to remove false positives. This network can be used with no training as demonstrated on multiple datasets or with retraining the second classification network for enhanced performance.</p>
      <p id="Par19">DRPnet was trained on one dataset (EMPIAR-10005 TRPV1), which was then used to pick particles on other datasets (EMPIAR-10061 <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M6"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq3.gif"/></alternatives></inline-formula>-galactosidase, EMPIAR-10017 <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M8"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq4.gif"/></alternatives></inline-formula>-galactosidase). We compare these DRPnet-picked particles to a similar number of particles generated by RELION’s Template Based Autopicking (using a randomized subset of particles that went into the published 3D reconstruction to simulate a “manually picked” template). Using these DRPnet or TBA particles, we generated 3D reconstructions in RELION. We show that compared to RELION’s TBA, DRPnet-picked particles result in consistently more 2D classes, improved orientation angle distributions, and allows small gains in resolution, especially when symmetry is not imposed. Finally, we compare our solution to other deep learning-based particle-picking networks (WARP, TOPAZ, crYOLO, DeepPicker) in terms of recall, precision and F-measure using both the pretrained networks and after retraining their models. Experimental results with the dataset (EMPIAR-10017, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M10"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq5.gif"/></alternatives></inline-formula>-galactosidase) show that DRPnet achieves recall, precision, and F-measures values of 87.7%, 71.1%, and 78.5% respectively. These values are comparable or better than the current state-of-the-art when using the pretrained networks, and DRPnet outperforms the state-of-the-art methods when all the methods are trained with the same dataset and tested on unseen data. DRPnet rivals popular deep-learning cryoEM particle picking algorithms in terms of time and quality, especially compared to manually picked, template-based autopicking, and is freely available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/emcoregit/DRPnet">https://github.com/emcoregit/DRPnet</ext-link>).</p>
    </sec>
  </sec>
  <sec id="Sec3">
    <title>Methods</title>
    <p id="Par20">Inspired by the recent successes of deep learning in object detection [<xref ref-type="bibr" rid="CR25">25</xref>], we set forth to develop a robust and flexible deep learning-based particle picking system that can handle multiple types of data, various particle sizes and shapes/aspect ratios, and different imaging technologies (i.e. direct detectors) with different defocus ranges. Below, we present our deep learning based particle picking framework, Deep Regression Picker Network (DRPnet) illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The proposed system works on multiple types of data (tested on three protein datasets) from various detectors, with improved speeds (testing time is approximately <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 6$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq6.gif"/></alternatives></inline-formula> s/micrograph on Nvidia GTX 1080 GPU with 8GB memory and SSD storage) compared to manual template selection (<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 30$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq7.gif"/></alternatives></inline-formula> min to select 1000 particles) as implemented by RELION. This RELION implementation includes manually selecting particles, then selection of 2D class averages to generate a template, and finding the autopicking parameters which would provide suitable number of particles—from here on, we will refer to this process as RELION’s template-based autopicking (TBA).<fig id="Fig2"><label>Fig. 2</label><caption><p>Cascaded architecture of the Deep Regression Picker Network (DRPnet). <bold>a</bold> Overview of the DRPnet particle picking pipeline. Processing stages from input micrographs to picked particles. <bold>b</bold> Architecture of the Fully Convolutional Regression Network (FCRN) used for initial particle detection. <bold>c</bold> Architecture of the Convolutional Neural Network (CNN) used for filtering/refinement of the detections through binary classification. <bold>d</bold> Evaluation metrics used in this study to assess particle picking performance</p></caption><graphic xlink:href="12859_2020_3948_Fig2_HTML" id="MO2"/></fig></p>
    <sec id="Sec4">
      <title>Deep regression picker network (DRPnet) particle picking pipeline</title>
      <p id="Par21">The particle picking process in DRPnet involves two steps: localization (or detection) and classification (refinement). In classical computer vision, object detection and classification processes often rely on carefully hand-crafted image features and descriptors such as HOG (Histogram of Oriented Gradients) [<xref ref-type="bibr" rid="CR26">26</xref>], SIFT (Scale-Invariant Feature Transform) [<xref ref-type="bibr" rid="CR27">27</xref>], or SURF (Speeded-Up Robust Features) [<xref ref-type="bibr" rid="CR28">28</xref>], etc. that are extracted from image patches. These descriptors are then fed to unsupervised or supervised machine learning models such as SVM (support vector machine), random forests, and neural networks to cluster or to classify those feature vectors. The success of these systems heavily depends on the selected or engineered feature descriptors that may not capture the complexities of the underlying visual patterns unless they can adapt to new patterns.</p>
      <p id="Par22">On the other side, deep learning approaches rely on data itself to learn discriminative features to perform the given task. Convolutional neural networks (CNN), a class of deep learning methods heavily used for image analysis, extract features over multiple convolutional layers with different sizes and different numbers of filters whose coefficients are learned during training. Earlier layers of convolutional networks learn deep features, while later fully connected layers perform the classification or regression tasks. Deep object detection approaches can be coarsely grouped as single-stage and two-stage. Single-stage detectors such as YOLO [<xref ref-type="bibr" rid="CR29">29</xref>] and SSD [<xref ref-type="bibr" rid="CR30">30</xref>] rely on regular dense sampling of objects, scales, and aspect ratios, and perform detection and classification in one step. Two-stage detectors such as FasterRCNN [<xref ref-type="bibr" rid="CR31">31</xref>] and Mask-RCNN [<xref ref-type="bibr" rid="CR32">32</xref>] first produce a sparse set of candidates (region proposals). These candidates are then classified into a number of classes, foreground versus background in our case. Faster-RCNN and Mask-RCNN have shown great performance in detection and classification tasks on image datasets such as Pascal VOC [<xref ref-type="bibr" rid="CR33">33</xref>] and MS COCO [<xref ref-type="bibr" rid="CR34">34</xref>]. However, these models were originally designed to work with larger objects with rich color, texture, and shape features. The features of the benchmark datasets used for training these standard detection networks are quite different when compared to features of cryo-electron micrographs . Unlike objects in these benchmark datasets, cryo-electron micrographs (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>) are grayscale, low contrast (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a), and may contain noise and artifacts caused by factors such as surface ice contamination (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b), support-film edges (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c), or overlapped particles (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d).</p>
      <p id="Par23">In order to overcome the aforementioned issues, we propose the Deep Regression Picker Network (“DRPnet”, Fig. <xref rid="Fig2" ref-type="fig">2</xref>), which is based on the blob detection concept [<xref ref-type="bibr" rid="CR35">35</xref>]. To better support the ability of localization and classification, we have developed a two-stage particle picking pipeline (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). The first stage consists of a fully convolutional regression network (FCRN) designed for particle candidate localization/detection (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b); while the second stage consists of a classification convolutional neural network (CNN) designed to refine the detections (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). While the second stage classification network is a supervised model to classify true versus false positives, training data for this task was collected in an unsupervised manner by using the first stage regression network’s measure of confidence. High and low confidence levels were used as indications for true positives and true negatives respectively. The initial network was trained using the EMPIAR-10005 dataset [<xref ref-type="bibr" rid="CR36">36</xref>]. This scheme allows DRPnet to operate on other datasets automatically from detection through classification. After the initial training with one dataset, the proposed DRPnet system was tested with multiple particles having various sizes, shapes, and distributions from different datasets. We tested 7 datasets from two modalities, (cryoEM versus negative stain) with relatively different particle sizes/pixels without the need for retraining demonstrating the robustness of DRPnet.</p>
    </sec>
    <sec id="Sec5">
      <title>Data preprocessing</title>
      <p id="Par24">In order to ensure optimal performance by both networks, the proposed particle picking pipeline also includes a micrograph preprocessing step to enhance contrast and to correct transmission/illumination artifacts. Illumination (beam centering) and/or electron transmission (transmitted electron signal) can misguide DRPnet’s detection because particle picking significantly relies on intensity of grayscale images. To obtain the best DRPnet detection performance, it was necessary to reduce the influence of illumination/transmission variations. We compute local averages of illumination by applying a low-pass filter with a very large kernel. The corrected intensity value of each pixel is obtained by subtracting local and adding global intensity averages, as in Eq. <xref rid="Equ1" ref-type="">1</xref>:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} I_{new} = I - I_{\sigma } + \frac{1}{n}\sum (I_{\sigma }) \end{aligned}$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3948_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>I</italic> is the original image, <italic>n</italic> is the number of pixels in the image, and <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\sigma }$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>I</mml:mi><mml:mi>σ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq8.gif"/></alternatives></inline-formula> is image smoothed with a Gaussian filter of sigma <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M20"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq9.gif"/></alternatives></inline-formula>, set heuristically according to particle size.</p>
    </sec>
    <sec id="Sec6">
      <title>Deep learning</title>
      <sec id="Sec7">
        <title>Stage 1: Fully convolutional regression network (FCRN)</title>
        <p id="Par25">
          <fig id="Fig3">
            <label>Fig. 3</label>
            <caption>
              <p>Sample training and test images for the proposed DRPnet from selected cryoEM micrographs. <bold>a</bold> A magnified image patch of a TPRV1 particle (scale is 50 Å). <bold>b</bold> Corresponding ground truth training label obtained by applying the distance transform to the binary particle mask, with blue and yellow indicating lower and higher distance values, respectively. <bold>c</bold> Smoothed 2D particle prediction map corresponding to the output of the fully convolutional regression network shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b for a single particle (left) and its 3D visualization (right). <bold>d</bold> Sample cryoEM micrograph input into DRPnet (scale is 885 Å). Yellow box represents the particle shown in <bold>a</bold>. <bold>e</bold> Particle prediction map from C computed by DRPnet for the entire cryoEM micrograph (left), and its 3D visualization with circled area showing a magnified view of the local maxima (right). <bold>f</bold>, <bold>g</bold> Positive (<bold>f</bold>, blue circles) and negative (<bold>g</bold>, yellow circles) particles used to train the classification network shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>c. Positive samples represent true particles, negative samples represent false detections. These positive and negative training samples are selected in an unsupervised way using the prediction confidence values from the fully convolutional regression network depicted in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, with high or low confidence particles corresponding to positive or negative training samples, respectively (scale is 885 Å)</p>
            </caption>
            <graphic xlink:href="12859_2020_3948_Fig3_HTML" id="MO4"/>
          </fig>
        </p>
        <p id="Par26">To address the challenges of automated particle picking, we have treated this task as a blob detection problem - where each particle is assumed to be a roughly convex blob with texture different than the background (Figs. <xref rid="Fig2" ref-type="fig">2</xref>b and <xref rid="Fig3" ref-type="fig">3</xref>a). Additionally, we assume that the dimensions and shapes of particles are relatively similar. Given a rough size estimate, our goal is to locate particle centers. Our proposed model is a Fully Convolutional Regression Network (FCRN), trained to predict particle centers by producing a likelihood map where local maxima correspond to the particle centers (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Given the ground truth particle centers (as provided by the datasets in EMPIAR) along with a particle size estimate, first, binary particle-versus-background masks are produced for the cryo electron micrographs. Then, distance transforms of those binary masks are used as training labels for the proposed FCRN model (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). The distance transform of a binary image is a grayscale map where each pixel’s value represents the distance to the closest boundary. This is calculated at each pixel by the distance to the nearest background pixel. Distance transform values for the foreground regions (or the particles) increase from a particle’s boundary towards the particle’s center, reaching the local maxima at the particle’s center (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b), and the distance transform for the background pixels are set to zero (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, left). The distance transform of the particle mask produces an estimate of the particle center probability map (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, right). This continuous regression model (FCRN), trained with the particle distance transforms, is then used to localize particle centers. This approach is different than deep regression used to estimate object coordinates (i.e. object bounding box coordinates) that is adopted by many deep object detectors such as FasterRCNN [<xref ref-type="bibr" rid="CR31">31</xref>] or YOLO [<xref ref-type="bibr" rid="CR29">29</xref>]. Unlike traditional deep object detectors that regress to a discrete set of coordinates, the proposed network learns to regress to a continuous distance map that acts like a probability density function of particle centers. This regression approach has considerable advantages over direct regression to particle center coordinates: (1) the continuous mapping captures information on not only particle centers, but also on particle shapes; (2) learning to approximate distance transform implicitly regularizes the output making the continuous representation of the particle centers more robust to noise compared to discrete coordinates (which is very important for processing of extremely noisy cryo-EM images). Furthermore, because of its continuous nature, this model also enables localization of an individual particle within a dense cluster, and ensures better scale adaptation, which allows detection of different sized particles without need for retraining the network.</p>
        <p id="Par27">The proposed FCRN has seven layers (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b); one input layer, five convolutional layers, and one max-pooling layer [<xref ref-type="bibr" rid="CR37">37</xref>]. With its simple structure, our approach has smaller computational cost and training data needs, compared to more complex deep learning models such as Fast-RCNN. The proposed network was implemented using the Matlab deep learning toolbox. The network was trained with image patches (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a) from raw micrographs and their associated training labels, centered and cropped on particle regions (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b); their prediction is shown in (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). These image patches are of the same size as the FCRN input layer. The number of patches extracted from each image is equal to the number of selected particles in those images. We used Adam optimizer [<xref ref-type="bibr" rid="CR38">38</xref>] to train this network. Since our network is built without fully connected layers, it does not require fixed size input images. In the testing stage, we directly applied the trained FCRN model to different-sized input images (for example, an entire 2D cryoEM micrograph, Fig. <xref rid="Fig3" ref-type="fig">3</xref>d) to predict associated particle center probability maps (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e, left). Figure <xref rid="Fig3" ref-type="fig">3</xref>e(right) shows the associated 3D visualization.</p>
      </sec>
      <sec id="Sec8">
        <title>Stage 2: Classification network</title>
        <p id="Par28">The first network (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) outputs candidate particle locations, but suffers from false detection. The second convolutional neural network (CNN) refines these particle candidates using a learned keep-or-reject candidate process (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). We extracted two subsets from the particles detected by the first FCRN network, and trained a second two-class classification network using stochastic gradient descent optimization [<xref ref-type="bibr" rid="CR37">37</xref>]. Positive training samples were particles detected with high confidence, then further refined by removing those with low standard deviation of intensity. Negative training samples were particles with low probability scores in the detection map, as well as particles which had a low standard deviation of intensity. Negative particles included patches of background, carbon edges, ice contaminated regions, and weak patterns. Using the second convolutional network, these particles are classified into positive particles (Fig. <xref rid="Fig3" ref-type="fig">3</xref>f) and negative particles (Fig. <xref rid="Fig3" ref-type="fig">3</xref>g). This second classification network learns texture patterns of true particles versus false positives caused by various artifacts, and provides a refinement to the particle detection process in an efficient, unsupervised manner. This network has four convolutional layers each followed by a max-pooling layer [<xref ref-type="bibr" rid="CR37">37</xref>] for feature extraction and two fully connected layers [<xref ref-type="bibr" rid="CR37">37</xref>] to decide whether to pick or discard a particle patch using the learned features.</p>
        <p id="Par29">DRPnet that consists of this cascade of two networks was successfully implemented and tested using Matlab 2018b Image Processing Toolbox, Computer Vision Toolbox, and Deep Learning Toolbox. DRPnet is freely available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/emcoregit/DRPnet">https://github.com/emcoregit/DRPnet</ext-link>.</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>3D reconstruction pipeline</title>
      <p id="Par30">Taking cryoEM datasets available in EMPIAR [<xref ref-type="bibr" rid="CR39">39</xref>], we utilized both DRPnet-particle picking and RELION (v3.0) TBA to generate datasets with similar numbers of particles. For each EMPIAR dataset utilized, RELION requires generation of a manually picked particle set, usually around 1000 particles total. Particles used in our RELION comparison results were generated by randomly selecting a subset (<inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sim }$$\end{document}</tex-math><mml:math id="M22"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq10.gif"/></alternatives></inline-formula> 1000) of particles deposited in EMPIAR that contributed to the final, refined high resolution 3D reconstructions previously published. These randomly selected particles can be considered the “manually picked” particles. These particles were then processed through the standard RELION pipeline (template generation by 2D classification). DRPnet particles were generated as described before. Particles that have a distance to input image edge less than the box size (as defined by the user in DRPnet) are filtered to avoid incomplete detection of particles, Both DRPnet particles and the RELION TBA particles were then processed through RELION 2D classification to identify good 2D class averages (see Fig. <xref rid="Fig3" ref-type="fig">3</xref> in chapter 6 of Methods in Enzymology [<xref ref-type="bibr" rid="CR40">40</xref>]). Then both DRPnet and RELION TBA 2D class averages were further 3D classified (allowing 5 possible classes) using the corresponding deposited, low-resolution (60 Å) filtered 3D reconstruction as the initial model. All good 3D classes were selected and refined to generate the final 3D reconstruction.</p>
    </sec>
    <sec id="Sec10">
      <title>Performance metrics</title>
      <p id="Par31">We used multiple metrics to measure the particle picking performance of the proposed DRPnet pipeline (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). Performance metrics have been poorly defined to assess the output provided by the aforementioned, previously-developed particle picking tools. We sought to provide a battery of metrics which may provide insights into particle picking performance. Most tools involve a manual/visual inspection step of the 2D class averages computed using the picked particles and the resultant 3D reconstructed map. In addition to manual/visual inspection, we have proposed five quantitative particle picking evaluation measures:(1) recall, precision, F-measure, (2) global resolution, (3) local resolution, (4) angular distribution, and (5) Rosenthal and Henderson B-factor plots that are described below.</p>
      <sec id="Sec11">
        <title>Recall, precision, F-measure</title>
        <p id="Par32">Given a dataset with ground truth particle locations, detection performance can be quantitatively evaluated using three supervised metrics, recall, precision, and F-measure, as defined below:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Recall= &amp; {} \frac{TP}{TP+FN} \quad \quad \quad Precision=\frac{TP}{TP+FP} \end{aligned}$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3948_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F= &amp; {} 2\times \frac{Precision \times Recall}{Precision+Recall} \end{aligned}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3948_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where TP, FP, FN refer to true positives, false positives, and false negatives, respectively. These metrics are used to compare the particle detection performance of DRPnet to other state-of-the-art deep-learning based particle picking networks. Also refer to Table <xref rid="Tab1" ref-type="table">1</xref> for the prediction outcomes and confusion matrix.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Prediction outcomes and confusion matrix</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Actual positive</th><th align="left">Actual negative</th></tr></thead><tbody><tr><td align="left">Positive prediction</td><td align="left">TP</td><td align="left">FP</td></tr><tr><td align="left">Negative prediction</td><td align="left">TN</td><td align="left">FN</td></tr></tbody></table></table-wrap></p>
      </sec>
      <sec id="Sec12">
        <title>3D reconstruction global resolution</title>
        <p id="Par33">An evaluation metric we applied to evaluate the performance of particle picking is the final resolution of the 3D reconstruction. In cryo-electron microscopy, we rely on the concept of signal-to-noise ratio (SNR), and measure the internal consistency of the 3D reconstructions generated by autopicked particles (of DRPnet or RELION TBA). Taking advantage of the Fourier transform, correlation between two 3D reconstructions can be represented by a product in Fourier space, and then that product is split into shells by radial frequency to compute Fourier Shell Correlation (FSC; Eq. <xref rid="Equ4" ref-type="">4</xref>) [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR41">41</xref>–<xref ref-type="bibr" rid="CR43">43</xref>].<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} FSC(k,\Delta k) = \frac{{{\mathop {\mathrm{{Real}}}\nolimits } \left( {\sum \nolimits _{(k,\Delta k)} {{F_1}(K){F_2}(K)} } \right) }}{{{{\left( {\sum \nolimits _{(k,\Delta k)} {{{\left| {{F_1}(K)} \right| }^2}{{\left| {{F_2}(K)} \right| }^2}} } \right) }^{1/2}}}} \end{aligned}$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Real</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3948_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <italic>K</italic> represents spatial frequency vector, <inline-formula id="IEq11"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k = |K|$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq11.gif"/></alternatives></inline-formula>, is the magnitude of spatial frequency, <inline-formula id="IEq12"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta K$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq12.gif"/></alternatives></inline-formula> denotes ring width or shell thickness, and <inline-formula id="IEq13"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_1(K), F_2(K)$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq13.gif"/></alternatives></inline-formula> are the Fourier transforms of the two half set reconstructions.</p>
        <p id="Par34">In the 3D reconstruction process, a plot of FSC versus spatial frequency shows that FSC falls off when spatial frequency increases, and the connection between FSC and Spectral Signal to Noise Ratio (SSNR) is explained by [<xref ref-type="bibr" rid="CR44">44</xref>] as following:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} SSNR=\frac{FSC}{1-FSC}, \quad FSC=\frac{SSNR}{SSNR+1} \end{aligned}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">FSC</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>F</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">SSNR</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3948_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>FSC is a biased estimate of SSNR. For a large number of images variance of SSNR is equal to variance of FSC, and the bias is negligible. When FSC is calculated for a data set which is split into two halves, the relationship is:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} SSNR=\frac{2FSC}{1-FSC} \end{aligned}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3948_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>By definition, FSC indicates the consistency of the two 3D reconstructions from particle data. As its relationship with SSNR, FSC is used to identify the resolution of 3D reconstruction. A specific level of FSC correlates to a spatial frequency, and that frequency has a unit of 1/Angstroms (1/Å) which is the inverse of the second measured metric, resolution [<xref ref-type="bibr" rid="CR42">42</xref>]. To avoid overfitting, those two 3D reconstructions should be generated independently from two halves of data. RELION’s 3D refinement uses 0.143 as a cutoff level between signal and noise to evaluate resolution, and this level is also referred as the gold standard. [<xref ref-type="bibr" rid="CR9">9</xref>]<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} FSC = \frac{{\sum {(S + {N_1})(S + {N_2})} }}{{\sum {({S^2} + 2SN + {N^2})} }} \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2020_3948_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <italic>S</italic> denotes the signal and <inline-formula id="IEq14"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N = {N_1} = {N_2}$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq14.gif"/></alternatives></inline-formula> are noise in half datasets.</p>
      </sec>
      <sec id="Sec13">
        <title>3D reconstruction local resolution</title>
        <p id="Par35">The resolution estimated by FSC curve is a global evaluation of the 3D single particle reconstruction. To analyze resolution variations in different 3D map regions, Kucukelbir [<xref ref-type="bibr" rid="CR45">45</xref>] proposed a definition of local resolution. For each voxel, the local resolution is the wavelength of the highest local spatial frequency that is statistically above the noise. The noise level is identified by taking two halves of gold standard 3D map as input to compute both the mean, representing the signal, and the difference between them, representing the noise, as implemented in the software package, ResMap [<xref ref-type="bibr" rid="CR45">45</xref>]. Instead of using ResMap, we applied RELION’s implementation to perform local resolution analysis in our experiment. RELION utilizes a soft spherical mask moved around the entire 3D map to estimate local resolution, which we used as another metric to evaluate 3D reconstructions using DRPnet-picked versus RELION TBA particles.</p>
      </sec>
      <sec id="Sec14">
        <title>Angular distribution</title>
        <p id="Par36">Besides the metrics above, we analyzed the angular distributions recorded in RELION .star files of 3D refinement jobs to understand the differences in orientation of particles picked by DRPnet and RELION TBA. Those angular distributions showed the effect of orientation on resolution and clarified the resolution difference in maps obtained by DRPnet and RELION TBA. We visualized the angular distribution by 2D Hammer projection scatter plots of angular coverage [<xref ref-type="bibr" rid="CR46">46</xref>]. These scatter plots are equivalent to the bild files of RELION’s 3D refinement jobs, and they include the same scale color bars to compare between DRPnet and RELION TBA. Furthermore, we employed efficiency number E<inline-formula id="IEq15"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq15.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR47">47</xref>] to confirm the angular distributions’ effect on structure’s resolution. By using corresponding point spread function, Naydenova and Russo [<xref ref-type="bibr" rid="CR47">47</xref>] computed E<inline-formula id="IEq16"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq16.gif"/></alternatives></inline-formula> to assess how the angular distribution contributes to the reconstruction results. An E<inline-formula id="IEq17"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq17.gif"/></alternatives></inline-formula> value of 0.8 to 1 indicates a good orientation distribution and uniform Fourier space coverage. If the E<inline-formula id="IEq18"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq18.gif"/></alternatives></inline-formula> is lower than 0.5, the lack of particles in angular distribution will cause elongation artifacts in the 3D reconstruction (for example, elongation in an axis that is missing the views).</p>
      </sec>
      <sec id="Sec15">
        <title>Rosenthal and Henderson B-factor plots</title>
        <p id="Par37">As originally proposed by Rosenthal and Henderson [<xref ref-type="bibr" rid="CR48">48</xref>], plotting of the inverse-squared resolution as a function of the number of particles allows us to compare numbers of particles picked with DRPnet or RELION and the effect of particle numbers on 3D reconstruction resolution [<xref ref-type="bibr" rid="CR49">49</xref>]. We used Rosenthal &amp; Henderson B-factor plots as another metric to evaluate the convergence of the 3D reconstructions using DRPnet-picked versus RELION TBA.
</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Results</title>
    <sec id="Sec17">
      <title>Datasets</title>
      <p id="Par38">To demonstrate our network’s ability to pick multiple types of particles, we prepared a pretrained DRPnet model from one cryoEM dataset (TRPV1, EMPIAR-10005 [<xref ref-type="bibr" rid="CR36">36</xref>]) and tested it on other datasets (<inline-formula id="IEq19"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M52"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq19.gif"/></alternatives></inline-formula>-galactosidase, EMPIAR-10017 [<xref ref-type="bibr" rid="CR11">11</xref>], and <inline-formula id="IEq20"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M54"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq20.gif"/></alternatives></inline-formula>-galactosidase, EMPIAR-10061 [<xref ref-type="bibr" rid="CR50">50</xref>]). These cryoEM datasets were selected because of the instrumentation used to collect the data and the existence of a ground truth. They were acquired on a cryo-transmission electron microscope at 300 kV accelerating voltage using either a FEI Titan Krios (EMPIAR-10005 and EMPIAR-10061) or on a FEI Tecnai F30 Polara (EMPIAR-10017). The direct detector, or camera, differed for each dataset. Please see Table <xref rid="Tab2" ref-type="table">2</xref> for a summary of the experimental differences between these cryoEM datasets. The particles picked from these datasets were taken through the RELION 3D reconstruction pipeline and results presented in Figs. <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref>, <xref rid="Fig5" ref-type="fig">5</xref> and <xref rid="Fig6" ref-type="fig">6</xref>. Additional experiments were also performed to show the effectiveness of DRPnet picking on particles of various size, shapes, and embedded in different medias and are shown in the supplementary materials. DRPnet particle picking was performed on in house negatively stained small particles including the apo-form of aldehyde dehydrogenase 7A1 [<xref ref-type="bibr" rid="CR51">51</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3 A-B) and a self-associating Fab fragment, OKT3 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3 C-D). Also included is DRPnet particle picking results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 A-D) of the larger T20S proteasome (EMPIAR-10025 [<xref ref-type="bibr" rid="CR52">52</xref>]) having different particle top and side view shapes.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Experimental datasets from EMPIAR used for DRPnet testing</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Voltage (kV)</th><th align="left">Camera</th><th align="left">Defocus range (<inline-formula id="IEq21"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\upmu$$\end{document}</tex-math><mml:math id="M56"><mml:mi mathvariant="normal">μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq21.gif"/></alternatives></inline-formula>m)</th><th align="left"># Total images</th><th align="left"># Test images</th><th align="left"># Picked particles</th></tr></thead><tbody><tr><td align="left"><p>EMPIAR-10005</p><p>(TRPV1)</p></td><td align="left">300</td><td align="left">Gatan K2</td><td align="left">1.5–3.5</td><td align="left">871</td><td align="left"><p>661</p><p>(subset)</p></td><td align="left">60,000</td></tr><tr><td align="left"><p>EMPIAR-10017</p><p>(<inline-formula id="IEq22"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M58"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq22.gif"/></alternatives></inline-formula>-gal)</p></td><td align="left">300</td><td align="left">FEI Falcon 2</td><td align="left">1.0–3.0</td><td align="left">84</td><td align="left"><p>84</p><p>(full set)</p></td><td align="left">50,000</td></tr><tr><td align="left"><p>EMPIAR-10061</p><p>(<inline-formula id="IEq23"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M60"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq23.gif"/></alternatives></inline-formula>-gal)</p></td><td align="left">300</td><td align="left"><p>Gatan K2</p><p>Summit GIF K2</p></td><td align="left">0.6–3.0</td><td align="left">1538</td><td align="left"><p>661</p><p>(subset)</p></td><td align="left">60,000</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec18">
      <title>Network training on the EMPIAR-10005 (TRPV1) dataset</title>
      <p id="Par39">The first network of the proposed DRPnet cascade is FCRN (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) that is responsible for particle candidate detection. We have trained the FCRN network with a subset of the TRPV1 dataset (EMPIAR-10005), using 50 TRPV1 micrographs and 9751 ground truth particles extracted from the deposited coordinates used for the high resolution 3D reconstruction [<xref ref-type="bibr" rid="CR36">36</xref>]. Image dimensions for these cryoEM micrographs were <inline-formula id="IEq24"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3710\times 3710$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mn>3710</mml:mn><mml:mo>×</mml:mo><mml:mn>3710</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq24.gif"/></alternatives></inline-formula> pixels, pixel size was 1.2156 Å and the TRPV1 particles are 100 Å x 110 Å x 110 Å. We scaled down the images by <inline-formula id="IEq25"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\times$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq25.gif"/></alternatives></inline-formula> and used a box size of <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$64\times 64$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mn>64</mml:mn><mml:mo>×</mml:mo><mml:mn>64</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq26.gif"/></alternatives></inline-formula> pixels to extract particle patches. Using the deposited particle coordinates, first binary particle masks were generated, then distance transform of those masks were calculated (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b) and used to train the FCRN network. The second network of the proposed DRPnet cascade, a classification CNN (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c), was trained to detect positive or negative training samples (Fig. <xref rid="Fig3" ref-type="fig">3</xref>g, h) using the output of the first FCRN network.</p>
    </sec>
    <sec id="Sec19">
      <title>Network testing on EMPIAR-deposited datasets</title>
      <sec id="Sec20">
        <title>EMPIAR-10005 (TRPV1) testing</title>
        <p id="Par40">In order to validate the pretrained DRPnet model described above, we tested it on a set of 661 TRPV1 micrographs collected on a Gatan K2 direct detector. TRPV1 micrographs have low contrast, and some micrographs do not contain any particles. To detect the particle candidates, we set the first network (FCRN) parameters at normal detection levels (<inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {sigma} = 9$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mtext>sigma</mml:mtext><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq27.gif"/></alternatives></inline-formula>, <inline-formula id="IEq28"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {threshold} = 2\times 5$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mtext>threshold</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq28.gif"/></alternatives></inline-formula>). Positive and negatives training samples for the second network were selected using the parameter sets <inline-formula id="IEq29"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {sigma} = 9$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mtext>sigma</mml:mtext><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq29.gif"/></alternatives></inline-formula>, <inline-formula id="IEq30"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {threshold} = 3\times 5$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mtext>threshold</mml:mtext><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {sigma} = 9$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mtext>sigma</mml:mtext><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq31.gif"/></alternatives></inline-formula>, <inline-formula id="IEq32"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {threshold} = 1\times 5$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mtext>threshold</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq32.gif"/></alternatives></inline-formula> respectively. As a result of this process, DRPnet picked 61,282 particles. In order to pick similar numbers of particles, we set the parameters of the RELION TBA to <inline-formula id="IEq33"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {sigma} = 1$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mtext>sigma</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {threshold} = 0.475$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mtext>threshold</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.475</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq34.gif"/></alternatives></inline-formula>.</p>
        <p id="Par41">Picking similar particle quantities ensures a fair comparison between DRPnet and RELION TBA. As has been seen from the Rosenthal-Henderson plots [<xref ref-type="bibr" rid="CR48">48</xref>] particle quantity effects final 3D reconstruction resolution, but limited by the Nyquist frequency of the data or the flexibility of the protein particle. For each image, the number of true particles is fixed while the number of picked particles varies depending on the threshold. If the set threshold is high, the picking program is likely not to detect all true particles. Conversely, if the set threshold is low, the picking program will pick more false positives (noisy artifacts such as ice contamination, carbon edges, or overlapped particles see Fig. <xref rid="Fig3" ref-type="fig">3</xref>). These two cases degrade the quality of 2D image patches thus consequently the resolution of 3D reconstruction. It is necessary to clarify the definition of threshold as used by RELION and how it differs in DRPnet. RELION’s thresholding uses cross-correlation to compare image patches to a set of particle templates. This threshold is used to judge similarity of image patches to the particle template set. DRPnet uses distance transform map as a probability density function of particle centers. In DRPnet, threshold is used to determine if there is enough evidence for a particle at a particular location utilizing the distance transform map.</p>
        <p id="Par42">The template-matching based particle picking function in RELION requires manual picking of about a thousand particles by expert users. The process is not only time consuming but also potentially subjective and biased. Our goal is not to improve performance against expert selected template-based picking, rather to achieve comparable results in a fully automated fashion that is faster and unbiased.</p>
        <p id="Par43">Given these parameters, RELION TBA picked 61,599 particles To perform the subsequent jobs, we extracted particles with box size <inline-formula id="IEq35"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$200\times 200$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mn>200</mml:mn><mml:mo>×</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq35.gif"/></alternatives></inline-formula> pixels without image scaling. Taking both sets of picked particles forward through the RELION 3.0 pipeline, we selected 23,147 good particles picked by DRPnet and 22,830 good particles picked by RELION TBA to generate the 3D reconstruction.</p>
        <p id="Par44">Figure <xref rid="Fig4" ref-type="fig">4</xref> presents detailed evaluation of particle picking performance by the proposed DRPnet network versus the RELION TBA on the EMPIAR-10005 (TRPV1) dataset. Figure <xref rid="Fig4" ref-type="fig">4</xref>a, b shows picked particles on a sample micrograph. As discussed in the “Methods” section, it is observed that DRPnet can successfully pick particles in dense groups, within close proximity of each other. When fed to the RELION processing pipeline, particles picked by DRPnet result in more “good” 2D class averages classes, (49 classes, Fig. <xref rid="Fig4" ref-type="fig">4</xref>c) compared to particles picked by RELION (32 classes, Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). We also studied the angular distribution of the picked particles using angular coverage plots (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e, f). In these plots, appearing views are indicated by dots on the 2D Hammer projection surface. The number of each view is proportional with size and color of corresponding dot. The angular coverage plots show that the distribution of DRPnet particle orientations (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e, see also “Number of Views” in Table <xref rid="Tab3" ref-type="table">3</xref>) were more distributed and numerous compared to those picked with RELION TBA (Fig. <xref rid="Fig4" ref-type="fig">4</xref>f). This result also agreed with the efficiency number E<inline-formula id="IEq36"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq36.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR47">47</xref>] reported in Table <xref rid="Tab3" ref-type="table">3</xref>, with DRPnet having a E<inline-formula id="IEq37"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq37.gif"/></alternatives></inline-formula> of 0.57 while RELION had E<inline-formula id="IEq38"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq38.gif"/></alternatives></inline-formula> of 0.51. Without imposing symmetry on the TRPV1 3D reconstructions (Table <xref rid="Tab3" ref-type="table">3</xref>, indicated with parentheses), we note that DRPnet’s picked particles had improvements in angular coverage, which was further corroborated with improved E<inline-formula id="IEq39"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq39.gif"/></alternatives></inline-formula>, as well as improved 3D reconstruction resolution generated with decreasing numbers of particles (Fig. <xref rid="Fig4" ref-type="fig">4</xref>g, solid lines) when comparing to the same measurements from RELION TBA. Upon imposing symmetry (C4) for the final TRPV1 3D reconstructions using approximately 20,000 particles (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b), the resolution of 3D reconstructions from both DRPnet &amp; RELION TBA particles were 3.9 Å (Table <xref rid="Tab3" ref-type="table">3</xref>, and Fig. <xref rid="Fig4" ref-type="fig">4</xref>g). The C4 symmetrized 3D reconstructions also didn’t show noticeable differences (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a, b) nor did their Fourier Shell Correlations (Fig. <xref rid="Fig7" ref-type="fig">7</xref>c). The particles picked by the fully automated DRPnet pipeline were able to generate similar resolutions in symmetrized 3D reconstructions compared to interactive RELION TBA but at much faster speeds. DRPnet testing time was approximately <inline-formula id="IEq40"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 6$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq40.gif"/></alternatives></inline-formula> s/micrograph onNvidia GTX 1080 GPU with 8GB memory and SSD storage. Whereas manual template selection in RELION took approximately <inline-formula id="IEq41"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim 30$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq41.gif"/></alternatives></inline-formula> mins for 1000 particles. DRPnet also increased angular coverage (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e) and increased good 2D class averages (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c), resulting in improved efficiency (Table <xref rid="Tab3" ref-type="table">3</xref>) and improved resolution without symmetry, even with low particle numbers (500) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>g). These features are particularly helpful in structure determination when a dataset is lacking particle numbers or has an unknown symmetry.<fig id="Fig4"><label>Fig. 4</label><caption><p>Particle picking results on EMPIAR-10005 (TRPV1) dataset. A representative cryoEM micrograph and picked particles (yellow circles) by DRPnet (<bold>a</bold>) and RELION TBA (<bold>b</bold>) (scale is 500 Å). All picked particles were classified using RELION to select quality 2D class averages as displayed for DRPnet (<bold>c</bold>) and RELION (<bold>d</bold>). The angular distributions were determined during 3D reconstruction and are displayed in angular coverage plots for DRPnet (<bold>e</bold>) and RELION (<bold>f</bold>). The range of the color bar is from 1 view (blue) to 600 views (yellow). Note, better angular coverage is delineated by increased views for DRPnet-picked particles. (<bold>g</bold>) Rosenthal and Henderson B-factor plot shows the relationship between number of particles and the global resolution of the 3D reconstruction</p></caption><graphic xlink:href="12859_2020_3948_Fig4_HTML" id="MO11"/></fig><table-wrap id="Tab3"><label>Table 3</label><caption><p>Summary table of results using DRPnet and RELION TBA (values in parentheses were obtained without imposing symmetry)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left" colspan="2">EMPIAR-10005</th><th align="left" colspan="2">EMPIAR-10061</th><th align="left" colspan="2">EMPIAR-10017</th></tr><tr><th align="left">Program</th><th align="left">DRPnet</th><th align="left">RELION</th><th align="left">DRPnet</th><th align="left">RELION</th><th align="left">DRPnet</th><th align="left">RELION</th></tr></thead><tbody><tr><td align="left"># Picked particles</td><td align="left">61,282</td><td align="left">61,599</td><td align="left">60,267</td><td align="left">61,597</td><td align="left">49,604</td><td align="left">49,855</td></tr><tr><td align="left"># Selected particles</td><td align="left">23,147</td><td align="left">22,830</td><td align="left">49,582</td><td align="left">49,570</td><td align="left">41,914</td><td align="left">40,669</td></tr><tr><td align="left" rowspan="2"># Angular views (in total 12,288)</td><td align="left">2105</td><td align="left">1907</td><td align="left">3092</td><td align="left">3000</td><td align="left">3103</td><td align="left">3034</td></tr><tr><td align="left">(4481)</td><td align="left">(3697)</td><td align="left">(8269)</td><td align="left">(7968)</td><td align="left">(10,038)</td><td align="left">(9876)</td></tr><tr><td align="left" rowspan="2">Efficiency E<inline-formula id="IEq42"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq42.gif"/></alternatives></inline-formula></td><td align="left">0.57</td><td align="left">0.51</td><td align="left">0.82</td><td align="left">0.80</td><td align="left">0.69</td><td align="left">0.69</td></tr><tr><td align="left">(0.47)</td><td align="left">(0.32)</td><td align="left">(0.76)</td><td align="left">(0.74)</td><td align="left">(0.70)</td><td align="left">(0.70)</td></tr><tr><td align="left" rowspan="2">Resolution (Å)</td><td align="left">3.9</td><td align="left">3.9</td><td align="left">2.8</td><td align="left">2.8</td><td align="left">4.2</td><td align="left">4.3</td></tr><tr><td align="left">(6.6)</td><td align="left">(6.8)</td><td align="left">(3.0)</td><td align="left">(3.1)</td><td align="left">(4.7)</td><td align="left">(5.1)</td></tr><tr><td align="left" rowspan="2">Local resolution (Å)</td><td align="left">3.6</td><td align="left">3.7</td><td align="left">2.8</td><td align="left">2.8</td><td align="left">3.9</td><td align="left">4.0</td></tr><tr><td align="left">(6.7)</td><td align="left">(6.9)</td><td align="left">(3.5)</td><td align="left">(3.7)</td><td align="left">(5.8)</td><td align="left">(6.0)</td></tr></tbody></table></table-wrap></p>
        <p id="Par45">Next, we performed testing with two other datasets to verify that the proposed DRPnet particle picking network trained with TRPV1/EMPIAR-10005 could not only select particles with diversified shapes quickly, but also select particles with improved angular coverage correlating with a resulting higher resolution 3D reconstruction.</p>
      </sec>
      <sec id="Sec21">
        <title>EMPIAR-10061 (<inline-formula id="IEq43"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M100"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq43.gif"/></alternatives></inline-formula>-galactosidase) testing</title>
        <p id="Par46">In the second test, we picked particles from 661 selected micrographs from the EMPIAR-10061 dataset of <inline-formula id="IEq44"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M102"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq44.gif"/></alternatives></inline-formula>-galactosidase. <inline-formula id="IEq45"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M104"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq45.gif"/></alternatives></inline-formula>-galactosidase has a less compact more elongated shape (dimensions 180 Å x 140 Å x 87 Å) as compared to TRPV1/EMPIAR-10005 used for training. This high resolution dataset was collected with minimal defocus and at high magnification (pixel size of 0.3185Å) on an Gatan K2 energy-filtered direct detector (size of <inline-formula id="IEq46"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$7676\times 7420$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mn>7676</mml:mn><mml:mo>×</mml:mo><mml:mn>7420</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq46.gif"/></alternatives></inline-formula> pixels), which resulted in extremely low particle contrast (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). To pick particles from this dataset using DRPnet, the detection levels (<inline-formula id="IEq47"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {sigma} = 1$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mtext>sigma</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq47.gif"/></alternatives></inline-formula>, <inline-formula id="IEq48"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {threshold} = 1\times 0.01$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mtext>threshold</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq48.gif"/></alternatives></inline-formula>) and scale factor of 1/8 were set as input parameters. DRPnet second classification CNN (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c) was retrained with positive samples composed of subset of detected particles by the DRPnet FCRN network having high standard deviations (<inline-formula id="IEq49"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {s} &gt; 0.25$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>&gt;</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq49.gif"/></alternatives></inline-formula>) and negative samples as a subset of detected particles having low standard deviation (<inline-formula id="IEq50"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {s} &lt; 0.25$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>&lt;</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq50.gif"/></alternatives></inline-formula>). Note that the first CNN (FCRN detection network) was not retrained. Only the second CNN (refinement network) was retrained. Labeled training data for the second CNN was generated in an unsupervised manner, without need for any external annotation, by thresholding the output of the first CNN. DRPnet picked 60,267 particles from the EMPIAR-10061 micrographs (Table <xref rid="Tab3" ref-type="table">3</xref> and Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). To obtain similar number of particles, for RELION TBA, we selected <inline-formula id="IEq51"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {sigma} = 1.2$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mtext>sigma</mml:mtext><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq51.gif"/></alternatives></inline-formula> and <inline-formula id="IEq52"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {threshold} = 0.15$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mtext>threshold</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq52.gif"/></alternatives></inline-formula> and picked 61,597 particles (Table <xref rid="Tab3" ref-type="table">3</xref> and Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). All subsequent jobs were performed in RELION 3.0, including extraction, classification and refinement. We used a binning factor of 2, a box size of <inline-formula id="IEq53"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$384\times 384$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mn>384</mml:mn><mml:mo>×</mml:mo><mml:mn>384</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq53.gif"/></alternatives></inline-formula> pixels and a pixel size of 0.637 Å. During the 3D structure refinement step, we kept 49,592 and 49,570 good particles from DRPnet and RELION TBA, respectively (Table <xref rid="Tab3" ref-type="table">3</xref>), and once again noted more 2D classes for DRPnet (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c) versus RELION TBA (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d). The reported resolution of the resulting 3D reconstructions were 2.8 Å for DRPnet and RELION (Table <xref rid="Tab3" ref-type="table">3</xref>) using D2 symmetry. Although the 3D reconstruction FSC global resolutions were similar, Fig. <xref rid="Fig5" ref-type="fig">5</xref>e, f illustrate the angular distribution of particles picked from the EMPIAR-10061 dataset (<inline-formula id="IEq54"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M122"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq54.gif"/></alternatives></inline-formula>-galactosidase). The plots of angular coverage show that the particles of DRPnet (Fig. <xref rid="Fig5" ref-type="fig">5</xref>e, f) represented more views than particles of RELION TBA (Table <xref rid="Tab3" ref-type="table">3</xref>). This result also agreed with an improved efficiency factor (E<inline-formula id="IEq55"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq55.gif"/></alternatives></inline-formula> in Table <xref rid="Tab3" ref-type="table">3</xref>). To visualize all views picked by either DRPnet or RELION TBA, no symmetry (C1) was imposed and the corresponding C1 values are listed in parentheses in Table <xref rid="Tab3" ref-type="table">3</xref>. DRPnet shows that more views were picked in C1, having improved E<inline-formula id="IEq56"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq56.gif"/></alternatives></inline-formula> and resolution than RELION TBA. Looking at the resolution imposing two-fold (D2) symmetry, DRPnet had E<inline-formula id="IEq57"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq57.gif"/></alternatives></inline-formula> of 0.82 while RELION had E<inline-formula id="IEq58"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq58.gif"/></alternatives></inline-formula> of 0.80. Finally, a Rosenthal and Henderson B-factor plot (Fig. <xref rid="Fig5" ref-type="fig">5</xref>g) shows that when the number of EMPIAR-10061 particles increase from 1200 to 38,000 particles, the 3D reconstruction from DRPnet’s particles yield higher resolutions compared to RELION TBA’s—both with and without symmetry.<fig id="Fig5"><label>Fig. 5</label><caption><p>Particle picking results on EMPIAR-10061 (<inline-formula id="IEq59"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M132"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq59.gif"/></alternatives></inline-formula>-galactosidase): A representative cryoEM micrograph and picked particles (yellow circles) by DRPnet (<bold>a</bold>) and RELION (<bold>b</bold>) (scale is 300 Å). All picked particles were classified using RELION to select quality 2D class averages as displayed for DRPnet (<bold>c</bold>) and RELION (<bold>d</bold>). The angular distributions were determined during 3D reconstruction and are displayed in angular coverage plots for DRPnet (<bold>e</bold>) and RELION (<bold>f</bold>). The range of the color bar is from 1 view (blue) to 700 views (yellow). Note, better angular coverage is delineated by increased views for DRPnet-picked particles. (<bold>g</bold>) Rosenthal and Henderson B-factor plot shows the relationship between number of particles and the global resolution of the 3D reconstruction</p></caption><graphic xlink:href="12859_2020_3948_Fig5_HTML" id="MO12"/></fig></p>
      </sec>
      <sec id="Sec22">
        <title>EMPIAR-10017 (<inline-formula id="IEq60"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M134"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq60.gif"/></alternatives></inline-formula>-galactosidase) testing</title>
        <p id="Par47">After testing DRPnet particle picking on the EMPIAR-10005 (TRPV1) and EMPIAR-10061 (<inline-formula id="IEq61"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M136"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq61.gif"/></alternatives></inline-formula>-galactosidase) datasets, we conducted the third test on the all micrographs in the deposited EMPIAR-10017 (<inline-formula id="IEq62"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M138"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq62.gif"/></alternatives></inline-formula>-galactosidase) dataset. Note, these <inline-formula id="IEq63"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M140"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq63.gif"/></alternatives></inline-formula>-galactosidase protein particles are the same as the previous test, however with different data collection conditions. This dataset was collected on an older generation cryo-transmission electron microscope (FEI F30 Tecnai Polara) and a different direct detector (FEI Falcon II), having an image size of <inline-formula id="IEq64"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4096\times 4096$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mn>4096</mml:mn><mml:mo>×</mml:mo><mml:mn>4096</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq64.gif"/></alternatives></inline-formula> pixels and a pixel size of 1.77 Å. We set DRPnet to detect particles at picking level (sigma = 7, threshold = <inline-formula id="IEq65"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\times 7$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq65.gif"/></alternatives></inline-formula>), and selected training samples for classification at positive level (sigma = 16, threshold = <inline-formula id="IEq66"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\times 7.5$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>7.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq66.gif"/></alternatives></inline-formula>) and negative level (sigma = 12.5, threshold = <inline-formula id="IEq67"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\times 5$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq67.gif"/></alternatives></inline-formula>) to pick 49,604 particles (Table <xref rid="Tab3" ref-type="table">3</xref> and Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). RELION TBA parameters were set to pick 49,855 particles (Table <xref rid="Tab3" ref-type="table">3</xref> and Fig. <xref rid="Fig6" ref-type="fig">6</xref>b). Those particles were extracted with a box size of <inline-formula id="IEq68"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$200\times 200$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mn>200</mml:mn><mml:mo>×</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq68.gif"/></alternatives></inline-formula> pixels at original scale for 3D map reconstruction. Unlike the EMPIAR-10005 and EMPIAR-10061 datasets, whose ground truth particle sets consist of only selected good particles, the ground truth provided for the EMPIAR-10017 dataset consists of particles manually picked by an expert [<xref ref-type="bibr" rid="CR11">11</xref>] and covers almost all the particles in the associated micrographs. Because of this fact, for the EMPIAR-10017 dataset, we were able to evaluate the reconstruction outcome of the picked particles, and directly evaluate their detection performance using Recall, Precision, and F-measure metrics. Table <xref rid="Tab4" ref-type="table">4</xref> shows that while RELION TBA results achieved recall, precision, and F-measure values of 73.4 %, 59.9 %, and 65.9 % respectively, the proposed DRPnet system achieved recall, precision, and F-measure values of 87.7 %, 71.1 %, and 78.5 %; a considerable improvement of more than 10% in each metric.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Particle picking results on EMPIAR-10017 (<inline-formula id="IEq69"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M152"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq69.gif"/></alternatives></inline-formula>-galactosidase): A representative cryoEM micrograph and picked particles (yellow circles) by DRPnet (<bold>a</bold>) and RELION (<bold>b</bold>) (scale is 500 Å). All picked particles were classified using RELION to select good 2D class averages as shown for DRPnet (<bold>c</bold>) and RELION (<bold>d</bold>). The angular distributions were determined during 3D reconstruction and are displayed in angular coverage plots for DRPnet (<bold>e</bold>) and RELION (<bold>f</bold>). The range of the color bar is from 1 view (blue) to 200 views (yellow). Note, better angular coverage is delineated by increased views for DRPnet-picked particles. (<bold>g</bold>) Rosenthal and Henderson B-factor plot shows the relationship between number of particles and the global resolution of the 3D reconstruction</p></caption><graphic xlink:href="12859_2020_3948_Fig6_HTML" id="MO13"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><p>Single particle analysis 3D reconstruction outcomes. Left and middle columns compare the superimposed 3D reconstructions rendered as isosurfaces colored to represent local resolution variations generated from DRPnet-picked (<bold>a</bold>, <bold>d</bold>, <bold>g</bold>) or RELION template-based picked particles (<bold>b</bold>, <bold>e</bold>, <bold>h</bold>), respectively. The 3D reconstruction isosurfaces are colored such that higher resolution regions are colored in blue, and red represents less well-resolved regions (see color scale on left). The right column (<bold>c</bold>, <bold>f</bold>, <bold>i</bold>) contains corresponding masked Fourier Shell Correlation curves for 3D reconstructions, performed with or without symmetry, using DRPnet-picked or RELION TBA, with horizontal line indicating the gold standard (0.143) FSC cutoff. The top row shows 3D reconstructions from EMPIAR-10005 (TRPV1) , the middle row from EMPIAR-10061 (<inline-formula id="IEq70"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M154"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq70.gif"/></alternatives></inline-formula>-galactosidase) and last row from EMPIAR-10017 (<inline-formula id="IEq71"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M156"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq71.gif"/></alternatives></inline-formula>-galactosidase)</p></caption><graphic xlink:href="12859_2020_3948_Fig7_HTML" id="MO14"/></fig><table-wrap id="Tab4"><label>Table 4</label><caption><p>Recall, precision and F-measure for the proposed automated particle picking pipeline evaluated on EMPIAR-10017 (<inline-formula id="IEq72"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M158"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq72.gif"/></alternatives></inline-formula>-galactosidase) versus other state-of-the-art pickers</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model training</th><th align="left">Program</th><th align="left">Version</th><th align="left"># Picked particles</th><th align="left">Recall (%)</th><th align="left">Precision (%)</th><th align="left">F-measure (%)</th></tr></thead><tbody><tr><td align="left" rowspan="6">Pretrained</td><td align="left">DRPnet</td><td align="left">1</td><td char="." align="char">49,604</td><td char="." align="char"><italic>87.7</italic></td><td char="." align="char">71.1</td><td char="." align="char"><italic>78.5</italic></td></tr><tr><td align="left">RELION</td><td align="left">3.0</td><td char="." align="char">49,855</td><td char="." align="char">73.4</td><td char="." align="char">59.9</td><td char="." align="char">65.9</td></tr><tr><td align="left">WARP</td><td align="left">1.0.9</td><td char="." align="char">46,438</td><td char="." align="char">83.9</td><td char="." align="char"><italic>73.6</italic></td><td char="." align="char">78.4</td></tr><tr><td align="left">TOPAZ</td><td align="left">cryoSPARC 2.14.2</td><td char="." align="char">51,749</td><td char="." align="char">83.4</td><td char="." align="char">64.9</td><td char="." align="char">73.0</td></tr><tr><td align="left">crYOLO(*)</td><td align="left">1.7.5</td><td char="." align="char">49,329</td><td char="." align="char"><bold>90.9</bold></td><td char="." align="char"><bold>74.8</bold></td><td char="." align="char"><bold>82.1</bold></td></tr><tr><td align="left">DeepPicker</td><td align="left">1</td><td char="." align="char">40,880</td><td char="." align="char">26.5</td><td char="." align="char">26.4</td><td char="." align="char">26.5</td></tr><tr><td align="left" rowspan="6"><p>Trained from scratch with</p><p>TRPV1 (EMPIAR-10005)</p></td><td align="left">DRPnet</td><td align="left">1</td><td char="." align="char">49,604</td><td char="." align="char"><bold>87.7</bold></td><td char="." align="char"><bold>71.1</bold></td><td char="." align="char"><bold>78.5</bold></td></tr><tr><td align="left">RELION</td><td align="left">3.0</td><td char="." align="char">49,855</td><td char="." align="char">73.4</td><td char="." align="char">59.9</td><td char="." align="char">65.9</td></tr><tr><td align="left">WARP</td><td align="left">1.0.9</td><td char="." align="char">49,209</td><td char="." align="char"><italic>85.0</italic></td><td char="." align="char"><italic>69.7</italic></td><td char="." align="char"><italic>76.6</italic></td></tr><tr><td align="left">TOPAZ</td><td align="left">cryoSPARC 2.14.2</td><td char="." align="char">48,208</td><td char="." align="char">72.3</td><td char="." align="char">60.7</td><td char="." align="char">66.1</td></tr><tr><td align="left">crYOLO</td><td align="left">1.7.5</td><td char="." align="char">49,742</td><td char="." align="char">59.2</td><td char="." align="char">48.2</td><td char="." align="char">53.1</td></tr><tr><td align="left">DeepPicker</td><td align="left">1</td><td char="." align="char">40,205</td><td char="." align="char">23.3</td><td char="." align="char">23.6</td><td char="." align="char">23.5</td></tr></tbody></table><table-wrap-foot><p>The best scoring is indicated in bold and the second-best in italics</p><p>*The pretrained model of crYOLO made available by its developers was trained with a training set that included our test set while training sets for all other pickers did not include particles from the test set</p></table-wrap-foot></table-wrap></p>
        <p id="Par48">With the total number of picked particles around 50,000 particles from each algorithm, using RELION’s 3D reconstruction pipeline, we performed 2D classification to identify particles sorting into well-defined 2D class averages. Visually, we selected only good 2D class averages for further 3D classification, selecting the best for 3D refinement and reconstruction. The number of good particles sorting into defined 2D class averages corresponding to either DRPnet’s pick or RELION TBA are 41,914 or 40,669, respectively (Table <xref rid="Tab3" ref-type="table">3</xref>). Again we note the increased number of 2D classes output for DRPnet (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c) versus RELION TBA (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). Our experiment shows that map generated from DRPnet-identified particles had a resolution of 4.2 Å while RELION structure had a resolution of 4.3 Å. Figure <xref rid="Fig6" ref-type="fig">6</xref>e, f illustrate the angular coverage of particles picked from dataset EMPIAR-10017 (<inline-formula id="IEq73"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M160"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq73.gif"/></alternatives></inline-formula>-galactosidase). These plots show that the particles of DRPnet improved angular coverage than particles from RELION TBA. With symmetry imposed (D2), Table <xref rid="Tab3" ref-type="table">3</xref> shows DRPnet covers 3103 views while RELION TBA has 3034 views. Without symmetry (C1), DRPnet increases to 162 views (see Table <xref rid="Tab3" ref-type="table">3</xref>). Both DRPnet and RELION TBA’s particles had the same efficiency E<inline-formula id="IEq74"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq74.gif"/></alternatives></inline-formula> of 0.69 with two fold symmetry (D2), and 0.70 without symmetry (C1). The Rosenthal and Henderson B-factor plot in Fig. <xref rid="Fig6" ref-type="fig">6</xref>g shows that when the number of EMPIAR-10017 particles increase from 1200 to 38,400 particles, the resolution of DRPnet’s 3D reconstruction was improved compared to RELION TBA, especially in case of no symmetry (C1).</p>
        <p id="Par49">In Fig. <xref rid="Fig7" ref-type="fig">7</xref>, we display local and global (Fourier Shell Correlation cutoff of 0.143) 3D reconstruction resolution results for EMPIAR-10005 (TRPV1) in the first row (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a–c), EMPIAR-10061 in the second row(<inline-formula id="IEq75"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M164"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq75.gif"/></alternatives></inline-formula>-galactosidase) (Fig. <xref rid="Fig7" ref-type="fig">7</xref>d–f), and EMPIAR-10017 in the last row (<inline-formula id="IEq76"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M166"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq76.gif"/></alternatives></inline-formula>-galactosidase) (Fig. <xref rid="Fig7" ref-type="fig">7</xref>g–i). The 3D reconstructions generated from DRPnet- (left, Fig. <xref rid="Fig7" ref-type="fig">7</xref>a, d, g) and RELION- (middle, Fig. <xref rid="Fig7" ref-type="fig">7</xref>b, e, h) picked particles are rendered as isosurfaces, contoured at the same level using the UCSF Chimera visualization software [<xref ref-type="bibr" rid="CR53">53</xref>]. The detailed differences of resolution between 3D reconstructions from DRPnet-picked particles and RELION TBA particles are shown using a local resolution-based color-scheme with blue representing areas with higher resolution, red with lower resolutions. DRPnet-picked 3D reconstructions show increased local-resolution compared to RELION TBA’s 3D reconstructions, indicating an overall improved particle orientation and alignment. The local resolution ranges of those maps for EMPIAR-10005 are 3.6–6.7 Å (by DRPnet) and 3.7–6.9 Å (by RELION TBA), for EMPIAR-10061 are 2.8–3.5 Å (by DRPnet) and 2.8–3.7 Å (by RELION TBA), and for EMPIAR-10017 are 3.9–5.8 Å (by DRPnet) and 4.0–6.0 Å (by RELION TBA). The masked FSC curves produced by RELION’s post-processing task are shown (Fig. <xref rid="Fig7" ref-type="fig">7</xref>c, f, i), with and without imposing symmetry, for both DRPnet-picked and RELION TBA’s particles. The DRPnet-picked 3D reconstruction Fourier Shell Correlation curve extends to a slightly higher resolution than RELION TBA’s reconstruction in all 3 datasets, both with and without imposing symmetry.</p>
      </sec>
      <sec id="Sec23">
        <title>Comparison of particle picking networks</title>
        <p id="Par50">DRPnet’s performance was evaluated in terms of recall, precision, and F-measure [<xref ref-type="bibr" rid="CR54">54</xref>], and compared to other previously reported state-of-the-art deep learning-based particle picking networks. Four networks were compared to DRPnet: WARP (version 1.0.9) [<xref ref-type="bibr" rid="CR20">20</xref>] , TOPAZ (version 0.2.5 implemented in CryoSPARC 2.14.2) [<xref ref-type="bibr" rid="CR19">19</xref>] , crYOLO (version 1.7.5) [<xref ref-type="bibr" rid="CR55">55</xref>] , and DeepPicker (version 1) [<xref ref-type="bibr" rid="CR18">18</xref>]. Table <xref rid="Tab4" ref-type="table">4</xref> shows these comparisons. These deep learning-based tools (especially WARP and TOPAZ) have become widely adopted in the cryoEM community to perform the particle picking task. For our first experiment, using their pretrained network models as downloaded from Github, each network was tested on the full EMPIAR-10017 (<inline-formula id="IEq77"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M168"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq77.gif"/></alternatives></inline-formula>-galactosidase) dataset (84 cryoEM micrographs) [<xref ref-type="bibr" rid="CR50">50</xref>]. Recall, precision, and F-measure values were computed for each network and compared to DRPnet’s values (Table <xref rid="Tab4" ref-type="table">4</xref>, “Pretrained” Model). As mentioned previously, DRPnet had a recall of 87.7%, precision of 71.1%, and F-measure of 78.5%. DRPnet performed better than all others tested, with the exception of crYOLO. Pretrained model of crYOLO [<xref ref-type="bibr" rid="CR21">21</xref>] was previously trained on multiple datasets by its developers including EMPIAR-10017, thus crYOLO had an unfair advantage as this network had already seen this testing data. In our second experiment, each network was trained from scratch with EMPIAR-10005 (TRPV1) [<xref ref-type="bibr" rid="CR36">36</xref>] using default training settings indicated by the developers, then tested on EMPIAR-10017 (<inline-formula id="IEq78"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M170"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq78.gif"/></alternatives></inline-formula>-galactosidase) dataset, and recall, precision, and F-measure values were compared. DRPnet outperformed all other networks as shown in (Table <xref rid="Tab4" ref-type="table">4</xref>, “Trained with TRPV1” Model). This is true even for crYOLO, whose performance drastically drops when tested on unseen data. Although we used the network developers’ suggested settings for training, retraining the networks could suffer from inappropriate settings used and/or amount of training data used. When we retrained the networks from scratch on 1800 particles, the performance decreased. This performance decrease could be attributed to limited quantity of training data used when training from scratch. If DRPnet training from scratch is required, one benefit of DRPnet is less data quantities are required compared to other networks. Particle picking results for a sample image obtained using the pretrained and retrained networks listed in Table <xref rid="Tab4" ref-type="table">4</xref> are shown in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 and S2. Corresponding quantitative evaluation results are given in Table S1. Further sample results demonstrating the DRPnet’s particle picking performance on negatively stain datasets (ALDH7A1, BiFab OKT3) and on an additional cryoEM dataset (EMPIAR-10025 T20S proteasome cryoEM) are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S3 and S4, respectively. These results demonstrate generalization capabilities of DRPnet on unseen data.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec24">
    <title>Conclusions</title>
    <p id="Par51">In summary, we propose a Deep Regression Picker Network (DRPnet) and successfully demonstrate the ability to pick particles on a multiple datasets of cryo-EM micrographs which is different from the training data (TRPV1,EMPIAR-10017)—different sized/shaped/separated particles, collected on different microscopes, using different cameras, with different background contrast (ie. negative stain)—and greatly reduced the time-consuming barrier of manual picking to generate a template (as in RELION’s template based autopicking). Our deep learning-based network is simple and effective for automatically picking particles from 2D cryo-EM micrographs, including those with low contrast, having a large particle box size, having differing particle shapes, handling particles that are clumped, using data collected with different cryo transmission electron microscopes, with different direct detection cameras, and different defocus ranges. We have also successfully used DRPnet to pick particles from negatively stained data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3), which has been reported to be a challenge with other deep-learning based tools [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p id="Par52">DRPnet has a cascade of two convolutional neural networks—the first for detection, followed by a second for classification. This cascade architecture provides flexibility to retrain either or both networks if desired. Compared to other deep learning tools for particle picking of cryoEM micrographs reported to date, this cascade strategy is unique. After the initial training with TRPV1, we found it was unnecessary to retrain DRPnet when applied to other cryoEM micrographs containing differently shaped particles in other datasets (e.g. <inline-formula id="IEq79"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M172"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq79.gif"/></alternatives></inline-formula>-galactosidase, EMPIAR-10061 &amp; EMPIAR-10005). Without the need to retrain, automated particle picking using DRPnet to assist in 3D reconstruction of protein structures by single particle analysis can be realized. If desired, one can retrain the classification CNN—which may be useful for very low contrast images or images that have artifacts, such as ice contamination with similar dimensions to particles of interest, or if the data exhibits a different pattern or illumination.</p>
    <p id="Par53">Utilizing a pretrained network to pick particles significantly reduces time to obtain a particle dataset. DRPnet is very efficient for selecting a set of particles. For comparison, picking <inline-formula id="IEq80"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim \,1000$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mo>∼</mml:mo><mml:mspace width="0.166667em"/><mml:mn>1000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq80.gif"/></alternatives></inline-formula> particles manually in our laboratory from the above EMPIAR datasets took about 30 min per dataset. With manually picking particles, there is also additional time spent running the manually picked 2D classification (10 min), selecting good 2D class average templates (1 min), as well as more time invested optimizing template-based autopicking parameters (10 min) and finally running the autopicking job (10 min or longer). With DRPnet, it takes about 6 s per micrograph to pick the particles, which results in significant time savings, as compared to generating a quality particle dataset in similar quantity via RELION’s workflow.</p>
    <p id="Par54">Considering the size of scaled input particles (64 x 64 pixels), the proposed network architecture has been kept simple to maintain an appropriate number of neural network parameters to avoid convergence issues and to achieve faster performance. The current network configurations are adequate for our picking pipeline and therefore implementing more complex architectures is unnecessary. Our results show that DRPnet architecture performs better than other more complex architectures (WARP uses UNet, crYOLO using YOLO), which as we show in Table <xref rid="Tab4" ref-type="table">4</xref> can be inhibitive for particle picking. Considering that we achieve this even with smaller training sets also emphasizes the effect of simpler architecture.</p>
    <p id="Par55">Investigating traditional computer science detection/classification evaluation metrics of recall, precision, and F-measure, we performed a comparison between popular deep learning-based particle picking networks (WARP, TOPAZ, crYOLO, DeepPicker)—both with and without model retraining. We note DRPnet had comparable or improved evaluation metrics compared to all programs attempted, with or without training—with the exception of crYOLO, which had been trained previously on our test dataset (EMPIAR-10017). While these supervised evaluations are very informative, many times, existing ground truth sets are lacking due to 1) low contrast particles not contained in the “expert’s” ground truth, or 2) the particles composing final 3D reconstruction not representing the total particles used for alignment, classification, and averaging. Specifically, in case of EMPIAR-10017 (<inline-formula id="IEq81"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M176"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq81.gif"/></alternatives></inline-formula>-galactosidase), although the ground truth was the most comprehensive, it still did not cover all particle patterns, thus orientations. This may be due to fluctuations in intensity level, which may effect the ground truth’s particle patterns. Cryo-electron microscopy images captured with low contrast (low defocus or minimal electron radiation exposure, therefore enhancing high resolution terms) likely have high resolution 3D protein structural information, and conversely, those captured with high contrast (high defocus or high electron radiation exposure, enhancing low resolution terms) contain low resolution information. Because images in EMPIAR-10017 (<inline-formula id="IEq82"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M178"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq82.gif"/></alternatives></inline-formula>-galactosidase) have different contrast levels, a true positive particle in a low contrast image can be a false positive pattern in high contrast image.</p>
    <p id="Par56">For the above reasons, the detection stage F-measure of 78.5% was not high, but it was the best result we could achieve with EMPIAR-10017 (<inline-formula id="IEq83"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M180"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq83.gif"/></alternatives></inline-formula>-galactosidase) data. We note however DRPnet was the best compared to deep-learning particle picking networks (WARP, TOPAZ, DeepPicker) that hadn’t been previously trained on this data, and the discrepancy becomes even wider upon model training from scratch. In addition to supervised detection evaluation metrics, we sought additional unsupervised metrics to guide our analysis even when complete ground truths are not available. Metrics we found useful include angular distributions plots, efficiency (E<inline-formula id="IEq84"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M182"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq84.gif"/></alternatives></inline-formula>) values [<xref ref-type="bibr" rid="CR47">47</xref>], Rosenthal and Henderson B-factor plots [<xref ref-type="bibr" rid="CR48">48</xref>] with and without imposing symmetry, inspecting the 3D isosurface using local-resolution based color scheme, and finally reporting resolution using the gold standard Fourier Shell Correlation (correlation threshold of 0.143) [<xref ref-type="bibr" rid="CR48">48</xref>].</p>
    <p id="Par57">We consistently obtained more 2D classes, and improved angular coverage. The corresponding 3D reconstructions had slightly higher global &amp; local resolutions with DRPnet picked particles compared to RELION’s TBA particles. DRPnet excelled in particle picking with low contrast data sets (those collected on Gatan direct detectors using images collected close to focus). Plotting the angular distributions allows one to visually inspect the orientations (angles and rotations) of the picked particles and also their abundance. With DRPnet picked particles, a broader coverage of angular space is observed (less white background in the 2D Hammer projection surface) for all datasets tested. This finding is also corroborated by the efficiency metric, with DRPnet consistently showing improved E<inline-formula id="IEq85"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{\text {od}}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mrow/><mml:mtext>od</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3948_Article_IEq85.gif"/></alternatives></inline-formula> values, indicating a more robust sampling of particle angular orientations in the final 3D reconstruction. Finally, visual inspection of the 3D reconstruction isosurface when displaying the variation in local resolution indicates improved particle alignment with DRPnet-picked versus RELION TBA’s 3D reconstructions, indicated by more blue (high resolution) and less red (lower resolution) isosurface. We conclude DRPnet, based on the concept of blob detection, can pick diversified patterns which usually results in wider particle orientation angle coverage, yielding improved resolution. This is different than the manually selected templates used in RELION TBA. Especially for low contrast (low defocus, high resolution) datasets, bias from the user picking manual particles is minimized when using DRPnet—not only are preferred high contrast particle views picked, but also other less obvious views with less contrast—yielding a particle set from DRPnet having more diverse angular orientations. If limited by either input particle quantity, unknown symmetry or inability to apply it (for example variable ligand binding stoichiometries, variable conformations or allostery), DRPnet may be particularly useful in picking particles that have improved angular orientation sampling leading to improved particle alignments. All these benefits may likely result in a 3D single particle reconstruction with improved final resolutions—both global and local. Future plans include implementation in an open-source framework (Pytorch, for example), reducing the barrier to DRPnet’s widespread adoption. Also, addition of powerful classification networks to our workflow, trained with multiple types of particles (e.g. heterogeneous populations of particles) would likely reduce the running time of our picking software while increasing its accuracy (reducing false positives such as noisy and/or low contrast particles).</p>
    <p id="Par58">Here, we present a deep regression-based particle picking network composed of a dual cascade of convolutional neural networks, entitled “DRPnet”. The advantages of automated particle picking with DRPnet are following: (1) the picking algorithm does not have to be, but can be, retrained, (2) the efficiency of automated particle picking compared to manual template generation, and (3) the ability of DRPnet to perform picking on low contrast cryoEM datasets (low defocus, high resolution) or data that is not complete (poor angular sampling). We compare DRPnet performance to popular, deep-learning based particle picking networks in terms of detection evaluation metrics, recall, precision, and F-measure, and show that is comparable or better with and without training the respective models. We also provide functional assessment metrics—higher quantities of good 2D class averages, better efficiency reflected in angular coverage plots, Rosenthal–Henderson plots, assessing global/local resolution—for cryoEM micrograph particle picking beyond traditional evaluation metrics. We envision these metrics will be useful to the cryoEM community when assessing the performance of future particle picking networks.
</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec25">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3948_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1:</bold> Supplemental materials.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CryoEM</term>
        <def>
          <p id="Par4">Cryo-electron microscopy</p>
        </def>
      </def-item>
      <def-item>
        <term>TBA</term>
        <def>
          <p id="Par5">Template based autopicking</p>
        </def>
      </def-item>
      <def-item>
        <term>TEM</term>
        <def>
          <p id="Par6">Transmission electron microscope</p>
        </def>
      </def-item>
      <def-item>
        <term>DRPnet</term>
        <def>
          <p id="Par7">Deep regression picker network</p>
        </def>
      </def-item>
      <def-item>
        <term>FCRN</term>
        <def>
          <p id="Par8">Fully convolutional regression network</p>
        </def>
      </def-item>
      <def-item>
        <term>CNN</term>
        <def>
          <p id="Par9">Convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>SNR</term>
        <def>
          <p id="Par10">Signal-to-noise ratio</p>
        </def>
      </def-item>
      <def-item>
        <term>FSC</term>
        <def>
          <p id="Par11">Fourier shell correlation</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1186/s12859-020-03948-x.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank the Research Computing Support Services (RCSS) of University of Missouri at Columbia for the computational resources and support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>TW &amp; FB conceived of the project and designed the experiments. NPN, FB and IE implemented the method. NPN gathered the results. JG provided support of the computational resources. NPN, TW, FB and IE analysed the data. NPN and TW wrote the manuscript. TW, FB, IE and NPN edited and approved the manuscript. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the University of Missouri Office of Research, Electron Microscopy Core, and the University of Missouri Interdisciplinary Pilot Grant funded through School of Medicine and College of Engineering.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets used for our experiments were downloaded from EMPIAR (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/pdbe/emdb/empiar/">https://www.ebi.ac.uk/pdbe/emdb/empiar/</ext-link>). DRPnet is freely available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/emcoregit/DRPnet">https://github.com/emcoregit/DRPnet</ext-link>).</p>
  </notes>
  <notes id="FPar3">
    <title>Ethics approval and consent to participate</title>
    <p id="Par59">Not applicable.</p>
  </notes>
  <notes id="FPar4">
    <title>Consent for publication</title>
    <p id="Par60">Not applicable.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par61">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baxter</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Grassucci</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Frank</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Determination of signal-to-noise ratios and spectral SNRs in cryo-EM low-dose imaging of molecules</article-title>
        <source>J Struct Biol</source>
        <year>2009</year>
        <volume>166</volume>
        <issue>2</issue>
        <fpage>126</fpage>
        <lpage>132</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jsb.2009.02.012</pub-id>
        <?supplied-pmid 19269332?>
        <pub-id pub-id-type="pmid">19269332</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lyumkis</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Challenges and opportunities in cryo-EM single-particle analysis</article-title>
        <source>J Biol Chem</source>
        <year>2019</year>
        <volume>294</volume>
        <issue>13</issue>
        <fpage>5181</fpage>
        <lpage>5197</lpage>
        <pub-id pub-id-type="doi">10.1074/jbc.rev118.005602</pub-id>
        <?supplied-pmid 30804214?>
        <pub-id pub-id-type="pmid">30804214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adrian</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dubochet</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lepault</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McDowall</surname>
            <given-names>AW</given-names>
          </name>
        </person-group>
        <article-title>Cryo-electron microscopy of viruses</article-title>
        <source>Nature</source>
        <year>1984</year>
        <pub-id pub-id-type="doi">10.1038/308032a0</pub-id>
        <?supplied-pmid 6322001?>
        <pub-id pub-id-type="pmid">6322001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Penczek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Radermacher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Frank</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Three-dimensional reconstruction of single particles embedded in ice</article-title>
        <source>Ultramicroscopy</source>
        <year>1992</year>
        <volume>40</volume>
        <issue>1</issue>
        <fpage>21</fpage>
        <pub-id pub-id-type="doi">10.1016/0304-3991(92)90233-A</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiu</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Electron microscopy of frozen, hydrated biological specimens</article-title>
        <source>Annu Rev Biophys Biophys Chem</source>
        <year>1986</year>
        <volume>15</volume>
        <fpage>21</fpage>
        <pub-id pub-id-type="doi">10.1146/annurev.bb.15.060186.001321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brilot</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Carragher</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Henderson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Grigorieff</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Beam-induced motion of vitrified specimen on holey carbon film</article-title>
        <source>J Struct Biol</source>
        <year>2012</year>
        <volume>177</volume>
        <issue>3</issue>
        <fpage>630</fpage>
        <lpage>637</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jsb.2012.02.003</pub-id>
        <?supplied-pmid 22366277?>
        <pub-id pub-id-type="pmid">22366277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baker</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cryo-electron microscopy shapes up</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>561</volume>
        <issue>7724</issue>
        <fpage>565</fpage>
        <lpage>567</lpage>
        <pub-id pub-id-type="doi">10.1038/d41586-018-06791-6</pub-id>
        <?supplied-pmid 30254359?>
        <pub-id pub-id-type="pmid">30254359</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>CB</given-names>
          </name>
        </person-group>
        <source>Transmission electron microscopy: a textbook for materials science</source>
        <year>2009</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>775</fpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheres</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Prevention of overfitting in cryo-EM structure determination</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>9</issue>
        <fpage>853</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2115</pub-id>
        <?supplied-pmid 22842542?>
        <pub-id pub-id-type="pmid">22842542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marques</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Purdy</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Yeager</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cryoem maps are full of potential</article-title>
        <source>Curr Opin Struct Biol</source>
        <year>2019</year>
        <volume>58</volume>
        <fpage>214</fpage>
        <lpage>223</lpage>
        <pub-id pub-id-type="doi">10.1016/j.sbi.2019.04.006</pub-id>
        <?supplied-pmid 31400843?>
        <pub-id pub-id-type="pmid">31400843</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheres</surname>
            <given-names>SHW</given-names>
          </name>
        </person-group>
        <article-title>Semi-automated selection of cryo-EM particles in RELION-1.3</article-title>
        <source>J Struct Biol</source>
        <year>2015</year>
        <volume>189</volume>
        <issue>2</issue>
        <fpage>114</fpage>
        <lpage>122</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jsb.2014.11.010</pub-id>
        <?supplied-pmid 25486611?>
        <pub-id pub-id-type="pmid">25486611</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>SK</given-names>
          </name>
        </person-group>
        <source>Medical image recognition, segmentation and parsing</source>
        <year>2016</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Academic Pres</publisher-name>
        <fpage>519</fpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Greenspan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>Deep learning for medical image analysis</source>
        <year>2017</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sabuncu</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <source>Machine learning and medical imaging</source>
        <year>2016</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
        <fpage>489</fpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Xing</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Wu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sabuncu</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Chapter 4: machine learning and its application in microscopic image analysis</article-title>
        <source>Machine learning and medical imaging</source>
        <year>2016</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
        <fpage>97</fpage>
        <lpage>127</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Shin</surname>
            <given-names>H-C</given-names>
          </name>
          <name>
            <surname>Orton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Leach</surname>
            <given-names>MO</given-names>
          </name>
        </person-group>
        <source>Organ detection using deep learning</source>
        <year>2016</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
        <fpage>123</fpage>
        <lpage>153</lpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xing</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Zhou</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Greenspan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Chapter 7: deep voting and structured regression for microscopy image analysis</article-title>
        <source>Deep learning for medical image analysis</source>
        <year>2017</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
        <fpage>155</fpage>
        <lpage>75</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Deeppicker: a deep learning approach for fully automated particle picking in cryo-EM</article-title>
        <source>J Struct Biol</source>
        <year>2016</year>
        <volume>195</volume>
        <issue>3</issue>
        <fpage>325</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jsb.2016.07.006</pub-id>
        <?supplied-pmid 27424268?>
        <pub-id pub-id-type="pmid">27424268</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bepler</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Morin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Brasch</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Positive-unlabeled convolutional neural networks for particle picking in cryo-electron micrographs</article-title>
        <source>Res Comput Mol Biol</source>
        <year>2018</year>
        <volume>10812</volume>
        <fpage>245</fpage>
        <lpage>247</lpage>
        <?supplied-pmid 29707703?>
        <pub-id pub-id-type="pmid">29707703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tegunov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cramer</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Real-time cryo-EM data pre-processing with warp</article-title>
        <source>BioRxiv</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1101/338558</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Merino</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Stabrin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moriya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Antoni</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Apelbaum</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hagel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sitsel</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Raisch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Prumbaum</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Quentin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Roderer</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tacke</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Siebolds</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schubert</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Shaikh</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Lill</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gatsogiannis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raunser</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>SPHIRE-crYOLO is a fast and accurate fully automated particle picker for cryo-EM</article-title>
        <source>Commun Biol</source>
        <year>2019</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s42003-019-0437-z</pub-id>
        <pub-id pub-id-type="pmid">30740537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">He K, Zhang X, Ren S, Sun J. Deep residual learning for image recognition. In: 2016 IEEE conference on computer vision and pattern recognition (CVPR), pp 770–778; 2016. 10.1109/CVPR.2016.90</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Redmon J, Farhadi A. YOLO9000: better, faster, stronger. arXiv; 2016.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Zhao Z-Q, Zheng P, Xu S-T, Wu X. Object detection with deep learning: a review; 2017. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1807.05511v1">arXiv:1807.05511v1</ext-link></mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Liu L, Ouyang W, Wang X, Fieguth P, Chen J, Liu X, Pietikäinen M. Deep learning for generic object detection: a survey; 2018. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1809.02165">arXiv:1809.02165</ext-link></mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Hough PVC. A method and means for recognizing complex patterns; 1962.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lowe</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Distinctive image features from scale-invariant keypoints (sift)</article-title>
        <source>Int J Comput Vis</source>
        <year>2004</year>
        <volume>60</volume>
        <issue>2</issue>
        <fpage>28</fpage>
        <pub-id pub-id-type="doi">10.1023/B:VISI.0000029664.99615.94</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bay</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ess</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tuytelaars</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gool</surname>
            <given-names>LV</given-names>
          </name>
        </person-group>
        <article-title>Speeded-up robust features (surf)</article-title>
        <source>Comput Vis Image Underst</source>
        <year>2008</year>
        <volume>110</volume>
        <issue>3</issue>
        <fpage>14</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cviu.2007.09.014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Redmon J, Farhadi A. YOLOv3: an incremental improvement; 2018. arXiv</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Liu W, Anguelov D, Erhan D, Szegedy C, Reed S, Fu C-Y, Berg AC. SSD: single shot multibox detector; 2016. arXiv.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Ren S, He K, Girshick R, Sun J. Faster R-CNN: towards real-time object detection with region proposal networks. In: International conference on neural information processing systems, p. 91–99.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">He K, Gkioxari G, Dollar P, Girshick R. Mask RCNN; 2017. arXiv.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Everingham</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Van Gool</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>CKI</given-names>
          </name>
          <name>
            <surname>Winn</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zisserman</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The pascal visual object classes (voc) challenge</article-title>
        <source>Int J Comput Vis</source>
        <year>2010</year>
        <volume>88</volume>
        <issue>2</issue>
        <fpage>303</fpage>
        <lpage>338</lpage>
        <pub-id pub-id-type="doi">10.1007/s11263-009-0275-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Lin T, Maire M, Belongie SJ, Bourdev LD, Girshick RB, Hays J, Perona P, Ramanan D, Dollár P, Zitnick CL. Microsoft COCO: common objects in context; 2014. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1405.0312">arXiv:1405.0312</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Szeliski</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>Computer vision: algorithms and applications</source>
        <year>2010</year>
        <edition>1</edition>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Julius</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Structure of the TRPV1 ion channel determined by electron cryo-microscopy</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>504</volume>
        <issue>7478</issue>
        <fpage>107</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12822</pub-id>
        <?supplied-pmid 24305160?>
        <pub-id pub-id-type="pmid">24305160</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Goodfellow</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Courville</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Deep learning</source>
        <year>2016</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>The MIT Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Kingma DP, Ba J. Adam: a method for stochastic optimization; 2014. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1412.6980">arXiv:1412.6980</ext-link></mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patwardhan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Carazo</surname>
            <given-names>J-M</given-names>
          </name>
          <name>
            <surname>Carragher</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Henderson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Heymann</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Lagerstedt</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lawson</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Ludtke</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Mastronarde</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Roseman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosenthal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sorzano</surname>
            <given-names>C-OS</given-names>
          </name>
          <name>
            <surname>Sanz-García</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Scheres</surname>
            <given-names>SHW</given-names>
          </name>
          <name>
            <surname>Subramaniam</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Westbrook</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Winn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Swedlow</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Kleywegt</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Data management challenges in three-dimensional EM</article-title>
        <source>Nat Struct Mol Biol</source>
        <year>2012</year>
        <volume>19</volume>
        <issue>12</issue>
        <fpage>1203</fpage>
        <lpage>1207</lpage>
        <pub-id pub-id-type="doi">10.1038/nsmb.2426</pub-id>
        <?supplied-pmid 23211764?>
        <pub-id pub-id-type="pmid">23211764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Scheres</surname>
            <given-names>SHW</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Crowther</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Chapter six: processing of structurally heterogeneous cryo-EM data in RELION</article-title>
        <source>The resolution revolution: recent advances in cryoEM. Methods in enzymology</source>
        <year>2016</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
        <fpage>125</fpage>
        <lpage>57</lpage>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Frank</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Three-dimensional electron microscopy of macromolecular assemblies: visualization of biological molecules in their native state</source>
        <year>2006</year>
        <publisher-loc>Oxford</publisher-loc>
        <publisher-name>Oxford University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Penczek</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Resolution measures in molecular electron microscopy</article-title>
        <source>Methods Enzymol</source>
        <year>2010</year>
        <pub-id pub-id-type="doi">10.1016/s0076-6879(10)82003-8</pub-id>
        <?supplied-pmid 20888958?>
        <pub-id pub-id-type="pmid">20888958</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harauz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>van Heel</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Exact filters for general geometry three dimensional reconstruction</article-title>
        <source>OPTIK</source>
        <year>1986</year>
        <volume>73</volume>
        <issue>4</issue>
        <fpage>146</fpage>
        <lpage>156</lpage>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Unser</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Trus</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Steven</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>A new resolution criterion based on spectral signal-to-noise ratios</article-title>
        <source>Ultramicroscopy</source>
        <year>1987</year>
        <volume>23</volume>
        <fpage>4</fpage>
        <pub-id pub-id-type="doi">10.1016/0304-3991(87)90225-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kucukelbir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sigworth</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Tagare</surname>
            <given-names>HD</given-names>
          </name>
        </person-group>
        <article-title>Quantifying the local resolution of cryo-EM density maps</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>63</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2727</pub-id>
        <?supplied-pmid 24213166?>
        <pub-id pub-id-type="pmid">24213166</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langlois</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pallesen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ash</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Rubinstein</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Frank</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Automated particle picking for low-contrast macromolecules in cryo-electron microscopy</article-title>
        <source>J Struct Biol</source>
        <year>2014</year>
        <volume>186</volume>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jsb.2014.03.001</pub-id>
        <pub-id pub-id-type="pmid">24607413</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Naydenova</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Russo</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>Measuring the effects of particle orientation to improve the efficiency of electron cryomicroscopy</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>629</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-00782-3</pub-id>
        <?supplied-pmid 28931821?>
        <pub-id pub-id-type="pmid">28931821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenthal</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Henderson</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Optimal determination of particle orientation, absolute hand, and contrast loss in single-particle electron cryomicroscopy</article-title>
        <source>J Mol Biol</source>
        <year>2003</year>
        <volume>333</volume>
        <issue>4</issue>
        <fpage>721</fpage>
        <lpage>745</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2003.07.013</pub-id>
        <?supplied-pmid 14568533?>
        <pub-id pub-id-type="pmid">14568533</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zivanov</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nakane</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Forsberg</surname>
            <given-names>BO</given-names>
          </name>
          <name>
            <surname>Kimanius</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hagen</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Lindahl</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Scheres</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>New tools for automated high-resolution cryo-em structure determination in relion-3</article-title>
        <source>eLife</source>
        <year>2018</year>
        <volume>7</volume>
        <fpage>42166</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.42166</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bartesaghi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Merk</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Banerjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Matthies</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Milne</surname>
            <given-names>JLS</given-names>
          </name>
          <name>
            <surname>Subramaniam</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>2.2 Å resolution cryo-EM structure of <italic>β</italic>-galactosidase in complex with a cell-permeant inhibitor</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <issue>6239</issue>
        <fpage>1147</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aab1576</pub-id>
        <?supplied-pmid 25953817?>
        <pub-id pub-id-type="pmid">25953817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korasick</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Chakravarthy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tanner</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Nad+ promotes assembly of the active tetramer of aldehyde dehydrogenase 7A1</article-title>
        <source>FEBS Lett</source>
        <year>2018</year>
        <volume>592</volume>
        <issue>19</issue>
        <fpage>3229</fpage>
        <lpage>3238</lpage>
        <pub-id pub-id-type="doi">10.1002/1873-3468.13238</pub-id>
        <pub-id pub-id-type="pmid">30184263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Veesler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Carragher</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>2.8 Å resolution reconstruction of the Thermoplasma acidophilum 20S proteasome using cryo-electron microscopy</article-title>
        <source>eLife</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>06380</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.06380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pettersen</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Couch</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Greenblatt</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Meng</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Ferrin</surname>
            <given-names>TE</given-names>
          </name>
        </person-group>
        <article-title>Ucsf chimera: a visualization system for exploratory research and analysis</article-title>
        <source>J Comput Chem</source>
        <year>2004</year>
        <volume>25</volume>
        <issue>13</issue>
        <fpage>1605</fpage>
        <lpage>1612</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.20084</pub-id>
        <pub-id pub-id-type="pmid">15264254</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kamber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pei</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Data mining: concepts and techniques</source>
        <year>2011</year>
        <edition>3</edition>
        <publisher-loc>San Francisco</publisher-loc>
        <publisher-name>Morgan Kaufmann Publishers Inc.</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Merino</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Stabrin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moriya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gatsogiannis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raunser</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>SPHIRE-crYOLO: a fast and well-centering automated particle picker for cryo-EM</article-title>
        <source>biorxiv</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1101/356584</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
