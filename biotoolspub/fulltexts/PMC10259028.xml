<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10259028</article-id>
    <article-id pub-id-type="publisher-id">5366</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05366-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CastNet: a systems-level sequence evolution simulator</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Rivera-Rivera</surname>
          <given-names>Carlos J.</given-names>
        </name>
        <address>
          <email>carlos.riverarivera@bristol.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grbic</surname>
          <given-names>Djordje</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5337.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7603</institution-id><institution>University of Bristol, </institution></institution-wrap>Life Sciences Building, 24 Tyndall Avenue, Bristol, BS8 1TG UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.5254.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 0674 042X</institution-id><institution>IT-University of Copenhagen, </institution></institution-wrap>Rued Langgaards Vej 7, 2300 Copenhagen, Denmark </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>247</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Simulating DNA evolution has been done through coevolution-agnostic probabilistic frameworks for the past 3 decades. The most common implementation is by using the converse of the probabilistic approach used to infer phylogenies which, in the simplest form, simulates a single sequence at a time. However, biological systems are multi-genic, and gene products can affect each other’s evolutionary paths through coevolution. These crucial evolutionary dynamics still remain to be simulated, and we believe that modelling them can lead to profound insights for comparative genomics.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here we present CastNet, a genome evolution simulator that assumes each genome is a collection of genes with constantly evolving regulatory interactions in between them. The regulatory interactions produce a phenotype in the form of gene expression profiles, upon which fitness is calculated. A genetic algorithm is then used to evolve a population of such entities through a user-defined phylogeny. Importantly, the regulatory mutations are a response to sequence mutations, thus making a 1–1 relationship between the rate of evolution of sequences and of regulatory parameters. This is, to our knowledge, the first time the evolution of sequences and regulation have been explicitly linked in a simulation, despite there being a multitude of sequence evolution simulators, and a handful of models to simulate Gene Regulatory Network (GRN) evolution. In our test runs, we see a coevolutionary signal among genes that are active in the GRN, and neutral evolution in genes that are not included in the network, showing that selective pressures imposed on the regulatory output of the genes are reflected in their sequences.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">We believe that CastNet represents a substantial step for developing new tools to study genome evolution, and more broadly, coevolutionary webs and complex evolving systems. This simulator also provides a new framework to study molecular evolution where sequence coevolution has a leading role.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05366-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Evolution simulation</kwd>
      <kwd>Evo-devo</kwd>
      <kwd>Complex systems</kwd>
      <kwd>Gene regulatory networks</kwd>
      <kwd>Evolutionary systems</kwd>
      <kwd>Coevolutionary webs</kwd>
      <kwd>Coevolution</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100018694</institution-id>
            <institution>HORIZON EUROPE Marie Sklodowska-Curie Actions</institution>
          </institution-wrap>
        </funding-source>
        <award-id>892606-RipGEESE</award-id>
        <principal-award-recipient>
          <name>
            <surname>Rivera-Rivera</surname>
            <given-names>Carlos J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">DNA and amino acid sequence evolution have traditionally been simulated through probabilistic models that infer substitutions on a single sequence in a branch-independent manner [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. These methods do not allow for gene coevolution by principle, since they simulate the evolution of a single sequence, one branch at a time [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], impeding by design the simulation of coevolving sequences. Biological evolution, however, has a diversity of examples in which sequence coevolution within and across lineages is evident and often pervasive (e.g. [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]).</p>
    <p id="Par5">The evolution of networks of interacting genes, or gene regulatory networks (GRNs) has been studied with simulations since the landmark models of Wagner [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. These studies, and related ones that followed (e.g. [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]) focus on the structural properties of GRNs that emerge due to the evolutionary process. One of these studies identified that robustness to mutation can emerge spontaneously through evolution, via the modification the GRN topology, thus ensuring consistent developmental results from networks that were slightly dissimilar [<xref ref-type="bibr" rid="CR13">13</xref>]. Many of these studies find that structural properties of the GRNs affect a system’s access to phenotypic spaces, or its evolvability, a crucial component of evolving systems we should understand in an environment that is changing at an ever-faster pace. The insights into evolutionary dynamics these studies achieved are ground-breaking and, in our view, still warrant additional study.</p>
    <p id="Par6">The studies of sequence and GRN evolution have remained separate so far. The most obvious reasoning for this is that the evolution of regulation is expected to influence regulatory sequences, rather than protein-coding sequences. However, biological examples of sequence coevolution observed directly on protein-coding sequences led us to propose a simulator in which GRN evolution and sequence evolution are explicitly linked. This simulator enables exploration into the extent to which the coevolutionary links among gene products constrain or channel sequence evolution. Such a system also allows for a simulation-driven test of the analytical proofs by González-Forero [<xref ref-type="bibr" rid="CR17">17</xref>], and can help to determine whether developmental information can be extracted solely from sequence evolution.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par7">Here we present CastNet, a highly customizable software for simulating the evolution of virtual organisms composed of genomes and proteomes, where genes are functionally linked.</p>
    <sec id="Sec3">
      <title>Virtual organism structure</title>
      <p id="Par8">CastNet creates a genome of a user-defined size in nucleotides, <italic>n</italic> × <italic>l</italic> (<italic>n</italic> = number of genes, <italic>l</italic> = sequence length in base pairs). The simulated genome is built by randomly sampling codons under a uniform distribution. CastNet then creates a regulatory matrix <bold><italic>R</italic></bold> of size <italic>n</italic> × <italic>n</italic>, which encodes the regulatory effects each gene of the system has on all other genes, and the regulatory effect that all genes have on each gene. The values in this matrix are sampled from a uniform distribution within a user-defined range that ideally includes negative (downregulation/repression) as well as positive (upregulation/activation) values, and then a mask is used to turn a user-defined proportion of cells to 0, to enforce sparseness. There are two additional gene-specific regulatory parameters: (1) a threshold <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M2"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq1.gif"/></alternatives></inline-formula> indicating the minimum activating signal that needs to be received by each gene in order for it to be expressed (from Espinosa-Soto 2008 [<xref ref-type="bibr" rid="CR16">16</xref>]), and (2) A gene-specific decay rate <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M4"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq2.gif"/></alternatives></inline-formula> determining how quickly each gene’s amount decreases with time under an exponential decay model.</p>
    </sec>
    <sec id="Sec4">
      <title>Simulating development</title>
      <p id="Par9">With the regulatory parameters <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{R}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq3.gif"/></alternatives></inline-formula>, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\lambda}} = \user2{ }\left[ {\lambda_{G1,} \lambda_{G2} , \ldots ,\lambda_{Gn} } \right]$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow/><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">Gn</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq4.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\theta}} = \left[ {\theta_{G1} ,\theta_{G2} , \ldots ,\theta_{Gn} } \right]$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="italic">Gn</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq5.gif"/></alternatives></inline-formula>, CastNet simulates the development of a system through a time-discrete Markov Chain by calculating the gene quantities vector <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{q}}_{t}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq6.gif"/></alternatives></inline-formula> at each step <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M14"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq7.gif"/></alternatives></inline-formula>, following:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{q}}_{{\varvec{t}}} = \left( {{\varvec{ReLU}}_{{\uptheta }} \left( {{\mathbf{R}} \cdot {\varvec{q}}_{{{\varvec{t}} - 1}} } \right) + {\varvec{q}}_{{{\varvec{t}} - 1}} e^{{ - {\uplambda }}} } \right)*{\varvec{c}}$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ReLU</mml:mi></mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">R</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mrow/><mml:mo>∗</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2023_5366_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{q}}_{t} = \left[ {q_{G1} \left( t \right),q_{G2} \left( t \right), \ldots ,q_{Gn} \left( t \right)} \right]$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="italic">Gn</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq8.gif"/></alternatives></inline-formula> is a vector of size <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M20"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq9.gif"/></alternatives></inline-formula> with the quantity <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{Gi} \left( t \right)$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="italic">Gi</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq10.gif"/></alternatives></inline-formula> of each gene at time <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M24"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq11.gif"/></alternatives></inline-formula> (quantities are in arbitrary units), <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{q}}_{t - 1} = \left[ {q_{G1} \left( {t - 1} \right),q_{G2} \left( {t - 1} \right), \ldots ,q_{Gn} \left( {t - 1} \right)} \right]$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="italic">Gn</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq12.gif"/></alternatives></inline-formula> is the gene quantities in the prior step of the chain, <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ReLU_{\theta }$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq13.gif"/></alternatives></inline-formula> is a rectifier function that rectifies to 0 any value below each gene’s activation threshold <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta_{Gi}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="italic">Gi</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq14.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}} = \left[ {{\varvec{c}}_{G1} ,{\varvec{c}}_{G2} , \ldots ,{\varvec{c}}_{Gn} } \right]$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">Gn</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq15.gif"/></alternatives></inline-formula> is a vector of size <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M34"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq16.gif"/></alternatives></inline-formula> that has a zero if the gene has a stop codon, and one otherwise. <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq17.gif"/></alternatives></inline-formula> multiplies by 0 the quantities of any gene which shows a nonsense mutation (i.e. with a stop codon mid-sequence), and by one that of genes with an intact open reading frame. This Markov chain is run for a user-defined number of developmental steps <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M38"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq18.gif"/></alternatives></inline-formula>, using an arbitrary seed quantity of 1 for the first gene in the list, and 0 for all other genes. This recursive operation results in an expression matrix <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{E}}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq19.gif"/></alternatives></inline-formula> of size <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M42"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq20.gif"/></alternatives></inline-formula> × <inline-formula id="IEq21"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M44"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq21.gif"/></alternatives></inline-formula>, which can be interpreted as gene expression profiles for all genes in the system (Algorithm <xref rid="Figa" ref-type="fig">1</xref>). This simulation of development assumes that all genes are monoexonic and have single isoform, and that regulation is happening exclusively at the level of transcription (similar to Wagner’s model in [<xref ref-type="bibr" rid="CR11">11</xref>]).</p>
      <p id="Par10">
        <fig position="anchor" id="Figa">
          <graphic position="anchor" xlink:href="12859_2023_5366_Figa_HTML" id="MO1"/>
        </fig>
      </p>
      <p id="Par11">A standard genetic algorithm (GA) [<xref ref-type="bibr" rid="CR18">18</xref>] is used to simulate evolution in this system (Algorithm <xref rid="Figb" ref-type="fig">2</xref>). Broadly, the mutation of an organism in each generation occurs in the following steps:<list list-type="order"><list-item><p id="Par12">Mutate the genome sequence based on a user-defined ‘probability of a point mutation per base, per generation’ rate <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M46"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq22.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par13">Assign each mutation to the gene in which it happened, and whether they are synonymous, non-synonymous, or nonsense mutations.</p></list-item><list-item><p id="Par14">For each mutation, mutate any regulatory value from the corresponding gene, reflecting their synonymous or non-synonymous nature. Non-synonymous mutations will occur in links which are known to be active (e.g., a gene that is expressed in the parental expression matrix <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{E}}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq23.gif"/></alternatives></inline-formula>), whereas synonymous mutations would occur in links which are known to be inactive (e.g., parental expression matrix <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{E}}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq24.gif"/></alternatives></inline-formula> shows no activation of that specific link). Synonymous regulatory mutations are intended to allow for ‘under the hood’ or hidden regulatory changes, which do not have a measurable effect in the actual GRN but would allow for larger innovations if the mutated gene is activated.. Whether a mutation occurs on regulatory parameters <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\theta}}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq25.gif"/></alternatives></inline-formula> or <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\lambda}}$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq26.gif"/></alternatives></inline-formula> is determined by the proportion of regulatory values these two vectors represent (<inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{2}{2 + n}$$\end{document}</tex-math><mml:math id="M56"><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq27.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq28"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M58"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq28.gif"/></alternatives></inline-formula> is the number of genes).</p></list-item></list></p>
      <p id="Par15">The following assumptions are in place in the mutational process: 1. Point mutations are equally likely across the genome (i.e. no site rate heterogeneity), and each mutation will result in any of the other three nucleotides with equal probability (i.e. follows a JC model), 2. The <italic>location</italic> of a mutation in the sequence is independent from the regulatory mutation, 3. The reproductive system is clonal, haploid, and does not have recombination, 4. Insertions/deletions, and gene/genome duplications do not occur, 5. Regulatory, evolutionary and fitness parameters are branch-specific unless otherwise enforced by the user.</p>
      <p id="Par16">The phenotype upon which fitness is measured is the output of the regulatory parameters (i.e., the gene expression profiles). Four metrics are used to evaluate the fitness of each gene expression profile: gene quantities must not increase exponentially; the more genes activated in the system, the fitter the organism; gene expression should be as stable as possible; and the system must have reached maturity (indicated by an arbitrary gene having passed a user-defined threshold in quantity, and being expressed in the final developmental step). Specific details on how these metrics are calculated are in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, and in the manual at the CastNet homepage.</p>
      <p id="Par17">CastNet then allows populations of such systems to evolve through user-defined branches, and numbers of generations, and in the end, will have multiple sequences simulated for each GRN, following the selective pressures imposed on the gene expression profile. CastNet simulates the evolution of multi-genic systems branch by branch, and the way the outputs are organized makes changing evolutionary parameters mid-branch relatively easy. This feature permits the simulation of branch-specific (or generation-specific within one branch) changes in rates of evolution, population size, and selective strategies.<fig position="anchor" id="Figb"><graphic position="anchor" xlink:href="12859_2023_5366_Figb_HTML" id="MO2"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results</title>
    <p id="Par18">We ran a proof con concept (POC) of CastNet with two simulated test runs of four lineages, five genes of 3000 bp each, and 20,000 generations, using a fully symmetrical tree (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A and E), a selection proportion of <italic>p</italic> = <italic>0.1</italic>, but with two different selection strategies: ‘high pressure’ (only fittest <inline-formula id="IEq29"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M60"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq29.gif"/></alternatives></inline-formula> survive—Run 1), and ‘totally relaxed’ (<inline-formula id="IEq30"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M62"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq30.gif"/></alternatives></inline-formula> random organisms survive—Run 2). Our main interest with this proof of concept is to ensure realistic results at three main levels: 1. sequence evolution simulation, 2. GRN and development evolution simulation, and 3. the link between sequence and regulatory mutations. For the mutation rate per base per generation <italic>μ</italic>, we used as a conservative measure, 5.33333e-6 (this represents a suitable starting point for a genome of this size—but see manual for detailed recommended settings for this and all other parameters, as well as benchmarks on how time increases with increasing parameter values). This rate, over the 20,000 generations is expected to produce patristic distances of 0.1066666 subtitutions per site if no selection is present. We cannot provide a fair comparison of these POCs with pre-existing probability-based sequence evolution simulators because functional sequence co-evolution—CastNet’s main feature—is not included in the most widely used simulators.<fig id="Fig1"><label>Fig. 1</label><caption><p>Experimental data from Runs 1 and 2 of the CastNet proof-of-concept. <bold>A</bold>–<bold>D</bold> shows results for Run 1 (stringent selection), and <bold>E</bold>–<bold>H</bold> for Run 2 (no selection). <bold>A</bold> and <bold>E</bold> show the target phylogenies, <bold>B</bold> and <bold>F</bold> the gene trees, <bold>C</bold> and <bold>G</bold> the mean population fitness progression (sampled every 100 generations, for 20,000 generations), and <bold>D</bold> and <bold>H</bold> in what proportion of the population each gene was expressed</p></caption><graphic xlink:href="12859_2023_5366_Fig1_HTML" id="MO3"/></fig></p>
    <sec id="Sec6">
      <title>Run 1: stringent selection</title>
      <p id="Par19">Sequence evolution was simulated effectively in parallel for all five genes, as all gene trees show the intended topology (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). Interestingly, there are gene-specific evolutionary patterns, although larger replicates are needed to determine how they reflect the evolution of regulatory parameters. Ideally, one would have multiple replicates for statistical power, as well as a reliable metric that compares gene trees within tree space and identifies co-variation of branch lengths. Combined with the (known) variation of the regulatory parameters, one could identify patterns that link regulatory evolution to sequence evolution. In this POC, regulatory parameter evolution was also successfully simulated, as it is reflected in the mean fitness traces with strong positive selection in the first few thousand generations, and a stabilization in a local optimum for the remainder of the run on all branches (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C). Finally, gene participation is strongly selected for, as in the founder population, Gene 3 is only activated in 1% of the population, whereas in all subsequent lineages this number is 100% (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). The fact that Gene 4 is never activated is also evident in the number of stop codons each lineage’s sequence has (Lineage A: 13, Lineage B: 12, Lineage C: 12, Lineage D: 15), showing that sequences of genes not involved in the normal operation of gene expression will accumulate stop codons, as would be expected from a silenced gene. Thus, this simulation run confirms that CastNet is effective at all three levels initially sought: simulating sequence evolution, simulating the evolution of regulation, and passing selective signals from the regulatory network onto the genomic sequence.</p>
    </sec>
    <sec id="Sec7">
      <title>Run 2: no selection</title>
      <p id="Par20">Without selection, gene trees still follow the correct phylogeny, but no longer show gene-specific branch length patterns (Fig. <xref rid="Fig1" ref-type="fig">1</xref>F). The generalized branch length pattern confirms the hypothesis stated above that under no selection, the patristic distances of the tip lineages should be close to 0.1. The stochastic way of exploring the fitness landscape when there is no selection is clear on (Fig. <xref rid="Fig1" ref-type="fig">1</xref>G), where it progresses in a much less structured way than on Fig. <xref rid="Fig1" ref-type="fig">1</xref>D, where selection was present. In addition, we also noticed that selection for gene participation was virtually non-existent in comparison to Run 1, as most genes were inactive throughout most of the tree (Fig. <xref rid="Fig1" ref-type="fig">1</xref>H). The only ones still expressed are Genes 1 and 5, which are both needed in order for a system to exist, and will be present regardless of nonsense mutations in their sequences. In this case, Gene 1 indeed has accumulated nonsense mutations (Gene 1 is always expressed because it is the one that kick-starts development), therefore under more realistic conditions this whole population would have potentially gone extinct.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Conclusion</title>
    <p id="Par21">The sequence simulator presented can effectively simulate the evolution of coding sequences which coevolve due to functional links and have a concrete output as developmental profiles. We envisage that CastNet will serve to address many new and old questions from phylogenetics; for example, to what extent can coevolutionary interactions between genes or systems (regulatory or otherwise) be modelled by measuring sequence covariation through time (given appropriate methods and sample sizes). Additionally, CastNet sets ‘number of generations’ and ‘mutation rate’ as separate parameters, unlike the probabilistic models currently used to infer and ultimately simulate phylogenies, in which branch length is a combination of both values. This feature enables a rigorous exploration of systematic biases like long branch attraction, and how to better manage them, as well as testing for the accuracy of time-tree inference programs, which are methods designed to reliably disentangle time (= number of generations) and mutation rate from observed samples.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec9">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5366_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Detailed explanation of all fitness criteria, and how they are combined to produce one value.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Juan I. Montoya-Burgos, Owen McMillan, Russell Garwood, Robert Sansom, Davide Pisani, and Afa Juste for their comments and suggestions to improve the algorithm and code presented here.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>CJRR developed and implemented the algorithm, DJ reviewed the code and helped to optimize it, and both authors wrote the manuscript. Both authors read and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project was funded by a Marie Skłodowska–Curie Actions to CJRR (project 892606-RipGEESE).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The CastNet script as well as the datasets used in these papers and the R and Python scripts used to make the results figures are available on <ext-link ext-link-type="uri" xlink:href="https://github.com/carlosj-rr/CastNet">https://github.com/carlosj-rr/CastNet</ext-link>. Project name: CastNet. Project homepage: <ext-link ext-link-type="uri" xlink:href="https://github.com/carlosj-rr/CastNet">https://github.com/carlosj-rr/CastNet</ext-link>. Operating system: Platform independent. Programming language: Python 3.9.7. Other requirements: NumPy 1.20.3, Matplotlib 3.5.2, tqdm 4.64.1, scipy 1.9.0, gif 22.5.0. License: GNU GPL v3. Any restriction to use by non-academics: license needed.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par22">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par23">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par24">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>PAML 4: phylogenetic analysis by maximum likelihood</article-title>
        <source>Mol Biol Evol</source>
        <year>2007</year>
        <volume>24</volume>
        <fpage>1586</fpage>
        <lpage>1591</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msm088</pub-id>
        <?supplied-pmid 17483113?>
        <pub-id pub-id-type="pmid">17483113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grassly</surname>
            <given-names>NC</given-names>
          </name>
        </person-group>
        <article-title>Seq-gen: An application for the monte carlo simulation of dna sequence evolution along phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <year>1997</year>
        <volume>13</volume>
        <fpage>235</fpage>
        <lpage>238</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/13.3.235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hall</surname>
            <given-names>BG</given-names>
          </name>
        </person-group>
        <article-title>Simulating DNA coding sequence evolution with EvolveAGene 3</article-title>
        <source>Mol Biol Evol</source>
        <year>2008</year>
        <volume>25</volume>
        <fpage>688</fpage>
        <lpage>695</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msn008</pub-id>
        <?supplied-pmid 18192698?>
        <pub-id pub-id-type="pmid">18192698</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fletcher</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>INDELible: a flexible simulator of biological sequence evolution</article-title>
        <source>Mol Biol Evol</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>1879</fpage>
        <lpage>1888</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp098</pub-id>
        <?supplied-pmid 19423664?>
        <pub-id pub-id-type="pmid">19423664</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ly-Trong</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Naser-Khdour</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lanfear</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
        </person-group>
        <article-title>AliSim: a fast and versatile phylogenetic sequence simulator for the genomic era</article-title>
        <source>Mol Biol Evol</source>
        <year>2021</year>
        <volume>39</volume>
        <issue>5</issue>
        <fpage>msac092</fpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msac092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Molecular phylogenetics: principles and practice</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>303</fpage>
        <lpage>314</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3186</pub-id>
        <?supplied-pmid 22456349?>
        <pub-id pub-id-type="pmid">22456349</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Yang Z. Simulating molecular evolution. In: Molecular evolution: a statistical approach. 2014. Oxford University Press (Oxford, UK). p. 418–41.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yeang</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Detecting coevolution in and among protein domains</article-title>
        <source>PLoS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>2122</fpage>
        <lpage>2134</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0030211</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>AAT</given-names>
          </name>
          <name>
            <surname>Abi-Rached</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Galtier</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bernard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Montoya-Burgos</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Chenuil</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Positive selection on sperm ion channels in a brooding brittle star: consequence of life-history traits evolution</article-title>
        <source>Mol Ecol</source>
        <year>2017</year>
        <volume>26</volume>
        <fpage>3744</fpage>
        <lpage>3759</lpage>
        <pub-id pub-id-type="doi">10.1111/mec.14024</pub-id>
        <?supplied-pmid 28099777?>
        <pub-id pub-id-type="pmid">28099777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crotty</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Bean</surname>
            <given-names>NG</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Tuke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jermiin</surname>
            <given-names>LS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GHOST: recovering historical signal from heterotachously-evolved sequence alignments</article-title>
        <source>Syst Biol</source>
        <year>2020</year>
        <volume>69</volume>
        <fpage>249</fpage>
        <lpage>264</lpage>
        <?supplied-pmid 31364711?>
        <pub-id pub-id-type="pmid">31364711</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Evolution of gene networks by gene duplications: a mathematical model and its implications on genome organization</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1994</year>
        <volume>91</volume>
        <fpage>4387</fpage>
        <lpage>4391</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.91.10.4387</pub-id>
        <?supplied-pmid 8183919?>
        <pub-id pub-id-type="pmid">8183919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Does evolutionary plasticity evolve?</article-title>
        <source>Evolution (N Y)</source>
        <year>1996</year>
        <volume>50</volume>
        <fpage>1008</fpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ciliberti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>OC</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Robustness can evolve gradually in complex regulatory gene networks with varying topology</article-title>
        <source>PLoS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>0164</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0030015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fierst</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Modeling the evolution of complex genetic systems: the gene network family tree</article-title>
        <source>J Exp Zool Part B Mol Dev Evol</source>
        <year>2015</year>
        <volume>324</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1002/jez.b.22597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kittelmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buffry</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Franke</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Almudi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Yoth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sabaris</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene regulatory network architecture in different developmental contexts influences the genetic basis of morphological evolution</article-title>
        <source>PLoS Genet</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>1</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1007375</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Espinosa-Soto</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>On the role of sparseness in the evolution of modularity in gene regulatory networks</article-title>
        <source>PLoS Comput Biol</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>1</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006172</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>González-Forero</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>How development affects evolution</article-title>
        <source>Evolution (N Y)</source>
        <year>2023</year>
        <volume>77</volume>
        <fpage>562</fpage>
        <lpage>579</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mitchell</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>An introduction to genetic algorithms</source>
        <year>1998</year>
        <publisher-loc>Cambridge, Massachusetts</publisher-loc>
        <publisher-name>MIT Press</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10259028</article-id>
    <article-id pub-id-type="publisher-id">5366</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05366-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CastNet: a systems-level sequence evolution simulator</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Rivera-Rivera</surname>
          <given-names>Carlos J.</given-names>
        </name>
        <address>
          <email>carlos.riverarivera@bristol.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grbic</surname>
          <given-names>Djordje</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5337.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7603</institution-id><institution>University of Bristol, </institution></institution-wrap>Life Sciences Building, 24 Tyndall Avenue, Bristol, BS8 1TG UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.5254.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 0674 042X</institution-id><institution>IT-University of Copenhagen, </institution></institution-wrap>Rued Langgaards Vej 7, 2300 Copenhagen, Denmark </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>247</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Simulating DNA evolution has been done through coevolution-agnostic probabilistic frameworks for the past 3 decades. The most common implementation is by using the converse of the probabilistic approach used to infer phylogenies which, in the simplest form, simulates a single sequence at a time. However, biological systems are multi-genic, and gene products can affect each other’s evolutionary paths through coevolution. These crucial evolutionary dynamics still remain to be simulated, and we believe that modelling them can lead to profound insights for comparative genomics.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here we present CastNet, a genome evolution simulator that assumes each genome is a collection of genes with constantly evolving regulatory interactions in between them. The regulatory interactions produce a phenotype in the form of gene expression profiles, upon which fitness is calculated. A genetic algorithm is then used to evolve a population of such entities through a user-defined phylogeny. Importantly, the regulatory mutations are a response to sequence mutations, thus making a 1–1 relationship between the rate of evolution of sequences and of regulatory parameters. This is, to our knowledge, the first time the evolution of sequences and regulation have been explicitly linked in a simulation, despite there being a multitude of sequence evolution simulators, and a handful of models to simulate Gene Regulatory Network (GRN) evolution. In our test runs, we see a coevolutionary signal among genes that are active in the GRN, and neutral evolution in genes that are not included in the network, showing that selective pressures imposed on the regulatory output of the genes are reflected in their sequences.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">We believe that CastNet represents a substantial step for developing new tools to study genome evolution, and more broadly, coevolutionary webs and complex evolving systems. This simulator also provides a new framework to study molecular evolution where sequence coevolution has a leading role.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05366-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Evolution simulation</kwd>
      <kwd>Evo-devo</kwd>
      <kwd>Complex systems</kwd>
      <kwd>Gene regulatory networks</kwd>
      <kwd>Evolutionary systems</kwd>
      <kwd>Coevolutionary webs</kwd>
      <kwd>Coevolution</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100018694</institution-id>
            <institution>HORIZON EUROPE Marie Sklodowska-Curie Actions</institution>
          </institution-wrap>
        </funding-source>
        <award-id>892606-RipGEESE</award-id>
        <principal-award-recipient>
          <name>
            <surname>Rivera-Rivera</surname>
            <given-names>Carlos J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">DNA and amino acid sequence evolution have traditionally been simulated through probabilistic models that infer substitutions on a single sequence in a branch-independent manner [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. These methods do not allow for gene coevolution by principle, since they simulate the evolution of a single sequence, one branch at a time [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], impeding by design the simulation of coevolving sequences. Biological evolution, however, has a diversity of examples in which sequence coevolution within and across lineages is evident and often pervasive (e.g. [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]).</p>
    <p id="Par5">The evolution of networks of interacting genes, or gene regulatory networks (GRNs) has been studied with simulations since the landmark models of Wagner [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. These studies, and related ones that followed (e.g. [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]) focus on the structural properties of GRNs that emerge due to the evolutionary process. One of these studies identified that robustness to mutation can emerge spontaneously through evolution, via the modification the GRN topology, thus ensuring consistent developmental results from networks that were slightly dissimilar [<xref ref-type="bibr" rid="CR13">13</xref>]. Many of these studies find that structural properties of the GRNs affect a system’s access to phenotypic spaces, or its evolvability, a crucial component of evolving systems we should understand in an environment that is changing at an ever-faster pace. The insights into evolutionary dynamics these studies achieved are ground-breaking and, in our view, still warrant additional study.</p>
    <p id="Par6">The studies of sequence and GRN evolution have remained separate so far. The most obvious reasoning for this is that the evolution of regulation is expected to influence regulatory sequences, rather than protein-coding sequences. However, biological examples of sequence coevolution observed directly on protein-coding sequences led us to propose a simulator in which GRN evolution and sequence evolution are explicitly linked. This simulator enables exploration into the extent to which the coevolutionary links among gene products constrain or channel sequence evolution. Such a system also allows for a simulation-driven test of the analytical proofs by González-Forero [<xref ref-type="bibr" rid="CR17">17</xref>], and can help to determine whether developmental information can be extracted solely from sequence evolution.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par7">Here we present CastNet, a highly customizable software for simulating the evolution of virtual organisms composed of genomes and proteomes, where genes are functionally linked.</p>
    <sec id="Sec3">
      <title>Virtual organism structure</title>
      <p id="Par8">CastNet creates a genome of a user-defined size in nucleotides, <italic>n</italic> × <italic>l</italic> (<italic>n</italic> = number of genes, <italic>l</italic> = sequence length in base pairs). The simulated genome is built by randomly sampling codons under a uniform distribution. CastNet then creates a regulatory matrix <bold><italic>R</italic></bold> of size <italic>n</italic> × <italic>n</italic>, which encodes the regulatory effects each gene of the system has on all other genes, and the regulatory effect that all genes have on each gene. The values in this matrix are sampled from a uniform distribution within a user-defined range that ideally includes negative (downregulation/repression) as well as positive (upregulation/activation) values, and then a mask is used to turn a user-defined proportion of cells to 0, to enforce sparseness. There are two additional gene-specific regulatory parameters: (1) a threshold <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M2"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq1.gif"/></alternatives></inline-formula> indicating the minimum activating signal that needs to be received by each gene in order for it to be expressed (from Espinosa-Soto 2008 [<xref ref-type="bibr" rid="CR16">16</xref>]), and (2) A gene-specific decay rate <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M4"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq2.gif"/></alternatives></inline-formula> determining how quickly each gene’s amount decreases with time under an exponential decay model.</p>
    </sec>
    <sec id="Sec4">
      <title>Simulating development</title>
      <p id="Par9">With the regulatory parameters <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{R}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq3.gif"/></alternatives></inline-formula>, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\lambda}} = \user2{ }\left[ {\lambda_{G1,} \lambda_{G2} , \ldots ,\lambda_{Gn} } \right]$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow/><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">Gn</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq4.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\theta}} = \left[ {\theta_{G1} ,\theta_{G2} , \ldots ,\theta_{Gn} } \right]$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="italic">Gn</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq5.gif"/></alternatives></inline-formula>, CastNet simulates the development of a system through a time-discrete Markov Chain by calculating the gene quantities vector <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{q}}_{t}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq6.gif"/></alternatives></inline-formula> at each step <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M14"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq7.gif"/></alternatives></inline-formula>, following:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{q}}_{{\varvec{t}}} = \left( {{\varvec{ReLU}}_{{\uptheta }} \left( {{\mathbf{R}} \cdot {\varvec{q}}_{{{\varvec{t}} - 1}} } \right) + {\varvec{q}}_{{{\varvec{t}} - 1}} e^{{ - {\uplambda }}} } \right)*{\varvec{c}}$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ReLU</mml:mi></mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold">R</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mrow/><mml:mo>∗</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2023_5366_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{q}}_{t} = \left[ {q_{G1} \left( t \right),q_{G2} \left( t \right), \ldots ,q_{Gn} \left( t \right)} \right]$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="italic">Gn</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq8.gif"/></alternatives></inline-formula> is a vector of size <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M20"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq9.gif"/></alternatives></inline-formula> with the quantity <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_{Gi} \left( t \right)$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="italic">Gi</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq10.gif"/></alternatives></inline-formula> of each gene at time <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M24"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq11.gif"/></alternatives></inline-formula> (quantities are in arbitrary units), <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{q}}_{t - 1} = \left[ {q_{G1} \left( {t - 1} \right),q_{G2} \left( {t - 1} \right), \ldots ,q_{Gn} \left( {t - 1} \right)} \right]$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="italic">Gn</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq12.gif"/></alternatives></inline-formula> is the gene quantities in the prior step of the chain, <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ReLU_{\theta }$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq13.gif"/></alternatives></inline-formula> is a rectifier function that rectifies to 0 any value below each gene’s activation threshold <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta_{Gi}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="italic">Gi</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq14.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}} = \left[ {{\varvec{c}}_{G1} ,{\varvec{c}}_{G2} , \ldots ,{\varvec{c}}_{Gn} } \right]$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">Gn</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq15.gif"/></alternatives></inline-formula> is a vector of size <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M34"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq16.gif"/></alternatives></inline-formula> that has a zero if the gene has a stop codon, and one otherwise. <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq17.gif"/></alternatives></inline-formula> multiplies by 0 the quantities of any gene which shows a nonsense mutation (i.e. with a stop codon mid-sequence), and by one that of genes with an intact open reading frame. This Markov chain is run for a user-defined number of developmental steps <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M38"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq18.gif"/></alternatives></inline-formula>, using an arbitrary seed quantity of 1 for the first gene in the list, and 0 for all other genes. This recursive operation results in an expression matrix <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{E}}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq19.gif"/></alternatives></inline-formula> of size <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M42"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq20.gif"/></alternatives></inline-formula> × <inline-formula id="IEq21"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M44"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq21.gif"/></alternatives></inline-formula>, which can be interpreted as gene expression profiles for all genes in the system (Algorithm <xref rid="Figa" ref-type="fig">1</xref>). This simulation of development assumes that all genes are monoexonic and have single isoform, and that regulation is happening exclusively at the level of transcription (similar to Wagner’s model in [<xref ref-type="bibr" rid="CR11">11</xref>]).</p>
      <p id="Par10">
        <fig position="anchor" id="Figa">
          <graphic position="anchor" xlink:href="12859_2023_5366_Figa_HTML" id="MO1"/>
        </fig>
      </p>
      <p id="Par11">A standard genetic algorithm (GA) [<xref ref-type="bibr" rid="CR18">18</xref>] is used to simulate evolution in this system (Algorithm <xref rid="Figb" ref-type="fig">2</xref>). Broadly, the mutation of an organism in each generation occurs in the following steps:<list list-type="order"><list-item><p id="Par12">Mutate the genome sequence based on a user-defined ‘probability of a point mutation per base, per generation’ rate <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M46"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq22.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par13">Assign each mutation to the gene in which it happened, and whether they are synonymous, non-synonymous, or nonsense mutations.</p></list-item><list-item><p id="Par14">For each mutation, mutate any regulatory value from the corresponding gene, reflecting their synonymous or non-synonymous nature. Non-synonymous mutations will occur in links which are known to be active (e.g., a gene that is expressed in the parental expression matrix <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{E}}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq23.gif"/></alternatives></inline-formula>), whereas synonymous mutations would occur in links which are known to be inactive (e.g., parental expression matrix <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{E}}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq24.gif"/></alternatives></inline-formula> shows no activation of that specific link). Synonymous regulatory mutations are intended to allow for ‘under the hood’ or hidden regulatory changes, which do not have a measurable effect in the actual GRN but would allow for larger innovations if the mutated gene is activated.. Whether a mutation occurs on regulatory parameters <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\theta}}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq25.gif"/></alternatives></inline-formula> or <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\lambda}}$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq26.gif"/></alternatives></inline-formula> is determined by the proportion of regulatory values these two vectors represent (<inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{2}{2 + n}$$\end{document}</tex-math><mml:math id="M56"><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq27.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq28"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M58"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq28.gif"/></alternatives></inline-formula> is the number of genes).</p></list-item></list></p>
      <p id="Par15">The following assumptions are in place in the mutational process: 1. Point mutations are equally likely across the genome (i.e. no site rate heterogeneity), and each mutation will result in any of the other three nucleotides with equal probability (i.e. follows a JC model), 2. The <italic>location</italic> of a mutation in the sequence is independent from the regulatory mutation, 3. The reproductive system is clonal, haploid, and does not have recombination, 4. Insertions/deletions, and gene/genome duplications do not occur, 5. Regulatory, evolutionary and fitness parameters are branch-specific unless otherwise enforced by the user.</p>
      <p id="Par16">The phenotype upon which fitness is measured is the output of the regulatory parameters (i.e., the gene expression profiles). Four metrics are used to evaluate the fitness of each gene expression profile: gene quantities must not increase exponentially; the more genes activated in the system, the fitter the organism; gene expression should be as stable as possible; and the system must have reached maturity (indicated by an arbitrary gene having passed a user-defined threshold in quantity, and being expressed in the final developmental step). Specific details on how these metrics are calculated are in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, and in the manual at the CastNet homepage.</p>
      <p id="Par17">CastNet then allows populations of such systems to evolve through user-defined branches, and numbers of generations, and in the end, will have multiple sequences simulated for each GRN, following the selective pressures imposed on the gene expression profile. CastNet simulates the evolution of multi-genic systems branch by branch, and the way the outputs are organized makes changing evolutionary parameters mid-branch relatively easy. This feature permits the simulation of branch-specific (or generation-specific within one branch) changes in rates of evolution, population size, and selective strategies.<fig position="anchor" id="Figb"><graphic position="anchor" xlink:href="12859_2023_5366_Figb_HTML" id="MO2"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results</title>
    <p id="Par18">We ran a proof con concept (POC) of CastNet with two simulated test runs of four lineages, five genes of 3000 bp each, and 20,000 generations, using a fully symmetrical tree (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A and E), a selection proportion of <italic>p</italic> = <italic>0.1</italic>, but with two different selection strategies: ‘high pressure’ (only fittest <inline-formula id="IEq29"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M60"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq29.gif"/></alternatives></inline-formula> survive—Run 1), and ‘totally relaxed’ (<inline-formula id="IEq30"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p$$\end{document}</tex-math><mml:math id="M62"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5366_Article_IEq30.gif"/></alternatives></inline-formula> random organisms survive—Run 2). Our main interest with this proof of concept is to ensure realistic results at three main levels: 1. sequence evolution simulation, 2. GRN and development evolution simulation, and 3. the link between sequence and regulatory mutations. For the mutation rate per base per generation <italic>μ</italic>, we used as a conservative measure, 5.33333e-6 (this represents a suitable starting point for a genome of this size—but see manual for detailed recommended settings for this and all other parameters, as well as benchmarks on how time increases with increasing parameter values). This rate, over the 20,000 generations is expected to produce patristic distances of 0.1066666 subtitutions per site if no selection is present. We cannot provide a fair comparison of these POCs with pre-existing probability-based sequence evolution simulators because functional sequence co-evolution—CastNet’s main feature—is not included in the most widely used simulators.<fig id="Fig1"><label>Fig. 1</label><caption><p>Experimental data from Runs 1 and 2 of the CastNet proof-of-concept. <bold>A</bold>–<bold>D</bold> shows results for Run 1 (stringent selection), and <bold>E</bold>–<bold>H</bold> for Run 2 (no selection). <bold>A</bold> and <bold>E</bold> show the target phylogenies, <bold>B</bold> and <bold>F</bold> the gene trees, <bold>C</bold> and <bold>G</bold> the mean population fitness progression (sampled every 100 generations, for 20,000 generations), and <bold>D</bold> and <bold>H</bold> in what proportion of the population each gene was expressed</p></caption><graphic xlink:href="12859_2023_5366_Fig1_HTML" id="MO3"/></fig></p>
    <sec id="Sec6">
      <title>Run 1: stringent selection</title>
      <p id="Par19">Sequence evolution was simulated effectively in parallel for all five genes, as all gene trees show the intended topology (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). Interestingly, there are gene-specific evolutionary patterns, although larger replicates are needed to determine how they reflect the evolution of regulatory parameters. Ideally, one would have multiple replicates for statistical power, as well as a reliable metric that compares gene trees within tree space and identifies co-variation of branch lengths. Combined with the (known) variation of the regulatory parameters, one could identify patterns that link regulatory evolution to sequence evolution. In this POC, regulatory parameter evolution was also successfully simulated, as it is reflected in the mean fitness traces with strong positive selection in the first few thousand generations, and a stabilization in a local optimum for the remainder of the run on all branches (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C). Finally, gene participation is strongly selected for, as in the founder population, Gene 3 is only activated in 1% of the population, whereas in all subsequent lineages this number is 100% (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). The fact that Gene 4 is never activated is also evident in the number of stop codons each lineage’s sequence has (Lineage A: 13, Lineage B: 12, Lineage C: 12, Lineage D: 15), showing that sequences of genes not involved in the normal operation of gene expression will accumulate stop codons, as would be expected from a silenced gene. Thus, this simulation run confirms that CastNet is effective at all three levels initially sought: simulating sequence evolution, simulating the evolution of regulation, and passing selective signals from the regulatory network onto the genomic sequence.</p>
    </sec>
    <sec id="Sec7">
      <title>Run 2: no selection</title>
      <p id="Par20">Without selection, gene trees still follow the correct phylogeny, but no longer show gene-specific branch length patterns (Fig. <xref rid="Fig1" ref-type="fig">1</xref>F). The generalized branch length pattern confirms the hypothesis stated above that under no selection, the patristic distances of the tip lineages should be close to 0.1. The stochastic way of exploring the fitness landscape when there is no selection is clear on (Fig. <xref rid="Fig1" ref-type="fig">1</xref>G), where it progresses in a much less structured way than on Fig. <xref rid="Fig1" ref-type="fig">1</xref>D, where selection was present. In addition, we also noticed that selection for gene participation was virtually non-existent in comparison to Run 1, as most genes were inactive throughout most of the tree (Fig. <xref rid="Fig1" ref-type="fig">1</xref>H). The only ones still expressed are Genes 1 and 5, which are both needed in order for a system to exist, and will be present regardless of nonsense mutations in their sequences. In this case, Gene 1 indeed has accumulated nonsense mutations (Gene 1 is always expressed because it is the one that kick-starts development), therefore under more realistic conditions this whole population would have potentially gone extinct.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Conclusion</title>
    <p id="Par21">The sequence simulator presented can effectively simulate the evolution of coding sequences which coevolve due to functional links and have a concrete output as developmental profiles. We envisage that CastNet will serve to address many new and old questions from phylogenetics; for example, to what extent can coevolutionary interactions between genes or systems (regulatory or otherwise) be modelled by measuring sequence covariation through time (given appropriate methods and sample sizes). Additionally, CastNet sets ‘number of generations’ and ‘mutation rate’ as separate parameters, unlike the probabilistic models currently used to infer and ultimately simulate phylogenies, in which branch length is a combination of both values. This feature enables a rigorous exploration of systematic biases like long branch attraction, and how to better manage them, as well as testing for the accuracy of time-tree inference programs, which are methods designed to reliably disentangle time (= number of generations) and mutation rate from observed samples.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec9">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5366_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Detailed explanation of all fitness criteria, and how they are combined to produce one value.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Juan I. Montoya-Burgos, Owen McMillan, Russell Garwood, Robert Sansom, Davide Pisani, and Afa Juste for their comments and suggestions to improve the algorithm and code presented here.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>CJRR developed and implemented the algorithm, DJ reviewed the code and helped to optimize it, and both authors wrote the manuscript. Both authors read and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project was funded by a Marie Skłodowska–Curie Actions to CJRR (project 892606-RipGEESE).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The CastNet script as well as the datasets used in these papers and the R and Python scripts used to make the results figures are available on <ext-link ext-link-type="uri" xlink:href="https://github.com/carlosj-rr/CastNet">https://github.com/carlosj-rr/CastNet</ext-link>. Project name: CastNet. Project homepage: <ext-link ext-link-type="uri" xlink:href="https://github.com/carlosj-rr/CastNet">https://github.com/carlosj-rr/CastNet</ext-link>. Operating system: Platform independent. Programming language: Python 3.9.7. Other requirements: NumPy 1.20.3, Matplotlib 3.5.2, tqdm 4.64.1, scipy 1.9.0, gif 22.5.0. License: GNU GPL v3. Any restriction to use by non-academics: license needed.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par22">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par23">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par24">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>PAML 4: phylogenetic analysis by maximum likelihood</article-title>
        <source>Mol Biol Evol</source>
        <year>2007</year>
        <volume>24</volume>
        <fpage>1586</fpage>
        <lpage>1591</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msm088</pub-id>
        <?supplied-pmid 17483113?>
        <pub-id pub-id-type="pmid">17483113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grassly</surname>
            <given-names>NC</given-names>
          </name>
        </person-group>
        <article-title>Seq-gen: An application for the monte carlo simulation of dna sequence evolution along phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <year>1997</year>
        <volume>13</volume>
        <fpage>235</fpage>
        <lpage>238</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/13.3.235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hall</surname>
            <given-names>BG</given-names>
          </name>
        </person-group>
        <article-title>Simulating DNA coding sequence evolution with EvolveAGene 3</article-title>
        <source>Mol Biol Evol</source>
        <year>2008</year>
        <volume>25</volume>
        <fpage>688</fpage>
        <lpage>695</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msn008</pub-id>
        <?supplied-pmid 18192698?>
        <pub-id pub-id-type="pmid">18192698</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fletcher</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>INDELible: a flexible simulator of biological sequence evolution</article-title>
        <source>Mol Biol Evol</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>1879</fpage>
        <lpage>1888</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp098</pub-id>
        <?supplied-pmid 19423664?>
        <pub-id pub-id-type="pmid">19423664</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ly-Trong</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Naser-Khdour</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lanfear</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
        </person-group>
        <article-title>AliSim: a fast and versatile phylogenetic sequence simulator for the genomic era</article-title>
        <source>Mol Biol Evol</source>
        <year>2021</year>
        <volume>39</volume>
        <issue>5</issue>
        <fpage>msac092</fpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msac092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Molecular phylogenetics: principles and practice</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>303</fpage>
        <lpage>314</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3186</pub-id>
        <?supplied-pmid 22456349?>
        <pub-id pub-id-type="pmid">22456349</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Yang Z. Simulating molecular evolution. In: Molecular evolution: a statistical approach. 2014. Oxford University Press (Oxford, UK). p. 418–41.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yeang</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Detecting coevolution in and among protein domains</article-title>
        <source>PLoS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>2122</fpage>
        <lpage>2134</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0030211</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>AAT</given-names>
          </name>
          <name>
            <surname>Abi-Rached</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Galtier</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bernard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Montoya-Burgos</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Chenuil</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Positive selection on sperm ion channels in a brooding brittle star: consequence of life-history traits evolution</article-title>
        <source>Mol Ecol</source>
        <year>2017</year>
        <volume>26</volume>
        <fpage>3744</fpage>
        <lpage>3759</lpage>
        <pub-id pub-id-type="doi">10.1111/mec.14024</pub-id>
        <?supplied-pmid 28099777?>
        <pub-id pub-id-type="pmid">28099777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crotty</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Bean</surname>
            <given-names>NG</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Tuke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jermiin</surname>
            <given-names>LS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GHOST: recovering historical signal from heterotachously-evolved sequence alignments</article-title>
        <source>Syst Biol</source>
        <year>2020</year>
        <volume>69</volume>
        <fpage>249</fpage>
        <lpage>264</lpage>
        <?supplied-pmid 31364711?>
        <pub-id pub-id-type="pmid">31364711</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Evolution of gene networks by gene duplications: a mathematical model and its implications on genome organization</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1994</year>
        <volume>91</volume>
        <fpage>4387</fpage>
        <lpage>4391</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.91.10.4387</pub-id>
        <?supplied-pmid 8183919?>
        <pub-id pub-id-type="pmid">8183919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Does evolutionary plasticity evolve?</article-title>
        <source>Evolution (N Y)</source>
        <year>1996</year>
        <volume>50</volume>
        <fpage>1008</fpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ciliberti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>OC</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Robustness can evolve gradually in complex regulatory gene networks with varying topology</article-title>
        <source>PLoS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>0164</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0030015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fierst</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Modeling the evolution of complex genetic systems: the gene network family tree</article-title>
        <source>J Exp Zool Part B Mol Dev Evol</source>
        <year>2015</year>
        <volume>324</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1002/jez.b.22597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kittelmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buffry</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Franke</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Almudi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Yoth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sabaris</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene regulatory network architecture in different developmental contexts influences the genetic basis of morphological evolution</article-title>
        <source>PLoS Genet</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>1</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1007375</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Espinosa-Soto</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>On the role of sparseness in the evolution of modularity in gene regulatory networks</article-title>
        <source>PLoS Comput Biol</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>1</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006172</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>González-Forero</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>How development affects evolution</article-title>
        <source>Evolution (N Y)</source>
        <year>2023</year>
        <volume>77</volume>
        <fpage>562</fpage>
        <lpage>579</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mitchell</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>An introduction to genetic algorithms</source>
        <year>1998</year>
        <publisher-loc>Cambridge, Massachusetts</publisher-loc>
        <publisher-name>MIT Press</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
