<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Blood Sci</journal-id>
    <journal-id journal-id-type="iso-abbrev">Blood Sci</journal-id>
    <journal-id journal-id-type="publisher-id">BLS</journal-id>
    <journal-title-group>
      <journal-title>Blood Science</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2543-6368</issn>
    <publisher>
      <publisher-name>Lippincott Williams &amp; Wilkins</publisher-name>
      <publisher-loc>Hagerstown, MD</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8974938</article-id>
    <article-id pub-id-type="publisher-id">BLS-21-002</article-id>
    <article-id pub-id-type="doi">10.1097/BS9.0000000000000072</article-id>
    <article-id pub-id-type="art-access-id">00003</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SIEVE: identifying robust single cell variable genes for single-cell RNA sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Yinan</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Xiaowei</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
        <xref rid="aff3" ref-type="aff">
          <sup>c</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Peng</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
        <xref rid="aff3" ref-type="aff">
          <sup>c</sup>
        </xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Ping</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
        <xref rid="aff3" ref-type="aff">
          <sup>c</sup>
        </xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
    </contrib-group>
    <aff id="aff1"><label>a</label>State Key Laboratory of Experimental Hematology, Institute of Hematology and Blood Diseases Hospital, Chinese Academy of Medical Sciences &amp; Peking Union Medical College, Tianjin 300020, China</aff>
    <aff id="aff2"><label>b</label>Department of Stem Cell &amp; Regenerative Medicine, Chinese Academy of Medical Sciences &amp; Peking Union Medical College, Tianjin 300020, China</aff>
    <aff id="aff3"><label>c</label>National Clinical Research Center for Blood Diseases, Center for Stem Cell Medicine, Chinese Academy of Medical Sciences, Tianjin 300020, China</aff>
    <author-notes id="cor1">
      <corresp><label>∗</label>Address correspondence: Peng Wu, PhD, and Ping Zhu, PhD, State Key Laboratory of Experimental Hematology, Institute of Hematology and Blood Diseases Hospital, No. 288 Nanjing Road, Heping District, Tianjin 300020, China. E-mail address: <email>wupeng1@ihcams.ac.cn</email> (P. Wu); <email>zhuping@ihcams.ac.cn</email> (P. Zhu)</corresp>
      <fn fn-type="COI-statement">
        <p>The authors declare no conflicts of interest.</p>
      </fn>
      <fn fn-type="other">
        <p>Supplemental digital content is available for this article.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <volume>3</volume>
    <issue>2</issue>
    <fpage>35</fpage>
    <lpage>39</lpage>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2021 The Authors. Published by Wolters Kluwer Health Inc., on behalf of the Chinese Association for Blood Sciences.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution-Non Commercial-No Derivatives License 4.0 (CCBY-NC-ND), where it is permissible to download and share the work provided it is properly cited. The work cannot be changed in any way or used commercially without permission from the journal. <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">http://creativecommons.org/licenses/by-nc-nd/4.0</ext-link></license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bls-3-35.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Single-cell RNA-seq data analysis generally requires quality control, normalization, highly variable genes screening, dimensionality reduction and clustering. Among these processes, downstream analysis including dimensionality reduction and clustering are sensitive to the selection of highly variable genes. Though increasing number of tools for selecting the highly variable genes have been developed, an evaluation of their performances and a general strategy are lack. Here, we compare the performance of nine commonly used methods for screening variable genes by using single-cell RNA-seq data from hematopoietic stem/progenitor cells and mature blood cells, and find that SCHS outperforms other methods regarding to reproducibility and accuracy. However, this method prefers the selection of highly expressed genes. We further propose a new strategy SIEVE (SIngle-cEll Variable gEnes) by multiple rounds of random sampling, therefore minimizing the stochastic noise and identifying a robust set of variable genes. Moreover, SIEVE recovers lowly expressed genes as variable genes and substantially improves the accuracy of single cell classification, especially for the methods with lower reproducibility. The SIEVE software is freely available at <ext-link xlink:href="https://github.com/YinanZhang522/SIEVE" ext-link-type="uri">https://github.com/YinanZhang522/SIEVE</ext-link>.</p>
    </abstract>
    <kwd-group>
      <title>Keywords</title>
      <kwd>Hematopoietic stem/progenitor cells</kwd>
      <kwd>Highly variable genes</kwd>
      <kwd>Single-cell RNA-seq</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>This work has been supported by the National Natural Science Foundation of China (82022002, 81900117, 81890993, 81890990, 32000803), National Key Research and Development Program of China (2018YFA0107804), CAMS Initiative for Innovative Medicine (2017-I2M-1-015, 2017-I2M-3-009, 2019-I2M-2-001) and Fundamental Research Funds for the Central Research Institutes (2020-RC310-005).</funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>OPEN-ACCESS</meta-name>
        <meta-value>TRUE</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec>
    <label>1</label>
    <title>INTRODUCTION</title>
    <p>In the past decades, next-generation sequencing technologies have provided unprecedented opportunities to explore single cell heterogeneity at genomics, transcriptomics and epigenomics levels.<sup><xref rid="R1" ref-type="bibr">1</xref>–<xref rid="R4" ref-type="bibr">4</xref></sup> Single-cell RNA sequencing (scRNA-seq) enables us to investigate the transcriptomes of thousands of single cells in complex multicellular organisms with lower costs.<sup><xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R6" ref-type="bibr">6</xref></sup> How to process the scRNA-seq data to reflect the biological significance has become a big challenge. In general, scRNA-seq data needs to be filtered out of low-quality data and normalized to eliminate background noise. Then, highly variable genes (HVGs) are selected and fed to dimensionality reduction and followed by clustering analysis.<sup><xref rid="R7" ref-type="bibr">7</xref>,<xref rid="R8" ref-type="bibr">8</xref></sup> Notably, advanced downstream analyses depend on the accurate determination of HVGs.</p>
    <p>Currently, multiple tools have been developed to identify HVGs. Representative methods include the M3Drop,<sup><xref rid="R9" ref-type="bibr">9</xref>,<xref rid="R10" ref-type="bibr">10</xref></sup> Scmap,<sup><xref rid="R11" ref-type="bibr">11</xref></sup> Scran,<sup><xref rid="R12" ref-type="bibr">12</xref></sup> Vst, SCTransform (SCT) and Disp in Seurat,<sup><xref rid="R13" ref-type="bibr">13</xref>,<xref rid="R14" ref-type="bibr">14</xref></sup> ROGUE, ROGUE using normalized value (ROGUE_n)<sup><xref rid="R15" ref-type="bibr">15</xref></sup> and singleCellHaystack (SCHS).<sup><xref rid="R16" ref-type="bibr">16</xref></sup> The M3Drop method identifies genes with higher variability than expected by analyzing the relationship between the square of the variation coefficient and the average expression. Scmap first checks the dropout rate of the single-cell matrix and then selects genes by the relationship between the average expression and dropout rate. Scran obtains HVGs through the variance of the logarithmic expression value and the mean expression value. Vst, SCT and Disp are all sourced from Seurat package. Vst uses local polynomial regression to fit the logarithmic variance to logarithmic mean value and calculates the variance based on the normalized values; SCT applies the regularized negative binomial regression to calculate the technical noise model and selects genes by Pearson residuals; Disp directly selects genes with the highest discrete values. A new method ROGUE recently published selects meaningful genes by fitting the relationship between the expression entropy values and the average expression levels. It can handle both the original counts and the normalized data, and we use ROGUE and ROGUE_n to represent them respectively. SCHS is initially designed to detect differentially expressed genes and identifies genes by the spatial distribution of cells.</p>
    <p>Here, we compare the performance of nine methods for identifying HVGs on scRNA-seq data of hematopoietic stem/progenitor cells (HSPCs) and mature blood cells separately, in terms of purity, reproducibility and accuracy. We further propose a new strategy SIEVE (SIngle-cEll Variable gEnes) by multiple rounds of random sampling to identify a robust set of variable genes. We show that SIEVE substantially improves the accuracy of single cell classification.</p>
  </sec>
  <sec>
    <label>2</label>
    <title>RESULTS</title>
    <sec>
      <label>2.1</label>
      <title>Overall experimental design</title>
      <p>In order to evaluate the performance of different methods for identifying HVGs, a general pipeline of scRNA-seq data analysis, including data preprocessing, HVGs selection, dimensionality reduction and clustering, was carried out on single cell transcriptomes of hematopoietic cells we recently published<sup><xref rid="R17" ref-type="bibr">17</xref></sup> (Fig. <xref rid="F1" ref-type="fig">1</xref><bold>A</bold>). Only in the HVGs selection step, nine different methods were applied, while the other steps followed the default settings in Seurat. The dataset covered a total of 7,551 single cells with 32 immunophenotypic cell types from fluorescent-activated cell sorting. The evaluation indicators used for the comparison of different methods were the purity of cell clustering, reproducibility of HVGs, and accuracy of cell classification.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p>Characterization of highly variable genes by different methods in the HSPC dataset. (A) Workflow for analysis of single-cell RNA-seq data and evaluation of HVG selection methods. A new strategy SIEVE (SIngle-cEll Variable gEnes) is proposed to improve the HVG selection. (B) HVGs by different methods are viewed in the relationship between standard deviation and average expression of genes. Each point represents one gene, light blue points mean HVGs and dark blue points mean other genes. The bar plot below each scatter plot presents the gene expression levels for HVGs. High, higher than the 3rd quartile (orange); median, between the 1st quartile and the 3rd quartile (yellow); low, lower than the 1st quartile (green).</p>
        </caption>
        <graphic xlink:href="bls-3-35-g001" position="float"/>
      </fig>
    </sec>
    <sec>
      <label>2.2</label>
      <title>Characterization of HVGs by different methods</title>
      <p>Most HVGs selection methods depend on the calculation of the relationship between the mean and variance of gene expression. We analyzed the distribution of 2,000 HVGs obtained by each method in hematopoietic cells and found that the average expression levels of these gene sets varied among these methods (Fig. <xref rid="F1" ref-type="fig">1</xref><bold>B</bold> and Supplementary Fig. S1A). About a quarter of genes reported by four methods, including M3Drop, Seurat_vst, Seurat_sct and Seurat_disp, expressed at a low level. In contrast, ROGUE, ROGUE_n and Scran methods chose almost no lowly expressed genes. However, over 85% of Scmap- and SCHS-derived genes were highly expressed genes (Supplementary Fig. S1B). In addition, the distribution of HVGs obtained by different methods in mature blood cells was consistent with that of stem/progenitor cells (Supplementary Fig. S1C).</p>
      <p>These distinct gene sets would inevitably lead to different results for downstream advanced analyses. When using HVGs selected by M3Drop to cluster HSPCs, clusters were separated from each other and there was more than one immunophenotypic cell type in each cluster. This might be relevant to the similarity of the transcriptome among HSPCs, and we cannot see the transcriptional continuum during hematopoietic stem cell (HSC) differentiation from the clusters resulted from M3Drop. While other methods had a relatively good distinguishing ability, even for HSPCs with very similar expression profiles. HSC was located at the apex of hematopoietic differentiation and produced complete progenitor cells of erythroid, myeloid and lymphoid lines, reflecting that the hematopoietic process was a continuous progress (Supplementary Fig. 1D). While each type of mature blood cell had its own relatively specific expression profile, a complete separation of erythrocyte cells, T cells, B cells and granulocytes was revealed by various methods (Supplementary Fig. 1E). We used the Calinski-Harabasz index and Davies-Bouldin index<sup><xref rid="R18" ref-type="bibr">18</xref></sup> to evaluate the different methods, where a higher Calinski-Harabasz index and a lower Davies-Bouldin index relate to a model with better separation between the clusters. M3Drop have the lowest Calinski-Harabasz index and the highest Davies-Bouldin index, indicating a relatively lower distinguishing capability. (Supplementary Fig. 1F, G). Conclusively, single cells containing very different transcriptome spectrum could be clustered better no matter which HVG selection method was applied.</p>
    </sec>
    <sec>
      <label>2.3</label>
      <title>Robustness of HVGs and downstream effects</title>
      <p>To compare the effects of HVGs on downstream analyses, we first calculated the purity of each cluster. The pure cluster here was defined as a cluster that had the identical function and state without variable genes. We observed that the purity of cell clusters generated by all methods was relatively high, maintaining above 90% in both HSPCs and mature blood cells (Fig. <xref rid="F2" ref-type="fig">2</xref><bold>A</bold>). ROGUE, Scmap and Scran were slightly inferior to the other methods.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p>Evaluation of different HVG selecting methods. (A) The purity of clusters defined by genes selected by different methods. Each point represents a value. (B) Reproducibility of HVGs selected by different methods. (C) Cell classification accuracy of different methods. (D) The relationship between the number of HVGs and classification accuracy. A smooth line was fitted for each method. The middle line shows the average value and the grey region indicates interquartile range.</p>
        </caption>
        <graphic xlink:href="bls-3-35-g002" position="float"/>
      </fig>
      <p>Next, we randomly sampled 70% of the total number of cells 50 times. Cells extracted each time were used as the reference set, and the remaining 30% cells were used as the query set. Applying each method on the reference set resulted in 2,000 HVGs each test. We first examined the reproducibility of different methods in identifying HVGs, the proportion of overlapped genes that reported by every two tests was used to indicate the reproducibility. We found that SCHS outperformed other methods in both HSPCs and mature blood cells (Fig. <xref rid="F2" ref-type="fig">2</xref><bold>B</bold>). Scran, Scmap and ROGUE had a relatively lower performance, with a stable reproducibility of 80% to 90%, while others showed the lowest reproducibility ranging from 50% to 70%. We also tested the effect of different sampling sizes on the reproducibility and found that the reproducibility was increased with the sampling size of reference set. However, when the sample size is the same, the differential performances of distinct methods were still consistent. (Supplementary Fig. 2A, B).</p>
      <p>Cell classification is a routine procedure to annotate cell types in newly generated datasets for integrative analyses. Therefore, we assessed the accuracy of cell classification that confounded by HVGs. During each round of random sampling, the HVGs were selected for the reference set by different methods. The random forest classifier was trained using the reference set and the corresponding selected genes, and then used to predict cell types in the remaining query set. Compared to the cell labels predefined using the total cell set, the classification accuracy could be calculated (Supplementary Fig. S2C, D). In HSPCs, the classification accuracy of majority methods ranged from 85 to 90% (Fig. <xref rid="F2" ref-type="fig">2</xref><bold>C</bold> left). Due to the high gene expression specificity of mature blood cells, the classification accuracy reached over 90% except for the M3Drop method (Fig. <xref rid="F2" ref-type="fig">2</xref><bold>C</bold> right). We further showed that the classification accuracy of these methods except M3Drop was not greatly affected by the number of HVGs (Fig. <xref rid="F2" ref-type="fig">2</xref><bold>D</bold>). Collectively, the selection of HVGs affected single cell classification to various degrees in these methods.</p>
    </sec>
    <sec>
      <label>2.4</label>
      <title>Optimized strategy for HVGs screening</title>
      <p>The low reproducibility of HVGs means that the corresponding gene selection method is unstable, affecting the purity of cell clustering and accuracy of cell classification. To further improve the performance of existing HVGs selection methods, we developed a strategy named SIEVE (SIngle-cEll Variable gEnes) (Fig. <xref rid="F3" ref-type="fig">3</xref><bold>A</bold>). Based on random sampling for all single cells in a scRNA-seq dataset, SIEVE provided the reproducibility estimation for HVGs selection method and screened robust HVGs for the following analysis. The average expression levels of HVGs after using SIEVE increased as compared to that before using SIEVE (Fig. <xref rid="F3" ref-type="fig">3</xref><bold>B</bold>, Supplementary Fig. S3C). The methods, such as M3Drop, Seurat, ROGUE and Scran, chose more median expression level genes than Scmap and SCHS, illustrating that HVGs selected by them had a wider dynamic range of expression. In addition, we clustered cells using different HVGs and calculated the cluster markers. For majority methods, the HVGs obtained by using SIEVE were more enriched in cell cluster markers than those without SIEVE (Fig. <xref rid="F3" ref-type="fig">3</xref><bold>C</bold>), demonstrating that SIEVE selected more biologically relevant genes.</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p>SIEVE improves the single-cell clustering. (A) Workflow for SIEVE. Based on random sampling for a scRNA-seq dataset, SIEVE provides the reproducibility estimation for HVG selection method and screens high frequency variable genes as the last HVGs used to the following dimensionality reduction. (B) The gene expression levels for HVGs after using SIEVE. High, higher than the 3rd quartile (orange); median, between the 1st quartile and the 3rd quartile (yellow); low, lower than the 1st quartile (green). (C) Comparation of the enrichment significances of HVGs on cluster markers between using SIEVE and without SIEVE. (D) The relationship between the number of repetitions and classification accuracy. The middle line shows mean and the grey region indicates interquartile range.</p>
        </caption>
        <graphic xlink:href="bls-3-35-g003" position="float"/>
      </fig>
      <p>Furthermore, SIEVE significantly enhanced the classification accuracy, in spite of the number of random sampling (Fig. <xref rid="F3" ref-type="fig">3</xref><bold>D</bold>). SIEVE geared the commonly used methods to select the most representative HVGs and effectively improve the cell clustering visualization, especially for those with lower reproducibility (Supplementary Fig. S3A, B). After applying SIEVE, the cell clustering of M3Drop and Seurat_disp were substantially advanced, the hematopoietic differentiation of erythroid, myeloid lines became clear.</p>
    </sec>
  </sec>
  <sec>
    <label>3</label>
    <title>DISCUSSION</title>
    <p>The performance of HVGs selection methods varies for different cell type data. For mature blood cells, these methods show highly consistent performances on purity of cell clustering and accuracy of cell type classification. By contrast, they perform differently in stem/progenitor cells. Probably, these differences are relevant to the transcriptional continuum during HSC differentiation. Hence, we adopt the strategy through multiple rounds of random sampling and sieve genes that are highly variable in single cells. These HVGs are more likely to represent cell heterogeneity and relevant to biological processes.</p>
    <p>As single-cell data sets may be different in cell types or data volumes, our proposed SIEVE is more flexible and generalized to commonly used methods during HVGs screening. For instance, when dealing with a data set from a large number of single cells, we can extract a smaller proportion of the data subset to shorten the calculation time and ensure the selection of robust HVGs. Our strategy is expected to be widely applied in a large amount of data and more gene selection methods.</p>
  </sec>
  <sec>
    <label>4</label>
    <title>MATERIALS AND METHODS</title>
    <sec>
      <label>4.1</label>
      <title>HVG selection methods</title>
      <p>The M3Drop method used the BrenneckeGetVariableGenes function. The Seurat_sct method was implemented with the SCTransform function in Seurat package. The Seurat_vst and Seurat_disp method were implemented with the FindVariableFeatures function in Seurat package. The ROGUE and ROGUE _n method were implemented with the SE_fun function in ROGUE package. The feature selection step in Scmap was implemented according to the selectFeatures function in scmap package. The step of the Scran method was copied from the source code of the pipeline of Scran. In addition, we implemented the SCHS method with haystack function in singleCellHaystack package.</p>
    </sec>
    <sec>
      <label>4.2</label>
      <title>Single-cell dimensionality reduction and cell clustering</title>
      <p>The read count of a given gene was quantified by the total number of distinct UMIs, and the raw UMIs of protein-coding genes were normalized by log<sub>2</sub> (TPM/10 + 1) (TPM: transcripts per million) for downstream analysis. The mean of the normalized data of one gene across all single cells was calculated as the average expression level, which was further divided into three levels: high (higher than the 3rd quartile), median (between the 1st quartile and the 3rd quartile) and low (lower than the 1st quartile). Single-cell dimensionality reduction and cell clustering were analyzed using different HVG sets by Seurat. We performed RunUMAP (dims = 1:8) and FindClusters (resolution = 0.6) to cluster single cells.</p>
    </sec>
    <sec>
      <label>4.3</label>
      <title>Comparison of purity, reproducibility and classification accuracy</title>
      <p>The purity index of cell cluster is calculated with the rogue function in ROGUE package. When the purity index is 1, it means there's no differentially expressed genes in the cluster. Gene expression matrix and cell labels were input with the parameter of that “sample” of all cells was set to “1”.<sup><xref rid="R15" ref-type="bibr">15</xref></sup></p>
      <p>To illustrate the performance of different methods, we adapt the random sampling approach. Firstly, we randomly selected 70% of the total cells as the reference set and identified HVGs based on the reference set with different HVG selection methods respectively. Then, we further trained the random forest classifier using the reference set with only informative genes selected by different methods and predicted the remaining 30% cells as query set with the trained classifier. Finally, we repeated this entire procedure for n = 50 times for each method. The reproducibility score is the overlapped ratio between the different genes selected during every two repetitions. The classification accuracy was quantified with the classification accuracy score, which is the similarity between the predicted cell types and the original cell types of the query set.</p>
      <p>We calculated the reproducibility by intersecting the corresponding sets of variable genes as</p>
      <disp-formula id="FD1">
        <mml:math id="M1" display="block" altimg="si1.gif" overflow="scroll">
          <mml:mrow>
            <mml:mtext>Reproducibility</mml:mtext>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:mi>G</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>s</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mn>1</mml:mn>
                </mml:msub>
                <mml:mo>∩</mml:mo>
                <mml:mi>G</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>n</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>s</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:msub>
              </mml:mrow>
              <mml:mi>n</mml:mi>
            </mml:mfrac>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where n is the number of HVGs.</p>
      <p>We calculated the reproducibility by the similarity between the predicted cell types and the original cell types of the query set.</p>
      <disp-formula id="FD2">
        <mml:math id="M2" display="block" altimg="si2.gif" overflow="scroll">
          <mml:mrow>
            <mml:mtext>Classification accuracy</mml:mtext>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>n</mml:mi>
                  <mml:mi>r</mml:mi>
                </mml:msub>
              </mml:mrow>
              <mml:mi>N</mml:mi>
            </mml:mfrac>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <italic toggle="yes">n</italic><sub><italic toggle="yes">r</italic></sub> is the number of rightly-predicted cells, N is the number of cells of the query set.</p>
    </sec>
    <sec>
      <label>4.4</label>
      <title>Evaluation of SIEVE</title>
      <p>Single-cell dimensionality reduction and cell clustering using HVGs obtained by SIEVE were performed by Seurat with the same parameters as described above. Cluster markers were calculated using the FindAllMarkers function of Seurat and defined with the FDR &lt; 0.05 and |avg_logFC| &gt; 1. The enrichment analysis of HVGs on cell cluster markers was performed by Fisher's exact test. To confirm the effects of gene sets before and after using SIEVE on the dimensionality reduction and cell clustering, we calculated classification accuracy by choosing genes with different times of random sampling.</p>
    </sec>
    <sec>
      <label>4.5</label>
      <title>Sequencing data acquisition</title>
      <p>The single-cell RNA sequencing data used in this study were downloaded from the Gene Expression Omnibus database with the accession numbers GSE137864 and GSE149938.<sup><xref rid="R17" ref-type="bibr">17</xref></sup></p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="SD1" position="float" content-type="local-data">
      <caption>
        <title>Supplemental Digital Content</title>
      </caption>
      <media xlink:href="bls-3-35-s001.docx" id="d64e445" position="anchor"/>
    </supplementary-material>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="SD2" position="float" content-type="local-data">
      <caption>
        <title>Supplemental Digital Content</title>
      </caption>
      <media xlink:href="bls-3-35-s002.docx" id="d64e451" position="anchor"/>
    </supplementary-material>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="SD3" position="float" content-type="local-data">
      <caption>
        <title>Supplemental Digital Content</title>
      </caption>
      <media xlink:href="bls-3-35-s003.docx" id="d64e457" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGMENTS</title>
    <p>This work has been supported by the National Natural Science Foundation of China (82022002, 81900117, 81890993, 81890990, 32000803), National Key Research and Development Program of China (2018YFA0107804), CAMS Initiative for Innovative Medicine (2017-I2M-1-015, 2017-I2M-3-009, 2019-I2M-2-001) and Fundamental Research Funds for the Central Research Institutes (2020-RC310-005).</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="R1">
      <label>[1]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chappell</surname><given-names>L</given-names></name><name><surname>Russell</surname><given-names>AJC</given-names></name><name><surname>Voet</surname><given-names>T</given-names></name></person-group>. <article-title>Single-cell (multi)omics technologies</article-title>. <source><italic toggle="yes">Annu Rev Genomics Hum Genet</italic></source><year>2018</year>;<volume>19</volume>:<fpage>15</fpage>–<lpage>41</lpage>. <comment>doi: 10.1146/annurev-genom-091416-035324</comment>.<pub-id pub-id-type="pmid">29727584</pub-id></mixed-citation>
    </ref>
    <ref id="R2">
      <label>[2]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>Y</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Tian</surname><given-names>T</given-names></name><name><surname>Zhu</surname><given-names>Z</given-names></name><name><surname>Yang</surname><given-names>C</given-names></name></person-group>. <article-title>Single cell transcriptomics: moving towards multi-omics</article-title>. <source><italic toggle="yes">Analyst</italic></source><year>2019</year>;<volume>144</volume><issue>(10)</issue>:<fpage>3172</fpage>–<lpage>3189</lpage>. <comment>doi: 10.1039/c8an01852a</comment>.<pub-id pub-id-type="pmid">30849139</pub-id></mixed-citation>
    </ref>
    <ref id="R3">
      <label>[3]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>F</given-names></name><name><surname>Barbacioru</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><etal/></person-group><article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>. <source><italic toggle="yes">Nat Methods</italic></source><year>2009</year>;<volume>6</volume><issue>(5)</issue>:<fpage>377</fpage>–<lpage>382</lpage>. <comment>doi: 10.1038/nmeth.1315</comment>.<pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation>
    </ref>
    <ref id="R4">
      <label>[4]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>H</given-names></name><name><surname>Zhu</surname><given-names>P</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Wen</surname><given-names>L</given-names></name><name><surname>Tang</surname><given-names>F</given-names></name></person-group>. <article-title>Single-cell methylome landscapes of mouse embryonic stem cells and early embryos analyzed using reduced representation bisulfite sequencing</article-title>. <source><italic toggle="yes">Genome Res</italic></source><year>2013</year>;<volume>23</volume><issue>(12)</issue>:<fpage>2126</fpage>–<lpage>2135</lpage>. <comment>doi: 10.1101/gr.161679.113</comment>.<pub-id pub-id-type="pmid">24179143</pub-id></mixed-citation>
    </ref>
    <ref id="R5">
      <label>[5]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Picelli</surname><given-names>S</given-names></name></person-group>. <article-title>Single-cell RNA-sequencing: the future of genome biology is now</article-title>. <source><italic toggle="yes">RNA Biol</italic></source><year>2017</year>;<volume>14</volume><issue>(5)</issue>:<fpage>637</fpage>–<lpage>650</lpage>. <comment>doi: 10.1080/15476286.2016.1201618</comment>.<pub-id pub-id-type="pmid">27442339</pub-id></mixed-citation>
    </ref>
    <ref id="R6">
      <label>[6]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>AR</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Streets</surname><given-names>AM</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name></person-group>. <article-title>Single-cell transcriptional analysis</article-title>. <source><italic toggle="yes">Ann Rev Anal Chem</italic></source><year>2017</year>;<volume>10</volume><issue>(1)</issue>:<fpage>439</fpage>–<lpage>462</lpage>. <comment>doi: 10.1146/annurev-anchem-061516-045228</comment>.</mixed-citation>
    </ref>
    <ref id="R7">
      <label>[7]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choi</surname><given-names>YH</given-names></name><name><surname>Kim</surname><given-names>JK</given-names></name></person-group>. <article-title>Dissecting cellular heterogeneity using single-cell RNA sequencing</article-title>. <source><italic toggle="yes">Mol Cells</italic></source><year>2019</year>;<volume>42</volume>:<fpage>189</fpage>–<lpage>199</lpage>. <comment>doi: 10.14348/molcells.2019.2446</comment>.<pub-id pub-id-type="pmid">30764602</pub-id></mixed-citation>
    </ref>
    <ref id="R8">
      <label>[8]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haque</surname><given-names>A</given-names></name><name><surname>Engel</surname><given-names>J</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Lonnberg</surname><given-names>T</given-names></name></person-group>. <article-title>A practical guide to single-cell RNA-sequencing for biomedical research and clinical applications</article-title>. <source><italic toggle="yes">Genome Med</italic></source><year>2017</year>;<volume>9</volume>:<fpage>75</fpage>. <comment>doi: 10.1186/s13073-017-0467-4</comment>.<pub-id pub-id-type="pmid">28821273</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <label>[9]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brennecke</surname><given-names>P</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Kim</surname><given-names>JK</given-names></name><etal/></person-group><article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>. <source><italic toggle="yes">Nat Methods</italic></source><year>2013</year>;<volume>10</volume><issue>(11)</issue>:<fpage>1093</fpage>–<lpage>1095</lpage>. <comment>doi: 10.1038/nmeth.2645</comment>.<pub-id pub-id-type="pmid">24056876</pub-id></mixed-citation>
    </ref>
    <ref id="R10">
      <label>[10]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrews</surname><given-names>TS</given-names></name><name><surname>Hemberg</surname><given-names>M</given-names></name></person-group>. <article-title>M3Drop: dropout-based feature selection for scRNASeq</article-title>. <source><italic toggle="yes">Bioinformatics</italic></source><year>2019</year>;<volume>35</volume><issue>(16)</issue>:<fpage>2865</fpage>–<lpage>2867</lpage>. <comment>doi: 10.1093/bioinformatics/bty1044</comment>.<pub-id pub-id-type="pmid">30590489</pub-id></mixed-citation>
    </ref>
    <ref id="R11">
      <label>[11]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiselev</surname><given-names>VY</given-names></name><name><surname>Yiu</surname><given-names>A</given-names></name><name><surname>Hemberg</surname><given-names>M</given-names></name></person-group>. <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source><italic toggle="yes">Nat Methods</italic></source><year>2018</year>;<volume>15</volume><issue>(5)</issue>:<fpage>359</fpage>–<lpage>362</lpage>. <comment>doi: 10.1038/nmeth.4644</comment>.<pub-id pub-id-type="pmid">29608555</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <label>[12]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lun</surname><given-names>AT</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group>. <article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data with bioconductor</article-title>. <source><italic toggle="yes">F1000Research</italic></source><year>2016</year>;<volume>5</volume>:<fpage>2122</fpage>. <comment>doi: 10.12688/f1000research.9501.2</comment>.<pub-id pub-id-type="pmid">27909575</pub-id></mixed-citation>
    </ref>
    <ref id="R13">
      <label>[13]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hafemeister</surname><given-names>C</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group>. <article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title>. <source><italic toggle="yes">Genome Biol</italic></source><year>2019</year>;<volume>20</volume><issue>(1)</issue>:<fpage>296</fpage>. <comment>doi: 10.1186/s13059-019-1874-1</comment>.<pub-id pub-id-type="pmid">31870423</pub-id></mixed-citation>
    </ref>
    <ref id="R14">
      <label>[14]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname><given-names>T</given-names></name><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><etal/></person-group><article-title>Comprehensive integration of single-cell data</article-title>. <source><italic toggle="yes">Cell</italic></source><year>2019</year>;<volume>177</volume><issue>(7)</issue>:<fpage>1888</fpage>–<lpage>1902.e21</lpage>. <comment>doi: 10.1016/j.cell.2019.05.031</comment>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="R15">
      <label>[15]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>B</given-names></name><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>D</given-names></name><name><surname>Ren</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name></person-group>. <article-title>An entropy-based metric for assessing the purity of single cell populations</article-title>. <source><italic toggle="yes">Na Commun</italic></source><year>2020</year>;<volume>11</volume><issue>(1)</issue>:<fpage>3155</fpage>. <comment>doi: 10.1038/s41467-020-16904-3</comment>.</mixed-citation>
    </ref>
    <ref id="R16">
      <label>[16]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vandenbon</surname><given-names>A</given-names></name><name><surname>Diez</surname><given-names>D</given-names></name></person-group>. <article-title>A clustering-independent method for finding differentially expressed genes in single-cell transcriptome data</article-title>. <source><italic toggle="yes">Nat Commun</italic></source><year>2020</year>;<volume>11</volume><issue>(1)</issue>:<fpage>4318</fpage>. <comment>doi: 10.1038/s41467-020-17900-3</comment>.<pub-id pub-id-type="pmid">32859930</pub-id></mixed-citation>
    </ref>
    <ref id="R17">
      <label>[17]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Single-cell transcriptomic landscape of human blood cells</article-title>. <source><italic toggle="yes">Natl Sci Rev</italic></source><year>2021</year>;<volume>8</volume><issue>(3)</issue>:<fpage>nwaa180</fpage>. <pub-id pub-id-type="doi">10.1093/nsr/nwaa180</pub-id>.<pub-id pub-id-type="pmid">34691592</pub-id></mixed-citation>
    </ref>
    <ref id="R18">
      <label>[18]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname></name><etal/></person-group><article-title>Scikit-learn: machine learning in python</article-title>. <source><italic toggle="yes">JMLR</italic></source><year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>2830</lpage>. <comment>doi: 10.5555/1953048.2078195</comment>.</mixed-citation>
    </ref>
  </ref-list>
</back>
