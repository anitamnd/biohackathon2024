<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8189678</article-id>
    <article-id pub-id-type="pmid">33135044</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa944</article-id>
    <article-id pub-id-type="publisher-id">btaa944</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RNANet: an automatically built dual-source dataset integrating homologous sequences and RNA structures</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Becquey</surname>
          <given-names>Louis</given-names>
        </name>
        <aff><institution>Université Paris-Saclay, Univ Evry, IBISC</institution>, Evry-Courcouronnes 91020, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Angel</surname>
          <given-names>Eric</given-names>
        </name>
        <aff><institution>Université Paris-Saclay, Univ Evry, IBISC</institution>, Evry-Courcouronnes 91020, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Tahi</surname>
          <given-names>Fariza</given-names>
        </name>
        <xref rid="btaa944-cor1" ref-type="corresp"/>
        <aff><institution>Université Paris-Saclay, Univ Evry, IBISC</institution>, Evry-Courcouronnes 91020, <country country="FR">France</country></aff>
        <!--louis.becquey@univ-evry.fr-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Pier Luigi</surname>
          <given-names>Martelli</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa944-cor1">To whom correspondence should be addressed. <email>louis.becquey@univ-evry.fr</email> or <email>fariza.tahi@univ-evry.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-12-07">
      <day>07</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <volume>37</volume>
    <issue>9</issue>
    <fpage>1218</fpage>
    <lpage>1224</lpage>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>22</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>10</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa944.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Applied research in machine learning progresses faster when a clean dataset is available and ready to use. Several datasets have been proposed and released over the years for specific tasks such as image classification, speech-recognition and more recently for protein structure prediction. However, for the fundamental problem of RNA structure prediction, information is spread between several databases depending on the level we are interested in: sequence, secondary structure, 3D structure or interactions with other macromolecules. In order to speed-up advances in machine-learning based approaches for RNA secondary and/or 3D structure prediction, a dataset integrating all this information is required, to avoid spending time on data gathering and cleaning.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we propose the first attempt of a standardized and automatically generated dataset dedicated to RNA combining together: RNA sequences, homology information (under the form of position-specific scoring matrices) and information derived by annotation of available 3D structures (including secondary structure, canonical and non-canonical interactions and backbone torsion angles). The data are retrieved from public databases PDB, Rfam and SILVA. The paper describes the procedure to build such dataset and the RNA structure descriptors we provide. Some statistical descriptions of the resulting dataset are also provided.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The dataset is updated every month and available online (in flat-text file format) on the EvryRNA software platform (<ext-link xlink:href="https://evryrna.ibisc.univ-evry.fr/evryrna/rnanet" ext-link-type="uri">https://evryrna.ibisc.univ-evry.fr/evryrna/rnanet</ext-link>). An efficient parallel pipeline to build the dataset is also provided for easy reproduction or modification.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>EvryRNA</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Genopole</institution>
            <institution-id institution-id-type="DOI">10.13039/501100007149</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>A major part of any data-science work consists in finding appropriate data that contains enough signal to tackle the problem we are interested in. Then, cleaning the data to ensure uniformity of the measures, compatibility of the various data sources and protocols, and a reasonable amount of noise is sometimes the most time-consuming step.</p>
    <p>Data-based methods have been popular for a long time in the field of RNA structural bioinformatics, for structure prediction (e.g. with <xref rid="btaa944-B4" ref-type="bibr">Do <italic toggle="yes">et al.</italic>, 2006</xref>) or for mining and classification of interactions in motifs and networks (<xref rid="btaa944-B16" ref-type="bibr">Petrov <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btaa944-B19" ref-type="bibr">Reinharz <italic toggle="yes">et al.</italic>, 2018</xref>). Machine learning prediction methods start to rise [recent example with <xref rid="btaa944-B22" ref-type="bibr">Singh <italic toggle="yes">et al.</italic> (2019)</xref>] following, with a few years delay, their rise in the field of protein structure prediction. However, past works use specialized datasets built on-purpose, probably using time and effort or databases focused on secondary structure only, for example. As we expect future developments in the field, in particular regarding 3D structure prediction, an annotated dataset of RNA 3D structures is needed. To our knowledge, the only available dataset is BGSU’s RNA Structure Atlas (<ext-link xlink:href="https://rna.bgsu.edu/rna3dhub/pdb" ext-link-type="uri">https://rna.bgsu.edu/rna3dhub/pdb</ext-link>). It provides annotations of all RNA 3D structures in a browseable website, but their annotations cannot be downloaded as a whole and ready-to-use dataset for machine learning applications. Indeed, such dataset is needed to allow quick testing of new ideas, and to perform benchmarks and comparisons between future knowledge-based structure prediction algorithms.</p>
    <p>We propose in this paper a standardized RNA dataset integrating and connecting together various pieces of information related to the RNA families, their sequences, their secondary and 3D structures. It is automatically built, allowing regular updates and improvements. This work was inspired by a recent publication by <xref rid="btaa944-B2" ref-type="bibr">AlQuraishi (2019b</xref>), who proposed a standard dataset for protein structure prediction, called ProteinNet (mimicking the names of the famous WordNet and ImageNet reference datasets of vocabulary and images commonly used in machine-learning community). Our RNA dataset, accordingly called RNANet, differs from ProteinNet in several points. A much lower amount of available 3D data with a high proportion of identical chains (like ribosomal and transfer RNAs), as well as missing software tools adapted to RNA force us to forsake some pertinent ProteinNet strategies. Here, we propose a first attempt to build a usable dataset dedicated to RNA following the ProteinNet philosophy, using the currently available RNA data and tools. With the growth of databases and certainly successful use-cases in the future, the dataset will evolve, to reach, we hope, the size and quality of ProteinNet.</p>
    <p>Specificities of RNA also make the corresponding dataset easier to build on some points. Among the key differences between RNA and proteins, we can cite the lower diversity of the residues: there are only four main nucleotides. When consensus residues exist, they are often related to structural features of the bases (purine or pyrimidine, weak or strong) rather than the physico-chemical properties that are used for amino-acids (acido-basicity, hydrophobicity). Then, it is easier to encode the three-dimensional conformation of a nucleotide, because the 3D descriptors are defined in the same way for all residues. This is not the case with amino-acids, one example being the number of torsion angles to consider differs depending on the considered amino-acid. The interactions between residues also are easier to encode. Most models consider that each base can interact one time on each of its 3 sides. This makes the interaction space of a nucleotide finite, while we have to consider many faces and rotamers when working with amino acids.</p>
    <p>A common first problem in RNA computational biology is the prediction of structure from sequence. The basis for a dataset is then to gather sequences and their experimentally verified secondary structure and tertiary (3D) structure descriptors. A good start is to get the Watson–Crick basepairs, which permits to describe stems and various loops (hairpin loops, or multiple junctions).</p>
    <p>Then, to capture the 3D structure, two kinds of descriptors can be used in complementarity: those which focus on the backbone configuration (helix forms, ribose configurations, torsion angles), and those which focus on all the base–base and base-backbone interactions [the 12 variants of Leontis–Westhof base–base pairing nomenclature (<xref rid="btaa944-B10" ref-type="bibr">Leontis and Westhof, 2001</xref>), plus stacking interactions and base-phosphate interactions]. The different levels of approximation of an RNA structure are illustrated on<xref rid="btaa944-F1" ref-type="fig">Figure 1</xref>. The full-atom 3D structure in <xref rid="btaa944-F1" ref-type="fig">Figure 1A</xref> can be encoded, as a first approximation, into a sequence of letters, the primary structure (<xref rid="btaa944-F1" ref-type="fig">Fig. 1B</xref>), because we know, by convention, to which composition of atoms each of the letters corresponds. The next step is to describe the interactions between each of the bases. Such description is proposed on <xref rid="btaa944-F1" ref-type="fig">Figure 1C</xref>, with the secondary structure graph of the same molecule and its non-canonical interactions. Yet, the global shape and folding of the polymer appear. The finest level of description is to describe every atom’s position using geometrical parameters. On <xref rid="btaa944-F1" ref-type="fig">Figure 1D</xref>, we annotate the three nucleotides highlighted by a red rectangle on <xref rid="btaa944-F1" ref-type="fig">Figure 1A, B and C</xref> using geometrical descriptors.</p>
    <fig position="float" id="btaa944-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Different ways to encode the structural information of an RNA molecule. (<bold>A</bold>) Full-atom structure of an example RNA molecule (PDB 6sy6, chain D). (<bold>B</bold>) Primary sequence of this chain, using conventional A, C, G and U one-letter codes to describe commonly observed ensemble of atoms (the nucleotides). Residue numbers are indicated in light blue. When homologous sequences are available, it is possible to compute nucleotide frequencies at every position (a.k.a. position-specific scoring matrices or PSSMs). (*) Residue n<sup>∘</sup>1 is not resolved in 3D and not represented on the figure. (**) The example values are fictive since 6sy6-D does not belong to a particular RNA family to our knowledge. (<bold>C</bold>) Secondary structure graph of the chain, with the number of base contacts for each base (in red), the base symbol in dot-bracket notation (light gray) and the non-canonical interactions between bases in Leontis–Westhof nomenclature (in black). The first letter <italic toggle="yes">c</italic> or <italic toggle="yes">t</italic> indicates a <italic toggle="yes">cis</italic> or <italic toggle="yes">trans</italic> configuration, and the two following uppercase letters H, S and W, are the base’s sides interacting (illustrated on nucleotide 17 in D). (*) A question mark (?) is used when the nucleotide interacts with only one atom, which is not enough to define a base side. (<bold>D</bold>) Detailed 3D geometric descriptors illustrated on nucleotides 15, 16 and 17 of the chain. Nucleotide 15 is annotated with its torsion angles (in light blue). Nucleotide 16 is annotated with virtual bond systems and their pseudotorsion angles <italic toggle="yes">η</italic> and <italic toggle="yes">θ</italic> (in yellow) and <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo>η</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mo>θ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> (in green). Nucleotide 17 is annotated with a label on each base edge: H on the Hoogsteen edge, W on the Watson–Crick edge, S on the sugar edge. These three residues are highlighted by a red box in (A), (B) and (C)</p>
      </caption>
      <graphic xlink:href="btaa944f1" position="float"/>
    </fig>
    <p>Finally, on top of the structural descriptors of each RNA chain, the most recent developments in structural bioinformatics have shown the importance of capturing the folding information of macromolecules families, so that the family fold can be used later when trying to predict how one sequence will fold in space [e.g. <xref rid="btaa944-B25" ref-type="bibr">Xu, (2019)</xref> and <xref rid="btaa944-B1" ref-type="bibr">AlQuraishi (2019a</xref>) with proteins, or <xref rid="btaa944-B13" ref-type="bibr">Magnus <italic toggle="yes">et al.</italic> (2019)</xref> in the field of RNA]. Therefore, it is useful to include position-specific scoring matrices computed on homologous sequences in addition to every chain sequence, to reflect diversity or conservation inside a family of molecules. For that reason, one of the key elements of the dataset, which brings novelty to this work, is to provide nucleotide frequencies at every position of the RNA 3D structures from the PDB (as illustrated below the sequence on <xref rid="btaa944-F1" ref-type="fig">Fig. 1B</xref>).</p>
    <p>To summarize, for each RNA chain, we provide descriptors about the sequence and sequence variation, about the secondary structure and pairing scheme of each nucleotide (with non-canonical interactions and multi-basepairs), and fine descriptors of the 3D conformation (angles, torsions). We provide the data in an SQLite database and flat text format (CSV files) to be opened in a spreadsheet or parsed by user scripts. The dataset is updated every month to take into account newer data.</p>
    <p>In the next section, we go through the steps of the pipeline, starting from the public databases, to the final dataset. We explain the choices made and why it differs from ProteinNet. We then provide some descriptive statistics about the obtained data and its quality in Section 3.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>To build the RNANet dataset, we developed a pipeline whose different stages are summarized in <xref rid="btaa944-F2" ref-type="fig">Figure 2</xref>. The pipeline gathers a list of RNA chains from the BGSU RNA research group website (<xref rid="btaa944-B11" ref-type="bibr">Leontis and Zirbel, 2012</xref>), and searches for mappings of these chains to Rfam RNA families (<xref rid="btaa944-B7" ref-type="bibr">Kalvari <italic toggle="yes">et al.</italic>, 2018</xref>). The identified mappings allow then to download known homologous sequences and realign them with the 3D chain sequences, to get sequence variation statistics. In parallel, three-dimensional structures are downloaded and annotated by DSSR (<xref rid="btaa944-B12" ref-type="bibr">Lu <italic toggle="yes">et al.</italic>, 2015</xref>) to yield descriptors of the 3D structure. Finally, the two kinds of per-position information are re-mapped one to each other, and the dataset is saved. We thus obtain a list of various nucleotide descriptors at each scale: sequence and its variability, secondary structure and non-canonical interactions and precise geometrical descriptors, including sugar puckering and torsion angles. The complete list is presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. Details on the choices made for each of the steps are given in the following sections.</p>
    <fig position="float" id="btaa944-F2">
      <label>Fig. 2.</label>
      <caption>
        <p>Pipeline of the RNANet dataset construction from public databases PDB, Rfam and SILVA</p>
      </caption>
      <graphic xlink:href="btaa944f2" position="float"/>
    </fig>
    <sec>
      <title>2.1 Data selection</title>
      <p>The first step is to identify RNA chains of sufficient quality in the 3D data available in the PDB. To do so, we use the list kept up-to-date by the BGSU RNA research group (<xref rid="btaa944-B11" ref-type="bibr">Leontis and Zirbel, 2012</xref>). We include all the RNA chains with resolution better than a desired resolution threshold (4.0 Angströms by default, which can be changed using a command-line option). The number of available RNA chains as a function of structure resolution is presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>. Note that we keep the redundant chains. This is motivated by the lack of data: as we have few 3D data, we need to exploit every variant of the same molecule if several structures are available. Because replica of crystallography or EM experiments may vary a little in the position of nucleotides, interactions and 3D descriptors like angles or sugar pucker may also vary a little. This gives information about the probability distributions of these parameters. Redundancy could be eliminated or controlled later by the user, by further re-filtering the final dataset. The BGSU list is not exhaustive of the RNA chains available in 3D (it lacks, for example, all the available NMR structures). But, the RNA chains in the BGSU list are organized by redundancy in so called ‘equivalence classes’, and we find it useful to identify more links between 3D chains and homologous sequences.</p>
      <p>An important bottleneck is to identify homologous sequences for all these chains, so that we can compute nucleotide frequencies at every position in the chain. A good strategy proposed in <xref rid="btaa944-B2" ref-type="bibr">AlQuraishi (2019b</xref>) for proteins is to use the jackHMMER tool (<xref rid="btaa944-B6" ref-type="bibr">Johnson <italic toggle="yes">et al.</italic>, 2010</xref>), which performs an iterative search of homologous sequences against wide sequence databases. Unfortunately, the tool does not support nucleic acid sequences. However, the HMMER software tools, excluding jackHMMER, have been specialized for DNA/RNA sequences resulting in the Infernal tools (<xref rid="btaa944-B15" ref-type="bibr">Nawrocki and Eddy, 2013</xref>). These tools work with the pre-computed covariance models of the Rfam RNA families (<xref rid="btaa944-B7" ref-type="bibr">Kalvari <italic toggle="yes">et al.</italic>, 2018</xref>). With every Rfam family comes a covariance model and a list of sequence hits from reference genomes. Infernal can realign sequences with the covariance model to get a multiple sequence alignment. Moreover, Rfam provides a list of 5567 mappings between PDB structures and Rfam families, which is why we decided to use it as our basis to get homologous sequences. Using them may not be the way leading to the highest number of hits between the existing 3D chains and homologous sequences. Indeed, Rfam is evolving since release 13.0 to a high-quality database based on non-redundant genomes and probably lacks some species and ‘families’. We may detect more homologous sequence clusters by scanning more genomes ourselves. However, we do not wish to compete with Rfam, and prefer to rely on their expertise and regular updates. Hence, we filter the previous list of 3D RNA chains to keep only those with an available mapping to an Rfam family, namely, a covariance model. We also retain 3D structures for which no mapping is directly available, but a mapping exists to another 3D chain from the same equivalence class in the BGSU redundancy list. Considering all the data without a resolution requirement, the filtering reduces the number of chains from 11 702 to 6282 (53%). When no mapping from Rfam is available, but several mappings to different families can be inferred using the equivalence class, the chain is copied and truncated to save the portion corresponding to each mapping, respectively. This procedure increases the counter to 6668 chains, including the copies of chains that are mapped several times. Optionally, as the Rfam-PDB mappings are relative to portions of PDB chains, the user can provide an option in the command line to extract the desired portions only from the source mmCIF files, excluding the other uninteresting chains, waters, ligands and ions.</p>
    </sec>
    <sec>
      <title>2.2 Annotation of the 3D chains</title>
      <p>Now that we have a collection of data points (one datum corresponding to one RNA chain), we need to use an annotation program to provide a list of descriptors of these chains. The list of RNA-containing mmCIF files is therefore fed to the RNA annotation software tool DSSR (<xref rid="btaa944-B12" ref-type="bibr">Lu <italic toggle="yes">et al.</italic>, 2015</xref>), to extract position-specific information at every nucleotide. This includes nucleotide sequence, with DSSR’s wide support of modified bases, base–base interactions in both DSSR and Leontis–Westhof (<xref rid="btaa944-B10" ref-type="bibr">Leontis and Westhof, 2001</xref>) nomenclatures and with support of multiple interactions per base. This also includes geometric descriptors of the bases, riboses and backbone: first, the six torsion angles of the backbone, commonly denoted by <italic toggle="yes">α</italic>, <italic toggle="yes">β</italic>, <italic toggle="yes">γ</italic>, <italic toggle="yes">δ</italic>, <italic toggle="yes">ϵ</italic> and <italic toggle="yes">ζ</italic>; then, the ribose-base torsion angle <italic toggle="yes">χ</italic>, and the associated label ‘syn’ or ‘anti’; and then, the five torsion angles of the ribose, commonly denoted by <italic toggle="yes">ν</italic><sub>0</sub> to <italic toggle="yes">ν</italic><sub>4</sub>. Then come the pseudo torsion angles of virtual bond systems <italic toggle="yes">η</italic>/<italic toggle="yes">θ</italic>, <italic toggle="yes">η</italic>′/<italic toggle="yes">θ</italic>′, <italic toggle="yes">η</italic>″/<italic toggle="yes">θ</italic>″, summarizing the backbone with only P and C4′ atoms for <italic toggle="yes">η</italic>/<italic toggle="yes">θ</italic>, P and C1′ for <italic toggle="yes">η</italic>′/<italic toggle="yes">θ</italic>′ or P and base center position for <italic toggle="yes">η</italic>″/<italic toggle="yes">θ</italic>″ [see <xref rid="btaa944-B9" ref-type="bibr">Keating <italic toggle="yes">et al.</italic>, (2011)</xref> for a good introduction to the backbone description systems]. DSSR also provides the phase angle of the ribose cycle and its amplitude, and the associated ‘sugar puckering’ label. Two descriptors concern the position of the 3′-phosphorus. Finally, if the nucleotide is involved in a stem, the stem type (A, B or Z) is reported. A detailed description of computed 3D descriptors is available in the third group of <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. Note that using the whole mmCIF structures for annotation permits to yield both intra-chain and inter-chain interactions in the descriptors. The ‘pair_type’ fields contain information about both. But the ‘paired’ field, which gives the index value of the corresponding nucleotide for intra-chain interactions, is set to zero if an interaction is inter-chain.</p>
    </sec>
    <sec>
      <title>2.3 Alignment of the sequences</title>
      <p>As the RNA sequences of the chains have now been extracted using DSSR, we can now compute position-specific nucleotide frequencies. To do so, we use the previously retrieved PDB-Rfam mapping of every chain. We gather together all the sequence hits of a given Rfam family, plus the sequences of the 3D chains that are mapped to this family, in a single file. A multiple sequence alignment is then recomputed using Infernal’s <italic toggle="yes">cmalign</italic> program. Technical limits (in particular the <italic toggle="yes">cmalign</italic> memory requirements) make it impossible to realign the largest families on regular computer hardware. It is the case of the ribosomal sub-units [families from Rfam clans CL00111-SSU (Small Sub-Units) and CL00112-LSU (Large Sub-Units)]. So, we decided to re-align these sequences differently. Instead of using Infernal and Rfam sequences, we consider the specialized database SILVA (<xref rid="btaa944-B17" ref-type="bibr">Pruesse <italic toggle="yes">et al.</italic>, 2007</xref>) and its aligner <italic toggle="yes">SINA</italic> (<xref rid="btaa944-B18" ref-type="bibr">Pruesse <italic toggle="yes">et al.</italic>, 2012</xref>). The SILVA data are larger than Rfam hits on the above families’ covariance models, hand-curated, and their specialized aligner is faster and uses less memory. As ribosomal RNAs are a consequent portion of the whole RNA 3D dataset, it is worth using specialized tools. Both <italic toggle="yes">SINA</italic> and <italic toggle="yes">cmalign</italic> output multiple-sequence alignments. Multiple sequence alignments are then summarized into position-specific scoring matrices (PSSM), which basically are a summary of the base counts per column in the alignments.</p>
    </sec>
    <sec>
      <title>2.4 Re-mapping strategy</title>
      <p>The final step is to merge the per-position data concerning the RNA 3D chain with the per-position nucleotide frequencies in the multiple sequence alignments. As each sequence extracted from a 3D chain has been realigned with its homologs, it now contains gaps in its aligned version. On the 3D chain side, gaps may only occur if some residues are not resolved. On the multiple sequence alignment side, <italic toggle="yes">cmalign</italic> produces two kinds of gaps: gaps to the family consensus whose symbols are ‘-’ and describe an important deletion with respect to the family pattern, and gaps whose symbols are ‘.’ that are just padding because another sequence contains an insertion with respect to the family consensus. Starting with the two different gapped sequences, our mapping strategy is the following:
</p>
      <list list-type="bullet">
        <list-item>
          <p>If the two sequence symbols (nucleotide letter or gap) match, we merge the position descriptors, and move to the next position.</p>
        </list-item>
        <list-item>
          <p>If the 3D chain contains a gap (‘-’ symbol) but does not face a gap to the consensus in the multiple alignment, we first try to search for a real gap to the consensus in the following positions (ignoring insertion gaps ‘.’ until a resolved nucleotide letter comes). If one is found, we map the two positions together. If none is found, we search for an insertion gap ‘.’. If no gap is found at all, we map the 3D chain descriptors with unknown homology descriptors (NaN values). This happens when the alignment is locally incorrect.</p>
        </list-item>
        <list-item>
          <p>If the aligned sequence contains a gap, but not the 3D chain, we just skip this position and move to the following.</p>
        </list-item>
        <list-item>
          <p>If the sequence symbols do not match but are not gaps, we throw an error. This never happens in practice.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>2.5 Special attention paid to specific cases</title>
      <p>In order to maximize the amount of data, problematic cases were not discarded. We try to overcome particular situations as much as possible to include all the data. First, it is very common to observe missing residues in RNA chains, because of unresolved portions in the mmCIF file. Their positions are marked as gaps in the sequence. By default, they are later replaced by the most common nucleotide at this position among the homologous sequences in a dedicated database field (nt_align_code). A gap character ‘-’ remains in the main field (nt_code, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). This can be turned off with an option. Another common case is the presence of ligands and small molecules crystallized with the RNA chain. DSSR often detects them as residues and tries to annotate them like nucleotides. This leads to wrong ‘modified bases’ (which are not bases at all) at the end of chains. We automated the detection and removal of such ligands, but unfortunately we cannot guarantee that all were correctly detected. We also tackle various particular cases where nucleotides are numbered in a non-standard way in the mmCIF files, e.g. using letters, negative numbers, numbers augmented by a thousand to indicate an artificial nucleotide in the biological sequence, and many others. Such anomalies are very common. Our processed chains are numbered from one to their length. Finally, we do not remove base–base interactions which do not fit in one of the Leontis–Westhof nomenclature descriptions. This concerns, for example, bases interacting using only the Guanine <italic toggle="yes">N</italic><sub>2</sub>. We include them, but label them in a group named ‘other’.</p>
    </sec>
    <sec>
      <title>2.6 Implementation details</title>
      <p>RNANet is built automatically using a Python script available on the EvryRNA website (<ext-link xlink:href="https://EvryRNA.ibisc.univ-evry.fr/evryrna/rnanet" ext-link-type="uri">https://EvryRNA.ibisc.univ-evry.fr/evryrna/rnanet</ext-link>). It heavily relies on the BioPython package (<xref rid="btaa944-B3" ref-type="bibr">Cock <italic toggle="yes">et al.</italic>, 2009</xref>) to parse mmCIF and alignment files. It depends on a working installation of <italic toggle="yes">SINA</italic>, <italic toggle="yes">DSSR</italic> and <italic toggle="yes">Infernal</italic>. A Docker container is provided to ease the installation. Running it on a multi-core computer greatly speeds up the computation, but requires more memory, at scale. Fifteen hours are required to compute all the dataset for the first time on a 32-core server (Intel Xeon E7-4850 v4 @32x2.10 GHz), with 48 GB of RAM. Later runs will, by default, only perform necessary computations to keep the database up-to-date more quickly.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussion</title>
    <sec>
      <title>3.1 Dataset files and database</title>
      <p>The pipeline organizes the information in a collection of tables in an SQLite3 database (the database scheme is provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). This makes it easy to query specific data. By default, all the per-position information is extracted to CSV files, one per RNA chain. It is possible to re-extract a different set of files using for example a different structure resolution threshold. We provide a few example using Python and the sqlite3 package on EvryRNA.</p>
      <p>Another example of filtering criterion is the data publication date. With ProteinNet, AlQuraishi proposes pre-computed versions of his dataset with only the available data at some points in time, corresponding to rounds of the CASP protein-folding competition. This allows users to compare their prediction methods or tools with all the popular ones that have been participating a past CASP competition. Users might want to do the same with the RNA-Puzzles problems (<xref rid="btaa944-B14" ref-type="bibr">Miao and Westhof, 2017</xref>). No time-frozen releases of the dataset are pre-computed, but it is possible to query our SQLite database to yield only the chains whose release date is earlier than a certain RNA-Puzzles problem.</p>
    </sec>
    <sec>
      <title>3.2 General statistics over the dataset</title>
      <p>Using the SQL database, it is easy to query various statistics over the available RNA structural data to date. For example we can query the most common RNA family, which is RF00005 corresponding to transfer-RNAs, with 1694 chains.</p>
      <p>To date (September 2020) and without further filtering based on structure resolution, we registered 10 173 RNA 3D chains available in the PDB. Rfam provided 5505 mappings to known families (54%). Using BGSU’s redundancy lists (v3.145), we extended this list to 6217 unique RNA chains, or 6602 chains if we accept to map copies of chain portions to different Rfam families. These figures are slightly lower than the ones given in Section 2.1, because they exclude chains that are too short, contain no nucleotides (backbone only), or are incorrectly parsed by DSSR. The chains were mapped to 92 Rfam families. The number of homologous sequences found by family ranges from 5 (RF00044) to 1 429 931 (tRNAs from Rfam, RF00005), or 2 225 272 (SSU sequences from SILVA). Detailed numbers of families as a function of the resolution threshold considered, and numbers of sequences mapped to each Rfam family are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
      <p>Concerning the nucleotide distribution over the RNA families, <xref rid="btaa944-F3" ref-type="fig">Figure 3</xref> presents both a histogram of RNA chain lengths, and the distribution of Rfam families within that histogram. As we can see, the longest chains are from Large ribosomal Sub-Units (LSU), followed by the Small Sub-Units (SSU). In general, the dataset is mainly composed of ribosomal RNAs, which also are the longest chains, followed by transfer RNAs. The majority of other RNA families are represented by fewer chains, and are often less than 500 bases long. Nucleotide frequency statistics by RNA family are provided as an additional CSV file to download on EvryRNA.</p>
      <fig position="float" id="btaa944-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Distribution of sequence lengths among RNA families (logarithmic scale). The longest families are the 4 LSU families (RF02540, RF02541, RF02543 and RF02546 for archaeal, prokaryotic, eukaryotic and mitochondrial ribosomes, respectively) with over 2500 nucleotides. SSUs follow (RF00177, RF01960 and RF02545), around 1600 nucleotides long. Transfer RNAs are the most common family, but they are less than 300 bases. The group labelled ‘Other’ contains various RNAs from 82 families, all smaller than 500 nucleotides long</p>
        </caption>
        <graphic xlink:href="btaa944f3" position="float"/>
      </fig>
      <p>To quantify the redundancy among RNA families, we compute sequence identity matrices for every Rfam family. The sequence identity matrices can also be used to perform a hierarchical clustering over chains. The result is presented graphically on <xref rid="btaa944-F4" ref-type="fig">Figure 4</xref>. As expected, a majority of the 92 families consists of a very few, or very similar sequences. A high average identity in a RNA family is reassuring regarding the quality of the sequence alignment, but also is a sign of great redundancy in the sequence space at least. However, the RNA chains which share a common sequence may present different secondary and 3D structures, since the sequence does not completely determine the structure. We do not further filter the data to eliminate redundancy (yet), but users are encouraged to do so by themselves, at the level of redundancy they chose to keep, and at the cost of data reduction.</p>
      <fig position="float" id="btaa944-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Sequence identity matrices of RNA chains mapped to various Rfam families (clustered by Ward’s method). The more yellow (or light gray) a distance matrix is, the more similar the sequences are. The more blue (or dark gray) the matrix is, the more distant the sequences are. Families with less than three chains available in 3D are not represented (20 families)</p>
        </caption>
        <graphic xlink:href="btaa944f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Joint distribution of the <italic toggle="yes">η</italic>/<italic toggle="yes">θ</italic> pseudotorsions</title>
      <p>In <xref rid="btaa944-B24" ref-type="bibr">Wadley <italic toggle="yes">et al.</italic> (2007)</xref>, the authors identified that non-helical nucleotides usually have discrete possible conformations. To show evidence, they measured and plotted the joint distributions of the pseudotorsion angles <italic toggle="yes">η</italic> and <italic toggle="yes">θ</italic> in non-helical nucleotides, like Ramachandran did with amino-acids in proteins. For a nucleotide <italic toggle="yes">i</italic>, <italic toggle="yes">η<sub>i</sub></italic> is defined as the torsional angle between the four atoms <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:msubsup><mml:mo>′</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, <italic toggle="yes">P<sup>i</sup></italic>, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:msubsup><mml:mo>′</mml:mo><mml:mn>4</mml:mn><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Similarly, <italic toggle="yes">θ<sub>i</sub></italic> is defined as the torsion angle between <italic toggle="yes">P<sup>i</sup></italic>, <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:msubsup><mml:mo>′</mml:mo><mml:mn>4</mml:mn><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:msubsup><mml:mo>′</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. These pseudotorsions have been proven easier to use than the six regular torsion angles of the RNA backbone (<xref rid="btaa944-B5" ref-type="bibr">Duarte and Pyle, 1998</xref>). They propose a list of clusters linked to a particular conformation of the nucleotides. As an example use case of the dataset, we try to reproduce the same clusters with the 2020 data. The joint distribution plot of the <italic toggle="yes">η</italic>/<italic toggle="yes">θ</italic> pseudotorsions in our dataset is given on <xref rid="btaa944-F5" ref-type="fig">Figures 5A1</xref> and A2, to compare with Figure 6a and b of <xref rid="btaa944-B24" ref-type="bibr">Wadley <italic toggle="yes">et al.</italic> (2007)</xref> respectively. With the growth of the amount of solved structures, all of the C3′-endo clusters except the large central one have vanished. However, we still find the C2′-endo clusters, plus a small new fifth one.</p>
      <fig position="float" id="btaa944-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Ramachandran-like plots of the couples of pseudotorsions (<inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mo>η</mml:mo><mml:mo>,</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula>) in A1 (non-helical C3′-endo nucleotides) and A2 (C2′-endo nucleotides), and (<inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mo>η</mml:mo><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>) in B1 (non-helical C3′-endo nucleotides) and B2 (C2′-endo nucleotides). Gaussian kernel density estimates are superposed to scatter plots. The line contours correspond to <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mo>ρ</mml:mo><mml:mo>+</mml:mo><mml:mo>σ</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>ρ</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>σ</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mo>ρ</mml:mo><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo>σ</mml:mo></mml:mrow></mml:math></inline-formula> where <italic toggle="yes">ρ</italic> is the average height of the kernel and <italic toggle="yes">σ</italic> its standard deviation. The used nucleotides are from unique chains of resolution 4.0 Å or better. Plots of the distributions using more restrictive thresholds at 3.0 and 2.0 Å are available in Supplementary Section S4</p>
        </caption>
        <graphic xlink:href="btaa944f5" position="float"/>
      </fig>
      <p>The simplest hypothesis about the difference of clusters between <xref rid="btaa944-F5" ref-type="fig">Figure 5A1</xref> and the original plot from Wadley might be the growth of the amount of data dissolving small peaks that were significant in 2007 in a widespread mass of points. We indeed can observe the old clusters if we decide to relax the average plus one standard deviation threshold to only average, for example (data not shown). This threshold was originally proposed by Wadley <italic toggle="yes">et al.</italic> to focus on significant peaks. Nevertheless, the proportion of these small peaks relatively to the large central one has changed over the years. The second hypothesis could be a difference in the way we filter non-helical nucleotides, which fall in the central region. We indeed removed nucleotides annotated by DSSR as being part of an A-form, B-form or Z-form 3D stem. As many nucleotides may not fulfil DSSR’s detection criteria, but still be part of or near a helix, they are included and participate to the massive peak.</p>
      <p>A few years later, Keating <italic toggle="yes">et al.</italic> proposed to use another definition of the pseudotorsions, called <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mo>η</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mo>θ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, which uses carbons <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> instead of <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (<xref rid="btaa944-B8" ref-type="bibr">Keating and Pyle, 2010</xref>). Indeed, because base planes are easy to solve, <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are the most precisely located atoms in X-ray crystallographic RNA structures. So we recompute the plot with <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mo>η</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mo>θ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, and the results are given on <xref rid="btaa944-F5" ref-type="fig">Figure 5B1</xref> and B2, for non-helical <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-endo and <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-endo nucleotides respectively. Here, we observe slightly different cluster positions, including small peaks on the C3′-endo plot, pointed by arrows on <xref rid="btaa944-F5" ref-type="fig">Figure 5B1</xref>. They are well conserved compared to the 2007 dataset.</p>
    </sec>
    <sec>
      <title>3.4 Shortcomings compared to ProteinNet</title>
      <p>Besides the fact that the inspiration for RNANet came from ProteinNet, the two are actually different, because of methodology variations and because of the gap in the available amount of data between proteins and RNA.</p>
      <sec>
        <title>3.4.1 Small amount of data</title>
        <p>The convenience of the Rfam/Infernal ecosystem, providing precomputed hits of non-coding RNA sequences on the families covariance models, comes at the price of heavy data reduction. Because a mapping is not (yet) available for every 3D chain, more than a third of the available chains are unused. This can be critical to deep-learning models. The development of a nucleic-acid equivalent of jackHMMER (<xref rid="btaa944-B6" ref-type="bibr">Johnson <italic toggle="yes">et al.</italic>, 2010</xref>), used in ProteinNet to find sequence homologs (<xref rid="btaa944-B2" ref-type="bibr">AlQuraishi, 2019b</xref>), could be of great use. First, it would allow to take into account all the available 3D chains. Second, it would find more homologous sequences for every chain, using even larger RNA databases (Rfam is built only on a collection of reference genomes as a basis, and only non-coding RNAs).</p>
      </sec>
      <sec>
        <title>3.4.2 Data diversity and pre-computed splits of training, testing and validation sets</title>
        <p>As <xref rid="btaa944-F4" ref-type="fig">Figure 4</xref> shows, sequences are very close to each other inside a family. And even across several families, sequences are dependant on each other and linked by evolutive relations, e.g. the three families of large ribosomal sub-units in the three great living domains. So, without further filtering, RNA chains of the dataset cannot be considered independent and identically distributed. This also means that the dataset cannot be naively split randomly to get training and test sets. To overcome this, the ProteinNet approach (<xref rid="btaa944-B2" ref-type="bibr">AlQuraishi, 2019b</xref>) proposes to carefully select sequences to build training and test subsets without having two sequences with too much similarity in one of each. This would indeed constitute a leak of information between the training and test sets. Such work is even harder with RNA. First, we cannot reproduce the same filtering algorithm yet, because the tools used for the multiple-sequence alignment based clustering, HHBlits (<xref rid="btaa944-B20" ref-type="bibr">Remmert <italic toggle="yes">et al.</italic>, 2012</xref>) and MMSeqs2 (<xref rid="btaa944-B23" ref-type="bibr">Steinegger and Söding, 2017</xref>), do not support nucleic acid sequences for now. As for jackHMMER, support of these tools for nucleic acid sequences would allow similar strategies. Second, any other automated or manual approach would still be difficult, because of the small amount of data. As a consequence, we have to provide the un-split dataset for now, and let the users decide how they want to build the splits. Splits may come in a later release if a pertinent strategy is found, or if new software tools are released.</p>
      </sec>
    </sec>
    <sec>
      <title>3.5 Upcoming plans and new descriptors</title>
      <p>RNANet will be continuously updated to integrate newer data as the PDB grows. The first thing to do, as soon as the data permits it, would be to further cluster all the RNA chains by similarity and define sets of points with enough distance between them to be considered independent. This would allow pre-computed training, testing and validation sets.</p>
      <p>Moreover, if an equivalent of the protein tools jackHMMER, HHBlits or MMSeqs2 is released with support for RNA sequences, improvements would become possible to closer follow the ProteinNet strategy. A sequence-alignment-based clustering step could then be added, and the search for homologous sequences upgraded.</p>
      <p>In addition, more descriptors would be easy to compute and could be added in future versions. For example, the BGSU RNA Structure Atlas which uses annotations by FR3D (<xref rid="btaa944-B21" ref-type="bibr">Sarver <italic toggle="yes">et al.</italic>, 2007</xref>) instead of DSSR does not compute the 3D geometric descriptors, but proposes annotations of stacking interactions, base-phosphate interactions, and loop types (hairpin, internal or multiple loops). DSSR also proposes a way to identify splayed-apart conformations of some nucleotides, which could be integrated to our analysis. Such features might be added in a future release of the dataset.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>To speed up the development of machine-learning based RNA structure prediction tools, we developed a pipeline which builds a multi-scale dataset, called RNANet, from public data. Both the dataset and pipeline code are available on the EvryRNA software platform (<ext-link xlink:href="https://EvryRNA.ibisc.univ-evry.fr/evryrna/rnanet" ext-link-type="uri">https://EvryRNA.ibisc.univ-evry.fr/evryrna/rnanet</ext-link>).</p>
    <p>The dataset gathers information about the sequences, the secondary structures and the tertiary structures of available RNA chains chosen with resolution better than a given threshold. We propose a list of various descriptors, including nucleotide frequencies computed on sequences from the Rfam and SILVA databases known to be homologous to the chains, realigned with the 3D chains sequences.</p>
    <p>The dataset can be easily sub-sampled or filtered on demand using custom SQL queries. For example, structures available before a certain date can be retrieved, to allow comparisons with previous RNA-Puzzles benchmarks (<xref rid="btaa944-B14" ref-type="bibr">Miao and Westhof, 2017</xref>). A structure resolution criteria, or a gap percentage threshold, or a minimum number of certain types of basepairs can also be applied to yield only the required data.</p>
    <p>The amount of data, being directly dependant on the content of public databases like the PDB, is for now an obvious limit when it comes to deep models, which would be subject to over-fitting issues. In the meantime, the dataset is useful to compute descriptive statistics about RNA structures [e.g. reproducing (<xref rid="btaa944-B24" ref-type="bibr">Wadley <italic toggle="yes">et al.</italic>, 2007</xref>) results, motif discovery or recurrent interaction patterns description]. Simple supervised learning models, trying to predict some of the structural descriptors using sequence and homology data, can still make a great use of RNANet. The automated pipeline will keep the RNANet dataset up-to-date on EvryRNA, as long as the public databases grow.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa944_Supplementary_Data</label>
      <media xlink:href="btaa944_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>Fariza Tahi would like to thank the Genopole for the financial support given for the platform EvryRNA.</p>
    <sec>
      <title>Funding</title>
      <p>The platform EvryRNA is partially supported by the Genopole.</p>
      <p><italic toggle="yes">Financial Support</italic>: none declared.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa944-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>AlQuraishi</surname><given-names>M.</given-names></string-name></person-group> (<year>2019</year>a) 
<article-title>End-to-end differentiable learning of protein structure</article-title>. <source>Cell Syst</source>., <volume>8</volume>, <fpage>292</fpage>–<lpage>301.e3</lpage>.<pub-id pub-id-type="pmid">31005579</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>AlQuraishi</surname><given-names>M.</given-names></string-name></person-group> (<year>2019</year>b) 
<article-title>ProteinNet: a standardized data set for machine learning of protein structure</article-title>. <source>BMC Bioinformatics</source>, <volume>20</volume>, <fpage>311</fpage>.<pub-id pub-id-type="pmid">31185886</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cock</surname><given-names>P.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) 
<article-title>Biopython: freely available python tools for computational molecular biology and bioinformatics</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1422</fpage>–<lpage>1423</lpage>.<pub-id pub-id-type="pmid">19304878</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Do</surname><given-names>C.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2006</year>) 
<article-title>CONTRAfold: RNA secondary structure prediction without physics-based models</article-title>. <source>Bioinformatics</source>, <volume>22</volume>, <fpage>e90</fpage>–<lpage>e98</lpage>.<pub-id pub-id-type="pmid">16873527</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duarte</surname><given-names>C.M.</given-names></string-name>, <string-name><surname>Pyle</surname><given-names>A.M.</given-names></string-name></person-group> (<year>1998</year>) 
<article-title>Stepping through an RNA structure: a novel approach to conformational analysis</article-title>. <source>J. Mol. Biol</source>., <volume>284</volume>, <fpage>1465</fpage>–<lpage>1478</lpage>.<pub-id pub-id-type="pmid">9878364</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johnson</surname><given-names>L.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>Hidden Markov model speed heuristic and iterative HMM search procedure</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>431</fpage>.<pub-id pub-id-type="pmid">20718988</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kalvari</surname><given-names>I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Rfam 13.0: shifting to a genome-centric resource for non-coding RNA families</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>D335</fpage>–<lpage>D342</lpage>.<pub-id pub-id-type="pmid">29112718</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keating</surname><given-names>K.S.</given-names></string-name>, <string-name><surname>Pyle</surname><given-names>A.M.</given-names></string-name></person-group> (<year>2010</year>) 
<article-title>Semiautomated model building for RNA crystallography using a directed rotameric approach</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>107</volume>, <fpage>8177</fpage>–<lpage>8182</lpage>.<pub-id pub-id-type="pmid">20404211</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keating</surname><given-names>K.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>A new way to see RNA</article-title>. <source>Q. Rev. Biophys</source>., <volume>44</volume>, <fpage>433</fpage>–<lpage>466</lpage>.<pub-id pub-id-type="pmid">21729350</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leontis</surname><given-names>N.B.</given-names></string-name>, <string-name><surname>Westhof</surname><given-names>E.</given-names></string-name></person-group> (<year>2001</year>) 
<article-title>Geometric nomenclature and classification of RNA base pairs</article-title>. <source>RNA</source>, <volume>7</volume>, <fpage>499</fpage>–<lpage>512</lpage>.<pub-id pub-id-type="pmid">11345429</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Leontis</surname><given-names>N.B.</given-names></string-name>, <string-name><surname>Zirbel</surname><given-names>C.L.</given-names></string-name></person-group> (<year>2012</year>) <part-title>Nonredundant 3D structure datasets for RNA knowledge extraction and benchmarking</part-title>. In: Leontis,N. and Westhof,E. (eds) <source>RNA 3D Structure Analysis and Prediction</source>. <italic toggle="yes">Nucleic Acids and Molecular Biology</italic>, vol 27. Springer, Berlin, Heidelberg. pp. <fpage>281</fpage>–<lpage>298</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa944-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>X.-J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>DSSR: an integrated software tool for dissecting the spatial structure of RNA</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>e142</fpage>–<lpage>e142</lpage>.<pub-id pub-id-type="pmid">26184874</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Magnus</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>RNA 3D structure prediction guided by independent folding of homologous sequences</article-title>. <source>BMC Bioinformatics</source>, <volume>20</volume>, <fpage>512</fpage>.<pub-id pub-id-type="pmid">31640563</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miao</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Westhof</surname><given-names>E.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>RNA structure: advances and assessment of 3D structure prediction</article-title>. <source>Annu. Rev. Biophys</source>., <volume>46</volume>, <fpage>483</fpage>–<lpage>503</lpage>.<pub-id pub-id-type="pmid">28375730</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nawrocki</surname><given-names>E.P.</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>S.R.</given-names></string-name></person-group> (<year>2013</year>) 
<article-title>Infernal 1.1: 100-fold faster RNA homology searches</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2933</fpage>–<lpage>2935</lpage>.<pub-id pub-id-type="pmid">24008419</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Petrov</surname><given-names>A.I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Automated classification of RNA 3D motifs and the RNA 3D Motif Atlas</article-title>. <source>RNA</source>, <volume>19</volume>, <fpage>1327</fpage>–<lpage>1340</lpage>.<pub-id pub-id-type="pmid">23970545</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pruesse</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) 
<article-title>SILVA: a comprehensive online resource for quality checked and aligned ribosomal RNA sequence data compatible with ARB</article-title>. <source>Nucleic Acids Res</source>., <volume>35</volume>, <fpage>7188</fpage>–<lpage>7196</lpage>.<pub-id pub-id-type="pmid">17947321</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pruesse</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) 
<article-title>SINA: accurate high-throughput multiple sequence alignment of ribosomal RNA genes</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1823</fpage>–<lpage>1829</lpage>.<pub-id pub-id-type="pmid">22556368</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reinharz</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Mining for recurrent long-range interactions in RNA structures reveals embedded hierarchies in network families</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>3841</fpage>–<lpage>3851</lpage>.<pub-id pub-id-type="pmid">29608773</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Remmert</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) 
<article-title>HHblits: lightning-fast iterative protein sequence searching by HMM-HMM alignment</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>173</fpage>–<lpage>175</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa944-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sarver</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) 
<article-title>FR3D: finding local and composite recurrent structural motifs in RNA 3D structures</article-title>. <source>J. Math. Biol</source>., <volume>56</volume>, <fpage>215</fpage>–<lpage>252</lpage>.<pub-id pub-id-type="pmid">17694311</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Singh</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>RNA secondary structure prediction using an ensemble of two-dimensional deep neural networks and transfer learning</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>1</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">30602773</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M.</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>. <source>Nat. Biotechnol</source>., <volume>35</volume>, <fpage>1026</fpage>–<lpage>1028</lpage>.<pub-id pub-id-type="pmid">29035372</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wadley</surname><given-names>L.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) 
<article-title>Evaluating and learning from RNA pseudotorsional space: quantitative validation of a reduced representation for RNA structure</article-title>. <source>J. Mol. Biol</source>., <volume>372</volume>, <fpage>942</fpage>–<lpage>957</lpage>.<pub-id pub-id-type="pmid">17707400</pub-id></mixed-citation>
    </ref>
    <ref id="btaa944-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>J.</given-names></string-name></person-group> (<year>2019</year>) 
<article-title>Distance-based protein folding powered by deep learning</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>116</volume>, <fpage>16856</fpage>–<lpage>16865</lpage>.<pub-id pub-id-type="pmid">31399549</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
