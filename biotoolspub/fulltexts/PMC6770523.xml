<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genes (Basel)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genes (Basel)</journal-id>
    <journal-id journal-id-type="publisher-id">genes</journal-id>
    <journal-title-group>
      <journal-title>Genes</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2073-4425</issn>
    <publisher>
      <publisher-name>MDPI</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6770523</article-id>
    <article-id pub-id-type="doi">10.3390/genes10090666</article-id>
    <article-id pub-id-type="publisher-id">genes-10-00666</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A Super-Clustering Approach for Fully Automated Single Particle Picking in Cryo-EM</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Al-Azzawi</surname>
          <given-names>Adil</given-names>
        </name>
        <xref ref-type="aff" rid="af1-genes-10-00666">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ouadou</surname>
          <given-names>Anes</given-names>
        </name>
        <xref ref-type="aff" rid="af1-genes-10-00666">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-8314-113X</contrib-id>
        <name>
          <surname>Tanner</surname>
          <given-names>John J.</given-names>
        </name>
        <xref ref-type="aff" rid="af2-genes-10-00666">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Jianlin</given-names>
        </name>
        <xref ref-type="aff" rid="af1-genes-10-00666">1</xref>
        <xref ref-type="aff" rid="af3-genes-10-00666">3</xref>
        <xref rid="c1-genes-10-00666" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="af1-genes-10-00666"><label>1</label>Electrical Engineering and Computer Science Department, University of Missouri, Columbia, MO 65211, USA</aff>
    <aff id="af2-genes-10-00666"><label>2</label>Departments of Biochemistry and Chemistry, University of Missouri, Columbia, MO 65211, USA</aff>
    <aff id="af3-genes-10-00666"><label>3</label>Informatics Institute, University of Missouri, Columbia, MO 65211, USA</aff>
    <author-notes>
      <corresp id="c1-genes-10-00666"><label>*</label>Correspondence: <email>chengji@missouri.edu</email>; Tel.: +1-573-882-7306</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <volume>10</volume>
    <issue>9</issue>
    <elocation-id>666</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 by the authors.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="open-access">
        <license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Structure determination of proteins and macromolecular complexes by single-particle cryo-electron microscopy (cryo-EM) is poised to revolutionize structural biology. An early challenging step in the cryo-EM pipeline is the detection and selection of particles from two-dimensional micrographs (particle picking). Most existing particle-picking methods require human intervention to deal with complex (irregular) particle shapes and extremely low signal-to-noise ratio (SNR) in cryo-EM images. Here, we design a fully automated super-clustering approach for single particle picking (SuperCryoEMPicker) in cryo-EM micrographs, which focuses on identifying, detecting, and picking particles of the complex and irregular shapes in micrographs with extremely low signal-to-noise ratio (SNR). Our method first applies advanced image processing procedures to improve the quality of the cryo-EM images. The binary mask image-highlighting protein particles are then generated from each individual cryo-EM image using the super-clustering (SP) method, which improves upon base clustering methods (i.e., k-means, fuzzy c-means (FCM), and intensity-based cluster (IBC) algorithm) via a super-pixel algorithm. SuperCryoEMPicker is tested and evaluated on micrographs of β-galactosidase and 80S ribosomes, which are examples of cryo-EM data exhibiting complex and irregular particle shapes. The results show that the super-particle clustering method provides a more robust detection of particles than the base clustering methods, such as k-means, FCM, and IBC. SuperCryoEMPicker automatically and effectively identifies very complex particles from cryo-EM images of extremely low SNR. As a fully automated particle detection method, it has the potential to relieve researchers from laborious, manual particle-labeling work and therefore is a useful tool for cryo-EM protein structure determination.</p>
    </abstract>
    <kwd-group>
      <kwd>super-clustering</kwd>
      <kwd>intensity based clustering (IBC)</kwd>
      <kwd>micrograph</kwd>
      <kwd>cryo-EM</kwd>
      <kwd>singe particle pickling</kwd>
      <kwd>protein structure determination</kwd>
      <kwd>k-means</kwd>
      <kwd>fuzzy c-means (FCM)</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1-genes-10-00666">
    <title>1. Introduction</title>
    <p>For decades, X-ray crystallography and nuclear magnetic resonance (NMR) spectroscopy have been the principal technologies of high resolution structural biology, accounting for over 95% of the current holdings of the Protein Data Bank. However, in the past few years, major technological advances have fueled a “resolution revolution” in cryo-electron microscopy (cryo-EM) [<xref rid="B1-genes-10-00666" ref-type="bibr">1</xref>,<xref rid="B2-genes-10-00666" ref-type="bibr">2</xref>,<xref rid="B3-genes-10-00666" ref-type="bibr">3</xref>], and cryo-EM has emerged as a leading structural biology technology capable of determining protein structures to resolutions rivaling X-ray crystallography [<xref rid="B4-genes-10-00666" ref-type="bibr">4</xref>,<xref rid="B5-genes-10-00666" ref-type="bibr">5</xref>,<xref rid="B6-genes-10-00666" ref-type="bibr">6</xref>,<xref rid="B7-genes-10-00666" ref-type="bibr">7</xref>,<xref rid="B8-genes-10-00666" ref-type="bibr">8</xref>,<xref rid="B9-genes-10-00666" ref-type="bibr">9</xref>].</p>
    <p>Identification of particles in micrographs (particle picking) is a critical step in structure determination by cryo-EM. The micrographs result from passing an electron beam through a thin vitrified sample to create 2D image projections of the particle under study [<xref rid="B10-genes-10-00666" ref-type="bibr">10</xref>]. Ultimately, the 3D shape (density map) of the protein is reconstructed from the 2D images. The 2D cryo-EM images contain randomly arranged particles along with non-particles—bits of frost, deformed particles, protein aggregates, and so on. These images have high background noise and low contrast due to a limited electron dose used in imaging. A large number of single-particle images need to be picked from cryo-EM micrographs to perform a reliable 3D reconstruction of the underlying protein structure. Particle picking thus represents an early bottleneck in the practice of cryo-EM structure determination.</p>
    <p>Particle picking methods can be basically divided into three categories: Generative methods [<xref rid="B11-genes-10-00666" ref-type="bibr">11</xref>,<xref rid="B12-genes-10-00666" ref-type="bibr">12</xref>], discriminative classification [<xref rid="B13-genes-10-00666" ref-type="bibr">13</xref>,<xref rid="B14-genes-10-00666" ref-type="bibr">14</xref>,<xref rid="B15-genes-10-00666" ref-type="bibr">15</xref>,<xref rid="B16-genes-10-00666" ref-type="bibr">16</xref>], including the recent deep learning approaches [<xref rid="B17-genes-10-00666" ref-type="bibr">17</xref>,<xref rid="B18-genes-10-00666" ref-type="bibr">18</xref>], and unsupervised learning (clustering) methods [<xref rid="B19-genes-10-00666" ref-type="bibr">19</xref>]. Typically, the generative method employs a template-matching technique, which measures the similarity to a reference to identify particle candidates from micrographs. This technique requires initial high-quality particle templates which are manually selected by an expert. The discriminative classification technique requires preparing an initial set of manually labeled reference particles as the training dataset to train a classifier (e.g., a deep convolutional neural network) to detect particles. Therefore, generative and discriminative methods are not fully automated.</p>
    <p>A typical generative method employs a template-matching technique with a cross-correlation similarity measure to accomplish particle selection. Template-based matching methods are very sensitive to noise and result in a substitutional fraction of false positives since the template-based matching methods rely on local cross-correlation, which result from a false correlation peak [<xref rid="B20-genes-10-00666" ref-type="bibr">20</xref>]. Thus, some initial “good references” are selected in advance to ensure that the manually selected examples have less noise compared with the other particles in the same (2D) micrographs. The discriminative methods first train a classifier based on a labeled dataset of positive and negative examples and then apply this trained classifier to detect and recognize particle images from micrographs. Also, some “good examples” are selected in advance, which avoid the low-contrast particle examples from the micrographs. In most cases, the “bad particle” examples include the local aggregates, overlapped particles, background noise fluctuations, carbon-rich areas, and ice contamination. Thus, after initializing the classifier, an additional step called “manual versification and selection” is required to sort out the “good examples” and isolate them from the “bad ones” [<xref rid="B21-genes-10-00666" ref-type="bibr">21</xref>]. In contrast, the unsupervised approaches distinguish the images of particle-like objects from background noise in micrographs via an unsupervised learning manner (i.e., without any labeled training data). Therefore, the unsupervised approaches are often combined with the template-matching or classification-based approaches to achieve decent picking results [<xref rid="B22-genes-10-00666" ref-type="bibr">22</xref>].</p>
    <p>To aid the streamlining of particle picking, we propose a super-fully automated approach (SuperCryoEMPicker) for picking single particles of complex shapes in cryo-EM images, leveraging the new super-clustering technique. This method improves the base clustering algorithms (e.g., k-means) using the super-pixel algorithm (simple linear iterative clustering (SLIC)) [<xref rid="B23-genes-10-00666" ref-type="bibr">23</xref>]. Specifically, the super-clustering algorithm applies a base clustering algorithm such as k-means [<xref rid="B24-genes-10-00666" ref-type="bibr">24</xref>], fuzzy c-means (FCM) [<xref rid="B25-genes-10-00666" ref-type="bibr">25</xref>], or intensity-based clustering (IBC) [<xref rid="B26-genes-10-00666" ref-type="bibr">26</xref>] to generate a super-pixel map, which is then used for fully automated particle picking in cryo-EM images without human intervention. We demonstrate that our fully automated super-clustering approach can accurately detect and select a sufficient number of complex particles that are comparable to those picked manually. Therefore, it can significantly reduce time and labor spent on particle picking and relieve a bottleneck in the cryo-EM structure determination pipeline.</p>
  </sec>
  <sec sec-type="methods" id="sec2-genes-10-00666">
    <title>2. Methods</title>
    <p>Some cryo-EM datasets feature particles with relatively simple shapes, such as circles or squares; our recently reported algorithm, AutoCryoPicker [<xref rid="B26-genes-10-00666" ref-type="bibr">26</xref>], was designed to handle these cases. Herein, we address the more general (and challenging) case of particles with arbitrary shapes [<xref rid="B14-genes-10-00666" ref-type="bibr">14</xref>,<xref rid="B27-genes-10-00666" ref-type="bibr">27</xref>]. In this case, detecting and picking the irregular or complex particle shapes in very low signal-to-noise ratio (SNR) cryo-EM images faces two main challenges. First, particles appear as non-structural object shapes, which makes template-matching algorithms unable to distinguish between the objects and the background. Second, the particles in the very low SNR cryo-EM images have almost the same intensity level as the background. To address this problem, we propose a super-fully automated approach (SuperCryoEMPicker) for picking single particles of complex shapes in cryo-EM images, leveraging the new super-clustering technique.</p>
    <p>The super-clustering approach was designed especially for picking particles of irregular and complex shapes, as shown for the 80S ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] in <xref ref-type="fig" rid="genes-10-00666-f001">Figure 1</xref>a,b. The framework of the super-clustering approach is shown in <xref ref-type="fig" rid="genes-10-00666-f002">Figure 2</xref>. It was divided into three main stages—pre-processing, particle clustering, and particle picking. In the first stage (pre-processing), the 3D grid (array) of voxels MRC file (Medical Research Council) was converted to the PNG (Portable Network Graphics) image file format using EMAN2 (Executable Image Suite for Electron Microscopy) [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>] in order to apply various image pre-processing techniques. Then, the same advanced pre-processing steps were used to improve the quality of the cryo-EM images. In the second stage, the binary mask of the cryo-EM image was generated. Two kinds of clustering methods were implemented in this stage. The first kind was the base clustering method, which included k-means [<xref rid="B24-genes-10-00666" ref-type="bibr">24</xref>], FCM [<xref rid="B25-genes-10-00666" ref-type="bibr">25</xref>], or intensity-based clustering (IBC) [<xref rid="B26-genes-10-00666" ref-type="bibr">26</xref>]. The second kind was the super-clustering (SP) approach (super-pixel-based simple linear iterative clustering (SLIC) [<xref rid="B23-genes-10-00666" ref-type="bibr">23</xref>]), which was implemented to improve the three base clustering algorithms (k-means, FCM, and IBC), leading to three super-clustering algorithms (SP-k-means, SP-FCM, and SP-IBC). In the third stage, based on the generated binary mask, a final set of particles was selected and picked from clustered particle candidates after some post-processing steps, such as binary mask cleaning and particle property measurement.</p>
    <sec id="sec2dot1-genes-10-00666">
      <title>2.1. Stage 1: Pre-Processing</title>
      <p>In this stage, the EMAN2 software [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>] was used to adjust the global intensity of the cryo-EM micrographs and convert them from the MRC file format to the PNG image format in order to apply standard image-processing tools to them. <xref ref-type="fig" rid="genes-10-00666-f003">Figure 3</xref> shows some samples where different scaling factors were used with EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>] to adjust the intensity of the cryo-EM images.</p>
      <p><xref ref-type="fig" rid="genes-10-00666-f003">Figure 3</xref>b shows the same zoomed-in particle image after using scale factor 5 and its histogram, respectively, which had better contrast than the original image, shown in <xref ref-type="fig" rid="genes-10-00666-f003">Figure 3</xref>a. However, the quality of images in <xref ref-type="fig" rid="genes-10-00666-f003">Figure 3</xref>h which were adjusted with scaling factors 0.1 and 0.5, were lower than the original.</p>
      <p>In the second step, different image pre-processing procedures (image resolution, global intensity adjustment, global contrast enhancement-based histogram equalization, noise suppressing using the Wiener filter, local particle contrast enhancement with adaptive histogram equalization, and edges enhancement using guided image filtering) were applied to improve the quality of the cryo-EM images as in AutoCryoPicker [<xref rid="B26-genes-10-00666" ref-type="bibr">26</xref>]. The results of the pre-processing procedures for the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] and beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] images are shown in <xref ref-type="fig" rid="genes-10-00666-f004">Figure 4</xref>.</p>
    </sec>
    <sec id="sec2dot2-genes-10-00666">
      <title>2.2. Stage 2: Particle Clustering</title>
      <p>In order to pick each possible particle in the cryo-EM image, a binary mask that clusters particles was needed. Both the base clustering algorithms (k-means [<xref rid="B24-genes-10-00666" ref-type="bibr">24</xref>], FCM [<xref rid="B25-genes-10-00666" ref-type="bibr">25</xref>], and IBC [<xref rid="B26-genes-10-00666" ref-type="bibr">26</xref>]) and the super-clustering algorithm built on top of the base algorithms (SP-K-means, SP-FCM, and SP-IBC) via pixel posterization using simple linear iterative clustering (SLIC) [<xref rid="B23-genes-10-00666" ref-type="bibr">23</xref>] were used to create the binary mask according to the following steps.</p>
      <sec id="sec2dot2dot1-genes-10-00666">
        <title>2.2.1. Clustering with Base Clustering Algorithms</title>
        <p>We applied three base clustering algorithms, including k-means, FCM, and IBC, to cluster particles. The number of clusters was chosen based on the predefined cluster numbers that the ICB clustering algorithm defined [<xref rid="B26-genes-10-00666" ref-type="bibr">26</xref>]. The initial number of clusters in the ICB algorithm was based on two factors—the adjusted intensity range and the interval size. The adjusted intensity range was automatically computed from the pre-processed cryo-EM image based on the lower and the upper bounds of the intensity level, while interval size was computed based on the ratio between the difference of the maximum and minimum intensity level and the adjusted intensity range. For instance, the initial number of clusters was <italic>K</italic> = 4, and if the adjusted intensity range was from 0.2 to 0.8 and the interval size was 0.15, there were 4 initial cluster levels, where the intensity level [0.2–0.35] is assigned to Cluster 1, [0.35–0.5] to Cluster 2, [0.5–0.65] to Cluster 3, and 316 [0.65–0.8] to Cluster 4. <xref ref-type="fig" rid="genes-10-00666-f005">Figure 5</xref> illustrates the results of the three base clustering algorithms. More details about applying the three algorithms to particle clustering can be found in [<xref rid="B26-genes-10-00666" ref-type="bibr">26</xref>].</p>
      </sec>
      <sec id="sec2dot2dot2-genes-10-00666">
        <title>2.2.2. Super-Particle Clustering</title>
        <p>We designed a super-clustering approach to further improve cryo-EM binary mask image generation based on pixel posterization using simple linear iterative clustering (SLIC) [<xref rid="B23-genes-10-00666" ref-type="bibr">23</xref>]. In this approach, an intermedia image map (super pixel over segmentation image) was generated and used as the input for the three base clustering algorithms (k-means, FCM, and IBC) to perform clustering, leading to three super-clustering methods, SP-k-means, DP-FCM, and SP-IBC, for fully automated single particle picking in cryo-EM.</p>
        <p>The SLIC super-pixel method [<xref rid="B23-genes-10-00666" ref-type="bibr">23</xref>] combines the two kinds of distances between pixels <inline-formula><mml:math id="mm1"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm2"><mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (Equation (1) for intensity distance and Equation (2) for spatial distance) into a single distance in Equation (3) [<xref rid="B23-genes-10-00666" ref-type="bibr">23</xref>]:<disp-formula id="FD1-genes-10-00666"><label>(1)</label><mml:math id="mm3"><mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD2-genes-10-00666"><label>(2)</label><mml:math id="mm4"><mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm5"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:math></inline-formula> is the intensity level and <inline-formula><mml:math id="mm6"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm7"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> are spatial pixel information.
<disp-formula id="FD3-genes-10-00666"><label>(3)</label><mml:math id="mm8"><mml:mrow><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm9"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm10"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are the maximum distance within a cluster. Basically, SLIC normalizes the distances of the intensity value and the spatial information by their respective maximum values. The maximum spatial distance is calculated based on the expected spatial distance within a given cluster that corresponds to the sampling grid interval (<inline-formula><mml:math id="mm11"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula>). To produce the roughly equal-sized super-pixels, the interval grid <inline-formula><mml:math id="mm12"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> is calculated as is shown in Equation (4) [<xref rid="B23-genes-10-00666" ref-type="bibr">23</xref>]:<disp-formula id="FD4-genes-10-00666"><label>(4)</label><mml:math id="mm13"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:mfrac></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm14"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> is the desired number of the approximated equal-sized super-pixels and N is the lowest gradient position (3 × 3) neighborhood.</p>
        <p>To avoid centering a super-pixel in an edge, the centers of the grid interval (<inline-formula><mml:math id="mm15"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula>) are moved to the seed location corresponding to the lowest gradient position (3 × 3) neighborhood. To reduce the distance computations, SLIC only computes the distance from each pixel to each cluster center within the <inline-formula><mml:math id="mm16"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mi>S</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> region. Since the intensity level can vary significantly from image to image and from cluster to cluster, the calculation of the maximum intensity distance <inline-formula><mml:math id="mm17"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is straightforward. <inline-formula><mml:math id="mm18"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is fixed as a constant <inline-formula><mml:math id="mm19"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> so that the weighted distance measure is calculated as Equation (5) [<xref rid="B23-genes-10-00666" ref-type="bibr">23</xref>].
<disp-formula id="FD5-genes-10-00666"><label>(5)</label><mml:math id="mm20"><mml:mrow><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mi>S</mml:mi></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm21"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> is a fixed constant number and <inline-formula><mml:math id="mm22"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> is the grid interval. Multiplying Equation (5) by <inline-formula><mml:math id="mm23"><mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula> leads to a simplified distance measure in Equation (6):<disp-formula id="FD6-genes-10-00666"><label>(6)</label><mml:math id="mm24"><mml:mrow><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mi>S</mml:mi></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p>Also, <inline-formula><mml:math id="mm25"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> allows us to weight the relative importance of the spatial information and the intensity similarity. When m is large, there is a small area-to-perimeter ratio (more impact); otherwise, there is an area close to the image boundary, which is less regular. <xref ref-type="fig" rid="genes-10-00666-f006">Figure 6</xref> shows examples of different intermediate cryo-EM images of super-pixel clustering for ribosomes [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] and beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>]. We compared the intermediate cryo-EM images generated from the original cryo-EM images without pre-processing and with the ones from the pre-processed images (<xref ref-type="fig" rid="genes-10-00666-f006">Figure 6</xref>).</p>
        <p>The intermediate images generated from original images were worse than the originals, but the intermediate cryo-EM images generated from the pre-processed images were better than the pre-processed images. The intermediate images generated from the pre-processed images were used by the three base clustering algorithms for super-clustering, respectively. The super-pixel k-means clustering (SP-k-means) had three significant steps: Generating the 2D super pixels from the intermediate images, using k-means to cluster super-pixels (i.e., binary mask generation), and selecting the particle cluster from the clean image mask without small objects.</p>
        <p>The SP-k-means automatically selected the proper cluster number for particles after the non-zero element (clustered particles) was extracted from each cluster image, as is shown in <xref ref-type="fig" rid="genes-10-00666-f007">Figure 7</xref>. The SP-k-means did not require extra human intervention to select the most appropriate cluster like the original k-means [<xref rid="B24-genes-10-00666" ref-type="bibr">24</xref>] did. SP-k-means is a fully automated clustering algorithm based on the assumption that each group of white pixels (non-zero elements) represents one particular single particle in different cluster image and the black pixels represent the cryo-EM background (see <xref ref-type="fig" rid="genes-10-00666-f007">Figure 7</xref>b). SP-k-means labeled each group of pixels (particles) in each cluster image (binary) and numbered each single particle (see <xref ref-type="fig" rid="genes-10-00666-f007">Figure 7</xref>c). Based on the total number of particles in each cluster image (see <xref ref-type="fig" rid="genes-10-00666-f007">Figure 7</xref>d–g), the SP-k-means selected the optimal cluster that had the smallest number of labels, which represented the target cluster that had the correct particle number and position in the original image (see <xref ref-type="fig" rid="genes-10-00666-f007">Figure 7</xref>f).</p>
        <array orientation="portrait">
          <tbody>
            <tr>
              <td align="left" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">
                <bold>Algorithm 1: SP-k-Means Clustering Algorithm</bold>
              </td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">1. <bold>Input:</bold> Pre-processed cryo-EM image <inline-formula><mml:math id="mm26"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">2. <bold>Return:</bold> Super-clustered image <inline-formula><mml:math id="mm27"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">3. Set number of clusters, <inline-formula><mml:math id="mm28"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">4. Generate the 2D super-pixel from the super-clustered image</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">5. <bold>begin</bold>/* SLIC */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">6.  Initialize <inline-formula><mml:math id="mm29"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>/* the cluster centers */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">7.  Move the cluster center cluster centers to the lowest gradient position in a 3 × 3 neighborhood.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">8.  Set label <inline-formula><mml:math id="mm30"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> for each pixel <inline-formula><mml:math id="mm31"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">9.  Set distance <inline-formula><mml:math id="mm32"><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>∞</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for each pixel <inline-formula><mml:math id="mm33"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">10.  <bold>repeat</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">11.   <bold>for</bold>
<inline-formula><mml:math id="mm34"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="mm35"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">12.    <bold>for</bold> each pixel <inline-formula><mml:math id="mm36"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> in <inline-formula><mml:math id="mm37"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mi>S</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> region around <inline-formula><mml:math id="mm38"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>
<bold>do</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">13.     Compute distance D between <inline-formula><mml:math id="mm39"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm40"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">14.      <bold>if</bold>
<inline-formula><mml:math id="mm41"><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>
<bold>then</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">15.       set <inline-formula><mml:math id="mm42"><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">16.       set <inline-formula><mml:math id="mm43"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">17.      <bold>end if</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">18.    <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">19.   <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">20.   Compute new cluster center <inline-formula><mml:math id="mm44"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="sans-serif">θ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">21.   Compute residual error <inline-formula><mml:math id="mm45"><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">22.  <bold>until</bold>
<inline-formula><mml:math id="mm46"><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">23.  generate binary mask</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">24.  end/* SLIC */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">25.  <bold>repeat</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">26.   <bold>for</bold> n = 1 to <inline-formula><mml:math id="mm47"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">27.    Determine the closest representative, <inline-formula><mml:math id="mm48"><mml:mrow><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, for <inline-formula><mml:math id="mm49"><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">28.    Set label for data point <inline-formula><mml:math id="mm50"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="mm51"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">29.   <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">30.   <bold>for</bold> k = 1 to <italic>K</italic>
<bold>do</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">31.    Update cluster representative <inline-formula><mml:math id="mm53"><mml:mrow><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to the mean with cluster label <inline-formula><mml:math id="mm54"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">32.                  <inline-formula><mml:math id="mm55"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="sans-serif">θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">33.   <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">34.  <bold>until</bold> change in cluster centers are small</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">35.   <bold>for</bold> k = 1 to to <italic>K</italic> do/* foe each clustered image */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">36.   <inline-formula><mml:math id="mm57"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi>sc</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi>Min</mml:mi><mml:mfenced><mml:mrow><mml:mi>Nonzero</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* extract the total number of the non-zero element in each cluster and select the cluster that has the minimum total number of the non-zero element */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">37.   <bold>end for</bold></td>
            </tr>
          </tbody>
        </array>
        <p>Similarly, SP-FCM and SP-IBC are described in Algorithms 2 and 3, respectively.</p>
        <array orientation="portrait">
          <tbody>
            <tr>
              <td align="left" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">
                <bold>Algorithm 2: SP-FCM Clustering Algorithm</bold>
              </td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">1. <bold>Input:</bold> Pre-processed cryo-EM image <inline-formula><mml:math id="mm58"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">2. <bold>Return:</bold> Super-clustered image <inline-formula><mml:math id="mm59"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">3. Set number of clusters, <inline-formula><mml:math id="mm60"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">4. Generate the 2D super-pixel over segmentation image</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">5.  <bold>begin</bold>/*SLIC*/</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">6.  Initialize the cluster centers <inline-formula><mml:math id="mm61"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">7.  Move the cluster center cluster centers to the lowest gradient position in a 3 × 3 neighborhood.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">8.  Set label <inline-formula><mml:math id="mm62"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> for each pixel <inline-formula><mml:math id="mm63"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">9.  Set distance <inline-formula><mml:math id="mm64"><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>∞</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for each pixel <inline-formula><mml:math id="mm65"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">10.  <bold>repeat</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">11.   <bold>for</bold>
<inline-formula><mml:math id="mm66"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="mm67"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">12.    <bold>for</bold> each pixel <inline-formula><mml:math id="mm68"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> in <inline-formula><mml:math id="mm69"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mi>S</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> region around <inline-formula><mml:math id="mm70"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>
<bold>do</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">13.     Compute distance D between <inline-formula><mml:math id="mm71"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm72"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">14.     <bold>if</bold>
<inline-formula><mml:math id="mm73"><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>
<bold>then</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">15.      Set <inline-formula><mml:math id="mm74"><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">16.      Set <inline-formula><mml:math id="mm75"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">17.     <bold>end if</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">18.    <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">19.   <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">20.   Compute new cluster center <inline-formula><mml:math id="mm76"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="sans-serif">θ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">21.   Compute residual error <inline-formula><mml:math id="mm77"><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">22.  <bold>until</bold>
<inline-formula><mml:math id="mm78"><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">23. generate binary mask</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">24. end/* SLIC */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">25. <bold>repeat</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">26.   <bold>for</bold> n = 1 to <inline-formula><mml:math id="mm79"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> do</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">27.    Update membership <inline-formula><mml:math id="mm80"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">u</mml:mi><mml:mrow><mml:mi>nk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> by taking sum of distance ratios of cluster <inline-formula><mml:math id="mm81"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula> and all clusters.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">28.                 <inline-formula><mml:math id="mm82"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">29.       <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">30. <bold>until</bold> change in cluster centers are small</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">31. <bold>for</bold> k = 1 to <inline-formula><mml:math id="mm83"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold>/* foe each clustered image */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">32.    <inline-formula><mml:math id="mm84"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi>sc</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi>Min</mml:mi><mml:mfenced><mml:mrow><mml:mi>Nonzero</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* extract the total number of the non-zero element in each cluster and select the minimum one as a final selected clustered image */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">33. <bold>end for</bold></td>
            </tr>
          </tbody>
        </array>
        <array orientation="portrait">
          <tbody>
            <tr>
              <td align="left" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">
                <bold>Algorithm 3: SP-IBC Clustering Algorithm</bold>
              </td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">1. <bold>Input:</bold> Pre-processed cryo-EM image <inline-formula><mml:math id="mm85"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">2. <bold>Return:</bold> Super-clustered image <inline-formula><mml:math id="mm86"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">3. Set number of clusters, <inline-formula><mml:math id="mm87"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">4. Generate the 2D super-pixel over segmentation image</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">5.  <bold>begin</bold>/* SLIC */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">6.  Initialize the cluster centers <inline-formula><mml:math id="mm88"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">7.  Move the cluster center cluster centers to the lowest gradient position in a 3 × 3 neighborhood.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">8.  Set label <inline-formula><mml:math id="mm89"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> for each pixel <inline-formula><mml:math id="mm90"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">9.  Set distance <inline-formula><mml:math id="mm91"><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>∞</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for each pixel <inline-formula><mml:math id="mm92"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">10.  <bold>repeat</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">11.   <bold>for</bold>
<inline-formula><mml:math id="mm93"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="mm94"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">12.    <bold>for</bold> each pixel <inline-formula><mml:math id="mm95"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> in <inline-formula><mml:math id="mm96"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mi>S</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> region around <inline-formula><mml:math id="mm97"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>
<bold>do</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">13.     Compute distance D between <inline-formula><mml:math id="mm98"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm99"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">14.     <bold>if</bold>
<inline-formula><mml:math id="mm100"><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>
<bold>then</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">15.      Set <inline-formula><mml:math id="mm101"><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">16.      Set <inline-formula><mml:math id="mm102"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mfenced><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">17.    <bold>end if</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">18.    <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">19.   <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">20.   Compute new cluster center <inline-formula><mml:math id="mm103"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="sans-serif">θ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">21.   Compute residual error <inline-formula><mml:math id="mm104"><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">22.  <bold>until</bold>
<inline-formula><mml:math id="mm105"><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">23.  Generate binary mask</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">24. <bold>end</bold>/* SLIC */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">25. Transform the intermedia 2D image map <inline-formula><mml:math id="mm106"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> into 1D <inline-formula><mml:math id="mm107"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">v</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> which has the intensity values of all the pixels.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">26. <inline-formula><mml:math id="mm109"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>← height × width where <inline-formula><mml:math id="mm110"><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:math></inline-formula> is the total number of pixels in the <inline-formula><mml:math id="mm111"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">27. <inline-formula><mml:math id="mm112"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mrow><mml:mi>Max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>← <inline-formula><mml:math id="mm113"><mml:mrow><mml:mrow><mml:mi>Max</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">v</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* maximum values of intensity in the image */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">28. <inline-formula><mml:math id="mm114"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mrow><mml:mi>Min</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>← <inline-formula><mml:math id="mm115"><mml:mrow><mml:mrow><mml:mi>Min</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">v</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* minimum values of intensity in the image */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">29. K← 4/* set the number of initial cluster based on the interval size = 0.15 */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">30. <bold>for</bold>
<inline-formula><mml:math id="mm116"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> = 1 to <inline-formula><mml:math id="mm117"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">31.  <inline-formula><mml:math id="mm118"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Int</mml:mi></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>← <inline-formula><mml:math id="mm119"><mml:mrow><mml:mrow><mml:mfenced><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mrow><mml:mi>Max</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mrow><mml:mi>Min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">K</mml:mi><mml:mo>×</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mn>0.15</mml:mn><mml:mo>/</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>* set the interval size as the vector of intensity range (max min) divided by the cluster number <inline-formula><mml:math id="mm120"><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:math></inline-formula> */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">32. <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">33. <bold>for</bold>
<inline-formula><mml:math id="mm121"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> = 1 to <inline-formula><mml:math id="mm122"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">34.  <inline-formula><mml:math id="mm123"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="sans-serif">θ</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mrow><mml:mi>Int</mml:mi></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:mi mathvariant="normal">i</mml:mi></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> /* initialize the cluster center based on the interval size */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">35. <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">36. <bold>repeat</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">37.    <bold>for</bold>
<inline-formula><mml:math id="mm124"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> = 1 to <inline-formula><mml:math id="mm125"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">38.    <bold>for</bold>
<inline-formula><mml:math id="mm126"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> = 1 to <inline-formula><mml:math id="mm127"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> do</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">39.     <inline-formula><mml:math id="mm128"><mml:mrow><mml:mrow><mml:mi>Cluster</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mi>ind</mml:mi></mml:mrow></mml:mfenced><mml:mtext> </mml:mtext><mml:mo>←</mml:mo><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>abs</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi mathvariant="sans-serif">θ</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mfenced close="]" open="["><mml:mi mathvariant="normal">i</mml:mi></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mfenced close="]" open="["><mml:mi mathvariant="normal">j</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* assign <inline-formula><mml:math id="mm129"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> the cluster <inline-formula><mml:math id="mm130"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula> whose center (<inline-formula><mml:math id="mm131"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="sans-serif">θ</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is closest to <inline-formula><mml:math id="mm132"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> according to the absolute intensity difference between the two */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">40.   <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">41.  <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">42.  <bold>for</bold>
<inline-formula><mml:math id="mm133"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> = 1 to <inline-formula><mml:math id="mm134"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">43.   <inline-formula><mml:math id="mm135"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="sans-serif">θ</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:mi mathvariant="normal">n</mml:mi></mml:mfenced><mml:mo>←</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mi>Cluster</mml:mi><mml:mfenced close="]" open="["><mml:mi mathvariant="normal">k</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>count</mml:mi><mml:mfenced><mml:mrow><mml:mi>ones</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>/* update the mean <inline-formula><mml:math id="mm136"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="sans-serif">θ</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> of each cluster by calculating the average intensity values of the pixels assigned to the cluster */.</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">44.  <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">45. <bold>until</bold> there is no change in cluster centers.</td>
            </tr>
          </tbody>
        </array>
        <p><xref ref-type="fig" rid="genes-10-00666-f008">Figure 8</xref> shows some examples of the super-clustering results for the 80S ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] and beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>], comparing them with the base clustering algorithms. <xref ref-type="fig" rid="genes-10-00666-f008">Figure 8</xref> shows that the super-clustering results were better than those of the base algorithms. The three super-clustering methods were fully automated, generated cleaner image masks, and ran faster than their base clustering algorithms. For instance, the running time of clustering one image using k-means was 46.07 s, versus 117.06 s for SP-k-means.</p>
      </sec>
    </sec>
    <sec id="sec2dot3-genes-10-00666">
      <title>2.3. Stage 3: Particle Picking</title>
      <p>The particle picking stage had two main steps. The first step was the binary mask image cleaning and the second step was the particle detection and picking. The image masks generated by the super-clustering methods (e.g., <xref ref-type="fig" rid="genes-10-00666-f008">Figure 8</xref>f,h,j,l,n,p) were clean and did not require a post-processing stage to clean them. However, the binary mask image cleaning step was required to remove some small and noisy objects from the image mask generated by the base clustering algorithms (e.g., <xref ref-type="fig" rid="genes-10-00666-f008">Figure 8</xref>e,g,i,k,m,o).</p>
      <sec id="sec2dot3dot1-genes-10-00666">
        <title>2.3.1. Binary Mask Cleaning</title>
        <p>The regular binary mask for each cryo-EM cluster image generated by a base clustering method (k-means, FCM, and IBC) was cleaned through the removal of the small and non-connected objects. The image cleaning algorithm is shown in Algorithm 4.</p>
        <array orientation="portrait">
          <tbody>
            <tr>
              <td align="left" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">
                <bold>Algorithm 4: Image Cleaning</bold>
              </td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">1. <bold>Input:</bold>
<inline-formula><mml:math id="mm137"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>/* cluster cryo-EM image */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">2. <bold>Return:</bold>
<inline-formula><mml:math id="mm138"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>/* cleaned cluster image */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">3. <inline-formula><mml:math id="mm139"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi>imopen</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* apply image opening on the cluster image to enlarge small blobs */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">4. <inline-formula><mml:math id="mm140"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mo>←</mml:mo><mml:mi>bwlabel</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* label each object in the cluster image which returns a label matrix <inline-formula><mml:math id="mm141"><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:math></inline-formula> that contains 8-connected object in the cluster */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">5. <bold>for</bold>
<inline-formula><mml:math id="mm142"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>=1 to <inline-formula><mml:math id="mm143"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold>/* for each object in the clustered image */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">6.  <inline-formula><mml:math id="mm144"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi>object</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi>state</mml:mi><mml:mfenced><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mfenced><mml:mi mathvariant="normal">k</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* get each particle where <inline-formula><mml:math id="mm145"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula> is the total number of objects in the cluster cryo-EM */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">7.  <inline-formula><mml:math id="mm146"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi>object</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi>remove</mml:mi><mml:mfenced><mml:mrow><mml:mi>state</mml:mi><mml:mfenced><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mfenced><mml:mi mathvariant="normal">k</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mtext> </mml:mtext></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* remove all the connected components that are smaller than the p pixels */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">8.  <inline-formula><mml:math id="mm147"><mml:mrow><mml:mrow><mml:mi>centroid</mml:mi><mml:mo>=</mml:mo><mml:mi>stats</mml:mi><mml:mfenced><mml:mi mathvariant="normal">k</mml:mi></mml:mfenced><mml:mo>.</mml:mo><mml:mi>Centroid</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>/* mark and get the actual index numbers and the centroid of each object */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">9. <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">10. <inline-formula><mml:math id="mm148"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>obj</mml:mi></mml:mrow><mml:mrow><mml:mi>number</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mrow><mml:mi>is</mml:mi><mml:mtext> </mml:mtext><mml:mi>member</mml:mi></mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi>object</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* extract the number of object (particles) */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">11. <inline-formula><mml:math id="mm149"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mo>←</mml:mo><mml:mi>bwlabel</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>/* label each object (particle) */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">12. <bold>for</bold>
<inline-formula><mml:math id="mm150"><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:mrow></mml:math></inline-formula>= 1 to <inline-formula><mml:math id="mm151"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold>/* for each object (particles) */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">13.  Do size filtering and roundness filtering</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">14.  <inline-formula><mml:math id="mm152"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mo>←</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mi>props</mml:mi><mml:mo>.</mml:mo><mml:mi>label</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* extract the 8-connectedlabeld object */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">15.         <inline-formula><mml:math id="mm153"><mml:mrow><mml:mrow><mml:mi>keeperObjects</mml:mi><mml:mo>←</mml:mo><mml:mi>props</mml:mi><mml:mo>.</mml:mo><mml:mi>label</mml:mi><mml:mo>&gt;</mml:mo><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mo>/</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>* remove each object that less than 8-connected component in the binary image */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">16.  <inline-formula><mml:math id="mm154"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mrow><mml:mi>keeperObjects</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>/* get actual index numbers instead of a logical vector */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">17.  <inline-formula><mml:math id="mm155"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi>cc</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi>bwareaopen</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* produce new binary image with only the small, or non-connected object */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">18. <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">19. Generate and getting a new binary image</td>
            </tr>
          </tbody>
        </array>
        <p><xref ref-type="fig" rid="genes-10-00666-f009">Figure 9</xref> shows examples of the image cleaning and non-connected object removal on the image masks generated by the three base clustering algorithms. <xref ref-type="fig" rid="genes-10-00666-f009">Figure 9</xref> shows that image cleaning separated the particles from the background noise in the image masks generated by the three base clustering methods well.</p>
        <p><xref ref-type="fig" rid="genes-10-00666-f010">Figure 10</xref> shows the whole particle images of the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] and beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] before and after image cleaning for k-means [<xref rid="B24-genes-10-00666" ref-type="bibr">24</xref>], FCM [<xref rid="B25-genes-10-00666" ref-type="bibr">25</xref>], and IBC [<xref rid="B26-genes-10-00666" ref-type="bibr">26</xref>] clustering, respectively. For instance, <xref ref-type="fig" rid="genes-10-00666-f010">Figure 10</xref>a,b shows the whole particle ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] image before and after image cleaning for k-means, respectively. <xref ref-type="fig" rid="genes-10-00666-f010">Figure 10</xref>c,d shows the whole particle image of beta-galactosidase before and after image cleaning for k-means respectively. In both cases, we noticed that when the non-particles (small objects) and noise in the clustering image were cleaned and removed from the background, the objects (particles) became clearer to detect and pick.</p>
      </sec>
      <sec id="sec2dot3dot2-genes-10-00666">
        <title>2.3.2. Single Particle Detection and Picking</title>
        <p>Since the shapes of the protein particles were complex or irregular, particle detection and picking step was applied on clean image masks to detect each single particle. The particle detection and picking algorithm is described in Algorithm 5.</p>
        <array orientation="portrait">
          <tbody>
            <tr>
              <td align="left" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">
                <bold>Algorithm 5: Single Particle Detection and Picking</bold>
              </td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">1. <bold>Input:</bold>
<inline-formula><mml:math id="mm156"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> /* cleaned cluster image with square shapes only */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">2. <bold>Return:</bold>
<inline-formula><mml:math id="mm157"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> /* cleaned cluster image with perfect square shapes */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">3. <inline-formula><mml:math id="mm158"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mo>←</mml:mo><mml:mi>bwlabel</mml:mi><mml:mfenced><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> /* label each object in the cluster image */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">4. <bold>for</bold> i = 1 to <inline-formula><mml:math id="mm159"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold> /* for each object in the clustered image */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">5.  <inline-formula><mml:math id="mm160"><mml:mrow><mml:mrow><mml:mrow><mml:mi>Stats</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mo>←</mml:mo><mml:mrow><mml:mtext> </mml:mtext><mml:mi>regionprops</mml:mi></mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi>cs</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* measure properties of particle region */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">6.   Areas ← [props.Area /* compute all the shape measurements and the pixel value measurements as well */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">7. <bold>end for</bold></td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">8. <bold>for</bold>
<inline-formula><mml:math id="mm161"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> = 1 to <inline-formula><mml:math id="mm162"><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mfenced><mml:mrow><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>O</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>
<bold>do</bold>/* for each particle object */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">9.  <inline-formula><mml:math id="mm163"><mml:mrow><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>←</mml:mo><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mfenced><mml:mrow><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>O</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>/* extract the centroid is the horizontal coordinate (or x-coordinate) and vertical coordinate (or y-coordinate) */</td>
            </tr>
            <tr>
              <td align="left" valign="middle" rowspan="1" colspan="1">10.  Draw all bounding box for a discontinuous region</td>
            </tr>
            <tr>
              <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">11. <bold>end for</bold></td>
            </tr>
          </tbody>
        </array>
        <p>The detection algorithm returned a bounding box drawn around each particle detected in the image. <xref ref-type="fig" rid="genes-10-00666-f011">Figure 11</xref> shows the detection results of two different cryo-EM images of the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] and beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>]. The results of the super-clustering methods were significantly better than the base clustering methods for both the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] and the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] images.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="sec3-genes-10-00666">
    <title>3. Results and Discussion</title>
    <sec id="sec3dot1-genes-10-00666">
      <title>3.1. Datasets</title>
      <p>Images from two datasets (80S ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] and beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>]) were used to evaluate the fully automated particle picking using the base and super-clustering methods. The two datasets were download form the Electron Microscopy Public Image Archive (EMPIAR-10028 and EMPIAR-10017). The ribosome dataset (EMPIAR-10028) [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] was in a multi-frame MRC image format (32 Bit Float). The size of each micrograph was 4096 by 4096 pixels and the dataset consisted of 1081 micrographs, each with 16 frames per image. The beta-galactosidase dataset (EMPIAR-10017) was in the single-frame MRC image format (32 Bit Float). It was a public dataset available in the Electron Microscopy Public Image Archive (EMPIAR) as EMPIAR-10017. The size of each micrograph was 4096 by 4096 pixels, with 84 micrographs in total. The micrographs were the average, without any realignment, of 24 raw movie frames (accumulating 24 electron per squared Angstrom in a 1.5 s exposure). For the experimental results, we randomly selected 80 micrographs from the ribosome dataset [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] and 80 micrographs from the beta-galactosidase dataset [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] for a balanced dataset that was used to evaluate our approach.</p>
    </sec>
    <sec id="sec3dot2-genes-10-00666">
      <title>3.2. Evaluation Metrics</title>
      <p>In general, the signal-to-noise ratio is the way that the noise signal is measured in either a signal or an image. In other words, a better way to assess the amount of noise in an image is to measure the ratio of pure pixels (called mean of the signal or mean of the pixel values) to noisy pixels, which is the standard deviation of the signal (called the noise standard deviation), as shown in Equation (7).
<disp-formula id="FD7-genes-10-00666"><label>(7)</label><mml:math id="mm164"><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <italic>n</italic> is the total number of pixels in the micrograph.</p>
      <p>In order to reduce radiation damage to the biomolecules of interest during the imaging process of the microscopy, a limited electron dose was used, as high-energy electrons can greatly damage specimens during imaging, resulting in extremely noisy micrographs. Moreover, the micrographs contained two-dimensional projections of a particle in different orientations. Generally, cryo-EM images have low contrast, due to the similarity of the electron density of the protein to that of the surrounding solution, as well as the limited electron dose used in data collection. In addition, the micrographs might have contained sections of ice, deformed particles, protein aggregates, etc., which would complicate particle picking. The cryo-EM images (micrographs) of the protein particles were taken by electron microscope, which contained randomly arranged particles along with non-particles—bits of frost, deformed particles, protein aggregates, and so on. These images suffered from heavy background noise and low contrast, due to a limited electron dose used in imaging. For these reasons, we observed that the micrographs had an extremely low signal-to-noise ratio.</p>
      <p>Typically, for the first pre-processing stage, we used the EMAN2 software [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>] to adjust the global intensity of the cryo-EM and convert them from MRC file format to the PNG image format in order to apply standard image-processing tools to them. In terms of selecting the best results, we used different scaling factors with EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>] to adjust the intensity of the cryo-EM images. Then, we computed different evaluation metrics, such as the peak signal-to-noise ratio (PSNR), signal-to-noise ratio (SNR), and mean squared error (MSE), to evaluate the improvement of the quality of cryo-EM images in the whole dataset in each different scaling factor and compare the results with the original micrographs (i.e., without the using the intensity adjustment scaling factor).</p>
      <p>Based on the SNR evaluation metric in Equation (7), where noise signal was measured, the PSNR often measured ratios between the maximum signal (pure pixels) and noise (corrupted pixels). PNSR uses a logarithmic decibel scale to measure the ratio between the maximum signal and noise that has a very wide dynamic range, as shown in Equation (8).
<disp-formula id="FD8-genes-10-00666"><label>(8)</label><mml:math id="mm165"><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mfenced><mml:mrow><mml:mfrac><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm166"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the maximum possible pixel value of the micrograph and <inline-formula><mml:math id="mm167"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is mean squared error given in Equation (9):<disp-formula id="FD9-genes-10-00666"><label>(9)</label><mml:math id="mm168"><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>(</mml:mo><mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>I</mml:mi><mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm169"><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is the micrograph image size, <inline-formula><mml:math id="mm170"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> is the original micrograph, and <inline-formula><mml:math id="mm171"><mml:mrow><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the pre-processed micrograph.</p>
      <p>For the pre-processing stage, we used common image pre-processing criteria, such as peak signal-to-noise ratio (PSNR), signal-to-noise ratio (SNR), and mean squared error (MSE), to evaluate the improvement of the quality of cryo-EM images [<xref rid="B33-genes-10-00666" ref-type="bibr">33</xref>]. For the particle clustering and detection stages, we used the accuracy, precision, recall, and F1-score (i.e., the geometry means of precision and recall) to evaluate the particle clustering/detection results.</p>
      <p><xref rid="genes-10-00666-t001" ref-type="table">Table 1</xref> reports the average quality measurements of the cryo-EM images with/without EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>] intensity adjustment. The average quality measurements (PSNR, SNR, and MSE) of the original cryo-EM images were 28.06, 6.99 dB, and 26218.13, respectively. The intensity adjustment with many scaling factors improved the quality. The best scaling factor, which increased the PSNR and SNR while simultaneously decreasing the MSE, was the “sane” option, which picked a good range of scaling factors automatically. The three scores of using the “sane” scaling factor were improved by 29.27, 8.10 dB, and 0.198643.</p>
      <p><xref ref-type="fig" rid="genes-10-00666-f012">Figure 12</xref>a compares the average PSNR and SNR scores of the cryo-EM images before and after all the pre-processing steps in the pre-processing stage. <xref ref-type="fig" rid="genes-10-00666-f012">Figure 12</xref>b shows the MSE scores of the cryo-EM images before and after all the pre-processing steps.</p>
      <p>The average PSNR score increased from 77.43 to 78.57 and the average SNR score increased from 3.40 to 4.05. The average MSE was reduced from 0.302 to 0.233. The range of PSNR scores increased from [77.429–77.43] for the original cryo-EM images to [78.52–78.64] for the pre-processed ones. The range of the SNR scores increased from [3.36–3.44] for the original images to [4.04–4.052] for the pre-processed ones. The range of MSE scores decreased from [0.3026–0.3033] to [0.23–0.237] after the pre-processing steps. According to Student’s t test, the p-values of the changes of PSNR, SNR, and MSE scores caused by the pre-processing were (-15.70) -28.31, and -19.53, respectively, indicating that the pre-processing steps significantly improved the quality of cryo-EM images.</p>
    </sec>
    <sec id="sec3dot3-genes-10-00666">
      <title>3.3. Particle Clustering, Detection, and Picking Results</title>
      <p>In order to evaluate the performance of automated particle clustering and picking, we generated a true reference by manually picking the particles on the images. <xref ref-type="fig" rid="genes-10-00666-f013">Figure 13</xref> illustrates the entire workflow of the super-clustering approach for fully automated complex and irregular single particle picking in cryo-EM.</p>
      <p>The super-clustering approach was designed for fully automated single particle picking in cryo-EM. Our framework contained three stages. The first stage was micrograph pre-processing (shown on the yellow box of <xref ref-type="fig" rid="genes-10-00666-f013">Figure 13</xref>), the second stage was the clustering stage, which had two different approaches, i.e., the regular clustering approach (shown in the blue box of <xref ref-type="fig" rid="genes-10-00666-f013">Figure 13</xref>) and the super-clustering approach (shown in the orange box of <xref ref-type="fig" rid="genes-10-00666-f013">Figure 13</xref>), and the third stage was the single particle picking (shown in the green box of <xref ref-type="fig" rid="genes-10-00666-f013">Figure 13</xref>).</p>
      <p><xref ref-type="fig" rid="genes-10-00666-f014">Figure 14</xref> shows some examples of the fully automated complex single particle shape detection and picking using the super-clustering methods and the base cluster methods. The true particles that failed to be detected (false negatives) are denoted by red dots. Yellow dots represent the non-particle background (e.g., icy) objects that were falsely detected as particles (false positives).</p>
      <p>Compared with the results of the base clustering methods (k-means, FCM, and IBC), the performances of the super-clustering methods (SP-IBC, SP-K-means, and SP-FCM) were significantly improved. The number of false negatives and false positives was significantly reduced. <xref rid="genes-10-00666-t002" ref-type="table">Table 2</xref> reports the recall, precision, accuracy, F1 score, and running time of the base single particle picking methods (IBC, k-means, and FCM). <xref rid="genes-10-00666-t003" ref-type="table">Table 3</xref> shows the results of the super-clustering methods (SP-IBC, SP-k-means, and SP-FCM).</p>
      <p><xref rid="genes-10-00666-t003" ref-type="table">Table 3</xref> shows the results of the super-clustering methods (SP-IBC, SP-k-means, and SP-FCM). The three super-clustering methods were fully automated. The mean average of particle picking accuracy increased by 12.03%, 3.5%, and 2.1% for the IBC, k-means, and FCM, respectively. Also, the average time taken (pre-processing, running time of clustering, and particle picking) over the whole dataset decreased by 5.68 s for the SP-IBC, 86.24 s for the SP-k-means, and 59.58 s for the SP-FCM.</p>
      <p>Generally, the super-clustering methods achieved better performance than their corresponding base methods according to almost all the metrics. SP-k-means clustering achieved a higher accuracy (95.48%) than SP-FCM (94.08%) and SP-IBC (88.98%). SP-IBC ran substantially faster than the other methods and all three super-clustering methods were fully automated.</p>
    </sec>
    <sec id="sec3dot4-genes-10-00666">
      <title>3.4. Comparison with Other Particle Picking Methods</title>
      <p>We compared SuperCryoEMPicker with two other methods, Scipion [<xref rid="B34-genes-10-00666" ref-type="bibr">34</xref>] and EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>], in terms of computational efficiency, detection quality, and automation. Both Scipion [<xref rid="B34-genes-10-00666" ref-type="bibr">34</xref>] and EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>] needed a reference set of particles to be selected manually (<xref ref-type="fig" rid="genes-10-00666-f015">Figure 15</xref>a for Scipion; <xref ref-type="fig" rid="genes-10-00666-f015">Figure 15</xref>e for EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>]), which were used to train the methods to pick more particles (<xref ref-type="fig" rid="genes-10-00666-f015">Figure 15</xref>d using Scipion and <xref ref-type="fig" rid="genes-10-00666-f015">Figure 15</xref>e using EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>]). Use of the arbitrarily manually selected particles resulted in most of the true particles being selected (<xref ref-type="fig" rid="genes-10-00666-f015">Figure 15</xref>c using Scipion [<xref rid="B34-genes-10-00666" ref-type="bibr">34</xref>] and <xref ref-type="fig" rid="genes-10-00666-f015">Figure 15</xref>e,f using EMAN2). However, some false positives, likely corresponding to thick ice, were also incorrectly selected (<xref ref-type="fig" rid="genes-10-00666-f015">Figure 15</xref>d using Scipion [<xref rid="B34-genes-10-00666" ref-type="bibr">34</xref>] and <xref ref-type="fig" rid="genes-10-00666-f015">Figure 15</xref>e using EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>]). Increasing the number of the manually selected particles could reduce the number of false positives, but at the expense of increasing the number of false negatives (<xref ref-type="fig" rid="genes-10-00666-f015">Figure 15</xref>e for EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>]). In comparison, SuperCryoEMPicker successfully captured all true particles on the images without using any manually selected samples for training (<xref ref-type="fig" rid="genes-10-00666-f015">Figure 15</xref>g–i).</p>
      <p>Quantitative assessment of the comparison is shown in <xref ref-type="fig" rid="genes-10-00666-f016">Figure 16</xref> and <xref rid="genes-10-00666-t004" ref-type="table">Table 4</xref>. <xref ref-type="fig" rid="genes-10-00666-f016">Figure 16</xref>a,b shows a micrograph from the beta-galactosidase dataset [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] after particle picking using EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>], where only five particle references were selected (more references selected means more time taken to complete the task but more accurate results), and our super-clustering approach. <xref ref-type="fig" rid="genes-10-00666-f016">Figure 16</xref>a shows the particle picking performance results using EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>]. In terms of evaluating each particle picking tool, in addition to our fully automated particle picking approach, three criteria were selected to label and evaluate the particle picking performance results: True Positive (TP) picking, where the correct particles were marked by the yellow circles; False Negative (FN) picking, where the missed particles were marked by red circles; False Positive (FP) picking, where the incorrectly picked particles were marked by blue circles. <xref ref-type="fig" rid="genes-10-00666-f016">Figure 16</xref>b shows the same criteria of the particle picking results using the super-clustering approach.</p>
      <p><xref rid="genes-10-00666-t004" ref-type="table">Table 4</xref> illustrates the statistical evaluation of the performance results based on the TP, FN, and FP for each single particle picking algorithm, as well as the particle shape class and total number of particles (ground truth) in each image. Note that the super-clustering approach for fully automated single particle picking performed better in regard to detecting the shapes; it achieved 99.13% sensitivity, 98.45% precision, and 97.61% accuracy.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec4-genes-10-00666">
    <title>4. Conclusions</title>
    <p>In this work, we designed SuperCryoEMPicker, a fully automated super-particle clustering method to pick particles of complex and irregular shapes in cryo-EM images. SuperCryoEMPicker, which was based on the super-clustering methods, was more accurate and ran faster than particle picking based on the base clustering methods. It also performed well compared to established semi-automated particle picking methods, which require users to manually pick reference particles for training. Therefore, SuperCyroEMPicker may be a useful and reliable tool for automated single particle picking in cryo-EM images.</p>
  </sec>
</body>
<back>
  <notes>
    <title>Author Contributions</title>
    <p>J.C. conceived of the project. A.-A.A. and J.C. designed the experiment; A.-A.A. implemented the method and gathered the results; A.-A.A., J.C., and A.O. analyzed the data; A.-A.A., J.J.T., and J.C. wrote the manuscript. All authors edited and approved the manuscript.</p>
  </notes>
  <notes>
    <title>Funding</title>
    <p>Research reported in this publication was supported in part by the National Institutes of Health (NIH) grant R01GM093123 (to J.C.), an administrative supplement to NIH grant R01GM065546 (to J.J.T., Collaborative Supplements for Cryo-Electron Microscopy Technology Transfer), and the National Science Foundation grants DBI 1759934 and IIS 1763246 (to J.C.).</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The authors declare they have no conflict of interest.</p>
  </notes>
  <notes>
    <title>Dataset</title>
    <p>The datasets used in this study and the source code of SuperCryoEMPicker are available at <uri xlink:href="https://github.com/jianlin-cheng/SuperCryoEMPicker">https://github.com/jianlin-cheng/SuperCryoEMPicker</uri>.</p>
  </notes>
  <ref-list>
    <title>References</title>
    <ref id="B1-genes-10-00666">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nogales</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Scheres</surname>
            <given-names>S.H.</given-names>
          </name>
        </person-group>
        <article-title>Cryo-EM: A Unique Tool for the Visualization of Macromolecular Complexity</article-title>
        <source>Mol. Cell</source>
        <year>2015</year>
        <volume>58</volume>
        <fpage>677</fpage>
        <lpage>689</lpage>
        <pub-id pub-id-type="pmid">26000851</pub-id>
      </element-citation>
    </ref>
    <ref id="B2-genes-10-00666">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Callaway</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>The revolution will not be crystallized: A new method sweeps through structural biology</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>525</volume>
        <fpage>172</fpage>
        <lpage>174</lpage>
        <pub-id pub-id-type="pmid">26354465</pub-id>
      </element-citation>
    </ref>
    <ref id="B3-genes-10-00666">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merk</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bartesaghi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Banerjee</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Falconieri</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>M.I.</given-names>
          </name>
          <name>
            <surname>Pragani</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Boxer</surname>
            <given-names>M.B.</given-names>
          </name>
          <name>
            <surname>Earl</surname>
            <given-names>L.A.</given-names>
          </name>
          <name>
            <surname>Milne</surname>
            <given-names>J.L.S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Breaking Cryo-EM Resolution Barriers to Facilitate Drug Discovery</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <fpage>1698</fpage>
        <lpage>1707</lpage>
        <pub-id pub-id-type="pmid">27238019</pub-id>
      </element-citation>
    </ref>
    <ref id="B4-genes-10-00666">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Pentelute</surname>
            <given-names>B.L.</given-names>
          </name>
          <name>
            <surname>Collier</surname>
            <given-names>R.J.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z.H.</given-names>
          </name>
        </person-group>
        <article-title>Atomic structure of anthrax protective antigen pore elucidates toxin translocation</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>521</volume>
        <fpage>545</fpage>
        <lpage>549</lpage>
      </element-citation>
    </ref>
    <ref id="B5-genes-10-00666">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bartesaghi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Merk</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Banerjee</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Matthies</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Milne</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Subramaniam</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>2.2 A resolution cryo-EM structure of beta-galactosidase in complex with a cell-permeant inhibitor</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>1147</fpage>
        <lpage>1151</lpage>
        <pub-id pub-id-type="pmid">25953817</pub-id>
      </element-citation>
    </ref>
    <ref id="B6-genes-10-00666">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>M.G.</given-names>
          </name>
          <name>
            <surname>Veesler</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>C.S.</given-names>
          </name>
          <name>
            <surname>Carragher</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>2.8 A resolution reconstruction of the Thermoplasma acidophilum 20S proteasome using cryo-electron microscopy</article-title>
        <source>Elife</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>e06380</fpage>
      </element-citation>
    </ref>
    <ref id="B7-genes-10-00666">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herzik</surname>
            <given-names>M.A.</given-names>
            <suffix>Jr.</suffix>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>G.C.</given-names>
          </name>
        </person-group>
        <article-title>Achieving better-than-3-A resolution by single-particle cryo-EM at 200 keV</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>1075</fpage>
        <lpage>1078</lpage>
        <pub-id pub-id-type="pmid">28991891</pub-id>
      </element-citation>
    </ref>
    <ref id="B8-genes-10-00666">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khoshouei</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Radjainia</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Baumeister</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Danev</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Cryo-EM structure of haemoglobin at 3.2 A determined with the Volta phase plate</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>16099</fpage>
        <pub-id pub-id-type="pmid">28665412</pub-id>
      </element-citation>
    </ref>
    <ref id="B9-genes-10-00666">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Klose</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Irimia-Dominguez</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Vago</surname>
            <given-names>F.S.</given-names>
          </name>
          <name>
            <surname>Vidal</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>Sub-3A apoferritin structure determined with full range of phase shifts using a single position of volta phase plate</article-title>
        <source>J. Struct. Biol.</source>
        <year>2019</year>
        <volume>206</volume>
        <fpage>225</fpage>
        <lpage>232</lpage>
        <pub-id pub-id-type="pmid">30928614</pub-id>
      </element-citation>
    </ref>
    <ref id="B10-genes-10-00666">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doerr</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Single-particle cryo-electron microscopy</article-title>
        <source>Nat. Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>23</fpage>
        <pub-id pub-id-type="pmid">27110631</pub-id>
      </element-citation>
    </ref>
    <ref id="B11-genes-10-00666">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J.Z.</given-names>
          </name>
          <name>
            <surname>Grigorieff</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>A single-particle selection system for molecular electron microscopy</article-title>
        <source>J. Struct. Biol.</source>
        <year>2007</year>
        <volume>157</volume>
        <fpage>168</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="pmid">16870473</pub-id>
      </element-citation>
    </ref>
    <ref id="B12-genes-10-00666">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hall</surname>
            <given-names>R.J.</given-names>
          </name>
          <name>
            <surname>Patwardhan</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>A twostep approach for semi-automated particle selection from low contrast cryo-electron micrographs</article-title>
        <source>J. Struct. Biol.</source>
        <year>2004</year>
        <volume>145</volume>
        <fpage>19</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="pmid">15065670</pub-id>
      </element-citation>
    </ref>
    <ref id="B13-genes-10-00666">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Penczek</surname>
            <given-names>P.A.</given-names>
          </name>
        </person-group>
        <article-title>Application of template matching technique to particle detection in electron micrographs</article-title>
        <source>J. Struct. Biol.</source>
        <year>2004</year>
        <volume>145</volume>
        <fpage>29</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="pmid">15065671</pub-id>
      </element-citation>
    </ref>
    <ref id="B14-genes-10-00666">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langlois</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Pallesen</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Frank</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Reference-free particle selection enhanced with semi-supervised machine learning for cryo-electron microscopy</article-title>
        <source>J. Struct. Biol.</source>
        <year>2011</year>
        <volume>175</volume>
        <fpage>353</fpage>
        <lpage>361</lpage>
        <pub-id pub-id-type="pmid">21708269</pub-id>
      </element-citation>
    </ref>
    <ref id="B15-genes-10-00666">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sorzano</surname>
            <given-names>C.O.S.</given-names>
          </name>
          <name>
            <surname>Recarte</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Alcorlo</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bilbao-Castro</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>San-Martín</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Marabini</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Carazo</surname>
            <given-names>J.M.</given-names>
          </name>
        </person-group>
        <article-title>Automatic particle selection from electron micrographs using machine learning techniques</article-title>
        <source>J. Struct. Biol.</source>
        <year>2009</year>
        <volume>167</volume>
        <fpage>252</fpage>
        <lpage>260</lpage>
        <pub-id pub-id-type="pmid">19555764</pub-id>
      </element-citation>
    </ref>
    <ref id="B16-genes-10-00666">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arbeláez</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>B.G.</given-names>
          </name>
          <name>
            <surname>Typke</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Glaeser</surname>
            <given-names>R.M.</given-names>
          </name>
          <name>
            <surname>Malik</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Experimental evaluation of support vector machine-based and correlation-based approaches to automatic particle selection</article-title>
        <source>J. Struct. Biol.</source>
        <year>2011</year>
        <volume>175</volume>
        <fpage>319</fpage>
        <lpage>328</lpage>
        <pub-id pub-id-type="pmid">21640190</pub-id>
      </element-citation>
    </ref>
    <ref id="B17-genes-10-00666">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>DeepPicker: A Deep Learning Approach for Fully Automated Particle Picking in Cryo-EM</article-title>
        <source>J. Struct. Biol.</source>
        <year>2016</year>
        <volume>195</volume>
        <fpage>325</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="pmid">27424268</pub-id>
      </element-citation>
    </ref>
    <ref id="B18-genes-10-00666">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Ouyang</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Mao</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>A deep convolutional neural network approach to single-particle recognition in cryo-electron microscopy</article-title>
        <source>BMC Bioinform.</source>
        <year>2017</year>
        <volume>18</volume>
        <elocation-id>348</elocation-id>
      </element-citation>
    </ref>
    <ref id="B19-genes-10-00666">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adiga</surname>
            <given-names>P.U.</given-names>
          </name>
          <name>
            <surname>Malladi</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Baxter</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Glaeser</surname>
            <given-names>R.M.</given-names>
          </name>
        </person-group>
        <article-title>A binary segmentation approach for boxing ribosome particles in cryo EM micrographs</article-title>
        <source>J. Struct. Biol.</source>
        <year>2004</year>
        <volume>145</volume>
        <fpage>142</fpage>
        <lpage>151</lpage>
        <pub-id pub-id-type="pmid">15065681</pub-id>
      </element-citation>
    </ref>
    <ref id="B20-genes-10-00666">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicholson</surname>
            <given-names>W.V.</given-names>
          </name>
          <name>
            <surname>Glaeser</surname>
            <given-names>R.M.</given-names>
          </name>
        </person-group>
        <article-title>Review: Automatic particle detection in electron</article-title>
        <source>J. Struct. Biol.</source>
        <year>2001</year>
        <fpage>90</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="pmid">11472081</pub-id>
      </element-citation>
    </ref>
    <ref id="B21-genes-10-00666">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Brubaker</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Rubinstein</surname>
            <given-names>J.L.</given-names>
          </name>
        </person-group>
        <article-title>TMaCS: A hybrid template matching and classification system for partially-automated particle selection</article-title>
        <source>J. Struct. Biol.</source>
        <year>2013</year>
        <fpage>234</fpage>
        <lpage>242</lpage>
      </element-citation>
    </ref>
    <ref id="B22-genes-10-00666">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Voss</surname>
            <given-names>N.R.</given-names>
          </name>
          <name>
            <surname>Yoshioka</surname>
            <given-names>C.K.</given-names>
          </name>
          <name>
            <surname>Radermacher</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>C.S.</given-names>
          </name>
          <name>
            <surname>Carragher</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>DoG Picker and TiltPicker: Software tools to facilitate particle selection in single particle electron microscopy</article-title>
        <source>J. Struct. Biol.</source>
        <year>2009</year>
        <volume>166</volume>
        <fpage>205</fpage>
        <lpage>213</lpage>
        <pub-id pub-id-type="pmid">19374019</pub-id>
      </element-citation>
    </ref>
    <ref id="B23-genes-10-00666">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Radhakrishna</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Appu</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kevin</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Pascal</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Sabine</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>SLIC Superpixels Compared to State-of-the-Art Superpixel Methods</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <year>2012</year>
        <volume>34</volume>
        <fpage>2274</fpage>
        <lpage>2282</lpage>
        <pub-id pub-id-type="pmid">22641706</pub-id>
      </element-citation>
    </ref>
    <ref id="B24-genes-10-00666">
      <label>24.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>MacQueen</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Some methods for classification and analysis of multivariate observations</article-title>
        <source>Proceedings of the 5th Berkeley Symposium on Mathematical Statistics and Probability</source>
        <publisher-name>University of California Press</publisher-name>
        <publisher-loc>Berkeley, CA, USA</publisher-loc>
        <year>1967</year>
        <comment>Volume 1: Statistics</comment>
        <fpage>281</fpage>
        <lpage>297</lpage>
      </element-citation>
    </ref>
    <ref id="B25-genes-10-00666">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunn</surname>
            <given-names>J.C.</given-names>
          </name>
        </person-group>
        <article-title>A fuzzy relative of the ISODATA process and its use in detecting compact well-separated clusters</article-title>
        <source>J. Cybern.</source>
        <year>1973</year>
        <volume>3</volume>
        <fpage>32</fpage>
        <lpage>57</lpage>
      </element-citation>
    </ref>
    <ref id="B26-genes-10-00666">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al-Azzawi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ouadou</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tanner</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>AutoCryoPicker: an unsupervised learning approach for fully automated single particle picking in Cryo-EM images</article-title>
        <source>BMC Bioinform.</source>
        <year>2019</year>
        <fpage>1</fpage>
        <lpage>26</lpage>
      </element-citation>
    </ref>
    <ref id="B27-genes-10-00666">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>R.F.</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Siebert</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Muench</surname>
            <given-names>S.P.</given-names>
          </name>
          <name>
            <surname>Ranson</surname>
            <given-names>N.A.</given-names>
          </name>
        </person-group>
        <article-title>An introduction to sample preparation and imaging by cryo-electron microscopy for structural biology</article-title>
        <source>Methods</source>
        <year>2016</year>
        <fpage>3</fpage>
        <lpage>15</lpage>
      </element-citation>
    </ref>
    <ref id="B28-genes-10-00666">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Bai</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Hanssen</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Condron</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Baum</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Scheres</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Cryo-EM structure of the Plasmodium falciparum 80S ribosome bound to the anti-protozoan drug emetine</article-title>
        <source>Elife</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>e03080</fpage>
        <pub-id pub-id-type="doi">10.7554/elife.03080</pub-id>
      </element-citation>
    </ref>
    <ref id="B29-genes-10-00666">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Baldwin</surname>
            <given-names>P.R.</given-names>
          </name>
          <name>
            <surname>Mann</surname>
            <given-names>D.S.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Rees</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Ludtke</surname>
            <given-names>S.J.</given-names>
          </name>
        </person-group>
        <article-title>EMAN2: An extensible image processing suite for electron microscopy</article-title>
        <source>J. Struct. Biol.</source>
        <year>2007</year>
        <volume>157</volume>
        <fpage>38</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="pmid">16859925</pub-id>
      </element-citation>
    </ref>
    <ref id="B30-genes-10-00666">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheres</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Beta-galactosidase Falcon-II micrographs plus manually selected coordinates by Richard Henderson</article-title>
        <source>J. Struct. Biol.</source>
        <year>2015</year>
        <volume>189</volume>
        <fpage>114</fpage>
        <lpage>122</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jsb.2014.11.010</pub-id>
        <pub-id pub-id-type="pmid">25486611</pub-id>
      </element-citation>
    </ref>
    <ref id="B31-genes-10-00666">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pettersen</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Couch</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Greenblatt</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Meng</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Ferrin</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>J Comput</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>UCSF Chimera-a visualization system for exploratory research and analysis</article-title>
        <source>J. Comput. Chem.</source>
        <year>2004</year>
        <volume>25</volume>
        <fpage>1605</fpage>
        <lpage>1612</lpage>
        <pub-id pub-id-type="pmid">15264254</pub-id>
      </element-citation>
    </ref>
    <ref id="B32-genes-10-00666">
      <label>32.</label>
      <element-citation publication-type="web">
        <article-title>The Electron Microscopy Data Bank (EMDB) at PDBe</article-title>
        <comment>Available online: <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/pdbe/emdb/">http://www.ebi.ac.uk/pdbe/emdb/</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2018-11-02">(accessed on 2 November 2018)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B33-genes-10-00666">
      <label>33.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gonzalez</surname>
            <given-names>R.C.</given-names>
          </name>
          <name>
            <surname>Woods</surname>
            <given-names>R.E.</given-names>
          </name>
        </person-group>
        <source>Digital Image Processing</source>
        <edition>4th ed.</edition>
        <publisher-name>Pearson</publisher-name>
        <publisher-loc>New York, NY, USA</publisher-loc>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="B34-genes-10-00666">
      <label>34.</label>
      <element-citation publication-type="web">
        <article-title>Scipion, Cryo-EM image processing framework. Integration, traceability and analysis</article-title>
        <comment>Available online: <ext-link ext-link-type="uri" xlink:href="http://scipion.i2pc.es">http://scipion.i2pc.es</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2019-01-04">(accessed on 4 January 2019)</date-in-citation>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="genes-10-00666-f001" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Examples of particles of complex and irregular shapes. (<bold>a</bold>) 80S ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] cryo-electron microscopy (cryo-EM) electron density map; (<bold>b</bold>) cryo-EM image of 80S ribosome particles (Electron Microscopy Public Image Archive (EMPIAR) entry 10028, [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>]); (<bold>c</bold>) beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] cryo-EM electron density map; (<bold>d</bold>) cryo-EM image of beta-galactosidase particles (EMPIAR-10017, [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>]). Both (<bold>a</bold>) and (<bold>c</bold>) were created using Chimera [<xref rid="B31-genes-10-00666" ref-type="bibr">31</xref>] and density maps from Protein Data Bank in Europe EMBL-EBI (The European Bioinformatics Institute) [<xref rid="B32-genes-10-00666" ref-type="bibr">32</xref>].</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g001"/>
  </fig>
  <fig id="genes-10-00666-f002" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>The general framework of the SuperCryoEMPicker. The dashed boxes represent three stages of the approach, i.e., pre-processing, super-clustering, and particle picking. Solid boxes denote analysis steps.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g002"/>
  </fig>
  <fig id="genes-10-00666-f003" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>One zoomed-in particle image from the ribosome dataset [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] during the first stage of the pre-processing “intensity adjustment” using different scaling factors in the EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>]. (<bold>a</bold>) Original zoomed-in particle (manually selected and cropped from the original image) and the original histogram of the image; (<bold>b</bold>) particle image after intensity adjustment using scale factor 5 and the histogram of the pre-processed image; (<bold>c</bold>) particle image after intensity adjustment with scale factor 4 and the histogram of the pre-processed image; (<bold>d</bold>) particle image after the intensity adjustment with scale factor 3 and the histogram of the pre-processed image; (<bold>e</bold>) particle after intensity adjustment with scale factor 1 and the histogram of the pre-processed image; (<bold>f</bold>) particle image after intensity adjustment with scale factor 0.1 and the histogram of the pre-processed image; (<bold>g</bold>) particle image after intensity adjustment with scale factor 0.25 and the histogram of the pre-processed; (<bold>h</bold>) particle image after intensity adjustment with scale factor 0.5 and the histogram of the pre-processed image.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g003"/>
  </fig>
  <fig id="genes-10-00666-f004" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Illustration of the effects of the pre-processing procedures on ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] and beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] images. (<bold>a</bold>) Original particle image of ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] (one full image and one zoomed-in particle); (<bold>b</bold>) original image of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>]; (<bold>c</bold>) image of ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] after image resolution improvement; (<bold>d</bold>) image of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] after image resolution improvement; (<bold>e</bold>) image of ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] after global intensity adjustment; (<bold>f</bold>) image of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] after global intensity adjustment; (<bold>g</bold>) image of ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] after global contrast enhancement-based histogram equalization; (<bold>h</bold>) image of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] after global contrast enhancement-based histogram equalization; (<bold>i</bold>) image of ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] after noise-suppression using the Wiener filter; (<bold>j</bold>) image of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] after noise-suppression using the Wiener filter; (<bold>k</bold>) image of ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] after local particle contrast enhancement with adaptive histogram equalization; (<bold>l</bold>) image of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] after local particle contrast enhancement using adaptive histogram equalization; (<bold>m</bold>) image of ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] after edge enhancement using guided image filtering; (<bold>n</bold>) image of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] after edge enhancement using guided image filtering; (<bold>o</bold>) image of ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] after particle shape localization using morphological image operation; (<bold>p</bold>) image of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] after particle shape localization using morphological image operation.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g004a"/>
    <graphic xlink:href="genes-10-00666-g004b"/>
  </fig>
  <fig id="genes-10-00666-f005" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Image clustering results using k-means, FCM, and IBC. (<bold>a</bold>) Original cryo-EM image of the 80S ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>]; (<bold>b</bold>) original cryo-EM image of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>]; (<bold>c</bold>) k-means clustering results (Cluster 1, Cluster 2, Cluster 3, and Cluster 4) for the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] image; most real particles were assigned to Cluster 3; (<bold>d</bold>) k-means clustering results (Cluster 1, Cluster 2, Cluster 3, and Cluster 4) for the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] image; most real particles were assigned to Cluster 2; (<bold>e</bold>) FCM ((Fuzzy C-means) clustering results (Cluster 1, Cluster 2, Cluster 3, and Cluster 4) for the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] image; most real particles were assigned to Cluster 2; (<bold>f</bold>) FCM clustering results (Cluster 1, Cluster 2, Cluster 3, and Cluster 4) for the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] image; most real particles were assigned to Cluster 1; (<bold>g</bold>) IBC (Intensity-Based Clustering) results (Cluster 1, Cluster 2, Cluster 3, and Cluster 4) for the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] image. Most real particles were assigned to Cluster 1; (<bold>h</bold>) IBC clustering results (Cluster 1, Cluster 2, Cluster 3, and Cluster 4) for the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] image. Most real particles were assigned to Cluster 1.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g005a"/>
    <graphic xlink:href="genes-10-00666-g005b"/>
  </fig>
  <fig id="genes-10-00666-f006" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <p>Different cryo-EM intermediate micrographs generated using simple linear iterative clustering (SLIC). (<bold>a</bold>) Original cryo-EM image of ribosome; (<bold>b</bold>) histogram of (<bold>a</bold>); (<bold>c</bold>) intermediate micrograph generated using simple linear iterative clustering (SLIC) based on the pre-processed image; (<bold>d</bold>) histogram of (<bold>c</bold>); (<bold>e</bold>) intermediate micrograph generated by SLIC from the original image; (<bold>f</bold>) histogram of (<bold>e</bold>); (<bold>g</bold>) original cryo-EM image of beta-galactosidase; (<bold>h</bold>) histogram of (<bold>g</bold>); (<bold>i</bold>) intermediate micrograph generated by SLIC from the pre-processed image; (<bold>j</bold>) histogram of (<bold>i</bold>); (<bold>k</bold>) intermediate micrograph generated by SLIC from the original image; (<bold>l</bold>) histogram of (<bold>k</bold>).</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g006"/>
  </fig>
  <fig id="genes-10-00666-f007" orientation="portrait" position="float">
    <label>Figure 7</label>
    <caption>
      <p>SP-k-means evaluation and automated cluster section based on extracting the total number of the particles in each cluster and selecting the cluster that has the minimum total number of particles. (<bold>a</bold>) Binary clustered image; (<bold>b</bold>) Particle labels in the clustered image; (<bold>c</bold>) Label of each individual particle number in the clustering evaluation stage for the fully automated cluster image selection; (<bold>d</bold>) Total number of objects (particles) in the Cluster index 1; (<bold>e</bold>) total number of objects (particles) in Cluster index 2; (<bold>f</bold>) total number of objects (particles) in Cluster index 3; (<bold>g</bold>) total number of objects (particles) in Cluster index 4. The super-pixel k-means clustering (SP-k-means) is shown in Algorithm 1.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g007"/>
  </fig>
  <fig id="genes-10-00666-f008" orientation="portrait" position="float">
    <label>Figure 8</label>
    <caption>
      <p>Cryo-EM super-clustering results of SP-k-means, SP-FCM, and SP-IBC in comparison with the base algorithms. (<bold>a</bold>) An original cryo-EM image of the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>]; (<bold>b</bold>) intermediate micrograph generated by SLIC from pre-processed image of the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>]; (<bold>c</bold>) original cryo-EM image of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>]; (<bold>d</bold>) intermediate micrograph generated by SLIC for beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>]; (<bold>e</bold>) k-means clustering results of the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>]; (<bold>f</bold>) SP-k-means clustering results of the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>]; (<bold>g</bold>) k-means clustering results of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] cryo-EM image; (<bold>h</bold>) SP-K-means clustering results of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] cryo-EM image; (<bold>i</bold>) FCM clustering results of the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] cryo-EM image; (<bold>j</bold>) SP-FCM clustering results of the ribosome cryo-EM image; (<bold>k</bold>) FCM clustering results of the beta-galactosidase cryo-EM image; (<bold>l</bold>) SP-FCM clustering results of the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] cryo-EM image; (<bold>m</bold>) IBC clustering results of the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] cryo-EM image; (<bold>n</bold>) SP-IBC clustering results of the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] cryo-EM image; (<bold>o</bold>) IBC clustering results of the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] cryo-EM image; (<bold>p</bold>) SP-IBC clustering results of the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] cryo-EM image.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g008"/>
  </fig>
  <fig id="genes-10-00666-f009" orientation="portrait" position="float">
    <label>Figure 9</label>
    <caption>
      <p>A zoomed-in selected particle image before and after binary image cleaning and non-connected object removal on the image masks generated by the three base clustering methods. (<bold>a</bold>) Original zoomed-in particle image; (<bold>b</bold>) particle clustering image before binary image cleaning by k-means for the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>]; (<bold>c</bold>) particle clustering image after binary image cleaning by k-means for the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>]; (<bold>d</bold>) original zoomed-in particle image; (<bold>e</bold>) particle clustering image before binary image cleaning by FCM clustering for the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>]; (<bold>f</bold>) particle clustering image after binary image cleaning by FCM clustering for the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>]; (<bold>g</bold>) original zoomed-in particle image; (<bold>h</bold>) particle clustering image before binary image cleaning by IBC clustering for the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>]; (<bold>i</bold>) particle clustering image after binary image cleaning by IBC clustering for the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>].</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g009"/>
  </fig>
  <fig id="genes-10-00666-f010" orientation="portrait" position="float">
    <label>Figure 10</label>
    <caption>
      <p>Whole cryo-EM particle clustering results before and after binary image cleaning for the three base clustering methods. (<bold>a</bold>) Ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] clustered image of k-means; (<bold>b</bold>) image mask of (<bold>a</bold>) after image cleaning; (<bold>c</bold>) beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] clustered image of k-means; (<bold>d</bold>) binary image mask of (<bold>c</bold>) after image cleaning; (<bold>e</bold>) ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] clustered image of FCM; (<bold>f</bold>) binary image mask of (<bold>e</bold>) after image cleaning; (<bold>g</bold>) beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] clustered image of FCM; (<bold>h</bold>) binary mask of (<bold>g</bold>) after image cleaning; (<bold>i</bold>) ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] clustered image of IBC; (<bold>j</bold>) binary image mask of (<bold>i</bold>) after image cleaning; (<bold>k</bold>) beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] clustered image of IBC; (<bold>l</bold>) binary image mask of (<bold>k</bold>) after image cleaning.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g010"/>
  </fig>
  <fig id="genes-10-00666-f011" orientation="portrait" position="float">
    <label>Figure 11</label>
    <caption>
      <p>Results of detecting particles of irregular and complex shapes on ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] and beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] images. (<bold>a</bold>) Particle detection and picking by k-means on the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] image; (<bold>b</bold>) particle detection and picking by FCM on the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] image; (<bold>c</bold>) particle detection and picking by IBC on the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] image; (<bold>d</bold>) particle detection and picking by k-means on the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] image; (<bold>e</bold>) particle detection and picking by FCM on the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] image; (<bold>f</bold>) particle detection and picking by IBC on the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] image; (<bold>g</bold>) particle detection and picking by SP-k-means on the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] image; (<bold>h</bold>) particle detection and picking by SP-FCM on the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] image; (<bold>i</bold>) particle detection and picking by SP-IBC on the ribosome [<xref rid="B28-genes-10-00666" ref-type="bibr">28</xref>] image; (<bold>j</bold>) particle detection and picking by SP-K-means on the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] image; (<bold>k</bold>) particle detection and picking by SP-FCM on the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] image; (<bold>l</bold>) particle detection and picking by SP-IBC on the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] image.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g011a"/>
    <graphic xlink:href="genes-10-00666-g011b"/>
  </fig>
  <fig id="genes-10-00666-f012" orientation="portrait" position="float">
    <label>Figure 12</label>
    <caption>
      <p>Quality of cryo-EM images before and after the pre-processing stage. (<bold>a</bold>) Average PSNR and SNR values of the cryo-EM images before and after the pre-processing steps; (<bold>b</bold>) average MSE values of the cryo-EM images before and after the pre-processing steps.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g012"/>
  </fig>
  <fig id="genes-10-00666-f013" orientation="portrait" position="float">
    <label>Figure 13</label>
    <caption>
      <p>Entire workflow of the super-clustering approach for fully automated complex and irregular single particle picking in cryo-EM.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g013"/>
  </fig>
  <fig id="genes-10-00666-f014" orientation="portrait" position="float">
    <label>Figure 14</label>
    <caption>
      <p>Results of the fully automated single particle picking in cryo-EM images by the base and super-clustering methods. Red dots denote the missing particles not detected (false negatives) and yellow dots show false positives. (<bold>a</bold>) Particle picking of IBC; (<bold>b</bold>) particle picking of IBC on an extremely low SNR cryo-EM image; (<bold>c</bold>) particle picking of SP-IBC; (<bold>d</bold>) single particle picking of SP-IBC on an extremely low SNR cryo-EM image; (<bold>e</bold>) particle picking of k-means; (<bold>f</bold>) particle picking of k-means clustering algorithm on an extremely low-SNR cryo-EM image; (<bold>g</bold>) particle picking of SP-k-means; (<bold>h</bold>) particle picking of SP-k-means on an extremely low-SNR cryo-EM image; (<bold>i</bold>) particle picking of FCM; (<bold>j</bold>) particle picking of FCM on an extremely low-SNR cryo-EM image; (<bold>k</bold>) particle picking of SP-FCM; (<bold>l</bold>) particle picking of SP-FCM on an extremely low-SNR cryo-EM image.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g014"/>
  </fig>
  <fig id="genes-10-00666-f015" orientation="portrait" position="float">
    <label>Figure 15</label>
    <caption>
      <p>Particle picking using EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>], Scipion [<xref rid="B34-genes-10-00666" ref-type="bibr">34</xref>], and SuperCryoEMPicker. (<bold>a</bold>) Manually selected reference particle of the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] image for Scipion [<xref rid="B34-genes-10-00666" ref-type="bibr">34</xref>]; (<bold>b</bold>) zoom-in view of some manually selected reference particles for the beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] image for Scipion [<xref rid="B34-genes-10-00666" ref-type="bibr">34</xref>]; (<bold>c</bold>) final reference particles of beta-galactosidase manually selected for Scipion [<xref rid="B34-genes-10-00666" ref-type="bibr">34</xref>]; (<bold>d</bold>) all particle picking results of Scipion [<xref rid="B34-genes-10-00666" ref-type="bibr">34</xref>] trained on 40 manual reference particles on the image of the beta-galactosidase; (<bold>e</bold>) EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>] autopicking results based on different manually selected training samples in the first tested image of the beta-galactosidase dataset [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>]; (<bold>f</bold>) manually selected reference particles of beta-galactosidase [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] for EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>]; (<bold>g</bold>) particle picking results of SuperCryoEMPicker based on SP-IBC clustering; (<bold>h</bold>) particle picking results of SuperCryoEMPicker based on SP-k-means clustering; (<bold>i</bold>) particle picking results of SuperCryoEMPicker based on SP-FCM clustering.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g015a"/>
    <graphic xlink:href="genes-10-00666-g015b"/>
  </fig>
  <fig id="genes-10-00666-f016" orientation="portrait" position="float">
    <label>Figure 16</label>
    <caption>
      <p>Evaluation of particle picking using EMAN2 and the super-clustering approach for fully automated single particle picking. (<bold>a</bold>) Particle picking results of the beta-galactosidase image [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] using EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>]; (<bold>b</bold>) particle picking results of the beta-galactosidase image [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>] using the super-clustering approach for fully automated single particle picking. Particles are labeled as follows: Yellow—True Positive (TP); red—False Negative (FN); blue—False.</p>
    </caption>
    <graphic xlink:href="genes-10-00666-g016"/>
  </fig>
  <table-wrap id="genes-10-00666-t001" orientation="portrait" position="float">
    <object-id pub-id-type="pii">genes-10-00666-t001_Table 1</object-id>
    <label>Table 1</label>
    <caption>
      <p>The average peak signal-to-noise ratio (PSNR), signal-to-noise ratio (SNR), and mean squared error (MSE) of the cryo-EM images with or without EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>] intensity adjustment, according to different scaling factors.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Intensity Adjustment Scaling Factor</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">PSNR</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">SNR</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Original Image (without Adjustment)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">28.06118</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">6.99260 dB</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Scaling Factor = 10</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">27.55033</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">20.00023 dB</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Scaling Factor = 5</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">28.06118</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">13.98521 dB</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Scaling Factor = 4</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">28.34026</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">12.05305 dB</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Scaling Factor = 3</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">28.84182</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">9.59165 dB</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Scaling Factor = 2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">29.91141</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">6.43044 dB</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Scaling Factor = 1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">32.61282</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2.87674 dB</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Scaling Factor = 0.1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">44.37584</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.16536 dB</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Scaling Factor = 0.5</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">35.81839</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1.26105 dB</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Scaling Factor = 0.25</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">39.23404</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.55222 dB</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Scaling Factor = Sane</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">29.26647</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">8.09887 dB</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="genes-10-00666-t002" orientation="portrait" position="float">
    <object-id pub-id-type="pii">genes-10-00666-t002_Table 2</object-id>
    <label>Table 2</label>
    <caption>
      <p>Results of particle picking using the base clustering algorithms (k-means, FCM, and IBC).</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Measures</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">IBC</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">k-Means</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">FCM</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Sensitivity/Recall (%)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">82.42</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">97.14</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">97.14</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Precision (%)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">87.07</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">94.50</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">94.50</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Accuracy (%)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">76.95</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">91.98</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">91.98</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">F1 Score (%)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">84.68</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">95.80</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">95.80</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Time consuming (s)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">16.77</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">113.55</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">412.86</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Automation</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Fully Automated</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Manual</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Manual</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="genes-10-00666-t003" orientation="portrait" position="float">
    <object-id pub-id-type="pii">genes-10-00666-t003_Table 3</object-id>
    <label>Table 3</label>
    <caption>
      <p>Results of the super-clustering methods (SP-k-means, SP-FCM, and SP-IBC).</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Measures</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">IBC</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">k-Means</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">FCM</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Sensitivity/Recall (%)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">92.44</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">97.50</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">95.71</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Precision (%)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">96.62</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">97.86</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">98.19</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Accuracy (%)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">88.98</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">95.48</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">94.08</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">F1 Score (%)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">94.48</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">97.68</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">96.93</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Time Taken (s)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">11.09</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">27.31</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">353.28</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Automation</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Fully Automated</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Fully Automated</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Fully Automated</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="genes-10-00666-t004" orientation="portrait" position="float">
    <object-id pub-id-type="pii">genes-10-00666-t004_Table 4</object-id>
    <label>Table 4</label>
    <caption>
      <p>Statistical evaluation super-clustering approach for fully automated single particle picking and EMAN2 [<xref rid="B29-genes-10-00666" ref-type="bibr">29</xref>] performances using a beta-galactosidase image [<xref rid="B30-genes-10-00666" ref-type="bibr">30</xref>]. The table reports True Positive (TP) picking results where the correct particles are picked, False Negative (FN) picking results where some good particles are missed, and False Positive (FP) picking results where the incorrect particles (other objects such as background or artificial objects) are picked as particles.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Evaluation Metric</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Our Approach</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">EMAN2</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Total Particles Number</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">579</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">579</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">True Positive (TP)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">574</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">101</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">False Negative (FN)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">5</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">478</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">False Positive (FP)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">9</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Sensitivity/Recall (%)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.99136442</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.174439</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Precision (%)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.98456261</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Accuracy (%)</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.97619048</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">0.174439</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">F1 Score (%)</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.98795181</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.297059</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
