<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9371920</article-id>
    <article-id pub-id-type="pmid">35536255</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkac333</article-id>
    <article-id pub-id-type="publisher-id">gkac333</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>Narese/7</subject>
        <subject>Narese/9</subject>
        <subject>Narese/24</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Reconstructing physical cell interaction networks from single-cell data using Neighbor-seq</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ghaddar</surname>
          <given-names>Bassel</given-names>
        </name>
        <aff><institution>Rutgers Cancer Institute of New Jersey, Rutgers the State University of New Jersey</institution>, New Brunswick, NJ 08901, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2313-8593</contrib-id>
        <name>
          <surname>De</surname>
          <given-names>Subhajyoti</given-names>
        </name>
        <!--subhajyoti.de@rutgers.edu-->
        <xref rid="COR1" ref-type="corresp"/>
        <aff><institution>Rutgers Cancer Institute of New Jersey, Rutgers the State University of New Jersey</institution>, New Brunswick, NJ 08901, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +1 732 235 8558; Fax: +1 732 235 5331; Email: <email>subhajyoti.de@rutgers.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>12</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-05-10">
      <day>10</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <volume>50</volume>
    <issue>14</issue>
    <fpage>e82</fpage>
    <lpage>e82</lpage>
    <history>
      <date date-type="accepted">
        <day>05</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="received">
        <day>18</day>
        <month>1</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkac333.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Cell-cell interactions are the fundamental building blocks of tissue organization and multicellular life. We developed Neighbor-seq, a method to identify and annotate the architecture of direct cell–cell interactions and relevant ligand–receptor signaling from the undissociated cell fractions in massively parallel single cell sequencing data. Neighbor-seq accurately identifies microanatomical features of diverse tissue types such as the small intestinal epithelium, terminal respiratory tract, and splenic white pulp. It also captures the differing topologies of cancer-immune-stromal cell communications in pancreatic and skin tumors, which are consistent with the patterns observed in spatial transcriptomic data. Neighbor-seq is fast and scalable. It draws inferences from routine single-cell data and does not require prior knowledge about sample cell-types or multiplets. Neighbor-seq provides a framework to study the organ-level cellular interactome in health and disease, bridging the gap between single-cell and spatial transcriptomics.</p>
    </abstract>
    <abstract abstract-type="graphical">
      <title>Graphical Abstract</title>
      <p>
        <fig position="float" id="ga1">
          <label>Graphical Abstract</label>
          <caption>
            <p>Neighbor-seq method.</p>
          </caption>
          <graphic xlink:href="gkac333figgra1" position="float"/>
        </fig>
      </p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R21CA248122</award-id>
        <award-id>R01GM129066</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Center for Advancing Translational Sciences</institution>
            <institution-id institution-id-type="DOI">10.13039/100006108</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Rutgers Clinical and Translational Science</institution>
          </institution-wrap>
        </funding-source>
        <award-id>TL1TR003019</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="14"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>The spatial context of cells in a tissue and their resulting cell–cell communications influence numerous processes, including cellular differentiation, organ development and homeostasis, and immune interactions in disease (<xref rid="B1" ref-type="bibr">1</xref>). Few high-throughput methods exist that can resolve direct cellular communications <italic toggle="yes">in vivo</italic> at single-cell resolution. Single-cell RNA sequencing (scRNA-seq) can identify cell-types and states in heterogeneous tissues, but the tissue structure is largely destroyed in the process (<xref rid="B2" ref-type="bibr">2</xref>). Microscopy-based methods such as RNAscope and FISH can interrogate only preselected genes at high spatial resolution. Spatial transcriptomics allows profiling of microscopic regions, but still samples 10–100 cells per region (<xref rid="B3" ref-type="bibr">3</xref>,<xref rid="B4" ref-type="bibr">4</xref>). Sequencing of partially dissociated tissues and subsequent multiplet deconvolution permits inference of physical cell interactions, but this requires specialized experimental modifications (<xref rid="B5" ref-type="bibr">5–8</xref>). A general method that can infer direct cell–cell interactions and concurrent transcriptomic changes <italic toggle="yes">in vivo</italic> at single cell resolution would provide unprecedented insight into the building blocks of tissue architecture in healthy and diseased tissues.</p>
    <p>Cell aggregates (multiplets) naturally arise in scRNA-seq experiments when two or more cells are captured in the same reaction droplet, and they typically represent at least several percent of all capture events (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B10" ref-type="bibr">10</xref>). Such multiplets occur primarily due to incomplete tissue dissociation (<xref rid="B6" ref-type="bibr">6</xref>), or occasionally by random co-encapsulation. We developed Neighbor-seq, a method to infer physical cell–cell communications by identifying, annotating, and analyzing cell multiplets from the undissociated cell fractions in scRNA-seq data using computational approaches (see Methods, Figure <xref rid="F1" ref-type="fig">1A</xref>). Neighbor-seq provides a framework to study the cellular interactome in health and disease using standard scRNA-seq data.</p>
    <fig position="float" id="F1">
      <label>Figure 1.</label>
      <caption>
        <p>Benchmarking cell neighbor detection and annotation. (<bold>A</bold>) A schematic representation of the Neighbor-seq workflow. (<bold>B</bold>) Uniform manifold approximation and projection (UMAP) of barcode RNA sequencing data singlets and multiplets of known composition from three cancer cell lines, colored by cell-type identities and shaped by the number of cells per barcode. (<bold>C</bold>) Neighbor-seq barcode composition annotation performance of cell-line barcodes in (B), plotted by known barcode type. AUC = area under the receiver operator curve. (<bold>D</bold>) Benchmarking Neighbor-seq doublet detection against nine other methods using 16 datasets of diverse tissue types with experimentally annotated doublets (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). Among these methods, only Neighbor-seq is explicitly optimized to infer doublet composition. Comparison of singlet vs. doublet classification area under the receiver operator curve (AUROC) distributions are shown. Boxplots show median (line), 25th and 75th percentiles (box) and 1.5× IQR (whiskers). Points represent outliers. (<bold>E</bold>) Comparison of the number of co-expressed ligand–receptor pairs in enriched (statistically significant) doublet types, not enriched doublets, and random synthetic doublets from the benchmarking studies in (D). Descriptions of the boxplots are as in (D). (Wilcoxon tests, ****<italic toggle="yes">P</italic> &lt; 0.0001. See also <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B, C</xref>). (<bold>F</bold>) Neighbor-seq example receiver operator curve for classifying artificial multiplet types in the cline-ch study, one of the benchmark studies used in (D). AUC, area under the curve. (<bold>G</bold>) Robustness of cell neighbor type annotation. Comparison of the distribution of coefficients of variation for neighbor type counts from the cline-ch benchmark dataset across <italic toggle="yes">n</italic> = 10 runs of Neighbor-seq and scDblFinder (Wilcoxon test, boxplots as in (D)).</p>
      </caption>
      <graphic xlink:href="gkac333fig1" position="float"/>
    </fig>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Neighbor-seq algorithm</title>
      <p>Neighbor-seq is a method to infer physical cell–cell communications by identifying, annotating and analyzing cell multiplets from the undissociated cell fractions in scRNA-seq data using machine learning approaches. The Neighbor-seq algorithm consists of the following components, each further described below: (i) barcode clustering and marker gene identification, (ii) Random Forest classifier training to identify multiplets and their cell type compositions, (iii) calculating enrichment scores for cell–cell interactions and (iv) construction of cell–cell interactome network and analysis of cell-neighbor transcriptomes, including ligand–receptor interactions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>).</p>
      <sec id="SEC2-1-1">
        <title>Input and cell type identification</title>
        <p>The input for Neighbor-seq is a cell by gene counts matrix, and optionally, cell-type cluster labels. If cell-type labels are not provided, Neighbor-seq utilizes a wrapper function to run Seurat (<xref rid="B11" ref-type="bibr">11</xref>) functions that TP10K normalize and scale the scRNA-seq data, find a default of 5000 variable genes, perform principle component analysis with <italic toggle="yes">n</italic> = 50 components, and identify cell type clusters. Cell-type marker genes are then identified using the FindAllMarkers function using a default of 200 cells subsampled for each cluster, an average log fold change threshold cutoff of 1, and minimum fraction of cells expressing a gene of 0.2 for computational efficiency. If cell-type labels are known a priori, only normalization and marker finding functions are run.</p>
      </sec>
      <sec id="SEC2-1-2">
        <title>Random forest classifier training</title>
        <p>Next, all homotypic and heterotypic combinations for a default of two cell-types are enumerated (e.g. AA, AB, etc.). Cells forming a doublet or multiplet are hereon referred to as ‘neighbors’, and the ‘neighbor-type’ indicates the identities of the 2+ cells on a single barcode. For each neighbor-type, artificial multiplets are created by randomly sampling cells from the constituent cell types and the prepared input gene by cell matrix and summing their gene counts. A random forest is then trained using a balanced set of singlets and artificial multiplets to predict the cell type composition of the barcodes from the assembled dataset. Although the majority of barcodes are expected to contain single cells, a balanced training set is used to increase random forest prediction accuracy. As such, a default of 100 artificial multiplets is created for each neighbor-type, and these are pooled with a default of 100 singlets from each originally identified cell-type to create the training set. A random forest trained, and hold-out artificial multiplets data are used to assess random forest performance. The multiROC R package is used to compute receiver operator curves. The process is iterated multiple times to retrain and generate an ensemble annotation result. The trained random forest is then used to predict the barcode composition of all barcodes in the original dataset. Two random forest implementations are incorporated in Neighbor-seq: the randomForest (<xref rid="B12" ref-type="bibr">12</xref>) R package, run with a default of 500 trees, and a faster implementation via the xgboost (<xref rid="B13" ref-type="bibr">13</xref>) R package, configured with the following parameters: objective = multi:softprob, eval_metric = mlogloss, nround = 1, max_depth = 20, num_parallel_tree = 200, subsample = 0.632, colsample_bytree = sqrt(number cells)/total number of cells, and colsample_bynode = sqrt(number of cells)/total number of cell. The faster implementation is preferred with large datasets and is set as the default in Neighbor-seq. Both implementations generated consistent results on benchmark analyses (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5b</xref>).</p>
      </sec>
      <sec id="SEC2-1-3">
        <title>Determining significantly enriched cell–cell interactions</title>
        <p>Neighbor-seq calculates an enrichment score for each cell-type interaction and compares it to the distribution of enrichment scores expected by chance. The interaction enrichment score reflects the proportion of counts of a neighbor type relative to the product of the total number of edges detected from each constituent cell and all other cell types. For neighbor type <italic toggle="yes">C</italic><sub>1</sub><italic toggle="yes">C</italic><sub>n</sub> composed of cell types <italic toggle="yes">C</italic><sub>1</sub> … <italic toggle="yes">C<sub>n</sub></italic>, the enrichment score is specifically defined as:<disp-formula><tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}EnrichmentScore{_{{C_1}{C_n}}} = \frac{{counts\left( {{C_1}{C_n}} \right)}}{{\mathop \prod \nolimits_{i = 1}^{i = n} totalEdge{s_{{C_i}}}}}\ \end{equation*}$$\end{document}</tex-math></disp-formula></p>
        <p>The observed enrichment score for a neighbor type is compared to that expected by chance. The null hypothesis assumes that multiplet formation is random and thus the distribution of neighbor-types follows the underlying singlet population counts. As such, for each sample in a dataset, given <italic toggle="yes">n</italic> predicted singlets and <italic toggle="yes">m</italic> predicted multiplets consisting of <italic toggle="yes">x</italic> constituent cells, Neighbor-seq simulates the synthetic creation of <italic toggle="yes">m</italic> multiplets drawing without replacement from <italic toggle="yes">n + x</italic> cells. The resulting neighbor-types are tallied and their enrichment scores are computed. This simulation is repeated for a default of 100 times; for each neighbor type, lower tailed Wilcoxon testing quantifies the probability that the simulated enrichment scores have a central tendency greater than the observed enrichment score. All probabilities are adjusted using the Holm correction.</p>
      </sec>
      <sec id="SEC2-1-4">
        <title>Construction of a cell–cell interactome network and transcriptomic analysis</title>
        <p>The primary outputs of Neighbor-seq are: (i) the artificial multiplet training and test sets, (ii) the trained random forest, (iii) the barcode classification probabilities for all barcode classes and (iv) the neighbor enrichment analysis. The latter reports the counts of each multiplet class detected in a sample as well as its enrichment score and corresponding <italic toggle="yes">P</italic>-value. When an ensemble result is generated by retraining the algorithm over multiple iterations, Neighbor-seq additionally reports the mean counts for each multiplet class and a combined <italic toggle="yes">P</italic>-value using Fisher's method. Using the cell neighbor type enrichment data, we use igraph (<xref rid="B14" ref-type="bibr">14</xref>) to plot a network, and it is possible to calculate network statistics such as degree and centrality. We use ligand–receptor data from Ramilowski <italic toggle="yes">et al.</italic> (<xref rid="B15" ref-type="bibr">15</xref>) or Shao <italic toggle="yes">et al.</italic> (<xref rid="B16" ref-type="bibr">16</xref>) to identify highly expressed ligand–receptor pairs in cell neighbors. Differentially expressed genes and other transcriptomic features in neighbor-types can be assessed using Seurat (<xref rid="B11" ref-type="bibr">11</xref>).</p>
      </sec>
    </sec>
    <sec id="SEC2-2">
      <title>Benchmarking, robustness and reproducibility</title>
      <p>We used a number of different metrics for benchmarking Neighbor-seq.</p>
      <sec id="SEC2-2-1">
        <title>Comparative assessment with other doublet finding methods</title>
        <p>We obtained scRNA-seq data for the benchmark annotated doublet datasets from Xi <italic toggle="yes">et al.</italic> (<xref rid="B10" ref-type="bibr">10</xref>) (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> for dataset details) and compared Neighbor-seq's ability to identify singlets versus doublets against the following nine published methods: doubletCells (<xref rid="B17" ref-type="bibr">17</xref>), Scrublet (<xref rid="B9" ref-type="bibr">9</xref>), DoubletDetection (<ext-link xlink:href="https://github.com/JonathanShor/DoubletDetection" ext-link-type="uri">https://github.com/JonathanShor/DoubletDetection</ext-link>), cxds (<xref rid="B18" ref-type="bibr">18</xref>),bcds (<xref rid="B18" ref-type="bibr">18</xref>), hybrid (<xref rid="B18" ref-type="bibr">18</xref>), solo (<xref rid="B19" ref-type="bibr">19</xref>), DoubletFinder (<xref rid="B20" ref-type="bibr">20</xref>) and scDblFinder (<ext-link xlink:href="https://github.com/plger/scDblFinder" ext-link-type="uri">https://github.com/plger/scDblFinder</ext-link>). These methods are optimized to distinguish singlets and filter out doublets in scRNA-seq data, and only scDblFinder has the ability to propose doublet composition. These methods generally rely on simulating artificial doublets, projecting data into a lower dimensional space, and using a machine or deep learning classifier to annotate barcodes. In contrast, Neighbor-seq utilizes cell-type specific clustering and marker gene sets to train a classifier directly on the gene counts of all possible expected barcode compositions, and it explicitly assigns multiplet class probabilities for each barcode rather than annotating the broader label of singlet or doublet. To evaluate Neighbor-seq, we ran Neighbor-seq using the default parameters on each benchmark dataset. To compute the probability of each barcode being either a singlet or doublet, we summed the Neighbor-seq probabilities for all doublet classes. Classification performance (area under the receiver operator curves) for the nine benchmark doublet finding methods tested on these datasets were obtained from Xi <italic toggle="yes">et al.</italic> (<xref rid="B10" ref-type="bibr">10</xref>), who ran these methods using their default settings. Area under the receiver operator curves for the Neighbor-seq singlet versus doublet classification were calculated as above with multiROC and compared with all other methods.</p>
        <p>To compare the stability of doublet population predictions across multiple runs from Neighbor-seq and scDblFinder, we ran each algorithm 10 times on the cline-ch benchmark dataset obtained from Xi <italic toggle="yes">et al.</italic> (<xref rid="B10" ref-type="bibr">10</xref>) For each doublet class, the coefficient of variation of its counts (mean/standard deviation) was computed, and the distributions of coefficients of variations were compared using Wilcoxon testing.</p>
      </sec>
      <sec id="SEC2-2-2">
        <title>Ensemble prediction</title>
        <p>To increase reproducibility of results, artificial multiplet construction and/or random forest training can be run for multiple iterations and an ensemble results can be computed. For each neighboring cell-type pair, the mean observed counts and Fisher's combined adjusted <italic toggle="yes">P</italic>-value are reported. We observed a high degree of reproducibility across multiple iterations and with a range of random seeds. These multiplet type counts and <italic toggle="yes">P</italic>-value thresholds for determining significant interactions were set to counts &gt;10 and <italic toggle="yes">P</italic>-value &lt;0.05 for most analyses in this study, but they can be adjusted and interpreted in light of data quality and known biology.</p>
      </sec>
      <sec id="SEC2-2-3">
        <title>Evaluation of ligand–receptor co-expression in cell neighbors</title>
        <p>Ligand-receptor data was obtained from Ramilowski <italic toggle="yes">et al.</italic> (<xref rid="B15" ref-type="bibr">15</xref>) or Shao <italic toggle="yes">et al.</italic> (<xref rid="B16" ref-type="bibr">16</xref>). We compared three classes of barcodes: (i) multiplet-classes with statistically significant enrichment, (ii) multiplet-classes without statistical enrichment and (iii) randomly synthesized multiplets from the same datasets. Multiplet class statistical enrichment was determined as described above. Random multiplets of degree 2 were created by aggregating the read counts of randomly sampled cells. We determined the number of matched ligand–receptor pairs as follows. Using TP10K normalized scRNA data, we called a gene ‘expressed’ in a barcode if its normalized count was greater than the 25th percentile of expression across all barcodes. For each barcode in a dataset, we counted the number of expressed ligands whose receptor was also expressed. We compared the distributions of the number of co-expressed ligand–receptor pairs across the three barcode classes (enriched multiplet types, non-enriched multiplet types, random multiplets) using Wilcoxon testing.</p>
      </sec>
    </sec>
    <sec id="SEC2-3">
      <title>Identifying cell–cell interactions in the small intestine</title>
      <p>We obtained scRNA-seq data and metadata, including cell-type annotations, from Haber <italic toggle="yes">et al.</italic> (<xref rid="B21" ref-type="bibr">21</xref>) UMAP plots were drawn using Seurat (<xref rid="B11" ref-type="bibr">11</xref>). Neighbor-seq was run for <italic toggle="yes">n</italic> = 10 iterations using default parameters. Cell-cell interactions were considered significant for those interactions with mean counts &gt;10 and combined <italic toggle="yes">P</italic>-value &lt;0.05. The validation analysis in known intestinal singlets multiplets was done using data from Andrews <italic toggle="yes">et al.</italic> (<xref rid="B6" ref-type="bibr">6</xref>), who also provided metadata and cell-type annotations. Neighbor-seq was run with default parameters as above on the small intestine scRNA-seq data. The resulting classifier was used to predict interactions in the accompanying small intestine partially dissociated clumps. Interactions were kept for those with counts &gt;10 and adjusted <italic toggle="yes">P</italic>-value &lt;0.05. Quantitative comparison of cell–cell networks from different studies was done by converting the networks into adjacency matrices and computing the inner product correlation. A permutation-based test was used to calculate the statistical significance of the inner product correlation. For a pair of matrices, random symmetric adjacency matrices are generated with the same number of nodes and edges as the test matrix, and a distribution of inner product correlations is computed. The center of this distribution is compared to the actual inner product correlation between the two test matrices using a one-sided Wilcoxon test.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Identifying cell–cell interactions in the lung</title>
      <p>We obtained scRNA-seq data and metadata, including cell-type annotations, from Travaglini et al. (<xref rid="B22" ref-type="bibr">22</xref>) To reduce computational complexity, cell-type annotations were collapsed into the following parent classes: alveolar, basal, ciliated, club, endothelial, fibroblast, goblet, immune, mucous, smooth muscle. UMAP plots were drawn using Seurat (<xref rid="B11" ref-type="bibr">11</xref>). Neighbor-seq was run for <italic toggle="yes">n</italic> = 10 iterations using default parameters. Cell-cell interactions were considered significant for those interactions with mean counts &gt;10 and combined <italic toggle="yes">P</italic>-value &lt;0.05. The validation analysis in known lung singlets and multiplets was done using data from Andrews <italic toggle="yes">et al.</italic> (<xref rid="B6" ref-type="bibr">6</xref>), who also provided metadata and cell-type annotations. Neighbor-seq was run with default parameters as above on the lung scRNA-seq data. The resulting classifier was used to predict interactions in the accompanying lung partially dissociated clumps. Interactions were kept for those with counts &gt;10 and adjusted <italic toggle="yes">P</italic>-value &lt;0.05. Quantitative comparison of cell–cell networks from different studies was done with the permutation-based inner correlation test as described for the small intestine analysis.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Identifying cell–cell interactions in the spleen</title>
      <p>We obtained scRNA-seq data and metadata, including cell-type annotations, from Madissoon <italic toggle="yes">et al.</italic> (<xref rid="B23" ref-type="bibr">23</xref>) To reduce computational complexity, cell-type annotations were collapsed into the following parent classes: CD34 progenitor, CD4 T-cells, CD8 T-cells, Cycling T-cells, dendritic cells, follicular B cells, germinal center B cells, innate lymphoid cells, macrophage, mantle B cells, monocytes, natural killer cells, plasma B cells and platelets. UMAP plots were drawn using Seurat (<xref rid="B11" ref-type="bibr">11</xref>). Neighbor-seq was run for <italic toggle="yes">n</italic> = 10 iterations using default parameters. This study contained data from 19 human samples. Cell-cell interactions were considered significant for those interactions found in &gt;1 sample and with mean counts &gt;5 and combined <italic toggle="yes">P</italic>-value &lt;0.05. The validation analysis was done using spleen data from Tabula Muris (<xref rid="B24" ref-type="bibr">24</xref>), who also provided metadata and cell-type annotations. Cell-type annotations were appended with their cluster label, resulting in multiple B-cell, T-cell and myeloid clusters. Neighbor-seq was run with default parameters as above. Cell–cell interactions were considered significant for those interactions with mean counts &gt;5 and combined <italic toggle="yes">P</italic>-value &lt;0.05.</p>
    </sec>
    <sec id="SEC2-6">
      <title>Identifying cell–cell interactions in pancreatic cancer</title>
      <p>We obtained scRNA-seq data and metadata, including cell-type annotations, from Peng <italic toggle="yes">et al.</italic> (<xref rid="B25" ref-type="bibr">25</xref>) UMAP plots were drawn using Seurat (<xref rid="B11" ref-type="bibr">11</xref>). Neighbor-seq was run for <italic toggle="yes">n</italic> = 10 iterations using default parameters. Cell–cell interactions were considered significant for those interactions with mean counts &gt;10 and combined <italic toggle="yes">P</italic>-value &lt;0.05. Ligand-receptor analysis was done as described above. Betweenness centrality was calculated using igraph (<xref rid="B14" ref-type="bibr">14</xref>). Hierarchical clustering of betweenness centralities scaled by cell-type was done using the pheatmap R package (<ext-link xlink:href="https://CRAN.R-project.org/package%20=%20pheatmap" ext-link-type="uri">https://CRAN.R-project.org/package = pheatmap</ext-link>). Spatial transcriptomic data for PDAC tumors was obtained from Moncada <italic toggle="yes">et al.</italic> (<xref rid="B26" ref-type="bibr">26</xref>) Cell-type scores for each spatial barcode were calculated as follows. We used the FindAllMarkers function from Seurat (<xref rid="B11" ref-type="bibr">11</xref>) to find differentially expressed genes for the PDAC cell-types in Peng <italic toggle="yes">et al.</italic> (<xref rid="B25" ref-type="bibr">25</xref>). Only highly cell-type specific genes were found by using these parameters: logfc.threshold = 2, min.diff.pct = 0.5, min.pct = 0.5. Spatial barcodes were TP10K normalized, and cell-type scores were calculated as the average expression of each cell-type gene signature. Scores Spearman correlations were computed using the cor.test function in R. Quantitative comparison of cell–cell networks from different studies was done by converting the networks into adjacency matrices and computing the inner product correlation. The Spearman correlation matrix of the transcriptomic data was used as the adjacency matrix, only keeping those edges with values <italic toggle="yes">r</italic> &gt; 0.2 and <italic toggle="yes">P</italic> &lt; 0.05. A permutation-based test was used to calculate the statistical significance of the inner product correlation as described above.</p>
    </sec>
    <sec id="SEC2-7">
      <title>Identifying cell–cell interactions in skin cancer</title>
      <p>We obtained scRNA-seq data and metadata, including cell-type annotations, from Ji <italic toggle="yes">et al.</italic> (<xref rid="B27" ref-type="bibr">27</xref>). To reduce computational complexity, immune cell-types annotations were collapsed into parent lymphoid and myeloid classes. UMAP plots were drawn using Seurat (<xref rid="B11" ref-type="bibr">11</xref>). Neighbor-seq was run for <italic toggle="yes">n</italic> = 10 iterations using default parameters. Cell-cell interactions were considered significant for those interactions with mean counts &gt;10 and combined <italic toggle="yes">P</italic>-value &lt;0.05. Ligand-receptor analysis was done as described above. Cell-type scores for each spatial barcode was calculated as follows. We used the FindAllMarkers function from Seurat (<xref rid="B11" ref-type="bibr">11</xref>) to find differentially expressed genes for the cell-types in Ji <italic toggle="yes">et al.</italic> Only highly cell-type specific genes were found by using these parameters: logfc.threshold = 0.5, min.diff.pct = 0.52. Marker genes were only kept if they were differentially expressed in &lt;5 cell types. Spatial barcodes were TP10K normalized, and cell-type scores were calculated as the average expression of each cell-type gene signature. Scores Pearson correlations were computed using the cor.test function in R.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <p>Neighbor-seq identifies physical cell interactions by using a machine learning classifier that annotates the cellular composition of each scRNA-seq barcode. Briefly, scRNA-seq data is filtered to remove low quality cells, the remaining barcodes are clustered based on their gene expression, and cluster marker genes are identified using a standard approach (<xref rid="B11" ref-type="bibr">11</xref>). A vast majority of the barcodes typically represent genuine single cells, with a minority being doublets or multiplets. Next, a training set of artificial multiplets is constructed representing all possible multiplet types by randomly sampling cells from each cell cluster and aggregating their raw read counts. The artificial multiplets can be homotypic (same cell-type) or heterotypic (different cell-type) and can be of order 2 (e.g. AA, AB, BB, etc.) or higher (e.g. AAA, ABA, etc.). A Random Forest cell-type classifier is trained based on the expression of marker gene sets from <italic toggle="yes">n</italic> (default: 100) randomly sampled barcodes from each artificial multiplet type, as well as <italic toggle="yes">n</italic> barcodes from each original cell type cluster, which are predominantly singlets. Neighbor-seq then applies the classifier to annotate each barcode in the original dataset and identifies those classified as multiplets. An ensemble annotation result is generated by iterating the algorithm. Neighbor-seq computes the enrichment and corresponding statistical significance of the observed frequencies of multiplet types compared to that expected based on the prevalence of the original cell-types in the dataset. Accordingly, Neighbor-seq constructs a network representing significant cell-type interactions and enables transcriptomic analysis of interacting cells.</p>
    <sec id="SEC3-1">
      <title>Benchmarking and validation with known multiplets</title>
      <p>We evaluated Neighbor-seq's ability to identify physically interacting cells via (i) annotation of multiplets with known composition, (ii) detection of known doublets in diverse tissues and (iii) identification of known cellular architectures in solid tissues. First, we tested Neighbor-seq's ability to annotate barcode composition in a controlled setting. We obtained scRNA-seq data (<xref rid="B6" ref-type="bibr">6</xref>) for three cancer cell lines that had been sorted as either singlets or multiplets of known composition (Figure <xref rid="F1" ref-type="fig">1B</xref>); we trained Neighbor-seq on the singlet data and used it to annotate singlet and multiplet barcode compositions, which contained between 1 and 4 cells in nonsymmetrical combinations. Neighbor-seq classified all droplets with high accuracy (AUC: singlets: 1, doublets: 0.99, triplets: 0.94, quadruplets: 0.82; Figure <xref rid="F1" ref-type="fig">1C</xref>), indicating that it can reliably infer barcode composition.</p>
      <p>Next, we benchmarked Neighbor-seq against nine other published doublet-finding methods using 16 datasets of diverse tissue types in which doublets were experimentally annotated (<xref rid="B10" ref-type="bibr">10</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). Neighbor-seq performed better or equally well to all published methods in identifying doublets (Wilcoxon <italic toggle="yes">P</italic> &gt; 0.8, Figure <xref rid="F1" ref-type="fig">1D</xref>), but with the unique advantages of (i) determining multiplet cell-types, (ii) identifying significantly enriched cell-type interactions, (iii) requiring no parameter tuning and (iv) making no assumptions about the underlying doublet frequencies, which ranged from 2.5% to 37% in the benchmark datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1A</xref>) and may not be known <italic toggle="yes">a priori</italic> in a real dataset. Moreover, Neighbor-seq is also the only method that can annotate higher order multiplets and can transfer knowledge across datasets.</p>
      <p>We further hypothesized that since doublets contain neighboring cells, they would have increased co-expression of ligand–receptor pairs. Indeed, enriched doublets-types co-expressed significantly more ligand–receptor pairs than non-enriched doublets, and significantly more pairs than randomly synthesized doublets (both Wilcoxon <italic toggle="yes">P</italic> &lt; 2.2e–16, Figure <xref rid="F1" ref-type="fig">1E</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>, see Materials and Methods for details). This was true in aggregate using two different ligand–receptor databases (<xref rid="B15" ref-type="bibr">15</xref>,<xref rid="B16" ref-type="bibr">16</xref>) and for each benchmark study individually (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>).</p>
      <p>Neighbor-seq performed exceptionally well at classifying singlets and all artificial doublet types (average AUC = 0.99, Figure <xref rid="F1" ref-type="fig">1F</xref>) and performed significantly better than expected by chance when cell-type labels were randomized (cline_ch data; average AUC = 0.501, Wilcoxon <italic toggle="yes">P</italic> &lt; 2.2e–16, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1C, D</xref>). Neighbor-seq classification accuracies across all benchmark datasets were similarly high (all AUC &gt; 0.92, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1E</xref>). While Neighbor-seq is the only method designed to infer doublet-types, scDblFinder also proposes doublet compositions, but when comparing the stability of doublet-type counts across multiple runs on the same dataset, Neighbor-seq results were significantly more stable (Wilcoxon <italic toggle="yes">P</italic> &lt; 2.2e–16, Figure <xref rid="F1" ref-type="fig">1G</xref>). These results indicate that Neighbor-seq successfully and identifies doublets across a range of tissue types and reproducibly annotates their cellular composition. Taken together, these attributes make Neighbor-seq first in the class of innovative computational methods that can help reconstruct physical cell interaction networks from single-cell sequencing data.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Identifying cell–cell interactions in the small intestine</title>
      <p>We examined whether Neighbor-seq could identify known interaction architectures in multiple tissue types with varying levels of cell-type diversity and organization. First, we tested Neighbor-seq on a scRNA-seq survey of the small intestinal epithelium containing 11 666 cells from <italic toggle="yes">n</italic> = 2 mice (<xref rid="B21" ref-type="bibr">21</xref>). The small intestine consists of alternating units of villi and crypts. Paneth cells in the crypt protect the residing stem cells, which differentiate and migrate upwards through various progenitor stages until becoming mature enterocytes, while goblet cells are scattered throughout villus (<xref rid="B28" ref-type="bibr">28</xref>) (Figure <xref rid="F2" ref-type="fig">2A</xref>). We identified the major cell types (Figure <xref rid="F2" ref-type="fig">2B</xref>) and used Neighbor-seq to recover their cellular adjacencies. Neighbor-seq correctly detected Paneth-stem interactions, a progression from stem to mature enterocytes, and multiple goblet cell interactions in the villus (Figure <xref rid="F2" ref-type="fig">2C</xref>, see Materials and Methods for details). We confirmed this microanatomy by training Neighbor-seq on a separate study of 5279 small intestinal singlets and used it to identify interactions in a dataset of 3671 intestinal multiplets (<xref rid="B6" ref-type="bibr">6</xref>) (Figure <xref rid="F2" ref-type="fig">2D</xref>). This validation analysis revealed a similar interaction network as obtained only from scRNA-seq data (Figure <xref rid="F2" ref-type="fig">2E</xref>). Differences between the schematic illustration and the two networks are primarily due to different cell types annotated in the two datasets and different optimized network layouts; nonetheless, both networks recapitulate a progression from the Paneth-stem crypt to the mature enterocytes at the top of the villus whilst passing through transition and progenitor cells. Furthermore, both networks supported known ligand–receptor signaling (<xref rid="B28" ref-type="bibr">28</xref>), such as <italic toggle="yes">LGR, LRP, BMP</italic> and <italic toggle="yes">NOTCH</italic>-mediated interactions between Paneth and stem cells. The directionality of this signaling could be inferred by inspecting the stem and Paneth cell singlets data, in which stem cells had significantly higher expression of the aforementioned genes compared to Paneth cells (Wilcoxon testing, <italic toggle="yes">P</italic> &lt; 2e–16 for all four genes). To quantitatively compare the networks obtained from the two studies, we harmonized the cell labels based on cell ontology and represented them as adjacency matrices (Figure <xref rid="F2" ref-type="fig">2F</xref>). The two matrices were significantly more correlated than expected by chance (inner product correlation = 0.53, Wilcoxon permutation test, <italic toggle="yes">P</italic> = 4e–17, see Materials and Methods), indicating that Neighbor-seq identified similar cell networks from independent studies of the same tissue types.</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Detecting known microanatomical features of the small intestinal epithelium. (<bold>A</bold>) Illustration of the main cell types in the small intestinal crypt and villus. (<bold>B</bold>) Uniform manifold approximation and projection (UMAP) of 11 665 small intestinal cells (<xref rid="B21" ref-type="bibr">21</xref>) from the duodenum, jejunum, and ileum (<italic toggle="yes">n</italic> = 2 mice) colored by cell type. TA, transit amplifying; EP, enterocyte progenitor. (<bold>C</bold>) Network diagram of significant cell type interactions from (B) identified by Neighbor-seq. Neighbor-seq is run for <italic toggle="yes">n</italic> = 10 iterations, and interactions are shown for edges with a mean count &gt;10 and enrichment score combined adjusted <italic toggle="yes">P</italic>-value &lt;0.05 (see Materials and Methods). Edge thickness represents interaction <italic toggle="yes">P</italic>-value and edge color represents counts. Green color scale represents anatomical progression from crypt to villus. (<bold>D</bold>) UMAP of 5279 cells from the small intestine (<xref rid="B6" ref-type="bibr">6</xref>) (<italic toggle="yes">n</italic> = 1 mouse) colored by cell type. Neighbor-seq is trained on these cells and used to predict the interaction network in a dataset of partially dissociated intestinal clumps. (<bold>E</bold>) Network diagram of significant cell type interactions identified by Neighbor-seq from 3671 small intestinal clumps. Methods, edge color and thickness, and colors scale are the same as in (C). (<bold>F</bold>) Adjacency matrix representation of the networks from (C) and (E). Cell labels were harmonized based on cell ontologies. Red color indicates the presence of a connection, white indicates no connection.</p>
        </caption>
        <graphic xlink:href="gkac333fig2" position="float"/>
      </fig>
    </sec>
    <sec id="SEC3-3">
      <title>Identifying cell–cell interactions in the lung</title>
      <p>Second, we tested Neighbor-seq's ability to identify microanatomical structures in the lung, which contains interactions between cells of multiple lineages. The terminal bronchioles contain ciliated epithelium and club cells, smooth muscle, mucous secreting cells, and basal stem cells; gas exchange occurs in the alveoli, which contain alveolar pneumocytes and macrophages and are lined by vessels, fibroblasts, and smooth muscle (<xref rid="B22" ref-type="bibr">22</xref>) (Figure <xref rid="F3" ref-type="fig">3A</xref>). We analyzed a human lung cell atlas containing 65 662 cells from <italic toggle="yes">n</italic> = 5 human donors (<xref rid="B22" ref-type="bibr">22</xref>), identified the cell-types (Figure <xref rid="F3" ref-type="fig">3B</xref>) and recovered an interaction network (Figure <xref rid="F3" ref-type="fig">3C</xref>, see Materials and Methods for details). Neighbor-seq correctly separated the bronchiolar and alveolar compartments and identified the gas exchange membrane between alveolar and endothelial cells. We confirmed detection of these cell–cell interactions in a dataset of lung singlets and multiplets (<xref rid="B6" ref-type="bibr">6</xref>) (Figure <xref rid="F3" ref-type="fig">3D</xref>). Training Neighbor-seq on the singlet data and deconvoluting interactions from the known multiplets again revealed bronchiolar and alveolar compartments as well as several immune cell interactions (Figure <xref rid="F3" ref-type="fig">3E</xref>). Neighbor-seq networks also corroborated known signaling pathways in lung development (<xref rid="B29" ref-type="bibr">29</xref>), such as by expression of <italic toggle="yes">NOTCH, FGF</italic>, and <italic toggle="yes">EGF</italic> ligands in basal- cell neighbors. Representing the networks derived from the two studies as adjacency matrices with harmonized cell-ontology labeling further indicated significant similarity in the cell–cell connections identified (Figure <xref rid="F3" ref-type="fig">3F</xref>, inner product correlation = 0.73, Wilcoxon permutation test, <italic toggle="yes">P</italic> = 5e–17, see Materials and Methods).</p>
      <fig position="float" id="F3">
        <label>Figure 3.</label>
        <caption>
          <p>Detecting known microanatomical features of the terminal respiratory tract. (<bold>A</bold>) Illustration of the main cell types in the terminal bronchioles and alveolus. AT1, alveolar type 1 cell, AT2, alveolar type 2 cell (<bold>B</bold>) Uniform manifold approximation and projection (UMAP) 65,662 cells (<xref rid="B22" ref-type="bibr">22</xref>) from the terminal respiratory tract (<italic toggle="yes">n</italic> = 5 human samples) colored by cell type. (<bold>C</bold>) Network diagram of significant cell type interactions from (B) identified by Neighbor-seq, colored by known microanatomical compartment. Data is shown for <italic toggle="yes">n</italic> = 10 iterations, mean counts &gt;10, combined <italic toggle="yes">P</italic>-value &lt; 0.05. (<bold>D</bold>) UMAP of 6084 mouse lung cells (<xref rid="B6" ref-type="bibr">6</xref>) (<italic toggle="yes">n</italic> = 3 mice) colored by cell type. Neighbor-seq is trained on these cells and used to predict the interaction network in a dataset of partially dissociated lung clumps. (<bold>E</bold>) Network diagram of significant cell type interactions identified by Neighbor-seq from 4729 lung clumps. Methods, edge color and thickness, and colors scale are the same as in (C). (<bold>F</bold>) Adjacency matrix representation of the networks from (C) and (E). Cell labels were harmonized based on cell ontologies. Red color indicates the presence of a connection, white indicates no connection.</p>
        </caption>
        <graphic xlink:href="gkac333fig3" position="float"/>
      </fig>
    </sec>
    <sec id="SEC3-4">
      <title>Identifying cell–cell interactions in the spleen</title>
      <p>Third, we used Neighbor-seq to predict interactions in the splenic white pulp, a structure not held by tight junctions but whose organization is chemokine driven (<xref rid="B30" ref-type="bibr">30</xref>). The white pulp is surrounded by myeloid cells and consists of separate B- and T-cell zones, with B-cell follicles further separating into germinal centers and mantle zones and T-cells interacting with antigen presenting myeloid cells (<xref rid="B30" ref-type="bibr">30</xref>) (Figure <xref rid="F4" ref-type="fig">4A</xref>). We used Neighbor-seq to analyze a dataset of human spleen containing 94,050 immune cells from <italic toggle="yes">n</italic> = 19 human samples (<xref rid="B23" ref-type="bibr">23</xref>) (Figure <xref rid="F4" ref-type="fig">4B</xref>, see Materials and Methods for details). Neighbor-seq correctly identified the B and T-cell zones; germinal centers did not interact with non-B-cells, and myeloid cells interacted with both B and T lymphocytes (Figure <xref rid="F4" ref-type="fig">4C</xref>). We confirmed these structures by analyzing splenic tissue from the Tabula Muris (<xref rid="B24" ref-type="bibr">24</xref>) containing 9552 cells of lymphoid and myeloid origin (Figure <xref rid="F4" ref-type="fig">4D</xref>). Neighbor-seq again identified B and T-cell zones with myeloid interactions (Figure <xref rid="F4" ref-type="fig">4E</xref>). Collectively, these analyses confirmed that Neighbor-seq can correctly identify direct cell–cell interactions and microanatomies <italic toggle="yes">in vivo</italic> in diverse tissue types.</p>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>Detecting known microanatomical features of the splenic white pulp. (<bold>A</bold>) Illustration of the main cell types in the splenic white pulp. (<bold>B</bold>) Uniform manifold approximation and projection (UMAP) of 94 050 splenic white pulp immune cells (<xref rid="B23" ref-type="bibr">23</xref>) (<italic toggle="yes">n</italic> = 19 human samples) colored by cell type. DC, dendritic cell; GC, germinal center; ILC, innate lymphoid cell; NK, natural killer cell. (<bold>C</bold>) Network diagram of significant cell type interactions from (B) identified by Neighbor-seq, colored by known cell type lineage. Data is shown for <italic toggle="yes">n</italic> = 10 iterations, mean counts &gt;5, combined <italic toggle="yes">P</italic>-value &lt; 0.05. (<bold>D</bold>) UMAP of 9552 murine immune cells from Tabula Muris (<xref rid="B24" ref-type="bibr">24</xref>) colored by cell type. (<bold>E</bold>) Network diagram of significant cell type interactions from (D) identified by Neighbor-seq, colored by known cell compartment. Methods, edge color and thickness, and colors scale are the same as in (C).</p>
        </caption>
        <graphic xlink:href="gkac333fig4" position="float"/>
      </fig>
    </sec>
    <sec id="SEC3-5">
      <title>Identifying cell–cell interactions in pancreatic cancer</title>
      <p>We next used Neighbor-seq to analyze inter-cellular interactions in pancreatic ductal adenocarcinoma (PDAC). We obtained scRNA-seq data for 24 tumors and 11 control samples (<xref rid="B25" ref-type="bibr">25</xref>); these tissues had normal to poorly differentiated histopathology, were from anatomic locations throughout the pancreas (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>), and in total contained 57 530 cells from a mixture of normal and malignant epithelial cells and immune, stromal and endothelial cells (Figure <xref rid="F5" ref-type="fig">5A</xref>). Neighbor-seq detected 17 580 doublets (31% of barcodes), of which 1373 were heterotypic doublets (2.3% of all barcodes)—this fraction of heterotypic cell neighbors was typical for all datasets analyzed.</p>
      <fig position="float" id="F5">
        <label>Figure 5.</label>
        <caption>
          <p>Identification of cell type interactions in pancreatic cancer. (<bold>A</bold>) Uniform manifold approximation and projection (UMAP) of 57 530 primary human cells (<xref rid="B25" ref-type="bibr">25</xref>) from <italic toggle="yes">n</italic> = 24 pancreatic ductal adenocarcinomas and <italic toggle="yes">n</italic> = 11 control pancreatic tissues colored by cell type. (<bold>B</bold>) Network diagram of significant cell type interactions from (A) identified by Neighbor-seq, colored by known cell compartment. Edge thickness represents interaction <italic toggle="yes">P</italic>-value and edge color represents counts. Neighbor-seq is run for <italic toggle="yes">n</italic> = 10 iterations, and interactions are shown for edges with a mean count &gt;10 and enrichment score combined adjusted <italic toggle="yes">P</italic>-value &lt;0.05 (see Materials and Methods). (<bold>C</bold>) Comparison of the number of co-expressed ligand–receptor pairs in enriched (statistically significant) doublet types, not enriched doublets, and random synthetic doublets from (A). Boxplots show median (line), 25th and 75th percentiles (box) and 1.5× IQR (whiskers). Points represent outliers. Wilcoxon tests, ****<italic toggle="yes">P</italic> &lt; 0.0001. (<bold>D</bold>) Heatmap and hierarchical clustering of cell type betweenness centrality in interaction networks for each sample. Rows represent cell types and columns represent samples; T#, tumor sample; N#, normal sample; ME#, microenvironment. (<bold>E</bold>) Spatial transcriptomic maps of two pancreatic tumors (<xref rid="B26" ref-type="bibr">26</xref>,<xref rid="B32" ref-type="bibr">32</xref>) with <italic toggle="yes">n</italic> = 428 (top) and <italic toggle="yes">n</italic> = 224 (bottom) barcodes, colored by cell-type abundance scores. Correlation of abundance score of multiple cell type pairs, identified in Figure <xref rid="F3" ref-type="fig">3B</xref>, were significant (tumor and ductal cells: A: <italic toggle="yes">r</italic> = 0.19, <italic toggle="yes">P</italic> = 2e–2; B: <italic toggle="yes">r</italic> = 0.44, <italic toggle="yes">P</italic> = 4e–10; tumor cells and fibroblasts: A: <italic toggle="yes">r</italic> = 0.30, <italic toggle="yes">P</italic> = 8e–9; ductal and acinar cells: A: <italic toggle="yes">r</italic> = 0.16, <italic toggle="yes">P</italic> = 2e–2; ductal and endocrine cells: A: <italic toggle="yes">r</italic> = 0.29, <italic toggle="yes">P</italic> = 5e–8; ductal and endothelial cells A: <italic toggle="yes">r</italic> = 0.41, <italic toggle="yes">P</italic> = 1e–17; Spearman correlation). See <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref> for additional instances.</p>
        </caption>
        <graphic xlink:href="gkac333fig5" position="float"/>
      </fig>
      <p>Out of 45 possible heterotypic cell-type pairs, Neighbor-seq identified 19 enriched interactions (Figure <xref rid="F5" ref-type="fig">5B</xref>). Normal pancreatic epithelium (ductal, endocrine, acinar cells) interacted with each other and with endothelial cells, whereas tumor cells had stronger connections with ductal cells and fibroblasts and immune cells interacted with most cell-types. These interactions were detected across multiple samples, the most common being B cell-myeloid, ductal-tumor and tumor-T cell interactions (Figure <xref rid="F5" ref-type="fig">5B</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2A, Table S3</xref>). Again, enriched cell neighbors co-expressed significantly more matched ligand–receptor pairs than non-enriched doublet-types or random synthetic doublets (Wilcoxon <italic toggle="yes">P</italic> &lt; 2.2e–16, Figure <xref rid="F5" ref-type="fig">5C</xref>). The detected neighboring cell communications were also consistent with existing literature. For example, <italic toggle="yes">BTK-</italic>dependent B-cell interactions with <italic toggle="yes">FCγR+</italic> myeloid cells were recently implicated in PDAC progression (<xref rid="B31" ref-type="bibr">31</xref>), and we observed significantly greater <italic toggle="yes">BTK</italic> (Wilcoxon, <italic toggle="yes">P</italic> = 6.3e–40) and <italic toggle="yes">FCGR1A</italic> expression (Wilcoxon, <italic toggle="yes">P</italic> = 6.8e–59) in B cell-myeloid doublets compared to all other doublet-types. This highlights how Neighbor-seq can be used to identify interaction-specific transcriptional changes with functional relevance.</p>
      <p>The topology of cell–cell interactions varied across samples, which could be due to intra- or inter-tumor heterogeneity in cell interactions or differential presence/absence of doublet-types in a sample. We computed the betweenness centrality of cell-types in each sample, and clustering of these centrality scores revealed three classes of tissue microenvironments (ME, Figure <xref rid="F5" ref-type="fig">5D</xref>). ME1 contained mostly normal ductal epithelial connections, ME2 was dominated by tumor cell connections and ME3 by immune cell edges (Figure <xref rid="F5" ref-type="fig">5D</xref>). These ME classes had significantly different histopathological characteristics (Fisher's exact test; pathology: <italic toggle="yes">P</italic> = 5e–4; stage: <italic toggle="yes">P</italic> = 5e–4; lymph node invasion: <italic toggle="yes">P</italic> = 3e–3). These analyses indicate that Neighbor-seq can uncover direct cellular interactions and tumor microenvironment characteristics with functional or clinical relevance.</p>
      <p>Next, we analyzed spatial transcriptomic data for pancreatic ductal adenocarcinoma (PDAC) samples from a published study (<xref rid="B26" ref-type="bibr">26</xref>) where there were 243–996 spatially annotated barcodes per sample, each capturing the aggregated transcriptomic makeup of ∼20–70 cells in tumor and adjacent normal tissue microenvironments. We observed organizational contexts similar to what we identified from scRNA-seq data alone. We used marker genes to calculate cell-type scores for each spatial barcode (see Materials and Methods; PDAC-A: <italic toggle="yes">n</italic> = 428, PDAC-B: <italic toggle="yes">n</italic> = 224 spatial barcodes) and visualized the distribution of cell-types in the tissues (Figure <xref rid="F5" ref-type="fig">5E</xref>). Tumor cells co-localized with ductal cells (Spearman correlation; A: <italic toggle="yes">r</italic> = 0.19, <italic toggle="yes">P</italic> = 2e–2; B: <italic toggle="yes">r</italic> = 0.44, <italic toggle="yes">P</italic> = 4e–10) and fibroblasts (Spearman correlation; A: <italic toggle="yes">r</italic> = 0.30, <italic toggle="yes">P</italic> = 8e–9). Ductal cells co-localized with acinar cells (Spearman correlation; A: <italic toggle="yes">r</italic> = 0.16, <italic toggle="yes">P</italic> = 2e–2), endocrine cells (Spearman correlation; A: <italic toggle="yes">r</italic> = 0.29, <italic toggle="yes">P</italic> = 5e–8), and endothelial cells (Spearman correlation; A: <italic toggle="yes">r</italic> = 0.41, <italic toggle="yes">P</italic> = 1e–17). B and T cells were scattered throughout the tissue, but myeloid cells did not significantly co-localize with tumor cells. We observed similar patterns when visualizing spatial transcriptomic data for <italic toggle="yes">n</italic> = 7 other PDAC tumors (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3A</xref>). These findings are broadly consistent with the architecture of cell-networks we deduced from scRNA-seq data of a different cohort of PDAC tumors (Figure <xref rid="F5" ref-type="fig">5C</xref>), suggesting that despite intra- and inter-tumor heterogeneity, the topology of cell–cell interactions may be similar. We represented the cell–cell networks derived from scRNA-seq and the spatial transcriptomic data as cell adjacency matrices (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2B</xref>, see Materials and Methods). Inner product correlation further indicated that the cell adjacencies identified from the two studies were significantly more similar than expected by chance (<italic toggle="yes">r</italic> = 0.33, <italic toggle="yes">P</italic> = 2e–11). This validation across two different technology platforms reinforces Neighbor-seq's ability to infer cellular connectomes from scRNA-seq data and bridge between single-cell and spatial transcriptomics, which has a resolution of 10<sup>1</sup>–10<sup>2</sup> cells.</p>
    </sec>
    <sec id="SEC3-6">
      <title>Identifying cell–cell interactions in skin cancer</title>
      <p>Lastly, we used Neighbor-seq to analyze physical cell interactions in cutaneous squamous cell carcinoma (SCC). We obtained scRNA-seq data for 10 tumors, of which four tumors also had spatial transcriptomic data (<xref rid="B27" ref-type="bibr">27</xref>). These tissues had moderate or well differentiated histology, were from various primary sites on the body, and the dataset in total contained 48 164 single-cell transcriptomes from 16 cell subtypes of epithelial, stromal, and immune origin (Figure <xref rid="F6" ref-type="fig">6A</xref>). Neighbor-seq detected 15 626 doublets (32% of all barcodes), of which 5346 were heterotypic doublets (11% of all barcodes). Of 105 possible heterotypic cell-type pairs, Neighbor-seq identified 38 significant pairwise interactions (Figure <xref rid="F6" ref-type="fig">6B</xref>). Tumor cell populations were on the edge of the cell interaction network and showed significant interactions mostly with normal epithelium. Unlike in pancreatic cancer (Figure <xref rid="F5" ref-type="fig">5B</xref>), immune cells were located peripherally in the network and interacted mostly with normal epithelium. We did not observe direct connections between lymphoid cells and any tumor subpopulation (Figure <xref rid="F6" ref-type="fig">6B</xref>), which might suggest potential immune evasion.</p>
      <fig position="float" id="F6">
        <label>Figure 6.</label>
        <caption>
          <p>Identification of cell type interactions in skin cancer. (<bold>A</bold>) Uniform manifold approximation and projection (UMAP) of 48 164 primary human cells from <italic toggle="yes">n</italic> = 10 cutaneous squamous cell carcinomas (<xref rid="B27" ref-type="bibr">27</xref>) colored by cell type. TSK, tumor-specific keratinocyte; KC, keratinocyte; Cyc, cycling; Diff, differentiating. (<bold>B</bold>) Network diagram of significant cell type interactions from (A) identified by Neighbor-seq, colored by known cell compartment. Edge thickness represents interaction <italic toggle="yes">P</italic>-value and edge color represents counts. Neighbor-seq is run for <italic toggle="yes">n</italic> = 10 iterations, and interactions are shown for edges with a mean count &gt;10 and enrichment score combined adjusted <italic toggle="yes">P</italic>-value &lt;0.05 (see Materials and Methods). (<bold>C</bold>) Spatial transcriptomic maps of four patients (P2: <italic toggle="yes">n</italic> = 666, P5: <italic toggle="yes">n</italic> = 521, P9: <italic toggle="yes">n</italic> = 1145, P10: <italic toggle="yes">n</italic> = 608 barcodes) colored by cell-type abundance scores (see Materials and Methods). (<bold>D</bold>) Boxplots comparing spatial barcode cell-type abundance scores between cell-type pairs with enriched doublets from (B) compared to all other possible pairs. Boxplots show median (line), 25th and 75th percentiles (box) and 1.5× IQR (whiskers). Points represent outliers. Wilcoxon testing. (<bold>E</bold>) Comparison of the number of co-expressed ligand–receptor pairs in enriched (statistically significant) doublet types, not enriched doublets and random synthetic doublets from (A). Boxplots are the same as in (D).</p>
        </caption>
        <graphic xlink:href="gkac333fig6" position="float"/>
      </fig>
      <p>These general patterns identified from the inferred cell-interaction network agreed with observations made from spatial transcriptomic sequencing data of the same tumors profiled at 8179 spots. Using the single-cell data, we identified cell-type marker genes and used these to calculate cell-type scores for each spatial sequencing spot in four patients (see Methods). Coloring the spatial maps by composite tumor, normal epithelium and stroma, or immune scores revealed spatial contexts similar to those we identified with Neighbor-seq from the single-cell data alone (Figure <xref rid="F6" ref-type="fig">6C</xref>). Most prominently in patient P2, tumor populations occupied a separate region of the spatial map with minimal immune presence, while the adjacent regions were rich in normal epithelium, stromal, and immune genetic activity. We next compared the specific cell-type pair associations identified by Neighbor-seq (Figure <xref rid="F6" ref-type="fig">6B</xref>) with the cell-type score correlations in the matched spatial data. For all patients, cell-types with enriched neighbor interactions in scRNA-seq were significantly more correlated with each other across spatial spots than were cell-type pairs that did not have enriched doublets in scRNA-seq (P2: <italic toggle="yes">P</italic> = 2.3e–7, P5: <italic toggle="yes">P</italic> = 3.8e–4, P9: <italic toggle="yes">P</italic> = 3.4e–6, P10: <italic toggle="yes">P</italic> = 4.2e–10; Wilcoxon; Figure <xref rid="F6" ref-type="fig">6D</xref>). Lastly, we confirmed that the enriched cell neighbors in scRNA-seq exhibited increased pairwise crosstalk by assessing the number of co-expressed ligand–receptor pairs (see Materials and Methods). Consistent with our previous analyses, enriched doublets expressed significantly more ligand–receptor pairs than non-enriched doublets or randomly synthesized doublets (both Wilcoxon <italic toggle="yes">P</italic> &lt; 2.2e–16, Figure <xref rid="F6" ref-type="fig">6E</xref>). Taken together, these results indicate that Neighbor-seq accurately identifies and annotates multiplets that contain interacting cells across a range of normal and diseased tissues, and these interactions are consistent with spatial contexts identified from both the same and different samples.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>In summary, Neighbor-seq infers direct cell–cell interactions by identifying undissociated cell multiplets in standard scRNA-seq data and classifying them according to their constituent cell-types, ultimately building the cellular interactome in diverse normal and diseased tissues. It shows high accuracy and reproducibility, and the results are in agreement with prior knowledge about tissue microenvironments in well-studied tissues and with spatial transcriptomic data. Neighbor-seq complements emerging methods (<xref rid="B5" ref-type="bibr">5–8</xref>) that are optimized for deconvoluting the transcriptomics of single cells and cell clumps. It, however, reconstructs tissue-scale cell interaction networks using undissociated multiplets from standard scRNA-seq alone, thereby eliminating the need for specialized sample preparation and boosting scalability. Neighbor-seq provides a framework to study the topology of cell–cell interactome leading to the organization of tissue microenvironment, bridging the gap in resolution between single-cell and spatial transcriptomics. Neighbor-seq is available at <ext-link xlink:href="https://github.com/sjdlabgroup/Neighborseq" ext-link-type="uri">https://github.com/sjdlabgroup/Neighborseq</ext-link>.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>The Neighbor-seq resource and user-friendly documentations are freely available on Github at <ext-link xlink:href="https://github.com/sjdlabgroup/Neighborseq" ext-link-type="uri">https://github.com/sjdlabgroup/Neighborseq</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>gkac333_Supplemental_Files</label>
      <media xlink:href="gkac333_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We acknowledge the Office of Advanced Research Computing (OARC) at Rutgers, The State University of New Jersey for providing access to the Amarel cluster URL: <ext-link xlink:href="https://it.rutgers.edu/oarc" ext-link-type="uri">https://it.rutgers.edu/oarc</ext-link>.</p>
  </ack>
  <sec id="SEC6">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkac333#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC7">
    <title>FUNDING</title>
    <p>National Institutes of Health [R21CA248122, R01GM129066 to S.D.]; National Institutes of Health, National Center for Advancing Translational Sciences, Rutgers Clinical and Translational Science Award [TL1TR003019 to B.G.]. The open access publication charge for this paper has been waived by Oxford University Press - <italic toggle="yes">NAR</italic> Editorial Board members are entitled to one free paper per year in recognition of their work on behalf of the journal.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Armingol</surname><given-names>E.</given-names></string-name>, <string-name><surname>Officer</surname><given-names>A.</given-names></string-name>, <string-name><surname>Harismendy</surname><given-names>O.</given-names></string-name>, <string-name><surname>Lewis</surname><given-names>N.E.</given-names></string-name></person-group><article-title>Deciphering cell–cell interactions and communication from gene expression</article-title>. <source>Nat. Rev. Genet.</source><year>2021</year>; <volume>22</volume>:<fpage>71</fpage>–<lpage>88</lpage>.<pub-id pub-id-type="pmid">33168968</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Regev</surname><given-names>A.</given-names></string-name>, <string-name><surname>Teichmann</surname><given-names>S.A.</given-names></string-name>, <string-name><surname>Lander</surname><given-names>E.S.</given-names></string-name>, <string-name><surname>Amit</surname><given-names>I.</given-names></string-name>, <string-name><surname>Benoist</surname><given-names>C.</given-names></string-name>, <string-name><surname>Birney</surname><given-names>E.</given-names></string-name>, <string-name><surname>Bodenmiller</surname><given-names>B.</given-names></string-name>, <string-name><surname>Campbell</surname><given-names>P.</given-names></string-name>, <string-name><surname>Carninci</surname><given-names>P.</given-names></string-name>, <string-name><surname>Clatworthy</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Science forum: the human cell atlas</article-title>. <source>Elife</source>. <year>2017</year>; <volume>6</volume>:<fpage>e27041</fpage>.<pub-id pub-id-type="pmid">29206104</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Asp</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bergenstråhle</surname><given-names>J.</given-names></string-name>, <string-name><surname>Lundeberg</surname><given-names>J.</given-names></string-name></person-group><article-title>Spatially resolved transcriptomes—next generation tools for tissue exploration</article-title>. <source>BioEssays</source>. <year>2020</year>; <volume>42</volume>:<fpage>1900221</fpage>.</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Crosetto</surname><given-names>N.</given-names></string-name>, <string-name><surname>Bienko</surname><given-names>M.</given-names></string-name>, <string-name><surname>van Oudenaarden</surname><given-names>A.</given-names></string-name></person-group><article-title>Spatially resolved transcriptomics and beyond</article-title>. <source>Nat. Rev. Genet.</source><year>2015</year>; <volume>16</volume>:<fpage>57</fpage>–<lpage>66</lpage>.<pub-id pub-id-type="pmid">25446315</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Manco</surname><given-names>R.</given-names></string-name>, <string-name><surname>Averbukh</surname><given-names>I.</given-names></string-name>, <string-name><surname>Porat</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Halpern</surname><given-names>K.B.</given-names></string-name>, <string-name><surname>Amit</surname><given-names>I.</given-names></string-name>, <string-name><surname>Itzkovitz</surname><given-names>S.</given-names></string-name></person-group><article-title>Clump sequencing exposes the spatial expression programs of intestinal secretory cells</article-title>. <source>Nat. Commun.</source><year>2021</year>; <volume>12</volume>:<fpage>3074</fpage>.<pub-id pub-id-type="pmid">34031373</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andrews</surname><given-names>N.</given-names></string-name>, <string-name><surname>Serviss</surname><given-names>J.T.</given-names></string-name>, <string-name><surname>Geyer</surname><given-names>N.</given-names></string-name>, <string-name><surname>Andersson</surname><given-names>A.B.</given-names></string-name>, <string-name><surname>Dzwonkowska</surname><given-names>E.</given-names></string-name>, <string-name><surname>Šutevski</surname><given-names>I.</given-names></string-name>, <string-name><surname>Heijboer</surname><given-names>R.</given-names></string-name>, <string-name><surname>Baryawno</surname><given-names>N.</given-names></string-name>, <string-name><surname>Gerling</surname><given-names>M.</given-names></string-name>, <string-name><surname>Enge</surname><given-names>M.</given-names></string-name></person-group><article-title>An unsupervised method for physical cell interaction profiling of complex tissues</article-title>. <source>Nat. Methods</source>. <year>2021</year>; <volume>18</volume>:<fpage>912</fpage>–<lpage>920</lpage>.<pub-id pub-id-type="pmid">34253926</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boisset</surname><given-names>J.-C.</given-names></string-name>, <string-name><surname>Vivié</surname><given-names>J.</given-names></string-name>, <string-name><surname>Grün</surname><given-names>D.</given-names></string-name>, <string-name><surname>Muraro</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Lyubimova</surname><given-names>A.</given-names></string-name>, <string-name><surname>van Oudenaarden</surname><given-names>A.</given-names></string-name></person-group><article-title>Mapping the physical network of cellular interactions</article-title>. <source>Nat. Methods</source>. <year>2018</year>; <volume>15</volume>:<fpage>547</fpage>–<lpage>553</lpage>.<pub-id pub-id-type="pmid">29786092</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Giladi</surname><given-names>A.</given-names></string-name>, <string-name><surname>Cohen</surname><given-names>M.</given-names></string-name>, <string-name><surname>Medaglia</surname><given-names>C.</given-names></string-name>, <string-name><surname>Baran</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Li</surname><given-names>B.</given-names></string-name>, <string-name><surname>Zada</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bost</surname><given-names>P.</given-names></string-name>, <string-name><surname>Blecher-Gonen</surname><given-names>R.</given-names></string-name>, <string-name><surname>Salame</surname><given-names>T.-M.</given-names></string-name>, <string-name><surname>Mayer</surname><given-names>J.U.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Dissecting cellular crosstalk by sequencing physically interacting cells</article-title>. <source>Nat. Biotechnol.</source><year>2020</year>; <volume>38</volume>:<fpage>629</fpage>–<lpage>637</lpage>.<pub-id pub-id-type="pmid">32152598</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolock</surname><given-names>S.L.</given-names></string-name>, <string-name><surname>Lopez</surname><given-names>R.</given-names></string-name>, <string-name><surname>Klein</surname><given-names>A.M.</given-names></string-name></person-group><article-title>Scrublet: computational identification of cell doublets in single-cell transcriptomic data</article-title>. <source>Cell Syst</source>. <year>2019</year>; <volume>8</volume>:<fpage>281</fpage>–<lpage>291</lpage>.<pub-id pub-id-type="pmid">30954476</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xi</surname><given-names>N.M.</given-names></string-name>, <string-name><surname>Li</surname><given-names>J.J.</given-names></string-name></person-group><article-title>Benchmarking computational doublet-detection methods for single-cell RNA sequencing data</article-title>. <source>Cell Syst</source>. <year>2021</year>; <volume>12</volume>:<fpage>176</fpage>–<lpage>194</lpage>.<pub-id pub-id-type="pmid">33338399</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T.</given-names></string-name>, <string-name><surname>Butler</surname><given-names>A.</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P.</given-names></string-name>, <string-name><surname>Stoeckius</surname><given-names>M.</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P.</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name>, <string-name><surname>Stuart</surname><given-names>T.</given-names></string-name>, <string-name><surname>Butler</surname><given-names>A.</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P.</given-names></string-name>, <string-name><surname>Hafemeister</surname><given-names>C.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source>. <year>2019</year>; <volume>177</volume>:<fpage>1888</fpage>–<lpage>1902</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liaw</surname><given-names>A.</given-names></string-name>, <string-name><surname>Wiener</surname><given-names>M.</given-names></string-name></person-group><article-title>Classification and regression by randomForest</article-title>. <source>R News</source>. <year>2002</year>; <volume>2</volume>:<fpage>18</fpage>–<lpage>22</lpage>.</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>T.</given-names></string-name>, <string-name><surname>Guestrin</surname><given-names>C.</given-names></string-name></person-group><article-title>XGBoost: a scalable tree boosting system</article-title>. <year>2016</year>; <comment>arXiv doi:</comment><comment>10 June 2016, preprint: not peer reviewed</comment><uri xlink:href="https://arxiv.org/abs/1603.02754">https://arxiv.org/abs/1603.02754</uri>.</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Csardi</surname><given-names>G.</given-names></string-name>, <string-name><surname>Nepusz</surname><given-names>T.</given-names></string-name></person-group><article-title>The igraph software package for complex network research</article-title>. <source>InterJ. Complex Syst</source>. <year>2006</year>; <volume>1695</volume>:<fpage>1696</fpage>.</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramilowski</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Goldberg</surname><given-names>T.</given-names></string-name>, <string-name><surname>Harshbarger</surname><given-names>J.</given-names></string-name>, <string-name><surname>Kloppmann</surname><given-names>E.</given-names></string-name>, <string-name><surname>Lizio</surname><given-names>M.</given-names></string-name>, <string-name><surname>Satagopam</surname><given-names>V.P.</given-names></string-name>, <string-name><surname>Itoh</surname><given-names>M.</given-names></string-name>, <string-name><surname>Kawaji</surname><given-names>H.</given-names></string-name>, <string-name><surname>Carninci</surname><given-names>P.</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A draft network of ligand–receptor-mediated multicellular signalling in human</article-title>. <source>Nat. Commun.</source><year>2015</year>; <volume>6</volume>:<fpage>7866</fpage>.<pub-id pub-id-type="pmid">26198319</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shao</surname><given-names>X.</given-names></string-name>, <string-name><surname>Liao</surname><given-names>J.</given-names></string-name>, <string-name><surname>Li</surname><given-names>C.</given-names></string-name>, <string-name><surname>Lu</surname><given-names>X.</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J.</given-names></string-name>, <string-name><surname>Fan</surname><given-names>X.</given-names></string-name></person-group><article-title>CellTalkDB: a manually curated database of ligand–receptor interactions in humans and mice</article-title>. <source>Brief. Bioinform.</source><year>2021</year>; <volume>22</volume>:<fpage>bbaa269</fpage>.<pub-id pub-id-type="pmid">33147626</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lun</surname><given-names>A.T.L.</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Marioni</surname><given-names>J.C.</given-names></string-name></person-group><article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data with Bioconductor</article-title>. <source>F1000Research</source>. <year>2016</year>; <volume>5</volume>:<fpage>2122</fpage>.<pub-id pub-id-type="pmid">27909575</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bais</surname><given-names>A.S.</given-names></string-name>, <string-name><surname>Kostka</surname><given-names>D.</given-names></string-name></person-group><article-title>scds: computational annotation of doublets in single-cell RNA sequencing data</article-title>. <source>Bioinformatics</source>. <year>2020</year>; <volume>36</volume>:<fpage>1150</fpage>–<lpage>1158</lpage>.<pub-id pub-id-type="pmid">31501871</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bernstein</surname><given-names>N.J.</given-names></string-name>, <string-name><surname>Fong</surname><given-names>N.L.</given-names></string-name>, <string-name><surname>Lam</surname><given-names>I.</given-names></string-name>, <string-name><surname>Roy</surname><given-names>M.A.</given-names></string-name>, <string-name><surname>Hendrickson</surname><given-names>D.G.</given-names></string-name>, <string-name><surname>Kelley</surname><given-names>D.R.</given-names></string-name></person-group><article-title>Solo: doublet identification in single-cell RNA-Seq via semi-supervised deep learning</article-title>. <source>Cell Syst</source>. <year>2020</year>; <volume>11</volume>:<fpage>95</fpage>–<lpage>101</lpage>.<pub-id pub-id-type="pmid">32592658</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McGinnis</surname><given-names>C.S.</given-names></string-name>, <string-name><surname>Murrow</surname><given-names>L.M.</given-names></string-name>, <string-name><surname>Gartner</surname><given-names>Z.J.</given-names></string-name></person-group><article-title>DoubletFinder: doublet detection in single-cell RNA sequencing data using artificial nearest neighbors</article-title>. <source>Cell Syst</source>. <year>2019</year>; <volume>8</volume>:<fpage>329</fpage>–<lpage>337</lpage>.<pub-id pub-id-type="pmid">30954475</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haber</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Biton</surname><given-names>M.</given-names></string-name>, <string-name><surname>Rogel</surname><given-names>N.</given-names></string-name>, <string-name><surname>Herbst</surname><given-names>R.H.</given-names></string-name>, <string-name><surname>Shekhar</surname><given-names>K.</given-names></string-name>, <string-name><surname>Smillie</surname><given-names>C.</given-names></string-name>, <string-name><surname>Burgin</surname><given-names>G.</given-names></string-name>, <string-name><surname>Delorey</surname><given-names>T.M.</given-names></string-name>, <string-name><surname>Howitt</surname><given-names>M.R.</given-names></string-name>, <string-name><surname>Katz</surname><given-names>Y.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A single-cell survey of the small intestinal epithelium</article-title>. <source>Nature</source>. <year>2017</year>; <volume>551</volume>:<fpage>333</fpage>–<lpage>339</lpage>.<pub-id pub-id-type="pmid">29144463</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Travaglini</surname><given-names>K.J.</given-names></string-name>, <string-name><surname>Nabhan</surname><given-names>A.N.</given-names></string-name>, <string-name><surname>Penland</surname><given-names>L.</given-names></string-name>, <string-name><surname>Sinha</surname><given-names>R.</given-names></string-name>, <string-name><surname>Gillich</surname><given-names>A.</given-names></string-name>, <string-name><surname>Sit</surname><given-names>R.V</given-names></string-name>, <string-name><surname>Chang</surname><given-names>S.</given-names></string-name>, <string-name><surname>Conley</surname><given-names>S.D.</given-names></string-name>, <string-name><surname>Mori</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Seita</surname><given-names>J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A molecular cell atlas of the human lung from single-cell RNA sequencing</article-title>. <source>Nature</source>. <year>2020</year>; <volume>587</volume>:<fpage>619</fpage>–<lpage>625</lpage>.<pub-id pub-id-type="pmid">33208946</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Madissoon</surname><given-names>E.</given-names></string-name>, <string-name><surname>Wilbrey-Clark</surname><given-names>A.</given-names></string-name>, <string-name><surname>Miragaia</surname><given-names>R.J.</given-names></string-name>, <string-name><surname>Saeb-Parsy</surname><given-names>K.</given-names></string-name>, <string-name><surname>Mahbubani</surname><given-names>K.T.</given-names></string-name>, <string-name><surname>Georgakopoulos</surname><given-names>N.</given-names></string-name>, <string-name><surname>Harding</surname><given-names>P.</given-names></string-name>, <string-name><surname>Polanski</surname><given-names>K.</given-names></string-name>, <string-name><surname>Huang</surname><given-names>N.</given-names></string-name>, <string-name><surname>Nowicki-Osuch</surname><given-names>K.</given-names></string-name><etal>et al</etal>.</person-group><article-title>scRNA-seq assessment of the human lung, spleen, and esophagus tissue stability after cold preservation</article-title>. <source>Genome Biol</source>. <year>2019</year>; <volume>21</volume>:<fpage>1</fpage>.<pub-id pub-id-type="pmid">31892341</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaum</surname><given-names>N.</given-names></string-name>, <string-name><surname>Karkanias</surname><given-names>J.</given-names></string-name>, <string-name><surname>Neff</surname><given-names>N.F.</given-names></string-name>, <string-name><surname>May</surname><given-names>A.P.</given-names></string-name>, <string-name><surname>Quake</surname><given-names>S.R.</given-names></string-name>, <string-name><surname>Wyss-Coray</surname><given-names>T.</given-names></string-name>, <string-name><surname>Darmanis</surname><given-names>S.</given-names></string-name>, <string-name><surname>Batson</surname><given-names>J.</given-names></string-name>, <string-name><surname>Botvinnik</surname><given-names>O.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>M.B.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>. <source>Nature</source>. <year>2018</year>; <volume>562</volume>:<fpage>367</fpage>–<lpage>372</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>J.</given-names></string-name>, <string-name><surname>Sun</surname><given-names>B.F.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>C.Y.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>J.Y.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y.S.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L.</given-names></string-name>, <string-name><surname>Huang</surname><given-names>D.</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Cui</surname><given-names>G.S.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Single-cell RNA-seq highlights intra-tumoralheterogeneity and malignant progression in pancreatic ductal adenocarcinoma</article-title>. <source>Cell Res.</source><year>2019</year>; <volume>29</volume>:<fpage>725</fpage>–<lpage>738</lpage>.<pub-id pub-id-type="pmid">31273297</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moncada</surname><given-names>R.</given-names></string-name>, <string-name><surname>Barkley</surname><given-names>D.</given-names></string-name>, <string-name><surname>Wagner</surname><given-names>F.</given-names></string-name>, <string-name><surname>Chiodin</surname><given-names>M.</given-names></string-name>, <string-name><surname>Devlin</surname><given-names>J.C.</given-names></string-name>, <string-name><surname>Baron</surname><given-names>M.</given-names></string-name>, <string-name><surname>Hajdu</surname><given-names>C.H.</given-names></string-name>, <string-name><surname>Simeone</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>Yanai</surname><given-names>I.</given-names></string-name></person-group><article-title>Integrating microarray-based spatial transcriptomics and single-cell RNA-seq reveals tissue architecture in pancreatic ductal adenocarcinomas</article-title>. <source>Nat. Biotechnol.</source><year>2020</year>; <volume>38</volume>:<fpage>333</fpage>–<lpage>342</lpage>.<pub-id pub-id-type="pmid">31932730</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ji</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Rubin</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Thrane</surname><given-names>K.</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>S.</given-names></string-name>, <string-name><surname>Reynolds</surname><given-names>D.L.</given-names></string-name>, <string-name><surname>Meyers</surname><given-names>R.M.</given-names></string-name>, <string-name><surname>Guo</surname><given-names>M.G.</given-names></string-name>, <string-name><surname>George</surname><given-names>B.M.</given-names></string-name>, <string-name><surname>Mollbrink</surname><given-names>A.</given-names></string-name>, <string-name><surname>Bergenstråhle</surname><given-names>J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Multimodal Analysis of Composition and Spatial Architecture in Human Squamous Cell Carcinoma</article-title>. <source>Cell</source>. <year>2020</year>; <volume>182</volume>:<fpage>497</fpage>–<lpage>514</lpage>.<pub-id pub-id-type="pmid">32579974</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gehart</surname><given-names>H.</given-names></string-name>, <string-name><surname>Clevers</surname><given-names>H.</given-names></string-name></person-group><article-title>Tales from the crypt: new insights into intestinal stem cells</article-title>. <source>Nat. Rev. Gastroenterol. Hepatol.</source><year>2019</year>; <volume>16</volume>:<fpage>19</fpage>–<lpage>34</lpage>.<pub-id pub-id-type="pmid">30429586</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whitsett</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Kalin</surname><given-names>T.V</given-names></string-name>, <string-name><surname>Xu</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Kalinichenko</surname><given-names>V.V</given-names></string-name></person-group><article-title>Building and regenerating the lung cell by cell</article-title>. <source>Physiol. Rev.</source><year>2018</year>; <volume>99</volume>:<fpage>513</fpage>–<lpage>554</lpage>.</mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>M.</surname><given-names>L.S.</given-names></string-name>, <string-name><surname>Adam</surname><given-names>W.</given-names></string-name>, <string-name><surname>C.</surname><given-names>E.S</given-names></string-name></person-group><article-title>Structure and function of the immune system in the spleen</article-title>. <source>Sci. Immunol.</source><year>2019</year>; <volume>4</volume>:<fpage>eaau6085</fpage>.<pub-id pub-id-type="pmid">30824527</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gunderson</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Kaneda</surname><given-names>M.M.</given-names></string-name>, <string-name><surname>Tsujikawa</surname><given-names>T.</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>A.V</given-names></string-name>, <string-name><surname>Affara</surname><given-names>N.I.</given-names></string-name>, <string-name><surname>Ruffell</surname><given-names>B.</given-names></string-name>, <string-name><surname>Gorjestani</surname><given-names>S.</given-names></string-name>, <string-name><surname>Liudahl</surname><given-names>S.M.</given-names></string-name>, <string-name><surname>Truitt</surname><given-names>M.</given-names></string-name>, <string-name><surname>Olson</surname><given-names>P.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Bruton tyrosine kinase–dependent immune cell cross-talk drives pancreas cancer</article-title>. <source>Cancer Discov</source>. <year>2016</year>; <volume>6</volume>:<fpage>270</fpage>–<lpage>285</lpage>.<pub-id pub-id-type="pmid">26715645</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moncada</surname><given-names>R.</given-names></string-name>, <string-name><surname>Barkley</surname><given-names>D.</given-names></string-name>, <string-name><surname>Wagner</surname><given-names>F.</given-names></string-name>, <string-name><surname>Chiodin</surname><given-names>M.</given-names></string-name>, <string-name><surname>Devlin</surname><given-names>J.C.</given-names></string-name>, <string-name><surname>Baron</surname><given-names>M.</given-names></string-name>, <string-name><surname>Hajdu</surname><given-names>C.H.</given-names></string-name>, <string-name><surname>Simeone</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>Yanai</surname><given-names>I.</given-names></string-name></person-group><article-title>Integrating microarray-based spatial transcriptomics and single-cell RNA-seq reveals tissue architecture in pancreatic ductal adenocarcinomas</article-title>. <source>Nat. Biotechnol.</source><year>2020</year>; <volume>38</volume>:<fpage>333</fpage>–<lpage>342</lpage>.<pub-id pub-id-type="pmid">31932730</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
