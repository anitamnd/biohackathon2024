<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7386246</article-id>
    <article-id pub-id-type="pmid">32552725</article-id>
    <article-id pub-id-type="publisher-id">2052</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-020-02052-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>KAML: improving genomic prediction accuracy of complex traits using machine learning determined parameters</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yin</surname>
          <given-names>Lilin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Haohao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Xiang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yuan</surname>
          <given-names>Xiaohui</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Shuhong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Li</surname>
          <given-names>Xinyun</given-names>
        </name>
        <address>
          <email>xyli@mail.hzau.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9954-1426</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Xiaolei</given-names>
        </name>
        <address>
          <email>xiaoleiliu@mail.hzau.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.35155.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 1790 4137</institution-id><institution>Key Laboratory of Agricultural Animal Genetics, Breeding and Reproduction, Ministry of Education &amp; College of Animal Science and Technology, </institution><institution>Huazhong Agricultural University, </institution></institution-wrap>Wuhan, 430070 Hubei People’s Republic of China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.35155.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 1790 4137</institution-id><institution>Key Laboratory of Swine Genetics and Breeding, Ministry of Agriculture, </institution><institution>Huazhong Agricultural University, </institution></institution-wrap>Wuhan, 430070 Hubei People’s Republic of China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.162110.5</institution-id><institution-id institution-id-type="ISNI">0000 0000 9291 3229</institution-id><institution>School of Computer Science and Technology, </institution><institution>Wuhan University of Technology, </institution></institution-wrap>Wuhan, 430070 China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Department of Biostatistics, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, MI USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Center for Statistical Genetics, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, MI USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>146</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>5</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Advances in high-throughput sequencing technologies have reduced the cost of genotyping dramatically and led to genomic prediction being widely used in animal and plant breeding, and increasingly in human genetics. Inspired by the efficient computing of linear mixed model and the accurate prediction of Bayesian methods, we propose a machine learning-based method incorporating cross-validation, multiple regression, grid search, and bisection algorithms named KAML that aims to combine the advantages of prediction accuracy with computing efficiency. KAML exhibits higher prediction accuracy than existing methods, and it is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/YinLiLin/KAML">https://github.com/YinLiLin/KAML</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>31702087, 31672391, 31701144</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Key project of the National Natural Science Foundation of China</institution>
        </funding-source>
        <award-id>31790414</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Swine Industry Technology System</institution>
        </funding-source>
        <award-id>CARS-35</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">In the past decade, genome-wide association studies (GWAS) have provided unprecedented insights into the genetic mechanisms of complex traits [<xref ref-type="bibr" rid="CR1">1</xref>]. With the advances of high-throughput sequencing technologies, the increasing availability of genetic data from existing association studies has led to a growing interest in the selection of traits in livestock and plants, as well as the prediction of disease susceptibility in humans. Over the past 10 years, genomic selection has been applied to several major livestock species and has more than doubled genetic progress in some; it has become an essential tool for livestock breeding programs [<xref ref-type="bibr" rid="CR2">2</xref>]. For plant breeding, genomic selection is anticipated to facilitate commercialization of improved genotypes at shorter intervals of time than phenotypic selection. For example, the selection cycle for palm oil breeding has been reduced from 19 to 6 years [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. In humans, genomic prediction for risk of diseases could be utilized to evaluate the effectiveness of disease prevention strategies tailored according to the individual level of projected risk. It is, therefore, no surprise that genomic prediction for risk of diseases will be one of the key tools in the health care of humans in the near future [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par3">A commonly used model is known as linear mixed model (LMM), commonly implemented as genomic best linear unbiased prediction (GBLUP), which involves solving mixed model equations (MME) that incorporate the inverse of a genomic similarity matrix, in order to obtain predictions of the corresponding random effect. Its simplest form assumes that all single nucleotide polymorphisms (SNPs) contribute to the heritability of traits, in that all SNPs come from the same one normal distribution [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. However, this can limit the prediction accuracy of LMM, especially in cases where a trait is controlled by several major genes. To better fit those large effects, alternative Bayesian framework-based methods have been proposed, which include BayesA, BayesB, BayesLASSO, etc. [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. These methods allow different SNPs to have their own independent variances that follow a specific distribution (e.g., the inverse chi-square distribution). Furthermore, these Bayesian models may assign the SNPs into a mixture of different groups where each group comes from the same normal distribution, which reduces the computational complexity of the model by decreasing the number of parameters to be estimated. For example, BSLMM assumes a mixture of two normal distributions, which allows an additional variance for a subset of SNPs compared with LMM [<xref ref-type="bibr" rid="CR11">11</xref>]. BayesR assumes a three-component normal mixture together with a group of zero variance [<xref ref-type="bibr" rid="CR12">12</xref>], which accommodates SNPs with large, medium, small, or no effect. A Bayesian non-parametric model, named Dirichlet process regression (DPR), assigns SNPs into more groups with an assumption of a <italic>x</italic>-component normal mixture where <italic>x</italic> refers to an unlimited number; however, it showed no significant increase in prediction accuracy compared with BayesR [<xref ref-type="bibr" rid="CR13">13</xref>]. Typically, the unknown parameters of Bayesian models are estimated and optimized by a Markov Chain Monte Carlo (MCMC) procedure. Although the prediction accuracy of Bayesian methods outperforms LMM in the majority of cases [<xref ref-type="bibr" rid="CR14">14</xref>], the substantial computational burden of the MCMC procedure means analyses take a long time, and also, it can be difficult to choose the right model for any given trait whose genetic architecture could never be known in practice.</p>
    <p id="Par4">Computational efficiency is an important requirement for the application of genomic selection and genomic prediction (GS/GP) in practice, which often precludes the application of Bayesian methods, and has led to LMM becoming one of the most widely used of the GS/GP methods. Moreover, including the most significant SNPs or the verified QTLs as covariates in the LMM improved the prediction accuracy [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], but the phenotypic variance explained (PVE) by those SNPs or QTLs was limited and false positive associations cannot be avoided. Many researchers have attempted to weight the SNPs to construct a trait-specific genomic relationship matrix (Kinship), such that the optimized random effect enables LMM to be as accurate as Bayesian methods [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref>]. However, any noisy SNP may dilute the effects of causal SNPs in only one random effect.</p>
    <p id="Par5">More recently, a LMM methodology that incorporated multiple random effects was proposed. SNPs can be classified into groups using GWAS results or biological information, such as the annotation of SNPs, which include coding, intronic, and intergenic, leading to the simultaneous fitting of separate random effects derived from each of the different groups of SNPs. The LMM with multiple random effects improved the prediction accuracy when the effect size variances differed markedly across the groups [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. However, the SNPs within each group still contribute equally to each random effect, which potentially limits the prediction accuracy. The principle of SNP classification was too uncontrollable to achieve stable performance among different species [<xref ref-type="bibr" rid="CR13">13</xref>]. In addition, the efficient and accurate estimation of variance components of many random effects typically represents a significant challenge.</p>
    <p id="Par6">Inspired by the high prediction accuracy of a SNP-weighted strategy and efficient calculation of LMM, here, we present a Kinship-adjusted-multiple-loci (KAML) linear mixed model, which is a flexible modeling framework that generalizes the LMM to accommodate traits with various types of genetic architectures by incorporating pseudo quantitative trait nucleotides (QTNs) as covariates and a SNP-weighted trait-specific Kinship as the variance-covariance assumption corresponding to the random effect term. The selection of pseudo QTNs and SNP weights are optimized by a machine learning procedure combining cross-validation, multiple regression, grid search, and bisection algorithms. Similar to the regular LMM, KAML fits a single random effect and maintains the computing efficiency. Differently, KAML picks up the SNPs with big effects as covariates and simultaneously gives larger weights to SNPs with moderate effects and smaller weights to SNPs with little or no effects as it constructs the Kinship matrix.</p>
    <p id="Par7">We first applied KAML to the seven human diseases that comprise the Wellcome Trust Case Control Consortium (2007) (WTCCC1). Compared with LMM, BSLMM [<xref ref-type="bibr" rid="CR11">11</xref>], and BayesR [<xref ref-type="bibr" rid="CR12">12</xref>], KAML performed similarly to the Bayesian methods and significantly outperformed LMM for most of diseases in terms of the prediction accuracy. Taking advantage of parallel computation, the running time of KAML was several orders of magnitude faster than that of BSLMM or BayesR. Afterwards, we evaluated the stability of all the methods mentioned above using data from real cattle, horse, and maize experiments. The results indicated that KAML was the most stable method in terms of the prediction accuracy. Finally, we demonstrated that KAML still performed well when it was assigned prior to calculated model parameters, and this made KAML as efficient as regular LMM, while generating significantly higher prediction accuracy.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par8">We evaluated KAML using both simulated and real datasets. To assess the prediction accuracy, each dataset was repeatedly split randomly into a reference sample that contained 80% of individuals and a validation sample that contained the remaining 20%. This procedure was repeated 20 times to evaluate the performance of accuracy and stability, but we ensured that the validation sample remained the same for all methods that were compared. The prediction accuracy was quantified with Pearson’s correlation coefficient or AUROC (area under the receiver operator characteristic curve) for continuous traits or binary traits, respectively [<xref ref-type="bibr" rid="CR22">22</xref>].</p>
    <p id="Par9">The methods that we compared with KAML included (1) the linear mixed model (LMM) referred to as GBLUP, where all SNPs were assumed to contribute equally to the Kinship matrix [<xref ref-type="bibr" rid="CR23">23</xref>]; (2) Bayesian sparse linear mixed models (BSLMM), which assumed the effects of SNPs followed a mixture of two normal distributions, one with a smaller variance and one with a larger variance, which combined the advantages of both regular LMMs and sparse regression modeling [<xref ref-type="bibr" rid="CR11">11</xref>]; and (3) BayesR, which assumed that the SNP effects followed a mixture of four zero mean normal distributions with a fixed variance for each mixture component, was flexibly adapted to traits underlying various types of genetic architectures [<xref ref-type="bibr" rid="CR12">12</xref>]. Note that both BSLMM and BayesR have been demonstrated recently to outperform a range of existing prediction methods; thus, we did not exhaustively include other prediction methods into comparison in our study [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
    <p id="Par10">For quantifying computing efficiency, we did not personally adjust the settings of all methods and we simply used the defaults. The number of total/burn-in MCMC iterations was 1000,000/100,000 and 50,000/20,000 for BSLMM and BayesR, respectively. The parameter optimization procedure of KAML was sped up using parallel computing, and the computational resources were assigned automatically according to the number of real-time computational tasks, such as the number of SNPs to be tested, population size, and the cross-validation number for optimizing the unknown parameters of KAML. Therefore, the number of threads that was used for speeding up KAML was not constant but varied from 1 to 132 on our server. The computing efficiency of KAML was tested on the Microsoft R Open (MRO, <ext-link ext-link-type="uri" xlink:href="https://mran.microsoft.com/open">https://mran.microsoft.com/open</ext-link>) platform instead of the base R (<ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">https://www.r-project.org/</ext-link>), and multi-threads were assigned automatically to speed up the mathematical calculations by Intel Math Kernel Library (Intel MKL), which included matrix multiply/inverse and matrix decomposition. The computation time results provided a rough guide to the relative computational burden of different methods.</p>
    <sec id="Sec3">
      <title>Simulation studies</title>
      <p id="Par11">First, we demonstrated the flexibility of KAML compared with a regular LMM. To be as realistic as possible, we simulated phenotypes of three scenarios in heritabilities of 0.2, 0.5, and 0.8 with different groups of SNPs corresponding to various genetic architectures that used the genotypes of the WTCCC1 dataset. Phenotypes were simulated by adding the additive genetic effect values and residual effect values as described in previous studies [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref>]. We considered three scenarios of genetic architectures for simulating the additive genetic effects: (1) a large group of 10,000 SNPs with small effects that followed a normal distribution with a mean value of 0 and a variance of 0.005, representing the “polygenic component”; (2) in addition to the polygenic architecture in scenario 1, we added a small group of 10 SNPs with large or moderate effects that followed a normal distribution with a mean value of 0 and a variance of 0.1, representing the “pseudo QTNs <italic>(pQ)</italic>”, where the “polygenic component” and “<italic>pQ</italic>” contributed equally to the genetic variance; and (3) only “<italic>pQ</italic>” in scenario 2 was simulated, which represented the “major genes.” For each combination of heritability and scenario, 20% random selected phenotypes were marked as missing and treated as the validation dataset. The Pearson correlation coefficients between the additive genetic values and predicted values in the validation dataset were calculated, and the mean values of 100 replicates were used to quantify the prediction accuracy.</p>
      <p id="Par12">Figure <xref rid="Fig1" ref-type="fig">1</xref>a shows the achieved models of KAML that can be applied to various types of qualitative or quantitative traits that underlie different genetic architectures. A total of five types of models can be switched flexibly in KAML: (1) regular LMM (<italic>K</italic><sub><italic>s</italic></sub>), (2) LMM with SNP-weighted Kinship (<italic>K</italic><sub><italic>w</italic></sub>), (3) LMM with pseudo QTNs as covariates and standard Kinship (<italic>pQ+K</italic><sub><italic>s</italic></sub>), (4) LMM with pseudo QTNs as covariates and SNP-weighted Kinship (<italic>pQ+K</italic><sub><italic>w</italic></sub>), or (5) linear model with pseudo QTNs as covariates (<italic>pQ</italic>). Figure <xref rid="Fig1" ref-type="fig">1</xref>b summarizes the prediction accuracy performances of LMM and KAML (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). For scenario 1, the two methods performed similarly with respect to the prediction accuracy, and as we expected, 89%, 69%, and 67% of the KAML models switched to “<italic>K</italic><sub><italic>s</italic></sub>” for the heritability of 0.2, 0.5, and 0.8, respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2), indicating that the hypothesis of LMM was suitable for polygenic traits. Although KAML tended to select the “<italic>pQ+K</italic>” model with an increase in heritability, it made no meaningful difference to the prediction accuracy due to the low proportion of phenotypic variance that was explained by the selected pseudo QTNs. Compared with scenario 1, a small number of SNPs were simulated with large or moderate effects in scenario 2, but the performance of LMM was not improved with the increased number of genetic variants with large effects; accordingly and impressively, there was a significant improvement for KAML when either fitting the optimized pseudo QTNs as covariates or a SNP-weighted Kinship as random effect term, indicating that the strategy of KAML worked correctly. For scenario 3, KAML was far superior to LMM and the results showed that 98%, 96%, and 89% of the models in KAML switched to “<italic>pQ</italic>” for the heritability of 0.2, 0.5, and 0.8, respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2).
<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>a</bold> Summary of the achieved models in KAML. Five types of models could be flexibly switched to fit the hypotheses of various types of traits underlying different genetic architectures. The <bold><italic>pQ</italic></bold> is the pseudo QTNs, <bold><italic>K</italic></bold><sub><bold><italic>s</italic></bold></sub> is the standard Kinship, and <bold><italic>K</italic></bold><sub><bold><italic>w</italic></bold></sub> is the SNP-weighted Kinship. <bold>b</bold> The prediction accuracy performances of LMM and KAML on simulated traits. The <italic>x</italic>-axis indexes the simulation scenarios on different levels of heritabilities. The <italic>y</italic>-axis indexes the Pearson correlation coefficients between predicted values and additive genetic effects values in the 20% randomly selected validation dataset for LMM (colored in red) and KAML (colored in blue) across 100 replicates. For each box, the middle line (colored in black) represents the average value, the bottom and top represent the standard deviation, and the top and bottom whiskers represent the maximum and minimum values, respectively</p></caption><graphic xlink:href="13059_2020_2052_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par13">To verify its performance, we next compared KAML with GBLUP, BSLMM, and BayesR for three complex traits in three scenarios with heritabilities of 0.2, 0.5, and 0.8, respectively. We simulated the additive genetic effects of the traits that were controlled by 10 SNPs with large effects that were distributed as <italic>N</italic>(0, 0.1), 1000 SNPs with moderate effects that were distributed as <italic>N</italic>(0, 0.01), and 10,000 SNPs with polygenic effects that followed a normal distribution with a mean value of 0 and a variance of 0.005. We implemented the experiments on chromosome 1 of the WTCCC1 dataset with 20 replicates for each scenario [<xref ref-type="bibr" rid="CR27">27</xref>], and the predictive accuracies are reported in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3 of the supplementary materials. We found that KAML significantly outperformed LMM for all scenarios and performed slightly better than Bayesian models. Furthermore, we evaluated the methods above using a public dataset that was simulated as part of the 16th QTL-MAS Workshop (<ext-link ext-link-type="uri" xlink:href="http://qtl-mas-2012.kassiopeagroup.com/en/dataset.php">http://qtl-mas-2012.kassiopeagroup.com/en/dataset.php</ext-link>) [<xref ref-type="bibr" rid="CR28">28</xref>], and this data has been used widely in comparisons of the performance of alternative methods [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. The dataset included 1000 reference individuals in each of the first three generations and 1000 validation individuals in generation four. The genotype data had five chromosomes, and each chromosome was simulated with 2000 SNPs. Three traits were simulated and, for each trait, 50 SNPs were randomly selected as QTLs, while their effects followed a gamma distribution (shape parameter = 0.42, scale parameter = 5.4) [<xref ref-type="bibr" rid="CR19">19</xref>]. The additive genetic effect values for all 4000 individuals were used to assess the prediction accuracy. The results in Table <xref rid="Tab1" ref-type="table">1</xref> demonstrate the performance of the four methods in terms of prediction accuracy and computing time. For all traits, LMM generated the lowest prediction accuracies compared with the other methods. KAML performed slightly better than BSLMM and BayesR, and the final confirmed models of KAML were all of the form “<italic>pQ+Kw</italic>,” consistent with the simulated genetic architectures. Taking advantage of the parallelized computation, KAML was hundreds of times faster than BSLMM or BayesR.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Prediction performance in simulated public dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Traits/COR<sup><bold>a</bold></sup> (time in h)<sup><bold>b</bold></sup></th><th colspan="4">Methods</th></tr><tr><th>LMM</th><th>BSLMM</th><th>BayesR</th><th>KAML</th></tr></thead><tbody><tr><td><bold>T1</bold></td><td>0.732 (0.002)</td><td>0.791 (3.875)</td><td>0.795 (0.782)</td><td><bold>0.801</bold> (0.038)</td></tr><tr><td><bold>T2</bold></td><td>0.771 (0.002)</td><td>0.831 (4.483)</td><td>0.832 (0.714)</td><td><bold>0.843</bold> (0.043)</td></tr><tr><td><bold>T3</bold></td><td>0.758 (0.002)</td><td>0.827 (4.721)</td><td>0.832 (0.740)</td><td><bold>0.832</bold> (0.039)</td></tr><tr><td>Average</td><td>0.754</td><td>0.816</td><td>0.820</td><td>0.825</td></tr></tbody></table><table-wrap-foot><p>COR<sup>a</sup>: The Pearson correlation coefficient between predicted values and additive genetic effects values. The reference dataset included 3000 individuals and 1000 validation individuals</p><p>(Time in h)<sup>b</sup>: The computing time is recorded in hours</p></table-wrap-foot></table-wrap></p>
      <p id="Par14">By choosing the most appropriate prediction model, pseudo QTNs, and optimizing a SNP-weighted Kinship in a cross-validation process, KAML had the potential to change the model hypothesis according to the data feature automatically, and it can be adapted to a wide range of traits underlying various types of genetic architectures. Furthermore, KAML could significantly shorten the computational effort without sacrificing prediction accuracy. In practice, we will never know the real genetic architecture in advance, which makes the stable performance of KAML very appealing.</p>
    </sec>
    <sec id="Sec4">
      <title>WTCCC1 data</title>
      <p id="Par15">In addition to the simulated data, KAML was also evaluated using the real published data from human, cattle, horse, and maize experiments. We firstly assessed the performance of KAML for seven disease traits from the Wellcome Trust Case Control Consortium (WTCCC1, <ext-link ext-link-type="uri" xlink:href="https://www.wtccc.org.uk/">https://www.wtccc.org.uk/</ext-link>) [<xref ref-type="bibr" rid="CR31">31</xref>]. When comparing the performance of methods on binary disease traits (cases 1, controls 0), we treated the phenotypic records as continuous variables following previous studies [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR32">32</xref>], and the predicted values were then considered to be the probability of being the case. The WTCCC1 dataset included about 1400 cases and 2938 shared controls, and all individuals were genotyped for about 450,000 SNPs. The seven diseases were bipolar disorder (BD), coronary artery disease (CAD), Crohn’s disease (CD), hypertension (HT), rheumatoid arthritis (RA), type 1 diabetes (T1D), and type 2 diabetes (T2D).</p>
      <p id="Par16">The information from the GWAS results was used to select the pseudo QTNs and to optimize the SNP weights in KAML. Various statistical models have been utilized to detect the trait-associated SNPs [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>], and results varied in different datasets. The rank and the significance of SNPs in the results obtained by different statistical models may potentially affect the processes of selecting pseudo QTNs and optimizing Kinship in KAML. Therefore, we compared the prediction accuracy of KAML when using a general linear model (GLM) or a mixed linear model (MLM) for the GWAS procedure; the Manhattan plot from GLM can be found at Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1. Benefiting from the combination strategies of grid search, bisection method, and cross-validation, we found that there was no significant difference between those two association test models in any of the WTCCC1 datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). Consequently, we recommended the GLM because it generated similar prediction accuracy, but ran much faster than MLM. In addition, we obtained a slight improvement in prediction accuracy when we increased the number of cross-validation replicates, but this resulted in an increased computational burden (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). It is often necessary to balance prediction accuracy performance and computational efficiency accordingly.</p>
      <p id="Par17">We next compared the prediction accuracy performance of KAML with that of LMM, BSLMM, and BayesR. Table <xref rid="Tab2" ref-type="table">2</xref> reports the prediction accuracy performances of those models using WTCCC1 datasets. Here, we conducted KAML using GLM and a 4*5 cross-validation procedure (5-fold cross-validation repeated four times) to estimate the unknown parameters for traits. We found that KAML performed as well as BSLMM and BayesR for all diseases, and it outperformed LMM for most diseases, which was consistent with the simulation. In particular, KAML outperformed BSLMM and BayesR for three diseases (CD, RA, and T1D) where a small number of relatively strong associations were identified in the original study [<xref ref-type="bibr" rid="CR31">31</xref>]. Moreover, KAML, BSLMM, and BayesR performed slightly worse than LMM for HT and BD, as we expected, and no pseudo QTNs were selected as covariates in KAML for those two diseases (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7), which indicated that both traits were polygenic, and all markers contributed very little to the traits and matched the marker effect size distribution hypothesis of LMM, which was consistent with the situation that no significant associations were detected (Supplemental Fig. 1). However, we noted that none of the methods could be competitive for all traits, since the genetic architecture was more complex than implied by the models [<xref ref-type="bibr" rid="CR35">35</xref>].
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of prediction accuracy performances of LMM, BSLMM, BayesR, and KAML by using seven case/control diseases in the WTCCC1 dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Traits/AUROC</th><th colspan="4">Methods</th></tr><tr><th>LMM</th><th>BSLMM</th><th>BayesR</th><th>KAML</th></tr></thead><tbody><tr><td><bold>CAD</bold></td><td>0.586 (0.0043)</td><td>0.599 (0.0041)</td><td><bold>0.602 (0.0039)</bold></td><td>0.600 (0.0041)</td></tr><tr><td><bold>HT</bold></td><td><bold>0.597 (0.0038)</bold></td><td>0.596 (0.0038)</td><td>0.596 (0.0041)</td><td>0.594 (0.0038)</td></tr><tr><td><bold>T2D</bold></td><td>0.600 (0.0032)</td><td>0.618 (0.0032)</td><td><bold>0.620 (0.0034)</bold></td><td>0.618 (0.0031)</td></tr><tr><td><bold>BD</bold></td><td>0.641 (0.0033)</td><td>0.641 (0.0034)</td><td><bold>0.647 (0.0033)</bold></td><td>0.638 (0.0035)</td></tr><tr><td><bold>CD</bold></td><td>0.628 (0.0039)</td><td>0.669 (0.0041)</td><td>0.668 (0.0046)</td><td><bold>0.669 (0.0039)</bold></td></tr><tr><td><bold>RA</bold></td><td>0.614 (0.0034)</td><td>0.704 (0.0032)</td><td>0.708 (0.0033)</td><td><bold>0.717 (0.0037)</bold></td></tr><tr><td><bold>T1D</bold></td><td>0.646 (0.0045)</td><td>0.858 (0.0019)</td><td>0.861 (0.0018)</td><td><bold>0.862 (0.0019)</bold></td></tr><tr><td>Average</td><td>0.616</td><td>0.669</td><td>0.672</td><td>0.671</td></tr></tbody></table><table-wrap-foot><p>Prediction accuracy performance was measured by the area under the ROC curve (AUROC). For prediction assessment, total samples were split to two subsets: 80% of the samples were used as the reference dataset and 20% were used as the validation dataset; the procedure was repeated 20 times; and the mean AUROC values and standard deviations of each trait are shown in the table</p></table-wrap-foot></table-wrap></p>
      <p id="Par18">Table <xref rid="Tab3" ref-type="table">3</xref> reports the average computing time of LMM, BSLMM, BayesR, and KAML in hours. LMM was the most efficient model due to its simple hypothesis for all traits. Benefiting from the parallel computing design, KAML was computationally very efficient, and the computing time was several orders of magnitude lower than BSLMM and BayesR. The computing time for both BSLMM and BayesR varied with the complexity of the architectures of traits, polygenic traits required much more time to reach convergence. Because only two groups of SNP effects were assumed in BSLMM instead of four in BayesR, as well as an improved parameter sampling strategy for fast convergence, BSLMM was faster than BayesR for most of the traits.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>The computing performance tests of LMM, BSLMM, BayesR, and KAML methods by using the WTCCC1 dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Traits/time (hours)</th><th colspan="4">Methods</th></tr><tr><th>LMM</th><th>BSLMM</th><th>BayesR</th><th>KAML</th></tr></thead><tbody><tr><td><bold>CAD</bold></td><td>0.01 (0.00)</td><td>13.78 (2.55)</td><td>44.93 (2.45)</td><td>0.30 (0.01)</td></tr><tr><td><bold>HT</bold></td><td>0.01 (0.00)</td><td>27.15 (5.25)</td><td>42.83 (2.46)</td><td>0.32 (0.02)</td></tr><tr><td><bold>T2D</bold></td><td>0.01 (0.00)</td><td>38.11 (6.15)</td><td>45.85 (2.17)</td><td>0.32 (0.01)</td></tr><tr><td><bold>BD</bold></td><td>0.01 (0.00)</td><td>23.5 (6.26)</td><td>40.21 (2.26)</td><td>0.35 (0.03)</td></tr><tr><td><bold>CD</bold></td><td>0.01 (0.00)</td><td>56.55 (5.02)</td><td>32.87 (0.80)</td><td>0.35 (0.01)</td></tr><tr><td><bold>RA</bold></td><td>0.01 (0.00)</td><td>3.85 (0.27)</td><td>33.22 (0.78)</td><td>0.40 (0.00)</td></tr><tr><td><bold>T1D</bold></td><td>0.01 (0.00)</td><td>5.98 (0.27)</td><td>34.23 (1.02)</td><td>0.4 (0.00)</td></tr><tr><td>Average</td><td>0.01</td><td>24.13</td><td>39.16</td><td>0.35</td></tr></tbody></table><table-wrap-foot><p>Computing performance tests were conducted in a Red Hat Enterprise Linux sever with 2.20 GHz Intel(R) Xeon(R) 132 CPUs E7-8880 v4, and 2 TB memory. The computing time records and the standard deviations are described in Table <xref rid="Tab2" ref-type="table">2</xref>. The computing performances of BSLMM and BayesR methods were tested using their default settings</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec5">
      <title>Cattle/horse/maize</title>
      <p id="Par19">In addition to the WTCCC1 dataset, we assessed the prediction accuracy performance of LMM, BSLMM, BayesR, and KAML using datasets of multiple species, including animal (cattle and horse) and plant (maize) populations. Details about the population size and available SNPs were described in the Data Quality Control section. Seven traits were used for performance tests: four of which were quantitative traits, including milk fat percentage (mfp), milk yield (my), somatic cell score (scs), and growing degree days (gdd), and three were qualitative traits, including coat color, yellow or white kernels (ywk), and sweet or starchy kernels (ssk). Considering the situation that inbreeding may increase false positive associations in GWAS due to cryptic relationships among individuals (e.g., a population includes a parent with a large number of progenies in the population [<xref ref-type="bibr" rid="CR36">36</xref>]), the GWAS model was switched to MLM in KAML for animal and plant datasets, and a 1*5 cross-validation procedure was used to reduce computational effort. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the prediction accuracy performances of the four models (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparison of prediction accuracy performances of LMM (red), BSLMM (yellow), BayesR (violet), and KAML (blue) in cattle, horse, and maize datasets. The prediction accuracy performance of each method was measured by the correlation method, which is the average Pearson correlation between predicted values and phenotypic values of 20 replicates in the validation subset. In each replicate, the dataset was randomly split into a reference subset containing 80% of individuals and a validation subset containing the remaining 20%. For each boxplot, the middle line represents the average value, the bottom and top are the standard deviation, and the upper and lower ends of each box represent the maximum and minimum, respectively</p></caption><graphic xlink:href="13059_2020_2052_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par20">For the cattle data, BayesR outperformed the other methods for traits mfp and my, while KAML performed best for trait scs. For the horse data, as the provided phenotype from the publishers were already coded as 1, 2, 3, and 4 for corresponding colors believed to result from three known coat color loci that included <italic>MC1R</italic> (chestnut), <italic>STX17</italic> (gray), and <italic>ASIP</italic> (agouti, black/bay) [<xref ref-type="bibr" rid="CR37">37</xref>], we used the original phenotype as a continuous trait to run all software directly to make fair comparisons. From the results, we found that both KAML and BSLMM performed better than BayesR, and most of the selected models in KAML were “<italic>pQ</italic>” (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7), suggesting that the coat color was influenced by a small number of SNPs with large effects, which mismatched the hypotheses of the four marker effect distributions of BayesR, and this maybe a reason that BayesR took a long time to reach MCMC convergence and performed much slower than BSLMM for this trait (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). For maize data, KAML performed the best among the four methods. Strangely, BayesR performed abnormally for traits ywk and ssk when using the default number of MCMC iterations.
<fig id="Fig3"><label>Fig. 3</label><caption><p>The comparison of computing performances (in seconds) of LMM (red), BSLMM (yellow), BayesR (violet), and KAML (blue) for cattle, horse, and maize datasets. The <italic>y</italic>-axis represents the computing time in log<sub>10</sub> scale. Computing performance tests were performed in a Red Hat Enterprise Linux sever with 2.20 GHz Intel(R) Xeon(R) 132CPUs E7-8880 v4, and 2 TB memory. The computing time records are corresponding to the experiments described in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The computing performances of BSLMM and BayesR methods were tested using their default settings</p></caption><graphic xlink:href="13059_2020_2052_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par21">Our previous study showed that when the marker density was increased, MCMC-based methods required more iterations to reach convergence and to obtain reliable prediction values. In order to figure out the problem, we designed a series of gradients of total iteration numbers to track trends in predictive performance. As shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2, when the total number of iterations reached 200,000, BayesR tended to perform as accurately as BSLMM, suggesting that BayesR required more MCMC iterations for the traits ywk and ssk. On the contrary, BSLMM performed well at a low number of MCMC steps. For these three traits, the performance declined continuously for BSLMM with an increase in total iteration number, that because BSLMM is the combination of the LMM and BVSR [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>], and the MCMC procedure of BSLMM for estimating the unknown parameters started at the values derived from LMM, so its performance was similar to LMM when the total MCMC iteration number was small, the dropped accuracy is caused by the mismatch of genetic architecture between the hypothesis and the analyzed traits. Therefore, it is a challenge for MCMC-based methods to determine the appropriate number of total MCMC iterations to ensure an accurate and stable prediction performance for traits with unknown genetic architectures. On the whole, KAML performed stably for all traits of multiple species, indicating that the hypothesis of KAML had the potential to be adapted to a wide range of genetic architectures. Additionally, KAML was roughly 100–300 times faster than BSLMM or BayesR (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6). Moreover, KAML could be accelerated by more computing resources.</p>
    </sec>
    <sec id="Sec6">
      <title>Predicting with pre-optimized parameters for KAML</title>
      <p id="Par22">The most time-consuming part of KMAL is for the estimation of variance components in the cross-validation procedure. Although the procedure can be sped up by parallel computation, it is still a challenge when dealing with big datasets with limited computational resources. In fact, it is not necessary for KAML to re-optimize the weights of markers repeatedly for the same trait when the dataset reaches a “sufficient” size, since the contributions of common SNPs could be captured easily without a very large population [<xref ref-type="bibr" rid="CR23">23</xref>]. To verify this assumption, we implemented a further experiment using all the datasets mentioned above on KAML and compared its prediction performance with LMM. We randomly selected half of the total individuals only once, and then we ran KAML to obtain all model parameters (<italic>model type</italic>, <italic>pseudo QTNs</italic>, <italic>α</italic>, and <italic>β</italic>, for details, see the “<xref rid="Sec9" ref-type="sec">Methods</xref>” section) by a default setting of KAML for each trait. Then the optimized parameters were directly used in KAML to evaluate the prediction accuracy performance using the same replicates above. Note that an extra GWAS within reference subset for each replicate needed to be done to calculate the Kinship matrix with the known <italic>α</italic> and <italic>β</italic>, but the time-consuming cross-validation procedure was excluded. Compared with optimizing the unknown parameters adaptively every time, this saved a great deal of time.</p>
      <p id="Par23">Figure <xref rid="Fig4" ref-type="fig">4</xref> reports the predictive performances of LMM and KAML (<bold><italic>Half</italic></bold>, <bold><italic>Adaptive</italic></bold>). We found that the <bold><italic>Half</italic></bold> performed even better than <bold><italic>Adaptive</italic></bold> in some traits (coat color, ywk) but performed similarly in most cases (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8). It was quite clear that both <bold><italic>Half</italic></bold> and <bold><italic>Adaptive</italic></bold> performed significantly better than LMM. This result indicated that it was not necessary to re-optimize the unknown parameters for KAML when the population size was increased slightly. Especially in animal breeding, the unknown parameters of KAML could be renewed weekly or even annually, which makes the computational complexity of KAML closer to LMM and could save much time in practice (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S9).
<fig id="Fig4"><label>Fig. 4</label><caption><p>The comparison of prediction accuracy performances of LMM and KAML. The performance was measured by the AUROC and Pearson correlation for the datasets of human and other species, respectively. <bold><italic>Half</italic></bold> represents that KAML randomly selected only half of the total individuals to optimize the model parameters; <bold><italic>Adaptive</italic></bold> represents running KAML on the entire dataset, and the parameters were optimized for each replicate. For each boxplot, the middle line represents the average value, the bottom and top are the standard deviation, and the upper and lower ends of each box represent the maximum and minimum, respectively</p></caption><graphic xlink:href="13059_2020_2052_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Predicting by integrating KAML into SSBLUP</title>
      <p id="Par24">It is always difficult to genotype all individuals with phenotypic records for a large population. Therefore, a single-step BLUP (SSBLUP) [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR41">41</xref>] method was developed to utilize the pedigree information, genotype information, and phenotype information simultaneously to estimate individual genetic values. It has become the most widely used model in livestock breeding programs due to its high predictive performance [<xref ref-type="bibr" rid="CR42">42</xref>]. The SNP-weighted Kinship matrix from KAML can be directly integrated with SSBLUP to construct a trait-specific mixture relationship matrix for all available individuals. Using the simulated data in the 16th QTL-MAS Workshop, which contained pedigree information, we compared the prediction accuracy performances of PBLUP (with the relationship matrix derived from pedigree information only), LMM (with the relationship matrix derived from genotype information only), SSBLUP (with the relationship matrix derived from information of both pedigree and genotype), KAML (with SNP-weighted Kinship matrix derived from genotype information only and incorporating the <italic>pQs</italic> as covariates), and SSKAML (with weighted Kinship matrix derived from information of both pedigree and genotype) methods. The comparative results are shown in Table <xref rid="Tab4" ref-type="table">4</xref> and indicated that the SSKAML outperformed SSBLUP and LMM methods for both non-genotyped and genotyped individuals. It was noted that the KAML outperformed SSKAML for the genotyped individuals in terms of prediction accuracy; one potential reason was that the <italic>pQs</italic> were incorporated as covariates in the KAML model, which is unachievable for SSKAML due to the absence of genotypes for non-genotyped individuals. The results highlighted the potential of KAML in the application of genomic selection.
<table-wrap id="Tab4"><label>Table 4</label><caption><p>The comparison of prediction performances on the 16th QTL-MAS Workshop dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Traits/accuracy</th><th colspan="3">Non-genotyped (<bold><italic>n</italic></bold> = 100)</th><th colspan="5">Genotyped (<bold><italic>n</italic></bold> = 1000)</th></tr><tr><th>PBLUP</th><th>SSBLUP</th><th>SSKAML</th><th>PBLUP</th><th>LMM</th><th>SSBLUP</th><th>KAML</th><th>SSKAML</th></tr></thead><tbody><tr><td>T1</td><td>0.7823</td><td>0.8648</td><td>0.8819</td><td>0.4549</td><td>0.7317</td><td>0.7322</td><td>0.8011</td><td>0.7969</td></tr><tr><td>T2</td><td>0.7954</td><td>0.8726</td><td>0.8901</td><td>0.5331</td><td>0.7708</td><td>0.7707</td><td>0.8433</td><td>0.8378</td></tr><tr><td>T3</td><td>0.7401</td><td>0.8238</td><td>0.8418</td><td>0.4704</td><td>0.7581</td><td>0.7579</td><td>0.8324</td><td>0.8262</td></tr></tbody></table><table-wrap-foot><p>P<italic>BLUP</italic> pedigree information-based BLUP method, <italic>LMM</italic> genomic information-based BLUP method, <italic>SSBLUP</italic> single-step BLUP method. For SSBLUP, the weight of pedigree-based relationship matrix for genotyped individuals was 0.05. The diagonal and off-diagonal of both pedigree and genomic relationship matrices were adjusted to the same scale</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion and conclusion</title>
    <p id="Par25">Because of the flexible hypotheses, Bayesian methods are well known for their high predictive accuracy. A large number of unknown parameters, including thousands or even millions of marker effects, should be estimated. The complex posterior distributions and computational complexity of traditional multiple integrals limited the implementation of Bayesian methods. The problem was solved after the MCMC method was introduced to Bayesian statistics. However, the effects of millions of markers can need a large number of MCMC iterations to reach convergence of the posterior means and the iterations cannot easily be accelerated by parallel computing, which limits the practical application of Bayesian methods. In contrast, the LMM efficiently predicts individual genetic values using the relationship information, and all markers are assumed in a sense to contribute equally to the construction of Kinship matrix. The marker contribution can also be weighted under the LMM framework, but this makes the modified LMM face the same problem as Bayesian methods—a large number of unknown parameters need to be estimated. KAML adopted a machine learning procedure combining cross-validation, multiple regression, grid search, and bisection algorithms for unknown parameter estimation to solve the problem and reduce thousands or millions of unknown parameters to two (<italic>α</italic> and <italic>β</italic>), which can be combined with the marker <italic>p</italic> value from GWAS results to weight the marker contributions. Compared with MCMC, the machine learning procedure can be accelerated with parallel computing and is much more efficient.</p>
    <p id="Par26">Marker effects and <italic>p</italic> values were reported to be used to weight the marker contributions in modified LMM to improve the prediction accuracy [<xref ref-type="bibr" rid="CR43">43</xref>]. In KAML, we used the <italic>p</italic> value, which represented how significant the genetic marker was associated with the objective trait. It should be pointed out that there are two potential concerns for integrating GWAS results to improve the predictive accuracy. The first is that LD between genetic markers and causal mutations are usually different between the training subsets and individuals to be predicted. In our implementation, the genetic markers were tested <italic>x</italic> times, where <italic>x</italic> is the number of significant detections in a bootstrap strategy-based GWAS from the cross-validation procedure. The bootstrap strategy resampled the individuals a number of times to reduce the effect of population-specific LD to some extent, which filtered the pseudo QTNs that were far from the causal mutations. The problem could be avoided to some extent by the increasing marker density and number of repeats in the cross-validation procedure. The second problem was that the <italic>p</italic> values were different when the genetic markers were tested by different GWAS methods. It is challenging to know how to assign appropriate weights of genetic markers using the <italic>p</italic> values from different GWAS methods to obtain a robust predictive accuracy. In KAML, two parameters, which included the base value of logarithmic function of <italic>p</italic> values and the percentage of top significant genetic markers to be weighted, were optimized in a combined method of grid search and bisection to eliminate to some extent the effect of the <italic>p</italic> values in terms of absolute value. However, this does not mean that GWAS methods do not affect the prediction accuracy. A GWAS method with higher statistical power for a given false discovery rate will certainly provide a better <italic>p</italic> value rank of genetic markers to improve the prediction accuracy compared to using an under powered GWAS.</p>
    <p id="Par27">In either selection of pseudo QTNs or construction of the SNP-weighted Kinship, the unknown parameters were optimized by the machine learning procedure combining cross-validation, multiple regression, grid search, and bisection algorithms. The number of folds (<italic>s</italic>) and repeats (<italic>v</italic>) in the cross-validation procedure influence the prediction accuracy. It was difficult to determine <italic>s</italic> and <italic>v</italic>, and appropriate sets were related to the size of reference population and the genetic architecture of the objective trait. In this study, we found that more repeats improved prediction accuracy of KAML, but significantly increased computing time. Therefore, we recommend setting the number of repeats according to the data size and computing resources. With the help of the cross-validation strategy of machine learning procedure, KAML can switch automatically to five types of models (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Hence, it has the potential to adjust the model hypothesis based on features of the data, and it can be adapted to a wide range of genetic architectures. With the advantage of an efficient parallelized parameter optimization procedure, KAML is computationally efficient and roughly hundreds of times faster than BSLMM and BayesR methods, as well as other MCMC-based methods, while generating similar or better predictive performance.</p>
    <p id="Par28">The usage of pedigree information can sometimes be limited in plants and humans due to incomplete pedigree records or small family sizes and in plants due to novel modes of reproduction, such that the single-step strategy is currently only used widely in livestock breeding. We compared the integrated prediction accuracy of combining SSBLUP with KAML. In practical breeding, SSKAML with pre-estimated parameters led to a higher prediction accuracy compared with SSBLUP and maintained the advantage of computing speed. It highlighted the great potential of KAML in its application of genomic selection.</p>
    <p id="Par29">Functional annotations, reported QTLs, Encode, etc. can be used as prior knowledge to weight the contributions of genetic markers in the prediction model. With the increasing number of publications reporting research for complex diseases, prior knowledge will be enriched by advanced statistical analyses and integrating this information would potentially improve the prediction accuracy. However, it is difficult to evaluate the reliability of prior knowledge, and directly incorporating the information in the prediction model is of high risk. Therefore, we recommend utilizing prior knowledge in the GWAS model instead of directly increasing the weights of genetic markers. The machine learning-based parameter optimization procedure would help to assess the top significant genetic markers of GWAS results and to evaluate the prior knowledge indirectly, and this enables KAML to provide a robust prediction accuracy performance.</p>
    <p id="Par30">In conclusion, aiming to exploit the advantages of both prediction accuracy and computing speed, we proposed a machine learning-based method combining cross-validation, multiple regression, grid search, and bisection algorithms named KAML. The new method incorporates pseudo QTNs as covariates and a trait-specific random effect term under the LMM framework and provides a flexible assumption to accommodate traits of various genetic architectures. We demonstrated the reliability and robustness of KAML by both rigorous simulations and real data analyses. We recommend the use of KAML in practice because of its high prediction performance and advanced computing efficiency. The KAML method is implemented in an easy-to-use software tool that is freely available to the public.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <p id="Par31">KAML is a flexible model that extends LMM by integrating pseudo QTNs as covariates and an optimized trait-specific random effect. All unknown parameters are optimized by machine learning procedure combining cross-validation, multiple regression, grid search, and bisection algorithms. The pseudo QTNs are derived from a multiple regression model-based selection procedure, and random effect relevant unknown parameters (e.g., the weights of SNP markers) are optimized by combining grid search and bisection algorithm. Here, we firstly provide a brief overview of LMM, and then give the description of theoretical differences between LMM and KAML.</p>
    <sec id="Sec10">
      <title>Linear mixed model</title>
      <p id="Par32">The standard LMM assumes that <italic>y</italic>, which is the phenotypic records for <italic>n</italic> individuals, follows a normal distribution, and its variance is influenced by effects from both heredity and environment. The LMM model can be described as:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ y= Xb+ Z\mu +\mathrm{with}\ \mu \sim N\left(0,K{\sigma}_g^2\right)\ \mathrm{and}\ e\sim N\left(0,I{\sigma}_e^2\right), $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">Xb</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">Zμ</mml:mi><mml:mo>+</mml:mo><mml:mtext>with</mml:mtext><mml:mspace width="0.25em"/><mml:mi>μ</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mn>0</mml:mn><mml:mrow><mml:mi>K</mml:mi><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.25em"/><mml:mi>e</mml:mi><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mn>0</mml:mn><mml:mrow><mml:mi>I</mml:mi><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2052_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par33">where <italic>b</italic> is a vector of the estimated effects of the fixed covariates with the corresponding coefficient matrix <italic>X</italic>; <italic>μ</italic> is a vector of random effects, which represents the individual genetic values with the corresponding variance-covariance matrix <italic>K</italic> that is also defined as genomic relationship matrix; <italic>e</italic> is the vector of residual effects; <italic>I</italic> is an identity matrix; and <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_g^2 $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_e^2 $$\end{document}</tex-math><mml:math id="M6" display="inline"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq2.gif"/></alternatives></inline-formula> are the estimated genetic variance and residual variance, respectively. The genetic relationship between individuals <italic>i</italic> and <italic>j</italic> is calculated as: [<xref ref-type="bibr" rid="CR23">23</xref>]
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {K}_{ij}=\frac{1}{m}{\sum}_{k=1}^m\frac{\left({M}_{ik-}2{p}_k\right)\ \left({M}_{jk-}2{p}_k\right)}{2{p}_k\left(1-{p}_k\right)}, $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:msub><mml:mi>K</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2052_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par34">where <italic>m</italic> is the number of markers, <italic>M</italic> is the numerical genotype matrix (AA, AB, and BB genotypes are coded as 0, 1, and 2, respectively), and <italic>p</italic> is the frequency of the coded allele. The genetic values of all individuals including observed and non-observed phenotypic records can be derived by the following equation:
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu =K{Z}^T{V}^{-1}\left(y- Xb\right) $$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:msup><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="italic">Xb</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2020_2052_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>b</italic> = (<italic>X</italic><sup><italic>T</italic></sup><italic>V</italic><sup>−1</sup><italic>X</italic>)<sup>−1</sup>(<italic>X</italic><sup><italic>T</italic></sup><italic>V</italic><sup>−1</sup><italic>y</italic>) and <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ V= ZK{Z}^T{\sigma}_g^2+I{\sigma}_e^2 $$\end{document}</tex-math><mml:math id="M12" display="inline"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">ZK</mml:mi><mml:msup><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq3.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec11">
      <title>Machine learning determined parameter optimizations (KAML)</title>
      <p id="Par35">The LMM assumes that all available SNPs contribute equally to the Kinship matrix. This limits its prediction accuracy, especially in cases that the objective traits are controlled by several major genes. Therefore, KAML extends Eq. 1 to include <italic>n</italic> covariates <italic>Q</italic><sub><italic>1</italic></sub>, <italic>Q</italic><sub><italic>2</italic></sub>, … <italic>, Q</italic><sub><italic>n</italic></sub>, which are derived from a multiple regression model-based selection procedure, and a SNP-weighted Kinship (<italic>K</italic><sub><italic>w</italic></sub>), which is optimized by the combination of grid search and bisection algorithm:
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ y= Xb+ Qq+Z{\mu}^{\ast }+e\ \mathrm{with}\ {\mu}^{\ast}\sim N\left(0,{K}_w{\sigma}_g^2\right)\ \mathrm{and}\ e\sim N\left(0,I{\sigma}_e^2\right), $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">Xb</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">Qq</mml:mi><mml:mo>+</mml:mo><mml:mi>Z</mml:mi><mml:msup><mml:mi>μ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mtext>with</mml:mtext><mml:mspace width="0.25em"/><mml:msup><mml:mi>μ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.25em"/><mml:mi>e</mml:mi><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mn>0</mml:mn><mml:mrow><mml:mi>I</mml:mi><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2020_2052_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par36">KAML firstly integrates some major SNPs into the model as covariates to capture some of the genetic variance, then optimizes a SNP-weighted Kinship for the random effect to make a better explanation for the remaining genetic variance. The derivation of weighting SNPs in constructing Kinship matrix is described in the paper published by Su et al. [<xref ref-type="bibr" rid="CR43">43</xref>] and can be formulated as follows:
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {K}_{w_{ij}}=\frac{1}{m}{\sum}_{k=1}^m\frac{\left({M}_{ik}-2{p}_k\right){\xi}_k\left({M}_{jk}-2{p}_k\right)}{2{p}_k\left(1-{p}_k\right)} $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:msub><mml:mi>K</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="italic">ik</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi>ξ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="italic">jk</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2020_2052_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <italic>ξ</italic><sub><italic>k</italic></sub> is the weight of <italic>k</italic>th SNP. In contrast to previous studies, we propose a more flexible and robust weighting strategy with fewer unknown parameters to be estimated; the weight <italic>ξ</italic><sub><italic>k</italic></sub> is derived from the following equation:
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\xi}_k\mid \left(\alpha, \beta \right)\sim \left\{\begin{array}{c}1\kern4.75em ;\kern0.5em 1-\beta \\ {}1+{\mathit{\log}}_{\alpha }{P}_{m\beta}-{\mathit{\log}}_{\alpha }{P}_k;\kern1.50em \beta \end{array}\right. $$\end{document}</tex-math><mml:math id="M18" display="block"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mfenced close=")" open="(" separators=","><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mfenced><mml:mo>~</mml:mo><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mspace width="4.75em"/><mml:mo>;</mml:mo><mml:mspace width="0.5em"/><mml:malignmark/><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mo mathvariant="italic">log</mml:mo><mml:mi>α</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="italic">mβ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mo mathvariant="italic">log</mml:mo><mml:mi>α</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:mspace width="0.5em"/><mml:malignmark/><mml:mspace width="1em"/><mml:mi>β</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="13059_2020_2052_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <italic>P</italic> is the ordered <italic>p</italic> values of all SNPs from GWAS result, <italic>α</italic> is the base value of logarithmic function, and <italic>β</italic> is the percentage of top significant SNPs to be weighted. If <italic>β</italic> equals 0, Eq. <xref rid="Equ5" ref-type="">5</xref> will switch to Eq. 2. It can be simplified as:
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {K}_{w_{ij}}={K}_{ij}+\frac{1}{m}{\sum}_{k=1}^{m\beta}\frac{\left({M}_{ik}-2{p}_k\right)\left({\mathit{\log}}_{\alpha }{P}_{m\beta}-{\mathit{\log}}_{\alpha }{P}_k\right)\left({M}_{jk}-2{p}_k\right)}{2{p}_k\left(1-{p}_k\right)} $$\end{document}</tex-math><mml:math id="M20" display="block"><mml:msub><mml:mi>K</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="italic">mβ</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="italic">ik</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mo mathvariant="italic">log</mml:mo><mml:mi>α</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="italic">mβ</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mo mathvariant="italic">log</mml:mo><mml:mi>α</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="italic">jk</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2020_2052_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par37">As shown above, this could be computed on-the-fly with a subset instead of all SNPs. Unlike LMM, the estimated genetic values of KAML include two parts: the first part is the fixed effect and the second part is the random effect:
<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mu}^{\ast }= Qq+{K}_w{Z}^T{V}^{-1}\left(y- Xb- Qq\right) $$\end{document}</tex-math><mml:math id="M22" display="block"><mml:msup><mml:mi>μ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="italic">Qq</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msup><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="italic">Xb</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="italic">Qq</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2020_2052_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par38">As described above, the key steps of KAML are identifying the SNPs with large effects and estimating the unknown parameters <italic>α</italic> and <italic>β</italic> efficiently. KAML achieves those two goals by a machine learning procedure, which includes multiple regression for pseudo QTN selection and grid search, bisection algorithms for trait-specific weighted Kinship matrix, and cross-validation, which is considered to be one of the most powerful and accurate methods in parameter estimation [<xref ref-type="bibr" rid="CR44">44</xref>]. Compared with MCMC procedures which are commonly used to estimate parameter in Bayesian methods, the machine learning procedure can be readily accelerated by parallel computation. Hence, the entire procedure of KAML includes two stages: (1) a training stage, which is used to obtain the optimal parameters from the reference population including all individuals with phenotypic records, the reference population set is partitioned for cross-fold internal validation to tune the parameters in KAML, and (2) a prediction stage, which predicts the genetic value of each individual without phenotype by the optimal parameters obtained from the training stage.</p>
      <sec id="Sec12">
        <title>Genome-wide association study</title>
        <p id="Par39">A genome-wide association study is the prevailing method for detecting candidate genes underlying traits and has successfully detected substantial numbers of variants that are associated with human diseases and agricultural economic traits. For the trait to be predicted, GWAS is a powerful tool to capture its genetic architecture, as the <italic>p</italic> values provide information for the downstream model optimization of KAML. Define <italic>s</italic> as the repeat number and <italic>v</italic> as the fold number of cross-validation procedure. For each replicate, the individuals with non-missing phenotype are equally divided into <italic>v</italic> groups, GWAS is conducted <italic>v</italic> times by using the data of randomly combined <italic>v</italic> − 1 groups, and the data of the left-out group is used as validation subset for the parameter optimization.</p>
      </sec>
      <sec id="Sec13">
        <title>The pseudo QTNs derived by multiple regression</title>
        <p id="Par40">It is very sensitive to integrate the pseudo QTNs (<italic>pQ</italic>) as covariates, because a false positive can significantly decrease the prediction accuracy; therefore, we cautiously constitute a rigorous strategy to reduce the risk of selecting false positives. First, we order the <italic>p</italic> values from small to large. Second, filter the ordered SNPs by linkage disequilibrium (LD) at a threshold of 0.3. Third, simultaneously pick up the top <italic>n</italic> pseudo QTNs to ensure valuable signals of multiple peaks can be captured. Finally, we repeat the first three steps in a <italic>s</italic> ∗ <italic>v</italic> cross-validation procedure. The bootstrap strategy is used to measure the robustness of SNP association [<xref ref-type="bibr" rid="CR45">45</xref>]. GWAS is conducted <italic>s</italic> ∗ <italic>v</italic> times in total, and the SNPs that are counted more than <italic>s</italic> ∗ <italic>v</italic> ∗ 90% times are considered as <italic>pQ</italic> for downstream multiple regression analysis. It should be noted that the number of <italic>pQ</italic> (<italic>n</italic>) is never known; a smaller number may lead to losing <italic>pQ</italic> and a greater number would result in more calculation burden. Fortunately, the setting of <italic>n</italic> slightly affects the prediction accuracy as the weights of lost <italic>pQ</italic> could be enhanced in the SNP-weighted procedure, and the default setting of <italic>n</italic> is set to 15.</p>
        <p id="Par41">The LD between genetic markers and causal mutations may be different in the reference and validation populations, and this will increase the risk of false positive associations due to limited marker density. In order to reduce this type of false positive associations, <italic>pQs</italic> are added as covariates in LMM one by one without replacement and validated to determine whether they can help the model to improve the prediction accuracy in a cross-validation procedure. The <italic>pQs</italic> are simultaneously validated in three types of models: “<italic>K</italic>” (LMM), “<italic>pQ+K</italic>” (<italic>pQ</italic> are incorporated as covariates in LMM), and “<italic>pQ</italic>” (<italic>pQ</italic> is incorporated as covariates in GLM), and a series of models are generated. The reliability of each <italic>pQ</italic> is validated by its average prediction accuracy in a <italic>s</italic> ∗ <italic>v</italic> cross-validation procedure, and the equation can be written as:
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_{q_i}=\raisebox{1ex}{$\sum \limits_{k=1}^{s\ast v}{A}_{q_{ik}}$}\!\left/ \!\raisebox{-1ex}{$s\ast v$}\right. $$\end{document}</tex-math><mml:math id="M24" display="block"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mfrac bevelled="true"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>∗</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>A</mml:mi><mml:msub><mml:mi>q</mml:mi><mml:mi mathvariant="italic">ik</mml:mi></mml:msub></mml:msub></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>∗</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/></mml:math><graphic xlink:href="13059_2020_2052_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq4"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {A}_{q_{ik}} $$\end{document}</tex-math><mml:math id="M26" display="inline"><mml:msub><mml:mi>A</mml:mi><mml:msub><mml:mi>q</mml:mi><mml:mi mathvariant="italic">ik</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq4.gif"/></alternatives></inline-formula> is the accuracy of <italic>i</italic>th <italic>pQ</italic> for <italic>k</italic>th cross-validation; it should be pointed out that two methods, including Pearson correlation and area under the receiver operator characteristic curve (AUROC), are implemented in KAML to compute the prediction accuracy; KAML will automatically switch to use AUROC when the phenotype is coded in two levels by 0 and 1, and to use Pearson correlation for other cases. The AUROC is calculated under the guidance of the paper published by Wray et al. in 2010 [<xref ref-type="bibr" rid="CR22">22</xref>]. It is defined as follows:
<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{AUROC}=\frac{1}{N_{d\prime }}\left({\overline{r}}_d-\frac{N_d}{2}-\frac{1}{2}\right) $$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mtext>AUROC</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2020_2052_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>where <italic>N</italic><sub><italic>d</italic></sub> and <italic>N</italic><sub><italic>d</italic>′</sub> are the numbers of diseased and not diseased individuals, respectively, and <inline-formula id="IEq5"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{r}}_d $$\end{document}</tex-math><mml:math id="M30" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq5.gif"/></alternatives></inline-formula> is the mean rank of the diseased individuals. <inline-formula id="IEq6"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_{q_i} $$\end{document}</tex-math><mml:math id="M32" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq6.gif"/></alternatives></inline-formula> is the average accuracy of <italic>i</italic>th <italic>pQ</italic>. Let <inline-formula id="IEq7"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_0 $$\end{document}</tex-math><mml:math id="M34" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq7.gif"/></alternatives></inline-formula> refer to the average prediction accuracy of LMM. The maximum prediction accuracy values of three types of models are compared to decide the final prediction model type for the application stage. The <italic>pQ</italic> under the condition of <inline-formula id="IEq8"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_{q_{i-1}}&lt;{\overline{A}}_{q_i}\&amp;{\overline{A}}_0&lt;{\overline{A}}_{q_i} $$\end{document}</tex-math><mml:math id="M36" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>&amp;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq8.gif"/></alternatives></inline-formula> will be selected as the effective <italic>pQ</italic> in the application stage.</p>
      </sec>
      <sec id="Sec14">
        <title>The SNP-weighted Kinship optimized by grid search and bisection algorithms</title>
        <p id="Par42">If the confirmed model of multiple regression is not “<italic>pQ</italic>,” a combination strategy of grid search and bisection methods, which are used to derive a SNP-weighted Kinship, will be conducted. To start the grid search procedure, start values should be provided for unknown parameters <italic>α</italic> and <italic>β</italic>, respectively. By default, KAML provides the start values of <italic>α</italic><sub>1</sub>, <italic>α</italic><sub>2</sub>, …, <italic>α</italic><sub><italic>n</italic>1</sub> and <italic>β</italic><sub>1</sub>, <italic>β</italic><sub>2</sub>, …, <italic>β</italic><sub><italic>n</italic>2</sub> as (1.01, 1.11, <italic>e</italic>, 10) and (0.0001, 0.001, 0.01, 0.1), respectively, where <italic>e</italic> is the base of natural logarithm. The SNP-weighted Kinship can be constructed following Eq. <xref rid="Equ6" ref-type="">6</xref> by using the corresponding GWAS results from cross-validation, and then the prediction accuracy performances of combinations <inline-formula id="IEq9"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {A}_{\alpha_1{\beta}_1},{A}_{\alpha_1{\beta}_2},\dots, {A}_{\alpha_2{\beta}_1},{A}_{\alpha_2{\beta}_2},\dots, {A}_{\alpha_{n1}{\beta}_{n2}} $$\end{document}</tex-math><mml:math id="M38" display="inline"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq9.gif"/></alternatives></inline-formula> will be recorded for <italic>s</italic> ∗ <italic>v</italic> times in the cross-validation procedure, and the average prediction accuracy of different combinations of <italic>α</italic> and <italic>β</italic> can be calculated as:
<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_{\alpha_i{\beta}_j}=\raisebox{1ex}{$\sum \limits_{k=1}^{s\ast v}{A}_{\alpha_{ik}{\beta}_{jk}}$}\!\left/ \!\raisebox{-1ex}{$s\ast v$}\right. $$\end{document}</tex-math><mml:math id="M40" display="block"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac bevelled="true"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>∗</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="italic">ik</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi mathvariant="italic">jk</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>∗</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2020_2052_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq10"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {A}_{\alpha_{ik}{\beta}_{jk}} $$\end{document}</tex-math><mml:math id="M42" display="inline"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="italic">ik</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi mathvariant="italic">jk</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq10.gif"/></alternatives></inline-formula> is the accuracy of the combination of <italic>i</italic>th <italic>α</italic> and <italic>j</italic>th <italic>β</italic> at the <italic>k</italic>th cross-validation. <inline-formula id="IEq11"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_{\alpha_i{\beta}_j} $$\end{document}</tex-math><mml:math id="M44" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq11.gif"/></alternatives></inline-formula> is the average accuracy of the combination of <italic>α</italic> and <italic>β</italic>. The combinations of <italic>α</italic> and <italic>β</italic> are the intersection points of black solid lines shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Illustration of grid search and bisection algorithm in SNP-weighted Kinship optimization. The ovals are contour line, and the smallest circle at the center is the optimum combination of <italic>α</italic> and <italic>β</italic> in theory. A combination strategy of grid search and bisection methods are used to search the optimum combination of <italic>α</italic> and <italic>β</italic>. In order to avoid multiple peaks around the maximum value in each iteration, four points are set on both sides (<italic>x</italic>- and <italic>y</italic>-axes) instead of one. The iteration procedure will be stopped until the maximum number of iterations is reached or the difference of prediction accuracy values between the last two iterations is less than a pre-set threshold, e.g., 10e<sup>−5</sup></p></caption><graphic xlink:href="13059_2020_2052_Fig5_HTML" id="MO5"/></fig></p>
        <p id="Par43">The point with the maximum prediction accuracy value <inline-formula id="IEq12"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_{\alpha \beta} $$\end{document}</tex-math><mml:math id="M46" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mi mathvariant="italic">αβ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq12.gif"/></alternatives></inline-formula> in the grid search procedure (the hollow ring in Fig. <xref rid="Fig5" ref-type="fig">5</xref>) is assigned to be the start of bisection procedure. In order to avoid multiple peaks around <inline-formula id="IEq13"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_{\alpha \beta} $$\end{document}</tex-math><mml:math id="M48" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mi mathvariant="italic">αβ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq13.gif"/></alternatives></inline-formula>, we reset two levels at the midpoint on both sides of <italic>α</italic> and <italic>β</italic>. Let <inline-formula id="IEq14"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\phi}_{\alpha_1}^{\ast },{\phi}_{\alpha_2}^{\ast } $$\end{document}</tex-math><mml:math id="M50" display="inline"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∗</mml:mo></mml:msubsup><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\phi}_{\beta_1}^{\ast },{\phi}_{\beta_2}^{\ast } $$\end{document}</tex-math><mml:math id="M52" display="inline"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq15.gif"/></alternatives></inline-formula> be the reset values for <italic>α</italic> and <italic>β</italic>, respectively (the intersection of dotted line in Fig. <xref rid="Fig5" ref-type="fig">5</xref>):
<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left({\phi}_{\alpha}^{\ast },{\phi}_{\beta}^{\ast}\right)\in {\phi}^{\ast}\sim f(x)=\left\{\begin{array}{c}U\left(\frac{\phi_i}{2},\frac{\phi_i+{\phi}_{i+1}}{2}\right)\kern3.25em ;i=1\kern1.25em \\ {}U\left(\frac{\phi_{i-1}+{\phi}_i}{2},\frac{\phi_i+{\phi}_{i+1}}{2}\right)\kern1.25em ;1&lt;i&lt;n\\ {}U\left(\frac{\phi_{i-1}+{\phi}_i}{2},\frac{3{\phi}_i-{\phi}_{i-1}}{2}\right)\kern1.25em ;i=n\ \end{array}\right. $$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mfenced close=")" open="(" separators=","><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>α</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>β</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mfenced><mml:mo>∈</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>~</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:mi>U</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mfrac><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mspace width="3.25em"/><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1.25em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>U</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mfrac><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mspace width="1.25em"/><mml:mo>;</mml:mo><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>U</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mfrac><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mspace width="1.25em"/><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mspace width="0.25em"/></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="13059_2020_2052_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>where <italic>U</italic> is the uniform distribution and <italic>i</italic> is the iteration number of bisection procedure. Similarly, we predict the individuals in validation dataset to get the average accuracy <inline-formula id="IEq16"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_{\phi_{\alpha_1{\beta}_1}^{\ast }},{\overline{A}}_{\phi_{\alpha_1{\beta}_2}^{\ast }},{\overline{A}}_{\phi_{\alpha_2{\beta}_1}^{\ast }},{\overline{A}}_{\phi_{\alpha_2{\beta}_2}^{\ast }} $$\end{document}</tex-math><mml:math id="M56" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq16.gif"/></alternatives></inline-formula> by Eq. <xref rid="Equ8" ref-type="">8</xref> and we select the maximum value <inline-formula id="IEq17"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_{\phi_{\alpha \beta}^{\ast }} $$\end{document}</tex-math><mml:math id="M58" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi mathvariant="italic">αβ</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq17.gif"/></alternatives></inline-formula>. Subsequently, stepping to the next iteration with the newly updated <inline-formula id="IEq18"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\phi}_{\alpha_1}^{\ast },{\phi}_{\alpha_2}^{\ast } $$\end{document}</tex-math><mml:math id="M60" display="inline"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∗</mml:mo></mml:msubsup><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq18.gif"/></alternatives></inline-formula> and <inline-formula id="IEq19"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\phi}_{\beta_1}^{\ast },{\phi}_{\beta_2}^{\ast } $$\end{document}</tex-math><mml:math id="M62" display="inline"><mml:msubsup><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq19.gif"/></alternatives></inline-formula>, which are defined by Eq. <xref rid="Equ12" ref-type="">12</xref>. The iteration procedure will continue until the maximum number of iterations is reached or the difference of prediction accuracy values between the last two iterations is less than a pre-set threshold, e.g., 10e<sup>−5</sup>.</p>
        <p id="Par44">Once the iteration procedure stops, we compare the <inline-formula id="IEq20"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_{\phi_{\alpha \beta}^{\ast }} $$\end{document}</tex-math><mml:math id="M64" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi mathvariant="italic">αβ</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq20.gif"/></alternatives></inline-formula> and <inline-formula id="IEq21"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_0 $$\end{document}</tex-math><mml:math id="M66" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq21.gif"/></alternatives></inline-formula> to determine whether the SNP-weighted Kinship could help to increase the prediction accuracy. If <inline-formula id="IEq22"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_{\phi_{\alpha \beta}^{\ast }} $$\end{document}</tex-math><mml:math id="M68" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi mathvariant="italic">αβ</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq22.gif"/></alternatives></inline-formula> &lt; <inline-formula id="IEq23"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{A}}_0 $$\end{document}</tex-math><mml:math id="M70" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2020_2052_Article_IEq23.gif"/></alternatives></inline-formula>, the optimizations will be given up, and KAML uses the standard Kinship without weighting any SNPs. On the contrary, if the optimizations are validated to be effective, then KAML will construct the SNP-weighted Kinship using the optimum combination of <italic>α</italic> and <italic>β</italic>.</p>
      </sec>
      <sec id="Sec15">
        <title>Prediction for application stage</title>
        <p id="Par45">If the final prediction model is selected to be “<italic>pQ</italic>,” the individual genetic values will be directly predicted by LM with the selected <italic>pQ</italic>. If not, an extra GWAS needs to be conducted for the entire reference population, or we merge the bootstrap GWAS results of cross-validation by mean, then a SNP-weighted Kinship matrix can be computed using the optimum combination of <italic>α</italic>, <italic>β</italic>, and the GWAS results, which finally will be applied to predict the individual genetic values.</p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>Dataset</title>
      <p id="Par46">The WTCCC1 data includes approximately 14,000 cases from seven common diseases and 2938 shared controls, and all individuals were genotyped at about 450,000 SNPs. Following previous analyses of the datasets [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR21">21</xref>], we removed SNPs using PLINK [<xref ref-type="bibr" rid="CR46">46</xref>], with either minor allele frequency (MAF) &lt; 0.01, or genotype call rate (CR) &lt; 0.95, or <italic>p</italic> value &lt; 0.05 from Hardy-Weinberg equilibrium (HWE) test. After being filtered, 1868 cases and 373,369 SNPs of bipolar disorder (BD), 1926 cases and 372,541 SNPs of coronary artery disease (CAD), 1748 cases and 374,113 SNPs of Crohn’s disease (CD), 1952 cases and 373,338 SNPs of hypertension (HT), 1860 cases and 373,056 SNPs of rheumatoid arthritis (RA), 1963 cases and 372,964 SNPs of type 1 diabetes (T1D), and 1924 cases and 373,149 SNPs of type 2 diabetes (T2D) remained for prediction performance tests.</p>
      <p id="Par47">The cattle dataset was a German Holstein genomic prediction population comprising 5024 bulls [<xref ref-type="bibr" rid="CR19">19</xref>]. All bulls were genotyped with the Illumina Bovine SNP50 Beadchip [<xref ref-type="bibr" rid="CR47">47</xref>]. After removing the SNPs with either HWE <italic>p</italic> value &lt; 10<sup>−4</sup> or CR &lt; 0.95 or MAF &lt; 0.01, a total of 42,551 SNPs remained for the downstream analysis. The estimated breeding values of three traits were available and used in this study: milk fat percentage (mfp), milk yield (my), and somatic cell score (scs). The three traits may represent three types of genetic architectures composed of (1) one or several major genes and a large number of loci with small effects (mfp), (2) a few moderate effect loci and many small effect loci (my), and (3) many loci with small effects (scs).</p>
      <p id="Par48">The maize data consisted of 2279 inbred accessions and three traits, including two case/control traits: yellow or white kernels (ywk) and sweet or starchy kernels (ssk), and one quantitative trait: growing degree days (gdd). A total of 681,257 SNPs across all maize lines were obtained with genotyping by sequencing (GBS) [<xref ref-type="bibr" rid="CR48">48</xref>]. After removing SNPs with either MAF &lt; 0.01 or CR &lt; 0.95, 314 controls, 1281 cases, and 631,413 SNPs for ywk; 2490 controls, 141 cases, and 633,754 SNPs for ssk; 2279 individuals and 631,674 SNPs for GDD remained in this study [<xref ref-type="bibr" rid="CR49">49</xref>].</p>
      <p id="Par49">The horse data included 14 domestic horse breeds and 18 evolutionarily related species. In total, 480 horses were genotyped with a designed ~ 54,000 SNP assay. A total of 50,621 SNPs was available after removing the SNPs with MAF &lt; 0.01, CR &lt; 0.90, and <italic>p</italic> value &lt; 0.001 from the HWE test. The trait was coat color, which contained 4 levels of classified variables, and it was previously reported to be regulated by a major gene on chromosome 3 [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec17">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="13059_2020_2052_MOESM1_ESM.docx">
          <caption>
            <p><bold>Additional file 1.</bold> Tables S1–S9 and Figs. S1–S3.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="13059_2020_2052_MOESM2_ESM.docx">
          <caption>
            <p><bold>Additional file 2.</bold> Review history.</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-020-02052-w.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the reviewers for their insightful comments and professional suggestions on our paper. We thank Prof. Dorian J. Garrick from Massey University for his valuable suggestions and comments. We thank Thomas A. Gavin, Professor Emeritus, Cornell University, for help with editing this paper.</p>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par50">Yixin Yao was the primary editor on this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par51">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>Conceived the study: XLL. Designed the experiments: XLL and XYL. Performed the experiments and analyzed the data: LLY. Wrote and modified the paper: LLY, XLL, XYL, SHZ, XZ, and XHY. Provided the data: XZ and XLL. Software development: LLY, HHZ, and XLL. All authors reviewed and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the National Natural Science Foundation of China [31702087, 31672391, 31701144], the Key project of the National Natural Science Foundation of China [31790414], and the National Swine Industry Technology System [CARS-35].</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>This study makes use of data generated by the Wellcome Trust Case Control Consortium (WTCCC). A full list of the investigators who contributed to the generation of the WTCCC data is available from <ext-link ext-link-type="uri" xlink:href="http://www.wtccc.org.uk/">http://www.wtccc.org.uk/</ext-link>, where the dataset can be publicly accessed. Funding for the WTCCC project was provided by the Wellcome Trust under award 076113 and 085475. The following datasets can be directly downloaded from the links below:</p>
    <p>QTL-MAS-2012: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/QTL-MAS-2012/12336866">https://figshare.com/articles/QTL-MAS-2012/12336866</ext-link>;</p>
    <p>Horse: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/Horse_dataset/12336773">https://figshare.com/articles/Horse_dataset/12336773</ext-link>;</p>
    <p>Cattle: <ext-link ext-link-type="uri" xlink:href="https://www.g3journal.org/content/5/4/615.supplemental">https://www.g3journal.org/content/5/4/615.supplemental</ext-link>; and</p>
    <p>Maize: <ext-link ext-link-type="uri" xlink:href="https://datacommons.cyverse.org/browse/iplant/home/shared/panzea">https://datacommons.cyverse.org/browse/iplant/home/shared/panzea</ext-link>.</p>
    <p>The source code of KAML is available at a DOI-assigning repository Zenodo (10.5281/zenodo.3757055) [<xref ref-type="bibr" rid="CR50">50</xref>] and at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/YinLiLin/KAML">https://github.com/YinLiLin/KAML</ext-link>) under the GNU General Public License v3.0.</p>
  </notes>
  <notes id="FPar3">
    <title>Ethics approval and consent to participate</title>
    <p id="Par52">Not applicable.</p>
  </notes>
  <notes id="FPar4" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par53">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Wray</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Sklar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>10 years of GWAS discovery: biology, function, and translation</article-title>
        <source>Am J Hum Genet</source>
        <year>2017</year>
        <volume>101</volume>
        <fpage>5</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2017.06.005</pub-id>
        <pub-id pub-id-type="pmid">28686856</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Georges</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Charlier</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Harnessing genomic information for livestock improvement</article-title>
        <source>Nat Rev Genet</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>135</fpage>
        <lpage>156</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-018-0082-2</pub-id>
        <pub-id pub-id-type="pmid">30514919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Desta</surname>
            <given-names>ZA</given-names>
          </name>
          <name>
            <surname>Ortiz</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Genomic selection: genome-wide prediction in plant improvement</article-title>
        <source>Trends Plant Sci</source>
        <year>2014</year>
        <volume>19</volume>
        <fpage>592</fpage>
        <lpage>601</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tplants.2014.05.006</pub-id>
        <pub-id pub-id-type="pmid">24970707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Lorenz AJ, Chao S, Asoro FG, Heffner EL, Hayashi T, Iwata H, Smith KP, Sorrells ME, Jannink J-L. Genomic selection in plant breeding: knowledge and prospects. Adv Agronomy. 2011;110:77-123.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Chatterjee N, Shi JX, Garcia-Closas M. Developing and evaluating polygenic risk prediction models for stratified disease prevention. Nat Rev Genet. 2016;17:392–406.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pasaniuc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Dissecting the genetics of complex traits using summary association statistics</article-title>
        <source>Nat Rev Genet</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>117</fpage>
        <lpage>127</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2016.142</pub-id>
        <pub-id pub-id-type="pmid">27840428</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>VanRaden</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>Efficient methods to compute genomic predictions</article-title>
        <source>J Dairy Sci</source>
        <year>2008</year>
        <volume>91</volume>
        <fpage>4414</fpage>
        <lpage>4423</lpage>
        <pub-id pub-id-type="doi">10.3168/jds.2007-0980</pub-id>
        <pub-id pub-id-type="pmid">18946147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Habier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fernando</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Dekkers</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>The impact of genetic relationship information on genome-assisted breeding values</article-title>
        <source>Genetics</source>
        <year>2007</year>
        <volume>177</volume>
        <fpage>2389</fpage>
        <lpage>2397</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.107.081190</pub-id>
        <pub-id pub-id-type="pmid">18073436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Bayesian LASSO for quantitative trait loci mapping</article-title>
        <source>Genetics</source>
        <year>2008</year>
        <volume>179</volume>
        <fpage>1045</fpage>
        <lpage>1055</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.107.085589</pub-id>
        <pub-id pub-id-type="pmid">18505874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meuwissen</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>
        <source>Genetics</source>
        <year>2001</year>
        <volume>157</volume>
        <fpage>1819</fpage>
        <lpage>1829</lpage>
        <?supplied-pmid 11290733?>
        <pub-id pub-id-type="pmid">11290733</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Zhou X, Carbonetto P, Stephens M. Polygenic modeling with Bayesian sparse linear mixed models. PLoS Genet. 2013;9:e1003264.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Moser G, Lee SH, Hayes BJ, Goddard ME, Wray NR, Visscher PM. Simultaneous discovery, estimation and prediction analysis of complex traits using a Bayesian mixture model. PLoS Genet. 2015;11:e1004969.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeng</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Non-parametric genetic prediction of complex traits with latent Dirichlet process regression models</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>456</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-00470-2</pub-id>
        <pub-id pub-id-type="pmid">28878256</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Habier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fernando</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Kizilkaya</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Garrick</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Extension of the Bayesian alphabet for genomic selection</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>186</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-186</pub-id>
        <pub-id pub-id-type="pmid">21605355</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moore</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Manmathan</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Poland</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Haley</surname>
            <given-names>SD</given-names>
          </name>
        </person-group>
        <article-title>Improving genomic prediction for pre-harvest sprouting tolerance in wheat by weighting large-effect quantitative trait loci</article-title>
        <source>Crop Sci</source>
        <year>2017</year>
        <volume>57</volume>
        <fpage>1315</fpage>
        <lpage>1324</lpage>
        <pub-id pub-id-type="doi">10.2135/cropsci2016.06.0453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopes</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Bovenhuis</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>van Son</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nordbo</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Grindflek</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Knol</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Bastiaansen</surname>
            <given-names>JWM</given-names>
          </name>
        </person-group>
        <article-title>Using markers with large effect in genetic and genomic predictions</article-title>
        <source>J Anim Sci</source>
        <year>2017</year>
        <volume>95</volume>
        <fpage>59</fpage>
        <lpage>71</lpage>
        <?supplied-pmid 28177367?>
        <pub-id pub-id-type="pmid">28177367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Zhang Z, Ober U, Erbe M, Zhang H, Gao N, He JL, Li JQ, Simianer H. Improving the accuracy of whole genome prediction for complex traits using the results of genome wide association studies. PLoS One. 2014;9:e93017.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Tiezzi F, Maltecca C. Accounting for trait architecture in genomic predictions of US Holstein cattle using a weighted realized relationship matrix. Genet Sel Evol. 2015;47:24.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Erbe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ober</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Simianer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Accuracy of whole-genome prediction using a genetic architecture-enhanced variance-covariance matrix</article-title>
        <source>G3: Genes Genomes Genetics</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>615</fpage>
        <lpage>627</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.114.016261</pub-id>
        <pub-id pub-id-type="pmid">25670771</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Sarup P, Jensen J, Ostersen T, Henryon M, Sorensen P. Increased prediction accuracy using a genomic feature model including prior information on quantitative trait locus regions in purebred Danish Duroc pigs. BMC Genet. 2016;17.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Speed</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>MultiBLUP: improved SNP-based prediction for complex traits</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>1550</fpage>
        <lpage>1557</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.169375.113</pub-id>
        <pub-id pub-id-type="pmid">24963154</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wray</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>The genetic interpretation of area under the ROC curve in genomic profiling</article-title>
        <source>PLoS Genet</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1000864</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1000864</pub-id>
        <pub-id pub-id-type="pmid">20195508</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Benyamin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>McEvoy</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Henders</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Nyholt</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Heath</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>NG</given-names>
          </name>
          <name>
            <surname>Montgomery</surname>
            <given-names>GW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Common SNPs explain a large proportion of the heritability for human height</article-title>
        <source>Nat Genet</source>
        <year>2010</year>
        <volume>42</volume>
        <fpage>565</fpage>
        <lpage>U131</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.608</pub-id>
        <pub-id pub-id-type="pmid">20562875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pressoir</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Briggs</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Vroh Bi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Yamasaki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Doebley</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>McMullen</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Gaut</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>JB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A unified mixed-model method for association mapping that accounts for multiple levels of relatedness</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>203</fpage>
        <lpage>208</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1702</pub-id>
        <pub-id pub-id-type="pmid">16380716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Tang Y, Liu X. G2P: a genome-wide-association-study simulation tool for genotype simulation, phenotype simulation and power evaluation. Bioinformatics. 2019;35:3852-4.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Buckler</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Iterative usage of fixed and random effect models for powerful and efficient genome-wide association studies</article-title>
        <source>PLoS Genet</source>
        <year>2016</year>
        <volume>12</volume>
        <fpage>e1005767</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1005767</pub-id>
        <pub-id pub-id-type="pmid">26828793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lloyd-Jones</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sidorenko</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yengo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Moser</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kemper</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Magi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Esko</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved polygenic prediction by Bayesian multiple regression on summary statistics</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>5086</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-12653-0</pub-id>
        <pub-id pub-id-type="pmid">31704910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Usai</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Gaspa</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Macciotta</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Carta</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Casu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>XVI (th) QTLMAS: simulated dataset and comparative analysis of submitted results for QTL mapping and genomic evaluation</article-title>
        <source>BMC Proc</source>
        <year>2014</year>
        <volume>8</volume>
        <fpage>S1</fpage>
        <pub-id pub-id-type="doi">10.1186/1753-6561-8-S5-S1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bao</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>An efficient unified model for genome-wide association studies and genomic selection</article-title>
        <source>Genet Sel Evol</source>
        <year>2017</year>
        <volume>49</volume>
        <fpage>64</fpage>
        <pub-id pub-id-type="doi">10.1186/s12711-017-0338-x</pub-id>
        <pub-id pub-id-type="pmid">28836943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Joint prediction of multiple quantitative traits using a Bayesian multivariate antedependence model</article-title>
        <source>Heredity (Edinb)</source>
        <year>2015</year>
        <volume>115</volume>
        <fpage>29</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1038/hdy.2015.9</pub-id>
        <pub-id pub-id-type="pmid">25873147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Wellcome Trust Case Control C</collab>
        </person-group>
        <article-title>Genome-wide association study of 14,000 cases of seven common diseases and 3,000 shared controls</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>447</volume>
        <fpage>661</fpage>
        <lpage>678</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05911</pub-id>
        <pub-id pub-id-type="pmid">17554300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>GCTA: a tool for genome-wide complex trait analysis</article-title>
        <source>Am J Hum Genet</source>
        <year>2011</year>
        <volume>88</volume>
        <fpage>76</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2010.11.011</pub-id>
        <pub-id pub-id-type="pmid">21167468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Ersoz</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>CQ</given-names>
          </name>
          <name>
            <surname>Todhunter</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Tiwari</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Gore</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Bradbury</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Arnett</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Ordovas</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Buckler</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Mixed linear model approach adapted for genome-wide association studies</article-title>
        <source>Nat Genet</source>
        <year>2010</year>
        <volume>42</volume>
        <fpage>355</fpage>
        <lpage>U118</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.546</pub-id>
        <pub-id pub-id-type="pmid">20208535</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Listgarten</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lippert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kadie</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>RI</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Heckerman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Improved linear mixed models for genome-wide association studies</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>525</fpage>
        <lpage>526</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2037</pub-id>
        <pub-id pub-id-type="pmid">22669648</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wray</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Wijmenga</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>Common disease is more complex than implied by the core gene omnigenic model</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <fpage>1573</fpage>
        <lpage>1580</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.05.051</pub-id>
        <pub-id pub-id-type="pmid">29906445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hayes</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Overview of statistical methods for genome-wide association studies (GWAS)</article-title>
        <source>Methods Mol Biol</source>
        <year>2013</year>
        <volume>1019</volume>
        <fpage>149</fpage>
        <lpage>169</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-62703-447-0_6</pub-id>
        <pub-id pub-id-type="pmid">23756890</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">McCue ME, Bannasch DL, Petersen JL, Gurr J, Bailey E, Binns MM, Distl O, Guerin G, Hasegawa T, Hill EW, et al. A high density SNP array for the domestic horse and extant Perissodactyla: utility for association mapping, genetic diversity, and phylogeny studies. PLoS Genet. 2012;8:e1002451.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Logsdon BA, Hoffman GE, Mezey JG. A variational Bayes algorithm for fast and accurate multiple locus genome-wide association analysis. BMC Bioinformatics. 2010;11:58.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guan</surname>
            <given-names>YT</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bayesian variable selection regression for genome-wide association studies and other large-scale problems</article-title>
        <source>Ann Applied Statistics</source>
        <year>2011</year>
        <volume>5</volume>
        <fpage>1780</fpage>
        <lpage>1815</lpage>
        <pub-id pub-id-type="doi">10.1214/11-AOAS455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aguilar</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Misztal</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Legarra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tsuruta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lawlor</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>Hot topic: a unified approach to utilize phenotypic, full pedigree, and genomic information for genetic evaluation of Holstein final score</article-title>
        <source>J Dairy Sci</source>
        <year>2010</year>
        <volume>93</volume>
        <fpage>743</fpage>
        <lpage>752</lpage>
        <pub-id pub-id-type="doi">10.3168/jds.2009-2730</pub-id>
        <pub-id pub-id-type="pmid">20105546</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Christensen OF</collab>
          <name>
            <surname>Lund</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Genomic prediction when some animals are not genotyped</article-title>
        <source>Genet Sel Evol</source>
        <year>2010</year>
        <volume>42</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-42-2</pub-id>
        <pub-id pub-id-type="pmid">20105297</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meuwissen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Genomic selection: a paradigm shift in animal breeding</article-title>
        <source>Animal Frontiers</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>6</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.2527/af.2016-0002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>G</given-names>
          </name>
          <collab>Christensen OF</collab>
          <name>
            <surname>Janss</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lund</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Comparison of genomic predictions using genomic relationship matrices built with different weighting factors to account for locus-specific variances</article-title>
        <source>J Dairy Sci</source>
        <year>2014</year>
        <volume>97</volume>
        <fpage>6547</fpage>
        <lpage>6559</lpage>
        <pub-id pub-id-type="doi">10.3168/jds.2014-8210</pub-id>
        <pub-id pub-id-type="pmid">25129495</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stone</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cross-validatory choice and assessment of statistical predictions</article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1974</year>
        <volume>36</volume>
        <fpage>111</fpage>
        <lpage>133</lpage>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bradbury</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Hung</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Flint-Garcia</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rocheford</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>McMullen</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Buckler</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide association study of leaf architecture in the maize nested association mapping population</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>159</fpage>
        <lpage>U113</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.746</pub-id>
        <pub-id pub-id-type="pmid">21217756</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Neale</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Todd-Brown</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>MAR</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Maller</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sklar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>de Bakker</surname>
            <given-names>PIW</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Sham</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <fpage>559</fpage>
        <lpage>575</lpage>
        <pub-id pub-id-type="doi">10.1086/519795</pub-id>
        <pub-id pub-id-type="pmid">17701901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Matukumalli LK, Lawley CT, Schnabel RD, Taylor JF, Allan MF, Heaton MP, O'Connell J, Moore SS, Smith TPL, Sonstegard TS, Van Tassell CP. Development and characterization of a high density SNP genotyping assay for cattle. PLoS One. 2009;4:e5350.</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elshire</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Glaubitz</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Poland</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Kawamoto</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Buckler</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Mitchell</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>A robust, simple genotyping-by-sequencing (GBS) approach for high diversity species</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e19379</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0019379</pub-id>
        <pub-id pub-id-type="pmid">21573248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Romay MC, Millard MJ, Glaubitz JC, Peiffer JA, Swarts KL, Casstevens TM, Elshire RJ, Acharya CB, Mitchell SE, Flint-Garcia SA, et al. Comprehensive genotyping of the USA national maize inbred seed bank. Genome Biol. 2013;14:R55.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Yin L, Zhang H, Zhou X, Yuan X, Zhao S, Li X, Liu X. KAML: improving genomic prediction accuracy of complex traits using machine learning determined parameters. Source Code Zenodo Repository. 2020; 10.5281/zenodo.3757055.</mixed-citation>
    </ref>
  </ref-list>
</back>
