<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6022547</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty260</article-id>
    <article-id pub-id-type="publisher-id">bty260</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb 2018–Intelligent Systems for Molecular Biology Proceedings</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Comparative and Functional Genomics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Random forest based similarity learning for single cell RNA sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pouyan</surname>
          <given-names>Maziyar Baran</given-names>
        </name>
        <xref ref-type="aff" rid="bty260-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kostka</surname>
          <given-names>Dennis</given-names>
        </name>
        <xref ref-type="aff" rid="bty260-aff1">1</xref>
        <xref ref-type="aff" rid="bty260-aff2">2</xref>
        <xref ref-type="corresp" rid="bty260-cor1"/>
        <!--<email>kostka@pitt.edu</email>-->
      </contrib>
    </contrib-group>
    <aff id="bty260-aff1"><label>1</label>Department of Developmental Biology, University of Pittsburgh, Pittsburgh, PA, USA</aff>
    <aff id="bty260-aff2"><label>2</label>Department for Computational and Systems Biology, Pittsburgh Center for Evolutionary Biology and Medicine, School of Medicine, University of Pittsburgh, Pittsburgh, PA, USA</aff>
    <author-notes>
      <corresp id="bty260-cor1">To whom correspondence should be addressed. <email>kostka@pitt.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>7</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-06-27">
      <day>27</day>
      <month>6</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>6</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>13</issue>
    <issue-title>ISMB 2018 Proceedings July 6 to July 10, 2018, Chicago, IL, United States</issue-title>
    <fpage>i79</fpage>
    <lpage>i88</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty260.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Genome-wide transcriptome sequencing applied to single cells (scRNA-seq) is rapidly becoming an assay of choice across many fields of biological and biomedical research. Scientific objectives often revolve around discovery or characterization of types or sub-types of cells, and therefore, obtaining accurate cell–cell similarities from scRNA-seq data is a critical step in many studies. While rapid advances are being made in the development of tools for scRNA-seq data analysis, few approaches exist that explicitly address this task. Furthermore, abundance and type of noise present in scRNA-seq datasets suggest that application of generic methods, or of methods developed for bulk RNA-seq data, is likely suboptimal.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present RAFSIL, a random forest based approach to learn cell–cell similarities from scRNA-seq data. RAFSIL implements a two-step procedure, where feature construction geared towards scRNA-seq data is followed by similarity learning. It is designed to be adaptable and expandable, and RAFSIL similarities can be used for typical exploratory data analysis tasks like dimension reduction, visualization and clustering. We show that our approach compares favorably with current methods across a diverse collection of datasets, and that it can be used to detect and highlight unwanted technical variation in scRNA-seq datasets in situations where other methods fail. Overall, RAFSIL implements a flexible approach yielding a useful tool that improves the analysis of scRNA-seq data.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The RAFSIL R package is available at <ext-link ext-link-type="uri" xlink:href="http://www.kostkalab.net/software.html">www.kostkalab.net/software.html</ext-link></p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institutes of Health</named-content>
          <named-content content-type="funder-identifier">10.13039/100000002</named-content>
        </funding-source>
        <award-id>R01GM115836</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">University of Pittsburgh School of Medicine</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Sequencing transcriptomes of single cells (scRNA-seq) is becoming increasingly common, as technology evolves and costs decline. Studying gene expression genome-wide at single cell resolution overcomes intrinsic limitations of bulk RNA sequencing, where expression levels are averaged over thousands or millions of cells. scRNA-seq enables researchers to more rigorously address questions about the cellular composition of tissues, the transcriptional heterogeneity and structure of ‘cell types’, and how this may change, for instance during development or in disease (<xref rid="bty260-B23" ref-type="bibr">Kumar <italic>et al.</italic>, 2017</xref>; <xref rid="bty260-B29" ref-type="bibr">Patel <italic>et al.</italic>, 2014</xref>). Identifying group structure is therefore a crucially important step in most scRNA-seq data analyses, and it has yielded exciting discoveries of novel cell types and revealed previously un-appreciated sub-populations and heterogeneity of known types of cells (<xref rid="bty260-B23" ref-type="bibr">Kumar <italic>et al.</italic>, 2017</xref>).</p>
    <p>Identifying group structure in scRNA-seq data is, however, not without challenges. Even for bulk RNA sequencing no gold standard has emerged in the field (<xref rid="bty260-B8" ref-type="bibr">Conesa <italic>et al.</italic>, 2016</xref>), and for single cell RNA sequencing several factors further complicate the task. These include additional biological heterogeneity induced by the inherent stochasticity of gene expression in single cells, and technical noise rooted in cell processing, cell lysis and library preparation from extremely low amounts of ‘input’ messenger RNA (<xref rid="bty260-B1" ref-type="bibr">Adam <italic>et al.</italic>, 2017</xref>). The latter, for example, leads to dropout events, where no RNA is measured for a gene actually expressed in a cell. It is estimated that 50–95% of a cell’s mRNA are not measured by current technologies (<xref rid="bty260-B1" ref-type="bibr">Adam <italic>et al.</italic>, 2017</xref>; <xref rid="bty260-B38" ref-type="bibr">Svensson <italic>et al.</italic>, 2017</xref>). While the relative magnitude of such factors will depend on the specific technology used, it is fair to assume they play a role in most, if not all, scRNA-seq studies. Therefore, there is a need for computational approaches that take the specific nature of scRNA-seq data into account and enable researchers to accurately and reliably identify, visualize and explore group (or population) structure of single cells. To address that need we developed RAFSIL, a random forest (RF) based method for learning similarities between cells from single cell RNA sequencing experiments.</p>
    <p>Related work includes clustering methods, which implicitly or explicitly rely on a similarity concept and are commonly used to group objects. Examples of approaches developed specifically for scRNA-seq data include the combination of Pearson correlation with robust k-means clustering (<xref rid="bty260-B12" ref-type="bibr">Grün <italic>et al.</italic>, 2015</xref>), and the use of consensus clustering (<xref rid="bty260-B37" ref-type="bibr">Strehl and Ghosh, 2002</xref>) to obtain stable cell groupings by <xref rid="bty260-B19" ref-type="bibr">Kiselev <italic>et al.</italic> (2017b</xref>). <xref rid="bty260-B51" ref-type="bibr">Žurauskienė and Yau (2016)</xref> combine agglomerative clustering with principal component analysis (PCA), while <xref rid="bty260-B27" ref-type="bibr">Lin <italic>et al.</italic> (2017)</xref> explore the use of neural networks (NNs) (<xref rid="bty260-B15" ref-type="bibr">Hagan <italic>et al.</italic>, 1996</xref>) for clustering and dimension reduction. More closely related to our work is SIMLR (<xref rid="bty260-B47" ref-type="bibr">Wang <italic>et al.</italic>, 2017</xref>b), an approach based on multiple kernel learning (<xref rid="bty260-B24" ref-type="bibr">Lanckriet <italic>et al.</italic>, 2004</xref>) that directly learns similarities between single cells. However, SIMLR is built around a clustering paradigm, and the user is asked to provide the algorithm with a specific cluster number to guide similarity learning.</p>
    <p>In contrast, RAFSIL similarities are based on random forests (RFs) (<xref rid="bty260-B4" ref-type="bibr">Breiman, 2001</xref>), and our approach requires no prior information about group structure. We show RAFSIL learns similarities that faithfully represent group structure in scRNA-seq data; when used for dimension reduction and clustering they provide an accurate visualization of datasets and enable exploratory analyses for cell type identification and discovery. Importantly, RAFSIL compares favorably with the current state-of-the-art showing high accuracy and robustness, and we demonstrate how it enables the identification of technical variation that remains hidden with other approaches.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>We assume normalized gene expression data on log-scale of <italic>n</italic> cells for <italic>p</italic> genes is available, organized into a <italic>p </italic>×<italic> n</italic> expression matrix <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> indicates the expression of <italic>p</italic> genes in cell <italic>i</italic><inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
    <sec>
      <title>2.1 Gene filtering</title>
      <p>We consider three types of gene filters for the scRNA-seq data matrix <bold><italic>X</italic></bold>:</p>
      <p><italic>All genes (ALL):</italic> All genes in <bold><italic>X</italic></bold> are considered that have non-zero expression in at least one cell in the dataset. This is the most inclusive set of genes.</p>
      <p><italic>Frequency filtering (FRQ):</italic> Here, we consider only genes that are expressed in a certain fraction of cells. Specifically, we choose 6%, as reported by <xref rid="bty260-B19" ref-type="bibr">Kiselev <italic>et al</italic>. (2017b)</xref> for our analyses.</p>
      <p><italic>Highly expressed genes (HiE):</italic> The subset of frequency-filtered genes is further narrowed down to consider genes with ‘high’ expression across cells. In each cell, expressed genes are sorted in decreasing order of expression and the top 10% are marked as highly expressed. To focus on genes that are frequently highly expressed across cells, we discard half of the genes that are highly expressed in the fewest cells. This approach yields a set of genes that are highly expressed across cells, but still allows for variability in gene expression.</p>
      <p>In the following, we describe our approach for <underline>ra</underline>ndom <underline>f</underline>orest based <underline>si</underline>milarity <underline>l</underline>earning (RAFSIL) from scRNA-seq data. We developed two methods, RAFSIL1 and RAFSIL2, which are both two-step procedures. They share a feature-construction step and then apply different types of RF based similarity learning.</p>
    </sec>
    <sec>
      <title>2.2 RAFSIL: feature construction</title>
      <sec>
        <title>2.2.1 RAFSIL gene filtering and clustering</title>
        <p>For the RAFSIL methods, we apply the frequency filter described above, and then derive gene clusters as follows: first, PCA is applied to the gene-filtered expression matrix <bold><italic>X</italic></bold> (treating genes as observations and cells as features), and we keep the most informative principal components as selected by the ‘elbow method’ (<xref rid="bty260-B39" ref-type="bibr">Thorndike, 1953</xref>). Next, we apply k-means clustering (<monospace>kmeans</monospace><monospace>++</monospace>; <xref rid="bty260-B2" ref-type="bibr">Arthur and Vassilvitskii, 2007</xref>; <xref rid="bty260-B28" ref-type="bibr">Mouselimis, 2017</xref>) to this reduced representation of genes and derive gene clusters, where we determine the number of clusters by finding the elbow point of the sum of squared errors as a function of increasing cluster numbers. This yields a partition of frequency-selected genes into <italic>k</italic> disjoint clusters.</p>
      </sec>
      <sec>
        <title>2.2.2 RAFSIL Spearman feature space construction</title>
        <p>Gene clustering decomposes the column space of <bold><italic>X</italic></bold> into orthogonal sub-spaces, and we characterize each cell based on its similarities with all other cells in each sub-space. Specifically, we calculate <italic>n </italic>×<italic> n</italic> cell–cell similarity matrices <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> using Spearman rank correlation and genes restricted to the respective clusters derived beforehand. Spearman rank correlation is used rather than Pearson correlation because of its robustness to outliers (<xref rid="bty260-B10" ref-type="bibr">Gentleman <italic>et al.</italic>, 2005</xref>). For each similarity matrix <italic>C<sub>i</sub></italic> we then perform PCA, and again keep <italic>m<sub>i</sub></italic> informative principal components identified by the elbow method. This yields <italic>k</italic> matrices <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> based on genes in cluster <italic>i</italic>, where each cell is embedded by its principal components derived from local similarities (i.e., similarities calculated using only genes in a gene cluster). We then construct a final feature matrix <bold><italic>F</italic></bold> by juxtaposing matrices from individual gene clusters:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo> </mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo> </mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>…</mml:mo><mml:mo> </mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></disp-formula>
The number of columns in <inline-formula id="IE6"><mml:math id="IM6"><mml:mi mathvariant="bold-italic">F</mml:mi></mml:math></inline-formula> (i.e. the number of features <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) is data-dependent, and each cell <italic>j</italic> is now described by a feature vector <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (the <italic>j</italic>-th row of <bold><italic>F</italic></bold>). In the following, we use these features for RF based similarity learning.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 RAFSIL: RAndom Forest based SImilarity Learning</title>
      <p>RFs are an established classification method based on ensembles of decision trees (<xref rid="bty260-B4" ref-type="bibr">Breiman, 2001</xref>). However, they can also be used in an unsupervised setting to infer similarities between objects (<xref rid="bty260-B5" ref-type="bibr">Breiman and Cutler, 2003</xref>; <xref rid="bty260-B35" ref-type="bibr">Shi and Horvath, 2006</xref>). Here, we present two variations of this general strategy.</p>
      <sec>
        <title>2.3.1 RAFSIL1</title>
        <p>Here, we describe an approach for RF based similarity learning (<xref rid="bty260-B5" ref-type="bibr">Breiman and Cutler, 2003</xref>; <xref rid="bty260-B35" ref-type="bibr">Shi and Horvath, 2006</xref>) that has been applied to various types of biomedical data (<xref rid="bty260-B34" ref-type="bibr">Seligson <italic>et al.</italic>, 2005</xref>; <xref rid="bty260-B33" ref-type="bibr">Ramirez <italic>et al.</italic>, 2018</xref>) and is implemented in the <monospace>randomForest</monospace> package for the <monospace>R</monospace> programming language (<xref rid="bty260-B26" ref-type="bibr">Liaw and Wiener, 2017</xref>). In <xref rid="bty260-B31" ref-type="bibr">Pouyan and Nourani (2017)</xref>, the RAFSIL1 approach (without the feature construction step) was applied to Cytometry by Time of Flight (CyTOF) data, where protein expression of several marker genes (typically less than 50) is assessed.</p>
        <p>Next, we briefly summarize RF based similarity learning: To cast the unsupervised similarity learning problem into a problem suitable for RFs, a ‘synthetic’ dataset is generated, for instance by randomly shuffling the values of each feature independently; then, an RF classifier is trained to distinguish the shuffled data from the un-shuffled data (<bold><italic>F</italic></bold> in our notation). Let <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> denote the <italic>i</italic>-th row of <bold><italic>F</italic></bold>. If we assume the RF classifier contains <italic>N</italic> trees and define <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:mi mathvariant="monospace">nt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> as the number of trees that classify cells <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> via the same leaf, then the RF based <italic>n </italic>×<italic> n</italic> similarity matrix <bold><italic>S</italic></bold> is defined via <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="monospace">nt</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>. A corresponding dissimilarity matrix <bold><italic>D</italic></bold> can then be obtained via <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. In the following, we use the term similarity and dissimilarity interchangeably, referring to <bold><italic>S</italic></bold> and <bold><italic>D</italic></bold>, respectively. Repeating this procedure <italic>B</italic> times allows us to aggregate individual similarity matrices <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> into a final matrix <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mi>i</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> and corresponding <bold><italic>D</italic></bold>. We used <italic>B</italic> = 50 for our experiments.</p>
      </sec>
      <sec>
        <title>2.3.2 RAFSIL2</title>
        <p>We now describe how we use the RF classifier to construct (dis)similarity matrices without the need for synthetically generated datasets. The general idea, as in the above method, is to exploit feature dependence. However, we proceed as follows: After selecting a single feature <italic>j</italic> (the <italic>j-</italic>th column of the feature matrix <bold><italic>F</italic></bold>) we quantize its values to derive class labels <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> for all cells. We use partitioning around medoids as implemented by the <monospace>pamk</monospace> function provided by the R package <monospace>fpc</monospace> (<xref rid="bty260-B16" ref-type="bibr">Hennig, 2018</xref>), which also estimates the optimal number of clusters. Then, we remove the <italic>j</italic>-th column from <bold><italic>F</italic></bold> and use the RF classifier to learn the obtained class labels with this reduced dataset. The resulting RF then yields a similarity between cells as described above. Repeating this procedure for all features yields <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> RF classifiers with corresponding similarity measures <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, and averaging as described for RAFSIL1 above results in a final pair of similarity and dissimilarity matrices <bold><italic>S</italic></bold> and <bold><italic>D</italic></bold>, respectively. As before, we use the <monospace>randomForest</monospace> package for R (<xref rid="bty260-B26" ref-type="bibr">Liaw and Wiener, 2017</xref>) with its default forest size of 500 trees.</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Performance evaluation</title>
      <p>To evaluate our approach, we apply RAFSIL1/2 to ten scRNA-seq datasets that have pre-annotated cell populations, and we compare results with current state of the art approaches. We distinguish three different scenarios, namely similarity learning, dimension reduction and clustering. All of these play critical roles in exploring, visualizing and interpreting scRNA-seq data, but they have different objectives and we evaluate them accordingly.</p>
      <sec>
        <title>2.4.1 Similarity learning</title>
        <p>For similarity learning, we compare our method with SIMLR (<xref rid="bty260-B47" ref-type="bibr">Wang <italic>et al.</italic>, 2017</xref>b), the only scRNA-seq method that advertises similarity learning. In addition, we explored common similarity/dissimilarity measures: Euclidean distance, Pearson and Spearman correlation, applied to the full (ALL), frequency-filtered (FRQ) and highly-expressed (HiE) sets of genes (see Section 2.1 for details on the gene sets). Following <xref rid="bty260-B47" ref-type="bibr">Wang <italic>et al.</italic> (2017</xref>b) the metric we choose to evaluate similarity learning is the nearest neighbor error (NNE) <xref rid="bty260-B43" ref-type="bibr">(van der Maaten <italic>et al.</italic>, 2009)</xref>. The NNE is calculated by using a nearest neighbor classifier based on the target similarity to be evaluated: for a given set of labeled cells, an unlabeled cell is classified with the same label as its most similar labeled neighbor. Predictions for each cell are obtained via 10-fold cross-validation (CV), and the NNE then reports the fraction of mis-classified cells. Because in the 10-fold CV procedure data are randomly split into 10 folds (9 for training, 1 for validation) we report averages over 20 runs. The NNE is a direct reflection of how well the learned dissimilarity measure captures the pre-annotated class labels. For SIMLR we used the SIMLR R package (<xref rid="bty260-B46" ref-type="bibr">Wang <italic>et al.</italic>, 2017a</xref>), provided it with all genes (ALL) and evaluated the similarity matrix returned by the <monospace>SIMLR</monospace> function with default options. For SIMLR we needed to provide the option <monospace>normaliz</monospace><monospace>e = T</monospace><monospace>RUE</monospace> for the Treutlein dataset, otherwise the program would abort. We have indicated this by putting the respective values in parentheses in the relevant result tables.</p>
      </sec>
      <sec>
        <title>2.4.2 Dimension reduction</title>
        <p>To evaluate the results of dimension reduction, we use the same NNE metric as for evaluating similarity (see above), but in this case applied to the reduced-dimensional projection. That is, we first perform similarity learning. Then we use the resulting similarity matrix as input for a dimension reduction algorithm, which sees each cell as a vector of its’ similarities. Finally we calculate the NNE based on Euclidean distance in the reduced-dimensional space.</p>
        <p>For all methods, we choose two as the number of dimensions to project down to, and we compared the following approaches for dimensionality reduction: t stochastic neighbor embedding (tSNE; <xref rid="bty260-B44" ref-type="bibr">van der Maaten and Hinton, 2008</xref>), PCA and probabilistic PCA (pPCA; <xref rid="bty260-B40" ref-type="bibr">Tipping and Bishop, 1999</xref>). We also skip the similarity learning step and directly apply dimension reduction to cells characterized by their highly expressed genes (Data-HiE in <xref rid="bty260-T3" ref-type="table">Table 3</xref>). For pPCA we used the implementation provided by the <monospace>pcaMethods</monospace> R package (<xref rid="bty260-B36" ref-type="bibr">Stacklies <italic>et al.</italic>, 2007</xref>; <xref rid="bty260-B18" ref-type="bibr">Kiselev <italic>et al.</italic>, 2017a</xref>) and for tSNE the <monospace>Rtsne</monospace> R package (<xref rid="bty260-B22" ref-type="bibr">Krijthe, 2015</xref>). We used tSNE with default values for all datasets except Treutlein, where we set the perplexity to 20.</p>
      </sec>
      <sec>
        <title>2.4.3 Clustering</title>
        <p>We also evaluate the performance of RAFSIL1/2 in the context of clustering; that is, we ask how well group structure inferred based on RAFSIL1/2 similarities agrees with pre-annotated cell populations. This allows us to expand the methods we compare RAFSIL with, because in addition to the approaches we compared with for similarity learning and dimension reduction, we can now add algorithms that have no explicit similarity learning step. Specifically, we add SC3 (<xref rid="bty260-B19" ref-type="bibr">Kiselev <italic>et al.</italic>, 2017b</xref>), pcaReduce (<xref rid="bty260-B51" ref-type="bibr">Žurauskienė and Yau, 2016</xref>, <xref rid="bty260-B50" ref-type="bibr">2015</xref>) and SINCERA (<xref rid="bty260-B13" ref-type="bibr">Guo, 2017</xref>; <xref rid="bty260-B14" ref-type="bibr">Guo <italic>et al.</italic>, 2015</xref>) to our comparisons. These methods, and SIMLR, are geared towards scRNA-seq clustering, and we provide each method with the number of pre-annotated populations for each dataset and the expression profiles comprising the complete set of expressed genes (ALL).</p>
        <p><bold><italic>Clustering methods.</italic></bold> For RAFSIL1/2 and Spearman correlation we implemented two clustering strategies. First, using similarities as a vector embedding for each cell, we run k-means clustering (KM) to infer group labels. Second, we perform hierarchical clustering with average linkage (HC) using learned dissimilarities (<inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>ρ</mml:mo></mml:mrow></mml:math></inline-formula> for Spearman correlation). For k-means clustering we use <monospace>kmeans+</monospace><monospace>+</monospace> as provided by the R package <monospace>pracma</monospace> (<xref rid="bty260-B3" ref-type="bibr">Borchers, 2017</xref>), while for hierarchical clustering we use the base functionality provided within R through the <monospace>stats</monospace> package (<xref rid="bty260-B32" ref-type="bibr">R Core Team, 2017</xref>). Like for the other methods, we set the number of clusters to the known number of different cell labels (<xref rid="bty260-B19" ref-type="bibr">Kiselev <italic>et al.</italic>, 2017b</xref>).</p>
        <p><bold><italic>Evaluation metric.</italic></bold> To evaluate clustering results, we calculate two performance metrics: the adjusted Rand index (ARI) and normalized mutual information (NMI). Both of them are popular metrics to evaluate clustering results in the context of a known labeling in single cell data (<xref rid="bty260-B17" ref-type="bibr">Hubert and Arabie, 1985</xref>; <xref rid="bty260-B19" ref-type="bibr">Kiselev <italic>et al.</italic>, 2017b</xref>; <xref rid="bty260-B45" ref-type="bibr">Vinh <italic>et al.</italic>, 2010</xref>; <xref rid="bty260-B47" ref-type="bibr">Wang <italic>et al.</italic>, 2017</xref>b). The ARI is defined as follows: assume, we cluster <italic>n</italic> cells into <italic>k</italic> clusters. Let <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> denote the inferred cluster labels, and <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> the pre-annotated labeling. Then
<disp-formula id="E2"><mml:math id="M2"><mml:mrow><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
where <italic>l</italic> and <italic>s</italic> enumerate the <italic>k</italic> clusters, and <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mi>I</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mi>I</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi>I</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> the indicator function that is one for <italic>x </italic>=<italic> y</italic> and zero otherwise. The ARI is one if the inferred labels correspond perfectly to the known labels, and it decreases with increasing disagreement.</p>
        <p>For the NMI, let <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>. Then <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> are the respective entropies of the two clusterings, and <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> is their mutual information. The NMI is then defined as <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:mi>N</mml:mi><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. Like the ARI the NMI is one for perfectly overlapping clusterings, and it decreases with increasing disagreement. It is bounded by zero from below. For ARI and NMI we report median values over 20 clustering runs in our clustering evaluation.</p>
        <p><bold><italic>Clustering in reduced dimensions.</italic></bold> We also evaluate clustering results after dimension reduction. To do so, we build on the results from evaluating dimension reduction with the NNE (see Section 2.4.2). For each similarity learning approach we assess the corresponding dimension reduction method with the smallest NNE and then perform standard k-means and hierarchical clustering in reduced dimensions. Results are then evaluated as described above. However, here, we use Pearson correlation and not Spearman correlation as a representative for generic similarity learning, because it performs slightly better (see <xref rid="bty260-T3" ref-type="table">Table 3</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.5 Data used and software availability</title>
      <p>Datasets used in the majority of our analyses are summarized in <xref rid="bty260-T1" ref-type="table">Table 1</xref>. Patel, Pollen, Goolam and Treutlein datasets were downloaded from <ext-link ext-link-type="uri" xlink:href="https://hemberg-lab.github.io/scRNA.seq.datasets/">https://hemberg-lab.github.io/scRNA.seq.datasets/</ext-link>; Usoskin, Buettner and Kolod datasets were downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/BatzoglouLabSU/SIMLR">https://github.com/BatzoglouLabSU/SIMLR</ext-link>. The Engel and Lin datasets can be found in the supporting material of <xref rid="bty260-B27" ref-type="bibr">Lin <italic>et al.</italic> (2017)</xref> and were downloaded from <ext-link ext-link-type="uri" xlink:href="http://128.2.210.230:">http://128.2.210.230:</ext-link>8080<ext-link ext-link-type="uri" xlink:href="http:///">/</ext-link>; the label ‘Lin’ in our result tables refers to the combination of three primary datasets described in the Section 2 there. Finally, the Leng dataset was obtained from <ext-link ext-link-type="uri" xlink:href="https://bioinfo.uth.edu/scrnaseqdb/">https://bioinfo.uth.edu/scrnaseqdb/</ext-link>.
<table-wrap id="bty260-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>List of datasets analyzed and their attributes</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1">Dataset</th><th align="left" rowspan="1" colspan="1">Number of cells</th><th align="left" rowspan="1" colspan="1">Number of genes</th><th align="left" rowspan="1" colspan="1">Number of populations</th><th align="left" rowspan="1" colspan="1">Sparsity (in %)</th><th align="left" rowspan="1" colspan="1">Units</th><th align="left" rowspan="1" colspan="1">References</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">Patel</td><td rowspan="1" colspan="1">430</td><td rowspan="1" colspan="1">5948</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">TPM</td><td rowspan="1" colspan="1"><xref rid="bty260-B29" ref-type="bibr">Patel <italic>et al.</italic> (2014)</xref></td></tr><tr><td rowspan="1" colspan="1">Buettener</td><td rowspan="1" colspan="1">182</td><td rowspan="1" colspan="1">9573</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">37</td><td rowspan="1" colspan="1">FPKM</td><td rowspan="1" colspan="1"><xref rid="bty260-B6" ref-type="bibr">Buettner <italic>et al.</italic> (2015)</xref></td></tr><tr><td rowspan="1" colspan="1">Engel</td><td rowspan="1" colspan="1">203</td><td rowspan="1" colspan="1">21 690</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">80</td><td rowspan="1" colspan="1">TPM</td><td rowspan="1" colspan="1"><xref rid="bty260-B9" ref-type="bibr">Engel <italic>et al.</italic> (2016)</xref></td></tr><tr><td rowspan="1" colspan="1">Kolod</td><td rowspan="1" colspan="1">704</td><td rowspan="1" colspan="1">13 473</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">CPM</td><td rowspan="1" colspan="1"><xref rid="bty260-B21" ref-type="bibr">Kolodziejczyk <italic>et al.</italic> (2015)</xref></td></tr><tr><td rowspan="1" colspan="1">Goolam</td><td rowspan="1" colspan="1">124</td><td rowspan="1" colspan="1">41 480</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">69</td><td rowspan="1" colspan="1">CPM</td><td rowspan="1" colspan="1"><xref rid="bty260-B11" ref-type="bibr">Goolam <italic>et al.</italic> (2016)</xref></td></tr><tr><td rowspan="1" colspan="1">Usoskin</td><td rowspan="1" colspan="1">622</td><td rowspan="1" colspan="1">17 772</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">78</td><td rowspan="1" colspan="1">RPM</td><td rowspan="1" colspan="1"><xref rid="bty260-B42" ref-type="bibr">Usoskin <italic>et al.</italic> (2015)</xref></td></tr><tr><td rowspan="1" colspan="1">Treutlein</td><td rowspan="1" colspan="1">80</td><td rowspan="1" colspan="1">23 271</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">90</td><td rowspan="1" colspan="1">FPKM</td><td rowspan="1" colspan="1"><xref rid="bty260-B41" ref-type="bibr">Treutlein <italic>et al.</italic> (2014)</xref></td></tr><tr><td rowspan="1" colspan="1">Leng</td><td rowspan="1" colspan="1">460</td><td rowspan="1" colspan="1">19 084</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">47</td><td rowspan="1" colspan="1">TPM</td><td rowspan="1" colspan="1"><xref rid="bty260-B25" ref-type="bibr">Leng and Kendziorski (2015)</xref></td></tr><tr><td rowspan="1" colspan="1">Pollen</td><td rowspan="1" colspan="1">301</td><td rowspan="1" colspan="1">9966</td><td rowspan="1" colspan="1">11</td><td rowspan="1" colspan="1">67</td><td rowspan="1" colspan="1">TPM</td><td rowspan="1" colspan="1"><xref rid="bty260-B30" ref-type="bibr">Pollen <italic>et al.</italic> (2014)</xref></td></tr><tr><td rowspan="1" colspan="1">Lin</td><td rowspan="1" colspan="1">402</td><td rowspan="1" colspan="1">9437</td><td rowspan="1" colspan="1">16</td><td rowspan="1" colspan="1">43</td><td rowspan="1" colspan="1">TPM</td><td rowspan="1" colspan="1"><xref rid="bty260-B27" ref-type="bibr">Lin <italic>et al.</italic> (2017)</xref></td></tr></tbody></table></table-wrap></p>
      <p>For our analysis underlying <xref ref-type="fig" rid="bty260-F1">Figure 1</xref>, the Usoskin and Kolod datasets were re-downloaded to obtain normalized expression values without batch corrections. For Usoskin, data were downloaded this information from the ‘External resource <xref rid="bty260-T1" ref-type="table">Table 1</xref>’, available at <ext-link ext-link-type="uri" xlink:href="http://linnarssonlab.org/drg/">http://linnarssonlab.org/drg/</ext-link>; for Kolod, data were downloaded from <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/teichmann-srv/espresso/">https://www.ebi.ac.uk/teichmann-srv/espresso/</ext-link>.
</p>
      <fig id="bty260-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>RAFSIL2 discovers unwanted variation. This figure shows tSNE plots for two datasets: data from <xref rid="bty260-B42" ref-type="bibr">Usoskin <italic>et al.</italic> (2015)</xref> in the first row, and from <xref rid="bty260-B21" ref-type="bibr">Kolodziejczyk <italic>et al.</italic> (2015)</xref> in the second row. Cells are colored according to biologically meaningful annotations in panels one and three, and according to technical covariates in panels two and four. In both datasets biological annotations are different cell types. Technical covariates are different picking sessions (first row) and different sequencing chips (second row). In the first row, we see that sub-structure in biologically meaningful groupings can be explained through technical variables for both methods. In the second row, this still holds true for RAFSIL2, but SIMLR does not highlight the unwanted technical variation present in the data (for more details see Section 3.2.2).</p>
        </caption>
        <graphic xlink:href="bty260f1"/>
      </fig>
      <p>The RAFSIL R package is available at <ext-link ext-link-type="uri" xlink:href="http://www.kostkalab.net/software.html">www.kostkalab.net/software.html</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 A random forest based approach for single cell similarity learning</title>
      <p>Here we present RAFSIL, a RF based approach for learning similarities from single cell RNA-sequencing data. RF based similarity learning (<xref rid="bty260-B35" ref-type="bibr">Shi and Horvath, 2006</xref>) is a way to apply RFs (<xref rid="bty260-B4" ref-type="bibr">Breiman, 2001</xref>) to unsupervised learning and derive similarities between objects (<xref rid="bty260-B5" ref-type="bibr">Breiman and Cutler, 2003</xref>; <xref rid="bty260-B35" ref-type="bibr">Shi and Horvath, 2006</xref>). In particular, RF based similarity learning is robust to outliers and has built-in feature selection, which is appealing for analyzing high-dimensional and noisy data, like single cell RNA sequencing profiles. We also note that this approach is fundamentally different from ensemble approaches working with multiple clusterings of a dataset, see (<xref rid="bty260-B48" ref-type="bibr">Yan <italic>et al.</italic>, 2013</xref>, Section 3). To apply RF based similarity learning to single cell RNA sequencing (scRNA-seq) data, we implemented an approach we call RAFSIL. It is a two-step procedure, where in the first step we pre-process scRNA-seq expression data (feature construction step) and in a second step then perform RF-based similarity learning (similarity learning step).</p>
      <p>The feature construction step is a heuristic approach designed to deal with the noise and sparsity typically present in scRNA-seq data (<xref rid="bty260-B49" ref-type="bibr">Yuan <italic>et al.</italic>, 2017</xref>). Briefly, we first find an orthogonal sub-space decomposition of the input space of cells, and then we describe each cell by its ‘local’ similarities to other cells in each sub-space separately, which we then aggregate to a final feature set. Details on the feature construction step are in Section 2.2.</p>
      <p>For the RF-based similarity learning step we explore two different approaches: RAFSIL1 and RAFSIL2. RAFSIL1 is a straight forward application of the methodology of <xref rid="bty260-B35" ref-type="bibr">Shi and Horvath (2006)</xref> to learn similarities between single cells described by the features recovered in our feature construction step. The general idea is to use RF to discriminate between the real and a synthetic dataset, where the latter is derived from the real data by applying perturbations that destroy feature correlations. Similarity between cells is then quantified by co-classification of pairs of cells via the same leaf across trees in the RF. For RAFSIL2, we apply RFs to unsupervised learning in a different way. For each feature, we quantize its values to derive class labels for cells, and then use the other features to predict these labels using a RF. Similarity is then quantified in the same way as described before. Details about RAFSIL1 and RAFSIL2 are in Sections 2.3.1 and 2.3.2.</p>
      <p>In the following, we show that RAFSIL1/2 compare favorably with current approaches across a variety of scenarios. We also show how the method enables identification of unwanted technical variation in scRNA-seq datasets.</p>
    </sec>
    <sec>
      <title>3.2 Similarities learned by random forests accurately characterize single cell RNA sequencing data</title>
      <p>We applied RAFSIL1 and RAFSIL2 to a diverse collection of single cell RNA sequencing datasets (<xref rid="bty260-T1" ref-type="table">Table 1</xref>) and compared their performance with state-of-the-art approaches. In our analyses, we distinguish three scenarios: similarity learning, dimension reduction and clustering. For similarity learning, we evaluate how well inferred pairwise similarities characterize pre-annotated cell populations (i.e. class labels for cells). For dimension reduction, we use the inferred similarities as features and project each cell into two dimensions. We then evaluate how well the resulting euclidean distances between projected cells characterize pre-annotated cell populations. Finally, we also evaluate how accurately inferred similarities allow clustering algorithms to reproduce available class labels; we apply clustering algorithms to two settings: the originally inferred similarities, and similarities in reduced-dimensional projections inferred by dimension reduction approaches.</p>
      <sec>
        <title>3.2.1 Similarity learning</title>
        <p><bold><italic>Random forest based similarities accurately capture cell population structure in scRNA-seq data.</italic></bold> We applied our RAFSIL algorithms to ten datasets (see <xref rid="bty260-T1" ref-type="table">Table 1</xref>), where labels for cell populations have been pre-annotated. We assess the learned similarities in terms of the NNE, which is the mis-classification rate of a nearest neighbor classifier (see Section 2.4.1 for details). We compare RAFSIL1/2 to SIMLR (<xref rid="bty260-B47" ref-type="bibr">Wang <italic>et al.</italic>, 2017</xref>b), which performs similarity learning specifically for scRNA-seq data, and to (dis)similarities as assessed by Euclidean distance, Spearman and Pearson correlation. For the latter three we assess three gene selection strategies: ALL, FRQ and only HiE; see Section 2.4 for a more detailed description.</p>
        <p>Results are summarized in <xref rid="bty260-T2" ref-type="table">Table 2</xref>. We see that RAFSIL1/2 and SIMLR learn similarities that accurately characterize annotated cell populations (i.e. they have low NNE). We also find that RAFSIL and SIMLR substantially outperform Euclidean distance and the two correlation-based similarities, and that RAFSIL2 shows the best overall performance. For the Euclidean distance and the correlation-based approaches we also observe that focusing on highly expressed genes improves performance for all of them.
<table-wrap id="bty260-T2" orientation="portrait" position="float"><label>Table 2.</label><caption><p>Nearest neighbor error values for similarity learning (in percent, lower is better)</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">Patel</th><th rowspan="1" colspan="1">Buttener</th><th rowspan="1" colspan="1">Engel</th><th rowspan="1" colspan="1">Kolod</th><th rowspan="1" colspan="1">Goolam</th><th rowspan="1" colspan="1">Usoskin</th><th rowspan="1" colspan="1">Treutlein</th><th rowspan="1" colspan="1">Leng</th><th rowspan="1" colspan="1">Pollen</th><th rowspan="1" colspan="1">Lin</th><th rowspan="1" colspan="1">Average</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">RAFSIL1</td><td rowspan="1" colspan="1">1.6</td><td rowspan="1" colspan="1">3.8</td><td rowspan="1" colspan="1">1.0</td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1">2.4</td><td rowspan="1" colspan="1">2.6</td><td rowspan="1" colspan="1">10.0</td><td rowspan="1" colspan="1">5.0</td><td rowspan="1" colspan="1">3.7</td><td rowspan="1" colspan="1"><bold>4.7</bold></td><td rowspan="1" colspan="1">3.5</td></tr><tr><td rowspan="1" colspan="1">RAFSIL2</td><td rowspan="1" colspan="1"><bold>1.4</bold></td><td rowspan="1" colspan="1">3.8</td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1">3.2</td><td rowspan="1" colspan="1"><bold>0.8</bold></td><td rowspan="1" colspan="1"><bold>6.2</bold></td><td rowspan="1" colspan="1"><bold>4.1</bold></td><td rowspan="1" colspan="1">4.3</td><td rowspan="1" colspan="1">5.2</td><td rowspan="1" colspan="1"><bold>2.9</bold></td></tr><tr><td rowspan="1" colspan="1">SIMLR</td><td rowspan="1" colspan="1">2.4</td><td rowspan="1" colspan="1"><bold>1.6</bold></td><td rowspan="1" colspan="1">3.4</td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">3.1</td><td align="center" rowspan="1" colspan="1">(25)<xref ref-type="table-fn" rid="tblfn3"><sup>a</sup></xref></td><td rowspan="1" colspan="1">14.8</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">6.2</td><td rowspan="1" colspan="1">6.0</td></tr><tr><td rowspan="1" colspan="1">Pearson-ALL</td><td rowspan="1" colspan="1">1.9</td><td rowspan="1" colspan="1">57.7</td><td rowspan="1" colspan="1">38.9</td><td rowspan="1" colspan="1">9.7</td><td rowspan="1" colspan="1">3.2</td><td rowspan="1" colspan="1">10.5</td><td rowspan="1" colspan="1">20.0</td><td rowspan="1" colspan="1">49.6</td><td rowspan="1" colspan="1">12.3</td><td rowspan="1" colspan="1">14.4</td><td rowspan="1" colspan="1">21.8</td></tr><tr><td rowspan="1" colspan="1">Pearson-FRQ</td><td rowspan="1" colspan="1">2.1</td><td rowspan="1" colspan="1">58.2</td><td rowspan="1" colspan="1">42.4</td><td rowspan="1" colspan="1">10.4</td><td rowspan="1" colspan="1">2.4</td><td rowspan="1" colspan="1">7.2</td><td rowspan="1" colspan="1">12.5</td><td rowspan="1" colspan="1">42.8</td><td rowspan="1" colspan="1">10.3</td><td rowspan="1" colspan="1">14.7</td><td rowspan="1" colspan="1">20.3</td></tr><tr><td rowspan="1" colspan="1">Pearson-HiE</td><td rowspan="1" colspan="1">3.5</td><td rowspan="1" colspan="1">33.5</td><td rowspan="1" colspan="1">15.3</td><td rowspan="1" colspan="1">9.8</td><td rowspan="1" colspan="1">1.6</td><td rowspan="1" colspan="1">4.7</td><td rowspan="1" colspan="1">11.2</td><td rowspan="1" colspan="1">48.5</td><td rowspan="1" colspan="1">6.3</td><td rowspan="1" colspan="1">10.4</td><td rowspan="1" colspan="1">14.5</td></tr><tr><td rowspan="1" colspan="1">Spearman-ALL</td><td rowspan="1" colspan="1">2.8</td><td rowspan="1" colspan="1">57.7</td><td rowspan="1" colspan="1">12.8</td><td rowspan="1" colspan="1">0.9</td><td rowspan="1" colspan="1"><bold>0.8</bold></td><td rowspan="1" colspan="1">15.1</td><td rowspan="1" colspan="1">28.8</td><td rowspan="1" colspan="1">58.7</td><td rowspan="1" colspan="1">2.0</td><td rowspan="1" colspan="1">13.7</td><td rowspan="1" colspan="1">19.3</td></tr><tr><td rowspan="1" colspan="1">Spearman-FRQ</td><td rowspan="1" colspan="1">1.9</td><td rowspan="1" colspan="1">57.7</td><td rowspan="1" colspan="1">10.3</td><td rowspan="1" colspan="1">0.9</td><td rowspan="1" colspan="1"><bold>0.8</bold></td><td rowspan="1" colspan="1">10.1</td><td rowspan="1" colspan="1">8.8</td><td rowspan="1" colspan="1">44.6</td><td rowspan="1" colspan="1"><bold>1.7</bold></td><td rowspan="1" colspan="1">13.2</td><td rowspan="1" colspan="1">15.0</td></tr><tr><td rowspan="1" colspan="1">Spearman-HiE</td><td rowspan="1" colspan="1">14.4</td><td rowspan="1" colspan="1">43.4</td><td rowspan="1" colspan="1">9.9</td><td rowspan="1" colspan="1">1.8</td><td rowspan="1" colspan="1">2.4</td><td rowspan="1" colspan="1">7.4</td><td rowspan="1" colspan="1">10.0</td><td rowspan="1" colspan="1">29.1</td><td rowspan="1" colspan="1">5.3</td><td rowspan="1" colspan="1">8.5</td><td rowspan="1" colspan="1">13.2</td></tr><tr><td rowspan="1" colspan="1">Euclidean-ALL</td><td rowspan="1" colspan="1">30.0</td><td rowspan="1" colspan="1">51.6</td><td rowspan="1" colspan="1">48.3</td><td rowspan="1" colspan="1">24.7</td><td rowspan="1" colspan="1">2.4</td><td rowspan="1" colspan="1">14.5</td><td rowspan="1" colspan="1">21.2</td><td rowspan="1" colspan="1">44.6</td><td rowspan="1" colspan="1">6.0</td><td rowspan="1" colspan="1">22.4</td><td rowspan="1" colspan="1">26.6</td></tr><tr><td rowspan="1" colspan="1">Euclidean-FRQ</td><td rowspan="1" colspan="1">2.1</td><td rowspan="1" colspan="1">57.7</td><td rowspan="1" colspan="1">39.9</td><td rowspan="1" colspan="1">10.5</td><td rowspan="1" colspan="1">2.4</td><td rowspan="1" colspan="1">7.4</td><td rowspan="1" colspan="1">12.5</td><td rowspan="1" colspan="1">45.9</td><td rowspan="1" colspan="1">9.3</td><td rowspan="1" colspan="1">13.7</td><td rowspan="1" colspan="1">20.1</td></tr><tr><td rowspan="1" colspan="1">Euclidean-HiE</td><td rowspan="1" colspan="1">4.0</td><td rowspan="1" colspan="1">33.5</td><td rowspan="1" colspan="1">13.8</td><td rowspan="1" colspan="1">8.8</td><td rowspan="1" colspan="1">1.6</td><td rowspan="1" colspan="1">3.7</td><td rowspan="1" colspan="1">12.5</td><td rowspan="1" colspan="1">47.4</td><td rowspan="1" colspan="1">7.0</td><td rowspan="1" colspan="1">10.7</td><td rowspan="1" colspan="1">14.3</td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p>ALL, all expressed genes; FRQ, frequency-filtered genes; HiE, highly-expressed genes.</p></fn><fn id="tblfn2"><p>The best-performing method in each column is in boldface.</p></fn><fn id="tblfn3"><label>a</label><p>Parentheses indicate that SIMLR was run with different parameters for this dataset.</p></fn></table-wrap-foot></table-wrap></p>
      </sec>
      <sec>
        <title>3.2.2 Dimension reduction</title>
        <p><bold><italic>Dimension reduction improves similarity learning.</italic></bold> We performed dimension reduction on the learned similarities obtained from RAFSIL1/2, and compared results with the same methods used in the previous section: SIMLR and Euclidean distance, as well as Spearman and Pearson correlation. We again use the NNE as a quality metric (on Euclidean distances in the reduced-dimensional space, for all methods), and results are summarized in <xref rid="bty260-T3" ref-type="table">Table 3</xref>. As a baseline approach we also included dimension reduction directly on the expression data (Data in <xref rid="bty260-T3" ref-type="table">Table 3</xref>); this is different from the other methods, where we apply dimension reduction to cells described by their similarities with other cells (see Section 2.4.2).
<table-wrap id="bty260-T3" orientation="portrait" position="float"><label>Table 3.</label><caption><p>Nearest neighbor error values for dimension reduction (in percent, lower is better)</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">Patel</th><th rowspan="1" colspan="1">Buttener</th><th rowspan="1" colspan="1">Engel</th><th rowspan="1" colspan="1">Kolod</th><th rowspan="1" colspan="1">Goolam</th><th rowspan="1" colspan="1">Usoskin</th><th rowspan="1" colspan="1">Treutlein</th><th rowspan="1" colspan="1">Leng</th><th rowspan="1" colspan="1">Pollen</th><th rowspan="1" colspan="1">Lin</th><th rowspan="1" colspan="1">Average</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">RAFSIL1-tSNE</td><td rowspan="1" colspan="1"><bold>1.9</bold></td><td rowspan="1" colspan="1">3.8</td><td rowspan="1" colspan="1">0.5</td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1">4.0</td><td rowspan="1" colspan="1">1.0</td><td rowspan="1" colspan="1">7.5</td><td rowspan="1" colspan="1"><bold>4.1</bold></td><td rowspan="1" colspan="1">2.7</td><td rowspan="1" colspan="1"><bold>5.5</bold></td><td rowspan="1" colspan="1"><bold>3.1</bold></td></tr><tr><td rowspan="1" colspan="1">RAFSIL1-PCA</td><td rowspan="1" colspan="1">8.1</td><td rowspan="1" colspan="1">4.4</td><td rowspan="1" colspan="1">11.3</td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1">9.7</td><td rowspan="1" colspan="1">21.5</td><td rowspan="1" colspan="1">12.5</td><td rowspan="1" colspan="1">26.5</td><td rowspan="1" colspan="1">12.6</td><td rowspan="1" colspan="1">24.9</td><td rowspan="1" colspan="1">13.2</td></tr><tr><td rowspan="1" colspan="1">RAFSIL1-pPCA</td><td rowspan="1" colspan="1">7.7</td><td rowspan="1" colspan="1">4.4</td><td rowspan="1" colspan="1">11.3</td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1">9.7</td><td rowspan="1" colspan="1">22.5</td><td rowspan="1" colspan="1">15.0</td><td rowspan="1" colspan="1">25.4</td><td rowspan="1" colspan="1">12.3</td><td rowspan="1" colspan="1">24.4</td><td rowspan="1" colspan="1">13.3</td></tr><tr><td rowspan="1" colspan="1">RAFSIL2-tSNE</td><td rowspan="1" colspan="1"><bold>1.9</bold></td><td rowspan="1" colspan="1">2.7</td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1">4.8</td><td rowspan="1" colspan="1"><bold>0.6</bold></td><td rowspan="1" colspan="1">6.2</td><td rowspan="1" colspan="1">4.6</td><td rowspan="1" colspan="1">4.0</td><td rowspan="1" colspan="1">9.2</td><td rowspan="1" colspan="1">3.4</td></tr><tr><td rowspan="1" colspan="1">RAFSIL2-PCA</td><td rowspan="1" colspan="1">10.2</td><td rowspan="1" colspan="1">6.6</td><td rowspan="1" colspan="1">5.9</td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1">4.8</td><td rowspan="1" colspan="1">5.6</td><td rowspan="1" colspan="1">12.5</td><td rowspan="1" colspan="1">25.9</td><td rowspan="1" colspan="1">16.3</td><td rowspan="1" colspan="1">33.1</td><td rowspan="1" colspan="1">12.1</td></tr><tr><td rowspan="1" colspan="1">RAFSIL2-pPCA</td><td rowspan="1" colspan="1">9.8</td><td rowspan="1" colspan="1">7.1</td><td rowspan="1" colspan="1">4.9</td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1">4.0</td><td rowspan="1" colspan="1">5.3</td><td rowspan="1" colspan="1">11.2</td><td rowspan="1" colspan="1">26.3</td><td rowspan="1" colspan="1">14.3</td><td rowspan="1" colspan="1">30.6</td><td rowspan="1" colspan="1">11.4</td></tr><tr><td rowspan="1" colspan="1">SIMLR-tSNE</td><td rowspan="1" colspan="1">3.7</td><td rowspan="1" colspan="1">3.3</td><td rowspan="1" colspan="1">4.4</td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1">4.8</td><td rowspan="1" colspan="1">5.5</td><td rowspan="1" colspan="1">(26.2)<xref ref-type="table-fn" rid="tblfn6"><sup>a</sup></xref></td><td rowspan="1" colspan="1">19.8</td><td rowspan="1" colspan="1">3.0</td><td rowspan="1" colspan="1">15.7</td><td rowspan="1" colspan="1">8.6</td></tr><tr><td rowspan="1" colspan="1">SIMLR-PCA</td><td rowspan="1" colspan="1">6.7</td><td rowspan="1" colspan="1"><bold>2.2</bold></td><td rowspan="1" colspan="1">27.1</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">11.3</td><td rowspan="1" colspan="1">6.4</td><td rowspan="1" colspan="1">(43.8)</td><td rowspan="1" colspan="1">36.3</td><td rowspan="1" colspan="1">22.9</td><td rowspan="1" colspan="1">51.0</td><td rowspan="1" colspan="1">20.8</td></tr><tr><td rowspan="1" colspan="1">SIMLR-pPCA</td><td rowspan="1" colspan="1">7.4</td><td rowspan="1" colspan="1"><bold>2.2</bold></td><td rowspan="1" colspan="1">27.6</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">9.7</td><td rowspan="1" colspan="1">5.9</td><td align="center" rowspan="1" colspan="1">(45)</td><td rowspan="1" colspan="1">37.0</td><td rowspan="1" colspan="1">22.3</td><td rowspan="1" colspan="1">53.2</td><td rowspan="1" colspan="1">21.0</td></tr><tr><td rowspan="1" colspan="1">Data-HiE-tSNE</td><td rowspan="1" colspan="1">7.4</td><td rowspan="1" colspan="1">12.1</td><td rowspan="1" colspan="1">14.3</td><td rowspan="1" colspan="1">0.3</td><td rowspan="1" colspan="1">1.6</td><td rowspan="1" colspan="1">3.7</td><td rowspan="1" colspan="1">15.0</td><td rowspan="1" colspan="1">37.0</td><td rowspan="1" colspan="1">3.3</td><td rowspan="1" colspan="1">10.7</td><td rowspan="1" colspan="1">10.5</td></tr><tr><td rowspan="1" colspan="1">Data-HiE-PCA</td><td rowspan="1" colspan="1">40.7</td><td rowspan="1" colspan="1">25.8</td><td rowspan="1" colspan="1">13.3</td><td rowspan="1" colspan="1">1.4</td><td rowspan="1" colspan="1">4.8</td><td rowspan="1" colspan="1">34.1</td><td rowspan="1" colspan="1">31.2</td><td rowspan="1" colspan="1">56.1</td><td rowspan="1" colspan="1">16.3</td><td rowspan="1" colspan="1">40.5</td><td rowspan="1" colspan="1">26.4</td></tr><tr><td rowspan="1" colspan="1">Data-HiE-pPCA</td><td rowspan="1" colspan="1">40.5</td><td rowspan="1" colspan="1">28.6</td><td rowspan="1" colspan="1">14.3</td><td rowspan="1" colspan="1">1.4</td><td rowspan="1" colspan="1">7.3</td><td rowspan="1" colspan="1">33.3</td><td rowspan="1" colspan="1">32.5</td><td rowspan="1" colspan="1">57.4</td><td rowspan="1" colspan="1">17.3</td><td rowspan="1" colspan="1">41.5</td><td rowspan="1" colspan="1">27.4</td></tr><tr><td rowspan="1" colspan="1">Euclidean-HiE-tSNE</td><td rowspan="1" colspan="1">4.4</td><td rowspan="1" colspan="1">4.4</td><td rowspan="1" colspan="1">3.9</td><td rowspan="1" colspan="1">0.4</td><td rowspan="1" colspan="1">6.5</td><td rowspan="1" colspan="1">8.2</td><td rowspan="1" colspan="1">23.8</td><td rowspan="1" colspan="1">39.1</td><td rowspan="1" colspan="1">5.3</td><td rowspan="1" colspan="1">21.1</td><td rowspan="1" colspan="1">11.7</td></tr><tr><td rowspan="1" colspan="1">Euclidean-HiE-PCA</td><td rowspan="1" colspan="1">36.5</td><td rowspan="1" colspan="1">7.7</td><td rowspan="1" colspan="1">35.0</td><td rowspan="1" colspan="1">7.0</td><td rowspan="1" colspan="1">25.8</td><td rowspan="1" colspan="1">58.7</td><td rowspan="1" colspan="1">32.5</td><td rowspan="1" colspan="1">52.8</td><td rowspan="1" colspan="1">19.9</td><td rowspan="1" colspan="1">39.1</td><td rowspan="1" colspan="1">31.5</td></tr><tr><td rowspan="1" colspan="1">Euclidean-HiE-pPCA</td><td rowspan="1" colspan="1">36.0</td><td rowspan="1" colspan="1">8.8</td><td rowspan="1" colspan="1">39.4</td><td rowspan="1" colspan="1">6.8</td><td rowspan="1" colspan="1">28.2</td><td rowspan="1" colspan="1">57.7</td><td rowspan="1" colspan="1">32.5</td><td rowspan="1" colspan="1">53.0</td><td rowspan="1" colspan="1">20.3</td><td rowspan="1" colspan="1">38.8</td><td rowspan="1" colspan="1">32.2</td></tr><tr><td rowspan="1" colspan="1">Pearson-HiE-tSNE</td><td rowspan="1" colspan="1">2.8</td><td rowspan="1" colspan="1">9.3</td><td rowspan="1" colspan="1">3.0</td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1">1.6</td><td rowspan="1" colspan="1">2.1</td><td rowspan="1" colspan="1">17.5</td><td rowspan="1" colspan="1">24.1</td><td rowspan="1" colspan="1"><bold>2.3</bold></td><td rowspan="1" colspan="1">20.1</td><td rowspan="1" colspan="1">8.3</td></tr><tr><td rowspan="1" colspan="1">Pearson-HiE-PCA</td><td rowspan="1" colspan="1">25.1</td><td rowspan="1" colspan="1">23.1</td><td rowspan="1" colspan="1">16.3</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">2.4</td><td rowspan="1" colspan="1">27.8</td><td rowspan="1" colspan="1">12.5</td><td rowspan="1" colspan="1">49.1</td><td rowspan="1" colspan="1">10.6</td><td rowspan="1" colspan="1">27.9</td><td rowspan="1" colspan="1">19.5</td></tr><tr><td rowspan="1" colspan="1">Pearson-HiE-pPCA</td><td rowspan="1" colspan="1">24.0</td><td rowspan="1" colspan="1">23.1</td><td rowspan="1" colspan="1">17.2</td><td rowspan="1" colspan="1">0.3</td><td rowspan="1" colspan="1">2.4</td><td rowspan="1" colspan="1">27.5</td><td rowspan="1" colspan="1">15.0</td><td rowspan="1" colspan="1">47.6</td><td rowspan="1" colspan="1">11.3</td><td rowspan="1" colspan="1">28.1</td><td rowspan="1" colspan="1">19.7</td></tr><tr><td rowspan="1" colspan="1">Spearman-HiE-tSNE</td><td rowspan="1" colspan="1">3.3</td><td rowspan="1" colspan="1">11.0</td><td rowspan="1" colspan="1">1.0</td><td rowspan="1" colspan="1"><bold>0.0</bold></td><td rowspan="1" colspan="1"><bold>0.8</bold></td><td rowspan="1" colspan="1">3.2</td><td rowspan="1" colspan="1"><bold>5.0</bold></td><td rowspan="1" colspan="1">15.4</td><td rowspan="1" colspan="1">3.0</td><td rowspan="1" colspan="1">18.4</td><td rowspan="1" colspan="1">6.1</td></tr><tr><td rowspan="1" colspan="1">Spearman-HiE-PCA</td><td rowspan="1" colspan="1">37.2</td><td rowspan="1" colspan="1">26.9</td><td rowspan="1" colspan="1">9.4</td><td rowspan="1" colspan="1">0.3</td><td rowspan="1" colspan="1"><bold>0.8</bold></td><td rowspan="1" colspan="1">33.4</td><td rowspan="1" colspan="1"><bold>5.0</bold></td><td rowspan="1" colspan="1">61.7</td><td rowspan="1" colspan="1">13.0</td><td rowspan="1" colspan="1">32.3</td><td rowspan="1" colspan="1">22.0</td></tr><tr><td rowspan="1" colspan="1">Spearman-HiE-pPCA</td><td rowspan="1" colspan="1">36.3</td><td rowspan="1" colspan="1">27.5</td><td rowspan="1" colspan="1">12.8</td><td rowspan="1" colspan="1">0.3</td><td rowspan="1" colspan="1">3.2</td><td rowspan="1" colspan="1">32.5</td><td rowspan="1" colspan="1">6.2</td><td rowspan="1" colspan="1">59.1</td><td rowspan="1" colspan="1">12.6</td><td rowspan="1" colspan="1">30.6</td><td rowspan="1" colspan="1">22.1</td></tr></tbody></table><table-wrap-foot><fn id="tblfn4"><p>tSNE, t stochastic neighbor embedding; PCA, principal component analysis; pPCA, probabilistic PCA.</p></fn><fn id="tblfn5"><p>The best-performing method in each column is in boldface.</p></fn><fn id="tblfn6"><label>a</label><p>Parentheses indicate that SIMLR was run with different parameters for this dataset.</p></fn></table-wrap-foot></table-wrap></p>
        <p>We observe that dimension reductions obtained using tSNE (<xref rid="bty260-B44" ref-type="bibr">van der Maaten and Hinton, 2008</xref>) perform better (on average) than those obtained with PCA or pPCA. Interestingly, we find that (dis)similarities in the reduced-dimensional space perform almost always better than in the original (dis)similarities (see <xref rid="bty260-T3" ref-type="table">Table 3</xref>). The main exception is RAFSIL2, which performs better using original similarities. We again see that approaches designed for scRNA-seq typically outperform more generic methods, and RAFSIL1 and RAFSIL2 have lower NNE compared with SIMLR. We note that Spearman correlation on highly-expressed genes, followed by tSNE, has good average performance comparable with RAFSIL1/2 and SIMLR.</p>
        <p>We also visualize results from similarity learning and dimension reduction in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>. We find clear differences in the inferred similarities between methods for some datasets (especially for Leng and Usoskin, but also for Buettner), and this is reflected in the respective two-dimensional projections. Overall, RAFSIL and SIMLR are able to more clearly separate cell populations compared with Euclidean distance and Spearman correlation. Also, we note that the good performance of RAFSIL2 (in terms of NNE, see <xref rid="bty260-T3" ref-type="table">Table 3</xref>) is clearly reflected, probably most pronounced for the Leng dataset. Overall, this shows that RAFSIL2 can improve the visualization (and therefore discovery) of group/population structure in scRNA-seq data.</p>
        <p><bold><italic>RAFSIL can discover unwanted variation in scRNA-seq data.</italic></bold> In practice, dimension reduction is typically used for exploratory data analysis, for instance to find group structure in the data that might correspond to novel (sub)populations of cells. However, it can also be a valuable tool for data quality control, for instance when color coding additional information about cells (covariates) in a two-dimensional projection of the data. <xref ref-type="fig" rid="bty260-F1">Figure 1</xref> demonstrates this approach. The first row depicts tSNE plots for the Usoskin dataset, with RAFSIL2 projections in the first two panels and SIMLR projections in panels three and four. Color coding each cell with biological labels (four principal neuronal types) we see a clear separation with both approaches (panels one and three), but with substantial structure inside each neuronal cell type. Panels two and three reveal that this structure is likely a technical artifact. In these panels, we color the cells according to a technical variable (different cell picking sessions). For both approaches, RAFSIL and SIMLR, we clearly see that the perceived sub-structure in different neuronal types can largely be explained by the picking session. For clarity, we have annotated one cell type (tyrosine hydroxylase containing neurons) in panels one and three with the colors of the technical annotation in the adjacent plot that correlate with prominent sub-clusters.</p>
        <p>The second row in <xref ref-type="fig" rid="bty260-F1">Figure 1</xref> is set up in the same way, just this time using the data of <xref rid="bty260-B21" ref-type="bibr">Kolodziejczyk <italic>et al.</italic> (2015)</xref>. Here, the biological color coding corresponds to different culturing conditions of mouse embryonic stem cells, while the technical variable denotes different sequencing chips. In the RAFSIL representation (panels one and two), we again see sub-structure in the biological annotation that perfectly corresponds to technical annotation (different sequencing chips). For this dataset SIMLR also recapitulates the biological group structure (panel three), but does not pick up the presence of confounding technical variation (panel four).</p>
        <p>In summary, <xref ref-type="fig" rid="bty260-F1">Figure 1</xref> shows that RAFSIL can detect unwanted technical variation in scRNA-seq data, also in cases where other methods do not. We note that in both publications the authors corrected for batch effects, and we have used the uncorrected data for these analyses. In practice, this type of approach is mainly useful to assess if corrections for known technical factors are successful, or to rule out that discovered group structure corresponds to known covariates. Also, we note that the choice of dimension reduction technique plays a role in these analyses; for instance, when using PCA instead of tSNE things become considerably less clear (data not shown). However, this is not unexpected given the good performance of tSNE as a dimension reduction method (see <xref rid="bty260-T3" ref-type="table">Table 3</xref>).</p>
      </sec>
      <sec>
        <title>3.2.3 Clustering</title>
        <p><bold><italic>Random forest based similarities accurately recapitulate annotated cell populations.</italic></bold> Next, we explored the performance of RAFSIL1/2 in terms of cell clustering, which is commonly used to discover population/group structure in scRNA-seq data and constitutes an essential step for most analyses in this field. To do so, we used the dissimilarities learned by RAFSIL1/2 in two ways: (i) to perform hierarchical clustering of cells (HC) and (ii) as input for k-means clustering (KM), taking each cell as a vector of its similarities with all cells in the dataset. We use the ARI and NMI as quality measures (see Section 2.4.3 for details), and results are summarized in <xref rid="bty260-T4" ref-type="table">Table 4</xref>. As before, we compared RAFSIL1/2 to SIMLR and Spearman correlation, and added the direct application of HC and KM to the expression data (Data in <xref rid="bty260-T4" ref-type="table">Table 4</xref>). Because there are more methods for clustering scRNA-seq data than for similarity learning, we added additional comparisons with SC3, SINCERA and pcaReduce that do not implement similarity learning but perform clustering.
<table-wrap id="bty260-T4" orientation="portrait" position="float"><label>Table 4.</label><caption><p>ARI and NMI values for clustering methods across ten datasets (in percent, higher is better)</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1"/><th colspan="2" rowspan="1">Patel<hr/></th><th colspan="2" rowspan="1">Buettner<hr/></th><th colspan="2" rowspan="1">Engel<hr/></th><th colspan="2" rowspan="1">Kolod<hr/></th><th colspan="2" rowspan="1">Goolam<hr/></th><th colspan="2" rowspan="1">Usoskin<hr/></th><th colspan="2" rowspan="1">Treutlein<hr/></th><th colspan="2" rowspan="1">Leng<hr/></th><th colspan="2" rowspan="1">Pollen<hr/></th><th colspan="2" rowspan="1">Lin<hr/></th><th colspan="2" rowspan="1">Average<hr/></th></tr><tr><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">RAFSIL1-KM</td><td rowspan="1" colspan="1">89.6</td><td rowspan="1" colspan="1">88.4</td><td rowspan="1" colspan="1"><bold>93.5</bold></td><td rowspan="1" colspan="1"><bold>90.5</bold></td><td rowspan="1" colspan="1">27.7</td><td rowspan="1" colspan="1">47.0</td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1">54.4</td><td rowspan="1" colspan="1">73.5</td><td rowspan="1" colspan="1">76.9</td><td rowspan="1" colspan="1">77.8</td><td rowspan="1" colspan="1">34.8</td><td rowspan="1" colspan="1">59.2</td><td rowspan="1" colspan="1"><bold>49.7</bold></td><td rowspan="1" colspan="1"><bold>63.2</bold></td><td rowspan="1" colspan="1">84.4</td><td rowspan="1" colspan="1">92.0</td><td rowspan="1" colspan="1">51.9</td><td rowspan="1" colspan="1">73.6</td><td rowspan="1" colspan="1">66.3</td><td rowspan="1" colspan="1">76.5</td></tr><tr><td rowspan="1" colspan="1">RAFSIL1-HC</td><td rowspan="1" colspan="1">95.8</td><td rowspan="1" colspan="1">94.3</td><td rowspan="1" colspan="1">90.4</td><td rowspan="1" colspan="1">87.1</td><td rowspan="1" colspan="1">34.6</td><td rowspan="1" colspan="1">46.3</td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>91.4</bold></td><td rowspan="1" colspan="1"><bold>90.6</bold></td><td rowspan="1" colspan="1">75.0</td><td rowspan="1" colspan="1">73.0</td><td rowspan="1" colspan="1">54.3</td><td rowspan="1" colspan="1">68.9</td><td rowspan="1" colspan="1">43.4</td><td rowspan="1" colspan="1">58.4</td><td rowspan="1" colspan="1">85.1</td><td rowspan="1" colspan="1">93.6</td><td rowspan="1" colspan="1">53.1</td><td rowspan="1" colspan="1">76.7</td><td rowspan="1" colspan="1">72.3</td><td rowspan="1" colspan="1">78.9</td></tr><tr><td rowspan="1" colspan="1">RAFSIL2-KM</td><td rowspan="1" colspan="1">88.5</td><td rowspan="1" colspan="1">87.5</td><td rowspan="1" colspan="1">81.6</td><td rowspan="1" colspan="1">76.6</td><td rowspan="1" colspan="1">75.8</td><td rowspan="1" colspan="1">76.8</td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1">54.4</td><td rowspan="1" colspan="1">73.5</td><td rowspan="1" colspan="1">64.7</td><td rowspan="1" colspan="1">75.4</td><td rowspan="1" colspan="1">55.3</td><td rowspan="1" colspan="1">72.4</td><td rowspan="1" colspan="1">39.1</td><td rowspan="1" colspan="1">50.1</td><td rowspan="1" colspan="1">82.6</td><td rowspan="1" colspan="1">91.8</td><td rowspan="1" colspan="1">49.2</td><td rowspan="1" colspan="1">72.5</td><td rowspan="1" colspan="1">69.1</td><td rowspan="1" colspan="1">77.7</td></tr><tr><td rowspan="1" colspan="1">RAFSIL2-HC</td><td rowspan="1" colspan="1">97.0</td><td rowspan="1" colspan="1">95.5</td><td rowspan="1" colspan="1">84.3</td><td rowspan="1" colspan="1">80.6</td><td rowspan="1" colspan="1"><bold>93.4</bold></td><td rowspan="1" colspan="1"><bold>92.6</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>91.4</bold></td><td rowspan="1" colspan="1"><bold>90.6</bold></td><td rowspan="1" colspan="1"><bold>92.6</bold></td><td rowspan="1" colspan="1"><bold>90.0</bold></td><td rowspan="1" colspan="1"><bold>88.9</bold></td><td rowspan="1" colspan="1"><bold>82.4</bold></td><td rowspan="1" colspan="1">36.7</td><td rowspan="1" colspan="1">53.0</td><td rowspan="1" colspan="1">91.6</td><td rowspan="1" colspan="1"><bold>95.5</bold></td><td rowspan="1" colspan="1">54.7</td><td rowspan="1" colspan="1">81.2</td><td rowspan="1" colspan="1"><bold>83.1</bold></td><td rowspan="1" colspan="1"><bold>86.1</bold></td></tr><tr><td rowspan="1" colspan="1">SIMLR</td><td rowspan="1" colspan="1">80.9</td><td rowspan="1" colspan="1">84.9</td><td rowspan="1" colspan="1">88.8</td><td rowspan="1" colspan="1">88.8</td><td rowspan="1" colspan="1">10.6</td><td rowspan="1" colspan="1">25.7</td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1">47.1</td><td rowspan="1" colspan="1">65.5</td><td rowspan="1" colspan="1">66.0</td><td rowspan="1" colspan="1">72.8</td><td rowspan="1" colspan="1">(23.8)<xref ref-type="table-fn" rid="tblfn9"><sup>a</sup></xref></td><td rowspan="1" colspan="1">(45.6)</td><td rowspan="1" colspan="1">24.0</td><td rowspan="1" colspan="1">34.4</td><td rowspan="1" colspan="1">84.4</td><td rowspan="1" colspan="1">92.2</td><td rowspan="1" colspan="1">42.2</td><td rowspan="1" colspan="1">74.2</td><td rowspan="1" colspan="1">56.8</td><td rowspan="1" colspan="1">68.4</td></tr><tr><td rowspan="1" colspan="1">SC3</td><td rowspan="1" colspan="1"><bold>98.9</bold></td><td rowspan="1" colspan="1"><bold>98.4</bold></td><td rowspan="1" colspan="1">88.7</td><td rowspan="1" colspan="1">86.1</td><td rowspan="1" colspan="1">46.0</td><td rowspan="1" colspan="1">64.2</td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1">54.4</td><td rowspan="1" colspan="1">73.5</td><td rowspan="1" colspan="1">84.5</td><td rowspan="1" colspan="1">81.6</td><td rowspan="1" colspan="1">54.3</td><td rowspan="1" colspan="1">63.1</td><td rowspan="1" colspan="1">32.8</td><td rowspan="1" colspan="1">55.5</td><td rowspan="1" colspan="1"><bold>95.8</bold></td><td rowspan="1" colspan="1">95.3</td><td rowspan="1" colspan="1"><bold>58.8</bold></td><td rowspan="1" colspan="1"><bold>82.1</bold></td><td rowspan="1" colspan="1">71.4</td><td rowspan="1" colspan="1">80.0</td></tr><tr><td rowspan="1" colspan="1">pcaReduce</td><td rowspan="1" colspan="1">47.8</td><td rowspan="1" colspan="1">60.3</td><td rowspan="1" colspan="1">39.8</td><td rowspan="1" colspan="1">45.9</td><td rowspan="1" colspan="1">17.4</td><td rowspan="1" colspan="1">18.2</td><td rowspan="1" colspan="1">96.1</td><td rowspan="1" colspan="1">94.2</td><td rowspan="1" colspan="1">45.9</td><td rowspan="1" colspan="1">62.2</td><td rowspan="1" colspan="1">54.7</td><td rowspan="1" colspan="1">60.4</td><td rowspan="1" colspan="1">37.6</td><td rowspan="1" colspan="1">38.6</td><td rowspan="1" colspan="1">21.7</td><td rowspan="1" colspan="1">25.5</td><td rowspan="1" colspan="1">89.1</td><td rowspan="1" colspan="1">93.1</td><td rowspan="1" colspan="1">51.3</td><td rowspan="1" colspan="1">74.4</td><td rowspan="1" colspan="1">50.1</td><td rowspan="1" colspan="1">57.3</td></tr><tr><td rowspan="1" colspan="1">SINCERA</td><td rowspan="1" colspan="1">91.3</td><td rowspan="1" colspan="1">89.8</td><td rowspan="1" colspan="1">50.7</td><td rowspan="1" colspan="1">47.6</td><td rowspan="1" colspan="1">23.0</td><td rowspan="1" colspan="1">31.1</td><td rowspan="1" colspan="1">99.6</td><td rowspan="1" colspan="1">99.2</td><td rowspan="1" colspan="1">39.3</td><td rowspan="1" colspan="1">58.0</td><td rowspan="1" colspan="1">52.4</td><td rowspan="1" colspan="1">61.7</td><td rowspan="1" colspan="1">27.8</td><td rowspan="1" colspan="1">50.5</td><td rowspan="1" colspan="1">8.7</td><td rowspan="1" colspan="1">12.3</td><td rowspan="1" colspan="1">85.5</td><td rowspan="1" colspan="1">93.4</td><td rowspan="1" colspan="1">45.5</td><td rowspan="1" colspan="1">69.4</td><td rowspan="1" colspan="1">52.4</td><td rowspan="1" colspan="1">61.3</td></tr><tr><td rowspan="1" colspan="1">Spearman-HiE-KM</td><td rowspan="1" colspan="1">35.0</td><td rowspan="1" colspan="1">46.2</td><td rowspan="1" colspan="1">25.4</td><td rowspan="1" colspan="1">33.3</td><td rowspan="1" colspan="1">67.7</td><td rowspan="1" colspan="1">63.6</td><td rowspan="1" colspan="1">45.7</td><td rowspan="1" colspan="1">51.2</td><td rowspan="1" colspan="1">64.7</td><td rowspan="1" colspan="1">80.3</td><td rowspan="1" colspan="1">28.4</td><td rowspan="1" colspan="1">35.4</td><td rowspan="1" colspan="1">62.2</td><td rowspan="1" colspan="1">74.7</td><td rowspan="1" colspan="1">5.6</td><td rowspan="1" colspan="1">10.0</td><td rowspan="1" colspan="1">80.4</td><td rowspan="1" colspan="1">89.2</td><td rowspan="1" colspan="1">46.4</td><td rowspan="1" colspan="1">71.7</td><td rowspan="1" colspan="1">46.1</td><td rowspan="1" colspan="1">55.6</td></tr><tr><td rowspan="1" colspan="1">Spearman-HiE-HC</td><td rowspan="1" colspan="1">20.2</td><td rowspan="1" colspan="1">44.8</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">2.1</td><td rowspan="1" colspan="1">47.0</td><td rowspan="1" colspan="1">53.0</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">0.6</td><td rowspan="1" colspan="1">59.1</td><td rowspan="1" colspan="1">76.1</td><td rowspan="1" colspan="1">0.3</td><td rowspan="1" colspan="1">1.3</td><td rowspan="1" colspan="1">64.1</td><td rowspan="1" colspan="1">71.2</td><td rowspan="1" colspan="1">0.3</td><td rowspan="1" colspan="1">2.7</td><td rowspan="1" colspan="1">9.5</td><td rowspan="1" colspan="1">38.3</td><td rowspan="1" colspan="1">25.8</td><td rowspan="1" colspan="1">68.8</td><td rowspan="1" colspan="1">22.7</td><td rowspan="1" colspan="1">35.9</td></tr><tr><td rowspan="1" colspan="1">Data-HiE-KM</td><td rowspan="1" colspan="1">78.1</td><td rowspan="1" colspan="1">75.6</td><td rowspan="1" colspan="1">38.5</td><td rowspan="1" colspan="1">42.2</td><td rowspan="1" colspan="1">15.1</td><td rowspan="1" colspan="1">17.9</td><td rowspan="1" colspan="1">63.1</td><td rowspan="1" colspan="1">75.3</td><td rowspan="1" colspan="1">42.3</td><td rowspan="1" colspan="1">48.0</td><td rowspan="1" colspan="1">28.9</td><td rowspan="1" colspan="1">37.0</td><td rowspan="1" colspan="1">18.9</td><td rowspan="1" colspan="1">33.4</td><td rowspan="1" colspan="1">3.4</td><td rowspan="1" colspan="1">13.9</td><td rowspan="1" colspan="1">71.2</td><td rowspan="1" colspan="1">84.9</td><td rowspan="1" colspan="1">51.8</td><td rowspan="1" colspan="1">76.5</td><td rowspan="1" colspan="1">41.1</td><td rowspan="1" colspan="1">50.5</td></tr><tr><td rowspan="1" colspan="1">Data-HiE-HC</td><td rowspan="1" colspan="1">20.4</td><td rowspan="1" colspan="1">36.9</td><td rowspan="1" colspan="1">4.5</td><td rowspan="1" colspan="1">17.1</td><td rowspan="1" colspan="1">10.4</td><td rowspan="1" colspan="1">11.8</td><td rowspan="1" colspan="1">0.2</td><td rowspan="1" colspan="1">0.8</td><td rowspan="1" colspan="1">33.5</td><td rowspan="1" colspan="1">41.3</td><td rowspan="1" colspan="1">5.0</td><td rowspan="1" colspan="1">9.4</td><td rowspan="1" colspan="1">32.8</td><td rowspan="1" colspan="1">37.7</td><td rowspan="1" colspan="1">−0.6</td><td rowspan="1" colspan="1">0.8</td><td rowspan="1" colspan="1">7.9</td><td rowspan="1" colspan="1">35.9</td><td rowspan="1" colspan="1">8.9</td><td rowspan="1" colspan="1">42.4</td><td rowspan="1" colspan="1">12.3</td><td rowspan="1" colspan="1">23.4</td></tr></tbody></table><table-wrap-foot><fn id="tblfn7"><p>KM, k-means; HC, hierarchical clustering.</p></fn><fn id="tblfn8"><p>The best-performing method in each column is in boldface.</p></fn><fn id="tblfn9"><label>a</label><p>Parentheses indicate that SIMLR was run with different parameters for this dataset.</p></fn></table-wrap-foot></table-wrap></p>
        <p>We see that domain-specific methods for scRNA-seq clustering perform well, and that RAFSIL2 (using hierarchical clustering) has the best average performance, with SC3 and RAFSIL1-KM performing better for some datasets (Buettner, Patel and Leng). Interestingly, k-means clustering appears to perform better when directly applied to the data or in the context of Spearman correlation, while hierarchical clustering works better for RF derived distances.</p>
        <p><bold><italic>Dimension reduction improves clustering.</italic></bold> Motivated by our previous result of decreased NNE for reduced-dimension embeddings obtainable by tSNE, we applied clustering after dimension reduction for the methods we studied before (clustering-only approaches do not allow for dimension reduction). Results are summarized in <xref rid="bty260-T5" ref-type="table">Table 5</xref>, please see Section 2.4.3 for details on the Methods. Like before, we observe an overall better performance of clustering when using data with reduced dimensionality, again with the exception of RAFSIL2, which performs better in high dimensions. Also, comparing clustering results with similarity learning results, we find that using the original dissimilarity matrix RAFSIL2 had the smallest NNE and also the best clustering performance; for reduced dimensions, RAFSIL1 has the smallest NNE and also shows the best clustering performance. We finally note that the fact that RAFSIL2 performs worse than RAFSIL1 in this scenario is driven by its poor performance on the Kolod dataset. This relates to our previous discussion of <xref ref-type="fig" rid="bty260-F1">Figure 1</xref>: batch effect removal may not have been successful for this dataset, and RAFSIL2’s clustering performance reflects the situation depicted in the first panel of the second row, where cell groupings induced by cell picking session dominate biological variation.
<table-wrap id="bty260-T5" orientation="portrait" position="float"><label>Table 5.</label><caption><p>ARI and NMI values for clustering methods across ten datasets after dimension reduction (in percent, higher is better)</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1"/><th colspan="2" rowspan="1">Patel<hr/></th><th colspan="2" rowspan="1">Buettner<hr/></th><th colspan="2" rowspan="1">Engel<hr/></th><th colspan="2" rowspan="1">Kolod<hr/></th><th colspan="2" rowspan="1">Goolam<hr/></th><th colspan="2" rowspan="1">Usoskin<hr/></th><th colspan="2" rowspan="1">Treutlein<hr/></th><th colspan="2" rowspan="1">Leng<hr/></th><th colspan="2" rowspan="1">Pollen<hr/></th><th colspan="2" rowspan="1">Lin<hr/></th><th colspan="2" rowspan="1">Average<hr/></th></tr><tr><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th><th rowspan="1" colspan="1">ARI</th><th rowspan="1" colspan="1">NMI</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">RAFSIL1-tSNE-KM</td><td rowspan="1" colspan="1">96.8</td><td rowspan="1" colspan="1">95.7</td><td rowspan="1" colspan="1"><bold>93.5</bold></td><td rowspan="1" colspan="1"><bold>90.5</bold></td><td rowspan="1" colspan="1"><bold>44.7</bold></td><td rowspan="1" colspan="1"><bold>55.9</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1">54.4</td><td rowspan="1" colspan="1">73.5</td><td rowspan="1" colspan="1">61.7</td><td rowspan="1" colspan="1">71.5</td><td rowspan="1" colspan="1">33.8</td><td rowspan="1" colspan="1">58.2</td><td rowspan="1" colspan="1">46.4</td><td rowspan="1" colspan="1">61.1</td><td rowspan="1" colspan="1">89.0</td><td rowspan="1" colspan="1"><bold>94.9</bold></td><td rowspan="1" colspan="1">48.6</td><td rowspan="1" colspan="1">74.1</td><td rowspan="1" colspan="1">66.9</td><td rowspan="1" colspan="1">77.5</td></tr><tr><td rowspan="1" colspan="1">RAFSIL1-tSNE-HC</td><td rowspan="1" colspan="1">93.4</td><td rowspan="1" colspan="1">91.8</td><td rowspan="1" colspan="1"><bold>93.5</bold></td><td rowspan="1" colspan="1"><bold>90.5</bold></td><td rowspan="1" colspan="1">26.6</td><td rowspan="1" colspan="1">46.3</td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1">54.4</td><td rowspan="1" colspan="1">73.5</td><td rowspan="1" colspan="1">64.6</td><td rowspan="1" colspan="1">75.8</td><td rowspan="1" colspan="1">54.8</td><td rowspan="1" colspan="1">70.9</td><td rowspan="1" colspan="1">46.6</td><td rowspan="1" colspan="1">62.4</td><td rowspan="1" colspan="1">89.2</td><td rowspan="1" colspan="1"><bold>94.9</bold></td><td rowspan="1" colspan="1">50.1</td><td rowspan="1" colspan="1">76.3</td><td rowspan="1" colspan="1"><bold>67.7</bold></td><td rowspan="1" colspan="1"><bold>78.2</bold></td></tr><tr><td rowspan="1" colspan="1">RAFSIL2-tSNE-KM</td><td rowspan="1" colspan="1"><bold>97.5</bold></td><td rowspan="1" colspan="1"><bold>96.3</bold></td><td rowspan="1" colspan="1">87.3</td><td rowspan="1" colspan="1">83.1</td><td rowspan="1" colspan="1">26.6</td><td rowspan="1" colspan="1">46.3</td><td rowspan="1" colspan="1">34.9</td><td rowspan="1" colspan="1">41.7</td><td rowspan="1" colspan="1">54.4</td><td rowspan="1" colspan="1">73.5</td><td rowspan="1" colspan="1">65.5</td><td rowspan="1" colspan="1">77.1</td><td rowspan="1" colspan="1">55.0</td><td rowspan="1" colspan="1">72.4</td><td rowspan="1" colspan="1"><bold>48.7</bold></td><td rowspan="1" colspan="1">60.0</td><td rowspan="1" colspan="1">88.0</td><td rowspan="1" colspan="1">93.3</td><td rowspan="1" colspan="1">42.1</td><td rowspan="1" colspan="1">71.2</td><td rowspan="1" colspan="1">60.0</td><td rowspan="1" colspan="1">71.5</td></tr><tr><td rowspan="1" colspan="1">RAFSIL2-tSNE-HC</td><td rowspan="1" colspan="1"><bold>97.5</bold></td><td rowspan="1" colspan="1"><bold>96.3</bold></td><td rowspan="1" colspan="1">87.5</td><td rowspan="1" colspan="1">85.0</td><td rowspan="1" colspan="1">24.8</td><td rowspan="1" colspan="1">45.1</td><td rowspan="1" colspan="1">30.9</td><td rowspan="1" colspan="1">38.9</td><td rowspan="1" colspan="1">54.4</td><td rowspan="1" colspan="1">73.5</td><td rowspan="1" colspan="1">65.9</td><td rowspan="1" colspan="1">78.5</td><td rowspan="1" colspan="1"><bold>55.8</bold></td><td rowspan="1" colspan="1"><bold>72.5</bold></td><td rowspan="1" colspan="1">30.9</td><td rowspan="1" colspan="1">46.2</td><td rowspan="1" colspan="1">87.5</td><td rowspan="1" colspan="1">93.3</td><td rowspan="1" colspan="1">48.8</td><td rowspan="1" colspan="1">73.6</td><td rowspan="1" colspan="1">58.4</td><td rowspan="1" colspan="1">70.3</td></tr><tr><td rowspan="1" colspan="1">SIMLR-tSNE-KM</td><td rowspan="1" colspan="1">90.8</td><td rowspan="1" colspan="1">89.6</td><td rowspan="1" colspan="1">88.8</td><td rowspan="1" colspan="1">88.8</td><td rowspan="1" colspan="1">10.6</td><td rowspan="1" colspan="1">25.7</td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1">47.1</td><td rowspan="1" colspan="1">65.5</td><td rowspan="1" colspan="1">66.0</td><td rowspan="1" colspan="1">73.4</td><td rowspan="1" colspan="1">(27.3)<xref ref-type="table-fn" rid="tblfn11"><sup>a</sup></xref></td><td rowspan="1" colspan="1">(30.0)</td><td rowspan="1" colspan="1">47.1</td><td rowspan="1" colspan="1"><bold>65.5</bold></td><td rowspan="1" colspan="1">82.4</td><td rowspan="1" colspan="1">90.5</td><td rowspan="1" colspan="1">41.3</td><td rowspan="1" colspan="1">71.8</td><td rowspan="1" colspan="1">60.1</td><td rowspan="1" colspan="1">70.1</td></tr><tr><td rowspan="1" colspan="1">SIMLR-tSNE-HC</td><td rowspan="1" colspan="1">80.9</td><td rowspan="1" colspan="1">84.9</td><td rowspan="1" colspan="1">88.8</td><td rowspan="1" colspan="1">88.8</td><td rowspan="1" colspan="1">10.6</td><td rowspan="1" colspan="1">25.7</td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1">47.1</td><td rowspan="1" colspan="1">65.5</td><td rowspan="1" colspan="1">66.0</td><td rowspan="1" colspan="1">73.4</td><td rowspan="1" colspan="1">(40.7)</td><td rowspan="1" colspan="1">(41.7)</td><td rowspan="1" colspan="1">47.7</td><td rowspan="1" colspan="1"><bold>65.5</bold></td><td rowspan="1" colspan="1">72.5</td><td rowspan="1" colspan="1">88.4</td><td rowspan="1" colspan="1">42.1</td><td rowspan="1" colspan="1">74.2</td><td rowspan="1" colspan="1">59.6</td><td rowspan="1" colspan="1">70.7</td></tr><tr><td rowspan="1" colspan="1">Data-tSNE-KM</td><td rowspan="1" colspan="1">71.5</td><td rowspan="1" colspan="1">72.2</td><td rowspan="1" colspan="1">33.4</td><td rowspan="1" colspan="1">33.0</td><td rowspan="1" colspan="1">18.0</td><td rowspan="1" colspan="1">18.9</td><td rowspan="1" colspan="1">92.6</td><td rowspan="1" colspan="1">90.0</td><td rowspan="1" colspan="1">35.8</td><td rowspan="1" colspan="1">52.6</td><td rowspan="1" colspan="1"><bold>84.9</bold></td><td rowspan="1" colspan="1"><bold>80.2</bold></td><td rowspan="1" colspan="1">31.6</td><td rowspan="1" colspan="1">55.1</td><td rowspan="1" colspan="1">16.7</td><td rowspan="1" colspan="1">26.4</td><td rowspan="1" colspan="1">82.3</td><td rowspan="1" colspan="1">88.8</td><td rowspan="1" colspan="1">54.4</td><td rowspan="1" colspan="1"><bold>78.5</bold></td><td rowspan="1" colspan="1">52.1</td><td rowspan="1" colspan="1">59.6</td></tr><tr><td rowspan="1" colspan="1">Data-tSNE-HC</td><td rowspan="1" colspan="1">66.4</td><td rowspan="1" colspan="1">67.3</td><td rowspan="1" colspan="1">25.6</td><td rowspan="1" colspan="1">29.7</td><td rowspan="1" colspan="1">24.1</td><td rowspan="1" colspan="1">29.3</td><td rowspan="1" colspan="1">59.2</td><td rowspan="1" colspan="1">63.4</td><td rowspan="1" colspan="1">45.9</td><td rowspan="1" colspan="1">62.7</td><td rowspan="1" colspan="1">80.4</td><td rowspan="1" colspan="1">74.5</td><td rowspan="1" colspan="1">40.5</td><td rowspan="1" colspan="1">52.7</td><td rowspan="1" colspan="1">1.8</td><td rowspan="1" colspan="1">9.5</td><td rowspan="1" colspan="1"><bold>94.3</bold></td><td rowspan="1" colspan="1">93.4</td><td rowspan="1" colspan="1"><bold>55.0</bold></td><td rowspan="1" colspan="1">77.5</td><td rowspan="1" colspan="1">49.3</td><td rowspan="1" colspan="1">56.0</td></tr><tr><td rowspan="1" colspan="1">Pearson-tSNE-KM</td><td rowspan="1" colspan="1">88.5</td><td rowspan="1" colspan="1">86.2</td><td rowspan="1" colspan="1">29.2</td><td rowspan="1" colspan="1">33.6</td><td rowspan="1" colspan="1">28.9</td><td rowspan="1" colspan="1">35.4</td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>58.2</bold></td><td rowspan="1" colspan="1"><bold>74.0</bold></td><td rowspan="1" colspan="1">64.9</td><td rowspan="1" colspan="1">66.6</td><td rowspan="1" colspan="1">40.2</td><td rowspan="1" colspan="1">62.0</td><td rowspan="1" colspan="1">6.9</td><td rowspan="1" colspan="1">10.9</td><td rowspan="1" colspan="1">78.6</td><td rowspan="1" colspan="1">91.1</td><td rowspan="1" colspan="1">48.1</td><td rowspan="1" colspan="1">73.0</td><td rowspan="1" colspan="1">54.4</td><td rowspan="1" colspan="1">63.3</td></tr><tr><td rowspan="1" colspan="1">Pearson-tSNE-HC</td><td rowspan="1" colspan="1">87.5</td><td rowspan="1" colspan="1">85.3</td><td rowspan="1" colspan="1">27.3</td><td rowspan="1" colspan="1">35.6</td><td rowspan="1" colspan="1">33.5</td><td rowspan="1" colspan="1">51.1</td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1"><bold>100.0</bold></td><td rowspan="1" colspan="1">48.5</td><td rowspan="1" colspan="1">71.2</td><td rowspan="1" colspan="1">63.6</td><td rowspan="1" colspan="1">66.0</td><td rowspan="1" colspan="1">53.3</td><td rowspan="1" colspan="1">65.2</td><td rowspan="1" colspan="1">14.7</td><td rowspan="1" colspan="1">17.2</td><td rowspan="1" colspan="1">84.3</td><td rowspan="1" colspan="1">92.8</td><td rowspan="1" colspan="1">42.9</td><td rowspan="1" colspan="1">72.7</td><td rowspan="1" colspan="1">55.5</td><td rowspan="1" colspan="1">65.7</td></tr></tbody></table><table-wrap-foot><fn id="tblfn10"><p>The best-performing method in each column is in boldface.</p></fn><fn id="tblfn11"><label>a</label><p>Parentheses indicate that SIMLR was run with different parameters for this dataset.</p></fn></table-wrap-foot></table-wrap></p>
        <p><bold><italic>RAFSIL approaches yield robust clustering solutions.</italic></bold> To assess the robustness of clustering solutions, we randomly excluded 10% of cells from each dataset and re-ran each clustering approach 20 times. <xref ref-type="fig" rid="bty260-F2">Figure 2</xref> summarizes the results. We see substantial variability in the ARI for most datasets and most methods across re-sampling runs; in terms of performance as measured by ARI averaged across datasets, RAFSIL2 (with hierarchical clustering) performs best with SC3 coming in second. This is consistent with our previous results obtained with the full data (see <xref rid="bty260-T4" ref-type="table">Table 4</xref>). Next, we looked at variability and calculated the interquartile range (IQR) across res-sampling runs for each method analyzing each dataset, and then averaged across datasets (aIQR). SC3 exhibits the most stable clustering solutions (5% aIQR); RAFSIL2-HC is a bit worse with 7% aIQR, but a bit better than SIMLR, which has 8% aIQR. The method pcaReduce performs worst in terms of stability with an aIQR of 14%. Overall, we find that RAFSIL produces relatively stable clustering solutions with good ARI.
</p>
        <fig id="bty260-F2" orientation="portrait" position="float">
          <label>Fig. 2.</label>
          <caption>
            <p>RAFSIL2 yields accurate and robust clustering solutions. Panels are box plots of the ARI for ten datastes, across 20 instances of randomly sampling 90% of available cells. The panel labeled ‘Average’ represents the mean performance across all ten datasets. We see that RAFSIL2 followed by hierarchical clustering has the best performance, followed by SC3 and then the other RAFSIL-type methods. In terms of robustness SC3 performs best, while pcaReduce shows the highest variability (see Section 3.2.3 for a more detailed discussion). KM, k-means; HC, hierarchical clustering; HiE, highly expressed genes.</p>
          </caption>
          <graphic xlink:href="bty260f2"/>
        </fig>
        <p><bold><italic>RAFSIL can estimate the number of populations in a scRNA-seq dataset.</italic></bold> Here, we ask whether RAFSIL can estimate the number of populations present in a scRNA-seq dataset. Briefly, we apply RAFSIL1/2 followed by hierarchical clustering (RAFSIL1/2-HC) and retrieve the corresponding series of cell partitions with increasing cluster numbers. To those we apply the Calinski–Harabasz criterion (<xref rid="bty260-B7" ref-type="bibr">Calinski and Harabasz, 1974</xref>), where each cell is described by its corresponding row in the scaled feature matrix <bold><italic>F</italic></bold> (see Section 2.2). We compared RAFSIL with SC3 and SINCERA in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>. We find that RAFSIL1/2 perform well (RAFSIL2-HC is amongst the most accurate methods for the most datasets), but overall there is little difference between the approaches.</p>
        <p><bold><italic>Additional analyses.</italic></bold> In addition to the analyses described above, we also compared our method to the neural network based approach of <xref rid="bty260-B27" ref-type="bibr">Lin <italic>et al.</italic> (2017)</xref>. Lin et al. provide the data they used to assess their method, so we calculated performance metrics for RAFSIL1/2 and SC3 (without any gene filtering, to be consistent with the authors) and compared them to <xref rid="bty260-T2" ref-type="table">Table 2</xref> from <xref rid="bty260-B27" ref-type="bibr">Lin <italic>et al.</italic> (2017)</xref>. Results are shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>, where everything except the RAFSIL1/2 and SC3 lines has been taken from their publication. We see that the RAFSIL approaches (especially RAFSIL2) are competitive with the NN based approach, even though we do not make use of a supervised training phase.</p>
        <p>We also studied the clustering performance of RAFSIL1/2 performing only the feature construction step, and only the similarity learning step, respectively. Results are summarized in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>. We see that RAFSIL1/2 outperform these ‘reduced’ approaches, highlighting the value of both of these steps in our approach. Nevertheless, feature construction alone followed by k-means clustering also performs well overall.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion and conclusion</title>
    <p>We have presented RAFSIL, a two-step approach for learning similarities between single cells based on whole transcriptome sequencing data. Accurately inferring such similarities is an important step in single cell RNA sequencing studies, because they form the basis for identification, visualization and interpretation of group structure. And reliable and accurate inference of group structure is necessary for discovery of new (sub)types of cells, for improved characterization and understanding of existing types of cells, for decoding the cellular composition healthy (and abnormal) tissue types, and more. We analyzed a diverse collection of datasets and show that RAFSIL performs well in similarity learning, on average outperforming SIMLR (to our knowledge the only other similarity learning approach geared specifically towards the scRNA-seq domain) as well as several generic approaches. In addition, the SIMLR algorithm requires a known (or pre-determined) number of clusters to calculate similarities, but reasonable estimates are not always available in practice. RAFSIL has no such requirement. We also show that RAFSIL similarities improve dimension reduction and data visualization, and that they can be used to discover unwanted technical variation in single cell RNA sequencing datasets. Finally, comparing clustering solutions obtained with RAFSIL similarities with state-of-the-art methods, we show that RAFSIL2 followed by hierarchical clustering is highly competitive, outperforming all other methods on average, and also individually on most datasets we studied.</p>
    <p>RAFSIL implements a two-step procedure, first feature construction, and then similarity learning using random forests (RFs); it is flexible and easy to modify, expand and optimize. Our current feature construction step is a heuristic that reflects what we found to work well with scRNA-seq data we studied, but it is meant to be adapted as technology (and methodology) develops. For instance, including prior information about groups of genes (for example based on functional annotation databases) may improve performance. Likewise, we presented two strategies to apply RFs to unsupervised similarity learning (RAFSIL1 and RAFSIL2), but different approaches, perhaps more principled ones, can be imagined. Currently, the running time of RAFSIL algorithms is comparable to methods like SC3 and SIMLR, and datasets with on the order of thousand cells can be analyzed without any problems. However, a truly large scale implementation for datasets with hundreds of thousands of cells (or more) would be desirable and is one of our future research directions.</p>
    <p>Some limitations of our study include that, while we compared RAFSIL extensively, our work is not exhaustive and results are restricted to the data we analyzed. However, we cover a variety of scRNA-seq technologies and computational approaches, and exhaustive comparisons considering all combinations of reasonable choices for gene filtering, dimension reduction, and clustering across many datasets quickly become infeasible. Along the same lines, we report that dimension reduction improves similarity learning and clustering, but only study projection into two-dimensional spaces (<italic>k</italic> = 2). While exploring larger choices for <italic>k</italic> might in principle be worthwhile for some methods, the fact that tSNE performed clearly best in our analysis might argue against it. The reason is that tSNE is known to perform well for projection into two to three dimensions, but runs into problems for higher <italic>k</italic> (<xref rid="bty260-B44" ref-type="bibr">van der Maaten and Hinton, 2008</xref>). Further on, we (and others) compare methods based on performance metrics like averages over adjusted Rand indexes (aARI) or average NMI. However, our re-sampling experiment assessing robustness of clustering solutions (by repeatedly leaving out 10% of cells in a given dataset randomly) yields inter quartile ranges of the aARI between 5% and 14% (depending on the clustering method used). This implies that small performance differences are typically not robust to changing a small amount of cells in a dataset. While these values might be affected by the relatively small number of re-sampling runs (20), we believe it highlights the need for this type of analysis in the context of performance comparisons for single cell RNA-seq data methodology in general.</p>
    <p>To summarize, we presented RAFSIL, a random forest based approach for similarity learning from single cell RNA sequencing data. We show that it performs well on a variety of datasets and believe it will be a useful tool for bioinformatics researchers working in this domain.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty260_kostka.283.sup.1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Dr Abha S. Bais and Dr Emmanuel Sapin for helpful discussions.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the National Institutes of Health [R01GM115836] and the University of Pittsburgh School of Medicine.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bty260-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Adam</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>). 
<article-title>Psychrophilic proteases dramatically reduce single cell RNA-seq artifacts: a molecular atlas of kidney development</article-title>. <source>Development</source>, <volume>144</volume>, <fpage>3625</fpage>–<lpage>3632</lpage>.<pub-id pub-id-type="pmid">28851704</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Arthur</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Vassilvitskii</surname><given-names>S.</given-names></name></person-group> (<year>2007</year>). K-means++: the advantages of careful seeding. In: <italic>Proceedings of the Eighteenth Annual ACM-SIAM Symposium on Discrete Algorithms</italic>, SODA ’07, pp. 1027–1035, Philadelphia, PA, USA. Society for Industrial and Applied Mathematics.</mixed-citation>
    </ref>
    <ref id="bty260-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Borchers</surname><given-names>H.W.</given-names></name></person-group> (<year>2017</year>). <italic>pracma: Practical Numerical Math Functions</italic>. R package version 2.1.1.</mixed-citation>
    </ref>
    <ref id="bty260-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Breiman</surname><given-names>L.</given-names></name></person-group> (<year>2001</year>) 
<article-title>Random forests</article-title>. <source>Mach. Learn</source>., <volume>45</volume>, <fpage>5</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="bty260-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Breiman</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Cutler</surname><given-names>A.</given-names></name></person-group> (<year>2003</year>). Manual–setting up, using, and understanding random forests v4.0.</mixed-citation>
    </ref>
    <ref id="bty260-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Buettner</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>155</fpage>–<lpage>160</lpage>.<pub-id pub-id-type="pmid">25599176</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Calinski</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Harabasz</surname><given-names>J.</given-names></name></person-group> (<year>1974</year>) 
<article-title>A dendrite method for cluster analysis</article-title>. <source>Commun. Stat</source>., <volume>3</volume>, <fpage>1</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="bty260-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Conesa</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A survey of best practices for RNA-seq data analysis</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>13.</fpage><pub-id pub-id-type="pmid">26813401</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Engel</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Innate-like functions of natural killer t cell subsets result from highly divergent gene programs</article-title>. <source>Nat. Immunol</source>., <volume>17</volume>, <fpage>728</fpage>–<lpage>739</lpage>.<pub-id pub-id-type="pmid">27089380</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Gentleman</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>). <chapter-title>Distance measures in dna microarray data analysis</chapter-title> In: <source>Bioinformatics and Computational Biology Solutions Using R and Bioconductor</source>, Pp. <fpage>189</fpage>–<lpage>208</lpage>. 
<publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="bty260-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goolam</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Heterogeneity in oct4 and sox2 targets biases cell fate in 4-cell mouse embryos</article-title>. <source>Cell</source>, <volume>165</volume>, <fpage>61</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">27015307</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grün</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>. <source>Nature</source>, <volume>525</volume>, <fpage>251.</fpage><pub-id pub-id-type="pmid">26287467</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Guo</surname><given-names>M.</given-names></name></person-group> (<year>2017</year>). <italic>SINCERA: An R Implementation of SINCERA Pipeline for Processing Single-Cell RNA-seq Data.</italic> R package version 0.99.0.</mixed-citation>
    </ref>
    <ref id="bty260-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guo</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>SINCERA: a pipeline for Single-Cell RNA-Seq profiling analysis</article-title>. <source>PLoS Comput. Biol</source>, <volume>11</volume>, <fpage>e1004575.</fpage><pub-id pub-id-type="pmid">26600239</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B15">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Hagan</surname><given-names>M.T.</given-names></name></person-group><etal>et al</etal> (<year>1996</year>). <source>Neural Network Design</source>, Vol. <volume>20</volume>
<publisher-name>PWS Pub</publisher-name>, 
<publisher-loc>Boston</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="bty260-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Hennig</surname><given-names>C.</given-names></name></person-group> (<year>2018</year>). <italic>fpc: Flexible Procedures for Clustering.</italic> R package version 2.1-11.</mixed-citation>
    </ref>
    <ref id="bty260-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hubert</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Arabie</surname><given-names>P.</given-names></name></person-group> (<year>1985</year>) 
<article-title>Comparing partitions</article-title>. <source>J. Classification</source>, <volume>2</volume>, <fpage>193</fpage>–<lpage>218</lpage>.</mixed-citation>
    </ref>
    <ref id="bty260-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Kiselev</surname><given-names>V.Y.</given-names></name></person-group><etal>et al</etal> (<year>2017a</year>) <source>pcaMethods: A collection of PCA methods</source>. R-package version 1.70.o.</mixed-citation>
    </ref>
    <ref id="bty260-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kiselev</surname><given-names>V.Y.</given-names></name></person-group><etal>et al</etal> (<year>2017b</year>) 
<article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>483</fpage>–<lpage>486</lpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kolodziejczyk</surname><given-names>A.A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Single cell RNA-sequencing of pluripotent states unlocks modular transcriptional variation</article-title>. <source>Cell Stem Cell</source>, <volume>17</volume>, <fpage>471</fpage>–<lpage>485</lpage>.<pub-id pub-id-type="pmid">26431182</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B22">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Krijthe</surname><given-names>J.H.</given-names></name></person-group> (<year>2015</year>). <italic>Rtsne: T-Distributed Stochastic Neighbor Embedding using Barnes-Hut Implementation.</italic> R package version 0.13.</mixed-citation>
    </ref>
    <ref id="bty260-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kumar</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Understanding development and stem cells using single cell-based analyses of gene expression</article-title>. <source>Development</source>, <volume>144</volume>, <fpage>17</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">28049689</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lanckriet</surname><given-names>G.R.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>A statistical framework for genomic data fusion</article-title>. <source>Bioinformatics</source>, <volume>20</volume>, <fpage>2626</fpage>–<lpage>2635</lpage>.<pub-id pub-id-type="pmid">15130933</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leng</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Kendziorski</surname><given-names>C.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Oscope: a statistical pipeline for identifying oscillatory genes in unsynchronized single cell RNA-seq experiments</article-title>. <source>gene</source>, <volume>1</volume>, <fpage>1</fpage>.</mixed-citation>
    </ref>
    <ref id="bty260-B26">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Liaw</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Wiener</surname><given-names>M.</given-names></name></person-group> (<year>2017</year>). <italic>randomForest: Breiman and Cutler’s Random Forests for Classification and Regression.</italic> R package version 4.6-12.</mixed-citation>
    </ref>
    <ref id="bty260-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lin</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Using neural networks for reducing the dimensions of single-cell RNA-seq data</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>e156</fpage>–<lpage>e156</lpage>.<pub-id pub-id-type="pmid">28973464</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B28">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Mouselimis</surname><given-names>L.</given-names></name></person-group> (<year>2017</year>). <italic>pracma: Practical Numerical Math Functions.</italic> R package version 1.1.0.</mixed-citation>
    </ref>
    <ref id="bty260-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Patel</surname><given-names>A.P.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>. <source>Science</source>, <volume>344</volume>, <fpage>1396</fpage>–<lpage>1401</lpage>.<pub-id pub-id-type="pmid">24925914</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pollen</surname><given-names>A.A.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>1053</fpage>–<lpage>1058</lpage>.<pub-id pub-id-type="pmid">25086649</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pouyan</surname><given-names>M.B.</given-names></name>, <name name-style="western"><surname>Nourani</surname><given-names>M.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Clustering single-cell expression data using random forest graphs</article-title>. <source>IEEE J. Biomed. Health Inform</source>., <volume>21</volume>, <fpage>1172</fpage>–<lpage>1181</lpage>.<pub-id pub-id-type="pmid">28113735</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B32">
      <mixed-citation publication-type="book"><collab>R Core Team</collab> (<year>2017</year>) <source>R: A Language and Environment for Statistical Computing.</source><publisher-name>R Foundation for Statistical Computing</publisher-name>, 
<publisher-loc>Vienna, Austria</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="bty260-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ramirez</surname><given-names>K.S.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Detecting macroecological patterns in bacterial communities across independent studies of global soils</article-title>. <source>Nat. Microbiol</source>., <volume>3</volume>, <fpage>189</fpage>–<lpage>196</lpage>.<pub-id pub-id-type="pmid">29158606</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Seligson</surname><given-names>D.B.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>Global histone modification patterns predict risk of prostate cancer recurrence</article-title>. <source>Nature</source>, <volume>435</volume>, <fpage>1262</fpage>–<lpage>1266</lpage>.<pub-id pub-id-type="pmid">15988529</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shi</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Horvath</surname><given-names>S.</given-names></name></person-group> (<year>2006</year>) 
<article-title>Unsupervised learning with random forest predictors</article-title>. <volume>15</volume>, <fpage>118</fpage>–<lpage>138</lpage>.</mixed-citation>
    </ref>
    <ref id="bty260-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stacklies</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>pcamethods—a bioconductor package providing pca methods for incomplete data</article-title>. <source>Bioinformatics</source>, <volume>23</volume>, <fpage>1164</fpage>–<lpage>1167</lpage>.<pub-id pub-id-type="pmid">17344241</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Strehl</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Ghosh</surname><given-names>J.</given-names></name></person-group> (<year>2002</year>) 
<article-title>Cluster ensembles—a knowledge reuse framework for combining multiple partitions</article-title>. <source>J. Mach. Learn. Res</source>., <volume>3</volume>, <fpage>583</fpage>–<lpage>617</lpage>.</mixed-citation>
    </ref>
    <ref id="bty260-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Svensson</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Power analysis of single-cell RNA-sequencing experiments</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>381</fpage>–<lpage>387</lpage>.<pub-id pub-id-type="pmid">28263961</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Thorndike</surname><given-names>R.L.</given-names></name></person-group> (<year>1953</year>) 
<article-title>Who belongs in the family?</article-title><source>Psychometrika</source>, <volume>18</volume>, <fpage>267</fpage>–<lpage>276</lpage>.</mixed-citation>
    </ref>
    <ref id="bty260-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tipping</surname><given-names>M.E.</given-names></name>, <name name-style="western"><surname>Bishop</surname><given-names>C.M.</given-names></name></person-group> (<year>1999</year>) 
<article-title>Probabilistic principal component analysis</article-title>. <source>J. R. Stat. Soc. B</source>, <volume>61</volume>, <fpage>611</fpage>–<lpage>622</lpage>.</mixed-citation>
    </ref>
    <ref id="bty260-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Treutlein</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>. <source>Nature</source>, <volume>509</volume>, <fpage>371</fpage>–<lpage>375</lpage>.<pub-id pub-id-type="pmid">24739965</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Usoskin</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Unbiased classification of sensory neuron types by large-scale single-cell RNA sequencing</article-title>. <source>Nat. Neurosci</source>., <volume>18</volume>, <fpage>145</fpage>–<lpage>153</lpage>.<pub-id pub-id-type="pmid">25420068</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>van der Maaten</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Dimensionality reduction: a comparative</article-title>. <source>J. Mach. Learn. Res</source>., <volume>10</volume>, <fpage>66</fpage>–<lpage>71</lpage>.</mixed-citation>
    </ref>
    <ref id="bty260-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>van der Maaten</surname><given-names>L.J.P.</given-names></name>, <name name-style="western"><surname>Hinton</surname><given-names>G.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Visualizing data using t-SNE</article-title>. <source>JLMR</source>, <volume>9</volume>, <fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
    </ref>
    <ref id="bty260-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vinh</surname><given-names>N.X.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Information theoretic measures for clusterings comparison: variants, properties, normalization and correction for chance</article-title>. <source>J. Mach. Learn. Res</source>., <volume>11</volume>, <fpage>2837</fpage>–<lpage>2854</lpage>.</mixed-citation>
    </ref>
    <ref id="bty260-B46">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2017a</year>). <italic>SIMLR: Title: SIMLR: Single-cell Interpretation via Multi-kernel LeaRning</italic>. R package version 1.4.0.</mixed-citation>
    </ref>
    <ref id="bty260-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>414</fpage>–<lpage>416</lpage>.<pub-id pub-id-type="pmid">28263960</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yan</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Cluster forests</article-title>. <source>Comput. Stat. Data Anal</source>., <volume>66</volume>, <fpage>178</fpage>–<lpage>192</lpage>.</mixed-citation>
    </ref>
    <ref id="bty260-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yuan</surname><given-names>G.-C.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Challenges and emerging directions in single-cell analysis</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>84.</fpage><pub-id pub-id-type="pmid">28482897</pub-id></mixed-citation>
    </ref>
    <ref id="bty260-B50">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Žurauskienė</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Yau</surname><given-names>C.</given-names></name></person-group> (<year>2015</year>). <italic>pcaReduce: Hierarchical Clustering of Single Cell Transcriptional Profiles.</italic> R package version 1.0.</mixed-citation>
    </ref>
    <ref id="bty260-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Žurauskienė</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Yau</surname><given-names>C.</given-names></name></person-group> (<year>2016</year>) 
<article-title>pcareduce: hierarchical clustering of single cell transcriptional profiles</article-title>. <source>BMC Bioinformatics</source>, <volume>17</volume>, <fpage>140.</fpage><pub-id pub-id-type="pmid">27005807</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
