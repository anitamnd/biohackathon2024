<?properties no_embargo?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Acta Crystallogr D Biol Crystallogr</journal-id>
    <journal-id journal-id-type="publisher-id">Acta Cryst. D</journal-id>
    <journal-title>Acta Crystallographica Section D: Biological Crystallography</journal-title>
    <issn pub-type="ppub">0907-4449</issn>
    <issn pub-type="epub">1399-0047</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2394813</article-id>
    <article-id pub-id-type="publisher-id">ba5114</article-id>
    <article-id pub-id-type="doi">10.1107/S0907444907050172</article-id>
    <article-id pub-id-type="coden">ABCRE6</article-id>
    <article-id pub-id-type="pii">S0907444907050172</article-id>
    <article-id pub-id-type="pmid">18094476</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Papers</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>BALBES</italic>: a molecular-replacement pipeline</article-title>
      <alt-title>
        <italic>BALBES</italic>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Long</surname>
          <given-names>Fei</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="author-notes" rid="aunote1">‡</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vagin</surname>
          <given-names>Alexei A.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="author-notes" rid="aunote1">‡</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Young</surname>
          <given-names>Paul</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Murshudov</surname>
          <given-names>Garib N.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <aff id="a"><label>a</label>York Structural Biology Laboratory, Chemistry Department, University of York, Heslington, York, <country>England</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>garib@ysbl.york.ac.uk</email></corresp>
      <fn id="aunote1">
        <label>‡</label>
        <p>These authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>1</month>
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>12</month>
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>12</month>
      <year>2007</year>
    </pub-date>
    <volume>64</volume>
    <issue>Pt 1</issue>
    <issue-id pub-id-type="publisher-id">d080100</issue-id>
    <fpage>125</fpage>
    <lpage>132</lpage>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>5</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>10</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© International Union of Crystallography 2008</copyright-statement>
      <copyright-year>2008</copyright-year>
      <license license-type="open-access" xlink:href="http://journals.iucr.org/services/termsofuse.html">
        <p>This is an open-access article distributed under the terms described at http://journals.iucr.org/services/termsofuse.html.</p>
      </license>
    </permissions>
    <self-uri xlink:type="simple" xlink:href="http://dx.doi.org/10.1107/S0907444907050172">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p>The fully automated pipeline, <italic>BALBES</italic>, integrates a redesigned hierarchical database of protein structures with their domains and multimeric organization, and solves molecular-replacement problems using only input X-ray and sequence data.</p>
    </abstract>
    <abstract>
      <p>The number of macromolecular structures solved and deposited in the Protein Data Bank (PDB) is higher than 40 000. Using this information in macromolecular crystallo­graphy (MX) should in principle increase the efficiency of MX structure solution. This paper describes a molecular-replacement pipeline, <italic>BALBES</italic>, that makes extensive use of this repository. It uses a reorganized database taken from the PDB with multimeric as well as domain organization. A system manager written in Python controls the workflow of the process. Testing the current version of the pipeline using entries from the PDB has shown that this approach has huge potential and that around 75% of structures can be solved automatically without user intervention.</p>
    </abstract>
    <kwd-group>
      <kwd>
        <italic>BALBES</italic>
      </kwd>
      <kwd>molecular replacement</kwd>
    </kwd-group>
    <conference>
      <conf-date/>
      <conf-name>Molecular replacement</conf-name>
      <conf-loc/>
    </conference>
  </article-meta>
</front>
<body>
  <sec sec-type="introduction" id="sec1">
    <label>1.</label>
    <title>Introduction</title>
    <p>The number of macromolecular structures deposited in the Protein Data Bank (PDB; Berman <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb1"> ▶</xref>) is increasing rapidly every year. For example, out of more than 40 000 entries, around 5500 (more than 12%) were deposited and released in 2006. X-ray crystal structure analysis (MX) is by far the most common technique used for the determination of three-dimensional structures (approximately 83%), followed by NMR with around 15%.</p>
    <p>The PDB is a treasure of the structural biology community, the implications of which have yet to be fully appreciated. One can imagine the amount of information contained in this repository. How do we extract and analyse this information and use it to understand fundamental biological problems such as protein folding and protein evolution? This and other questions are the subject of many research disciplines, including bioinformatics. There have already been huge amounts of work carried out in this area. Two areas relevant to this paper are the classification of domains [CATH (Pearl <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb20"> ▶</xref>); SCOP (Murzin <italic>et al.</italic>, 1995<xref ref-type="bibr" rid="bb16"> ▶</xref>)] and the extraction of biological oligomers from crystal structures (Krissinel &amp; Henrick, 2005<xref ref-type="bibr" rid="bb12"> ▶</xref>). While the domains defined by both CATH and SCOP are extremely useful for the biological community in general, our attempts to use them for molecular replacement did not produce consistent results. Therefore, we undertook to redefine the domains so that they could be used for molecular replacement and structure solution routinely and consistently.</p>
    <p>One of the obvious applications of the PDB is the reuse of entries for macromolecular X-ray crystallography. The application of information derived from the PDB for molecular replacement, phase improvement (Terwilliger &amp; Berendzen, 1999<xref ref-type="bibr" rid="bb25"> ▶</xref>) and model building (Emsley &amp; Cowtan, 2004<xref ref-type="bibr" rid="bb4"> ▶</xref>; Jones <italic>et al.</italic>, 1991<xref ref-type="bibr" rid="bb9"> ▶</xref>) now routinely takes place. In the near future, one can envisage that information that is invariant for all entries in the PDB (or classes of proteins) will be used during all stages of structure analysis, thereby transferring information from high-resolution structures to new structure analysis, thus increasing the reliability of the derived models. Moreover, one can speculate that the celebrated phase problem may well be solved using substructure classes (<italic>e.g.</italic> domains) from the PDB by applying well established ideas such as the multi-solution techniques (Germain <italic>et al.</italic>, 1970<xref ref-type="bibr" rid="bb5"> ▶</xref>) used in the small-molecular crystallographic world.</p>
    <p>Analysis of the PDB shows that molecular replacement (MR) is the most widely used technique for macromolecular crystal structure solution. 67% of all X-ray structures released in 2006 were solved using this method (Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref>). It is expected that with (i) better organization of the database for molecular replacement, (ii) a better choice of protocols and (iii) improved algorithms in molecular replacement and refinement, this percentage will be significantly higher. However, it should be noted that the PDB reflects successful structure solution and therefore all statistical analysis derived from it will inevitably be biased.</p>
    <p>In recent years, there has been an explosion of developments of automatic procedures for macromolecular X-ray structure solution. These approaches have already produced several highly automated and very popular software packages for automatic model building and refinement (<italic>ARP</italic>/<italic>wARP</italic>; Perrakis <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb21"> ▶</xref>) and for automatic phasing and model building [<italic>SOLVE</italic>/<italic>RESOLVE</italic> (Terwilliger &amp; Berendzen, 1999<xref ref-type="bibr" rid="bb25"> ▶</xref>), <italic>CRANK</italic> (Ness <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb18"> ▶</xref>) and <italic>Auto-Rickshaw</italic> (Panjikar <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb19"> ▶</xref>)]. Despite the high productivity of the molecular-replacement technique, until recently it was not applied in automation procedures. Nevertheless, several automated molecular-replacement pipelines have already been made available to the user community, including <italic>NORMA</italic> (Delarue, 2008<xref ref-type="bibr" rid="bb3"> ▶</xref>), <italic>MrBUMP</italic> (Keegan &amp; Winn, 2008<xref ref-type="bibr" rid="bb10"> ▶</xref>) and part of the JSCS structure-solution pipeline (Schwarzenbacher <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb23"> ▶</xref>). All of these approaches are built around one or more of the popular molecular-replacement programs <italic>AMoRe</italic> (Navaza, 1987<xref ref-type="bibr" rid="bb30"> ▶</xref>), <italic>MOLREP</italic> (Vagin &amp; Teplyakov, 1997<xref ref-type="bibr" rid="bb27"> ▶</xref>; Lebedev <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb14"> ▶</xref>) and <italic>Phaser</italic> (Storoni <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb24"> ▶</xref>).</p>
    <p>This paper describes <italic>BALBES</italic>, a fully automatic molecular-replacement pipeline.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Overall organization</title>
    <p><italic>BALBES</italic>, a system for fully automating molecular replacement, consists of three major components, which were developed independently of each other. These are (i) a reorganized database of protein structures, (ii) a system manager that controls the workflow and makes decisions according to the available information and (iii) scientific programs, which are the powerhouse of the system. The overall workflow of the system is shown in Fig. 2<xref ref-type="fig" rid="fig2"> ▶</xref>. Some details of these components are given in the following sections.</p>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Database of macromolecular structures</title>
    <sec id="sec3.1">
      <label>3.1.</label>
      <title>Selection of entries</title>
      <p>All protein entries from the PDB with a length greater than 15 amino-acid residues that had been solved using MX and had been refined against data higher than 3.5 Å resolution were selected to build the current database. A basic entry in the database was a macromolecular subunit. If two subunits had a sequence identity greater than 80% and a root-mean-square deviation (r.m.s.d.) between corresponding C<sup>α</sup> atoms of less than 1 Å, then the one that had been refined against the higher resolution data was retained. This approach, while substantially reducing the number of subunits kept in the database, retained the conformational variability of the molecules. For example, if there were two copies of a subunit and there was a domain motion between these subunits, then both representatives were kept in the database even if the sequence identity was 100%.</p>
      <p>For each entry sequence, information about the secondary structure, domains (see below) and potential to form multimers was also stored. Therefore, when an entry was extracted, all necessary information was immediately available.</p>
      <p>All entries in the database (around 14 000 subunits) were aligned with each other using a modified version of the Needleman &amp; Wunsch (1970<xref ref-type="bibr" rid="bb17"> ▶</xref>) dynamic alignment algorithm. The result of this alignment was considered as a measure of similarity. Using this, a hierarchical database was organized with agglomerative clustering. The results were kept as a search tree.</p>
    </sec>
    <sec id="sec3.2">
      <label>3.2.</label>
      <title>Domains</title>
      <p>All domains were analysed and checked manually. The main criteria for domain definition were three-dimensional compactness and separability from other parts of the subunit. However, if there was no well defined domain in a molecule then the whole molecule was considered as a domain. If a tentative domain contained completely exposed loops and N- or C-terminal stretches, they were considered as flexible parts and were removed from the domains. The result of this analysis was approximately 23 000 domains. Each domain belonged to a subunit and each subunit belonged to a class as a result of clustering. All domains were aligned with each other again and further superimposed using three-dimensional fitting algorithms (Kabsch, 1976<xref ref-type="bibr" rid="bb11"> ▶</xref>). Quality factors (Q-factors) were calculated using the procedure described by Krissinel &amp; Henrick (2004<xref ref-type="bibr" rid="bb13"> ▶</xref>). The Q-factors were used in hierarchical clustering of the domains. Once clusterization of the domains was finished, they were used to check and correct the clustering of each entry (subunits). This procedure ensured that subunits and domains belonging to the same class were similar in three-dimensional structure and not merely in sequence. It should be noted that domains were kept in the database as a set of operations which was necessary to generate them from the basic entries (subunits).</p>
    </sec>
    <sec id="sec3.3">
      <label>3.3.</label>
      <title>Multimers</title>
      <p>Multimers for each entry were taken from the EBI’s PISA service (<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/msd-srv/prot_int/pistart.html">http://www.ebi.ac.uk/msd-srv/prot_int/pistart.html</ext-link>) for multimer generation from crystal structures (Krissinel &amp; Henrick, 2004<xref ref-type="bibr" rid="bb13"> ▶</xref>). Multimers are stored as operations to generate them from basic entries (subunits). This substantially reduces the amount of information stored in the database.</p>
      <p>The database also contains a full list of PDB entries with their unit-cell parameters and space groups. This list helps to search the PDB using cell and symmetry only.</p>
    </sec>
    <sec id="sec3.4">
      <label>3.4.</label>
      <title>Update</title>
      <p>Every 15 d, the database is updated using newly deposited structures. If the sequence and three-dimensional structure of the newly deposited structures are similar to an entry in the existing database, then their domain definitions are also transferred. For the remaining structures, manual analysis is carried out. Currently, even automatically generated domains are checked manually to make sure that automatic domain-definition transfer does not introduce errors.</p>
    </sec>
    <sec id="sec3.5">
      <label>3.5.</label>
      <title>Search using a single sequence</title>
      <p>When a sequence is given, a search is carried out in the database at the appropriate level. For one member of the database belonging to a branch of the tree, sequence alignment is carried out and the score, relative aligned length and number of gaps are calculated. A new quality factor is then calculated,<disp-formula id="fd1"><graphic xlink:href="d-64-00125-efd1.jpg" mimetype="image" mime-subtype="gif" position="float"/></disp-formula>where ‘score’ is based on the normalized BLOSUM62 substitution matrix (Henikoff &amp; Henikoff, 1992<xref ref-type="bibr" rid="bb7"> ▶</xref>), <italic>N</italic>
               <sub>1</sub> and <italic>N</italic>
               <sub>2</sub> are the number of residues in the first and the second sequence, <italic>N</italic>
               <sub>align</sub> is the number of aligned residues and <italic>N</italic>
               <sub>gap</sub> is the number of gaps. This function seemed to work consistently better than many other functions that were tried.</p>
      <p>Afterwards, the branch corresponding to the maximum of CQ (maxCQ) is taken and this branch is considered to be similar. If maxCQ &lt; 0.22, then it is considered that there is no similar structure. If a branch is similar to a given sequence, then at most 20 of the best aligned structures with their domain and multimeric organizations are taken from this branch as templates.</p>
      <p>If no similar structure is found among the basic entries, if the maximum of CQ is less than 0.60 or if the number of residues aligned with gaps is more than 40 then the system carries out a domain search. Firstly, it uses the full-length sequence and tries to find a similar domain. When stretches of the sequence corresponding to this domain are found, they are removed and the remaining sequence is submitted to a further domain search. At this stage, the remaining sequence is considered as a fragment of sequences. If another domain is found, the search continues until all domains have been found or the remaining sequence stretches are too fragmented (<italic>i.e.</italic> the longest length of a fragment in the remaining sequence is less than 40 residues). This procedure ensures that all domains are found that may be present in the different entries. An example of such a case is shown in Fig. 3<xref ref-type="fig" rid="fig3"> ▶</xref>. PDB entry <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1z45">1z45</ext-link> has two major domains, one of which can also be split into two smaller domains. Domain 1 is similar to <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ek6">1ek6</ext-link> (with sequence identity 55%) and domain 2 is similar to <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1yga">1yga</ext-link>. The domain search considers domain 2 as two separate domains and finds a similar domain for domain 2-1 from <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1yga">1yga</ext-link> (with sequence identity 51%) and for domain 2-2 from <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1udc">1udc</ext-link> (49%).</p>
    </sec>
    <sec id="sec3.6">
      <label>3.6.</label>
      <title>Search for assemblies</title>
      <p>If an input file contains more than one sequence then the system assumes that it is a complex of proteins. In this case, it searches for assemblies consisting of these or a subset of these sequences. If they are found then they are used as template models for molecular replacement and refinement. If no such assembles are found then each sequence is searched in turn and a set of template models is generated for each sequence (with their multimeric as well as their domain structures).</p>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Design of the system manager</title>
    <sec id="sec4.1">
      <label>4.1.</label>
      <title>Scripting language for the system manager and method of passing parameters</title>
      <p>A system manager is needed to integrate the database of macromolecular structures with the scientific software. It should make decisions according to the information that it has available and should provide a user-friendly interface for non-expert users as well as other programs (<italic>e.g.</italic> a graphical user interface or other pipelines that may incorporate this system). This places several requirements on the computing language of the system manager.<list id="l1" list-type="simple"><list-item><p>(i) Flexibility: it needs to seamlessly integrate the existing crystallographic software, which may have been developed using very different computing languages (such as Fortran, C and C++).</p></list-item><list-item><p>(ii) Modularity: each protocol or algorithm implemented in the system should work as a module. The modules can be assembled to form new modules and communicate with each other by passing parameters, <italic>e.g.</italic> in the form of Extensible Markup Language (XML). This feature is very important for the future development and update of the system. The manager should also allow the addition of more complicated protocols, which we probably do not know yet. These new modules should be easily plugged into the system without affecting the pre-existing modules.</p></list-item><list-item><p>(iii) Reusability: the reusability of elements is another important feature for rapid and efficient development of the system. It appeared that a scripting language allowing object orientation, <italic>i.e.</italic> Python, was the most appropriate for designing this system.</p></list-item></list>Communication between different modules of the system (database, programs) was carried out using an XML file format. <italic>BALBES</italic> uses a Python extension, PyXml (<ext-link ext-link-type="uri" xlink:href="http://pyxml.sourceforge.net/">http://pyxml.sourceforge.net/</ext-link>), to process XML files.</p>
    </sec>
    <sec id="sec4.2">
      <label>4.2.</label>
      <title>Implementation of the system manager</title>
      <p>In the <italic>BALBES</italic> system manager, all of the scientific programs are wrapped into Python classes that are descendants of an abstract class: this abstract class contains those procedures which are common in running a scientific program, such as calling the program, tracing the running process ID, killing the job <italic>etc</italic>. Different data are also wrapped as various Python classes to accommodate the needs of parameter passing; for example, the class CModel is designed to record and manipulate all the information required for a template model at different stages of finding a solution, such as its chain ID, sequence identity, the multimers and domains it may contain, the parameters needed and the resultant outputs when working on it by MR and refinement. Different combinations of the objects of these classes form independent modules that perform different functionalities.</p>
      <p>The overall workflow in <italic>BALBES</italic> is shown in Fig. 2<xref ref-type="fig" rid="fig2"> ▶</xref>. After the user’s input structure-factor file has been provided, it is analysed using <italic>SFCHECK</italic> and all necessary information is extracted (such as the unit-cell parameters, space group, data completeness, optimal resolution, the pseudo-translation vector if it exists, twin operators and estimates of the twin fractions). Next, <italic>BALBES</italic> begins to analyse the sequence, unit-cell parameters and space group. If the space group is the same as one of the entries and the unit-cell parameters are very similar (the maximum difference in unit-cell lengths and angles between the target and search crystals is less than 0.5%), then the system tries to use this PDB entry for refinement. This is performed to account for potential mistakes that may arise during expression and crystallization. If the differences in the unit-cell parameters are within 5% (the corresponding maximum difference is less than 5%) and the sequence identity is greater than 90%, then the system again tries to use this PDB entry for refinement. If refinement does not produce a desirable <italic>R</italic>/<italic>R</italic>
               <sub>free</sub>, the system then starts the automated molecular-replacement runs. A desirable <italic>R</italic>/<italic>R</italic>
               <sub>free</sub> in the current version is determined according to the following procedure.</p>
      <p>Let Δ<italic>R</italic>
               <sub>free</sub> = (<italic>R</italic>
               <sub>free</sub> − <italic>R</italic>
               <sub>free_init</sub>)/<italic>R</italic>
               <sub>free</sub>. <list id="l2" list-type="simple"><list-item><p>(i) If <italic>R</italic>
                        <sub>free</sub> ≤ 0.35 then the structure is considered ‘solved’ regardless of the value of Δ<italic>R</italic>
                        <sub>free</sub>.</p></list-item><list-item><p>(ii) If 0.35 &lt; <italic>R</italic>
                        <sub>free</sub> ≤ 0.45 then the structure is marked as ‘solved’ if Δ<italic>R</italic>
                        <sub>free</sub> &lt; 0.0001, which means that <italic>R</italic>
                        <sub>free</sub> could slightly increase.</p></list-item><list-item><p>(iii) If 0.45 &lt; <italic>R</italic>
                        <sub>free</sub> ≤ 0.50 then Δ<italic>R</italic>
                        <sub>free</sub> must be less than −0.05 for the structure to be considered as ‘solved’, which means that <italic>R</italic>
                        <sub>free</sub> should decrease.</p></list-item><list-item><p>(iv) If <italic>R</italic>
                        <sub>free</sub> &gt; 0.50 and Δ<italic>R</italic>
                        <sub>free</sub> &gt; 0.03, then the structure is considered to be ‘not solved’.</p></list-item><list-item><p>(v) All other cases are considered as potential solutions.</p></list-item></list>
            </p>
      <p>The first job in automated molecular replacement is to find the template structures by searching the internal database. The algorithms and criteria for this are detailed in the previous section. Currently, we select those with CQ &gt; 0.22 as the template structures. When this process has finished, users are provided with a group of template structures as detailed in the previous section. <italic>BALBES</italic> works on these structures in turn according to their priorities. That is, if assemblies are found <italic>BALBES</italic> will use the structures in these assemblies as search models, then the structures associated with different single sequences and finally the structure formed by domains from different PDB entries. Usually, several template structures are found in an assembly or associated with a sequence. The system manager starts with the template structure with the highest sequence identity, then the second structure and then the third structure. For each structure, multimer models, if they exist, are tried first and then the monomer models. There are different protocols used to carry out MR. The most widely used protocol is a combination of MR and refinement on a whole template structure. As a simple example, Table 1<xref ref-type="table" rid="table1"> ▶</xref> presents a template structure found by <italic>BALBES</italic> that is associated with one sequence in which there are four search models. MR is performed on the trimer model first, followed by refinement. If it is not considered to be a solution (currently using the behaviour of <italic>R</italic>
               <sub>free</sub> as defined above) the dimers and then the monomers are tried. If no solution is found for the whole multimers or monomers and domains exist, a more complicated set of protocols is employed.</p>
    </sec>
  </sec>
  <sec id="sec5">
    <label>5.</label>
    <title>Programs</title>
    <p>The system uses currently available programs including <italic>MOLREP</italic> (Lebe­dev <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb14"> ▶</xref>), <italic>REFMAC</italic> (Murshudov <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb15"> ▶</xref>) and <italic>SFCHECK</italic> (Vaguine <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb28"> ▶</xref>). The system makes use of these programs and at the same time tests them. This means that these programs are constantly tested using thousands of test cases. Improvements based on these tests increases the robustness of these programs, while increasing the power of the system in the next release.</p>
    <p>The most interesting aspect of these tests is the analysis of failed cases. Having a huge amount of test cases helps to prioritize future developments and their analysis helps to generate new ideas for phasing, molecular replacement, model building and refinement.</p>
  </sec>
  <sec id="sec6">
    <label>6.</label>
    <title>Interfaces</title>
    <p>Three types of user interface have been developed for <italic>BALBES</italic>. First and foremost is the command-line interface. This interface also forms the basis for the other two interfaces, the <italic>ccp</italic>4<italic>i</italic> (Potterton <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb22"> ▶</xref>) interface, which allows the use of the tools available within <italic>ccp</italic>4<italic>i</italic>, and the web interface, which allows the use of tools developed for web browsers.</p>
    <sec id="sec6.1">
      <label>6.1.</label>
      <title>Command-line interface</title>
      <p>The command-line interface takes inputs of sequence and data,</p>
      <p><monospace>balbes -f &lt;data&gt; -s &lt;sequence&gt; -o &lt;output&gt;</monospace>,</p>
      <p>where <monospace>data</monospace> is a file containing experimental data from the crystal under study, <monospace>sequence</monospace> is the file containing the sequence(s) of the unknown structure and <monospace>output</monospace> is a subdirectory where information about the template structures, results and details of the working system are written. The currently accepted file formats for experimental data are MTZ (Collaborative Computational Project, Number 4, 1994<xref ref-type="bibr" rid="bb2"> ▶</xref>) and CIF (Hall <italic>et al.</italic>, 1991<xref ref-type="bibr" rid="bb6"> ▶</xref>). The sequence format is FASTA.</p>
      <p>If a user wants to use his own library of structures then this can be performed using</p>
      <p>
        <monospace>balbes -f &lt;data&gt; -l &lt;LibraryOfModels&gt; -s &lt;sequence&gt;</monospace>
      </p>
      <p>where <monospace>data</monospace> and <monospace>sequence</monospace> are defined as above and <monospace>LibraryOfModels</monospace> is a subdirectory containing PDB files.</p>
      <p>If a user wants to use his particular model then this can be performed using</p>
      <p>
        <monospace>balbes -f &lt;data&gt; -m &lt;model&gt;</monospace>
      </p>
      <p>or</p>
      <p>
        <monospace>balbes -f &lt;data&gt; -m &lt;model&gt; -s &lt;sequence&gt;</monospace>
      </p>
      <p>where <monospace>model</monospace> is now an input PDB file.</p>
    </sec>
    <sec id="sec6.2">
      <label>6.2.</label>
      <title><italic>ccp</italic>4<italic>i</italic> interface</title>
      <p>Fig. 4<xref ref-type="fig" rid="fig4"> ▶</xref> shows an example of the <italic>ccp</italic>4<italic>i</italic>-style interface. The user only needs to provide a sequence and an experimental data file. Although the input is sufficiently simple, the output files contain all the process information, including the results of the analysis of the data by <italic>SFCHECK</italic>, <italic>REFMAC</italic> and <italic>MOLREP</italic>. If a solution is found, then a PDB file and an MTZ file containing the weighted coefficients corresponding to the refined models are also given.</p>
    </sec>
    <sec id="sec6.3">
      <label>6.3.</label>
      <title>Web interface</title>
      <p>Figs. 5<xref ref-type="fig" rid="fig5"> ▶</xref>(<italic>a</italic>) and 5<xref ref-type="fig" rid="fig5"> ▶</xref>(<italic>b</italic>) show the <italic>BALBES</italic> web interface. The user is required to upload data and sequence information and the process is then run. Output files are displayed according to their type; for example, if the output is a PDB file either it can be downloaded to the local computer or displayed using <italic>Jmol</italic> (<ext-link ext-link-type="uri" xlink:href="http://jmol.sourceforge.net/">http://jmol.sourceforge.net/</ext-link>).</p>
    </sec>
  </sec>
  <sec id="sec7">
    <label>7.</label>
    <title>Calibrating the system</title>
    <p>We are testing <italic>BALBES</italic> systematically during its development, which has proven to be beneficial to both the development of the whole system and of its individual components, including the incorporated scientific programs. While updating the database, the structure factors (if available) are also taken from the PDB. For these structures, <italic>BALBES</italic> runs automatically using the previous database and the results are compared with those of the final structures. The program developed for this purpose, <italic>solution_check</italic>, performs the comparison of these structures. This program compares two sets of PDB coordinates using all possible origins specific for this space group. Table 2<xref ref-type="table" rid="table2"> ▶</xref> shows tests carried out during 2006. After each session of tests, a detailed analysis of failed cases is carried out. If the reason for failure is clear and the program responsible for the failure can be identified, then that particular program is updated. If necessary, new algorithms are then designed and implemented to fix the problem. This has already enhanced the efficiency of <italic>BALBES</italic> and we have developed and implemented several new protocols (or algorithms) for both the individual scientific programs and <italic>BALBES</italic> itself. One of these protocols is shown in Fig. 6<xref ref-type="fig" rid="fig6"> ▶</xref>. This protocol combines refinement and several options of molecular replacement.</p>
    <p>The current version of the system does not include nucleic acid structures and structures solved by NMR. We are currently developing techniques and protocols for the efficient use of these structures. Both these type of entries have their peculiarities that need to be taken into account before including them in the system.</p>
    <p>The current success rate is around 75%, as shown in Table 2<xref ref-type="table" rid="table2"> ▶</xref>. It should be noted that structures are usually deposited in packs, <italic>i.e.</italic> one structure is solved using experimental phasing and then several related structures are solved using this method before all structures are deposited to the PDB simultaneously. If all search structures become available, then one can expect that this percentage will be higher. However, as was mentioned above, the PDB contains solved structures and thus all statistics based on this data bank are necessarily biased towards them. Therefore, the real success rate of the system is difficult to judge.</p>
  </sec>
  <sec id="sec8">
    <label>8.</label>
    <title>An example of the application of <italic>BALBES</italic>: multidomain protein <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1z45">1z45</ext-link>
         </title>
    <p>In this example, we use a multidomain protein in which the domains are from different molecules (see Fig. 3<xref ref-type="fig" rid="fig3"> ▶</xref>). Once the domains have been found, a simple molecular replacement is carried out using the largest domain and a very good contrast solution is found, which is then refined. <italic>R</italic> and <italic>R</italic>
            <sub>free</sub> after refinement of only one domain are 33% and 41%, respectively. Next, the refined model is used and weighted structure map coefficients are calculated in <italic>REFMAC</italic> to search for smaller domains in the electron density. The system finds the second domain and refines the first two domains. The system then tries to find the third domain but fails to do so. The reason for this is that it is too small and the packing function may prevent it solving this. It is a small fragment and the problem is a model-completion problem that can be solved using, for example, <italic>ARP</italic>/<italic>wARP</italic>.</p>
  </sec>
  <sec sec-type="conclusions" id="sec9">
    <label>9.</label>
    <title>Conclusions and future perspectives</title>
    <p>The organization of the database for macromolecular crystal structure solution is an important ingredient in designing automatic pipelines. We have designed such a database and as a proof of principle it has been successfully integrated into the <italic>BALBES</italic> molecular-replacement pipeline. Further development of this database is currently is under way. Future versions of the database will include several important features including molecule formation, operation from domains and analysis of these formations for compactness and variability, design and the regular update of sequence profiles for each domain class.</p>
    <p>Tests using the <italic>BALBES</italic> system have shown that with relatively simple protocols around 75% of all structures available in the PDB can be solved by MR automatically. We are currently analysing successful and unsuccessful cases. Successful cases are provided to developers of <italic>ARP</italic>/<italic>wARP</italic> for testing of automation. Unsuccessful cases are analysed by us to improve the molecular-replacement and refinement programs and procedures. These cases are available from the authors on request.</p>
    <p>The system is currently under intensive development. For example, the procedures described by Isupov &amp; Lebedev (2008<xref ref-type="bibr" rid="bb8"> ▶</xref>) and Lebedev <italic>et al.</italic> (2008<xref ref-type="bibr" rid="bb14"> ▶</xref>) will be implemented in future versions of the system.</p>
    <p>A future version of the system will also include decisions on such important aspects of crystallography as the correction of false origins when these are encountered (Lebedev, private communication) and automatic recognition and use of twinning during structure solution and refinement (Zhou, 2005<xref ref-type="bibr" rid="bb29"> ▶</xref>). One of the advantages of an automatic pipeline is that information can easily be extracted during structure solution and used when it is necessary. If a structure is solved by molecular replacement, then information about the model used can be utilized in refinement. For example, information about domains and/or secondary structures could be used during model building as well as refinement. It might be important when a search model is refined against high-resolution data and the target is at low resolution.</p>
    <p>In future, it is expected that this system will be linked with <italic>ARP</italic>/<italic>wARP</italic> and/or other automatic model-building procedures, thus completing the automation of molecular replacement. Combining this procedure with existing automatic experimental phasing procedures such as <italic>CRANK</italic> (Ness <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb18"> ▶</xref>) and <italic>Auto-Rickshaw</italic> (Panjikar <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb19"> ▶</xref>) would truly complete the automation of structure solution.</p>
    <p>The system is currently available from <ext-link ext-link-type="uri" xlink:href="http://www.ysbl.york.ac.uk/~fei/balbes/download">http://www.ysbl.york.ac.uk/~fei/balbes/download</ext-link>. When it is ready, it will be made available to the user community <italic>via</italic> the CCP4 download site <ext-link ext-link-type="uri" xlink:href="http://www.ccp4.ac.uk">http://www.ccp4.ac.uk</ext-link>.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Andrey Lebedev for discussions and useful suggestions and Misha Isupov, Gleb Bourunkev and Victor Lamzin for testing and useful feedback. This work was supported by the Wellcome Trust (FL and GNM; grant No. 064405/Z/01/A), BBSRC (AAV; grant No. 1 RO1 GM069758-03) and BIOXHIT (FL and PY; grant No. LSHG-CT-2003-503420). The computers used for testing the system were acquired using funds from NIH (grant No. 1 RO1 GM069758-03) and Wellcome Trust grants.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <citation citation-type="other">Berman, H. M., Westbrook, J., Feng, Z., Gilliland, G., Bhat, T. N., Weissig, H., Shindyalov, I. N. &amp; Bourne, P. E. (2000). <italic>Nucleic Acids Res.</italic><bold>28</bold>, 235–242.</citation>
    </ref>
    <ref id="bb2">
      <citation citation-type="other">Collaborative Computational Project, Number 4 (1994). <italic>Acta Cryst.</italic> D<bold>50</bold>, 760–763.</citation>
    </ref>
    <ref id="bb3">
      <citation citation-type="journal">Delarue, M. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 40–48.</citation>
    </ref>
    <ref id="bb4">
      <citation citation-type="other">Emsley, P. &amp; Cowtan, K. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2126–2132.</citation>
    </ref>
    <ref id="bb5">
      <citation citation-type="other">Germain, G., Main, P. &amp; Woolfson, M. M. (1970). <italic>Acta Cryst.</italic> B<bold>26</bold>, 274–285.</citation>
    </ref>
    <ref id="bb6">
      <citation citation-type="other">Hall, S. R., Allen, F. H. &amp; Brown, I. D. (1991). <italic>Acta Cryst.</italic> A<bold>47</bold>, 655–685.</citation>
    </ref>
    <ref id="bb7">
      <citation citation-type="other">Henikoff, S. &amp; Henikoff, J. G. (1992). <italic>Proc. Natl Acad. Sci. USA</italic>, <bold>89</bold>, 10915–10919.</citation>
    </ref>
    <ref id="bb8">
      <citation citation-type="journal">Isupov, M. N. &amp; Lebedev, A. A. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 90–98.</citation>
    </ref>
    <ref id="bb9">
      <citation citation-type="other">Jones, T. A., Zou, J.-Y., Cowan, S. W. &amp; Kjeldgaard, M. (1991). <italic>Acta Cryst.</italic> A<bold>47</bold>, 110–119.</citation>
    </ref>
    <ref id="bb10">
      <citation citation-type="journal">Keegan, R. &amp; Winn, M. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 119–124.</citation>
    </ref>
    <ref id="bb11">
      <citation citation-type="other">Kabsch, W. (1976). <italic>Acta Cryst.</italic> A<bold>32</bold>, 922–923.</citation>
    </ref>
    <ref id="bb12">
      <citation citation-type="other">Krissinel, E. &amp; Henrick, K. (2005). <italic>CompLife 2005</italic>, edited by M. R. Berthold, R. Glen, K. Diederichs, O. Kohlbacher &amp; I. Fischer, pp. 163–174. Berlin, Heidelberg: Springer-Verlag.</citation>
    </ref>
    <ref id="bb13">
      <citation citation-type="other">Krissinel, E. &amp; Henrick, K. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2256–2268.</citation>
    </ref>
    <ref id="bb14">
      <citation citation-type="journal">Lebedev, A., Vagin, A. A. &amp; Murshudov, G. N. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 33–39.</citation>
    </ref>
    <ref id="bb15">
      <citation citation-type="other">Murshudov, G. N., Vagin, A. A. &amp; Dodson, E. J. (1997). <italic>Acta Cryst.</italic> D<bold>53</bold>, 240–255.</citation>
    </ref>
    <ref id="bb16">
      <citation citation-type="other">Murzin, A. G., Brenner, S. E., Hubbard, T. &amp; Chothia, C. (1995). <italic>J. Mol. Biol.</italic><bold>147</bold>, 536–540.</citation>
    </ref>
    <ref id="bb30">
      <citation citation-type="other">Navaza, J. (1987). <italic>Acta Cryst.</italic> A<bold>43</bold>, 645–653.</citation>
    </ref>
    <ref id="bb17">
      <citation citation-type="other">Needleman, S. B. &amp; Wunsch, C. D. (1970). <italic>J. Mol. Biol.</italic><bold>48</bold>, 443–453.</citation>
    </ref>
    <ref id="bb18">
      <citation citation-type="other">Ness, S. R., de Graff, R. A. G., Abrahams, J. P. &amp; Pannu, N. S. (2004). <italic>Structure</italic>, <bold>12</bold>, 1753–1761.</citation>
    </ref>
    <ref id="bb19">
      <citation citation-type="other">Panjikar, S., Parthasarathy, V., Lamzin, V. S., Weiss, M. S. &amp; Tucker, P. A. (2005). <italic>Acta Cryst.</italic> D<bold>61</bold>, 449–457.</citation>
    </ref>
    <ref id="bb20">
      <citation citation-type="other">Pearl, F. <italic>et al.</italic> (2005). <italic>Nucleic Acids Res.</italic><bold>33</bold>, D247–D251.</citation>
    </ref>
    <ref id="bb21">
      <citation citation-type="other">Perrakis, A., Morris, R. &amp; Lamzin, V. S. (1999). <italic>Nature Struct. Biol.</italic><bold>6</bold>, 458–463.</citation>
    </ref>
    <ref id="bb22">
      <citation citation-type="other">Potterton, E., Briggs, P., Turkenburg, M. &amp; Dodson, E. (2003). <italic>Acta Cryst.</italic> D<bold>59</bold>, 1131–1137.</citation>
    </ref>
    <ref id="bb23">
      <citation citation-type="journal">Schwarzenbacher, R., Godzik, A. &amp; Jaroszewski, L. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 133–140.</citation>
    </ref>
    <ref id="bb24">
      <citation citation-type="other">Storoni, L. C., McCoy, A. J. &amp; Read, R. J. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 432–438.</citation>
    </ref>
    <ref id="bb25">
      <citation citation-type="other">Terwilliger, T. C. &amp; Berendzen, J. (1999). <italic>Acta Cryst.</italic> D<bold>55</bold>, 849–861.</citation>
    </ref>
    <ref id="bb27">
      <citation citation-type="other">Vagin, A. &amp; Teplyakov, A. (1997). <italic>J. Appl. Cryst.</italic><bold>30</bold>, 1022–1025.</citation>
    </ref>
    <ref id="bb28">
      <citation citation-type="other">Vaguine, A. A., Richelle, J. &amp; Wodak, S. J. (1999). <italic>Acta Cryst.</italic> D<bold>55</bold>, 191–205.</citation>
    </ref>
    <ref id="bb29">
      <citation citation-type="other">Zhou, D. (2005). PhD thesis. University of York, York, England.</citation>
    </ref>
  </ref-list>
</back>
<floats-wrap>
  <fig id="fig1" position="float">
    <label>Figure 1</label>
    <caption>
      <p>A pie chart showing the various methods used to determine X-ray structures for PDB entries released during 2006.</p>
    </caption>
    <graphic xlink:href="d-64-00125-fig1"/>
  </fig>
  <fig id="fig2" position="float">
    <label>Figure 2</label>
    <caption>
      <p>A schematic view of the <italic>BALBES</italic> workflow. All decisions are made internally according to the amount of data (reflections and sequence) and the stage of structure solution. The pink arrows show that the manager controls all the activities involved and the green arrows show the directions of the workflow.</p>
    </caption>
    <graphic xlink:href="d-64-00125-fig2"/>
  </fig>
  <fig id="fig3" position="float">
    <label>Figure 3</label>
    <caption>
      <p>An example of a search for several domains from the domain database. The target structure (<ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1z45">1z45</ext-link>) has three domains. The system finds all domains step by step. These domains belong to <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1udc">1udc</ext-link> (domain 1), <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1yga">1yga</ext-link> (domain 2) and <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ek6">1ek6</ext-link> (domain 3).</p>
    </caption>
    <graphic xlink:href="d-64-00125-fig3"/>
  </fig>
  <fig id="fig4" position="float">
    <label>Figure 4</label>
    <caption>
      <p><italic>BALBES ccp</italic>4<italic>i</italic> interface.</p>
    </caption>
    <graphic xlink:href="d-64-00125-fig4"/>
  </fig>
  <fig id="fig5" position="float">
    <label>Figure 5</label>
    <caption>
      <p><italic>BALBES</italic> web server. <italic>BALBES</italic> can be run from the YSBL programs website by uploading a structure-factor file and sequence-target file to the web server (<italic>a</italic>), which interacts with <italic>BALBES via</italic> a program poller. For example, the poller looks for a <monospace>startingProcess</monospace> file on the web server; when this is found, <italic>BALBES</italic> is run (on a separate host) and output files are copied across to the web server. The user can then view the output files by selecting an option from one of the drop-down menus (<italic>b</italic>). At present, viewable file types are text files, MTZ, PDB (using <italic>Jmol</italic>) and PDF.</p>
    </caption>
    <graphic xlink:href="d-64-00125-fig5"/>
  </fig>
  <fig id="fig6" position="float">
    <label>Figure 6</label>
    <caption>
      <p>A protocol for the combination of refinement and molecular replacement, with and without phases, when domains exist in the search model.</p>
    </caption>
    <graphic xlink:href="d-64-00125-fig6"/>
  </fig>
  <table-wrap id="table1" position="float">
    <label>Table 1</label>
    <caption>
      <title>Search models in a template structure</title>
      <p>PDB code <ext-link ext-link-type="uri" xlink:href="http://www.rcsb.org/pdb/explore.do?structureId=1ji5">1ji5</ext-link>; No. of models = 4.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead valign="bottom">
        <tr>
          <th rowspan="1" colspan="1" align="left" char="." charoff="11" valign="bottom">Model</th>
          <th rowspan="1" colspan="1" align="left" valign="bottom">Chain ID</th>
          <th rowspan="1" colspan="1" align="left" char="." charoff="11" valign="bottom">Similarity</th>
          <th rowspan="1" colspan="1" align="left" char="." charoff="11" valign="bottom">Residues</th>
          <th rowspan="1" colspan="1" align="left" valign="bottom">Multimer?</th>
          <th rowspan="1" colspan="1" align="left" valign="bottom">Domain?</th>
          <th rowspan="1" colspan="1" align="left" char="." charoff="11" valign="bottom">Monomers</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">1</td>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>A</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">0.5</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">142</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Monomer</td>
          <td rowspan="1" colspan="1" align="left" valign="top">No</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">5</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">2</td>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>A</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">0.5</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">119</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Monomer</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Yes</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">5</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">3</td>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>AB</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">0.5</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">284</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Dimer</td>
          <td rowspan="1" colspan="1" align="left" valign="top">No</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">2</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">4</td>
          <td rowspan="1" colspan="1" align="left" valign="top">
            <italic>ABC</italic>
          </td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">0.5</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">426</td>
          <td rowspan="1" colspan="1" align="left" valign="top">Trimer</td>
          <td rowspan="1" colspan="1" align="left" valign="top">No</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="11" valign="top">1</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="table2" position="float">
    <label>Table 2</label>
    <caption>
      <title>Test statistics for structure-factor files released between 1 January 2006 and 9 October 2006 (files released between 5 August and 21 September 2006 are excluded)</title>
    </caption>
    <table frame="hsides" rules="groups">
      <thead valign="bottom">
        <tr>
          <th rowspan="1" colspan="1" align="left" valign="bottom">Method</th>
          <th rowspan="1" colspan="1" align="left" valign="bottom">No. of cases</th>
          <th rowspan="1" colspan="1" align="left" valign="bottom">Cases solved</th>
          <th rowspan="1" colspan="1" align="left" valign="bottom">Success rate (%)</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">All</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">3136</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">2323</td>
          <td rowspan="1" colspan="1" align="left" valign="top">74.1</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">MR</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">2090</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">1759</td>
          <td rowspan="1" colspan="1" align="left" valign="top">84.1</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">SIR</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">21</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">5</td>
          <td rowspan="1" colspan="1" align="left" valign="top">23.8</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">MIR</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">57</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">13</td>
          <td rowspan="1" colspan="1" align="left" valign="top">22.8</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">SAD</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">263</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">78</td>
          <td rowspan="1" colspan="1" align="left" valign="top">29.7</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">MAD</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">305</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">104</td>
          <td rowspan="1" colspan="1" align="left" valign="top">34.1</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">Other<xref ref-type="table-fn" rid="tfn1">†</xref></td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">400</td>
          <td rowspan="1" colspan="1" align="char" char="." charoff="50" valign="top">364</td>
          <td rowspan="1" colspan="1" align="left" valign="top">91.0</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="tfn1">
        <label>†</label>
        <p>The techniques used for structure determination are not properly specified in the PDB file. These are most probably specified in the structures of isomorphous crystals.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-wrap>
