<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860087</article-id>
    <article-id pub-id-type="pmid">28961954</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx499</article-id>
    <article-id pub-id-type="publisher-id">btx499</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Databases and Ontologies</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PiMP my metabolome: an integrated, web-based tool for LC-MS metabolomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-0493-8592</contrib-id>
        <name>
          <surname>Gloaguen</surname>
          <given-names>Yoann</given-names>
        </name>
        <xref ref-type="aff" rid="btx499-aff1">1</xref>
        <xref ref-type="author-notes" rid="btx499-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Morton</surname>
          <given-names>Fraser</given-names>
        </name>
        <xref ref-type="aff" rid="btx499-aff1">1</xref>
        <xref ref-type="author-notes" rid="btx499-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Daly</surname>
          <given-names>Rónán</given-names>
        </name>
        <xref ref-type="aff" rid="btx499-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gurden</surname>
          <given-names>Ross</given-names>
        </name>
        <xref ref-type="aff" rid="btx499-aff1">1</xref>
        <xref ref-type="aff" rid="btx499-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rogers</surname>
          <given-names>Simon</given-names>
        </name>
        <xref ref-type="aff" rid="btx499-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-3068-4664</contrib-id>
        <name>
          <surname>Wandy</surname>
          <given-names>Joe</given-names>
        </name>
        <xref ref-type="aff" rid="btx499-aff1">1</xref>
        <xref ref-type="aff" rid="btx499-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wilson</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="btx499-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barrett</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="btx499-aff1">1</xref>
        <xref ref-type="aff" rid="btx499-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Burgess</surname>
          <given-names>Karl</given-names>
        </name>
        <xref ref-type="aff" rid="btx499-aff1">1</xref>
        <xref ref-type="corresp" rid="btx499-cor1"/>
        <!--<email>karl.burgess@glasgow.ac.uk</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx499-aff1"><label>1</label>Institute of Infection, Immunity and Inflammation, Glasgow Polyomics, University of Glasgow, Glasgow, UK</aff>
    <aff id="btx499-aff2"><label>2</label>Centre for Cell Engineering, University of Glasgow, Glasgow, UK</aff>
    <aff id="btx499-aff3"><label>3</label>School of Computing Science, University of Glasgow, Glasgow, UK</aff>
    <aff id="btx499-aff4"><label>4</label>Wellcome Trust Centre for Molecular Parasitology, Institute of Infection, Immunity and Inflammation, University of Glasgow, Glasgow, UK</aff>
    <author-notes>
      <fn id="btx499-FM1">
        <p>The authors wish it to be known that Yoann Gloaguen and Fraser Morton authors contributed equally.</p>
      </fn>
      <corresp id="btx499-cor1">To whom correspondence should be addressed. Email: <email>karl.burgess@glasgow.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>12</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-08-14">
      <day>14</day>
      <month>8</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>8</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>24</issue>
    <fpage>4007</fpage>
    <lpage>4009</lpage>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>2</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>6</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>8</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx499.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>The Polyomics integrated Metabolomics Pipeline (PiMP) fulfils an unmet need in metabolomics data analysis. PiMP offers automated and user-friendly analysis from mass spectrometry data acquisition to biological interpretation. Our key innovations are the Summary Page, which provides a simple overview of the experiment in the format of a scientific paper, containing the key findings of the experiment along with associated metadata; and the Metabolite Page, which provides a list of each metabolite accompanied by ‘evidence cards’, which provide a variety of criteria behind metabolite annotation including peak shapes, intensities in different sample groups and database information.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>PiMP is available at <ext-link ext-link-type="uri" xlink:href="http://polyomics.mvls.gla.ac.uk">http://polyomics.mvls.gla.ac.uk</ext-link>, and access is freely available on request. 50 GB of space is allocated for data storage, with unrestricted number of samples and analyses per user. Source code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/RonanDaly/pimp">https://github.com/RonanDaly/pimp</ext-link> and licensed under the GPL.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Wellcome Trust</named-content>
          <named-content content-type="funder-identifier">10.13039/100004440</named-content>
        </funding-source>
        <award-id>097821/Z/11/Z and 105614/Z/14/Z</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Metabolomics aims to catalogue and quantify the complete small molecule complement of a biological system (<xref rid="btx499-B6" ref-type="bibr">Oliver <italic>et al.</italic>, 1998</xref>). Liquid chromatography–mass spectrometry (LCMS) is now the most common analytical technique used to generate metabolomics data, and the methodology is capable of detecting hundreds to thousands of metabolites from a single sample. While the analytical platforms available are well developed (<xref rid="btx499-B2" ref-type="bibr">Dunn <italic>et al.</italic>, 2011</xref>), methods for linking the detected features, through identification of metabolites, to the interpretation of biological context are poorly developed. Annotation tools, pathway mapping tools and statistical tools often consist of individual functions or packages that must be invoked separately, requiring modification of data formats. Here we present a comprehensive and integrated web enabled pipeline: the Polyomics integrated Metabolomics Pipeline (PiMP). Through extensive interaction with end users, we have developed a workflow aimed at researchers with a modest background understanding of metabolomics and biochemistry, but with a need to garner vital information now available through MS-based metabolomics experimentation. The processing of metabolomics data in PiMP is presented as an assisted pipeline consisting of five sequential tasks: (i) project administration, (ii) data upload, (iii) quality control, (iv) analysis parameters and (v) data interpretation. This assisted pipeline provides guidance to users analysing metabolomics data without necessarily having significant prior knowledge pertaining to metabolomics workflows or even biochemistry. Results of experiments are shown using a tabbed display system, providing access to different contexts in which the data can be evaluated. These are: the <bold>summary</bold> tab; the <bold>metabolite</bold> tab and the <bold>pathways</bold> tab. Comparing the three major online platforms available (XCMS Online (<xref rid="btx499-B10" ref-type="bibr">Tautenhahn <italic>et al.</italic>, 2012</xref>), Workflow4metabolomics (W4M) (<xref rid="btx499-B3" ref-type="bibr">Giacomoni <italic>et al.</italic>, 2015</xref>) and MetaboAnalyst (<xref rid="btx499-B11" ref-type="bibr">Xia <italic>et al.</italic>, 2012</xref>), W4M provides a user-friendly front end to XCMS, but is limited to default visualizations and provides no biological inference for the results and MetaboAnalyst provides extensive statistical tools and interpretation, but lacks the contextual design of PiMP. XCMS Online provides the majority of PiMPs features, but is lacking the modular design and open development model of PiMP. Indeed a third party module has already been developed interfacing PiMP with MetExplore (<xref rid="btx499-B1" ref-type="bibr">Cottret <italic>et al.</italic>, 2010</xref>).</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>The user-interface of PiMP is written in common Web standards and accessible from any modern Web browser. Where possible, portions of the user interface are selectively retrieved and updated via asynchronous Javascript to improve perceived response time. The back-end of the PiMP web application is written in Python using Django. Django provides an abstraction layer to the database using object-relational mapping techniques. PiMP uses MySQL to store the data in a relational database. The analysis components in PiMP are implemented as an R pipeline based around XCMS (Colin A. <xref rid="btx499-B8" ref-type="bibr">Smith <italic>et al.</italic>, 2006</xref>) for the feature detection and mzMatch.R (<xref rid="btx499-B7" ref-type="bibr">Scheltema <italic>et al.</italic>, 2011</xref>) for common metabolomics data pre-processing tasks (<italic>e.g.</italic> alignment, batch correction and identification). All these components are gathered in a Docker container for easy deployment, both locally and on a shared server. Analysis results are returned to the web application via a PiMP-specific XML format, allowing for the possibility of a new computational pipeline to be used in place of the current pipeline, provided that the same output schema is maintained. From the user interface, analysis results can also be exported into text files for processing outside PiMP.</p>
  </sec>
  <sec>
    <title>3 Using PiMP</title>
    <p>Please refer to the <xref ref-type="supplementary-material" rid="sup1">Supplementary Information</xref> for a comprehensive user manual. PiMP’s project administration interface allows the user to define the experimental design, specify metadata (e.g. the study organism or specific tissue studied), and to share the project with collaborators with a chosen level of permission. The data can be uploaded by simple drag and drop. Visualization tools then allow the user to assess the quality of the data by accessing total ion chromatograms (TICs), viewing and curating raw data or looking for specific features/compounds including internal or external standards. The pipeline supports pairwise and combinatorial comparisons. Default parameters for XCMS and mzMatch are suggested to the user for data analysis, but alternatives are readily available via drag-down menus. Results are presented in a unified data exploration environment, organized into tabs (<xref ref-type="fig" rid="btx499-F1">Fig. 1</xref>). The <bold>summary</bold> tab contains the key metadata for the experiment, along with TICs allowing basic visualization of the reproducibility of each sample group. Principal component analysis plots are also provided for the dataset as a means of rapid quality control for the data. Experimental comparisons are then displayed with significant quantitative differences highlighted using histograms and a volcano plot, allowing metabolites corresponding to the largest changes between experimental conditions to be analysed. While for biomarker discovery applications, this may be sufficient as a starting point, biochemical context is often key to interpretation of a dataset. The <bold>metabolites</bold> tab provides a powerful means of understanding the biochemical changes observed in an experiment. It is based around the concept of ‘evidence’ for a particular metabolite. Any metabolite for which evidence for its existence is available is presented. This evidence, along with quantitative information, peak chromatograms, pathway information and structures are presented in a sidebar. To provide context for metabolites, filtering based on pathway and superpathway is available from the toolbar, and with the colour-coding for fold change between groups, the quantitative modulation of a given pathway can readily be assessed. The <bold>pathways</bold> tab then provides a summary of the detected pathways, and the sidebar allows direct access to the KEGG map associated with a chosen pathway (<xref rid="btx499-B4" ref-type="bibr">Kanehisa <italic>et al.</italic>, 2014</xref>). Once the map has been generated, comparisons can be overlaid on the map, providing a colour-coded overview of metabolism, in the same way as other applications (<xref rid="btx499-B5" ref-type="bibr">Leader <italic>et al.</italic>, 2011</xref>; <xref rid="btx499-B9" ref-type="bibr">Suhre and Schmitt-Kopplin, 2008</xref>). Two other tabs are available: the <bold>comparison</bold> tab and the <bold>peaks</bold> tab, which contain the raw peak data. Due to the number of unknown compounds detected, even after filtering for adducts and fragments, these are available for projects where information on all peaks detected is needed, irrespective of our ability to annotate them as putative metabolites.
</p>
    <fig id="btx499-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>Overview of the Polyomics integrated Metabolomics Pipeline—sample graphs from results tabs (Color version of this figure is available at <italic>Bioinformatics</italic> online.)</p>
      </caption>
      <graphic xlink:href="btx499f1"/>
    </fig>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx499_pimp_user_guide.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Maxime Chazalviel, Fabien Jourdan and Benjamin Merlet for their contribution in the integration of MetExplore with PiMP.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Wellcome Trust grants 097821/Z/11/Z and 105614/Z/14/Z. RG was supported by the BBSRC WestBio DTP - Grant Number BB/J013854/1.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx499-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cottret</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>MetExplore: a web server to link metabolomic experiments and genome-scale metabolic networks</article-title>. <source>Nucleic Acids Res</source>., <volume>38</volume>, <fpage>W132</fpage>–<lpage>W137</lpage>.<pub-id pub-id-type="pmid">20444866</pub-id></mixed-citation>
    </ref>
    <ref id="btx499-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dunn</surname><given-names>W.B.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Procedures for large-scale metabolic profiling of serum and plasma using gas chromatography and liquid chromatography coupled to mass spectrometry</article-title>. <source>Nat. Protoc</source>., <volume>6</volume>, <fpage>1060</fpage>–<lpage>1083</lpage>.<pub-id pub-id-type="pmid">21720319</pub-id></mixed-citation>
    </ref>
    <ref id="btx499-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Giacomoni</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Workflow4Metabolomics: a collaborative research infrastructure for computational metabolomics</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>1493</fpage>–<lpage>1495</lpage>.<pub-id pub-id-type="pmid">25527831</pub-id></mixed-citation>
    </ref>
    <ref id="btx499-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kanehisa</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Data, information, knowledge and principle: back to metabolism in KEGG</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>D199</fpage>–<lpage>D205</lpage>.<pub-id pub-id-type="pmid">24214961</pub-id></mixed-citation>
    </ref>
    <ref id="btx499-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leader</surname><given-names>D.P.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Pathos: A web facility that uses metabolic maps to display experimental changes in metabolites identified by mass spectrometry</article-title>. <source>Rapid Commun. Mass Spectrom</source>., <volume>25</volume>, <fpage>3422</fpage>–<lpage>3426</lpage>.<pub-id pub-id-type="pmid">22002696</pub-id></mixed-citation>
    </ref>
    <ref id="btx499-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Oliver</surname><given-names>S.G.</given-names></name></person-group><etal>et al</etal> (<year>1998</year>) 
<article-title>Systematic functional analysis of the yeast genome</article-title>. <source>Trends Biotechnol</source>., <volume>16</volume>, <fpage>373</fpage>–<lpage>378</lpage>.<pub-id pub-id-type="pmid">9744112</pub-id></mixed-citation>
    </ref>
    <ref id="btx499-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scheltema</surname><given-names>R.A.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>PeakML/mzMatch: a file format, java library, R library, and tool-chain for mass spectrometry data analysis</article-title>. <source>Anal. Chem</source>., <volume>83</volume>, <fpage>2786</fpage>–<lpage>2793</lpage>.<pub-id pub-id-type="pmid">21401061</pub-id></mixed-citation>
    </ref>
    <ref id="btx499-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>C.A.</given-names></name></person-group><etal>et al</etal><article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>. <source>Anal. chem.</source>, <volume>78</volume>, <fpage>779</fpage>–<lpage>787</lpage>.<pub-id pub-id-type="pmid">16448051</pub-id></mixed-citation>
    </ref>
    <ref id="btx499-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Suhre</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Schmitt-Kopplin</surname><given-names>P.</given-names></name></person-group> (<year>2008</year>) 
<article-title>MassTRIX: mass translator into pathways</article-title>. <source>Nucleic Acids Res</source>., <volume>36</volume>, <fpage>W481</fpage>–<lpage>W484</lpage>.<pub-id pub-id-type="pmid">18442993</pub-id></mixed-citation>
    </ref>
    <ref id="btx499-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tautenhahn</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>XCMS online: a web-based platform to process untargeted metabolomic data</article-title>. <source>Anal. Chem</source>., <volume>84</volume>, <fpage>5035</fpage>–<lpage>5039</lpage>.<pub-id pub-id-type="pmid">22533540</pub-id></mixed-citation>
    </ref>
    <ref id="btx499-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xia</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>MetaboAnalyst 2.0–a comprehensive server for metabolomic data analysis</article-title>. <source>Nucleic Acids Res</source>., <volume>40</volume>, <fpage>W127</fpage>–<lpage>W133</lpage>.<pub-id pub-id-type="pmid">22553367</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
