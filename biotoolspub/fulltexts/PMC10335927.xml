<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Genet</journal-id>
    <journal-title-group>
      <journal-title>Nature Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1061-4036</issn>
    <issn pub-type="epub">1546-1718</issn>
    <publisher>
      <publisher-name>Nature Publishing Group US</publisher-name>
      <publisher-loc>New York</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10335927</article-id>
    <article-id pub-id-type="pmid">37386250</article-id>
    <article-id pub-id-type="publisher-id">1438</article-id>
    <article-id pub-id-type="doi">10.1038/s41588-023-01438-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Brief Communication</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Imputation of low-coverage sequencing data from 150,119 UK Biobank genomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7725-4813</contrib-id>
        <name>
          <surname>Rubinacci</surname>
          <given-names>Simone</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9965-595X</contrib-id>
        <name>
          <surname>Hofmeister</surname>
          <given-names>Robin J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sousa da Mota</surname>
          <given-names>Bárbara</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3906-8446</contrib-id>
        <name>
          <surname>Delaneau</surname>
          <given-names>Olivier</given-names>
        </name>
        <address>
          <email>olivier.delaneau@unil.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.9851.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 2165 4204</institution-id><institution>Department of Computational Biology, </institution><institution>University of Lausanne, </institution></institution-wrap>Lausanne, Switzerland </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.419765.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2223 3006</institution-id><institution>Swiss Institute of Bioinformatics, </institution></institution-wrap>Lausanne, Switzerland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2023</year>
    </pub-date>
    <volume>55</volume>
    <issue>7</issue>
    <fpage>1088</fpage>
    <lpage>1090</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The release of 150,119 UK Biobank sequences represents an unprecedented opportunity as a reference panel to impute low-coverage whole-genome sequencing data with high accuracy but current methods cannot cope with the size of the data. Here we introduce GLIMPSE2, a low-coverage whole-genome sequencing imputation method that scales sublinearly in both the number of samples and markers, achieving efficient whole-genome imputation from the UK Biobank reference panel while retaining high accuracy for ancient and modern genomes, particularly at rare variants and for very low-coverage samples.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">GLIMPSE2 is an improved method using sparse models for accurate, efficient and cost-effective genotype imputation in low-coverage whole-genome sequencing data.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>DNA sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001711</institution-id>
            <institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung (Swiss National Science Foundation)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PP00P3_176977</award-id>
        <principal-award-recipient>
          <name>
            <surname>Delaneau</surname>
            <given-names>Olivier</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature America, Inc. 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Main</title>
    <p id="Par3">Recent work and method advances<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref></sup> highlight the advantages of low-coverage whole-genome sequencing (lcWGS), followed by genotype imputation from a large reference panel, as a cost-effective genotyping technology for statistical and population genetics. Large-scale whole-genome sequencing projects, such as the recent release of 150,119 samples from the UK Biobank<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> (UKB), offer new opportunities to improve lcWGS imputation, potentially improving accuracy at rare variants (minor allele frequency (MAF) &lt; 0.1%). However, current methods struggle to scale to the size of this new generation of reference panels resulting in prohibitive computational costs. To address this issue, we propose GLIMPSE v.2 (GLIMPSE2), a major improvement of GLIMPSE<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, that scales to a reference panel containing millions of reference haplotypes, with high imputation accuracy at rare variants (MAF &lt; 0.1%) and for very low-coverage samples (0.1× to 0.5×).</p>
    <p id="Par4">To demonstrate the benefits of using sequenced biobanks for lcWGS imputation, we phased the recent release of the UKB WGS data<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR6">6</xref></sup> using SHAPEIT5 (ref. <sup><xref ref-type="bibr" rid="CR7">7</xref></sup>) and created a UKB reference panel of 280,238 haplotypes and 582,534,516 markers (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>). We used the UKB panel to impute lcWGS samples with GLIMPSE2 and other recently released imputation methods: GLIMPSE1 (ref. <sup><xref ref-type="bibr" rid="CR1">1</xref></sup>) and QUILT v1.0.4 (ref. <sup><xref ref-type="bibr" rid="CR2">2</xref></sup>). Compared to other reference panels, the UKB leads to considerable accuracy improvements for British samples across all tested depths of coverage. Furthermore, GLIMPSE2 outperforms GLIMPSE1, particularly at rare variants (MAF &lt; 0.1%) and for very low-coverage (for 0.1× and 1.0× data at 0.01% MAF, GLIMPSE1 and GLIMPSE2 obtain an <italic>r</italic><sup>2</sup> of 0.561 and 0.892 compared to 0.725 and 0.927, respectively) and matches QUILT v.1.0.4 accuracy, designed to condition on the full set of reference haplotypes (for 0.1× and 1.0× data at 0.01% MAF, QUILT v.1.0.4 obtained an <italic>r</italic><sup>2</sup> of 0.728 and 0.925, respectively; Fig. <xref rid="Fig1" ref-type="fig">1a</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>, Supplementary Figs. <xref rid="MOESM1" ref-type="media">1</xref>–<xref rid="MOESM1" ref-type="media">3</xref> and Supplementary Tables <xref rid="MOESM1" ref-type="media">2</xref>–<xref rid="MOESM1" ref-type="media">4</xref>). We also find that the accuracy of GLIMPSE2 and QUILT v.1.0.4 methods is similar when imputing 42 non-European samples from 1,000 Genomes Project using the UKB reference panel (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><title>Accuracy, running time and power of low-coverage imputation using the UKB WGS data.</title><p><bold>a</bold>,<bold>b</bold>, Imputation performance of different imputation methods: QUILT v.1.0.4 (black), GLIMPSE1 (gray) and GLIMPSE2 (blue); across the 1,000 Genomes Project (KGP), HRC and UKB reference panels, for 100 UKB British samples at 1.0× coverage. <bold>a</bold>, Accuracy on chromosome 20 (Pearson <italic>r</italic><sup>2</sup>, <italic>y</italic> axis), of imputation methods and reference panels: KGP (dotted line), HRC (dashed line) and UKB (full line). Accuracy is plotted against MAF of the appropriate reference panel (<italic>x</italic> axis, log scale). <bold>b</bold>, Cost per sample on the RAP for whole-genome imputation (<italic>y</italic> axis, log scale) across different reference panels (<italic>x</italic> axis). <bold>c</bold>,<bold>d</bold>, Performance of imputed data using the UKB reference panel across coverages (0.1–4.0×, different shades of blue, GLIMPSE2 imputation) and Axiom array data (red). <bold>c</bold>, Accuracy on chromosome 1 of 10,000 UKB British samples (Pearson <italic>r</italic><sup>2</sup>, <italic>y</italic> axis) against MAF of the appropriate reference panel (<italic>x</italic> axis, log scale). <bold>d</bold>, Power in association testing of 10,000 UKB British samples compared to high-coverage data. Correlation of betas and <italic>P</italic> values (Pearson <italic>r</italic><sup>2</sup>, <italic>y</italic> axis) of different imputed datasets (<italic>x</italic> axis) across 22 UKB phenotypes. Lower and upper limits of the box plots represent the first and third quartiles (Q1 and Q3); the median is marked at the center of the box. Lower and upper whiskers are defined as Q1 − 1.5 (Q3–Q1) and Q3 + 1.5 (Q3–Q1), respectively.</p><p><xref rid="MOESM3" ref-type="media">Source data</xref></p></caption><graphic xlink:href="41588_2023_1438_Fig1_HTML" id="d32e424"/></fig></p>
    <p id="Par5">We further investigate the effect of the reference panel by imputing individuals of 129 human populations from the Simons Genome Diversity Project and we show that the UKB panel drastically improves imputation accuracy of European samples compared to the 1,000 Genomes Project reference panel, in particular of Northern Europe origin, for which the UKB reference panel obtains a reduction of non-reference discordance rate &gt;67% (Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>, Extended Data Fig. <xref rid="Fig3" ref-type="fig">2</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>). Additionally, we imputed three ancient Europeans and a Yamnaya sample for which high-coverage data (&gt;18×) are available and find similar improvements (Supplementary Note <xref rid="MOESM1" ref-type="media">4</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>), showing that some ancient populations, such as Viking, Western Hunter-Gatherer and Yamnaya could be well imputed from the UKB reference panel.</p>
    <p id="Par6">The imputation of a single lcWGS genome using the UKB reference panel is expensive or prohibitive using existing methods. On the UKB research analysis platform (RAP), the cost is £1.11 and £242.80 for GLIMPSE1 and QUILT v.1.0.4, respectively. In contrast, the same task performed with GLIMPSE2 only costs £0.08, due to major algorithmic improvements that drastically reduce the imputation time for rare variants (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">5</xref> and <xref rid="MOESM1" ref-type="media">6</xref>). We confirm this trend for up to 2 million reference haplotypes, using simulated data (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>). These improvements in imputation running time and memory requirements are crucial to keep lcWGS close to single nucleotide polymorphism (SNP) arrays in terms of computational costs<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">5</xref>) while maintaining the major advantage of providing better genotype calls. Indeed, we find that imputation of 0.5× data yields similar or more accurate results compared to the UKB Axiom array, with a notable difference at rare variants (for 0.5× coverage, accuracy improvement of <italic>r</italic><sup>2</sup> &gt; 0.1 for variants with a MAF &lt; 0.01%, Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). Using simulated SNP arrays, we further confirm that 0.5× yields at least the same imputation accuracy as the densest SNP array model tested (Omni 2.5 array; Extended Data Fig. <xref rid="Fig4" ref-type="fig">3</xref>).</p>
    <p id="Par7">To assess the impact of these improvements on genome-wide association studies (GWAS), we imputed 10,000 UKB samples that we used to test 22 quantitative traits for association, comparing the respective abilities of lcWGS and SNP array data to recover the signals found with high-coverage sequencing data (Supplementary Note <xref rid="MOESM1" ref-type="media">6</xref>). We find that 0.5× leads to <italic>P</italic> values and effect size estimates as accurate as those obtained from Axiom array data (Fig. <xref rid="Fig1" ref-type="fig">1d</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">10</xref>–<xref rid="MOESM1" ref-type="media">12</xref>) while delimiting regions of association with matching sensitivity and specificity (Supplementary Note <xref rid="MOESM1" ref-type="media">6</xref> and Extended Data Fig. <xref rid="Fig5" ref-type="fig">4</xref>). We also look at rare loss-of-function, missense and synonymous variants<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> and show that 1.0× outperforms the Axiom array for all categories of variants, an improvement that will be reflected in downstream burden-test analysis (Supplementary Note <xref rid="MOESM1" ref-type="media">7</xref> and Extended Data Fig. <xref rid="Fig6" ref-type="fig">5</xref>). Altogether, this shows that lcWGS constitutes a powerful alternative to SNP array for downstream GWAS and rare-variant analysis.</p>
    <p id="Par8">In this work, we introduce several improvements to the GLIMPSE method that solve the computational problem of imputing lcWGS data from the 150,119 WGS samples in the UKB. We demonstrate that this reference panel leads to striking accuracy improvements across several sample ancestries, allele frequencies and depths of coverages. Our study further confirms the advantage of lcWGS over SNP arrays for GWAS, by showing that using imputed data with coverage as low as 0.5× are enough to outperform SNP array data, particularly at rare variants. Our work can be applied to other sequenced and diverse biobanks, such as Trans-Omics for Precision Medicine<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, gnomAD<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> or AllofUs<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, thereby facilitating lcWGS imputation of non-European individuals. We believe that the difference between low-coverage and high-coverage WGS will become increasingly smaller as large reference panels will keep collecting more human haplotype diversity.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par9">This study relies on analyses of genetic data from the UKB cohort, which was collected with informed consent obtained from all participants. Data for this study were obtained under the UKB applications licence number 66995 and are available to registered researchers through the UKB data-access protocol. Additional data used in this study are all publicly available.</p>
    <sec id="Sec3">
      <title>GLIMPSE2</title>
      <p id="Par10">To perform imputation of low-coverage WGS data, GLIMPSE2 uses a Gibbs sampler algorithm that alternates between haploid imputation and phasing, using a modified version of the Li and Stephens hidden Markov model (HMM)<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. The method necessitates a genotype likelihoods matrix for the target samples and a reference panel of haplotypes as input. The initialization step begins with the selection of a set of haplotypes from the reference panel via rare-variant calls derived from the low-coverage genotype likelihoods. Following that, two consecutive steps of haploid imputation are executed, one for each of the two target haplotypes. At the end of the initialization step, a diplotype is assigned to each target sample. GLIMPSE2 subsequently runs a series of burn-in and main Gibbs iterations to refine the genotype calls and phasing of each target sample. The algorithm determines haploid likelihoods for one of the two target haplotypes, based on the original genotype likelihoods and conditional on the current estimate of the other haplotype. To integrate over phasing uncertainty, the approach averages imputation posteriors across all main iterations.</p>
      <p id="Par11">Conversely from the GLIMPSE1 method, GLIMPSE2 approach is primarily focused on imputation only from the reference panel and it optimizes this task by incorporating new features. First, the reference panel is represented sparsely in memory, allowing for efficient storage of dense cohorts. The sparse representation of the reference panel facilitates the introduction of a new data structure to hasten haplotype matching and an efficient implementation of the HMM, which calculates posterior probabilities by leveraging the sparsity of the panel. Additional features of GLIMPSE2 include a genotype caller that integrates genotype likelihood computations directly into the GLIMPSE software and imputation of small insertions and deletions and low-quality variants separately from SNPs, by performing imputation into a haplotype scaffold obtained from high-quality SNPs.</p>
      <p id="Par12">The subsequent sections will provide a more comprehensive explanation of three of the previously referenced features, which are critical for the ability of the model to scale when applied to deeply sequenced reference panels. Further details regarding the method can be found in Supplementary Note <xref rid="MOESM1" ref-type="media">1.2.2</xref>.</p>
    </sec>
    <sec id="Sec4">
      <title>Sparse reference panel representation</title>
      <p id="Par13">GLIMPSE2 represents the reference panel as a sparse matrix, encoding haplotypes with one bit per allele if the variant is defined as common (MAF ≥ 0.001 by default) and storing the indices of the haplotypes that carry the minor allele, otherwise. This data representation allows for small memory usage but also for a fast identification of the haplotypes carrying a rare variant. Additionally, the transpose of the data structures gives efficient access to the rare variants of each haplotype. More details can be found in Supplementary Note <xref rid="MOESM1" ref-type="media">1.2.2.1</xref>.</p>
      <p id="Par14">We encoded the sparse reference panel representation in a binary file format to be efficiently stored on the disk. The file format translates directly into the memory data structures used by GLIMPSE2 and does not require any general-purpose compression algorithm. Together with the reference file format, we store the run-length encoded sparse positional Burrows–Wheeler transform (PBWT) data structure in the same file file, together with the recombination map. As a result, all the data related to the reference panel can be quickly loaded in memory, in much faster running times than standard file formats, such as VCF and BCF.</p>
    </sec>
    <sec id="Sec5">
      <title>Sparse positional Burrows–Wheeler transform matching</title>
      <p id="Par15">One of the key components of the GLIMPSE1 model is to reduce the state space using PBWT<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, a data structure that allows efficient query searches in haplotype cohorts, linear in the number of samples and markers. Similarly, GLIMPSE2 extends the PBWT and proposes an algorithm designed for large sequencing cohorts, here called sparse PBWT.</p>
      <p id="Par16">By using the sparse representation of the reference panel, rare variants are treated differently than common variants, allowing the computation of smaller PBWTs which speeds up the algorithm. This is based on the idea that between two adjacent common variants most of the haplotypes do not contain the minor allele in the region and therefore most of the haplotypes would form a single invariable block of major alleles that preserves their relative haplotype order. Therefore, a smaller PBWT is constructed only on haplotypes that have at least one minor allele between two adjacent common variants. The positional prefix array of the small PBWT at the end of the rare-variant interval is simply concatenated with the positional prefix array of other haplotypes that are not changing in the interval. A schematic illustration of the sparse PBWT is shown in Extended Data Fig. <xref rid="Fig2" ref-type="fig">1</xref> and more details are provided in Supplementary Note <xref rid="MOESM1" ref-type="media">1.2.2.2</xref>.</p>
      <p id="Par17">Haplotype selection is performed by querying target samples in the sparse PBWT, looking at neighboring haplotypes at common variants (at 0.1 cM intervals by default). The selection is complemented with variant sharing at rare variants, as rare-variant sharing is likely to arise from a recent common ancestor.</p>
    </sec>
    <sec id="Sec6">
      <title>Sparse HMM computations</title>
      <p id="Par18">Imputation and phasing are performed using the forward–backward algorithm on the Li and Stephens HMM<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, where reference haplotypes represent the states of the HMM. The computation of posterior probabilities is a computationally intensive task, linear in the number of haplotypes and markers.</p>
      <p id="Par19">The sparse matrix representation of the reference haplotypes in GLIMPSE2 implementation allows to remove the linear component at the marker level during the HMM calculations. GLIMPSE2 selects only <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M2"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="41588_2023_1438_Article_IEq1.gif"/></alternatives></inline-formula> (default <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=2,000$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41588_2023_1438_Article_IEq2.gif"/></alternatives></inline-formula>) haplotypes with the sparse PBWT selection to assemble a custom reference panel in which most of the rare variants present in the original reference panel are monomorphic. In the forward–backward algorithm these monomorphic variants do not contribute to the overall state probability. Therefore, in GLIMPSE2 the forward–backward probabilities are computed only at sites that are polymorphic in the custom reference panel, adjusting the transition probability to consider the physical distance between two consecutive polymorphic sites. Posterior probabilities of variants that are monomorphic in the custom reference panel can be quickly computed using the appropriate emission probability.</p>
      <p id="Par20">Our method takes advantage of low-level programming language (AVX2 intrinsics) to optimize the HMM forward–backward computations at the hardware level, working on blocks of eight floats. This allows the method to be efficient in the core part of the algorithm and therefore use twice the number of states and larger imputation windows compared to the previous version of GLIMPSE. More details are provided in Supplementary Note <xref rid="MOESM1" ref-type="media">1.2.2.3</xref>.</p>
    </sec>
    <sec id="Sec7">
      <title>Evaluation of imputation accuracy</title>
      <p id="Par21">We measured imputation performance as the squared Pearson correlation between high-coverage genomes and imputed dosages. We pooled all validation and imputed dosages belonging to the same frequency bin and computed a single squared Pearson correlation value per bin. Statististics summarizing the number of variants falling in each allele count bin are provided in Supplementary Tables <xref rid="MOESM1" ref-type="media">2</xref>–<xref rid="MOESM1" ref-type="media">4</xref>. We used the GLIMPSE2_concordance tool to measure the squared Pearson correlation by streaming the imputed and validation data to maintain low memory requirements.</p>
      <p id="Par22">We also evaluated the non-reference discordance rate (NRD), defined as the rate between mismatches at the three possible genotypes, divided by the same mismatches plus heterozygous and homozygous alternative matches. We define the non-reference concordance rate as NRC = 1 − NRD. We provide more information about the benchmark and measurement of imputation accuracy in Supplementary Notes <xref rid="MOESM1" ref-type="media">1.3</xref> and <xref rid="MOESM1" ref-type="media">1.3.1</xref>, respectively.</p>
    </sec>
    <sec id="Sec8">
      <title>Evaluation of association tests</title>
      <p id="Par23">We used chromosome 1 data for a subset of 10,000 unrelated UKB individuals of white British ancestry randomly sampled and a total of 99 phenotypes, selected as phenotypes with &lt;10% of missing data in our call set across anthropomorphic traits and blood measurements. We performed association tests using plink2 (ref. <sup><xref ref-type="bibr" rid="CR16">16</xref></sup>) with default parameters and the first ten principal components plus sex and age as covariates to test phenotypes for associations with the seven call sets we generated: high-coverage WGS, five low-coverage WGS (0.1×, 0.25×, 0.5×, 1.0× and 4.0×) and the UKB Axiom array. We selected associations that are genome-wide significant (<italic>P</italic> &lt; 5 × 10<sup>−8</sup>) and independent (being at least 500 kilobases apart). Out of the phenotypes analyzed, a total of 22 showed significant associations on chromosome 1 in the high-coverage dataset. These 22 phenotypes were chosen for comparison across the six imputed call sets.</p>
      <p id="Par24">To assess the accuracy of GWAS performed using imputed call sets, we compared association strength and effect sizes by computing the Pearson correlation between imputed and high-coverage GWAS experiments. We additionally assess the ability of GWAS experiments to distinguish significant from non-significant signals, considering the high-coverage GWAS to be the ground truth. For this, we computed the sensitivity, the proportion of genome-wide significant associations that can be retrieved, and the specificity, the proportion of genome-wide non-significant associations that can be retrieved using imputed call sets.</p>
    </sec>
    <sec id="Sec9">
      <title>Statistics and reproducibility</title>
      <p id="Par25">This study was based on the UKB SNP array and WGS datasets, Simons Genome Diversity Project, 1,000 Genomes Project and the Haplotype Reference Consortium (HRC). Variants and samples selected are based on quality controls and ancestry as described by the respective dataset. For certain analysis samples were extracted randomly from the UKB cohort, according to their ancestry. Statistical analyses, including Wilcoxon tests were performed with R v.4.0. All code to reproduce analyses is publicly available (Code availability section).</p>
    </sec>
    <sec id="Sec10">
      <title>Reporting summary</title>
      <p id="Par26">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="materials|methods">
    <title>Online content</title>
    <p id="Par27">Any methods, additional references, Nature Portfolio reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at 10.1038/s41588-023-01438-3.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <p>
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="41588_2023_1438_MOESM1_ESM.pdf">
          <label>Supplementary Information</label>
          <caption>
            <p>Supplementary Notes 1–7, Figs. 1–12 and Tables 1–8.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="41588_2023_1438_MOESM2_ESM.pdf">
          <caption>
            <p>Reporting Summary</p>
          </caption>
        </media>
      </supplementary-material>
    </p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec12">
        <title>Extended data</title>
        <p id="Par32">
          <fig id="Fig2">
            <label>Extended Data Fig. 1</label>
            <caption>
              <title>Sparse PBWT positional prefix array computation.</title>
              <p><bold>(a)</bold> We consider a reference panel H with M = 6 markers and N = 8 haplotypes, h<sub>0</sub>,h<sub>1</sub>,…, h<sub>7</sub>. Here, marker 1 and marker 6 are common variants (light blue), and markers from 2 to 5 are rare variants (red). <bold>(b)</bold> Full prefix array A of the reference panel. <bold>(c)</bold> Sparse PBWT positional prefix array. At common variants (markers 1 and 6) the standard PBWT update is performed (light blue sites). At rare variants (red sites), no computation is required for the L = 5 haplotypes containing only the major allele in the region (h<sub>0</sub>,h<sub>1</sub>,h<sub>2</sub>,h<sub>5</sub>, h<sub>7</sub>) and they can be copied at the beginning of A<sub>5</sub> in the same relative order as they appear in A<sub>1</sub>. For the haplotypes that contain the minor allele in the region (h<sub>3</sub>,h<sub>4</sub>,h<sub>6</sub>), we compute the positional prefix array A’at the rare variants in the interval. The last positional prefix array (A'<sub>5</sub>) can be directly copied into A<sub>5</sub> from position N-L.</p>
            </caption>
            <graphic position="anchor" xlink:href="41588_2023_1438_Fig2_ESM" id="d32e870"/>
          </fig>
        </p>
        <p id="Par33">
          <fig id="Fig3">
            <label>Extended Data Fig. 2</label>
            <caption>
              <title>Imputation performance of SGDP samples using different reference panels.</title>
              <p><bold>(a-b)</bold> Comparison between KGP and the UKB reference panels to impute 276 SGDP samples across 129 world-wide populations at 1.0x coverage on chromosome 20. (a) Per sample comparison. Each circle represents one sample of SGDP and is colored according to the reduction in NRD achieved when using the UKB reference panel (red) or KGP (blue). Location represents the geographical origin of the sample. (b) Population-level comparison. Samples belonging to the same population (x-axis) have been considered together (number shown in the x-axis label), showing the reduction of NRD between the two panels (y-axis). Populations have been colored and ordered according to the continent and country of origin. Striped bars represent populations where KGP performs better than UKB reference panels.</p>
              <p>
                <xref rid="MOESM4" ref-type="media">Source data</xref>
              </p>
            </caption>
            <graphic position="anchor" xlink:href="41588_2023_1438_Fig3_ESM" id="d32e891"/>
          </fig>
        </p>
        <p id="Par34">
          <fig id="Fig4">
            <label>Extended Data Fig. 3</label>
            <caption>
              <title>Imputation performance of simulated SNP arrays and low-coverage.</title>
              <p>Chromosome 1 imputation accuracy (Aggregate <italic>r</italic><sup>2</sup>, y-axis) for 10,000 British samples of three simulated SNP arrays (Omni 2.5 Array, yellow; GSA array, orange; Axiom Array, red), and sequencing coverages (0.1–4.0x, shades of blue) using the UKB reference panel. The lifted-over (non-simulated) Axiom array data from the UK Biobank is shown in black. We imputed low-coverage data using GLIMPSE2 and SNP array data using BEAGLE v5.4.</p>
              <p>
                <xref rid="MOESM5" ref-type="media">Source data</xref>
              </p>
            </caption>
            <graphic position="anchor" xlink:href="41588_2023_1438_Fig4_ESM" id="d32e915"/>
          </fig>
        </p>
        <p id="Par35">
          <fig id="Fig5">
            <label>Extended Data Fig. 4</label>
            <caption>
              <title>Sensitivity and specificity of genome-wide association using imputed call sets.</title>
              <p><bold>(a-b)</bold> Sensitivity (<bold>a</bold>, y-axis) and specificity (<bold>b</bold>, y-axis) of GWAS by comparing with the validation GWAS across the 22 phenotypes examined. The x-axis shows the imputed call sets (0.1–4.0x, different shades of blue, GLIMPSE2 imputation; UKB Axiom array, red, imputed). Gray dotted lines represent the medians for GWAS using the Axiom array call set. The lower and upper limits of the box plots represent the lower and upper quartiles (Q1 and Q3); the median is marked at the centre of the box. Lower and upper whiskers are defined as Q1 − 1.5 (Q3–Q1) and Q3 + 1.5 (Q3–Q1), respectively.</p>
              <p>
                <xref rid="MOESM6" ref-type="media">Source data</xref>
              </p>
            </caption>
            <graphic position="anchor" xlink:href="41588_2023_1438_Fig5_ESM" id="d32e942"/>
          </fig>
        </p>
        <p id="Par36">
          <fig id="Fig6">
            <label>Extended Data Fig. 5</label>
            <caption>
              <title>Performance at genomic annotations compared to high-coverage data.</title>
              <p><bold>(a-b)</bold> Imputation performance of 10,000 British samples imputed using the UKB reference panel across coverages (0.1–4.0x, different shades of blue, GLIMPSE2 imputation) and the UKB Axiom array data (red). (a) Imputation accuracy at INDEL sites. (b) Gene-level imputation accuracy (Pearson <italic>r</italic><sup>2</sup>, y-axis) at rare Genebass functionally annotated variants (LoF, loss of function; missense, synonymous variants; MAC &lt; 200). Each data point represents a gene with at least one genetic variant across the 10,000 samples (defined <italic>r</italic><sup>2</sup> measure, N = 11185 Lof genes, N = 17003 missense genes, N = 17830 synonymous genes). P values between the imputed Axiom array and 1.0x data were computed with the two-sided Wilcoxon non-parametric rank sum test (LoF p-value = 1.9 × 10<sup>−37</sup>; Missense p-value &lt; 5 × 10<sup>−324</sup>; Synonymous p-value &lt; 5 × 10<sup>−324</sup>). The lower and upper limits of the box plots represent the first and third quartiles (Q1 and Q3); the median is marked at the centre of the box. Lower and upper whiskers are defined as Q1 − 1.5 (Q3–Q1) and Q3 + 1.5 (Q3–Q1), respectively.</p>
              <p>
                <xref rid="MOESM7" ref-type="media">Source data</xref>
              </p>
            </caption>
            <graphic position="anchor" xlink:href="41588_2023_1438_Fig6_ESM" id="d32e983"/>
          </fig>
        </p>
      </sec>
      <sec id="Sec14">
        <title>Source data</title>
        <p id="Par38">
          <media position="anchor" xlink:href="41588_2023_1438_MOESM3_ESM.xlsx" id="MOESM3">
            <label>Source Data Fig. 1</label>
            <caption>
              <p>Statistical source data.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="41588_2023_1438_MOESM4_ESM.xlsx" id="MOESM4">
            <label>Source Data Extended Data Fig. 2</label>
            <caption>
              <p>Statistical source data.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="41588_2023_1438_MOESM5_ESM.xlsx" id="MOESM5">
            <label>Source Data Extended Data Fig. 3</label>
            <caption>
              <p>Statistical source data.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="41588_2023_1438_MOESM6_ESM.xlsx" id="MOESM6">
            <label>Source Data Extended Data Fig. 4</label>
            <caption>
              <p>Statistical source data.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="41588_2023_1438_MOESM7_ESM.xlsx" id="MOESM7">
            <label>Source Data Extended Data Fig. 5</label>
            <caption>
              <p>Statistical source data.</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <sec id="FPar1">
      <title>Extended data</title>
      <p id="Par28">is available for this paper at 10.1038/s41588-023-01438-3.</p>
    </sec>
    <sec id="FPar2" sec-type="supplementary-material">
      <title>Supplementary information</title>
      <p id="Par29">The online version contains supplementary material available at 10.1038/s41588-023-01438-3.</p>
    </sec>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was funded by a Swiss National Science Foundation project grant 373 (PP00P3_176977) and conducted under UKB project 66995. The funders had no role in study design, data collection and analysis, decision to publish or preparation of the manuscript. We thank the participants of the UKB. The sequencing of 150,119 UKB samples used in this study has been funded by the UKB WGS consortium. DNA sequencing was performed at the Welcome Trust Sanger Institute and deCODE genetics. The New York Genome Center 1000 Genomes data were generated at the New York Genome Center with funds provided by a National Human Genome Research Institute grant no. 3UM1HG008901–03S1.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>S.R. and O.D. designed the study. S.R. and O.D. developed the algorithms and wrote the software. R.J.H. performed the GWAS experiments. S.R. and B.S.M. performed imputation of ancient samples. B.S.M. provided interpretation regarding imputed ancient samples. S.R. performed the remaining experiments. O.D. supervised the project. All authors reviewed the final paper.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar3">
      <title>Peer review information</title>
      <p id="Par30"><italic>Nature Genetics</italic> thanks Arnaldur Gylfason, Tobias Marschall and the other, anonymous, reviewer(s) for their contribution to the peer review of this work.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The 1,000 Genomes Project phase 3 dataset sequenced at high coverage by the New York Genome Center is available on the European Nucleotide Archive under accession no. <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena/data/view/PRJEB31736">PRJEB31736</ext-link>, the International Genome Sample Resource (IGSR) data portal and the University of Michigan school of public health ftp site (<ext-link ext-link-type="uri" xlink:href="ftp://share.sph.umich.edu/1000g-high-coverage/freeze9/phased/">ftp://share.sph.umich.edu/1000g-high-coverage/freeze9/phased/</ext-link>). The publicly available subset of the HRC dataset is available from the European Genome-phenome Archive at the European Bioinformatics Institute under accession no. <ext-link ext-link-type="uri" xlink:href="https://ega-archive.org/studies/EGAS00001001710">EGAS00001001710</ext-link>. The publicly available Simons Genome Diversity project is available on the IGSR data portal and Cancer Genomics Cloud, powered by Seven Bridges. The UKB WGS data and phenotypes can be accessed via RAP: <ext-link ext-link-type="uri" xlink:href="https://ukbiobank.dnanexus.com/landing">https://ukbiobank.dnanexus.com/landing</ext-link>. The phased WGS reference panel can be accessed via RAP: <ext-link ext-link-type="uri" xlink:href="https://ukbiobank.dnanexus.com/landing">https://ukbiobank.dnanexus.com/landing</ext-link>. <xref rid="Sec14" ref-type="sec">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>GLIMPSE2 source code is available with MIT licence from <ext-link ext-link-type="uri" xlink:href="https://github.com/odelaneau/GLIMPSE">https://github.com/odelaneau/GLIMPSE</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://odelaneau.github.io/GLIMPSE/">https://odelaneau.github.io/GLIMPSE/</ext-link>. This includes code to the chunk, split_reference, phase, ligate and concordance. The documentation is available at <ext-link ext-link-type="uri" xlink:href="https://odelaneau.github.io/GLIMPSE/">https://odelaneau.github.io/GLIMPSE/</ext-link>. Code and source data to reproduce analysis and figures have been deposited in a Zenodo repository<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>.</p>
  </notes>
  <notes id="FPar4" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par31">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubinacci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ribeiro</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hofmeister</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Delaneau</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Efficient phasing and imputation of low-coverage sequencing data using large reference panels</article-title>
        <source>Nat. Genet.</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>120</fpage>
        <lpage>126</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-020-00756-0</pub-id>
        <?supplied-pmid 33414550?>
        <pub-id pub-id-type="pmid">33414550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davies</surname>
            <given-names>RW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid genotype imputation from sequence with reference panels</article-title>
        <source>Nat. Genet.</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>1104</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00877-0</pub-id>
        <?supplied-pmid 34083788?>
        <pub-id pub-id-type="pmid">34083788</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>AR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Low-coverage sequencing cost-effectively detects known and novel variation in underrepresented populations</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2021</year>
        <volume>108</volume>
        <fpage>656</fpage>
        <lpage>668</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2021.03.012</pub-id>
        <?supplied-pmid 33770507?>
        <pub-id pub-id-type="pmid">33770507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Mazur</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Berisa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pickrell</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Low-pass sequencing increases the power of GWAS and decreases measurement error of polygenic risk scores compared to genotyping arrays</article-title>
        <source>Genome Res.</source>
        <year>2021</year>
        <volume>31</volume>
        <fpage>529</fpage>
        <lpage>537</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.266486.120</pub-id>
        <?supplied-pmid 33536225?>
        <pub-id pub-id-type="pmid">33536225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halldorsson</surname>
            <given-names>BV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequences of 150,119 genomes in the UK Biobank</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>607</volume>
        <fpage>732</fpage>
        <lpage>740</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-04965-x</pub-id>
        <?supplied-pmid 35859178?>
        <pub-id pub-id-type="pmid">35859178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bycroft</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <fpage>203</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0579-z</pub-id>
        <?supplied-pmid 30305743?>
        <pub-id pub-id-type="pmid">30305743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Hofmeister, R. J., Ribeiro, D. M., Rubinacci, S. &amp; Delaneau, O. Accurate rare variant phasing of whole-genome and whole-exome sequencing data in the UK Biobank. <italic>Nat. Genet.</italic>10.1038/s41588-023-01415-w (2023).</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A one-penny imputed genome from next-generation reference panels</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2018</year>
        <volume>103</volume>
        <fpage>338</fpage>
        <lpage>348</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2018.07.015</pub-id>
        <?supplied-pmid 30100085?>
        <pub-id pub-id-type="pmid">30100085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubinacci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Delaneau</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Genotype imputation using the positional Burrows Wheeler transform</article-title>
        <source>PLoS Genet.</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>e1009049</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1009049</pub-id>
        <?supplied-pmid 33196638?>
        <pub-id pub-id-type="pmid">33196638</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karczewski</surname>
            <given-names>KJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic single-variant and gene-based association testing of thousands of phenotypes in 394,841 UK Biobank exomes</article-title>
        <source>Cell Genomics</source>
        <year>2022</year>
        <volume>2</volume>
        <fpage>100168</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100168</pub-id>
        <?supplied-pmid 36778668?>
        <pub-id pub-id-type="pmid">36778668</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taliun</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequencing of 53,831 diverse genomes from the NHLBI TOPMed Program</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>590</volume>
        <fpage>290</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03205-y</pub-id>
        <?supplied-pmid 33568819?>
        <pub-id pub-id-type="pmid">33568819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karczewski</surname>
            <given-names>KJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The mutational constraint spectrum quantified from variation in 141,456 humans</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>581</volume>
        <fpage>434</fpage>
        <lpage>443</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2308-7</pub-id>
        <?supplied-pmid 32461654?>
        <pub-id pub-id-type="pmid">32461654</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">The All of Us Research Program Investigators. The ‘All of Us’ research program. <italic>N. Engl. J. Med</italic>. <bold>381</bold>, 668–676 (2019).</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Modeling linkage disequilibrium and identifying recombination hotspots using single-nucleotide polymorphism data</article-title>
        <source>Genetics</source>
        <year>2003</year>
        <volume>165</volume>
        <fpage>2213</fpage>
        <lpage>2233</lpage>
        <pub-id pub-id-type="doi">10.1093/genetics/165.4.2213</pub-id>
        <?supplied-pmid 14704198?>
        <pub-id pub-id-type="pmid">14704198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Efficient haplotype matching and storage using the positional Burrows–Wheeler transform (PBWT)</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1266</fpage>
        <lpage>1272</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu014</pub-id>
        <?supplied-pmid 24413527?>
        <pub-id pub-id-type="pmid">24413527</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>CC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>
        <source>Gigascience</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/s13742-015-0047-8</pub-id>
        <?supplied-pmid 25722852?>
        <pub-id pub-id-type="pmid">25722852</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Rubinacci, S., Hofmeister, R. J., Sousa da Mota, B. &amp; Delaneau, O. Source data, scripts and code for the manuscript ‘Imputation of low-coverage sequencing data from 150,119 UK Biobank genomes’. <italic>Zenodo</italic>10.5281/ZENODO.7860468 (2023).</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Genet</journal-id>
    <journal-title-group>
      <journal-title>Nature Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1061-4036</issn>
    <issn pub-type="epub">1546-1718</issn>
    <publisher>
      <publisher-name>Nature Publishing Group US</publisher-name>
      <publisher-loc>New York</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10335927</article-id>
    <article-id pub-id-type="pmid">37386250</article-id>
    <article-id pub-id-type="publisher-id">1438</article-id>
    <article-id pub-id-type="doi">10.1038/s41588-023-01438-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Brief Communication</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Imputation of low-coverage sequencing data from 150,119 UK Biobank genomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7725-4813</contrib-id>
        <name>
          <surname>Rubinacci</surname>
          <given-names>Simone</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9965-595X</contrib-id>
        <name>
          <surname>Hofmeister</surname>
          <given-names>Robin J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sousa da Mota</surname>
          <given-names>Bárbara</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3906-8446</contrib-id>
        <name>
          <surname>Delaneau</surname>
          <given-names>Olivier</given-names>
        </name>
        <address>
          <email>olivier.delaneau@unil.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.9851.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 2165 4204</institution-id><institution>Department of Computational Biology, </institution><institution>University of Lausanne, </institution></institution-wrap>Lausanne, Switzerland </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.419765.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2223 3006</institution-id><institution>Swiss Institute of Bioinformatics, </institution></institution-wrap>Lausanne, Switzerland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2023</year>
    </pub-date>
    <volume>55</volume>
    <issue>7</issue>
    <fpage>1088</fpage>
    <lpage>1090</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The release of 150,119 UK Biobank sequences represents an unprecedented opportunity as a reference panel to impute low-coverage whole-genome sequencing data with high accuracy but current methods cannot cope with the size of the data. Here we introduce GLIMPSE2, a low-coverage whole-genome sequencing imputation method that scales sublinearly in both the number of samples and markers, achieving efficient whole-genome imputation from the UK Biobank reference panel while retaining high accuracy for ancient and modern genomes, particularly at rare variants and for very low-coverage samples.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">GLIMPSE2 is an improved method using sparse models for accurate, efficient and cost-effective genotype imputation in low-coverage whole-genome sequencing data.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>DNA sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001711</institution-id>
            <institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung (Swiss National Science Foundation)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PP00P3_176977</award-id>
        <principal-award-recipient>
          <name>
            <surname>Delaneau</surname>
            <given-names>Olivier</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature America, Inc. 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Main</title>
    <p id="Par3">Recent work and method advances<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref></sup> highlight the advantages of low-coverage whole-genome sequencing (lcWGS), followed by genotype imputation from a large reference panel, as a cost-effective genotyping technology for statistical and population genetics. Large-scale whole-genome sequencing projects, such as the recent release of 150,119 samples from the UK Biobank<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> (UKB), offer new opportunities to improve lcWGS imputation, potentially improving accuracy at rare variants (minor allele frequency (MAF) &lt; 0.1%). However, current methods struggle to scale to the size of this new generation of reference panels resulting in prohibitive computational costs. To address this issue, we propose GLIMPSE v.2 (GLIMPSE2), a major improvement of GLIMPSE<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, that scales to a reference panel containing millions of reference haplotypes, with high imputation accuracy at rare variants (MAF &lt; 0.1%) and for very low-coverage samples (0.1× to 0.5×).</p>
    <p id="Par4">To demonstrate the benefits of using sequenced biobanks for lcWGS imputation, we phased the recent release of the UKB WGS data<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR6">6</xref></sup> using SHAPEIT5 (ref. <sup><xref ref-type="bibr" rid="CR7">7</xref></sup>) and created a UKB reference panel of 280,238 haplotypes and 582,534,516 markers (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>). We used the UKB panel to impute lcWGS samples with GLIMPSE2 and other recently released imputation methods: GLIMPSE1 (ref. <sup><xref ref-type="bibr" rid="CR1">1</xref></sup>) and QUILT v1.0.4 (ref. <sup><xref ref-type="bibr" rid="CR2">2</xref></sup>). Compared to other reference panels, the UKB leads to considerable accuracy improvements for British samples across all tested depths of coverage. Furthermore, GLIMPSE2 outperforms GLIMPSE1, particularly at rare variants (MAF &lt; 0.1%) and for very low-coverage (for 0.1× and 1.0× data at 0.01% MAF, GLIMPSE1 and GLIMPSE2 obtain an <italic>r</italic><sup>2</sup> of 0.561 and 0.892 compared to 0.725 and 0.927, respectively) and matches QUILT v.1.0.4 accuracy, designed to condition on the full set of reference haplotypes (for 0.1× and 1.0× data at 0.01% MAF, QUILT v.1.0.4 obtained an <italic>r</italic><sup>2</sup> of 0.728 and 0.925, respectively; Fig. <xref rid="Fig1" ref-type="fig">1a</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>, Supplementary Figs. <xref rid="MOESM1" ref-type="media">1</xref>–<xref rid="MOESM1" ref-type="media">3</xref> and Supplementary Tables <xref rid="MOESM1" ref-type="media">2</xref>–<xref rid="MOESM1" ref-type="media">4</xref>). We also find that the accuracy of GLIMPSE2 and QUILT v.1.0.4 methods is similar when imputing 42 non-European samples from 1,000 Genomes Project using the UKB reference panel (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><title>Accuracy, running time and power of low-coverage imputation using the UKB WGS data.</title><p><bold>a</bold>,<bold>b</bold>, Imputation performance of different imputation methods: QUILT v.1.0.4 (black), GLIMPSE1 (gray) and GLIMPSE2 (blue); across the 1,000 Genomes Project (KGP), HRC and UKB reference panels, for 100 UKB British samples at 1.0× coverage. <bold>a</bold>, Accuracy on chromosome 20 (Pearson <italic>r</italic><sup>2</sup>, <italic>y</italic> axis), of imputation methods and reference panels: KGP (dotted line), HRC (dashed line) and UKB (full line). Accuracy is plotted against MAF of the appropriate reference panel (<italic>x</italic> axis, log scale). <bold>b</bold>, Cost per sample on the RAP for whole-genome imputation (<italic>y</italic> axis, log scale) across different reference panels (<italic>x</italic> axis). <bold>c</bold>,<bold>d</bold>, Performance of imputed data using the UKB reference panel across coverages (0.1–4.0×, different shades of blue, GLIMPSE2 imputation) and Axiom array data (red). <bold>c</bold>, Accuracy on chromosome 1 of 10,000 UKB British samples (Pearson <italic>r</italic><sup>2</sup>, <italic>y</italic> axis) against MAF of the appropriate reference panel (<italic>x</italic> axis, log scale). <bold>d</bold>, Power in association testing of 10,000 UKB British samples compared to high-coverage data. Correlation of betas and <italic>P</italic> values (Pearson <italic>r</italic><sup>2</sup>, <italic>y</italic> axis) of different imputed datasets (<italic>x</italic> axis) across 22 UKB phenotypes. Lower and upper limits of the box plots represent the first and third quartiles (Q1 and Q3); the median is marked at the center of the box. Lower and upper whiskers are defined as Q1 − 1.5 (Q3–Q1) and Q3 + 1.5 (Q3–Q1), respectively.</p><p><xref rid="MOESM3" ref-type="media">Source data</xref></p></caption><graphic xlink:href="41588_2023_1438_Fig1_HTML" id="d32e424"/></fig></p>
    <p id="Par5">We further investigate the effect of the reference panel by imputing individuals of 129 human populations from the Simons Genome Diversity Project and we show that the UKB panel drastically improves imputation accuracy of European samples compared to the 1,000 Genomes Project reference panel, in particular of Northern Europe origin, for which the UKB reference panel obtains a reduction of non-reference discordance rate &gt;67% (Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>, Extended Data Fig. <xref rid="Fig3" ref-type="fig">2</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>). Additionally, we imputed three ancient Europeans and a Yamnaya sample for which high-coverage data (&gt;18×) are available and find similar improvements (Supplementary Note <xref rid="MOESM1" ref-type="media">4</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>), showing that some ancient populations, such as Viking, Western Hunter-Gatherer and Yamnaya could be well imputed from the UKB reference panel.</p>
    <p id="Par6">The imputation of a single lcWGS genome using the UKB reference panel is expensive or prohibitive using existing methods. On the UKB research analysis platform (RAP), the cost is £1.11 and £242.80 for GLIMPSE1 and QUILT v.1.0.4, respectively. In contrast, the same task performed with GLIMPSE2 only costs £0.08, due to major algorithmic improvements that drastically reduce the imputation time for rare variants (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">5</xref> and <xref rid="MOESM1" ref-type="media">6</xref>). We confirm this trend for up to 2 million reference haplotypes, using simulated data (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>). These improvements in imputation running time and memory requirements are crucial to keep lcWGS close to single nucleotide polymorphism (SNP) arrays in terms of computational costs<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">5</xref>) while maintaining the major advantage of providing better genotype calls. Indeed, we find that imputation of 0.5× data yields similar or more accurate results compared to the UKB Axiom array, with a notable difference at rare variants (for 0.5× coverage, accuracy improvement of <italic>r</italic><sup>2</sup> &gt; 0.1 for variants with a MAF &lt; 0.01%, Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). Using simulated SNP arrays, we further confirm that 0.5× yields at least the same imputation accuracy as the densest SNP array model tested (Omni 2.5 array; Extended Data Fig. <xref rid="Fig4" ref-type="fig">3</xref>).</p>
    <p id="Par7">To assess the impact of these improvements on genome-wide association studies (GWAS), we imputed 10,000 UKB samples that we used to test 22 quantitative traits for association, comparing the respective abilities of lcWGS and SNP array data to recover the signals found with high-coverage sequencing data (Supplementary Note <xref rid="MOESM1" ref-type="media">6</xref>). We find that 0.5× leads to <italic>P</italic> values and effect size estimates as accurate as those obtained from Axiom array data (Fig. <xref rid="Fig1" ref-type="fig">1d</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">10</xref>–<xref rid="MOESM1" ref-type="media">12</xref>) while delimiting regions of association with matching sensitivity and specificity (Supplementary Note <xref rid="MOESM1" ref-type="media">6</xref> and Extended Data Fig. <xref rid="Fig5" ref-type="fig">4</xref>). We also look at rare loss-of-function, missense and synonymous variants<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> and show that 1.0× outperforms the Axiom array for all categories of variants, an improvement that will be reflected in downstream burden-test analysis (Supplementary Note <xref rid="MOESM1" ref-type="media">7</xref> and Extended Data Fig. <xref rid="Fig6" ref-type="fig">5</xref>). Altogether, this shows that lcWGS constitutes a powerful alternative to SNP array for downstream GWAS and rare-variant analysis.</p>
    <p id="Par8">In this work, we introduce several improvements to the GLIMPSE method that solve the computational problem of imputing lcWGS data from the 150,119 WGS samples in the UKB. We demonstrate that this reference panel leads to striking accuracy improvements across several sample ancestries, allele frequencies and depths of coverages. Our study further confirms the advantage of lcWGS over SNP arrays for GWAS, by showing that using imputed data with coverage as low as 0.5× are enough to outperform SNP array data, particularly at rare variants. Our work can be applied to other sequenced and diverse biobanks, such as Trans-Omics for Precision Medicine<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, gnomAD<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> or AllofUs<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, thereby facilitating lcWGS imputation of non-European individuals. We believe that the difference between low-coverage and high-coverage WGS will become increasingly smaller as large reference panels will keep collecting more human haplotype diversity.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par9">This study relies on analyses of genetic data from the UKB cohort, which was collected with informed consent obtained from all participants. Data for this study were obtained under the UKB applications licence number 66995 and are available to registered researchers through the UKB data-access protocol. Additional data used in this study are all publicly available.</p>
    <sec id="Sec3">
      <title>GLIMPSE2</title>
      <p id="Par10">To perform imputation of low-coverage WGS data, GLIMPSE2 uses a Gibbs sampler algorithm that alternates between haploid imputation and phasing, using a modified version of the Li and Stephens hidden Markov model (HMM)<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. The method necessitates a genotype likelihoods matrix for the target samples and a reference panel of haplotypes as input. The initialization step begins with the selection of a set of haplotypes from the reference panel via rare-variant calls derived from the low-coverage genotype likelihoods. Following that, two consecutive steps of haploid imputation are executed, one for each of the two target haplotypes. At the end of the initialization step, a diplotype is assigned to each target sample. GLIMPSE2 subsequently runs a series of burn-in and main Gibbs iterations to refine the genotype calls and phasing of each target sample. The algorithm determines haploid likelihoods for one of the two target haplotypes, based on the original genotype likelihoods and conditional on the current estimate of the other haplotype. To integrate over phasing uncertainty, the approach averages imputation posteriors across all main iterations.</p>
      <p id="Par11">Conversely from the GLIMPSE1 method, GLIMPSE2 approach is primarily focused on imputation only from the reference panel and it optimizes this task by incorporating new features. First, the reference panel is represented sparsely in memory, allowing for efficient storage of dense cohorts. The sparse representation of the reference panel facilitates the introduction of a new data structure to hasten haplotype matching and an efficient implementation of the HMM, which calculates posterior probabilities by leveraging the sparsity of the panel. Additional features of GLIMPSE2 include a genotype caller that integrates genotype likelihood computations directly into the GLIMPSE software and imputation of small insertions and deletions and low-quality variants separately from SNPs, by performing imputation into a haplotype scaffold obtained from high-quality SNPs.</p>
      <p id="Par12">The subsequent sections will provide a more comprehensive explanation of three of the previously referenced features, which are critical for the ability of the model to scale when applied to deeply sequenced reference panels. Further details regarding the method can be found in Supplementary Note <xref rid="MOESM1" ref-type="media">1.2.2</xref>.</p>
    </sec>
    <sec id="Sec4">
      <title>Sparse reference panel representation</title>
      <p id="Par13">GLIMPSE2 represents the reference panel as a sparse matrix, encoding haplotypes with one bit per allele if the variant is defined as common (MAF ≥ 0.001 by default) and storing the indices of the haplotypes that carry the minor allele, otherwise. This data representation allows for small memory usage but also for a fast identification of the haplotypes carrying a rare variant. Additionally, the transpose of the data structures gives efficient access to the rare variants of each haplotype. More details can be found in Supplementary Note <xref rid="MOESM1" ref-type="media">1.2.2.1</xref>.</p>
      <p id="Par14">We encoded the sparse reference panel representation in a binary file format to be efficiently stored on the disk. The file format translates directly into the memory data structures used by GLIMPSE2 and does not require any general-purpose compression algorithm. Together with the reference file format, we store the run-length encoded sparse positional Burrows–Wheeler transform (PBWT) data structure in the same file file, together with the recombination map. As a result, all the data related to the reference panel can be quickly loaded in memory, in much faster running times than standard file formats, such as VCF and BCF.</p>
    </sec>
    <sec id="Sec5">
      <title>Sparse positional Burrows–Wheeler transform matching</title>
      <p id="Par15">One of the key components of the GLIMPSE1 model is to reduce the state space using PBWT<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, a data structure that allows efficient query searches in haplotype cohorts, linear in the number of samples and markers. Similarly, GLIMPSE2 extends the PBWT and proposes an algorithm designed for large sequencing cohorts, here called sparse PBWT.</p>
      <p id="Par16">By using the sparse representation of the reference panel, rare variants are treated differently than common variants, allowing the computation of smaller PBWTs which speeds up the algorithm. This is based on the idea that between two adjacent common variants most of the haplotypes do not contain the minor allele in the region and therefore most of the haplotypes would form a single invariable block of major alleles that preserves their relative haplotype order. Therefore, a smaller PBWT is constructed only on haplotypes that have at least one minor allele between two adjacent common variants. The positional prefix array of the small PBWT at the end of the rare-variant interval is simply concatenated with the positional prefix array of other haplotypes that are not changing in the interval. A schematic illustration of the sparse PBWT is shown in Extended Data Fig. <xref rid="Fig2" ref-type="fig">1</xref> and more details are provided in Supplementary Note <xref rid="MOESM1" ref-type="media">1.2.2.2</xref>.</p>
      <p id="Par17">Haplotype selection is performed by querying target samples in the sparse PBWT, looking at neighboring haplotypes at common variants (at 0.1 cM intervals by default). The selection is complemented with variant sharing at rare variants, as rare-variant sharing is likely to arise from a recent common ancestor.</p>
    </sec>
    <sec id="Sec6">
      <title>Sparse HMM computations</title>
      <p id="Par18">Imputation and phasing are performed using the forward–backward algorithm on the Li and Stephens HMM<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, where reference haplotypes represent the states of the HMM. The computation of posterior probabilities is a computationally intensive task, linear in the number of haplotypes and markers.</p>
      <p id="Par19">The sparse matrix representation of the reference haplotypes in GLIMPSE2 implementation allows to remove the linear component at the marker level during the HMM calculations. GLIMPSE2 selects only <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M2"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="41588_2023_1438_Article_IEq1.gif"/></alternatives></inline-formula> (default <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=2,000$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41588_2023_1438_Article_IEq2.gif"/></alternatives></inline-formula>) haplotypes with the sparse PBWT selection to assemble a custom reference panel in which most of the rare variants present in the original reference panel are monomorphic. In the forward–backward algorithm these monomorphic variants do not contribute to the overall state probability. Therefore, in GLIMPSE2 the forward–backward probabilities are computed only at sites that are polymorphic in the custom reference panel, adjusting the transition probability to consider the physical distance between two consecutive polymorphic sites. Posterior probabilities of variants that are monomorphic in the custom reference panel can be quickly computed using the appropriate emission probability.</p>
      <p id="Par20">Our method takes advantage of low-level programming language (AVX2 intrinsics) to optimize the HMM forward–backward computations at the hardware level, working on blocks of eight floats. This allows the method to be efficient in the core part of the algorithm and therefore use twice the number of states and larger imputation windows compared to the previous version of GLIMPSE. More details are provided in Supplementary Note <xref rid="MOESM1" ref-type="media">1.2.2.3</xref>.</p>
    </sec>
    <sec id="Sec7">
      <title>Evaluation of imputation accuracy</title>
      <p id="Par21">We measured imputation performance as the squared Pearson correlation between high-coverage genomes and imputed dosages. We pooled all validation and imputed dosages belonging to the same frequency bin and computed a single squared Pearson correlation value per bin. Statististics summarizing the number of variants falling in each allele count bin are provided in Supplementary Tables <xref rid="MOESM1" ref-type="media">2</xref>–<xref rid="MOESM1" ref-type="media">4</xref>. We used the GLIMPSE2_concordance tool to measure the squared Pearson correlation by streaming the imputed and validation data to maintain low memory requirements.</p>
      <p id="Par22">We also evaluated the non-reference discordance rate (NRD), defined as the rate between mismatches at the three possible genotypes, divided by the same mismatches plus heterozygous and homozygous alternative matches. We define the non-reference concordance rate as NRC = 1 − NRD. We provide more information about the benchmark and measurement of imputation accuracy in Supplementary Notes <xref rid="MOESM1" ref-type="media">1.3</xref> and <xref rid="MOESM1" ref-type="media">1.3.1</xref>, respectively.</p>
    </sec>
    <sec id="Sec8">
      <title>Evaluation of association tests</title>
      <p id="Par23">We used chromosome 1 data for a subset of 10,000 unrelated UKB individuals of white British ancestry randomly sampled and a total of 99 phenotypes, selected as phenotypes with &lt;10% of missing data in our call set across anthropomorphic traits and blood measurements. We performed association tests using plink2 (ref. <sup><xref ref-type="bibr" rid="CR16">16</xref></sup>) with default parameters and the first ten principal components plus sex and age as covariates to test phenotypes for associations with the seven call sets we generated: high-coverage WGS, five low-coverage WGS (0.1×, 0.25×, 0.5×, 1.0× and 4.0×) and the UKB Axiom array. We selected associations that are genome-wide significant (<italic>P</italic> &lt; 5 × 10<sup>−8</sup>) and independent (being at least 500 kilobases apart). Out of the phenotypes analyzed, a total of 22 showed significant associations on chromosome 1 in the high-coverage dataset. These 22 phenotypes were chosen for comparison across the six imputed call sets.</p>
      <p id="Par24">To assess the accuracy of GWAS performed using imputed call sets, we compared association strength and effect sizes by computing the Pearson correlation between imputed and high-coverage GWAS experiments. We additionally assess the ability of GWAS experiments to distinguish significant from non-significant signals, considering the high-coverage GWAS to be the ground truth. For this, we computed the sensitivity, the proportion of genome-wide significant associations that can be retrieved, and the specificity, the proportion of genome-wide non-significant associations that can be retrieved using imputed call sets.</p>
    </sec>
    <sec id="Sec9">
      <title>Statistics and reproducibility</title>
      <p id="Par25">This study was based on the UKB SNP array and WGS datasets, Simons Genome Diversity Project, 1,000 Genomes Project and the Haplotype Reference Consortium (HRC). Variants and samples selected are based on quality controls and ancestry as described by the respective dataset. For certain analysis samples were extracted randomly from the UKB cohort, according to their ancestry. Statistical analyses, including Wilcoxon tests were performed with R v.4.0. All code to reproduce analyses is publicly available (Code availability section).</p>
    </sec>
    <sec id="Sec10">
      <title>Reporting summary</title>
      <p id="Par26">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="materials|methods">
    <title>Online content</title>
    <p id="Par27">Any methods, additional references, Nature Portfolio reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at 10.1038/s41588-023-01438-3.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <p>
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="41588_2023_1438_MOESM1_ESM.pdf">
          <label>Supplementary Information</label>
          <caption>
            <p>Supplementary Notes 1–7, Figs. 1–12 and Tables 1–8.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="41588_2023_1438_MOESM2_ESM.pdf">
          <caption>
            <p>Reporting Summary</p>
          </caption>
        </media>
      </supplementary-material>
    </p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec12">
        <title>Extended data</title>
        <p id="Par32">
          <fig id="Fig2">
            <label>Extended Data Fig. 1</label>
            <caption>
              <title>Sparse PBWT positional prefix array computation.</title>
              <p><bold>(a)</bold> We consider a reference panel H with M = 6 markers and N = 8 haplotypes, h<sub>0</sub>,h<sub>1</sub>,…, h<sub>7</sub>. Here, marker 1 and marker 6 are common variants (light blue), and markers from 2 to 5 are rare variants (red). <bold>(b)</bold> Full prefix array A of the reference panel. <bold>(c)</bold> Sparse PBWT positional prefix array. At common variants (markers 1 and 6) the standard PBWT update is performed (light blue sites). At rare variants (red sites), no computation is required for the L = 5 haplotypes containing only the major allele in the region (h<sub>0</sub>,h<sub>1</sub>,h<sub>2</sub>,h<sub>5</sub>, h<sub>7</sub>) and they can be copied at the beginning of A<sub>5</sub> in the same relative order as they appear in A<sub>1</sub>. For the haplotypes that contain the minor allele in the region (h<sub>3</sub>,h<sub>4</sub>,h<sub>6</sub>), we compute the positional prefix array A’at the rare variants in the interval. The last positional prefix array (A'<sub>5</sub>) can be directly copied into A<sub>5</sub> from position N-L.</p>
            </caption>
            <graphic position="anchor" xlink:href="41588_2023_1438_Fig2_ESM" id="d32e870"/>
          </fig>
        </p>
        <p id="Par33">
          <fig id="Fig3">
            <label>Extended Data Fig. 2</label>
            <caption>
              <title>Imputation performance of SGDP samples using different reference panels.</title>
              <p><bold>(a-b)</bold> Comparison between KGP and the UKB reference panels to impute 276 SGDP samples across 129 world-wide populations at 1.0x coverage on chromosome 20. (a) Per sample comparison. Each circle represents one sample of SGDP and is colored according to the reduction in NRD achieved when using the UKB reference panel (red) or KGP (blue). Location represents the geographical origin of the sample. (b) Population-level comparison. Samples belonging to the same population (x-axis) have been considered together (number shown in the x-axis label), showing the reduction of NRD between the two panels (y-axis). Populations have been colored and ordered according to the continent and country of origin. Striped bars represent populations where KGP performs better than UKB reference panels.</p>
              <p>
                <xref rid="MOESM4" ref-type="media">Source data</xref>
              </p>
            </caption>
            <graphic position="anchor" xlink:href="41588_2023_1438_Fig3_ESM" id="d32e891"/>
          </fig>
        </p>
        <p id="Par34">
          <fig id="Fig4">
            <label>Extended Data Fig. 3</label>
            <caption>
              <title>Imputation performance of simulated SNP arrays and low-coverage.</title>
              <p>Chromosome 1 imputation accuracy (Aggregate <italic>r</italic><sup>2</sup>, y-axis) for 10,000 British samples of three simulated SNP arrays (Omni 2.5 Array, yellow; GSA array, orange; Axiom Array, red), and sequencing coverages (0.1–4.0x, shades of blue) using the UKB reference panel. The lifted-over (non-simulated) Axiom array data from the UK Biobank is shown in black. We imputed low-coverage data using GLIMPSE2 and SNP array data using BEAGLE v5.4.</p>
              <p>
                <xref rid="MOESM5" ref-type="media">Source data</xref>
              </p>
            </caption>
            <graphic position="anchor" xlink:href="41588_2023_1438_Fig4_ESM" id="d32e915"/>
          </fig>
        </p>
        <p id="Par35">
          <fig id="Fig5">
            <label>Extended Data Fig. 4</label>
            <caption>
              <title>Sensitivity and specificity of genome-wide association using imputed call sets.</title>
              <p><bold>(a-b)</bold> Sensitivity (<bold>a</bold>, y-axis) and specificity (<bold>b</bold>, y-axis) of GWAS by comparing with the validation GWAS across the 22 phenotypes examined. The x-axis shows the imputed call sets (0.1–4.0x, different shades of blue, GLIMPSE2 imputation; UKB Axiom array, red, imputed). Gray dotted lines represent the medians for GWAS using the Axiom array call set. The lower and upper limits of the box plots represent the lower and upper quartiles (Q1 and Q3); the median is marked at the centre of the box. Lower and upper whiskers are defined as Q1 − 1.5 (Q3–Q1) and Q3 + 1.5 (Q3–Q1), respectively.</p>
              <p>
                <xref rid="MOESM6" ref-type="media">Source data</xref>
              </p>
            </caption>
            <graphic position="anchor" xlink:href="41588_2023_1438_Fig5_ESM" id="d32e942"/>
          </fig>
        </p>
        <p id="Par36">
          <fig id="Fig6">
            <label>Extended Data Fig. 5</label>
            <caption>
              <title>Performance at genomic annotations compared to high-coverage data.</title>
              <p><bold>(a-b)</bold> Imputation performance of 10,000 British samples imputed using the UKB reference panel across coverages (0.1–4.0x, different shades of blue, GLIMPSE2 imputation) and the UKB Axiom array data (red). (a) Imputation accuracy at INDEL sites. (b) Gene-level imputation accuracy (Pearson <italic>r</italic><sup>2</sup>, y-axis) at rare Genebass functionally annotated variants (LoF, loss of function; missense, synonymous variants; MAC &lt; 200). Each data point represents a gene with at least one genetic variant across the 10,000 samples (defined <italic>r</italic><sup>2</sup> measure, N = 11185 Lof genes, N = 17003 missense genes, N = 17830 synonymous genes). P values between the imputed Axiom array and 1.0x data were computed with the two-sided Wilcoxon non-parametric rank sum test (LoF p-value = 1.9 × 10<sup>−37</sup>; Missense p-value &lt; 5 × 10<sup>−324</sup>; Synonymous p-value &lt; 5 × 10<sup>−324</sup>). The lower and upper limits of the box plots represent the first and third quartiles (Q1 and Q3); the median is marked at the centre of the box. Lower and upper whiskers are defined as Q1 − 1.5 (Q3–Q1) and Q3 + 1.5 (Q3–Q1), respectively.</p>
              <p>
                <xref rid="MOESM7" ref-type="media">Source data</xref>
              </p>
            </caption>
            <graphic position="anchor" xlink:href="41588_2023_1438_Fig6_ESM" id="d32e983"/>
          </fig>
        </p>
      </sec>
      <sec id="Sec14">
        <title>Source data</title>
        <p id="Par38">
          <media position="anchor" xlink:href="41588_2023_1438_MOESM3_ESM.xlsx" id="MOESM3">
            <label>Source Data Fig. 1</label>
            <caption>
              <p>Statistical source data.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="41588_2023_1438_MOESM4_ESM.xlsx" id="MOESM4">
            <label>Source Data Extended Data Fig. 2</label>
            <caption>
              <p>Statistical source data.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="41588_2023_1438_MOESM5_ESM.xlsx" id="MOESM5">
            <label>Source Data Extended Data Fig. 3</label>
            <caption>
              <p>Statistical source data.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="41588_2023_1438_MOESM6_ESM.xlsx" id="MOESM6">
            <label>Source Data Extended Data Fig. 4</label>
            <caption>
              <p>Statistical source data.</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="41588_2023_1438_MOESM7_ESM.xlsx" id="MOESM7">
            <label>Source Data Extended Data Fig. 5</label>
            <caption>
              <p>Statistical source data.</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <sec id="FPar1">
      <title>Extended data</title>
      <p id="Par28">is available for this paper at 10.1038/s41588-023-01438-3.</p>
    </sec>
    <sec id="FPar2" sec-type="supplementary-material">
      <title>Supplementary information</title>
      <p id="Par29">The online version contains supplementary material available at 10.1038/s41588-023-01438-3.</p>
    </sec>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was funded by a Swiss National Science Foundation project grant 373 (PP00P3_176977) and conducted under UKB project 66995. The funders had no role in study design, data collection and analysis, decision to publish or preparation of the manuscript. We thank the participants of the UKB. The sequencing of 150,119 UKB samples used in this study has been funded by the UKB WGS consortium. DNA sequencing was performed at the Welcome Trust Sanger Institute and deCODE genetics. The New York Genome Center 1000 Genomes data were generated at the New York Genome Center with funds provided by a National Human Genome Research Institute grant no. 3UM1HG008901–03S1.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>S.R. and O.D. designed the study. S.R. and O.D. developed the algorithms and wrote the software. R.J.H. performed the GWAS experiments. S.R. and B.S.M. performed imputation of ancient samples. B.S.M. provided interpretation regarding imputed ancient samples. S.R. performed the remaining experiments. O.D. supervised the project. All authors reviewed the final paper.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar3">
      <title>Peer review information</title>
      <p id="Par30"><italic>Nature Genetics</italic> thanks Arnaldur Gylfason, Tobias Marschall and the other, anonymous, reviewer(s) for their contribution to the peer review of this work.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The 1,000 Genomes Project phase 3 dataset sequenced at high coverage by the New York Genome Center is available on the European Nucleotide Archive under accession no. <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena/data/view/PRJEB31736">PRJEB31736</ext-link>, the International Genome Sample Resource (IGSR) data portal and the University of Michigan school of public health ftp site (<ext-link ext-link-type="uri" xlink:href="ftp://share.sph.umich.edu/1000g-high-coverage/freeze9/phased/">ftp://share.sph.umich.edu/1000g-high-coverage/freeze9/phased/</ext-link>). The publicly available subset of the HRC dataset is available from the European Genome-phenome Archive at the European Bioinformatics Institute under accession no. <ext-link ext-link-type="uri" xlink:href="https://ega-archive.org/studies/EGAS00001001710">EGAS00001001710</ext-link>. The publicly available Simons Genome Diversity project is available on the IGSR data portal and Cancer Genomics Cloud, powered by Seven Bridges. The UKB WGS data and phenotypes can be accessed via RAP: <ext-link ext-link-type="uri" xlink:href="https://ukbiobank.dnanexus.com/landing">https://ukbiobank.dnanexus.com/landing</ext-link>. The phased WGS reference panel can be accessed via RAP: <ext-link ext-link-type="uri" xlink:href="https://ukbiobank.dnanexus.com/landing">https://ukbiobank.dnanexus.com/landing</ext-link>. <xref rid="Sec14" ref-type="sec">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>GLIMPSE2 source code is available with MIT licence from <ext-link ext-link-type="uri" xlink:href="https://github.com/odelaneau/GLIMPSE">https://github.com/odelaneau/GLIMPSE</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://odelaneau.github.io/GLIMPSE/">https://odelaneau.github.io/GLIMPSE/</ext-link>. This includes code to the chunk, split_reference, phase, ligate and concordance. The documentation is available at <ext-link ext-link-type="uri" xlink:href="https://odelaneau.github.io/GLIMPSE/">https://odelaneau.github.io/GLIMPSE/</ext-link>. Code and source data to reproduce analysis and figures have been deposited in a Zenodo repository<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>.</p>
  </notes>
  <notes id="FPar4" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par31">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubinacci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ribeiro</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hofmeister</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Delaneau</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Efficient phasing and imputation of low-coverage sequencing data using large reference panels</article-title>
        <source>Nat. Genet.</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>120</fpage>
        <lpage>126</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-020-00756-0</pub-id>
        <?supplied-pmid 33414550?>
        <pub-id pub-id-type="pmid">33414550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davies</surname>
            <given-names>RW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid genotype imputation from sequence with reference panels</article-title>
        <source>Nat. Genet.</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>1104</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00877-0</pub-id>
        <?supplied-pmid 34083788?>
        <pub-id pub-id-type="pmid">34083788</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>AR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Low-coverage sequencing cost-effectively detects known and novel variation in underrepresented populations</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2021</year>
        <volume>108</volume>
        <fpage>656</fpage>
        <lpage>668</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2021.03.012</pub-id>
        <?supplied-pmid 33770507?>
        <pub-id pub-id-type="pmid">33770507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Mazur</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Berisa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pickrell</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Low-pass sequencing increases the power of GWAS and decreases measurement error of polygenic risk scores compared to genotyping arrays</article-title>
        <source>Genome Res.</source>
        <year>2021</year>
        <volume>31</volume>
        <fpage>529</fpage>
        <lpage>537</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.266486.120</pub-id>
        <?supplied-pmid 33536225?>
        <pub-id pub-id-type="pmid">33536225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halldorsson</surname>
            <given-names>BV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequences of 150,119 genomes in the UK Biobank</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>607</volume>
        <fpage>732</fpage>
        <lpage>740</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-04965-x</pub-id>
        <?supplied-pmid 35859178?>
        <pub-id pub-id-type="pmid">35859178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bycroft</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <fpage>203</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0579-z</pub-id>
        <?supplied-pmid 30305743?>
        <pub-id pub-id-type="pmid">30305743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Hofmeister, R. J., Ribeiro, D. M., Rubinacci, S. &amp; Delaneau, O. Accurate rare variant phasing of whole-genome and whole-exome sequencing data in the UK Biobank. <italic>Nat. Genet.</italic>10.1038/s41588-023-01415-w (2023).</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A one-penny imputed genome from next-generation reference panels</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2018</year>
        <volume>103</volume>
        <fpage>338</fpage>
        <lpage>348</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2018.07.015</pub-id>
        <?supplied-pmid 30100085?>
        <pub-id pub-id-type="pmid">30100085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubinacci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Delaneau</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Genotype imputation using the positional Burrows Wheeler transform</article-title>
        <source>PLoS Genet.</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>e1009049</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1009049</pub-id>
        <?supplied-pmid 33196638?>
        <pub-id pub-id-type="pmid">33196638</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karczewski</surname>
            <given-names>KJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic single-variant and gene-based association testing of thousands of phenotypes in 394,841 UK Biobank exomes</article-title>
        <source>Cell Genomics</source>
        <year>2022</year>
        <volume>2</volume>
        <fpage>100168</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100168</pub-id>
        <?supplied-pmid 36778668?>
        <pub-id pub-id-type="pmid">36778668</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taliun</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequencing of 53,831 diverse genomes from the NHLBI TOPMed Program</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>590</volume>
        <fpage>290</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03205-y</pub-id>
        <?supplied-pmid 33568819?>
        <pub-id pub-id-type="pmid">33568819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karczewski</surname>
            <given-names>KJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The mutational constraint spectrum quantified from variation in 141,456 humans</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>581</volume>
        <fpage>434</fpage>
        <lpage>443</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2308-7</pub-id>
        <?supplied-pmid 32461654?>
        <pub-id pub-id-type="pmid">32461654</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">The All of Us Research Program Investigators. The ‘All of Us’ research program. <italic>N. Engl. J. Med</italic>. <bold>381</bold>, 668–676 (2019).</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Modeling linkage disequilibrium and identifying recombination hotspots using single-nucleotide polymorphism data</article-title>
        <source>Genetics</source>
        <year>2003</year>
        <volume>165</volume>
        <fpage>2213</fpage>
        <lpage>2233</lpage>
        <pub-id pub-id-type="doi">10.1093/genetics/165.4.2213</pub-id>
        <?supplied-pmid 14704198?>
        <pub-id pub-id-type="pmid">14704198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Efficient haplotype matching and storage using the positional Burrows–Wheeler transform (PBWT)</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1266</fpage>
        <lpage>1272</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu014</pub-id>
        <?supplied-pmid 24413527?>
        <pub-id pub-id-type="pmid">24413527</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>CC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>
        <source>Gigascience</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/s13742-015-0047-8</pub-id>
        <?supplied-pmid 25722852?>
        <pub-id pub-id-type="pmid">25722852</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Rubinacci, S., Hofmeister, R. J., Sousa da Mota, B. &amp; Delaneau, O. Source data, scripts and code for the manuscript ‘Imputation of low-coverage sequencing data from 150,119 UK Biobank genomes’. <italic>Zenodo</italic>10.5281/ZENODO.7860468 (2023).</mixed-citation>
    </ref>
  </ref-list>
</back>
