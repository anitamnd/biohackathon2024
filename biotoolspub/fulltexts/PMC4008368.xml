<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4008368</article-id>
    <article-id pub-id-type="pmid">24786468</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-13-40172</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0091929</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Molecular Cell Biology</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Gene Prediction</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Elements</subject>
            <subj-group>
              <subject>Mobile Genetic Elements</subject>
              <subj-group>
                <subject>Transposable Elements</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Structural Genomics</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Gene Identification and Analysis</subject>
            <subject>Molecular Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PASTEC: An Automatic Transposable Element Classification Tool</article-title>
      <alt-title alt-title-type="running-head">A Transposable Element Classification Tool</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hoede</surname>
          <given-names>Claire</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arnoux</surname>
          <given-names>Sandie</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moisset</surname>
          <given-names>Mark</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chaumier</surname>
          <given-names>Timothée</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Inizan</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jamilloux</surname>
          <given-names>Véronique</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quesneville</surname>
          <given-names>Hadi</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>INRA, UR1164 URGI - Research Unit in Genomics-Info, Versailles, France</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>INRA, plateforme Bio-informatique Genotoul, Mathématiques et Informatique Appliquées Toulouse UR875, Castanet-Tolosan, France</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>INRA, LUNAM Université, Oniris, UMR1300 BioEpAR, Nantes, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cordaux</surname>
          <given-names>Richard</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Poitiers, France</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>Hadi.quesneville@versailles.inra.fr</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: CH HQ. Performed the experiments: CH. Analyzed the data: CH HQ. Wrote the paper: CH HQ. Designed the software used in analysis: CH SA TC MM OI VJ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>5</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>5</issue>
    <elocation-id>e91929</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>10</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>2</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Hoede et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Hoede et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Summary</title>
        <p>The classification of transposable elements (TEs) is key step towards deciphering their potential impact on the genome. However, this process is often based on manual sequence inspection by TE experts. With the wealth of genomic sequences now available, this task requires automation, making it accessible to most scientists. We propose a new tool, PASTEC, which classifies TEs by searching for structural features and similarities. This tool outperforms currently available software for TE classification. The main innovation of PASTEC is the search for HMM profiles, which is useful for inferring the classification of unknown TE on the basis of conserved functional domains of the proteins. In addition, PASTEC is the only tool providing an exhaustive spectrum of possible classifications to the order level of the Wicker hierarchical TE classification system. It can also automatically classify other repeated elements, such as SSR (Simple Sequence Repeats), rDNA or potential repeated host genes. Finally, the output of this new tool is designed to facilitate manual curation by providing to biologists with all the evidence accumulated for each TE consensus.</p>
      </sec>
      <sec>
        <title>Availability</title>
        <p>PASTEC is available as a REPET module or standalone software (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/repet/REPET_linux-x64-2.2.tar.gz">http://urgi.versailles.inra.fr/download/repet/REPET_linux-x64-2.2.tar.gz</ext-link>). It requires a Unix-like system. There are two standalone versions: one of which is parallelized (requiring Sun grid Engine or Torque), and the other of which is not.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>Claire Hoede's work was supported by a grant from the French National Research. Agency (ANR-08-KBBE-012-02) attributed to Hadi Quesneville. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Transposable elements account for a high proportion of eukaryotic genomes. They are involved in a number of important processes, including genome rearrangement, heterochromatin formation and the regulation of gene expression. Wicker <italic>et al</italic>. <xref rid="pone.0091929-Wicker1" ref-type="bibr">[1]</xref> published a detailed classification for eukaryotic TEs. Their goals were to harmonize and clarify TE classifications and names. This classification includes both well-known classes of TEs: class I (retrotransposons) and II (DNA transposons). Five orders (LTR, DIRS, PLE, LINE, SINE) are defined for class I, and four (TIR, Crypton, Helitron, Maverick) for class II. Each order is also divided into one or several superfamilies, resulting in 29 superfamilies total. Other categories comprising non-autonomous TEs (LARD, TRIM and MITE) are considered in this classification, together with various forms of non-autonomous entities related to TEs to various degrees. This classification is based on the transposition mechanism, sequence similarities and structural relationships. Wicker <italic>et al</italic>. described the protein-coding domains present in each TE superfamily in particular detail.</p>
    <p>Several computational tools have been proposed for the <italic>ab initio</italic> identification of repeat families (see reviews <xref rid="pone.0091929-Permal1" ref-type="bibr">[2]</xref>; <xref rid="pone.0091929-Bergman1" ref-type="bibr">[3]</xref>). These tools generally reconstruct the consensus sequences of repeated regions. It is then useful to characterize and classify these consensus sequences, to study the TE repertoire of a genome. Two tools for the automatic classification of a large range of TEs have been proposed: TEclass <xref rid="pone.0091929-Abrusn1" ref-type="bibr">[4]</xref> and REPCLASS <xref rid="pone.0091929-Feschotte1" ref-type="bibr">[5]</xref>. TEclass classifies TE sequences only into two classes: Retro (class I in Wicker's classification) and DNA (class II in Wicker's classification). This tool can classify class I elements into LTRs and non-LTRs and, where possible, into SINE or LINE elements. However, TEClass cannot distinguish between the various orders of class II elements. The SVM (Support Vector Machine: supervised learning model) classifiers in this tool were trained with RepBase Update, a database of eukaryotic repetitive sequences <xref rid="pone.0091929-Jurka1" ref-type="bibr">[6]</xref>, using different class lengths and vectors of tetramer and pentamer frequencies. This approach is useful when TEs show no clear similarity to known repeats.</p>
    <p>REPCLASS can classify TEs into classes I and II, and into the orders LTR retrotransposon (grouping LTR, LARD, TRIM, DIRS and PLE from Wicker's classification), DNA transposon (grouping TIR, crypton and Polinton from Wicker's classification), LINE/SINE and helitron. In some cases, this tool can also identify the superfamily of the TE. REPCLASS consists of three modules. The first is based on homology and has the greatest impact on final decision. At this step, the software carries out a tblastx analysis against the RepBase databank. The second module (in terms of order of priority for classification) searches for structural characteristics: terminal repeats, such as LTRs and TIRs, tRNA, polyA signals and SSR. Finally, the third module searches for target site duplication (TSD) around TE copies within the genome.</p>
    <p>Neither TEclass nor REPCLASS can classify TEs at the level of detail given by Wicker's classification (see <xref ref-type="table" rid="pone-0091929-t001">Table 1</xref>). We therefore developed PASTEC (Pseudo Agent System for Transposable Element Classification), a modular tool able to classify TEs automatically to order level, for all nine orders of autonomous TEs defined in Wicker's classification plus three orders of non-autonomous TEs (LARD, TRIM and MITE). If PASTEC cannot classify a TE to order level, it classifies it to class level. PASTEC is also designed to filter out false-positive repeated sequences identified by <italic>de novo</italic> approaches. It can therefore distinguish SSRs, rDNA sequences and potential host genes from real TEs. Moreover, PASTEC can classify and recognize incomplete TEs and potentially chimeric TEs (detection of an anomaly in the evidence used to select the classification, or several classifications possible). In this last case, PASTEC chooses the best classification if it has sufficient evidence to make a decision. All evidence is written to the output file, to facilitate the manual curation of potential chimeric TEs. We tested this tool by comparing the results of these three tools on three different datasets.</p>
    <table-wrap id="pone-0091929-t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Comparison of the classifications obtained with the PASTEC, TEClass and RepClass tools.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t001-1" xlink:href="pone.0091929.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">PASTEC (Wicker's) Class</td>
              <td align="left" rowspan="1" colspan="1">PASTEC (Wicker's) Order</td>
              <td align="left" rowspan="1" colspan="1">TEClass Class</td>
              <td align="left" rowspan="1" colspan="1">TEClass Order</td>
              <td align="left" rowspan="1" colspan="1">RepClass Class</td>
              <td align="left" rowspan="1" colspan="1">RepClass Order</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Class I (Retrotransposons)</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">DIRS</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">PLE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LARD*</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">TRIM*</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LINE/SINE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">SINE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">SINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LINE/SINE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Class II (DNA transposons)</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">TIR</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">MITE*</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Crypton</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Helitron</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">Helitron</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Maverick</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt101">
          <label/>
          <p>Notes: (*) Non-autonomous element. <italic>na</italic>: not considered by the tool.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <p>PASTEC was developed in the REPET package <xref rid="pone.0091929-FlutreT" ref-type="bibr">[7]</xref>. In this context, we used PASTEC to classify the consensus TE sequences found <italic>de novo</italic> in a genome. PASTEC uses several features of TEs to classify TE consensus sequences. It searches for structural evidence and sequence similarities stored in a MySQL database obtained during a preprocessing step. The structural features considered are TE length, presence of a LTR (long terminal repeat) or TIR (terminal inverted repeat) detected with a custom-built tool (with a minimum length of 10 bp, a minimum identity of 80%, the taking into account of reciprocal orientations of terminal repeats and a maximal length of 7000 bp), the presence of SSRs (simple sequence repeats detected with the tandem repeat finder (TRF) tool <xref rid="pone.0091929-Benson1" ref-type="bibr">[8]</xref>), the polyA tail and an ORF (open reading frame). The blastx and tblastx routines are used to search for similarities to known TEs in Repbase Update, and the hmmer3 package <xref rid="pone.0091929-Eddy1" ref-type="bibr">[9]</xref> to search against a HMM profile databases (TE-specific or not), after translation in all six frames. Sequence similarities are also identified by blastn searches against known rDNA sequences, known host genes and known helitron ends. The databanks used are preprocessed and formatted. The Repbase Update for PASTEC can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.girinst.org/repbase/index.html">http://www.girinst.org/repbase/index.html</ext-link>, whereas the HMM profile databank formatted for PASTEC is available from the REPET download directory (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/repet/">http://urgi.versailles.inra.fr/download/repet/</ext-link>).</p>
    <p>PASTEC classifies TEs by testing all classifications from Wicker's hierarchical TE classification system. Each possible classification is weighted according to the available evidence, with respect to the classification considered. TEs are currently classified to class and order level. PASTEC can also determine whether a TE is complete on the basis of four criteria: sequence coverage for known TEs, profile coverage, presence of terminal repeats for certain classes, presence of a polyA or SSR tail for LINEs and SINEs, and the length of the TEs with respect to expectations for the class concerned.</p>
    <p>We designed PASTEC as a modular multi-agent classifier. The system is composed of four types of agents: retrievers, classifiers, filter agents, and a super-agent (<xref ref-type="fig" rid="pone-0091929-g001">Figure 1</xref>). The retriever agents retrieve the pre-computed analysis results stored in the MySQL database. They act on the requests of the classifier or filter agents, filtering, formatting and supplying the results. The classifier and filter agents are specialized to recognize a particular category. For example, the LTR agent can determine only whether the TE is a LTR or not. The classifier and filter agents act on the request of the super-agent, deciding whether they can classify the TE or not. For example, the LTR agent decides whether the consensus TE is a LTR on the basis of the following evidence: presence of the ENV (envelope protein) profile (a condition sufficient for classification), the presence of INT (integrase), RT (reverse transcriptase), GAG (capsid protein), AP (aspartate proteinase) and RH (RNase H) profiles together with the detection of a LTR (long terminal repeat), a blast match with the sequence of a known LTR retrotransposon. The super-agent resolves classification conflicts and formats the output file. It resolves conflicts by using a confidence index normalized to 100. For example, the LTR agent calculates a confidence index with the following rules: presence of ENV profiles (+2 because this condition is sufficient for classification), presence of a long terminal repeat and an INT, GAG, RT, RH or AP profile (+1 for each profile combined with the long terminal repeat), +1 for each profile (ENV, AP, RT, RH and GAG) found in the same frame in the same ORF. If the consensus matches at least one known LTR retrotransposon, the LTR agent adds +2 for each type of blast (blastx or tblastx) at the confidence index. Finally, the length of the TE is taken into account because we add +1 if the TE without the long terminal repeat is between 4000 and 15000 bp in length, and we decrease the confidence index by 1 if the TE without the long terminal repeat is less than 1000 bp or more than 15000 bp long. The super-agent uses the maximum confidence index defined for each classifier agent to normalize the confidence index for each classification to 100 and then compare the different classifications. Advanced users can edit all decisions rules and maximum confidence indices in the Decision_rules.yaml file.</p>
    <fig id="pone-0091929-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Agents implemented in the system.</title>
        <p>Orange agents are retriever agents, blue agents are classifier and filter agents. The super-agent is shown in green. The arrows indicate the principal communications between the different agents, with only requests shown.</p>
      </caption>
      <graphic xlink:href="pone.0091929.g001"/>
    </fig>
    <p>The output can be read by humans and is biologist-friendly. A single line specifies the name of the TE, its length, status, class, order, completeness, confidence index and all the features characterizing it. A status of “potential chimeric” or “OK” is assigned to the TE. If the TE is not considered to be “OK” then users must apply their own expertise. A TE is declared “potential chimeric” when at least two classifications are possible. In this case, PASTEC chooses the best status based on the available evidence, or does not classify the TE if no decision is possible. In this last case, all possible classifications are given (separated by a pipe symbol “|”). We present an example of PASTEC output in <xref ref-type="supplementary-material" rid="pone.0091929.s007">table S1</xref>. PASTEC output is a tabular file, with the columns from left to right indicating the name of the TE, its length, the orientation of the sequence, chimeric/non-chimeric status (OK indicating that the element is not potentially chimeric), class (class I in this case), order. In the first line of the example provided, the TE is a LTR. We presume that the element is complete because we have no evidence to suggest that it is incomplete, and the confidence index is 71/100. The last column summarizes all the evidence found: coding sequence evidence, such as the results of tblastX queries against the Repbase database (TE_BLRtx evidence), blastX queries against the Repbase database (TE_BLRx evidence) and profiles. A blast match is taken account if coverage exceeds 5%, and a profile is taken into account if its coverage exceeds 20% (these parameters can be edited in the configuration file). For each item of coding sequence evidence, the coverage of the subject is specified. The structural evidence is also detailed: &gt;4000 bp indicates that TE length without terminal repeats is between 4000 and 15000 bp, the next item of information presented in the comments columns is the presence of terminal repeats: we have a LTR in this case, with an LTR length of 433 bp; two long ORFs have been identified, the last of which contains four profiles in the same frame and is up to 3000 bp long. Other evidence provided for this example includes the partial match with a <italic>Drosophila melanogaster</italic> gene (coverage 16.55% and the TE contains 18% SSRs). The super-agent determines whether a TE is complete based on whether it is sufficiently long, whether the expected terminal repeats or polyA tail are present, whether blast match coverage exceeds 30% and profile coverage exceeds 75%. The second line of the example corresponds to a potentially chimeric TE, for which human expertise is required.</p>
  </sec>
  <sec id="s3">
    <title>Results and Discussion</title>
    <p>We compared the results of PASTEC with those of the two other classification tools, REPCLASS and TEclass, for three datasets: (i) the <italic>A. thaliana</italic> consensuses found in Repbase update version 15.09 (referred to hereafter as Repbase-atha), (ii) the TEs present in Repbase update 15.09 but not in Repbase 13.07 (referred to hereafter as Repbase-diff), and (iii) the whole Repbase update 15.09 from which we removed redundant TEs, i.e., those with strictly identical sequences (referred to hereafter as Repbase-all). For RepClass and PASTEC, which require a database for blast analyses, we used RepBase update 15.09 from which we removed the <italic>A. thaliana</italic> TEs in the first case, RepBase 13.07 in the second case and no blast database in the last case. The second case (Repbase-diff) mimics standard use: we wanted to classify TEs obtained from a new genome and, therefore, not yet known in the Repbase database. Indeed, Repbase-diff contains the TEs present in Repbase Update 15.09, but not in Repbase Update 13.07, and we provided Repbase Update 13.07 for sequence similarity searches by REPCLASS and PASTEC. So, as is usually the case in such analyses, we have unknown TEs (Repbase-diff) and a database of known TEs (Repbase Update 13.07). This made it possible to check whether the classification results for Repbase-diff were consistent with the classification given in Repbase Update 15.09. The last case is the most difficult, with attempts to classify TEs as if no known TEs are present in the database.</p>
    <p>We compared the classification performance, in terms of the percentages of TEs well classified, misclassified relative to their annotation in the Repbase database or not classified at the level of class (<xref ref-type="table" rid="pone-0091929-t002">Table 2</xref>) or order (<xref ref-type="table" rid="pone-0091929-t003">Table 3</xref>), for each of the three tools. It was not possible to compare sensitivity and specificity for each order, because the three tools do not use the same classification. Nevertheless, sensitivity and specificity data are presented in the supplementary data for the orders for which this was possible. We mapped the PASTEC classification onto those used by TEclass or REPCLASS, to improve comparisons. <xref ref-type="table" rid="pone-0091929-t003">Table 3</xref> shows the performances obtained with PASTEC after mapping.</p>
    <table-wrap id="pone-0091929-t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Comparison of the performances of PASTEC, REPCLASS, and TECLASS for classification into TE classes.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t002-2" xlink:href="pone.0091929.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset (sequence <sup>#</sup>)</td>
              <td align="left" rowspan="1" colspan="1">Performance</td>
              <td align="left" rowspan="1" colspan="1">PASTEC</td>
              <td align="left" rowspan="1" colspan="1">REPCLASS</td>
              <td align="left" rowspan="1" colspan="1">TECLASS</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-atha (318)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">80.7</td>
              <td align="left" rowspan="1" colspan="1">83.6</td>
              <td align="left" rowspan="1" colspan="1">98.4</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>0.95</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.5</td>
              <td align="left" rowspan="1" colspan="1">1.3</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">12.9</td>
              <td align="left" rowspan="1" colspan="1">0.3</td>
            </tr>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-diff (5546)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">63.7</td>
              <td align="left" rowspan="1" colspan="1">26.1</td>
              <td align="left" rowspan="1" colspan="1">59.2</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">31.8</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>40.2</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">42.1</td>
              <td align="left" rowspan="1" colspan="1">0.5</td>
            </tr>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-all (9665)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">52.7</td>
              <td align="left" rowspan="1" colspan="1">20.35</td>
              <td align="left" rowspan="1" colspan="1">53.8</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>5.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">27.09</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>45.8</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">41.3</td>
              <td align="left" rowspan="1" colspan="1">52.6</td>
              <td align="left" rowspan="1" colspan="1">0.3</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <table-wrap id="pone-0091929-t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Comparison of the performances of PASTEC, REPCLASS, and TECLASS for classification to TE order level.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t003-3" xlink:href="pone.0091929.t003"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset (sequence <sup>#</sup>)</td>
              <td align="left" rowspan="1" colspan="1">Performance</td>
              <td align="left" rowspan="1" colspan="1">PASTEC</td>
              <td align="left" rowspan="1" colspan="1">PASTEC mapped to REPCLASS order (1)</td>
              <td align="left" rowspan="1" colspan="1">PASTEC mapped to TECLASS order (2)</td>
              <td align="left" rowspan="1" colspan="1">REPCLASS (3)</td>
              <td align="left" rowspan="1" colspan="1">TECLASS (4)</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-atha (318)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">71.4</td>
              <td align="left" rowspan="1" colspan="1">79.7</td>
              <td align="left" rowspan="1" colspan="1">93.7</td>
              <td align="left" rowspan="1" colspan="1">85.5</td>
              <td align="left" rowspan="1" colspan="1">97.5</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>10.2</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>1.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.5</td>
              <td align="left" rowspan="1" colspan="1">2.8</td>
              <td align="left" rowspan="1" colspan="1">1.9</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">3.8</td>
              <td align="left" rowspan="1" colspan="1">11.6</td>
              <td align="left" rowspan="1" colspan="1">0.6</td>
            </tr>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-diff (5546)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">51.3</td>
              <td align="left" rowspan="1" colspan="1">59.1</td>
              <td align="left" rowspan="1" colspan="1">49.7</td>
              <td align="left" rowspan="1" colspan="1">66.9</td>
              <td align="left" rowspan="1" colspan="1">47.7</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>10.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.1</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.5</td>
              <td align="left" rowspan="1" colspan="1">11.1</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>50.3</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">46.8</td>
              <td align="left" rowspan="1" colspan="1">17.6</td>
              <td align="left" rowspan="1" colspan="1">1.9</td>
            </tr>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-all (9665)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">22.4</td>
              <td align="left" rowspan="1" colspan="1">31.9</td>
              <td align="left" rowspan="1" colspan="1">8.6</td>
              <td align="left" rowspan="1" colspan="1">12.4</td>
              <td align="left" rowspan="1" colspan="1">40</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>15.8</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>6.2</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">6.7</td>
              <td align="left" rowspan="1" colspan="1">33.3</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>59.7</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">61.8</td>
              <td align="left" rowspan="1" colspan="1">61.8</td>
              <td align="left" rowspan="1" colspan="1">84.7</td>
              <td align="left" rowspan="1" colspan="1">50.84</td>
              <td align="left" rowspan="1" colspan="1">0.25</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt102">
          <label/>
          <p>Note that the classification differs between the three tools. We therefore mapped the PASTEC classification results onto those for REPCLASS (1) and TECLASS (2). (2) Mapped onto TECLASS class I orders only. (3) order considered are: DNA transposon, LTR retrotransposon, helitron, non LTR retrotransposon. (4) order considered are only LTR, LINE/SINE.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>PASTEC misclassified very few TEs, regardless of the dataset tested (<xref ref-type="table" rid="pone-0091929-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0091929-t003">3</xref>). These rare ambiguities mostly concerned closely related TEs: essentially MITE/TIR (427/605 −70.6% - TEs misclassified at order level in the Repbase subtraction dataset). For Repbase-diff, PASTEC was frequently more specific than the other two tools (see suppl. Data: Venn diagram and table of sensitivity and specificity of the three tools for this second dataset <xref ref-type="supplementary-material" rid="pone.0091929.s008">Tables S2</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s009">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s010">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s011">S5</xref>
<xref ref-type="supplementary-material" rid="pone.0091929.s012">S6</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s001">Figures S1</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s002">S2</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s003">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s004">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s005">S5</xref>
<xref ref-type="supplementary-material" rid="pone.0091929.s006">S6</xref>). However, it failed to classify many TEs due to a lack of useful evidence. PASTEC HMM profile detection was found to be particularly useful if the database contained no similar TE to that for which the search was carried out. For Repbase-all without blast searches, we had profile information for 3488 TEs, making it possible to classify these elements at least partially. For classification to order level, PASTEC gave better results than REPCLASS. PASTEC correctly classified more TEs than REPCLASS for the Repbase-all library (31.9% of the TEs were well classified by PASTEC on the basis of REPCLASS order, whereas REPCLASS classified only 12.4% of TEs well, and PASTEC misclassified fewer TEs for all datasets (see <xref ref-type="table" rid="pone-0091929-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0091929-t003">3</xref>).</p>
    <p>REPCLASS performed well on the Repbase-atha dataset, particularly for helitrons, thanks to its helitron_scan tool, if no TSDs were found. It was efficient, but required the genome sequence. This tool searches for 5′ and 3′ termini, including the flanking sequences of all copies found in the genome, and a subterminal hairpin-like GC-rich motif. For the other datasets, we provided no genome sequence because the TEs came from many different genomes. In such conditions, the TSD module of REPCLASS cannot be used, but good results were nevertheless obtained with this tool for the Repbase-diff dataset (67% of TEs well classified to order level, see <xref ref-type="table" rid="pone-0091929-t003">Table 3</xref>). For this dataset, REPCLASS was more sensitive (83.6% <italic>vs</italic> 52.7%) but less specific (89.7% <italic>vs</italic> 99.9%) than PASTEC for classification to order level. By contrast, for the Repbase-all dataset (without blast homology searches), this tool gave the worst results (12.4% of TEs well classified to order level).</p>
    <p>TEclass classified the <italic>A. thaliana</italic> dataset well, but despite the number of TEs correctly classified with each of the three test datasets, the percentage of TEs misclassified remained high. TEclass misclassified between 40% and 60% of TEs from the Repbase-diff and Repbase-all datasets, misclassifying more than half of the TEs at order level for these two datasets. This suggests that this tool does not recognize effectively the situations in which it cannot give a correct classification. For interpretation purposes, a lower level of misclassification with more TEs unclassified and requiring manual checking would be preferable. It should also be noted that, in this study, TEclass was at an advantage over the other tools, as we could not train TEclass with a database containing none of the TEs in the test set.</p>
  </sec>
  <sec id="s4">
    <title>Conclusions</title>
    <p>In conclusion, TEclass misclassified TEs more frequently than the other tools for the two largest datasets (more than 50% of TEs for classification to order level). Moreover, the order classification of this tool is highly simplified (only four potential classifications). REPCLASS also has a simplified order classification (only four potential classifications). For these four orders, this tool performs well in conditions in which a homology search is possible (86% of Repbase-atha TEs well classified, with only 3% misclassified, 67% of Repbase-diff TEs well classified, with only 11% misclassified). However for the Repbase-all dataset, for which no homology search was possible, it performed poorly (12% of TEs well classified for 33% misclassified).</p>
    <p>PASTEC was found to have many advantages over the other tools. First, it can classify TEs into no less than nine orders, according to Wicker's classification (versus only four for TEclass and REPCLASS). It performs well for classification into these nine orders, particularly for the dataset for which blast homology searches were not possible, due to the possibility of carrying out HMM profile searches (22% of TEs are well classified and only 16% are misclassified). This is particularly useful when looking at a species phylogenetically distant from the species from which the known TEs were obtained. It performed well for the Repbase-diff dataset, which simulates a standard dataset: 51% of TEs were well classified and 11% were misclassified for classification to order level (for the nine available orders). If we consider only the four REPCLASS levels of classification, PASTEC classified 59% of TEs well and misclassified only 3% of TEs. In the same conditions, REPCLASS classified 67% of TEs correctly and misclassified 11% of TEs (almost four times more than PASTEC).</p>
    <p>A second advantage of PASTEC is its output format. We paid particular attention in the development of this tool to the generation of a file readable by humans, containing all the information required for manual curation by a biologist. Furthermore, PASTEC highlights the TEs for which manual curation is particularly necessary, by specifying whether the classification was ambiguous.</p>
    <p>Finally, PASTEC's modular architecture makes it possible to add new analyses or decision rules without difficulty. Expert users can access a configuration file, to change diverse parameters.</p>
    <p>The main perspective for improving PASTEC concerns classification to the superfamily level, not only through blast searches, but also on the basis of the HMM profiles detected in the TEs. <ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/Tools/REPET">http://urgi.versailles.inra.fr/Tools/REPET</ext-link>
</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0091929.s001">
      <label>Figure S1</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for class I TEs.</bold> The number of well classified class I TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s002">
      <label>Figure S2</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for class II TEs.</bold> The number of well classified class II TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s003">
      <label>Figure S3</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for LINE/SINE TEs.</bold> The number of well classified LINE/SINE TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s004">
      <label>Figure S4</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for helitron TEs.</bold> The number of well classified helitron TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools. Note: TECLASS does not classify helitron TEs to order level.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s005">
      <label>Figure S5</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for LTR TEs.</bold> The number of well classified LTR TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s006">
      <label>Figure S6</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for TIR TEs.</bold> The number of well classified TIR TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools. Note: TECLASS does not classify TIR TEs to order level.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s007">
      <label>Table S1</label>
      <caption>
        <p><bold>An example of PASTEC output.</bold> We present two TEs: the first is classified as a LTR and the second is a potentially chimeric TE (chimera between a helitron and LARD). The output is a tabular file providing the maximum amount of information to facilitate interpretation by biologists.</p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0091929.s007.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s008">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for ClassI and ClassII TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s009">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for LINE/SINE TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s009.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s010">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for helitrons TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s010.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s011">
      <label>Table S5</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for LTR TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s011.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s012">
      <label>Table S6</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for TIR TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s012.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the REPET team for their support in software development, and Joelle Amselem, Nathalie Choisne and Florian Maumus, for user feedback. We also thank Aurélie Kapusta for her help with REPCLASS and the reviewers for their helpful comments.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0091929-Wicker1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wicker</surname><given-names>T</given-names></name>, <name><surname>Sabot</surname><given-names>F</given-names></name>, <name><surname>Hua-Van</surname><given-names>A</given-names></name>, <name><surname>Bennetzen</surname><given-names>JL</given-names></name>, <name><surname>Capy</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>A unified classification system for eukaryotic transposable elements</article-title>. <source>Nature Rev. Genet</source>
<volume>8</volume>: <fpage>973</fpage>–<lpage>982</lpage>.<pub-id pub-id-type="pmid">17984973</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Permal1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Permal</surname><given-names>E</given-names></name>, <name><surname>Flutre</surname><given-names>T</given-names></name>, <name><surname>Quesneville</surname><given-names>H</given-names></name> (<year>2012</year>) <article-title>Roadmap for annotating transposable elements in eukaryote genomes</article-title>. <source>Methods Mol. Biol</source>
<volume>859</volume>: <fpage>53</fpage>–<lpage>68</lpage>.<pub-id pub-id-type="pmid">22367865</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Bergman1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Bergman</surname><given-names>CM</given-names></name>, <name><surname>Quesneville</surname><given-names>H</given-names></name> (<year>2007</year>) <article-title>Discovering and detecting transposable elements in genome sequences</article-title>. <source>Brief. Bioinform</source>
<volume>8</volume>: <fpage>382</fpage>–<lpage>392</lpage>.<pub-id pub-id-type="pmid">17932080</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Abrusn1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Abrusán</surname><given-names>G</given-names></name>, <name><surname>Grundmann</surname><given-names>N</given-names></name>, <name><surname>DeMeester</surname><given-names>L</given-names></name>, <name><surname>Makalowski</surname><given-names>W</given-names></name> (<year>2009</year>) <article-title>TEclass: a tool for automated classification of unknown eukaryotic transposable elements</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>1329</fpage>–<lpage>1330</lpage>.<pub-id pub-id-type="pmid">19349283</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Feschotte1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Feschotte</surname><given-names>C</given-names></name>, <name><surname>Keswani</surname><given-names>U</given-names></name>, <name><surname>Ranganathan</surname><given-names>N</given-names></name>, <name><surname>Guibotsy</surname><given-names>ML</given-names></name>, <name><surname>Levine</surname><given-names>D</given-names></name> (<year>2009</year>) <article-title>Exploring Repetitive DNA Landscapes Using REPCLASS, a Tool That Automates the Classification of Transposable Elements in Eukaryotic Genomes</article-title>. <source>Genome Biol. Evol</source>
<volume>1</volume>: <fpage>205</fpage>–<lpage>220</lpage>.<pub-id pub-id-type="pmid">20333191</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Jurka1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Jurka</surname><given-names>J</given-names></name>, <name><surname>Kapitonov</surname><given-names>VV</given-names></name>, <name><surname>Pavlicek</surname><given-names>A</given-names></name>, <name><surname>Klonowski</surname><given-names>P</given-names></name>, <name><surname>Kohany</surname><given-names>O</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Repbase update, a database of eukaryotic repetitive elements</article-title>. <source>Cytogenet. Genome Res</source>
<volume>110</volume>: <fpage>462</fpage>–<lpage>467</lpage>.<pub-id pub-id-type="pmid">16093699</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-FlutreT">
      <label>7</label>
      <mixed-citation publication-type="journal">FlutreT, Duprat E, Feuillet C, Quesneville H (2011) Considering Transposable Element Diversification in De Novo Annotation Approaches. PLoS ONE <volume>6(1)</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0091929-Benson1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Benson</surname><given-names>G</given-names></name> (<year>1999</year>) <article-title>Tandem repeats finder: a program to analyze DNA sequences</article-title>. <source>Nucleic Acids Res</source>
<volume>27(2)</volume>: <fpage>573</fpage>–<lpage>580</lpage>.<pub-id pub-id-type="pmid">9862982</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Eddy1">
      <label>9</label>
      <mixed-citation publication-type="journal">Eddy SR (2011) Accelerated Profile HMM Searches. PLoS Comput. Biol. <volume>7(10)</volume>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4008368</article-id>
    <article-id pub-id-type="pmid">24786468</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-13-40172</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0091929</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Molecular Cell Biology</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Gene Prediction</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Elements</subject>
            <subj-group>
              <subject>Mobile Genetic Elements</subject>
              <subj-group>
                <subject>Transposable Elements</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Structural Genomics</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Gene Identification and Analysis</subject>
            <subject>Molecular Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PASTEC: An Automatic Transposable Element Classification Tool</article-title>
      <alt-title alt-title-type="running-head">A Transposable Element Classification Tool</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hoede</surname>
          <given-names>Claire</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arnoux</surname>
          <given-names>Sandie</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moisset</surname>
          <given-names>Mark</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chaumier</surname>
          <given-names>Timothée</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Inizan</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jamilloux</surname>
          <given-names>Véronique</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quesneville</surname>
          <given-names>Hadi</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>INRA, UR1164 URGI - Research Unit in Genomics-Info, Versailles, France</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>INRA, plateforme Bio-informatique Genotoul, Mathématiques et Informatique Appliquées Toulouse UR875, Castanet-Tolosan, France</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>INRA, LUNAM Université, Oniris, UMR1300 BioEpAR, Nantes, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cordaux</surname>
          <given-names>Richard</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Poitiers, France</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>Hadi.quesneville@versailles.inra.fr</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: CH HQ. Performed the experiments: CH. Analyzed the data: CH HQ. Wrote the paper: CH HQ. Designed the software used in analysis: CH SA TC MM OI VJ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>5</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>5</issue>
    <elocation-id>e91929</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>10</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>2</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Hoede et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Hoede et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Summary</title>
        <p>The classification of transposable elements (TEs) is key step towards deciphering their potential impact on the genome. However, this process is often based on manual sequence inspection by TE experts. With the wealth of genomic sequences now available, this task requires automation, making it accessible to most scientists. We propose a new tool, PASTEC, which classifies TEs by searching for structural features and similarities. This tool outperforms currently available software for TE classification. The main innovation of PASTEC is the search for HMM profiles, which is useful for inferring the classification of unknown TE on the basis of conserved functional domains of the proteins. In addition, PASTEC is the only tool providing an exhaustive spectrum of possible classifications to the order level of the Wicker hierarchical TE classification system. It can also automatically classify other repeated elements, such as SSR (Simple Sequence Repeats), rDNA or potential repeated host genes. Finally, the output of this new tool is designed to facilitate manual curation by providing to biologists with all the evidence accumulated for each TE consensus.</p>
      </sec>
      <sec>
        <title>Availability</title>
        <p>PASTEC is available as a REPET module or standalone software (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/repet/REPET_linux-x64-2.2.tar.gz">http://urgi.versailles.inra.fr/download/repet/REPET_linux-x64-2.2.tar.gz</ext-link>). It requires a Unix-like system. There are two standalone versions: one of which is parallelized (requiring Sun grid Engine or Torque), and the other of which is not.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>Claire Hoede's work was supported by a grant from the French National Research. Agency (ANR-08-KBBE-012-02) attributed to Hadi Quesneville. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Transposable elements account for a high proportion of eukaryotic genomes. They are involved in a number of important processes, including genome rearrangement, heterochromatin formation and the regulation of gene expression. Wicker <italic>et al</italic>. <xref rid="pone.0091929-Wicker1" ref-type="bibr">[1]</xref> published a detailed classification for eukaryotic TEs. Their goals were to harmonize and clarify TE classifications and names. This classification includes both well-known classes of TEs: class I (retrotransposons) and II (DNA transposons). Five orders (LTR, DIRS, PLE, LINE, SINE) are defined for class I, and four (TIR, Crypton, Helitron, Maverick) for class II. Each order is also divided into one or several superfamilies, resulting in 29 superfamilies total. Other categories comprising non-autonomous TEs (LARD, TRIM and MITE) are considered in this classification, together with various forms of non-autonomous entities related to TEs to various degrees. This classification is based on the transposition mechanism, sequence similarities and structural relationships. Wicker <italic>et al</italic>. described the protein-coding domains present in each TE superfamily in particular detail.</p>
    <p>Several computational tools have been proposed for the <italic>ab initio</italic> identification of repeat families (see reviews <xref rid="pone.0091929-Permal1" ref-type="bibr">[2]</xref>; <xref rid="pone.0091929-Bergman1" ref-type="bibr">[3]</xref>). These tools generally reconstruct the consensus sequences of repeated regions. It is then useful to characterize and classify these consensus sequences, to study the TE repertoire of a genome. Two tools for the automatic classification of a large range of TEs have been proposed: TEclass <xref rid="pone.0091929-Abrusn1" ref-type="bibr">[4]</xref> and REPCLASS <xref rid="pone.0091929-Feschotte1" ref-type="bibr">[5]</xref>. TEclass classifies TE sequences only into two classes: Retro (class I in Wicker's classification) and DNA (class II in Wicker's classification). This tool can classify class I elements into LTRs and non-LTRs and, where possible, into SINE or LINE elements. However, TEClass cannot distinguish between the various orders of class II elements. The SVM (Support Vector Machine: supervised learning model) classifiers in this tool were trained with RepBase Update, a database of eukaryotic repetitive sequences <xref rid="pone.0091929-Jurka1" ref-type="bibr">[6]</xref>, using different class lengths and vectors of tetramer and pentamer frequencies. This approach is useful when TEs show no clear similarity to known repeats.</p>
    <p>REPCLASS can classify TEs into classes I and II, and into the orders LTR retrotransposon (grouping LTR, LARD, TRIM, DIRS and PLE from Wicker's classification), DNA transposon (grouping TIR, crypton and Polinton from Wicker's classification), LINE/SINE and helitron. In some cases, this tool can also identify the superfamily of the TE. REPCLASS consists of three modules. The first is based on homology and has the greatest impact on final decision. At this step, the software carries out a tblastx analysis against the RepBase databank. The second module (in terms of order of priority for classification) searches for structural characteristics: terminal repeats, such as LTRs and TIRs, tRNA, polyA signals and SSR. Finally, the third module searches for target site duplication (TSD) around TE copies within the genome.</p>
    <p>Neither TEclass nor REPCLASS can classify TEs at the level of detail given by Wicker's classification (see <xref ref-type="table" rid="pone-0091929-t001">Table 1</xref>). We therefore developed PASTEC (Pseudo Agent System for Transposable Element Classification), a modular tool able to classify TEs automatically to order level, for all nine orders of autonomous TEs defined in Wicker's classification plus three orders of non-autonomous TEs (LARD, TRIM and MITE). If PASTEC cannot classify a TE to order level, it classifies it to class level. PASTEC is also designed to filter out false-positive repeated sequences identified by <italic>de novo</italic> approaches. It can therefore distinguish SSRs, rDNA sequences and potential host genes from real TEs. Moreover, PASTEC can classify and recognize incomplete TEs and potentially chimeric TEs (detection of an anomaly in the evidence used to select the classification, or several classifications possible). In this last case, PASTEC chooses the best classification if it has sufficient evidence to make a decision. All evidence is written to the output file, to facilitate the manual curation of potential chimeric TEs. We tested this tool by comparing the results of these three tools on three different datasets.</p>
    <table-wrap id="pone-0091929-t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Comparison of the classifications obtained with the PASTEC, TEClass and RepClass tools.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t001-1" xlink:href="pone.0091929.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">PASTEC (Wicker's) Class</td>
              <td align="left" rowspan="1" colspan="1">PASTEC (Wicker's) Order</td>
              <td align="left" rowspan="1" colspan="1">TEClass Class</td>
              <td align="left" rowspan="1" colspan="1">TEClass Order</td>
              <td align="left" rowspan="1" colspan="1">RepClass Class</td>
              <td align="left" rowspan="1" colspan="1">RepClass Order</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Class I (Retrotransposons)</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">DIRS</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">PLE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LARD*</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">TRIM*</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LINE/SINE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">SINE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">SINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LINE/SINE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Class II (DNA transposons)</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">TIR</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">MITE*</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Crypton</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Helitron</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">Helitron</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Maverick</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt101">
          <label/>
          <p>Notes: (*) Non-autonomous element. <italic>na</italic>: not considered by the tool.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <p>PASTEC was developed in the REPET package <xref rid="pone.0091929-FlutreT" ref-type="bibr">[7]</xref>. In this context, we used PASTEC to classify the consensus TE sequences found <italic>de novo</italic> in a genome. PASTEC uses several features of TEs to classify TE consensus sequences. It searches for structural evidence and sequence similarities stored in a MySQL database obtained during a preprocessing step. The structural features considered are TE length, presence of a LTR (long terminal repeat) or TIR (terminal inverted repeat) detected with a custom-built tool (with a minimum length of 10 bp, a minimum identity of 80%, the taking into account of reciprocal orientations of terminal repeats and a maximal length of 7000 bp), the presence of SSRs (simple sequence repeats detected with the tandem repeat finder (TRF) tool <xref rid="pone.0091929-Benson1" ref-type="bibr">[8]</xref>), the polyA tail and an ORF (open reading frame). The blastx and tblastx routines are used to search for similarities to known TEs in Repbase Update, and the hmmer3 package <xref rid="pone.0091929-Eddy1" ref-type="bibr">[9]</xref> to search against a HMM profile databases (TE-specific or not), after translation in all six frames. Sequence similarities are also identified by blastn searches against known rDNA sequences, known host genes and known helitron ends. The databanks used are preprocessed and formatted. The Repbase Update for PASTEC can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.girinst.org/repbase/index.html">http://www.girinst.org/repbase/index.html</ext-link>, whereas the HMM profile databank formatted for PASTEC is available from the REPET download directory (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/repet/">http://urgi.versailles.inra.fr/download/repet/</ext-link>).</p>
    <p>PASTEC classifies TEs by testing all classifications from Wicker's hierarchical TE classification system. Each possible classification is weighted according to the available evidence, with respect to the classification considered. TEs are currently classified to class and order level. PASTEC can also determine whether a TE is complete on the basis of four criteria: sequence coverage for known TEs, profile coverage, presence of terminal repeats for certain classes, presence of a polyA or SSR tail for LINEs and SINEs, and the length of the TEs with respect to expectations for the class concerned.</p>
    <p>We designed PASTEC as a modular multi-agent classifier. The system is composed of four types of agents: retrievers, classifiers, filter agents, and a super-agent (<xref ref-type="fig" rid="pone-0091929-g001">Figure 1</xref>). The retriever agents retrieve the pre-computed analysis results stored in the MySQL database. They act on the requests of the classifier or filter agents, filtering, formatting and supplying the results. The classifier and filter agents are specialized to recognize a particular category. For example, the LTR agent can determine only whether the TE is a LTR or not. The classifier and filter agents act on the request of the super-agent, deciding whether they can classify the TE or not. For example, the LTR agent decides whether the consensus TE is a LTR on the basis of the following evidence: presence of the ENV (envelope protein) profile (a condition sufficient for classification), the presence of INT (integrase), RT (reverse transcriptase), GAG (capsid protein), AP (aspartate proteinase) and RH (RNase H) profiles together with the detection of a LTR (long terminal repeat), a blast match with the sequence of a known LTR retrotransposon. The super-agent resolves classification conflicts and formats the output file. It resolves conflicts by using a confidence index normalized to 100. For example, the LTR agent calculates a confidence index with the following rules: presence of ENV profiles (+2 because this condition is sufficient for classification), presence of a long terminal repeat and an INT, GAG, RT, RH or AP profile (+1 for each profile combined with the long terminal repeat), +1 for each profile (ENV, AP, RT, RH and GAG) found in the same frame in the same ORF. If the consensus matches at least one known LTR retrotransposon, the LTR agent adds +2 for each type of blast (blastx or tblastx) at the confidence index. Finally, the length of the TE is taken into account because we add +1 if the TE without the long terminal repeat is between 4000 and 15000 bp in length, and we decrease the confidence index by 1 if the TE without the long terminal repeat is less than 1000 bp or more than 15000 bp long. The super-agent uses the maximum confidence index defined for each classifier agent to normalize the confidence index for each classification to 100 and then compare the different classifications. Advanced users can edit all decisions rules and maximum confidence indices in the Decision_rules.yaml file.</p>
    <fig id="pone-0091929-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Agents implemented in the system.</title>
        <p>Orange agents are retriever agents, blue agents are classifier and filter agents. The super-agent is shown in green. The arrows indicate the principal communications between the different agents, with only requests shown.</p>
      </caption>
      <graphic xlink:href="pone.0091929.g001"/>
    </fig>
    <p>The output can be read by humans and is biologist-friendly. A single line specifies the name of the TE, its length, status, class, order, completeness, confidence index and all the features characterizing it. A status of “potential chimeric” or “OK” is assigned to the TE. If the TE is not considered to be “OK” then users must apply their own expertise. A TE is declared “potential chimeric” when at least two classifications are possible. In this case, PASTEC chooses the best status based on the available evidence, or does not classify the TE if no decision is possible. In this last case, all possible classifications are given (separated by a pipe symbol “|”). We present an example of PASTEC output in <xref ref-type="supplementary-material" rid="pone.0091929.s007">table S1</xref>. PASTEC output is a tabular file, with the columns from left to right indicating the name of the TE, its length, the orientation of the sequence, chimeric/non-chimeric status (OK indicating that the element is not potentially chimeric), class (class I in this case), order. In the first line of the example provided, the TE is a LTR. We presume that the element is complete because we have no evidence to suggest that it is incomplete, and the confidence index is 71/100. The last column summarizes all the evidence found: coding sequence evidence, such as the results of tblastX queries against the Repbase database (TE_BLRtx evidence), blastX queries against the Repbase database (TE_BLRx evidence) and profiles. A blast match is taken account if coverage exceeds 5%, and a profile is taken into account if its coverage exceeds 20% (these parameters can be edited in the configuration file). For each item of coding sequence evidence, the coverage of the subject is specified. The structural evidence is also detailed: &gt;4000 bp indicates that TE length without terminal repeats is between 4000 and 15000 bp, the next item of information presented in the comments columns is the presence of terminal repeats: we have a LTR in this case, with an LTR length of 433 bp; two long ORFs have been identified, the last of which contains four profiles in the same frame and is up to 3000 bp long. Other evidence provided for this example includes the partial match with a <italic>Drosophila melanogaster</italic> gene (coverage 16.55% and the TE contains 18% SSRs). The super-agent determines whether a TE is complete based on whether it is sufficiently long, whether the expected terminal repeats or polyA tail are present, whether blast match coverage exceeds 30% and profile coverage exceeds 75%. The second line of the example corresponds to a potentially chimeric TE, for which human expertise is required.</p>
  </sec>
  <sec id="s3">
    <title>Results and Discussion</title>
    <p>We compared the results of PASTEC with those of the two other classification tools, REPCLASS and TEclass, for three datasets: (i) the <italic>A. thaliana</italic> consensuses found in Repbase update version 15.09 (referred to hereafter as Repbase-atha), (ii) the TEs present in Repbase update 15.09 but not in Repbase 13.07 (referred to hereafter as Repbase-diff), and (iii) the whole Repbase update 15.09 from which we removed redundant TEs, i.e., those with strictly identical sequences (referred to hereafter as Repbase-all). For RepClass and PASTEC, which require a database for blast analyses, we used RepBase update 15.09 from which we removed the <italic>A. thaliana</italic> TEs in the first case, RepBase 13.07 in the second case and no blast database in the last case. The second case (Repbase-diff) mimics standard use: we wanted to classify TEs obtained from a new genome and, therefore, not yet known in the Repbase database. Indeed, Repbase-diff contains the TEs present in Repbase Update 15.09, but not in Repbase Update 13.07, and we provided Repbase Update 13.07 for sequence similarity searches by REPCLASS and PASTEC. So, as is usually the case in such analyses, we have unknown TEs (Repbase-diff) and a database of known TEs (Repbase Update 13.07). This made it possible to check whether the classification results for Repbase-diff were consistent with the classification given in Repbase Update 15.09. The last case is the most difficult, with attempts to classify TEs as if no known TEs are present in the database.</p>
    <p>We compared the classification performance, in terms of the percentages of TEs well classified, misclassified relative to their annotation in the Repbase database or not classified at the level of class (<xref ref-type="table" rid="pone-0091929-t002">Table 2</xref>) or order (<xref ref-type="table" rid="pone-0091929-t003">Table 3</xref>), for each of the three tools. It was not possible to compare sensitivity and specificity for each order, because the three tools do not use the same classification. Nevertheless, sensitivity and specificity data are presented in the supplementary data for the orders for which this was possible. We mapped the PASTEC classification onto those used by TEclass or REPCLASS, to improve comparisons. <xref ref-type="table" rid="pone-0091929-t003">Table 3</xref> shows the performances obtained with PASTEC after mapping.</p>
    <table-wrap id="pone-0091929-t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Comparison of the performances of PASTEC, REPCLASS, and TECLASS for classification into TE classes.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t002-2" xlink:href="pone.0091929.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset (sequence <sup>#</sup>)</td>
              <td align="left" rowspan="1" colspan="1">Performance</td>
              <td align="left" rowspan="1" colspan="1">PASTEC</td>
              <td align="left" rowspan="1" colspan="1">REPCLASS</td>
              <td align="left" rowspan="1" colspan="1">TECLASS</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-atha (318)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">80.7</td>
              <td align="left" rowspan="1" colspan="1">83.6</td>
              <td align="left" rowspan="1" colspan="1">98.4</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>0.95</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.5</td>
              <td align="left" rowspan="1" colspan="1">1.3</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">12.9</td>
              <td align="left" rowspan="1" colspan="1">0.3</td>
            </tr>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-diff (5546)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">63.7</td>
              <td align="left" rowspan="1" colspan="1">26.1</td>
              <td align="left" rowspan="1" colspan="1">59.2</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">31.8</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>40.2</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">42.1</td>
              <td align="left" rowspan="1" colspan="1">0.5</td>
            </tr>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-all (9665)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">52.7</td>
              <td align="left" rowspan="1" colspan="1">20.35</td>
              <td align="left" rowspan="1" colspan="1">53.8</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>5.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">27.09</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>45.8</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">41.3</td>
              <td align="left" rowspan="1" colspan="1">52.6</td>
              <td align="left" rowspan="1" colspan="1">0.3</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <table-wrap id="pone-0091929-t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Comparison of the performances of PASTEC, REPCLASS, and TECLASS for classification to TE order level.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t003-3" xlink:href="pone.0091929.t003"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset (sequence <sup>#</sup>)</td>
              <td align="left" rowspan="1" colspan="1">Performance</td>
              <td align="left" rowspan="1" colspan="1">PASTEC</td>
              <td align="left" rowspan="1" colspan="1">PASTEC mapped to REPCLASS order (1)</td>
              <td align="left" rowspan="1" colspan="1">PASTEC mapped to TECLASS order (2)</td>
              <td align="left" rowspan="1" colspan="1">REPCLASS (3)</td>
              <td align="left" rowspan="1" colspan="1">TECLASS (4)</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-atha (318)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">71.4</td>
              <td align="left" rowspan="1" colspan="1">79.7</td>
              <td align="left" rowspan="1" colspan="1">93.7</td>
              <td align="left" rowspan="1" colspan="1">85.5</td>
              <td align="left" rowspan="1" colspan="1">97.5</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>10.2</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>1.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.5</td>
              <td align="left" rowspan="1" colspan="1">2.8</td>
              <td align="left" rowspan="1" colspan="1">1.9</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">3.8</td>
              <td align="left" rowspan="1" colspan="1">11.6</td>
              <td align="left" rowspan="1" colspan="1">0.6</td>
            </tr>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-diff (5546)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">51.3</td>
              <td align="left" rowspan="1" colspan="1">59.1</td>
              <td align="left" rowspan="1" colspan="1">49.7</td>
              <td align="left" rowspan="1" colspan="1">66.9</td>
              <td align="left" rowspan="1" colspan="1">47.7</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>10.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.1</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.5</td>
              <td align="left" rowspan="1" colspan="1">11.1</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>50.3</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">46.8</td>
              <td align="left" rowspan="1" colspan="1">17.6</td>
              <td align="left" rowspan="1" colspan="1">1.9</td>
            </tr>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-all (9665)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">22.4</td>
              <td align="left" rowspan="1" colspan="1">31.9</td>
              <td align="left" rowspan="1" colspan="1">8.6</td>
              <td align="left" rowspan="1" colspan="1">12.4</td>
              <td align="left" rowspan="1" colspan="1">40</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>15.8</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>6.2</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">6.7</td>
              <td align="left" rowspan="1" colspan="1">33.3</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>59.7</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">61.8</td>
              <td align="left" rowspan="1" colspan="1">61.8</td>
              <td align="left" rowspan="1" colspan="1">84.7</td>
              <td align="left" rowspan="1" colspan="1">50.84</td>
              <td align="left" rowspan="1" colspan="1">0.25</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt102">
          <label/>
          <p>Note that the classification differs between the three tools. We therefore mapped the PASTEC classification results onto those for REPCLASS (1) and TECLASS (2). (2) Mapped onto TECLASS class I orders only. (3) order considered are: DNA transposon, LTR retrotransposon, helitron, non LTR retrotransposon. (4) order considered are only LTR, LINE/SINE.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>PASTEC misclassified very few TEs, regardless of the dataset tested (<xref ref-type="table" rid="pone-0091929-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0091929-t003">3</xref>). These rare ambiguities mostly concerned closely related TEs: essentially MITE/TIR (427/605 −70.6% - TEs misclassified at order level in the Repbase subtraction dataset). For Repbase-diff, PASTEC was frequently more specific than the other two tools (see suppl. Data: Venn diagram and table of sensitivity and specificity of the three tools for this second dataset <xref ref-type="supplementary-material" rid="pone.0091929.s008">Tables S2</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s009">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s010">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s011">S5</xref>
<xref ref-type="supplementary-material" rid="pone.0091929.s012">S6</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s001">Figures S1</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s002">S2</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s003">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s004">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s005">S5</xref>
<xref ref-type="supplementary-material" rid="pone.0091929.s006">S6</xref>). However, it failed to classify many TEs due to a lack of useful evidence. PASTEC HMM profile detection was found to be particularly useful if the database contained no similar TE to that for which the search was carried out. For Repbase-all without blast searches, we had profile information for 3488 TEs, making it possible to classify these elements at least partially. For classification to order level, PASTEC gave better results than REPCLASS. PASTEC correctly classified more TEs than REPCLASS for the Repbase-all library (31.9% of the TEs were well classified by PASTEC on the basis of REPCLASS order, whereas REPCLASS classified only 12.4% of TEs well, and PASTEC misclassified fewer TEs for all datasets (see <xref ref-type="table" rid="pone-0091929-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0091929-t003">3</xref>).</p>
    <p>REPCLASS performed well on the Repbase-atha dataset, particularly for helitrons, thanks to its helitron_scan tool, if no TSDs were found. It was efficient, but required the genome sequence. This tool searches for 5′ and 3′ termini, including the flanking sequences of all copies found in the genome, and a subterminal hairpin-like GC-rich motif. For the other datasets, we provided no genome sequence because the TEs came from many different genomes. In such conditions, the TSD module of REPCLASS cannot be used, but good results were nevertheless obtained with this tool for the Repbase-diff dataset (67% of TEs well classified to order level, see <xref ref-type="table" rid="pone-0091929-t003">Table 3</xref>). For this dataset, REPCLASS was more sensitive (83.6% <italic>vs</italic> 52.7%) but less specific (89.7% <italic>vs</italic> 99.9%) than PASTEC for classification to order level. By contrast, for the Repbase-all dataset (without blast homology searches), this tool gave the worst results (12.4% of TEs well classified to order level).</p>
    <p>TEclass classified the <italic>A. thaliana</italic> dataset well, but despite the number of TEs correctly classified with each of the three test datasets, the percentage of TEs misclassified remained high. TEclass misclassified between 40% and 60% of TEs from the Repbase-diff and Repbase-all datasets, misclassifying more than half of the TEs at order level for these two datasets. This suggests that this tool does not recognize effectively the situations in which it cannot give a correct classification. For interpretation purposes, a lower level of misclassification with more TEs unclassified and requiring manual checking would be preferable. It should also be noted that, in this study, TEclass was at an advantage over the other tools, as we could not train TEclass with a database containing none of the TEs in the test set.</p>
  </sec>
  <sec id="s4">
    <title>Conclusions</title>
    <p>In conclusion, TEclass misclassified TEs more frequently than the other tools for the two largest datasets (more than 50% of TEs for classification to order level). Moreover, the order classification of this tool is highly simplified (only four potential classifications). REPCLASS also has a simplified order classification (only four potential classifications). For these four orders, this tool performs well in conditions in which a homology search is possible (86% of Repbase-atha TEs well classified, with only 3% misclassified, 67% of Repbase-diff TEs well classified, with only 11% misclassified). However for the Repbase-all dataset, for which no homology search was possible, it performed poorly (12% of TEs well classified for 33% misclassified).</p>
    <p>PASTEC was found to have many advantages over the other tools. First, it can classify TEs into no less than nine orders, according to Wicker's classification (versus only four for TEclass and REPCLASS). It performs well for classification into these nine orders, particularly for the dataset for which blast homology searches were not possible, due to the possibility of carrying out HMM profile searches (22% of TEs are well classified and only 16% are misclassified). This is particularly useful when looking at a species phylogenetically distant from the species from which the known TEs were obtained. It performed well for the Repbase-diff dataset, which simulates a standard dataset: 51% of TEs were well classified and 11% were misclassified for classification to order level (for the nine available orders). If we consider only the four REPCLASS levels of classification, PASTEC classified 59% of TEs well and misclassified only 3% of TEs. In the same conditions, REPCLASS classified 67% of TEs correctly and misclassified 11% of TEs (almost four times more than PASTEC).</p>
    <p>A second advantage of PASTEC is its output format. We paid particular attention in the development of this tool to the generation of a file readable by humans, containing all the information required for manual curation by a biologist. Furthermore, PASTEC highlights the TEs for which manual curation is particularly necessary, by specifying whether the classification was ambiguous.</p>
    <p>Finally, PASTEC's modular architecture makes it possible to add new analyses or decision rules without difficulty. Expert users can access a configuration file, to change diverse parameters.</p>
    <p>The main perspective for improving PASTEC concerns classification to the superfamily level, not only through blast searches, but also on the basis of the HMM profiles detected in the TEs. <ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/Tools/REPET">http://urgi.versailles.inra.fr/Tools/REPET</ext-link>
</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0091929.s001">
      <label>Figure S1</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for class I TEs.</bold> The number of well classified class I TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s002">
      <label>Figure S2</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for class II TEs.</bold> The number of well classified class II TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s003">
      <label>Figure S3</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for LINE/SINE TEs.</bold> The number of well classified LINE/SINE TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s004">
      <label>Figure S4</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for helitron TEs.</bold> The number of well classified helitron TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools. Note: TECLASS does not classify helitron TEs to order level.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s005">
      <label>Figure S5</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for LTR TEs.</bold> The number of well classified LTR TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s006">
      <label>Figure S6</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for TIR TEs.</bold> The number of well classified TIR TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools. Note: TECLASS does not classify TIR TEs to order level.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s007">
      <label>Table S1</label>
      <caption>
        <p><bold>An example of PASTEC output.</bold> We present two TEs: the first is classified as a LTR and the second is a potentially chimeric TE (chimera between a helitron and LARD). The output is a tabular file providing the maximum amount of information to facilitate interpretation by biologists.</p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0091929.s007.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s008">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for ClassI and ClassII TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s009">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for LINE/SINE TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s009.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s010">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for helitrons TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s010.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s011">
      <label>Table S5</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for LTR TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s011.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s012">
      <label>Table S6</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for TIR TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s012.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the REPET team for their support in software development, and Joelle Amselem, Nathalie Choisne and Florian Maumus, for user feedback. We also thank Aurélie Kapusta for her help with REPCLASS and the reviewers for their helpful comments.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0091929-Wicker1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wicker</surname><given-names>T</given-names></name>, <name><surname>Sabot</surname><given-names>F</given-names></name>, <name><surname>Hua-Van</surname><given-names>A</given-names></name>, <name><surname>Bennetzen</surname><given-names>JL</given-names></name>, <name><surname>Capy</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>A unified classification system for eukaryotic transposable elements</article-title>. <source>Nature Rev. Genet</source>
<volume>8</volume>: <fpage>973</fpage>–<lpage>982</lpage>.<pub-id pub-id-type="pmid">17984973</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Permal1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Permal</surname><given-names>E</given-names></name>, <name><surname>Flutre</surname><given-names>T</given-names></name>, <name><surname>Quesneville</surname><given-names>H</given-names></name> (<year>2012</year>) <article-title>Roadmap for annotating transposable elements in eukaryote genomes</article-title>. <source>Methods Mol. Biol</source>
<volume>859</volume>: <fpage>53</fpage>–<lpage>68</lpage>.<pub-id pub-id-type="pmid">22367865</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Bergman1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Bergman</surname><given-names>CM</given-names></name>, <name><surname>Quesneville</surname><given-names>H</given-names></name> (<year>2007</year>) <article-title>Discovering and detecting transposable elements in genome sequences</article-title>. <source>Brief. Bioinform</source>
<volume>8</volume>: <fpage>382</fpage>–<lpage>392</lpage>.<pub-id pub-id-type="pmid">17932080</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Abrusn1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Abrusán</surname><given-names>G</given-names></name>, <name><surname>Grundmann</surname><given-names>N</given-names></name>, <name><surname>DeMeester</surname><given-names>L</given-names></name>, <name><surname>Makalowski</surname><given-names>W</given-names></name> (<year>2009</year>) <article-title>TEclass: a tool for automated classification of unknown eukaryotic transposable elements</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>1329</fpage>–<lpage>1330</lpage>.<pub-id pub-id-type="pmid">19349283</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Feschotte1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Feschotte</surname><given-names>C</given-names></name>, <name><surname>Keswani</surname><given-names>U</given-names></name>, <name><surname>Ranganathan</surname><given-names>N</given-names></name>, <name><surname>Guibotsy</surname><given-names>ML</given-names></name>, <name><surname>Levine</surname><given-names>D</given-names></name> (<year>2009</year>) <article-title>Exploring Repetitive DNA Landscapes Using REPCLASS, a Tool That Automates the Classification of Transposable Elements in Eukaryotic Genomes</article-title>. <source>Genome Biol. Evol</source>
<volume>1</volume>: <fpage>205</fpage>–<lpage>220</lpage>.<pub-id pub-id-type="pmid">20333191</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Jurka1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Jurka</surname><given-names>J</given-names></name>, <name><surname>Kapitonov</surname><given-names>VV</given-names></name>, <name><surname>Pavlicek</surname><given-names>A</given-names></name>, <name><surname>Klonowski</surname><given-names>P</given-names></name>, <name><surname>Kohany</surname><given-names>O</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Repbase update, a database of eukaryotic repetitive elements</article-title>. <source>Cytogenet. Genome Res</source>
<volume>110</volume>: <fpage>462</fpage>–<lpage>467</lpage>.<pub-id pub-id-type="pmid">16093699</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-FlutreT">
      <label>7</label>
      <mixed-citation publication-type="journal">FlutreT, Duprat E, Feuillet C, Quesneville H (2011) Considering Transposable Element Diversification in De Novo Annotation Approaches. PLoS ONE <volume>6(1)</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0091929-Benson1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Benson</surname><given-names>G</given-names></name> (<year>1999</year>) <article-title>Tandem repeats finder: a program to analyze DNA sequences</article-title>. <source>Nucleic Acids Res</source>
<volume>27(2)</volume>: <fpage>573</fpage>–<lpage>580</lpage>.<pub-id pub-id-type="pmid">9862982</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Eddy1">
      <label>9</label>
      <mixed-citation publication-type="journal">Eddy SR (2011) Accelerated Profile HMM Searches. PLoS Comput. Biol. <volume>7(10)</volume>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4008368</article-id>
    <article-id pub-id-type="pmid">24786468</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-13-40172</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0091929</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Molecular Cell Biology</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Gene Prediction</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Elements</subject>
            <subj-group>
              <subject>Mobile Genetic Elements</subject>
              <subj-group>
                <subject>Transposable Elements</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Structural Genomics</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Gene Identification and Analysis</subject>
            <subject>Molecular Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PASTEC: An Automatic Transposable Element Classification Tool</article-title>
      <alt-title alt-title-type="running-head">A Transposable Element Classification Tool</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hoede</surname>
          <given-names>Claire</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arnoux</surname>
          <given-names>Sandie</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moisset</surname>
          <given-names>Mark</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chaumier</surname>
          <given-names>Timothée</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Inizan</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jamilloux</surname>
          <given-names>Véronique</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quesneville</surname>
          <given-names>Hadi</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>INRA, UR1164 URGI - Research Unit in Genomics-Info, Versailles, France</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>INRA, plateforme Bio-informatique Genotoul, Mathématiques et Informatique Appliquées Toulouse UR875, Castanet-Tolosan, France</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>INRA, LUNAM Université, Oniris, UMR1300 BioEpAR, Nantes, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cordaux</surname>
          <given-names>Richard</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Poitiers, France</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>Hadi.quesneville@versailles.inra.fr</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: CH HQ. Performed the experiments: CH. Analyzed the data: CH HQ. Wrote the paper: CH HQ. Designed the software used in analysis: CH SA TC MM OI VJ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>5</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>5</issue>
    <elocation-id>e91929</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>10</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>2</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Hoede et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Hoede et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Summary</title>
        <p>The classification of transposable elements (TEs) is key step towards deciphering their potential impact on the genome. However, this process is often based on manual sequence inspection by TE experts. With the wealth of genomic sequences now available, this task requires automation, making it accessible to most scientists. We propose a new tool, PASTEC, which classifies TEs by searching for structural features and similarities. This tool outperforms currently available software for TE classification. The main innovation of PASTEC is the search for HMM profiles, which is useful for inferring the classification of unknown TE on the basis of conserved functional domains of the proteins. In addition, PASTEC is the only tool providing an exhaustive spectrum of possible classifications to the order level of the Wicker hierarchical TE classification system. It can also automatically classify other repeated elements, such as SSR (Simple Sequence Repeats), rDNA or potential repeated host genes. Finally, the output of this new tool is designed to facilitate manual curation by providing to biologists with all the evidence accumulated for each TE consensus.</p>
      </sec>
      <sec>
        <title>Availability</title>
        <p>PASTEC is available as a REPET module or standalone software (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/repet/REPET_linux-x64-2.2.tar.gz">http://urgi.versailles.inra.fr/download/repet/REPET_linux-x64-2.2.tar.gz</ext-link>). It requires a Unix-like system. There are two standalone versions: one of which is parallelized (requiring Sun grid Engine or Torque), and the other of which is not.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>Claire Hoede's work was supported by a grant from the French National Research. Agency (ANR-08-KBBE-012-02) attributed to Hadi Quesneville. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Transposable elements account for a high proportion of eukaryotic genomes. They are involved in a number of important processes, including genome rearrangement, heterochromatin formation and the regulation of gene expression. Wicker <italic>et al</italic>. <xref rid="pone.0091929-Wicker1" ref-type="bibr">[1]</xref> published a detailed classification for eukaryotic TEs. Their goals were to harmonize and clarify TE classifications and names. This classification includes both well-known classes of TEs: class I (retrotransposons) and II (DNA transposons). Five orders (LTR, DIRS, PLE, LINE, SINE) are defined for class I, and four (TIR, Crypton, Helitron, Maverick) for class II. Each order is also divided into one or several superfamilies, resulting in 29 superfamilies total. Other categories comprising non-autonomous TEs (LARD, TRIM and MITE) are considered in this classification, together with various forms of non-autonomous entities related to TEs to various degrees. This classification is based on the transposition mechanism, sequence similarities and structural relationships. Wicker <italic>et al</italic>. described the protein-coding domains present in each TE superfamily in particular detail.</p>
    <p>Several computational tools have been proposed for the <italic>ab initio</italic> identification of repeat families (see reviews <xref rid="pone.0091929-Permal1" ref-type="bibr">[2]</xref>; <xref rid="pone.0091929-Bergman1" ref-type="bibr">[3]</xref>). These tools generally reconstruct the consensus sequences of repeated regions. It is then useful to characterize and classify these consensus sequences, to study the TE repertoire of a genome. Two tools for the automatic classification of a large range of TEs have been proposed: TEclass <xref rid="pone.0091929-Abrusn1" ref-type="bibr">[4]</xref> and REPCLASS <xref rid="pone.0091929-Feschotte1" ref-type="bibr">[5]</xref>. TEclass classifies TE sequences only into two classes: Retro (class I in Wicker's classification) and DNA (class II in Wicker's classification). This tool can classify class I elements into LTRs and non-LTRs and, where possible, into SINE or LINE elements. However, TEClass cannot distinguish between the various orders of class II elements. The SVM (Support Vector Machine: supervised learning model) classifiers in this tool were trained with RepBase Update, a database of eukaryotic repetitive sequences <xref rid="pone.0091929-Jurka1" ref-type="bibr">[6]</xref>, using different class lengths and vectors of tetramer and pentamer frequencies. This approach is useful when TEs show no clear similarity to known repeats.</p>
    <p>REPCLASS can classify TEs into classes I and II, and into the orders LTR retrotransposon (grouping LTR, LARD, TRIM, DIRS and PLE from Wicker's classification), DNA transposon (grouping TIR, crypton and Polinton from Wicker's classification), LINE/SINE and helitron. In some cases, this tool can also identify the superfamily of the TE. REPCLASS consists of three modules. The first is based on homology and has the greatest impact on final decision. At this step, the software carries out a tblastx analysis against the RepBase databank. The second module (in terms of order of priority for classification) searches for structural characteristics: terminal repeats, such as LTRs and TIRs, tRNA, polyA signals and SSR. Finally, the third module searches for target site duplication (TSD) around TE copies within the genome.</p>
    <p>Neither TEclass nor REPCLASS can classify TEs at the level of detail given by Wicker's classification (see <xref ref-type="table" rid="pone-0091929-t001">Table 1</xref>). We therefore developed PASTEC (Pseudo Agent System for Transposable Element Classification), a modular tool able to classify TEs automatically to order level, for all nine orders of autonomous TEs defined in Wicker's classification plus three orders of non-autonomous TEs (LARD, TRIM and MITE). If PASTEC cannot classify a TE to order level, it classifies it to class level. PASTEC is also designed to filter out false-positive repeated sequences identified by <italic>de novo</italic> approaches. It can therefore distinguish SSRs, rDNA sequences and potential host genes from real TEs. Moreover, PASTEC can classify and recognize incomplete TEs and potentially chimeric TEs (detection of an anomaly in the evidence used to select the classification, or several classifications possible). In this last case, PASTEC chooses the best classification if it has sufficient evidence to make a decision. All evidence is written to the output file, to facilitate the manual curation of potential chimeric TEs. We tested this tool by comparing the results of these three tools on three different datasets.</p>
    <table-wrap id="pone-0091929-t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Comparison of the classifications obtained with the PASTEC, TEClass and RepClass tools.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t001-1" xlink:href="pone.0091929.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">PASTEC (Wicker's) Class</td>
              <td align="left" rowspan="1" colspan="1">PASTEC (Wicker's) Order</td>
              <td align="left" rowspan="1" colspan="1">TEClass Class</td>
              <td align="left" rowspan="1" colspan="1">TEClass Order</td>
              <td align="left" rowspan="1" colspan="1">RepClass Class</td>
              <td align="left" rowspan="1" colspan="1">RepClass Order</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Class I (Retrotransposons)</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">DIRS</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">PLE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LARD*</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">TRIM*</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LINE/SINE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">SINE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">SINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LINE/SINE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Class II (DNA transposons)</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">TIR</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">MITE*</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Crypton</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Helitron</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">Helitron</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Maverick</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt101">
          <label/>
          <p>Notes: (*) Non-autonomous element. <italic>na</italic>: not considered by the tool.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <p>PASTEC was developed in the REPET package <xref rid="pone.0091929-FlutreT" ref-type="bibr">[7]</xref>. In this context, we used PASTEC to classify the consensus TE sequences found <italic>de novo</italic> in a genome. PASTEC uses several features of TEs to classify TE consensus sequences. It searches for structural evidence and sequence similarities stored in a MySQL database obtained during a preprocessing step. The structural features considered are TE length, presence of a LTR (long terminal repeat) or TIR (terminal inverted repeat) detected with a custom-built tool (with a minimum length of 10 bp, a minimum identity of 80%, the taking into account of reciprocal orientations of terminal repeats and a maximal length of 7000 bp), the presence of SSRs (simple sequence repeats detected with the tandem repeat finder (TRF) tool <xref rid="pone.0091929-Benson1" ref-type="bibr">[8]</xref>), the polyA tail and an ORF (open reading frame). The blastx and tblastx routines are used to search for similarities to known TEs in Repbase Update, and the hmmer3 package <xref rid="pone.0091929-Eddy1" ref-type="bibr">[9]</xref> to search against a HMM profile databases (TE-specific or not), after translation in all six frames. Sequence similarities are also identified by blastn searches against known rDNA sequences, known host genes and known helitron ends. The databanks used are preprocessed and formatted. The Repbase Update for PASTEC can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.girinst.org/repbase/index.html">http://www.girinst.org/repbase/index.html</ext-link>, whereas the HMM profile databank formatted for PASTEC is available from the REPET download directory (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/repet/">http://urgi.versailles.inra.fr/download/repet/</ext-link>).</p>
    <p>PASTEC classifies TEs by testing all classifications from Wicker's hierarchical TE classification system. Each possible classification is weighted according to the available evidence, with respect to the classification considered. TEs are currently classified to class and order level. PASTEC can also determine whether a TE is complete on the basis of four criteria: sequence coverage for known TEs, profile coverage, presence of terminal repeats for certain classes, presence of a polyA or SSR tail for LINEs and SINEs, and the length of the TEs with respect to expectations for the class concerned.</p>
    <p>We designed PASTEC as a modular multi-agent classifier. The system is composed of four types of agents: retrievers, classifiers, filter agents, and a super-agent (<xref ref-type="fig" rid="pone-0091929-g001">Figure 1</xref>). The retriever agents retrieve the pre-computed analysis results stored in the MySQL database. They act on the requests of the classifier or filter agents, filtering, formatting and supplying the results. The classifier and filter agents are specialized to recognize a particular category. For example, the LTR agent can determine only whether the TE is a LTR or not. The classifier and filter agents act on the request of the super-agent, deciding whether they can classify the TE or not. For example, the LTR agent decides whether the consensus TE is a LTR on the basis of the following evidence: presence of the ENV (envelope protein) profile (a condition sufficient for classification), the presence of INT (integrase), RT (reverse transcriptase), GAG (capsid protein), AP (aspartate proteinase) and RH (RNase H) profiles together with the detection of a LTR (long terminal repeat), a blast match with the sequence of a known LTR retrotransposon. The super-agent resolves classification conflicts and formats the output file. It resolves conflicts by using a confidence index normalized to 100. For example, the LTR agent calculates a confidence index with the following rules: presence of ENV profiles (+2 because this condition is sufficient for classification), presence of a long terminal repeat and an INT, GAG, RT, RH or AP profile (+1 for each profile combined with the long terminal repeat), +1 for each profile (ENV, AP, RT, RH and GAG) found in the same frame in the same ORF. If the consensus matches at least one known LTR retrotransposon, the LTR agent adds +2 for each type of blast (blastx or tblastx) at the confidence index. Finally, the length of the TE is taken into account because we add +1 if the TE without the long terminal repeat is between 4000 and 15000 bp in length, and we decrease the confidence index by 1 if the TE without the long terminal repeat is less than 1000 bp or more than 15000 bp long. The super-agent uses the maximum confidence index defined for each classifier agent to normalize the confidence index for each classification to 100 and then compare the different classifications. Advanced users can edit all decisions rules and maximum confidence indices in the Decision_rules.yaml file.</p>
    <fig id="pone-0091929-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Agents implemented in the system.</title>
        <p>Orange agents are retriever agents, blue agents are classifier and filter agents. The super-agent is shown in green. The arrows indicate the principal communications between the different agents, with only requests shown.</p>
      </caption>
      <graphic xlink:href="pone.0091929.g001"/>
    </fig>
    <p>The output can be read by humans and is biologist-friendly. A single line specifies the name of the TE, its length, status, class, order, completeness, confidence index and all the features characterizing it. A status of “potential chimeric” or “OK” is assigned to the TE. If the TE is not considered to be “OK” then users must apply their own expertise. A TE is declared “potential chimeric” when at least two classifications are possible. In this case, PASTEC chooses the best status based on the available evidence, or does not classify the TE if no decision is possible. In this last case, all possible classifications are given (separated by a pipe symbol “|”). We present an example of PASTEC output in <xref ref-type="supplementary-material" rid="pone.0091929.s007">table S1</xref>. PASTEC output is a tabular file, with the columns from left to right indicating the name of the TE, its length, the orientation of the sequence, chimeric/non-chimeric status (OK indicating that the element is not potentially chimeric), class (class I in this case), order. In the first line of the example provided, the TE is a LTR. We presume that the element is complete because we have no evidence to suggest that it is incomplete, and the confidence index is 71/100. The last column summarizes all the evidence found: coding sequence evidence, such as the results of tblastX queries against the Repbase database (TE_BLRtx evidence), blastX queries against the Repbase database (TE_BLRx evidence) and profiles. A blast match is taken account if coverage exceeds 5%, and a profile is taken into account if its coverage exceeds 20% (these parameters can be edited in the configuration file). For each item of coding sequence evidence, the coverage of the subject is specified. The structural evidence is also detailed: &gt;4000 bp indicates that TE length without terminal repeats is between 4000 and 15000 bp, the next item of information presented in the comments columns is the presence of terminal repeats: we have a LTR in this case, with an LTR length of 433 bp; two long ORFs have been identified, the last of which contains four profiles in the same frame and is up to 3000 bp long. Other evidence provided for this example includes the partial match with a <italic>Drosophila melanogaster</italic> gene (coverage 16.55% and the TE contains 18% SSRs). The super-agent determines whether a TE is complete based on whether it is sufficiently long, whether the expected terminal repeats or polyA tail are present, whether blast match coverage exceeds 30% and profile coverage exceeds 75%. The second line of the example corresponds to a potentially chimeric TE, for which human expertise is required.</p>
  </sec>
  <sec id="s3">
    <title>Results and Discussion</title>
    <p>We compared the results of PASTEC with those of the two other classification tools, REPCLASS and TEclass, for three datasets: (i) the <italic>A. thaliana</italic> consensuses found in Repbase update version 15.09 (referred to hereafter as Repbase-atha), (ii) the TEs present in Repbase update 15.09 but not in Repbase 13.07 (referred to hereafter as Repbase-diff), and (iii) the whole Repbase update 15.09 from which we removed redundant TEs, i.e., those with strictly identical sequences (referred to hereafter as Repbase-all). For RepClass and PASTEC, which require a database for blast analyses, we used RepBase update 15.09 from which we removed the <italic>A. thaliana</italic> TEs in the first case, RepBase 13.07 in the second case and no blast database in the last case. The second case (Repbase-diff) mimics standard use: we wanted to classify TEs obtained from a new genome and, therefore, not yet known in the Repbase database. Indeed, Repbase-diff contains the TEs present in Repbase Update 15.09, but not in Repbase Update 13.07, and we provided Repbase Update 13.07 for sequence similarity searches by REPCLASS and PASTEC. So, as is usually the case in such analyses, we have unknown TEs (Repbase-diff) and a database of known TEs (Repbase Update 13.07). This made it possible to check whether the classification results for Repbase-diff were consistent with the classification given in Repbase Update 15.09. The last case is the most difficult, with attempts to classify TEs as if no known TEs are present in the database.</p>
    <p>We compared the classification performance, in terms of the percentages of TEs well classified, misclassified relative to their annotation in the Repbase database or not classified at the level of class (<xref ref-type="table" rid="pone-0091929-t002">Table 2</xref>) or order (<xref ref-type="table" rid="pone-0091929-t003">Table 3</xref>), for each of the three tools. It was not possible to compare sensitivity and specificity for each order, because the three tools do not use the same classification. Nevertheless, sensitivity and specificity data are presented in the supplementary data for the orders for which this was possible. We mapped the PASTEC classification onto those used by TEclass or REPCLASS, to improve comparisons. <xref ref-type="table" rid="pone-0091929-t003">Table 3</xref> shows the performances obtained with PASTEC after mapping.</p>
    <table-wrap id="pone-0091929-t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Comparison of the performances of PASTEC, REPCLASS, and TECLASS for classification into TE classes.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t002-2" xlink:href="pone.0091929.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset (sequence <sup>#</sup>)</td>
              <td align="left" rowspan="1" colspan="1">Performance</td>
              <td align="left" rowspan="1" colspan="1">PASTEC</td>
              <td align="left" rowspan="1" colspan="1">REPCLASS</td>
              <td align="left" rowspan="1" colspan="1">TECLASS</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-atha (318)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">80.7</td>
              <td align="left" rowspan="1" colspan="1">83.6</td>
              <td align="left" rowspan="1" colspan="1">98.4</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>0.95</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.5</td>
              <td align="left" rowspan="1" colspan="1">1.3</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">12.9</td>
              <td align="left" rowspan="1" colspan="1">0.3</td>
            </tr>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-diff (5546)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">63.7</td>
              <td align="left" rowspan="1" colspan="1">26.1</td>
              <td align="left" rowspan="1" colspan="1">59.2</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">31.8</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>40.2</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">42.1</td>
              <td align="left" rowspan="1" colspan="1">0.5</td>
            </tr>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-all (9665)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">52.7</td>
              <td align="left" rowspan="1" colspan="1">20.35</td>
              <td align="left" rowspan="1" colspan="1">53.8</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>5.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">27.09</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>45.8</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">41.3</td>
              <td align="left" rowspan="1" colspan="1">52.6</td>
              <td align="left" rowspan="1" colspan="1">0.3</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <table-wrap id="pone-0091929-t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Comparison of the performances of PASTEC, REPCLASS, and TECLASS for classification to TE order level.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t003-3" xlink:href="pone.0091929.t003"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset (sequence <sup>#</sup>)</td>
              <td align="left" rowspan="1" colspan="1">Performance</td>
              <td align="left" rowspan="1" colspan="1">PASTEC</td>
              <td align="left" rowspan="1" colspan="1">PASTEC mapped to REPCLASS order (1)</td>
              <td align="left" rowspan="1" colspan="1">PASTEC mapped to TECLASS order (2)</td>
              <td align="left" rowspan="1" colspan="1">REPCLASS (3)</td>
              <td align="left" rowspan="1" colspan="1">TECLASS (4)</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-atha (318)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">71.4</td>
              <td align="left" rowspan="1" colspan="1">79.7</td>
              <td align="left" rowspan="1" colspan="1">93.7</td>
              <td align="left" rowspan="1" colspan="1">85.5</td>
              <td align="left" rowspan="1" colspan="1">97.5</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>10.2</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>1.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.5</td>
              <td align="left" rowspan="1" colspan="1">2.8</td>
              <td align="left" rowspan="1" colspan="1">1.9</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">3.8</td>
              <td align="left" rowspan="1" colspan="1">11.6</td>
              <td align="left" rowspan="1" colspan="1">0.6</td>
            </tr>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-diff (5546)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">51.3</td>
              <td align="left" rowspan="1" colspan="1">59.1</td>
              <td align="left" rowspan="1" colspan="1">49.7</td>
              <td align="left" rowspan="1" colspan="1">66.9</td>
              <td align="left" rowspan="1" colspan="1">47.7</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>10.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.1</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.5</td>
              <td align="left" rowspan="1" colspan="1">11.1</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>50.3</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">46.8</td>
              <td align="left" rowspan="1" colspan="1">17.6</td>
              <td align="left" rowspan="1" colspan="1">1.9</td>
            </tr>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-all (9665)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">22.4</td>
              <td align="left" rowspan="1" colspan="1">31.9</td>
              <td align="left" rowspan="1" colspan="1">8.6</td>
              <td align="left" rowspan="1" colspan="1">12.4</td>
              <td align="left" rowspan="1" colspan="1">40</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>15.8</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>6.2</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">6.7</td>
              <td align="left" rowspan="1" colspan="1">33.3</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>59.7</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">61.8</td>
              <td align="left" rowspan="1" colspan="1">61.8</td>
              <td align="left" rowspan="1" colspan="1">84.7</td>
              <td align="left" rowspan="1" colspan="1">50.84</td>
              <td align="left" rowspan="1" colspan="1">0.25</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt102">
          <label/>
          <p>Note that the classification differs between the three tools. We therefore mapped the PASTEC classification results onto those for REPCLASS (1) and TECLASS (2). (2) Mapped onto TECLASS class I orders only. (3) order considered are: DNA transposon, LTR retrotransposon, helitron, non LTR retrotransposon. (4) order considered are only LTR, LINE/SINE.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>PASTEC misclassified very few TEs, regardless of the dataset tested (<xref ref-type="table" rid="pone-0091929-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0091929-t003">3</xref>). These rare ambiguities mostly concerned closely related TEs: essentially MITE/TIR (427/605 −70.6% - TEs misclassified at order level in the Repbase subtraction dataset). For Repbase-diff, PASTEC was frequently more specific than the other two tools (see suppl. Data: Venn diagram and table of sensitivity and specificity of the three tools for this second dataset <xref ref-type="supplementary-material" rid="pone.0091929.s008">Tables S2</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s009">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s010">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s011">S5</xref>
<xref ref-type="supplementary-material" rid="pone.0091929.s012">S6</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s001">Figures S1</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s002">S2</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s003">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s004">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s005">S5</xref>
<xref ref-type="supplementary-material" rid="pone.0091929.s006">S6</xref>). However, it failed to classify many TEs due to a lack of useful evidence. PASTEC HMM profile detection was found to be particularly useful if the database contained no similar TE to that for which the search was carried out. For Repbase-all without blast searches, we had profile information for 3488 TEs, making it possible to classify these elements at least partially. For classification to order level, PASTEC gave better results than REPCLASS. PASTEC correctly classified more TEs than REPCLASS for the Repbase-all library (31.9% of the TEs were well classified by PASTEC on the basis of REPCLASS order, whereas REPCLASS classified only 12.4% of TEs well, and PASTEC misclassified fewer TEs for all datasets (see <xref ref-type="table" rid="pone-0091929-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0091929-t003">3</xref>).</p>
    <p>REPCLASS performed well on the Repbase-atha dataset, particularly for helitrons, thanks to its helitron_scan tool, if no TSDs were found. It was efficient, but required the genome sequence. This tool searches for 5′ and 3′ termini, including the flanking sequences of all copies found in the genome, and a subterminal hairpin-like GC-rich motif. For the other datasets, we provided no genome sequence because the TEs came from many different genomes. In such conditions, the TSD module of REPCLASS cannot be used, but good results were nevertheless obtained with this tool for the Repbase-diff dataset (67% of TEs well classified to order level, see <xref ref-type="table" rid="pone-0091929-t003">Table 3</xref>). For this dataset, REPCLASS was more sensitive (83.6% <italic>vs</italic> 52.7%) but less specific (89.7% <italic>vs</italic> 99.9%) than PASTEC for classification to order level. By contrast, for the Repbase-all dataset (without blast homology searches), this tool gave the worst results (12.4% of TEs well classified to order level).</p>
    <p>TEclass classified the <italic>A. thaliana</italic> dataset well, but despite the number of TEs correctly classified with each of the three test datasets, the percentage of TEs misclassified remained high. TEclass misclassified between 40% and 60% of TEs from the Repbase-diff and Repbase-all datasets, misclassifying more than half of the TEs at order level for these two datasets. This suggests that this tool does not recognize effectively the situations in which it cannot give a correct classification. For interpretation purposes, a lower level of misclassification with more TEs unclassified and requiring manual checking would be preferable. It should also be noted that, in this study, TEclass was at an advantage over the other tools, as we could not train TEclass with a database containing none of the TEs in the test set.</p>
  </sec>
  <sec id="s4">
    <title>Conclusions</title>
    <p>In conclusion, TEclass misclassified TEs more frequently than the other tools for the two largest datasets (more than 50% of TEs for classification to order level). Moreover, the order classification of this tool is highly simplified (only four potential classifications). REPCLASS also has a simplified order classification (only four potential classifications). For these four orders, this tool performs well in conditions in which a homology search is possible (86% of Repbase-atha TEs well classified, with only 3% misclassified, 67% of Repbase-diff TEs well classified, with only 11% misclassified). However for the Repbase-all dataset, for which no homology search was possible, it performed poorly (12% of TEs well classified for 33% misclassified).</p>
    <p>PASTEC was found to have many advantages over the other tools. First, it can classify TEs into no less than nine orders, according to Wicker's classification (versus only four for TEclass and REPCLASS). It performs well for classification into these nine orders, particularly for the dataset for which blast homology searches were not possible, due to the possibility of carrying out HMM profile searches (22% of TEs are well classified and only 16% are misclassified). This is particularly useful when looking at a species phylogenetically distant from the species from which the known TEs were obtained. It performed well for the Repbase-diff dataset, which simulates a standard dataset: 51% of TEs were well classified and 11% were misclassified for classification to order level (for the nine available orders). If we consider only the four REPCLASS levels of classification, PASTEC classified 59% of TEs well and misclassified only 3% of TEs. In the same conditions, REPCLASS classified 67% of TEs correctly and misclassified 11% of TEs (almost four times more than PASTEC).</p>
    <p>A second advantage of PASTEC is its output format. We paid particular attention in the development of this tool to the generation of a file readable by humans, containing all the information required for manual curation by a biologist. Furthermore, PASTEC highlights the TEs for which manual curation is particularly necessary, by specifying whether the classification was ambiguous.</p>
    <p>Finally, PASTEC's modular architecture makes it possible to add new analyses or decision rules without difficulty. Expert users can access a configuration file, to change diverse parameters.</p>
    <p>The main perspective for improving PASTEC concerns classification to the superfamily level, not only through blast searches, but also on the basis of the HMM profiles detected in the TEs. <ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/Tools/REPET">http://urgi.versailles.inra.fr/Tools/REPET</ext-link>
</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0091929.s001">
      <label>Figure S1</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for class I TEs.</bold> The number of well classified class I TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s002">
      <label>Figure S2</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for class II TEs.</bold> The number of well classified class II TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s003">
      <label>Figure S3</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for LINE/SINE TEs.</bold> The number of well classified LINE/SINE TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s004">
      <label>Figure S4</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for helitron TEs.</bold> The number of well classified helitron TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools. Note: TECLASS does not classify helitron TEs to order level.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s005">
      <label>Figure S5</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for LTR TEs.</bold> The number of well classified LTR TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s006">
      <label>Figure S6</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for TIR TEs.</bold> The number of well classified TIR TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools. Note: TECLASS does not classify TIR TEs to order level.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s007">
      <label>Table S1</label>
      <caption>
        <p><bold>An example of PASTEC output.</bold> We present two TEs: the first is classified as a LTR and the second is a potentially chimeric TE (chimera between a helitron and LARD). The output is a tabular file providing the maximum amount of information to facilitate interpretation by biologists.</p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0091929.s007.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s008">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for ClassI and ClassII TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s009">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for LINE/SINE TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s009.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s010">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for helitrons TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s010.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s011">
      <label>Table S5</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for LTR TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s011.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s012">
      <label>Table S6</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for TIR TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s012.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the REPET team for their support in software development, and Joelle Amselem, Nathalie Choisne and Florian Maumus, for user feedback. We also thank Aurélie Kapusta for her help with REPCLASS and the reviewers for their helpful comments.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0091929-Wicker1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wicker</surname><given-names>T</given-names></name>, <name><surname>Sabot</surname><given-names>F</given-names></name>, <name><surname>Hua-Van</surname><given-names>A</given-names></name>, <name><surname>Bennetzen</surname><given-names>JL</given-names></name>, <name><surname>Capy</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>A unified classification system for eukaryotic transposable elements</article-title>. <source>Nature Rev. Genet</source>
<volume>8</volume>: <fpage>973</fpage>–<lpage>982</lpage>.<pub-id pub-id-type="pmid">17984973</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Permal1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Permal</surname><given-names>E</given-names></name>, <name><surname>Flutre</surname><given-names>T</given-names></name>, <name><surname>Quesneville</surname><given-names>H</given-names></name> (<year>2012</year>) <article-title>Roadmap for annotating transposable elements in eukaryote genomes</article-title>. <source>Methods Mol. Biol</source>
<volume>859</volume>: <fpage>53</fpage>–<lpage>68</lpage>.<pub-id pub-id-type="pmid">22367865</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Bergman1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Bergman</surname><given-names>CM</given-names></name>, <name><surname>Quesneville</surname><given-names>H</given-names></name> (<year>2007</year>) <article-title>Discovering and detecting transposable elements in genome sequences</article-title>. <source>Brief. Bioinform</source>
<volume>8</volume>: <fpage>382</fpage>–<lpage>392</lpage>.<pub-id pub-id-type="pmid">17932080</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Abrusn1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Abrusán</surname><given-names>G</given-names></name>, <name><surname>Grundmann</surname><given-names>N</given-names></name>, <name><surname>DeMeester</surname><given-names>L</given-names></name>, <name><surname>Makalowski</surname><given-names>W</given-names></name> (<year>2009</year>) <article-title>TEclass: a tool for automated classification of unknown eukaryotic transposable elements</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>1329</fpage>–<lpage>1330</lpage>.<pub-id pub-id-type="pmid">19349283</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Feschotte1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Feschotte</surname><given-names>C</given-names></name>, <name><surname>Keswani</surname><given-names>U</given-names></name>, <name><surname>Ranganathan</surname><given-names>N</given-names></name>, <name><surname>Guibotsy</surname><given-names>ML</given-names></name>, <name><surname>Levine</surname><given-names>D</given-names></name> (<year>2009</year>) <article-title>Exploring Repetitive DNA Landscapes Using REPCLASS, a Tool That Automates the Classification of Transposable Elements in Eukaryotic Genomes</article-title>. <source>Genome Biol. Evol</source>
<volume>1</volume>: <fpage>205</fpage>–<lpage>220</lpage>.<pub-id pub-id-type="pmid">20333191</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Jurka1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Jurka</surname><given-names>J</given-names></name>, <name><surname>Kapitonov</surname><given-names>VV</given-names></name>, <name><surname>Pavlicek</surname><given-names>A</given-names></name>, <name><surname>Klonowski</surname><given-names>P</given-names></name>, <name><surname>Kohany</surname><given-names>O</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Repbase update, a database of eukaryotic repetitive elements</article-title>. <source>Cytogenet. Genome Res</source>
<volume>110</volume>: <fpage>462</fpage>–<lpage>467</lpage>.<pub-id pub-id-type="pmid">16093699</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-FlutreT">
      <label>7</label>
      <mixed-citation publication-type="journal">FlutreT, Duprat E, Feuillet C, Quesneville H (2011) Considering Transposable Element Diversification in De Novo Annotation Approaches. PLoS ONE <volume>6(1)</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0091929-Benson1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Benson</surname><given-names>G</given-names></name> (<year>1999</year>) <article-title>Tandem repeats finder: a program to analyze DNA sequences</article-title>. <source>Nucleic Acids Res</source>
<volume>27(2)</volume>: <fpage>573</fpage>–<lpage>580</lpage>.<pub-id pub-id-type="pmid">9862982</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Eddy1">
      <label>9</label>
      <mixed-citation publication-type="journal">Eddy SR (2011) Accelerated Profile HMM Searches. PLoS Comput. Biol. <volume>7(10)</volume>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4008368</article-id>
    <article-id pub-id-type="pmid">24786468</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-13-40172</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0091929</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Molecular Cell Biology</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Gene Prediction</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Elements</subject>
            <subj-group>
              <subject>Mobile Genetic Elements</subject>
              <subj-group>
                <subject>Transposable Elements</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Structural Genomics</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Gene Identification and Analysis</subject>
            <subject>Molecular Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PASTEC: An Automatic Transposable Element Classification Tool</article-title>
      <alt-title alt-title-type="running-head">A Transposable Element Classification Tool</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hoede</surname>
          <given-names>Claire</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arnoux</surname>
          <given-names>Sandie</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moisset</surname>
          <given-names>Mark</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chaumier</surname>
          <given-names>Timothée</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Inizan</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jamilloux</surname>
          <given-names>Véronique</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quesneville</surname>
          <given-names>Hadi</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>INRA, UR1164 URGI - Research Unit in Genomics-Info, Versailles, France</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>INRA, plateforme Bio-informatique Genotoul, Mathématiques et Informatique Appliquées Toulouse UR875, Castanet-Tolosan, France</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>INRA, LUNAM Université, Oniris, UMR1300 BioEpAR, Nantes, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cordaux</surname>
          <given-names>Richard</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Poitiers, France</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>Hadi.quesneville@versailles.inra.fr</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: CH HQ. Performed the experiments: CH. Analyzed the data: CH HQ. Wrote the paper: CH HQ. Designed the software used in analysis: CH SA TC MM OI VJ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>5</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>5</issue>
    <elocation-id>e91929</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>10</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>2</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Hoede et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Hoede et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Summary</title>
        <p>The classification of transposable elements (TEs) is key step towards deciphering their potential impact on the genome. However, this process is often based on manual sequence inspection by TE experts. With the wealth of genomic sequences now available, this task requires automation, making it accessible to most scientists. We propose a new tool, PASTEC, which classifies TEs by searching for structural features and similarities. This tool outperforms currently available software for TE classification. The main innovation of PASTEC is the search for HMM profiles, which is useful for inferring the classification of unknown TE on the basis of conserved functional domains of the proteins. In addition, PASTEC is the only tool providing an exhaustive spectrum of possible classifications to the order level of the Wicker hierarchical TE classification system. It can also automatically classify other repeated elements, such as SSR (Simple Sequence Repeats), rDNA or potential repeated host genes. Finally, the output of this new tool is designed to facilitate manual curation by providing to biologists with all the evidence accumulated for each TE consensus.</p>
      </sec>
      <sec>
        <title>Availability</title>
        <p>PASTEC is available as a REPET module or standalone software (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/repet/REPET_linux-x64-2.2.tar.gz">http://urgi.versailles.inra.fr/download/repet/REPET_linux-x64-2.2.tar.gz</ext-link>). It requires a Unix-like system. There are two standalone versions: one of which is parallelized (requiring Sun grid Engine or Torque), and the other of which is not.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>Claire Hoede's work was supported by a grant from the French National Research. Agency (ANR-08-KBBE-012-02) attributed to Hadi Quesneville. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Transposable elements account for a high proportion of eukaryotic genomes. They are involved in a number of important processes, including genome rearrangement, heterochromatin formation and the regulation of gene expression. Wicker <italic>et al</italic>. <xref rid="pone.0091929-Wicker1" ref-type="bibr">[1]</xref> published a detailed classification for eukaryotic TEs. Their goals were to harmonize and clarify TE classifications and names. This classification includes both well-known classes of TEs: class I (retrotransposons) and II (DNA transposons). Five orders (LTR, DIRS, PLE, LINE, SINE) are defined for class I, and four (TIR, Crypton, Helitron, Maverick) for class II. Each order is also divided into one or several superfamilies, resulting in 29 superfamilies total. Other categories comprising non-autonomous TEs (LARD, TRIM and MITE) are considered in this classification, together with various forms of non-autonomous entities related to TEs to various degrees. This classification is based on the transposition mechanism, sequence similarities and structural relationships. Wicker <italic>et al</italic>. described the protein-coding domains present in each TE superfamily in particular detail.</p>
    <p>Several computational tools have been proposed for the <italic>ab initio</italic> identification of repeat families (see reviews <xref rid="pone.0091929-Permal1" ref-type="bibr">[2]</xref>; <xref rid="pone.0091929-Bergman1" ref-type="bibr">[3]</xref>). These tools generally reconstruct the consensus sequences of repeated regions. It is then useful to characterize and classify these consensus sequences, to study the TE repertoire of a genome. Two tools for the automatic classification of a large range of TEs have been proposed: TEclass <xref rid="pone.0091929-Abrusn1" ref-type="bibr">[4]</xref> and REPCLASS <xref rid="pone.0091929-Feschotte1" ref-type="bibr">[5]</xref>. TEclass classifies TE sequences only into two classes: Retro (class I in Wicker's classification) and DNA (class II in Wicker's classification). This tool can classify class I elements into LTRs and non-LTRs and, where possible, into SINE or LINE elements. However, TEClass cannot distinguish between the various orders of class II elements. The SVM (Support Vector Machine: supervised learning model) classifiers in this tool were trained with RepBase Update, a database of eukaryotic repetitive sequences <xref rid="pone.0091929-Jurka1" ref-type="bibr">[6]</xref>, using different class lengths and vectors of tetramer and pentamer frequencies. This approach is useful when TEs show no clear similarity to known repeats.</p>
    <p>REPCLASS can classify TEs into classes I and II, and into the orders LTR retrotransposon (grouping LTR, LARD, TRIM, DIRS and PLE from Wicker's classification), DNA transposon (grouping TIR, crypton and Polinton from Wicker's classification), LINE/SINE and helitron. In some cases, this tool can also identify the superfamily of the TE. REPCLASS consists of three modules. The first is based on homology and has the greatest impact on final decision. At this step, the software carries out a tblastx analysis against the RepBase databank. The second module (in terms of order of priority for classification) searches for structural characteristics: terminal repeats, such as LTRs and TIRs, tRNA, polyA signals and SSR. Finally, the third module searches for target site duplication (TSD) around TE copies within the genome.</p>
    <p>Neither TEclass nor REPCLASS can classify TEs at the level of detail given by Wicker's classification (see <xref ref-type="table" rid="pone-0091929-t001">Table 1</xref>). We therefore developed PASTEC (Pseudo Agent System for Transposable Element Classification), a modular tool able to classify TEs automatically to order level, for all nine orders of autonomous TEs defined in Wicker's classification plus three orders of non-autonomous TEs (LARD, TRIM and MITE). If PASTEC cannot classify a TE to order level, it classifies it to class level. PASTEC is also designed to filter out false-positive repeated sequences identified by <italic>de novo</italic> approaches. It can therefore distinguish SSRs, rDNA sequences and potential host genes from real TEs. Moreover, PASTEC can classify and recognize incomplete TEs and potentially chimeric TEs (detection of an anomaly in the evidence used to select the classification, or several classifications possible). In this last case, PASTEC chooses the best classification if it has sufficient evidence to make a decision. All evidence is written to the output file, to facilitate the manual curation of potential chimeric TEs. We tested this tool by comparing the results of these three tools on three different datasets.</p>
    <table-wrap id="pone-0091929-t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Comparison of the classifications obtained with the PASTEC, TEClass and RepClass tools.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t001-1" xlink:href="pone.0091929.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">PASTEC (Wicker's) Class</td>
              <td align="left" rowspan="1" colspan="1">PASTEC (Wicker's) Order</td>
              <td align="left" rowspan="1" colspan="1">TEClass Class</td>
              <td align="left" rowspan="1" colspan="1">TEClass Order</td>
              <td align="left" rowspan="1" colspan="1">RepClass Class</td>
              <td align="left" rowspan="1" colspan="1">RepClass Order</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Class I (Retrotransposons)</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">DIRS</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">PLE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LARD*</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">TRIM*</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LINE/SINE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">SINE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">SINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LINE/SINE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Class II (DNA transposons)</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">TIR</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">MITE*</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Crypton</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Helitron</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">Helitron</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Maverick</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt101">
          <label/>
          <p>Notes: (*) Non-autonomous element. <italic>na</italic>: not considered by the tool.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <p>PASTEC was developed in the REPET package <xref rid="pone.0091929-FlutreT" ref-type="bibr">[7]</xref>. In this context, we used PASTEC to classify the consensus TE sequences found <italic>de novo</italic> in a genome. PASTEC uses several features of TEs to classify TE consensus sequences. It searches for structural evidence and sequence similarities stored in a MySQL database obtained during a preprocessing step. The structural features considered are TE length, presence of a LTR (long terminal repeat) or TIR (terminal inverted repeat) detected with a custom-built tool (with a minimum length of 10 bp, a minimum identity of 80%, the taking into account of reciprocal orientations of terminal repeats and a maximal length of 7000 bp), the presence of SSRs (simple sequence repeats detected with the tandem repeat finder (TRF) tool <xref rid="pone.0091929-Benson1" ref-type="bibr">[8]</xref>), the polyA tail and an ORF (open reading frame). The blastx and tblastx routines are used to search for similarities to known TEs in Repbase Update, and the hmmer3 package <xref rid="pone.0091929-Eddy1" ref-type="bibr">[9]</xref> to search against a HMM profile databases (TE-specific or not), after translation in all six frames. Sequence similarities are also identified by blastn searches against known rDNA sequences, known host genes and known helitron ends. The databanks used are preprocessed and formatted. The Repbase Update for PASTEC can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.girinst.org/repbase/index.html">http://www.girinst.org/repbase/index.html</ext-link>, whereas the HMM profile databank formatted for PASTEC is available from the REPET download directory (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/repet/">http://urgi.versailles.inra.fr/download/repet/</ext-link>).</p>
    <p>PASTEC classifies TEs by testing all classifications from Wicker's hierarchical TE classification system. Each possible classification is weighted according to the available evidence, with respect to the classification considered. TEs are currently classified to class and order level. PASTEC can also determine whether a TE is complete on the basis of four criteria: sequence coverage for known TEs, profile coverage, presence of terminal repeats for certain classes, presence of a polyA or SSR tail for LINEs and SINEs, and the length of the TEs with respect to expectations for the class concerned.</p>
    <p>We designed PASTEC as a modular multi-agent classifier. The system is composed of four types of agents: retrievers, classifiers, filter agents, and a super-agent (<xref ref-type="fig" rid="pone-0091929-g001">Figure 1</xref>). The retriever agents retrieve the pre-computed analysis results stored in the MySQL database. They act on the requests of the classifier or filter agents, filtering, formatting and supplying the results. The classifier and filter agents are specialized to recognize a particular category. For example, the LTR agent can determine only whether the TE is a LTR or not. The classifier and filter agents act on the request of the super-agent, deciding whether they can classify the TE or not. For example, the LTR agent decides whether the consensus TE is a LTR on the basis of the following evidence: presence of the ENV (envelope protein) profile (a condition sufficient for classification), the presence of INT (integrase), RT (reverse transcriptase), GAG (capsid protein), AP (aspartate proteinase) and RH (RNase H) profiles together with the detection of a LTR (long terminal repeat), a blast match with the sequence of a known LTR retrotransposon. The super-agent resolves classification conflicts and formats the output file. It resolves conflicts by using a confidence index normalized to 100. For example, the LTR agent calculates a confidence index with the following rules: presence of ENV profiles (+2 because this condition is sufficient for classification), presence of a long terminal repeat and an INT, GAG, RT, RH or AP profile (+1 for each profile combined with the long terminal repeat), +1 for each profile (ENV, AP, RT, RH and GAG) found in the same frame in the same ORF. If the consensus matches at least one known LTR retrotransposon, the LTR agent adds +2 for each type of blast (blastx or tblastx) at the confidence index. Finally, the length of the TE is taken into account because we add +1 if the TE without the long terminal repeat is between 4000 and 15000 bp in length, and we decrease the confidence index by 1 if the TE without the long terminal repeat is less than 1000 bp or more than 15000 bp long. The super-agent uses the maximum confidence index defined for each classifier agent to normalize the confidence index for each classification to 100 and then compare the different classifications. Advanced users can edit all decisions rules and maximum confidence indices in the Decision_rules.yaml file.</p>
    <fig id="pone-0091929-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Agents implemented in the system.</title>
        <p>Orange agents are retriever agents, blue agents are classifier and filter agents. The super-agent is shown in green. The arrows indicate the principal communications between the different agents, with only requests shown.</p>
      </caption>
      <graphic xlink:href="pone.0091929.g001"/>
    </fig>
    <p>The output can be read by humans and is biologist-friendly. A single line specifies the name of the TE, its length, status, class, order, completeness, confidence index and all the features characterizing it. A status of “potential chimeric” or “OK” is assigned to the TE. If the TE is not considered to be “OK” then users must apply their own expertise. A TE is declared “potential chimeric” when at least two classifications are possible. In this case, PASTEC chooses the best status based on the available evidence, or does not classify the TE if no decision is possible. In this last case, all possible classifications are given (separated by a pipe symbol “|”). We present an example of PASTEC output in <xref ref-type="supplementary-material" rid="pone.0091929.s007">table S1</xref>. PASTEC output is a tabular file, with the columns from left to right indicating the name of the TE, its length, the orientation of the sequence, chimeric/non-chimeric status (OK indicating that the element is not potentially chimeric), class (class I in this case), order. In the first line of the example provided, the TE is a LTR. We presume that the element is complete because we have no evidence to suggest that it is incomplete, and the confidence index is 71/100. The last column summarizes all the evidence found: coding sequence evidence, such as the results of tblastX queries against the Repbase database (TE_BLRtx evidence), blastX queries against the Repbase database (TE_BLRx evidence) and profiles. A blast match is taken account if coverage exceeds 5%, and a profile is taken into account if its coverage exceeds 20% (these parameters can be edited in the configuration file). For each item of coding sequence evidence, the coverage of the subject is specified. The structural evidence is also detailed: &gt;4000 bp indicates that TE length without terminal repeats is between 4000 and 15000 bp, the next item of information presented in the comments columns is the presence of terminal repeats: we have a LTR in this case, with an LTR length of 433 bp; two long ORFs have been identified, the last of which contains four profiles in the same frame and is up to 3000 bp long. Other evidence provided for this example includes the partial match with a <italic>Drosophila melanogaster</italic> gene (coverage 16.55% and the TE contains 18% SSRs). The super-agent determines whether a TE is complete based on whether it is sufficiently long, whether the expected terminal repeats or polyA tail are present, whether blast match coverage exceeds 30% and profile coverage exceeds 75%. The second line of the example corresponds to a potentially chimeric TE, for which human expertise is required.</p>
  </sec>
  <sec id="s3">
    <title>Results and Discussion</title>
    <p>We compared the results of PASTEC with those of the two other classification tools, REPCLASS and TEclass, for three datasets: (i) the <italic>A. thaliana</italic> consensuses found in Repbase update version 15.09 (referred to hereafter as Repbase-atha), (ii) the TEs present in Repbase update 15.09 but not in Repbase 13.07 (referred to hereafter as Repbase-diff), and (iii) the whole Repbase update 15.09 from which we removed redundant TEs, i.e., those with strictly identical sequences (referred to hereafter as Repbase-all). For RepClass and PASTEC, which require a database for blast analyses, we used RepBase update 15.09 from which we removed the <italic>A. thaliana</italic> TEs in the first case, RepBase 13.07 in the second case and no blast database in the last case. The second case (Repbase-diff) mimics standard use: we wanted to classify TEs obtained from a new genome and, therefore, not yet known in the Repbase database. Indeed, Repbase-diff contains the TEs present in Repbase Update 15.09, but not in Repbase Update 13.07, and we provided Repbase Update 13.07 for sequence similarity searches by REPCLASS and PASTEC. So, as is usually the case in such analyses, we have unknown TEs (Repbase-diff) and a database of known TEs (Repbase Update 13.07). This made it possible to check whether the classification results for Repbase-diff were consistent with the classification given in Repbase Update 15.09. The last case is the most difficult, with attempts to classify TEs as if no known TEs are present in the database.</p>
    <p>We compared the classification performance, in terms of the percentages of TEs well classified, misclassified relative to their annotation in the Repbase database or not classified at the level of class (<xref ref-type="table" rid="pone-0091929-t002">Table 2</xref>) or order (<xref ref-type="table" rid="pone-0091929-t003">Table 3</xref>), for each of the three tools. It was not possible to compare sensitivity and specificity for each order, because the three tools do not use the same classification. Nevertheless, sensitivity and specificity data are presented in the supplementary data for the orders for which this was possible. We mapped the PASTEC classification onto those used by TEclass or REPCLASS, to improve comparisons. <xref ref-type="table" rid="pone-0091929-t003">Table 3</xref> shows the performances obtained with PASTEC after mapping.</p>
    <table-wrap id="pone-0091929-t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Comparison of the performances of PASTEC, REPCLASS, and TECLASS for classification into TE classes.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t002-2" xlink:href="pone.0091929.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset (sequence <sup>#</sup>)</td>
              <td align="left" rowspan="1" colspan="1">Performance</td>
              <td align="left" rowspan="1" colspan="1">PASTEC</td>
              <td align="left" rowspan="1" colspan="1">REPCLASS</td>
              <td align="left" rowspan="1" colspan="1">TECLASS</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-atha (318)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">80.7</td>
              <td align="left" rowspan="1" colspan="1">83.6</td>
              <td align="left" rowspan="1" colspan="1">98.4</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>0.95</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.5</td>
              <td align="left" rowspan="1" colspan="1">1.3</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">12.9</td>
              <td align="left" rowspan="1" colspan="1">0.3</td>
            </tr>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-diff (5546)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">63.7</td>
              <td align="left" rowspan="1" colspan="1">26.1</td>
              <td align="left" rowspan="1" colspan="1">59.2</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">31.8</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>40.2</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">42.1</td>
              <td align="left" rowspan="1" colspan="1">0.5</td>
            </tr>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-all (9665)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">52.7</td>
              <td align="left" rowspan="1" colspan="1">20.35</td>
              <td align="left" rowspan="1" colspan="1">53.8</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>5.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">27.09</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>45.8</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">41.3</td>
              <td align="left" rowspan="1" colspan="1">52.6</td>
              <td align="left" rowspan="1" colspan="1">0.3</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <table-wrap id="pone-0091929-t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Comparison of the performances of PASTEC, REPCLASS, and TECLASS for classification to TE order level.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t003-3" xlink:href="pone.0091929.t003"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset (sequence <sup>#</sup>)</td>
              <td align="left" rowspan="1" colspan="1">Performance</td>
              <td align="left" rowspan="1" colspan="1">PASTEC</td>
              <td align="left" rowspan="1" colspan="1">PASTEC mapped to REPCLASS order (1)</td>
              <td align="left" rowspan="1" colspan="1">PASTEC mapped to TECLASS order (2)</td>
              <td align="left" rowspan="1" colspan="1">REPCLASS (3)</td>
              <td align="left" rowspan="1" colspan="1">TECLASS (4)</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-atha (318)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">71.4</td>
              <td align="left" rowspan="1" colspan="1">79.7</td>
              <td align="left" rowspan="1" colspan="1">93.7</td>
              <td align="left" rowspan="1" colspan="1">85.5</td>
              <td align="left" rowspan="1" colspan="1">97.5</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>10.2</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>1.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.5</td>
              <td align="left" rowspan="1" colspan="1">2.8</td>
              <td align="left" rowspan="1" colspan="1">1.9</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">3.8</td>
              <td align="left" rowspan="1" colspan="1">11.6</td>
              <td align="left" rowspan="1" colspan="1">0.6</td>
            </tr>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-diff (5546)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">51.3</td>
              <td align="left" rowspan="1" colspan="1">59.1</td>
              <td align="left" rowspan="1" colspan="1">49.7</td>
              <td align="left" rowspan="1" colspan="1">66.9</td>
              <td align="left" rowspan="1" colspan="1">47.7</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>10.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.1</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.5</td>
              <td align="left" rowspan="1" colspan="1">11.1</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>50.3</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">46.8</td>
              <td align="left" rowspan="1" colspan="1">17.6</td>
              <td align="left" rowspan="1" colspan="1">1.9</td>
            </tr>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-all (9665)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">22.4</td>
              <td align="left" rowspan="1" colspan="1">31.9</td>
              <td align="left" rowspan="1" colspan="1">8.6</td>
              <td align="left" rowspan="1" colspan="1">12.4</td>
              <td align="left" rowspan="1" colspan="1">40</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>15.8</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>6.2</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">6.7</td>
              <td align="left" rowspan="1" colspan="1">33.3</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>59.7</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">61.8</td>
              <td align="left" rowspan="1" colspan="1">61.8</td>
              <td align="left" rowspan="1" colspan="1">84.7</td>
              <td align="left" rowspan="1" colspan="1">50.84</td>
              <td align="left" rowspan="1" colspan="1">0.25</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt102">
          <label/>
          <p>Note that the classification differs between the three tools. We therefore mapped the PASTEC classification results onto those for REPCLASS (1) and TECLASS (2). (2) Mapped onto TECLASS class I orders only. (3) order considered are: DNA transposon, LTR retrotransposon, helitron, non LTR retrotransposon. (4) order considered are only LTR, LINE/SINE.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>PASTEC misclassified very few TEs, regardless of the dataset tested (<xref ref-type="table" rid="pone-0091929-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0091929-t003">3</xref>). These rare ambiguities mostly concerned closely related TEs: essentially MITE/TIR (427/605 −70.6% - TEs misclassified at order level in the Repbase subtraction dataset). For Repbase-diff, PASTEC was frequently more specific than the other two tools (see suppl. Data: Venn diagram and table of sensitivity and specificity of the three tools for this second dataset <xref ref-type="supplementary-material" rid="pone.0091929.s008">Tables S2</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s009">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s010">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s011">S5</xref>
<xref ref-type="supplementary-material" rid="pone.0091929.s012">S6</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s001">Figures S1</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s002">S2</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s003">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s004">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s005">S5</xref>
<xref ref-type="supplementary-material" rid="pone.0091929.s006">S6</xref>). However, it failed to classify many TEs due to a lack of useful evidence. PASTEC HMM profile detection was found to be particularly useful if the database contained no similar TE to that for which the search was carried out. For Repbase-all without blast searches, we had profile information for 3488 TEs, making it possible to classify these elements at least partially. For classification to order level, PASTEC gave better results than REPCLASS. PASTEC correctly classified more TEs than REPCLASS for the Repbase-all library (31.9% of the TEs were well classified by PASTEC on the basis of REPCLASS order, whereas REPCLASS classified only 12.4% of TEs well, and PASTEC misclassified fewer TEs for all datasets (see <xref ref-type="table" rid="pone-0091929-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0091929-t003">3</xref>).</p>
    <p>REPCLASS performed well on the Repbase-atha dataset, particularly for helitrons, thanks to its helitron_scan tool, if no TSDs were found. It was efficient, but required the genome sequence. This tool searches for 5′ and 3′ termini, including the flanking sequences of all copies found in the genome, and a subterminal hairpin-like GC-rich motif. For the other datasets, we provided no genome sequence because the TEs came from many different genomes. In such conditions, the TSD module of REPCLASS cannot be used, but good results were nevertheless obtained with this tool for the Repbase-diff dataset (67% of TEs well classified to order level, see <xref ref-type="table" rid="pone-0091929-t003">Table 3</xref>). For this dataset, REPCLASS was more sensitive (83.6% <italic>vs</italic> 52.7%) but less specific (89.7% <italic>vs</italic> 99.9%) than PASTEC for classification to order level. By contrast, for the Repbase-all dataset (without blast homology searches), this tool gave the worst results (12.4% of TEs well classified to order level).</p>
    <p>TEclass classified the <italic>A. thaliana</italic> dataset well, but despite the number of TEs correctly classified with each of the three test datasets, the percentage of TEs misclassified remained high. TEclass misclassified between 40% and 60% of TEs from the Repbase-diff and Repbase-all datasets, misclassifying more than half of the TEs at order level for these two datasets. This suggests that this tool does not recognize effectively the situations in which it cannot give a correct classification. For interpretation purposes, a lower level of misclassification with more TEs unclassified and requiring manual checking would be preferable. It should also be noted that, in this study, TEclass was at an advantage over the other tools, as we could not train TEclass with a database containing none of the TEs in the test set.</p>
  </sec>
  <sec id="s4">
    <title>Conclusions</title>
    <p>In conclusion, TEclass misclassified TEs more frequently than the other tools for the two largest datasets (more than 50% of TEs for classification to order level). Moreover, the order classification of this tool is highly simplified (only four potential classifications). REPCLASS also has a simplified order classification (only four potential classifications). For these four orders, this tool performs well in conditions in which a homology search is possible (86% of Repbase-atha TEs well classified, with only 3% misclassified, 67% of Repbase-diff TEs well classified, with only 11% misclassified). However for the Repbase-all dataset, for which no homology search was possible, it performed poorly (12% of TEs well classified for 33% misclassified).</p>
    <p>PASTEC was found to have many advantages over the other tools. First, it can classify TEs into no less than nine orders, according to Wicker's classification (versus only four for TEclass and REPCLASS). It performs well for classification into these nine orders, particularly for the dataset for which blast homology searches were not possible, due to the possibility of carrying out HMM profile searches (22% of TEs are well classified and only 16% are misclassified). This is particularly useful when looking at a species phylogenetically distant from the species from which the known TEs were obtained. It performed well for the Repbase-diff dataset, which simulates a standard dataset: 51% of TEs were well classified and 11% were misclassified for classification to order level (for the nine available orders). If we consider only the four REPCLASS levels of classification, PASTEC classified 59% of TEs well and misclassified only 3% of TEs. In the same conditions, REPCLASS classified 67% of TEs correctly and misclassified 11% of TEs (almost four times more than PASTEC).</p>
    <p>A second advantage of PASTEC is its output format. We paid particular attention in the development of this tool to the generation of a file readable by humans, containing all the information required for manual curation by a biologist. Furthermore, PASTEC highlights the TEs for which manual curation is particularly necessary, by specifying whether the classification was ambiguous.</p>
    <p>Finally, PASTEC's modular architecture makes it possible to add new analyses or decision rules without difficulty. Expert users can access a configuration file, to change diverse parameters.</p>
    <p>The main perspective for improving PASTEC concerns classification to the superfamily level, not only through blast searches, but also on the basis of the HMM profiles detected in the TEs. <ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/Tools/REPET">http://urgi.versailles.inra.fr/Tools/REPET</ext-link>
</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0091929.s001">
      <label>Figure S1</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for class I TEs.</bold> The number of well classified class I TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s002">
      <label>Figure S2</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for class II TEs.</bold> The number of well classified class II TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s003">
      <label>Figure S3</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for LINE/SINE TEs.</bold> The number of well classified LINE/SINE TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s004">
      <label>Figure S4</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for helitron TEs.</bold> The number of well classified helitron TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools. Note: TECLASS does not classify helitron TEs to order level.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s005">
      <label>Figure S5</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for LTR TEs.</bold> The number of well classified LTR TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s006">
      <label>Figure S6</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for TIR TEs.</bold> The number of well classified TIR TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools. Note: TECLASS does not classify TIR TEs to order level.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s007">
      <label>Table S1</label>
      <caption>
        <p><bold>An example of PASTEC output.</bold> We present two TEs: the first is classified as a LTR and the second is a potentially chimeric TE (chimera between a helitron and LARD). The output is a tabular file providing the maximum amount of information to facilitate interpretation by biologists.</p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0091929.s007.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s008">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for ClassI and ClassII TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s009">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for LINE/SINE TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s009.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s010">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for helitrons TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s010.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s011">
      <label>Table S5</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for LTR TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s011.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s012">
      <label>Table S6</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for TIR TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s012.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the REPET team for their support in software development, and Joelle Amselem, Nathalie Choisne and Florian Maumus, for user feedback. We also thank Aurélie Kapusta for her help with REPCLASS and the reviewers for their helpful comments.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0091929-Wicker1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wicker</surname><given-names>T</given-names></name>, <name><surname>Sabot</surname><given-names>F</given-names></name>, <name><surname>Hua-Van</surname><given-names>A</given-names></name>, <name><surname>Bennetzen</surname><given-names>JL</given-names></name>, <name><surname>Capy</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>A unified classification system for eukaryotic transposable elements</article-title>. <source>Nature Rev. Genet</source>
<volume>8</volume>: <fpage>973</fpage>–<lpage>982</lpage>.<pub-id pub-id-type="pmid">17984973</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Permal1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Permal</surname><given-names>E</given-names></name>, <name><surname>Flutre</surname><given-names>T</given-names></name>, <name><surname>Quesneville</surname><given-names>H</given-names></name> (<year>2012</year>) <article-title>Roadmap for annotating transposable elements in eukaryote genomes</article-title>. <source>Methods Mol. Biol</source>
<volume>859</volume>: <fpage>53</fpage>–<lpage>68</lpage>.<pub-id pub-id-type="pmid">22367865</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Bergman1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Bergman</surname><given-names>CM</given-names></name>, <name><surname>Quesneville</surname><given-names>H</given-names></name> (<year>2007</year>) <article-title>Discovering and detecting transposable elements in genome sequences</article-title>. <source>Brief. Bioinform</source>
<volume>8</volume>: <fpage>382</fpage>–<lpage>392</lpage>.<pub-id pub-id-type="pmid">17932080</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Abrusn1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Abrusán</surname><given-names>G</given-names></name>, <name><surname>Grundmann</surname><given-names>N</given-names></name>, <name><surname>DeMeester</surname><given-names>L</given-names></name>, <name><surname>Makalowski</surname><given-names>W</given-names></name> (<year>2009</year>) <article-title>TEclass: a tool for automated classification of unknown eukaryotic transposable elements</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>1329</fpage>–<lpage>1330</lpage>.<pub-id pub-id-type="pmid">19349283</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Feschotte1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Feschotte</surname><given-names>C</given-names></name>, <name><surname>Keswani</surname><given-names>U</given-names></name>, <name><surname>Ranganathan</surname><given-names>N</given-names></name>, <name><surname>Guibotsy</surname><given-names>ML</given-names></name>, <name><surname>Levine</surname><given-names>D</given-names></name> (<year>2009</year>) <article-title>Exploring Repetitive DNA Landscapes Using REPCLASS, a Tool That Automates the Classification of Transposable Elements in Eukaryotic Genomes</article-title>. <source>Genome Biol. Evol</source>
<volume>1</volume>: <fpage>205</fpage>–<lpage>220</lpage>.<pub-id pub-id-type="pmid">20333191</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Jurka1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Jurka</surname><given-names>J</given-names></name>, <name><surname>Kapitonov</surname><given-names>VV</given-names></name>, <name><surname>Pavlicek</surname><given-names>A</given-names></name>, <name><surname>Klonowski</surname><given-names>P</given-names></name>, <name><surname>Kohany</surname><given-names>O</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Repbase update, a database of eukaryotic repetitive elements</article-title>. <source>Cytogenet. Genome Res</source>
<volume>110</volume>: <fpage>462</fpage>–<lpage>467</lpage>.<pub-id pub-id-type="pmid">16093699</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-FlutreT">
      <label>7</label>
      <mixed-citation publication-type="journal">FlutreT, Duprat E, Feuillet C, Quesneville H (2011) Considering Transposable Element Diversification in De Novo Annotation Approaches. PLoS ONE <volume>6(1)</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0091929-Benson1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Benson</surname><given-names>G</given-names></name> (<year>1999</year>) <article-title>Tandem repeats finder: a program to analyze DNA sequences</article-title>. <source>Nucleic Acids Res</source>
<volume>27(2)</volume>: <fpage>573</fpage>–<lpage>580</lpage>.<pub-id pub-id-type="pmid">9862982</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Eddy1">
      <label>9</label>
      <mixed-citation publication-type="journal">Eddy SR (2011) Accelerated Profile HMM Searches. PLoS Comput. Biol. <volume>7(10)</volume>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4008368</article-id>
    <article-id pub-id-type="pmid">24786468</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-13-40172</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0091929</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Molecular Cell Biology</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Gene Prediction</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Elements</subject>
            <subj-group>
              <subject>Mobile Genetic Elements</subject>
              <subj-group>
                <subject>Transposable Elements</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Structural Genomics</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Gene Identification and Analysis</subject>
            <subject>Molecular Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PASTEC: An Automatic Transposable Element Classification Tool</article-title>
      <alt-title alt-title-type="running-head">A Transposable Element Classification Tool</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hoede</surname>
          <given-names>Claire</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arnoux</surname>
          <given-names>Sandie</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moisset</surname>
          <given-names>Mark</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chaumier</surname>
          <given-names>Timothée</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Inizan</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jamilloux</surname>
          <given-names>Véronique</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quesneville</surname>
          <given-names>Hadi</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>INRA, UR1164 URGI - Research Unit in Genomics-Info, Versailles, France</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>INRA, plateforme Bio-informatique Genotoul, Mathématiques et Informatique Appliquées Toulouse UR875, Castanet-Tolosan, France</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>INRA, LUNAM Université, Oniris, UMR1300 BioEpAR, Nantes, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cordaux</surname>
          <given-names>Richard</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Poitiers, France</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>Hadi.quesneville@versailles.inra.fr</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: CH HQ. Performed the experiments: CH. Analyzed the data: CH HQ. Wrote the paper: CH HQ. Designed the software used in analysis: CH SA TC MM OI VJ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>5</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>5</issue>
    <elocation-id>e91929</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>10</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>2</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Hoede et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Hoede et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Summary</title>
        <p>The classification of transposable elements (TEs) is key step towards deciphering their potential impact on the genome. However, this process is often based on manual sequence inspection by TE experts. With the wealth of genomic sequences now available, this task requires automation, making it accessible to most scientists. We propose a new tool, PASTEC, which classifies TEs by searching for structural features and similarities. This tool outperforms currently available software for TE classification. The main innovation of PASTEC is the search for HMM profiles, which is useful for inferring the classification of unknown TE on the basis of conserved functional domains of the proteins. In addition, PASTEC is the only tool providing an exhaustive spectrum of possible classifications to the order level of the Wicker hierarchical TE classification system. It can also automatically classify other repeated elements, such as SSR (Simple Sequence Repeats), rDNA or potential repeated host genes. Finally, the output of this new tool is designed to facilitate manual curation by providing to biologists with all the evidence accumulated for each TE consensus.</p>
      </sec>
      <sec>
        <title>Availability</title>
        <p>PASTEC is available as a REPET module or standalone software (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/repet/REPET_linux-x64-2.2.tar.gz">http://urgi.versailles.inra.fr/download/repet/REPET_linux-x64-2.2.tar.gz</ext-link>). It requires a Unix-like system. There are two standalone versions: one of which is parallelized (requiring Sun grid Engine or Torque), and the other of which is not.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>Claire Hoede's work was supported by a grant from the French National Research. Agency (ANR-08-KBBE-012-02) attributed to Hadi Quesneville. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Transposable elements account for a high proportion of eukaryotic genomes. They are involved in a number of important processes, including genome rearrangement, heterochromatin formation and the regulation of gene expression. Wicker <italic>et al</italic>. <xref rid="pone.0091929-Wicker1" ref-type="bibr">[1]</xref> published a detailed classification for eukaryotic TEs. Their goals were to harmonize and clarify TE classifications and names. This classification includes both well-known classes of TEs: class I (retrotransposons) and II (DNA transposons). Five orders (LTR, DIRS, PLE, LINE, SINE) are defined for class I, and four (TIR, Crypton, Helitron, Maverick) for class II. Each order is also divided into one or several superfamilies, resulting in 29 superfamilies total. Other categories comprising non-autonomous TEs (LARD, TRIM and MITE) are considered in this classification, together with various forms of non-autonomous entities related to TEs to various degrees. This classification is based on the transposition mechanism, sequence similarities and structural relationships. Wicker <italic>et al</italic>. described the protein-coding domains present in each TE superfamily in particular detail.</p>
    <p>Several computational tools have been proposed for the <italic>ab initio</italic> identification of repeat families (see reviews <xref rid="pone.0091929-Permal1" ref-type="bibr">[2]</xref>; <xref rid="pone.0091929-Bergman1" ref-type="bibr">[3]</xref>). These tools generally reconstruct the consensus sequences of repeated regions. It is then useful to characterize and classify these consensus sequences, to study the TE repertoire of a genome. Two tools for the automatic classification of a large range of TEs have been proposed: TEclass <xref rid="pone.0091929-Abrusn1" ref-type="bibr">[4]</xref> and REPCLASS <xref rid="pone.0091929-Feschotte1" ref-type="bibr">[5]</xref>. TEclass classifies TE sequences only into two classes: Retro (class I in Wicker's classification) and DNA (class II in Wicker's classification). This tool can classify class I elements into LTRs and non-LTRs and, where possible, into SINE or LINE elements. However, TEClass cannot distinguish between the various orders of class II elements. The SVM (Support Vector Machine: supervised learning model) classifiers in this tool were trained with RepBase Update, a database of eukaryotic repetitive sequences <xref rid="pone.0091929-Jurka1" ref-type="bibr">[6]</xref>, using different class lengths and vectors of tetramer and pentamer frequencies. This approach is useful when TEs show no clear similarity to known repeats.</p>
    <p>REPCLASS can classify TEs into classes I and II, and into the orders LTR retrotransposon (grouping LTR, LARD, TRIM, DIRS and PLE from Wicker's classification), DNA transposon (grouping TIR, crypton and Polinton from Wicker's classification), LINE/SINE and helitron. In some cases, this tool can also identify the superfamily of the TE. REPCLASS consists of three modules. The first is based on homology and has the greatest impact on final decision. At this step, the software carries out a tblastx analysis against the RepBase databank. The second module (in terms of order of priority for classification) searches for structural characteristics: terminal repeats, such as LTRs and TIRs, tRNA, polyA signals and SSR. Finally, the third module searches for target site duplication (TSD) around TE copies within the genome.</p>
    <p>Neither TEclass nor REPCLASS can classify TEs at the level of detail given by Wicker's classification (see <xref ref-type="table" rid="pone-0091929-t001">Table 1</xref>). We therefore developed PASTEC (Pseudo Agent System for Transposable Element Classification), a modular tool able to classify TEs automatically to order level, for all nine orders of autonomous TEs defined in Wicker's classification plus three orders of non-autonomous TEs (LARD, TRIM and MITE). If PASTEC cannot classify a TE to order level, it classifies it to class level. PASTEC is also designed to filter out false-positive repeated sequences identified by <italic>de novo</italic> approaches. It can therefore distinguish SSRs, rDNA sequences and potential host genes from real TEs. Moreover, PASTEC can classify and recognize incomplete TEs and potentially chimeric TEs (detection of an anomaly in the evidence used to select the classification, or several classifications possible). In this last case, PASTEC chooses the best classification if it has sufficient evidence to make a decision. All evidence is written to the output file, to facilitate the manual curation of potential chimeric TEs. We tested this tool by comparing the results of these three tools on three different datasets.</p>
    <table-wrap id="pone-0091929-t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Comparison of the classifications obtained with the PASTEC, TEClass and RepClass tools.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t001-1" xlink:href="pone.0091929.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">PASTEC (Wicker's) Class</td>
              <td align="left" rowspan="1" colspan="1">PASTEC (Wicker's) Order</td>
              <td align="left" rowspan="1" colspan="1">TEClass Class</td>
              <td align="left" rowspan="1" colspan="1">TEClass Order</td>
              <td align="left" rowspan="1" colspan="1">RepClass Class</td>
              <td align="left" rowspan="1" colspan="1">RepClass Order</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Class I (Retrotransposons)</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">DIRS</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">PLE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LARD*</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">TRIM*</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LINE/SINE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">SINE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">SINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LINE/SINE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Class II (DNA transposons)</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">TIR</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">MITE*</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Crypton</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Helitron</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">Helitron</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Maverick</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt101">
          <label/>
          <p>Notes: (*) Non-autonomous element. <italic>na</italic>: not considered by the tool.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <p>PASTEC was developed in the REPET package <xref rid="pone.0091929-FlutreT" ref-type="bibr">[7]</xref>. In this context, we used PASTEC to classify the consensus TE sequences found <italic>de novo</italic> in a genome. PASTEC uses several features of TEs to classify TE consensus sequences. It searches for structural evidence and sequence similarities stored in a MySQL database obtained during a preprocessing step. The structural features considered are TE length, presence of a LTR (long terminal repeat) or TIR (terminal inverted repeat) detected with a custom-built tool (with a minimum length of 10 bp, a minimum identity of 80%, the taking into account of reciprocal orientations of terminal repeats and a maximal length of 7000 bp), the presence of SSRs (simple sequence repeats detected with the tandem repeat finder (TRF) tool <xref rid="pone.0091929-Benson1" ref-type="bibr">[8]</xref>), the polyA tail and an ORF (open reading frame). The blastx and tblastx routines are used to search for similarities to known TEs in Repbase Update, and the hmmer3 package <xref rid="pone.0091929-Eddy1" ref-type="bibr">[9]</xref> to search against a HMM profile databases (TE-specific or not), after translation in all six frames. Sequence similarities are also identified by blastn searches against known rDNA sequences, known host genes and known helitron ends. The databanks used are preprocessed and formatted. The Repbase Update for PASTEC can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.girinst.org/repbase/index.html">http://www.girinst.org/repbase/index.html</ext-link>, whereas the HMM profile databank formatted for PASTEC is available from the REPET download directory (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/repet/">http://urgi.versailles.inra.fr/download/repet/</ext-link>).</p>
    <p>PASTEC classifies TEs by testing all classifications from Wicker's hierarchical TE classification system. Each possible classification is weighted according to the available evidence, with respect to the classification considered. TEs are currently classified to class and order level. PASTEC can also determine whether a TE is complete on the basis of four criteria: sequence coverage for known TEs, profile coverage, presence of terminal repeats for certain classes, presence of a polyA or SSR tail for LINEs and SINEs, and the length of the TEs with respect to expectations for the class concerned.</p>
    <p>We designed PASTEC as a modular multi-agent classifier. The system is composed of four types of agents: retrievers, classifiers, filter agents, and a super-agent (<xref ref-type="fig" rid="pone-0091929-g001">Figure 1</xref>). The retriever agents retrieve the pre-computed analysis results stored in the MySQL database. They act on the requests of the classifier or filter agents, filtering, formatting and supplying the results. The classifier and filter agents are specialized to recognize a particular category. For example, the LTR agent can determine only whether the TE is a LTR or not. The classifier and filter agents act on the request of the super-agent, deciding whether they can classify the TE or not. For example, the LTR agent decides whether the consensus TE is a LTR on the basis of the following evidence: presence of the ENV (envelope protein) profile (a condition sufficient for classification), the presence of INT (integrase), RT (reverse transcriptase), GAG (capsid protein), AP (aspartate proteinase) and RH (RNase H) profiles together with the detection of a LTR (long terminal repeat), a blast match with the sequence of a known LTR retrotransposon. The super-agent resolves classification conflicts and formats the output file. It resolves conflicts by using a confidence index normalized to 100. For example, the LTR agent calculates a confidence index with the following rules: presence of ENV profiles (+2 because this condition is sufficient for classification), presence of a long terminal repeat and an INT, GAG, RT, RH or AP profile (+1 for each profile combined with the long terminal repeat), +1 for each profile (ENV, AP, RT, RH and GAG) found in the same frame in the same ORF. If the consensus matches at least one known LTR retrotransposon, the LTR agent adds +2 for each type of blast (blastx or tblastx) at the confidence index. Finally, the length of the TE is taken into account because we add +1 if the TE without the long terminal repeat is between 4000 and 15000 bp in length, and we decrease the confidence index by 1 if the TE without the long terminal repeat is less than 1000 bp or more than 15000 bp long. The super-agent uses the maximum confidence index defined for each classifier agent to normalize the confidence index for each classification to 100 and then compare the different classifications. Advanced users can edit all decisions rules and maximum confidence indices in the Decision_rules.yaml file.</p>
    <fig id="pone-0091929-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Agents implemented in the system.</title>
        <p>Orange agents are retriever agents, blue agents are classifier and filter agents. The super-agent is shown in green. The arrows indicate the principal communications between the different agents, with only requests shown.</p>
      </caption>
      <graphic xlink:href="pone.0091929.g001"/>
    </fig>
    <p>The output can be read by humans and is biologist-friendly. A single line specifies the name of the TE, its length, status, class, order, completeness, confidence index and all the features characterizing it. A status of “potential chimeric” or “OK” is assigned to the TE. If the TE is not considered to be “OK” then users must apply their own expertise. A TE is declared “potential chimeric” when at least two classifications are possible. In this case, PASTEC chooses the best status based on the available evidence, or does not classify the TE if no decision is possible. In this last case, all possible classifications are given (separated by a pipe symbol “|”). We present an example of PASTEC output in <xref ref-type="supplementary-material" rid="pone.0091929.s007">table S1</xref>. PASTEC output is a tabular file, with the columns from left to right indicating the name of the TE, its length, the orientation of the sequence, chimeric/non-chimeric status (OK indicating that the element is not potentially chimeric), class (class I in this case), order. In the first line of the example provided, the TE is a LTR. We presume that the element is complete because we have no evidence to suggest that it is incomplete, and the confidence index is 71/100. The last column summarizes all the evidence found: coding sequence evidence, such as the results of tblastX queries against the Repbase database (TE_BLRtx evidence), blastX queries against the Repbase database (TE_BLRx evidence) and profiles. A blast match is taken account if coverage exceeds 5%, and a profile is taken into account if its coverage exceeds 20% (these parameters can be edited in the configuration file). For each item of coding sequence evidence, the coverage of the subject is specified. The structural evidence is also detailed: &gt;4000 bp indicates that TE length without terminal repeats is between 4000 and 15000 bp, the next item of information presented in the comments columns is the presence of terminal repeats: we have a LTR in this case, with an LTR length of 433 bp; two long ORFs have been identified, the last of which contains four profiles in the same frame and is up to 3000 bp long. Other evidence provided for this example includes the partial match with a <italic>Drosophila melanogaster</italic> gene (coverage 16.55% and the TE contains 18% SSRs). The super-agent determines whether a TE is complete based on whether it is sufficiently long, whether the expected terminal repeats or polyA tail are present, whether blast match coverage exceeds 30% and profile coverage exceeds 75%. The second line of the example corresponds to a potentially chimeric TE, for which human expertise is required.</p>
  </sec>
  <sec id="s3">
    <title>Results and Discussion</title>
    <p>We compared the results of PASTEC with those of the two other classification tools, REPCLASS and TEclass, for three datasets: (i) the <italic>A. thaliana</italic> consensuses found in Repbase update version 15.09 (referred to hereafter as Repbase-atha), (ii) the TEs present in Repbase update 15.09 but not in Repbase 13.07 (referred to hereafter as Repbase-diff), and (iii) the whole Repbase update 15.09 from which we removed redundant TEs, i.e., those with strictly identical sequences (referred to hereafter as Repbase-all). For RepClass and PASTEC, which require a database for blast analyses, we used RepBase update 15.09 from which we removed the <italic>A. thaliana</italic> TEs in the first case, RepBase 13.07 in the second case and no blast database in the last case. The second case (Repbase-diff) mimics standard use: we wanted to classify TEs obtained from a new genome and, therefore, not yet known in the Repbase database. Indeed, Repbase-diff contains the TEs present in Repbase Update 15.09, but not in Repbase Update 13.07, and we provided Repbase Update 13.07 for sequence similarity searches by REPCLASS and PASTEC. So, as is usually the case in such analyses, we have unknown TEs (Repbase-diff) and a database of known TEs (Repbase Update 13.07). This made it possible to check whether the classification results for Repbase-diff were consistent with the classification given in Repbase Update 15.09. The last case is the most difficult, with attempts to classify TEs as if no known TEs are present in the database.</p>
    <p>We compared the classification performance, in terms of the percentages of TEs well classified, misclassified relative to their annotation in the Repbase database or not classified at the level of class (<xref ref-type="table" rid="pone-0091929-t002">Table 2</xref>) or order (<xref ref-type="table" rid="pone-0091929-t003">Table 3</xref>), for each of the three tools. It was not possible to compare sensitivity and specificity for each order, because the three tools do not use the same classification. Nevertheless, sensitivity and specificity data are presented in the supplementary data for the orders for which this was possible. We mapped the PASTEC classification onto those used by TEclass or REPCLASS, to improve comparisons. <xref ref-type="table" rid="pone-0091929-t003">Table 3</xref> shows the performances obtained with PASTEC after mapping.</p>
    <table-wrap id="pone-0091929-t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Comparison of the performances of PASTEC, REPCLASS, and TECLASS for classification into TE classes.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t002-2" xlink:href="pone.0091929.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset (sequence <sup>#</sup>)</td>
              <td align="left" rowspan="1" colspan="1">Performance</td>
              <td align="left" rowspan="1" colspan="1">PASTEC</td>
              <td align="left" rowspan="1" colspan="1">REPCLASS</td>
              <td align="left" rowspan="1" colspan="1">TECLASS</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-atha (318)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">80.7</td>
              <td align="left" rowspan="1" colspan="1">83.6</td>
              <td align="left" rowspan="1" colspan="1">98.4</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>0.95</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.5</td>
              <td align="left" rowspan="1" colspan="1">1.3</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">12.9</td>
              <td align="left" rowspan="1" colspan="1">0.3</td>
            </tr>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-diff (5546)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">63.7</td>
              <td align="left" rowspan="1" colspan="1">26.1</td>
              <td align="left" rowspan="1" colspan="1">59.2</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">31.8</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>40.2</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">42.1</td>
              <td align="left" rowspan="1" colspan="1">0.5</td>
            </tr>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-all (9665)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">52.7</td>
              <td align="left" rowspan="1" colspan="1">20.35</td>
              <td align="left" rowspan="1" colspan="1">53.8</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>5.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">27.09</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>45.8</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">41.3</td>
              <td align="left" rowspan="1" colspan="1">52.6</td>
              <td align="left" rowspan="1" colspan="1">0.3</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <table-wrap id="pone-0091929-t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Comparison of the performances of PASTEC, REPCLASS, and TECLASS for classification to TE order level.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t003-3" xlink:href="pone.0091929.t003"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset (sequence <sup>#</sup>)</td>
              <td align="left" rowspan="1" colspan="1">Performance</td>
              <td align="left" rowspan="1" colspan="1">PASTEC</td>
              <td align="left" rowspan="1" colspan="1">PASTEC mapped to REPCLASS order (1)</td>
              <td align="left" rowspan="1" colspan="1">PASTEC mapped to TECLASS order (2)</td>
              <td align="left" rowspan="1" colspan="1">REPCLASS (3)</td>
              <td align="left" rowspan="1" colspan="1">TECLASS (4)</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-atha (318)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">71.4</td>
              <td align="left" rowspan="1" colspan="1">79.7</td>
              <td align="left" rowspan="1" colspan="1">93.7</td>
              <td align="left" rowspan="1" colspan="1">85.5</td>
              <td align="left" rowspan="1" colspan="1">97.5</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>10.2</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>1.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.5</td>
              <td align="left" rowspan="1" colspan="1">2.8</td>
              <td align="left" rowspan="1" colspan="1">1.9</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">3.8</td>
              <td align="left" rowspan="1" colspan="1">11.6</td>
              <td align="left" rowspan="1" colspan="1">0.6</td>
            </tr>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-diff (5546)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">51.3</td>
              <td align="left" rowspan="1" colspan="1">59.1</td>
              <td align="left" rowspan="1" colspan="1">49.7</td>
              <td align="left" rowspan="1" colspan="1">66.9</td>
              <td align="left" rowspan="1" colspan="1">47.7</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>10.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.1</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.5</td>
              <td align="left" rowspan="1" colspan="1">11.1</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>50.3</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">46.8</td>
              <td align="left" rowspan="1" colspan="1">17.6</td>
              <td align="left" rowspan="1" colspan="1">1.9</td>
            </tr>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-all (9665)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">22.4</td>
              <td align="left" rowspan="1" colspan="1">31.9</td>
              <td align="left" rowspan="1" colspan="1">8.6</td>
              <td align="left" rowspan="1" colspan="1">12.4</td>
              <td align="left" rowspan="1" colspan="1">40</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>15.8</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>6.2</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">6.7</td>
              <td align="left" rowspan="1" colspan="1">33.3</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>59.7</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">61.8</td>
              <td align="left" rowspan="1" colspan="1">61.8</td>
              <td align="left" rowspan="1" colspan="1">84.7</td>
              <td align="left" rowspan="1" colspan="1">50.84</td>
              <td align="left" rowspan="1" colspan="1">0.25</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt102">
          <label/>
          <p>Note that the classification differs between the three tools. We therefore mapped the PASTEC classification results onto those for REPCLASS (1) and TECLASS (2). (2) Mapped onto TECLASS class I orders only. (3) order considered are: DNA transposon, LTR retrotransposon, helitron, non LTR retrotransposon. (4) order considered are only LTR, LINE/SINE.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>PASTEC misclassified very few TEs, regardless of the dataset tested (<xref ref-type="table" rid="pone-0091929-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0091929-t003">3</xref>). These rare ambiguities mostly concerned closely related TEs: essentially MITE/TIR (427/605 −70.6% - TEs misclassified at order level in the Repbase subtraction dataset). For Repbase-diff, PASTEC was frequently more specific than the other two tools (see suppl. Data: Venn diagram and table of sensitivity and specificity of the three tools for this second dataset <xref ref-type="supplementary-material" rid="pone.0091929.s008">Tables S2</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s009">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s010">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s011">S5</xref>
<xref ref-type="supplementary-material" rid="pone.0091929.s012">S6</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s001">Figures S1</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s002">S2</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s003">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s004">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s005">S5</xref>
<xref ref-type="supplementary-material" rid="pone.0091929.s006">S6</xref>). However, it failed to classify many TEs due to a lack of useful evidence. PASTEC HMM profile detection was found to be particularly useful if the database contained no similar TE to that for which the search was carried out. For Repbase-all without blast searches, we had profile information for 3488 TEs, making it possible to classify these elements at least partially. For classification to order level, PASTEC gave better results than REPCLASS. PASTEC correctly classified more TEs than REPCLASS for the Repbase-all library (31.9% of the TEs were well classified by PASTEC on the basis of REPCLASS order, whereas REPCLASS classified only 12.4% of TEs well, and PASTEC misclassified fewer TEs for all datasets (see <xref ref-type="table" rid="pone-0091929-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0091929-t003">3</xref>).</p>
    <p>REPCLASS performed well on the Repbase-atha dataset, particularly for helitrons, thanks to its helitron_scan tool, if no TSDs were found. It was efficient, but required the genome sequence. This tool searches for 5′ and 3′ termini, including the flanking sequences of all copies found in the genome, and a subterminal hairpin-like GC-rich motif. For the other datasets, we provided no genome sequence because the TEs came from many different genomes. In such conditions, the TSD module of REPCLASS cannot be used, but good results were nevertheless obtained with this tool for the Repbase-diff dataset (67% of TEs well classified to order level, see <xref ref-type="table" rid="pone-0091929-t003">Table 3</xref>). For this dataset, REPCLASS was more sensitive (83.6% <italic>vs</italic> 52.7%) but less specific (89.7% <italic>vs</italic> 99.9%) than PASTEC for classification to order level. By contrast, for the Repbase-all dataset (without blast homology searches), this tool gave the worst results (12.4% of TEs well classified to order level).</p>
    <p>TEclass classified the <italic>A. thaliana</italic> dataset well, but despite the number of TEs correctly classified with each of the three test datasets, the percentage of TEs misclassified remained high. TEclass misclassified between 40% and 60% of TEs from the Repbase-diff and Repbase-all datasets, misclassifying more than half of the TEs at order level for these two datasets. This suggests that this tool does not recognize effectively the situations in which it cannot give a correct classification. For interpretation purposes, a lower level of misclassification with more TEs unclassified and requiring manual checking would be preferable. It should also be noted that, in this study, TEclass was at an advantage over the other tools, as we could not train TEclass with a database containing none of the TEs in the test set.</p>
  </sec>
  <sec id="s4">
    <title>Conclusions</title>
    <p>In conclusion, TEclass misclassified TEs more frequently than the other tools for the two largest datasets (more than 50% of TEs for classification to order level). Moreover, the order classification of this tool is highly simplified (only four potential classifications). REPCLASS also has a simplified order classification (only four potential classifications). For these four orders, this tool performs well in conditions in which a homology search is possible (86% of Repbase-atha TEs well classified, with only 3% misclassified, 67% of Repbase-diff TEs well classified, with only 11% misclassified). However for the Repbase-all dataset, for which no homology search was possible, it performed poorly (12% of TEs well classified for 33% misclassified).</p>
    <p>PASTEC was found to have many advantages over the other tools. First, it can classify TEs into no less than nine orders, according to Wicker's classification (versus only four for TEclass and REPCLASS). It performs well for classification into these nine orders, particularly for the dataset for which blast homology searches were not possible, due to the possibility of carrying out HMM profile searches (22% of TEs are well classified and only 16% are misclassified). This is particularly useful when looking at a species phylogenetically distant from the species from which the known TEs were obtained. It performed well for the Repbase-diff dataset, which simulates a standard dataset: 51% of TEs were well classified and 11% were misclassified for classification to order level (for the nine available orders). If we consider only the four REPCLASS levels of classification, PASTEC classified 59% of TEs well and misclassified only 3% of TEs. In the same conditions, REPCLASS classified 67% of TEs correctly and misclassified 11% of TEs (almost four times more than PASTEC).</p>
    <p>A second advantage of PASTEC is its output format. We paid particular attention in the development of this tool to the generation of a file readable by humans, containing all the information required for manual curation by a biologist. Furthermore, PASTEC highlights the TEs for which manual curation is particularly necessary, by specifying whether the classification was ambiguous.</p>
    <p>Finally, PASTEC's modular architecture makes it possible to add new analyses or decision rules without difficulty. Expert users can access a configuration file, to change diverse parameters.</p>
    <p>The main perspective for improving PASTEC concerns classification to the superfamily level, not only through blast searches, but also on the basis of the HMM profiles detected in the TEs. <ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/Tools/REPET">http://urgi.versailles.inra.fr/Tools/REPET</ext-link>
</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0091929.s001">
      <label>Figure S1</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for class I TEs.</bold> The number of well classified class I TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s002">
      <label>Figure S2</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for class II TEs.</bold> The number of well classified class II TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s003">
      <label>Figure S3</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for LINE/SINE TEs.</bold> The number of well classified LINE/SINE TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s004">
      <label>Figure S4</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for helitron TEs.</bold> The number of well classified helitron TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools. Note: TECLASS does not classify helitron TEs to order level.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s005">
      <label>Figure S5</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for LTR TEs.</bold> The number of well classified LTR TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s006">
      <label>Figure S6</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for TIR TEs.</bold> The number of well classified TIR TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools. Note: TECLASS does not classify TIR TEs to order level.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s007">
      <label>Table S1</label>
      <caption>
        <p><bold>An example of PASTEC output.</bold> We present two TEs: the first is classified as a LTR and the second is a potentially chimeric TE (chimera between a helitron and LARD). The output is a tabular file providing the maximum amount of information to facilitate interpretation by biologists.</p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0091929.s007.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s008">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for ClassI and ClassII TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s009">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for LINE/SINE TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s009.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s010">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for helitrons TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s010.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s011">
      <label>Table S5</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for LTR TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s011.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s012">
      <label>Table S6</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for TIR TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s012.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the REPET team for their support in software development, and Joelle Amselem, Nathalie Choisne and Florian Maumus, for user feedback. We also thank Aurélie Kapusta for her help with REPCLASS and the reviewers for their helpful comments.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0091929-Wicker1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wicker</surname><given-names>T</given-names></name>, <name><surname>Sabot</surname><given-names>F</given-names></name>, <name><surname>Hua-Van</surname><given-names>A</given-names></name>, <name><surname>Bennetzen</surname><given-names>JL</given-names></name>, <name><surname>Capy</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>A unified classification system for eukaryotic transposable elements</article-title>. <source>Nature Rev. Genet</source>
<volume>8</volume>: <fpage>973</fpage>–<lpage>982</lpage>.<pub-id pub-id-type="pmid">17984973</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Permal1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Permal</surname><given-names>E</given-names></name>, <name><surname>Flutre</surname><given-names>T</given-names></name>, <name><surname>Quesneville</surname><given-names>H</given-names></name> (<year>2012</year>) <article-title>Roadmap for annotating transposable elements in eukaryote genomes</article-title>. <source>Methods Mol. Biol</source>
<volume>859</volume>: <fpage>53</fpage>–<lpage>68</lpage>.<pub-id pub-id-type="pmid">22367865</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Bergman1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Bergman</surname><given-names>CM</given-names></name>, <name><surname>Quesneville</surname><given-names>H</given-names></name> (<year>2007</year>) <article-title>Discovering and detecting transposable elements in genome sequences</article-title>. <source>Brief. Bioinform</source>
<volume>8</volume>: <fpage>382</fpage>–<lpage>392</lpage>.<pub-id pub-id-type="pmid">17932080</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Abrusn1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Abrusán</surname><given-names>G</given-names></name>, <name><surname>Grundmann</surname><given-names>N</given-names></name>, <name><surname>DeMeester</surname><given-names>L</given-names></name>, <name><surname>Makalowski</surname><given-names>W</given-names></name> (<year>2009</year>) <article-title>TEclass: a tool for automated classification of unknown eukaryotic transposable elements</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>1329</fpage>–<lpage>1330</lpage>.<pub-id pub-id-type="pmid">19349283</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Feschotte1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Feschotte</surname><given-names>C</given-names></name>, <name><surname>Keswani</surname><given-names>U</given-names></name>, <name><surname>Ranganathan</surname><given-names>N</given-names></name>, <name><surname>Guibotsy</surname><given-names>ML</given-names></name>, <name><surname>Levine</surname><given-names>D</given-names></name> (<year>2009</year>) <article-title>Exploring Repetitive DNA Landscapes Using REPCLASS, a Tool That Automates the Classification of Transposable Elements in Eukaryotic Genomes</article-title>. <source>Genome Biol. Evol</source>
<volume>1</volume>: <fpage>205</fpage>–<lpage>220</lpage>.<pub-id pub-id-type="pmid">20333191</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Jurka1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Jurka</surname><given-names>J</given-names></name>, <name><surname>Kapitonov</surname><given-names>VV</given-names></name>, <name><surname>Pavlicek</surname><given-names>A</given-names></name>, <name><surname>Klonowski</surname><given-names>P</given-names></name>, <name><surname>Kohany</surname><given-names>O</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Repbase update, a database of eukaryotic repetitive elements</article-title>. <source>Cytogenet. Genome Res</source>
<volume>110</volume>: <fpage>462</fpage>–<lpage>467</lpage>.<pub-id pub-id-type="pmid">16093699</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-FlutreT">
      <label>7</label>
      <mixed-citation publication-type="journal">FlutreT, Duprat E, Feuillet C, Quesneville H (2011) Considering Transposable Element Diversification in De Novo Annotation Approaches. PLoS ONE <volume>6(1)</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0091929-Benson1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Benson</surname><given-names>G</given-names></name> (<year>1999</year>) <article-title>Tandem repeats finder: a program to analyze DNA sequences</article-title>. <source>Nucleic Acids Res</source>
<volume>27(2)</volume>: <fpage>573</fpage>–<lpage>580</lpage>.<pub-id pub-id-type="pmid">9862982</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Eddy1">
      <label>9</label>
      <mixed-citation publication-type="journal">Eddy SR (2011) Accelerated Profile HMM Searches. PLoS Comput. Biol. <volume>7(10)</volume>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4008368</article-id>
    <article-id pub-id-type="pmid">24786468</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-13-40172</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0091929</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Molecular Cell Biology</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Gene Prediction</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Elements</subject>
            <subj-group>
              <subject>Mobile Genetic Elements</subject>
              <subj-group>
                <subject>Transposable Elements</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Structural Genomics</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Gene Identification and Analysis</subject>
            <subject>Molecular Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PASTEC: An Automatic Transposable Element Classification Tool</article-title>
      <alt-title alt-title-type="running-head">A Transposable Element Classification Tool</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hoede</surname>
          <given-names>Claire</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arnoux</surname>
          <given-names>Sandie</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moisset</surname>
          <given-names>Mark</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chaumier</surname>
          <given-names>Timothée</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Inizan</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jamilloux</surname>
          <given-names>Véronique</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quesneville</surname>
          <given-names>Hadi</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>INRA, UR1164 URGI - Research Unit in Genomics-Info, Versailles, France</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>INRA, plateforme Bio-informatique Genotoul, Mathématiques et Informatique Appliquées Toulouse UR875, Castanet-Tolosan, France</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>INRA, LUNAM Université, Oniris, UMR1300 BioEpAR, Nantes, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cordaux</surname>
          <given-names>Richard</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Poitiers, France</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>Hadi.quesneville@versailles.inra.fr</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: CH HQ. Performed the experiments: CH. Analyzed the data: CH HQ. Wrote the paper: CH HQ. Designed the software used in analysis: CH SA TC MM OI VJ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>5</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>5</issue>
    <elocation-id>e91929</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>10</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>2</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Hoede et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Hoede et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Summary</title>
        <p>The classification of transposable elements (TEs) is key step towards deciphering their potential impact on the genome. However, this process is often based on manual sequence inspection by TE experts. With the wealth of genomic sequences now available, this task requires automation, making it accessible to most scientists. We propose a new tool, PASTEC, which classifies TEs by searching for structural features and similarities. This tool outperforms currently available software for TE classification. The main innovation of PASTEC is the search for HMM profiles, which is useful for inferring the classification of unknown TE on the basis of conserved functional domains of the proteins. In addition, PASTEC is the only tool providing an exhaustive spectrum of possible classifications to the order level of the Wicker hierarchical TE classification system. It can also automatically classify other repeated elements, such as SSR (Simple Sequence Repeats), rDNA or potential repeated host genes. Finally, the output of this new tool is designed to facilitate manual curation by providing to biologists with all the evidence accumulated for each TE consensus.</p>
      </sec>
      <sec>
        <title>Availability</title>
        <p>PASTEC is available as a REPET module or standalone software (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/repet/REPET_linux-x64-2.2.tar.gz">http://urgi.versailles.inra.fr/download/repet/REPET_linux-x64-2.2.tar.gz</ext-link>). It requires a Unix-like system. There are two standalone versions: one of which is parallelized (requiring Sun grid Engine or Torque), and the other of which is not.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>Claire Hoede's work was supported by a grant from the French National Research. Agency (ANR-08-KBBE-012-02) attributed to Hadi Quesneville. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Transposable elements account for a high proportion of eukaryotic genomes. They are involved in a number of important processes, including genome rearrangement, heterochromatin formation and the regulation of gene expression. Wicker <italic>et al</italic>. <xref rid="pone.0091929-Wicker1" ref-type="bibr">[1]</xref> published a detailed classification for eukaryotic TEs. Their goals were to harmonize and clarify TE classifications and names. This classification includes both well-known classes of TEs: class I (retrotransposons) and II (DNA transposons). Five orders (LTR, DIRS, PLE, LINE, SINE) are defined for class I, and four (TIR, Crypton, Helitron, Maverick) for class II. Each order is also divided into one or several superfamilies, resulting in 29 superfamilies total. Other categories comprising non-autonomous TEs (LARD, TRIM and MITE) are considered in this classification, together with various forms of non-autonomous entities related to TEs to various degrees. This classification is based on the transposition mechanism, sequence similarities and structural relationships. Wicker <italic>et al</italic>. described the protein-coding domains present in each TE superfamily in particular detail.</p>
    <p>Several computational tools have been proposed for the <italic>ab initio</italic> identification of repeat families (see reviews <xref rid="pone.0091929-Permal1" ref-type="bibr">[2]</xref>; <xref rid="pone.0091929-Bergman1" ref-type="bibr">[3]</xref>). These tools generally reconstruct the consensus sequences of repeated regions. It is then useful to characterize and classify these consensus sequences, to study the TE repertoire of a genome. Two tools for the automatic classification of a large range of TEs have been proposed: TEclass <xref rid="pone.0091929-Abrusn1" ref-type="bibr">[4]</xref> and REPCLASS <xref rid="pone.0091929-Feschotte1" ref-type="bibr">[5]</xref>. TEclass classifies TE sequences only into two classes: Retro (class I in Wicker's classification) and DNA (class II in Wicker's classification). This tool can classify class I elements into LTRs and non-LTRs and, where possible, into SINE or LINE elements. However, TEClass cannot distinguish between the various orders of class II elements. The SVM (Support Vector Machine: supervised learning model) classifiers in this tool were trained with RepBase Update, a database of eukaryotic repetitive sequences <xref rid="pone.0091929-Jurka1" ref-type="bibr">[6]</xref>, using different class lengths and vectors of tetramer and pentamer frequencies. This approach is useful when TEs show no clear similarity to known repeats.</p>
    <p>REPCLASS can classify TEs into classes I and II, and into the orders LTR retrotransposon (grouping LTR, LARD, TRIM, DIRS and PLE from Wicker's classification), DNA transposon (grouping TIR, crypton and Polinton from Wicker's classification), LINE/SINE and helitron. In some cases, this tool can also identify the superfamily of the TE. REPCLASS consists of three modules. The first is based on homology and has the greatest impact on final decision. At this step, the software carries out a tblastx analysis against the RepBase databank. The second module (in terms of order of priority for classification) searches for structural characteristics: terminal repeats, such as LTRs and TIRs, tRNA, polyA signals and SSR. Finally, the third module searches for target site duplication (TSD) around TE copies within the genome.</p>
    <p>Neither TEclass nor REPCLASS can classify TEs at the level of detail given by Wicker's classification (see <xref ref-type="table" rid="pone-0091929-t001">Table 1</xref>). We therefore developed PASTEC (Pseudo Agent System for Transposable Element Classification), a modular tool able to classify TEs automatically to order level, for all nine orders of autonomous TEs defined in Wicker's classification plus three orders of non-autonomous TEs (LARD, TRIM and MITE). If PASTEC cannot classify a TE to order level, it classifies it to class level. PASTEC is also designed to filter out false-positive repeated sequences identified by <italic>de novo</italic> approaches. It can therefore distinguish SSRs, rDNA sequences and potential host genes from real TEs. Moreover, PASTEC can classify and recognize incomplete TEs and potentially chimeric TEs (detection of an anomaly in the evidence used to select the classification, or several classifications possible). In this last case, PASTEC chooses the best classification if it has sufficient evidence to make a decision. All evidence is written to the output file, to facilitate the manual curation of potential chimeric TEs. We tested this tool by comparing the results of these three tools on three different datasets.</p>
    <table-wrap id="pone-0091929-t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Comparison of the classifications obtained with the PASTEC, TEClass and RepClass tools.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t001-1" xlink:href="pone.0091929.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">PASTEC (Wicker's) Class</td>
              <td align="left" rowspan="1" colspan="1">PASTEC (Wicker's) Order</td>
              <td align="left" rowspan="1" colspan="1">TEClass Class</td>
              <td align="left" rowspan="1" colspan="1">TEClass Order</td>
              <td align="left" rowspan="1" colspan="1">RepClass Class</td>
              <td align="left" rowspan="1" colspan="1">RepClass Order</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Class I (Retrotransposons)</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">DIRS</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LTR</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">PLE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LTR/DIRS/PLE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LARD*</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">TRIM*</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">LINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LINE/SINE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">SINE</td>
              <td align="left" rowspan="1" colspan="1">Retro</td>
              <td align="left" rowspan="1" colspan="1">SINE</td>
              <td align="left" rowspan="1" colspan="1">Class I</td>
              <td align="left" rowspan="1" colspan="1">LINE/SINE</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Class II (DNA transposons)</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">TIR</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">MITE*</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Crypton</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Helitron</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">Helitron</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Maverick</td>
              <td align="left" rowspan="1" colspan="1">DNA</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>na</italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Class II</td>
              <td align="left" rowspan="1" colspan="1">TIR/Crypton/Polinton</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt101">
          <label/>
          <p>Notes: (*) Non-autonomous element. <italic>na</italic>: not considered by the tool.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <p>PASTEC was developed in the REPET package <xref rid="pone.0091929-FlutreT" ref-type="bibr">[7]</xref>. In this context, we used PASTEC to classify the consensus TE sequences found <italic>de novo</italic> in a genome. PASTEC uses several features of TEs to classify TE consensus sequences. It searches for structural evidence and sequence similarities stored in a MySQL database obtained during a preprocessing step. The structural features considered are TE length, presence of a LTR (long terminal repeat) or TIR (terminal inverted repeat) detected with a custom-built tool (with a minimum length of 10 bp, a minimum identity of 80%, the taking into account of reciprocal orientations of terminal repeats and a maximal length of 7000 bp), the presence of SSRs (simple sequence repeats detected with the tandem repeat finder (TRF) tool <xref rid="pone.0091929-Benson1" ref-type="bibr">[8]</xref>), the polyA tail and an ORF (open reading frame). The blastx and tblastx routines are used to search for similarities to known TEs in Repbase Update, and the hmmer3 package <xref rid="pone.0091929-Eddy1" ref-type="bibr">[9]</xref> to search against a HMM profile databases (TE-specific or not), after translation in all six frames. Sequence similarities are also identified by blastn searches against known rDNA sequences, known host genes and known helitron ends. The databanks used are preprocessed and formatted. The Repbase Update for PASTEC can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.girinst.org/repbase/index.html">http://www.girinst.org/repbase/index.html</ext-link>, whereas the HMM profile databank formatted for PASTEC is available from the REPET download directory (<ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/download/repet/">http://urgi.versailles.inra.fr/download/repet/</ext-link>).</p>
    <p>PASTEC classifies TEs by testing all classifications from Wicker's hierarchical TE classification system. Each possible classification is weighted according to the available evidence, with respect to the classification considered. TEs are currently classified to class and order level. PASTEC can also determine whether a TE is complete on the basis of four criteria: sequence coverage for known TEs, profile coverage, presence of terminal repeats for certain classes, presence of a polyA or SSR tail for LINEs and SINEs, and the length of the TEs with respect to expectations for the class concerned.</p>
    <p>We designed PASTEC as a modular multi-agent classifier. The system is composed of four types of agents: retrievers, classifiers, filter agents, and a super-agent (<xref ref-type="fig" rid="pone-0091929-g001">Figure 1</xref>). The retriever agents retrieve the pre-computed analysis results stored in the MySQL database. They act on the requests of the classifier or filter agents, filtering, formatting and supplying the results. The classifier and filter agents are specialized to recognize a particular category. For example, the LTR agent can determine only whether the TE is a LTR or not. The classifier and filter agents act on the request of the super-agent, deciding whether they can classify the TE or not. For example, the LTR agent decides whether the consensus TE is a LTR on the basis of the following evidence: presence of the ENV (envelope protein) profile (a condition sufficient for classification), the presence of INT (integrase), RT (reverse transcriptase), GAG (capsid protein), AP (aspartate proteinase) and RH (RNase H) profiles together with the detection of a LTR (long terminal repeat), a blast match with the sequence of a known LTR retrotransposon. The super-agent resolves classification conflicts and formats the output file. It resolves conflicts by using a confidence index normalized to 100. For example, the LTR agent calculates a confidence index with the following rules: presence of ENV profiles (+2 because this condition is sufficient for classification), presence of a long terminal repeat and an INT, GAG, RT, RH or AP profile (+1 for each profile combined with the long terminal repeat), +1 for each profile (ENV, AP, RT, RH and GAG) found in the same frame in the same ORF. If the consensus matches at least one known LTR retrotransposon, the LTR agent adds +2 for each type of blast (blastx or tblastx) at the confidence index. Finally, the length of the TE is taken into account because we add +1 if the TE without the long terminal repeat is between 4000 and 15000 bp in length, and we decrease the confidence index by 1 if the TE without the long terminal repeat is less than 1000 bp or more than 15000 bp long. The super-agent uses the maximum confidence index defined for each classifier agent to normalize the confidence index for each classification to 100 and then compare the different classifications. Advanced users can edit all decisions rules and maximum confidence indices in the Decision_rules.yaml file.</p>
    <fig id="pone-0091929-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Agents implemented in the system.</title>
        <p>Orange agents are retriever agents, blue agents are classifier and filter agents. The super-agent is shown in green. The arrows indicate the principal communications between the different agents, with only requests shown.</p>
      </caption>
      <graphic xlink:href="pone.0091929.g001"/>
    </fig>
    <p>The output can be read by humans and is biologist-friendly. A single line specifies the name of the TE, its length, status, class, order, completeness, confidence index and all the features characterizing it. A status of “potential chimeric” or “OK” is assigned to the TE. If the TE is not considered to be “OK” then users must apply their own expertise. A TE is declared “potential chimeric” when at least two classifications are possible. In this case, PASTEC chooses the best status based on the available evidence, or does not classify the TE if no decision is possible. In this last case, all possible classifications are given (separated by a pipe symbol “|”). We present an example of PASTEC output in <xref ref-type="supplementary-material" rid="pone.0091929.s007">table S1</xref>. PASTEC output is a tabular file, with the columns from left to right indicating the name of the TE, its length, the orientation of the sequence, chimeric/non-chimeric status (OK indicating that the element is not potentially chimeric), class (class I in this case), order. In the first line of the example provided, the TE is a LTR. We presume that the element is complete because we have no evidence to suggest that it is incomplete, and the confidence index is 71/100. The last column summarizes all the evidence found: coding sequence evidence, such as the results of tblastX queries against the Repbase database (TE_BLRtx evidence), blastX queries against the Repbase database (TE_BLRx evidence) and profiles. A blast match is taken account if coverage exceeds 5%, and a profile is taken into account if its coverage exceeds 20% (these parameters can be edited in the configuration file). For each item of coding sequence evidence, the coverage of the subject is specified. The structural evidence is also detailed: &gt;4000 bp indicates that TE length without terminal repeats is between 4000 and 15000 bp, the next item of information presented in the comments columns is the presence of terminal repeats: we have a LTR in this case, with an LTR length of 433 bp; two long ORFs have been identified, the last of which contains four profiles in the same frame and is up to 3000 bp long. Other evidence provided for this example includes the partial match with a <italic>Drosophila melanogaster</italic> gene (coverage 16.55% and the TE contains 18% SSRs). The super-agent determines whether a TE is complete based on whether it is sufficiently long, whether the expected terminal repeats or polyA tail are present, whether blast match coverage exceeds 30% and profile coverage exceeds 75%. The second line of the example corresponds to a potentially chimeric TE, for which human expertise is required.</p>
  </sec>
  <sec id="s3">
    <title>Results and Discussion</title>
    <p>We compared the results of PASTEC with those of the two other classification tools, REPCLASS and TEclass, for three datasets: (i) the <italic>A. thaliana</italic> consensuses found in Repbase update version 15.09 (referred to hereafter as Repbase-atha), (ii) the TEs present in Repbase update 15.09 but not in Repbase 13.07 (referred to hereafter as Repbase-diff), and (iii) the whole Repbase update 15.09 from which we removed redundant TEs, i.e., those with strictly identical sequences (referred to hereafter as Repbase-all). For RepClass and PASTEC, which require a database for blast analyses, we used RepBase update 15.09 from which we removed the <italic>A. thaliana</italic> TEs in the first case, RepBase 13.07 in the second case and no blast database in the last case. The second case (Repbase-diff) mimics standard use: we wanted to classify TEs obtained from a new genome and, therefore, not yet known in the Repbase database. Indeed, Repbase-diff contains the TEs present in Repbase Update 15.09, but not in Repbase Update 13.07, and we provided Repbase Update 13.07 for sequence similarity searches by REPCLASS and PASTEC. So, as is usually the case in such analyses, we have unknown TEs (Repbase-diff) and a database of known TEs (Repbase Update 13.07). This made it possible to check whether the classification results for Repbase-diff were consistent with the classification given in Repbase Update 15.09. The last case is the most difficult, with attempts to classify TEs as if no known TEs are present in the database.</p>
    <p>We compared the classification performance, in terms of the percentages of TEs well classified, misclassified relative to their annotation in the Repbase database or not classified at the level of class (<xref ref-type="table" rid="pone-0091929-t002">Table 2</xref>) or order (<xref ref-type="table" rid="pone-0091929-t003">Table 3</xref>), for each of the three tools. It was not possible to compare sensitivity and specificity for each order, because the three tools do not use the same classification. Nevertheless, sensitivity and specificity data are presented in the supplementary data for the orders for which this was possible. We mapped the PASTEC classification onto those used by TEclass or REPCLASS, to improve comparisons. <xref ref-type="table" rid="pone-0091929-t003">Table 3</xref> shows the performances obtained with PASTEC after mapping.</p>
    <table-wrap id="pone-0091929-t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Comparison of the performances of PASTEC, REPCLASS, and TECLASS for classification into TE classes.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t002-2" xlink:href="pone.0091929.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset (sequence <sup>#</sup>)</td>
              <td align="left" rowspan="1" colspan="1">Performance</td>
              <td align="left" rowspan="1" colspan="1">PASTEC</td>
              <td align="left" rowspan="1" colspan="1">REPCLASS</td>
              <td align="left" rowspan="1" colspan="1">TECLASS</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-atha (318)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">80.7</td>
              <td align="left" rowspan="1" colspan="1">83.6</td>
              <td align="left" rowspan="1" colspan="1">98.4</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>0.95</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.5</td>
              <td align="left" rowspan="1" colspan="1">1.3</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">12.9</td>
              <td align="left" rowspan="1" colspan="1">0.3</td>
            </tr>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-diff (5546)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">63.7</td>
              <td align="left" rowspan="1" colspan="1">26.1</td>
              <td align="left" rowspan="1" colspan="1">59.2</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">31.8</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>40.2</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">42.1</td>
              <td align="left" rowspan="1" colspan="1">0.5</td>
            </tr>
            <tr>
              <td colspan="5" align="left" rowspan="1">Repbase-all (9665)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">52.7</td>
              <td align="left" rowspan="1" colspan="1">20.35</td>
              <td align="left" rowspan="1" colspan="1">53.8</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>5.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">27.09</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>45.8</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">41.3</td>
              <td align="left" rowspan="1" colspan="1">52.6</td>
              <td align="left" rowspan="1" colspan="1">0.3</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <table-wrap id="pone-0091929-t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0091929.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Comparison of the performances of PASTEC, REPCLASS, and TECLASS for classification to TE order level.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0091929-t003-3" xlink:href="pone.0091929.t003"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Dataset (sequence <sup>#</sup>)</td>
              <td align="left" rowspan="1" colspan="1">Performance</td>
              <td align="left" rowspan="1" colspan="1">PASTEC</td>
              <td align="left" rowspan="1" colspan="1">PASTEC mapped to REPCLASS order (1)</td>
              <td align="left" rowspan="1" colspan="1">PASTEC mapped to TECLASS order (2)</td>
              <td align="left" rowspan="1" colspan="1">REPCLASS (3)</td>
              <td align="left" rowspan="1" colspan="1">TECLASS (4)</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-atha (318)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">71.4</td>
              <td align="left" rowspan="1" colspan="1">79.7</td>
              <td align="left" rowspan="1" colspan="1">93.7</td>
              <td align="left" rowspan="1" colspan="1">85.5</td>
              <td align="left" rowspan="1" colspan="1">97.5</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>10.2</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>1.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.5</td>
              <td align="left" rowspan="1" colspan="1">2.8</td>
              <td align="left" rowspan="1" colspan="1">1.9</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">18.4</td>
              <td align="left" rowspan="1" colspan="1">3.8</td>
              <td align="left" rowspan="1" colspan="1">11.6</td>
              <td align="left" rowspan="1" colspan="1">0.6</td>
            </tr>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-diff (5546)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">51.3</td>
              <td align="left" rowspan="1" colspan="1">59.1</td>
              <td align="left" rowspan="1" colspan="1">49.7</td>
              <td align="left" rowspan="1" colspan="1">66.9</td>
              <td align="left" rowspan="1" colspan="1">47.7</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>10.9</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.1</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.5</td>
              <td align="left" rowspan="1" colspan="1">11.1</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>50.3</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">33.4</td>
              <td align="left" rowspan="1" colspan="1">46.8</td>
              <td align="left" rowspan="1" colspan="1">17.6</td>
              <td align="left" rowspan="1" colspan="1">1.9</td>
            </tr>
            <tr>
              <td colspan="7" align="left" rowspan="1">Repbase-all (9665)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Well classified</td>
              <td align="left" rowspan="1" colspan="1">22.4</td>
              <td align="left" rowspan="1" colspan="1">31.9</td>
              <td align="left" rowspan="1" colspan="1">8.6</td>
              <td align="left" rowspan="1" colspan="1">12.4</td>
              <td align="left" rowspan="1" colspan="1">40</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Misclassified</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>15.8</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>6.2</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">6.7</td>
              <td align="left" rowspan="1" colspan="1">33.3</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>59.7</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Not classified</td>
              <td align="left" rowspan="1" colspan="1">61.8</td>
              <td align="left" rowspan="1" colspan="1">61.8</td>
              <td align="left" rowspan="1" colspan="1">84.7</td>
              <td align="left" rowspan="1" colspan="1">50.84</td>
              <td align="left" rowspan="1" colspan="1">0.25</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt102">
          <label/>
          <p>Note that the classification differs between the three tools. We therefore mapped the PASTEC classification results onto those for REPCLASS (1) and TECLASS (2). (2) Mapped onto TECLASS class I orders only. (3) order considered are: DNA transposon, LTR retrotransposon, helitron, non LTR retrotransposon. (4) order considered are only LTR, LINE/SINE.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>PASTEC misclassified very few TEs, regardless of the dataset tested (<xref ref-type="table" rid="pone-0091929-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0091929-t003">3</xref>). These rare ambiguities mostly concerned closely related TEs: essentially MITE/TIR (427/605 −70.6% - TEs misclassified at order level in the Repbase subtraction dataset). For Repbase-diff, PASTEC was frequently more specific than the other two tools (see suppl. Data: Venn diagram and table of sensitivity and specificity of the three tools for this second dataset <xref ref-type="supplementary-material" rid="pone.0091929.s008">Tables S2</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s009">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s010">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s011">S5</xref>
<xref ref-type="supplementary-material" rid="pone.0091929.s012">S6</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s001">Figures S1</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s002">S2</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s003">S3</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s004">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0091929.s005">S5</xref>
<xref ref-type="supplementary-material" rid="pone.0091929.s006">S6</xref>). However, it failed to classify many TEs due to a lack of useful evidence. PASTEC HMM profile detection was found to be particularly useful if the database contained no similar TE to that for which the search was carried out. For Repbase-all without blast searches, we had profile information for 3488 TEs, making it possible to classify these elements at least partially. For classification to order level, PASTEC gave better results than REPCLASS. PASTEC correctly classified more TEs than REPCLASS for the Repbase-all library (31.9% of the TEs were well classified by PASTEC on the basis of REPCLASS order, whereas REPCLASS classified only 12.4% of TEs well, and PASTEC misclassified fewer TEs for all datasets (see <xref ref-type="table" rid="pone-0091929-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0091929-t003">3</xref>).</p>
    <p>REPCLASS performed well on the Repbase-atha dataset, particularly for helitrons, thanks to its helitron_scan tool, if no TSDs were found. It was efficient, but required the genome sequence. This tool searches for 5′ and 3′ termini, including the flanking sequences of all copies found in the genome, and a subterminal hairpin-like GC-rich motif. For the other datasets, we provided no genome sequence because the TEs came from many different genomes. In such conditions, the TSD module of REPCLASS cannot be used, but good results were nevertheless obtained with this tool for the Repbase-diff dataset (67% of TEs well classified to order level, see <xref ref-type="table" rid="pone-0091929-t003">Table 3</xref>). For this dataset, REPCLASS was more sensitive (83.6% <italic>vs</italic> 52.7%) but less specific (89.7% <italic>vs</italic> 99.9%) than PASTEC for classification to order level. By contrast, for the Repbase-all dataset (without blast homology searches), this tool gave the worst results (12.4% of TEs well classified to order level).</p>
    <p>TEclass classified the <italic>A. thaliana</italic> dataset well, but despite the number of TEs correctly classified with each of the three test datasets, the percentage of TEs misclassified remained high. TEclass misclassified between 40% and 60% of TEs from the Repbase-diff and Repbase-all datasets, misclassifying more than half of the TEs at order level for these two datasets. This suggests that this tool does not recognize effectively the situations in which it cannot give a correct classification. For interpretation purposes, a lower level of misclassification with more TEs unclassified and requiring manual checking would be preferable. It should also be noted that, in this study, TEclass was at an advantage over the other tools, as we could not train TEclass with a database containing none of the TEs in the test set.</p>
  </sec>
  <sec id="s4">
    <title>Conclusions</title>
    <p>In conclusion, TEclass misclassified TEs more frequently than the other tools for the two largest datasets (more than 50% of TEs for classification to order level). Moreover, the order classification of this tool is highly simplified (only four potential classifications). REPCLASS also has a simplified order classification (only four potential classifications). For these four orders, this tool performs well in conditions in which a homology search is possible (86% of Repbase-atha TEs well classified, with only 3% misclassified, 67% of Repbase-diff TEs well classified, with only 11% misclassified). However for the Repbase-all dataset, for which no homology search was possible, it performed poorly (12% of TEs well classified for 33% misclassified).</p>
    <p>PASTEC was found to have many advantages over the other tools. First, it can classify TEs into no less than nine orders, according to Wicker's classification (versus only four for TEclass and REPCLASS). It performs well for classification into these nine orders, particularly for the dataset for which blast homology searches were not possible, due to the possibility of carrying out HMM profile searches (22% of TEs are well classified and only 16% are misclassified). This is particularly useful when looking at a species phylogenetically distant from the species from which the known TEs were obtained. It performed well for the Repbase-diff dataset, which simulates a standard dataset: 51% of TEs were well classified and 11% were misclassified for classification to order level (for the nine available orders). If we consider only the four REPCLASS levels of classification, PASTEC classified 59% of TEs well and misclassified only 3% of TEs. In the same conditions, REPCLASS classified 67% of TEs correctly and misclassified 11% of TEs (almost four times more than PASTEC).</p>
    <p>A second advantage of PASTEC is its output format. We paid particular attention in the development of this tool to the generation of a file readable by humans, containing all the information required for manual curation by a biologist. Furthermore, PASTEC highlights the TEs for which manual curation is particularly necessary, by specifying whether the classification was ambiguous.</p>
    <p>Finally, PASTEC's modular architecture makes it possible to add new analyses or decision rules without difficulty. Expert users can access a configuration file, to change diverse parameters.</p>
    <p>The main perspective for improving PASTEC concerns classification to the superfamily level, not only through blast searches, but also on the basis of the HMM profiles detected in the TEs. <ext-link ext-link-type="uri" xlink:href="http://urgi.versailles.inra.fr/Tools/REPET">http://urgi.versailles.inra.fr/Tools/REPET</ext-link>
</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0091929.s001">
      <label>Figure S1</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for class I TEs.</bold> The number of well classified class I TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s002">
      <label>Figure S2</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for class II TEs.</bold> The number of well classified class II TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s003">
      <label>Figure S3</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for LINE/SINE TEs.</bold> The number of well classified LINE/SINE TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s004">
      <label>Figure S4</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for helitron TEs.</bold> The number of well classified helitron TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools. Note: TECLASS does not classify helitron TEs to order level.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s005">
      <label>Figure S5</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for LTR TEs.</bold> The number of well classified LTR TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s006">
      <label>Figure S6</label>
      <caption>
        <p><bold>Venn diagram (Repbase-diff dataset) for TIR TEs.</bold> The number of well classified TIR TEs is shown in brackets. The numbers within the Venn diagram are the numbers of TEs well classified by each tool, with the overlaps indicating those well classified by several tools. Note: TECLASS does not classify TIR TEs to order level.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0091929.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s007">
      <label>Table S1</label>
      <caption>
        <p><bold>An example of PASTEC output.</bold> We present two TEs: the first is classified as a LTR and the second is a potentially chimeric TE (chimera between a helitron and LARD). The output is a tabular file providing the maximum amount of information to facilitate interpretation by biologists.</p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0091929.s007.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s008">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for ClassI and ClassII TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s009">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for LINE/SINE TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s009.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s010">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for helitrons TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s010.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s011">
      <label>Table S5</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for LTR TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s011.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0091929.s012">
      <label>Table S6</label>
      <caption>
        <p>
          <bold>Sensitivity/specificity for TIR TEs.</bold>
        </p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0091929.s012.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the REPET team for their support in software development, and Joelle Amselem, Nathalie Choisne and Florian Maumus, for user feedback. We also thank Aurélie Kapusta for her help with REPCLASS and the reviewers for their helpful comments.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0091929-Wicker1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Wicker</surname><given-names>T</given-names></name>, <name><surname>Sabot</surname><given-names>F</given-names></name>, <name><surname>Hua-Van</surname><given-names>A</given-names></name>, <name><surname>Bennetzen</surname><given-names>JL</given-names></name>, <name><surname>Capy</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>A unified classification system for eukaryotic transposable elements</article-title>. <source>Nature Rev. Genet</source>
<volume>8</volume>: <fpage>973</fpage>–<lpage>982</lpage>.<pub-id pub-id-type="pmid">17984973</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Permal1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Permal</surname><given-names>E</given-names></name>, <name><surname>Flutre</surname><given-names>T</given-names></name>, <name><surname>Quesneville</surname><given-names>H</given-names></name> (<year>2012</year>) <article-title>Roadmap for annotating transposable elements in eukaryote genomes</article-title>. <source>Methods Mol. Biol</source>
<volume>859</volume>: <fpage>53</fpage>–<lpage>68</lpage>.<pub-id pub-id-type="pmid">22367865</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Bergman1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Bergman</surname><given-names>CM</given-names></name>, <name><surname>Quesneville</surname><given-names>H</given-names></name> (<year>2007</year>) <article-title>Discovering and detecting transposable elements in genome sequences</article-title>. <source>Brief. Bioinform</source>
<volume>8</volume>: <fpage>382</fpage>–<lpage>392</lpage>.<pub-id pub-id-type="pmid">17932080</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Abrusn1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Abrusán</surname><given-names>G</given-names></name>, <name><surname>Grundmann</surname><given-names>N</given-names></name>, <name><surname>DeMeester</surname><given-names>L</given-names></name>, <name><surname>Makalowski</surname><given-names>W</given-names></name> (<year>2009</year>) <article-title>TEclass: a tool for automated classification of unknown eukaryotic transposable elements</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>1329</fpage>–<lpage>1330</lpage>.<pub-id pub-id-type="pmid">19349283</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Feschotte1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Feschotte</surname><given-names>C</given-names></name>, <name><surname>Keswani</surname><given-names>U</given-names></name>, <name><surname>Ranganathan</surname><given-names>N</given-names></name>, <name><surname>Guibotsy</surname><given-names>ML</given-names></name>, <name><surname>Levine</surname><given-names>D</given-names></name> (<year>2009</year>) <article-title>Exploring Repetitive DNA Landscapes Using REPCLASS, a Tool That Automates the Classification of Transposable Elements in Eukaryotic Genomes</article-title>. <source>Genome Biol. Evol</source>
<volume>1</volume>: <fpage>205</fpage>–<lpage>220</lpage>.<pub-id pub-id-type="pmid">20333191</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Jurka1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Jurka</surname><given-names>J</given-names></name>, <name><surname>Kapitonov</surname><given-names>VV</given-names></name>, <name><surname>Pavlicek</surname><given-names>A</given-names></name>, <name><surname>Klonowski</surname><given-names>P</given-names></name>, <name><surname>Kohany</surname><given-names>O</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Repbase update, a database of eukaryotic repetitive elements</article-title>. <source>Cytogenet. Genome Res</source>
<volume>110</volume>: <fpage>462</fpage>–<lpage>467</lpage>.<pub-id pub-id-type="pmid">16093699</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-FlutreT">
      <label>7</label>
      <mixed-citation publication-type="journal">FlutreT, Duprat E, Feuillet C, Quesneville H (2011) Considering Transposable Element Diversification in De Novo Annotation Approaches. PLoS ONE <volume>6(1)</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0091929-Benson1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Benson</surname><given-names>G</given-names></name> (<year>1999</year>) <article-title>Tandem repeats finder: a program to analyze DNA sequences</article-title>. <source>Nucleic Acids Res</source>
<volume>27(2)</volume>: <fpage>573</fpage>–<lpage>580</lpage>.<pub-id pub-id-type="pmid">9862982</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0091929-Eddy1">
      <label>9</label>
      <mixed-citation publication-type="journal">Eddy SR (2011) Accelerated Profile HMM Searches. PLoS Comput. Biol. <volume>7(10)</volume>.</mixed-citation>
    </ref>
  </ref-list>
</back>
