<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1891116</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-8-148</article-id>
    <article-id pub-id-type="pmid">17484781</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-8-148</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>primetv: a viewer for reconciled trees</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Sennblad</surname>
          <given-names>Bengt</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>bengt.sennblad@sbc.su.se</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Schreil</surname>
          <given-names>Eva</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>Eva.Schreil.1448@student.uu.se</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Berglund Sonnhammer</surname>
          <given-names>Ann-Charlotte</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>Ann-Charlotte.Sonnhammer@lcb.uu.se</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Lagergren</surname>
          <given-names>Jens</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>jensl@csc.kth.se</email>
      </contrib>
      <contrib id="A5" corresp="yes" contrib-type="author">
        <name>
          <surname>Arvestad</surname>
          <given-names>Lars</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>arve@csc.kth.se</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Stockholm Bioinformatics Center and Department of Biochemistry and Biophysics, Stockholm University, SE-106 91, Stockholm, Sweden</aff>
    <aff id="I2"><label>2</label>Stockholm Bioinformatics Center and School of Computer Science and Communication, KTH, SE-100 44, Stockholm, Sweden</aff>
    <aff id="I3"><label>3</label>Now at Linnaeus Centre for Bioinformatics and Uppsala Multidisciplinary Center for Advanced Computational Science, Uppsala University, BMC, Box 598, SE-751 24 Uppsala, Sweden</aff>
    <pub-date pub-type="collection">
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>5</month>
      <year>2007</year>
    </pub-date>
    <volume>8</volume>
    <fpage>148</fpage>
    <lpage>148</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/8/148"/>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>10</month>
        <year>2006</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>5</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright Â© 2007 Sennblad et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2007</copyright-year>
      <copyright-holder>Sennblad et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Sennblad
               Bengt
               
               bengt.sennblad@sbc.su.se
            </dc:author><dc:title>
            primetv: a viewer for reconciled trees
         </dc:title><dc:date>2007</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 8(1): 148-. (2007)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2007)8:1&#x0003c;148&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Evolutionary processes, such as gene family evolution or parasite-host co-speciation, can often be viewed as a tree evolving inside another tree. Relating two given trees under such a constraint is known as reconciling them. Adequate software tools for generating illustrations of tree reconciliations are instrumental for presenting and communicating results and ideas regarding these phenomena. Available visualization tools have been limited to illustrations of the most parsimonious reconciliation. However, there exists a plethora of biologically relevant non-parsimonious reconciliations. Illustrations of these <italic>general </italic>reconciliations may not be achieved without manual editing.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We have developed a new reconciliation viewer, primetv. It is a simple and compact visualization program that is the first automatic tool for illustrating <italic>general </italic>tree reconciliations. It reads reconciled trees in an extended Newick format and outputs them as tree-within-tree illustrations in a range of graphic formats. Output attributes, such as colors and layout, can easily be adjusted by the user. To enhance the construction of input to primetv, two helper programs, readReconciliation and reconcile, accompany primetv. Detailed examples of all programs' usage are provided in the text. For the casual user a web-service provides a simple user interface to all programs.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>With primetv, the first visualization tool for <italic>general </italic>reconciliations, illustrations of trees-within-trees are easy to produce. Because it clarifies and accentuates an underlying structure in a reconciled tree, e.g., the impact of a species tree on a gene-family phylogeny, it will enhance scientific presentations as well as pedagogic illustrations in an educational setting. primetv is available at <ext-link ext-link-type="uri" xlink:href="http://prime.sbc.su.se/primetv"/>, both as a standalone command-line tool and as a web service. The software is distributed under the GNU General Public License.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Illustrating evolution using phylogenetic trees is a natural way of depicting evolutionary processes. Indeed, already Darwin drew trees and there exist many tools for automatically producing graphical representations of phylogenies. Some phenomena are, however, better viewed as trees-within-trees. For example, gene family evolution should be put in the context of species evolution, parasite evolution is best understood in relation to a host tree, and a speciation process that is affected by geological processes, such as continental breakup and movement, is often viewed as a species tree that evolves within an area tree. The relation between the two trees is called a <italic>reconciliation </italic>[<xref ref-type="bibr" rid="B1">1</xref>]. More precise, a reconciliation describes how a <italic>guest tree</italic>, <italic>G </italic>(e.g., a gene tree in the case of gene evolution), evolves <italic>inside </italic>a <italic>host tree</italic>, <italic>S </italic>(e.g., a species tree), and allows the prediction and dating of evolutionary events (e.g., gene duplications or speciations) corresponding to vertices of <italic>G </italic>with respect to <italic>S</italic>. A special case is the <italic>most parsimonious reconciliation</italic>, <italic>MPR</italic>, i.e., the reconciliation that minimizes the number of evolutionary events. In order to avoid confusion, we will here use the term <italic>general reconciliation </italic>to indicate the set of all possible reconciliations (i.e., <italic>not </italic>restricted to <italic>MPR</italic>s).</p>
    <p>Illustrations of these phenomena are common in the literature today, but, apart from <italic>MPR</italic>s, graphic representations of general reconciliations must be created by hand. Early support for viewing <italic>MPR</italic>swas available in COMPONENT [<xref ref-type="bibr" rid="B2">2</xref>], GeneTree [<xref ref-type="bibr" rid="B3">3</xref>] and TreeMap [<xref ref-type="bibr" rid="B4">4</xref>], featuring a nested view of co-evolving trees as well as an opportunity to look at them side-by-side. The Mesquite [<xref ref-type="bibr" rid="B5">5</xref>] coalescence package also provides automatic calculation and viewing of <italic>MPR</italic>s. The tree viewer ATV [<xref ref-type="bibr" rid="B6">6</xref>] has support for displaying vertices corresponding to gene duplications in a different color, thus implicitly defining the reconciliation, but the relation to the species tree is not directly visualized. The ATV interface has been inherited and improved in Notung [<xref ref-type="bibr" rid="B7">7</xref>], which is a program for e.g. gene family analysis, including methods for tree reconstruction, <italic>MPR</italic>sand gene-tree rooting. The RAP system [<xref ref-type="bibr" rid="B8">8</xref>] visualizes <italic>MPR</italic>s similar to ATV, but also  supports interactions with databases through a graphical  query language for gene tree features, thereby helping the  user find gene families with a given evolutionary pattern. DupLoss [<xref ref-type="bibr" rid="B9">9</xref>] displays <italic>MPR</italic>sbut is an exploratory tool for algorithmic research rather than a general reconciliation viewer and cannot, for example, read input with arbitrary leaf names. Another approach to identify duplications, that implicitly relies on  <italic>MPR</italic>s, is taken by TreeSimplifier [<xref ref-type="bibr" rid="B10">10</xref>], which shows guest  trees on a hyperbolic surface and supports collapsing  subtrees that are isomorphic to the host tree. Finally, we  mention TreeDyn [<xref ref-type="bibr" rid="B11">11</xref>], a powerful tree editor that, while not  directly handling reconciliations, allows visualization of  relations between leaves in host trees and guest trees. We present primetv (<italic>PrIME </italic>Tree Viewer, PrIME is Probabilistic Inference of Models of Evolution), to our knowledge the first computer program that produce tree-within-tree illustrations of general reconciliations, i.e., not restricted to <italic>MPR</italic>s. For convenience, a primetv web service is also available where a user can create illustrations without installing any software.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>Input to primetv is a host tree, <italic>S </italic>(typically a species tree), and a reconciled tree, (<italic>G</italic>, <italic>Î³</italic>), where the guest tree, <italic>G</italic>, typically is a gene tree and <italic>Î³ </italic>is a reconciliation between <italic>G </italic>and <italic>S</italic>. Formally, the reconciliation is a mapping between vertices in <italic>G </italic>and the edges in <italic>S </italic>on which they evolve. A <italic>reconciled tree </italic>is a guest tree given together with a reconciliation.</p>
    <p>The output of primetv is an illustration of <italic>S</italic>, <italic>G </italic>and <italic>Î³ </italic>that has <italic>G </italic>nested in <italic>S </italic>(see Figure <xref ref-type="fig" rid="F1">1</xref> for an example): The host tree <italic>S </italic>is drawn using wide edges and ellipses for vertices. The guest tree is drawn using narrow edges and circles or squares for the vertices: Vertices in <italic>G </italic>that <italic>Î³ </italic>associates with vertices in <italic>S</italic>, i.e., speciations in the case of a gene family, are marked by circles and placed within the corresponding ellipses of <italic>S</italic>. The remaining vertices in <italic>G</italic>, i.e., duplications in gene family evolution, are marked by squares and are evenly distributed over edges in <italic>S</italic>. There is a number of options affecting colors and format of the output; these are further described in the <italic>Results and Discussion </italic>section.</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>An example reconciliation</bold>. primetv-generated illustration of the reconciled tree showing the evolution of the gene family Major Histocompatibility Complex class I in Gorilla, Orangutan, and Tamarin. The species tree is shown in blue and the gene tree in black. Gene tree vertices corresponding to speciations are indicated by circles and are placed inside species tree vertices, while duplications are indicated by squares. Species names are given in italics and gene names in standard format. The numbers below species tree vertices indicate the time intervals corresponding to the incoming edge, the length of which is scaled according to this number.</p>
      </caption>
      <graphic xlink:href="1471-2105-8-148-1"/>
    </fig>
    <p>primetv is written to work closely with output from <italic>PrIME </italic>(PRobabilistic Integrated Models of Evolution), a line of tools we are writing for performing probabilistic tree reconciliations [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>]. Thus, reconciled trees from these computer programs can be used as input directly. The <italic>PrIME </italic>reconciled tree format is documented in detail at the primetv web site. In brief, it is based on the Newick [<xref ref-type="bibr" rid="B14">14</xref>] tree format. A reconciled guest tree may have additional vertex markups, of the type used in the Nexus [<xref ref-type="bibr" rid="B15">15</xref>] and NHX [<xref ref-type="bibr" rid="B16">16</xref>] formats, that indicates the host tree vertex to which it is reconciled, see example in Figure <xref ref-type="fig" rid="F2">2(f)</xref>. A user can take any phylogenetic tree, add markup following the <italic>PrIME </italic>format, and view manually constructed reconciliations. Since such an exercise is quite tedious and error prone, we provide two helper programs to simplify this task.</p>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p><bold>Input formats of primetv</bold>. <bold>(a) </bold>The host tree, <italic>S</italic>, and <bold>(b) </bold>the guest tree, <italic>G</italic>, in Newick format. <bold>(c) </bold>The leaf map between the host tree in (a) and the guest tree in (b) in tabular form. In each row, the left column has a guest tree leaf name and the right column has the associated host tree leaf name. <bold>(d, e, f) </bold>The reconciliation <italic>Î³ </italic>can be input to primetv in three different formats: <bold>(d) </bold>The <italic>full </italic>reconciliation, <italic>Î³</italic>, in tabular format. For a host tree node <italic>x </italic>(the left column), <italic>Î³</italic>(<italic>x</italic>) (the right column of the same row) comprise all guest tree vertices whose incoming edges appear on the incoming edge of <italic>x </italic>in the reconciled tree, cf. <italic>Î³</italic>(4) as indicated in Figure 3(a). Notice that a guest vertex can map to several host vertices. <bold>(e) </bold>The <italic>reduced </italic>reconciliation, <inline-formula><inline-graphic xlink:href="1471-2105-8-148-i1.gif"/></inline-formula>, in tabular format. This is achieved from a full reconciliation, <italic>Î³</italic>, by, for each host tree vertex <italic>x</italic>, removing from <italic>Î³</italic>(<italic>x</italic>) all guest vertices that are ancestral to other vertices in <italic>Î³</italic>(<italic>x</italic>), e.g., 8 in <italic>Î³</italic>(4). <bold>(f) </bold>The reconciled tree (<italic>G</italic>, <italic>Î³</italic>) in <italic>PrIME </italic>format. This is a Newick tree with <italic>PrIME </italic>tags added to tree vertices; a sequence of <italic>PrIME </italic>tags are always given within brackets and are preceded by the tag specifier &amp;&amp;PRIME. For a guest vertex, <italic>v</italic>, the tag ID indicates a unique number identifying <italic>v</italic>. If no ID-tag is given, e.g., in Newick format, identity numbers are assigned automatically. The tag AC indicates the ID-numbers of the host tree vertices that <italic>v </italic>maps to in the reduced reconciliation <inline-formula><inline-graphic xlink:href="1471-2105-8-148-i1.gif"/></inline-formula>; these host tree vertices should always form a path in the host tree. Additionally, for a leaf <italic>l</italic>, the tag S indicate the label of the host tree leaf that <italic>l </italic>maps to. When reading host trees primetv will assume that numbers after colons (:) represent (ultrametric) edge times rather than edge lengths. This can be made explicit by using the tag ET in the <italic>PrIME </italic>format.</p>
      </caption>
      <graphic xlink:href="1471-2105-8-148-2"/>
    </fig>
    <p>The first, readReconciliation, is a translator that takes a guest tree, a host tree, and a separate reconciliation description and returns a reconciled tree in <italic>PrIME</italic>-format. The input guest and host trees are in Newick or <italic>PrIME</italic>-format, and the input reconciliation is in tabular form, see Figure <xref ref-type="fig" rid="F2">2(d)</xref> and <xref ref-type="fig" rid="F2">2(e)</xref> and the <italic>Results and Discussion </italic>section. The output is in <italic>PrIME</italic>-format and can be directly fed into primetv. The second helper program, reconcile, is an implementation of Zhang's algorithm [<xref ref-type="bibr" rid="B17">17</xref>] for most parsimonious tree reconciliation. For simplicity of implementation, a quadratic time version of the least-common-ancestor subroutine was used. Its input is in the Newick or <italic>PrIME </italic>format and the output is either a reconciled tree in <italic>PrIME</italic>-format that can be directly fed to primetv, or a reconciliation in tabular format that can provide a starting point for a user's adaptation to non-<italic>MPR </italic>reconciliations.</p>
    <p>The programs are all implemented using C++. A simple graphical user interface is provided for the web-service. The GNU plotutils [<xref ref-type="bibr" rid="B18">18</xref>] package was used to generate the graphics. It has the advantage that we can produce output in a number of practical formats. Besides the popular bitmap-based image formats such as GIF and PNG, there is EPS, SVG, and FIG for vector-based illustrations that also can be manipulated and improved manually with programs such as Adobe Illustrator (Adobe Systems Inc.), Inkscape [<xref ref-type="bibr" rid="B19">19</xref>] and XFig [<xref ref-type="bibr" rid="B20">20</xref>].</p>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <p>To illustrate the competence of primetv we give two examples of its application, illustrating different inputs to primetv. These two examples also illustrate the formatting options of primetv.</p>
    <p>The first example is a test case from the major histocompatibility complex class I, <italic>MHCI</italic>, in primates, analyzed using <italic>PrIME </italic>in [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B10">10</xref>]. The species tree consists of three primates, its branch times are taken from [<xref ref-type="bibr" rid="B21">21</xref>], and the gene tree is from [<xref ref-type="bibr" rid="B22">22</xref>]. The reconciliation is estimated with <italic>PrIME </italic>and the reconciled tree from <italic>PrIME </italic>is used as input to primetv. The output from primetv is presented in Figure <xref ref-type="fig" rid="F1">1</xref>.</p>
    <p>The relation between the gene tree and the species tree is clear when using primetv: Identifying the gene tree's speciation vertices and their corresponding vertices in the species tree is straightforward. Gene losses are also apparent from missing gene lineages at speciations in the species tree. Another advantage with this type of illustration is that deciding which species a gene belongs to is immediate; you do not need to rely on a prefix or suffix notation in the gene names. Notice that the reconciliation in Figure <xref ref-type="fig" rid="F1">1</xref> is not the <italic>MPR</italic>: the second gene tree vertex from the left in Figure <xref ref-type="fig" rid="F1">1</xref> would in the <italic>MPR </italic>be denoted as a speciation. However, as described in [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>], if auxiliary evidence, i.e., <italic>MHCI </italic>representatives from the human genome, is included it becomes evident, also with the most parsimonious reconciliation, that this vertex indeed represent a duplication. The ability to output non-<italic>MPR </italic>illustrations is currently unique to primetv.</p>
    <p>The second example illustrates how to manually construct input to primetv using readReconciliation or reconcile. Assume that we want to reconcile the guest tree <italic>G </italic>to the host tree <italic>S</italic>, Figure <xref ref-type="fig" rid="F3">3(b)</xref> and <xref ref-type="fig" rid="F3">3(c)</xref> respectively, to achieve the reconciled tree in Figure <xref ref-type="fig" rid="F3">3(a)</xref>. The input to readReconciliation comprises <italic>S </italic>and <italic>G </italic>in Newick- (Figure <xref ref-type="fig" rid="F2">2(a)</xref> and <xref ref-type="fig" rid="F2">2(b)</xref>, respectively) or <italic>PrIME</italic>-format, and a reconciliation in tabular format as described below. The reconciliation associates vertices in <italic>S </italic>with vertices in <italic>G </italic>using their unique identity number. The <italic>PrIME </italic>programs, including primetv, automatically assign such identity numbers in a consistent way, and primetv can be used to view the assigned identity numbers, e.g., Figure <xref ref-type="fig" rid="F3">3(b)</xref> and <xref ref-type="fig" rid="F3">3(c)</xref> shows automatically assigned identity numbers on <italic>G </italic>and <italic>S</italic>, respectively. However, as a convenience user-defined identity numbers (that override the automatic identity numbers) can be assigned using the tag ID in the tree file, as exemplified in Figure <xref ref-type="fig" rid="F2">2(f)</xref>.</p>
    <fig position="float" id="F3">
      <label>Figure 3</label>
      <caption>
        <p><bold>primetv output versatility</bold>. primetv output illustrations associated with the data given in Figure 2. <bold>(a) </bold>The reconciled tree (<italic>G</italic>, <italic>Î³</italic>), with <italic>Î³</italic>(4) indicated with a dashed line. <bold>(b, c) </bold>The guest tree- and host tree-parts, respectively, of the reconciled tree (<italic>G</italic>, <italic>Î³</italic>) in Figure 3(a). <bold>(d) </bold>The most parsimonious reconciled tree between the host tree and the guest tree in Figure 2. The host tree is given in yellow and orange and the guest tree is given in dark-red. Numbers by vertices indicate the unique vertex identity labels assigned by <italic>PrIME </italic>. In <bold>(a)</bold>, divergence times for host tree vertices are given on a time scale to the left. Dashed line in <bold>(a) </bold>is added, posterior to primetv output, using Adobe Illustrator (Adobe Systems Inc.).</p>
      </caption>
      <graphic xlink:href="1471-2105-8-148-3"/>
    </fig>
    <p>The tabular format for the reconciliation is given as a two column table where, for each row, the left column holds the identity number of a host tree vertex and the right column holds the identity numbers of the guest tree vertices reconciled to this host tree vertex. Depending on how the guest tree vertices are given, there are two 'flavors' of the tabular format. In the <italic>full </italic>reconciliation, denoted <italic>Î³</italic>, the right column comprise the guest tree vertices whose incoming edge appear on the incoming edge of the host tree vertex. An example is given in Figure <xref ref-type="fig" rid="F2">2(d)</xref> and row 4 in this table, i.e., <italic>Î³</italic>(4) is graphically indicated in Figure <xref ref-type="fig" rid="F3">3(a)</xref>. Notice that the guest vertices mapped to a host tree vertex in <italic>Î³ </italic>form subtrees of <italic>G</italic>. The <italic>reduced </italic>reconciliation, denoted <inline-formula><inline-graphic xlink:href="1471-2105-8-148-i1.gif"/></inline-formula>, comprises for each host vertex the leaves of these subtrees, cf. Figure <xref ref-type="fig" rid="F2">2(e)</xref>. Reduced reconciliations are generic in <italic>PrIME</italic>, but full reconciliations may be more intuitive for users. The result of readReconciliation run with <italic>S</italic>, <italic>G </italic>and either <italic>Î³ </italic>or <inline-formula><inline-graphic xlink:href="1471-2105-8-148-i1.gif"/></inline-formula> as arguments is the reconciled tree (<italic>G</italic>, <italic>Î³</italic>) shown in Figure <xref ref-type="fig" rid="F2">2(f)</xref>. Here the tag AC for a guest tree vertex <italic>v </italic>comprise the host vertices to which <italic>v </italic>is mapped in the reduced reconciliation (i.e., the inverse of <inline-formula><inline-graphic xlink:href="1471-2105-8-148-i1.gif"/></inline-formula>). The primetv output for this reconciled tree is given in Figure <xref ref-type="fig" rid="F3">3(a)</xref>.</p>
    <p>The program reconcile produces most parsimonious reconciliations, <italic>MPR</italic>s, of trees. It takes as input a host tree and a guest tree in Newick format and a leaf-map in tabular format that maps the name of a guest tree leaf to the name of the corresponding host tree leaf, see example in Figure <xref ref-type="fig" rid="F2">2(c)</xref>. The output is either the most parsimonious reconciliation, <italic>Î³</italic>*, in tabular format, or the reconciled tree (<italic>G</italic>, <italic>Î³</italic>*) in <italic>PrIME </italic>format. The output reconciliation in tabular form may be used as a starting point for the construction of user-defined reconciliations. The reconciled tree output can be fed directly to primetv; the most parsimonious reconciled tree for the host tree and guest tree in Figure <xref ref-type="fig" rid="F2">2</xref> is shown in Figure <xref ref-type="fig" rid="F3">3(d)</xref>.</p>
    <p>As a further convenience, the programs can be accessed using the web interface, <ext-link ext-link-type="uri" xlink:href="http://prime.sbc.su.se/primetv"/>. There, guest and host trees in <italic>PrIME </italic>format are put into text boxes. The user can then choose between creating an <italic>MPR </italic>or giving a reconciliation on a tabular or <italic>PrIME </italic>format; if the <italic>MPR </italic>alternative is chosen, an additional leaf map (which for easy cases is deduced automatically) is needed as input to reconcile. In either case a primetv-generated illustration is presented along with options for layout and color changes. The computed reconciliation is also given in a text box to allow for modifications and immediate updates of the illustration.</p>
    <p>Figures <xref ref-type="fig" rid="F1">1</xref> and <xref ref-type="fig" rid="F3">3</xref> also illustrate the customization options available in primetv. The layout can be altered in various ways: The tree in Figure <xref ref-type="fig" rid="F1">1</xref> is drawn horizontally, ladderized right and with the subtrees positioned asymmetrically, while the tree in Figure <xref ref-type="fig" rid="F3">3(a)</xref> is drawn vertically, ladderized right and with subtrees distributed symmetrically. In these figures, the host tree edges are scaled in relation to their edge times; This scaling, however, can be removed as in Figure <xref ref-type="fig" rid="F3">3(d)</xref>. It is also possible to remove either the guest tree, as in Figure <xref ref-type="fig" rid="F3">3(c)</xref>, or the host tree, as in Figure <xref ref-type="fig" rid="F3">3(b)</xref>. For this last option no host tree needs to be given, thus primetv can be used to illustrate any tree, i.e., not only reconciled trees. Colors of guest and host tree vertices and edges are highly customizable and examples are shown in Figures <xref ref-type="fig" rid="F1">1</xref> and <xref ref-type="fig" rid="F3">3</xref>. Some annotation can also be customized. The time annotation of the host tree can be shown as divergence times on a time axis, as in Figure <xref ref-type="fig" rid="F3">3(a)</xref>, or as the time intervals associated with host tree edges, as in Figure <xref ref-type="fig" rid="F1">1</xref>. As shown in Figure <xref ref-type="fig" rid="F3">3(b)</xref> and <xref ref-type="fig" rid="F3">3(c)</xref>, vertex annotation with identity numbers assigned by <italic>PrIME </italic>can be shown. Further options not shown include scaling of fonts and change of page size or bitmap size. The result can be shown on an X11-window or saved to file in a number of formats, see section <italic>Implementation</italic>.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>Our tool primetv is a simple and compact computer program dedicated to visualizing reconciled trees. It is the first tool to visualize <italic>general </italic>reconciliations and not only <italic>MPR</italic>s. primetv visualizes reconciled trees as trees within trees. This type of illustration clarifies and accentuates the underlying structure in a reconciled tree, for example the impact of a species tree on a gene family phylogeny or how parasite evolution has followed its host species. Many visualization attributes, such as colors and layout parameters, can be adjusted according to the user's needs, thus making it possible to adapt the style of the illustration to the style of a presentation. The range of output formats make adaptation easier as well.</p>
    <p>These attributes makes primetv a powerful tool for illustrations of gene family histories, orthology analysis, biogeography and co-speciation studies, especially since primetv allows for alternative reconciliations. primetv has formats suitable for manuscript preparation, immediate inspection, web applications, and presentations. The clarity and intuitiveness of trees-within-trees illustrations is also ideal for pedagogic illustrations of the above-mentioned processes in an educational setting.</p>
    <p>Two programs distributed jointly with primetv simplify input adaption by removing the need to create input by hand. The primary user interface of primetv is the command line, hence it is easy to include it into scripts allowing automatic visualizations in large data sets. For the casual user, the web interface provides a simple GUI and also avoids the need for installing software.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p><bold>Project name: </bold>primetv</p>
    <p>
      <bold>Project home page: </bold>
      <ext-link ext-link-type="uri" xlink:href="http://prime.sbc.su.se/primetv"/>
    </p>
    <p>Release 1.5.3 of primetv is also distributed with this manuscript [see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>].</p>
    <p><bold>Operating systems: </bold>primetv has been tested on Linux systems (Red Hat 9 and Fedora Core 3), Mac OS X (10.3.9 and 10.4.5) and Microsoft Windows (cygwin 1.5.18-1).</p>
    <p><bold>Programming languages: </bold>The software is a command-line tool written in C++. We have compiled primetv using the GNU C and C++ compilers,  both versions 3.4, 4.0.01 (Mac OS X), and 4.1 (Linux). </p>
    <p>The casual user is recommended to use our web server which, besides being platform independent, provides an easy-to-use user interface.</p>
    <p><bold>Other requirements: </bold>The graphics interface of primetv makes use of the GNU plotutils [<xref ref-type="bibr" rid="B18">18</xref>] package. There are a couple of adjustments to plotutils needed to compile on Linux using a modern C++ compiler. The patched source are available on our website, where we have also put executable binaries. For Mac OS X and Microsoft Windows, patched versions of plotutils are available, e.g., through MacPorts and Cygwin [<xref ref-type="bibr" rid="B23">23</xref>], respectively.</p>
    <p><bold>License: </bold>The software is distributed under the GNU General Public License.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>This project was conceived and supervised by BS, ACBS, JL, and LA. ES wrote most of the software. BS and LA contributed code and wrote this article. LA implemented the web interface.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p>Relase 1.5.3 of primetv. The source code distribution of primetv.</p>
      </caption>
      <media xlink:href="1471-2105-8-148-S1.gz" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>The authors wishes to express their thanks to Rod Page and two anonymous reviewers for valuable comments on the manuscript. This work was funded by the Foundation for Strategic Research (SSF), the Swedish Research Council and Carl Tryggers Stiftelse.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Czelusniak</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Romero-Herrera</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Matsuda</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Fitting the gene lineage into its species lineage, a parsimony strategy illustrated by cladograms</article-title>
        <source>Syst Zool</source>
        <year>1979</year>
        <volume>28</volume>
        <fpage>132</fpage>
        <lpage>163</lpage>
        <pub-id pub-id-type="doi">10.2307/2412519</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Page</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>COMPONENT: Tree comparison software for Microsoft Windows, Version 2.0</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://taxonomy.zoology.gla.ac.uk/rod/cpw.html"/>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Page</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>GeneTree: comparing gene and species phylogenies using reconciled trees</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>819</fpage>
        <lpage>820</lpage>
        <pub-id pub-id-type="pmid">9918954</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/14.9.819</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Charleston</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Page</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>TreeMap</article-title>
        <year>2000</year>
        <ext-link ext-link-type="uri" xlink:href="http://taxonomy.zoology.gla.ac.uk/rod/treemap.html"/>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Maddison</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>Maddison</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Mesquite: a modular system for evolutionary analysis, version 1.06</article-title>
        <year>2005</year>
        <ext-link ext-link-type="uri" xlink:href="http://mesquiteproject.org"/>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zmasek</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>ATV: Display and manipulation of annotated phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>383</fpage>
        <lpage>384</lpage>
        <pub-id pub-id-type="pmid">11301314</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/17.4.383</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Halldorsson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Vernot</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A hybrid micro-macroevolutionary approach to gene tree reconstruction</article-title>
        <source>J Comput Biol</source>
        <year>2006</year>
        <volume>13</volume>
        <fpage>320</fpage>
        <lpage>335</lpage>
        <pub-id pub-id-type="pmid">16597243</pub-id>
        <pub-id pub-id-type="doi">10.1089/cmb.2006.13.320</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dufayard</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Duret</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Penel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gouy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rechenmann</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Perriere</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Tree pattern matching in phylogenetic trees: automatic search for orthologs or paralogs in homologous gene sequence databases</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>2596</fpage>
        <lpage>2603</lpage>
        <pub-id pub-id-type="pmid">15713731</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti325</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>BÃ©langer</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hallet</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>DupLoss: A Java Module for Computing and Drawing Gene Duplication-Loss Events</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.sable.mcgill.ca/~dbelan2/duploss/applet/duploss.html"/>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lott</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Mundry</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sassenberg</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lorkowski</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fuellen</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Simplifying gene trees for easier comprehension</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>231</fpage>
        <pub-id pub-id-type="pmid">16643669</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-231</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chevenet</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brun</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Banuls</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Jacq</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Christen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>TreeDyn: towards dynamic graphics and annotations for analyses of trees</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>439</fpage>
        <pub-id pub-id-type="pmid">17032440</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-439</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arvestad</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Berglund</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Lagergren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sennblad</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Bayesian gene/species tree reconciliation and orthology analysis using MCMC</article-title>
        <source>Bioinformatics/ISMB'03</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>i7</fpage>
        <lpage>i15</lpage>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Arvestad</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Berglund</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Lagergren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sennblad</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Gene tree reconstruction and orthology analysis based on an integrated model for duplications and sequence evolution</article-title>
        <source>Proc of RECOMB</source>
        <year>2004</year>
        <fpage>326</fpage>
        <lpage>335</lpage>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>James Archie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Day</surname>
            <given-names>WHE</given-names>
          </name>
          <name>
            <surname>Maddison</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Meacham</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rohlf</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Swofford</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The Newick tree format</article-title>
        <year>1986</year>
        <ext-link ext-link-type="uri" xlink:href="http://evolution.genetics.washington.edu/phylip/newicktree.html"/>
        <pub-id pub-id-type="pmid">3024605</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maddison</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Swofford</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Maddison</surname>
            <given-names>WP</given-names>
          </name>
        </person-group>
        <article-title>NEXUS: An extensible file format for systematic information</article-title>
        <source>Syst Biol</source>
        <year>1997</year>
        <volume>46</volume>
        <fpage>590</fpage>
        <lpage>621</lpage>
        <pub-id pub-id-type="pmid">11975335</pub-id>
        <pub-id pub-id-type="doi">10.2307/2413497</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Zmasek</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>NHX â New Hampshire eXtended</article-title>
        <year>2001</year>
        <ext-link ext-link-type="uri" xlink:href="http://www.phylogenomics.us/forester/NHX.html"/>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>On a Mirkin-Muchnik-Smith conjecture for comparing molecular phylogenies</article-title>
        <source>J Comput Biol</source>
        <year>1997</year>
        <volume>4</volume>
        <fpage>177</fpage>
        <lpage>187</lpage>
        <pub-id pub-id-type="pmid">9228616</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="other">
        <article-title>GNU Plotutils</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.gnu.org/software/plotutils"/>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="other">
        <article-title>Inkscape: Open Source Scalable Vector Graphics Editor</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.inkscape.org"/>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Sutanthavibul</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>BV</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>XFIG Drawing Program for the X Window System</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.xfig.org"/>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arnason</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Janke</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Mitogenomic analyses of eutherian relationships</article-title>
        <source>Cytogenet Genome Res</source>
        <year>2002</year>
        <volume>96</volume>
        <fpage>20</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="pmid">12438776</pub-id>
        <pub-id pub-id-type="doi">10.1159/000063023</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Sitnikova</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Evolution by the birth-and-death process in multigene families of vertebrate immune system</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1997</year>
        <volume>94</volume>
        <fpage>7799</fpage>
        <lpage>7806</lpage>
        <pub-id pub-id-type="pmid">9223266</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.94.15.7799</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="other">
        <article-title>Cygwin</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.cygwin.com/"/>
      </citation>
    </ref>
  </ref-list>
</back>
