<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS One</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10237437</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0286314</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-23-01135</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Phylogenetic Analysis</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Animals</subject>
              <subj-group>
                <subject>Vertebrates</subject>
                <subj-group>
                  <subject>Amniotes</subject>
                  <subj-group>
                    <subject>Mammals</subject>
                    <subj-group>
                      <subject>Primates</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Zoology</subject>
          <subj-group>
            <subject>Animals</subject>
            <subj-group>
              <subject>Vertebrates</subject>
              <subj-group>
                <subject>Amniotes</subject>
                <subj-group>
                  <subject>Mammals</subject>
                  <subj-group>
                    <subject>Primates</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Nucleotide Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Nucleotide Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Sequence Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Bioenergetics</subject>
            <subj-group>
              <subject>Energy-Producing Organelles</subject>
              <subj-group>
                <subject>Mitochondria</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Structures and Organelles</subject>
            <subj-group>
              <subject>Energy-Producing Organelles</subject>
              <subj-group>
                <subject>Mitochondria</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Organismal Evolution</subject>
            <subj-group>
              <subject>Animal Evolution</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PyKleeBarcode: Enabling representation of the whole animal kingdom in information space</article-title>
      <alt-title alt-title-type="running-head">PyKleeBarcode: Enabling representation of the whole animal kingdom in information space</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8854-7235</contrib-id>
        <name>
          <surname>Duchemin</surname>
          <given-names>Wandrille</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thaler</surname>
          <given-names>David S.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>sciCORE Center for Scientific Computing, University of Basel, Basel, Switzerland</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Biozentrum, University of Basel, Basel, Switzerland</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Program for the Human Environment, Rockefeller University, New York, NY, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cserhati</surname>
          <given-names>Matthew</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>AbbVie Inc, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>wandrille.duchemin@unibas.ch</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>18</volume>
    <issue>6</issue>
    <elocation-id>e0286314</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 Duchemin, Thaler</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Duchemin, Thaler</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0286314.pdf"/>
    <abstract>
      <p>As biological sequence databases continue growing, so do the insight that they promise to shed on the shape of the genetic diversity of life. However, to fulfil this promise the software must remain usable, be able to accommodate a large amount of data and allow use of modern high performance computing infrastructure. In this study we present a reimplementation as well as an extension of a technique using indicator vectors to compute and visualize similarities between sets of nucleotide sequences. We have a flexible and easy to use python program relying on standard and open-source libraries. Our tool allows analysis of very large complement of sequences using code parallelization, as well as by providing routines to split a computational task in smaller and manageable subtasks whose results are then merged. This implementation also facilitates adding new sequences into an indicator vector-based representation without re-computing the whole set. The efficient synthesis of data into knowledge is no trivial matter given the size and rapid growth of biological sequence databases. Based on previous results regarding the properties of indicator vectors, the open-source approach proposed here efficiently and flexibly supports comparative analysis of genetic diversity at a large scale. Our software is freely available at: <ext-link xlink:href="https://github.com/WandrilleD/pyKleeBarcode" ext-link-type="uri">https://github.com/WandrilleD/pyKleeBarcode</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100021373</institution-id>
            <institution>Swiss Institute of Bioinformatics</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8854-7235</contrib-id>
          <name>
            <surname>Duchemin</surname>
            <given-names>Wandrille</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100017651</institution-id>
            <institution>Richard Lounsbery Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>"A Cosmic View of Life on Earth"</award-id>
        <principal-award-recipient>
          <name>
            <surname>Thaler</surname>
            <given-names>David S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100017651</institution-id>
            <institution>Richard Lounsbery Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>"A Cosmic View of Life on Earth"</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8854-7235</contrib-id>
          <name>
            <surname>Duchemin</surname>
            <given-names>Wandrille</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This research was funded by the SIB Swiss Institute of Bioinformatics. WD and DT were supported in this research by the Lounsbery Foundation grant "A Cosmic View of Life on Earth". The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. URL of funder websites: * sib.swiss * <ext-link xlink:href="https://www.rlounsbery.org/" ext-link-type="uri">https://www.rlounsbery.org/</ext-link>.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="0"/>
      <page-count count="14"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The code, documentation, and instruction of use for PyKleeBarcode can be found in the GitHub repository (<ext-link xlink:href="https://github.com/WandrilleD/pyKleeBarcode" ext-link-type="uri">https://github.com/WandrilleD/pyKleeBarcode</ext-link>). All relevant data and code for the experiment conducted in this article can be found in the GitHub repository (<ext-link xlink:href="https://github.com/WandrilleD/pyKleeBarcode-publication-supporting-code-and-data" ext-link-type="uri">https://github.com/WandrilleD/pyKleeBarcode-publication-supporting-code-and-data</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The code, documentation, and instruction of use for PyKleeBarcode can be found in the GitHub repository (<ext-link xlink:href="https://github.com/WandrilleD/pyKleeBarcode" ext-link-type="uri">https://github.com/WandrilleD/pyKleeBarcode</ext-link>). All relevant data and code for the experiment conducted in this article can be found in the GitHub repository (<ext-link xlink:href="https://github.com/WandrilleD/pyKleeBarcode-publication-supporting-code-and-data" ext-link-type="uri">https://github.com/WandrilleD/pyKleeBarcode-publication-supporting-code-and-data</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The study of biological evolution through comparing linear sequences from different species, now known as molecular phylogeny, was first proposed by Crick in a 1957 lecture [<xref rid="pone.0286314.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0286314.ref002" ref-type="bibr">2</xref>]. The passage that heralds the coming of molecular phylogeny is clear and to the point:</p>
    <disp-quote>
      <p>“Biologists should realize that before long we shall have a subject which might be called ’protein taxonomy’ -the study of the amino acid sequences of the proteins of an organism and the comparison of them between species. It can be argued that these sequences are the most delicate expression possible of the phenotype of an organism and that vast amounts of evolutionary information may be hidden away within them.”</p>
    </disp-quote>
    <p>Linear sequence analysis of proteins from different species combined with paleontology to estimate chronological time of their divergence gave rise to the concept of a ‘molecular clock’ [<xref rid="pone.0286314.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0286314.ref004" ref-type="bibr">4</xref>], which proposes a constant number of amino acid changes per year in chronological time [<xref rid="pone.0286314.ref005" ref-type="bibr">5</xref>]. Directly inspired by the molecular clock, the neutral theory of evolution proposes that many sequence changes in evolution result from population effects such as drift, minor intermittent selection, and bottlenecks [<xref rid="pone.0286314.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0286314.ref007" ref-type="bibr">7</xref>]. The subsequent advent and development of DNA sequencing led Kimura to explicitly extend the neutral theory to DNA sequences with the reasonable hypothesis that synonymous mutations were neutral [<xref rid="pone.0286314.ref008" ref-type="bibr">8</xref>]. While the neutrality of synonymous sequences is not 100% valid, it is a useful first order approximation in many systems [<xref rid="pone.0286314.ref009" ref-type="bibr">9</xref>].</p>
    <p>Woese and colleagues pioneered the use of small subunit ribosomal RNAs to construct phylogenies that encompass all of cellular life [<xref rid="pone.0286314.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0286314.ref011" ref-type="bibr">11</xref>]. SSU RNAs have two important features in this regard: a) Presence and sufficient similarity in all cellular life to allow them to be aligned and compared. b) Abundance and relative stability, facilitating their purification and characterization. Molecular methods including in situ hybridization and PCR allowed the characterization of SSU RNAs and the genes encoding them in situ including uncultured and unculturable organisms [<xref rid="pone.0286314.ref012" ref-type="bibr">12</xref>].</p>
    <p>Mitochondrial genomes are small in size, lack recombination, and are technically straightforward in terms of molecular biology because their copy number is approximately a thousand times greater than nuclear genes. Mitochondrial analysis both confirmed and refined other methods for species and population identification, especially among animals [<xref rid="pone.0286314.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0286314.ref014" ref-type="bibr">14</xref>] but with certain caveats among other Eukaryotes, e.g., plants and fungi, as well [<xref rid="pone.0286314.ref015" ref-type="bibr">15</xref>]. Hebert and colleagues proposed that a partial segment of the mitochondrial genome agreed upon by the community could universalize and democratize species identification [<xref rid="pone.0286314.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0286314.ref017" ref-type="bibr">17</xref>]. The particular mitochondrial sequence that has become the most widely used, a 648 base pair (bp) segment of the gene encoding mitochondrial cytochrome c oxidase subunit I (COI), became most widely adopted because reliable primers and methods useful for both vertebrates and invertebrates were adopted by a critical mass of the community. Intrinsically, there is nothing special about the mtCOI DNA barcode region compared to other protein-encoding regions of the mitochondrial genome [<xref rid="pone.0286314.ref018" ref-type="bibr">18</xref>].</p>
    <p>The Barcode Of Life Database (BOLD) is an open access compilation including mtCOI barcode data from approximately five million individuals that collectively cover a great deal of the extant animal kingdom [<xref rid="pone.0286314.ref019" ref-type="bibr">19</xref>]. The BOLD approach is a different approach in the world of sequence analysis because it is a small proportion of the genome (e.g., in humans less than one millionth of the total genome) but is available from many different individuals in many species. For many animal species DNA barcodes are the only sequence information available. The use of BOLD was first limited to species identification. The broad but not deep nature of barcode data can be used for more than identification, they can support phylogenic reconstructions and evolutionary models [<xref rid="pone.0286314.ref020" ref-type="bibr">20</xref>].</p>
    <p>A method of choice to extract and recapitulate the evolutionary information contained in a set of homologous sequences is to construct a phylogenetic tree based on the of likelihood of a substitution model. These methods have benefitted from numerous advances in the past decades, but the explosion of the number of possible tree topologies as the number of leaves increase—(2n-5)!!, unrooted topologies for n leaves–still makes the reconstruction of phylogenetic trees with tens of thousands of sequences using likelihood methods daunting (although there exist strategies to improve the scalability using phylogenetic placement, see [<xref rid="pone.0286314.ref021" ref-type="bibr">21</xref>]). Aside from computational consideration, one has to consider cases where the evolutionary history of sequences does not follow a strictly tree-like pattern because of horizontal and modular evolution [<xref rid="pone.0286314.ref022" ref-type="bibr">22</xref>].</p>
    <p>Sirovich and colleagues developed an innovative approach to allow multiple DNA sequences both within and among many animal species to be compared such that the overall structure of animal life within and among species can be visualized [<xref rid="pone.0286314.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>]. Their method relies on a contrastive approach to build indicator vectors which recapitulates the genetic information of a sequence, or a group of sequence, which can then be used to probe the genetic diversity, or closedness of the taxonomic groups they represent, for example in the form of a similarity matrix called the structure matrix. Visualization of the structure matrix has been a valuable part of a number of publications [<xref rid="pone.0286314.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0286314.ref025" ref-type="bibr">25</xref>–<xref rid="pone.0286314.ref031" ref-type="bibr">31</xref>]. However, the indicator vector and structure matrix approach for the comparative study of DNA sequences has not yet been utilized to its full potential. The present work was originally motivated to make the prior work of Sirovich and colleagues more accessible as the implementation of software to compute the indicator vectors and Klee diagrams has been limited to the original code released with [<xref rid="pone.0286314.ref023" ref-type="bibr">23</xref>] (currently available at <ext-link xlink:href="https://phe.rockefeller.edu/barcode/klee.php" ext-link-type="uri">https://phe.rockefeller.edu/barcode/klee.php</ext-link>), which runs on an older version of a proprietary commercial software, Matlab2009a, a not only unmaintained version, but whose documentation is no longer available on the developer’s website. We used the opportunity of a re-implementation to introduce significant extensions to the original methods, in particular to accommodate a variable number of sequences per species, and provide a more flexible interface to the computational steps involved in going from a multiple sequence alignment to a structure matrix. Refactoring the process into separate steps allowed an efficient and scalable parallelization of the pipeline, as well as adding flexibility. In the previous Matlab implementation updating a structure matrix with one or several new sequences required recomputing it entirely. Separation of different steps in the implementation grants additional flexibility, both computationally and conceptually. Real-life datasets from BOLD (The Barcode Of Life Database) are used to illustrate the new implementation and in places contrast it with the published Matlab-based method.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <sec id="sec003">
      <title>Derivation of the original method’s formula</title>
      <p>After a series of pre-processing steps, which are detailed in the result section of this manuscript as well as in [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>], the multiple sequence alignment is split in several sequence sets.</p>
      <p>A set of sequence <italic toggle="yes">i</italic> is represented as matrix <italic toggle="yes">s</italic><sub><italic toggle="yes">i</italic></sub> of size <italic toggle="yes">m</italic>×<italic toggle="yes">s</italic>⋅4, where <italic toggle="yes">m</italic> is the number of sequences in the sequence set and <italic toggle="yes">s</italic> is the sequence size, in nucleotides.</p>
      <p>Then, the indicator vector of sequence set <italic toggle="yes">i</italic> is computed as the eigenvector with the largest positive eigenvalue of matrix:
<disp-formula id="pone.0286314.e001"><alternatives><graphic xlink:href="pone.0286314.e001.jpg" id="pone.0286314.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
, where <italic toggle="yes">N</italic> is the number of sequence sets, as defined in equation 15 of [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>]. Note that this formulation presumes that all sequence set contains the same number of sequences. We begin by writing:
<disp-formula id="pone.0286314.e002"><alternatives><graphic xlink:href="pone.0286314.e002.jpg" id="pone.0286314.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></disp-formula>
such that the previous equation can be written <inline-formula id="pone.0286314.e003"><alternatives><graphic xlink:href="pone.0286314.e003.jpg" id="pone.0286314.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p>This formula can be rewritten as:
<disp-formula id="pone.0286314.e004"><alternatives><graphic xlink:href="pone.0286314.e004.jpg" id="pone.0286314.e004g" position="anchor"/><mml:math id="M4" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Which makes it evident that once the <inline-formula id="pone.0286314.e005"><alternatives><graphic xlink:href="pone.0286314.e005.jpg" id="pone.0286314.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> matrix has been computed; the indicator vector of a sequence set can be computed independently from the other sequences. Additionally, the original method only considers the case were the number of sequences per set, noted <italic toggle="yes">m</italic>, is the same for each set. We generalize this approach to any specific number of sequences per set, noted m<sub>i</sub> for sequence set <italic toggle="yes">i</italic> by normalizing the S<sub>i</sub> matrices by m<sub>i</sub>, such that the previous equation becomes:
<disp-formula id="pone.0286314.e006"><alternatives><graphic xlink:href="pone.0286314.e006.jpg" id="pone.0286314.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Given its role of contrasting a given sequence set against all others, we call the matrix <inline-formula id="pone.0286314.e007"><alternatives><graphic xlink:href="pone.0286314.e007.jpg" id="pone.0286314.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> the reference matrix.</p>
      <p>Finally, it can be remarked that the computation of all, or parts of, the structure matrix depends only on the indicator vectors of the sequences of interest.</p>
      <p>Consequently, we describe the method of [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>] as three consecutive steps:</p>
      <list list-type="order">
        <list-item>
          <p>Computation of the reference matrix from all sequence sets</p>
        </list-item>
        <list-item>
          <p>Computation of an indicator vector for each sequence set independently</p>
        </list-item>
        <list-item>
          <p>Computation of the structure matrix from the indicator vectors of all sequence sets</p>
        </list-item>
      </list>
      <p>We detail each of these steps in the results section.</p>
    </sec>
    <sec id="sec004">
      <title>Mammalian sequences dataset</title>
      <p>In order to test and demonstrate our method, we accessed the <ext-link xlink:href="https://www.boldsystems.org/" ext-link-type="uri">Barcode Of Life Database</ext-link> [<xref rid="pone.0286314.ref019" ref-type="bibr">19</xref>] for primary COI5-P sequences of mammals. Out of the &gt;100,000 mammalian sequences, we selected a limited set, in order to facilitate results analysis and interpretation.</p>
      <p>This set was built such that each of the following mammalian taxon is represented: Afrotheria, Artiodactyla, Carnivora, Chiroptera, Dermoptera, Eulipotyphla, Glires, Metatheria, Perissodactyla, Pholidota, Primates, Prototheria, Scandentia, Xenarthra.</p>
      <p>To ensure this, we randomly selected a maximum of 40 species per taxon, and 3 sequences per species, except for Prototheria, Pholidota, Scandentia and Dermoptera where the low number of sampled species and sequences caused us to take all available sequences (resp. 3, 7, 9, and 1 species, and 7, 21, 16, and 3 sequences). The resulting set is composed of 1049 sequences spread among 354 species.</p>
      <p>The retrieved sequences were then aligned using MAFFT [<xref rid="pone.0286314.ref032" ref-type="bibr">32</xref>, <xref rid="pone.0286314.ref033" ref-type="bibr">33</xref>]. The sequence alignment extremities were then trimmed to avoid the spurious gaps resulting from differences in the size of the sequenced fragment. The resulting multiple sequence alignment presented no gaps (-), no missing base (N) characters, and 0.007% ambiguous IUPAC characters (Y,R,W,etc.).</p>
    </sec>
    <sec id="sec005">
      <title>Impact of the reference matrix on the indicator vector and structure matrix</title>
      <p>One of the new possibilities offered by our re-implementation is the possibility to compute the indicator vectors of sequences which are absent from the reference matrix. This can be useful, for instance, if a new sequence were just acquired, because it could be integrated to the structure matrix without having to re-compute it entirely.</p>
      <p>In order to evaluate the impact of an incomplete reference matrix, we devised a number of experiments where we compute the indicator vectors and structure matrix of our mammalian dataset sequences with a reference matrix computed of a limited set of sequences. We then compared these with the indicator vectors and structure matrix obtained with a complete reference matrix.</p>
      <p>The initial experiments were “primate-only”: reference matrix with primate sequences only (120 primate sequences); “no-Laurasiatheria”: reference matrix with Laurasiatherian sequences missing (488 non-Laurasiatherian sequences); and “missingXX%”: random percentages of sequences missing.</p>
      <p>For the “missingXX%”, we tested percentages from 10 to 90 percent (by increments of 10%). We performed 10 replicates per condition to assess the variability in the results.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec006">
    <title>Results</title>
    <p>We have implemented each of the following steps as an independent piece of code with its specific parallelization scheme, as well as in a single executable regrouping all three steps for convenience. All implementations were done in python3 using core modules and the publicly accessible libraries numpy, scipy, matplotlib, mpi4py. The source code is available at <ext-link xlink:href="https://github.com/WandrilleD/pyKleeBarcode" ext-link-type="uri">https://github.com/WandrilleD/pyKleeBarcode</ext-link>, complete with a documentation, tests, and example of usage with toy datasets. <xref rid="pone.0286314.g001" ref-type="fig">Fig 1</xref> gives a schematic overview of the steps involved in the process of going from an input multiple sequence alignment to a structure matrix.</p>
    <fig position="float" id="pone.0286314.g001">
      <object-id pub-id-type="doi">10.1371/journal.pone.0286314.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Schematic description of pyKleeBarcode pre-processing and steps.</title>
      </caption>
      <graphic xlink:href="pone.0286314.g001" position="float"/>
    </fig>
    <p>PyKleeBarcode takes as input a multiple sequence alignment in the fasta format, whose sequences are grouped into sequences sets, most frequently corresponding to species.</p>
    <p>The grouping of individual sequences into sets is deduced from part of the sequence name in the input fasta file, or via an association table provided using an optional argument to the script. Note that a sequence set may contain a single sequence. Also, note that while the original method from [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>] enforces the constraint that each sequence set has the same number of sequences, pyKleeBarcode allows sequence sets of different sizes.</p>
    <sec id="sec007">
      <title>Sequence alignment pre-processing steps</title>
      <p>To compute the structure matrix from a multiple sequence alignment, the DNA sequences are first pre-processed and transformed to vectors of four numbers. The pre-processing consists in a tentative imputation of the ambiguous N characters: any N character is replaced by the modal nucleotide at this position among its sequence set (typically, sequences of the same species in the multiple sequence alignment), unless that modal value is the gap character (“-”), or there are multiple non-gap character modal values, in which case the value stays N at this position. This pre-processing step is unchanged from the original method of [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>]. Then the sequences are transformed to numerical vectors where each nucleotide is represented using four numbers, such that A corresponds to [1,0,0,0], C to [0,1,0,0], G to [0,0,1,0], and T to [0,0,0,1]), and the gap character “-" to [0,0,0,0] (formula 1 and 2 of [<xref rid="pone.0286314.ref022" ref-type="bibr">22</xref>]), additionally we have added support for ambiguous IUPAC characters, which corresponds to a vector with the different possibilities having the same weights and summing to 1 (<italic toggle="yes">e</italic>.<italic toggle="yes">g</italic>., B may correspond to C,G, or T and is represented as [0,1/3,1/3,1/3]).</p>
      <p>The numerical representations of each sequence are then grouped by set into matrices where each row is the numerical vector of a single sequence. Thus, sequence set <italic toggle="yes">i</italic> is represented as matrix s<sub>i</sub> of size <italic toggle="yes">m</italic>×<italic toggle="yes">s</italic>⋅4, where <italic toggle="yes">m</italic> is the number of sequences in the sequence set and <italic toggle="yes">s</italic> is the sequence size, in nucleotides.</p>
      <p>This series of pre-processing steps are represented in <xref rid="pone.0286314.g001" ref-type="fig">Fig 1</xref>. They are performed either once, or at the beginning of step 1 and step 2 when these are executed as independent executables.</p>
    </sec>
    <sec id="sec008">
      <title>Step1: Reference matrix computation</title>
      <p>This step corresponds to the computation of a matrix representation of the diversity of a DNA sequence across several individuals or sets of individuals (typically, species) that will serve as a reference against which individual sequence will later be contrasted (see step 2).After sequences have been transformed into numerical vectors and grouped into matrices s<sub>i</sub> as described in the pre-processing steps above and the top part of <xref rid="pone.0286314.g001" ref-type="fig">Fig 1</xref>, the reference matrix R is obtained by computing, for each sequence set i:
<disp-formula id="pone.0286314.e008"><alternatives><graphic xlink:href="pone.0286314.e008.jpg" id="pone.0286314.e008g" position="anchor"/><mml:math id="M8" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></disp-formula></p>
      <p>And then summing all S<sub>i</sub> matrices, normalized by the number of sequences in each set m<sub>i</sub>:
<disp-formula id="pone.0286314.e009"><alternatives><graphic xlink:href="pone.0286314.e009.jpg" id="pone.0286314.e009g" position="anchor"/><mml:math id="M9" display="block" overflow="scroll"><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>See the <xref rid="sec002" ref-type="sec">Method</xref> section detail how we derive this formulation from the original formulas of [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>].</p>
      <p>Reference matrix computation has a time complexity of <italic toggle="yes">O</italic>(<italic toggle="yes">Ns</italic><sup>2</sup>) and a memory complexity of <inline-formula id="pone.0286314.e010"><alternatives><graphic xlink:href="pone.0286314.e010.jpg" id="pone.0286314.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msqrt><mml:mi>N</mml:mi></mml:msqrt><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>.</p>
      <p>When executed as an independent script, it takes as input a multiple sequence alignment in the fasta format, and as output the reference matrix in a simple binary format, chosen for its read/write performance.</p>
      <p>The script is parallelized using MPI and thus it can be deployed on multiple CPU architectures. Briefly, the different sequences sets are split between the different processes, each computing a local reference matrix, which are then combined before being written to a file.</p>
      <p>Furthermore, we provide a utility script to merge pre-existing reference matrix together (provided they were computed on an independent set of sequences and that no grouping/species are shared). This allows one to update a previously obtained matrix with new sequences.</p>
      <p>Additionally, it also permits the computation of a reference matrix to be subdivided in any number of subtasks, by simply splitting the input alignment, and subsequently merging the resulting matrices. This makes the computation of very large datasets tractable and easy to deploy on one or multiple HPC architecture.</p>
    </sec>
    <sec id="sec009">
      <title>Step2: Indicator vector computation</title>
      <p>This step corresponds to the computation of indicator vectors for each sequence or sets of sequences provided.</p>
      <p>As per [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>], the indicator vector of a sequence set is defined as the eigenvector with the largest positive eigenvalue of a matrix contrasting the sequence set against all other sequence sets. Using the definitions provided above, for sequence set i this matrix is computed as:
<disp-formula id="pone.0286314.e011"><alternatives><graphic xlink:href="pone.0286314.e011.jpg" id="pone.0286314.e011g" position="anchor"/><mml:math id="M11" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mi>R</mml:mi></mml:math></alternatives></disp-formula></p>
      <p>See the <xref rid="sec002" ref-type="sec">Method</xref> section detail how we derive this formulation from the original formulas of [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>].</p>
      <p>Indicator vectors computation has a time and a memory complexity of <italic toggle="yes">O</italic>(<italic toggle="yes">Ns</italic><sup>2</sup>). When executed as an independent script, it takes as input a multiple sequence alignment in the fasta format, the reference matrix (as obtained from the previous step), and it outputs indicator vectors in a csv format file.</p>
      <p>The computation of each individual indicator vector being independent from the rest, the parallelization of this script using MPI is fairly straightforward.</p>
      <p>As with step1, it is possible to further split the computations in many subtasks by splitting the input alignment before invoking pyKleeBarcode. The subsequent merging of the resulting file is done by simple concatenation.</p>
    </sec>
    <sec id="sec010">
      <title>Step3: Structure matrix computation</title>
      <p>In this step a structure matrix, containing the correlation between the indicator vectors of different sets of sequences, is computed.</p>
      <p>In pyKleeBarcode it may be computed either in one go as the inner product of in two fashions. Either in one go, following the formulation of [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>], with a single multiplication of a matrix where each row is an indicator vector by its transpose, or in multiple steps where each step computes a line from the structure matrix.</p>
      <p>The first option is faster—albeit both options have the same time complexity–but more memory-intensive because the whole structure matrix needs to be held in memory at once, while the second one is slower but requires less memory.</p>
      <p>The switch between these two options is, by default, set at 5,000 indicator vectors, corresponding to about 800Mb of memory, and can be modified to suit the available resources.</p>
      <p>Structure matrix computation has a time complexity of <italic toggle="yes">O</italic>(<italic toggle="yes">Ns</italic>) and a memory complexity of <italic toggle="yes">O</italic>(<italic toggle="yes">N</italic><sup>2</sup><italic toggle="yes">s</italic>) when the number of indicator vectors is small, and <italic toggle="yes">O</italic>(<italic toggle="yes">Ns</italic>) otherwise.</p>
      <p>This step takes as input the set of indicator vectors, in csv format, for which to compute pair-wise correlations; and it outputs the structure matrix (in a binary format of its lower triangular portion).</p>
      <p>While the previous steps could be parallelized and split in subtasks in a straightforward manner, the structure matrix computation matrix computation is a more complicated affair, because it must look at all pairs of indicator vectors.</p>
      <p>Nevertheless, we have devised an algorithm, and provide the corresponding script, to update an existing structure matrix with new indicator vectors (and thus, new sequences).</p>
      <p>In fact, as structure matrices grow quadratically in size with the number of sequence sets they represent (count about 38Gb for 100,000 sequence sets), the structure matrix file format has been explicitly devised with the goal of allowing an update without having to read, or even re-write the whole file; the new information is merely appended to it.</p>
      <p>Overall, throughout our various benchmarks and experiments, Step2 has consistently been the step that took most of the computational time (usually between 80% and 90%). When using a single MPI process, pykleebarcode has a performance of the same order of magnitude as the original Matlab code (see <xref rid="pone.0286314.s003" ref-type="supplementary-material">S2 Fig</xref>); the usage of several MPI processes diminishes runtime due to the increased amount of computational resources (see <xref rid="pone.0286314.s003" ref-type="supplementary-material">S2 Fig</xref>).</p>
    </sec>
    <sec id="sec011">
      <title>Impact of the reference matrix on the indicator vector and structure matrix</title>
      <p><xref rid="pone.0286314.g002" ref-type="fig">Fig 2A</xref> presents a view of the structure matrix of the mammalian dataset obtained with the whole data set as reference matrix. To help interpretation, rows and columns have been ordered and annotated with taxonomic groups retrieved from the NCBI taxonomy [<xref rid="pone.0286314.ref034" ref-type="bibr">34</xref>], whose hierarchical structure is displayed on <xref rid="pone.0286314.g002" ref-type="fig">Fig 2B</xref>. It should be noted that the ordering of groups inside the same taxonomic unit is arbitrary (e.g.: the appearance of Carnivora next to Artiodactyla in Laurasiatheria). In this structure matrix, it appears that the correlation of indicator vectors is higher among the sequences closely lower taxonomic unit (such as Equidae, or Pecora). However, between less closely related groups (ie, off the structure matrix diagonal) the correlation fluctuates between 0.2 and 0.4. This effect is related to the genetic saturation of the studied COI5-P sequence (see <xref rid="pone.0286314.s004" ref-type="supplementary-material">S3 Fig</xref>). For reference, steps 1, 2 and 3 took respectively 5, 30 and 1 seconds as well as 95, 162, and 92 megabytes, on an Intel i7-8665U CPU on this dataset of 1049 sequences of 384bp took (for the purpose of this test each sequence were kept separate as their own set).</p>
      <fig position="float" id="pone.0286314.g002">
        <object-id pub-id-type="doi">10.1371/journal.pone.0286314.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <p>A. View of the structure matrix of the mammalian dataset and taxonomic structure of Mammalia. B. Phylogenetic tree structure of the taxonomic groups retrieved from NCBI taxonomy.</p>
        </caption>
        <graphic xlink:href="pone.0286314.g002" position="float"/>
      </fig>
      <p>To assess the effect of the impact of an incomplete reference matrix on the indicator vectors and structure matrix we designed three experiments as described in the methods section. The “primates-only” experiment serves to assess a case of extrapolation: computing indicator vectors on sequences which are outgroups to the ones included in the reference matrix. In contrast, the “no-Laurasiatheria” explores a case of interpolation, albeit one an extreme one where an entire super-order is missing. Finally, the “missingXX%” experiment addresses mixed cases of extrapolation and interpolation but where no large taxonomic group is missing.</p>
      <p><xref rid="pone.0286314.g003" ref-type="fig">Fig 3A</xref> presents the absolute Pearson correlation values between the indicator vectors obtained with a reference matrix containing all sequences versus a reference matrix containing the primate sequences only (“primates-only” experiment). All values are above 0.980, despite the “primates-only” reference matrix containing less than 12% (120/1049) of sequences, and all coming from the same subgroup of the data: primates in this instance. Interestingly, it appears the indicator vector of primate sequences themselves are among the most impacted as it presents the lowest average correlation value of all the main taxa as well as contains the vector with the overall lowest correlation value. <xref rid="pone.0286314.g004" ref-type="fig">Fig 4A</xref> reinforces this impression, as it shows that values in the structure matrix obtained from primates-only reference are highly correlated with the ones obtained with the full reference, but with a notable decrease when it comes to values describing the similarity between primates and other groups. This is suggestive of a behaviour where the effect of extrapolation (here, computing a structure matrix with some non-primates on a reference matrix containing primates sequences only) mostly affects the displayed relationship between the extrapolated sequences and the sequences used for building the reference matrix, rather than between the different extrapolated sequences.</p>
      <fig position="float" id="pone.0286314.g003">
        <object-id pub-id-type="doi">10.1371/journal.pone.0286314.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <p>A. Absolute Pearson correlation between indicator vectors obtained on the complete and the primate-only reference matrices. B. Absolute Pearson correlation between indicator vectors obtained on the complete and the no-Laurasiatheria reference matrices. C. Evolution of absolute Pearson correlation between indicator vectors obtained on the complete and a limited reference matrix with an increasing percentage of randomly missing sequences. Each boxplot corresponds to a single random replicate.</p>
        </caption>
        <graphic xlink:href="pone.0286314.g003" position="float"/>
      </fig>
      <fig position="float" id="pone.0286314.g004">
        <object-id pub-id-type="doi">10.1371/journal.pone.0286314.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Pearson correlation of the structure matrices with the reference one, grouped by main taxa.</title>
          <p>A. comparison of the primates-only structure matrix and the reference one. B. comparison of the no-Laurasiatheria structure matrix and the reference one.</p>
        </caption>
        <graphic xlink:href="pone.0286314.g004" position="float"/>
      </fig>
      <p>The results of the “no-Laurasiatheria” experiment, presented in <xref rid="pone.0286314.g003" ref-type="fig">Fig 3B</xref>, also show very good correlations with the full reference matrix, with all values being above 0.997. Regarding a pattern where the sequences included in the reference matrix (i.e., the non-laurasiatherians) are on average lower than the ones excluded (i.e., laurasiatherians), while a Mann-Whitney U yields a small p-value (&lt;10<sup>−12</sup>), the actual difference in median is only about 0.0001. <xref rid="pone.0286314.g004" ref-type="fig">Fig 4B</xref> also does not exhibit a pattern which specifically differentiate Laurasiatherians from others when comparing the structure matrices. Thus, it would seem that "interpolation” of new sequences in a structure matrix is not specifically affect the new sequences, even when they are from a group which is entirely missing from the reference matrix.</p>
      <p><xref rid="pone.0286314.g003" ref-type="fig">Fig 3C</xref> shows the results of the “missingXX%” experiment, where sequences are missing at random from the reference matrix. We see an expected pattern of general decrease in absolute correlation as the percentage of missing sequences increases, albeit all values stay above 0.9998 until 60% of sequences are missing and remain above 0.998 even when 90% of the sequences are missing. We also observe that the variation between replicates is limited, showing that this trend is robust to random sampling effects.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec012">
    <title>Discussion</title>
    <p>PyKleeBarcode builds on the previous works on indicator vectors, and allows several new possibilities, such as an extended handling of ambiguous nucleotide character, but more importantly the ability to have differences in the number of sequences included per group, as well as the possibility of efficient integration of new results onto a pre-existing structure matrix—something hitherto not possible. As our experiments have shown, this has only minimal impact on the computed indicator vectors and similarities between sequences, except in the direst of scenarios, such as in the primates-only experiment, or when the percentage of new sequences is above 50%. Consequently, our method is appropriate to integrate a growing set of sequences, continuously integrating new specimens to see where they fit among the existing structure, which could only need to be entirely recomputed for major version releases for example.</p>
    <p>Considering PyKleeBarcode, and the indicator vectors approach in general, in the context of other methods used to extract insight from homologous sequences, it first presumes that a multiple sequence alignment has already been obtained, using MAFFT [<xref rid="pone.0286314.ref032" ref-type="bibr">32</xref>, <xref rid="pone.0286314.ref033" ref-type="bibr">33</xref>] for example, in order to establish homology nucleotide by nucleotide. Thus, in an analysis pipeline it would come after tools used to establish a distance-based homology between a single sequence and among a larger database, such as BLAST [<xref rid="pone.0286314.ref035" ref-type="bibr">35</xref>], mapping tools such as bwa [<xref rid="pone.0286314.ref036" ref-type="bibr">36</xref>] or minimap2 [<xref rid="pone.0286314.ref037" ref-type="bibr">37</xref>], or dedicated software and databases (such as SiLiX [<xref rid="pone.0286314.ref038" ref-type="bibr">38</xref>] and HOGENOM [<xref rid="pone.0286314.ref039" ref-type="bibr">39</xref>] for instance), which are not the most appropriate or efficient to compute all pairwise distances between already aligned sequences.</p>
    <p>As we noted above our approach can be contrasted with phylogenetic tree reconstruction methods: pyKleeBarcode does not create an explicit evolutionary scenario, but only a distance matrix. Consequently, pyKleeBarcode is robust to cases where sequences do not follow a strictly tree-like evolutionary scenario and is not hindered by the unfavorable combinatorics of the number of possible tree topologies. In contrast, likelihood-based tree reconstruction methods must constantly engage in compromises between result approximation and runtime to completion.</p>
    <p>Furthermore, the distance matrix produced by pyKleeBarcode may be used as the basis to construct a tree, using a distance-based method such as Neighbor-Joining [<xref rid="pone.0286314.ref040" ref-type="bibr">40</xref>] or UPGMA [<xref rid="pone.0286314.ref041" ref-type="bibr">41</xref>]. PyKleeBarcode may be used in complement with the results of likelihood-based methods to point out discrepancies that suggest reticulated evolution or convergences.</p>
    <p>The indicator vector approach is most closely related with pairwise-distance methods and shares some of their limitations such as a sensitivity to genetic saturation. The main specificity of our approach relies on the elegant approach of [<xref rid="pone.0286314.ref023" ref-type="bibr">23</xref>] to conserve the richness of sequence diversity information when grouping sequences at various taxonomic levels rather than relying on a single consensus sequence per group.</p>
    <p>Some properties of indicator vectors are still unclear. For example, the contrastive nature of the approach should make them robust against heterogeneities in the mutation patterns of sequences, but this remains to be tested. Similarly, it would be of interest to investigate potential biases introduced by sampling differences between studied clades.</p>
    <p>With pyKleeBarcode we propose a flexible and up-to-date interface to compute indicator vectors and structure matrix from a multiple sequence alignment in a manner, adapted to the size of modern datasets and large computer infrastructures.</p>
    <p>We anticipate that pyKleeBarcode will help undertake deeper analyses of biological sequence databases, including BOLD, and allow new insights into large scale features of extant life.</p>
  </sec>
  <sec id="sec013" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pone.0286314.s001" position="float" content-type="local-data">
      <label>S1 File</label>
      <caption>
        <p>Supporting information for “PyKleeBarcode: Enabling representation of the whole animal kingdom in information space “Appendix A: Benchmarking of pykleeBarcode against the previous Matlab implementation, and Appendix B: Investigating the saturation of the COI5-P among mammals evolution.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0286314.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0286314.s002" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <p>Evolution of execution time (A) and peak RAM usage (B) for the computation of a structure matrix with the number of DNA sequences for different implementations.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0286314.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0286314.s003" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Estimation of the speedup of pykleeBarcode achieved with 4 MPI processes.</title>
        <p>The red line represents the average on a rolling window of 20 points.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0286314.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0286314.s004" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Evolution of COI5-P hamming distances with divergence time among mammals.</title>
        <p>The red line corresponds to a rolling average of a 20 MYA window.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0286314.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>Important thanks to Brian Abbott, Jesse Ausubel, Jacqueline Faherty, and Mark Stoeckle for valuable discussions. Calculations were performed at sciCORE (<ext-link xlink:href="http://scicore.unibas.ch/" ext-link-type="uri">http://scicore.unibas.ch/</ext-link>) scientific computing center at University of Basel, with support by the SIB—Swiss Institute of Bioinformatics. The title is a reference to Stewart Brand’s question “Why haven’t we seen a photograph of the whole earth yet?” <ext-link xlink:href="https://en.wikipedia.org/wiki/The_Blue_Marble" ext-link-type="uri">https://en.wikipedia.org/wiki/The_Blue_Marble</ext-link>.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0286314.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Cobb</surname><given-names>M.</given-names></name><article-title>60 years ago, Francis Crick changed the logic of biology</article-title>. <source><italic toggle="yes">PLoS biology</italic></source><year>2017</year>, <volume>15</volume>(<issue>9</issue>):<fpage>e2003243</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pbio.2003243</pub-id><?supplied-pmid 28922352?><pub-id pub-id-type="pmid">28922352</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Crick</surname><given-names>FH</given-names></name>. <article-title>On protein synthesis</article-title>. <source><italic toggle="yes">Symp Soc Exp Biol</italic></source><year>1958</year>, <fpage>12</fpage>:138–163. <?supplied-pmid 13580867?><pub-id pub-id-type="pmid">13580867</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref003">
      <label>3</label>
      <mixed-citation publication-type="book"><name><surname>Zuckerkandl</surname><given-names>E</given-names></name>, <name><surname>Pauling</surname><given-names>L</given-names></name>. <part-title>Molecular Disease, Evolution, and Genic Heterogeneity.</part-title> In: <source><italic toggle="yes">Horizons in Biochemistry: Albert Szent-Gyögyi Dedicatory Volume</italic>. edn. Edited by</source>
<name><surname>Kasha</surname><given-names>M</given-names></name>, <name><surname>Pullman</surname><given-names>B</given-names></name>: <publisher-name>Academic Press</publisher-name>; <year>1962</year>: <fpage>189</fpage>–<lpage>225</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0286314.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Zuckerkandl</surname><given-names>E.</given-names></name><article-title>Fifty-year old and still ticking… . an interview with Emile Zuckerkandl on the 50th anniversary of the molecular clock. Interview by Giacomo Bernardi</article-title>. <source><italic toggle="yes">Journal of molecular evolution</italic></source><year>2012</year>, <volume>74</volume><issue>(5–6</issue>):<fpage>233</fpage>–<lpage>236</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00239-012-9511-6</pub-id><?supplied-pmid 22739996?><pub-id pub-id-type="pmid">22739996</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Koonin</surname><given-names>EV</given-names></name>. <article-title>A half-century after the molecular clock: new dimensions of molecular evolution</article-title>. <source><italic toggle="yes">EMBO reports</italic></source><year>2012</year>, <volume>13</volume>(<issue>8</issue>):<fpage>664</fpage>–<lpage>666</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/embor.2012.103</pub-id><?supplied-pmid 22791022?><pub-id pub-id-type="pmid">22791022</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Kimura</surname><given-names>M</given-names></name>, <name><surname>Crow</surname><given-names>JF</given-names></name>. <article-title>The Number of Alleles That Can Be Maintained in a Finite Population</article-title>. <source><italic toggle="yes">Genetics</italic></source><year>1964</year>, <volume>49</volume>:<fpage>725</fpage>–<lpage>738</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/genetics/49.4.725</pub-id><?supplied-pmid 14156929?><pub-id pub-id-type="pmid">14156929</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Kimura</surname><given-names>M.</given-names></name><article-title>DNA and the neutral theory</article-title>. <source><italic toggle="yes">Philosophical transactions of the Royal Society of London</italic></source><year>1986</year>, <volume>312</volume>(<issue>1154</issue>):<fpage>343</fpage>–<lpage>354</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rstb.1986.0012</pub-id><?supplied-pmid 2870526?><pub-id pub-id-type="pmid">2870526</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Kimura</surname><given-names>M.</given-names></name><article-title>Preponderance of synonymous changes as evidence for the neutral theory of molecular evolution</article-title>. <source><italic toggle="yes">Nature</italic></source><year>1977</year>, <volume>267</volume>(<issue>5608</issue>):<fpage>275</fpage>–<lpage>276</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/267275a0</pub-id><?supplied-pmid 865622?><pub-id pub-id-type="pmid">865622</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Parvathy</surname><given-names>ST</given-names></name>, <name><surname>Udayasuriyan</surname><given-names>V</given-names></name>, <name><surname>Bhadana</surname><given-names>V</given-names></name>. <article-title>Codon usage bias</article-title>. <source><italic toggle="yes">Mol Biol Rep</italic></source><year>2022</year>, <volume>49</volume>(<issue>1</issue>):<fpage>539</fpage>–<lpage>565</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s11033-021-06749-4</pub-id><?supplied-pmid 34822069?><pub-id pub-id-type="pmid">34822069</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Woese</surname><given-names>CR</given-names></name>, <name><surname>Kandler</surname><given-names>O</given-names></name>, <name><surname>Wheelis</surname><given-names>ML</given-names></name>. <article-title>Towards a natural system of organisms: proposal for the domains of archea, bacteria, and eukarya</article-title>. <source><italic toggle="yes">Proc Natl Acad Sci USA</italic></source><year>1990</year>, <volume>87</volume>:<fpage>4576</fpage>–<lpage>4579</lpage>.<pub-id pub-id-type="pmid">2112744</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Woese</surname><given-names>CR</given-names></name>, <name><surname>Fox</surname><given-names>GE</given-names></name>. <article-title>Phylogenetic structure of the prokaryotic domain: the primary kingdoms</article-title>. <source><italic toggle="yes">Proceedings of the National Academy of Sciences of the United States of America</italic></source><year>1977</year>, <volume>74</volume>(<issue>11</issue>):<fpage>5088</fpage>–<lpage>5090</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.74.11.5088</pub-id><?supplied-pmid 270744?><pub-id pub-id-type="pmid">270744</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Olsen</surname><given-names>GJ</given-names></name>, <name><surname>Lane</surname><given-names>DJ</given-names></name>, <name><surname>Giovannoni</surname><given-names>SJ</given-names></name>, <name><surname>Pace</surname><given-names>NR</given-names></name>, <name><surname>Stahl</surname><given-names>DA</given-names></name>. <article-title>Microbial ecology and evolution: a ribosomal RNA approach</article-title>. <source><italic toggle="yes">Annual review of microbiology</italic></source><year>1986</year>, <fpage>40</fpage>:337–365. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev.mi.40.100186.002005</pub-id><?supplied-pmid 2430518?><pub-id pub-id-type="pmid">2430518</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Avise</surname><given-names>JC</given-names></name>, <name><surname>Arnold</surname><given-names>J</given-names></name>, <name><surname>Ball</surname><given-names>RM</given-names></name>, <name><surname>Bermingham</surname><given-names>E</given-names></name>, <name><surname>Lamb</surname><given-names>T</given-names></name>, <name><surname>Neigel</surname><given-names>JE</given-names></name>, <etal>et al</etal>. <article-title>Intraspecific phylogeography: the mitochondrial bridge between population genetics and systematics.</article-title><source><italic toggle="yes">Ann Rev Ecol Syst</italic></source><year>1987</year>, <volume>18</volume>:<fpage>489</fpage>–<lpage>522</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0286314.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Moore</surname><given-names>WS</given-names></name>. <article-title>Inferring phylogenies from mtDNA variation: Mitochondrial-gene trees versus nuclear-gene trees</article-title>. <source><italic toggle="yes">Evolution</italic></source><year>1995</year>, <volume>49</volume>:<fpage>718</fpage>–<lpage>726</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/j.1558-5646.1995.tb02308.x</pub-id><?supplied-pmid 28565131?><pub-id pub-id-type="pmid">28565131</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Ausubel</surname><given-names>JH</given-names></name>. <article-title>A botanical macroscope</article-title>. <source><italic toggle="yes">Proceedings of the National Academy of Sciences of the United States of America</italic></source><year>2009</year>, <volume>106</volume>(<issue>31</issue>):<fpage>12569</fpage>–<lpage>12570</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0906757106</pub-id><?supplied-pmid 19666620?><pub-id pub-id-type="pmid">19666620</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Hebert</surname><given-names>PD</given-names></name>, <name><surname>Ratnasingham</surname><given-names>S</given-names></name>, <name><surname>deWaard</surname><given-names>JR</given-names></name>. <article-title>Barcoding animal life: cytochrome c oxidase subunit 1 divergences among closely related species</article-title>. <source><italic toggle="yes">Proc Biol Sci</italic></source><year>2003</year>, <volume>270</volume> Suppl <issue>1</issue>:<fpage>S96</fpage>–<lpage>99</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rsbl.2003.0025</pub-id>
<?supplied-pmid 12952648?><pub-id pub-id-type="pmid">12952648</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Stoeckle</surname><given-names>MY</given-names></name>, <name><surname>Hebert</surname><given-names>PD</given-names></name>. <article-title>Barcode of life.</article-title><source><italic toggle="yes">Sci Am</italic></source><year>2008</year>, <volume>299</volume>(<issue>4</issue>):<fpage>82</fpage>–<lpage>86</lpage>, 88. <?supplied-pmid 18847089?><pub-id pub-id-type="pmid">18847089</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Thaler</surname><given-names>DS</given-names></name>, <name><surname>Stoeckle</surname><given-names>MY</given-names></name>. <article-title>Bridging two scholarly islands enriches both: COI DNA barcodes for species identification versus human mitochondrial variation for the study of migrations and pathologies</article-title>. <source><italic toggle="yes">Ecology and Evolution</italic></source><year>2016</year>, <volume>6</volume>:<fpage>6824</fpage>–<lpage>6835</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/ece3.2394</pub-id><?supplied-pmid 28725363?><pub-id pub-id-type="pmid">28725363</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Ratnasingham</surname><given-names>S</given-names></name>, <name><surname>Hebert</surname><given-names>P</given-names></name>. <article-title>bold: The Barcode of Life Data System (<ext-link xlink:href="http://www.barcodinglife.org" ext-link-type="uri">http://www.barcodinglife.org</ext-link>).</article-title><source>Mol Ecol Notes</source>. <year>2007</year><month>May</month><day>1</day>;<volume>7</volume>(<issue>3</issue>):<fpage>355</fpage>–<lpage>364</lpage>.<pub-id pub-id-type="pmid">18784790</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Hebert</surname><given-names>PD</given-names></name>, <name><surname>Hollingsworth</surname><given-names>PM</given-names></name>, <name><surname>Hajibabaei</surname><given-names>M</given-names></name>. <article-title>From writing to reading the encyclopedia of life</article-title>. <source><italic toggle="yes">Philosophical transactions of the Royal Society of London</italic></source><volume>2016</volume>, <fpage>371</fpage>(<year>1702</year>).</mixed-citation>
    </ref>
    <ref id="pone.0286314.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Chu</surname><given-names>G</given-names></name>, <name><surname>Warnow</surname><given-names>T</given-names></name>. <article-title>SCAMPP+FastTree: improving scalability for likelihood-based phylogenetic placement</article-title>, <source><italic toggle="yes">Bioinformatics Advances</italic></source><year>2023</year>, <volume>3</volume>(<issue>1</issue>), <fpage>vbad008</fpage>\ <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioadv/vbad008</pub-id><?supplied-pmid 36818728?><pub-id pub-id-type="pmid">36818728</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Soucy</surname><given-names>S</given-names></name>, <name><surname>Huang</surname><given-names>J</given-names></name>, <name><surname>Gogarten</surname><given-names>J</given-names></name>. <article-title>Horizontal gene transfer: building the web of life</article-title>. <source><italic toggle="yes">Nat Rev Genet</italic></source><year>2016</year>, <volume>16</volume>, <fpage>472</fpage>–<lpage>482</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0286314.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Sirovich</surname><given-names>L</given-names></name>, <name><surname>Stoeckle</surname><given-names>MY</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>. <article-title>A scalable method for analysis and display of DNA sequences</article-title>. <source><italic toggle="yes">PLoS One</italic></source><year>2009</year>, <volume>4</volume>(<issue>10</issue>):<fpage>e7051</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0007051</pub-id><?supplied-pmid 19798412?><pub-id pub-id-type="pmid">19798412</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Sirovich</surname><given-names>L</given-names></name>, <name><surname>Stoeckle</surname><given-names>MY</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>. <article-title>Structural analysis of biodiversity.</article-title><source><italic toggle="yes">PLoS One</italic></source><year>2010</year>, <volume>5</volume>(<issue>2</issue>):<fpage>e9266</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0009266</pub-id><?supplied-pmid 20195371?><pub-id pub-id-type="pmid">20195371</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Stoeckle</surname><given-names>M</given-names></name>, <name><surname>Coffran</surname><given-names>C</given-names></name>. <article-title>TreeParser-Aided Klee Diagrams Display Taxonomic Clusters in DNA Barcode and Nuclear Gene Datasets.</article-title><source><italic toggle="yes">Sci Rep</italic></source><year>2013</year>,<volume>3</volume>, <fpage>2635</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/srep02635</pub-id><?supplied-pmid 24022383?><pub-id pub-id-type="pmid">24022383</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>von Beeren</surname><given-names>C</given-names></name>, <name><surname>Stoeckle</surname><given-names>M</given-names></name>, <name><surname>Xia</surname><given-names>J</given-names></name>, <name><surname>Burke</surname><given-names>G</given-names></name>, <name><surname>Kronauer</surname><given-names>DJC</given-names></name>. <article-title>Interbreeding among deeply divergent mitochondrial lineages in the American cockroach (Periplaneta americana).</article-title><source><italic toggle="yes">Sci Rep</italic></source><year>2015</year>, <volume>5</volume>, <fpage>8297</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/srep08297</pub-id><?supplied-pmid 25656854?><pub-id pub-id-type="pmid">25656854</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Raupach</surname><given-names>MJ</given-names></name>, <name><surname>Astrin</surname><given-names>JJ</given-names></name>, <name><surname>Hannig</surname><given-names>K</given-names></name>, <name><surname>Peters</surname><given-names>MK</given-names></name>, <name><surname>Stoeckle</surname><given-names>MY</given-names></name>, <name><surname>Wägele</surname><given-names>JW</given-names></name>. <article-title>Molecular species identification of Central European ground beetles (Coleoptera: Carabidae) using nuclear rDNA expansion segments and DNA barcodes.</article-title><source><italic toggle="yes">Front Zool</italic></source><year>2010</year>, <volume>7</volume>, <fpage>26</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1742-9994-7-26</pub-id><?supplied-pmid 20836845?><pub-id pub-id-type="pmid">20836845</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Raupach</surname><given-names>MJ</given-names></name>, <name><surname>Barco</surname><given-names>A</given-names></name>, <name><surname>Steinke</surname><given-names>D</given-names></name>, <name><surname>Beermann</surname><given-names>J</given-names></name>, <name><surname>Laakmann</surname><given-names>S</given-names></name>, <name><surname>Mohrbeck</surname><given-names>I</given-names></name>, <etal>et al</etal>. <article-title>The Application of DNA Barcodes for the Identification of Marine Crustaceans from the North Sea and Adjacent Regions.</article-title><source>PLoS One</source>. <year>2015</year><month>Sep</month><day>29</day>;<volume>10</volume>(<issue>9</issue>):<fpage>e0139421</fpage><comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0139421</pub-id><?supplied-pmid 26417993?><pub-id pub-id-type="pmid">26417993</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Modica</surname><given-names>MV</given-names></name>, <name><surname>Puillandre</surname><given-names>N</given-names></name>, <name><surname>Castelin</surname><given-names>M</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Holford</surname><given-names>M</given-names></name>. <article-title>A good compromise: rapid and robust species proxies for inventorying biodiversity hotspots using the Terebridae (Gastropoda: Conoidea).</article-title><source>PLoS One.</source><year>2014</year><month>Jul</month><day>8</day>;<volume>9</volume>(<issue>7</issue>):<fpage>e102160</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0102160</pub-id> ; PMCID: PMC4086986.<?supplied-pmid 25003611?><pub-id pub-id-type="pmid">25003611</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Stoeckle</surname><given-names>M</given-names></name>, <name><surname>Thaler</surname><given-names>D</given-names></name>. <article-title>Why Should Mitochondria Define Species?</article-title><source><italic toggle="yes">Human Evolution</italic></source><year>2018</year>, <volume>33</volume>, <fpage>1</fpage>–<lpage>30</lpage></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Stoeckle</surname><given-names>MY</given-names></name>, <name><surname>Thaler</surname><given-names>DS</given-names></name>. <article-title>DNA barcoding works in practice but not in (neutral) theory.</article-title><source><italic toggle="yes">PLoS One</italic></source> (<year>2014</year>),<volume>9</volume>, <fpage>e100755</fpage>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0100755</pub-id>
<?supplied-pmid 24988408?><pub-id pub-id-type="pmid">24988408</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Misawa</surname><given-names>K</given-names></name>, <name><surname>Kuma</surname><given-names>KI</given-names></name>, <name><surname>Miyata</surname><given-names>T</given-names></name>. <article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>. <source><italic toggle="yes">Nucleic acids research</italic></source><year>2002</year>, <volume>30</volume>(<issue>14</issue>):<fpage>3059</fpage>–<lpage>66</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkf436</pub-id><?supplied-pmid 12136088?><pub-id pub-id-type="pmid">12136088</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Standley</surname><given-names>DM</given-names></name>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source><italic toggle="yes">Molecular biology and evolution</italic></source><year>2013</year>, <volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>80</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id><?supplied-pmid 23329690?><pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Schoch</surname><given-names>CL</given-names></name>, <name><surname>Ciufo</surname><given-names>S</given-names></name>, <name><surname>Domrachev</surname><given-names>M</given-names></name>, <name><surname>Hotton</surname><given-names>CL</given-names></name>, <name><surname>Kannan</surname><given-names>S</given-names></name>, <name><surname>Khovanskaya</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>NCBI Taxonomy: a comprehensive update on curation, resources and tools.</article-title><source>Database (Oxford).</source><year>2020</year><month>Jan</month><day>1</day>;2020:baaa062. [cited 2023 Jan 4] <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/database/baaa062</pub-id><?supplied-pmid 32761142?><pub-id pub-id-type="pmid">32761142</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Gish</surname><given-names>W</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <name><surname>Myers</surname><given-names>EW</given-names></name>, <name><surname>Lipman</surname><given-names>DJ</given-names></name> (<year>1990</year>) <article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source>
<volume>215</volume>: <fpage>403</fpage>–<lpage>410</lpage>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
<?supplied-pmid 2231712?><pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name>.<article-title>Fast and accurate short read alignment with Burrows-Wheeler Transform</article-title>. <source>Bioinformatics</source><year>2009</year>, <volume>25</volume>:<fpage>1754</fpage>–<lpage>60</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id><?supplied-pmid 19451168?><pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H.</given-names></name><article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>. <source><italic toggle="yes">Bioinformatics</italic></source><year>2018</year>, <volume>34</volume>:<fpage>3094</fpage>–<lpage>3100</lpage><comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id><?supplied-pmid 29750242?><pub-id pub-id-type="pmid">29750242</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Miele</surname><given-names>V</given-names></name>, <name><surname>Penel</surname><given-names>S</given-names></name>, <name><surname>Duret</surname><given-names>L</given-names></name>. <article-title>Ultra-fast sequence clustering from similarity networks with SiLiX</article-title>. <source><italic toggle="yes">BMC Bioinformatics</italic></source><year>2011</year>, <volume>12</volume>, <fpage>116</fpage><comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-12-116</pub-id><?supplied-pmid 21513511?><pub-id pub-id-type="pmid">21513511</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Penel</surname><given-names>S</given-names></name>, <name><surname>Arigon</surname><given-names>AM</given-names></name>, <name><surname>Dufayard</surname><given-names>JF</given-names></name>, <name><surname>Sertier</surname><given-names>AS</given-names></name>, <name><surname>Daubin</surname><given-names>V</given-names></name>, <name><surname>Duret</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Databases of homologous gene families for comparative genomics</article-title>. <source>BMC Bioinformatics</source><year>2009</year>, <volume>10</volume> (<issue>Suppl 6</issue>):<fpage>S3</fpage>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-10-S6-S3</pub-id>
<?supplied-pmid 19534752?><pub-id pub-id-type="pmid">19534752</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Saitou</surname><given-names>N</given-names></name>, <name><surname>Nei</surname><given-names>M</given-names></name>. <article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title>. <source><italic toggle="yes">Molecular Biology and Evolution</italic></source><year>1987</year>, <volume>4</volume>(<issue>4</issue>): <fpage>406</fpage>–<lpage>425</lpage><comment>doi: </comment><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a040454</pub-id><?supplied-pmid 3447015?><pub-id pub-id-type="pmid">3447015</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Sokal</surname><given-names>RR</given-names></name>, <name><surname>Michener</surname><given-names>CD</given-names></name>. <article-title>A statistical method for evaluating systematic relationships.</article-title><source><italic toggle="yes">Univ</italic>. <italic toggle="yes">Kansas Sci</italic>. <italic toggle="yes">Bull</italic></source>. <year>1958</year>, <volume>38</volume>:<fpage>1409</fpage>–<lpage>1438</lpage></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS One</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10237437</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0286314</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-23-01135</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Phylogenetic Analysis</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Animals</subject>
              <subj-group>
                <subject>Vertebrates</subject>
                <subj-group>
                  <subject>Amniotes</subject>
                  <subj-group>
                    <subject>Mammals</subject>
                    <subj-group>
                      <subject>Primates</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Zoology</subject>
          <subj-group>
            <subject>Animals</subject>
            <subj-group>
              <subject>Vertebrates</subject>
              <subj-group>
                <subject>Amniotes</subject>
                <subj-group>
                  <subject>Mammals</subject>
                  <subj-group>
                    <subject>Primates</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Nucleotide Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Nucleotide Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Sequence Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Bioenergetics</subject>
            <subj-group>
              <subject>Energy-Producing Organelles</subject>
              <subj-group>
                <subject>Mitochondria</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Structures and Organelles</subject>
            <subj-group>
              <subject>Energy-Producing Organelles</subject>
              <subj-group>
                <subject>Mitochondria</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Organismal Evolution</subject>
            <subj-group>
              <subject>Animal Evolution</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PyKleeBarcode: Enabling representation of the whole animal kingdom in information space</article-title>
      <alt-title alt-title-type="running-head">PyKleeBarcode: Enabling representation of the whole animal kingdom in information space</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8854-7235</contrib-id>
        <name>
          <surname>Duchemin</surname>
          <given-names>Wandrille</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thaler</surname>
          <given-names>David S.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>sciCORE Center for Scientific Computing, University of Basel, Basel, Switzerland</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Biozentrum, University of Basel, Basel, Switzerland</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Program for the Human Environment, Rockefeller University, New York, NY, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cserhati</surname>
          <given-names>Matthew</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>AbbVie Inc, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>wandrille.duchemin@unibas.ch</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>18</volume>
    <issue>6</issue>
    <elocation-id>e0286314</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 Duchemin, Thaler</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Duchemin, Thaler</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0286314.pdf"/>
    <abstract>
      <p>As biological sequence databases continue growing, so do the insight that they promise to shed on the shape of the genetic diversity of life. However, to fulfil this promise the software must remain usable, be able to accommodate a large amount of data and allow use of modern high performance computing infrastructure. In this study we present a reimplementation as well as an extension of a technique using indicator vectors to compute and visualize similarities between sets of nucleotide sequences. We have a flexible and easy to use python program relying on standard and open-source libraries. Our tool allows analysis of very large complement of sequences using code parallelization, as well as by providing routines to split a computational task in smaller and manageable subtasks whose results are then merged. This implementation also facilitates adding new sequences into an indicator vector-based representation without re-computing the whole set. The efficient synthesis of data into knowledge is no trivial matter given the size and rapid growth of biological sequence databases. Based on previous results regarding the properties of indicator vectors, the open-source approach proposed here efficiently and flexibly supports comparative analysis of genetic diversity at a large scale. Our software is freely available at: <ext-link xlink:href="https://github.com/WandrilleD/pyKleeBarcode" ext-link-type="uri">https://github.com/WandrilleD/pyKleeBarcode</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100021373</institution-id>
            <institution>Swiss Institute of Bioinformatics</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8854-7235</contrib-id>
          <name>
            <surname>Duchemin</surname>
            <given-names>Wandrille</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100017651</institution-id>
            <institution>Richard Lounsbery Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>"A Cosmic View of Life on Earth"</award-id>
        <principal-award-recipient>
          <name>
            <surname>Thaler</surname>
            <given-names>David S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100017651</institution-id>
            <institution>Richard Lounsbery Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>"A Cosmic View of Life on Earth"</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8854-7235</contrib-id>
          <name>
            <surname>Duchemin</surname>
            <given-names>Wandrille</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This research was funded by the SIB Swiss Institute of Bioinformatics. WD and DT were supported in this research by the Lounsbery Foundation grant "A Cosmic View of Life on Earth". The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. URL of funder websites: * sib.swiss * <ext-link xlink:href="https://www.rlounsbery.org/" ext-link-type="uri">https://www.rlounsbery.org/</ext-link>.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="0"/>
      <page-count count="14"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The code, documentation, and instruction of use for PyKleeBarcode can be found in the GitHub repository (<ext-link xlink:href="https://github.com/WandrilleD/pyKleeBarcode" ext-link-type="uri">https://github.com/WandrilleD/pyKleeBarcode</ext-link>). All relevant data and code for the experiment conducted in this article can be found in the GitHub repository (<ext-link xlink:href="https://github.com/WandrilleD/pyKleeBarcode-publication-supporting-code-and-data" ext-link-type="uri">https://github.com/WandrilleD/pyKleeBarcode-publication-supporting-code-and-data</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The code, documentation, and instruction of use for PyKleeBarcode can be found in the GitHub repository (<ext-link xlink:href="https://github.com/WandrilleD/pyKleeBarcode" ext-link-type="uri">https://github.com/WandrilleD/pyKleeBarcode</ext-link>). All relevant data and code for the experiment conducted in this article can be found in the GitHub repository (<ext-link xlink:href="https://github.com/WandrilleD/pyKleeBarcode-publication-supporting-code-and-data" ext-link-type="uri">https://github.com/WandrilleD/pyKleeBarcode-publication-supporting-code-and-data</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The study of biological evolution through comparing linear sequences from different species, now known as molecular phylogeny, was first proposed by Crick in a 1957 lecture [<xref rid="pone.0286314.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0286314.ref002" ref-type="bibr">2</xref>]. The passage that heralds the coming of molecular phylogeny is clear and to the point:</p>
    <disp-quote>
      <p>“Biologists should realize that before long we shall have a subject which might be called ’protein taxonomy’ -the study of the amino acid sequences of the proteins of an organism and the comparison of them between species. It can be argued that these sequences are the most delicate expression possible of the phenotype of an organism and that vast amounts of evolutionary information may be hidden away within them.”</p>
    </disp-quote>
    <p>Linear sequence analysis of proteins from different species combined with paleontology to estimate chronological time of their divergence gave rise to the concept of a ‘molecular clock’ [<xref rid="pone.0286314.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0286314.ref004" ref-type="bibr">4</xref>], which proposes a constant number of amino acid changes per year in chronological time [<xref rid="pone.0286314.ref005" ref-type="bibr">5</xref>]. Directly inspired by the molecular clock, the neutral theory of evolution proposes that many sequence changes in evolution result from population effects such as drift, minor intermittent selection, and bottlenecks [<xref rid="pone.0286314.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0286314.ref007" ref-type="bibr">7</xref>]. The subsequent advent and development of DNA sequencing led Kimura to explicitly extend the neutral theory to DNA sequences with the reasonable hypothesis that synonymous mutations were neutral [<xref rid="pone.0286314.ref008" ref-type="bibr">8</xref>]. While the neutrality of synonymous sequences is not 100% valid, it is a useful first order approximation in many systems [<xref rid="pone.0286314.ref009" ref-type="bibr">9</xref>].</p>
    <p>Woese and colleagues pioneered the use of small subunit ribosomal RNAs to construct phylogenies that encompass all of cellular life [<xref rid="pone.0286314.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0286314.ref011" ref-type="bibr">11</xref>]. SSU RNAs have two important features in this regard: a) Presence and sufficient similarity in all cellular life to allow them to be aligned and compared. b) Abundance and relative stability, facilitating their purification and characterization. Molecular methods including in situ hybridization and PCR allowed the characterization of SSU RNAs and the genes encoding them in situ including uncultured and unculturable organisms [<xref rid="pone.0286314.ref012" ref-type="bibr">12</xref>].</p>
    <p>Mitochondrial genomes are small in size, lack recombination, and are technically straightforward in terms of molecular biology because their copy number is approximately a thousand times greater than nuclear genes. Mitochondrial analysis both confirmed and refined other methods for species and population identification, especially among animals [<xref rid="pone.0286314.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0286314.ref014" ref-type="bibr">14</xref>] but with certain caveats among other Eukaryotes, e.g., plants and fungi, as well [<xref rid="pone.0286314.ref015" ref-type="bibr">15</xref>]. Hebert and colleagues proposed that a partial segment of the mitochondrial genome agreed upon by the community could universalize and democratize species identification [<xref rid="pone.0286314.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0286314.ref017" ref-type="bibr">17</xref>]. The particular mitochondrial sequence that has become the most widely used, a 648 base pair (bp) segment of the gene encoding mitochondrial cytochrome c oxidase subunit I (COI), became most widely adopted because reliable primers and methods useful for both vertebrates and invertebrates were adopted by a critical mass of the community. Intrinsically, there is nothing special about the mtCOI DNA barcode region compared to other protein-encoding regions of the mitochondrial genome [<xref rid="pone.0286314.ref018" ref-type="bibr">18</xref>].</p>
    <p>The Barcode Of Life Database (BOLD) is an open access compilation including mtCOI barcode data from approximately five million individuals that collectively cover a great deal of the extant animal kingdom [<xref rid="pone.0286314.ref019" ref-type="bibr">19</xref>]. The BOLD approach is a different approach in the world of sequence analysis because it is a small proportion of the genome (e.g., in humans less than one millionth of the total genome) but is available from many different individuals in many species. For many animal species DNA barcodes are the only sequence information available. The use of BOLD was first limited to species identification. The broad but not deep nature of barcode data can be used for more than identification, they can support phylogenic reconstructions and evolutionary models [<xref rid="pone.0286314.ref020" ref-type="bibr">20</xref>].</p>
    <p>A method of choice to extract and recapitulate the evolutionary information contained in a set of homologous sequences is to construct a phylogenetic tree based on the of likelihood of a substitution model. These methods have benefitted from numerous advances in the past decades, but the explosion of the number of possible tree topologies as the number of leaves increase—(2n-5)!!, unrooted topologies for n leaves–still makes the reconstruction of phylogenetic trees with tens of thousands of sequences using likelihood methods daunting (although there exist strategies to improve the scalability using phylogenetic placement, see [<xref rid="pone.0286314.ref021" ref-type="bibr">21</xref>]). Aside from computational consideration, one has to consider cases where the evolutionary history of sequences does not follow a strictly tree-like pattern because of horizontal and modular evolution [<xref rid="pone.0286314.ref022" ref-type="bibr">22</xref>].</p>
    <p>Sirovich and colleagues developed an innovative approach to allow multiple DNA sequences both within and among many animal species to be compared such that the overall structure of animal life within and among species can be visualized [<xref rid="pone.0286314.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>]. Their method relies on a contrastive approach to build indicator vectors which recapitulates the genetic information of a sequence, or a group of sequence, which can then be used to probe the genetic diversity, or closedness of the taxonomic groups they represent, for example in the form of a similarity matrix called the structure matrix. Visualization of the structure matrix has been a valuable part of a number of publications [<xref rid="pone.0286314.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0286314.ref025" ref-type="bibr">25</xref>–<xref rid="pone.0286314.ref031" ref-type="bibr">31</xref>]. However, the indicator vector and structure matrix approach for the comparative study of DNA sequences has not yet been utilized to its full potential. The present work was originally motivated to make the prior work of Sirovich and colleagues more accessible as the implementation of software to compute the indicator vectors and Klee diagrams has been limited to the original code released with [<xref rid="pone.0286314.ref023" ref-type="bibr">23</xref>] (currently available at <ext-link xlink:href="https://phe.rockefeller.edu/barcode/klee.php" ext-link-type="uri">https://phe.rockefeller.edu/barcode/klee.php</ext-link>), which runs on an older version of a proprietary commercial software, Matlab2009a, a not only unmaintained version, but whose documentation is no longer available on the developer’s website. We used the opportunity of a re-implementation to introduce significant extensions to the original methods, in particular to accommodate a variable number of sequences per species, and provide a more flexible interface to the computational steps involved in going from a multiple sequence alignment to a structure matrix. Refactoring the process into separate steps allowed an efficient and scalable parallelization of the pipeline, as well as adding flexibility. In the previous Matlab implementation updating a structure matrix with one or several new sequences required recomputing it entirely. Separation of different steps in the implementation grants additional flexibility, both computationally and conceptually. Real-life datasets from BOLD (The Barcode Of Life Database) are used to illustrate the new implementation and in places contrast it with the published Matlab-based method.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <sec id="sec003">
      <title>Derivation of the original method’s formula</title>
      <p>After a series of pre-processing steps, which are detailed in the result section of this manuscript as well as in [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>], the multiple sequence alignment is split in several sequence sets.</p>
      <p>A set of sequence <italic toggle="yes">i</italic> is represented as matrix <italic toggle="yes">s</italic><sub><italic toggle="yes">i</italic></sub> of size <italic toggle="yes">m</italic>×<italic toggle="yes">s</italic>⋅4, where <italic toggle="yes">m</italic> is the number of sequences in the sequence set and <italic toggle="yes">s</italic> is the sequence size, in nucleotides.</p>
      <p>Then, the indicator vector of sequence set <italic toggle="yes">i</italic> is computed as the eigenvector with the largest positive eigenvalue of matrix:
<disp-formula id="pone.0286314.e001"><alternatives><graphic xlink:href="pone.0286314.e001.jpg" id="pone.0286314.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
, where <italic toggle="yes">N</italic> is the number of sequence sets, as defined in equation 15 of [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>]. Note that this formulation presumes that all sequence set contains the same number of sequences. We begin by writing:
<disp-formula id="pone.0286314.e002"><alternatives><graphic xlink:href="pone.0286314.e002.jpg" id="pone.0286314.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></disp-formula>
such that the previous equation can be written <inline-formula id="pone.0286314.e003"><alternatives><graphic xlink:href="pone.0286314.e003.jpg" id="pone.0286314.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p>This formula can be rewritten as:
<disp-formula id="pone.0286314.e004"><alternatives><graphic xlink:href="pone.0286314.e004.jpg" id="pone.0286314.e004g" position="anchor"/><mml:math id="M4" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Which makes it evident that once the <inline-formula id="pone.0286314.e005"><alternatives><graphic xlink:href="pone.0286314.e005.jpg" id="pone.0286314.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> matrix has been computed; the indicator vector of a sequence set can be computed independently from the other sequences. Additionally, the original method only considers the case were the number of sequences per set, noted <italic toggle="yes">m</italic>, is the same for each set. We generalize this approach to any specific number of sequences per set, noted m<sub>i</sub> for sequence set <italic toggle="yes">i</italic> by normalizing the S<sub>i</sub> matrices by m<sub>i</sub>, such that the previous equation becomes:
<disp-formula id="pone.0286314.e006"><alternatives><graphic xlink:href="pone.0286314.e006.jpg" id="pone.0286314.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Given its role of contrasting a given sequence set against all others, we call the matrix <inline-formula id="pone.0286314.e007"><alternatives><graphic xlink:href="pone.0286314.e007.jpg" id="pone.0286314.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> the reference matrix.</p>
      <p>Finally, it can be remarked that the computation of all, or parts of, the structure matrix depends only on the indicator vectors of the sequences of interest.</p>
      <p>Consequently, we describe the method of [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>] as three consecutive steps:</p>
      <list list-type="order">
        <list-item>
          <p>Computation of the reference matrix from all sequence sets</p>
        </list-item>
        <list-item>
          <p>Computation of an indicator vector for each sequence set independently</p>
        </list-item>
        <list-item>
          <p>Computation of the structure matrix from the indicator vectors of all sequence sets</p>
        </list-item>
      </list>
      <p>We detail each of these steps in the results section.</p>
    </sec>
    <sec id="sec004">
      <title>Mammalian sequences dataset</title>
      <p>In order to test and demonstrate our method, we accessed the <ext-link xlink:href="https://www.boldsystems.org/" ext-link-type="uri">Barcode Of Life Database</ext-link> [<xref rid="pone.0286314.ref019" ref-type="bibr">19</xref>] for primary COI5-P sequences of mammals. Out of the &gt;100,000 mammalian sequences, we selected a limited set, in order to facilitate results analysis and interpretation.</p>
      <p>This set was built such that each of the following mammalian taxon is represented: Afrotheria, Artiodactyla, Carnivora, Chiroptera, Dermoptera, Eulipotyphla, Glires, Metatheria, Perissodactyla, Pholidota, Primates, Prototheria, Scandentia, Xenarthra.</p>
      <p>To ensure this, we randomly selected a maximum of 40 species per taxon, and 3 sequences per species, except for Prototheria, Pholidota, Scandentia and Dermoptera where the low number of sampled species and sequences caused us to take all available sequences (resp. 3, 7, 9, and 1 species, and 7, 21, 16, and 3 sequences). The resulting set is composed of 1049 sequences spread among 354 species.</p>
      <p>The retrieved sequences were then aligned using MAFFT [<xref rid="pone.0286314.ref032" ref-type="bibr">32</xref>, <xref rid="pone.0286314.ref033" ref-type="bibr">33</xref>]. The sequence alignment extremities were then trimmed to avoid the spurious gaps resulting from differences in the size of the sequenced fragment. The resulting multiple sequence alignment presented no gaps (-), no missing base (N) characters, and 0.007% ambiguous IUPAC characters (Y,R,W,etc.).</p>
    </sec>
    <sec id="sec005">
      <title>Impact of the reference matrix on the indicator vector and structure matrix</title>
      <p>One of the new possibilities offered by our re-implementation is the possibility to compute the indicator vectors of sequences which are absent from the reference matrix. This can be useful, for instance, if a new sequence were just acquired, because it could be integrated to the structure matrix without having to re-compute it entirely.</p>
      <p>In order to evaluate the impact of an incomplete reference matrix, we devised a number of experiments where we compute the indicator vectors and structure matrix of our mammalian dataset sequences with a reference matrix computed of a limited set of sequences. We then compared these with the indicator vectors and structure matrix obtained with a complete reference matrix.</p>
      <p>The initial experiments were “primate-only”: reference matrix with primate sequences only (120 primate sequences); “no-Laurasiatheria”: reference matrix with Laurasiatherian sequences missing (488 non-Laurasiatherian sequences); and “missingXX%”: random percentages of sequences missing.</p>
      <p>For the “missingXX%”, we tested percentages from 10 to 90 percent (by increments of 10%). We performed 10 replicates per condition to assess the variability in the results.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec006">
    <title>Results</title>
    <p>We have implemented each of the following steps as an independent piece of code with its specific parallelization scheme, as well as in a single executable regrouping all three steps for convenience. All implementations were done in python3 using core modules and the publicly accessible libraries numpy, scipy, matplotlib, mpi4py. The source code is available at <ext-link xlink:href="https://github.com/WandrilleD/pyKleeBarcode" ext-link-type="uri">https://github.com/WandrilleD/pyKleeBarcode</ext-link>, complete with a documentation, tests, and example of usage with toy datasets. <xref rid="pone.0286314.g001" ref-type="fig">Fig 1</xref> gives a schematic overview of the steps involved in the process of going from an input multiple sequence alignment to a structure matrix.</p>
    <fig position="float" id="pone.0286314.g001">
      <object-id pub-id-type="doi">10.1371/journal.pone.0286314.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Schematic description of pyKleeBarcode pre-processing and steps.</title>
      </caption>
      <graphic xlink:href="pone.0286314.g001" position="float"/>
    </fig>
    <p>PyKleeBarcode takes as input a multiple sequence alignment in the fasta format, whose sequences are grouped into sequences sets, most frequently corresponding to species.</p>
    <p>The grouping of individual sequences into sets is deduced from part of the sequence name in the input fasta file, or via an association table provided using an optional argument to the script. Note that a sequence set may contain a single sequence. Also, note that while the original method from [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>] enforces the constraint that each sequence set has the same number of sequences, pyKleeBarcode allows sequence sets of different sizes.</p>
    <sec id="sec007">
      <title>Sequence alignment pre-processing steps</title>
      <p>To compute the structure matrix from a multiple sequence alignment, the DNA sequences are first pre-processed and transformed to vectors of four numbers. The pre-processing consists in a tentative imputation of the ambiguous N characters: any N character is replaced by the modal nucleotide at this position among its sequence set (typically, sequences of the same species in the multiple sequence alignment), unless that modal value is the gap character (“-”), or there are multiple non-gap character modal values, in which case the value stays N at this position. This pre-processing step is unchanged from the original method of [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>]. Then the sequences are transformed to numerical vectors where each nucleotide is represented using four numbers, such that A corresponds to [1,0,0,0], C to [0,1,0,0], G to [0,0,1,0], and T to [0,0,0,1]), and the gap character “-" to [0,0,0,0] (formula 1 and 2 of [<xref rid="pone.0286314.ref022" ref-type="bibr">22</xref>]), additionally we have added support for ambiguous IUPAC characters, which corresponds to a vector with the different possibilities having the same weights and summing to 1 (<italic toggle="yes">e</italic>.<italic toggle="yes">g</italic>., B may correspond to C,G, or T and is represented as [0,1/3,1/3,1/3]).</p>
      <p>The numerical representations of each sequence are then grouped by set into matrices where each row is the numerical vector of a single sequence. Thus, sequence set <italic toggle="yes">i</italic> is represented as matrix s<sub>i</sub> of size <italic toggle="yes">m</italic>×<italic toggle="yes">s</italic>⋅4, where <italic toggle="yes">m</italic> is the number of sequences in the sequence set and <italic toggle="yes">s</italic> is the sequence size, in nucleotides.</p>
      <p>This series of pre-processing steps are represented in <xref rid="pone.0286314.g001" ref-type="fig">Fig 1</xref>. They are performed either once, or at the beginning of step 1 and step 2 when these are executed as independent executables.</p>
    </sec>
    <sec id="sec008">
      <title>Step1: Reference matrix computation</title>
      <p>This step corresponds to the computation of a matrix representation of the diversity of a DNA sequence across several individuals or sets of individuals (typically, species) that will serve as a reference against which individual sequence will later be contrasted (see step 2).After sequences have been transformed into numerical vectors and grouped into matrices s<sub>i</sub> as described in the pre-processing steps above and the top part of <xref rid="pone.0286314.g001" ref-type="fig">Fig 1</xref>, the reference matrix R is obtained by computing, for each sequence set i:
<disp-formula id="pone.0286314.e008"><alternatives><graphic xlink:href="pone.0286314.e008.jpg" id="pone.0286314.e008g" position="anchor"/><mml:math id="M8" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></disp-formula></p>
      <p>And then summing all S<sub>i</sub> matrices, normalized by the number of sequences in each set m<sub>i</sub>:
<disp-formula id="pone.0286314.e009"><alternatives><graphic xlink:href="pone.0286314.e009.jpg" id="pone.0286314.e009g" position="anchor"/><mml:math id="M9" display="block" overflow="scroll"><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>See the <xref rid="sec002" ref-type="sec">Method</xref> section detail how we derive this formulation from the original formulas of [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>].</p>
      <p>Reference matrix computation has a time complexity of <italic toggle="yes">O</italic>(<italic toggle="yes">Ns</italic><sup>2</sup>) and a memory complexity of <inline-formula id="pone.0286314.e010"><alternatives><graphic xlink:href="pone.0286314.e010.jpg" id="pone.0286314.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msqrt><mml:mi>N</mml:mi></mml:msqrt><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>.</p>
      <p>When executed as an independent script, it takes as input a multiple sequence alignment in the fasta format, and as output the reference matrix in a simple binary format, chosen for its read/write performance.</p>
      <p>The script is parallelized using MPI and thus it can be deployed on multiple CPU architectures. Briefly, the different sequences sets are split between the different processes, each computing a local reference matrix, which are then combined before being written to a file.</p>
      <p>Furthermore, we provide a utility script to merge pre-existing reference matrix together (provided they were computed on an independent set of sequences and that no grouping/species are shared). This allows one to update a previously obtained matrix with new sequences.</p>
      <p>Additionally, it also permits the computation of a reference matrix to be subdivided in any number of subtasks, by simply splitting the input alignment, and subsequently merging the resulting matrices. This makes the computation of very large datasets tractable and easy to deploy on one or multiple HPC architecture.</p>
    </sec>
    <sec id="sec009">
      <title>Step2: Indicator vector computation</title>
      <p>This step corresponds to the computation of indicator vectors for each sequence or sets of sequences provided.</p>
      <p>As per [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>], the indicator vector of a sequence set is defined as the eigenvector with the largest positive eigenvalue of a matrix contrasting the sequence set against all other sequence sets. Using the definitions provided above, for sequence set i this matrix is computed as:
<disp-formula id="pone.0286314.e011"><alternatives><graphic xlink:href="pone.0286314.e011.jpg" id="pone.0286314.e011g" position="anchor"/><mml:math id="M11" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mi>R</mml:mi></mml:math></alternatives></disp-formula></p>
      <p>See the <xref rid="sec002" ref-type="sec">Method</xref> section detail how we derive this formulation from the original formulas of [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>].</p>
      <p>Indicator vectors computation has a time and a memory complexity of <italic toggle="yes">O</italic>(<italic toggle="yes">Ns</italic><sup>2</sup>). When executed as an independent script, it takes as input a multiple sequence alignment in the fasta format, the reference matrix (as obtained from the previous step), and it outputs indicator vectors in a csv format file.</p>
      <p>The computation of each individual indicator vector being independent from the rest, the parallelization of this script using MPI is fairly straightforward.</p>
      <p>As with step1, it is possible to further split the computations in many subtasks by splitting the input alignment before invoking pyKleeBarcode. The subsequent merging of the resulting file is done by simple concatenation.</p>
    </sec>
    <sec id="sec010">
      <title>Step3: Structure matrix computation</title>
      <p>In this step a structure matrix, containing the correlation between the indicator vectors of different sets of sequences, is computed.</p>
      <p>In pyKleeBarcode it may be computed either in one go as the inner product of in two fashions. Either in one go, following the formulation of [<xref rid="pone.0286314.ref024" ref-type="bibr">24</xref>], with a single multiplication of a matrix where each row is an indicator vector by its transpose, or in multiple steps where each step computes a line from the structure matrix.</p>
      <p>The first option is faster—albeit both options have the same time complexity–but more memory-intensive because the whole structure matrix needs to be held in memory at once, while the second one is slower but requires less memory.</p>
      <p>The switch between these two options is, by default, set at 5,000 indicator vectors, corresponding to about 800Mb of memory, and can be modified to suit the available resources.</p>
      <p>Structure matrix computation has a time complexity of <italic toggle="yes">O</italic>(<italic toggle="yes">Ns</italic>) and a memory complexity of <italic toggle="yes">O</italic>(<italic toggle="yes">N</italic><sup>2</sup><italic toggle="yes">s</italic>) when the number of indicator vectors is small, and <italic toggle="yes">O</italic>(<italic toggle="yes">Ns</italic>) otherwise.</p>
      <p>This step takes as input the set of indicator vectors, in csv format, for which to compute pair-wise correlations; and it outputs the structure matrix (in a binary format of its lower triangular portion).</p>
      <p>While the previous steps could be parallelized and split in subtasks in a straightforward manner, the structure matrix computation matrix computation is a more complicated affair, because it must look at all pairs of indicator vectors.</p>
      <p>Nevertheless, we have devised an algorithm, and provide the corresponding script, to update an existing structure matrix with new indicator vectors (and thus, new sequences).</p>
      <p>In fact, as structure matrices grow quadratically in size with the number of sequence sets they represent (count about 38Gb for 100,000 sequence sets), the structure matrix file format has been explicitly devised with the goal of allowing an update without having to read, or even re-write the whole file; the new information is merely appended to it.</p>
      <p>Overall, throughout our various benchmarks and experiments, Step2 has consistently been the step that took most of the computational time (usually between 80% and 90%). When using a single MPI process, pykleebarcode has a performance of the same order of magnitude as the original Matlab code (see <xref rid="pone.0286314.s003" ref-type="supplementary-material">S2 Fig</xref>); the usage of several MPI processes diminishes runtime due to the increased amount of computational resources (see <xref rid="pone.0286314.s003" ref-type="supplementary-material">S2 Fig</xref>).</p>
    </sec>
    <sec id="sec011">
      <title>Impact of the reference matrix on the indicator vector and structure matrix</title>
      <p><xref rid="pone.0286314.g002" ref-type="fig">Fig 2A</xref> presents a view of the structure matrix of the mammalian dataset obtained with the whole data set as reference matrix. To help interpretation, rows and columns have been ordered and annotated with taxonomic groups retrieved from the NCBI taxonomy [<xref rid="pone.0286314.ref034" ref-type="bibr">34</xref>], whose hierarchical structure is displayed on <xref rid="pone.0286314.g002" ref-type="fig">Fig 2B</xref>. It should be noted that the ordering of groups inside the same taxonomic unit is arbitrary (e.g.: the appearance of Carnivora next to Artiodactyla in Laurasiatheria). In this structure matrix, it appears that the correlation of indicator vectors is higher among the sequences closely lower taxonomic unit (such as Equidae, or Pecora). However, between less closely related groups (ie, off the structure matrix diagonal) the correlation fluctuates between 0.2 and 0.4. This effect is related to the genetic saturation of the studied COI5-P sequence (see <xref rid="pone.0286314.s004" ref-type="supplementary-material">S3 Fig</xref>). For reference, steps 1, 2 and 3 took respectively 5, 30 and 1 seconds as well as 95, 162, and 92 megabytes, on an Intel i7-8665U CPU on this dataset of 1049 sequences of 384bp took (for the purpose of this test each sequence were kept separate as their own set).</p>
      <fig position="float" id="pone.0286314.g002">
        <object-id pub-id-type="doi">10.1371/journal.pone.0286314.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <p>A. View of the structure matrix of the mammalian dataset and taxonomic structure of Mammalia. B. Phylogenetic tree structure of the taxonomic groups retrieved from NCBI taxonomy.</p>
        </caption>
        <graphic xlink:href="pone.0286314.g002" position="float"/>
      </fig>
      <p>To assess the effect of the impact of an incomplete reference matrix on the indicator vectors and structure matrix we designed three experiments as described in the methods section. The “primates-only” experiment serves to assess a case of extrapolation: computing indicator vectors on sequences which are outgroups to the ones included in the reference matrix. In contrast, the “no-Laurasiatheria” explores a case of interpolation, albeit one an extreme one where an entire super-order is missing. Finally, the “missingXX%” experiment addresses mixed cases of extrapolation and interpolation but where no large taxonomic group is missing.</p>
      <p><xref rid="pone.0286314.g003" ref-type="fig">Fig 3A</xref> presents the absolute Pearson correlation values between the indicator vectors obtained with a reference matrix containing all sequences versus a reference matrix containing the primate sequences only (“primates-only” experiment). All values are above 0.980, despite the “primates-only” reference matrix containing less than 12% (120/1049) of sequences, and all coming from the same subgroup of the data: primates in this instance. Interestingly, it appears the indicator vector of primate sequences themselves are among the most impacted as it presents the lowest average correlation value of all the main taxa as well as contains the vector with the overall lowest correlation value. <xref rid="pone.0286314.g004" ref-type="fig">Fig 4A</xref> reinforces this impression, as it shows that values in the structure matrix obtained from primates-only reference are highly correlated with the ones obtained with the full reference, but with a notable decrease when it comes to values describing the similarity between primates and other groups. This is suggestive of a behaviour where the effect of extrapolation (here, computing a structure matrix with some non-primates on a reference matrix containing primates sequences only) mostly affects the displayed relationship between the extrapolated sequences and the sequences used for building the reference matrix, rather than between the different extrapolated sequences.</p>
      <fig position="float" id="pone.0286314.g003">
        <object-id pub-id-type="doi">10.1371/journal.pone.0286314.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <p>A. Absolute Pearson correlation between indicator vectors obtained on the complete and the primate-only reference matrices. B. Absolute Pearson correlation between indicator vectors obtained on the complete and the no-Laurasiatheria reference matrices. C. Evolution of absolute Pearson correlation between indicator vectors obtained on the complete and a limited reference matrix with an increasing percentage of randomly missing sequences. Each boxplot corresponds to a single random replicate.</p>
        </caption>
        <graphic xlink:href="pone.0286314.g003" position="float"/>
      </fig>
      <fig position="float" id="pone.0286314.g004">
        <object-id pub-id-type="doi">10.1371/journal.pone.0286314.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Pearson correlation of the structure matrices with the reference one, grouped by main taxa.</title>
          <p>A. comparison of the primates-only structure matrix and the reference one. B. comparison of the no-Laurasiatheria structure matrix and the reference one.</p>
        </caption>
        <graphic xlink:href="pone.0286314.g004" position="float"/>
      </fig>
      <p>The results of the “no-Laurasiatheria” experiment, presented in <xref rid="pone.0286314.g003" ref-type="fig">Fig 3B</xref>, also show very good correlations with the full reference matrix, with all values being above 0.997. Regarding a pattern where the sequences included in the reference matrix (i.e., the non-laurasiatherians) are on average lower than the ones excluded (i.e., laurasiatherians), while a Mann-Whitney U yields a small p-value (&lt;10<sup>−12</sup>), the actual difference in median is only about 0.0001. <xref rid="pone.0286314.g004" ref-type="fig">Fig 4B</xref> also does not exhibit a pattern which specifically differentiate Laurasiatherians from others when comparing the structure matrices. Thus, it would seem that "interpolation” of new sequences in a structure matrix is not specifically affect the new sequences, even when they are from a group which is entirely missing from the reference matrix.</p>
      <p><xref rid="pone.0286314.g003" ref-type="fig">Fig 3C</xref> shows the results of the “missingXX%” experiment, where sequences are missing at random from the reference matrix. We see an expected pattern of general decrease in absolute correlation as the percentage of missing sequences increases, albeit all values stay above 0.9998 until 60% of sequences are missing and remain above 0.998 even when 90% of the sequences are missing. We also observe that the variation between replicates is limited, showing that this trend is robust to random sampling effects.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec012">
    <title>Discussion</title>
    <p>PyKleeBarcode builds on the previous works on indicator vectors, and allows several new possibilities, such as an extended handling of ambiguous nucleotide character, but more importantly the ability to have differences in the number of sequences included per group, as well as the possibility of efficient integration of new results onto a pre-existing structure matrix—something hitherto not possible. As our experiments have shown, this has only minimal impact on the computed indicator vectors and similarities between sequences, except in the direst of scenarios, such as in the primates-only experiment, or when the percentage of new sequences is above 50%. Consequently, our method is appropriate to integrate a growing set of sequences, continuously integrating new specimens to see where they fit among the existing structure, which could only need to be entirely recomputed for major version releases for example.</p>
    <p>Considering PyKleeBarcode, and the indicator vectors approach in general, in the context of other methods used to extract insight from homologous sequences, it first presumes that a multiple sequence alignment has already been obtained, using MAFFT [<xref rid="pone.0286314.ref032" ref-type="bibr">32</xref>, <xref rid="pone.0286314.ref033" ref-type="bibr">33</xref>] for example, in order to establish homology nucleotide by nucleotide. Thus, in an analysis pipeline it would come after tools used to establish a distance-based homology between a single sequence and among a larger database, such as BLAST [<xref rid="pone.0286314.ref035" ref-type="bibr">35</xref>], mapping tools such as bwa [<xref rid="pone.0286314.ref036" ref-type="bibr">36</xref>] or minimap2 [<xref rid="pone.0286314.ref037" ref-type="bibr">37</xref>], or dedicated software and databases (such as SiLiX [<xref rid="pone.0286314.ref038" ref-type="bibr">38</xref>] and HOGENOM [<xref rid="pone.0286314.ref039" ref-type="bibr">39</xref>] for instance), which are not the most appropriate or efficient to compute all pairwise distances between already aligned sequences.</p>
    <p>As we noted above our approach can be contrasted with phylogenetic tree reconstruction methods: pyKleeBarcode does not create an explicit evolutionary scenario, but only a distance matrix. Consequently, pyKleeBarcode is robust to cases where sequences do not follow a strictly tree-like evolutionary scenario and is not hindered by the unfavorable combinatorics of the number of possible tree topologies. In contrast, likelihood-based tree reconstruction methods must constantly engage in compromises between result approximation and runtime to completion.</p>
    <p>Furthermore, the distance matrix produced by pyKleeBarcode may be used as the basis to construct a tree, using a distance-based method such as Neighbor-Joining [<xref rid="pone.0286314.ref040" ref-type="bibr">40</xref>] or UPGMA [<xref rid="pone.0286314.ref041" ref-type="bibr">41</xref>]. PyKleeBarcode may be used in complement with the results of likelihood-based methods to point out discrepancies that suggest reticulated evolution or convergences.</p>
    <p>The indicator vector approach is most closely related with pairwise-distance methods and shares some of their limitations such as a sensitivity to genetic saturation. The main specificity of our approach relies on the elegant approach of [<xref rid="pone.0286314.ref023" ref-type="bibr">23</xref>] to conserve the richness of sequence diversity information when grouping sequences at various taxonomic levels rather than relying on a single consensus sequence per group.</p>
    <p>Some properties of indicator vectors are still unclear. For example, the contrastive nature of the approach should make them robust against heterogeneities in the mutation patterns of sequences, but this remains to be tested. Similarly, it would be of interest to investigate potential biases introduced by sampling differences between studied clades.</p>
    <p>With pyKleeBarcode we propose a flexible and up-to-date interface to compute indicator vectors and structure matrix from a multiple sequence alignment in a manner, adapted to the size of modern datasets and large computer infrastructures.</p>
    <p>We anticipate that pyKleeBarcode will help undertake deeper analyses of biological sequence databases, including BOLD, and allow new insights into large scale features of extant life.</p>
  </sec>
  <sec id="sec013" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pone.0286314.s001" position="float" content-type="local-data">
      <label>S1 File</label>
      <caption>
        <p>Supporting information for “PyKleeBarcode: Enabling representation of the whole animal kingdom in information space “Appendix A: Benchmarking of pykleeBarcode against the previous Matlab implementation, and Appendix B: Investigating the saturation of the COI5-P among mammals evolution.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0286314.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0286314.s002" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <p>Evolution of execution time (A) and peak RAM usage (B) for the computation of a structure matrix with the number of DNA sequences for different implementations.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0286314.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0286314.s003" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Estimation of the speedup of pykleeBarcode achieved with 4 MPI processes.</title>
        <p>The red line represents the average on a rolling window of 20 points.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0286314.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0286314.s004" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Evolution of COI5-P hamming distances with divergence time among mammals.</title>
        <p>The red line corresponds to a rolling average of a 20 MYA window.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0286314.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>Important thanks to Brian Abbott, Jesse Ausubel, Jacqueline Faherty, and Mark Stoeckle for valuable discussions. Calculations were performed at sciCORE (<ext-link xlink:href="http://scicore.unibas.ch/" ext-link-type="uri">http://scicore.unibas.ch/</ext-link>) scientific computing center at University of Basel, with support by the SIB—Swiss Institute of Bioinformatics. The title is a reference to Stewart Brand’s question “Why haven’t we seen a photograph of the whole earth yet?” <ext-link xlink:href="https://en.wikipedia.org/wiki/The_Blue_Marble" ext-link-type="uri">https://en.wikipedia.org/wiki/The_Blue_Marble</ext-link>.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0286314.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Cobb</surname><given-names>M.</given-names></name><article-title>60 years ago, Francis Crick changed the logic of biology</article-title>. <source><italic toggle="yes">PLoS biology</italic></source><year>2017</year>, <volume>15</volume>(<issue>9</issue>):<fpage>e2003243</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pbio.2003243</pub-id><?supplied-pmid 28922352?><pub-id pub-id-type="pmid">28922352</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Crick</surname><given-names>FH</given-names></name>. <article-title>On protein synthesis</article-title>. <source><italic toggle="yes">Symp Soc Exp Biol</italic></source><year>1958</year>, <fpage>12</fpage>:138–163. <?supplied-pmid 13580867?><pub-id pub-id-type="pmid">13580867</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref003">
      <label>3</label>
      <mixed-citation publication-type="book"><name><surname>Zuckerkandl</surname><given-names>E</given-names></name>, <name><surname>Pauling</surname><given-names>L</given-names></name>. <part-title>Molecular Disease, Evolution, and Genic Heterogeneity.</part-title> In: <source><italic toggle="yes">Horizons in Biochemistry: Albert Szent-Gyögyi Dedicatory Volume</italic>. edn. Edited by</source>
<name><surname>Kasha</surname><given-names>M</given-names></name>, <name><surname>Pullman</surname><given-names>B</given-names></name>: <publisher-name>Academic Press</publisher-name>; <year>1962</year>: <fpage>189</fpage>–<lpage>225</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0286314.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Zuckerkandl</surname><given-names>E.</given-names></name><article-title>Fifty-year old and still ticking… . an interview with Emile Zuckerkandl on the 50th anniversary of the molecular clock. Interview by Giacomo Bernardi</article-title>. <source><italic toggle="yes">Journal of molecular evolution</italic></source><year>2012</year>, <volume>74</volume><issue>(5–6</issue>):<fpage>233</fpage>–<lpage>236</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00239-012-9511-6</pub-id><?supplied-pmid 22739996?><pub-id pub-id-type="pmid">22739996</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Koonin</surname><given-names>EV</given-names></name>. <article-title>A half-century after the molecular clock: new dimensions of molecular evolution</article-title>. <source><italic toggle="yes">EMBO reports</italic></source><year>2012</year>, <volume>13</volume>(<issue>8</issue>):<fpage>664</fpage>–<lpage>666</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/embor.2012.103</pub-id><?supplied-pmid 22791022?><pub-id pub-id-type="pmid">22791022</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Kimura</surname><given-names>M</given-names></name>, <name><surname>Crow</surname><given-names>JF</given-names></name>. <article-title>The Number of Alleles That Can Be Maintained in a Finite Population</article-title>. <source><italic toggle="yes">Genetics</italic></source><year>1964</year>, <volume>49</volume>:<fpage>725</fpage>–<lpage>738</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/genetics/49.4.725</pub-id><?supplied-pmid 14156929?><pub-id pub-id-type="pmid">14156929</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Kimura</surname><given-names>M.</given-names></name><article-title>DNA and the neutral theory</article-title>. <source><italic toggle="yes">Philosophical transactions of the Royal Society of London</italic></source><year>1986</year>, <volume>312</volume>(<issue>1154</issue>):<fpage>343</fpage>–<lpage>354</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rstb.1986.0012</pub-id><?supplied-pmid 2870526?><pub-id pub-id-type="pmid">2870526</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Kimura</surname><given-names>M.</given-names></name><article-title>Preponderance of synonymous changes as evidence for the neutral theory of molecular evolution</article-title>. <source><italic toggle="yes">Nature</italic></source><year>1977</year>, <volume>267</volume>(<issue>5608</issue>):<fpage>275</fpage>–<lpage>276</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/267275a0</pub-id><?supplied-pmid 865622?><pub-id pub-id-type="pmid">865622</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Parvathy</surname><given-names>ST</given-names></name>, <name><surname>Udayasuriyan</surname><given-names>V</given-names></name>, <name><surname>Bhadana</surname><given-names>V</given-names></name>. <article-title>Codon usage bias</article-title>. <source><italic toggle="yes">Mol Biol Rep</italic></source><year>2022</year>, <volume>49</volume>(<issue>1</issue>):<fpage>539</fpage>–<lpage>565</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s11033-021-06749-4</pub-id><?supplied-pmid 34822069?><pub-id pub-id-type="pmid">34822069</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Woese</surname><given-names>CR</given-names></name>, <name><surname>Kandler</surname><given-names>O</given-names></name>, <name><surname>Wheelis</surname><given-names>ML</given-names></name>. <article-title>Towards a natural system of organisms: proposal for the domains of archea, bacteria, and eukarya</article-title>. <source><italic toggle="yes">Proc Natl Acad Sci USA</italic></source><year>1990</year>, <volume>87</volume>:<fpage>4576</fpage>–<lpage>4579</lpage>.<pub-id pub-id-type="pmid">2112744</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Woese</surname><given-names>CR</given-names></name>, <name><surname>Fox</surname><given-names>GE</given-names></name>. <article-title>Phylogenetic structure of the prokaryotic domain: the primary kingdoms</article-title>. <source><italic toggle="yes">Proceedings of the National Academy of Sciences of the United States of America</italic></source><year>1977</year>, <volume>74</volume>(<issue>11</issue>):<fpage>5088</fpage>–<lpage>5090</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.74.11.5088</pub-id><?supplied-pmid 270744?><pub-id pub-id-type="pmid">270744</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Olsen</surname><given-names>GJ</given-names></name>, <name><surname>Lane</surname><given-names>DJ</given-names></name>, <name><surname>Giovannoni</surname><given-names>SJ</given-names></name>, <name><surname>Pace</surname><given-names>NR</given-names></name>, <name><surname>Stahl</surname><given-names>DA</given-names></name>. <article-title>Microbial ecology and evolution: a ribosomal RNA approach</article-title>. <source><italic toggle="yes">Annual review of microbiology</italic></source><year>1986</year>, <fpage>40</fpage>:337–365. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev.mi.40.100186.002005</pub-id><?supplied-pmid 2430518?><pub-id pub-id-type="pmid">2430518</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Avise</surname><given-names>JC</given-names></name>, <name><surname>Arnold</surname><given-names>J</given-names></name>, <name><surname>Ball</surname><given-names>RM</given-names></name>, <name><surname>Bermingham</surname><given-names>E</given-names></name>, <name><surname>Lamb</surname><given-names>T</given-names></name>, <name><surname>Neigel</surname><given-names>JE</given-names></name>, <etal>et al</etal>. <article-title>Intraspecific phylogeography: the mitochondrial bridge between population genetics and systematics.</article-title><source><italic toggle="yes">Ann Rev Ecol Syst</italic></source><year>1987</year>, <volume>18</volume>:<fpage>489</fpage>–<lpage>522</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0286314.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Moore</surname><given-names>WS</given-names></name>. <article-title>Inferring phylogenies from mtDNA variation: Mitochondrial-gene trees versus nuclear-gene trees</article-title>. <source><italic toggle="yes">Evolution</italic></source><year>1995</year>, <volume>49</volume>:<fpage>718</fpage>–<lpage>726</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/j.1558-5646.1995.tb02308.x</pub-id><?supplied-pmid 28565131?><pub-id pub-id-type="pmid">28565131</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Ausubel</surname><given-names>JH</given-names></name>. <article-title>A botanical macroscope</article-title>. <source><italic toggle="yes">Proceedings of the National Academy of Sciences of the United States of America</italic></source><year>2009</year>, <volume>106</volume>(<issue>31</issue>):<fpage>12569</fpage>–<lpage>12570</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0906757106</pub-id><?supplied-pmid 19666620?><pub-id pub-id-type="pmid">19666620</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Hebert</surname><given-names>PD</given-names></name>, <name><surname>Ratnasingham</surname><given-names>S</given-names></name>, <name><surname>deWaard</surname><given-names>JR</given-names></name>. <article-title>Barcoding animal life: cytochrome c oxidase subunit 1 divergences among closely related species</article-title>. <source><italic toggle="yes">Proc Biol Sci</italic></source><year>2003</year>, <volume>270</volume> Suppl <issue>1</issue>:<fpage>S96</fpage>–<lpage>99</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rsbl.2003.0025</pub-id>
<?supplied-pmid 12952648?><pub-id pub-id-type="pmid">12952648</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Stoeckle</surname><given-names>MY</given-names></name>, <name><surname>Hebert</surname><given-names>PD</given-names></name>. <article-title>Barcode of life.</article-title><source><italic toggle="yes">Sci Am</italic></source><year>2008</year>, <volume>299</volume>(<issue>4</issue>):<fpage>82</fpage>–<lpage>86</lpage>, 88. <?supplied-pmid 18847089?><pub-id pub-id-type="pmid">18847089</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Thaler</surname><given-names>DS</given-names></name>, <name><surname>Stoeckle</surname><given-names>MY</given-names></name>. <article-title>Bridging two scholarly islands enriches both: COI DNA barcodes for species identification versus human mitochondrial variation for the study of migrations and pathologies</article-title>. <source><italic toggle="yes">Ecology and Evolution</italic></source><year>2016</year>, <volume>6</volume>:<fpage>6824</fpage>–<lpage>6835</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/ece3.2394</pub-id><?supplied-pmid 28725363?><pub-id pub-id-type="pmid">28725363</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Ratnasingham</surname><given-names>S</given-names></name>, <name><surname>Hebert</surname><given-names>P</given-names></name>. <article-title>bold: The Barcode of Life Data System (<ext-link xlink:href="http://www.barcodinglife.org" ext-link-type="uri">http://www.barcodinglife.org</ext-link>).</article-title><source>Mol Ecol Notes</source>. <year>2007</year><month>May</month><day>1</day>;<volume>7</volume>(<issue>3</issue>):<fpage>355</fpage>–<lpage>364</lpage>.<pub-id pub-id-type="pmid">18784790</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Hebert</surname><given-names>PD</given-names></name>, <name><surname>Hollingsworth</surname><given-names>PM</given-names></name>, <name><surname>Hajibabaei</surname><given-names>M</given-names></name>. <article-title>From writing to reading the encyclopedia of life</article-title>. <source><italic toggle="yes">Philosophical transactions of the Royal Society of London</italic></source><volume>2016</volume>, <fpage>371</fpage>(<year>1702</year>).</mixed-citation>
    </ref>
    <ref id="pone.0286314.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Chu</surname><given-names>G</given-names></name>, <name><surname>Warnow</surname><given-names>T</given-names></name>. <article-title>SCAMPP+FastTree: improving scalability for likelihood-based phylogenetic placement</article-title>, <source><italic toggle="yes">Bioinformatics Advances</italic></source><year>2023</year>, <volume>3</volume>(<issue>1</issue>), <fpage>vbad008</fpage>\ <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioadv/vbad008</pub-id><?supplied-pmid 36818728?><pub-id pub-id-type="pmid">36818728</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Soucy</surname><given-names>S</given-names></name>, <name><surname>Huang</surname><given-names>J</given-names></name>, <name><surname>Gogarten</surname><given-names>J</given-names></name>. <article-title>Horizontal gene transfer: building the web of life</article-title>. <source><italic toggle="yes">Nat Rev Genet</italic></source><year>2016</year>, <volume>16</volume>, <fpage>472</fpage>–<lpage>482</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0286314.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Sirovich</surname><given-names>L</given-names></name>, <name><surname>Stoeckle</surname><given-names>MY</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>. <article-title>A scalable method for analysis and display of DNA sequences</article-title>. <source><italic toggle="yes">PLoS One</italic></source><year>2009</year>, <volume>4</volume>(<issue>10</issue>):<fpage>e7051</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0007051</pub-id><?supplied-pmid 19798412?><pub-id pub-id-type="pmid">19798412</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Sirovich</surname><given-names>L</given-names></name>, <name><surname>Stoeckle</surname><given-names>MY</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>. <article-title>Structural analysis of biodiversity.</article-title><source><italic toggle="yes">PLoS One</italic></source><year>2010</year>, <volume>5</volume>(<issue>2</issue>):<fpage>e9266</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0009266</pub-id><?supplied-pmid 20195371?><pub-id pub-id-type="pmid">20195371</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Stoeckle</surname><given-names>M</given-names></name>, <name><surname>Coffran</surname><given-names>C</given-names></name>. <article-title>TreeParser-Aided Klee Diagrams Display Taxonomic Clusters in DNA Barcode and Nuclear Gene Datasets.</article-title><source><italic toggle="yes">Sci Rep</italic></source><year>2013</year>,<volume>3</volume>, <fpage>2635</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/srep02635</pub-id><?supplied-pmid 24022383?><pub-id pub-id-type="pmid">24022383</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>von Beeren</surname><given-names>C</given-names></name>, <name><surname>Stoeckle</surname><given-names>M</given-names></name>, <name><surname>Xia</surname><given-names>J</given-names></name>, <name><surname>Burke</surname><given-names>G</given-names></name>, <name><surname>Kronauer</surname><given-names>DJC</given-names></name>. <article-title>Interbreeding among deeply divergent mitochondrial lineages in the American cockroach (Periplaneta americana).</article-title><source><italic toggle="yes">Sci Rep</italic></source><year>2015</year>, <volume>5</volume>, <fpage>8297</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/srep08297</pub-id><?supplied-pmid 25656854?><pub-id pub-id-type="pmid">25656854</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Raupach</surname><given-names>MJ</given-names></name>, <name><surname>Astrin</surname><given-names>JJ</given-names></name>, <name><surname>Hannig</surname><given-names>K</given-names></name>, <name><surname>Peters</surname><given-names>MK</given-names></name>, <name><surname>Stoeckle</surname><given-names>MY</given-names></name>, <name><surname>Wägele</surname><given-names>JW</given-names></name>. <article-title>Molecular species identification of Central European ground beetles (Coleoptera: Carabidae) using nuclear rDNA expansion segments and DNA barcodes.</article-title><source><italic toggle="yes">Front Zool</italic></source><year>2010</year>, <volume>7</volume>, <fpage>26</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1742-9994-7-26</pub-id><?supplied-pmid 20836845?><pub-id pub-id-type="pmid">20836845</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Raupach</surname><given-names>MJ</given-names></name>, <name><surname>Barco</surname><given-names>A</given-names></name>, <name><surname>Steinke</surname><given-names>D</given-names></name>, <name><surname>Beermann</surname><given-names>J</given-names></name>, <name><surname>Laakmann</surname><given-names>S</given-names></name>, <name><surname>Mohrbeck</surname><given-names>I</given-names></name>, <etal>et al</etal>. <article-title>The Application of DNA Barcodes for the Identification of Marine Crustaceans from the North Sea and Adjacent Regions.</article-title><source>PLoS One</source>. <year>2015</year><month>Sep</month><day>29</day>;<volume>10</volume>(<issue>9</issue>):<fpage>e0139421</fpage><comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0139421</pub-id><?supplied-pmid 26417993?><pub-id pub-id-type="pmid">26417993</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Modica</surname><given-names>MV</given-names></name>, <name><surname>Puillandre</surname><given-names>N</given-names></name>, <name><surname>Castelin</surname><given-names>M</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Holford</surname><given-names>M</given-names></name>. <article-title>A good compromise: rapid and robust species proxies for inventorying biodiversity hotspots using the Terebridae (Gastropoda: Conoidea).</article-title><source>PLoS One.</source><year>2014</year><month>Jul</month><day>8</day>;<volume>9</volume>(<issue>7</issue>):<fpage>e102160</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0102160</pub-id> ; PMCID: PMC4086986.<?supplied-pmid 25003611?><pub-id pub-id-type="pmid">25003611</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Stoeckle</surname><given-names>M</given-names></name>, <name><surname>Thaler</surname><given-names>D</given-names></name>. <article-title>Why Should Mitochondria Define Species?</article-title><source><italic toggle="yes">Human Evolution</italic></source><year>2018</year>, <volume>33</volume>, <fpage>1</fpage>–<lpage>30</lpage></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Stoeckle</surname><given-names>MY</given-names></name>, <name><surname>Thaler</surname><given-names>DS</given-names></name>. <article-title>DNA barcoding works in practice but not in (neutral) theory.</article-title><source><italic toggle="yes">PLoS One</italic></source> (<year>2014</year>),<volume>9</volume>, <fpage>e100755</fpage>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0100755</pub-id>
<?supplied-pmid 24988408?><pub-id pub-id-type="pmid">24988408</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Misawa</surname><given-names>K</given-names></name>, <name><surname>Kuma</surname><given-names>KI</given-names></name>, <name><surname>Miyata</surname><given-names>T</given-names></name>. <article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>. <source><italic toggle="yes">Nucleic acids research</italic></source><year>2002</year>, <volume>30</volume>(<issue>14</issue>):<fpage>3059</fpage>–<lpage>66</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkf436</pub-id><?supplied-pmid 12136088?><pub-id pub-id-type="pmid">12136088</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Katoh</surname><given-names>K</given-names></name>, <name><surname>Standley</surname><given-names>DM</given-names></name>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source><italic toggle="yes">Molecular biology and evolution</italic></source><year>2013</year>, <volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>80</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id><?supplied-pmid 23329690?><pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Schoch</surname><given-names>CL</given-names></name>, <name><surname>Ciufo</surname><given-names>S</given-names></name>, <name><surname>Domrachev</surname><given-names>M</given-names></name>, <name><surname>Hotton</surname><given-names>CL</given-names></name>, <name><surname>Kannan</surname><given-names>S</given-names></name>, <name><surname>Khovanskaya</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>NCBI Taxonomy: a comprehensive update on curation, resources and tools.</article-title><source>Database (Oxford).</source><year>2020</year><month>Jan</month><day>1</day>;2020:baaa062. [cited 2023 Jan 4] <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/database/baaa062</pub-id><?supplied-pmid 32761142?><pub-id pub-id-type="pmid">32761142</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Gish</surname><given-names>W</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <name><surname>Myers</surname><given-names>EW</given-names></name>, <name><surname>Lipman</surname><given-names>DJ</given-names></name> (<year>1990</year>) <article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source>
<volume>215</volume>: <fpage>403</fpage>–<lpage>410</lpage>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
<?supplied-pmid 2231712?><pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name>.<article-title>Fast and accurate short read alignment with Burrows-Wheeler Transform</article-title>. <source>Bioinformatics</source><year>2009</year>, <volume>25</volume>:<fpage>1754</fpage>–<lpage>60</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id><?supplied-pmid 19451168?><pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H.</given-names></name><article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>. <source><italic toggle="yes">Bioinformatics</italic></source><year>2018</year>, <volume>34</volume>:<fpage>3094</fpage>–<lpage>3100</lpage><comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id><?supplied-pmid 29750242?><pub-id pub-id-type="pmid">29750242</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Miele</surname><given-names>V</given-names></name>, <name><surname>Penel</surname><given-names>S</given-names></name>, <name><surname>Duret</surname><given-names>L</given-names></name>. <article-title>Ultra-fast sequence clustering from similarity networks with SiLiX</article-title>. <source><italic toggle="yes">BMC Bioinformatics</italic></source><year>2011</year>, <volume>12</volume>, <fpage>116</fpage><comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-12-116</pub-id><?supplied-pmid 21513511?><pub-id pub-id-type="pmid">21513511</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Penel</surname><given-names>S</given-names></name>, <name><surname>Arigon</surname><given-names>AM</given-names></name>, <name><surname>Dufayard</surname><given-names>JF</given-names></name>, <name><surname>Sertier</surname><given-names>AS</given-names></name>, <name><surname>Daubin</surname><given-names>V</given-names></name>, <name><surname>Duret</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Databases of homologous gene families for comparative genomics</article-title>. <source>BMC Bioinformatics</source><year>2009</year>, <volume>10</volume> (<issue>Suppl 6</issue>):<fpage>S3</fpage>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-10-S6-S3</pub-id>
<?supplied-pmid 19534752?><pub-id pub-id-type="pmid">19534752</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Saitou</surname><given-names>N</given-names></name>, <name><surname>Nei</surname><given-names>M</given-names></name>. <article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title>. <source><italic toggle="yes">Molecular Biology and Evolution</italic></source><year>1987</year>, <volume>4</volume>(<issue>4</issue>): <fpage>406</fpage>–<lpage>425</lpage><comment>doi: </comment><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a040454</pub-id><?supplied-pmid 3447015?><pub-id pub-id-type="pmid">3447015</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0286314.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Sokal</surname><given-names>RR</given-names></name>, <name><surname>Michener</surname><given-names>CD</given-names></name>. <article-title>A statistical method for evaluating systematic relationships.</article-title><source><italic toggle="yes">Univ</italic>. <italic toggle="yes">Kansas Sci</italic>. <italic toggle="yes">Bull</italic></source>. <year>1958</year>, <volume>38</volume>:<fpage>1409</fpage>–<lpage>1438</lpage></mixed-citation>
    </ref>
  </ref-list>
</back>
