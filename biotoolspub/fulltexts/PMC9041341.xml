<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">nargab</journal-id>
    <journal-title-group>
      <journal-title>NAR Genomics and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2631-9268</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9041341</article-id>
    <article-id pub-id-type="doi">10.1093/nargab/lqac032</article-id>
    <article-id pub-id-type="publisher-id">lqac032</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00030</subject>
        <subject>AcademicSubjects/SCI00980</subject>
        <subject>AcademicSubjects/SCI01060</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Standard Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FastViFi: Fast and accurate detection of (Hybrid) Viral DNA and RNA</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8240-2860</contrib-id>
        <name>
          <surname>Javadzadeh</surname>
          <given-names>Sara</given-names>
        </name>
        <!--sjavadza@ucsd.edu-->
        <aff><institution>Department of Computer Science &amp; Engineering</institution>, UC San Diego, La Jolla, California, <country country="US">USA</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rajkumar</surname>
          <given-names>Utkrisht</given-names>
        </name>
        <aff><institution>Department of Computer Science &amp; Engineering</institution>, UC San Diego, La Jolla, California, <country country="US">USA</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nguyen</surname>
          <given-names>Nam</given-names>
        </name>
        <aff><institution>Boundless Bio, Inc. 11099 N Torrey Pines Rd</institution>, La Jolla, CA, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sarmashghi</surname>
          <given-names>Shahab</given-names>
        </name>
        <aff><institution>Department of Electrical and Computer Engineering</institution>, UC San Diego, La Jolla, California, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Luebeck</surname>
          <given-names>Jens</given-names>
        </name>
        <aff><institution>Bioinformatics &amp; Systems Biology Graduate Program</institution>, UC San Diego, La Jolla, California, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shang</surname>
          <given-names>Jingbo</given-names>
        </name>
        <aff><institution>Department of Computer Science &amp; Engineering</institution>, UC San Diego, La Jolla, California, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Bafna</surname>
          <given-names>Vineet</given-names>
        </name>
        <!--vbafna@cs.ucsd.edu-->
        <aff><institution>Department of Computer Science &amp; Engineering</institution>, UC San Diego, La Jolla, California, <country country="US">USA</country></aff>
        <aff><institution>Boundless Bio, Inc. 11099 N Torrey Pines Rd</institution>, La Jolla, CA, <country country="US">USA</country></aff>
        <aff><institution>Moores Cancer Center</institution>, UC San Diego, La Jolla, California, <country country="US">USA</country></aff>
        <xref rid="COR2" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Email: <email>sjavadza@ucsd.edu</email></corresp>
      <corresp id="COR2">Correspondence may also be addressed to Vineet Bafna. Email: <email>vbafna@cs.ucsd.edu</email></corresp>
      <fn id="FN1">
        <p>These authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-04-26">
      <day>26</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <volume>4</volume>
    <issue>2</issue>
    <elocation-id>lqac032</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>11</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of NAR Genomics and Bioinformatics.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="lqac032.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>DNA viruses are important infectious agents known to mediate a large number of human diseases, including cancer. Viral integration into the host genome and the formation of hybrid transcripts are also associated with increased pathogenicity. The high variability of viral genomes, however requires the use of sensitive ensemble hidden Markov models that add to the computational complexity, often requiring &gt; 40 CPU-hours per sample. Here, we describe FastViFi, a fast 2-stage filtering method that reduces the computational burden. On simulated and cancer genomic data, FastViFi improved the running time by 2 orders of magnitude with comparable accuracy on challenging data sets. Recently published methods have focused on identification of location of viral integration into the human host genome using local assembly, but do not extend to RNA. To identify human viral hybrid transcripts, we additionally developed ensemble Hidden Markov Models for the Epstein Barr virus (EBV) to add to the models for Hepatitis B (HBV), Hepatitis C (HCV) viruses and the Human Papillomavirus (HPV), and used FastViFi to query RNA-seq data from Gastric cancer (EBV) and liver cancer (HBV/HCV). FastViFi ran in &lt;10 minutes per sample and identified multiple hybrids that fuse viral and human genes suggesting new mechanisms for oncoviral pathogenicity. FastViFi is available at <ext-link xlink:href="https://github.com/sara-javadzadeh/FastViFi" ext-link-type="uri">https://github.com/sara-javadzadeh/FastViFi</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>U24CA264379</award-id>
        <award-id>R01GM114362</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>DNA viruses are important infectious agents mediating a large number of human diseases, cancer in particular. These include human papillomaviruses (HPV), Epstein-Barr Virus (EBV), Hepatitis B and C viruses (HBV/HCV) and other viruses involved in the etiology of various cancers (<xref rid="B1" ref-type="bibr">1</xref>). For example, HPV (mainly HPV-16 and HPV-18) is reported to cause at least 5% of all cancers globally (<xref rid="B2" ref-type="bibr">2</xref>), with high risk HPV reported as the causal agent for almost all cervical cancers (<xref rid="B3" ref-type="bibr">3–5</xref>). Similarly, oropharynx cancer, often driven by human papillomavirus (HPV) type 16 (<xref rid="B6" ref-type="bibr">6</xref>), is now the second-fastest growing cause of cancer death and the third-fastest growing in frequency among solid organ cancers in the U.S. according to <ext-link xlink:href="https://progressreport.cancer.gov/diagnosis/incidence" ext-link-type="uri">https://progressreport.cancer.gov/diagnosis/incidence</ext-link> (2020). EBV (HHV-4), known as the cause of mononucleosis, is also associated with various non-malignant, premalignant, and malignant lymphoproliferative diseases including Burkitt lymphoma, autoimmune diseases (e.g. rheumatoid arthritis), Sjögren’s syndrome, and multiple sclerosis. In 2010, nearly 200,000 global cancer cases per year were attributable to EBV (<xref rid="B7" ref-type="bibr">7</xref>), and the rate of infections is continually growing.</p>
    <p>Analytic pipelines have been developed to identify viral sequences from Illumina NGS data (Verse (<xref rid="B8" ref-type="bibr">8</xref>), VirusFinder (<xref rid="B9" ref-type="bibr">9</xref>), ViralFusionSeq (<xref rid="B10" ref-type="bibr">10</xref>), and Virus-Clip (<xref rid="B11" ref-type="bibr">11</xref>)). Despite these advances, there is tremendous variability even between strains of the same viral subtype, and we cannot preclude the possibility that novel viral strains are missed in sequence based searches. Hirose et. al. (<xref rid="B12" ref-type="bibr">12</xref>) found an average of 4.6 per 100bp nucleotide substitutions within HPV-16 genomes in each host. Therefore, identifying the infectious viral strain remains challenging.</p>
    <p>Analyses of viral mediated cancer data has associated HPV integration into the host genome with increased DNA instability (<xref rid="B12" ref-type="bibr">12</xref>), hybrid virus-human extrachromosomal DNA formation (<xref rid="B4" ref-type="bibr">4</xref>,<xref rid="B13" ref-type="bibr">13</xref>,<xref rid="B14" ref-type="bibr">14</xref>) with dramatically increased expression of hybrid viral-human transcripts (<xref rid="B15" ref-type="bibr">15</xref>). The presence of hybrid HPV-human transcripts encoding the viral oncogene E6 are associated with poor pathogenesis (<xref rid="B16" ref-type="bibr">16</xref>). The difficulty of discovering of hybrid host-viral reads (either DNA or RNA) is tightly related to the difficulty of discovering viral reads as the host (e.g human) sequence is not highly mutated and easy to identify. However, the discovery of a viral-human hybrid read does not immediately yield the location of integration into the host genome because the host read may be drawn from a repetitive region such as Alu, LINE, or ribosomal RNA genes.</p>
    <p>New methods like VIRUSBreakend (<xref rid="B17" ref-type="bibr">17</xref>) focus specifically on improved detection of viral integration locations. VIRUSBreakend uses a keyword matching approach for the detection of viruses, followed by a local genome assembly that allows it to detect integration even in low-complexity regions of the host genome that are missed by other methods. Because of its requirement of local assembly (suitable for DNA, but not RNA), we were unable to systematically test VIRUSBreakend for identification of diverged viral reads, or for detection of host-viral hybrid transcripts using RNA-seq samples (see Results).</p>
    <p>From a different side, deep learning tools such as DeepVirFinder (<xref rid="B18" ref-type="bibr">18</xref>) have reported excellent results on identifying viral sequences drawn from larger viral families. However, when training in a host-viral setting, the networks often end up learning what is ‘not-host,’ which is an easier problem when the host has well characterized and conserved sequence (e.g. human). Unfortunately, in realistic host-viral settings, the sampled data often includes bacterial and fungal sequences (<xref rid="B19" ref-type="bibr">19</xref>,<xref rid="B20" ref-type="bibr">20</xref>), which are not known <italic toggle="yes">a priori</italic> and are therefore not included in the training set. We tested DeepVirFinder in these ‘open-set’ scenarios and observed a significant degradation in performance (Results). We had previously developed ViFi which used an ensemble of Hidden Markov Models (HMMs) to identify highly variable strains with high accuracy (<xref rid="B15" ref-type="bibr">15</xref>). However, ViFi is slow, requiring (for example) 52 cpu-hours to identify HPV from human cancer whole genome sequenced samples with 352 million reads, and is outperformed by VIRUSBreakend in detecting sites of integration.</p>
    <p>Here, we describe Filter-associated-ViFi (<italic toggle="yes">FastViFi</italic>), which uses keyword based filtering to speed up ViFi without losing sensitivity, and focuses specifically on detection of (diverged) viral reads and hybrid host-viral reads. We benchmarked FastViFi on a collection of simulated and tumor whole genome data to measure speed, precision, and recall, and compared our results to DeepVirFinder, Kraken (<xref rid="B21" ref-type="bibr">21</xref>) (a k-mer matching method) and ViFi. we tested the importance of having two Kraken filters instead of a single Kraken filter by comparing the performance of single-stage vs two-stage Kraken filtering. As VIRUSBreakend (<xref rid="B17" ref-type="bibr">17</xref>) is focused on integration sites and does not work for sparse, viral-only read data, we compared partially against it for host-viral integration and identification of hybrid viral-human transcripts in RNA-seq data. Finally, we tested the relevance of FastViFi results on three TCGA cancer datasets with Human Papilloma virus, Hepatitis B virus, Hepatitis C virus, and Epstein Barr virus infections, focusing specifically on hybrid human viral RNA detection.</p>
    <p>The results suggest that FastViFi can accurately identify diverged viral strains, and host-viral hybrid transcripts. Our results also identified possible novel mechanisms of cancer pathology due to hybrid transcript formation in HBV and EBV mediated cancers.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>MATERIAL AND METHODS</title>
    <p>FastViFi relies on a filtering strategy to increase speed while maintaining high sensitivity. The filter aims to rapidly discard a large majority of the (mostly human) reads, while retaining most of the true viral or viral-human hybrid reads. The small number of filtered reads are subsequently analyzed and confirmed using a slower but more accurate method (ViFi). We characterize the filter by (a) speed and (b) its sensitivity (or <italic toggle="yes">recall</italic>) in retaining true viral reads. However, <italic toggle="yes">precision</italic>, defined as the fraction of filtered reads that are truly viral, is not a major concern because the filtered reads are subsequently confirmed using ViFi. Instead, we characterize the filter by its <italic toggle="yes">efficiency</italic>–defined as the ratio of the number of query reads to the number of filtered reads. High efficiency of the filters decreases the running time of the overall computation as the slower but accurate ViFi is deployed only on the filtered reads.</p>
    <p>The pipeline implementing the filtering and matching strategy, called <italic toggle="yes">FastViFi</italic>, is shown in Figure <xref rid="F1" ref-type="fig">1A</xref> and described in this section. Broadly, for parameters <italic toggle="yes">k</italic>, <italic toggle="yes">t</italic>, <italic toggle="yes">u</italic>, we <italic toggle="yes">filtered</italic> a read if at least <italic toggle="yes">u</italic><italic toggle="yes">k</italic>-mers matched a human and virus reference database, and the fraction of <italic toggle="yes">k</italic>-mers that match virus exceeded <italic toggle="yes">t</italic>. The problem remained challenging for viruses because of their high variability. Large <italic toggle="yes">k</italic>-mers tended to lose sensitivity while smaller values of <italic toggle="yes">k</italic> lowered the efficiency. Therefore, we deployed a two stage filter with the first filter aimed towards removing human reads from the sample, and the second filter aimed at enriching for viral reads. We additionally developed a method called <italic toggle="yes">FastViFiAnalytics</italic> to automatically estimate sensitivity and efficiency of the two-stage filters for any choice of parameters, and enable the users to optimize the method for their needs.</p>
    <fig position="float" id="F1">
      <label>Figure 1.</label>
      <caption>
        <p><bold>Panel A</bold> Pipeline describing the FastViFi filter strategy. The viral, human and unmapped k-mers are used to compute the unmapped ratio and score used for filtering. <bold>Panel B</bold> Pairwise Skmer distance between reference papillomavirus strains computed using Skmer(<xref rid="B22" ref-type="bibr">22</xref>)(k=12), followed by hierarchical clustering. Known PV families Alpha, Beta and Gamma are labeled along with the marks for the test data sets–HPV-intermediate, HPV-validation, HPV-difficult and PV-non-human. Cancer associated HPV strains HPV16,18,6,11,31,33, 45, 52, and 58 cluster together in the alpha PV class.</p>
      </caption>
      <graphic xlink:href="lqac032fig1" position="float"/>
    </fig>
    <p>Finally, we extended the range of oncoviral families supported by developing new Hidden Markov models for Human Papilloma Virus (95 models), Hepatitis B (19), Hepatitis C (27) Virus and Epstein Barr Virus (5 models); we improved the software to allow for the incorporation of other viral families, for sub-family classification, and to provide more flexible controls for a range of sensitivity, and run time requirements.</p>
    <sec id="SEC2-1">
      <title>The FastViFi method</title>
      <p>Formally, consider a data set of sequences <italic toggle="yes">D</italic>. The objective is to identify a subset <italic toggle="yes">V</italic>(<italic toggle="yes">D</italic>)⊆<italic toggle="yes">D</italic> of viral sequences. Define a <italic toggle="yes">filter</italic><italic toggle="yes">F</italic> as a procedure that takes a data set <italic toggle="yes">D</italic> and returns a subset <italic toggle="yes">F</italic>(<italic toggle="yes">D</italic>)⊆<italic toggle="yes">D</italic>. A filter is characterized by its (a) <italic toggle="yes">running-time</italic> denoted by <italic toggle="yes">T</italic><sub><italic toggle="yes">F</italic></sub>(<italic toggle="yes">D</italic>); (b) <italic toggle="yes">efficiency</italic> defined as<disp-formula><tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \text{efficiency} = E = \frac{\vert D\vert }{\vert F(D)\vert }\; ; \end{equation*}$$\end{document}</tex-math></disp-formula>and, (c) <italic toggle="yes">sensitivity or recall</italic>, defined by<disp-formula><tex-math id="M0001a" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \text{recall} = \frac{\vert F(D)\cap V(D)\vert }{\vert V(D) \vert } \end{equation*}$$\end{document}</tex-math></disp-formula>A desired filter is fast, efficient and sensitive. Using this definition, ViFi can be thought of as a filter that outputs <italic toggle="yes">V</italic>(<italic toggle="yes">D</italic>)⊆<italic toggle="yes">D</italic> with very high efficiency and recall but slow running-time <italic toggle="yes">T</italic><sub><italic toggle="yes">V</italic></sub>. We attached a filter with high speed <italic toggle="yes">T</italic><sub>1</sub>, efficiency <italic toggle="yes">E</italic><sub>1</sub> and high recall and ran ViFi on the filtered output to improve overall performance. The new overall running time would be <italic toggle="yes">T</italic><sub>1</sub>(<italic toggle="yes">D</italic>) + <italic toggle="yes">T</italic><sub><italic toggle="yes">V</italic></sub>(|<italic toggle="yes">D</italic>|/<italic toggle="yes">E</italic><sub>1</sub>), and governed by the speed and efficiency of the attached filter. Also, the <inline-formula><tex-math id="M0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\text{recall}=\frac{\vert F(D)\cap V(D)\vert }{\vert V(D) \vert }$\end{document}</tex-math></inline-formula> depends critically on the recall of <italic toggle="yes">F</italic>. Filters can be composed, so that a filter is deployed on the filtered output of a previous filter. We selected filters by optimizing an efficiency versus recall trade-off.</p>
      <sec id="SEC2-1-1">
        <title>Keyword match filters</title>
        <p>We selected Kraken (<xref rid="B21" ref-type="bibr">21</xref>) as the tool to estimate the k-mer composition of the viral reads. For the parameter <italic toggle="yes">k</italic>, a taxonomy tree, and a set of reference sequences, Kraken builds an index based on k-mer length <italic toggle="yes">k</italic> from the references to rapidly annotate query reads. Specifically, Kraken reported the detected taxonomy label for each k-mer in a query read. For k-mers that mapped to multiple nodes in the taxonomy tree, Kraken reported the lowest common ancestor. Finally, the k-mers that did not map to any node in the taxonomy tree were reported as unmapped.</p>
      </sec>
      <sec id="SEC2-1-2">
        <title>Kraken references</title>
        <p>To build custom Kraken indices, human and viral references should be provided. For human reference, we used the setting in Kraken to download the reference from the NCBI library. For viral strains, we provided the reference FASTA files identical to the references in ViFi. We augmented the taxonomy tree with all viruses in the reference as direct descendants of the Viruses (Rank:superkingdom) node wit taxid:10239.</p>
      </sec>
      <sec id="SEC2-1-3">
        <title>Level-1 filtering</title>
        <p>FastViFi is composed of two filters, with the goals of discarding human reads first, followed by discarding unknown contaminant reads while retaining target viral reads later in the second filter. Each filter had 3 parameters denoted by <italic toggle="yes">k</italic><sub>1</sub>, <italic toggle="yes">u</italic><sub>1</sub>, <italic toggle="yes">t</italic><sub>1</sub>, and <italic toggle="yes">k</italic><sub>2</sub>, <italic toggle="yes">u</italic><sub>2</sub>, <italic toggle="yes">t</italic><sub>2</sub>, respectively.</p>
        <p>For read <italic toggle="yes">r</italic>, parameter <italic toggle="yes">k</italic><sub>1</sub> let <italic toggle="yes">n</italic><sub><inline-formula><tex-math id="M0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula></sub>(<italic toggle="yes">r</italic>, <italic toggle="yes">k</italic><sub>1</sub>) (respectively, <italic toggle="yes">n</italic><sub><italic toggle="yes">h</italic></sub>(<italic toggle="yes">r</italic>, <italic toggle="yes">k</italic><sub>1</sub>)) denote the number of k-mers labeled as viral (respectively, human). We defined a v-score for <italic toggle="yes">r</italic> as:<disp-formula><tex-math id="M0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \text{v-score}(r,k_1) = \frac{n_{v}(r,k_1)}{n_{v}(r,k_1) + n_{h}(r,k_1)} \end{equation*}$$\end{document}</tex-math></disp-formula>A read was classified by the Level-1 filter as <italic toggle="yes">non-human</italic> (and retained for the next filter)if and only if<disp-formula><tex-math id="M0005" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \text{v-score}(r,k_1)\ge t_1 \end{equation*}$$\end{document}</tex-math></disp-formula>or<disp-formula><tex-math id="M0006" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \frac{n_u(r,k_1)}{n_u(r,k_1)+n_v(r,k_1)+n_h(r,k_1)}\ge u_1 \end{equation*}$$\end{document}</tex-math></disp-formula>A paired-end read passed this filter if at least one of the paired-ends passed the filter.</p>
      </sec>
      <sec id="SEC2-1-4">
        <title>Level-2 filtering</title>
        <p>The level-2 filter used the same criteria as level-1 but the parameters <italic toggle="yes">k</italic><sub>2</sub>, <italic toggle="yes">t</italic><sub>2</sub> were chosen to accept viral sequences and discard contaminants. Specifically, only the viral k-mer indexes in Kraken reference were chosen for mapping k-mers.</p>
      </sec>
      <sec id="SEC2-1-5">
        <title>FastViFi filter parameter grid-search</title>
        <p>We performed a grid-search on <italic toggle="yes">k</italic><sub>1</sub>, <italic toggle="yes">k</italic><sub>2</sub>, <italic toggle="yes">u</italic><sub>1</sub>, <italic toggle="yes">t</italic><sub>1</sub> and <italic toggle="yes">t</italic><sub>2</sub> as an experimental optimization of the parameters for the Level-1 and Level-2 composed or FastViFi filters. The grid search on the FastViFifilter is performed on the following parameters and values: <italic toggle="yes">k</italic><sub>1</sub> ∈ {20, 25, 30}, <italic toggle="yes">u</italic><sub>1</sub> ∈ {0.2, 0.4, 0.6, 0.8, 0.9, 1.0}, <italic toggle="yes">t</italic><sub>1</sub> ∈ {0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8}, <italic toggle="yes">k</italic><sub>2</sub> ∈ {14, 18, 22, 24, 26, 28}, <italic toggle="yes">t</italic><sub>2</sub> ∈ {0.2, 0.4, 0.6, 0.8, 0.9, 1.0}.</p>
      </sec>
      <sec id="SEC2-1-6">
        <title>FastViFi configurations</title>
        <p>FastViFi is configured to have either high read level sensitivity, where the goal is to maximize the viral reads detected, or sample level sensitivity, where the goal is to rapidly label samples as positive or negative for a viral genome. The parameters for each configuration were extracted from the grid search values. The proposed way to run FastViFi on a dataset with a large number of samples is to first run FastViFi on <italic toggle="yes">sample-level</italic> configuration. Then, on the samples where viral reads were detected, run FastViFi on <italic toggle="yes">read-level</italic>.</p>
        <p>The <italic toggle="yes">sample-level</italic> configuration was set based on the experiment resulting the maximum combination of recall and efficiency where recall was at least 0.50 and efficiency was at least 830. Specifically, <italic toggle="yes">k</italic><sub>1</sub> = 25, <italic toggle="yes">k</italic><sub>2</sub> = 22, <italic toggle="yes">t</italic><sub>1</sub> = 0.4, <italic toggle="yes">u</italic><sub>1</sub> = 0.8 · <italic toggle="yes">n</italic>(<italic toggle="yes">r</italic>, <italic toggle="yes">k</italic><sub>1</sub>), <italic toggle="yes">t</italic><sub>2</sub> = 0.1 · <italic toggle="yes">n</italic>(<italic toggle="yes">r</italic>, <italic toggle="yes">k</italic><sub>2</sub>). Similarly, the <italic toggle="yes">read-level</italic> configuration was set based on the experiment resulting in the maximum efficiency when recall was at least 80%, resulting in a choice of <italic toggle="yes">k</italic><sub>1</sub> = 25, <italic toggle="yes">k</italic><sub>2</sub> = 18, <italic toggle="yes">t</italic><sub>1</sub> = 0.8, <italic toggle="yes">u</italic><sub>1</sub> = 0.6 · <italic toggle="yes">n</italic>(<italic toggle="yes">r</italic>, <italic toggle="yes">k</italic><sub>1</sub>), <italic toggle="yes">t</italic><sub>2</sub> = 0.2 · <italic toggle="yes">n</italic>(<italic toggle="yes">r</italic>, <italic toggle="yes">k</italic><sub>2</sub>). The software distribution includes scripts to find configurations with any desired minimum recall and efficiency based on experiments on the HPV-validation dataset.</p>
      </sec>
      <sec id="SEC2-1-7">
        <title>FastViFi input</title>
        <p>The input to FastViFi could be either a pair of FASTQ files containing sequenced paired end reads, or a BAM file containing those reads aligned to the human genome. For a given BAM file containing paired end sequenced reads aligned to the human genome, an additional <italic toggle="yes">alignment-based</italic> filter (script available in the repository) discards paired end reads where both mates are mapped to the human genome. The remaining reads are stored as FASTQ files and processed by FastViFi.</p>
      </sec>
      <sec id="SEC2-1-8">
        <title>FastViFi output</title>
        <p>FastViFi reports the paired-end reads where both mapped to viral references, or where one mate is mapped to the human genome and the other is either mapped to a viral reference or a reference HMM, as well the hybrid DNA/RNA loci and the supporting reads.</p>
      </sec>
      <sec id="SEC2-1-9">
        <title>Viral HMMs in ViFi</title>
        <p>We created viral references for HPV, HBV, HCV and EBV based on 337, 73, 111, and 23 strains respectively. The number of FastViFi HMMs created for HPV, HBV, HCV and EBV are 95, 19, 27, and 5 HMMs respectively.</p>
      </sec>
      <sec id="SEC2-1-10">
        <title>Modifications in Kraken2</title>
        <p>In the modified version of Kraken2 used in the FastViFi pipeline, the computations on score and thresholds illustrated in Figure <xref rid="F1" ref-type="fig">1</xref> are embedded in the Kraken2 process, avoiding an extra filtering step on Kraken2 output files. The filtering strategy is configurable conveniently by input flags to the modified Kraken2 software. Based on the input threshold values, as soon as a decision on discarding a read is made, further processes on the read is interrupted.</p>
      </sec>
      <sec id="SEC2-1-11">
        <title>Modifications in ViFi</title>
        <p>ViFi primarily utilizes HMM alignment to target hybrid DNA or hybrid RNA for variant viral strains. Specifically, the original ViFi software aligns paired end reads to HMMs if one mate is mapped to the human genome and one is unmapped. To broaden the scope of HMM alignment, we modified ViFi to align paired end reads to HMMs if at least one mate is unmapped. This modification enables us to extract variant viral strains in cases with no hybrid DNA or hybrid RNA. Moreover, our modifications in the read-level configuration avoids considering a BWA alignment to the human or viral genomes a valid alignment in case a significant number (80%) of read bases are soft-clipped. Additionally, we added a feature to report further details on HMM alignment such as alignment location on HMM and the corresponding set of viral references constructing the HMM.</p>
      </sec>
    </sec>
    <sec id="SEC2-2">
      <title>FastViFiAnalytics for selection of parameters for 2-level filtering.</title>
      <p>Let ℓ denote the number of k-mers in a query sequence, and <italic toggle="yes">n</italic> denote the number of k-mers in a data set. Let <italic toggle="yes">d</italic> be the genomic distance of the query sequence from its nearest ortholog in the data set. The expected number of k-mer matches between the query and and the data set is given by<disp-formula id="M1"><label>(1)</label><tex-math id="M0007" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \mathbb {E}[{\rm \# k-mer matches}] =\lambda _v =\ell (1-d)^k \end{equation*}$$\end{document}</tex-math></disp-formula>The value of <italic toggle="yes">d</italic> depends upon context. For viral query and viral data sets, we use <italic toggle="yes">d</italic> ∈ {0.05, 0.1, 0.15, 0.2} depending upon the hardness of the data set (See data set construction below). Similarly, for a human (host) query is mapped to a human (host) reference, <italic toggle="yes">d</italic><sub><italic toggle="yes">h</italic></sub> = 0.01 (largely due to sequencing errors), and<disp-formula><tex-math id="M0008" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \lambda _h = \ell (1-d_h)^k \end{equation*}$$\end{document}</tex-math></disp-formula>Finally, consider the case of a query that is not from the same group as the index, and any k-mer match is just by chance. Let <italic toggle="yes">d</italic><sub><italic toggle="yes">r</italic></sub> denote its genomic distance from the closest sequence in the index. Here <italic toggle="yes">d</italic><sub><italic toggle="yes">r</italic></sub> is very high (we choose <italic toggle="yes">d</italic><sub><italic toggle="yes">r</italic></sub> = 0.75) but the k-mer may match anywhere in the reference containing <italic toggle="yes">n</italic> k-mers. Therefore,<disp-formula><tex-math id="M0009" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \mathbb {E}[{{\rm \# k-mer matches to query}}]=\lambda _{r,n}=\ell n (1-d_r)^k \end{equation*}$$\end{document}</tex-math></disp-formula>As the probability of a single k-mer matching is small, we assume in each case that the number of matches <italic toggle="yes">u</italic> are Poisson distributed with the parameter λ conditioned on there being at most ℓ matches. Thus, the probability of matching at most <italic toggle="yes">t</italic> of the ℓ k-mers is approximated to<disp-formula><tex-math id="M00010" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \frac{\sum _{u=0}^{t}\text{Poisson}(\lambda ,u)}{\sum _{u=0}^{\ell }\text{Poisson}(\lambda ,u)} \end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <sec id="SEC2-2-1">
        <title>Level-1 filtering</title>
        <p>The goal of level-1 filtering is to remove all host reads. Specifically, for parameters <italic toggle="yes">k</italic><sub>1</sub>, <italic toggle="yes">u</italic><sub>1</sub>, <italic toggle="yes">t</italic><sub>1</sub>, we <italic toggle="yes">retain</italic> a read only if <italic toggle="yes">no more</italic> than <italic toggle="yes">u</italic><sub>1</sub>ℓ <italic toggle="yes">k</italic><sub>1</sub>-mers are matched (i.e. non-host) OR if <italic toggle="yes">t</italic><sub>1</sub>ℓ or higher number <italic toggle="yes">k</italic><sub>1</sub>-mers match to virus. The second filtering condition ensures that viral reads are retained, providing an estimate of sensitivity as:<disp-formula id="M2"><label>(2)</label><tex-math id="M00011" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \text{Sensitivity}_1 \simeq \frac{\sum _{u=t_1\ell }^{\ell }\text{Poisson}(\lambda _v,u)}{\sum _{u=0}^{\ell }\text{Poisson}(\lambda _v,u)} \end{equation*}$$\end{document}</tex-math></disp-formula>The probability of retaining (not discarding) a host sequence is approximated by<disp-formula><tex-math id="M00012" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} P_h\simeq \frac{\sum _{u=0}^{u_1\ell } \text{Poisson}(\lambda _h,u)}{\sum _{u=0}^{\ell } \text{Poisson}(\lambda _h,u)} \end{equation*}$$\end{document}</tex-math></disp-formula>Define <italic toggle="yes">P</italic><sub><italic toggle="yes">r</italic></sub> as the prior probability of a sequence being a contaminant sequence in the sample. We estimate <italic toggle="yes">P</italic><sub><italic toggle="yes">r</italic></sub> ≃ 0.05 , <italic toggle="yes">d</italic><sub><italic toggle="yes">r</italic></sub> = 0.75. Let <italic toggle="yes">n</italic> = 3 × 10<sup>9</sup> and <italic toggle="yes">n</italic><sub><inline-formula><tex-math id="M00013" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula></sub> = 337 × 7500 represent the number of k-mers in the human genome and viral references respectively.<disp-formula><tex-math id="M00014" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} \text{Pr[random-match]} &amp;\simeq&amp; \frac{\sum _{u=0}^{t_1\ell _1} \text{Poisson}(\lambda _{r, n_h},u)}{\sum _{u=0}^{\ell _1} \text{Poisson}(\lambda _{r, n_h},u)}\\ \text{Pr[pass-filter]} &amp;=&amp; (1 - P_r) \cdot P_h + P_r \cdot \text{Pr[random-match]} \\ \text{Efficiency}_1 &amp;\simeq&amp; \frac{1}{\Pr [\text{pass-filter}]} \end{eqnarray*}$$\end{document}</tex-math></disp-formula>In the efficiency calculations for the first level of filtering, we only count for the human reads and contaminant reads, ignoring the viral reads as the number of viral reads are negligible when compared to contaminant and human reads.</p>
      </sec>
      <sec id="SEC2-2-2">
        <title>Level 2</title>
        <p>In the second level filtering (parameters <italic toggle="yes">k</italic><sub>2</sub>, <italic toggle="yes">t</italic><sub>2</sub>, we search only against the viral reference and retain a read if at least <italic toggle="yes">t</italic><sub>2</sub>ℓ of the <italic toggle="yes">k</italic><sub>2</sub>-mers match. The probability of retaining a read is related to the prior probability <italic toggle="yes">P</italic><sub><inline-formula><tex-math id="M00015" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula></sub> of being a viral sequence, and the probability of a chance match to a non-viral sequence.<disp-formula id="M3"><label>(3)</label><tex-math id="M00016" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \Pr [\text{match}] =(1-P_v) \frac{\sum _{u=t_2\ell }^{\ell } \text{Poisson}(\lambda _{r,n},u)}{\sum _{u=0}^{\ell } \text{Poisson}(\lambda _{r,n},u)} \end{equation*}$$\end{document}</tex-math></disp-formula><disp-formula id="M4"><label>(4)</label><tex-math id="M00017" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} + P_v\frac{\sum _{u=t_2\ell }^{\ell } \text{Poisson}(\lambda _v,u)}{\sum _{u=0}^{\ell } \text{Poisson}(\lambda _v,u)} \end{equation*}$$\end{document}</tex-math></disp-formula><disp-formula id="M5"><label>(5)</label><tex-math id="M00018" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \text{Efficiency}_2 =\frac{1}{\Pr [\text{match}]} \end{equation*}$$\end{document}</tex-math></disp-formula><disp-formula id="M6"><label>(6)</label><tex-math id="M00019" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \text{Sensitivity}_2 = \frac{\sum _{u=t_2\ell }^{\ell } \text{Poisson}(\lambda _v,u)}{\sum _{u=0}^{\ell } \text{Poisson}(\lambda _v,u)} \end{equation*}$$\end{document}</tex-math></disp-formula>The overall efficiency and sensitivity of the composite filter is the product of the efficiencies and sensitivities of the two filters, respectively.</p>
      </sec>
    </sec>
    <sec id="SEC2-3">
      <title>Using DeepVirFinder</title>
      <p>We compared FastViFi against DeepVirFinder (<xref rid="B18" ref-type="bibr">18</xref>) (DVF), the deep-learning gold standard for HPV detection. DVF which uses a CNN-based discriminative classifier to classify human and HPV sequences (<xref rid="B18" ref-type="bibr">18</xref>).</p>
      <p>We re-trained DeepVirFinder using our training data HPV-ref and reads from the human genome. We optimized the model using 500 filters in the convolutional layer, and 100 nodes in the dense layer. We trained for the model until convergence using 8 GeForce GTX 1080 Ti GPUs. As recommended by the software, if the loss on the validation set did not improve for 7 epochs (the ‘patience’ time), we halted the training.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Benchmark data sets</title>
      <p>We collected Human Papillomavirus (HPV) references from the Papillomavirus Episteme dataset (PaVE). PaVE portal is accessible through <ext-link xlink:href="https://pave.niaid.nih.gov" ext-link-type="uri">https://pave.niaid.nih.gov</ext-link>. We used all 337 HPV strains recorded prior to October 2017 as the <italic toggle="yes">training/reference</italic> data and refer to this dataset as <bold>HPV − ref</bold>. All sequences recorded after this date were referred to as <italic toggle="yes">novel</italic></p>
      <p>We used Skmer (<xref rid="B22" ref-type="bibr">22</xref>) to compute the minimum distance of every novel sequence to any sequence in HPV-ref. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref> shows the distribution of computed Skmer distances of each novel sequence with respect to HPV-ref, with the distance ≥0.1. We chose the four test data sets based on first (<bold>HPV-intermediate</bold>), 33<sup><italic toggle="yes">rd</italic></sup> (<bold>HPV-Validation</bold>), 66<sup><italic toggle="yes">th</italic></sup> (<bold>HPV-difficult</bold>) and last (<bold>PV-non-human</bold>) percentile of the distribution. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S11</xref> describes the strain names for each of the test data sets.</p>
      <p>Each test data set consisted of simulated reads (using ART (<xref rid="B23" ref-type="bibr">23</xref>)) from the selected viral genomes, the human genome (GRCh38 assembly), and contaminant genomes (bacterial and fungal) (<xref rid="B19" ref-type="bibr">19</xref>) as follows:</p>
      <list list-type="bullet">
        <list-item>
          <p>100k paired-end human originated reads simulated from the human genome (GRCh38 assembly) with coverage of 0.01.</p>
        </list-item>
        <list-item>
          <p>Around 240 paired-end virus originated reads simulated from 10 viral strains. For each viral genome, reads were simulated with coverage of 1. The exact number for each dataset varied depending on the length of the viral genomes.</p>
        </list-item>
        <list-item>
          <p>5250 paired-end reads sampled from five bacterial and three fungal strains (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S12</xref>) chosen randomly from the NCBI taxonomy tree. Reads were simulated from bacterial and fungal genomes and sub-sampled randomly, resulting in 2625 paired-end bacterial reads and 2625 paired-end fungal reads.</p>
        </list-item>
      </list>
      <p>All simulated data sets include the same human and contaminant reads, i.e., only the viral reads are updated for each test data set, and percentage of human to viral to contaminant reads was 100,000:240:5,250.</p>
    </sec>
    <sec id="SEC2-5">
      <title>FastViFi analysis</title>
      <sec id="SEC2-5-1">
        <title>Using FastViFi for identifying DNA integration and hybrid transcripts</title>
        <p>Hybrid DNA integration and hybrid transcripts are reported after clustering reads within the same junction and reporting the number of distinct junctions. Reads are considered to be within the same junction if they belong to the same sample i.e., same individual, the human part of the hybrid reads are within 300bp of each other, and the viral part of the hybrid reads are within 100bp of each other.</p>
      </sec>
      <sec id="SEC2-5-2">
        <title>Hybrid transcript expression</title>
        <p>We collected normalized RNA expression values for our HBV samples and EBV samples from the HCC and STAD studies respectively, from TCGA. We computed statistics for change in gene expression for specific genes with recurrent hybrid transcripts. For each gene of interest, we refer to samples carrying hybrid transcripts for that gene as positive; samples were labeled negative for that gene otherwise. We computed the r-statistic as the ratio of the median expression of the positive and negative samples. The Wilcoxon Rank Sum test is often used to estimate the significance of the change in gene expression values, but was not used due to the small number of positive samples. Instead, we performed a rank-permutation test as follows. For each gene, we computed the rank-sum statistic <italic toggle="yes">s</italic> as the sum of the global ranks of the gene in the positive samples. We ran 10,000 trials with random permutations of the positive/negative status and computed the p-value as the fraction of trials in which the permuted rank-sum statistic was more extreme than <italic toggle="yes">s</italic>.</p>
      </sec>
    </sec>
    <sec id="SEC2-6">
      <title>Software availability</title>
      <p>FastViFi is available at <ext-link xlink:href="https://github.com/sara-javadzadeh/FastViFi" ext-link-type="uri">https://github.com/sara-javadzadeh/FastViFi</ext-link>.</p>
      <p>We modified Kraken and ViFi tools to work more efficiently in FastViFi pipeline. The forked repositories are available at</p>
      <p><ext-link xlink:href="https://github.com/sara-javadzadeh/kraken2" ext-link-type="uri">https://github.com/sara-javadzadeh/kraken2</ext-link> and</p>
      <p><ext-link xlink:href="https://github.com/sara-javadzadeh/ViFi" ext-link-type="uri">https://github.com/sara-javadzadeh/ViFi</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>Training data</title>
      <p>We collected Human Papillomavirus (HPV) references from the Papillomavirus Episteme data set (PaVE). We chose all 337 HPV strains discovered prior to October 2017 as the <italic toggle="yes">training/reference</italic> data and refer to this data set as <bold>HPV − ref</bold>.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Estimating complexity/divergence of viral data</title>
      <p>We used Skmer (<xref rid="B22" ref-type="bibr">22</xref>) to estimate the distance between HPV genomes based on the number of shared k-mers (<italic toggle="yes">k</italic> = 12) followed by hierarchical distance based clustering (Figure <xref rid="F1" ref-type="fig">1B</xref>). Notably, the known Papilloma virus (PV) classes Alpha, Beta, and Gamma (derived by querying PaVE portal), each formed their own larger clusters, while the non-human PV genomes were scattered into smaller clusters or singletons.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Test data</title>
      <p>To generate realistic scenarios, we separated the training and test data by date. Specifically, training data was comprised of papilloma viral (PV) strains available on the PaVE platform earlier than October 2017. Viruses submitted later than the date were reserved for testing. We separated sequences by divergence based on their closest distance to any viral genome in the training set and created 4 data sets of increasing divergence (Material and Methods). Among these four, an <bold>HPV-validation</bold> data set was used in a feedback loop to fine-tune the parameters learned from HPV-ref in FastViFi. Three other data sets of increasing complexity–<bold>HPV-intermediate, HPV-difficult</bold> and <bold>PV-non-human</bold>– were used to benchmark and compare algorithms for speed and accuracy (Material and Methods). These data were combined with human and ‘contaminant reads’, comprising microbial and fungal reads that are often found to contaminate human samples to complete the data sets (See Material and Methods).</p>
      <p>In addition to benchmarking test data, we also used FastViFi to identify viral reads in samples from TCGA, including DNA reads from head and neck squamous cell carcinomas (HNSC)(<xref rid="B24" ref-type="bibr">24</xref>) with HPV infection, RNA reads from hepatocellular carcinoma with HBV and HCV infections (HCC)(<xref rid="B25" ref-type="bibr">25</xref>), and RNA reads from gastric adenocarcinoma with EBV infection (STAD)(<xref rid="B26" ref-type="bibr">26</xref>).</p>
      <p>Some of the HPV-difficult and all of the PV-non-human sequences were non-human PVs and represented truly difficult cases, where the reported host on PaVE was non-human. However, they are useful for benchmarking performance on highly variant strains. We note that the known cancer associated HPVs (HPV16, 18, 6,11, 31, 33, 45, 52, 58) are all Alpha PVs. These form the easiest cases, implying that the test data sets results represent a harder and more conservative measure of accuracy.</p>
    </sec>
    <sec id="SEC3-4">
      <title>Efficiency versus recall of two-stage versus single-stage filtering</title>
      <p>We used the HPV-training data and the human reference to identify HPV-related and human keywords, and used a choice of the 5 parameters for a two-stage filter. We tested FastViFiAnalytics in predicting the optimal efficiency and recall for any choice of parameters (Figure <xref rid="F2" ref-type="fig">2A</xref>) against empirical results on HPV-Intermediate (blue-line) HPV-difficult (orange line) and also PV-non-human (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>, red line). The results suggest that FastViFiAnalytics can be utilized as a faster alternative to predict parameters without running a grid search.</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>FastViFi filtering. <bold>Panel A</bold>. Efficiency-recall trade-offs for emprical search, FastFastViFiAnalytics predictions and single-stage Kraken on the test data sets with different parameter-settings (Also see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>). <bold>Panel B</bold>. FastViFi precision versus recall on HPV-validation, along with chosen settings for FastViFi_r (orange) and FastViFi_s (red). <bold>Panel C</bold>. Precision-recall trade-off for all the benchmarked methods. For FastViFi and Kraken, the lines were obtained by running a grid search on the input parameters and excluding the data points with suboptimal performance. For DVF, the lines are formed by varying a threshold on the score of each read to classify the read origin. <bold>Panel D</bold>. FastViFi speedup versus sensitivity compared to ViFi on the HNSC data set (8 samples). Each sample is represented by a dedicated marker shape. For each sample, the markers representing ViFi experiments are placed at (1.0, 1.0), and the FastViFi speed-up and sensitivity are described relative to the corresponding ViFi run.</p>
        </caption>
        <graphic xlink:href="lqac032fig2" position="float"/>
      </fig>
      <p>We compared the efficiency versus recall for single-stage (labeled as Kraken) filtering versus the two-stage (labeled as FastViFi) filtering, and found that the two-stage filtering dominated single-stage (Kraken) filtering. For example, we observed a high efficiency of 432 at 94% recall in HPV-intermediate (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>) implies that only one out of 432 reads passed the filters to the ViFi step of FastViFi on average, potentially resulting in a sharp speedup. In contrast, the single-stage Kraken filter showed an efficiency of 254 at 94% recall (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>). This behavior was due to the single Kraken filter either permitting a larger number of non-viral reads (low efficiency) or losing true viral reads (low recall). The improved efficiency versus recall curves for the two-stage FastViFi had a direct impact on the precision versus recall curves shown later.</p>
      <p>For all methods, there was drop in efficiency from HPV-intermediate to HPV-difficult because fewer reads could be confidently discarded by the filter without losing sensitivity.</p>
    </sec>
    <sec id="SEC3-5">
      <title>Training FastViFi parameters empirically</title>
      <p>We developed the FastViFi pipeline by coupling ViFi to the output of filters with a user-defined choice of 5 parameters, and performed a grid-search (Section Material and Methods:filter parameter grid-search) on the 5 parameters, measuring precision and recall on the HPV-Validation data set (Green dots in Figure <xref rid="F2" ref-type="fig">2B</xref>) and also efficiency versus recall (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>). We chose two Pareto optimal settings. The first identified viral reads with <inline-formula><tex-math id="M00020" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$50\%$\end{document}</tex-math></inline-formula> recall and efficiency of 834. While the per-read recall was low in this setting, it was sufficient to test if the sample was HPV positive and provided high efficiency/speed. The second parameter achieved read-level sensitivity exceeding <inline-formula><tex-math id="M00021" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$80\%$\end{document}</tex-math></inline-formula> with efficiency of 392, as this setting was sufficient to identify most viral human hybrid transcripts. The pipelines corresponding to these parameter settings were denoted as as FastViFi_s (sample-level) and FastViFi_r (read-level), respectively. We compared these methods against FastViFi (Filter only with no ViFi coupling), Kraken(<xref rid="B21" ref-type="bibr">21</xref>) (a single level keyword filtering method optimized for HPV), DVF(<xref rid="B18" ref-type="bibr">18</xref>), a recent deep learning based virus finder method, and ViFi(<xref rid="B15" ref-type="bibr">15</xref>). VIRUSBreakend(<xref rid="B17" ref-type="bibr">17</xref>) requires an assembly step which failed in these sparse data-sets that are unsuitable for checking sites of integration.</p>
    </sec>
    <sec id="SEC3-6">
      <title>Precision versus recall</title>
      <p>We plotted the precision versus recall trade-off across all methods (Figure <xref rid="F2" ref-type="fig">2C</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>) for HPV-intermediate and HPV-difficult. ViFi had the highest precision and recall on HPV-intermediate and HPV-difficult. On HPV-intermediate, FastViFi_r obtained recall of 0.97 with perfect precision of 1.0. In contrast, Kraken as an stand-alone tool obtained a recall of 0.86 for precision 1.0. The recall of FastViFi_r decreased to 0.81 for HPV-difficult data, which is still sufficient to identify most HPV positive samples, while the recall of Kraken decreased to 0.53 for the highest precision reached at 0.98. To establish a baseline, we also compared our results to a direct sequence alignment based method. Specifically, we ran Blastn against the training databases to identify viral reads in the test data. Blastn had a precision less than 0.1 across all test sets. The low value of precision was attributed to the large number of diverged viral reads that could only be identified by increasing the E-value cut-offs to where false sequences also matched.</p>
      <p>Our results additionally suggest that an ideal strategy for running FastViFi on large cancer data sets would be to run FastViFi_s across the whole data set to rapidly infer viral infection, followed by running FastViFi_r on the samples deemed positive by FastViFi_s, with both options available in the GitHub repository. Across all of our test sets, DeepVirFinder achieved less than 20% precision despite retraining the models (Figure <xref rid="F2" ref-type="fig">2C</xref>). We attribute this to two key assumptions made by DeepVirFinder: (1) onco-viral genome data contain only human and viral genomes and no contaminants; and, (2) viral genomes are well-represented in the database so that the test viral genomes are adequately represented in training. The former assumption specifically, relates to <italic toggle="yes">open-set</italic> problems, with the contaminant sequences forming the unknown-unknown class (not only unseen but also having no side information during training). Open-set problems are known to be challenging for deep neural networks (<xref rid="B27" ref-type="bibr">27</xref>), and we observe that in our data. The second assumption does not suitably account for the high variation in viral strains.</p>
    </sec>
    <sec id="SEC3-7">
      <title>FastViFi rapidly and accurately identifies HPV reads in head and neck squamous cell carcinomas</title>
      <p>We applied FastViFi to WGS data from 29 HPV positive samples from the Cancer Genome Atlas study of head and neck cancers (TCGA-HNSC). The original ViFi is very resource intensive and therefore we ran it on eight samples for comparison. For both methods, we discarded reads from the input BAM file where both mates of the paired-end read mapped to the human genome prior to analysis. Notably, FastViFi_r was 10 × faster than ViFi (Figure <xref rid="F2" ref-type="fig">2D</xref>), while retrieving (on average) <inline-formula><tex-math id="M00022" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$96\%$\end{document}</tex-math></inline-formula> of the reads identified by ViFi (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). FastViFi_s was 30-120 × faster with sensitivity loss of <inline-formula><tex-math id="M00023" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$3\%$\end{document}</tex-math></inline-formula> when compared to ViFi. The running time of FastViFi_s on the 29 HNSC whole genome samples ranged from 25 minutes to 9 hours with an average of 101 minutes per sample (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>). Most runs completed in about 2 hours. The running time was correlated with the number of unmapped reads up to 10<sup>8</sup> reads, and was stable after that.</p>
      <p>In terms of accuracy on WGS data, FastViFi_s detected HPV at the threshold of ≥1 viral read per million human reads in all 29 HPV positive sequences, and in 0 of the 15 control sequences (Figure <xref rid="F3" ref-type="fig">3A</xref>). As this is a relatively ‘easy’ data set, we also tested the single stage filtering strategy. Applying Kraken as an stand alone tool could not separate the HPV negative and positive samples, and missed three HPV positive samples (sensitivity = 0.9) at the threshold of 1 viral read per million reads (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>). Moreover, in FastViFi_s we observed a significant margin between the number of viral reads (per million human reads) in HPV positive and negative classes. Such a large margin between the two classes is not observed when running Kraken. This is likely due to higher level of false positive reads reported by Kraken on HPV negative samples, compared to FastViFi_s. The results confirm that FastViFi_s can be used as a quick and accurate test for detection of HPV sequences in human samples. FastViFi_s also detected hybrid DNA in all 19 samples previously reported by ViFi.</p>
      <fig position="float" id="F3">
        <label>Figure 3.</label>
        <caption>
          <p>FastViFi based identification of genomic integration in HPV-HNSC (panel A), and hybrid transcripts in HBV-HCC (panel B), HCV-HCC (panel C) and EBV-STAD (panel D). The right side of each panel displays the distribution of viral read abundance for class samples labeled as infected (orange) and non-infected (blue) in the original study. Each sample is represented by one marker ordered by normalized viral reads (per 1 million human reads) as detected by FastViFi. The horizontal dashed line at y=1 across panels B,C,D is the accepted threshold for hybrid transcript detection. Each marker is a cross if hybrid transcripts (or hybrid DNA) was identified, and otherwise denoted by a circle.</p>
        </caption>
        <graphic xlink:href="lqac032fig3" position="float"/>
      </fig>
      <p>VIRUSBreakend does not report viral-only reads but has shown excellent performance for the detection of integration locations using local assembly on simulated data (<xref rid="B17" ref-type="bibr">17</xref>). On 22 of HCC samples with HBV, they reported exactly the same 16 integration sites as ViFi (<xref rid="B17" ref-type="bibr">17</xref>). As FastViFi has a different focus, we only did a partial comparison against VIRUSBreakend using 2 WGS HNSC samples.</p>
      <p>As recommended, GRIDSS2(<xref rid="B28" ref-type="bibr">28</xref>) was used for local assembly prior to running VIRUSBreakend. On one sample bam file, TCGA-CR-5243, FastViFi took 61 cpu-minutes including 37 minutes of the alignment-based filter (Section Material and Methods:pre-processing). VIRUSBreakend took 185 minutes using a single thread with most time devoted to local assembly using GRIDSS2 (173 minutes). On a second sample (TCGA-CR-6473), VIRUSBreakend took 187 minutes on a single thread (using 178 minutes for assembly), while FastViFi took 73 minutes, including 40 minutes of alignment-based filter (Section Material and Methods:pre-processing).</p>
    </sec>
    <sec id="SEC3-8">
      <title>FastViFi rapidly identifies viral transcripts</title>
      <p>Expectedly, the FastViFi running time was much lower on RNA-seq data for HCC and STAD, with a mean time of 2 minutes for HCC and 9 minutes for STAD (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>). Notably the Epstein Barr Virus (EBV) is significantly larger than HBV and HPV (170kbp vs. 3kbp and 7kbp), which translates to slower HMM alignments. Nevertheless, the running time on STAD RNA-seq samples was well below DNA samples in HNSC.</p>
      <p>We could not match these results on the RNA-seq samples using VIRUSBreakend, which is not configured for RNA. On a single sample of aligned reads (Barcode TCGA-FP-7998-01), the FastViFi pipeline took 40 minutes including 27 minutes of the alignment-based filter (pre-processing, see Material and Methods) using a single CPU-thread on a server with 126Gb RAM and 24 CPU-threads. VIRUSBreakend (with 60Gb heap allocation) ran for 6 days on the server but failed at the assembly step. Therefore, we did not run it on all samples.</p>
    </sec>
    <sec id="SEC3-9">
      <title>Hybrid viral-human transcripts are abundant in liver and gastric cancers</title>
      <p>We applied FastViFi to a comprehensive RNA-seq data set with 193 Hepatocellular carcinoma (HCC) cases from the Cancer Genome Atlas(<xref rid="B25" ref-type="bibr">25</xref>). In that study, three separate computational methods as well as clinical markers were used to determine the HBV/HCV status of the patients, resulting in 44 tumors being labeled as HBV positive, and 31 as HCV positive. These positive samples included cases where clinical evidence confirmed viral infection, but none of the computational models reported viral infection possibly due to a response to antiviral therapy, among other reasons.</p>
      <p>FastViFi identified at least 1 viral read per 1 million human reads in 36 (82%) of the HBV positive samples and in 1 HBV negative sample (Figure <xref rid="F3" ref-type="fig">3B</xref>). In contrast, HCV transcript abundance was much lower. In the HCC cohort, only 3 of the 35 HCV positive samples and 1 of the 161 HCV negative samples met the required threshold for detection (Figure <xref rid="F3" ref-type="fig">3C</xref>) Similar to HBV, FastViFi identified a high burden of EBV transcripts in all of the 27 samples that were reported as EBV positive and none of the EBV negative samples that had RNA-seq data available in the original study(<xref rid="B26" ref-type="bibr">26</xref>) (Figure <xref rid="F3" ref-type="fig">3D</xref>).</p>
      <p>Overall, our results suggest that viral HBV and EBV transcript abundance values strongly correlate with infection status at diagnosis, and point to the applicability of FastViFi in transcript based detection of HBV mediated liver cancers and EBV mediated gastric cancers.</p>
      <sec id="SEC3-9-1">
        <title>Viral-human hybrid RNA</title>
        <p>Out of the 37 samples with HBV-human hybrid RNA reported by the HCC study, FastViFi detected HBV-human hybrid transcripts in 36, failing to report hybrid RNA for only one sample while still labeling the sample as HBV positive (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). Additionally, FastViFi identified viral-human hybrid in one HBV(-) and also one HBV(+) sample where the hybrid RNA were not detected in the HCC study (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S4, S5</xref>). Similarly, it reported hybrid RNA in 4 HCV(-) samples not previously reported as carrying hybrid RNA in the TCGA study(<xref rid="B29" ref-type="bibr">29</xref>). Only one of these samples met the threshold of 1 viral read per 1 million human RNA reads. Notably, FastViFi identified strong evidence of HBV-human hybrid RNA in one sample (TCGA-CC-A1HT-01A) which was labeled as HBV(+) in the HCC study, but no hybrid RNA was reported (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S6, S7</xref>).</p>
        <p>We additionally tested FastViFi for detecting EBV from 371 of 440 samples in the gastric cancer (TCGA-STAD) cohort(<xref rid="B26" ref-type="bibr">26</xref>) where RNA-seq was available. EBV integration into the host genome was generally considered to be infrequent in gastric cancer(<xref rid="B26" ref-type="bibr">26</xref>,<xref rid="B29" ref-type="bibr">29</xref>,<xref rid="B30" ref-type="bibr">30</xref>). However, a recent study identified multiple genomic integration sites through a targeted sequencing approach(<xref rid="B31" ref-type="bibr">31</xref>). The TCGA study(<xref rid="B26" ref-type="bibr">26</xref>) had previously confirmed a single EBV-human hybrid transcript through long-read sequencing. FastViFi confirmed that transcript identified in the STAD study (barcode TCGA-FP-7998), but also reported hybrid EBV-human RNA in 9 additional samples representing 38% of EBV positive gastric cancers in the TCGA-STAD cohort (Figure <xref rid="F3" ref-type="fig">3D</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). Together, our data suggest that similar to HPV(<xref rid="B15" ref-type="bibr">15</xref>), HBV and EBV mediated cancers frequently carry viral-human hybrid transcripts.</p>
      </sec>
    </sec>
    <sec id="SEC3-10">
      <title>HBV and EBV hybrid transcripts mediate tumor development</title>
      <p>In the HCC cohort, we identified 793 hybrid transcript junctions after clustering junctions within 100bp (Material and Methods). On the viral genome, <inline-formula><tex-math id="M00024" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$337 (42\%)$\end{document}</tex-math></inline-formula> of these 793 junctions originated at the HBx gene (Figure <xref rid="F4" ref-type="fig">4A</xref>). The product of HBx is an oncogenic marker known to interact with many other genes including TP53 and TERT to promote oncogenesis in liver cancer(<xref rid="B32" ref-type="bibr">32</xref>). While most hybrid reads matched directly to an HBV reference, 46 individual reads were discovered through a mapping to HBV HMMs. Interestingly, these 46 reads all mapped to an HBV locus containing the S and P genes in overlapping frames (Figure <xref rid="F4" ref-type="fig">4A</xref>). These results suggest that HBV-S hybrid transcripts are prevalent in a non-reference strain of HBV. Integration at the HBV-S gene locus is incompletely understood. However, integration of the ESPL-1 gene with HBV-S is associated with hepatocellular carcinoma in Chinese populations(<xref rid="B33" ref-type="bibr">33</xref>).</p>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>Hybrid human-viral RNA loci. Panels A, B. The two histograms show the location of the integration sites on HBV and EBV, respectively. The integration locis is non-random, enriching for HBx gene on HBV (panel A) and the BALF gene cluster on EBV(panel B) EBV. <bold>Panels C, D</bold>. Illustration of hybrid transcripts for HBx (NC_003977.2) and EBV(NC_007605.1) fused to MLL4 and BALF5 respectively (GrCH38 coordinates). One paired end read was chosen to represent each junction. <bold>Panel E</bold>. Normalized abundance of hybrid isoforms relative to their non-hybrid isoforms. ‘r’ denotes the ratio of expression means in the two sets. For ease of exposition, the RSEM values were further normalized by the maximum expression of the gene in each panel. A permutation test on ranks was used to compute p-values(Material and Methods).</p>
        </caption>
        <graphic xlink:href="lqac032fig4" position="float"/>
      </fig>
      <p>The HBV hybrid junctions involved 91 distinct human genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>) of which 27 (30%) were cancer associated, in contrast with the 11% of all genes that are cancer associated (P-value: 0.0001; χ<sup>2</sup>-test). ancer associated genes were derived from the allOnco gene list accessible through <ext-link xlink:href="http://www.bushmanlab.org/links/genelists" ext-link-type="uri">http://www.bushmanlab.org/links/genelists</ext-link> (2018). Many genes appeared recurrently including KMT2B/MLL4 (10 times), TERT (8), SERPINA1 (8) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S8</xref>). Our results supported previous publications that reported hybrid TERT and KMT2B transcripts in HCC cell-lines(<xref rid="B34" ref-type="bibr">34</xref>).</p>
      <p>A gene-set enrichment analysis using DAVID(<xref rid="B35" ref-type="bibr">35</xref>) showed enrichment for blood microparticles (BH q-value: 7.41 · 10<sup>−8</sup>) and platelet α-granule lumen proteins (q-value: 1.73 · 10<sup>−7</sup>). Adhesive proteins found in α-granules mediate direct interactions between tumors and platelets and platelet adhesion may facilitate tumor metastasis through cloaking tumor cells from immune surveillance and assisting their egress from circulation(<xref rid="B36" ref-type="bibr">36</xref>).</p>
      <p>Similarly, FastViFi identified 141 junctions in EBV associated STAD samples (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S9</xref>). Four of these junctions involved EBV HMM matches while the rest matched the reference EBV sequences. On the EBV genome, the junctions enriched (Figure <xref rid="F4" ref-type="fig">4B</xref>) for a region contained eight genes (BARF0, BALF3, BALF4, BALF5, A73, RPMS1, LF2 and LF1) that are highly expressed in the majority of EBV-positive gastric cancers(<xref rid="B37" ref-type="bibr">37</xref>). The BALF family of genes are involved in the early lytic phase of the EBV life-cycle(<xref rid="B38" ref-type="bibr">38</xref>).</p>
      <p>The EBV-hybrid transcripts included 74 human genes, with B2M(2), CD74(2) and ACTB(2) occurring recurrently (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S10</xref>). Eighteen (24%) of the 74 genes were cancer associated (p-val: 0.0005). Enrichment analysis using DAVID(<xref rid="B35" ref-type="bibr">35</xref>) revealed that 32 of the 74 genes encoded components of the extracellular exosome cellular component (68 genes; GO:0070062; BH q-value:3.8 · 10<sup>−7</sup>). Extracellular vesicles (EVs) have been previously implicated in EBV pathogenesis(<xref rid="B39" ref-type="bibr">39</xref>), and this enrichment suggests a novel role of EBV hybrid transcripts in extracellular vesicle formation. In thirty of the 91 transcripts integrated with HBV and 30 of the 74 genes integrated with EBV, the overlap was with coding exons (Figure <xref rid="F4" ref-type="fig">4C</xref>,D) consistent with viral promoters driving the expression of the viral-human hybrid transcript. We tested the impact of this integration on gene expression relative to the expression of the same gene in non-integrated samples. In many cases, the hybrid transcripts were significantly over-expressed for both HBV and EBV with the mean expression of the gene 4 - 278x higher in a hybrid isoform relative to the non-hybrid isoform. (Figure <xref rid="F4" ref-type="fig">4E</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>There is tremendous diversity in viral sequences even within a single family. Accurate detection of viral sequences in a mix of host and contaminant genomes are not currently achieved by discriminative deep learning models, even ones devised and trained specifically for this purpose. Representational models such as Hidden Markov models show high sensitivity but only when an ensemble of models is used - each capturing the diversity in a single clade. This leads to a computational bottleneck, especially when searching large data sets of host genomes for presence, absence or integration of the virus. Our results suggest that a 2-stage filtering is effective and fast, with the first stage used largely to eliminate the bulk of the host sequences, and the second filter used mainly to retain the viral sequences while discarding other contaminants. The small number of filtered reads can then be searched with the HMM ensemble to identify viral reads. FastViFi can search typical human whole genome data sets in an average time of 1 hour and RNA-seq data in &lt;10 minutes.</p>
    <p>Methods such as VIRUSBreakend are excellent for detecting locations of viral integration into the host genome, but require a prior assembly step to ensure extension of repetitive sequence into unique regions. The GRIDSS2 assembly is necessary for VIRUSBreakend, but may not be a standard part of the pipeline of other tools, and therefore running VIRUSBreakend could add significant computational expense.</p>
    <p>We designed FastViFi for a quick identification of viral reads in WGS, and viral and hybrid transcripts in RNA-seq data. We ran FastViFi on different oncoviral data sets including HNSC whole genomes and RNA-seq for HBV, HCV and EBV. The results suggested interesting differences in viral pathology mechanisms between HPV versus HBV and EBV. HPV integration in the human host occurs without preference for particular loci or genes. They act primarily to promote production of viral oncogenes E5/E6. HBV and EBV showed clear preference for the location of the viral end at HBx, HBV-S, and EBV-BALF regions. Also, the human part was often located in a protein coding gene, sometimes recurrently. The hybrid transcripts were consistent with a translated product supporting the viral gene fused to a human coding gene and the viral promoters driving transcription of the fused human genes.</p>
    <p>Previous reports have suggested increased pathogenicity in HBV hybrid transcripts due to activation of LINE elements(<xref rid="B34" ref-type="bibr">34</xref>). Our results point to a role of human oncogenes in mediating this pathogenicity. Other reports suggest increased genome instability due to HBV integration(<xref rid="B40" ref-type="bibr">40</xref>). We plan to investigate these in future work. Similarly, integration of EBV in gastric cancers has been associated with global changes in gene expression(<xref rid="B41" ref-type="bibr">41</xref>), and it will be intriguing to test if some of these hybrid transcripts drive those changes. In conclusion, FastViFi will add to the toolkit available to scientists studying viral infections and hybrid viral-host transcripts.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>lqac032_Supplemental_Files</label>
      <media xlink:href="lqac032_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec id="SEC5">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nargab/article-lookup/doi/10.1093/nargab/lqac032#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NARGAB Online.</p>
  </sec>
  <sec id="SEC7">
    <title>FUNDING</title>
    <p>V.B. was supported in part by grants U24CA264379 and R01GM114362 from the NIH.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. V.B. is a co-founder, consultant, SAB member and has equity interest in Boundless Bio, inc. and Abterra, Inc. The terms of this arrangement have been reviewed and approved by the University of California, San Diego in accordance with its conflict of interest policies.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>S.</given-names></string-name>, <string-name><surname>Strong</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X.</given-names></string-name>, <string-name><surname>Moss</surname><given-names>W.N.</given-names></string-name>, <string-name><surname>Concha</surname><given-names>M.</given-names></string-name>, <string-name><surname>Lin</surname><given-names>Z.</given-names></string-name>, <string-name><surname>O’Grady</surname><given-names>T.</given-names></string-name>, <string-name><surname>Baddoo</surname><given-names>M.</given-names></string-name>, <string-name><surname>Fewell</surname><given-names>C.</given-names></string-name>, <string-name><surname>Renne</surname><given-names>R.</given-names></string-name><etal>et al</etal>.</person-group><article-title>High-Throughput RNA Sequencing-Based Virome Analysis of 50 Lymphoma Cell Lines from the Cancer Cell Line Encyclopedia Project</article-title>. <source>J. Virol.</source><year>2015</year>; <volume>89</volume>:<fpage>713</fpage>–<lpage>729</lpage>.<pub-id pub-id-type="pmid">25355872</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berman</surname><given-names>T.A.</given-names></string-name>, <string-name><surname>Schiller</surname><given-names>J.T.</given-names></string-name></person-group><article-title>Human papillomavirus in cervical cancer and oropharyngeal cancer: one cause, two diseases</article-title>. <source>Cancer</source>. <year>2017</year>; <volume>123</volume>:<fpage>2219</fpage>–<lpage>2229</lpage>.<pub-id pub-id-type="pmid">28346680</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morgan</surname><given-names>I.M.</given-names></string-name>, <string-name><surname>Dinardo</surname><given-names>L.J.</given-names></string-name>, <string-name><surname>Windle</surname><given-names>B.</given-names></string-name></person-group><article-title>Integration of human papillomavirus genomes in head and neck cancer: Is it time to consider a paradigm shift?</article-title>. <source>Viruses</source>. <year>2017</year>; <volume>9</volume>:<fpage>208</fpage>.</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Groves</surname><given-names>I.J.</given-names></string-name>, <string-name><surname>Coleman</surname><given-names>N.</given-names></string-name></person-group><article-title>Human papillomavirus genome integration in squamous carcinogenesis: what have next-generation sequencing studies taught us?</article-title>. <source>J. Path.</source><year>2018</year>; <volume>245</volume>:<fpage>9</fpage>–<lpage>18</lpage>.<pub-id pub-id-type="pmid">29443391</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kobayashi</surname><given-names>K.</given-names></string-name>, <string-name><surname>Hisamatsu</surname><given-names>K.</given-names></string-name>, <string-name><surname>Suzui</surname><given-names>N.</given-names></string-name>, <string-name><surname>Hara</surname><given-names>A.</given-names></string-name>, <string-name><surname>Tomita</surname><given-names>H.</given-names></string-name>, <string-name><surname>Miyazaki</surname><given-names>T.</given-names></string-name></person-group><article-title>A review of HPV-related head and neck cancer</article-title>. <source>J. Clin. Med.</source><year>2018</year>; <volume>7</volume>:<fpage>241</fpage>.</mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chaturvedi</surname><given-names>A.K.</given-names></string-name>, <string-name><surname>Engels</surname><given-names>E.A.</given-names></string-name>, <string-name><surname>Pfeiffer</surname><given-names>R.M.</given-names></string-name>, <string-name><surname>Hernandez</surname><given-names>B.Y.</given-names></string-name>, <string-name><surname>Xiao</surname><given-names>W.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>E.</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>B.</given-names></string-name>, <string-name><surname>Goodman</surname><given-names>M.T.</given-names></string-name>, <string-name><surname>Sibug-Saber</surname><given-names>M.</given-names></string-name>, <string-name><surname>Cozen</surname><given-names>W.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Human papillomavirus and rising oropharyngeal cancer incidence in the United States</article-title>. <source>J. Clin. Oncol</source>. <year>2011</year>; <volume>29</volume>:<fpage>4294</fpage>.<pub-id pub-id-type="pmid">21969503</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cohen</surname><given-names>J.I.</given-names></string-name>, <string-name><surname>Fauci</surname><given-names>A.S.</given-names></string-name>, <string-name><surname>Varmus</surname><given-names>H.</given-names></string-name>, <string-name><surname>Nabel</surname><given-names>G.J.</given-names></string-name></person-group><article-title>Epstein-Barr virus: an important vaccine target for cancer prevention</article-title>. <source>Sci. Transl. Med.</source><year>2011</year>; <volume>3</volume>:<fpage>107fs7</fpage>.</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Jia</surname><given-names>P.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>Z.</given-names></string-name></person-group><article-title>VERSE: A novel approach to detect virus integration in host genomes through reference genome customization</article-title>. <source>Genome Med.</source><year>2015</year>; <volume>7</volume>:<fpage>2</fpage>.<pub-id pub-id-type="pmid">25699093</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Jia</surname><given-names>P.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>Z.</given-names></string-name></person-group><article-title>VirusFinder: Software for Efficient and Accurate Detection of Viruses and Their Integration Sites in Host Genomes through Next Generation Sequencing Data</article-title>. <source>PloS one</source>. <year>2013</year>; <volume>8</volume>:<fpage>e64465</fpage>.<pub-id pub-id-type="pmid">23717618</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>M.</given-names></string-name>, <string-name><surname>Wan</surname><given-names>R.</given-names></string-name>, <string-name><surname>Yu</surname><given-names>A.</given-names></string-name>, <string-name><surname>Co</surname><given-names>N.</given-names></string-name>, <string-name><surname>Wong</surname><given-names>N.</given-names></string-name>, <string-name><surname>Chan</surname><given-names>T.-F.</given-names></string-name></person-group><article-title>ViralFusionSeq: Accurately discover viral integration events and reconstruct fusion transcripts at single-base resolution</article-title>. <source>Bioinformatics (Oxford, England)</source>. <year>2013</year>; <volume>29</volume>:<fpage>649</fpage>–<lpage>651</lpage>.</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ho</surname><given-names>D.</given-names></string-name>, <string-name><surname>Sze</surname><given-names>K.</given-names></string-name>, <string-name><surname>Ng</surname><given-names>I.</given-names></string-name></person-group><article-title>Virus-Clip: A fast and memory-efficient viral integration site detection tool at single-base resolution with annotation capability</article-title>. <source>Oncotarget</source>. <year>2015</year>; <volume>6</volume>:<fpage>20959</fpage>.<pub-id pub-id-type="pmid">26087185</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hirose</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Yamaguchi-Naka</surname><given-names>M.</given-names></string-name>, <string-name><surname>Onuki</surname><given-names>M.</given-names></string-name>, <string-name><surname>Tenjimbayashi</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Tasaka</surname><given-names>N.</given-names></string-name>, <string-name><surname>Satoh</surname><given-names>T.</given-names></string-name>, <string-name><surname>Tanaka</surname><given-names>K.</given-names></string-name>, <string-name><surname>Iwata</surname><given-names>T.</given-names></string-name>, <string-name><surname>Sekizawa</surname><given-names>A.</given-names></string-name>, <string-name><surname>Matsumoto</surname><given-names>K.</given-names></string-name><etal>et al</etal>.</person-group><article-title>High Levels of Within-Host Variations of Human Papillomavirus 16 E1/E2 Genes in Invasive Cervical Cancer</article-title>. <source>Front. Microbiol.</source><year>2020</year>; <volume>11</volume>:<fpage>2861</fpage>.</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deshpande</surname><given-names>V.</given-names></string-name>, <string-name><surname>Luebeck</surname><given-names>J.</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>N.D.</given-names></string-name>, <string-name><surname>Bakhtiari</surname><given-names>M.</given-names></string-name>, <string-name><surname>Turner</surname><given-names>K.M.</given-names></string-name>, <string-name><surname>Schwab</surname><given-names>R.</given-names></string-name>, <string-name><surname>Carter</surname><given-names>H.</given-names></string-name>, <string-name><surname>Mischel</surname><given-names>P.S.</given-names></string-name>, <string-name><surname>Bafna</surname><given-names>V.</given-names></string-name></person-group><article-title>Exploring the landscape of focal amplifications in cancer using AmpliconArchitect</article-title>. <source>Nat. Commun.</source><year>2019</year>; <volume>10</volume>:<fpage>392</fpage>.<pub-id pub-id-type="pmid">30674876</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>N.P.</given-names></string-name>, <string-name><surname>Luebeck</surname><given-names>J.</given-names></string-name>, <string-name><surname>Ball</surname><given-names>L.</given-names></string-name>, <string-name><surname>Finegersh</surname><given-names>A.</given-names></string-name>, <string-name><surname>Ren</surname><given-names>S.</given-names></string-name>, <string-name><surname>Nakagawa</surname><given-names>T.</given-names></string-name>, <string-name><surname>Flagg</surname><given-names>M.</given-names></string-name>, <string-name><surname>Sadat</surname><given-names>S.</given-names></string-name>, <string-name><surname>Mischel</surname><given-names>P.S.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Extrachromosomal DNA in HPV mediated oropharyngeal cancer drives diverse oncogene transcription</article-title>. <source>Clin. Cancer Res</source>. <year>2021</year>; <volume>27</volume>:<fpage>6772</fpage>–<lpage>6786</lpage>.<pub-id pub-id-type="pmid">34548317</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nguyen</surname><given-names>N.D.</given-names></string-name>, <string-name><surname>Deshpande</surname><given-names>V.</given-names></string-name>, <string-name><surname>Luebeck</surname><given-names>J.</given-names></string-name>, <string-name><surname>Mischel</surname><given-names>P.S.</given-names></string-name>, <string-name><surname>Bafna</surname><given-names>V.</given-names></string-name></person-group><article-title>ViFi: accurate detection of viral integration and mRNA fusion reveals indiscriminate and unregulated transcription in proximal genomic regions in cervical cancer</article-title>. <source>Nucleic Acids Res.</source><year>2018</year>; <volume>46</volume>:<fpage>3309</fpage>–<lpage>3325</lpage>.<pub-id pub-id-type="pmid">29579309</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nulton</surname><given-names>T.J.</given-names></string-name>, <string-name><surname>Olex</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Dozmorov</surname><given-names>M.</given-names></string-name>, <string-name><surname>Morgan</surname><given-names>I.M.</given-names></string-name>, <string-name><surname>Windle</surname><given-names>B.</given-names></string-name></person-group><article-title>OncotargetAnalysis of The Cancer Genome Atlas sequencing data reveals novel properties of the human papillomavirus 16 genome in head and neck squamous cell carcinoma</article-title>. <source>Oncotarget</source>. <year>2017</year>; <volume>8</volume>:<fpage>17684</fpage>–<lpage>17699</lpage>.<pub-id pub-id-type="pmid">28187443</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cameron</surname><given-names>D.L.</given-names></string-name>, <string-name><surname>Jacobs</surname><given-names>N.</given-names></string-name>, <string-name><surname>Roepman</surname><given-names>P.</given-names></string-name>, <string-name><surname>Priestley</surname><given-names>P.</given-names></string-name>, <string-name><surname>Cuppen</surname><given-names>E.</given-names></string-name>, <string-name><surname>Papenfuss</surname><given-names>A.T.</given-names></string-name></person-group><article-title>VIRUSBreakend: Viral Integration Recognition Using Single Breakends</article-title>. <year>2021</year>; <volume>37</volume>:<fpage>3115</fpage>–<lpage>3119</lpage>.</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname><given-names>J.</given-names></string-name>, <string-name><surname>Song</surname><given-names>K.</given-names></string-name>, <string-name><surname>Deng</surname><given-names>C.</given-names></string-name>, <string-name><surname>Ahlgren</surname><given-names>N.</given-names></string-name>, <string-name><surname>Fuhrman</surname><given-names>J.</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Xie</surname><given-names>X.</given-names></string-name>, <string-name><surname>Poplin</surname><given-names>R.</given-names></string-name>, <string-name><surname>Sun</surname><given-names>F.</given-names></string-name></person-group><article-title>Identifying viruses from metagenomic data using deep learning</article-title>. <source>Quant. Biol.</source><year>2020</year>; <volume>8</volume>:<fpage>64</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">34084563</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gihawi</surname><given-names>A.</given-names></string-name>, <string-name><surname>Rallapalli</surname><given-names>G.</given-names></string-name>, <string-name><surname>Hurst</surname><given-names>R.</given-names></string-name>, <string-name><surname>Cooper</surname><given-names>C.</given-names></string-name>, <string-name><surname>Leggett</surname><given-names>R.</given-names></string-name>, <string-name><surname>Brewer</surname><given-names>D.</given-names></string-name></person-group><article-title>SEPATH: benchmarking the search for pathogens in human tissue whole genome sequence data leads to template pipelines</article-title>. <source>Genome Biol.</source><year>2019</year>; <volume>20</volume>:<fpage>1</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Park</surname><given-names>S.-J.</given-names></string-name>, <string-name><surname>Onizuka</surname><given-names>S.</given-names></string-name>, <string-name><surname>Seki</surname><given-names>M.</given-names></string-name>, <string-name><surname>Suzuki</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Iwata</surname><given-names>T.</given-names></string-name>, <string-name><surname>Nakai</surname><given-names>K.</given-names></string-name></person-group><article-title>A systematic sequencing-based approach for microbial contaminant detection and functional inference</article-title>. <source>BMC Biol.</source><year>2019</year>; <volume>17</volume>:<fpage>1</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">30616566</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wood</surname><given-names>D.E.</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>S.L.</given-names></string-name></person-group><article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol.</source><year>2014</year>; <volume>15</volume>:<fpage>1</fpage>–<lpage>12</lpage>.</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sarmashghi</surname><given-names>S.</given-names></string-name>, <string-name><surname>Bohmann</surname><given-names>K.</given-names></string-name>, <string-name><surname>P Gilbert</surname><given-names>M.T.</given-names></string-name>, <string-name><surname>Bafna</surname><given-names>V.</given-names></string-name>, <string-name><surname>Mirarab</surname><given-names>S.</given-names></string-name></person-group><article-title>Skmer: assembly-free and alignment-free sample identification using genome skims</article-title>. <source>Genome Biol.</source><year>2019</year>; <volume>20</volume>:<fpage>34</fpage>.<pub-id pub-id-type="pmid">30760303</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>W.</given-names></string-name>, <string-name><surname>Li</surname><given-names>L.</given-names></string-name>, <string-name><surname>Myers</surname><given-names>J.R.</given-names></string-name>, <string-name><surname>Marth</surname><given-names>G.T.</given-names></string-name></person-group><article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source>. <year>2012</year>; <volume>28</volume>:<fpage>593</fpage>–<lpage>594</lpage>.<pub-id pub-id-type="pmid">22199392</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lawrence</surname><given-names>M.S.</given-names></string-name>, <string-name><surname>Sougnez</surname><given-names>C.</given-names></string-name>, <string-name><surname>Lichtenstein</surname><given-names>L.</given-names></string-name>, <string-name><surname>Cibulskis</surname><given-names>K.</given-names></string-name>, <string-name><surname>Lander</surname><given-names>E.</given-names></string-name>, <string-name><surname>Gabriel</surname><given-names>S.B.</given-names></string-name>, <string-name><surname>Getz</surname><given-names>G.</given-names></string-name>, <string-name><surname>Ally</surname><given-names>A.</given-names></string-name>, <string-name><surname>Balasundaram</surname><given-names>M.</given-names></string-name>, <string-name><surname>Birol</surname><given-names>I.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Comprehensive genomic characterization of head and neck squamous cell carcinomas</article-title>. <year>2015</year>; <fpage>576</fpage>.</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ally</surname><given-names>A.</given-names></string-name>, <string-name><surname>Balasundaram</surname><given-names>M.</given-names></string-name>, <string-name><surname>Carlsen</surname><given-names>R.</given-names></string-name>, <string-name><surname>Chuah</surname><given-names>E.</given-names></string-name>, <string-name><surname>Clarke</surname><given-names>A.</given-names></string-name>, <string-name><surname>Dhalla</surname><given-names>N.</given-names></string-name>, <string-name><surname>Holt</surname><given-names>R.A.</given-names></string-name>, <string-name><surname>Jones</surname><given-names>S.J.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>D.</given-names></string-name>, <string-name><surname>Ma</surname><given-names>Y.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Comprehensive and integrative genomic characterization of hepatocellular carcinoma</article-title>. <source>Cell</source>. <year>2017</year>; <volume>169</volume>:<fpage>1327</fpage>–<lpage>1341</lpage>.<pub-id pub-id-type="pmid">28622513</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bass</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Thorsson</surname><given-names>V.</given-names></string-name>, <string-name><surname>Shmulevich</surname><given-names>I.</given-names></string-name>, <string-name><surname>Reynolds</surname><given-names>S.M.</given-names></string-name>, <string-name><surname>Miller</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bernard</surname><given-names>B.</given-names></string-name>, <string-name><surname>Hinoue</surname><given-names>T.</given-names></string-name>, <string-name><surname>Laird</surname><given-names>P.W.</given-names></string-name>, <string-name><surname>Curtis</surname><given-names>C.</given-names></string-name>, <string-name><surname>Shen</surname><given-names>H.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Comprehensive molecular characterization of gastric adenocarcinoma</article-title>. <source>Nature</source>. <year>2014</year>; <volume>513</volume>:<fpage>202</fpage>–<lpage>209</lpage>.<pub-id pub-id-type="pmid">25079317</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Geng</surname><given-names>C.</given-names></string-name>, <string-name><surname>Huang</surname><given-names>S.-J.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S.</given-names></string-name></person-group><article-title>Recent Advances in Open Set Recognition: A Survey</article-title>. <source>IEEE T. Pattern. Anal.</source><year>2020</year>; <volume>PP</volume>:<fpage>1</fpage>–<lpage>1</lpage>.</mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cameron</surname><given-names>D.L.</given-names></string-name>, <string-name><surname>Baber</surname><given-names>J.</given-names></string-name>, <string-name><surname>Shale</surname><given-names>C.</given-names></string-name>, <string-name><surname>Valle-Inclan</surname><given-names>J.E.</given-names></string-name>, <string-name><surname>Besselink</surname><given-names>N.</given-names></string-name>, <string-name><surname>van Hoeck</surname><given-names>A.</given-names></string-name>, <string-name><surname>Janssen</surname><given-names>R.</given-names></string-name>, <string-name><surname>Cuppen</surname><given-names>E.</given-names></string-name>, <string-name><surname>Priestley</surname><given-names>P.</given-names></string-name>, <string-name><surname>Papenfuss</surname><given-names>A.T.</given-names></string-name></person-group><article-title>GRIDSS2: comprehensive characterisation of somatic structural variation using single breakend variants and structural variant phasing</article-title>. <source>Genome Biol.</source><year>2021</year>; <volume>22</volume>:<fpage>202</fpage>.<pub-id pub-id-type="pmid">34253237</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abe</surname><given-names>H.</given-names></string-name>, <string-name><surname>Kaneda</surname><given-names>A.</given-names></string-name>, <string-name><surname>Fukayama</surname><given-names>M.</given-names></string-name></person-group><article-title>Epstein-Barr Virus-Associated Gastric Carcinoma: Use of Host Cell Machineries and Somatic Gene Mutations</article-title>. <source>Pathobiology</source>. <year>2015</year>; <volume>82</volume>:<fpage>212</fpage>–<lpage>223</lpage>.<pub-id pub-id-type="pmid">26337667</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wong</surname><given-names>S.S.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>K.M.</given-names></string-name>, <string-name><surname>Ting</surname><given-names>J.C.</given-names></string-name>, <string-name><surname>Yu</surname><given-names>K.</given-names></string-name>, <string-name><surname>Fu</surname><given-names>J.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>S.</given-names></string-name>, <string-name><surname>Cristescu</surname><given-names>R.</given-names></string-name>, <string-name><surname>Nebozhyn</surname><given-names>M.</given-names></string-name>, <string-name><surname>Gong</surname><given-names>L.</given-names></string-name>, <string-name><surname>Yue</surname><given-names>Y.G.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Genomic landscape and genetic heterogeneity in gastric adenocarcinoma revealed by whole-genome sequencing</article-title>. <source>Nat. Commun.</source><year>2014</year>; <volume>5</volume>:<fpage>5477</fpage>.<pub-id pub-id-type="pmid">25407104</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>M.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>W.L.</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>S.</given-names></string-name>, <string-name><surname>Yao</surname><given-names>Y.Y.</given-names></string-name>, <string-name><surname>Xiang</surname><given-names>T.</given-names></string-name>, <string-name><surname>Feng</surname><given-names>Q.S.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Peng</surname><given-names>R.J.</given-names></string-name>, <string-name><surname>Jia</surname><given-names>W.H.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Genome-wide profiling of Epstein-Barr virus integration by targeted sequencing in Epstein-Barr virus associated malignancies</article-title>. <source>Theranostics</source>. <year>2019</year>; <volume>9</volume>:<fpage>1115</fpage>–<lpage>1124</lpage>.<pub-id pub-id-type="pmid">30867819</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kew</surname><given-names>M.C.</given-names></string-name></person-group><article-title>Hepatitis B virus x protein in the pathogenesis of hepatitis B virus-induced hepatocellular carcinoma</article-title>. <source>J. Gastroenterol. Hepatol.</source><year>2011</year>; <volume>26</volume>(<issue>Suppl. 1</issue>):<fpage>144</fpage>–<lpage>152</lpage>.<pub-id pub-id-type="pmid">21199526</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>B.</given-names></string-name>, <string-name><surname>Huang</surname><given-names>W.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>R.</given-names></string-name>, <string-name><surname>Zang</surname><given-names>W.</given-names></string-name>, <string-name><surname>Su</surname><given-names>M.</given-names></string-name>, <string-name><surname>Li</surname><given-names>H.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H.</given-names></string-name>, <string-name><surname>Cao</surname><given-names>B.</given-names></string-name>, <string-name><surname>Deng</surname><given-names>D.</given-names></string-name>, <string-name><surname>Li</surname><given-names>Q.Q.</given-names></string-name><etal>et al</etal>.</person-group><article-title>High Rate of Detection of Human ESPL1-HBV S Fusion Gene in Patients With HBV-related Liver Cancer: A Chinese Case-Control Study</article-title>. <source>Anticancer Res.</source><year>2020</year>; <volume>40</volume>:<fpage>245</fpage>–<lpage>252</lpage>.<pub-id pub-id-type="pmid">31892573</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lau</surname><given-names>C.C.</given-names></string-name>, <string-name><surname>Sun</surname><given-names>T.</given-names></string-name>, <string-name><surname>Ching</surname><given-names>A.K.</given-names></string-name>, <string-name><surname>He</surname><given-names>M.</given-names></string-name>, <string-name><surname>Li</surname><given-names>J.W.</given-names></string-name>, <string-name><surname>Wong</surname><given-names>A.M.</given-names></string-name>, <string-name><surname>Co</surname><given-names>N.N.</given-names></string-name>, <string-name><surname>Chan</surname><given-names>A.W.</given-names></string-name>, <string-name><surname>Li</surname><given-names>P.S.</given-names></string-name>, <string-name><surname>Lung</surname><given-names>R.W.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Viral-human chimeric transcript predisposes risk to liver cancer development and progression</article-title>. <source>Cancer Cell</source>. <year>2014</year>; <volume>25</volume>:<fpage>335</fpage>–<lpage>349</lpage>.<pub-id pub-id-type="pmid">24582836</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>D. A.W.</given-names></string-name>, <string-name><surname>Sherman</surname><given-names>B.T.</given-names></string-name>, <string-name><surname>Lempicki</surname><given-names>R.A.</given-names></string-name></person-group><article-title>Systematic and integrative analysis of large gene lists using DAVID bioinformatics resources</article-title>. <source>Nat. Protoc.</source><year>2009</year>; <volume>4</volume>:<fpage>44</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">19131956</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pavlovic</surname><given-names>N.</given-names></string-name>, <string-name><surname>Rani</surname><given-names>B.</given-names></string-name>, <string-name><surname>Gerwins</surname><given-names>P.</given-names></string-name>, <string-name><surname>Heindryckx</surname><given-names>F.</given-names></string-name></person-group><article-title>Platelets as Key Factors in Hepatocellular Carcinoma</article-title>. <source>Cancers (Basel)</source>. <year>2019</year>; <volume>11</volume>:<fpage>1022</fpage>.</mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gulley</surname><given-names>M.L.</given-names></string-name></person-group><article-title>Genomic assays for Epstein-Barr virus-positive gastric adenocarcinoma</article-title>. <source>Exp. Mol. Med.</source><year>2015</year>; <volume>47</volume>:<fpage>e134</fpage>.<pub-id pub-id-type="pmid">25613731</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>S.</given-names></string-name>, <string-name><surname>Hu</surname><given-names>J.</given-names></string-name>, <string-name><surname>Luo</surname><given-names>X.</given-names></string-name>, <string-name><surname>Li</surname><given-names>N.</given-names></string-name>, <string-name><surname>M Bode</surname><given-names>A.</given-names></string-name>, <string-name><surname>Cao</surname><given-names>Y.</given-names></string-name></person-group><article-title>Epstein-Barr virus lytic reactivation regulation and its pathogenic role in carcinogenesis</article-title>. <source>Int. J. Biol. Sci.</source><year>2016</year>; <volume>12</volume>:<fpage>1309</fpage>–<lpage>1318</lpage>.<pub-id pub-id-type="pmid">27877083</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Teow</surname><given-names>S.Y.</given-names></string-name>, <string-name><surname>Liew</surname><given-names>K.</given-names></string-name>, <string-name><surname>Khoo</surname><given-names>A.S.</given-names></string-name>, <string-name><surname>Peh</surname><given-names>S.C.</given-names></string-name></person-group><article-title>Pathogenic Role of Exosomes in Epstein-Barr Virus (EBV)-Associated Cancers</article-title>. <source>Int. J. Biol. Sci.</source><year>2017</year>; <volume>13</volume>:<fpage>1276</fpage>–<lpage>1286</lpage>.<pub-id pub-id-type="pmid">29104494</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Álvarez</surname><given-names>E.G.</given-names></string-name>, <string-name><surname>Demeulemeester</surname><given-names>J.</given-names></string-name>, <string-name><surname>Zamora</surname><given-names>J.</given-names></string-name>, <string-name><surname>Jolly</surname><given-names>C.</given-names></string-name>, <string-name><surname>Tojo</surname><given-names>M.</given-names></string-name></person-group><article-title>Aberrant integration of Hepatitis B virus DNA promotes major restructuring of human hepatocarcinoma genome architecture</article-title>. <year>2021</year>; <volume>12</volume>:<fpage>1</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marquitz</surname><given-names>A.R.</given-names></string-name>, <string-name><surname>Mathur</surname><given-names>A.</given-names></string-name>, <string-name><surname>Shair</surname><given-names>K.H.</given-names></string-name>, <string-name><surname>Raab-Traub</surname><given-names>N.</given-names></string-name></person-group><article-title>Infection of Epstein-Barr virus in a gastric carcinoma cell line induces anchorage independence and global changes in gene expression</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>. <year>2012</year>; <volume>109</volume>:<fpage>9593</fpage>–<lpage>9598</lpage>.<pub-id pub-id-type="pmid">22647604</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
