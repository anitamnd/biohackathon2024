<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4718670</article-id>
    <article-id pub-id-type="pmid">26784691</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0146112</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-15-32483</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>iMet-Q: A User-Friendly Tool for Label-Free Metabolomics Quantitation Using Dynamic Peak-Width Determination</article-title>
      <alt-title alt-title-type="running-head">iMet-Q: A User-Friendly Tool for Label-Free Metabolomics Quantitation</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chang</surname>
          <given-names>Hui-Yin</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Ching-Tai</given-names>
        </name>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lih</surname>
          <given-names>T. Mamie</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lynn</surname>
          <given-names>Ke-Shiuan</given-names>
        </name>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Juo</surname>
          <given-names>Chiun-Gung</given-names>
        </name>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hsu</surname>
          <given-names>Wen-Lian</given-names>
        </name>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sung</surname>
          <given-names>Ting-Yi</given-names>
        </name>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Bioinformatics Program, Taiwan International Graduate Program, Academia Sinica, Taipei 11529, Taiwan</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Institute of Biomedical Informatics, National Yang-Ming University, Taipei 11221, Taiwan</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Institute of Information Science, Academia Sinica, Taipei 11529, Taiwan</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Mathematics, Fu Jen Catholic University, New Taipei City 24205, Taiwan</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Molecular Medicine Research Center, Chang Gung University, Taoyuan 33302, Taiwan</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Bundy</surname>
          <given-names>Jacob Guy</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Imperial College London, UNITED KINGDOM</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con" id="contrib001">
        <p>Conceived and designed the experiments: H-YC T-YS. Performed the experiments: C-GJ. Analyzed the data: H-YC C-TC K-SL TML. Contributed reagents/materials/analysis tools: H-YC C-TC C-GJ. Wrote the paper: H-YC T-YS. Helped revise the manuscript: TML W-LH.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>tsung@iis.sinica.edu.tw</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>11</volume>
    <issue>1</issue>
    <elocation-id>e0146112</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>7</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>12</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2016 Chang et al</copyright-statement>
      <copyright-year>2016</copyright-year>
      <copyright-holder>Chang et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="pone.0146112.pdf"/>
    <abstract>
      <p>Efficient and accurate quantitation of metabolites from LC-MS data has become an important topic. Here we present an automated tool, called iMet-Q (<underline>i</underline>ntelligent <underline>Met</underline>abolomic <underline>Q</underline>uantitation), for label-free metabolomics quantitation from high-throughput MS1 data. By performing peak detection and peak alignment, iMet-Q provides a summary of quantitation results and reports ion abundance at both replicate level and sample level. Furthermore, it gives the charge states and isotope ratios of detected metabolite peaks to facilitate metabolite identification. An in-house standard mixture and a public Arabidopsis metabolome data set were analyzed by iMet-Q. Three public quantitation tools, including XCMS, MetAlign, and MZmine 2, were used for performance comparison. From the mixture data set, seven standard metabolites were detected by the four quantitation tools, for which iMet-Q had a smaller quantitation error of 12% in both profile and centroid data sets. Our tool also correctly determined the charge states of seven standard metabolites. By searching the mass values for those standard metabolites against Human Metabolome Database, we obtained a total of 183 metabolite candidates. With the isotope ratios calculated by iMet-Q, 49% (89 out of 183) metabolite candidates were filtered out. From the public Arabidopsis data set reported with two internal standards and 167 elucidated metabolites, iMet-Q detected all of the peaks corresponding to the internal standards and 167 metabolites. Meanwhile, our tool had small abundance variation (≤0.19) when quantifying the two internal standards and had higher abundance correlation (≥0.92) when quantifying the 167 metabolites. iMet-Q provides user-friendly interfaces and is publicly available for download at <ext-link ext-link-type="uri" xlink:href="http://ms.iis.sinica.edu.tw/comics/Software_iMet-Q.html">http://ms.iis.sinica.edu.tw/comics/Software_iMet-Q.html</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by Academia Sinica, Ministry of Science and Technology of Taiwan (MOST103-2221-E-001-037), and Taiwan International Graduate Program.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="2"/>
      <page-count count="18"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Two datasets, including a standard metabolite mixture and a public Arabidopsis dataset, were used in our study. The public Arabidopsis dataset is a third-party open data (not owned by the authors), and thus we provided a website link to the public data (PRIMe, <ext-link ext-link-type="uri" xlink:href="http://prime.psc.riken.jp/">http://prime.psc.riken.jp/</ext-link>). The standard metabolite mixture owned by the authors is now available under the DOI: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.6084/m9.figshare.2058702.v1">https://dx.doi.org/10.6084/m9.figshare.2058702.v1</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Two datasets, including a standard metabolite mixture and a public Arabidopsis dataset, were used in our study. The public Arabidopsis dataset is a third-party open data (not owned by the authors), and thus we provided a website link to the public data (PRIMe, <ext-link ext-link-type="uri" xlink:href="http://prime.psc.riken.jp/">http://prime.psc.riken.jp/</ext-link>). The standard metabolite mixture owned by the authors is now available under the DOI: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.6084/m9.figshare.2058702.v1">https://dx.doi.org/10.6084/m9.figshare.2058702.v1</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Unbiased quantitation and identification of small-molecule metabolites in a biological system is important because metabolites serve as direct signatures of biochemical activity, making them relatively easier to correlate with disease phenotype and more suitable for clinical diagnostics [<xref rid="pone.0146112.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0146112.ref008" ref-type="bibr">8</xref>]. Liquid chromatography coupled with mass spectrometry (LC-MS) has become a conventional platform for analyzing metabolites across a large number of biological samples because of its ability to measure thousands of metabolites in a short period of time [<xref rid="pone.0146112.ref002" ref-type="bibr">2</xref>, <xref rid="pone.0146112.ref005" ref-type="bibr">5</xref>, <xref rid="pone.0146112.ref009" ref-type="bibr">9</xref>–<xref rid="pone.0146112.ref013" ref-type="bibr">13</xref>]. However, it is a time-consuming process to manually calculate the abundances of thousands of metabolites from large-scale LC-MS data, and thus developing a software package to automatically quantify LC-MS metabolomics data becomes essential.</p>
    <p>Many commercial software programs have been developed by instrument vendors, such as Progenesis QI (Waters), MassHunter (Agilent), MultiQuant (Sciex), and Xcalibur (Thermo). But they usually accept data formats specific to their own instruments, and thus limit the possibility of integrating metabolite analyses across different analytical platforms [<xref rid="pone.0146112.ref014" ref-type="bibr">14</xref>–<xref rid="pone.0146112.ref017" ref-type="bibr">17</xref>]. Additionally, data processing algorithms implemented in these programs are mostly unavailable. Publicly available quantitation tools, on the other hand, accept multiple input data formats and provide description of their computational algorithms. For example, XCMS [<xref rid="pone.0146112.ref018" ref-type="bibr">18</xref>], MetAlign [<xref rid="pone.0146112.ref019" ref-type="bibr">19</xref>] and MZmine 2 [<xref rid="pone.0146112.ref020" ref-type="bibr">20</xref>] accept input formats such as mzXML, mzData, and netCDF. XCMS, implemented in R, C, and C++ programming language, provides format conversion, noise filtering, peak detection, non-linear spectral alignment algorithms, and statistical analysis of LC-MS data. MetAlign, an open interface-driven tool implemented in C++ programming language, provides format conversion, mass calculation, baseline correction, peak-picking, saturation and mass peak artifact filtering, as well as data set alignment. MZmine 2, a modular-based tool implemented in Java programming language, provides raw data import, raw data processing, peak detection, peak list alignment, normalization, visualization, peak identification, and statistical analysis.</p>
    <p>However, some concerns of these public tools have been reported. For instance, some tools combine binning with model fitting or use slope calculation approaches to perform peak detection, but these approaches may have low sensitivity on peak picking because the peak shapes vary greatly from one to another [<xref rid="pone.0146112.ref021" ref-type="bibr">21</xref>, <xref rid="pone.0146112.ref022" ref-type="bibr">22</xref>]. Due to different peak detection and peak alignment algorithms provided in each tool, it is difficult for users to optimize the algorithm-related parameters, which very likely affect the quantitation results [<xref rid="pone.0146112.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0146112.ref024" ref-type="bibr">24</xref>]. On the other hand, most of the tools do not provide deisotoping, and thus users have to apply additional packages, such as CAMERA [<xref rid="pone.0146112.ref025" ref-type="bibr">25</xref>], to perform isotope pattern assembly [<xref rid="pone.0146112.ref021" ref-type="bibr">21</xref>].</p>
    <p>To rectify the above concerns, we develop a quantitation tool, called iMet-Q (<underline>i</underline>ntelligent <underline>Met</underline>abolomic <underline>Q</underline>uantitation), written in C# programming language, which provides highly accurate quantitation and user-friendly graphical interfaces. For peak detection, iMet-Q requires one input parameter, i.e., mzWidth (defined as the width of a peak in m/z dimension), and calculates the full width at half maximum (FWHM) of a peak to dynamically determine its chromatographic width so that the peak boundary can be automatically determined (i.e., without requiring parameter input). In addition, our tool determines the charge state of a peak by calculating the similarity between the peak shape of monoisotope and the peak shape of the second isotope peak. Once the charge state is determined, iMet-Q calculates its isotope ratio (i.e., the ratio of the second isotope abundance to the monoisotope abundance) to facilitate metabolite identification. Since metabolites usually have smaller retention time drifts across LC-MS technical replicates, iMet-Q first aligns peaks across different LC-MS replicates of a sample and then across different samples. In each alignment, LOESS regression algorithm [<xref rid="pone.0146112.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0146112.ref027" ref-type="bibr">27</xref>] is applied to adjust peak retention time so that peaks in different LC-MS replicates/samples can be aligned according to their <italic>m/z</italic> and adjusted retention time values.</p>
    <p>We used two metabolite data sets, an in-house standard mixture and a public Arabidopsis metabolome data set [<xref rid="pone.0146112.ref028" ref-type="bibr">28</xref>], to evaluate the performance of iMet-Q and compare it with three public quantitation tools, including XCMS, MetAlign, and MZmine2. Since the standard mixture was acquired in profile mode, we evaluated the performance of the four tools in both profile and centroid data sets, in which the centroid data set was converted from the profile data set by the centroiding function of ProteoWizard [<xref rid="pone.0146112.ref029" ref-type="bibr">29</xref>]. As a result, iMet-Q had small quantitation error of 12% in both profile and centroid data sets. In addition, our tool correctly determined the charge state of seven standard metabolites, removed their isotope peaks, and calculated their isotope ratios. With the isotope ratios, we successfully filtered out 49% (89 out of 183) metabolite candidates when using mass values of these standard metabolites to search in Human Metabolome Database (HMDB) [<xref rid="pone.0146112.ref030" ref-type="bibr">30</xref>]. For the public Arabidopsis metabolome data set reported with two internal standards and 167 elucidated metabolites, iMet-Q detected the internal standards from all replicates and samples. In addition, all of the 167 metabolites were also detected by iMet-Q, whereas 103 (62%), 145 (87%), and 129 (77%) elucidated metabolites were detected by XCMS, MetAlign, and MZmine 2, respectively. Comparing with the three quantitation tools, iMet-Q had relatively small abundance variations (≤0.19) when quantifying the internal standards, and had higher abundance correlation (≥0.92) when quantifying the 167 metabolites across replicates. All data underlying the manuscript are fully available without restriction. The source code of iMet-Q is freely available on SourceForge (<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/imet-q/?source=navbar">http://sourceforge.net/projects/imet-q/?source=navbar</ext-link>) under the license of GPL2.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and Methods</title>
    <sec id="sec003">
      <title>Experiment on standard metabolite mixture</title>
      <sec id="sec004">
        <title>Chemicals</title>
        <p>All chemicals and solvents were purchased from Sigma Aldrich (St. Louis, MO, USA). The chemicals were all of analytical grade. Water containing 0.1% formic acid (solvent A), and acetonitrile containing 0.1% formic acid (solvent B) were of CHROMASOLV grade.</p>
      </sec>
      <sec id="sec005">
        <title>Sample preparation</title>
        <p>Stoke solution of metabolites was prepared as 1 mg/mL of 80% MeOH solution with 0.1% formic acid. Two metabolite mixtures, Sample 1 and Sample 2, were prepared by adding seven standard metabolites with different amount into two 1.7 mL vials. These standard metabolites were L-histidine (3 μL in Sample 1, 6μL in Sample 2), L-carnosine (50μL in Sample 1, 50μL in Sample 2), creatine (6μL in Sample 1, 6μL in Sample 2), caffeine (6μL in Sample 1, 6μL in Sample 2), hippuric acid (5μL in Sample 1, 25μL in Sample 2), glycocholic acid (2μL in Sample 1, 10μL in Sample 2), and cholic acid (2μL in Sample 1, 6μL in Sample 2). The solutions were dried with SpeedVac and re-dissolved by 100 L of MeOH and water (2:1, v/v) with 0.1% formic acid.</p>
      </sec>
      <sec id="sec006">
        <title>UPLC/LTQ-Orbitrap MS</title>
        <p>A UPLC system (Acquity, Waters, Milford, MA, USA) equipped with a C18 reversed-phase column (2.1 × 100 mm, 1.8 m, HSS-T3; Waters, Milford, MA, USA) was coupled with a LTQ-Orbitrap mass spectrometer (Thermo Scientific, San Jose, CA, USA) with an orthogonal electrospray ionization (ESI) source. The initial flow rate was 0.1 mL/min of 99% solvent A (0.1% formic acid) and 1% solvent B (acetonitrile with 0.1% formic acid). A volume of 1μL of Sample 1 and Sample 2 were sequentially injected, and 6 technical replicates were conducted in profile mode on each standard mixture. After injection, solvent B was maintained at 1% for 5 min, then increased to 50% during a time span of 9 min, then to 90% over 6 min, and finally to 99% over a period of 12 min after which this percent composition was held for 1 min. The flow rate was changed to 0.5 mL/min, and after 5 min reduced to 0.1mL/min. After 0.1 min, solvent B was reduced back to 1% and held at this percentage for 7 min.</p>
        <p>The mass spectrometer was controlled by using Xcalibur 2.0.7 software (Thermo Scientific) and operated in positive ion mode on the <italic>m/z</italic> range from 120 to 1,000 with 60,000 resolution at <italic>m/z</italic> 400. The source and capillary voltages were set to 4500 and 35 V, and the temperatures of the capillary and the APCI vaporizer were set to 275°C and 150°C. Internal calibration was performed using the ion signal of dioctyl phthalate at <italic>m/z</italic> 391.28 as a lock mass.</p>
      </sec>
    </sec>
    <sec id="sec007">
      <title>Public Arabidopsis metabolome data set</title>
      <p>A public Arabidopsis metabolome data set of 36 samples acquired by LC-ESI-Q-TOF/MS (HPLC: Waters Acquity UPLC system; MS: Waters Q-TOF Premier) in positive- and negative-ion modes, with four technical replicates on each sample, was downloaded from the website of PRIMe (<ext-link ext-link-type="uri" xlink:href="http://prime.psc.riken.jp/">http://prime.psc.riken.jp/</ext-link>). All replicates of the Arabidopsis metabolome data set were acquired in centroid mode. Two internal standards, lidocaine (<italic>m/z</italic> = 235 [M+H]+, eluted at 4.19 min in the positive-ion mode data) and camphor-10-sulfonic acid (<italic>m/z</italic> = 231 [M-H]-, eluted at 3.84min in the negative-ion mode data) were spiked in each sample with the same amount of 0.5 mg/L for abundance normalization and 167 metabolites were elucidated from this data set [<xref rid="pone.0146112.ref031" ref-type="bibr">31</xref>, <xref rid="pone.0146112.ref032" ref-type="bibr">32</xref>].</p>
    </sec>
    <sec id="sec008">
      <title>Data processing and software parameter settings</title>
      <p>Data processing was performed on a Microsoft Windows 7 computer (x64 edition service pack 1 with an Intel Xeon E5-2630 processor, 16 GB RAM and 500GB hard disk drive). All raw data files of the standard mixture experiment and the public data set were converted into mzXML format using ProteoWizard. The acquired profile-mode data of standard mixture experiment was converted into two data sets, where one data set was directly converted to mzXML files (called <italic>profile data set</italic> for convenience) and the other was converted to mzXML files with an additional centroiding procedure in ProteoWizard (called <italic>centroid data set</italic> for convenience). Since the public data was acquired in centroid mode, no additional centroiding procedure in ProteoWizard was performed.</p>
      <p>Both profile and centroid data sets of standard mixture were processed by four tools. iMet-Q automatically skipped centroiding step when processing the centroid data set and used the following parameter setting: mzWidth = 0.02, mzTol = 0.02, and rtTol = 0.2 for both data sets. For XCMS, peaks in the profile and centroid data sets were first detected using <italic>matchedFilter</italic> and c<italic>entWave</italic> function, respectively. Then the <italic>rector</italic>.<italic>loess</italic> and <italic>group</italic>.<italic>density</italic> functions were then applied to align the detected peaks across samples. An additional <italic>fillPeaks</italic> fuction was performed for the recovery of missing peaks as suggested by the package vignette of XCMS. To optimize the XCMS parameters, 42 parameter combinations were examined using the standard metabolites in the standard mixture as benchmarks. The examination results of the 42 parameter combinations are listed in <xref rid="pone.0146112.s006" ref-type="supplementary-material">S1</xref> and <xref rid="pone.0146112.s007" ref-type="supplementary-material">S2</xref> Tables, and the quantitation results generated using those parameter combinations are provided in <xref rid="pone.0146112.s001" ref-type="supplementary-material">S1</xref> and <xref rid="pone.0146112.s002" ref-type="supplementary-material">S2</xref> Files. The optimized XCMS parameters on peak picking are: method = matchedFilter, fwhm = 30, snthresh = 10 for profile dataset; and method = centWave, ppm = 45, snthresh = 10, peakwidth = (5,20) for centroid dataset. The optimized XCMS parameters for both profile and centroid data sets on retention time correction and peak grouping are: method = loess, span = .67; and method = "density", mzwid = 0.03, bw = 3, minfrac = 0, minsamp = 0. MetAlign only accepts and processes the centroid data set. To run MetAlign, we selected the data type of accurate mass data with mass resolution of 10,000 and applied the default settings for the remaining parameters. In MZmine 2, the <italic>exact mass detector</italic> function and the <italic>centroid mass detector</italic> function were first applied to process the profile and centroid data sets, respectively, both with a noise level of 1,000,000. Then the following functions were applied using the same parameters to process both data sets. The chromatogram builder was used with the minimum time span, minimum height, and <italic>m/z</italic> tolerance set to be 0, 0 and 0.02, respectively. For chromatogram deconvolution, baseline cut-off algorithm was used to detect peaks, where the minimum peak height, peak duration length, and baseline level were 1,000,000, 0–2 min, and 1,000,000, respectively. The <italic>m/z</italic> and retention time tolerances in both isotopic peaks grouper and peak alignment were 0.02 and 0.2 min, respectively.</p>
      <p>Public Arabidopsis data set was processed by iMet-Q with mzWidth, mzTol, and rtTol of 0.03, 0.03, and 0.16 min, respectively. We used the XCMS c<italic>entWave</italic> function for peak detection, <italic>rector</italic>.<italic>loess</italic> and <italic>group</italic>.<italic>density</italic> functions for peak alignment, and <italic>fillPeaks</italic> function for the recovery of missing peaks. To optimize XCMS parameters on the public Arabidopsis positive- and negative-mode data sets, 37 parameter combinations were examined on each set and the parameter combination achieving the best quantitation performance was selected. The examination results of the parameter combinations are listed in <xref rid="pone.0146112.s008" ref-type="supplementary-material">S3</xref> and <xref rid="pone.0146112.s009" ref-type="supplementary-material">S4</xref> Tables, and the quantitation results generated using those parameter combinations are provided in <xref rid="pone.0146112.s003" ref-type="supplementary-material">S3</xref> and <xref rid="pone.0146112.s004" ref-type="supplementary-material">S4</xref> Files. Both data sets used centWave method in peak picking and the optimized XCMS parameters for Arabidopsis positive- and negative-mode datasets are: ppm = 30, snthresh = 10, peakwidth = (25, 40); and ppm = 20, snthresh = 10, peakwidth = (5, 20), respectively. Next, in retention time correction and peak grouping, the optimized XCMS parameters for both profile and centroid data sets are: method = loess, span = .67; and method = "density", mzwid = 0.03, bw = 3, minfrac = 0, minsamp = 0. For MetAlign, we selected the data type of accurate mass data with mass resolution of 9,000 and applied the following parameter settings for data processing: maximum amplitude = 10,000, peak slope factor = 1, peak threshold factor = 6, average peak width at half weight = 8, maximum shift per scan = 35, select min nr per peak set = 4, and scaling options = none. In MZmine 2, we used the centroid mass detector with a noise level of 6. The minimum time span, minimum height, and <italic>m/z</italic> tolerance in the chromatogram builder were set to be 0.1 min, 6 and 0.03, respectively. For chromatogram deconvolution, baseline cut-off algorithm was used to detect peaks, where the minimum peak height, peak duration length, and baseline level were 6, 0–1.6 (min), and 6, respectively. The <italic>m/z</italic> and retention time tolerances in both isotopic peaks grouper and peak alignment were 0.03 and 0.16 min, respectively. Detected peaks by each tool were retained in the quantitation results if their retention time values were within the effective retention time range (i.e., 0.85 to 12 min) and the peaks were detected in at least one sample.</p>
    </sec>
    <sec id="sec009">
      <title>Robust algorithms for metabolite quantitation</title>
      <p>In order to process data from various mass spectrometers, iMet-Q accepts input files in netCDF, mzXML, and mzML formats, which can be conveniently converted from raw data by existing converters. Also, it accepts profile-mode and centroid-mode data. The workflow of iMet-Q contains two main tasks, peak detection and peak alignment, as depicted in <xref rid="pone.0146112.g001" ref-type="fig">Fig 1</xref>. Performing peak detection on each input file generates a peak list that reports the <italic>m/z</italic>, retention time, charge state, isotope ratio, and abundance of detected peaks. To compare compounds across different samples, iMet-Q aligns the detected peaks in the peak lists according to their <italic>m/z</italic> and retention time. The detailed procedures of peak detection, peak alignment and quantitation result generation are described below.</p>
      <fig id="pone.0146112.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Schematic depiction of iMet-Q workflow for peak detection and peak alignment.</title>
        </caption>
        <graphic xlink:href="pone.0146112.g001"/>
      </fig>
    </sec>
    <sec id="sec010">
      <title>Peak Detection</title>
      <sec id="sec011">
        <title>Centroiding signals in each scan</title>
        <p>Centroiding, which can be performed during or after data acquisition, is a common first step for processing metabolomics data so that the data size can be greatly reduced. It aims at combining multiple signals from the same compound into a single one with an <italic>m/z</italic> and intensity value [<xref rid="pone.0146112.ref032" ref-type="bibr">32</xref>]. If the input files have already been centroided, iMet-Q automatically skips this step. The detailed algorithm description is listed in <xref rid="pone.0146112.s005" ref-type="supplementary-material">S1 Section</xref>.</p>
      </sec>
      <sec id="sec012">
        <title>Removing noises from each scan</title>
        <p>Due to nonspecific nature of ESI, a great portion of signals in the spectra could be noise [<xref rid="pone.0146112.ref033" ref-type="bibr">33</xref>]. It is essential to remove these noises to increase the effectiveness of peak detection. Instead of determining a fixed baseline for each spectrum, iMet-Q equally divides a scan into <italic>s</italic> segments (<italic>s</italic> = 10 by default) with an overlap of 20% to avoid borderline issues and defines the average intensity in a segment as its noise level. Then, for each segment, signals with S/N less than a specific threshold (3 by default) are removed from the scan, where S is the signal intensity and N is the noise level in the segment. The number of segments and the S/N threshold are user-adjustable.</p>
      </sec>
      <sec id="sec013">
        <title>Constructing extracted ion chromatograms (EIC) with dynamically determining peak width</title>
        <p>After processing signals in each scan, iMet-Q uses a two-stage algorithm to construct the extracted ion chromatogram (EIC) of a compound. The two-stage algorithm includes signal clustering and EIC boundary determination. Let <inline-formula id="pone.0146112.e001"><alternatives><graphic xlink:href="pone.0146112.e001.jpg" id="pone.0146112.e001g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>}</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> be the list of signals in all scans, where <italic>m</italic> is the total number of scans and <italic>n</italic><sub><italic>k</italic></sub> is the number of signals in the <italic>k</italic><sup>th</sup> scan. In signal clustering, starting from the most intensive signal, say <inline-formula id="pone.0146112.e002"><alternatives><graphic xlink:href="pone.0146112.e002.jpg" id="pone.0146112.e002g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, among all scans in <italic>S</italic>, iMet-Q clusters signals in <italic>S</italic> with <inline-formula id="pone.0146112.e003"><alternatives><graphic xlink:href="pone.0146112.e003.jpg" id="pone.0146112.e003g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> if the <italic>m/z</italic> differences between the signals and <inline-formula id="pone.0146112.e004"><alternatives><graphic xlink:href="pone.0146112.e004.jpg" id="pone.0146112.e004g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are within the given tolerance <italic>d</italic>, i.e., mzWidth in iMet-Q. A cluster with at least three signals is further processed. In the step of EIC boundary determination, iMet-Q automatically calculates FWHM and then dynamically determines the boundaries using FWHM. To be specific, for the most intensive signal in a cluster, say <inline-formula id="pone.0146112.e005"><alternatives><graphic xlink:href="pone.0146112.e005.jpg" id="pone.0146112.e005g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, with retention time <italic>t</italic>, the boundaries of the EIC are initially determined as <italic>t</italic> ± <italic>w</italic>, where <italic>w</italic> is the FWHM. To adapt to possible tailing effect of an EIC, the boundaries are further extended by a tolerance at most 0.5<italic>w</italic> and are set to the farthest signal or a signal with local-minimum intensity in this range (as shown in <xref rid="pone.0146112.g002" ref-type="fig">Fig 2</xref>). Then the trapezoid areas between any two adjacent signals of the EIC are summed up as the abundance. The two-stage algorithm is iteratively performed on the remaining unclustered signals to construct EICs until all signals in <italic>S</italic> are processed. In the following subsections, we term the constructed EICs as peaks for convenience. Furthermore, each peak is represented by its apex, i.e., using the m/z, retention time of the apex signal, and the associated abundance is recorded.</p>
        <fig id="pone.0146112.g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>A cartoon for the illustration of constructing extracted ion chromatograms.</title>
            <p>The blue straight lines represent the clustered signals, <italic>w</italic> and <italic>t</italic> are the FWHM and retention time of <inline-formula id="pone.0146112.e006"><alternatives><graphic id="pone.0146112.e006g" xlink:href="pone.0146112.e006"/><mml:math id="M6"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, respectively. Signal A and B are determined as the boundaries of the EIC, and the area in light blue color is the abundance.</p>
          </caption>
          <graphic xlink:href="pone.0146112.g002"/>
        </fig>
      </sec>
      <sec id="sec014">
        <title>Determining the charge state and isotope ratio of peaks</title>
        <p>In order to determine the charge state and isotope ratio, iMet-Q first constructs an isotope envelope for a peak. Starting from the most intensive peak, <italic>P</italic><sub><italic>1</italic></sub>, in the current peak list, our tool groups it with all of its neighboring peaks having larger <italic>m/z</italic> values and decreasing intensities, i.e., forming an isotope group. If the <italic>m/z</italic> distance between the apex of any two peaks in the isotope group equals to 1/<italic>z</italic> (<italic>z</italic> can be 1~4), the group is considered as a possible isotope envelope, where <italic>P</italic><sub><italic>1</italic></sub> and the peak adjacent to <italic>P</italic><sub><italic>1</italic></sub> are considered as the monoisotope peak and the second isotope peak, respectively. Then, to validate the correctness of the isotope envelope, iMet-Q calculates the peak shape similarity between the monoisotope peak and the second isotope peak by using the dot product as shown below:
<disp-formula id="pone.0146112.e007"><alternatives><graphic xlink:href="pone.0146112.e007.jpg" id="pone.0146112.e007g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic>n</italic> is the number of scans that both the monoisotope peak and the second isotope peak co-occur, and <italic>x</italic><sub><italic>i</italic></sub> and <italic>y</italic><sub><italic>i</italic></sub> are their respective signal intensities in the <italic>i</italic><sup>th</sup> scan. If the peak shape similarity between the two peaks is above a user-defined threshold (0.8 by default), we consider that all of the peaks in the isotope group form an isotope envelope and the charge state of <italic>P</italic><sub>1</sub> is determined as <italic>z</italic>. Moreover, the isotope ratio of <italic>P</italic><sub><italic>1</italic></sub> is calculated as the abundance of the second isotope peak divided by the abundance of <italic>P</italic><sub><italic>1</italic></sub>, and the peaks in the isotope group are removed from further processing. Otherwise, the peaks do not form an isotope envelope and the charge state and isotope ratio of <italic>P</italic><sub><italic>1</italic></sub> are denoted as 0. The charge state determination procedure is repeatedly performed until all peaks are processed.</p>
        <p>By performing the above peak detection procedures, iMet-Q generates a peak list with charge state and isotope ratio information for each input replicate file. Note that the isotope peaks except the monoisotope in the confirmed isotope envelopes will not be reported in the peak list.</p>
      </sec>
    </sec>
    <sec id="sec015">
      <title>Peak Alignment</title>
      <p>For an input data set with multiple samples (each probably with multiple technical replicates), iMet-Q performs the same algorithm for pair-wise alignment within a sample (i.e., aligning replicates) and then across samples. The algorithm is described as follows.</p>
      <p>iMet-Q first selects the peak list that contains the largest number of detected peaks as the reference list and aligns other peak lists to it. For a pair of reference list and aligning peak list, iMet-Q uses peaks detected in both lists with their <italic>m/z</italic> and retention time differences within user-defined tolerances (i.e., mzTol and rtTol in iMet-Q) as landmarks [<xref rid="pone.0146112.ref034" ref-type="bibr">34</xref>]. Given the retention time of landmarks in the reference list and in the aligning peak list as vectors A and B, respectively, iMet-Q uses LOESS regression [<xref rid="pone.0146112.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0146112.ref027" ref-type="bibr">27</xref>] to generate a mapping between A and B with span of 20% and weight of 1 since LOESS regression combines multiple linear least square regression models which fit localized subsets of the data. The retention time of peaks, which are not landmarks, in either peak list are adjusted according to the LOESS regression model. iMet-Q then aligns the peaks in both peak lists that satisfy user-defined <italic>m/z</italic> tolerance and retention time tolerance based on adjusted retention time.</p>
      <p>Repeating the above process for all peak lists, peaks can be aligned across replicates. Since peaks aligned from different replicates in a sample may have slightly different values of <italic>m/z</italic> and retention time, we use the <italic>median</italic> of their <italic>m/z</italic> and retention time as the representative peak in each sample. Then the same algorithm is applied to align all of the representative peaks across samples.</p>
    </sec>
    <sec id="sec016">
      <title>Generating output of quantitation results</title>
      <p>In addition to viewing quantitation results in the main interface, iMet-Q reports the medians of <italic>m/z</italic>, retention time and abundance of the peaks in all replicates of all samples. For the charge state of an aligned peak, iMet-Q displays the charge state that is detected in most replicates. For the isotope ratio, iMet-Q collects the isotope ratios corresponding to the displayed charge state and reports the median as the isotope ratio. Quantitation results can be exported in.csv and.txt formats by users to conduct further analyses.</p>
    </sec>
  </sec>
  <sec id="sec017">
    <title>Results and Discussion</title>
    <p>We evaluated the performance of iMet-Q in metabolite quantitation by comparing the accuracy of detecting metabolites and the abundance consistency, calculated by Pearson product-moment correlation coefficient (PPMCC), of detected metabolites among replicates with XCMS, MetAlign, and MZmine 2 using samples ranging from a small standard data set (seven standard metabolites) to a complex biological data set (public Arabidopsis data set). We also demonstrated the ability of iMet-Q on charge state determination and isotope ratio calculation.</p>
    <sec id="sec018">
      <title>Performance evaluation on a standard metabolite mixture data</title>
      <p>To demonstrate the ability of iMet-Q, we used a standard metabolite mixture in which seven standard metabolites with different sample concentration in two samples were included for evaluation. The sample ratio, defined as the detected abundance of a standard metabolite in Sample 1 divided by that in Sample 2, is calculated for each of the seven metabolites in the standard metabolite mixture for the four quantitation tools. Both profile and centroid data sets generated from the raw data were processed by iMet-Q, XCMS, MetAlign, and MZmine 2, respectively. Algorithms and parameter settings used in these tools were described in the subsection of <italic>Data Processing and Software Parameter Settings</italic>. <xref rid="pone.0146112.t001" ref-type="table">Table 1</xref> shows the quantitation errors, which is defined as the difference between theoretical and calculated sample ratios divided by the theoretical sample ratios, of the seven standard metabolites calculated by the four quantitation tools. Detailed abundances and sample ratios calculated by the four tools are listed in <xref rid="pone.0146112.s010" ref-type="supplementary-material">S5 Table</xref>.</p>
      <table-wrap id="pone.0146112.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>The quantitation error (%) of seven standard metabolites calculated by iMet-Q, XCMS, MetAlign, and MZmine 2.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0146112.t001g" xlink:href="pone.0146112.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1"/>
                <th colspan="8" align="center" rowspan="1">Quantitation error (%)<xref rid="t001fn001" ref-type="table-fn"><sup>a</sup></xref></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1"/>
                <th colspan="2" align="center" rowspan="1">iMet-Q</th>
                <th colspan="2" align="center" rowspan="1">XCMS</th>
                <th colspan="2" align="center" rowspan="1">MetAlign</th>
                <th colspan="2" align="center" rowspan="1">MZmine 2</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">Standard Compound</th>
                <th align="center" rowspan="1" colspan="1">Theoretical Sample Ratio</th>
                <th align="center" rowspan="1" colspan="1">Profile</th>
                <th align="center" rowspan="1" colspan="1">Centroid</th>
                <th align="center" rowspan="1" colspan="1">Profile</th>
                <th align="center" rowspan="1" colspan="1">Centroid</th>
                <th align="center" rowspan="1" colspan="1">Profile</th>
                <th align="center" rowspan="1" colspan="1">Centroid</th>
                <th align="center" rowspan="1" colspan="1">Profile</th>
                <th align="center" rowspan="1" colspan="1">Centroid</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">L-hisitidine</td>
                <td align="center" rowspan="1" colspan="1">0.50</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">12</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">L-Carnosine</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">9</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="center" rowspan="1" colspan="1">7</td>
                <td align="center" rowspan="1" colspan="1">50</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">11</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="center" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Creatine</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">18</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">11</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Caffine</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">16</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">16</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Hippuric acid</td>
                <td align="center" rowspan="1" colspan="1">0.20</td>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">105</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">20</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Glycocholic acid</td>
                <td align="center" rowspan="1" colspan="1">0.20</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">30</td>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="center" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Cholic acid</td>
                <td align="center" rowspan="1" colspan="1">0.33</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">24</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">24</td>
                <td align="center" rowspan="1" colspan="1">24</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">Average</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">32</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">13</td>
                <td align="center" rowspan="1" colspan="1">14</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p><sup>a</sup>Quantitation error (%) = (|Theoretical Sample Ratio–Calculated Sample Ratio|) x100/ Theoretical Sample Ratio.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>As shown in <xref rid="pone.0146112.t001" ref-type="table">Table 1</xref>, iMet-Q, XCMS, and MZmine 2 had the average quantitation error of 12%, 12% and 13% on the profile data set, and 12%, 32% and 14% on the centroid data set. MetAlign did not process the profile data set and had the average quantitation error of 14% on the centroid data set. The results showed that iMet-Q achieved the smallest quantitation errors and also had the same average quantitation error of 12% in both profile and centroid data set, suggesting the robustness of iMet-Q on processing input files in both data type.</p>
      <p>In addition to accurate quantitation, iMet-Q determined the charge state and isotope ratio of detected peaks. In order to evaluate the charge state determined by iMet-Q, we used CAMERA to annotate charge states and isotope peaks of the standard metabolites. Charge states and isotope peaks of the seven standard metabolites in both profile and centroid data sets annotated by iMet-Q were overall identical with CAMERA’s annotation.</p>
      <p>To demonstrate possible usefulness of isotope ratio information, we searched the mass of seven standard metabolites against HMDB [<xref rid="pone.0146112.ref030" ref-type="bibr">30</xref>] with mass tolerance of ±5 ppm and adduct type of unknown (assuming a user has little information on the spectra). As a result, 183 metabolites candidates were obtained. Using iMet-Q’s calculated isotope ratios (the isotope ratio tolerance is ±0.02) to filter out unnecessary metabolite candidates, we reduced 49% (89 out of 183) metabolite candidates (<xref rid="pone.0146112.s011" ref-type="supplementary-material">S6 Table</xref>). The remaining metabolite candidates could not be filtered out by isotope ratios because they have the same chemical formula (i.e., identical theoretical isotope ratios).</p>
    </sec>
    <sec id="sec019">
      <title>Performance evaluation on a public Arabidopsis metabolome data</title>
      <p>The public Arabidopsis data of 36 distinct samples collected from eight different plant classes (classified by Matsuda <italic>et al</italic>.) was used to demonstrate iMet-Q’s performance on quantifying complex biological samples. Each sample contained two internal standards, one for positive- and the other for negative-ion modes, and 167 metabolites (71 detected only in positive-ion mode, 39 only in negative-ion mode, and 57 in both modes) were elucidated from the data set [<xref rid="pone.0146112.ref028" ref-type="bibr">28</xref>]. The performance of four tools were evaluated in terms of the accuracy on detecting the two internal standards and 167 elucidated metabolites, and the ability of properly clustering 36 samples into eight plant classes.</p>
      <p><xref rid="pone.0146112.t002" ref-type="table">Table 2</xref> shows the reproducibility and normalized abundances of two internal standards detected by the four quantitation tools, where iMet-Q, XCMS, and MetAlign detected all the internal standards from each replicate, achieving 100% reproducibility, slightly better than MZmine 2. Furthermore, iMet-Q reported normalized abundances of 1±0.19 and 1±0.18 for the two standard metabolites, comparable to the best 1±0.18 reported by XCMS and MZmine 2 for Lidocaine and the best 1±0.17 reported by XCMS for Camphor-10-sulfonic acid.</p>
      <table-wrap id="pone.0146112.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>The reproducibility (Rep.) and normalized abundance (Abund.) of two internal standards detected by four quantitation tools.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0146112.t002g" xlink:href="pone.0146112.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th colspan="2" align="center" rowspan="1">Lidocaine</th>
                <th colspan="2" align="center" rowspan="1">Camphor-10-sulfonic acid</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">Rep. (%)</th>
                <th align="center" rowspan="1" colspan="1">Abund.</th>
                <th align="center" rowspan="1" colspan="1">Rep. (%)</th>
                <th align="center" rowspan="1" colspan="1">Abund.</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">iMet-Q</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.19</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.18</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">XCMS</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.18</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.17</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">MetAlign</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.20</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.22</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">MZmine 2</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.18</td>
                <td align="center" rowspan="1" colspan="1">85</td>
                <td align="center" rowspan="1" colspan="1">1±0.46</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>For 167 elucidated metabolites, we searched their <italic>m/z</italic> and retention time values provided in [<xref rid="pone.0146112.ref028" ref-type="bibr">28</xref>] against the quantitation results of the four tools with m/z and retention time tolerances of 0.05 m/z and 9 seconds. As a result, iMet-Q detected all of the elucidated metabolites, whereas XCMS, MetAlign, and MZmine 2 detected 103 (62%), 145 (87%), and 129 (77%) of the elucidated metabolites, respectively. We further evaluated the detected abundance of these metabolites. Since the exact abundance of 167 elucidated metabolites was unknown, we calculated the abundance correlation between any two replicates of a sample by PPMCC. As a result, iMet-Q achieved an average replicate abundance correlation of 0.92, whereas XCMS, MetAlign, and MZmine 2 achieved average abundance correlations of 0.87, 0.78, and 0.81, respectively (as shown in <xref rid="pone.0146112.g003" ref-type="fig">Fig 3</xref>). The result revealed that iMet-Q not only achieved high accuracy on detecting the 167 elucidated metabolites but also provided very consistent quantitation result.</p>
      <fig id="pone.0146112.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>The box plot of abundance correlation of 167 elucidated metabolites across replicates in the public Arabidopsis data detected by the four quantitation tools.</title>
        </caption>
        <graphic xlink:href="pone.0146112.g003"/>
      </fig>
      <p>Next, we examined whether replicates of the 36 samples could be properly clustered into eight plant classes using the quantitation results of the four tools. We combined the quantitation results from positive- and negative-ion modes, and performed hierarchical clustering using MATLAB <italic>dendrogram</italic> function with PPMCC as the abundance correlation measure. The combined quantitation results of the four tools are provided in <xref rid="pone.0146112.s012" ref-type="supplementary-material">S7</xref>–<xref rid="pone.0146112.s015" ref-type="supplementary-material">S10</xref> Tables. The numbers of detected peaks in the combined quantitation results of iMet-Q, XCMS, MetAlign, and MZmine 2 were 13079, 7487, 37364, and 19394, respectively. <xref rid="pone.0146112.g004" ref-type="fig">Fig 4</xref> shows the hierarchical clustering results of the four tools. The average abundance correlations of the eight plant classes using the combined quantitation results of iMet-Q, XCMS, MetAlign, and MZmine 2 were 0.71, 0.75, 0.65, and 0.59, respectively. The detailed average abundance correlation of each plant class is shown in <xref rid="pone.0146112.s016" ref-type="supplementary-material">S11 Table</xref>. Note that all the replicates of flower class, the best clustered plant class (blue color in <xref rid="pone.0146112.g004" ref-type="fig">Fig 4</xref>), were clustered using iMet-Q’s combined quantitation result, and the average abundance correlation of the flower class was 0.88. This evaluation implies that, although the numbers of peaks detected by MetAlign and MZmine 2 were much larger than those detected by iMet-Q and XCMS, peaks detected by iMet-Q and XCMS might be more essential for distinguishing plant classes.</p>
      <fig id="pone.0146112.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Hierarchical clustering by using the quantitation results of iMet-Q, XCMS, MetAlign, and MZmine 2.</title>
          <p>Each entry in the tree leaves of a dendrogram represents a replicate. For each tool, we first combined its quantitation results of positive- and negative-ion modes. Colors were assigned to each replicate in the combined quantitation results according to the plant classes which the replicates originated from as follows: orange for cotyledon, red for stem, green for leaf, blue for flower, light blue for shoot apex, yellow for root, pink for seed, and gray for silique. Next, the figure was produced using MATLAB <italic>dendrogram</italic> function with PMMCC as the abundance correlation measure between any two replicates in the combined quantitation results.</p>
        </caption>
        <graphic xlink:href="pone.0146112.g004"/>
      </fig>
      <p>To overcome the bottleneck in metabolite identification based on MS1 data, a method utilizing both isotope ratio and in-source fragment information has been recently proposed, in which the same Arabidopsis metabolome data set was also used for identification performance evaluation [<xref rid="pone.0146112.ref035" ref-type="bibr">35</xref>]. According to the study, 19 out of 167 elucidated metabolites have been confirmed that some of their in-source fragments were detected in MS1 scans [<xref rid="pone.0146112.ref035" ref-type="bibr">35</xref>], and the abundance correlations between the 19 metabolites and their fragments were above 0.8. We thus used the 19 confirmed metabolites to demonstrate the ability of iMet-Q. By calculating the abundance correlations between 19 metabolites and their in-source fragments, iMet-Q reported an abundance correlation of 0.94, whereas XCMS, MetAlign, and MZmine 2 reported abundance correlations of 0.61, 0.76, and 0.66, respectively (as shown in <xref rid="pone.0146112.g005" ref-type="fig">Fig 5</xref>). This result revealed that the abundances of the 19 metabolites and their in-source fragments were accurately detected and calculated by iMet-Q. Furthermore, isotope ratios of 89.47% (17 out of 19) metabolites were accurately calculated by iMet-Q, with differences within 0.05 to the theoretical ratio (<xref rid="pone.0146112.s017" ref-type="supplementary-material">S12 Table</xref>).</p>
      <fig id="pone.0146112.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>The box plot of abundance correlations between 19 verified metabolites and their in-source fragments detected in the public Arabidopsis data.</title>
        </caption>
        <graphic xlink:href="pone.0146112.g005"/>
      </fig>
    </sec>
    <sec id="sec020">
      <title>Friendly User Interfaces of iMet-Q</title>
      <p>We particularly implemented iMet-Q as a project-oriented quantitation platform, allowing users to conveniently quantify, manage and compare a large number of data sets or quantitation results in Microsoft Windows series platform (including Windows 7, 8, and Windows Server 2008, 2012). To be specific, iMet-Q applies a tree structure to organize quantitation results, where each node represents a project and sub-nodes of a project represent the quantitation results (as shown in <xref rid="pone.0146112.g006" ref-type="fig">Fig 6</xref>).</p>
      <fig id="pone.0146112.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>The main graphical user interface of Metab-Q.</title>
          <p>The Arabidopsis data from positive-ion mode is used as an example. After processing the data, Metab-Q lists the detected peaks in the summary table where the peaks are sorted according to their retention time. When users select peaks of interest in the summary table, the abundances of the selected peaks in different samples are plotted in the sample abundance plot and the detailed information of the selected peak in the technical replicates of a sample is listed in the panel below the summary table. The left panel is the quantitation parameter explorer that lists the parameters of a quantitation. Users can use the provided filter function to narrow down the number of peaks in the summary table.</p>
        </caption>
        <graphic xlink:href="pone.0146112.g006"/>
      </fig>
      <p>iMet-Q provides three wizards to guide users easily executing the program as follows. First, a <italic>project wizard</italic> guides a user to create a project and designate a folder to store the project. Second, a <italic>quantitation wizard</italic> guides the user to quantify LC-MS-based data. The wizard only requires the user to set up three quantitation parameters, i.e., mzWidth, mzTol, and rtTol; other parameters are optional. Since multiple technical replicates may be conducted on a sample, iMet-Q pops up a table to guide users to group technical replicates by the sample. During quantitation, iMet-Q sequentially detects peaks from each replicate and then aligns those detected peaks across replicates/samples. Third, an <italic>export wizard</italic> guides the user to export quantitation results in common output formats, including.csv and.txt. It also allows users to name the quantitation, designate the file for exporting, and set up criteria for filtering out unwanted peaks in order to focus on peaks of interest. With the conventional output formats, the user can easily import the quantitation results to other available tools, such as Microsoft Excel and Matlab, for further statistical analysis.</p>
      <p>To compare abundances across samples, iMet-Q hierarchically displays a quantitation result in the main interface, where the quantitation result is summarized in a summary table. The summary table lists the <italic>m/z</italic>, retention time, charge state, isotope ratio, and abundance of all detected peaks in all samples for a quick overview. The user can click on a detected peak of interest in the summary table, and the sample abundances of the selected peak will be plotted in the upper panel above the summary table. Meanwhile, the detailed information of the selected peak in the technical replicates of a sample will be listed in the panel below the summary table. The user can double-click a row in the replicate table to view the extracted ion chromatogram of the peak. In order to efficiently select peaks of interest in the summary table, iMet-Q provides a search function using the range of <italic>m/z</italic>, retention time, charge state, or isotope ratio to narrow down the peaks listed in the summary table.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec021">
    <title>Conclusions</title>
    <p>Many state-of-the-art quantitation tools have been proposed to allow users automatically quantifying metabolites from large-scale label-free metabolomics data sets. The quantitation ability of these tools is beyond doubt. However, a major concern of using these tools is the parameter setting for peak detection. Since peak shapes vary greatly from one to another, it is difficult for users to select an optimized parameter setting for peak detection. In addition, most of the tools do not provide deisotoping, and thus users have to apply additional packages for isotope pattern assembly. Therefore, in this paper, we introduced an intelligent quantitation tool, iMet-Q, which is capable of dynamically determining the peak widths in liquid chromatogram dimension without input parameter, and automatically performing isotope pattern assembly. In our evaluation, iMet-Q has the quantitation performance better than XCMS, MetAlign, and MZmine 2 on standard and large-scale metabolome data sets. Besides, iMet-Q provides both the charge states and isotope ratios of detected peaks. With the charge state information, users can obtain accurate masses of detected peaks. Meanwhile, the isotope ratio information provides users an opportunity to reduce metabolite candidates. Although our evaluation demonstrates that the metabolite isotope ratios calculated by iMet-Q are close to the theoretical values, it is important to note that isotope ratio can be affected by noise interference, saturation effects and different experimental conditions [<xref rid="pone.0146112.ref036" ref-type="bibr">36</xref>, <xref rid="pone.0146112.ref037" ref-type="bibr">37</xref>]. In addition to providing accurate quantitation, charge state, and isotope ratios, iMet-Q is equipped with friendly user interfaces so that quantifying metabolites become an easy task. The software program is now publicly available for download at <ext-link ext-link-type="uri" xlink:href="http://ms.iis.sinica.edu.tw/comics/Software_iMet-Q.html">http://ms.iis.sinica.edu.tw/comics/Software_iMet-Q.html</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec022">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0146112.s001">
      <label>S1 File</label>
      <caption>
        <title>The XCMS quantitation results of the standard metabolite mixture (profile mode) under five different parameter settings.</title>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0146112.s001.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s002">
      <label>S2 File</label>
      <caption>
        <title>The XCMS quantitation results of the standard metabolite mixture (centroid mode) under 37 different parameter settings.</title>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0146112.s002.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s003">
      <label>S3 File</label>
      <caption>
        <title>The XCMS quantitation results of the public Arabidopsis dataset (positive mode) under 37 different parameter settings.</title>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0146112.s003.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s004">
      <label>S4 File</label>
      <caption>
        <title>The XCMS quantitation results of the public Arabidopsis dataset (negative mode) under 37 different parameter settings.</title>
        <p>(7Z)</p>
      </caption>
      <media xlink:href="pone.0146112.s004.7z">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s005">
      <label>S1 Section</label>
      <caption>
        <title>The detailed description of centroiding signals in each scan.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0146112.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s006">
      <label>S1 Table</label>
      <caption>
        <title>The sample ratio of each metabolite under different fwhm (for Standard Mixture-profile).</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s006.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s007">
      <label>S2 Table</label>
      <caption>
        <title>The sample ratio of each metabolite under different centWave parameters (for Standard Mixture-centroid).</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s007.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s008">
      <label>S3 Table</label>
      <caption>
        <title>The reproducibility and abundance consistency of the internal standard (lidocaine) in Arabidopsis data set (positive mode) under different centWave parameters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s008.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s009">
      <label>S4 Table</label>
      <caption>
        <title>The reproducibility and abundance consistency of the internal standard (camphor-10-sulfonic acid) in Arabidopsis data set (negative mode) under different centWave parameters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s009.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s010">
      <label>S5 Table</label>
      <caption>
        <title>The abundances of seven standard metabolites detected from profile and centroid data set using four quantitation tools.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s011">
      <label>S6 Table</label>
      <caption>
        <title>The number of metabolite candidates of the seven standard metabolites using (1) mass match, and (2) mass and isotope ratio (IR) match.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s011.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s012">
      <label>S7 Table</label>
      <caption>
        <title>The combined quantitation result generated using iMet-Q.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s012.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s013">
      <label>S8 Table</label>
      <caption>
        <title>The combined quantitation result generated using XCMS.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s013.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s014">
      <label>S9 Table</label>
      <caption>
        <title>The combined quantitation result generated using MetAlign.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s014.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s015">
      <label>S10 Table</label>
      <caption>
        <title>The combined quantitation result generated using MZmine 2.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s015.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s016">
      <label>S11 Table</label>
      <caption>
        <title>The average abundance correlations of the eight plant classes using the quantitation results obtained from iMet-Q, XCMS, MetAlign, and MZmine 2.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s016.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s017">
      <label>S12 Table</label>
      <caption>
        <title>The isotope ratio of the 19 identified metabolites in the public Arabidopsis data set.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s017.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the support from Academia Sinica, Ministry of Science and Technology of Taiwan (MOST 103-2221-E-001-037), and Taiwan International Graduate Program. We also thank Wai-Kok Choong and Thejkiran Pitti for fruitful discussion on the manuscript.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0146112.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Ellis</surname><given-names>DI</given-names></name>, <name><surname>Dunn</surname><given-names>WB</given-names></name>, <name><surname>Griffin</surname><given-names>JL</given-names></name>, <name><surname>Allwood</surname><given-names>JW</given-names></name>, <name><surname>Goodacre</surname><given-names>R</given-names></name>. <article-title>Metabolic fingerprinting as a diagnostic tool</article-title>. <source>Pharmacogenomics</source>. <year>2007</year><month>9</month>;<volume>8</volume>(<issue>9</issue>):<fpage>1243</fpage>–<lpage>66</lpage>. .<?supplied-pmid 17924839?><pub-id pub-id-type="pmid">17924839</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Patti</surname><given-names>GJ</given-names></name>, <name><surname>Yanes</surname><given-names>O</given-names></name>, <name><surname>Siuzdak</surname><given-names>G</given-names></name>. <article-title>Innovation: Metabolomics: the apogee of the omics trilogy</article-title>. <source>Nature reviews Molecular cell biology</source>. <year>2012</year><month>4</month>;<volume>13</volume>(<issue>4</issue>):<fpage>263</fpage>–<lpage>9</lpage>. Pubmed Central PMCID: 3682684. <pub-id pub-id-type="doi">10.1038/nrm3314</pub-id><?supplied-pmid 22436749?><pub-id pub-id-type="pmid">22436749</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Weiss</surname><given-names>RH</given-names></name>, <name><surname>Kim</surname><given-names>K</given-names></name>. <article-title>Metabolomics in the study of kidney diseases</article-title>. <source>Nature reviews Nephrology</source>. <year>2012</year><month>1</month>;<volume>8</volume>(<issue>1</issue>):<fpage>22</fpage>–<lpage>33</lpage>. .<?supplied-pmid 22025087?><pub-id pub-id-type="pmid">22025087</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Baker</surname><given-names>M</given-names></name>. <article-title>Metabolomics: from small molecules to big ideas</article-title>. <source>Nat Methods</source>. <year>2011</year><source>Feb</source>;<volume>8</volume>(<issue>2</issue>):<fpage>117</fpage>–<lpage>21</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Dunn</surname><given-names>WB</given-names></name>, <name><surname>Broadhurst</surname><given-names>DI</given-names></name>, <name><surname>Atherton</surname><given-names>HJ</given-names></name>, <name><surname>Goodacre</surname><given-names>R</given-names></name>, <name><surname>Griffin</surname><given-names>JL</given-names></name>. <article-title>Systems level studies of mammalian metabolomes: the roles of mass spectrometry and nuclear magnetic resonance spectroscopy</article-title>. <source>Chemical Society reviews</source>. <year>2011</year><month>1</month>;<volume>40</volume>(<issue>1</issue>):<fpage>387</fpage>–<lpage>426</lpage>. <pub-id pub-id-type="doi">10.1039/b906712b</pub-id><?supplied-pmid 20717559?><pub-id pub-id-type="pmid">20717559</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Madsen</surname><given-names>R</given-names></name>, <name><surname>Lundstedt</surname><given-names>T</given-names></name>, <name><surname>Trygg</surname><given-names>J</given-names></name>. <article-title>Chemometrics in metabolomics-A review in human disease diagnosis</article-title>. <source>Analytica Chimica Acta</source>. <year>2010</year><month>2</month><day>5</day>;<volume>659</volume>(<issue>1–2</issue>):<fpage>23</fpage>–<lpage>33</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2009.11.042</pub-id><?supplied-pmid WOS:000274046900004?><pub-id pub-id-type="pmid">20103103</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Issaq</surname><given-names>HJ</given-names></name>, <name><surname>Van</surname><given-names>QN</given-names></name>, <name><surname>Waybright</surname><given-names>TJ</given-names></name>, <name><surname>Muschik</surname><given-names>GM</given-names></name>, <name><surname>Veenstra</surname><given-names>TD</given-names></name>. <article-title>Analytical and statistical approaches to metabolomics research</article-title>. <source>Journal of separation science</source>. <year>2009</year><month>7</month>;<volume>32</volume>(<issue>13</issue>):<fpage>2183</fpage>–<lpage>99</lpage>. <pub-id pub-id-type="doi">10.1002/jssc.200900152</pub-id><?supplied-pmid 19569098?><pub-id pub-id-type="pmid">19569098</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Mamas</surname><given-names>M</given-names></name>, <name><surname>Dunn</surname><given-names>WB</given-names></name>, <name><surname>Neyses</surname><given-names>L</given-names></name>, <name><surname>Goodacre</surname><given-names>R</given-names></name>. <article-title>The role of metabolites and metabolomics in clinically applicable biomarkers of disease</article-title>. <source>Archives of toxicology</source>. <year>2011</year><month>1</month>;<volume>85</volume>(<issue>1</issue>):<fpage>5</fpage>–<lpage>17</lpage>. <pub-id pub-id-type="doi">10.1007/s00204-010-0609-6</pub-id><?supplied-pmid 20953584?><pub-id pub-id-type="pmid">20953584</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>A</given-names></name>, <name><surname>Lison</surname><given-names>D</given-names></name>, <name><surname>Junot</surname><given-names>C</given-names></name>, <name><surname>Heilier</surname><given-names>JF</given-names></name>. <article-title>Applications of liquid chromatography coupled to mass spectrometry-based metabolomics in clinical chemistry and toxicology: A review</article-title>. <source>Clinical biochemistry</source>. <year>2011</year><month>1</month>;<volume>44</volume>(<issue>1</issue>):<fpage>119</fpage>–<lpage>35</lpage>. <pub-id pub-id-type="doi">10.1016/j.clinbiochem.2010.08.016</pub-id><?supplied-pmid 20800591?><pub-id pub-id-type="pmid">20800591</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Theodoridis</surname><given-names>GA</given-names></name>, <name><surname>Gika</surname><given-names>HG</given-names></name>, <name><surname>Want</surname><given-names>EJ</given-names></name>, <name><surname>Wilson</surname><given-names>ID</given-names></name>. <article-title>Liquid chromatography-mass spectrometry based global metabolite profiling: a review</article-title>. <source>Analytica chimica acta</source>. <year>2012</year><month>1</month><day>20</day>;<volume>711</volume>:<fpage>7</fpage>–<lpage>16</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2011.09.042</pub-id><?supplied-pmid 22152789?><pub-id pub-id-type="pmid">22152789</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>B</given-names></name>, <name><surname>Xiao</surname><given-names>JF</given-names></name>, <name><surname>Tuli</surname><given-names>L</given-names></name>, <name><surname>Ressom</surname><given-names>HW</given-names></name>. <article-title>LC-MS-based metabolomics</article-title>. <source>Molecular bioSystems</source>. <year>2012</year><month>2</month>;<volume>8</volume>(<issue>2</issue>):<fpage>470</fpage>–<lpage>81</lpage>. Pubmed Central PMCID: 3699692. <pub-id pub-id-type="doi">10.1039/c1mb05350g</pub-id><?supplied-pmid 22041788?><pub-id pub-id-type="pmid">22041788</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Bedair</surname><given-names>M</given-names></name>, <name><surname>Sumner</surname><given-names>LW</given-names></name>. <article-title>Current and emerging mass-spectrometry technologies for metabolomics</article-title>. <source>Trac-Trend Anal Chem</source>. <year>2008</year><month>3</month>;<volume>27</volume>(<issue>3</issue>):<fpage>238</fpage>–<lpage>50</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Dakna</surname><given-names>M</given-names></name>, <name><surname>He</surname><given-names>Z</given-names></name>, <name><surname>Yu</surname><given-names>WC</given-names></name>, <name><surname>Mischak</surname><given-names>H</given-names></name>, <name><surname>Kolch</surname><given-names>W</given-names></name>. <article-title>Technical, bioinformatical and statistical aspects of liquid chromatography-mass spectrometry (LC-MS) and capillary electrophoresis-mass spectrometry (CE-MS) based clinical proteomics: a critical assessment</article-title>. <source>Journal of chromatography B, Analytical technologies in the biomedical and life sciences</source>. <year>2009</year><month>5</month><day>1</day>;<volume>877</volume>(<issue>13</issue>):<fpage>1250</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1016/j.jchromb.2008.10.048</pub-id><?supplied-pmid 19010091?><pub-id pub-id-type="pmid">19010091</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Blekherman</surname><given-names>G</given-names></name>, <name><surname>Laubenbacher</surname><given-names>R</given-names></name>, <name><surname>Cortes</surname><given-names>DF</given-names></name>, <name><surname>Mendes</surname><given-names>P</given-names></name>, <name><surname>Torti</surname><given-names>FM</given-names></name>, <name><surname>Akman</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Bioinformatics tools for cancer metabolomics</article-title>. <source>Metabolomics: Official journal of the Metabolomic Society</source>. <year>2011</year><month>9</month>;<volume>7</volume>(<issue>3</issue>):<fpage>329</fpage>–<lpage>43</lpage>. . Pubmed Central PMCID: 3155682.<?supplied-pmid 21949492?><pub-id pub-id-type="pmid">21949492</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Jaitly</surname><given-names>N</given-names></name>, <name><surname>Mayampurath</surname><given-names>A</given-names></name>, <name><surname>Littlefield</surname><given-names>K</given-names></name>, <name><surname>Adkins</surname><given-names>JN</given-names></name>, <name><surname>Anderson</surname><given-names>GA</given-names></name>, <name><surname>Smith</surname><given-names>RD</given-names></name>. <article-title>Decon2LS: An open-source software package for automated processing and visualization of high resolution mass spectrometry data</article-title>. <source>BMC bioinformatics</source>. <year>2009</year>;<volume>10</volume>:<fpage>87</fpage> Pubmed Central PMCID: 2666663. <pub-id pub-id-type="doi">10.1186/1471-2105-10-87</pub-id><?supplied-pmid 19292916?><pub-id pub-id-type="pmid">19292916</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Sugimoto</surname><given-names>M</given-names></name>, <name><surname>Hirayama</surname><given-names>A</given-names></name>, <name><surname>Ishikawa</surname><given-names>T</given-names></name>, <name><surname>Robert</surname><given-names>M</given-names></name>, <name><surname>Baran</surname><given-names>R</given-names></name>, <name><surname>Uehara</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>Differential metabolomics software for capillary electrophoresis-mass spectrometry data analysis</article-title>. <source>Metabolomics: Official journal of the Metabolomic Society</source>. <year>2010</year><month>3</month>;<volume>6</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>41</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Scalbert</surname><given-names>A</given-names></name>, <name><surname>Brennan</surname><given-names>L</given-names></name>, <name><surname>Fiehn</surname><given-names>O</given-names></name>, <name><surname>Hankemeier</surname><given-names>T</given-names></name>, <name><surname>Kristal</surname><given-names>BS</given-names></name>, <name><surname>van Ommen</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>Mass-spectrometry-based metabolomics: limitations and recommendations for future progress with particular focus on nutrition research</article-title>. <source>Metabolomics: Official journal of the Metabolomic Society</source>. <year>2009</year><month>12</month>;<volume>5</volume>(<issue>4</issue>):<fpage>435</fpage>–<lpage>58</lpage>. . Pubmed Central PMCID: 2794347.<?supplied-pmid 20046865?><pub-id pub-id-type="pmid">20046865</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>CA</given-names></name>, <name><surname>Want</surname><given-names>EJ</given-names></name>, <name><surname>O'Maille</surname><given-names>G</given-names></name>, <name><surname>Abagyan</surname><given-names>R</given-names></name>, <name><surname>Siuzdak</surname><given-names>G</given-names></name>. <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>. <source>Analytical chemistry</source>. <year>2006</year><month>2</month><day>1</day>;<volume>78</volume>(<issue>3</issue>):<fpage>779</fpage>–<lpage>87</lpage>. .<?supplied-pmid 16448051?><pub-id pub-id-type="pmid">16448051</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Lommen</surname><given-names>A</given-names></name>. <article-title>MetAlign: interface-driven, versatile metabolomics tool for hyphenated full-scan mass spectrometry data preprocessing</article-title>. <source>Analytical chemistry</source>. <year>2009</year><month>4</month><day>15</day>;<volume>81</volume>(<issue>8</issue>):<fpage>3079</fpage>–<lpage>86</lpage>. <pub-id pub-id-type="doi">10.1021/ac900036d</pub-id><?supplied-pmid 19301908?><pub-id pub-id-type="pmid">19301908</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Pluskal</surname><given-names>T</given-names></name>, <name><surname>Castillo</surname><given-names>S</given-names></name>, <name><surname>Villar-Briones</surname><given-names>A</given-names></name>, <name><surname>Oresic</surname><given-names>M</given-names></name>. <article-title>MZmine 2: modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data</article-title>. <source>BMC bioinformatics</source>. <year>2010</year>;<volume>11</volume>:<fpage>395</fpage> Pubmed Central PMCID: 2918584. <pub-id pub-id-type="doi">10.1186/1471-2105-11-395</pub-id><?supplied-pmid 20650010?><pub-id pub-id-type="pmid">20650010</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Kenar</surname><given-names>E</given-names></name>, <name><surname>Franken</surname><given-names>H</given-names></name>, <name><surname>Forcisi</surname><given-names>S</given-names></name>, <name><surname>Wormann</surname><given-names>K</given-names></name>, <name><surname>Haring</surname><given-names>HU</given-names></name>, <name><surname>Lehmann</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Automated label-free quantification of metabolites from liquid chromatography-mass spectrometry data</article-title>. <source>Molecular &amp; cellular proteomics: MCP</source>. <year>2014</year><month>1</month>;<volume>13</volume>(<issue>1</issue>):<fpage>348</fpage>–<lpage>59</lpage>. . Pubmed Central PMCID: 3879626.<?supplied-pmid 24176773?><pub-id pub-id-type="pmid">24176773</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Aberg</surname><given-names>KM</given-names></name>, <name><surname>Torgrip</surname><given-names>RJ</given-names></name>, <name><surname>Kolmert</surname><given-names>J</given-names></name>, <name><surname>Schuppe-Koistinen</surname><given-names>I</given-names></name>, <name><surname>Lindberg</surname><given-names>J</given-names></name>. <article-title>Feature detection and alignment of hyphenated chromatographic-mass spectrometric data. Extraction of pure ion chromatograms using Kalman tracking</article-title>. <source>Journal of chromatography A</source>. <year>2008</year><month>5</month><day>23</day>;<volume>1192</volume>(<issue>1</issue>):<fpage>139</fpage>–<lpage>46</lpage>. <pub-id pub-id-type="doi">10.1016/j.chroma.2008.03.033</pub-id><?supplied-pmid 18378252?><pub-id pub-id-type="pmid">18378252</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Sugimoto</surname><given-names>M</given-names></name>, <name><surname>Kawakami</surname><given-names>M</given-names></name>, <name><surname>Robert</surname><given-names>M</given-names></name>, <name><surname>Soga</surname><given-names>T</given-names></name>, <name><surname>Tomita</surname><given-names>M</given-names></name>. <article-title>Bioinformatics Tools for Mass Spectroscopy-Based Metabolomic Data Processing and Analysis</article-title>. <source>Current bioinformatics</source>. <year>2012</year><month>3</month>;<volume>7</volume>(<issue>1</issue>):<fpage>96</fpage>–<lpage>108</lpage>. . Pubmed Central PMCID: 3299976.<?supplied-pmid 22438836?><pub-id pub-id-type="pmid">22438836</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Tautenhahn</surname><given-names>R</given-names></name>, <name><surname>Bottcher</surname><given-names>C</given-names></name>, <name><surname>Neumann</surname><given-names>S</given-names></name>. <article-title>Highly sensitive feature detection for high resolution LC/MS</article-title>. <source>BMC bioinformatics</source>. <year>2008</year>;<volume>9</volume>:<fpage>504</fpage> Pubmed Central PMCID: 2639432. <pub-id pub-id-type="doi">10.1186/1471-2105-9-504</pub-id><?supplied-pmid 19040729?><pub-id pub-id-type="pmid">19040729</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Kuhl</surname><given-names>C</given-names></name>, <name><surname>Tautenhahn</surname><given-names>R</given-names></name>, <name><surname>Bottcher</surname><given-names>C</given-names></name>, <name><surname>Larson</surname><given-names>TR</given-names></name>, <name><surname>Neumann</surname><given-names>S</given-names></name>. <article-title>CAMERA: an integrated strategy for compound spectra extraction and annotation of liquid chromatography/mass spectrometry data sets</article-title>. <source>Analytical chemistry</source>. <year>2012</year><month>1</month><day>3</day>;<volume>84</volume>(<issue>1</issue>):<fpage>283</fpage>–<lpage>9</lpage>. Pubmed Central PMCID: 3658281. <pub-id pub-id-type="doi">10.1021/ac202450g</pub-id><?supplied-pmid 22111785?><pub-id pub-id-type="pmid">22111785</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Cleveland</surname><given-names>WS</given-names></name>. <article-title>Robust Locally Weighted Regression and Smoothing Scatterplots</article-title>. <source>J Am Stat Assoc</source>. <year>1979</year>;<volume>74</volume>(<issue>368</issue>):<fpage>829</fpage>–<lpage>36</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Cleveland</surname><given-names>WS</given-names></name>. <article-title>Lowess—a Program for Smoothing Scatterplots by Robust Locally Weighted Regression</article-title>. <source>Am Stat</source>. <year>1981</year>;<volume>35</volume>(<issue>1</issue>):<fpage>54</fpage>–.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Matsuda</surname><given-names>F</given-names></name>, <name><surname>Hirai</surname><given-names>MY</given-names></name>, <name><surname>Sasaki</surname><given-names>E</given-names></name>, <name><surname>Akiyama</surname><given-names>K</given-names></name>, <name><surname>Yonekura-Sakakibara</surname><given-names>K</given-names></name>, <name><surname>Provart</surname><given-names>NJ</given-names></name>, <etal>et al</etal><article-title>AtMetExpress development: a phytochemical atlas of Arabidopsis development</article-title>. <source>Plant physiology</source>. <year>2010</year><month>2</month>;<volume>152</volume>(<issue>2</issue>):<fpage>566</fpage>–<lpage>78</lpage>. Pubmed Central PMCID: 2815869. <pub-id pub-id-type="doi">10.1104/pp.109.148031</pub-id><?supplied-pmid 20023150?><pub-id pub-id-type="pmid">20023150</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Kessner</surname><given-names>D</given-names></name>, <name><surname>Chambers</surname><given-names>M</given-names></name>, <name><surname>Burke</surname><given-names>R</given-names></name>, <name><surname>Agus</surname><given-names>D</given-names></name>, <name><surname>Mallick</surname><given-names>P</given-names></name>. <article-title>ProteoWizard: open source software for rapid proteomics tools development</article-title>. <source>Bioinformatics</source>. <year>2008</year><month>11</month><day>1</day>;<volume>24</volume>(<issue>21</issue>):<fpage>2534</fpage>–<lpage>6</lpage>. Pubmed Central PMCID: 2732273. <pub-id pub-id-type="doi">10.1093/bioinformatics/btn323</pub-id><?supplied-pmid 18606607?><pub-id pub-id-type="pmid">18606607</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Wishart</surname><given-names>DS</given-names></name>, <name><surname>Jewison</surname><given-names>T</given-names></name>, <name><surname>Guo</surname><given-names>AC</given-names></name>, <name><surname>Wilson</surname><given-names>M</given-names></name>, <name><surname>Knox</surname><given-names>C</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>HMDB 3.0—The Human Metabolome Database in 2013</article-title>. <source>Nucleic acids research</source>. <year>2013</year><month>1</month>;<volume>41</volume>(Database issue):<fpage>D801</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1065</pub-id>. Pubmed Central PMCID: 3531200.<?supplied-pmid 23161693?><pub-id pub-id-type="pmid">23161693</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Matsuda</surname><given-names>F</given-names></name>, <name><surname>Yonekura-Sakakibara</surname><given-names>K</given-names></name>, <name><surname>Niida</surname><given-names>R</given-names></name>, <name><surname>Kuromori</surname><given-names>T</given-names></name>, <name><surname>Shinozaki</surname><given-names>K</given-names></name>, <name><surname>Saito</surname><given-names>K</given-names></name>. <article-title>MS/MS spectral tag-based annotation of non-targeted profile of plant secondary metabolites</article-title>. <source>The Plant journal: for cell and molecular biology</source>. <year>2009</year><month>2</month>;<volume>57</volume>(<issue>3</issue>):<fpage>555</fpage>–<lpage>77</lpage>. . Pubmed Central PMCID: 2667644.<?supplied-pmid 18939963?><pub-id pub-id-type="pmid">18939963</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Katajamaa</surname><given-names>M</given-names></name>, <name><surname>Oresic</surname><given-names>M</given-names></name>. <article-title>Data processing for mass spectrometry-based metabolomics</article-title>. <source>Journal of chromatography A</source>. <year>2007</year><month>7</month><day>27</day>;<volume>1158</volume>(<issue>1–2</issue>):<fpage>318</fpage>–<lpage>28</lpage>. .<?supplied-pmid 17466315?><pub-id pub-id-type="pmid">17466315</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Keller</surname><given-names>BO</given-names></name>, <name><surname>Sui</surname><given-names>J</given-names></name>, <name><surname>Young</surname><given-names>AB</given-names></name>, <name><surname>Whittal</surname><given-names>RM</given-names></name>. <article-title>Interferences and contaminants encountered in modern mass spectrometry</article-title>. <source>Analytica chimica acta</source>. <year>2008</year><month>10</month><day>3</day>;<volume>627</volume>(<issue>1</issue>):<fpage>71</fpage>–<lpage>81</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2008.04.043</pub-id><?supplied-pmid 18790129?><pub-id pub-id-type="pmid">18790129</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Tolstikov</surname><given-names>VV</given-names></name>, <name><surname>Lommen</surname><given-names>A</given-names></name>, <name><surname>Nakanishi</surname><given-names>K</given-names></name>, <name><surname>Tanaka</surname><given-names>N</given-names></name>, <name><surname>Fiehn</surname><given-names>O</given-names></name>. <article-title>Monolithic silica-based capillary reversed-phase liquid chromatography/electrospray mass spectrometry for plant metabolomics</article-title>. <source>Analytical chemistry</source>. <year>2003</year><month>12</month><day>1</day>;<volume>75</volume>(<issue>23</issue>):<fpage>6737</fpage>–<lpage>40</lpage>. .<?supplied-pmid 14640754?><pub-id pub-id-type="pmid">14640754</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Lynn</surname><given-names>KS</given-names></name>, <name><surname>Cheng</surname><given-names>ML</given-names></name>, <name><surname>Chen</surname><given-names>YR</given-names></name>, <name><surname>Hsu</surname><given-names>C</given-names></name>, <name><surname>Chen</surname><given-names>A</given-names></name>, <name><surname>Lih</surname><given-names>TM</given-names></name>, <etal>et al</etal><article-title>Metabolite identification for mass spectrometry-based metabolomics using multiple types of correlated ion information</article-title>. <source>Analytical chemistry</source>. <year>2015</year><month>2</month><day>17</day>;<volume>87</volume>(<issue>4</issue>):<fpage>2143</fpage>–<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1021/ac503325c</pub-id><?supplied-pmid 25543920?><pub-id pub-id-type="pmid">25543920</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Werner</surname><given-names>E</given-names></name>, <name><surname>Heilier</surname><given-names>JF</given-names></name>, <name><surname>Ducruix</surname><given-names>C</given-names></name>, <name><surname>Ezan</surname><given-names>E</given-names></name>, <name><surname>Junot</surname><given-names>C</given-names></name>, <name><surname>Tabet</surname><given-names>JC</given-names></name>. <article-title>Mass spectrometry for the identification of the discriminating signals from metabolomics: current status and future trends</article-title>. <source>Journal of chromatography B, Analytical technologies in the biomedical and life sciences</source>. <year>2008</year><month>8</month><day>15</day>;<volume>871</volume>(<issue>2</issue>):<fpage>143</fpage>–<lpage>63</lpage>. <pub-id pub-id-type="doi">10.1016/j.jchromb.2008.07.004</pub-id><?supplied-pmid 18672410?><pub-id pub-id-type="pmid">18672410</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Nagao</surname><given-names>T</given-names></name>, <name><surname>Yukihira</surname><given-names>D</given-names></name>, <name><surname>Fujimura</surname><given-names>Y</given-names></name>, <name><surname>Saito</surname><given-names>K</given-names></name>, <name><surname>Takahashi</surname><given-names>K</given-names></name>, <name><surname>Miura</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Power of isotopic fine structure for unambiguous determination of metabolite elemental compositions: in silico evaluation and metabolomic application</article-title>. <source>Analytica chimica acta</source>. <year>2014</year><month>2</month><day>27</day>;<volume>813</volume>:<fpage>70</fpage>–<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2014.01.032</pub-id><?supplied-pmid 24528662?><pub-id pub-id-type="pmid">24528662</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4718670</article-id>
    <article-id pub-id-type="pmid">26784691</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0146112</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-15-32483</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>iMet-Q: A User-Friendly Tool for Label-Free Metabolomics Quantitation Using Dynamic Peak-Width Determination</article-title>
      <alt-title alt-title-type="running-head">iMet-Q: A User-Friendly Tool for Label-Free Metabolomics Quantitation</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chang</surname>
          <given-names>Hui-Yin</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Ching-Tai</given-names>
        </name>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lih</surname>
          <given-names>T. Mamie</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lynn</surname>
          <given-names>Ke-Shiuan</given-names>
        </name>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Juo</surname>
          <given-names>Chiun-Gung</given-names>
        </name>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hsu</surname>
          <given-names>Wen-Lian</given-names>
        </name>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sung</surname>
          <given-names>Ting-Yi</given-names>
        </name>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Bioinformatics Program, Taiwan International Graduate Program, Academia Sinica, Taipei 11529, Taiwan</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Institute of Biomedical Informatics, National Yang-Ming University, Taipei 11221, Taiwan</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Institute of Information Science, Academia Sinica, Taipei 11529, Taiwan</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Mathematics, Fu Jen Catholic University, New Taipei City 24205, Taiwan</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Molecular Medicine Research Center, Chang Gung University, Taoyuan 33302, Taiwan</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Bundy</surname>
          <given-names>Jacob Guy</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Imperial College London, UNITED KINGDOM</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con" id="contrib001">
        <p>Conceived and designed the experiments: H-YC T-YS. Performed the experiments: C-GJ. Analyzed the data: H-YC C-TC K-SL TML. Contributed reagents/materials/analysis tools: H-YC C-TC C-GJ. Wrote the paper: H-YC T-YS. Helped revise the manuscript: TML W-LH.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>tsung@iis.sinica.edu.tw</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>11</volume>
    <issue>1</issue>
    <elocation-id>e0146112</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>7</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>12</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2016 Chang et al</copyright-statement>
      <copyright-year>2016</copyright-year>
      <copyright-holder>Chang et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="pone.0146112.pdf"/>
    <abstract>
      <p>Efficient and accurate quantitation of metabolites from LC-MS data has become an important topic. Here we present an automated tool, called iMet-Q (<underline>i</underline>ntelligent <underline>Met</underline>abolomic <underline>Q</underline>uantitation), for label-free metabolomics quantitation from high-throughput MS1 data. By performing peak detection and peak alignment, iMet-Q provides a summary of quantitation results and reports ion abundance at both replicate level and sample level. Furthermore, it gives the charge states and isotope ratios of detected metabolite peaks to facilitate metabolite identification. An in-house standard mixture and a public Arabidopsis metabolome data set were analyzed by iMet-Q. Three public quantitation tools, including XCMS, MetAlign, and MZmine 2, were used for performance comparison. From the mixture data set, seven standard metabolites were detected by the four quantitation tools, for which iMet-Q had a smaller quantitation error of 12% in both profile and centroid data sets. Our tool also correctly determined the charge states of seven standard metabolites. By searching the mass values for those standard metabolites against Human Metabolome Database, we obtained a total of 183 metabolite candidates. With the isotope ratios calculated by iMet-Q, 49% (89 out of 183) metabolite candidates were filtered out. From the public Arabidopsis data set reported with two internal standards and 167 elucidated metabolites, iMet-Q detected all of the peaks corresponding to the internal standards and 167 metabolites. Meanwhile, our tool had small abundance variation (≤0.19) when quantifying the two internal standards and had higher abundance correlation (≥0.92) when quantifying the 167 metabolites. iMet-Q provides user-friendly interfaces and is publicly available for download at <ext-link ext-link-type="uri" xlink:href="http://ms.iis.sinica.edu.tw/comics/Software_iMet-Q.html">http://ms.iis.sinica.edu.tw/comics/Software_iMet-Q.html</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by Academia Sinica, Ministry of Science and Technology of Taiwan (MOST103-2221-E-001-037), and Taiwan International Graduate Program.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="2"/>
      <page-count count="18"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Two datasets, including a standard metabolite mixture and a public Arabidopsis dataset, were used in our study. The public Arabidopsis dataset is a third-party open data (not owned by the authors), and thus we provided a website link to the public data (PRIMe, <ext-link ext-link-type="uri" xlink:href="http://prime.psc.riken.jp/">http://prime.psc.riken.jp/</ext-link>). The standard metabolite mixture owned by the authors is now available under the DOI: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.6084/m9.figshare.2058702.v1">https://dx.doi.org/10.6084/m9.figshare.2058702.v1</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Two datasets, including a standard metabolite mixture and a public Arabidopsis dataset, were used in our study. The public Arabidopsis dataset is a third-party open data (not owned by the authors), and thus we provided a website link to the public data (PRIMe, <ext-link ext-link-type="uri" xlink:href="http://prime.psc.riken.jp/">http://prime.psc.riken.jp/</ext-link>). The standard metabolite mixture owned by the authors is now available under the DOI: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.6084/m9.figshare.2058702.v1">https://dx.doi.org/10.6084/m9.figshare.2058702.v1</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Unbiased quantitation and identification of small-molecule metabolites in a biological system is important because metabolites serve as direct signatures of biochemical activity, making them relatively easier to correlate with disease phenotype and more suitable for clinical diagnostics [<xref rid="pone.0146112.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0146112.ref008" ref-type="bibr">8</xref>]. Liquid chromatography coupled with mass spectrometry (LC-MS) has become a conventional platform for analyzing metabolites across a large number of biological samples because of its ability to measure thousands of metabolites in a short period of time [<xref rid="pone.0146112.ref002" ref-type="bibr">2</xref>, <xref rid="pone.0146112.ref005" ref-type="bibr">5</xref>, <xref rid="pone.0146112.ref009" ref-type="bibr">9</xref>–<xref rid="pone.0146112.ref013" ref-type="bibr">13</xref>]. However, it is a time-consuming process to manually calculate the abundances of thousands of metabolites from large-scale LC-MS data, and thus developing a software package to automatically quantify LC-MS metabolomics data becomes essential.</p>
    <p>Many commercial software programs have been developed by instrument vendors, such as Progenesis QI (Waters), MassHunter (Agilent), MultiQuant (Sciex), and Xcalibur (Thermo). But they usually accept data formats specific to their own instruments, and thus limit the possibility of integrating metabolite analyses across different analytical platforms [<xref rid="pone.0146112.ref014" ref-type="bibr">14</xref>–<xref rid="pone.0146112.ref017" ref-type="bibr">17</xref>]. Additionally, data processing algorithms implemented in these programs are mostly unavailable. Publicly available quantitation tools, on the other hand, accept multiple input data formats and provide description of their computational algorithms. For example, XCMS [<xref rid="pone.0146112.ref018" ref-type="bibr">18</xref>], MetAlign [<xref rid="pone.0146112.ref019" ref-type="bibr">19</xref>] and MZmine 2 [<xref rid="pone.0146112.ref020" ref-type="bibr">20</xref>] accept input formats such as mzXML, mzData, and netCDF. XCMS, implemented in R, C, and C++ programming language, provides format conversion, noise filtering, peak detection, non-linear spectral alignment algorithms, and statistical analysis of LC-MS data. MetAlign, an open interface-driven tool implemented in C++ programming language, provides format conversion, mass calculation, baseline correction, peak-picking, saturation and mass peak artifact filtering, as well as data set alignment. MZmine 2, a modular-based tool implemented in Java programming language, provides raw data import, raw data processing, peak detection, peak list alignment, normalization, visualization, peak identification, and statistical analysis.</p>
    <p>However, some concerns of these public tools have been reported. For instance, some tools combine binning with model fitting or use slope calculation approaches to perform peak detection, but these approaches may have low sensitivity on peak picking because the peak shapes vary greatly from one to another [<xref rid="pone.0146112.ref021" ref-type="bibr">21</xref>, <xref rid="pone.0146112.ref022" ref-type="bibr">22</xref>]. Due to different peak detection and peak alignment algorithms provided in each tool, it is difficult for users to optimize the algorithm-related parameters, which very likely affect the quantitation results [<xref rid="pone.0146112.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0146112.ref024" ref-type="bibr">24</xref>]. On the other hand, most of the tools do not provide deisotoping, and thus users have to apply additional packages, such as CAMERA [<xref rid="pone.0146112.ref025" ref-type="bibr">25</xref>], to perform isotope pattern assembly [<xref rid="pone.0146112.ref021" ref-type="bibr">21</xref>].</p>
    <p>To rectify the above concerns, we develop a quantitation tool, called iMet-Q (<underline>i</underline>ntelligent <underline>Met</underline>abolomic <underline>Q</underline>uantitation), written in C# programming language, which provides highly accurate quantitation and user-friendly graphical interfaces. For peak detection, iMet-Q requires one input parameter, i.e., mzWidth (defined as the width of a peak in m/z dimension), and calculates the full width at half maximum (FWHM) of a peak to dynamically determine its chromatographic width so that the peak boundary can be automatically determined (i.e., without requiring parameter input). In addition, our tool determines the charge state of a peak by calculating the similarity between the peak shape of monoisotope and the peak shape of the second isotope peak. Once the charge state is determined, iMet-Q calculates its isotope ratio (i.e., the ratio of the second isotope abundance to the monoisotope abundance) to facilitate metabolite identification. Since metabolites usually have smaller retention time drifts across LC-MS technical replicates, iMet-Q first aligns peaks across different LC-MS replicates of a sample and then across different samples. In each alignment, LOESS regression algorithm [<xref rid="pone.0146112.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0146112.ref027" ref-type="bibr">27</xref>] is applied to adjust peak retention time so that peaks in different LC-MS replicates/samples can be aligned according to their <italic>m/z</italic> and adjusted retention time values.</p>
    <p>We used two metabolite data sets, an in-house standard mixture and a public Arabidopsis metabolome data set [<xref rid="pone.0146112.ref028" ref-type="bibr">28</xref>], to evaluate the performance of iMet-Q and compare it with three public quantitation tools, including XCMS, MetAlign, and MZmine2. Since the standard mixture was acquired in profile mode, we evaluated the performance of the four tools in both profile and centroid data sets, in which the centroid data set was converted from the profile data set by the centroiding function of ProteoWizard [<xref rid="pone.0146112.ref029" ref-type="bibr">29</xref>]. As a result, iMet-Q had small quantitation error of 12% in both profile and centroid data sets. In addition, our tool correctly determined the charge state of seven standard metabolites, removed their isotope peaks, and calculated their isotope ratios. With the isotope ratios, we successfully filtered out 49% (89 out of 183) metabolite candidates when using mass values of these standard metabolites to search in Human Metabolome Database (HMDB) [<xref rid="pone.0146112.ref030" ref-type="bibr">30</xref>]. For the public Arabidopsis metabolome data set reported with two internal standards and 167 elucidated metabolites, iMet-Q detected the internal standards from all replicates and samples. In addition, all of the 167 metabolites were also detected by iMet-Q, whereas 103 (62%), 145 (87%), and 129 (77%) elucidated metabolites were detected by XCMS, MetAlign, and MZmine 2, respectively. Comparing with the three quantitation tools, iMet-Q had relatively small abundance variations (≤0.19) when quantifying the internal standards, and had higher abundance correlation (≥0.92) when quantifying the 167 metabolites across replicates. All data underlying the manuscript are fully available without restriction. The source code of iMet-Q is freely available on SourceForge (<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/imet-q/?source=navbar">http://sourceforge.net/projects/imet-q/?source=navbar</ext-link>) under the license of GPL2.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and Methods</title>
    <sec id="sec003">
      <title>Experiment on standard metabolite mixture</title>
      <sec id="sec004">
        <title>Chemicals</title>
        <p>All chemicals and solvents were purchased from Sigma Aldrich (St. Louis, MO, USA). The chemicals were all of analytical grade. Water containing 0.1% formic acid (solvent A), and acetonitrile containing 0.1% formic acid (solvent B) were of CHROMASOLV grade.</p>
      </sec>
      <sec id="sec005">
        <title>Sample preparation</title>
        <p>Stoke solution of metabolites was prepared as 1 mg/mL of 80% MeOH solution with 0.1% formic acid. Two metabolite mixtures, Sample 1 and Sample 2, were prepared by adding seven standard metabolites with different amount into two 1.7 mL vials. These standard metabolites were L-histidine (3 μL in Sample 1, 6μL in Sample 2), L-carnosine (50μL in Sample 1, 50μL in Sample 2), creatine (6μL in Sample 1, 6μL in Sample 2), caffeine (6μL in Sample 1, 6μL in Sample 2), hippuric acid (5μL in Sample 1, 25μL in Sample 2), glycocholic acid (2μL in Sample 1, 10μL in Sample 2), and cholic acid (2μL in Sample 1, 6μL in Sample 2). The solutions were dried with SpeedVac and re-dissolved by 100 L of MeOH and water (2:1, v/v) with 0.1% formic acid.</p>
      </sec>
      <sec id="sec006">
        <title>UPLC/LTQ-Orbitrap MS</title>
        <p>A UPLC system (Acquity, Waters, Milford, MA, USA) equipped with a C18 reversed-phase column (2.1 × 100 mm, 1.8 m, HSS-T3; Waters, Milford, MA, USA) was coupled with a LTQ-Orbitrap mass spectrometer (Thermo Scientific, San Jose, CA, USA) with an orthogonal electrospray ionization (ESI) source. The initial flow rate was 0.1 mL/min of 99% solvent A (0.1% formic acid) and 1% solvent B (acetonitrile with 0.1% formic acid). A volume of 1μL of Sample 1 and Sample 2 were sequentially injected, and 6 technical replicates were conducted in profile mode on each standard mixture. After injection, solvent B was maintained at 1% for 5 min, then increased to 50% during a time span of 9 min, then to 90% over 6 min, and finally to 99% over a period of 12 min after which this percent composition was held for 1 min. The flow rate was changed to 0.5 mL/min, and after 5 min reduced to 0.1mL/min. After 0.1 min, solvent B was reduced back to 1% and held at this percentage for 7 min.</p>
        <p>The mass spectrometer was controlled by using Xcalibur 2.0.7 software (Thermo Scientific) and operated in positive ion mode on the <italic>m/z</italic> range from 120 to 1,000 with 60,000 resolution at <italic>m/z</italic> 400. The source and capillary voltages were set to 4500 and 35 V, and the temperatures of the capillary and the APCI vaporizer were set to 275°C and 150°C. Internal calibration was performed using the ion signal of dioctyl phthalate at <italic>m/z</italic> 391.28 as a lock mass.</p>
      </sec>
    </sec>
    <sec id="sec007">
      <title>Public Arabidopsis metabolome data set</title>
      <p>A public Arabidopsis metabolome data set of 36 samples acquired by LC-ESI-Q-TOF/MS (HPLC: Waters Acquity UPLC system; MS: Waters Q-TOF Premier) in positive- and negative-ion modes, with four technical replicates on each sample, was downloaded from the website of PRIMe (<ext-link ext-link-type="uri" xlink:href="http://prime.psc.riken.jp/">http://prime.psc.riken.jp/</ext-link>). All replicates of the Arabidopsis metabolome data set were acquired in centroid mode. Two internal standards, lidocaine (<italic>m/z</italic> = 235 [M+H]+, eluted at 4.19 min in the positive-ion mode data) and camphor-10-sulfonic acid (<italic>m/z</italic> = 231 [M-H]-, eluted at 3.84min in the negative-ion mode data) were spiked in each sample with the same amount of 0.5 mg/L for abundance normalization and 167 metabolites were elucidated from this data set [<xref rid="pone.0146112.ref031" ref-type="bibr">31</xref>, <xref rid="pone.0146112.ref032" ref-type="bibr">32</xref>].</p>
    </sec>
    <sec id="sec008">
      <title>Data processing and software parameter settings</title>
      <p>Data processing was performed on a Microsoft Windows 7 computer (x64 edition service pack 1 with an Intel Xeon E5-2630 processor, 16 GB RAM and 500GB hard disk drive). All raw data files of the standard mixture experiment and the public data set were converted into mzXML format using ProteoWizard. The acquired profile-mode data of standard mixture experiment was converted into two data sets, where one data set was directly converted to mzXML files (called <italic>profile data set</italic> for convenience) and the other was converted to mzXML files with an additional centroiding procedure in ProteoWizard (called <italic>centroid data set</italic> for convenience). Since the public data was acquired in centroid mode, no additional centroiding procedure in ProteoWizard was performed.</p>
      <p>Both profile and centroid data sets of standard mixture were processed by four tools. iMet-Q automatically skipped centroiding step when processing the centroid data set and used the following parameter setting: mzWidth = 0.02, mzTol = 0.02, and rtTol = 0.2 for both data sets. For XCMS, peaks in the profile and centroid data sets were first detected using <italic>matchedFilter</italic> and c<italic>entWave</italic> function, respectively. Then the <italic>rector</italic>.<italic>loess</italic> and <italic>group</italic>.<italic>density</italic> functions were then applied to align the detected peaks across samples. An additional <italic>fillPeaks</italic> fuction was performed for the recovery of missing peaks as suggested by the package vignette of XCMS. To optimize the XCMS parameters, 42 parameter combinations were examined using the standard metabolites in the standard mixture as benchmarks. The examination results of the 42 parameter combinations are listed in <xref rid="pone.0146112.s006" ref-type="supplementary-material">S1</xref> and <xref rid="pone.0146112.s007" ref-type="supplementary-material">S2</xref> Tables, and the quantitation results generated using those parameter combinations are provided in <xref rid="pone.0146112.s001" ref-type="supplementary-material">S1</xref> and <xref rid="pone.0146112.s002" ref-type="supplementary-material">S2</xref> Files. The optimized XCMS parameters on peak picking are: method = matchedFilter, fwhm = 30, snthresh = 10 for profile dataset; and method = centWave, ppm = 45, snthresh = 10, peakwidth = (5,20) for centroid dataset. The optimized XCMS parameters for both profile and centroid data sets on retention time correction and peak grouping are: method = loess, span = .67; and method = "density", mzwid = 0.03, bw = 3, minfrac = 0, minsamp = 0. MetAlign only accepts and processes the centroid data set. To run MetAlign, we selected the data type of accurate mass data with mass resolution of 10,000 and applied the default settings for the remaining parameters. In MZmine 2, the <italic>exact mass detector</italic> function and the <italic>centroid mass detector</italic> function were first applied to process the profile and centroid data sets, respectively, both with a noise level of 1,000,000. Then the following functions were applied using the same parameters to process both data sets. The chromatogram builder was used with the minimum time span, minimum height, and <italic>m/z</italic> tolerance set to be 0, 0 and 0.02, respectively. For chromatogram deconvolution, baseline cut-off algorithm was used to detect peaks, where the minimum peak height, peak duration length, and baseline level were 1,000,000, 0–2 min, and 1,000,000, respectively. The <italic>m/z</italic> and retention time tolerances in both isotopic peaks grouper and peak alignment were 0.02 and 0.2 min, respectively.</p>
      <p>Public Arabidopsis data set was processed by iMet-Q with mzWidth, mzTol, and rtTol of 0.03, 0.03, and 0.16 min, respectively. We used the XCMS c<italic>entWave</italic> function for peak detection, <italic>rector</italic>.<italic>loess</italic> and <italic>group</italic>.<italic>density</italic> functions for peak alignment, and <italic>fillPeaks</italic> function for the recovery of missing peaks. To optimize XCMS parameters on the public Arabidopsis positive- and negative-mode data sets, 37 parameter combinations were examined on each set and the parameter combination achieving the best quantitation performance was selected. The examination results of the parameter combinations are listed in <xref rid="pone.0146112.s008" ref-type="supplementary-material">S3</xref> and <xref rid="pone.0146112.s009" ref-type="supplementary-material">S4</xref> Tables, and the quantitation results generated using those parameter combinations are provided in <xref rid="pone.0146112.s003" ref-type="supplementary-material">S3</xref> and <xref rid="pone.0146112.s004" ref-type="supplementary-material">S4</xref> Files. Both data sets used centWave method in peak picking and the optimized XCMS parameters for Arabidopsis positive- and negative-mode datasets are: ppm = 30, snthresh = 10, peakwidth = (25, 40); and ppm = 20, snthresh = 10, peakwidth = (5, 20), respectively. Next, in retention time correction and peak grouping, the optimized XCMS parameters for both profile and centroid data sets are: method = loess, span = .67; and method = "density", mzwid = 0.03, bw = 3, minfrac = 0, minsamp = 0. For MetAlign, we selected the data type of accurate mass data with mass resolution of 9,000 and applied the following parameter settings for data processing: maximum amplitude = 10,000, peak slope factor = 1, peak threshold factor = 6, average peak width at half weight = 8, maximum shift per scan = 35, select min nr per peak set = 4, and scaling options = none. In MZmine 2, we used the centroid mass detector with a noise level of 6. The minimum time span, minimum height, and <italic>m/z</italic> tolerance in the chromatogram builder were set to be 0.1 min, 6 and 0.03, respectively. For chromatogram deconvolution, baseline cut-off algorithm was used to detect peaks, where the minimum peak height, peak duration length, and baseline level were 6, 0–1.6 (min), and 6, respectively. The <italic>m/z</italic> and retention time tolerances in both isotopic peaks grouper and peak alignment were 0.03 and 0.16 min, respectively. Detected peaks by each tool were retained in the quantitation results if their retention time values were within the effective retention time range (i.e., 0.85 to 12 min) and the peaks were detected in at least one sample.</p>
    </sec>
    <sec id="sec009">
      <title>Robust algorithms for metabolite quantitation</title>
      <p>In order to process data from various mass spectrometers, iMet-Q accepts input files in netCDF, mzXML, and mzML formats, which can be conveniently converted from raw data by existing converters. Also, it accepts profile-mode and centroid-mode data. The workflow of iMet-Q contains two main tasks, peak detection and peak alignment, as depicted in <xref rid="pone.0146112.g001" ref-type="fig">Fig 1</xref>. Performing peak detection on each input file generates a peak list that reports the <italic>m/z</italic>, retention time, charge state, isotope ratio, and abundance of detected peaks. To compare compounds across different samples, iMet-Q aligns the detected peaks in the peak lists according to their <italic>m/z</italic> and retention time. The detailed procedures of peak detection, peak alignment and quantitation result generation are described below.</p>
      <fig id="pone.0146112.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Schematic depiction of iMet-Q workflow for peak detection and peak alignment.</title>
        </caption>
        <graphic xlink:href="pone.0146112.g001"/>
      </fig>
    </sec>
    <sec id="sec010">
      <title>Peak Detection</title>
      <sec id="sec011">
        <title>Centroiding signals in each scan</title>
        <p>Centroiding, which can be performed during or after data acquisition, is a common first step for processing metabolomics data so that the data size can be greatly reduced. It aims at combining multiple signals from the same compound into a single one with an <italic>m/z</italic> and intensity value [<xref rid="pone.0146112.ref032" ref-type="bibr">32</xref>]. If the input files have already been centroided, iMet-Q automatically skips this step. The detailed algorithm description is listed in <xref rid="pone.0146112.s005" ref-type="supplementary-material">S1 Section</xref>.</p>
      </sec>
      <sec id="sec012">
        <title>Removing noises from each scan</title>
        <p>Due to nonspecific nature of ESI, a great portion of signals in the spectra could be noise [<xref rid="pone.0146112.ref033" ref-type="bibr">33</xref>]. It is essential to remove these noises to increase the effectiveness of peak detection. Instead of determining a fixed baseline for each spectrum, iMet-Q equally divides a scan into <italic>s</italic> segments (<italic>s</italic> = 10 by default) with an overlap of 20% to avoid borderline issues and defines the average intensity in a segment as its noise level. Then, for each segment, signals with S/N less than a specific threshold (3 by default) are removed from the scan, where S is the signal intensity and N is the noise level in the segment. The number of segments and the S/N threshold are user-adjustable.</p>
      </sec>
      <sec id="sec013">
        <title>Constructing extracted ion chromatograms (EIC) with dynamically determining peak width</title>
        <p>After processing signals in each scan, iMet-Q uses a two-stage algorithm to construct the extracted ion chromatogram (EIC) of a compound. The two-stage algorithm includes signal clustering and EIC boundary determination. Let <inline-formula id="pone.0146112.e001"><alternatives><graphic xlink:href="pone.0146112.e001.jpg" id="pone.0146112.e001g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>}</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> be the list of signals in all scans, where <italic>m</italic> is the total number of scans and <italic>n</italic><sub><italic>k</italic></sub> is the number of signals in the <italic>k</italic><sup>th</sup> scan. In signal clustering, starting from the most intensive signal, say <inline-formula id="pone.0146112.e002"><alternatives><graphic xlink:href="pone.0146112.e002.jpg" id="pone.0146112.e002g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, among all scans in <italic>S</italic>, iMet-Q clusters signals in <italic>S</italic> with <inline-formula id="pone.0146112.e003"><alternatives><graphic xlink:href="pone.0146112.e003.jpg" id="pone.0146112.e003g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> if the <italic>m/z</italic> differences between the signals and <inline-formula id="pone.0146112.e004"><alternatives><graphic xlink:href="pone.0146112.e004.jpg" id="pone.0146112.e004g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are within the given tolerance <italic>d</italic>, i.e., mzWidth in iMet-Q. A cluster with at least three signals is further processed. In the step of EIC boundary determination, iMet-Q automatically calculates FWHM and then dynamically determines the boundaries using FWHM. To be specific, for the most intensive signal in a cluster, say <inline-formula id="pone.0146112.e005"><alternatives><graphic xlink:href="pone.0146112.e005.jpg" id="pone.0146112.e005g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, with retention time <italic>t</italic>, the boundaries of the EIC are initially determined as <italic>t</italic> ± <italic>w</italic>, where <italic>w</italic> is the FWHM. To adapt to possible tailing effect of an EIC, the boundaries are further extended by a tolerance at most 0.5<italic>w</italic> and are set to the farthest signal or a signal with local-minimum intensity in this range (as shown in <xref rid="pone.0146112.g002" ref-type="fig">Fig 2</xref>). Then the trapezoid areas between any two adjacent signals of the EIC are summed up as the abundance. The two-stage algorithm is iteratively performed on the remaining unclustered signals to construct EICs until all signals in <italic>S</italic> are processed. In the following subsections, we term the constructed EICs as peaks for convenience. Furthermore, each peak is represented by its apex, i.e., using the m/z, retention time of the apex signal, and the associated abundance is recorded.</p>
        <fig id="pone.0146112.g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>A cartoon for the illustration of constructing extracted ion chromatograms.</title>
            <p>The blue straight lines represent the clustered signals, <italic>w</italic> and <italic>t</italic> are the FWHM and retention time of <inline-formula id="pone.0146112.e006"><alternatives><graphic id="pone.0146112.e006g" xlink:href="pone.0146112.e006"/><mml:math id="M6"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, respectively. Signal A and B are determined as the boundaries of the EIC, and the area in light blue color is the abundance.</p>
          </caption>
          <graphic xlink:href="pone.0146112.g002"/>
        </fig>
      </sec>
      <sec id="sec014">
        <title>Determining the charge state and isotope ratio of peaks</title>
        <p>In order to determine the charge state and isotope ratio, iMet-Q first constructs an isotope envelope for a peak. Starting from the most intensive peak, <italic>P</italic><sub><italic>1</italic></sub>, in the current peak list, our tool groups it with all of its neighboring peaks having larger <italic>m/z</italic> values and decreasing intensities, i.e., forming an isotope group. If the <italic>m/z</italic> distance between the apex of any two peaks in the isotope group equals to 1/<italic>z</italic> (<italic>z</italic> can be 1~4), the group is considered as a possible isotope envelope, where <italic>P</italic><sub><italic>1</italic></sub> and the peak adjacent to <italic>P</italic><sub><italic>1</italic></sub> are considered as the monoisotope peak and the second isotope peak, respectively. Then, to validate the correctness of the isotope envelope, iMet-Q calculates the peak shape similarity between the monoisotope peak and the second isotope peak by using the dot product as shown below:
<disp-formula id="pone.0146112.e007"><alternatives><graphic xlink:href="pone.0146112.e007.jpg" id="pone.0146112.e007g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic>n</italic> is the number of scans that both the monoisotope peak and the second isotope peak co-occur, and <italic>x</italic><sub><italic>i</italic></sub> and <italic>y</italic><sub><italic>i</italic></sub> are their respective signal intensities in the <italic>i</italic><sup>th</sup> scan. If the peak shape similarity between the two peaks is above a user-defined threshold (0.8 by default), we consider that all of the peaks in the isotope group form an isotope envelope and the charge state of <italic>P</italic><sub>1</sub> is determined as <italic>z</italic>. Moreover, the isotope ratio of <italic>P</italic><sub><italic>1</italic></sub> is calculated as the abundance of the second isotope peak divided by the abundance of <italic>P</italic><sub><italic>1</italic></sub>, and the peaks in the isotope group are removed from further processing. Otherwise, the peaks do not form an isotope envelope and the charge state and isotope ratio of <italic>P</italic><sub><italic>1</italic></sub> are denoted as 0. The charge state determination procedure is repeatedly performed until all peaks are processed.</p>
        <p>By performing the above peak detection procedures, iMet-Q generates a peak list with charge state and isotope ratio information for each input replicate file. Note that the isotope peaks except the monoisotope in the confirmed isotope envelopes will not be reported in the peak list.</p>
      </sec>
    </sec>
    <sec id="sec015">
      <title>Peak Alignment</title>
      <p>For an input data set with multiple samples (each probably with multiple technical replicates), iMet-Q performs the same algorithm for pair-wise alignment within a sample (i.e., aligning replicates) and then across samples. The algorithm is described as follows.</p>
      <p>iMet-Q first selects the peak list that contains the largest number of detected peaks as the reference list and aligns other peak lists to it. For a pair of reference list and aligning peak list, iMet-Q uses peaks detected in both lists with their <italic>m/z</italic> and retention time differences within user-defined tolerances (i.e., mzTol and rtTol in iMet-Q) as landmarks [<xref rid="pone.0146112.ref034" ref-type="bibr">34</xref>]. Given the retention time of landmarks in the reference list and in the aligning peak list as vectors A and B, respectively, iMet-Q uses LOESS regression [<xref rid="pone.0146112.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0146112.ref027" ref-type="bibr">27</xref>] to generate a mapping between A and B with span of 20% and weight of 1 since LOESS regression combines multiple linear least square regression models which fit localized subsets of the data. The retention time of peaks, which are not landmarks, in either peak list are adjusted according to the LOESS regression model. iMet-Q then aligns the peaks in both peak lists that satisfy user-defined <italic>m/z</italic> tolerance and retention time tolerance based on adjusted retention time.</p>
      <p>Repeating the above process for all peak lists, peaks can be aligned across replicates. Since peaks aligned from different replicates in a sample may have slightly different values of <italic>m/z</italic> and retention time, we use the <italic>median</italic> of their <italic>m/z</italic> and retention time as the representative peak in each sample. Then the same algorithm is applied to align all of the representative peaks across samples.</p>
    </sec>
    <sec id="sec016">
      <title>Generating output of quantitation results</title>
      <p>In addition to viewing quantitation results in the main interface, iMet-Q reports the medians of <italic>m/z</italic>, retention time and abundance of the peaks in all replicates of all samples. For the charge state of an aligned peak, iMet-Q displays the charge state that is detected in most replicates. For the isotope ratio, iMet-Q collects the isotope ratios corresponding to the displayed charge state and reports the median as the isotope ratio. Quantitation results can be exported in.csv and.txt formats by users to conduct further analyses.</p>
    </sec>
  </sec>
  <sec id="sec017">
    <title>Results and Discussion</title>
    <p>We evaluated the performance of iMet-Q in metabolite quantitation by comparing the accuracy of detecting metabolites and the abundance consistency, calculated by Pearson product-moment correlation coefficient (PPMCC), of detected metabolites among replicates with XCMS, MetAlign, and MZmine 2 using samples ranging from a small standard data set (seven standard metabolites) to a complex biological data set (public Arabidopsis data set). We also demonstrated the ability of iMet-Q on charge state determination and isotope ratio calculation.</p>
    <sec id="sec018">
      <title>Performance evaluation on a standard metabolite mixture data</title>
      <p>To demonstrate the ability of iMet-Q, we used a standard metabolite mixture in which seven standard metabolites with different sample concentration in two samples were included for evaluation. The sample ratio, defined as the detected abundance of a standard metabolite in Sample 1 divided by that in Sample 2, is calculated for each of the seven metabolites in the standard metabolite mixture for the four quantitation tools. Both profile and centroid data sets generated from the raw data were processed by iMet-Q, XCMS, MetAlign, and MZmine 2, respectively. Algorithms and parameter settings used in these tools were described in the subsection of <italic>Data Processing and Software Parameter Settings</italic>. <xref rid="pone.0146112.t001" ref-type="table">Table 1</xref> shows the quantitation errors, which is defined as the difference between theoretical and calculated sample ratios divided by the theoretical sample ratios, of the seven standard metabolites calculated by the four quantitation tools. Detailed abundances and sample ratios calculated by the four tools are listed in <xref rid="pone.0146112.s010" ref-type="supplementary-material">S5 Table</xref>.</p>
      <table-wrap id="pone.0146112.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>The quantitation error (%) of seven standard metabolites calculated by iMet-Q, XCMS, MetAlign, and MZmine 2.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0146112.t001g" xlink:href="pone.0146112.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1"/>
                <th colspan="8" align="center" rowspan="1">Quantitation error (%)<xref rid="t001fn001" ref-type="table-fn"><sup>a</sup></xref></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1"/>
                <th colspan="2" align="center" rowspan="1">iMet-Q</th>
                <th colspan="2" align="center" rowspan="1">XCMS</th>
                <th colspan="2" align="center" rowspan="1">MetAlign</th>
                <th colspan="2" align="center" rowspan="1">MZmine 2</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">Standard Compound</th>
                <th align="center" rowspan="1" colspan="1">Theoretical Sample Ratio</th>
                <th align="center" rowspan="1" colspan="1">Profile</th>
                <th align="center" rowspan="1" colspan="1">Centroid</th>
                <th align="center" rowspan="1" colspan="1">Profile</th>
                <th align="center" rowspan="1" colspan="1">Centroid</th>
                <th align="center" rowspan="1" colspan="1">Profile</th>
                <th align="center" rowspan="1" colspan="1">Centroid</th>
                <th align="center" rowspan="1" colspan="1">Profile</th>
                <th align="center" rowspan="1" colspan="1">Centroid</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">L-hisitidine</td>
                <td align="center" rowspan="1" colspan="1">0.50</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">12</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">L-Carnosine</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">9</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="center" rowspan="1" colspan="1">7</td>
                <td align="center" rowspan="1" colspan="1">50</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">11</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="center" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Creatine</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">18</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">11</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Caffine</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">16</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">16</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Hippuric acid</td>
                <td align="center" rowspan="1" colspan="1">0.20</td>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">105</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">20</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Glycocholic acid</td>
                <td align="center" rowspan="1" colspan="1">0.20</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">30</td>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="center" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Cholic acid</td>
                <td align="center" rowspan="1" colspan="1">0.33</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">24</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">24</td>
                <td align="center" rowspan="1" colspan="1">24</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">Average</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">32</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">13</td>
                <td align="center" rowspan="1" colspan="1">14</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p><sup>a</sup>Quantitation error (%) = (|Theoretical Sample Ratio–Calculated Sample Ratio|) x100/ Theoretical Sample Ratio.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>As shown in <xref rid="pone.0146112.t001" ref-type="table">Table 1</xref>, iMet-Q, XCMS, and MZmine 2 had the average quantitation error of 12%, 12% and 13% on the profile data set, and 12%, 32% and 14% on the centroid data set. MetAlign did not process the profile data set and had the average quantitation error of 14% on the centroid data set. The results showed that iMet-Q achieved the smallest quantitation errors and also had the same average quantitation error of 12% in both profile and centroid data set, suggesting the robustness of iMet-Q on processing input files in both data type.</p>
      <p>In addition to accurate quantitation, iMet-Q determined the charge state and isotope ratio of detected peaks. In order to evaluate the charge state determined by iMet-Q, we used CAMERA to annotate charge states and isotope peaks of the standard metabolites. Charge states and isotope peaks of the seven standard metabolites in both profile and centroid data sets annotated by iMet-Q were overall identical with CAMERA’s annotation.</p>
      <p>To demonstrate possible usefulness of isotope ratio information, we searched the mass of seven standard metabolites against HMDB [<xref rid="pone.0146112.ref030" ref-type="bibr">30</xref>] with mass tolerance of ±5 ppm and adduct type of unknown (assuming a user has little information on the spectra). As a result, 183 metabolites candidates were obtained. Using iMet-Q’s calculated isotope ratios (the isotope ratio tolerance is ±0.02) to filter out unnecessary metabolite candidates, we reduced 49% (89 out of 183) metabolite candidates (<xref rid="pone.0146112.s011" ref-type="supplementary-material">S6 Table</xref>). The remaining metabolite candidates could not be filtered out by isotope ratios because they have the same chemical formula (i.e., identical theoretical isotope ratios).</p>
    </sec>
    <sec id="sec019">
      <title>Performance evaluation on a public Arabidopsis metabolome data</title>
      <p>The public Arabidopsis data of 36 distinct samples collected from eight different plant classes (classified by Matsuda <italic>et al</italic>.) was used to demonstrate iMet-Q’s performance on quantifying complex biological samples. Each sample contained two internal standards, one for positive- and the other for negative-ion modes, and 167 metabolites (71 detected only in positive-ion mode, 39 only in negative-ion mode, and 57 in both modes) were elucidated from the data set [<xref rid="pone.0146112.ref028" ref-type="bibr">28</xref>]. The performance of four tools were evaluated in terms of the accuracy on detecting the two internal standards and 167 elucidated metabolites, and the ability of properly clustering 36 samples into eight plant classes.</p>
      <p><xref rid="pone.0146112.t002" ref-type="table">Table 2</xref> shows the reproducibility and normalized abundances of two internal standards detected by the four quantitation tools, where iMet-Q, XCMS, and MetAlign detected all the internal standards from each replicate, achieving 100% reproducibility, slightly better than MZmine 2. Furthermore, iMet-Q reported normalized abundances of 1±0.19 and 1±0.18 for the two standard metabolites, comparable to the best 1±0.18 reported by XCMS and MZmine 2 for Lidocaine and the best 1±0.17 reported by XCMS for Camphor-10-sulfonic acid.</p>
      <table-wrap id="pone.0146112.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>The reproducibility (Rep.) and normalized abundance (Abund.) of two internal standards detected by four quantitation tools.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0146112.t002g" xlink:href="pone.0146112.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th colspan="2" align="center" rowspan="1">Lidocaine</th>
                <th colspan="2" align="center" rowspan="1">Camphor-10-sulfonic acid</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">Rep. (%)</th>
                <th align="center" rowspan="1" colspan="1">Abund.</th>
                <th align="center" rowspan="1" colspan="1">Rep. (%)</th>
                <th align="center" rowspan="1" colspan="1">Abund.</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">iMet-Q</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.19</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.18</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">XCMS</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.18</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.17</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">MetAlign</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.20</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.22</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">MZmine 2</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.18</td>
                <td align="center" rowspan="1" colspan="1">85</td>
                <td align="center" rowspan="1" colspan="1">1±0.46</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>For 167 elucidated metabolites, we searched their <italic>m/z</italic> and retention time values provided in [<xref rid="pone.0146112.ref028" ref-type="bibr">28</xref>] against the quantitation results of the four tools with m/z and retention time tolerances of 0.05 m/z and 9 seconds. As a result, iMet-Q detected all of the elucidated metabolites, whereas XCMS, MetAlign, and MZmine 2 detected 103 (62%), 145 (87%), and 129 (77%) of the elucidated metabolites, respectively. We further evaluated the detected abundance of these metabolites. Since the exact abundance of 167 elucidated metabolites was unknown, we calculated the abundance correlation between any two replicates of a sample by PPMCC. As a result, iMet-Q achieved an average replicate abundance correlation of 0.92, whereas XCMS, MetAlign, and MZmine 2 achieved average abundance correlations of 0.87, 0.78, and 0.81, respectively (as shown in <xref rid="pone.0146112.g003" ref-type="fig">Fig 3</xref>). The result revealed that iMet-Q not only achieved high accuracy on detecting the 167 elucidated metabolites but also provided very consistent quantitation result.</p>
      <fig id="pone.0146112.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>The box plot of abundance correlation of 167 elucidated metabolites across replicates in the public Arabidopsis data detected by the four quantitation tools.</title>
        </caption>
        <graphic xlink:href="pone.0146112.g003"/>
      </fig>
      <p>Next, we examined whether replicates of the 36 samples could be properly clustered into eight plant classes using the quantitation results of the four tools. We combined the quantitation results from positive- and negative-ion modes, and performed hierarchical clustering using MATLAB <italic>dendrogram</italic> function with PPMCC as the abundance correlation measure. The combined quantitation results of the four tools are provided in <xref rid="pone.0146112.s012" ref-type="supplementary-material">S7</xref>–<xref rid="pone.0146112.s015" ref-type="supplementary-material">S10</xref> Tables. The numbers of detected peaks in the combined quantitation results of iMet-Q, XCMS, MetAlign, and MZmine 2 were 13079, 7487, 37364, and 19394, respectively. <xref rid="pone.0146112.g004" ref-type="fig">Fig 4</xref> shows the hierarchical clustering results of the four tools. The average abundance correlations of the eight plant classes using the combined quantitation results of iMet-Q, XCMS, MetAlign, and MZmine 2 were 0.71, 0.75, 0.65, and 0.59, respectively. The detailed average abundance correlation of each plant class is shown in <xref rid="pone.0146112.s016" ref-type="supplementary-material">S11 Table</xref>. Note that all the replicates of flower class, the best clustered plant class (blue color in <xref rid="pone.0146112.g004" ref-type="fig">Fig 4</xref>), were clustered using iMet-Q’s combined quantitation result, and the average abundance correlation of the flower class was 0.88. This evaluation implies that, although the numbers of peaks detected by MetAlign and MZmine 2 were much larger than those detected by iMet-Q and XCMS, peaks detected by iMet-Q and XCMS might be more essential for distinguishing plant classes.</p>
      <fig id="pone.0146112.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Hierarchical clustering by using the quantitation results of iMet-Q, XCMS, MetAlign, and MZmine 2.</title>
          <p>Each entry in the tree leaves of a dendrogram represents a replicate. For each tool, we first combined its quantitation results of positive- and negative-ion modes. Colors were assigned to each replicate in the combined quantitation results according to the plant classes which the replicates originated from as follows: orange for cotyledon, red for stem, green for leaf, blue for flower, light blue for shoot apex, yellow for root, pink for seed, and gray for silique. Next, the figure was produced using MATLAB <italic>dendrogram</italic> function with PMMCC as the abundance correlation measure between any two replicates in the combined quantitation results.</p>
        </caption>
        <graphic xlink:href="pone.0146112.g004"/>
      </fig>
      <p>To overcome the bottleneck in metabolite identification based on MS1 data, a method utilizing both isotope ratio and in-source fragment information has been recently proposed, in which the same Arabidopsis metabolome data set was also used for identification performance evaluation [<xref rid="pone.0146112.ref035" ref-type="bibr">35</xref>]. According to the study, 19 out of 167 elucidated metabolites have been confirmed that some of their in-source fragments were detected in MS1 scans [<xref rid="pone.0146112.ref035" ref-type="bibr">35</xref>], and the abundance correlations between the 19 metabolites and their fragments were above 0.8. We thus used the 19 confirmed metabolites to demonstrate the ability of iMet-Q. By calculating the abundance correlations between 19 metabolites and their in-source fragments, iMet-Q reported an abundance correlation of 0.94, whereas XCMS, MetAlign, and MZmine 2 reported abundance correlations of 0.61, 0.76, and 0.66, respectively (as shown in <xref rid="pone.0146112.g005" ref-type="fig">Fig 5</xref>). This result revealed that the abundances of the 19 metabolites and their in-source fragments were accurately detected and calculated by iMet-Q. Furthermore, isotope ratios of 89.47% (17 out of 19) metabolites were accurately calculated by iMet-Q, with differences within 0.05 to the theoretical ratio (<xref rid="pone.0146112.s017" ref-type="supplementary-material">S12 Table</xref>).</p>
      <fig id="pone.0146112.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>The box plot of abundance correlations between 19 verified metabolites and their in-source fragments detected in the public Arabidopsis data.</title>
        </caption>
        <graphic xlink:href="pone.0146112.g005"/>
      </fig>
    </sec>
    <sec id="sec020">
      <title>Friendly User Interfaces of iMet-Q</title>
      <p>We particularly implemented iMet-Q as a project-oriented quantitation platform, allowing users to conveniently quantify, manage and compare a large number of data sets or quantitation results in Microsoft Windows series platform (including Windows 7, 8, and Windows Server 2008, 2012). To be specific, iMet-Q applies a tree structure to organize quantitation results, where each node represents a project and sub-nodes of a project represent the quantitation results (as shown in <xref rid="pone.0146112.g006" ref-type="fig">Fig 6</xref>).</p>
      <fig id="pone.0146112.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>The main graphical user interface of Metab-Q.</title>
          <p>The Arabidopsis data from positive-ion mode is used as an example. After processing the data, Metab-Q lists the detected peaks in the summary table where the peaks are sorted according to their retention time. When users select peaks of interest in the summary table, the abundances of the selected peaks in different samples are plotted in the sample abundance plot and the detailed information of the selected peak in the technical replicates of a sample is listed in the panel below the summary table. The left panel is the quantitation parameter explorer that lists the parameters of a quantitation. Users can use the provided filter function to narrow down the number of peaks in the summary table.</p>
        </caption>
        <graphic xlink:href="pone.0146112.g006"/>
      </fig>
      <p>iMet-Q provides three wizards to guide users easily executing the program as follows. First, a <italic>project wizard</italic> guides a user to create a project and designate a folder to store the project. Second, a <italic>quantitation wizard</italic> guides the user to quantify LC-MS-based data. The wizard only requires the user to set up three quantitation parameters, i.e., mzWidth, mzTol, and rtTol; other parameters are optional. Since multiple technical replicates may be conducted on a sample, iMet-Q pops up a table to guide users to group technical replicates by the sample. During quantitation, iMet-Q sequentially detects peaks from each replicate and then aligns those detected peaks across replicates/samples. Third, an <italic>export wizard</italic> guides the user to export quantitation results in common output formats, including.csv and.txt. It also allows users to name the quantitation, designate the file for exporting, and set up criteria for filtering out unwanted peaks in order to focus on peaks of interest. With the conventional output formats, the user can easily import the quantitation results to other available tools, such as Microsoft Excel and Matlab, for further statistical analysis.</p>
      <p>To compare abundances across samples, iMet-Q hierarchically displays a quantitation result in the main interface, where the quantitation result is summarized in a summary table. The summary table lists the <italic>m/z</italic>, retention time, charge state, isotope ratio, and abundance of all detected peaks in all samples for a quick overview. The user can click on a detected peak of interest in the summary table, and the sample abundances of the selected peak will be plotted in the upper panel above the summary table. Meanwhile, the detailed information of the selected peak in the technical replicates of a sample will be listed in the panel below the summary table. The user can double-click a row in the replicate table to view the extracted ion chromatogram of the peak. In order to efficiently select peaks of interest in the summary table, iMet-Q provides a search function using the range of <italic>m/z</italic>, retention time, charge state, or isotope ratio to narrow down the peaks listed in the summary table.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec021">
    <title>Conclusions</title>
    <p>Many state-of-the-art quantitation tools have been proposed to allow users automatically quantifying metabolites from large-scale label-free metabolomics data sets. The quantitation ability of these tools is beyond doubt. However, a major concern of using these tools is the parameter setting for peak detection. Since peak shapes vary greatly from one to another, it is difficult for users to select an optimized parameter setting for peak detection. In addition, most of the tools do not provide deisotoping, and thus users have to apply additional packages for isotope pattern assembly. Therefore, in this paper, we introduced an intelligent quantitation tool, iMet-Q, which is capable of dynamically determining the peak widths in liquid chromatogram dimension without input parameter, and automatically performing isotope pattern assembly. In our evaluation, iMet-Q has the quantitation performance better than XCMS, MetAlign, and MZmine 2 on standard and large-scale metabolome data sets. Besides, iMet-Q provides both the charge states and isotope ratios of detected peaks. With the charge state information, users can obtain accurate masses of detected peaks. Meanwhile, the isotope ratio information provides users an opportunity to reduce metabolite candidates. Although our evaluation demonstrates that the metabolite isotope ratios calculated by iMet-Q are close to the theoretical values, it is important to note that isotope ratio can be affected by noise interference, saturation effects and different experimental conditions [<xref rid="pone.0146112.ref036" ref-type="bibr">36</xref>, <xref rid="pone.0146112.ref037" ref-type="bibr">37</xref>]. In addition to providing accurate quantitation, charge state, and isotope ratios, iMet-Q is equipped with friendly user interfaces so that quantifying metabolites become an easy task. The software program is now publicly available for download at <ext-link ext-link-type="uri" xlink:href="http://ms.iis.sinica.edu.tw/comics/Software_iMet-Q.html">http://ms.iis.sinica.edu.tw/comics/Software_iMet-Q.html</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec022">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0146112.s001">
      <label>S1 File</label>
      <caption>
        <title>The XCMS quantitation results of the standard metabolite mixture (profile mode) under five different parameter settings.</title>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0146112.s001.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s002">
      <label>S2 File</label>
      <caption>
        <title>The XCMS quantitation results of the standard metabolite mixture (centroid mode) under 37 different parameter settings.</title>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0146112.s002.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s003">
      <label>S3 File</label>
      <caption>
        <title>The XCMS quantitation results of the public Arabidopsis dataset (positive mode) under 37 different parameter settings.</title>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0146112.s003.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s004">
      <label>S4 File</label>
      <caption>
        <title>The XCMS quantitation results of the public Arabidopsis dataset (negative mode) under 37 different parameter settings.</title>
        <p>(7Z)</p>
      </caption>
      <media xlink:href="pone.0146112.s004.7z">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s005">
      <label>S1 Section</label>
      <caption>
        <title>The detailed description of centroiding signals in each scan.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0146112.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s006">
      <label>S1 Table</label>
      <caption>
        <title>The sample ratio of each metabolite under different fwhm (for Standard Mixture-profile).</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s006.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s007">
      <label>S2 Table</label>
      <caption>
        <title>The sample ratio of each metabolite under different centWave parameters (for Standard Mixture-centroid).</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s007.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s008">
      <label>S3 Table</label>
      <caption>
        <title>The reproducibility and abundance consistency of the internal standard (lidocaine) in Arabidopsis data set (positive mode) under different centWave parameters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s008.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s009">
      <label>S4 Table</label>
      <caption>
        <title>The reproducibility and abundance consistency of the internal standard (camphor-10-sulfonic acid) in Arabidopsis data set (negative mode) under different centWave parameters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s009.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s010">
      <label>S5 Table</label>
      <caption>
        <title>The abundances of seven standard metabolites detected from profile and centroid data set using four quantitation tools.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s011">
      <label>S6 Table</label>
      <caption>
        <title>The number of metabolite candidates of the seven standard metabolites using (1) mass match, and (2) mass and isotope ratio (IR) match.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s011.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s012">
      <label>S7 Table</label>
      <caption>
        <title>The combined quantitation result generated using iMet-Q.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s012.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s013">
      <label>S8 Table</label>
      <caption>
        <title>The combined quantitation result generated using XCMS.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s013.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s014">
      <label>S9 Table</label>
      <caption>
        <title>The combined quantitation result generated using MetAlign.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s014.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s015">
      <label>S10 Table</label>
      <caption>
        <title>The combined quantitation result generated using MZmine 2.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s015.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s016">
      <label>S11 Table</label>
      <caption>
        <title>The average abundance correlations of the eight plant classes using the quantitation results obtained from iMet-Q, XCMS, MetAlign, and MZmine 2.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s016.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s017">
      <label>S12 Table</label>
      <caption>
        <title>The isotope ratio of the 19 identified metabolites in the public Arabidopsis data set.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s017.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the support from Academia Sinica, Ministry of Science and Technology of Taiwan (MOST 103-2221-E-001-037), and Taiwan International Graduate Program. We also thank Wai-Kok Choong and Thejkiran Pitti for fruitful discussion on the manuscript.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0146112.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Ellis</surname><given-names>DI</given-names></name>, <name><surname>Dunn</surname><given-names>WB</given-names></name>, <name><surname>Griffin</surname><given-names>JL</given-names></name>, <name><surname>Allwood</surname><given-names>JW</given-names></name>, <name><surname>Goodacre</surname><given-names>R</given-names></name>. <article-title>Metabolic fingerprinting as a diagnostic tool</article-title>. <source>Pharmacogenomics</source>. <year>2007</year><month>9</month>;<volume>8</volume>(<issue>9</issue>):<fpage>1243</fpage>–<lpage>66</lpage>. .<?supplied-pmid 17924839?><pub-id pub-id-type="pmid">17924839</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Patti</surname><given-names>GJ</given-names></name>, <name><surname>Yanes</surname><given-names>O</given-names></name>, <name><surname>Siuzdak</surname><given-names>G</given-names></name>. <article-title>Innovation: Metabolomics: the apogee of the omics trilogy</article-title>. <source>Nature reviews Molecular cell biology</source>. <year>2012</year><month>4</month>;<volume>13</volume>(<issue>4</issue>):<fpage>263</fpage>–<lpage>9</lpage>. Pubmed Central PMCID: 3682684. <pub-id pub-id-type="doi">10.1038/nrm3314</pub-id><?supplied-pmid 22436749?><pub-id pub-id-type="pmid">22436749</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Weiss</surname><given-names>RH</given-names></name>, <name><surname>Kim</surname><given-names>K</given-names></name>. <article-title>Metabolomics in the study of kidney diseases</article-title>. <source>Nature reviews Nephrology</source>. <year>2012</year><month>1</month>;<volume>8</volume>(<issue>1</issue>):<fpage>22</fpage>–<lpage>33</lpage>. .<?supplied-pmid 22025087?><pub-id pub-id-type="pmid">22025087</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Baker</surname><given-names>M</given-names></name>. <article-title>Metabolomics: from small molecules to big ideas</article-title>. <source>Nat Methods</source>. <year>2011</year><source>Feb</source>;<volume>8</volume>(<issue>2</issue>):<fpage>117</fpage>–<lpage>21</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Dunn</surname><given-names>WB</given-names></name>, <name><surname>Broadhurst</surname><given-names>DI</given-names></name>, <name><surname>Atherton</surname><given-names>HJ</given-names></name>, <name><surname>Goodacre</surname><given-names>R</given-names></name>, <name><surname>Griffin</surname><given-names>JL</given-names></name>. <article-title>Systems level studies of mammalian metabolomes: the roles of mass spectrometry and nuclear magnetic resonance spectroscopy</article-title>. <source>Chemical Society reviews</source>. <year>2011</year><month>1</month>;<volume>40</volume>(<issue>1</issue>):<fpage>387</fpage>–<lpage>426</lpage>. <pub-id pub-id-type="doi">10.1039/b906712b</pub-id><?supplied-pmid 20717559?><pub-id pub-id-type="pmid">20717559</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Madsen</surname><given-names>R</given-names></name>, <name><surname>Lundstedt</surname><given-names>T</given-names></name>, <name><surname>Trygg</surname><given-names>J</given-names></name>. <article-title>Chemometrics in metabolomics-A review in human disease diagnosis</article-title>. <source>Analytica Chimica Acta</source>. <year>2010</year><month>2</month><day>5</day>;<volume>659</volume>(<issue>1–2</issue>):<fpage>23</fpage>–<lpage>33</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2009.11.042</pub-id><?supplied-pmid WOS:000274046900004?><pub-id pub-id-type="pmid">20103103</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Issaq</surname><given-names>HJ</given-names></name>, <name><surname>Van</surname><given-names>QN</given-names></name>, <name><surname>Waybright</surname><given-names>TJ</given-names></name>, <name><surname>Muschik</surname><given-names>GM</given-names></name>, <name><surname>Veenstra</surname><given-names>TD</given-names></name>. <article-title>Analytical and statistical approaches to metabolomics research</article-title>. <source>Journal of separation science</source>. <year>2009</year><month>7</month>;<volume>32</volume>(<issue>13</issue>):<fpage>2183</fpage>–<lpage>99</lpage>. <pub-id pub-id-type="doi">10.1002/jssc.200900152</pub-id><?supplied-pmid 19569098?><pub-id pub-id-type="pmid">19569098</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Mamas</surname><given-names>M</given-names></name>, <name><surname>Dunn</surname><given-names>WB</given-names></name>, <name><surname>Neyses</surname><given-names>L</given-names></name>, <name><surname>Goodacre</surname><given-names>R</given-names></name>. <article-title>The role of metabolites and metabolomics in clinically applicable biomarkers of disease</article-title>. <source>Archives of toxicology</source>. <year>2011</year><month>1</month>;<volume>85</volume>(<issue>1</issue>):<fpage>5</fpage>–<lpage>17</lpage>. <pub-id pub-id-type="doi">10.1007/s00204-010-0609-6</pub-id><?supplied-pmid 20953584?><pub-id pub-id-type="pmid">20953584</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>A</given-names></name>, <name><surname>Lison</surname><given-names>D</given-names></name>, <name><surname>Junot</surname><given-names>C</given-names></name>, <name><surname>Heilier</surname><given-names>JF</given-names></name>. <article-title>Applications of liquid chromatography coupled to mass spectrometry-based metabolomics in clinical chemistry and toxicology: A review</article-title>. <source>Clinical biochemistry</source>. <year>2011</year><month>1</month>;<volume>44</volume>(<issue>1</issue>):<fpage>119</fpage>–<lpage>35</lpage>. <pub-id pub-id-type="doi">10.1016/j.clinbiochem.2010.08.016</pub-id><?supplied-pmid 20800591?><pub-id pub-id-type="pmid">20800591</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Theodoridis</surname><given-names>GA</given-names></name>, <name><surname>Gika</surname><given-names>HG</given-names></name>, <name><surname>Want</surname><given-names>EJ</given-names></name>, <name><surname>Wilson</surname><given-names>ID</given-names></name>. <article-title>Liquid chromatography-mass spectrometry based global metabolite profiling: a review</article-title>. <source>Analytica chimica acta</source>. <year>2012</year><month>1</month><day>20</day>;<volume>711</volume>:<fpage>7</fpage>–<lpage>16</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2011.09.042</pub-id><?supplied-pmid 22152789?><pub-id pub-id-type="pmid">22152789</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>B</given-names></name>, <name><surname>Xiao</surname><given-names>JF</given-names></name>, <name><surname>Tuli</surname><given-names>L</given-names></name>, <name><surname>Ressom</surname><given-names>HW</given-names></name>. <article-title>LC-MS-based metabolomics</article-title>. <source>Molecular bioSystems</source>. <year>2012</year><month>2</month>;<volume>8</volume>(<issue>2</issue>):<fpage>470</fpage>–<lpage>81</lpage>. Pubmed Central PMCID: 3699692. <pub-id pub-id-type="doi">10.1039/c1mb05350g</pub-id><?supplied-pmid 22041788?><pub-id pub-id-type="pmid">22041788</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Bedair</surname><given-names>M</given-names></name>, <name><surname>Sumner</surname><given-names>LW</given-names></name>. <article-title>Current and emerging mass-spectrometry technologies for metabolomics</article-title>. <source>Trac-Trend Anal Chem</source>. <year>2008</year><month>3</month>;<volume>27</volume>(<issue>3</issue>):<fpage>238</fpage>–<lpage>50</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Dakna</surname><given-names>M</given-names></name>, <name><surname>He</surname><given-names>Z</given-names></name>, <name><surname>Yu</surname><given-names>WC</given-names></name>, <name><surname>Mischak</surname><given-names>H</given-names></name>, <name><surname>Kolch</surname><given-names>W</given-names></name>. <article-title>Technical, bioinformatical and statistical aspects of liquid chromatography-mass spectrometry (LC-MS) and capillary electrophoresis-mass spectrometry (CE-MS) based clinical proteomics: a critical assessment</article-title>. <source>Journal of chromatography B, Analytical technologies in the biomedical and life sciences</source>. <year>2009</year><month>5</month><day>1</day>;<volume>877</volume>(<issue>13</issue>):<fpage>1250</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1016/j.jchromb.2008.10.048</pub-id><?supplied-pmid 19010091?><pub-id pub-id-type="pmid">19010091</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Blekherman</surname><given-names>G</given-names></name>, <name><surname>Laubenbacher</surname><given-names>R</given-names></name>, <name><surname>Cortes</surname><given-names>DF</given-names></name>, <name><surname>Mendes</surname><given-names>P</given-names></name>, <name><surname>Torti</surname><given-names>FM</given-names></name>, <name><surname>Akman</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Bioinformatics tools for cancer metabolomics</article-title>. <source>Metabolomics: Official journal of the Metabolomic Society</source>. <year>2011</year><month>9</month>;<volume>7</volume>(<issue>3</issue>):<fpage>329</fpage>–<lpage>43</lpage>. . Pubmed Central PMCID: 3155682.<?supplied-pmid 21949492?><pub-id pub-id-type="pmid">21949492</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Jaitly</surname><given-names>N</given-names></name>, <name><surname>Mayampurath</surname><given-names>A</given-names></name>, <name><surname>Littlefield</surname><given-names>K</given-names></name>, <name><surname>Adkins</surname><given-names>JN</given-names></name>, <name><surname>Anderson</surname><given-names>GA</given-names></name>, <name><surname>Smith</surname><given-names>RD</given-names></name>. <article-title>Decon2LS: An open-source software package for automated processing and visualization of high resolution mass spectrometry data</article-title>. <source>BMC bioinformatics</source>. <year>2009</year>;<volume>10</volume>:<fpage>87</fpage> Pubmed Central PMCID: 2666663. <pub-id pub-id-type="doi">10.1186/1471-2105-10-87</pub-id><?supplied-pmid 19292916?><pub-id pub-id-type="pmid">19292916</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Sugimoto</surname><given-names>M</given-names></name>, <name><surname>Hirayama</surname><given-names>A</given-names></name>, <name><surname>Ishikawa</surname><given-names>T</given-names></name>, <name><surname>Robert</surname><given-names>M</given-names></name>, <name><surname>Baran</surname><given-names>R</given-names></name>, <name><surname>Uehara</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>Differential metabolomics software for capillary electrophoresis-mass spectrometry data analysis</article-title>. <source>Metabolomics: Official journal of the Metabolomic Society</source>. <year>2010</year><month>3</month>;<volume>6</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>41</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Scalbert</surname><given-names>A</given-names></name>, <name><surname>Brennan</surname><given-names>L</given-names></name>, <name><surname>Fiehn</surname><given-names>O</given-names></name>, <name><surname>Hankemeier</surname><given-names>T</given-names></name>, <name><surname>Kristal</surname><given-names>BS</given-names></name>, <name><surname>van Ommen</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>Mass-spectrometry-based metabolomics: limitations and recommendations for future progress with particular focus on nutrition research</article-title>. <source>Metabolomics: Official journal of the Metabolomic Society</source>. <year>2009</year><month>12</month>;<volume>5</volume>(<issue>4</issue>):<fpage>435</fpage>–<lpage>58</lpage>. . Pubmed Central PMCID: 2794347.<?supplied-pmid 20046865?><pub-id pub-id-type="pmid">20046865</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>CA</given-names></name>, <name><surname>Want</surname><given-names>EJ</given-names></name>, <name><surname>O'Maille</surname><given-names>G</given-names></name>, <name><surname>Abagyan</surname><given-names>R</given-names></name>, <name><surname>Siuzdak</surname><given-names>G</given-names></name>. <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>. <source>Analytical chemistry</source>. <year>2006</year><month>2</month><day>1</day>;<volume>78</volume>(<issue>3</issue>):<fpage>779</fpage>–<lpage>87</lpage>. .<?supplied-pmid 16448051?><pub-id pub-id-type="pmid">16448051</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Lommen</surname><given-names>A</given-names></name>. <article-title>MetAlign: interface-driven, versatile metabolomics tool for hyphenated full-scan mass spectrometry data preprocessing</article-title>. <source>Analytical chemistry</source>. <year>2009</year><month>4</month><day>15</day>;<volume>81</volume>(<issue>8</issue>):<fpage>3079</fpage>–<lpage>86</lpage>. <pub-id pub-id-type="doi">10.1021/ac900036d</pub-id><?supplied-pmid 19301908?><pub-id pub-id-type="pmid">19301908</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Pluskal</surname><given-names>T</given-names></name>, <name><surname>Castillo</surname><given-names>S</given-names></name>, <name><surname>Villar-Briones</surname><given-names>A</given-names></name>, <name><surname>Oresic</surname><given-names>M</given-names></name>. <article-title>MZmine 2: modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data</article-title>. <source>BMC bioinformatics</source>. <year>2010</year>;<volume>11</volume>:<fpage>395</fpage> Pubmed Central PMCID: 2918584. <pub-id pub-id-type="doi">10.1186/1471-2105-11-395</pub-id><?supplied-pmid 20650010?><pub-id pub-id-type="pmid">20650010</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Kenar</surname><given-names>E</given-names></name>, <name><surname>Franken</surname><given-names>H</given-names></name>, <name><surname>Forcisi</surname><given-names>S</given-names></name>, <name><surname>Wormann</surname><given-names>K</given-names></name>, <name><surname>Haring</surname><given-names>HU</given-names></name>, <name><surname>Lehmann</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Automated label-free quantification of metabolites from liquid chromatography-mass spectrometry data</article-title>. <source>Molecular &amp; cellular proteomics: MCP</source>. <year>2014</year><month>1</month>;<volume>13</volume>(<issue>1</issue>):<fpage>348</fpage>–<lpage>59</lpage>. . Pubmed Central PMCID: 3879626.<?supplied-pmid 24176773?><pub-id pub-id-type="pmid">24176773</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Aberg</surname><given-names>KM</given-names></name>, <name><surname>Torgrip</surname><given-names>RJ</given-names></name>, <name><surname>Kolmert</surname><given-names>J</given-names></name>, <name><surname>Schuppe-Koistinen</surname><given-names>I</given-names></name>, <name><surname>Lindberg</surname><given-names>J</given-names></name>. <article-title>Feature detection and alignment of hyphenated chromatographic-mass spectrometric data. Extraction of pure ion chromatograms using Kalman tracking</article-title>. <source>Journal of chromatography A</source>. <year>2008</year><month>5</month><day>23</day>;<volume>1192</volume>(<issue>1</issue>):<fpage>139</fpage>–<lpage>46</lpage>. <pub-id pub-id-type="doi">10.1016/j.chroma.2008.03.033</pub-id><?supplied-pmid 18378252?><pub-id pub-id-type="pmid">18378252</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Sugimoto</surname><given-names>M</given-names></name>, <name><surname>Kawakami</surname><given-names>M</given-names></name>, <name><surname>Robert</surname><given-names>M</given-names></name>, <name><surname>Soga</surname><given-names>T</given-names></name>, <name><surname>Tomita</surname><given-names>M</given-names></name>. <article-title>Bioinformatics Tools for Mass Spectroscopy-Based Metabolomic Data Processing and Analysis</article-title>. <source>Current bioinformatics</source>. <year>2012</year><month>3</month>;<volume>7</volume>(<issue>1</issue>):<fpage>96</fpage>–<lpage>108</lpage>. . Pubmed Central PMCID: 3299976.<?supplied-pmid 22438836?><pub-id pub-id-type="pmid">22438836</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Tautenhahn</surname><given-names>R</given-names></name>, <name><surname>Bottcher</surname><given-names>C</given-names></name>, <name><surname>Neumann</surname><given-names>S</given-names></name>. <article-title>Highly sensitive feature detection for high resolution LC/MS</article-title>. <source>BMC bioinformatics</source>. <year>2008</year>;<volume>9</volume>:<fpage>504</fpage> Pubmed Central PMCID: 2639432. <pub-id pub-id-type="doi">10.1186/1471-2105-9-504</pub-id><?supplied-pmid 19040729?><pub-id pub-id-type="pmid">19040729</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Kuhl</surname><given-names>C</given-names></name>, <name><surname>Tautenhahn</surname><given-names>R</given-names></name>, <name><surname>Bottcher</surname><given-names>C</given-names></name>, <name><surname>Larson</surname><given-names>TR</given-names></name>, <name><surname>Neumann</surname><given-names>S</given-names></name>. <article-title>CAMERA: an integrated strategy for compound spectra extraction and annotation of liquid chromatography/mass spectrometry data sets</article-title>. <source>Analytical chemistry</source>. <year>2012</year><month>1</month><day>3</day>;<volume>84</volume>(<issue>1</issue>):<fpage>283</fpage>–<lpage>9</lpage>. Pubmed Central PMCID: 3658281. <pub-id pub-id-type="doi">10.1021/ac202450g</pub-id><?supplied-pmid 22111785?><pub-id pub-id-type="pmid">22111785</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Cleveland</surname><given-names>WS</given-names></name>. <article-title>Robust Locally Weighted Regression and Smoothing Scatterplots</article-title>. <source>J Am Stat Assoc</source>. <year>1979</year>;<volume>74</volume>(<issue>368</issue>):<fpage>829</fpage>–<lpage>36</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Cleveland</surname><given-names>WS</given-names></name>. <article-title>Lowess—a Program for Smoothing Scatterplots by Robust Locally Weighted Regression</article-title>. <source>Am Stat</source>. <year>1981</year>;<volume>35</volume>(<issue>1</issue>):<fpage>54</fpage>–.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Matsuda</surname><given-names>F</given-names></name>, <name><surname>Hirai</surname><given-names>MY</given-names></name>, <name><surname>Sasaki</surname><given-names>E</given-names></name>, <name><surname>Akiyama</surname><given-names>K</given-names></name>, <name><surname>Yonekura-Sakakibara</surname><given-names>K</given-names></name>, <name><surname>Provart</surname><given-names>NJ</given-names></name>, <etal>et al</etal><article-title>AtMetExpress development: a phytochemical atlas of Arabidopsis development</article-title>. <source>Plant physiology</source>. <year>2010</year><month>2</month>;<volume>152</volume>(<issue>2</issue>):<fpage>566</fpage>–<lpage>78</lpage>. Pubmed Central PMCID: 2815869. <pub-id pub-id-type="doi">10.1104/pp.109.148031</pub-id><?supplied-pmid 20023150?><pub-id pub-id-type="pmid">20023150</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Kessner</surname><given-names>D</given-names></name>, <name><surname>Chambers</surname><given-names>M</given-names></name>, <name><surname>Burke</surname><given-names>R</given-names></name>, <name><surname>Agus</surname><given-names>D</given-names></name>, <name><surname>Mallick</surname><given-names>P</given-names></name>. <article-title>ProteoWizard: open source software for rapid proteomics tools development</article-title>. <source>Bioinformatics</source>. <year>2008</year><month>11</month><day>1</day>;<volume>24</volume>(<issue>21</issue>):<fpage>2534</fpage>–<lpage>6</lpage>. Pubmed Central PMCID: 2732273. <pub-id pub-id-type="doi">10.1093/bioinformatics/btn323</pub-id><?supplied-pmid 18606607?><pub-id pub-id-type="pmid">18606607</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Wishart</surname><given-names>DS</given-names></name>, <name><surname>Jewison</surname><given-names>T</given-names></name>, <name><surname>Guo</surname><given-names>AC</given-names></name>, <name><surname>Wilson</surname><given-names>M</given-names></name>, <name><surname>Knox</surname><given-names>C</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>HMDB 3.0—The Human Metabolome Database in 2013</article-title>. <source>Nucleic acids research</source>. <year>2013</year><month>1</month>;<volume>41</volume>(Database issue):<fpage>D801</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1065</pub-id>. Pubmed Central PMCID: 3531200.<?supplied-pmid 23161693?><pub-id pub-id-type="pmid">23161693</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Matsuda</surname><given-names>F</given-names></name>, <name><surname>Yonekura-Sakakibara</surname><given-names>K</given-names></name>, <name><surname>Niida</surname><given-names>R</given-names></name>, <name><surname>Kuromori</surname><given-names>T</given-names></name>, <name><surname>Shinozaki</surname><given-names>K</given-names></name>, <name><surname>Saito</surname><given-names>K</given-names></name>. <article-title>MS/MS spectral tag-based annotation of non-targeted profile of plant secondary metabolites</article-title>. <source>The Plant journal: for cell and molecular biology</source>. <year>2009</year><month>2</month>;<volume>57</volume>(<issue>3</issue>):<fpage>555</fpage>–<lpage>77</lpage>. . Pubmed Central PMCID: 2667644.<?supplied-pmid 18939963?><pub-id pub-id-type="pmid">18939963</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Katajamaa</surname><given-names>M</given-names></name>, <name><surname>Oresic</surname><given-names>M</given-names></name>. <article-title>Data processing for mass spectrometry-based metabolomics</article-title>. <source>Journal of chromatography A</source>. <year>2007</year><month>7</month><day>27</day>;<volume>1158</volume>(<issue>1–2</issue>):<fpage>318</fpage>–<lpage>28</lpage>. .<?supplied-pmid 17466315?><pub-id pub-id-type="pmid">17466315</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Keller</surname><given-names>BO</given-names></name>, <name><surname>Sui</surname><given-names>J</given-names></name>, <name><surname>Young</surname><given-names>AB</given-names></name>, <name><surname>Whittal</surname><given-names>RM</given-names></name>. <article-title>Interferences and contaminants encountered in modern mass spectrometry</article-title>. <source>Analytica chimica acta</source>. <year>2008</year><month>10</month><day>3</day>;<volume>627</volume>(<issue>1</issue>):<fpage>71</fpage>–<lpage>81</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2008.04.043</pub-id><?supplied-pmid 18790129?><pub-id pub-id-type="pmid">18790129</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Tolstikov</surname><given-names>VV</given-names></name>, <name><surname>Lommen</surname><given-names>A</given-names></name>, <name><surname>Nakanishi</surname><given-names>K</given-names></name>, <name><surname>Tanaka</surname><given-names>N</given-names></name>, <name><surname>Fiehn</surname><given-names>O</given-names></name>. <article-title>Monolithic silica-based capillary reversed-phase liquid chromatography/electrospray mass spectrometry for plant metabolomics</article-title>. <source>Analytical chemistry</source>. <year>2003</year><month>12</month><day>1</day>;<volume>75</volume>(<issue>23</issue>):<fpage>6737</fpage>–<lpage>40</lpage>. .<?supplied-pmid 14640754?><pub-id pub-id-type="pmid">14640754</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Lynn</surname><given-names>KS</given-names></name>, <name><surname>Cheng</surname><given-names>ML</given-names></name>, <name><surname>Chen</surname><given-names>YR</given-names></name>, <name><surname>Hsu</surname><given-names>C</given-names></name>, <name><surname>Chen</surname><given-names>A</given-names></name>, <name><surname>Lih</surname><given-names>TM</given-names></name>, <etal>et al</etal><article-title>Metabolite identification for mass spectrometry-based metabolomics using multiple types of correlated ion information</article-title>. <source>Analytical chemistry</source>. <year>2015</year><month>2</month><day>17</day>;<volume>87</volume>(<issue>4</issue>):<fpage>2143</fpage>–<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1021/ac503325c</pub-id><?supplied-pmid 25543920?><pub-id pub-id-type="pmid">25543920</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Werner</surname><given-names>E</given-names></name>, <name><surname>Heilier</surname><given-names>JF</given-names></name>, <name><surname>Ducruix</surname><given-names>C</given-names></name>, <name><surname>Ezan</surname><given-names>E</given-names></name>, <name><surname>Junot</surname><given-names>C</given-names></name>, <name><surname>Tabet</surname><given-names>JC</given-names></name>. <article-title>Mass spectrometry for the identification of the discriminating signals from metabolomics: current status and future trends</article-title>. <source>Journal of chromatography B, Analytical technologies in the biomedical and life sciences</source>. <year>2008</year><month>8</month><day>15</day>;<volume>871</volume>(<issue>2</issue>):<fpage>143</fpage>–<lpage>63</lpage>. <pub-id pub-id-type="doi">10.1016/j.jchromb.2008.07.004</pub-id><?supplied-pmid 18672410?><pub-id pub-id-type="pmid">18672410</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Nagao</surname><given-names>T</given-names></name>, <name><surname>Yukihira</surname><given-names>D</given-names></name>, <name><surname>Fujimura</surname><given-names>Y</given-names></name>, <name><surname>Saito</surname><given-names>K</given-names></name>, <name><surname>Takahashi</surname><given-names>K</given-names></name>, <name><surname>Miura</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Power of isotopic fine structure for unambiguous determination of metabolite elemental compositions: in silico evaluation and metabolomic application</article-title>. <source>Analytica chimica acta</source>. <year>2014</year><month>2</month><day>27</day>;<volume>813</volume>:<fpage>70</fpage>–<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2014.01.032</pub-id><?supplied-pmid 24528662?><pub-id pub-id-type="pmid">24528662</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4718670</article-id>
    <article-id pub-id-type="pmid">26784691</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0146112</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-15-32483</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>iMet-Q: A User-Friendly Tool for Label-Free Metabolomics Quantitation Using Dynamic Peak-Width Determination</article-title>
      <alt-title alt-title-type="running-head">iMet-Q: A User-Friendly Tool for Label-Free Metabolomics Quantitation</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chang</surname>
          <given-names>Hui-Yin</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Ching-Tai</given-names>
        </name>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lih</surname>
          <given-names>T. Mamie</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lynn</surname>
          <given-names>Ke-Shiuan</given-names>
        </name>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Juo</surname>
          <given-names>Chiun-Gung</given-names>
        </name>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hsu</surname>
          <given-names>Wen-Lian</given-names>
        </name>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sung</surname>
          <given-names>Ting-Yi</given-names>
        </name>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Bioinformatics Program, Taiwan International Graduate Program, Academia Sinica, Taipei 11529, Taiwan</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Institute of Biomedical Informatics, National Yang-Ming University, Taipei 11221, Taiwan</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Institute of Information Science, Academia Sinica, Taipei 11529, Taiwan</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Mathematics, Fu Jen Catholic University, New Taipei City 24205, Taiwan</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Molecular Medicine Research Center, Chang Gung University, Taoyuan 33302, Taiwan</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Bundy</surname>
          <given-names>Jacob Guy</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Imperial College London, UNITED KINGDOM</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con" id="contrib001">
        <p>Conceived and designed the experiments: H-YC T-YS. Performed the experiments: C-GJ. Analyzed the data: H-YC C-TC K-SL TML. Contributed reagents/materials/analysis tools: H-YC C-TC C-GJ. Wrote the paper: H-YC T-YS. Helped revise the manuscript: TML W-LH.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>tsung@iis.sinica.edu.tw</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>11</volume>
    <issue>1</issue>
    <elocation-id>e0146112</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>7</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>12</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2016 Chang et al</copyright-statement>
      <copyright-year>2016</copyright-year>
      <copyright-holder>Chang et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="pone.0146112.pdf"/>
    <abstract>
      <p>Efficient and accurate quantitation of metabolites from LC-MS data has become an important topic. Here we present an automated tool, called iMet-Q (<underline>i</underline>ntelligent <underline>Met</underline>abolomic <underline>Q</underline>uantitation), for label-free metabolomics quantitation from high-throughput MS1 data. By performing peak detection and peak alignment, iMet-Q provides a summary of quantitation results and reports ion abundance at both replicate level and sample level. Furthermore, it gives the charge states and isotope ratios of detected metabolite peaks to facilitate metabolite identification. An in-house standard mixture and a public Arabidopsis metabolome data set were analyzed by iMet-Q. Three public quantitation tools, including XCMS, MetAlign, and MZmine 2, were used for performance comparison. From the mixture data set, seven standard metabolites were detected by the four quantitation tools, for which iMet-Q had a smaller quantitation error of 12% in both profile and centroid data sets. Our tool also correctly determined the charge states of seven standard metabolites. By searching the mass values for those standard metabolites against Human Metabolome Database, we obtained a total of 183 metabolite candidates. With the isotope ratios calculated by iMet-Q, 49% (89 out of 183) metabolite candidates were filtered out. From the public Arabidopsis data set reported with two internal standards and 167 elucidated metabolites, iMet-Q detected all of the peaks corresponding to the internal standards and 167 metabolites. Meanwhile, our tool had small abundance variation (≤0.19) when quantifying the two internal standards and had higher abundance correlation (≥0.92) when quantifying the 167 metabolites. iMet-Q provides user-friendly interfaces and is publicly available for download at <ext-link ext-link-type="uri" xlink:href="http://ms.iis.sinica.edu.tw/comics/Software_iMet-Q.html">http://ms.iis.sinica.edu.tw/comics/Software_iMet-Q.html</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by Academia Sinica, Ministry of Science and Technology of Taiwan (MOST103-2221-E-001-037), and Taiwan International Graduate Program.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="2"/>
      <page-count count="18"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Two datasets, including a standard metabolite mixture and a public Arabidopsis dataset, were used in our study. The public Arabidopsis dataset is a third-party open data (not owned by the authors), and thus we provided a website link to the public data (PRIMe, <ext-link ext-link-type="uri" xlink:href="http://prime.psc.riken.jp/">http://prime.psc.riken.jp/</ext-link>). The standard metabolite mixture owned by the authors is now available under the DOI: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.6084/m9.figshare.2058702.v1">https://dx.doi.org/10.6084/m9.figshare.2058702.v1</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Two datasets, including a standard metabolite mixture and a public Arabidopsis dataset, were used in our study. The public Arabidopsis dataset is a third-party open data (not owned by the authors), and thus we provided a website link to the public data (PRIMe, <ext-link ext-link-type="uri" xlink:href="http://prime.psc.riken.jp/">http://prime.psc.riken.jp/</ext-link>). The standard metabolite mixture owned by the authors is now available under the DOI: <ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.6084/m9.figshare.2058702.v1">https://dx.doi.org/10.6084/m9.figshare.2058702.v1</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Unbiased quantitation and identification of small-molecule metabolites in a biological system is important because metabolites serve as direct signatures of biochemical activity, making them relatively easier to correlate with disease phenotype and more suitable for clinical diagnostics [<xref rid="pone.0146112.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0146112.ref008" ref-type="bibr">8</xref>]. Liquid chromatography coupled with mass spectrometry (LC-MS) has become a conventional platform for analyzing metabolites across a large number of biological samples because of its ability to measure thousands of metabolites in a short period of time [<xref rid="pone.0146112.ref002" ref-type="bibr">2</xref>, <xref rid="pone.0146112.ref005" ref-type="bibr">5</xref>, <xref rid="pone.0146112.ref009" ref-type="bibr">9</xref>–<xref rid="pone.0146112.ref013" ref-type="bibr">13</xref>]. However, it is a time-consuming process to manually calculate the abundances of thousands of metabolites from large-scale LC-MS data, and thus developing a software package to automatically quantify LC-MS metabolomics data becomes essential.</p>
    <p>Many commercial software programs have been developed by instrument vendors, such as Progenesis QI (Waters), MassHunter (Agilent), MultiQuant (Sciex), and Xcalibur (Thermo). But they usually accept data formats specific to their own instruments, and thus limit the possibility of integrating metabolite analyses across different analytical platforms [<xref rid="pone.0146112.ref014" ref-type="bibr">14</xref>–<xref rid="pone.0146112.ref017" ref-type="bibr">17</xref>]. Additionally, data processing algorithms implemented in these programs are mostly unavailable. Publicly available quantitation tools, on the other hand, accept multiple input data formats and provide description of their computational algorithms. For example, XCMS [<xref rid="pone.0146112.ref018" ref-type="bibr">18</xref>], MetAlign [<xref rid="pone.0146112.ref019" ref-type="bibr">19</xref>] and MZmine 2 [<xref rid="pone.0146112.ref020" ref-type="bibr">20</xref>] accept input formats such as mzXML, mzData, and netCDF. XCMS, implemented in R, C, and C++ programming language, provides format conversion, noise filtering, peak detection, non-linear spectral alignment algorithms, and statistical analysis of LC-MS data. MetAlign, an open interface-driven tool implemented in C++ programming language, provides format conversion, mass calculation, baseline correction, peak-picking, saturation and mass peak artifact filtering, as well as data set alignment. MZmine 2, a modular-based tool implemented in Java programming language, provides raw data import, raw data processing, peak detection, peak list alignment, normalization, visualization, peak identification, and statistical analysis.</p>
    <p>However, some concerns of these public tools have been reported. For instance, some tools combine binning with model fitting or use slope calculation approaches to perform peak detection, but these approaches may have low sensitivity on peak picking because the peak shapes vary greatly from one to another [<xref rid="pone.0146112.ref021" ref-type="bibr">21</xref>, <xref rid="pone.0146112.ref022" ref-type="bibr">22</xref>]. Due to different peak detection and peak alignment algorithms provided in each tool, it is difficult for users to optimize the algorithm-related parameters, which very likely affect the quantitation results [<xref rid="pone.0146112.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0146112.ref024" ref-type="bibr">24</xref>]. On the other hand, most of the tools do not provide deisotoping, and thus users have to apply additional packages, such as CAMERA [<xref rid="pone.0146112.ref025" ref-type="bibr">25</xref>], to perform isotope pattern assembly [<xref rid="pone.0146112.ref021" ref-type="bibr">21</xref>].</p>
    <p>To rectify the above concerns, we develop a quantitation tool, called iMet-Q (<underline>i</underline>ntelligent <underline>Met</underline>abolomic <underline>Q</underline>uantitation), written in C# programming language, which provides highly accurate quantitation and user-friendly graphical interfaces. For peak detection, iMet-Q requires one input parameter, i.e., mzWidth (defined as the width of a peak in m/z dimension), and calculates the full width at half maximum (FWHM) of a peak to dynamically determine its chromatographic width so that the peak boundary can be automatically determined (i.e., without requiring parameter input). In addition, our tool determines the charge state of a peak by calculating the similarity between the peak shape of monoisotope and the peak shape of the second isotope peak. Once the charge state is determined, iMet-Q calculates its isotope ratio (i.e., the ratio of the second isotope abundance to the monoisotope abundance) to facilitate metabolite identification. Since metabolites usually have smaller retention time drifts across LC-MS technical replicates, iMet-Q first aligns peaks across different LC-MS replicates of a sample and then across different samples. In each alignment, LOESS regression algorithm [<xref rid="pone.0146112.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0146112.ref027" ref-type="bibr">27</xref>] is applied to adjust peak retention time so that peaks in different LC-MS replicates/samples can be aligned according to their <italic>m/z</italic> and adjusted retention time values.</p>
    <p>We used two metabolite data sets, an in-house standard mixture and a public Arabidopsis metabolome data set [<xref rid="pone.0146112.ref028" ref-type="bibr">28</xref>], to evaluate the performance of iMet-Q and compare it with three public quantitation tools, including XCMS, MetAlign, and MZmine2. Since the standard mixture was acquired in profile mode, we evaluated the performance of the four tools in both profile and centroid data sets, in which the centroid data set was converted from the profile data set by the centroiding function of ProteoWizard [<xref rid="pone.0146112.ref029" ref-type="bibr">29</xref>]. As a result, iMet-Q had small quantitation error of 12% in both profile and centroid data sets. In addition, our tool correctly determined the charge state of seven standard metabolites, removed their isotope peaks, and calculated their isotope ratios. With the isotope ratios, we successfully filtered out 49% (89 out of 183) metabolite candidates when using mass values of these standard metabolites to search in Human Metabolome Database (HMDB) [<xref rid="pone.0146112.ref030" ref-type="bibr">30</xref>]. For the public Arabidopsis metabolome data set reported with two internal standards and 167 elucidated metabolites, iMet-Q detected the internal standards from all replicates and samples. In addition, all of the 167 metabolites were also detected by iMet-Q, whereas 103 (62%), 145 (87%), and 129 (77%) elucidated metabolites were detected by XCMS, MetAlign, and MZmine 2, respectively. Comparing with the three quantitation tools, iMet-Q had relatively small abundance variations (≤0.19) when quantifying the internal standards, and had higher abundance correlation (≥0.92) when quantifying the 167 metabolites across replicates. All data underlying the manuscript are fully available without restriction. The source code of iMet-Q is freely available on SourceForge (<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/imet-q/?source=navbar">http://sourceforge.net/projects/imet-q/?source=navbar</ext-link>) under the license of GPL2.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and Methods</title>
    <sec id="sec003">
      <title>Experiment on standard metabolite mixture</title>
      <sec id="sec004">
        <title>Chemicals</title>
        <p>All chemicals and solvents were purchased from Sigma Aldrich (St. Louis, MO, USA). The chemicals were all of analytical grade. Water containing 0.1% formic acid (solvent A), and acetonitrile containing 0.1% formic acid (solvent B) were of CHROMASOLV grade.</p>
      </sec>
      <sec id="sec005">
        <title>Sample preparation</title>
        <p>Stoke solution of metabolites was prepared as 1 mg/mL of 80% MeOH solution with 0.1% formic acid. Two metabolite mixtures, Sample 1 and Sample 2, were prepared by adding seven standard metabolites with different amount into two 1.7 mL vials. These standard metabolites were L-histidine (3 μL in Sample 1, 6μL in Sample 2), L-carnosine (50μL in Sample 1, 50μL in Sample 2), creatine (6μL in Sample 1, 6μL in Sample 2), caffeine (6μL in Sample 1, 6μL in Sample 2), hippuric acid (5μL in Sample 1, 25μL in Sample 2), glycocholic acid (2μL in Sample 1, 10μL in Sample 2), and cholic acid (2μL in Sample 1, 6μL in Sample 2). The solutions were dried with SpeedVac and re-dissolved by 100 L of MeOH and water (2:1, v/v) with 0.1% formic acid.</p>
      </sec>
      <sec id="sec006">
        <title>UPLC/LTQ-Orbitrap MS</title>
        <p>A UPLC system (Acquity, Waters, Milford, MA, USA) equipped with a C18 reversed-phase column (2.1 × 100 mm, 1.8 m, HSS-T3; Waters, Milford, MA, USA) was coupled with a LTQ-Orbitrap mass spectrometer (Thermo Scientific, San Jose, CA, USA) with an orthogonal electrospray ionization (ESI) source. The initial flow rate was 0.1 mL/min of 99% solvent A (0.1% formic acid) and 1% solvent B (acetonitrile with 0.1% formic acid). A volume of 1μL of Sample 1 and Sample 2 were sequentially injected, and 6 technical replicates were conducted in profile mode on each standard mixture. After injection, solvent B was maintained at 1% for 5 min, then increased to 50% during a time span of 9 min, then to 90% over 6 min, and finally to 99% over a period of 12 min after which this percent composition was held for 1 min. The flow rate was changed to 0.5 mL/min, and after 5 min reduced to 0.1mL/min. After 0.1 min, solvent B was reduced back to 1% and held at this percentage for 7 min.</p>
        <p>The mass spectrometer was controlled by using Xcalibur 2.0.7 software (Thermo Scientific) and operated in positive ion mode on the <italic>m/z</italic> range from 120 to 1,000 with 60,000 resolution at <italic>m/z</italic> 400. The source and capillary voltages were set to 4500 and 35 V, and the temperatures of the capillary and the APCI vaporizer were set to 275°C and 150°C. Internal calibration was performed using the ion signal of dioctyl phthalate at <italic>m/z</italic> 391.28 as a lock mass.</p>
      </sec>
    </sec>
    <sec id="sec007">
      <title>Public Arabidopsis metabolome data set</title>
      <p>A public Arabidopsis metabolome data set of 36 samples acquired by LC-ESI-Q-TOF/MS (HPLC: Waters Acquity UPLC system; MS: Waters Q-TOF Premier) in positive- and negative-ion modes, with four technical replicates on each sample, was downloaded from the website of PRIMe (<ext-link ext-link-type="uri" xlink:href="http://prime.psc.riken.jp/">http://prime.psc.riken.jp/</ext-link>). All replicates of the Arabidopsis metabolome data set were acquired in centroid mode. Two internal standards, lidocaine (<italic>m/z</italic> = 235 [M+H]+, eluted at 4.19 min in the positive-ion mode data) and camphor-10-sulfonic acid (<italic>m/z</italic> = 231 [M-H]-, eluted at 3.84min in the negative-ion mode data) were spiked in each sample with the same amount of 0.5 mg/L for abundance normalization and 167 metabolites were elucidated from this data set [<xref rid="pone.0146112.ref031" ref-type="bibr">31</xref>, <xref rid="pone.0146112.ref032" ref-type="bibr">32</xref>].</p>
    </sec>
    <sec id="sec008">
      <title>Data processing and software parameter settings</title>
      <p>Data processing was performed on a Microsoft Windows 7 computer (x64 edition service pack 1 with an Intel Xeon E5-2630 processor, 16 GB RAM and 500GB hard disk drive). All raw data files of the standard mixture experiment and the public data set were converted into mzXML format using ProteoWizard. The acquired profile-mode data of standard mixture experiment was converted into two data sets, where one data set was directly converted to mzXML files (called <italic>profile data set</italic> for convenience) and the other was converted to mzXML files with an additional centroiding procedure in ProteoWizard (called <italic>centroid data set</italic> for convenience). Since the public data was acquired in centroid mode, no additional centroiding procedure in ProteoWizard was performed.</p>
      <p>Both profile and centroid data sets of standard mixture were processed by four tools. iMet-Q automatically skipped centroiding step when processing the centroid data set and used the following parameter setting: mzWidth = 0.02, mzTol = 0.02, and rtTol = 0.2 for both data sets. For XCMS, peaks in the profile and centroid data sets were first detected using <italic>matchedFilter</italic> and c<italic>entWave</italic> function, respectively. Then the <italic>rector</italic>.<italic>loess</italic> and <italic>group</italic>.<italic>density</italic> functions were then applied to align the detected peaks across samples. An additional <italic>fillPeaks</italic> fuction was performed for the recovery of missing peaks as suggested by the package vignette of XCMS. To optimize the XCMS parameters, 42 parameter combinations were examined using the standard metabolites in the standard mixture as benchmarks. The examination results of the 42 parameter combinations are listed in <xref rid="pone.0146112.s006" ref-type="supplementary-material">S1</xref> and <xref rid="pone.0146112.s007" ref-type="supplementary-material">S2</xref> Tables, and the quantitation results generated using those parameter combinations are provided in <xref rid="pone.0146112.s001" ref-type="supplementary-material">S1</xref> and <xref rid="pone.0146112.s002" ref-type="supplementary-material">S2</xref> Files. The optimized XCMS parameters on peak picking are: method = matchedFilter, fwhm = 30, snthresh = 10 for profile dataset; and method = centWave, ppm = 45, snthresh = 10, peakwidth = (5,20) for centroid dataset. The optimized XCMS parameters for both profile and centroid data sets on retention time correction and peak grouping are: method = loess, span = .67; and method = "density", mzwid = 0.03, bw = 3, minfrac = 0, minsamp = 0. MetAlign only accepts and processes the centroid data set. To run MetAlign, we selected the data type of accurate mass data with mass resolution of 10,000 and applied the default settings for the remaining parameters. In MZmine 2, the <italic>exact mass detector</italic> function and the <italic>centroid mass detector</italic> function were first applied to process the profile and centroid data sets, respectively, both with a noise level of 1,000,000. Then the following functions were applied using the same parameters to process both data sets. The chromatogram builder was used with the minimum time span, minimum height, and <italic>m/z</italic> tolerance set to be 0, 0 and 0.02, respectively. For chromatogram deconvolution, baseline cut-off algorithm was used to detect peaks, where the minimum peak height, peak duration length, and baseline level were 1,000,000, 0–2 min, and 1,000,000, respectively. The <italic>m/z</italic> and retention time tolerances in both isotopic peaks grouper and peak alignment were 0.02 and 0.2 min, respectively.</p>
      <p>Public Arabidopsis data set was processed by iMet-Q with mzWidth, mzTol, and rtTol of 0.03, 0.03, and 0.16 min, respectively. We used the XCMS c<italic>entWave</italic> function for peak detection, <italic>rector</italic>.<italic>loess</italic> and <italic>group</italic>.<italic>density</italic> functions for peak alignment, and <italic>fillPeaks</italic> function for the recovery of missing peaks. To optimize XCMS parameters on the public Arabidopsis positive- and negative-mode data sets, 37 parameter combinations were examined on each set and the parameter combination achieving the best quantitation performance was selected. The examination results of the parameter combinations are listed in <xref rid="pone.0146112.s008" ref-type="supplementary-material">S3</xref> and <xref rid="pone.0146112.s009" ref-type="supplementary-material">S4</xref> Tables, and the quantitation results generated using those parameter combinations are provided in <xref rid="pone.0146112.s003" ref-type="supplementary-material">S3</xref> and <xref rid="pone.0146112.s004" ref-type="supplementary-material">S4</xref> Files. Both data sets used centWave method in peak picking and the optimized XCMS parameters for Arabidopsis positive- and negative-mode datasets are: ppm = 30, snthresh = 10, peakwidth = (25, 40); and ppm = 20, snthresh = 10, peakwidth = (5, 20), respectively. Next, in retention time correction and peak grouping, the optimized XCMS parameters for both profile and centroid data sets are: method = loess, span = .67; and method = "density", mzwid = 0.03, bw = 3, minfrac = 0, minsamp = 0. For MetAlign, we selected the data type of accurate mass data with mass resolution of 9,000 and applied the following parameter settings for data processing: maximum amplitude = 10,000, peak slope factor = 1, peak threshold factor = 6, average peak width at half weight = 8, maximum shift per scan = 35, select min nr per peak set = 4, and scaling options = none. In MZmine 2, we used the centroid mass detector with a noise level of 6. The minimum time span, minimum height, and <italic>m/z</italic> tolerance in the chromatogram builder were set to be 0.1 min, 6 and 0.03, respectively. For chromatogram deconvolution, baseline cut-off algorithm was used to detect peaks, where the minimum peak height, peak duration length, and baseline level were 6, 0–1.6 (min), and 6, respectively. The <italic>m/z</italic> and retention time tolerances in both isotopic peaks grouper and peak alignment were 0.03 and 0.16 min, respectively. Detected peaks by each tool were retained in the quantitation results if their retention time values were within the effective retention time range (i.e., 0.85 to 12 min) and the peaks were detected in at least one sample.</p>
    </sec>
    <sec id="sec009">
      <title>Robust algorithms for metabolite quantitation</title>
      <p>In order to process data from various mass spectrometers, iMet-Q accepts input files in netCDF, mzXML, and mzML formats, which can be conveniently converted from raw data by existing converters. Also, it accepts profile-mode and centroid-mode data. The workflow of iMet-Q contains two main tasks, peak detection and peak alignment, as depicted in <xref rid="pone.0146112.g001" ref-type="fig">Fig 1</xref>. Performing peak detection on each input file generates a peak list that reports the <italic>m/z</italic>, retention time, charge state, isotope ratio, and abundance of detected peaks. To compare compounds across different samples, iMet-Q aligns the detected peaks in the peak lists according to their <italic>m/z</italic> and retention time. The detailed procedures of peak detection, peak alignment and quantitation result generation are described below.</p>
      <fig id="pone.0146112.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Schematic depiction of iMet-Q workflow for peak detection and peak alignment.</title>
        </caption>
        <graphic xlink:href="pone.0146112.g001"/>
      </fig>
    </sec>
    <sec id="sec010">
      <title>Peak Detection</title>
      <sec id="sec011">
        <title>Centroiding signals in each scan</title>
        <p>Centroiding, which can be performed during or after data acquisition, is a common first step for processing metabolomics data so that the data size can be greatly reduced. It aims at combining multiple signals from the same compound into a single one with an <italic>m/z</italic> and intensity value [<xref rid="pone.0146112.ref032" ref-type="bibr">32</xref>]. If the input files have already been centroided, iMet-Q automatically skips this step. The detailed algorithm description is listed in <xref rid="pone.0146112.s005" ref-type="supplementary-material">S1 Section</xref>.</p>
      </sec>
      <sec id="sec012">
        <title>Removing noises from each scan</title>
        <p>Due to nonspecific nature of ESI, a great portion of signals in the spectra could be noise [<xref rid="pone.0146112.ref033" ref-type="bibr">33</xref>]. It is essential to remove these noises to increase the effectiveness of peak detection. Instead of determining a fixed baseline for each spectrum, iMet-Q equally divides a scan into <italic>s</italic> segments (<italic>s</italic> = 10 by default) with an overlap of 20% to avoid borderline issues and defines the average intensity in a segment as its noise level. Then, for each segment, signals with S/N less than a specific threshold (3 by default) are removed from the scan, where S is the signal intensity and N is the noise level in the segment. The number of segments and the S/N threshold are user-adjustable.</p>
      </sec>
      <sec id="sec013">
        <title>Constructing extracted ion chromatograms (EIC) with dynamically determining peak width</title>
        <p>After processing signals in each scan, iMet-Q uses a two-stage algorithm to construct the extracted ion chromatogram (EIC) of a compound. The two-stage algorithm includes signal clustering and EIC boundary determination. Let <inline-formula id="pone.0146112.e001"><alternatives><graphic xlink:href="pone.0146112.e001.jpg" id="pone.0146112.e001g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>}</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> be the list of signals in all scans, where <italic>m</italic> is the total number of scans and <italic>n</italic><sub><italic>k</italic></sub> is the number of signals in the <italic>k</italic><sup>th</sup> scan. In signal clustering, starting from the most intensive signal, say <inline-formula id="pone.0146112.e002"><alternatives><graphic xlink:href="pone.0146112.e002.jpg" id="pone.0146112.e002g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, among all scans in <italic>S</italic>, iMet-Q clusters signals in <italic>S</italic> with <inline-formula id="pone.0146112.e003"><alternatives><graphic xlink:href="pone.0146112.e003.jpg" id="pone.0146112.e003g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> if the <italic>m/z</italic> differences between the signals and <inline-formula id="pone.0146112.e004"><alternatives><graphic xlink:href="pone.0146112.e004.jpg" id="pone.0146112.e004g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are within the given tolerance <italic>d</italic>, i.e., mzWidth in iMet-Q. A cluster with at least three signals is further processed. In the step of EIC boundary determination, iMet-Q automatically calculates FWHM and then dynamically determines the boundaries using FWHM. To be specific, for the most intensive signal in a cluster, say <inline-formula id="pone.0146112.e005"><alternatives><graphic xlink:href="pone.0146112.e005.jpg" id="pone.0146112.e005g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, with retention time <italic>t</italic>, the boundaries of the EIC are initially determined as <italic>t</italic> ± <italic>w</italic>, where <italic>w</italic> is the FWHM. To adapt to possible tailing effect of an EIC, the boundaries are further extended by a tolerance at most 0.5<italic>w</italic> and are set to the farthest signal or a signal with local-minimum intensity in this range (as shown in <xref rid="pone.0146112.g002" ref-type="fig">Fig 2</xref>). Then the trapezoid areas between any two adjacent signals of the EIC are summed up as the abundance. The two-stage algorithm is iteratively performed on the remaining unclustered signals to construct EICs until all signals in <italic>S</italic> are processed. In the following subsections, we term the constructed EICs as peaks for convenience. Furthermore, each peak is represented by its apex, i.e., using the m/z, retention time of the apex signal, and the associated abundance is recorded.</p>
        <fig id="pone.0146112.g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>A cartoon for the illustration of constructing extracted ion chromatograms.</title>
            <p>The blue straight lines represent the clustered signals, <italic>w</italic> and <italic>t</italic> are the FWHM and retention time of <inline-formula id="pone.0146112.e006"><alternatives><graphic id="pone.0146112.e006g" xlink:href="pone.0146112.e006"/><mml:math id="M6"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, respectively. Signal A and B are determined as the boundaries of the EIC, and the area in light blue color is the abundance.</p>
          </caption>
          <graphic xlink:href="pone.0146112.g002"/>
        </fig>
      </sec>
      <sec id="sec014">
        <title>Determining the charge state and isotope ratio of peaks</title>
        <p>In order to determine the charge state and isotope ratio, iMet-Q first constructs an isotope envelope for a peak. Starting from the most intensive peak, <italic>P</italic><sub><italic>1</italic></sub>, in the current peak list, our tool groups it with all of its neighboring peaks having larger <italic>m/z</italic> values and decreasing intensities, i.e., forming an isotope group. If the <italic>m/z</italic> distance between the apex of any two peaks in the isotope group equals to 1/<italic>z</italic> (<italic>z</italic> can be 1~4), the group is considered as a possible isotope envelope, where <italic>P</italic><sub><italic>1</italic></sub> and the peak adjacent to <italic>P</italic><sub><italic>1</italic></sub> are considered as the monoisotope peak and the second isotope peak, respectively. Then, to validate the correctness of the isotope envelope, iMet-Q calculates the peak shape similarity between the monoisotope peak and the second isotope peak by using the dot product as shown below:
<disp-formula id="pone.0146112.e007"><alternatives><graphic xlink:href="pone.0146112.e007.jpg" id="pone.0146112.e007g" position="anchor" mimetype="image" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic>n</italic> is the number of scans that both the monoisotope peak and the second isotope peak co-occur, and <italic>x</italic><sub><italic>i</italic></sub> and <italic>y</italic><sub><italic>i</italic></sub> are their respective signal intensities in the <italic>i</italic><sup>th</sup> scan. If the peak shape similarity between the two peaks is above a user-defined threshold (0.8 by default), we consider that all of the peaks in the isotope group form an isotope envelope and the charge state of <italic>P</italic><sub>1</sub> is determined as <italic>z</italic>. Moreover, the isotope ratio of <italic>P</italic><sub><italic>1</italic></sub> is calculated as the abundance of the second isotope peak divided by the abundance of <italic>P</italic><sub><italic>1</italic></sub>, and the peaks in the isotope group are removed from further processing. Otherwise, the peaks do not form an isotope envelope and the charge state and isotope ratio of <italic>P</italic><sub><italic>1</italic></sub> are denoted as 0. The charge state determination procedure is repeatedly performed until all peaks are processed.</p>
        <p>By performing the above peak detection procedures, iMet-Q generates a peak list with charge state and isotope ratio information for each input replicate file. Note that the isotope peaks except the monoisotope in the confirmed isotope envelopes will not be reported in the peak list.</p>
      </sec>
    </sec>
    <sec id="sec015">
      <title>Peak Alignment</title>
      <p>For an input data set with multiple samples (each probably with multiple technical replicates), iMet-Q performs the same algorithm for pair-wise alignment within a sample (i.e., aligning replicates) and then across samples. The algorithm is described as follows.</p>
      <p>iMet-Q first selects the peak list that contains the largest number of detected peaks as the reference list and aligns other peak lists to it. For a pair of reference list and aligning peak list, iMet-Q uses peaks detected in both lists with their <italic>m/z</italic> and retention time differences within user-defined tolerances (i.e., mzTol and rtTol in iMet-Q) as landmarks [<xref rid="pone.0146112.ref034" ref-type="bibr">34</xref>]. Given the retention time of landmarks in the reference list and in the aligning peak list as vectors A and B, respectively, iMet-Q uses LOESS regression [<xref rid="pone.0146112.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0146112.ref027" ref-type="bibr">27</xref>] to generate a mapping between A and B with span of 20% and weight of 1 since LOESS regression combines multiple linear least square regression models which fit localized subsets of the data. The retention time of peaks, which are not landmarks, in either peak list are adjusted according to the LOESS regression model. iMet-Q then aligns the peaks in both peak lists that satisfy user-defined <italic>m/z</italic> tolerance and retention time tolerance based on adjusted retention time.</p>
      <p>Repeating the above process for all peak lists, peaks can be aligned across replicates. Since peaks aligned from different replicates in a sample may have slightly different values of <italic>m/z</italic> and retention time, we use the <italic>median</italic> of their <italic>m/z</italic> and retention time as the representative peak in each sample. Then the same algorithm is applied to align all of the representative peaks across samples.</p>
    </sec>
    <sec id="sec016">
      <title>Generating output of quantitation results</title>
      <p>In addition to viewing quantitation results in the main interface, iMet-Q reports the medians of <italic>m/z</italic>, retention time and abundance of the peaks in all replicates of all samples. For the charge state of an aligned peak, iMet-Q displays the charge state that is detected in most replicates. For the isotope ratio, iMet-Q collects the isotope ratios corresponding to the displayed charge state and reports the median as the isotope ratio. Quantitation results can be exported in.csv and.txt formats by users to conduct further analyses.</p>
    </sec>
  </sec>
  <sec id="sec017">
    <title>Results and Discussion</title>
    <p>We evaluated the performance of iMet-Q in metabolite quantitation by comparing the accuracy of detecting metabolites and the abundance consistency, calculated by Pearson product-moment correlation coefficient (PPMCC), of detected metabolites among replicates with XCMS, MetAlign, and MZmine 2 using samples ranging from a small standard data set (seven standard metabolites) to a complex biological data set (public Arabidopsis data set). We also demonstrated the ability of iMet-Q on charge state determination and isotope ratio calculation.</p>
    <sec id="sec018">
      <title>Performance evaluation on a standard metabolite mixture data</title>
      <p>To demonstrate the ability of iMet-Q, we used a standard metabolite mixture in which seven standard metabolites with different sample concentration in two samples were included for evaluation. The sample ratio, defined as the detected abundance of a standard metabolite in Sample 1 divided by that in Sample 2, is calculated for each of the seven metabolites in the standard metabolite mixture for the four quantitation tools. Both profile and centroid data sets generated from the raw data were processed by iMet-Q, XCMS, MetAlign, and MZmine 2, respectively. Algorithms and parameter settings used in these tools were described in the subsection of <italic>Data Processing and Software Parameter Settings</italic>. <xref rid="pone.0146112.t001" ref-type="table">Table 1</xref> shows the quantitation errors, which is defined as the difference between theoretical and calculated sample ratios divided by the theoretical sample ratios, of the seven standard metabolites calculated by the four quantitation tools. Detailed abundances and sample ratios calculated by the four tools are listed in <xref rid="pone.0146112.s010" ref-type="supplementary-material">S5 Table</xref>.</p>
      <table-wrap id="pone.0146112.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>The quantitation error (%) of seven standard metabolites calculated by iMet-Q, XCMS, MetAlign, and MZmine 2.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0146112.t001g" xlink:href="pone.0146112.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1"/>
                <th colspan="8" align="center" rowspan="1">Quantitation error (%)<xref rid="t001fn001" ref-type="table-fn"><sup>a</sup></xref></th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1"/>
                <th colspan="2" align="center" rowspan="1">iMet-Q</th>
                <th colspan="2" align="center" rowspan="1">XCMS</th>
                <th colspan="2" align="center" rowspan="1">MetAlign</th>
                <th colspan="2" align="center" rowspan="1">MZmine 2</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">Standard Compound</th>
                <th align="center" rowspan="1" colspan="1">Theoretical Sample Ratio</th>
                <th align="center" rowspan="1" colspan="1">Profile</th>
                <th align="center" rowspan="1" colspan="1">Centroid</th>
                <th align="center" rowspan="1" colspan="1">Profile</th>
                <th align="center" rowspan="1" colspan="1">Centroid</th>
                <th align="center" rowspan="1" colspan="1">Profile</th>
                <th align="center" rowspan="1" colspan="1">Centroid</th>
                <th align="center" rowspan="1" colspan="1">Profile</th>
                <th align="center" rowspan="1" colspan="1">Centroid</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">L-hisitidine</td>
                <td align="center" rowspan="1" colspan="1">0.50</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">12</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">L-Carnosine</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">9</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="center" rowspan="1" colspan="1">7</td>
                <td align="center" rowspan="1" colspan="1">50</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">11</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="center" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Creatine</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">18</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">11</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Caffine</td>
                <td align="center" rowspan="1" colspan="1">1.00</td>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">16</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">16</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Hippuric acid</td>
                <td align="center" rowspan="1" colspan="1">0.20</td>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">105</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">20</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Glycocholic acid</td>
                <td align="center" rowspan="1" colspan="1">0.20</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">30</td>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="center" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Cholic acid</td>
                <td align="center" rowspan="1" colspan="1">0.33</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">24</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">24</td>
                <td align="center" rowspan="1" colspan="1">24</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">Average</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">32</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">13</td>
                <td align="center" rowspan="1" colspan="1">14</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p><sup>a</sup>Quantitation error (%) = (|Theoretical Sample Ratio–Calculated Sample Ratio|) x100/ Theoretical Sample Ratio.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>As shown in <xref rid="pone.0146112.t001" ref-type="table">Table 1</xref>, iMet-Q, XCMS, and MZmine 2 had the average quantitation error of 12%, 12% and 13% on the profile data set, and 12%, 32% and 14% on the centroid data set. MetAlign did not process the profile data set and had the average quantitation error of 14% on the centroid data set. The results showed that iMet-Q achieved the smallest quantitation errors and also had the same average quantitation error of 12% in both profile and centroid data set, suggesting the robustness of iMet-Q on processing input files in both data type.</p>
      <p>In addition to accurate quantitation, iMet-Q determined the charge state and isotope ratio of detected peaks. In order to evaluate the charge state determined by iMet-Q, we used CAMERA to annotate charge states and isotope peaks of the standard metabolites. Charge states and isotope peaks of the seven standard metabolites in both profile and centroid data sets annotated by iMet-Q were overall identical with CAMERA’s annotation.</p>
      <p>To demonstrate possible usefulness of isotope ratio information, we searched the mass of seven standard metabolites against HMDB [<xref rid="pone.0146112.ref030" ref-type="bibr">30</xref>] with mass tolerance of ±5 ppm and adduct type of unknown (assuming a user has little information on the spectra). As a result, 183 metabolites candidates were obtained. Using iMet-Q’s calculated isotope ratios (the isotope ratio tolerance is ±0.02) to filter out unnecessary metabolite candidates, we reduced 49% (89 out of 183) metabolite candidates (<xref rid="pone.0146112.s011" ref-type="supplementary-material">S6 Table</xref>). The remaining metabolite candidates could not be filtered out by isotope ratios because they have the same chemical formula (i.e., identical theoretical isotope ratios).</p>
    </sec>
    <sec id="sec019">
      <title>Performance evaluation on a public Arabidopsis metabolome data</title>
      <p>The public Arabidopsis data of 36 distinct samples collected from eight different plant classes (classified by Matsuda <italic>et al</italic>.) was used to demonstrate iMet-Q’s performance on quantifying complex biological samples. Each sample contained two internal standards, one for positive- and the other for negative-ion modes, and 167 metabolites (71 detected only in positive-ion mode, 39 only in negative-ion mode, and 57 in both modes) were elucidated from the data set [<xref rid="pone.0146112.ref028" ref-type="bibr">28</xref>]. The performance of four tools were evaluated in terms of the accuracy on detecting the two internal standards and 167 elucidated metabolites, and the ability of properly clustering 36 samples into eight plant classes.</p>
      <p><xref rid="pone.0146112.t002" ref-type="table">Table 2</xref> shows the reproducibility and normalized abundances of two internal standards detected by the four quantitation tools, where iMet-Q, XCMS, and MetAlign detected all the internal standards from each replicate, achieving 100% reproducibility, slightly better than MZmine 2. Furthermore, iMet-Q reported normalized abundances of 1±0.19 and 1±0.18 for the two standard metabolites, comparable to the best 1±0.18 reported by XCMS and MZmine 2 for Lidocaine and the best 1±0.17 reported by XCMS for Camphor-10-sulfonic acid.</p>
      <table-wrap id="pone.0146112.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>The reproducibility (Rep.) and normalized abundance (Abund.) of two internal standards detected by four quantitation tools.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0146112.t002g" xlink:href="pone.0146112.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th colspan="2" align="center" rowspan="1">Lidocaine</th>
                <th colspan="2" align="center" rowspan="1">Camphor-10-sulfonic acid</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">Rep. (%)</th>
                <th align="center" rowspan="1" colspan="1">Abund.</th>
                <th align="center" rowspan="1" colspan="1">Rep. (%)</th>
                <th align="center" rowspan="1" colspan="1">Abund.</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">iMet-Q</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.19</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.18</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">XCMS</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.18</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.17</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">MetAlign</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.20</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.22</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">MZmine 2</td>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">1±0.18</td>
                <td align="center" rowspan="1" colspan="1">85</td>
                <td align="center" rowspan="1" colspan="1">1±0.46</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>For 167 elucidated metabolites, we searched their <italic>m/z</italic> and retention time values provided in [<xref rid="pone.0146112.ref028" ref-type="bibr">28</xref>] against the quantitation results of the four tools with m/z and retention time tolerances of 0.05 m/z and 9 seconds. As a result, iMet-Q detected all of the elucidated metabolites, whereas XCMS, MetAlign, and MZmine 2 detected 103 (62%), 145 (87%), and 129 (77%) of the elucidated metabolites, respectively. We further evaluated the detected abundance of these metabolites. Since the exact abundance of 167 elucidated metabolites was unknown, we calculated the abundance correlation between any two replicates of a sample by PPMCC. As a result, iMet-Q achieved an average replicate abundance correlation of 0.92, whereas XCMS, MetAlign, and MZmine 2 achieved average abundance correlations of 0.87, 0.78, and 0.81, respectively (as shown in <xref rid="pone.0146112.g003" ref-type="fig">Fig 3</xref>). The result revealed that iMet-Q not only achieved high accuracy on detecting the 167 elucidated metabolites but also provided very consistent quantitation result.</p>
      <fig id="pone.0146112.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>The box plot of abundance correlation of 167 elucidated metabolites across replicates in the public Arabidopsis data detected by the four quantitation tools.</title>
        </caption>
        <graphic xlink:href="pone.0146112.g003"/>
      </fig>
      <p>Next, we examined whether replicates of the 36 samples could be properly clustered into eight plant classes using the quantitation results of the four tools. We combined the quantitation results from positive- and negative-ion modes, and performed hierarchical clustering using MATLAB <italic>dendrogram</italic> function with PPMCC as the abundance correlation measure. The combined quantitation results of the four tools are provided in <xref rid="pone.0146112.s012" ref-type="supplementary-material">S7</xref>–<xref rid="pone.0146112.s015" ref-type="supplementary-material">S10</xref> Tables. The numbers of detected peaks in the combined quantitation results of iMet-Q, XCMS, MetAlign, and MZmine 2 were 13079, 7487, 37364, and 19394, respectively. <xref rid="pone.0146112.g004" ref-type="fig">Fig 4</xref> shows the hierarchical clustering results of the four tools. The average abundance correlations of the eight plant classes using the combined quantitation results of iMet-Q, XCMS, MetAlign, and MZmine 2 were 0.71, 0.75, 0.65, and 0.59, respectively. The detailed average abundance correlation of each plant class is shown in <xref rid="pone.0146112.s016" ref-type="supplementary-material">S11 Table</xref>. Note that all the replicates of flower class, the best clustered plant class (blue color in <xref rid="pone.0146112.g004" ref-type="fig">Fig 4</xref>), were clustered using iMet-Q’s combined quantitation result, and the average abundance correlation of the flower class was 0.88. This evaluation implies that, although the numbers of peaks detected by MetAlign and MZmine 2 were much larger than those detected by iMet-Q and XCMS, peaks detected by iMet-Q and XCMS might be more essential for distinguishing plant classes.</p>
      <fig id="pone.0146112.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Hierarchical clustering by using the quantitation results of iMet-Q, XCMS, MetAlign, and MZmine 2.</title>
          <p>Each entry in the tree leaves of a dendrogram represents a replicate. For each tool, we first combined its quantitation results of positive- and negative-ion modes. Colors were assigned to each replicate in the combined quantitation results according to the plant classes which the replicates originated from as follows: orange for cotyledon, red for stem, green for leaf, blue for flower, light blue for shoot apex, yellow for root, pink for seed, and gray for silique. Next, the figure was produced using MATLAB <italic>dendrogram</italic> function with PMMCC as the abundance correlation measure between any two replicates in the combined quantitation results.</p>
        </caption>
        <graphic xlink:href="pone.0146112.g004"/>
      </fig>
      <p>To overcome the bottleneck in metabolite identification based on MS1 data, a method utilizing both isotope ratio and in-source fragment information has been recently proposed, in which the same Arabidopsis metabolome data set was also used for identification performance evaluation [<xref rid="pone.0146112.ref035" ref-type="bibr">35</xref>]. According to the study, 19 out of 167 elucidated metabolites have been confirmed that some of their in-source fragments were detected in MS1 scans [<xref rid="pone.0146112.ref035" ref-type="bibr">35</xref>], and the abundance correlations between the 19 metabolites and their fragments were above 0.8. We thus used the 19 confirmed metabolites to demonstrate the ability of iMet-Q. By calculating the abundance correlations between 19 metabolites and their in-source fragments, iMet-Q reported an abundance correlation of 0.94, whereas XCMS, MetAlign, and MZmine 2 reported abundance correlations of 0.61, 0.76, and 0.66, respectively (as shown in <xref rid="pone.0146112.g005" ref-type="fig">Fig 5</xref>). This result revealed that the abundances of the 19 metabolites and their in-source fragments were accurately detected and calculated by iMet-Q. Furthermore, isotope ratios of 89.47% (17 out of 19) metabolites were accurately calculated by iMet-Q, with differences within 0.05 to the theoretical ratio (<xref rid="pone.0146112.s017" ref-type="supplementary-material">S12 Table</xref>).</p>
      <fig id="pone.0146112.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>The box plot of abundance correlations between 19 verified metabolites and their in-source fragments detected in the public Arabidopsis data.</title>
        </caption>
        <graphic xlink:href="pone.0146112.g005"/>
      </fig>
    </sec>
    <sec id="sec020">
      <title>Friendly User Interfaces of iMet-Q</title>
      <p>We particularly implemented iMet-Q as a project-oriented quantitation platform, allowing users to conveniently quantify, manage and compare a large number of data sets or quantitation results in Microsoft Windows series platform (including Windows 7, 8, and Windows Server 2008, 2012). To be specific, iMet-Q applies a tree structure to organize quantitation results, where each node represents a project and sub-nodes of a project represent the quantitation results (as shown in <xref rid="pone.0146112.g006" ref-type="fig">Fig 6</xref>).</p>
      <fig id="pone.0146112.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0146112.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>The main graphical user interface of Metab-Q.</title>
          <p>The Arabidopsis data from positive-ion mode is used as an example. After processing the data, Metab-Q lists the detected peaks in the summary table where the peaks are sorted according to their retention time. When users select peaks of interest in the summary table, the abundances of the selected peaks in different samples are plotted in the sample abundance plot and the detailed information of the selected peak in the technical replicates of a sample is listed in the panel below the summary table. The left panel is the quantitation parameter explorer that lists the parameters of a quantitation. Users can use the provided filter function to narrow down the number of peaks in the summary table.</p>
        </caption>
        <graphic xlink:href="pone.0146112.g006"/>
      </fig>
      <p>iMet-Q provides three wizards to guide users easily executing the program as follows. First, a <italic>project wizard</italic> guides a user to create a project and designate a folder to store the project. Second, a <italic>quantitation wizard</italic> guides the user to quantify LC-MS-based data. The wizard only requires the user to set up three quantitation parameters, i.e., mzWidth, mzTol, and rtTol; other parameters are optional. Since multiple technical replicates may be conducted on a sample, iMet-Q pops up a table to guide users to group technical replicates by the sample. During quantitation, iMet-Q sequentially detects peaks from each replicate and then aligns those detected peaks across replicates/samples. Third, an <italic>export wizard</italic> guides the user to export quantitation results in common output formats, including.csv and.txt. It also allows users to name the quantitation, designate the file for exporting, and set up criteria for filtering out unwanted peaks in order to focus on peaks of interest. With the conventional output formats, the user can easily import the quantitation results to other available tools, such as Microsoft Excel and Matlab, for further statistical analysis.</p>
      <p>To compare abundances across samples, iMet-Q hierarchically displays a quantitation result in the main interface, where the quantitation result is summarized in a summary table. The summary table lists the <italic>m/z</italic>, retention time, charge state, isotope ratio, and abundance of all detected peaks in all samples for a quick overview. The user can click on a detected peak of interest in the summary table, and the sample abundances of the selected peak will be plotted in the upper panel above the summary table. Meanwhile, the detailed information of the selected peak in the technical replicates of a sample will be listed in the panel below the summary table. The user can double-click a row in the replicate table to view the extracted ion chromatogram of the peak. In order to efficiently select peaks of interest in the summary table, iMet-Q provides a search function using the range of <italic>m/z</italic>, retention time, charge state, or isotope ratio to narrow down the peaks listed in the summary table.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec021">
    <title>Conclusions</title>
    <p>Many state-of-the-art quantitation tools have been proposed to allow users automatically quantifying metabolites from large-scale label-free metabolomics data sets. The quantitation ability of these tools is beyond doubt. However, a major concern of using these tools is the parameter setting for peak detection. Since peak shapes vary greatly from one to another, it is difficult for users to select an optimized parameter setting for peak detection. In addition, most of the tools do not provide deisotoping, and thus users have to apply additional packages for isotope pattern assembly. Therefore, in this paper, we introduced an intelligent quantitation tool, iMet-Q, which is capable of dynamically determining the peak widths in liquid chromatogram dimension without input parameter, and automatically performing isotope pattern assembly. In our evaluation, iMet-Q has the quantitation performance better than XCMS, MetAlign, and MZmine 2 on standard and large-scale metabolome data sets. Besides, iMet-Q provides both the charge states and isotope ratios of detected peaks. With the charge state information, users can obtain accurate masses of detected peaks. Meanwhile, the isotope ratio information provides users an opportunity to reduce metabolite candidates. Although our evaluation demonstrates that the metabolite isotope ratios calculated by iMet-Q are close to the theoretical values, it is important to note that isotope ratio can be affected by noise interference, saturation effects and different experimental conditions [<xref rid="pone.0146112.ref036" ref-type="bibr">36</xref>, <xref rid="pone.0146112.ref037" ref-type="bibr">37</xref>]. In addition to providing accurate quantitation, charge state, and isotope ratios, iMet-Q is equipped with friendly user interfaces so that quantifying metabolites become an easy task. The software program is now publicly available for download at <ext-link ext-link-type="uri" xlink:href="http://ms.iis.sinica.edu.tw/comics/Software_iMet-Q.html">http://ms.iis.sinica.edu.tw/comics/Software_iMet-Q.html</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec022">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0146112.s001">
      <label>S1 File</label>
      <caption>
        <title>The XCMS quantitation results of the standard metabolite mixture (profile mode) under five different parameter settings.</title>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0146112.s001.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s002">
      <label>S2 File</label>
      <caption>
        <title>The XCMS quantitation results of the standard metabolite mixture (centroid mode) under 37 different parameter settings.</title>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0146112.s002.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s003">
      <label>S3 File</label>
      <caption>
        <title>The XCMS quantitation results of the public Arabidopsis dataset (positive mode) under 37 different parameter settings.</title>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0146112.s003.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s004">
      <label>S4 File</label>
      <caption>
        <title>The XCMS quantitation results of the public Arabidopsis dataset (negative mode) under 37 different parameter settings.</title>
        <p>(7Z)</p>
      </caption>
      <media xlink:href="pone.0146112.s004.7z">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s005">
      <label>S1 Section</label>
      <caption>
        <title>The detailed description of centroiding signals in each scan.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0146112.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s006">
      <label>S1 Table</label>
      <caption>
        <title>The sample ratio of each metabolite under different fwhm (for Standard Mixture-profile).</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s006.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s007">
      <label>S2 Table</label>
      <caption>
        <title>The sample ratio of each metabolite under different centWave parameters (for Standard Mixture-centroid).</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s007.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s008">
      <label>S3 Table</label>
      <caption>
        <title>The reproducibility and abundance consistency of the internal standard (lidocaine) in Arabidopsis data set (positive mode) under different centWave parameters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s008.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s009">
      <label>S4 Table</label>
      <caption>
        <title>The reproducibility and abundance consistency of the internal standard (camphor-10-sulfonic acid) in Arabidopsis data set (negative mode) under different centWave parameters.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s009.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s010">
      <label>S5 Table</label>
      <caption>
        <title>The abundances of seven standard metabolites detected from profile and centroid data set using four quantitation tools.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s011">
      <label>S6 Table</label>
      <caption>
        <title>The number of metabolite candidates of the seven standard metabolites using (1) mass match, and (2) mass and isotope ratio (IR) match.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s011.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s012">
      <label>S7 Table</label>
      <caption>
        <title>The combined quantitation result generated using iMet-Q.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s012.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s013">
      <label>S8 Table</label>
      <caption>
        <title>The combined quantitation result generated using XCMS.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s013.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s014">
      <label>S9 Table</label>
      <caption>
        <title>The combined quantitation result generated using MetAlign.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s014.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s015">
      <label>S10 Table</label>
      <caption>
        <title>The combined quantitation result generated using MZmine 2.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s015.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s016">
      <label>S11 Table</label>
      <caption>
        <title>The average abundance correlations of the eight plant classes using the quantitation results obtained from iMet-Q, XCMS, MetAlign, and MZmine 2.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s016.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0146112.s017">
      <label>S12 Table</label>
      <caption>
        <title>The isotope ratio of the 19 identified metabolites in the public Arabidopsis data set.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pone.0146112.s017.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the support from Academia Sinica, Ministry of Science and Technology of Taiwan (MOST 103-2221-E-001-037), and Taiwan International Graduate Program. We also thank Wai-Kok Choong and Thejkiran Pitti for fruitful discussion on the manuscript.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0146112.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Ellis</surname><given-names>DI</given-names></name>, <name><surname>Dunn</surname><given-names>WB</given-names></name>, <name><surname>Griffin</surname><given-names>JL</given-names></name>, <name><surname>Allwood</surname><given-names>JW</given-names></name>, <name><surname>Goodacre</surname><given-names>R</given-names></name>. <article-title>Metabolic fingerprinting as a diagnostic tool</article-title>. <source>Pharmacogenomics</source>. <year>2007</year><month>9</month>;<volume>8</volume>(<issue>9</issue>):<fpage>1243</fpage>–<lpage>66</lpage>. .<?supplied-pmid 17924839?><pub-id pub-id-type="pmid">17924839</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Patti</surname><given-names>GJ</given-names></name>, <name><surname>Yanes</surname><given-names>O</given-names></name>, <name><surname>Siuzdak</surname><given-names>G</given-names></name>. <article-title>Innovation: Metabolomics: the apogee of the omics trilogy</article-title>. <source>Nature reviews Molecular cell biology</source>. <year>2012</year><month>4</month>;<volume>13</volume>(<issue>4</issue>):<fpage>263</fpage>–<lpage>9</lpage>. Pubmed Central PMCID: 3682684. <pub-id pub-id-type="doi">10.1038/nrm3314</pub-id><?supplied-pmid 22436749?><pub-id pub-id-type="pmid">22436749</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Weiss</surname><given-names>RH</given-names></name>, <name><surname>Kim</surname><given-names>K</given-names></name>. <article-title>Metabolomics in the study of kidney diseases</article-title>. <source>Nature reviews Nephrology</source>. <year>2012</year><month>1</month>;<volume>8</volume>(<issue>1</issue>):<fpage>22</fpage>–<lpage>33</lpage>. .<?supplied-pmid 22025087?><pub-id pub-id-type="pmid">22025087</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Baker</surname><given-names>M</given-names></name>. <article-title>Metabolomics: from small molecules to big ideas</article-title>. <source>Nat Methods</source>. <year>2011</year><source>Feb</source>;<volume>8</volume>(<issue>2</issue>):<fpage>117</fpage>–<lpage>21</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Dunn</surname><given-names>WB</given-names></name>, <name><surname>Broadhurst</surname><given-names>DI</given-names></name>, <name><surname>Atherton</surname><given-names>HJ</given-names></name>, <name><surname>Goodacre</surname><given-names>R</given-names></name>, <name><surname>Griffin</surname><given-names>JL</given-names></name>. <article-title>Systems level studies of mammalian metabolomes: the roles of mass spectrometry and nuclear magnetic resonance spectroscopy</article-title>. <source>Chemical Society reviews</source>. <year>2011</year><month>1</month>;<volume>40</volume>(<issue>1</issue>):<fpage>387</fpage>–<lpage>426</lpage>. <pub-id pub-id-type="doi">10.1039/b906712b</pub-id><?supplied-pmid 20717559?><pub-id pub-id-type="pmid">20717559</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Madsen</surname><given-names>R</given-names></name>, <name><surname>Lundstedt</surname><given-names>T</given-names></name>, <name><surname>Trygg</surname><given-names>J</given-names></name>. <article-title>Chemometrics in metabolomics-A review in human disease diagnosis</article-title>. <source>Analytica Chimica Acta</source>. <year>2010</year><month>2</month><day>5</day>;<volume>659</volume>(<issue>1–2</issue>):<fpage>23</fpage>–<lpage>33</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2009.11.042</pub-id><?supplied-pmid WOS:000274046900004?><pub-id pub-id-type="pmid">20103103</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Issaq</surname><given-names>HJ</given-names></name>, <name><surname>Van</surname><given-names>QN</given-names></name>, <name><surname>Waybright</surname><given-names>TJ</given-names></name>, <name><surname>Muschik</surname><given-names>GM</given-names></name>, <name><surname>Veenstra</surname><given-names>TD</given-names></name>. <article-title>Analytical and statistical approaches to metabolomics research</article-title>. <source>Journal of separation science</source>. <year>2009</year><month>7</month>;<volume>32</volume>(<issue>13</issue>):<fpage>2183</fpage>–<lpage>99</lpage>. <pub-id pub-id-type="doi">10.1002/jssc.200900152</pub-id><?supplied-pmid 19569098?><pub-id pub-id-type="pmid">19569098</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Mamas</surname><given-names>M</given-names></name>, <name><surname>Dunn</surname><given-names>WB</given-names></name>, <name><surname>Neyses</surname><given-names>L</given-names></name>, <name><surname>Goodacre</surname><given-names>R</given-names></name>. <article-title>The role of metabolites and metabolomics in clinically applicable biomarkers of disease</article-title>. <source>Archives of toxicology</source>. <year>2011</year><month>1</month>;<volume>85</volume>(<issue>1</issue>):<fpage>5</fpage>–<lpage>17</lpage>. <pub-id pub-id-type="doi">10.1007/s00204-010-0609-6</pub-id><?supplied-pmid 20953584?><pub-id pub-id-type="pmid">20953584</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Roux</surname><given-names>A</given-names></name>, <name><surname>Lison</surname><given-names>D</given-names></name>, <name><surname>Junot</surname><given-names>C</given-names></name>, <name><surname>Heilier</surname><given-names>JF</given-names></name>. <article-title>Applications of liquid chromatography coupled to mass spectrometry-based metabolomics in clinical chemistry and toxicology: A review</article-title>. <source>Clinical biochemistry</source>. <year>2011</year><month>1</month>;<volume>44</volume>(<issue>1</issue>):<fpage>119</fpage>–<lpage>35</lpage>. <pub-id pub-id-type="doi">10.1016/j.clinbiochem.2010.08.016</pub-id><?supplied-pmid 20800591?><pub-id pub-id-type="pmid">20800591</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Theodoridis</surname><given-names>GA</given-names></name>, <name><surname>Gika</surname><given-names>HG</given-names></name>, <name><surname>Want</surname><given-names>EJ</given-names></name>, <name><surname>Wilson</surname><given-names>ID</given-names></name>. <article-title>Liquid chromatography-mass spectrometry based global metabolite profiling: a review</article-title>. <source>Analytica chimica acta</source>. <year>2012</year><month>1</month><day>20</day>;<volume>711</volume>:<fpage>7</fpage>–<lpage>16</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2011.09.042</pub-id><?supplied-pmid 22152789?><pub-id pub-id-type="pmid">22152789</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>B</given-names></name>, <name><surname>Xiao</surname><given-names>JF</given-names></name>, <name><surname>Tuli</surname><given-names>L</given-names></name>, <name><surname>Ressom</surname><given-names>HW</given-names></name>. <article-title>LC-MS-based metabolomics</article-title>. <source>Molecular bioSystems</source>. <year>2012</year><month>2</month>;<volume>8</volume>(<issue>2</issue>):<fpage>470</fpage>–<lpage>81</lpage>. Pubmed Central PMCID: 3699692. <pub-id pub-id-type="doi">10.1039/c1mb05350g</pub-id><?supplied-pmid 22041788?><pub-id pub-id-type="pmid">22041788</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Bedair</surname><given-names>M</given-names></name>, <name><surname>Sumner</surname><given-names>LW</given-names></name>. <article-title>Current and emerging mass-spectrometry technologies for metabolomics</article-title>. <source>Trac-Trend Anal Chem</source>. <year>2008</year><month>3</month>;<volume>27</volume>(<issue>3</issue>):<fpage>238</fpage>–<lpage>50</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Dakna</surname><given-names>M</given-names></name>, <name><surname>He</surname><given-names>Z</given-names></name>, <name><surname>Yu</surname><given-names>WC</given-names></name>, <name><surname>Mischak</surname><given-names>H</given-names></name>, <name><surname>Kolch</surname><given-names>W</given-names></name>. <article-title>Technical, bioinformatical and statistical aspects of liquid chromatography-mass spectrometry (LC-MS) and capillary electrophoresis-mass spectrometry (CE-MS) based clinical proteomics: a critical assessment</article-title>. <source>Journal of chromatography B, Analytical technologies in the biomedical and life sciences</source>. <year>2009</year><month>5</month><day>1</day>;<volume>877</volume>(<issue>13</issue>):<fpage>1250</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1016/j.jchromb.2008.10.048</pub-id><?supplied-pmid 19010091?><pub-id pub-id-type="pmid">19010091</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Blekherman</surname><given-names>G</given-names></name>, <name><surname>Laubenbacher</surname><given-names>R</given-names></name>, <name><surname>Cortes</surname><given-names>DF</given-names></name>, <name><surname>Mendes</surname><given-names>P</given-names></name>, <name><surname>Torti</surname><given-names>FM</given-names></name>, <name><surname>Akman</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Bioinformatics tools for cancer metabolomics</article-title>. <source>Metabolomics: Official journal of the Metabolomic Society</source>. <year>2011</year><month>9</month>;<volume>7</volume>(<issue>3</issue>):<fpage>329</fpage>–<lpage>43</lpage>. . Pubmed Central PMCID: 3155682.<?supplied-pmid 21949492?><pub-id pub-id-type="pmid">21949492</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Jaitly</surname><given-names>N</given-names></name>, <name><surname>Mayampurath</surname><given-names>A</given-names></name>, <name><surname>Littlefield</surname><given-names>K</given-names></name>, <name><surname>Adkins</surname><given-names>JN</given-names></name>, <name><surname>Anderson</surname><given-names>GA</given-names></name>, <name><surname>Smith</surname><given-names>RD</given-names></name>. <article-title>Decon2LS: An open-source software package for automated processing and visualization of high resolution mass spectrometry data</article-title>. <source>BMC bioinformatics</source>. <year>2009</year>;<volume>10</volume>:<fpage>87</fpage> Pubmed Central PMCID: 2666663. <pub-id pub-id-type="doi">10.1186/1471-2105-10-87</pub-id><?supplied-pmid 19292916?><pub-id pub-id-type="pmid">19292916</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Sugimoto</surname><given-names>M</given-names></name>, <name><surname>Hirayama</surname><given-names>A</given-names></name>, <name><surname>Ishikawa</surname><given-names>T</given-names></name>, <name><surname>Robert</surname><given-names>M</given-names></name>, <name><surname>Baran</surname><given-names>R</given-names></name>, <name><surname>Uehara</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>Differential metabolomics software for capillary electrophoresis-mass spectrometry data analysis</article-title>. <source>Metabolomics: Official journal of the Metabolomic Society</source>. <year>2010</year><month>3</month>;<volume>6</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>41</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Scalbert</surname><given-names>A</given-names></name>, <name><surname>Brennan</surname><given-names>L</given-names></name>, <name><surname>Fiehn</surname><given-names>O</given-names></name>, <name><surname>Hankemeier</surname><given-names>T</given-names></name>, <name><surname>Kristal</surname><given-names>BS</given-names></name>, <name><surname>van Ommen</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>Mass-spectrometry-based metabolomics: limitations and recommendations for future progress with particular focus on nutrition research</article-title>. <source>Metabolomics: Official journal of the Metabolomic Society</source>. <year>2009</year><month>12</month>;<volume>5</volume>(<issue>4</issue>):<fpage>435</fpage>–<lpage>58</lpage>. . Pubmed Central PMCID: 2794347.<?supplied-pmid 20046865?><pub-id pub-id-type="pmid">20046865</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>CA</given-names></name>, <name><surname>Want</surname><given-names>EJ</given-names></name>, <name><surname>O'Maille</surname><given-names>G</given-names></name>, <name><surname>Abagyan</surname><given-names>R</given-names></name>, <name><surname>Siuzdak</surname><given-names>G</given-names></name>. <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>. <source>Analytical chemistry</source>. <year>2006</year><month>2</month><day>1</day>;<volume>78</volume>(<issue>3</issue>):<fpage>779</fpage>–<lpage>87</lpage>. .<?supplied-pmid 16448051?><pub-id pub-id-type="pmid">16448051</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Lommen</surname><given-names>A</given-names></name>. <article-title>MetAlign: interface-driven, versatile metabolomics tool for hyphenated full-scan mass spectrometry data preprocessing</article-title>. <source>Analytical chemistry</source>. <year>2009</year><month>4</month><day>15</day>;<volume>81</volume>(<issue>8</issue>):<fpage>3079</fpage>–<lpage>86</lpage>. <pub-id pub-id-type="doi">10.1021/ac900036d</pub-id><?supplied-pmid 19301908?><pub-id pub-id-type="pmid">19301908</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Pluskal</surname><given-names>T</given-names></name>, <name><surname>Castillo</surname><given-names>S</given-names></name>, <name><surname>Villar-Briones</surname><given-names>A</given-names></name>, <name><surname>Oresic</surname><given-names>M</given-names></name>. <article-title>MZmine 2: modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data</article-title>. <source>BMC bioinformatics</source>. <year>2010</year>;<volume>11</volume>:<fpage>395</fpage> Pubmed Central PMCID: 2918584. <pub-id pub-id-type="doi">10.1186/1471-2105-11-395</pub-id><?supplied-pmid 20650010?><pub-id pub-id-type="pmid">20650010</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Kenar</surname><given-names>E</given-names></name>, <name><surname>Franken</surname><given-names>H</given-names></name>, <name><surname>Forcisi</surname><given-names>S</given-names></name>, <name><surname>Wormann</surname><given-names>K</given-names></name>, <name><surname>Haring</surname><given-names>HU</given-names></name>, <name><surname>Lehmann</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Automated label-free quantification of metabolites from liquid chromatography-mass spectrometry data</article-title>. <source>Molecular &amp; cellular proteomics: MCP</source>. <year>2014</year><month>1</month>;<volume>13</volume>(<issue>1</issue>):<fpage>348</fpage>–<lpage>59</lpage>. . Pubmed Central PMCID: 3879626.<?supplied-pmid 24176773?><pub-id pub-id-type="pmid">24176773</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Aberg</surname><given-names>KM</given-names></name>, <name><surname>Torgrip</surname><given-names>RJ</given-names></name>, <name><surname>Kolmert</surname><given-names>J</given-names></name>, <name><surname>Schuppe-Koistinen</surname><given-names>I</given-names></name>, <name><surname>Lindberg</surname><given-names>J</given-names></name>. <article-title>Feature detection and alignment of hyphenated chromatographic-mass spectrometric data. Extraction of pure ion chromatograms using Kalman tracking</article-title>. <source>Journal of chromatography A</source>. <year>2008</year><month>5</month><day>23</day>;<volume>1192</volume>(<issue>1</issue>):<fpage>139</fpage>–<lpage>46</lpage>. <pub-id pub-id-type="doi">10.1016/j.chroma.2008.03.033</pub-id><?supplied-pmid 18378252?><pub-id pub-id-type="pmid">18378252</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Sugimoto</surname><given-names>M</given-names></name>, <name><surname>Kawakami</surname><given-names>M</given-names></name>, <name><surname>Robert</surname><given-names>M</given-names></name>, <name><surname>Soga</surname><given-names>T</given-names></name>, <name><surname>Tomita</surname><given-names>M</given-names></name>. <article-title>Bioinformatics Tools for Mass Spectroscopy-Based Metabolomic Data Processing and Analysis</article-title>. <source>Current bioinformatics</source>. <year>2012</year><month>3</month>;<volume>7</volume>(<issue>1</issue>):<fpage>96</fpage>–<lpage>108</lpage>. . Pubmed Central PMCID: 3299976.<?supplied-pmid 22438836?><pub-id pub-id-type="pmid">22438836</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Tautenhahn</surname><given-names>R</given-names></name>, <name><surname>Bottcher</surname><given-names>C</given-names></name>, <name><surname>Neumann</surname><given-names>S</given-names></name>. <article-title>Highly sensitive feature detection for high resolution LC/MS</article-title>. <source>BMC bioinformatics</source>. <year>2008</year>;<volume>9</volume>:<fpage>504</fpage> Pubmed Central PMCID: 2639432. <pub-id pub-id-type="doi">10.1186/1471-2105-9-504</pub-id><?supplied-pmid 19040729?><pub-id pub-id-type="pmid">19040729</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Kuhl</surname><given-names>C</given-names></name>, <name><surname>Tautenhahn</surname><given-names>R</given-names></name>, <name><surname>Bottcher</surname><given-names>C</given-names></name>, <name><surname>Larson</surname><given-names>TR</given-names></name>, <name><surname>Neumann</surname><given-names>S</given-names></name>. <article-title>CAMERA: an integrated strategy for compound spectra extraction and annotation of liquid chromatography/mass spectrometry data sets</article-title>. <source>Analytical chemistry</source>. <year>2012</year><month>1</month><day>3</day>;<volume>84</volume>(<issue>1</issue>):<fpage>283</fpage>–<lpage>9</lpage>. Pubmed Central PMCID: 3658281. <pub-id pub-id-type="doi">10.1021/ac202450g</pub-id><?supplied-pmid 22111785?><pub-id pub-id-type="pmid">22111785</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Cleveland</surname><given-names>WS</given-names></name>. <article-title>Robust Locally Weighted Regression and Smoothing Scatterplots</article-title>. <source>J Am Stat Assoc</source>. <year>1979</year>;<volume>74</volume>(<issue>368</issue>):<fpage>829</fpage>–<lpage>36</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Cleveland</surname><given-names>WS</given-names></name>. <article-title>Lowess—a Program for Smoothing Scatterplots by Robust Locally Weighted Regression</article-title>. <source>Am Stat</source>. <year>1981</year>;<volume>35</volume>(<issue>1</issue>):<fpage>54</fpage>–.</mixed-citation>
    </ref>
    <ref id="pone.0146112.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Matsuda</surname><given-names>F</given-names></name>, <name><surname>Hirai</surname><given-names>MY</given-names></name>, <name><surname>Sasaki</surname><given-names>E</given-names></name>, <name><surname>Akiyama</surname><given-names>K</given-names></name>, <name><surname>Yonekura-Sakakibara</surname><given-names>K</given-names></name>, <name><surname>Provart</surname><given-names>NJ</given-names></name>, <etal>et al</etal><article-title>AtMetExpress development: a phytochemical atlas of Arabidopsis development</article-title>. <source>Plant physiology</source>. <year>2010</year><month>2</month>;<volume>152</volume>(<issue>2</issue>):<fpage>566</fpage>–<lpage>78</lpage>. Pubmed Central PMCID: 2815869. <pub-id pub-id-type="doi">10.1104/pp.109.148031</pub-id><?supplied-pmid 20023150?><pub-id pub-id-type="pmid">20023150</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Kessner</surname><given-names>D</given-names></name>, <name><surname>Chambers</surname><given-names>M</given-names></name>, <name><surname>Burke</surname><given-names>R</given-names></name>, <name><surname>Agus</surname><given-names>D</given-names></name>, <name><surname>Mallick</surname><given-names>P</given-names></name>. <article-title>ProteoWizard: open source software for rapid proteomics tools development</article-title>. <source>Bioinformatics</source>. <year>2008</year><month>11</month><day>1</day>;<volume>24</volume>(<issue>21</issue>):<fpage>2534</fpage>–<lpage>6</lpage>. Pubmed Central PMCID: 2732273. <pub-id pub-id-type="doi">10.1093/bioinformatics/btn323</pub-id><?supplied-pmid 18606607?><pub-id pub-id-type="pmid">18606607</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Wishart</surname><given-names>DS</given-names></name>, <name><surname>Jewison</surname><given-names>T</given-names></name>, <name><surname>Guo</surname><given-names>AC</given-names></name>, <name><surname>Wilson</surname><given-names>M</given-names></name>, <name><surname>Knox</surname><given-names>C</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>HMDB 3.0—The Human Metabolome Database in 2013</article-title>. <source>Nucleic acids research</source>. <year>2013</year><month>1</month>;<volume>41</volume>(Database issue):<fpage>D801</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1065</pub-id>. Pubmed Central PMCID: 3531200.<?supplied-pmid 23161693?><pub-id pub-id-type="pmid">23161693</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Matsuda</surname><given-names>F</given-names></name>, <name><surname>Yonekura-Sakakibara</surname><given-names>K</given-names></name>, <name><surname>Niida</surname><given-names>R</given-names></name>, <name><surname>Kuromori</surname><given-names>T</given-names></name>, <name><surname>Shinozaki</surname><given-names>K</given-names></name>, <name><surname>Saito</surname><given-names>K</given-names></name>. <article-title>MS/MS spectral tag-based annotation of non-targeted profile of plant secondary metabolites</article-title>. <source>The Plant journal: for cell and molecular biology</source>. <year>2009</year><month>2</month>;<volume>57</volume>(<issue>3</issue>):<fpage>555</fpage>–<lpage>77</lpage>. . Pubmed Central PMCID: 2667644.<?supplied-pmid 18939963?><pub-id pub-id-type="pmid">18939963</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Katajamaa</surname><given-names>M</given-names></name>, <name><surname>Oresic</surname><given-names>M</given-names></name>. <article-title>Data processing for mass spectrometry-based metabolomics</article-title>. <source>Journal of chromatography A</source>. <year>2007</year><month>7</month><day>27</day>;<volume>1158</volume>(<issue>1–2</issue>):<fpage>318</fpage>–<lpage>28</lpage>. .<?supplied-pmid 17466315?><pub-id pub-id-type="pmid">17466315</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Keller</surname><given-names>BO</given-names></name>, <name><surname>Sui</surname><given-names>J</given-names></name>, <name><surname>Young</surname><given-names>AB</given-names></name>, <name><surname>Whittal</surname><given-names>RM</given-names></name>. <article-title>Interferences and contaminants encountered in modern mass spectrometry</article-title>. <source>Analytica chimica acta</source>. <year>2008</year><month>10</month><day>3</day>;<volume>627</volume>(<issue>1</issue>):<fpage>71</fpage>–<lpage>81</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2008.04.043</pub-id><?supplied-pmid 18790129?><pub-id pub-id-type="pmid">18790129</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Tolstikov</surname><given-names>VV</given-names></name>, <name><surname>Lommen</surname><given-names>A</given-names></name>, <name><surname>Nakanishi</surname><given-names>K</given-names></name>, <name><surname>Tanaka</surname><given-names>N</given-names></name>, <name><surname>Fiehn</surname><given-names>O</given-names></name>. <article-title>Monolithic silica-based capillary reversed-phase liquid chromatography/electrospray mass spectrometry for plant metabolomics</article-title>. <source>Analytical chemistry</source>. <year>2003</year><month>12</month><day>1</day>;<volume>75</volume>(<issue>23</issue>):<fpage>6737</fpage>–<lpage>40</lpage>. .<?supplied-pmid 14640754?><pub-id pub-id-type="pmid">14640754</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Lynn</surname><given-names>KS</given-names></name>, <name><surname>Cheng</surname><given-names>ML</given-names></name>, <name><surname>Chen</surname><given-names>YR</given-names></name>, <name><surname>Hsu</surname><given-names>C</given-names></name>, <name><surname>Chen</surname><given-names>A</given-names></name>, <name><surname>Lih</surname><given-names>TM</given-names></name>, <etal>et al</etal><article-title>Metabolite identification for mass spectrometry-based metabolomics using multiple types of correlated ion information</article-title>. <source>Analytical chemistry</source>. <year>2015</year><month>2</month><day>17</day>;<volume>87</volume>(<issue>4</issue>):<fpage>2143</fpage>–<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1021/ac503325c</pub-id><?supplied-pmid 25543920?><pub-id pub-id-type="pmid">25543920</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Werner</surname><given-names>E</given-names></name>, <name><surname>Heilier</surname><given-names>JF</given-names></name>, <name><surname>Ducruix</surname><given-names>C</given-names></name>, <name><surname>Ezan</surname><given-names>E</given-names></name>, <name><surname>Junot</surname><given-names>C</given-names></name>, <name><surname>Tabet</surname><given-names>JC</given-names></name>. <article-title>Mass spectrometry for the identification of the discriminating signals from metabolomics: current status and future trends</article-title>. <source>Journal of chromatography B, Analytical technologies in the biomedical and life sciences</source>. <year>2008</year><month>8</month><day>15</day>;<volume>871</volume>(<issue>2</issue>):<fpage>143</fpage>–<lpage>63</lpage>. <pub-id pub-id-type="doi">10.1016/j.jchromb.2008.07.004</pub-id><?supplied-pmid 18672410?><pub-id pub-id-type="pmid">18672410</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0146112.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Nagao</surname><given-names>T</given-names></name>, <name><surname>Yukihira</surname><given-names>D</given-names></name>, <name><surname>Fujimura</surname><given-names>Y</given-names></name>, <name><surname>Saito</surname><given-names>K</given-names></name>, <name><surname>Takahashi</surname><given-names>K</given-names></name>, <name><surname>Miura</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Power of isotopic fine structure for unambiguous determination of metabolite elemental compositions: in silico evaluation and metabolomic application</article-title>. <source>Analytica chimica acta</source>. <year>2014</year><month>2</month><day>27</day>;<volume>813</volume>:<fpage>70</fpage>–<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2014.01.032</pub-id><?supplied-pmid 24528662?><pub-id pub-id-type="pmid">24528662</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
