<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4239578</article-id>
    <article-id pub-id-type="publisher-id">1471-2164-15-S6-S20</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2164-15-S6-S20</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Estimating the information value of polymorphic sites using pooled sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Malde</surname>
          <given-names>Ketil</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>ketil.malde@imr.no</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Institute of Marine Research, Nordnesgaten 50, Bergen, Norway</aff>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>10</month>
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <issue>Suppl 6</issue>
    <supplement>
      <named-content content-type="supplement-title">Proceedings of the Twelfth Annual Research in Computational Molecular Biology (RECOMB) Satellite Workshop on Comparative Genomics</named-content>
      <named-content content-type="supplement-editor">Laxmi Parida, Gurinder Atwal and Bud Mishra</named-content>
    </supplement>
    <fpage>S20</fpage>
    <lpage>S20</lpage>
    <permissions>
      <copyright-statement>Copyright Â© 2014 Malde; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Malde; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2164/15/S6/S20"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>High-throughput sequencing is a cost effective method for identifying genetic variation, and it is currently in use on a large scale across the field of biology, including ecology and population genetics. Correctly identifying variable sites and allele frequencies from sequencing data remains challenging, in large part due to artifacts and biases inherent in the sequencing process. Selecting variants that are diagnostic is commonly done using diversity statistics like <italic>F<sub>ST</sub></italic>, but these measures are not ideal for the task.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here, we develop a method that directly calculates the expected amount of information gained from observing each variant site. We then develop and implement a conservative estimator that takes into account uncertainity introduced by sampling bias and sequencing error. This estimator is applied to simulated and real sequencing data, and we discuss how it performs compared to the commonly used existing methods for identifying diagnostic polymorphisms.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The expected information content gives an easy to interpret measure for the usefulness of variant sites. The results show that we achieve a clear separation between true variants and noise, allowing us to select candidate sites with a high degree of confidence.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Population genetics</kwd>
      <kwd>SNP identification</kwd>
      <kwd>information theory</kwd>
      <kwd>diagnostic SNPs</kwd>
      <kwd>expected site information</kwd>
    </kwd-group>
    <conference>
      <conf-date>19-22 October 2014</conf-date>
      <conf-name>Twelfth Annual Research in Computational Molecular Biology (RECOMB) Satellite Workshop on Comparative Genomics</conf-name>
      <conf-loc>Cold Spring Harbor, NY, USA</conf-loc>
    </conference>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <sec>
      <title>SNP Selection</title>
      <p>A large part of the genetic variation in a species come in the form of single nucleotide polymorphisms (SNPs) [<xref ref-type="bibr" rid="B1">1</xref>]. Technological advances in high-throughput sequencing have made it possible to detect variations on genome-wide scales, also for non-model species. With current developments in high resolution genotyping technologies like SNP arrays and high-throughput mass spectrometry, SNP analysis is quickly becoming an indispensable tool in many fields of biology.</p>
      <p>In spite of improvements to technology, SNP analysis is still limited by genotyping cost and capacity. It therefore remains an important challenge to find a set of SNP markers that is as effective and efficient as possible. To be precise, we want to identify the minimal set of SNPs that must be examined in order to draw conclusions with an acceptable certainty - viz., the SNPs that are most <italic>informative </italic>for the task at hand. For instance, when selecting SNPs that are diagnostic (i.e., that can be used to identify individuals as belonging to one of two or more groups), we would like to pick a small set of sites that provide the most information about the individual's group affiliation. Although one could achieve the same certainty (at a somewhat higher cost) using a larger set of individually less informative SNPs, this would also increase the risk of <italic>overfitting </italic>the model to the data. Careful selection of SNPs is therefore not just an issue of economy and expedience, but also of accuracy.</p>
    </sec>
    <sec>
      <title>Diagnostic SNP identification</title>
      <p>In practice, diagnostic SNPs are usually identified and ranked or selected using some variation of the following procedure:</p>
      <p>First, samples are collected from individuals from the populations of interest, and DNA is extracted and sequenced to a depth deemed reasonable in terms of cost and benefit. Sequencing each sample individually is advantageous for reliably detecting rare alleles and to ensure a more complete SNP discovery [<xref ref-type="bibr" rid="B2">2</xref>], and is less sensitive to variation in molarity in the samples [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. In spite of these advantages, collecting multiple samples in pools before sequencing can still be more cost effective, in particular for novel SNP discovery in less well-studied species and when sample material is abundant [<xref ref-type="bibr" rid="B4">4</xref>]. The sequence data is typically filtered for quality and contamination, mapped to a reference genome sequence using a short read alignment program, and putative SNPs are identified when reads differ from each other or from the reference.</p>
      <p>The set of putative SNPs are then evaluated using some diversity statistic (e.g., <italic>F<sub>ST</sub></italic>), or statistical confidence in allele frequency difference (e.g., using Fisher's exact test, [<xref ref-type="bibr" rid="B5">5</xref>]). Often several measures are used, and candidates are typically filtered on one criterion (e.g., <italic>p</italic>-values), and then ranked using the other (e.g., <italic>F<sub>ST</sub></italic>). Sites can also be excluded based on coverage and more specific error estimates using base quality or mapping quality.</p>
      <p>In practice, some additional care is often taken in the selection of candidate sites. For instance, one might require a certain minimum distance between sites in the genome in order to avoid unwanted correlations, or exclude sites in regions with low average mapping quality.</p>
    </sec>
    <sec>
      <title>Challenges with this approach</title>
      <p>There are many statistics that could be used to identify diagnostic SNPs (the properties of several such statistics are reviewed by Rosenberg [<xref ref-type="bibr" rid="B6">6</xref>], other options are discussed by Zhou et al. [<xref ref-type="bibr" rid="B7">7</xref>]), but <italic>F<sub>ST </sub></italic>is perhaps most commonly used [<xref ref-type="bibr" rid="B8">8</xref>], and is readily calculated from identified allele frequencies.</p>
      <p>Unfortunately, <italic>F<sub>ST </sub></italic>is less than ideal for several reasons. It is a population genetics statistic, and must be calculated using some estimator. There exist several different options (e.g., reviews by Weir and Hill [<xref ref-type="bibr" rid="B9">9</xref>] and Holsinger and Weir [<xref ref-type="bibr" rid="B10">10</xref>], others are suggested by Karlsson et al. [<xref ref-type="bibr" rid="B11">11</xref>] and Fumagalli et al. [<xref ref-type="bibr" rid="B8">8</xref>]) which can give different results, and thus <italic>F<sub>ST </sub></italic>statistics may not be directly comparable between studies. <italic>F<sub>ST </sub></italic>is not robust to errors in the data, something that becomes a challenge with the relatively high number of errors and large number of candidate sites that typically arise from sequencing data. When coverage is low, a low number of sequencing errors can shift statistics substantially, and the highest <italic>F<sub>ST </sub></italic>scores tend to come from sites with low coverage. To counter this, coverage thresholds can be used, but this excludes a substantial fraction of candidate sites. And, although commonly used in this role, <italic>F<sub>ST </sub></italic>is controversial as a measure of differentiation. In particular, where heterozygosity <italic>within </italic>populations is high, <italic>F<sub>ST </sub></italic>will be lowered, regardless of the differences <italic>between </italic>populations [<xref ref-type="bibr" rid="B12">12</xref>].</p>
      <p>An alternative (or complimentary) approach is to use <italic>p</italic>-values for allele difference, usually calculated using Fisher's exact test, but other options are also possible [<xref ref-type="bibr" rid="B7">7</xref>]. One challenge here is that although we are usually interested in the <italic>magnitude </italic>of the allele differences, this is only taken indirectly into account by <italic>p</italic>-values. Variation in sequencing coverage means that sites with high coverage will tend to have higher confidence, even if the actual allele difference is small [<xref ref-type="bibr" rid="B13">13</xref>]. Even with no difference between population, sampling will introduce artificial differences, which will result in significant <italic>p</italic>-values if the coverage is sufficiently high. In addition, Fisher's exact test does not generally take into account the possibility of errors - the observation of a single allele will exclude an underlying frequency of zero for the observed allele, even if that may well be the case if the observation is an error.</p>
    </sec>
    <sec>
      <title>Outline</title>
      <p>In the following, we derive a method for calculating the expected information to be gained from genotyping a specific site, and argue that this is a more intuitive and useful measure for evaluating diagnostic SNPs than the commonly used alternatives. We will first describe how to calculate the expected informatino given <italic>a priori </italic>knowledge of allele frequency, we will then proceed to develop a method to make a conservative estimate for this statistic, taking into account sampling bias and uncertainty in the data. Finally, we provide an implementation, and discuss the results from applying it to both simulated and real data sets.</p>
    </sec>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Expected site information</title>
      <p>Given the drawbacks to using <italic>F<sub>ST </sub></italic>discussed above, it is perhaps tempting to instead use some other measures, like nucleotide diversity or absolute difference in allele frequency. However, it is easy to see that nucleotide diversity per site (defined as the probability of samples having different alleles, i.e., <italic>p</italic>(1 <italic>â q</italic>) + (1 <italic>â p</italic>)<italic>q </italic>where <italic>p </italic>and <italic>q </italic>are the major allele frequencies in the two populations) fails to measure divergence when one of the populations has an allele frequency of 0.5 - substituting <italic>p </italic>= 0.5 in the formula above results in 0.5(1 <italic>â q</italic>) + (1 <italic>â </italic>0.5)<italic>q</italic>, and it is easy to see that nucleotide diversity will be 0.5 regardless of <italic>q</italic>.</p>
      <p>Absolute difference in allele frequencies (<italic>|p â q|</italic>) is perhaps better, but consider populations where one allele's frequencies in the two populations are 0.4 and 0.6, respectively. Assigning an individual to a population based on observing this allele not inspire a lot of confidence in the result, they are roughly equally likely. Although the difference between allele frequency is the same for a site with allele frequencies 0.05 and 0.25, observing this allele is here five times as likely in one population as in the other, intuitively making this a much more useful site to observe.</p>
      <p>For diagnostic SNP, what we really would like to know is the amount of <italic>information </italic>observing each site contributes. Using Bayes theorem, observing an allele <italic>a </italic>in some individual <italic>N</italic>, gives us the following posterior probability for <italic>N </italic>belonging to some population <italic>A</italic>, where the allele frequency, <italic>P</italic>(<italic>a|A</italic>), is known:</p>
      <p>
        <disp-formula>
          <mml:math id="M1" name="1471-2164-15-S6-S20-i1" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>A</mml:mi>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mi>a</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:mi>A</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
              <mml:mi>P</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>A</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Here, P(A) is our prior probability of <italic>N </italic>belonging to <italic>A</italic>, which after observing <italic>a </italic>is modified by a factor of</p>
      <p>
        <disp-formula>
          <mml:math id="M2" name="1471-2164-15-S6-S20-i2" overflow="scroll">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:mi>A</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>In order to assign <italic>N </italic>to one of several populations (either <italic>A </italic>or <italic>B</italic>, say), we are interested in the <italic>relative </italic>probabilities for the two hypotheses. In other words, we would like to know the <italic>odds </italic>for <italic>N </italic>belonging to one population or the other. Given the probabilities of <italic>P</italic>(<italic>a|A</italic>) and <italic>P</italic>(<italic>a|B</italic>), and initial odds <italic>P </italic>(<italic>A</italic>)/<italic>P</italic>(<italic>B</italic>), we get</p>
      <p>
        <disp-formula>
          <mml:math id="M3" name="1471-2164-15-S6-S20-i3" overflow="scroll">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>A</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>B</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:mi>A</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>A</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                  <mml:mo class="MathClass-bin">/</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:mi>B</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>B</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                  <mml:mo class="MathClass-bin">/</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Canceling out <italic>P</italic>(<italic>a</italic>), we find that the prior odds are modified by:</p>
      <p>
        <disp-formula>
          <mml:math id="M4" name="1471-2164-15-S6-S20-i4" overflow="scroll">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:mi>A</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:mi>B</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>That is, the ratio of this allele's frequencies in each of the populations. For practical reasons, we take the logarithm of the odds. This gives us scores that are additive and symmetric (so that switching the two populations gives us the same score with the opposite sign). Specifically, base two logarithms will give us the score in bits.</p>
      <p>When observing a site, we may of course also encounter the alternative allele. By the same reasoning as above, we find that this allele modifies the prior odds by</p>
      <p>
        <disp-formula>
          <mml:math id="M5" name="1471-2164-15-S6-S20-i5" overflow="scroll">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo class="MathClass-bin">-</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:mi>A</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo class="MathClass-bin">-</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:mi>B</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Lacking any specific information about priors, we can consider each population equally likely, and the likelihood of observing a particular allele is the average of the likelihood in each population. The information gain from each possible allele is then averaged, weighted by this average likelihood. For a biallelic site with major allele frequencies <italic>p </italic>and <italic>q </italic>(and consequentially, minor allele frequencies of 1 <italic>â p </italic>and 1 <italic>â q</italic>) in the two populations, the expected added information from the site then becomes:</p>
      <p>
        <disp-formula>
          <mml:math id="M6" name="1471-2164-15-S6-S20-i6" overflow="scroll">
            <mml:mrow>
              <mml:mi>I</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:mi>q</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                  <mml:mo class="MathClass-bin">+</mml:mo>
                  <mml:mi>q</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:mfrac>
              <mml:mspace class="tmspace" width="2.77695pt"/>
              <mml:mfenced close="|" open="|">
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mstyle class="text">
                        <mml:mtext class="textsf" mathvariant="sans-serif">log</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>q</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo class="MathClass-bin">+</mml:mo>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo class="MathClass-bin">-</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mo class="MathClass-bin">+</mml:mo>
                      <mml:mi>q</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mspace class="tmspace" width="2.77695pt"/>
              <mml:mfenced close="|" open="|">
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mstyle class="text">
                        <mml:mtext class="textsf" mathvariant="sans-serif">log</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo class="MathClass-bin">-</mml:mo>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo class="MathClass-bin">-</mml:mo>
                      <mml:mi>q</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Note that we are here only interested in the amount of information gained, regardless of which hypothesis it favors, and thus we take the absolute values. For a site with multiple alleles enumerated by <italic>i </italic>and with frequency vectors <bold>p </bold>and <bold>q </bold>in the two populations, this generalizes to:</p>
      <p>
        <disp-formula>
          <mml:math id="M7" name="1471-2164-15-S6-S20-i7" overflow="scroll">
            <mml:mrow>
              <mml:mi>I</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold">
                    <mml:mi>p</mml:mi>
                  </mml:mstyle>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:mspace class="tmspace" width="2.77695pt"/>
                  <mml:mstyle mathvariant="bold">
                    <mml:mi>q</mml:mi>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:munder class="msub">
                <mml:mrow>
                  <mml:mo> â</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:munder>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo class="MathClass-bin">+</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>q</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:mfrac>
              <mml:mspace class="tmspace" width="2.77695pt"/>
              <mml:mfenced close="|" open="|">
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mstyle class="text">
                        <mml:mtext class="textsf" mathvariant="sans-serif">log</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>q</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Returning to the example at the start of the section, we now find that a site with allele frequencies of 0.4 and 0.6 contributes 0.58 bits of expected information, while 0.05 and 0.25 contributes 2.32 bits. Unlike measures like <italic>F<sub>ST</sub></italic>, measures of <italic>I </italic>is <italic>additive </italic>(assuming independence between sites), so the information gained from observing multiple sites is readily calculated, and observing with an ESI of 2.32 bits is equivalent to observing four sites with ESI 0.58.</p>
      <p>It may also be instructive to compare this procedure to sequence alignment and position specific score matrices (PSSMs). In sequence alignment, a sequence of nucleotides or amino acids are scored by comparing its match to a target sequence to its match to some base model using log odds scores. The base model to compare against is often implicit (typically using sequences of random composition), but more elaborate models is also possible ([<xref ref-type="bibr" rid="B14">14</xref>]). Similarly, position specific frequency matrices are often converted to position specific score matrices using log odds. Calculating the information value from a set of observed alleles is then analogous to scoring an "alignment" of the set of observed alleles to two different sets of allele frequencies.</p>
    </sec>
    <sec>
      <title>Allele frequency confidence intervals</title>
      <p>In order to apply the above method in practice, we need to measure the allele frequencies in the population. This is problematic for two reasons: First, we do not have precise knowledge of the allele frequencies, we can only estimate them from our sample, which introduces a sampling bias. Second, the sequencing process introduces additional artifacts that add nose and bias to the data. For instance, sequencing errors often result in substitutions, which are observed as apparent alleles. In addition, sequences can be incorrectly mapped, contain contamination, the reference genome can contain collapsed repeats, and the chemistry of the sequencing process is usually also biased - for instance, coverage is often biased by GC content. These artifacts often give the false appearance of variant positions.</p>
      <p>One challenge with calculating site information from sequencing data (as opposed to using allele frequencies directly), is that such errors in the data can vastly overestimate the information content. For instance, an allele that appears to be fixed in one population means that any other observed allele will assign the individual to the alternative population - regardless of any other alleles. It is easy to see that an allele frequency of zero results in the odds going either to zero or infinity, and thus the log odds will go to either positive or negative infinity.</p>
      <p>For diagnostic SNP discovery, it is more important to ensure that identified SNPs are informative, than to precisely estimate the information content. Thus, we take a conservative approach and use upper and lower limits for the allele frequencies by calculating confidence intervals using the method by Agresti and Coull [<xref ref-type="bibr" rid="B15">15</xref>]. In addition, the limits are also adjusted by a factor <italic>â</italic>, corresponding to sequencing error rate. In the following, we will refer to the resulting measure as <italic>conservative </italic>site information, or CSI.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Simulated data</title>
      <p>A set of simulated reads were generated using FlowSim [<xref ref-type="bibr" rid="B16">16</xref>], using a procedure adapted to populations genetics studies [<xref ref-type="bibr" rid="B17">17</xref>]. A section of 10 megabases, comprised of the four largest scaffolds, was extracted from the salmon louse (<italic>Lepeophtheirus salmonis</italic>) draft genome assembly. Random substitutions were introduced at a rate of 1/200 bases to generate three different haplotypes, which where then admixed in proportions 1:2:3 and 3:2:1 to generate two population, <italic>P</italic><sub>1 </sub>and <italic>P</italic><sub>2 </sub>with variant allele frequencies of 0.17, 0.33 and 0.50, as shown in Table <xref ref-type="table" rid="T1">1</xref>.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Statistics for the variants from haplotypes H1, H2, and H3, as mixed in populations <italic>P</italic><sup>1 </sup>and <italic>P</italic><sup>2</sup>.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">haplotype</th>
              <th align="left">MAF, <italic>P</italic><sub>1</sub></th>
              <th align="left">MAF, <italic>P</italic><sub>2</sub></th>
              <th align="left">
                <italic>F<sub>ST</sub></italic>
              </th>
              <th align="left">ESI</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">H1</td>
              <td align="left">0.17</td>
              <td align="left">0.50</td>
              <td align="left">0.125</td>
              <td align="left">1.6</td>
            </tr>
            <tr>
              <td align="left">H2</td>
              <td align="left">0.33</td>
              <td align="left">0.33</td>
              <td align="left">0</td>
              <td align="left">0</td>
            </tr>
            <tr>
              <td align="left">H3</td>
              <td align="left">0.50</td>
              <td align="left">0.17</td>
              <td align="left">0.125</td>
              <td align="left">1.6</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Simulated reads were then generated with genome coverages of 10x, 20x, and 40x from each of the populations, using substitution rates of 0.002, 0.01 and 0.02. To simplify analysis, the indel rate was held constant at 0.001.</p>
      <p>The reads were mapped to the reference genome using the BWA short read mapper [<xref ref-type="bibr" rid="B18">18</xref>], and analyzed using Samtools' mpileup command [<xref ref-type="bibr" rid="B19">19</xref>]. In addition to the methods described here, Popoolation [<xref ref-type="bibr" rid="B20">20</xref>] was used to calculate <italic>F<sub>ST </sub></italic>and <italic>p</italic>-values from Fisher's exact test.</p>
      <sec>
        <title>CSI scores for divergent and non-divergent sites</title>
        <p>In Figure <xref ref-type="fig" rid="F1">1</xref> we see that CSI clearly separates the divergent and non-divergent sites. At low CSI scores, the separation is approximately a factor of 10, and it increases with increasing CSI scores to a factor of about 100. Here, the number of divergent and non-divergent sites are approximately equal. The actual CSI value for the divergent sites are 1.6, we see that the program provides a conservative estimate, and only three sites score higher. The error rate does not seem to affect scores to a large degree.</p>
        <fig id="F1" position="float">
          <label>Figure 1</label>
          <caption>
            <p>Expected site information (CSI) calculated on divergent and non-divergent sites in simulated reads with an expected coverage of 20x and error rates of 0.002, 0.01, and 0.02.</p>
          </caption>
          <graphic xlink:href="1471-2164-15-S6-S20-1"/>
        </fig>
        <p>Figure <xref ref-type="fig" rid="F2">2</xref> shows how the scores are affected by varying the coverage. Although false positive scores aren't markedly affected by variations in coverage, the scores for divergent sites increase substantially as coverage increases. This indicates that, at least for the coverages and error rates studied here, controlling variation in coverage (and sampling bias) is more important than substitution errors.</p>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>Expected site information (CSI) calculated on divergent and non-divergent sites in simulated reads using various coverages</bold>. The error rate is 0.01.</p>
          </caption>
          <graphic xlink:href="1471-2164-15-S6-S20-2"/>
        </fig>
      </sec>
      <sec>
        <title>Comparing CSI and traditional statistics</title>
        <p>The relationship between CSI and <italic>p</italic>-values is shown in Figure <xref ref-type="fig" rid="F3">3</xref>. Although all sites are non-divergent, we obtain many higher <italic>p</italic>-values at higher coverage, indicating that Fisher's exact test is upwardly biased as coverage increases.</p>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>Comparing the expected site information (CSI) with <italic>p</italic>-values using Fisher's exact test at various coverages and with a substitution rate of 0.01</bold>. All sites are non-divergent.</p>
          </caption>
          <graphic xlink:href="1471-2164-15-S6-S20-3"/>
        </fig>
        <p>In Figure <xref ref-type="fig" rid="F4">4</xref>, the relationship between CSI and <italic>F<sub>ST </sub></italic>is explored. Especially, at low coverage, many sites show a very high <italic>F<sub>ST </sub></italic>value. As coverage increases, both the variation and expectation of <italic>F<sub>ST </sub></italic>is reduced, and also the correlation between CSI and <italic>F<sub>ST </sub></italic>improves.</p>
        <fig id="F4" position="float">
          <label>Figure 4</label>
          <caption>
            <p><bold>Comparing the expected site information (CSI) with <italic>F<sub>ST </sub></italic>values at various coverages and with a substitution rate of 0.01</bold>. All sites are non-divergent, i.e. the real <italic>F<sub>ST </sub></italic>and CSI are both 0.</p>
          </caption>
          <graphic xlink:href="1471-2164-15-S6-S20-4"/>
        </fig>
        <p>It is also instructive to contrast <italic>F<sub>ST </sub></italic>values with <italic>p</italic>-values (Figure <xref ref-type="fig" rid="F5">5</xref>). Since most polymorphic sites result in a non-zero <italic>p</italic>-values and <italic>F<sub>ST</sub></italic>, the diagram is noticeably denser than Figures <xref ref-type="fig" rid="F3">3</xref> or <xref ref-type="fig" rid="F4">4</xref>. There is also a clear banding effect; as coverage increases, <italic>F<sub>ST </sub></italic>values tend to decrease, and <italic>p</italic>-values increase, and the bulk of the data is rotated in a clockwise direction.</p>
        <fig id="F5" position="float">
          <label>Figure 5</label>
          <caption>
            <p><bold>Comparing <italic>p</italic>-value with <italic>F<sub>ST </sub></italic>values for non-divergent sites at various coverages and with a substitution rate of 0.01</bold>.</p>
          </caption>
          <graphic xlink:href="1471-2164-15-S6-S20-5"/>
        </fig>
      </sec>
      <sec>
        <title>Comparing CSI and F<sub>ST </sub>for divergent and non-divergent sites</title>
        <p>Adding the divergent sites in Figure <xref ref-type="fig" rid="F6">6</xref>, we see that the distribution for the divergent sites extend the general distribution for the non-divergent sites.</p>
        <fig id="F6" position="float">
          <label>Figure 6</label>
          <caption>
            <p><bold>Comparing the expected site information (CSI) with <italic>F<sub>ST </sub></italic>for divergent and non-divergent sites, using a 20x coverage and a substitution rate of 0.01</bold>.</p>
          </caption>
          <graphic xlink:href="1471-2164-15-S6-S20-6"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Real data</title>
      <p>One important use for SNPs, is to assign individuals to their respective populations or subpopulations. For instance, the quantity of Norwegian farmed salmon exceeds the wild river populations by a large factor. As salmon occasionally escape from sea farms, the ability to effectively identify escapees is important both to identify the farms responsible, as well as quantifying the ecological effects of introgression. Here SNPs will play an important role by providing a low-cost, high resolution data [<xref ref-type="bibr" rid="B21">21</xref>].</p>
      <p>Below, we examine pooled salmon sequencing data from rivers Flekkeelva and Suldalselva, and investigate the resulting CSI distributions. From each of the rivers, two pools were sequenced using Illumina HiSeq, resulting in datasets <italic>F</italic><sub>1</sub>, <italic>F</italic><sub>2</sub>, <italic>S</italic><sub>1 </sub>and <italic>S</italic><sub>2</sub>, each containing between 346 and 397 million aligned reads, corresponding to coverages of 11.5x to 13.2x, assuming a genome size of 3 gigabases. The data sets were then merged by river (combining <italic>F</italic><sub>1 </sub>with <italic>F</italic><sub>2 </sub>and <italic>S</italic><sub>1 </sub>with <italic>S</italic><sub>2</sub>), and by replicate (combining <italic>F</italic><sub>1 </sub>with <italic>S</italic><sub>1 </sub>and <italic>F</italic><sub>2 </sub>with <italic>S</italic><sub>2</sub>, to provide a model for false discoveries).</p>
      <sec>
        <title>Comparison</title>
        <p>It can be seen from Figure <xref ref-type="fig" rid="F7">7</xref> that, as expected, we identify a larger number of sites when comparing between rivers than between the mixed replicates, and although the separation is not as clear as for the simulated data, the slope is similar. The difference increases (and thus identification accuracy) with increasing scores, but there remain several high-scoring sites also in the replicates comparison.</p>
        <fig id="F7" position="float">
          <label>Figure 7</label>
          <caption>
            <p><bold>Comparing the expected site information (CSI) between pools mixed from both rivers, and single-river pools</bold>.</p>
          </caption>
          <graphic xlink:href="1471-2164-15-S6-S20-7"/>
        </fig>
      </sec>
      <sec>
        <title>Filtering by coverage</title>
        <p>A closer examination of the data reveals that many of the high scoring sites have a coverage substantially higher than the expected combined coverage of approximately 50x. This can be due to collapsed repeats in the genome assembly or other artifacts of the assembly, sequencing, or mapping processes. To investigate this, sites were filtered by coverage, retaining only sites with a total coverage of 50 Â± 20 (which corresponds to roughly three standard deviations of a Poisson distribution). The results are shown in Figure <xref ref-type="fig" rid="F8">8</xref>, for comparison the unfiltered results from Figure <xref ref-type="fig" rid="F7">7</xref> are retained with dashed lines.</p>
        <fig id="F8" position="float">
          <label>Figure 8</label>
          <caption>
            <p><bold>Comparing the expected site information (CSI) between pools mixed from both rivers, and single-river pools, filtered by coverage</bold>. The right axis shows the ratio of between-river scores to between-replicates scores for the coverage-filtered sites.</p>
          </caption>
          <graphic xlink:href="1471-2164-15-S6-S20-8"/>
        </fig>
        <p>We see from Figure <xref ref-type="fig" rid="F8">8</xref> that filtering on coverage eliminates some of the noise, most noticeable for higher CSI values. The effect of filtering also tends to reduce the scores between the replicate pools more than the river pools, this observation is also supported by the total number of identified SNP, as summarized in Table <xref ref-type="table" rid="T2">2</xref>. In all cases a large number of sites are removed, 30% (rivers) and 33% (replicates) of the identified sites.</p>
        <table-wrap id="T2" position="float">
          <label>Table 2</label>
          <caption>
            <p>The number of sites with non-zero expected site information, both in absolute numbers and in percent of an estimated 3 gigabase genome, before and after filtering for coverage.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="left">Comparison</th>
                <th align="left"># sites</th>
                <th align="left">% genome</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">Between rivers</td>
                <td align="left">699970</td>
                <td align="left">0.023</td>
              </tr>
              <tr>
                <td align="left">Between rivers, filtered</td>
                <td align="left">493163</td>
                <td align="left">0.016</td>
              </tr>
              <tr>
                <td align="left">Between replicates</td>
                <td align="left">450814</td>
                <td align="left">0.015</td>
              </tr>
              <tr>
                <td align="left">Between replicates, filtered</td>
                <td align="left">303972</td>
                <td align="left">0.010</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <sec>
      <title>Statistics, coverage, and sequencing errors</title>
      <p>It is striking that <italic>p</italic>-values for the non-divergent sites increase with coverage. For instance, out of the 36000 non-divergent sites, we expect approximately 36 sites by chance to have a <italic>p</italic>-value less than 10<sup>â3</sup>. For 10x coverage, we find 9, for 20x, we find 35, and for 40x we find 70. This indicates that <italic>p</italic>-values are biased upwards with increasing coverage, and must be consequently be interpreted with care [<xref ref-type="bibr" rid="B13">13</xref>]. The expectation and variance of <italic>F<sub>ST </sub></italic>similarly depends on coverage. In contrast, low coverage in combination with sequencing errors and incorrectly mapped reads here result in a large number of high-scoring non-divergent sites. Using a combination of these measures may be effective, but also effectively narrows the data set, much like a stringent filtering for coverage.</p>
      <p>Simulated data is by definition a simplification of reality. For instance, here the data assumes uniform probability of reads across the genome, and unbiased and context independent sequencing errors. Also, divergent and non-divergent positions occur in similar numbers in the simulated data, in reality, there will be a continuous spectrum of allele frequencies, and it will depend globally on the degree of divergence between populations, and locally on selection and other non-random evolution pressures. Results from simulated data must, as always, be interpreted as optimistic. In practice, coverage will vary substantially across a sequenced genome. In general, high variance regions tend to have lower mapping [<xref ref-type="bibr" rid="B22">22</xref>], but other factors are bias caused by GC-content, misassembly and collapsed repeats, copy-number and other structural variations, incorrect mapping, sampling bias (including from variation of molarity in DNA samples). Real data sets must therefore be expected to contain a wide range of coverages, mapping reliability, and sequencing error rates.</p>
    </sec>
    <sec>
      <title>Other information theoretic measures</title>
      <p>Although not commonly applied, information theoretic measures have been used previously in analyzing genetic variation. Expected site information is related to Kullback-Leibler divergence [<xref ref-type="bibr" rid="B23">23</xref>], but differs in that it is symmetric and extended to multiple alleles. Rosenberg [<xref ref-type="bibr" rid="B6">6</xref>] gives a summary of several alternative statistics, and also develops an information theoretic measure that contrasts individual populations with an average of all population. This measure is then used to infer ancestry, and applied to microsatellite data. Here, we develop an information theoretic measure in a Bayesian context, and apply it to high-throughput sequencing data.</p>
    </sec>
    <sec>
      <title>Dealing with sequencing errors and artifacts</title>
      <p>Based on the assumption that most sequencing errors will be singletons, Achaz [<xref ref-type="bibr" rid="B24">24</xref>] developed variants of several estimators for Î which avoids taking singletons into account. Achaz' formulas were later adapted to high-throughput sequencing experiments, and given a more generalized (but approximate) form that allowed an arbitrary lower bound on number of observed alleles [<xref ref-type="bibr" rid="B4">4</xref>]. However, much of the genetic diversity is in the form of low frequency alleles, and as singletons also have a high impact on many statistics [<xref ref-type="bibr" rid="B24">24</xref>], these estimators have lower power [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. It is also possible to attempt to quantify the errors more precisely by leveraging characteristics of the data [<xref ref-type="bibr" rid="B5">5</xref>].</p>
    </sec>
    <sec>
      <title>Future work</title>
      <p>Here, we have focused on the <italic>expected </italic>information content. As this is an additive measure, it is straightforward to sum over multiple sites to get the expected information for a set of SNPs. Since rare alleles yield more information than common ones, a natural extension might be to consider instead the <italic>minimum </italic>information content from a set of loci, ensuring that we can reach a conclusion even if we are unlucky with the actual alleles observed. Yet another option is to calculate a confidence interval for the information.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>When selecting diagnostic SNPs, we want to find sites that provide the most information regarding our current problem. Although this is commonly measured using statistics like <italic>F<sub>ST</sub></italic>, these are <italic>indirect </italic>measurements, proxies for the actual information. In addition, we have seen that it and other commonly used statistics have intrinsic biases when applied to sequencing data, due to coverage variation, sequencing artifacts, and mapping errors.</p>
    <p>As an alternative, we have derived a direct calculation of the expected site information from allele frequencies, using a Bayesian framework. In addition to being a direct measurement of the value of interest, it has a clear interpretation, and desirable properties, like additivity. We have further developed a conservative estimator for this statistic, and provide an implementation.</p>
  </sec>
  <sec>
    <title>Availability</title>
    <p>The method as described above was implemented in a program, 'varan', which parses read alignments in the standard "mpileup" format as output by the samtools mpileup command. It can currently output several different statistics and estimators, including conservative expected site information (CSI). The software is distributed under the General Public License, and the source code can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://malde.org/~ketil/biohaskell/varan">http://malde.org/~ketil/biohaskell/varan</ext-link>. Further information and documentation is available from <ext-link ext-link-type="uri" xlink:href="http://biohaskell.org/Applications/Varan">http://biohaskell.org/Applications/Varan</ext-link>.</p>
    <p>Simulation data, tables, and scripts used in this paper is available from <ext-link ext-link-type="uri" xlink:href="http://malde.org/~ketil/papers/varan">http://malde.org/~ketil/papers/varan</ext-link>. The salmon louse genome used to generate the simulated reads is available from <ext-link ext-link-type="uri" xlink:href="http://sealouse.imr.no/">http://sealouse.imr.no/</ext-link>.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The author declares that they have no competing interests.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>I am grateful for the support of my colleagues, both in the IBIS group at Helmholz Zentrum, Munich, Germany, and at the Institute of Marine Research in Bergen, Norway. In particular, I would like to thank Sapna Sharma and FranÃ§ois Besnier for helpful discussion and comments. I also appreciate Anna Wargelius and the SALMAT project allowing me access to the sequencing data.</p>
  </sec>
  <sec>
    <title>Declarations</title>
    <p>Publication costs for this article were funded by the Institute of Marine Research.</p>
    <p>This article has been published as part of <italic>BMC Genomics </italic>Volume 15 Supplement 6, 2014: Proceedings of the Twelfth Annual Research in Computational Molecular Biology (RECOMB) Satellite Workshop on Comparative Genomics. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/bmcgenomics/supplements/15/S6">http://www.biomedcentral.com/bmcgenomics/supplements/15/S6</ext-link>.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Collins</surname>
          <given-names>FS</given-names>
        </name>
        <name>
          <surname>Brooks</surname>
          <given-names>LD</given-names>
        </name>
        <name>
          <surname>Chakravarti</surname>
          <given-names>A</given-names>
        </name>
        <article-title>A DNA polymorphism discovery resource for research on human genetic variation</article-title>
        <source>Genome research</source>
        <year>1998</year>
        <volume>8</volume>
        <issue>12</issue>
        <fpage>1229</fpage>
        <lpage>1231</lpage>
        <?supplied-pmid 9872978?>
        <pub-id pub-id-type="pmid">9872978</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cutler</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Jensen</surname>
          <given-names>JD</given-names>
        </name>
        <article-title>To pool, or not to pool?</article-title>
        <source>Genetics</source>
        <year>2010</year>
        <volume>186</volume>
        <issue>1</issue>
        <fpage>41</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.110.121012</pub-id>
        <?supplied-pmid 20855575?>
        <pub-id pub-id-type="pmid">20855575</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Altmann</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Weber</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Quast</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Rex-Haffner</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Binder</surname>
          <given-names>EB</given-names>
        </name>
        <name>
          <surname>MÃ¼ller-Myhsok</surname>
          <given-names>B</given-names>
        </name>
        <article-title>vipR: variant identification in pooled DNA using R</article-title>
        <source>Bioinformatics [ISMB/ECCB]</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>13</issue>
        <fpage>77</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr205</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Futschik</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>SchlÃ¶tterer</surname>
          <given-names>C</given-names>
        </name>
        <article-title>The next generation of molecular markers from massively parallel sequencing of pooled DNA samples</article-title>
        <source>Genetics</source>
        <year>2010</year>
        <volume>186</volume>
        <issue>1</issue>
        <fpage>207</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.110.114397</pub-id>
        <?supplied-pmid 20457880?>
        <pub-id pub-id-type="pmid">20457880</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bansal</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Harismendy</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Tewhey</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Murray</surname>
          <given-names>SS</given-names>
        </name>
        <name>
          <surname>Schork</surname>
          <given-names>NJ</given-names>
        </name>
        <name>
          <surname>Topol</surname>
          <given-names>EJ</given-names>
        </name>
        <name>
          <surname>Frazer</surname>
          <given-names>KA</given-names>
        </name>
        <article-title>Accurate detection and genotyping of SNPs utilizing population sequencing data</article-title>
        <source>Genome research</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>537</fpage>
        <lpage>545</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.100040.109</pub-id>
        <?supplied-pmid 20150320?>
        <pub-id pub-id-type="pmid">20150320</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rosenberg</surname>
          <given-names>NA</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>LM</given-names>
        </name>
        <name>
          <surname>Ward</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Pritchard</surname>
          <given-names>JK</given-names>
        </name>
        <article-title>Informativeness of genetic markers for inference of ancestry</article-title>
        <source>The American Journal of Human Genetics</source>
        <year>2003</year>
        <volume>73</volume>
        <issue>6</issue>
        <fpage>1402</fpage>
        <lpage>1422</lpage>
        <pub-id pub-id-type="doi">10.1086/380416</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhou</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Effective selection of informative SNPs and classification on the hapmap genotype data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>484</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-484</pub-id>
        <?supplied-pmid 18093342?>
        <pub-id pub-id-type="pmid">18093342</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fumagalli</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Vieira</surname>
          <given-names>FG</given-names>
        </name>
        <name>
          <surname>Korneliussen</surname>
          <given-names>TS</given-names>
        </name>
        <name>
          <surname>Linderoth</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Huerta-SÃ¡nchez</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Albrechtsen</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Nielsen</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Quantifying population genetic differentiation from next-generation sequencing data</article-title>
        <source>Genetics</source>
        <year>2013</year>
        <volume>195</volume>
        <issue>3</issue>
        <fpage>979</fpage>
        <lpage>992</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.113.154740</pub-id>
        <?supplied-pmid 23979584?>
        <pub-id pub-id-type="pmid">23979584</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Weir</surname>
          <given-names>BS</given-names>
        </name>
        <name>
          <surname>Hill</surname>
          <given-names>W</given-names>
        </name>
        <article-title>Estimating F-statistics</article-title>
        <source>Annual Review of Genetics</source>
        <year>2002</year>
        <volume>36</volume>
        <issue>1</issue>
        <fpage>721</fpage>
        <lpage>750</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.genet.36.050802.093940</pub-id>
        <?supplied-pmid 12359738?>
        <pub-id pub-id-type="pmid">12359738</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Holsinger</surname>
          <given-names>KE</given-names>
        </name>
        <name>
          <surname>Weir</surname>
          <given-names>BS</given-names>
        </name>
        <article-title>Genetics in geographically structured populations: defining, estimating and interpreting <italic>F<sub>ST</sub></italic></article-title>
        <source>Nature Reviews Genetics</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>9</issue>
        <fpage>639</fpage>
        <lpage>650</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2611</pub-id>
        <?supplied-pmid 19687804?>
        <pub-id pub-id-type="pmid">19687804</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Karlsson</surname>
          <given-names>EK</given-names>
        </name>
        <name>
          <surname>Baranowska</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Wade</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Hillbertz</surname>
          <given-names>NHS</given-names>
        </name>
        <name>
          <surname>Zody</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Anderson</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Biagi</surname>
          <given-names>TM</given-names>
        </name>
        <name>
          <surname>Patterson</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Pielberg</surname>
          <given-names>GR</given-names>
        </name>
        <name>
          <surname>Kulbokas</surname>
          <given-names>EJ</given-names>
        </name>
        <etal/>
        <article-title>Efficient mapping of mendelian traits in dogs through genome-wide association</article-title>
        <source>Nature genetics</source>
        <year>2007</year>
        <volume>39</volume>
        <issue>11</issue>
        <fpage>1321</fpage>
        <lpage>1328</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2007.10</pub-id>
        <?supplied-pmid 17906626?>
        <pub-id pub-id-type="pmid">17906626</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Jost</surname>
          <given-names>L</given-names>
        </name>
        <article-title>GST and its relatives do not measure differentiation</article-title>
        <source>Molecular Ecology</source>
        <year>2008</year>
        <volume>17</volume>
        <issue>18</issue>
        <fpage>4015</fpage>
        <lpage>4026</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-294X.2008.03887.x</pub-id>
        <?supplied-pmid 19238703?>
        <pub-id pub-id-type="pmid">19238703</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lucas</surname>
          <given-names>HC</given-names>
          <suffix>Jr</suffix>
        </name>
        <name>
          <surname>Shmueli</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Research commentary-too big to fail: Large samples and the p-value problem</article-title>
        <source>Information Systems Research</source>
        <year>2013</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>906</fpage>
        <lpage>917</lpage>
        <pub-id pub-id-type="doi">10.1287/isre.2013.0480</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Malde</surname>
          <given-names>K</given-names>
        </name>
        <article-title>The effect of sequence quality on sequence alignment</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>7</issue>
        <fpage>897</fpage>
        <lpage>900</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn052</pub-id>
        <?supplied-pmid 18296747?>
        <pub-id pub-id-type="pmid">18296747</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Agresti</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Coull</surname>
          <given-names>BA</given-names>
        </name>
        <article-title>Approximate is better than "exact" for interval estimation of binomial proportions</article-title>
        <source>The American Statistician</source>
        <year>1998</year>
        <volume>52</volume>
        <issue>2</issue>
        <fpage>119</fpage>
        <lpage>126</lpage>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Balzer</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Malde</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>LanzÃ©n</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Sharma</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Jonassen</surname>
          <given-names>I</given-names>
        </name>
        <article-title>Characteristics of 454 pyrosequencing data--enabling realistic simulation with FlowSim</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>18</issue>
        <fpage>420</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq365</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Malde</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Simulating a population genomics data set using FlowSim</article-title>
        <source>BMC Research Notes</source>
        <year>2014</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>68</fpage>
        <pub-id pub-id-type="doi">10.1186/1756-0500-7-68</pub-id>
        <?supplied-pmid 24479665?>
        <pub-id pub-id-type="pmid">24479665</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Fast and accurate short read alignment with burrows-wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <?supplied-pmid 19451168?>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Handsaker</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Wysoker</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fennell</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ruan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Homer</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Abecasis</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <etal/>
        <article-title>The sequence alignment/map format and samtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kofler</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Orozco-terWengel</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>De Maio</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Pandey</surname>
          <given-names>RV</given-names>
        </name>
        <name>
          <surname>Nolte</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Futschik</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Kosiol</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>SchlÃ¶tterer</surname>
          <given-names>C</given-names>
        </name>
        <article-title>Popoolation: a toolbox for population genetic analysis of next generation sequencing data from pooled individuals</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>15925</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0015925</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Karlsson</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Moen</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Lien</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Glover</surname>
          <given-names>KA</given-names>
        </name>
        <name>
          <surname>Hindar</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Generic genetic differences between farmed and wild atlantic salmon identified from a 7K SNP-chip</article-title>
        <source>Molecular Ecology Resources</source>
        <year>2011</year>
        <volume>11</volume>
        <issue>s1</issue>
        <fpage>247</fpage>
        <lpage>253</lpage>
        <?supplied-pmid 21429178?>
        <pub-id pub-id-type="pmid">21429178</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Wei</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Lam</surname>
          <given-names>TW</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Next generation sequencing has lower sequence coverage and poorer SNP-detection capability in the regulatory regions</article-title>
        <source>Scientific reports</source>
        <year>2011</year>
        <volume>1</volume>
        <fpage>55</fpage>
        <pub-id pub-id-type="doi">10.1038/srep00055</pub-id>
        <?supplied-pmid 22355574?>
        <pub-id pub-id-type="pmid">22355574</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="other">
        <name>
          <surname>Kullback</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Leibler</surname>
          <given-names>RA</given-names>
        </name>
        <article-title>On information and sufficiency</article-title>
        <source>The Annals of Mathematical Statistics</source>
        <year>1951</year>
        <fpage>79</fpage>
        <lpage>86</lpage>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Achaz</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Testing for neutrality in samples with sequencing errors</article-title>
        <source>Genetics</source>
        <year>2008</year>
        <volume>179</volume>
        <issue>3</issue>
        <fpage>1409</fpage>
        <lpage>1424</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.107.082198</pub-id>
        <?supplied-pmid 18562660?>
        <pub-id pub-id-type="pmid">18562660</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
