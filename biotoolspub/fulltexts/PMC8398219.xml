<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Metabolites</journal-id>
    <journal-id journal-id-type="iso-abbrev">Metabolites</journal-id>
    <journal-id journal-id-type="publisher-id">metabolites</journal-id>
    <journal-title-group>
      <journal-title>Metabolites</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2218-1989</issn>
    <publisher>
      <publisher-name>MDPI</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8398219</article-id>
    <article-id pub-id-type="pmid">34436433</article-id>
    <article-id pub-id-type="doi">10.3390/metabo11080492</article-id>
    <article-id pub-id-type="publisher-id">metabolites-11-00492</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MStractor: R Workflow Package for Enhancing Metabolomics Data Pre-Processing and Visualization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nicolotti</surname>
          <given-names>Luca</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-11-00492">1</xref>
        <xref ref-type="aff" rid="af2-metabolites-11-00492">2</xref>
        <xref rid="c1-metabolites-11-00492" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hack</surname>
          <given-names>Jeremy</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-11-00492">1</xref>
        <xref ref-type="aff" rid="af2-metabolites-11-00492">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Herderich</surname>
          <given-names>Markus</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-11-00492">1</xref>
        <xref ref-type="aff" rid="af2-metabolites-11-00492">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lloyd</surname>
          <given-names>Natoiya</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-11-00492">1</xref>
        <xref ref-type="aff" rid="af2-metabolites-11-00492">2</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kim</surname>
          <given-names>Seongho</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <aff id="af1-metabolites-11-00492"><label>1</label>The Australian Wine Research Institute, Adelaide, SA 5064, Australia; <email>jeremy.hack76@gmail.com</email> (J.H.); <email>markus.herderich@awri.com.au</email> (M.H.); <email>natoiya.lloyd@awri.com.au</email> (N.L.)</aff>
    <aff id="af2-metabolites-11-00492"><label>2</label>Metabolomics Australia, The Australian Wine Research Institute, Adelaide, SA 5064, Australia</aff>
    <author-notes>
      <corresp id="c1-metabolites-11-00492"><label>*</label>Correspondence: <email>luca.nicolotti@awri.com.au</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <volume>11</volume>
    <issue>8</issue>
    <elocation-id>492</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 by the authors.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Untargeted metabolomics experiments for characterizing complex biological samples, conducted with chromatography/mass spectrometry technology, generate large datasets containing very complex and highly variable information. Many data-processing options are available, however, both commercial and open-source solutions for data processing have limitations, such as vendor platform exclusivity and/or requiring familiarity with diverse programming languages. Data processing of untargeted metabolite data is a particular problem for laboratories that specialize in non-routine mass spectrometry analysis of diverse sample types across humans, animals, plants, fungi, and microorganisms. Here, we present MStractor, an R workflow package developed to streamline and enhance pre-processing of metabolomics mass spectrometry data and visualization. MStractor combines functions for molecular feature extraction with user-friendly dedicated GUIs for chromatographic and mass spectromerty (MS) parameter input, graphical quality-control outputs, and descriptive statistics. MStractor performance was evaluated through a detailed comparison with XCMS Online. The MStractor package is freely available on GitHub at the MetabolomicsSA repository.</p>
    </abstract>
    <kwd-group>
      <kwd>metabolomics</kwd>
      <kwd>data analysis</kwd>
      <kwd>pre-processing</kwd>
      <kwd>R programming language</kwd>
      <kwd>LC/MS</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1-metabolites-11-00492">
    <title>1. Introduction</title>
    <p>Over the last few decades, mass spectrometry (MS) has become the technique of choice to profile metabolites in biological systems, specifically when untargeted strategies are required for characterizing the complexity of biological samples. Significant improvements to the instrument’s sensitivity resulted in exponential growth of metabolites detected in a single analysis (&gt;10<sup>3</sup>), and faster chromatographic separations allow analysis of large sample sets. As a consequence, a single instrument can, over 24 h, produce data covering 10<sup>5</sup> to 10<sup>6</sup> potential metabolites. Hence, data processing has become a critical step that limits throughput, productivity, and potentially also the quality of interpretation of raw mass spectrometry data. Availability of bioinformatics workflows and software that enable reliable data pre-processing, rapid throughput, and production of reliable information is essential for the quality of the analytical results and biological interpretation [<xref rid="B1-metabolites-11-00492" ref-type="bibr">1</xref>,<xref rid="B2-metabolites-11-00492" ref-type="bibr">2</xref>,<xref rid="B3-metabolites-11-00492" ref-type="bibr">3</xref>,<xref rid="B4-metabolites-11-00492" ref-type="bibr">4</xref>].</p>
    <p>Software for processing metabolomics data is in either a proprietary or open-source format [<xref rid="B1-metabolites-11-00492" ref-type="bibr">1</xref>,<xref rid="B5-metabolites-11-00492" ref-type="bibr">5</xref>]. There are many solutions available, with various degrees of sophistication; some software supports the entire metabolomics data-processing pipeline, while other programs are specialized for specific tasks such as feature detection, statistical analysis, or metabolite identification. In addition, many tools offer processing solutions limited to single technology platforms such as GC/MS [<xref rid="B6-metabolites-11-00492" ref-type="bibr">6</xref>] or LC/MS.</p>
    <p>Commonly used commercially available software includes Mass Profiler by Agilent Technologies, Bruker Metaboscape, Progenesis QI by Waters, and Compound Discoverer by Thermo Fisher Scientific. On the other hand, a fast-progressing area in metabolomics is the development of freely available and open-source tools for all facets of data processing [<xref rid="B7-metabolites-11-00492" ref-type="bibr">7</xref>,<xref rid="B8-metabolites-11-00492" ref-type="bibr">8</xref>]. Popular open-source software such as MetaboAnalyst, MetaboNexus, XCMS, MZmine2, and MAVEN [<xref rid="B9-metabolites-11-00492" ref-type="bibr">9</xref>,<xref rid="B10-metabolites-11-00492" ref-type="bibr">10</xref>,<xref rid="B11-metabolites-11-00492" ref-type="bibr">11</xref>,<xref rid="B12-metabolites-11-00492" ref-type="bibr">12</xref>,<xref rid="B13-metabolites-11-00492" ref-type="bibr">13</xref>] provide the community with advanced tools to manage, explore, and annotate the increasing complexity of data generated from new and evolving technologies. Some popular open-source packages and platforms like XCMS and XCMS online also include tools for statistical analysis [<xref rid="B14-metabolites-11-00492" ref-type="bibr">14</xref>,<xref rid="B15-metabolites-11-00492" ref-type="bibr">15</xref>,<xref rid="B16-metabolites-11-00492" ref-type="bibr">16</xref>].</p>
    <p>Bioconductor, an open-source platform for bioinformatics analysis based on the R programming language, represents one of the best options available when dealing with both GC/MS and LC/MS datasets. It offers a range of packages covering pre-processing of GC/MS and LC/MS data, reconstruction and annotation of deconvoluted spectra [<xref rid="B17-metabolites-11-00492" ref-type="bibr">17</xref>], and complex data visualization.</p>
    <p>Despite the many advantages of open-source tools, some aspects can be improved further. As an example, XCMS and CAMERA [<xref rid="B17-metabolites-11-00492" ref-type="bibr">17</xref>] contain hundreds of functions (around 1000 for XCMS) with many different parameter-setting options. This provides experienced users with desirable flexibility and allows the development of optimized data pre-processing solutions. At the same time, this can be a challenge for time-poor researchers, occasional users, technical staff, and laboratories that analyze many diverse biological sample types. In addition, it can be difficult for users who are not familiar with the R language to build a suitable script for processing a specific dataset.</p>
    <p>Here we present MStractor, an R workflow package that offers a generic, user-friendly framework for simplifying and automating the supervised analysis of LC/MS data from untargeted metabolomics experiments. MStractor organizes, integrates, and implements a range of functions and provides GUIs for project set-up, quality control (QC) data monitoring, graphical outputs, data normalization, and descriptive statistics calculations. In addition, it provides the operator with guidance for the selection of meaningful parameters related to the analytical platform used, thus minimizing potential parameter input errors. MStractor workflow performance is critically evaluated in the following sections of this paper and compared in detail with XCMS Online [<xref rid="B16-metabolites-11-00492" ref-type="bibr">16</xref>], which is one of the most popular GUI-based tools for online pre-processing and visualisation of LC/MS metabolomics datasets.</p>
  </sec>
  <sec sec-type="discussion" id="sec2-metabolites-11-00492">
    <title>2. Discussion and Results</title>
    <sec id="sec2dot1-metabolites-11-00492">
      <title>2.1. General Overview</title>
      <p>The MStractor workflow translates raw mass spectrometry data into a base peak table output that can be used for statistical analysis. It is freely available on Github and combines a range of tools into a seamless workflow for processing large batches of metabolomics datasets quickly and easily.</p>
      <p>It is written in the R programming language, and the functionality of the toolbox is user-adaptable, extendable, and practical for wider community use by analysts and biologists. It includes high-performing tools such as XCMS and CAMERA [<xref rid="B16-metabolites-11-00492" ref-type="bibr">16</xref>,<xref rid="B17-metabolites-11-00492" ref-type="bibr">17</xref>] with specific parameter-setting functions to minimize processing errors and graphical outputs for QC.</p>
      <p>A schematic representation of the MStractor framework is displayed in <xref ref-type="fig" rid="metabolites-11-00492-f001">Figure 1</xref>, in which the different steps of the workflow are displayed together with the associated functions. The workflow has been designed to use XCMS functions compatible with the most recent xcmsEXPn object type. The package also offers the possibility of running the workflow using a lower computing power environment that utilizes the former XCMS object type (xcmsSet). This option is detailed in the package documentation and is not described here in the interest of brevity.</p>
      <p>MStractor functions can be classified into three groups:<list list-type="order"><list-item><p>Functions developed by the authors to provide the user with GUIs for parameter input and data QC monitoring (in green in <xref ref-type="fig" rid="metabolites-11-00492-f001">Figure 1</xref>).</p></list-item><list-item><p>Wrappers of XCMS and CAMERA functions that are implemented with additional code to automate routine operations and graphical output generation (in blue in <xref ref-type="fig" rid="metabolites-11-00492-f001">Figure 1</xref>).</p></list-item><list-item><p>Native CAMERA and XCMS functions. All the arguments and parameters required by these functions are automatically generated along the workflow (in orange in <xref ref-type="fig" rid="metabolites-11-00492-f001">Figure 1</xref>).</p></list-item></list></p>
    </sec>
    <sec id="sec2dot2-metabolites-11-00492">
      <title>2.2. MStractor Performance Evaluation</title>
      <p>MStractor performance was benchmarked against the existing XCMS Online tool. XCMS Online was chosen for the following reasons: both programs are directed to the same user type; they share core workflow steps (parameter input, peak detection, retention time alignment, and data visualization); and they both rely on XCMS and CAMERA packages for feature extraction and annotation. The LC/MS demo dataset for the software comparison and the chosen parameters are described in the Materials and Methods section.</p>
      <sec id="sec2dot2dot1-metabolites-11-00492">
        <title>2.2.1. Data Input</title>
        <p>Raw data files are converted into one of the supported file formats (mzXML, mzData, CDF and mzML). Files need to be stored in a directory named “MSfiles”, where raw data files are arranged in different subdirectories according to their class (see package vignettes), and based on this folder structure, each analytical sample is automatically assigned to the class of belonging within the MStractor workflow. XCMS Online (Pairwise option) requires separate uploads of each class of samples.</p>
        <p>Both workflows provide similar tools for data upload; XCMS Online uses a drag-and-drop/file explorer option, and MStractor uses the functions <monospace>Project() </monospace>and <monospace>LoadData()</monospace>. <monospace>Project()</monospace> allows setting the working directory via a file explorer GUI, while <monospace>LoadData()</monospace> uploads raw data within the R working environment.</p>
        <p>Compared to XCMS Online, the data input step in MStractor provides two additional advantages:<list list-type="order"><list-item><p><monospace>Project() </monospace>allows two analytical replicates to be defined that are used in the early steps of the workflow to evaluate peak detection parameters. It also generates a QC directory where all the QC graphical outputs and data tables generated along the intermediate steps are stored.</p></list-item><list-item><p><monospace>DefineClassAttributes() </monospace>automatically defines symbols, colours, and identifiers for each sample class. In this way, samples belonging to different classes are labelled with different colours and symbols in the graphical outputs generated. This enables easier interpretations of the generated plots, as well as performing additional quality control of the loaded files.</p></list-item></list></p>
      </sec>
      <sec id="sec2dot2dot2-metabolites-11-00492">
        <title>2.2.2. Data Processing Parameter Input</title>
        <p>Parameter input for data processing in MStractor works differently in comparison to XCMS Online.</p>
        <p>XCMS Online provides five different tabs for parameter input; “General”, “Feature detection”, “Retention time correction”, “Alignment”, and “Annotation”.</p>
        <p>All parameters must be entered before submitting the job. Although input parameters are saved and stored within the project, the user has no option to perform adjustments along the workflow.</p>
        <p>Conversely, MStractor provides GUI for input parameters in a stepwise manner, and an example of the GUI is displayed in <xref ref-type="app" rid="app1-metabolites-11-00492">Figure S2</xref>. The advantage of the MStractor stepwise parameter input scheme is to provide QC and flexibility during every stage of processing. The fit for purpose of entered values can be tested, and if required, changed prior to re-executing the functions, as described in <xref ref-type="sec" rid="sec2dot2dot3-metabolites-11-00492">Section 2.2.3</xref>.</p>
        <p>General chromatographic and mass spectrometry settings (such as retention time deviation and polarity) are defined via <monospace>ChromParam()</monospace> and <monospace>MassSpecParam() </monospace>functions, while feature-detection parameters are entered via <monospace>PeakPickingParam()</monospace>.</p>
        <p>In addition to the options available for peak detection in XCMS Online, MStractor also allows defining values for “integration threshold” and “sensitivity”, which are useful for limiting the number of features detected in the background range, thus minimizing noise in the extracted data.</p>
        <p>Feature grouping is defined within <monospace>peakPickGroup()</monospace>, while the retention time parameter input is carried out via the <monospace>RTAlign()</monospace> function.</p>
        <p>Isotopic pattern and adduct annotation in XCMS Online is based on ppm and <italic>m/z</italic> absolute error parameters, which are entered via the “Annotation” tab.</p>
        <p>In MStractor, this is achieved via the “CAMERA” package, the main functions of which are grouped within the <monospace>autoCAMERA()</monospace> function, which also provides a GUI for parameter input. After parameter input, <monospace>autoCAMERA()</monospace>identifies <italic>m/z</italic> ions that are likely to belong to the same molecule and groups them in pseudospectra. After this, annotation of the isotopic pattern and related adducts is performed. Input parameters used for <monospace>autoCamera()</monospace> are listed in <xref rid="metabolites-11-00492-t001" ref-type="table">Table 1</xref>.</p>
      </sec>
      <sec id="sec2dot2dot3-metabolites-11-00492">
        <title>2.2.3. Functionalities for Workflow QC</title>
        <p>The standout feature of MStractor is the generation of quality control (QC) outputs for intermediate (framework) steps, a characteristic that is absent in XCMS Online, as all the outputs are only accessible upon job completion. The most valuable QC features are feature-detection parameter evaluation and feature curation.</p>
        <p>For feature-detection parameter evaluation, peak-picking parameters are tested on the reference files selected at the beginning of the workflow, via <monospace>Project()</monospace>. Using the <monospace>exploreRef()</monospace> function, peak detection and grouping is performed on the selected reference files. <monospace>refTic()</monospace> prints the total ion chromatogram for reference files, while <monospace>get100() </monospace>prints an image of 100 features randomly selected across the retention time range (an example is reported in <xref ref-type="fig" rid="metabolites-11-00492-f002">Figure 2</xref>). The plot gives a general overview of the peak-picking process, showing whether extensive background noise is present or if multiple peaks were grouped into a single feature. It is, therefore, possible to adjust the input values until the desired peak-picking quality is achieved, without the need to wait until the entire workflow has been completed.</p>
        <p>In respect to feature curation, the <monospace>CollectBP_EICs() </monospace>function prints images of the extracted ion chromatograms related to the base peak matrix in two identical folders named “EICs_BasePeaks” and “EICs_BasePeaks_Curated”. The Base Peak matrix output is also stored within the working directory in a tab separated value (.tsv) file named “Pks_BPs”. The “EICs_BasePeak” is used as a backup directory and stores all the EICs prior to curation. The EICs in the directory “EICs_BasePeaks_Curated” need to be inspected by the user, and the images (features) that do not resemble resolved chromatographic peaks need to be deleted. Following this, the function <monospace>BasePks_Curated()</monospace> creates an updated data matrix based on the content of the “EICs_BasePeaks_Curated” directory. The curated data matrix (named “PksBpsCurated") is saved in a comma separated value file (.csv) within the working directory.</p>
        <p>Additionally, MStractor outputs that can be used as confirmation of workflow progression are the printed EICs for all detected features, including both raw (step 4) and retention-time-corrected data (step 6); and data tables generated at steps 7, 8, and 9 that summarize detected feature information (feature intensity, <italic>m/z</italic>, and retention time).</p>
      </sec>
      <sec id="sec2dot2dot4-metabolites-11-00492">
        <title>2.2.4. Results</title>
        <p>MStractor results were evaluated by comparing the output obtained from processing the same dataset using XCMS Online. A detailed description of the workflow parameters is provided in the Materials and Methods section. Comparison of further data visualization and data analysis tools will be discussed in <xref ref-type="sec" rid="sec2dot2dot5-metabolites-11-00492">Section 2.2.5</xref>.</p>
        <p>The XCMS Online results were returned in the form of a table; in total, 5656 features were detected. However, XCMS Online generated a data table that included all detected features, and did not provide the users with any tools for data curation or data reduction. Although very detailed, the result table contained redundant information (features belonging to the same peak group and, possibly, noise), and it might be difficult to interpret or use for further data analysis.</p>
        <p>In this respect, XCMS Online’s output can be compared to the MStractor’s “PksAn” data matrix, which is generated after CAMERA annotation and is stored in the QC directory. The number of features listed in the “PksAn” data matrix amounted to 2312. This was significantly lower than the features detected via XCMS Online; however, this was expected since MStractor allows the definition of a minimum “integration threshold” value (set to 2000) and a “sensitivity” value (set to 0.7); both limit the inclusion of background noise.</p>
        <p>Further data reduction and curation steps were subsequently performed in MStractor to rationalize the large amount of data generated. These steps included:<list list-type="bullet"><list-item><p>Condensing peak groups by retaining only the most intense feature for each peak group (<monospace>FilterDM()</monospace>). This feature selection assumes that features in an assigned group belong to the same chemical entity. After filtering, the matrix was reduced to 343 peaks. The same data-reduction step was manually performed for comparison purposes on the XCMS Online dataset, which was reduced to 1000 features.</p></list-item><list-item><p>Performing manual curation via <monospace>CollectBP_EICs()</monospace> and <monospace>BasePks_Curated()</monospace>. This step was aimed at removing background signals and peaks that were not well resolved (described in <xref ref-type="sec" rid="sec2dot2dot3-metabolites-11-00492">Section 2.2.3</xref>). During the curation step, 31 features were removed, and the final data table contained 312 features. This further curation step, however, was not available in XCMS Online, since EICs are not generated for all the features. The MStractor and XCMS Online results are summarized in <xref ref-type="fig" rid="metabolites-11-00492-f003">Figure 3</xref>.</p></list-item><list-item><p>Median normalization, which was carried out to minimize possible inter-run instrument variability.</p></list-item><list-item><p>Calculation of descriptive statistics via the <monospace>statsByClass()</monospace> function that returned separate data tables containing average values, standard deviation, and coefficient of variation (%CV ) for each sample class (Treatment and Mix in the present dataset).</p></list-item></list></p>
        <p>An extract of the result tables generated by XCMS Online and MStractor is reported in <xref ref-type="app" rid="app1-metabolites-11-00492">Tables S1–S4</xref>.</p>
        <p>The structure of the result data table generated by MStractor also provides the user with additional information. As an example, instrument response is displayed for each sample, while XCMS Online only returns the average response among classes and the standard deviation. Conversely, descriptive statistics results (average, standard deviation and %CV) are calculated and stored separately using MStractor.</p>
      </sec>
      <sec id="sec2dot2dot5-metabolites-11-00492">
        <title>2.2.5. Data Analysis and Visualization</title>
        <p>Result visualization and data analysis provide quite different outputs in MStractor and XCMS Online. Each of the different tools are discussed in the following section.
<list list-type="bullet"><list-item><p>Extracted Ion Chromatograms (EICs) and Box Plots</p><p>EIC visualization and box plots are available in XCMS Online depending on the output of the <italic>t</italic>-test (displayed in the result table). If the feature result is not significant, the plot is not generated. This is quite limiting, as the user cannot visualize all the metabolites in the biological sample. On the contrary, MStractor does not perform a significance test, but provides extracted ion chromatograms and box plots for every feature. A <italic>t</italic>-test was not included among MStractor features because it was designed to be able to accommodate pairwise and multigroup comparisons without the need of selecting dedicated workflows, as required by XCMS Online. Extracted ion chromatogram plots are automatically generated at different stages of the workflow and stored in dedicated folders.</p><p>In regard to box plots, MStractor provides more advanced visualization compared to XCMS Online. Using the <monospace>bpSel()</monospace> function, a dedicated GUI enables the user to select the classes to be represented in the box plot (an option that is particularly valuable in case of multigroup experiments). Both individual box plots and group box plot (<xref ref-type="fig" rid="metabolites-11-00492-f004">Figure 4</xref>) visualizations are saved as .html files. This allows performing immediate visual comparisons of the analyte differences among sample classes. In addition, all the plots are interactive, allowing zooming in, as well as source-data display upon hovering.</p></list-item><list-item><p>Heat map, Principal Component Analysis and Cloud Plot</p><p>Heat maps generated in MStractor and XCMS Online are very similar, as both provide interactive visualization (Heatmaply package for MStractor [<xref rid="B18-metabolites-11-00492" ref-type="bibr">18</xref>]). However, the heat map in XCMS Online can only display a limited number of features (first 1000). Thanks to the data-reduction steps, the MStractor user is provided with a heat map for the whole dataset, avoiding a partial visualization. Using the present case study, the heatmap could not be generated in XCMS Online. This, however, could be related to the speed of the internet connection, rather than XCMS Online’s computational power. An example of the heat map produced in MStractor is reported in <xref ref-type="fig" rid="metabolites-11-00492-f005">Figure 5</xref>.</p><p>On the other hand, XCMS Online provides PCA and cloud plots. Specifically, interactive cloud plot functionality is useful, since it represents the feature fold change along the retention time domain as bubble plots. A number of interactive settings are also available to filter the results based on intensity, <italic>m/z</italic>, rt, p-value, and fold change. An example is reported in <xref ref-type="fig" rid="metabolites-11-00492-f006">Figure 6</xref>. This type of feature is not available in MStractor.</p></list-item><list-item><p>Library Search, Putative Identifications</p><p>Library search and putative identifications represent another point of divergence between MStractor and XCMS Online.</p><p>Within XCMS Online, parameters for putative identification are entered via the “Identification” tab, which allows users to define the mass tolerance and select possible adducts.</p><p>Library search is performed via the METLIN database using the feature mass and the corresponding fragmentation pattern. On one hand, this option proves very valuable for datasets containing MS/MS data. On the other hand, when MS1 data are used (such as in the example dataset considered), the confidence of the putative identification performed might drop significantly, as it is based only on the accurate mass of the molecular ion and its isotopic pattern.</p><p>In MStractor, the spectrum of each chemical entity is saved as a list of <italic>m/z</italic> vs. intensities that are stored as .msp files. This type of file can be uploaded in the NIST software and searched for matches against a given spectral library.</p><p>Using GUIs, <monospace>StoreRefFeat()</monospace> and <monospace>spectraFromScan()</monospace> functions extract the raw spectra from a selected reference file, <monospace>nistEntryFromScan()</monospace> creates individual NIST compatible entries for each compound, while <monospace>createSearchList() </monospace>lists all compound spectra with unique identifiers in the .msp file. In this way, the library search can be performed for a single compound of interest or, alternatively, for all the compounds at once.</p></list-item></list></p>
      </sec>
    </sec>
  </sec>
  <sec id="sec3-metabolites-11-00492">
    <title>3. Materials and Methods</title>
    <sec id="sec3dot1-metabolites-11-00492">
      <title>3.1. Samples and Sample Preparation</title>
      <p>The sample set included in the package is for demonstration purposes and includes wine samples and a pooled biological mix. The wine samples include three biological replicates of a white wine, named “Treatment”, while the pooled biological sample used for instrument quality control (QC) was prepared by mixing equal aliquots of each sample and named “MIX”.</p>
      <p>A 1 mL aliquot of each sample was transferred in a 2 mL amber HPLC screw-cap vial and kept at 4 °C prior to analysis. Three biological replicates for each wine and three analytical replicates of the MIX were analyzed by LC/MS. The samples were injected neat.</p>
    </sec>
    <sec id="sec3dot2-metabolites-11-00492">
      <title>3.2. HPLC-QToF MS Analytical Platform</title>
      <p>Samples were analyzed using an Agilent 1200SL HPLC (Agilent, Santa Clara, CA, USA) coupled to a high-resolution Bruker micrOTof QII (Bruker Daltonics, Karlsruhe, Germany).</p>
      <p>The Agilent system was equipped with a degasser, an autosampler, a binary pump, and a column oven. Chromatography analysis was carried out using a reverse phase (RP) method adopting a Kinetex PFP column (150 mm × 2.1 mm ID, 2.6 μm particle size) manufactured by Phenomenex (Torrance, CA, USA). The column temperature was set at 30 °C.</p>
      <p>The mobile phases were solvent A (0.1% formic acid, 0.5% methanol in MilliQ water) and solvent B (0.1% formic acid, 2% MilliQ water, 40% acetonitrile in methanol). All the solvents were gradient grade for liquid chromatography from Supelco (Bellefonte, PA, USA). The flow was held constant at 0.4 mL/min, and the gradient used started at 0% B; the percentage of solvent B was then increased to 1% at 25 min, 7.5% at 80 min, 60% at 125 min, and 90% at 130 min, and then held for 3 min. The column was washed and re-equilibrated from 133 to 147 min. The sample injection volume was 1 μL.</p>
      <p>The mass spectrometer was operated in negative ESI mode using the following source conditions: temperature 200 °C, capillary voltage 3500 V, end plate offset −500 V, nebulizer pressure 2.0 Bar, dry gas flow 7.0 L/min.</p>
      <p>The mass range acquired was from 50 to 1650 amu and the acquisition rate 0.5 Hz in MS1 mode.</p>
      <p>The instrument was calibrated by infusing a 10 mM sodium formate solution at a rate of 100 μL/h. The calibrant was also injected at the beginning of each run to perform a post-run calibration.</p>
    </sec>
    <sec id="sec3dot3-metabolites-11-00492">
      <title>3.3. Dataset Preparation</title>
      <p>Prior to running the workflow, data were translated into the mzXML generic file format (other supported formats include CDF, mzData, mzML) using Proteo Wizard (Proteo Wizard, <uri xlink:href="http://proteowizard.sourceforge.net/">http://proteowizard.sourceforge.net/</uri>, accessed 13 April 2021).</p>
      <p>The dataset used in this paper is freely available and can be downloaded with the package at <uri xlink:href="https://github.com/MetabolomicsSA/MStractor">https://github.com/MetabolomicsSA/MStractor</uri>, accessed 1 July 2021.</p>
    </sec>
    <sec id="sec3dot4-metabolites-11-00492">
      <title>3.4. Hardware and Software</title>
      <p>The example dataset was processed using R version 4.1.0 and RStudio Version 1.3.1093 on a 64-bit Windows 10 Pro operating system with 32 GB of RAM and an Intel(R) Core (TM) i7-8809G CPU @ 3.10GHz processor.</p>
      <p>The same dataset was processed in parallel using XCMS Online (<uri xlink:href="https://xcmsonline.scripps.edu">https://xcmsonline.scripps.edu</uri>, accessed 30 July 2021) using the “pairwise” job option.</p>
      <p>Where possible, the same parameters were used for feature extraction. The full list is reported in <xref rid="metabolites-11-00492-t001" ref-type="table">Table 1</xref>. Besides the parameters listed in <xref rid="metabolites-11-00492-t001" ref-type="table">Table 1</xref>, XCMS Online also gives the option to perform pathway mapping. However, this option was not used because it goes beyond the scope of this paper.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec4-metabolites-11-00492">
    <title>4. Conclusions</title>
    <p>The MStractor package was critically evaluated and compared to the existing XCMS Online workflow. The main advantages of MStractor are preliminary visual outputs to evaluate parameter settings, data QC at various processing stages through graphical output and data tables, data reduction that rationalize complex data, median normalization, and detailed result tables.</p>
    <p>In this respect, MStractor provides a quick and efficient alternative for users that prefer to process their data in an offline environment, while still maintaining advanced data extraction, QC monitoring, and visualization tools, all within a single package.</p>
    <p>MStractor is used routinely in our laboratory by multiple technical staff and scientists for effectively processing a broad range of data from untargeted metabolomics experiments with biomedical, agricultural, and food samples. By offering the possibility of a deeper control on parameter settings, MStractor has proven very valuable, not only for users with minimal coding skills, but also for experienced R users. Finally, being coded in R, the MStractor workflow can be easily adapted, extended, integrated, or enhanced with other existing applications.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s Note:</bold> MDPI stays neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <app-group>
    <app id="app1-metabolites-11-00492">
      <title>Supplementary Materials</title>
      <p>The following are available online at <uri xlink:href="https://www.mdpi.com/article/10.3390/metabo11080492/s1">https://www.mdpi.com/article/10.3390/metabo11080492/s1</uri>: Table S1: MStractor raw result table extract, Table S2: MStractor normalized result table extract, Table S3: MStractor descriptive stats result extract, Table S4: XCMS Online result table extract, Figure S1: Workflow commands, Figure S2: Example of MStractor GUI for parameter input.</p>
      <supplementary-material content-type="local-data" id="metabolites-11-00492-s001">
        <media xlink:href="metabolites-11-00492-s001.zip">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
    </app>
  </app-group>
  <notes>
    <title>Author Contributions</title>
    <p>Conceptualization: J.H., L.N. and N.L.; methodology: J.H., N.L, L.N. and M.H.; software: J.H. and L.N.; validation: J.H., L.N. and N.L.; formal analysis: N.L.; data curation: J.H., N.L and L.N.; writing—original draft preparation: L.N., N.L. and M.H.; writing—review and editing: J.H., N.L, L.N. and M.H.; supervision: M.H. and N.L.; project administration: M.H. and N.L.; funding acquisition: M.H. and N.L. All authors have read and agreed to the published version of the manuscript.</p>
  </notes>
  <notes>
    <title>Funding</title>
    <p>This work was funded by Bioplatforms Australia Pty Ltd. (BPA), and investment from the South Australian State Government and the Australian Wine Research Institute. This research used NCRIS-enabled infrastructure, and the work was performed by the South Australian node of Metabolomics Australia.</p>
  </notes>
  <notes>
    <title>Institutional Review Board Statement</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Informed Consent Statement</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data Availability Statement</title>
    <p>The package and dataset described in this paper are available on GitHub <uri xlink:href="https://github.com/MetabolomicsSA/MStractor/">https://github.com/MetabolomicsSA/MStractor/</uri>, accessed on 1 July 2021.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The authors declare no conflict of interest.</p>
  </notes>
  <ref-list>
    <title>References</title>
    <ref id="B1-metabolites-11-00492">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>C.H.</given-names>
          </name>
          <name>
            <surname>Ivanisevic</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Benton</surname>
            <given-names>P.H.</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Bioinformatics: The Next Frontier of Metabolomics</article-title>
        <source>Anal. Chem.</source>
        <year>2015</year>
        <volume>87</volume>
        <fpage>147</fpage>
        <lpage>156</lpage>
        <pub-id pub-id-type="doi">10.1021/ac5040693</pub-id>
        <?supplied-pmid 25389922?>
        <pub-id pub-id-type="pmid">25389922</pub-id>
      </element-citation>
    </ref>
    <ref id="B2-metabolites-11-00492">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Mathis</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>Ventura</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Prince</surname>
            <given-names>J.T.</given-names>
          </name>
        </person-group>
        <article-title>Proteomics, lipidomics, metabolomics: A mass spectrometry tutorial from a computer scientist’s point of view</article-title>
        <source>BMC Bioinform.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-S7-S9</pub-id>
        <?supplied-pmid 25078324?>
        <pub-id pub-id-type="pmid">25078324</pub-id>
      </element-citation>
    </ref>
    <ref id="B3-metabolites-11-00492">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katajamaa</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Data processing for mass spectrometry-based metabolomics</article-title>
        <source>J. Chromatogr. A</source>
        <year>2007</year>
        <volume>1158</volume>
        <fpage>318</fpage>
        <lpage>328</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chroma.2007.04.021</pub-id>
        <?supplied-pmid 17466315?>
        <pub-id pub-id-type="pmid">17466315</pub-id>
      </element-citation>
    </ref>
    <ref id="B4-metabolites-11-00492">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Masson</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Processing and analysis of GC/LC-MS-based metabolomics data</article-title>
        <source>Methods Mol. Biol.</source>
        <year>2011</year>
        <volume>708</volume>
        <fpage>277</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-61737-985-7_17</pub-id>
        <pub-id pub-id-type="pmid">21207297</pub-id>
      </element-citation>
    </ref>
    <ref id="B5-metabolites-11-00492">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sugimoto</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kawakami</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Soga</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Tomita</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Bioinformatics Tools for Mass Spectroscopy-Based Metabolomics Data Processing and analysis</article-title>
        <source>Curr. Bioinform.</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>96</fpage>
        <lpage>108</lpage>
        <pub-id pub-id-type="doi">10.2174/157489312799304431</pub-id>
        <?supplied-pmid 22438836?>
        <pub-id pub-id-type="pmid">22438836</pub-id>
      </element-citation>
    </ref>
    <ref id="B6-metabolites-11-00492">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnsen</surname>
            <given-names>L.G.</given-names>
          </name>
          <name>
            <surname>Skou</surname>
            <given-names>P.B.</given-names>
          </name>
          <name>
            <surname>Khakimov</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Bro</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Gas chromatography-mass spec data processing made easy</article-title>
        <source>J. Chromatogr. A</source>
        <year>2017</year>
        <volume>1503</volume>
        <fpage>57</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chroma.2017.04.052</pub-id>
        <?supplied-pmid 28499599?>
        <pub-id pub-id-type="pmid">28499599</pub-id>
      </element-citation>
    </ref>
    <ref id="B7-metabolites-11-00492">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cambiaghi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ferrario</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Masseroli</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Analysis of metabolomic data: Tools, current strategies and future challenges for omics data integration</article-title>
        <source>Brief. Bioinform.</source>
        <year>2016</year>
        <volume>18</volume>
        <fpage>498</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbw031</pub-id>
        <?supplied-pmid 27075479?>
        <pub-id pub-id-type="pmid">27075479</pub-id>
      </element-citation>
    </ref>
    <ref id="B8-metabolites-11-00492">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stanstrup</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Broeckling</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Helmus</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Mathe</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Naake</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Nicolotti</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Rainer</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Salek</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The metaRbolomics Toolbox in Bioconductor and beyond</article-title>
        <source>Metabolites</source>
        <year>2019</year>
        <volume>9</volume>
        <elocation-id>200</elocation-id>
        <pub-id pub-id-type="doi">10.3390/metabo9100200</pub-id>
      </element-citation>
    </ref>
    <ref id="B9-metabolites-11-00492">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Chong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>MetaboAnalystR 3.0: Toward an Optimized Workflow for Global Metabolomics</article-title>
        <source>Metabolites</source>
        <year>2020</year>
        <volume>10</volume>
        <elocation-id>186</elocation-id>
        <pub-id pub-id-type="doi">10.3390/metabo10050186</pub-id>
        <?supplied-pmid 32392884?>
        <pub-id pub-id-type="pmid">32392884</pub-id>
      </element-citation>
    </ref>
    <ref id="B10-metabolites-11-00492">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Benke</surname>
            <given-names>P.I.</given-names>
          </name>
        </person-group>
        <article-title>MetaboNexus: An interactive platform for integrated metabolomics analysis</article-title>
        <source>Metabolomics</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>1084</fpage>
        <lpage>1093</lpage>
        <pub-id pub-id-type="doi">10.1007/s11306-014-0648-8</pub-id>
      </element-citation>
    </ref>
    <ref id="B11-metabolites-11-00492">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Want</surname>
            <given-names>E.J.</given-names>
          </name>
          <name>
            <surname>O’Maille</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>XCMS: Processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching and identification</article-title>
        <source>Anal.Chem.</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>779</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
        <pub-id pub-id-type="pmid">16448051</pub-id>
      </element-citation>
    </ref>
    <ref id="B12-metabolites-11-00492">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pluskal</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Castillo</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Villar-Briones</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>MZmine 2: Modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data</article-title>
        <source>BMC Bioinform.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>395</fpage>
        <lpage>405</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-395</pub-id>
        <?supplied-pmid 20650010?>
        <pub-id pub-id-type="pmid">20650010</pub-id>
      </element-citation>
    </ref>
    <ref id="B13-metabolites-11-00492">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clasquin</surname>
            <given-names>M.F.</given-names>
          </name>
          <name>
            <surname>Melamud</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Rabinowitz</surname>
            <given-names>J.D.</given-names>
          </name>
        </person-group>
        <article-title>LC-MS Data Processing with MAVEN: A Metabolomic Analysis and Visualization Engine</article-title>
        <source>Curr. Protoc. Bioinform.</source>
        <year>2012</year>
        <volume>37</volume>
        <fpage>1</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1002/0471250953.bi1411s37</pub-id>
      </element-citation>
    </ref>
    <ref id="B14-metabolites-11-00492">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tautenhahn</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Boettcher</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Highly sensitive feature detection for high resolution LC/MS</article-title>
        <source>BMC Bioinform.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>504</fpage>
        <lpage>519</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-504</pub-id>
        <?supplied-pmid 19040729?>
        <pub-id pub-id-type="pmid">19040729</pub-id>
      </element-citation>
    </ref>
    <ref id="B15-metabolites-11-00492">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tautenhahn</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Patti</surname>
            <given-names>G.J.</given-names>
          </name>
          <name>
            <surname>Rinehart</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>XCMS Online: A web-based platform to process untargeted metabolomic data</article-title>
        <source>Anal. Chem.</source>
        <year>2012</year>
        <volume>84</volume>
        <fpage>5035</fpage>
        <lpage>5039</lpage>
        <pub-id pub-id-type="doi">10.1021/ac300698c</pub-id>
        <?supplied-pmid 22533540?>
        <pub-id pub-id-type="pmid">22533540</pub-id>
      </element-citation>
    </ref>
    <ref id="B16-metabolites-11-00492">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gowda</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Ivanisevic</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>C.H.</given-names>
          </name>
          <name>
            <surname>Kurczy</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Benton</surname>
            <given-names>P.H.</given-names>
          </name>
          <name>
            <surname>Rinehart</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Ray</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kuehl</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Arevalo</surname>
            <given-names>B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Interactive XCMS Online: Simplifying Advanced Metabolomic Data Processing and Subsequent Statistical Analyses</article-title>
        <source>Anal. Chem.</source>
        <year>2014</year>
        <volume>86</volume>
        <fpage>6931</fpage>
        <lpage>6939</lpage>
        <pub-id pub-id-type="doi">10.1021/ac500734c</pub-id>
        <?supplied-pmid 24934772?>
        <pub-id pub-id-type="pmid">24934772</pub-id>
      </element-citation>
    </ref>
    <ref id="B17-metabolites-11-00492">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhl</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Tautenhahn</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Boettcher</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>T.R.</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>CAMERA: An integrated strategy for compound spectra extraction and annotation of liquid chromatography/mass spectrometry data sets</article-title>
        <source>Anal. Chem.</source>
        <year>2012</year>
        <volume>84</volume>
        <fpage>283</fpage>
        <lpage>289</lpage>
        <pub-id pub-id-type="doi">10.1021/ac202450g</pub-id>
        <?supplied-pmid 22111785?>
        <pub-id pub-id-type="pmid">22111785</pub-id>
      </element-citation>
    </ref>
    <ref id="B18-metabolites-11-00492">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Galili</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>O’Callaghan</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Sidi</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sievert</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>heatmaply: An R package for creating interactive cluster heatmaps for online publishing</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>34</volume>
        <fpage>1600</fpage>
        <lpage>1602</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx657</pub-id>
        <?supplied-pmid 29069305?>
        <pub-id pub-id-type="pmid">29069305</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="metabolites-11-00492-f001" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Schematic representation of the MStractor workflow and associated functions.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00492-g001"/>
  </fig>
  <fig id="metabolites-11-00492-f002" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Example of graphical output for input-parameter evaluation.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00492-g002"/>
  </fig>
  <fig id="metabolites-11-00492-f003" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Result comparison for XCMS Online and MStractor.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00492-g003"/>
  </fig>
  <fig id="metabolites-11-00492-f004" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Box plots: (<bold>a</bold>) XCMS Online; (<bold>b</bold>) MStractor individual box plot with source data displayed upon hovering; (<bold>c</bold>) MStractor group box plots.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00492-g004"/>
  </fig>
  <fig id="metabolites-11-00492-f005" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Heat map generated by MStractor.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00492-g005"/>
  </fig>
  <fig id="metabolites-11-00492-f006" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <p>Interactive cloud plot generated by XCMS Online.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00492-g006"/>
  </fig>
  <table-wrap id="metabolites-11-00492-t001" orientation="portrait" position="float">
    <object-id pub-id-type="pii">metabolites-11-00492-t001_Table 1</object-id>
    <label>Table 1</label>
    <caption>
      <p>Parameters used for XCMS Online and MStractor.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="left" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">
</th>
          <th align="left" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">XCMS Online</th>
          <th align="left" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">MStractor</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
</td>
          <td colspan="2" align="left" valign="middle" style="border-bottom:solid thin" rowspan="1">
            <bold>Feature Detection CentWave</bold>
          </td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">ppm</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">10</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">10</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Min peak width (seconds)</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">10</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">10</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Max peak width (seconds)</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">20</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">20</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Signal-to-noise threshold</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">100</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">100</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">m/z difference</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.01</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.01</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Integration method</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">1</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Prefilter peaks</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">100</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">100</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Prefilter intensity</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">750</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">750</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Noise filter</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">None</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Not applicable</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Integration threshold</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Not applicable</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">2000</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Sensitivity</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Not applicable</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.7</td>
        </tr>
        <tr>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Fit Gaussian</td>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Not applicable</td>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">FALSE</td>
        </tr>
        <tr>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
</td>
          <td colspan="2" align="left" valign="middle" style="border-bottom:solid thin" rowspan="1">
            <bold>Retention Time Correction</bold>
          </td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Method</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">loess</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">loess</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Extra peaks</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">1</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Missing</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">3</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">3</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Bw (seconds)</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">20</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">20</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Mzwid</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.1</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.1</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Minfrac</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.5</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.5</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Span</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.6</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.6</td>
        </tr>
        <tr>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Family</td>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Gaussian</td>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Gaussian</td>
        </tr>
        <tr>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
</td>
          <td colspan="2" align="left" valign="middle" style="border-bottom:solid thin" rowspan="1">
            <bold>Alignment</bold>
          </td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Bw (seconds)</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">20</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">20</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Minfrac</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.3</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.3</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Mzwid</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.1</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.1</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Minsamp</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">2</td>
        </tr>
        <tr>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Max</td>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">50</td>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">50</td>
        </tr>
        <tr>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
</td>
          <td colspan="2" align="left" valign="middle" style="border-bottom:solid thin" rowspan="1">
            <bold>Peak annotation</bold>
          </td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Sigma</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Not applicable</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">6</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Percentage of FHWM</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Not applicable</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">1</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Intensity</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Not applicable</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">maxo</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Max number of expected isotopes</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Not applicable</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">4</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">ppm error</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">10</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">10</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">m/z absolute error</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.005</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Not applicable</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Group-correlation threshold</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Not applicable</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.7</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Intensity-correlation threshold</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Not applicable</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">0.7</td>
        </tr>
        <tr>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Correlation-threshold significance</td>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Not applicable</td>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.1</td>
        </tr>
        <tr>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
</td>
          <td colspan="2" align="left" valign="middle" style="border-bottom:solid thin" rowspan="1">
            <bold>Identification</bold>
          </td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">ppm</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">10</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Not applicable</td>
        </tr>
        <tr>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">adducts</td>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[M − H]<sup>−</sup>, [M + FA-H]<sup>−</sup></td>
          <td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Not applicable</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
