<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Metabolites</journal-id>
    <journal-id journal-id-type="iso-abbrev">Metabolites</journal-id>
    <journal-id journal-id-type="publisher-id">metabolites</journal-id>
    <journal-title-group>
      <journal-title>Metabolites</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2218-1989</issn>
    <publisher>
      <publisher-name>MDPI</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6572057</article-id>
    <article-id pub-id-type="doi">10.3390/metabo9050103</article-id>
    <article-id pub-id-type="publisher-id">metabolites-09-00103</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MetPC: Metabolite Pipeline Consisting of Metabolite Identification and Biomarker Discovery Under the Control of Two-Dimensional FDR</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Jaehwi</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-09-00103">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jeong</surname>
          <given-names>Jaesik</given-names>
        </name>
        <xref ref-type="aff" rid="af2-metabolites-09-00103">2</xref>
        <xref rid="c1-metabolites-09-00103" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="af1-metabolites-09-00103"><label>1</label>Statistical Information Department, Duksung Women’s University, Seoul 01369, Korea; <email>un7743@naver.com</email></aff>
    <aff id="af2-metabolites-09-00103"><label>2</label>Statistics Department, Chonnam National University, Kwangju 61186, Korea</aff>
    <author-notes>
      <corresp id="c1-metabolites-09-00103"><label>*</label>Correspondence: <email>jjs3098@cnu.ac.kr</email>; Tel.: +82-62-530-3442</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <volume>9</volume>
    <issue>5</issue>
    <elocation-id>103</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>3</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>5</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 by the authors.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="open-access">
        <license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Due to the complex features of metabolomics data, the development of a unified platform, which covers preprocessing steps to data analysis, has been in high demand over the last few decades. Thus, we developed a new bioinformatics tool that includes a few of preprocessing steps and biomarker discovery procedure. For metabolite identification, we considered a hierarchical statistical model coupled with an Expectation–Maximization (EM) algorithm to take care of latent variables. For biomarker metabolite discovery, our procedure controls two-dimensional false discovery rate (fdr2d) when testing for multiple hypotheses simultaneously.</p>
    </abstract>
    <kwd-group>
      <kwd>hierarchical statistical model</kwd>
      <kwd>fdr2d</kwd>
      <kwd>metabolite identification</kwd>
      <kwd>latent variable</kwd>
      <kwd>Expectation-Maximization</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1-metabolites-09-00103">
    <title>1. Introduction</title>
    <p>Due to intrinsic complexity of metabolomics data, it is very challenging to preprocess the data. In essence, preprocessing of the data requires many different sequential steps including, but not limited to peak detection, peak merging, metabolite identification and peak alignment. Conducting all these steps together is not easy and each preprocessing step has been addressed separately in different studies. Especially, metabolite identification [<xref rid="B1-metabolites-09-00103" ref-type="bibr">1</xref>,<xref rid="B2-metabolites-09-00103" ref-type="bibr">2</xref>] and peak alignment [<xref rid="B3-metabolites-09-00103" ref-type="bibr">3</xref>,<xref rid="B4-metabolites-09-00103" ref-type="bibr">4</xref>,<xref rid="B5-metabolites-09-00103" ref-type="bibr">5</xref>,<xref rid="B6-metabolites-09-00103" ref-type="bibr">6</xref>,<xref rid="B7-metabolites-09-00103" ref-type="bibr">7</xref>,<xref rid="B8-metabolites-09-00103" ref-type="bibr">8</xref>] have attracted much attention compared to other preprocessing steps. Note that most preprocessing works have not taken statistical model into account to achieve their goal. But, Jeong and his colleagues employed statistical hierarchical model to address both issues such as metabolite identification and peak alignment in three different studies [<xref rid="B1-metabolites-09-00103" ref-type="bibr">1</xref>,<xref rid="B3-metabolites-09-00103" ref-type="bibr">3</xref>,<xref rid="B4-metabolites-09-00103" ref-type="bibr">4</xref>].</p>
    <p>Once metabolomics data are preprocessed, the subsequent tasks are applied to the preprocessed data. Especially, biomarker metabolite discovery has been extensively studied [<xref rid="B9-metabolites-09-00103" ref-type="bibr">9</xref>,<xref rid="B10-metabolites-09-00103" ref-type="bibr">10</xref>,<xref rid="B11-metabolites-09-00103" ref-type="bibr">11</xref>]. Here, “biomarker metabolite” means the metabolite with statistically significant difference between two groups (e.g., cancer vs. normal group). In other words, if some metabolites have huge mean difference between groups, it is more likely that they are related somehow to cancer, implying that they could possibly play a role in cancer mechanism. In this regard, it is crucial to discover them in the scientific way because they can be used as potential targets in the course of medical treatment. From the statistician’s perspective, such issue is categorized as the multiple testing problem. When testing for multiple hypotheses simultaneously, the most important issue is how to control the false discovery rate (FDR). Benjamini and Hochberg defined FDR and introduced a stepwise test rule that uses ordered <italic>p</italic> values [<xref rid="B12-metabolites-09-00103" ref-type="bibr">12</xref>]. Following the seminal paper of FDR, a test rule, which controls one-dimensional false discovery rate (fdr1d), was developed [<xref rid="B9-metabolites-09-00103" ref-type="bibr">9</xref>]. However, there is a limitation that the null hypotheses corresponding to test statistics with small standard error have higher tendency of being falsely rejected, resulting in high FDR [<xref rid="B10-metabolites-09-00103" ref-type="bibr">10</xref>]. To avoid such inflation of FDR, a new test rule, which controls two-dimensional false discovery rate (fdr2d), was introduced [<xref rid="B10-metabolites-09-00103" ref-type="bibr">10</xref>]. Comparative analysis showed that the fdr2d is much better than the fdr1d in terms of the control of FDR. It is also mentioned that the FDR control is well graphically summarized in two types of plots: volcano plot and tornado plot.</p>
    <p>Since there has been the increasing demand for the development of unified computational platform handling metabolomics data, many softwares have been developed over the last decade. However, each software has a very limited function. For example, some softwares such as XCMS Online [<xref rid="B13-metabolites-09-00103" ref-type="bibr">13</xref>] and MetSign [<xref rid="B14-metabolites-09-00103" ref-type="bibr">14</xref>] can be used for preprocessing such as peak detection and alignment while others (MetScape [<xref rid="B15-metabolites-09-00103" ref-type="bibr">15</xref>], IMPaLa [<xref rid="B16-metabolites-09-00103" ref-type="bibr">16</xref>], MetExplore [<xref rid="B17-metabolites-09-00103" ref-type="bibr">17</xref>], MetPA [<xref rid="B18-metabolites-09-00103" ref-type="bibr">18</xref>], and MetaboAnalystR 2.0 [<xref rid="B19-metabolites-09-00103" ref-type="bibr">19</xref>]) for pathway analysis and visualization. Also, MZmine2 contains some statistical analysis such as principal component analysis (PCA) and clustering. [<xref rid="B20-metabolites-09-00103" ref-type="bibr">20</xref>] The functions that each software contains are well summarized in the literature [<xref rid="B21-metabolites-09-00103" ref-type="bibr">21</xref>] (it is written in Korean and the title is translated into English by the authors). In some cases, it is important to select some meaningful information (say, biomarker) and use them for statistical analysis. Thus, we develop a bioinformatics platform that is implemented by R, which mainly consists of metabolite identification and biomarker discovery. Also, some other functions including peak merging are contained, which will be explained later in detail. In <xref ref-type="sec" rid="sec2-metabolites-09-00103">Section 2</xref>, we provide Materials and Methods. Some results are provided in <xref ref-type="sec" rid="sec3-metabolites-09-00103">Section 3</xref>, and followed by Discussion in <xref ref-type="sec" rid="sec4-metabolites-09-00103">Section 4</xref>. Additional details on the manual of the software is provided in <xref ref-type="app" rid="app1-metabolites-09-00103">Supplementary Materials I</xref>.</p>
  </sec>
  <sec id="sec2-metabolites-09-00103">
    <title>2. Materials and Methods</title>
    <sec id="sec2dot1-metabolites-09-00103">
      <title>2.1. Metabolite Identification by a Hierarchical Statistical Model</title>
      <p>The metabolite identification is processed by comparing sample metabolites with library metabolites. Such comparison is based on similarity measure, which is the input for our model. We consider a hierarchical statistical model for metabolite identification, which consists of four different layers. Each layer of the model, which reflect experimental situations, includes an observed or unobserved (latent) variable, explaining a part of the whole process (<xref ref-type="fig" rid="metabolites-09-00103-f001">Figure 1</xref> and <xref ref-type="fig" rid="metabolites-09-00103-f002">Figure 2</xref>).</p>
      <p>Firstly, <italic>Y</italic> is a binary random variable that indicates whether the metabolite in the library is in the sample (absent: 0, present: 1). In practice, we do not know what metabolites are in the sample compound and thus variable <italic>Y</italic> is a latent variable. Secondly, <italic>Z</italic> is an observable variable that indicates whether the metabolite in the library matches a particular metabolite in the sample (not matched: 0, matched: 1). As a criterion for matching, we consider the cosine score, acute angle between two mass spectra. The cosine score between two metabolites (one from sample and the other from library) is called the dissimilarity score. Matching rule is that, given a metabolite in the sample, a metabolite in the library with the smallest dissimilarity score is matched. At the end of the matching, it is possible that several sample metabolites can be matched to a metabolite in the library. Thirdly, <italic>W</italic> is a binary variable indicating whether or not the matching is correct (incorrect: 0, correct: 1). If the value of <italic>Z</italic> is zero (if the metabolite in the library does not match any metabolite in the sample), then the value of <italic>W</italic> does not need to be considered. Similarly, if <italic>Y</italic> = 0 and <italic>Z</italic> = 1, the value of <italic>W</italic> will always be zero. However, under normal circumstances, we do not know whether or not the matching is correct, implying that the variable <italic>W</italic> is also a latent variable. In the last layer of the hierarchy, we collect all dissimilarity scores from matched pairs (variable <italic>S</italic>) and then estimate the density function of the scores in the normal mixture framework. All layers of our hierarchical model are graphically summarized in <xref ref-type="fig" rid="metabolites-09-00103-f002">Figure 2</xref>.</p>
      <p>Since there are two latent variables, Expectation–Maximization (EM) comes in for parameter estimation. Furthermore, we consider a factorization of joint distribution function for computational simplicity because joint distribution is not easy to handle. By simple algebra, it is easily shown that the joint distribution is factored into multiplication of four marginal distributions:<disp-formula><mml:math id="mm1"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mi>Y</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mi>W</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
Given distribution assumption for each of four variables, we then write down the complete-data log-likelihood, <inline-formula><mml:math id="mm2"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. In E-step, we take conditional expectation of the complete-data log-likelihood given observed data, resulting in target function:<disp-formula><mml:math id="mm3"><mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm4"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> is the parameter vector. In M-step, we maximize the target function with respect to <inline-formula><mml:math id="mm5"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula>. More details about distribution assumption and EM are given in the previous literatures [<xref rid="B1-metabolites-09-00103" ref-type="bibr">1</xref>,<xref rid="B3-metabolites-09-00103" ref-type="bibr">3</xref>].</p>
    </sec>
    <sec id="sec2dot2-metabolites-09-00103">
      <title>2.2. Biomarker Discovery Under the Control of Two-Dimensional FDR</title>
      <p>Once all samples are identified, they are combined in terms of metabolites existing in all samples. After that, biomarker metabolites that have statistically significant difference between/among groups are discovered. Here, we focus on the two group problem because many problems in the real world including cancer study belong to this area. In case of classical two-sample comparison (<inline-formula><mml:math id="mm6"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm7"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), the null hypothesis is
<disp-formula><mml:math id="mm8"><mml:mrow><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
To test the null hypothesis, we use a typical <italic>t</italic>-statistic
<disp-formula><mml:math id="mm9"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm10"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm11"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm12"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> are sample mean and variance for group <inline-formula><mml:math id="mm13"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. However, note that we have to test for many hypotheses simultaneously, i.e., multiple testing problem. It is well known that classical test rule does not work in multiple testing problem. Thus, we consider controlling fdr2d.</p>
      <p>Benjamini and Hochberg introduced the concept of FDR, which is defined as the probability that null hypothesis is falsely rejected, <inline-formula><mml:math id="mm14"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>j</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> [<xref rid="B12-metabolites-09-00103" ref-type="bibr">12</xref>]. Following the seminal paper of FDR, effort of continuing improvement has been made in the mixture framework:<disp-formula><mml:math id="mm15"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm16"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm17"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are the proportions of true null and alternative, respectively, and <inline-formula><mml:math id="mm18"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm19"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are densities of <italic>z</italic> corresponding to <inline-formula><mml:math id="mm20"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm21"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, respectively [<xref rid="B10-metabolites-09-00103" ref-type="bibr">10</xref>,<xref rid="B22-metabolites-09-00103" ref-type="bibr">22</xref>]. One-dimensional local fdr is defined as follows:<disp-formula><mml:math id="mm22"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi>fdr</mml:mi><mml:mn>1</mml:mn><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
For the estimation of the fdr1d, they first estimated the crucial ratio <inline-formula><mml:math id="mm23"><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> by using logistic regression in empirical Bayes sense and then combined it with <inline-formula><mml:math id="mm24"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> [<xref rid="B22-metabolites-09-00103" ref-type="bibr">22</xref>]. Based on the estimate of fdr1d, they developed a test rule. However, Ploner and his colleagues mentioned that Efron’s fdr1d would have some problem when making decisions for test statistics with small standard error. In other words, test statistic could be inflated due to a small standard error even when the mean difference is small, leading to the false rejection of null hypothesis. As an illustrating example, suppose that we have two hypotheses with the same observed test statistic <inline-formula><mml:math id="mm25"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, but different standard errors. Then, the same values of <inline-formula><mml:math id="mm26"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are graphically represented as two distinct points (1 and 2 in <xref ref-type="fig" rid="metabolites-09-00103-f003">Figure 3</xref>) due to different standard errors.</p>
      <p>Clearly, they are separated in fdr2d, but not in fdr1d. In other words, the statistical decision for two hypothesis should be the same in fdr1d, but could be different in fdr2d. Thus, to reduce the inflation of the FDR, Ploner and his colleagues extended the one-dimensional FDR to two-dimensional one. The two-dimensional local fdr is defined:<disp-formula><mml:math id="mm27"><mml:mrow><mml:mrow><mml:mrow><mml:mi>fdr</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm28"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is <italic>t</italic> statistic and <inline-formula><mml:math id="mm29"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is logarithm of standard error of the test statistic. For the estimation of fdr2d, they first estimated the ratio by penalized log-likelihood approach:<disp-formula><mml:math id="mm30"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm31"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the number of permutation. And then they get the estimate of fdr2d by plugging the <inline-formula><mml:math id="mm32"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in the equation below:<disp-formula><mml:math id="mm33"><mml:mrow><mml:mrow><mml:mrow><mml:mi>fdr</mml:mi><mml:mn>2</mml:mn><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
It is mentioned that the <italic>t</italic> statistic reduces the combined information contained in the mean difference and the standard error to a single ratio, which is a disadvantage of Efron’s approach. In contrast, the fdr2d uses the full bivariate information, a cause of FDR reduction [<xref rid="B10-metabolites-09-00103" ref-type="bibr">10</xref>].</p>
    </sec>
    <sec id="sec2dot3-metabolites-09-00103">
      <title>2.3. Software Implementation</title>
      <sec id="sec2dot3dot1-metabolites-09-00103">
        <title>2.3.1. Two Major Goals</title>
        <p>Two major goals are sequentially addressed: metabolite identification and biomarker discovery. Overall workflow of our software is graphically summarized in <xref ref-type="fig" rid="metabolites-09-00103-f004">Figure 4</xref>.</p>
        <p>For metabolite identification, we consider a database search algorithm. Database means a library in which information about all metabolites is known. A key idea is that to identify a metabolite in sample, we look into the library and find the metabolite with the most similar features to the sample metabolite. As a dissimilarity measure, we use cosine score:<disp-formula><mml:math id="mm34"><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>180</mml:mn><mml:mi>π</mml:mi></mml:mfrac><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced separators="" open="(" close=")"><mml:mfrac><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>·</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>b</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm35"><mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the inner product of two vectors and <inline-formula><mml:math id="mm36"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the Euclidean norm of <italic>a</italic>. In our case, each component in the vector is non-negative and the range of the score is <inline-formula><mml:math id="mm37"><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>s</mml:mi><mml:mo>≤</mml:mo><mml:mn>90</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, the small cosine score meaning high similarity.</p>
        <p>For biomarker discovery, we need to reduce the dimension of the data such that a scalar value is assigned to each metabolite. Two popular reductions, which transform mass spectrum for each metabolite to a scalar value, are widely used: base peak chromatogram (the maximum value of the intensity) or total ion chromatogram (sum of all intensities). After dimension reduction, extra data manipulation such as log-transformation and scaling is taken into account. More specifically, after log-transformation, scaling within each column is performed, resulting in relative proportion (i.e., sum to 1). Thus, input for biomarker discovery is data matrix from two different groups. Each row represents each metabolite and each column each subject. Multiple testing is performed on data matrix under the control of fdr2d.</p>
      </sec>
      <sec id="sec2dot3dot2-metabolites-09-00103">
        <title>2.3.2. Kernel Density Estimator</title>
        <p>In the last layer of the hierarchy, we estimate the density function of the score in the finite mixture framework. We fit two or three component normal mixture to the scores depending on the situation. In comparison to a parametric approach, we also consider kernel density estimator (KDE):<disp-formula><mml:math id="mm38"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>K</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>K</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm39"><mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> is a bandwidth and <italic>K</italic> is a non-negative density function. Note that, even though optimal bandwidth is used as a default, bandwidth can be selected by users.</p>
        <p>Some built-in plots are added to the package to give a chance to graphically check the accuracy of the parametric density estimation. In case of parameters estimated (say, estimates of mean, variance, and component proportion), we provide trace plot to check the convergence of EM algorithm. Comparing the parametric density estimator to the KDE, the accuracy of the parameter estimation can be further checked.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="sec3-metabolites-09-00103">
    <title>3. Results</title>
    <sec id="sec3dot1-metabolites-09-00103">
      <title>3.1. Identification</title>
      <sec id="sec3dot1dot1-metabolites-09-00103">
        <title>3.1.1. Data</title>
        <p>A mixture of 35 amino acids, fatty acids and organic acids were prepared in pyridine. All GCxGC/TOF-MS analyses were performed on a LECO Pegasus 4D time-of-flight mass spectrometer (TOF-MS) with a Gerstel MPS2 auto-sampler. The Pegasus 4D GCxGC/TOF-MS instrument was equipped with an Agilent 6890 gas chromatograph featuring a LECO two stage cryogenic modulator and secondary oven. Experimental details are provided in the <xref ref-type="app" rid="app1-metabolites-09-00103">Supplementary Materials</xref> of the original literature [<xref rid="B3-metabolites-09-00103" ref-type="bibr">3</xref>].</p>
        <p>The experiments were conducted with temperature gradient of 5 <inline-formula><mml:math id="mm40"><mml:mrow><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>C/min with ten replicates. We selected two of them for illustration (the Dataset1 in Experiment I in original paper). For identification, we used those two data sets obtained from the same compound mixture. One of them is used as sample and the other one library. Before conducting identification, we performed peak merging (the peak with the biggest area is selected), resulting in 76 peaks.</p>
      </sec>
      <sec id="sec3dot1dot2-metabolites-09-00103">
        <title>3.1.2. Identification Results</title>
        <p>As a criterion for identification, we consider confidence measure, which is defined as a posterior probability that a metabolite in library exists in sample given dissimilarity score
<disp-formula><mml:math id="mm41"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm42"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is parameter estimates and <inline-formula><mml:math id="mm43"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the score assigned to the <italic>j</italic>-th metabolite in library.</p>
        <p>As a result of identification, we have a table containing two columns such as name and confidence measure. <xref ref-type="fig" rid="metabolites-09-00103-f005">Figure 5</xref> shows the top 20 metabolites in terms of posterior probabilities in the descending order. Among all metabolites in the library, those 20 metabolites are more likely to exist in the sample. Complete lists including all identification results is provided in <xref ref-type="app" rid="app1-metabolites-09-00103">Supplementary Materials II</xref>.</p>
        <p>Regarding parameter estimation, <xref ref-type="fig" rid="metabolites-09-00103-f006">Figure 6</xref> provides the trace plot of four different parameter estimates by EM. Based on the plots, it is clear that Expectation–Maximization (EM) algorithm converges fast within the first 200 iterations for all cases.</p>
        <p>For density estimation, we consider two different approaches: parametric vs. non-parametric (kernel density estimator). Two density estimates are provided in different colors in <xref ref-type="fig" rid="metabolites-09-00103-f007">Figure 7</xref> (three component normal mixture in red and kernel density estimator in black).</p>
        <p>Clearly, the parametric estimate overlaps the kernel density estimate very well, implying that EM-algorithm works well (i.e., mean and variance of each component are appropriately estimated).</p>
      </sec>
    </sec>
    <sec id="sec3dot2-metabolites-09-00103">
      <title>3.2. Real Data Anlaysis</title>
      <sec id="sec3dot2dot1-metabolites-09-00103">
        <title>3.2.1. Schisandra Data</title>
        <p>For biomarker metabolite discovery, we consider a new data set consisting of 57 schisandra chinesis from two different countries; 27 species of China and 30 species of Korean Schizandra chinensis are purchased, dried, and crushed to powder. The produced powder is extracted and then underwent derivatization to be analyzed by the GC/MS. Experimental details are given in the literature [<xref rid="B23-metabolites-09-00103" ref-type="bibr">23</xref>]. Before statistical analysis, the data are statistically processed: centering and log-transformation, resulting in 3226 by 57 data matrix.</p>
      </sec>
      <sec id="sec3dot2dot2-metabolites-09-00103">
        <title>3.2.2. Biomarker Discovery</title>
        <p>Since the data come from two different countries (Korea and China), the classical two-sample comparison is considered. We have 3226 null hypotheses to be tested simultaneously (a hypothesis for each metabolite). Controlling two-dimensional fdr, we find some metabolites showing significant difference between two countries. For this, we borrow some code from <italic>OCplus</italic> R package developed by Ploner and his colleagues.</p>
        <p>As suggested by Ploner and his colleagues, biomarker discovery results are graphically represented as volcano plot and tornado plot. In both plots, the <italic>x</italic>-axis is mean difference. The <italic>y</italic>-axis, however, is different. That is, the log(se) is used in the volcano plot while -log(<italic>p</italic> value) is used in the tornado plot.</p>
        <p>In <xref ref-type="fig" rid="metabolites-09-00103-f008">Figure 8</xref>, each point in the plot represents a hypothesis for a metabolite and each isoline corresponds to each level of FDR. The test rule is that, given a FDR level, all points outside the corresponding isoline are rejected. For example, at the fdr2d level of 0.05, 1092 null hypothesis are rejected. Furthermore, 1326, 1782, and 2120 hypothesis are rejected at the level of 0.1, 0.2, and 0.3, respectively.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec4-metabolites-09-00103">
    <title>4. Discussion</title>
    <p>Our ultimate goal is to build a streamlined bioinformatics tool that can be easily used to handle omics type big data, ranging from preprocessing to various statistical analysis. As a first step, two major issues are considered: metabolite identification and biomarker metabolite discovery. It should be emphasized that, for metabolite identification, both the sample and the library have to be provided from users, i.e., no built-in library in the program. The reason is that the composition of library heavily depends on the type of sample analyzed.</p>
    <p>As a future direction, classification (group assignment) using the discovered biomarkers will be added to the pipeline. Network analysis (metabolite–metabolite interaction) would be another direction. From different point of view, the tool will be extended to the multi-group problem. The current version of the tool is now available at the github website (<uri xlink:href="https://github.com/jjs3098/CNU-Bioinformatics-Lab">https://github.com/jjs3098/CNU-Bioinformatics-Lab</uri>). If there is an update, we then make it available as soon as possible. For reproduction of all plots provided in this study, we provide detailed explanations about how to reproduce those plots in the <xref ref-type="app" rid="app1-metabolites-09-00103">Supplementary Materials I</xref>.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We gratefully acknowledge Johan Lim for allowing us to use the real omija data for statistical analysis.</p>
  </ack>
  <fn-group>
    <fn>
      <p><bold>Sample Availability:</bold> All samples used and the current version of the tool are now available at the github website (<uri xlink:href="https://github.com/jjs3098/CNU-Bioinformatics-Lab">https://github.com/jjs3098/CNU-Bioinformatics-Lab</uri>).</p>
    </fn>
  </fn-group>
  <app-group>
    <app id="app1-metabolites-09-00103">
      <title>Supplementary Materials</title>
      <p>The following are available online at <uri xlink:href="https://www.mdpi.com/2218-1989/9/5/103/s1">https://www.mdpi.com/2218-1989/9/5/103/s1</uri>, Figure S1: Part of raw data from two dimensional GCxTC/TOF-MS.</p>
      <supplementary-material content-type="local-data" id="metabolites-09-00103-s001">
        <media xlink:href="metabolites-09-00103-s001.pdf">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
    </app>
  </app-group>
  <notes>
    <title>Author Contributions</title>
    <p>Conceptualization, J.J.; Formal analysis, J.K. and J.J.; Methodology, J.K. and J.J.; Software, J.K.; Supervision, J.J.; Validation, J.K.; Visualization, J.K.; Writing—original draft, J.J.; Writing—review &amp; editing, J.J.</p>
  </notes>
  <notes>
    <title>Funding</title>
    <p>This research was supported by Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Education (grant number: NRF-2015R1D1A1A01058223 and NRF-2018R1D1A1B07042372 to JJ).</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The authors declare no conflict of interest. The funders had no role in the design of the study; in the collection, analyses, or interpretation of data; in the writing of the manuscript, or in the decision to publish the results.</p>
  </notes>
  <glossary>
    <title>Abbreviations</title>
    <p>The following abbreviations are used in this manuscript:
<array orientation="portrait"><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1">FDR</td><td align="left" valign="middle" rowspan="1" colspan="1">false discovery rate</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">fdr2d</td><td align="left" valign="middle" rowspan="1" colspan="1">two-dimensional local false discovery rate</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">EM</td><td align="left" valign="middle" rowspan="1" colspan="1">Expectation-Maximization</td></tr></tbody></array></p>
  </glossary>
  <ref-list>
    <title>References</title>
    <ref id="B1-metabolites-09-00103">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>An empirical Bayes model using a competition score for metabolite identification in gas chromatography mass spectrometry</article-title>
        <source>BMC Bioinformat.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>392</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-392</pub-id>
      </element-citation>
    </ref>
    <ref id="B2-metabolites-09-00103">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>J.F.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Ressom</surname>
            <given-names>H.W.</given-names>
          </name>
        </person-group>
        <article-title>Metabolite identification and quantification in LC-MS/MS-based metabolomics</article-title>
        <source>Trends Anal. Chem.</source>
        <year>2012</year>
        <volume>32</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trac.2011.08.009</pub-id>
        <?supplied-pmid 22345829?>
        <pub-id pub-id-type="pmid">22345829</pub-id>
      </element-citation>
    </ref>
    <ref id="B3-metabolites-09-00103">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Model-based peak alignment of metabolomic profiling from comprehensive two dimensional gas chromatography mass spectrometry</article-title>
        <source>BMC Bioinformat.</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>27</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-27</pub-id>
      </element-citation>
    </ref>
    <ref id="B4-metabolites-09-00103">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>An efficient post-hoc integration method improving peak alignment of metabolomics data from GCxGC/TOF-MS</article-title>
        <source>BMC Bioinformat.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>123</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-123</pub-id>
      </element-citation>
    </ref>
    <ref id="B5-metabolites-09-00103">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Jeong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>An optimal peak alignment for comprehensive two-dimensional gas chromatography mass spectrometry using mixture similarity measure</article-title>
        <source>Bioinformat.</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>1660</fpage>
        <lpage>1666</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr188</pub-id>
        <?supplied-pmid 21493650?>
        <pub-id pub-id-type="pmid">21493650</pub-id>
      </element-citation>
    </ref>
    <ref id="B6-metabolites-09-00103">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Koo</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>Smith-Waterman peak alignment for comprehensive two-dimensional gas chromatography mass spectromety</article-title>
        <source>BMC Bioinformat.</source>
        <year>2011</year>
        <volume>12</volume>
        <elocation-id>235</elocation-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-235</pub-id>
        <?supplied-pmid 21676240?>
        <pub-id pub-id-type="pmid">21676240</pub-id>
      </element-citation>
    </ref>
    <ref id="B7-metabolites-09-00103">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pierce</surname>
            <given-names>K.M.</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>L.F.</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>B.W.</given-names>
          </name>
          <name>
            <surname>Synovec</surname>
            <given-names>R.E.</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive two-dimensional retention time alignment algorithm to enhance chemometric analysis of comprehensive two-dimensional separation data</article-title>
        <source>Anal. Chem.</source>
        <year>2005</year>
        <volume>77</volume>
        <fpage>7735</fpage>
        <lpage>7743</lpage>
        <pub-id pub-id-type="doi">10.1021/ac0511142</pub-id>
        <?supplied-pmid 16316183?>
        <pub-id pub-id-type="pmid">16316183</pub-id>
      </element-citation>
    </ref>
    <ref id="B8-metabolites-09-00103">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Heim</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Bogdanov</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Pugh</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Libardoni</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>DISCO: Distance and spectrum correlation optimization alignment for two-dimensional gas chromatography time-of-flight mass spectrometry-based metabolomics</article-title>
        <source>Anal. Chem.</source>
        <year>2010</year>
        <volume>82</volume>
        <fpage>5069</fpage>
        <lpage>5081</lpage>
        <pub-id pub-id-type="doi">10.1021/ac100064b</pub-id>
        <pub-id pub-id-type="pmid">20476746</pub-id>
      </element-citation>
    </ref>
    <ref id="B9-metabolites-09-00103">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Empirical Bayes Method and False Discovery Rates for Microarrays</article-title>
        <source>Gene Epidem.</source>
        <year>2002</year>
        <volume>23</volume>
        <fpage>70</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1002/gepi.1124</pub-id>
      </element-citation>
    </ref>
    <ref id="B10-metabolites-09-00103">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ploner</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Calza</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gusnanto</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Pawitan</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Multidimensional local false discovery rate for micorarray studies</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>556</fpage>
        <lpage>565</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btk013</pub-id>
        <pub-id pub-id-type="pmid">16368770</pub-id>
      </element-citation>
    </ref>
    <ref id="B11-metabolites-09-00103">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Jeong</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Controlling two-dimensional false discovery rates by combining two univariate multiple testing results with an application to mass spectromety data</article-title>
        <source>Chemom. Intell. Lab. Syst.</source>
        <year>2018</year>
        <volume>182</volume>
        <fpage>149</fpage>
        <lpage>157</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chemolab.2018.09.006</pub-id>
      </element-citation>
    </ref>
    <ref id="B12-metabolites-09-00103">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: A practical and powerful approach to multiple testing</article-title>
        <source>J. Roy. Stat. Soc. B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="doi">10.1111/j.2517-6161.1995.tb02031.x</pub-id>
      </element-citation>
    </ref>
    <ref id="B13-metabolites-09-00103">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tautenhahn</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Patti</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Renehart</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>XCMS Online: A web-based platform to process untargeted metabolomic data</article-title>
        <source>Anal. Chem.</source>
        <year>2012</year>
        <volume>84</volume>
        <fpage>5035</fpage>
        <lpage>5039</lpage>
        <pub-id pub-id-type="doi">10.1021/ac300698c</pub-id>
        <?supplied-pmid 22533540?>
        <pub-id pub-id-type="pmid">22533540</pub-id>
      </element-citation>
    </ref>
    <ref id="B14-metabolites-09-00103">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Koo</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Bogdanov</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MetSign: A computational platform for high-resolution mass spectrometry-based metabolomics</article-title>
        <source>Anal. Chem.</source>
        <year>2011</year>
        <volume>83</volume>
        <fpage>7668</fpage>
        <lpage>7675</lpage>
        <pub-id pub-id-type="doi">10.1021/ac2017025</pub-id>
        <?supplied-pmid 21932828?>
        <pub-id pub-id-type="pmid">21932828</pub-id>
      </element-citation>
    </ref>
    <ref id="B15-metabolites-09-00103">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Tarcea</surname>
            <given-names>V.G.</given-names>
          </name>
          <name>
            <surname>Karnovsky</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Mirel</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Weymouth</surname>
            <given-names>T.E.</given-names>
          </name>
          <name>
            <surname>Beecher</surname>
            <given-names>C.W.</given-names>
          </name>
          <name>
            <surname>Cavalcoli</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Athey</surname>
            <given-names>B.D.</given-names>
          </name>
          <name>
            <surname>Omenn</surname>
            <given-names>G.S.</given-names>
          </name>
          <name>
            <surname>Burant</surname>
            <given-names>C.F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metscape: A cytoscape plug-in for visualizing and interpreting metabolomic data in the context of human metabolic networks</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>971</fpage>
        <lpage>973</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq048</pub-id>
        <pub-id pub-id-type="pmid">20139469</pub-id>
      </element-citation>
    </ref>
    <ref id="B16-metabolites-09-00103">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kamburov</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Cavill</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ebbels</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Herwig</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Keun</surname>
            <given-names>H.C.</given-names>
          </name>
          <name>
            <surname>Notes</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Integrated pathway-level analysis of transcriptomics and metabolomcs data with IMPaLA</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2917</fpage>
        <lpage>2918</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr499</pub-id>
        <pub-id pub-id-type="pmid">21893519</pub-id>
      </element-citation>
    </ref>
    <ref id="B17-metabolites-09-00103">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cottret</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Wildridge</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Vinson</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Charles</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Sagot</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Jourdan</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>MetExplore: A web server to link metabolomic experiments and genome-scale metabolic networks</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>132</fpage>
        <lpage>137</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq312</pub-id>
        <?supplied-pmid 20444866?>
        <pub-id pub-id-type="pmid">20444866</pub-id>
      </element-citation>
    </ref>
    <ref id="B18-metabolites-09-00103">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wishart</surname>
            <given-names>D.S.</given-names>
          </name>
        </person-group>
        <article-title>MetPA: A web-based metabolomics tool for pathway analysis and visulalization</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>2342</fpage>
        <lpage>2344</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq418</pub-id>
        <pub-id pub-id-type="pmid">20628077</pub-id>
      </element-citation>
    </ref>
    <ref id="B19-metabolites-09-00103">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Yamamoto</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>MetaboAnalystR 2.0: From raw spectra to biological insights</article-title>
        <source>Metabolites</source>
        <year>2019</year>
        <volume>9</volume>
        <elocation-id>57</elocation-id>
        <pub-id pub-id-type="doi">10.3390/metabo9030057</pub-id>
      </element-citation>
    </ref>
    <ref id="B20-metabolites-09-00103">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pluskal</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Catillo</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Villar-Briones</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>MZmine2: Modular framework for processing, visualizing, and analyzing mass spectromety-based molecular profile data</article-title>
        <source>BMC Bioinformat.</source>
        <year>2010</year>
        <volume>11</volume>
        <elocation-id>395</elocation-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-395</pub-id>
      </element-citation>
    </ref>
    <ref id="B21-metabolites-09-00103">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Recent trends in the metabolomics</article-title>
        <source>BRIC View</source>
        <year>2015</year>
        <volume>2015</volume>
        <fpage>T09</fpage>
      </element-citation>
    </ref>
    <ref id="B22-metabolites-09-00103">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Tusher</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <article-title>Empirical Bayes analysis of a microarray experiment</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>2001</year>
        <volume>96</volume>
        <fpage>1151</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="doi">10.1198/016214501753382129</pub-id>
      </element-citation>
    </ref>
    <ref id="B23-metabolites-09-00103">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>W.J.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kwon</surname>
            <given-names>S.W.</given-names>
          </name>
        </person-group>
        <article-title>Classification of spectral data using fused lasso logistic regression</article-title>
        <source>Chemom. Intell. Lab. Syst.</source>
        <year>2015</year>
        <volume>142</volume>
        <fpage>70</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chemolab.2015.01.006</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="metabolites-09-00103-f001" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Schematic representation of 4 variables. <italic>Y</italic> is a binary latent variable representing the existence of each library metabolite in sample (<bold>top left</bold>). <italic>Z</italic> is a binary variable (observable) representing one of two status: “matched (<inline-formula><mml:math id="mm44"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>)” or “not matched (<inline-formula><mml:math id="mm45"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>)” (<bold>top right</bold>). <italic>W</italic> (<bold>bottom left</bold>) is a binary latent variable representing the matching results: correct (<inline-formula><mml:math id="mm46"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>) or not correct (<inline-formula><mml:math id="mm47"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). <italic>S</italic> is the similarity score between two mass spectra (<bold>bottom right</bold>).</p>
    </caption>
    <graphic xlink:href="metabolites-09-00103-g001"/>
  </fig>
  <fig id="metabolites-09-00103-f002" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Graphical representation of the hierarchy of our model.</p>
    </caption>
    <graphic xlink:href="metabolites-09-00103-g002"/>
  </fig>
  <fig id="metabolites-09-00103-f003" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Limitation on Efron’s FDR. Two points have the same value of <inline-formula><mml:math id="mm48"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. However, the standard error of point 1 (in red) is larger than that of point 2 (in grey).</p>
    </caption>
    <graphic xlink:href="metabolites-09-00103-g003"/>
  </fig>
  <fig id="metabolites-09-00103-f004" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Process of metabolite identification and biomarker discovery.</p>
    </caption>
    <graphic xlink:href="metabolites-09-00103-g004"/>
  </fig>
  <fig id="metabolites-09-00103-f005" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Results of metabolite identification.</p>
    </caption>
    <graphic xlink:href="metabolites-09-00103-g005"/>
  </fig>
  <fig id="metabolites-09-00103-f006" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <p>Trace plot of four parameter estimates by EM-algorithm. Parameter <inline-formula><mml:math id="mm49"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:math></inline-formula> (<bold>top left</bold>), parameter <inline-formula><mml:math id="mm50"><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:math></inline-formula> (<bold>top right</bold>), parameter <inline-formula><mml:math id="mm51"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<bold>bottom left</bold>), and parameter <inline-formula><mml:math id="mm52"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> (<bold>bottom right</bold>).</p>
    </caption>
    <graphic xlink:href="metabolites-09-00103-g006"/>
  </fig>
  <fig id="metabolites-09-00103-f007" orientation="portrait" position="float">
    <label>Figure 7</label>
    <caption>
      <p>Parametric vs. Non-parametric density estimator. Parametric density estimator (three component normal mixture) is represented in red and non-parametric density estimator (kernel density estimator) is in black. The parametric density estimator overlaps well the non-parametric density estimator.</p>
    </caption>
    <graphic xlink:href="metabolites-09-00103-g007"/>
  </fig>
  <fig id="metabolites-09-00103-f008" orientation="portrait" position="float">
    <label>Figure 8</label>
    <caption>
      <p>Tornado plot (<bold>left</bold>) vs. volcano plot (<bold>right</bold>). Four isolines corresponding to the four different levels of FDR, i.e., (0.05, 0.1, 0.2, 0.3) are represented in red.</p>
    </caption>
    <graphic xlink:href="metabolites-09-00103-g008"/>
  </fig>
</floats-group>
