<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6501302</article-id>
    <article-id pub-id-type="publisher-id">2828</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2828-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Tree reconciliation combined with subsampling improves large scale inference of orthologous group hierarchies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Heller</surname>
          <given-names>Davide</given-names>
        </name>
        <address>
          <email>davide.heller@imls.uzh.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Szklarczyk</surname>
          <given-names>Damian</given-names>
        </name>
        <address>
          <email>damian.szk@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7734-9102</contrib-id>
        <name>
          <surname>Mering</surname>
          <given-names>Christian von</given-names>
        </name>
        <address>
          <email>mering@imls.uzh.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1937 0650</institution-id><institution-id institution-id-type="GRID">grid.7400.3</institution-id><institution>Institute of Molecular Life Sciences, University of Zurich, </institution></institution-wrap>Winterthurerstrasse 190, Zurich, 8057 Switzerland </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2223 3006</institution-id><institution-id institution-id-type="GRID">grid.419765.8</institution-id><institution>SIB Swiss Institute of Bioinformatics, </institution></institution-wrap>Quartier Sorge, Batiment Genopode, Lausanne, 1015 Switzerland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>228</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>9</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>An orthologous group (OG) comprises a set of orthologous and paralogous genes that share a last common ancestor (LCA). OGs are defined with respect to a chosen taxonomic level, which delimits the position of the LCA in time to a specified speciation event. A hierarchy of OGs expands on this notion, connecting more general OGs, distant in time, to more recent, fine-grained OGs, thereby spanning multiple levels of the tree of life. Large scale inference of OG hierarchies with independently computed taxonomic levels can suffer from inconsistencies between successive levels, such as the position in time of a duplication event. This can be due to confounding genetic signal or algorithmic limitations. Importantly, inconsistencies limit the potential use of OGs for functional annotation and third-party applications.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here we present a new methodology to ensure hierarchical consistency of OGs across taxonomic levels. To resolve an inconsistency, we subsample the protein space of the OG members and perform gene tree-species tree reconciliation for each sampling. Differently from previous approaches, by subsampling the protein space, we avoid the notoriously difficult task of accurately building and reconciling very large phylogenies. We implement the method into a high-throughput pipeline and apply it to the eggNOG database. We use independent protein domain definitions to validate its performance.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The presented consistency pipeline shows that, contrary to previous limitations, tree reconciliation can be a useful instrument for the construction of OG hierarchies. The key lies in the combination of sampling smaller trees and aggregating their reconciliations for robustness. Results show comparable or greater performance to previous pipelines. The code is available on Github at: <ext-link ext-link-type="uri" xlink:href="https://github.com/meringlab/og_consistency_pipeline">https://github.com/meringlab/og_consistency_pipeline</ext-link>.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-2828-z) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Tree reconciliation</kwd>
      <kwd>Consistency</kwd>
      <kwd>Orthologous groups</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung (CH)</institution>
        </funding-source>
        <award-id>31003A-160095</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>From the initial definition of orthology and paralogy by Walter Fitch [<xref ref-type="bibr" rid="CR1">1</xref>], which distinguishes whether two genes diverged from their last common ancestor by speciation or duplication, the concept has been expanded to the notion of orthologous group (OG) [<xref ref-type="bibr" rid="CR2">2</xref>]. The latter aims to represent a set of genes from two or more species that are in a homologous relationship with respect to their last common ancestor at a given speciation event. This extends the historically pairwise relationship of orthology to be more inclusive. For example, an OG can contain paralogs, if their duplication occurred after the speciation event of reference. In fact, we distinguish between in-paralogs and out-paralogs when the duplication event occurred respectively after (in) or before (out) the speciation of reference [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p>When defining OGs, one always chooses a taxonomic level of reference, i.e. the last common ancestor of the species included in the OG. Because of this characteristic, many resources have focused their attention on providing hierarchically layered OGs [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR8">8</xref>] or "OG hierarchies" illustrated in (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). This has proven a useful extension to provide a connection from larger OGs, whose ancestor is distant in time, to more fine-grained OGs, whose species are more closely related [<xref ref-type="bibr" rid="CR6">6</xref>]. The method used to compute hierarchies of OGs differs across resources. For example, eggNOG [<xref ref-type="bibr" rid="CR9">9</xref>] and orthoDB [<xref ref-type="bibr" rid="CR10">10</xref>] compute OGs independently at various radiations on the tree of life, while others rely on a graph based approach [<xref ref-type="bibr" rid="CR11">11</xref>] or hierarchical pairwise comparison [<xref ref-type="bibr" rid="CR8">8</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>Hierarchical orthologous groups and the consistency problem. Letters represent species while the subscript number of each letter represents a gene of the relative species. Boxes and circles represent orthologous groups (OG), while the number inside the circle denotes the number of genes in the respective OG. The example shows how genes are clustered into OGs based on the chosen taxonomic level (dotted line) and how the independently computed levels can be joined into a hierarchy of OGs(right side). <bold>a</bold> shows a hierarchically inconsistent definition, while <bold>b</bold> shows the repaired and consistent definition. The presented consistency pipeline acts with split and merge operations to make the network consistent are highlighted in orange. (Figure based on [<xref ref-type="bibr" rid="CR40">40</xref>])</p></caption><graphic xlink:href="12859_2019_2828_Fig1_HTML" id="MO1"/></fig></p>
    <p>Intuitively, when discussing the prediction of OG hierarchies, gene tree inference combined with species tree reconciliation would seem the ideal answer, but it has been difficult to build phylogenies that are sufficiently accurate, while being as computationally scalable as clustering methods [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. On the other hand, clustering methods, such as eggNOG and orthoDB, must work with varying genomic signal across levels. At every level, the species composition is different and as a consequence the genetic signal will result from different rates of evolution as well as varying quality of genome annotation. It is therefore possible that two independent clustering processes at two different taxonomic levels can create hierarchically inconsistent results (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). For example, while it would be expected that all the proteins of an OG at the taxonomic level of mammals should be found in a single OG at the vertebrate level, it is possible that the previously clustered proteins split in two separate OGs at the vertebrate level. Such inconsistencies limit the propagation of information across the database and furthermore present the end-user with incompatible results for distinct levels.</p>
    <p>Here we present a new methodology to resolve inconsistent hierarchies of OGs based on tree reconciliation. We acknowledge the open challenges for large-scale OG inference faced by tree-based methods and for this reason limit their scope by subsampling the space of proteins that are part of an inconsistency beforehand. Sampling small sets of genes from each inconsistency allows to reconcile many phylogenies even for hierarchies containing very large OGs, for which it would be difficult to build accurate phylogenies. The collection of reconciled tree samples is then used to create consensus on how the OGs should be repaired (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b) to ensure consistency between taxonomic levels, rather than to re-infer the OGs entirely. To validate the approach, we have applied the consistency pipeline to the eukaryotic clade of the eggNOG database. We measured the performance through the QFO benchmarking service [<xref ref-type="bibr" rid="CR14">14</xref>] and InterPro domains [<xref ref-type="bibr" rid="CR15">15</xref>] and show that by making all OGs hierarchically consistent, we actually improve the performance of the database.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p>The proposed pipeline to resolve inconsistent OG hierarchies consists of six major steps (Fig. <xref rid="Fig2" ref-type="fig">2</xref>): (1) expanding individual OGs to a hierarchical definition connecting several taxonomic levels; (2) sampling the expanded definition by selecting subsets of proteins spanning the inconsistency; (3) building a phylogenetic tree for each of the subsamples; (4) reconciling the sampled gene trees with the species tree using a tree reconciliation algorithm; (5) joining the solutions resulting from the reconciliation to decide how to repair the inconsistency; (6) propagating the applied solution to all lower levels if new inconsistencies are formed. Since the current application of the methodology is the eggNOG database, we will describe the following sections with the latter in mind, but the approach can be adapted easily to other sources. An open source python implementation using the Snakemake workflow engine [<xref ref-type="bibr" rid="CR16">16</xref>] is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/meringlab/og_consistency_pipeline">https://github.com/meringlab/og_consistency_pipeline</ext-link>.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Flowchart of the consistency pipeline Given an inconsistent hierarchy of OGs, the consistency pipeline traverses the hierarchy of levels in reversed level order, i.e. starting from the leaves, every parent level is visited only after all lower levels have been visited (outer loop). To make each level hierarchically consistent with all its lower levels, the described six steps are applied for each inconsistency in the level (inner loop): (1) expansion of OGs between one parent level and its children levels, to identify hierarchical inconsistencies (red lines); (2) subsampling of the expanded OG (dashed oval) to obtain sequence samples; (3) Gene tree computation from the sequence samples and pruning of the general species tree to match individual gene tree samples; (4) reconciliation of gene tree and pruned species tree samples; (5) majority vote to determine the solution to resolve the inconsistency, i.e. merge or split; (6) propagation of the split decision if new inconsistencies arise in children’s descendant levels. The algorithm repeats until the root level is completed and the entire hierarchy will be consistent</p></caption><graphic xlink:href="12859_2019_2828_Fig2_HTML" id="MO2"/></fig></p>
    <sec id="Sec3">
      <title>Expansion of orthologous groups</title>
      <p>The expansion step consists of detecting hierarchical inconsistencies, by following the protein members of each OG between related levels (parent-children). The parent level is the next higher taxonomic rank, i.e. closer to the root level in the taxonomy tree. For example, in eggNOG’s level hierarchy a higher level would be Supraprimates while its lower levels would be Primates and Rodents. Starting from the proteins of an OG at a lower level, each protein is matched at the higher level to determine whether it is assigned to a higher level OG. For each protein of the matched higher OG, the search process is reversed towards the lower levels, to determine the assignment in the lower levels. The search process continues as long as new OGs are found. In a graph analogy, OGs would be the nodes of a graph where edges represent protein overlap between a higher and a lower OG. In this analogy, the search algorithm simply determines the connected components of the graph. We denote each connected component as expanded OG (Fig. <xref rid="Fig2" ref-type="fig">2</xref>, dashed oval) to represent the fact that it was created by expanding a single initial OG. Hierarchical inconsistencies, are now easily found whenever the proteins of a lower OG diverge in two or more higher OGs. Because of the presence of singletons (single protein member not assigned to any OG), we differentiate inconsistencies when composed of only singletons at the higher level or only one higher OG of size larger than two. These trivial cases are automatically assigned to be merged without further phylogenetic testing.</p>
    </sec>
    <sec id="Sec4">
      <title>Sampling the inconsistencies</title>
      <p>To assess via tree reconciliation how to resolve a hierarchical inconsistency, we apply a subsampling strategy. Since OGs can consist of hundreds or even thousands of proteins, it is computationally expensive to build reliable phylogenetic trees including all proteins in the inconsistency. Therefore, we repeatedly sample a subset of proteins and use the latter to build phylogenetic trees for the reconciliation step. The sampling strategy is a guided process, i.e. not entirely random; instead, the species composition should be such that the last common ancestor is located at the higher taxonomic level. This criterion ensures that the tree reconciliation step determines whether, to solve the inconsistency, the higher OGs should be merged (speciation event) or left separated (duplication event) by splitting the lower OGs. In order to fulfill the criterion, the guided sampling process first determines the species composition of all the proteins in the inconsistency. Then, the species composition is used to determine which child taxonomic levels are composing the problem. For example, for an inconsistency at Supraprimates, the species composition could be Primates, Rodents or Leporidae species, added at Supraprimates. By sampling proteins from at least two of these levels, we can ensure that the root of the sampled tree is located at Supraprimates. For the special case in which the species composition comes from only one of the child levels, e.g. primates, a merge decision is automatically assigned without further phylogenetic testing. This follows the assumption, that such inconsistencies are best addressed already at the lower level, e.g. whether the inconsistent primate’s proteins should be clustered together or not.</p>
    </sec>
    <sec id="Sec5">
      <title>Tree building</title>
      <p>For each sample, we retrieve the protein sequences used to define the orthologous groups (see “<xref rid="Sec10" ref-type="sec">Input data</xref>” section) and build a phylogenetic tree. The multiple sequence alignment is computed using MAFFT [<xref ref-type="bibr" rid="CR17">17</xref>] and the phylogenetic tree is built with FastTree [<xref ref-type="bibr" rid="CR18">18</xref>]. While several other combinations are possible, we chose the latter combination due to its reliability and speed. The resulting trees are rooted with the midpoint criterion, which in absence of reliable outgroup information is a reasonable alternative [<xref ref-type="bibr" rid="CR19">19</xref>] and is commonly chosen by high-throughput phylogenetic tree workflows [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    </sec>
    <sec id="Sec6">
      <title>Tree reconciliation</title>
      <p>For every sampled phylogenetic tree, we prune a general species tree until it only includes the species in the sample. The reconciliation between the sampled gene tree and the pruned species tree is performed using the tree reconciliation software NOTUNG [<xref ref-type="bibr" rid="CR21">21</xref>]. The results of the tree reconciliation predict for each inner tree node which evolutionary event has occurred, using the maximum parsimony principle. We limit the inference to the detection of speciation, duplication (D) and loss events (L), also defined as the DL scenario. While it is possible to include the detection of lateral gene transfer (LGT) events, i.e. the DTL scenario, we do not expect that in the eukaryotic domain of life LGT events have a strong influence on inconsistencies given their limited occurrence [<xref ref-type="bibr" rid="CR22">22</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Solution joining</title>
      <p>The evolutionary events resulting from the reconciliation algorithm suggest the solution for solving the inconsistency and making the hierarchy of OGs consistent. Specifically, we focus on the evolutionary event corresponding to the root of the tree to decide whether to split or merge the inconsistency. A duplication event indicates that at the current taxonomic level the two sister clades are in a paralogous relationship and therefore the higher OGs should stay separated. We apply the split decision, to separate the lower, inconsistent, OG into two or more OGs according to the higher OGs by protein overlap. A speciation event indicates instead that the two sister clades are orthologous and should by definition be part of the same orthologous group. We apply the merge decision to join the higher OGs into a single OG. Because for each inconsistency we have multiple tree reconciliations, we separate the join process into two sub-routines. First, individual reconciliation samples are aggregated by majority vote to decide whether to merge the higher OGs or split the lower OG. Second, since the expanded OG can be composed of several inconsistencies, we apply the solutions iteratively until the expanded OG is completely consistent.</p>
    </sec>
    <sec id="Sec8">
      <title>Solution back-propagation</title>
      <p>While merge operations change the higher taxonomic level, without influencing the lower levels, the split operations divide OGs at the lower levels, making it possible that new inconsistencies arise in the subtree of the descendant levels, which was previously consistent. Using the eggNOG level hierarchy as example, if an inconsistency between the higher level Mammalia and the lower level Superprimates is solved by splitting the OG at the Superprimates level, this may create an inconsistency with its descendant levels, Primates and Rodents. To ensure maintenance of consistency, split operations are therefore back-propagated towards the leaf levels whenever new inconsistencies arise, that is, the conflicting OGs in lower levels of the hierarchy are split as well until no inconsistency is present in the sub-hierarchy.</p>
    </sec>
    <sec id="Sec9">
      <title>Methods and data for validation</title>
      <sec id="Sec10">
        <title>Input data</title>
        <p>We applied the consistency pipeline to version 4.0 of the eggNOG database [<xref ref-type="bibr" rid="CR23">23</xref>], which provides non-supervised orthologous groups for 2031 species across 107 taxonomic levels. For this study, we focused on repairing the eukaryotic clade of the eggNOG level tree containing 238 species and 2’859’900 clustered proteins. In this particular subset of the database there were 273’784 inconsistencies, out of which 63’846 classified as non-trivial (see sampling method). The pipeline was applied to each level in the hierarchy in reversed level order (leaf to root), such that for every level the children are either leaves or have already been repaired to be consistent towards lower levels.</p>
      </sec>
      <sec id="Sec11">
        <title>Species tree</title>
        <p>The species trees used for reconciling gene trees in the reconciliation step are pruned versions of the same general species tree. The latter species tree was computed using 40 marker genes and the NCBI reference taxonomy as a constraint [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
      </sec>
      <sec id="Sec12">
        <title>Algorithm parameters and performance</title>
        <p>The consistency pipeline has two parameters that determine the sampling algorithm, the number of samples (n) and the number of protein sequences in each sample (m). For the results shown below, we used n=30 and m=25, leading to a total average of 1’214’808 reconciled trees to resolve all non-trivial inconsistencies. The tree computations and reconciliations were parallelized on an SGE cluster with 600 cores. The remaining tasks, including expansion, sampling and joining were performed on a high memory machine using 10 cores. Overall, the execution of the pipeline lasted on average 21 h (of which cluster operations: 10h tree computations, 3.6h reconciliation).</p>
      </sec>
      <sec id="Sec13">
        <title>Third party software parameters</title>
        <p>MAFFT (v6.861) [<xref ref-type="bibr" rid="CR17">17</xref>] was used with default parameters (–auto) and –memsave when the input sequence was above 4000 amino acids; FastTree (v2.1.9) [<xref ref-type="bibr" rid="CR18">18</xref>] with -nopr -pseudo -mlacc 3 -slownni options for increased reconstruction accuracy; NOTUNG (v2.9) [<xref ref-type="bibr" rid="CR24">24</xref>] with default weighing scheme (D=1.5, L=1) and the –rearrange option with threshold 0.9. The latter option rearranges the topology of the tree for weakly supported branches to minimize the cumulative cost of the reconciliation.</p>
      </sec>
      <sec id="Sec14">
        <title>Quest for Orthologs (QFO) benchmark</title>
        <p>We used the orthology benchmark service published by Altenhoff et al. [<xref ref-type="bibr" rid="CR14">14</xref>], which offers three main test categories for the evaluation of orthologous gene pairs: (1) Species Tree discordance tests, (2) Gold standard gene tree tests and (3) Gene Ontology and Enzymatic Nomenclature tests; Importantly, no single test category is identified as more important than the others. The QFO benchmark uses 66 reference proteomes and aims to provide a "common denominator" for method comparison in the orthology field. We continue to support this effort but acknowledge, together with the benchmark authors [<xref ref-type="bibr" rid="CR14">14</xref>], that the included tests are geared towards orthologous pair predictions and less optimized for OG predictions and, to an even lesser degree, for hierarchical OG definitions. Furthermore, given the reduced number of reference proteomes, it was not possible to define a large taxonomic hierarchy for which to apply the consistency pipeline. We therefore mapped the QFO proteomes through the reciprocal best hit method to the eggNOG proteomes and designed a simple bottom up algorithm to convert the hierarchy of OGs into pairs of orthologs (see Additional file <xref rid="MOESM5" ref-type="media">5</xref>). Given the high degree of variability introduced by such conversion process, we used the benchmark service as a control to test whether the orthologous pair prediction performance changed after applying consistency rather than to compare against other methods submitted to the QFO benchmark.</p>
      </sec>
      <sec id="Sec15">
        <title>Domain benchmark</title>
        <p>We devised a benchmark that is better suited for larger number of species and hierarchies of OGs, by analyzing the protein domain distribution across OGs. From a structural point of view, domains constitute the functional units of proteins but at the same time, from an evolutionary perspective, they are also highly conserved protein sequences [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. They are the most straight forward building blocks of deep homology [<xref ref-type="bibr" rid="CR27">27</xref>] and as such tightly connected to the definition of OGs. As originally shown by [<xref ref-type="bibr" rid="CR2">2</xref>], OGs tend to closely represent conserved domain families. The assumptions for this benchmark are twofold: in a hierarchy of OGs, the OG at the taxonomic level closest to the evolutionary origin of the domain, should (1) contain all annotated proteins and (2) exclude the proteins with conflicting domain annotation. Since these assumptions are not without challenges [<xref ref-type="bibr" rid="CR26">26</xref>], we have excluded domains with short sequence length (&lt;= 50aa) given their high degree of mobility [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>] and excluded potential cases of convergent evolution (e.g. zinc-fingers and repeats). Furthermore, since we applied our pipeline to the eukaryotic levels of eggNOG, we restricted the benchmark to domains that were annotated exclusively in Eukaryotes and present in at least 5 species.</p>
        <p>To annotate the proteins in the eggNOG database we used the domain database InterPro(v64.0) as well as the UniProt database to link protein identifiers. We restricted the test set of eggNOG proteins to a subset with high confidence matching to UniProt (1-to-1 mutual best hits and above 70% sequence identity). This condition limits the maximum number of available annotations, but minimizes the error rate of incorrect-annotation due erroneous mapping. We use the mapping file available from InterPro FTP service (protein2interpro.dat.gz, version 64, [<xref ref-type="bibr" rid="CR15">15</xref>]) to identify the UniProt ids to annotate. Additionally, we selected the domains originating from the PFAM database to define a consistent source of annotation and further pruned the dataset as described above. The final set of tested domains can be further divided into InterPro Domains and InterPro Families [<xref ref-type="bibr" rid="CR30">30</xref>]. The total number of tested domains is 4120, out of which 2143 are defined as InterPro Family and 1977 as InterPro Domain.</p>
        <p>For each tested protein domain the dataset contains several proteins which are annotated with the domain. These proteins constitute the maximal set of positive elements for the test when we compute the statistical performance measures for a matching OG, i.e. with at least one protein annotated with the tested domain. We divide the OG’s proteins into 3 categories: (1) proteins with the domain annotation which constitute the true positives (TP); (2) proteins without the domain annotation but from species which have been annotated with that domain, i.e. the false positive (FP), and (3) the remaining proteins without the domain annotation but from species which do not have the tested domain annotation and are therefore excluded from the test. Finally, the other proteins in the dataset at the same taxonomic level that are annotated with the tested domain are the false negatives (FN). We also excluded from testing proteins that were not matched with sufficiently high score to UniProt. We computed precision (or positive predictive value, <italic>PPV</italic>=<italic>TP</italic>/(<italic>TP</italic>+<italic>FP</italic>)), recall (or true positive rate, <italic>TP</italic><italic>R</italic>=<italic>TP</italic>/(<italic>TP</italic>+<italic>FN</italic>)) and their harmonic mean or F1 score, to be used as the final score with which to validate the benchmark. For each domain, the best F1 score is selected across all levels.</p>
      </sec>
      <sec id="Sec16">
        <title>Ad-hoc consistency strategy for eggNOG 4.5</title>
        <p>We have developed a temporary method of forcing the consistent hierarchy by repairing the obvious clustering errors without introducing significant deviation from the size distribution of the original OGs [<xref ref-type="bibr" rid="CR9">9</xref>]. As with the presented reconciliation-based method, the algorithm is applied in reverse (leaf to root) level order prioritizing the human branch. For every inconsistency between the tested and the parental level, the method is applied iteratively between the largest parental cluster and every other affected parental cluster in the descending size order. The decision consists of either joining the parental clusters (merge) or splitting the proteins from the tested cluster (split) at the tested level and every affected branch in the leaf-ward direction. The method, by default, joins the inconsistent clusters when there is no overlap between species. If such overlap exist the merge decision is applied only to groups with dissimilar sizes (more than 100% size difference) otherwise the split decision is applied. Such blunt heuristic seems not to create very large OGs which are not present in the original clustering.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec17" sec-type="results">
    <title>Results</title>
    <p>We present the benchmark results by comparing the consistent OG definition generated by our method (Level Sampling - LS) against OG definitions generated, using the same eggNOG dataset, by the following methods: the original inconsistent version (v4.0), the ad-hoc strategy for eggNOG v4.5 (v4.5), a strategy that always merges inconsistencies (MERGE – M), always splits inconsistencies (SPLIT – S) and randomly chooses whether to split or merge an inconsistency with equal probability (RANDOM – RND). Besides the original definition (v4.0) all other OG definitions are hierarchically consistent.</p>
    <p>In (Additional files <xref rid="MOESM4" ref-type="media">4</xref>: Figure S4 and <xref rid="MOESM6" ref-type="media">6</xref>: Table S2) we show the results from the QFO benchmark service. Since the presented method (LS) consists solely of eukaryotic OGs, the ortholog predictions from missing species pairs are taken from (v4.0), the baseline. The results showed close performance between the baseline (v4.0), the presented method (LS) and the ad-hoc strategy (v4.5), while the (SPLIT) scenario departs from the baseline (v4.0) with a much lower number of predicted pairs throughout all tests (low recall). It was not possible to identify a clear winner across the benchmark, with all versions often aligning orthogonally to the direction of best performance. Generally speaking, for the species tree discordance tests (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figure S4A,B), the presented method (LS) shows a more balanced performance, completing more tree samplings (4/6 tests) than the baseline (v4.0) as well as being more precise in average RF distance (5/6 tests) and average fraction of incorrect trees (4/6 tests) than baseline (v4.0) and the ad-hoc strategy and (v4.5). For the reference gene tree tests the ad-hoc strategy (v4.5) has a better recall and precision (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figure S4C,D). RND and MERGE were not included due to the high number of generated orthologous pairs (respectively more than 8 billion pairs for MERGE and 3 billion pairs for RND, compared to less than 21 million pairs for each of the remaining methods).</p>
    <p>In (Fig. <xref rid="Fig3" ref-type="fig">3</xref>) we introduce the results of the domain benchmark with the example domain Pop3 (InterPro Family IPR013241: RNase P, subunit Pop3). This domain is annotated in 47 fungal species, with each 1 annotated protein. The line profiles connect the best matching OG for each version for a hierarchy of nested taxonomic levels, in this example from Saccharomyceta over Ascomycota, Fungi, Opistokonta to Eukaryota. The inconsistent version (v4.0) represents our baseline performance. The line profile shows that the best scoring OGs do not include all annotated proteins (17 at most) with the consequent low F1 score. This is also visualized in (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a), which shows the OG network as explored by the expansion step (see <xref rid="Sec2" ref-type="sec">Methods</xref>) before repairing inconsistencies. Inconsistencies are the branching points in the upwards direction and reflect the reassignment of proteins. The random strategy, albeit consistent (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c), did not improve the performance of the OG definition by resolving the inconsistencies. The ad-hoc strategy based on species-overlap, performed better but still missed the majority of annotated proteins. In this example, our method (LS) obtained the best score by merging the inconsistencies into a single OG (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Domain benchmark results for tested OG definitions (S/SPLIT; M/MERGE; RND/RANDOM; Level Sampling/LS; 4.0/v4.0; 4.5/v4.5). <bold>(A’-A”)</bold> Example evaluation of InterPro entry IPR013241 (RNase P, subunit Pop3). F1 score and size (no. of proteins) are shown for the orthologous group (OG) with the best matching (F1) to annotated proteins (n=47), for each tested definition (colors) and selected taxonomic levels. Levels in nested order: Saccharomycetales, Ascomycota, Fungi, Opistokonta, Eukaryota. <bold>(B’-B”)</bold> Cumulative results for all tested domains (n=4120). For every OG definition (columns), for each domain, the best matching OG (F1 score) across all tested taxonomic levels is chosen. One-sided paired Wilcoxon signed rank test, alternative hypothesis F1(v4.0) - F1(LS) &lt; 0, p-value: &lt; 0.0001 (all cases); F1(v4.5) - F1(LS) &lt; 0, p-value all domains: 0.06 (InterPro Family type 0.02 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2A’) and non-significant for InterPro Domain type (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2A”)). <bold>(C)</bold> Selective comparison on 858 domains that differ more than 0.1 in F1 score between the compared methods (LS, v4.0, v4.5). Every point in the scatterplot represents F1 score and size of the best matching OG</p></caption><graphic xlink:href="12859_2019_2828_Fig3_HTML" id="MO3"/></fig>
<fig id="Fig4"><label>Fig. 4</label><caption><p>Expanded OG network example for proteins annotated with InterPro entry IPR013241. Circles represent individual OG scaled for size and connected to OGs at different taxonomic levels (legend) to represent protein overlap. Labels within the circle represent the size of the OG corrected for proteins which were not mapped to UniProt (see data methods). The network represented in (<bold>b</bold>) shows the same network as in (<bold>a</bold>) after application of the consistency pipeline. Likewise (<bold>c</bold>) also shows the same network as (A) but was made consistent by applying random split and merge decisions. All three networks were pruned to the levels represented in Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, for complete networks see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1</p></caption><graphic xlink:href="12859_2019_2828_Fig4_HTML" id="MO4"/></fig></p>
    <p>To combine findings for individual domains, we selected the OG with the highest F1 score among all levels as representative for the respective OG definition. The boxplots in (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b) show the aggregated results for 4120 InterPro domains. The always split strategy obtained the lowest performance and generates a smaller OG size distribution (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2C). Similar performance is obtained by the random strategy, which created both smaller and larger aggregations. The always merge strategy obtained performance similar or better than the inconsistent version, but also generates a very skewed OG size distribution, culminating in a very large cluster at the Eukaryota level (1’533’579 proteins in one OG out of 2’859’900 cumulatively clustered level proteins, 53.62%). The presented method (LS) performed better than the inconsistent version (v4.0) in all tested scenarios (one-sided paired Wilcoxon signed-rank test, p-value &lt; 0.0001) and has comparable or better performance than the ad-hoc strategy (v4.5) (one-sided paired Wilcoxon signed-rank test, p-value for all domains 0.06 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b’), for InterPro Family type 0.02 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2A”) and non-significant for InterPro Domain type (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a’)). We simplified the difference for visualization in (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c) by representing only the domains for which the F1 score difference between the methods (LS, v4.0, v4.5) is greater than 0.1. Importantly, the presented LS method did not alter the OG size distribution extensively.</p>
  </sec>
  <sec id="Sec18" sec-type="discussion">
    <title>Discussion</title>
    <p>In the presented methodology, inconsistencies are solved using one of two possible decisions: (1) splitting the lower OG by subdividing it according to intersection with the OGs at the higher level, resulting in two or more smaller orthologous groups; (2) merging the higher OGs into one single OG, containing all proteins from the OG at the lower level. From this perspective, the reconciliation strategy is one of many possible binary strategies that indicates for every inconsistency whether to split or merge. The resulting OG definition is consistent as long as the chosen strategy does not create new inconsistencies, for example by back-propagating split decisions (see <xref rid="Sec2" ref-type="sec">Methods</xref>).</p>
    <p>Notably, also choosing randomly whether to split or merge an inconsistency with back-propagation fulfill the requirements to obtain a hierarchically consistent definition. While consistent, the results for a random or constant decision (always merge/split) were not favorable, and led to either low performance and/or excessive aggregation. A very large and unspecific orthologous group is in contrast with the aims of the OG prediction which seeks to represent groups which can be described as protein families with a common functional characteristics [<xref ref-type="bibr" rid="CR2">2</xref>]. Indeed, in the introductory example (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a) we see both F1 score and OG size (number of protein members) plateau for the last two levels. This is expected, as the sequence similarity is potentially too small to produce larger clusters at the Eukaryota level, despite speculations that the InterPro Pop3 domain is likely to be related to human RNase P subunit Rpp38 ([<xref ref-type="bibr" rid="CR31">31</xref>], InterPro description for IPR013241). In the same example, the InterPro annotation is also not represented entirely by a single OG, which is due to the fact that all tested methods rely on the initial clustering (v4.0). More precisely, if in the original definition the OGs containing all annotated proteins are never linked across taxonomic levels by an inconsistently classified protein, the methods targeted at repairing inconsistencies, will never be able to form a single OG containing them (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 v4.0). While it is possible to develop methods that aim to change also hierarchically consistent OGs, it is beyond the scope of the current method to build entirely new OG definitions. On a related note, given that the example annotation is strictly contained in the Fungi kingdom, it would be correct to assume that the best F1 score should be already found at the Fungi level and not at Opisthokonta (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a’). This can be understood considering that the presented methods only merges OGs in the upwards direction, that is, with respect to the OG at the lower level, which proteins are divided into several OGs at the next higher level. The decision of merging lower OGs is possible but does not resolve the inconsistency. On the contrary, the aggregation of lower OGs can potentially create new inconsistencies.</p>
    <sec id="Sec19">
      <title>QFO benchmark</title>
      <p>The close clustering of the presented method (LS) to the ad-hoc strategy (v4.5) and to the baseline (v4.0) in the QFO benchmark results (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figure S4) is a general indication, that the consistency pipelines preserve the pairwise orthologs prediction performance, but it may also indicate that the tests are not sensitive enough for testing differences in hierarchical OGs. The high recall and precision of the ad-hoc strategy (v4.5) method in the reference tree tests can be partially explained by the more conservative approach in merging OGs, which artificially limits the maximum size of OGs. The presented version (LS) of our method, does not include such size limiting heuristic. We have implemented similar strategies in the production version for the next release of eggNOG (v5.0), bound by computational resources given the high number of included species (5090). This version obtained better recall and precision scores by adding pre-processing operations for OG size control, suggesting that such simple heuristics can indeed increase the robustness of a consistency method when the signal to noise ratio is low. Similar performance improvements can be expected if more computational resources were allocated for more extensive sampling, improved gene tree prediction or tree reconciliation.</p>
    </sec>
    <sec id="Sec20">
      <title>Method parameter space</title>
      <p>Overall the results of the proposed consistency pipeline show comparable or better performance (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2) than current methods, suggesting that sampling the protein space of the inconsistencies and using tree reconciliation can correctly determine how to solve an inconsistency. The method does, however, have a large parameter space. Being composed of several individually challenging parts, such as the phylogenetic tree construction and reconciliation, it is virtually impossible to do an extensive parameter screen. Phylogenetic workflows offer a plethora of possible tool and parameter combinations and can vary greatly in computational demand and accuracy. Tree reconciliation in addition, proposes a large number of inferable evolutionary hypotheses and requires individual event cost parametrization in the maximum parsimony framework [<xref ref-type="bibr" rid="CR32">32</xref>]. For these reason, we guided our choice by practicality (rather than result optimization) and selected a combination of established methods (MAFFT [<xref ref-type="bibr" rid="CR17">17</xref>], FastTree [<xref ref-type="bibr" rid="CR18">18</xref>], NOTUNG [<xref ref-type="bibr" rid="CR24">24</xref>]) for a consistent baseline performance and high throughput capability.</p>
      <p>Another important set of parameters of the consistency pipeline govern the sub-sampling step. Sample size (M) and sample number (N) determine the size (no. of sequences) and the number of reconciled trees per inconsistency. To choose the used combination for the results (LS), we performed a convergence analysis of 208 large OGs at the Bilateria level with a starting size (before expansion) of at least 50 proteins. We measured convergence by computing the ratio of the reconciliation outcome between inferred duplication over speciation events (D/S ratio). In (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S3A) we show that for each choice of M the D/S-ratio converges with increasing N. In most cases (155/208, 73%) the final convergence values were in close vicinity (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S3A’-A”’, std &lt; 0.15) while the remaining had larger divergence (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S3A””). We explain this divergence, by the fact that a smaller sample size inherently limits the maximum amount of sequence variation captured by the tree sample. While it is computationally infeasible to always sample large trees, we chose a value of M=25 that reduces the variation of the D/S scores towards higher M values (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S3B), while still being computationally feasible. To choose the sample number N, we computed confidence intervals (0.95) along the convergence by comparing the outcome to a Bernoulli process with unknown success probability and correcting the estimate for small sample size [<xref ref-type="bibr" rid="CR33">33</xref>]. The same results were also confirmed by the standard Wald method [<xref ref-type="bibr" rid="CR34">34</xref>]. As one might expect the confidence interval initially widens to then decrease along N (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S3C). We chose N=30 to combine the computational limitations and the reduction in variance with increasing N (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S3D).</p>
      <p>The sample composition is also important for the final step of the reconciliation algorithm, as the merge-split decision is taken based on the evolutionary event inferred at the root of the tree. While we include multiple branches of life by selectively sampling the protein space (see <xref rid="Sec2" ref-type="sec">Methods</xref>), tree rooting remains a difficult phylogenetic problem. A possible improvement for this could be the selection of an outlier sequence in each sample to make the inference of the root easier or using an un-rooted reconciliation approach such as [<xref ref-type="bibr" rid="CR35">35</xref>]. Another promising improvement lies in a recently proposed aggregated tree reconciliation or super-tree reconciliation [<xref ref-type="bibr" rid="CR36">36</xref>], holding the possibility of more accurate results.</p>
    </sec>
  </sec>
  <sec id="Sec21" sec-type="conclusion">
    <title>Conclusion</title>
    <p>We developed a new methodology to solve inconsistencies in hierarchies of OGs based on tree sampling and gene-species tree reconciliation. Against previous results, suggesting that tree reconciliation has limited applicability in the context of large scale inference of OGs [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>], we show that it can be effectively employed to determine the solution to hierarchical inconsistencies if combined with sub-sampling. We apply the consistency pipeline to the eggNOG database in the eukaryotic domain of life and evaluate results using protein domain annotations from the InterPro database. Benchmark results reveal comparable or greater performance than the original inconsistent version or the currently employed ad-hoc consistency strategy. Based on these results we have successfully used a slightly modified version of the methodology for the upcoming release (v5.0) of the eggNOG database, with 5090 genomes and 351 taxonomic levels. Despite computational demands limiting the exploration of the large parameter space governing the pipeline, the approach offers several points to further improve the performance. The sampling strategy for inconsistencies could be improved by take into account genome quality measures, such as BUSCO by Simão et al. [<xref ref-type="bibr" rid="CR37">37</xref>], or known variations in the speed of genome evolution, favoring slow evolving genomes over fast evolving ones. The field of tree reconciliation has seen exciting new theoretical advances which expand the number of modelled evolutionary events, reconciliation for multi-domain families [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>] or new ways to aggregate results from multiple reconciliations [<xref ref-type="bibr" rid="CR36">36</xref>]. These improvements can both strengthen and expand the capabilities of our pipeline, making it also suitable for applications in Bacteria and Archean domain as well.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec22">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_2828_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>Fully expanded OG networks for proteins annotated with InterPro entry IPR013241. Circles represent individual OG, scaled for size (no. of proteins, also shown as label), connected to represent protein overlap to OG at different taxonomic levels (legend). Version 4.0 shows the original OG network with hierarchical inconsistencies while the other methods (RANDOM, v4.5, LS) show the repaired and hierarchically consistent OGs. (PDF 665 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_2828_MOESM2_ESM.pdf">
            <label>Additional file 2</label>
            <caption>
              <p>Domain benchmark results for sub-types of InterPro annotation and overall OG sizes. <bold>(A’-A”)</bold> Cumulative results for separated domain sub-types, InterPro Domain type (n=1977) and InterPro Family type (n=2143). For every OG definition (columns), for each domain, the best matching OG (F1 score) across all tested taxonomic levels is chosen. One-sided paired Wilcoxon signed rank test, alternative hypothesis F1(v4.0) - F1(LS) &lt; 0, p-value &lt; 0.0001; F1(v4.5) - F1(LS) &lt; 0 for InterPro Family type 0.02 (A”) and non-significant for InterPro Domain type (A’). <bold>(B’-B”)</bold> Selective comparison on domains that differ more than 0.1 in F1 score between the compared methods (LS, v4.0, v4.5). Every point in the scatterplot represents the F1 score and size of the best matching OG. Subdivided by InterPro domain type: Domains (n=337) and Family (n=505). <bold>(C)</bold> Overall distribution of OG size (no. of proteins) per version and taxonomic level. (PDF 3865 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2019_2828_MOESM3_ESM.pdf">
            <label>Additional file 3</label>
            <caption>
              <p>Convergence study for sampling parameters. <bold>(A)</bold> Duplication-Speciation ratio (D/S) convergence for selected sample sizes (M = 5,10,25,45,65,85,105) over 200 samplings (N). A’-A”’ show examples of solution convergences with low variation across M; A”” shows an example with large variation. <bold>(B)</bold> Quantification of D/S variation across all tested OGs (n=208) at N=200 for different M combinations. The first including all M values and the other three large values (65,85,105) combined with one smaller value (5,10,25,45). <bold>(C)</bold> Confidence quantification for D/S of M=25 across increasing N values for example A’ using an exact estimation for binomial processes [<xref ref-type="bibr" rid="CR33">33</xref>]. <bold>(D)</bold> Quantification of the 95 percent confidence interval width over all tested OGs (n=208) for M=25 across increasing N values. (PDF 516 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2019_2828_MOESM4_ESM.pdf">
            <label>Additional file 4</label>
            <caption>
              <p>Quest for Orthologs Benchmark. <bold>(A)</bold> Generalized Species Tree Discordance Benchmark (Altenhoff2016), STD-LUCA [last common universal ancestor]/ Euk[Eukaryotes]/ Ver[Vertebrata]/ Fun[Fungi]; <bold>(B)</bold> Species Tree Discordance Benchmark (Altenhoff2009); columns distinguish realm (TT-Euk [Eukaryotes]/Fun[Fungi]); <bold>(C)</bold> Agreement with Reference Gene Phylogenies: SwissTree (Boeckmann 2011); <bold>(D)</bold> Agreement with Reference Gene Phylogenies: TreeFamA (Li 2006); <bold>(E)</bold> boxplot for true positive rate in <bold>(F)</bold>; (F) boxplot for positive predictive value rate in (C); <bold>(G)</bold> Gene Ontology conservation test; <bold>(H)</bold> Enzyme Classification (EC) conservation test. (PDF 726 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2019_2828_MOESM5_ESM.pdf">
            <label>Additional file 5</label>
            <caption>
              <p>Supplementary information for the Quest for Orthologs benchmark reference proteomes mapping process. (PDF 59 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2019_2828_MOESM6_ESM.xlsx">
            <label>Additional file 6</label>
            <caption>
              <p>Supplementary data table for the Quest for Orthologs benchmark containing the underlying data to Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figure S4. (XLSX 18 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors wish to thank Jaime Huerta-Cepas, for helpful discussions and help in using the ete tookit [<xref ref-type="bibr" rid="CR20">20</xref>], and João F.Matias Rodrigues for helpful discussions and technical help in implementing the program’s execution on the computational cluster.</p>
    <sec id="d29e771">
      <title>Funding</title>
      <p>Swiss National Science Foundation (31003A-160095).</p>
    </sec>
    <sec id="d29e776" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p>The datasets analyzed during the current study are available in the respective eggNOG version website, i.e. for the inconsistent version (4.0) at <ext-link ext-link-type="uri" xlink:href="http://eggnog.embl.de/version_4.0.beta/downloads.v4.html">http://eggnog.embl.de/version_4.0.beta/downloads.v4.html</ext-link>and for the ad-hoc consistent version (v4.5) at <ext-link ext-link-type="uri" xlink:href="http://eggnogdb.embl.de/#/app/downloads">http://eggnogdb.embl.de/#/app/downloads</ext-link>. The source code of the methodology is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/meringlab/og_consistency_pipeline">https://github.com/meringlab/og_consistency_pipeline</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>DH, DS and CVM designed the research, analyzed the data, and wrote the article. DH implemented the method. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec>
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec>
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec>
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec>
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fitch</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Distinguishing Homologous from Analogous Proteins</article-title>
        <source>Syst Zool</source>
        <year>1970</year>
        <volume>19</volume>
        <issue>2</issue>
        <fpage>99</fpage>
        <pub-id pub-id-type="doi">10.2307/2412448</pub-id>
        <pub-id pub-id-type="pmid">5449325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tatusov</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>A Genomic Perspective on Protein Families</article-title>
        <source>Science</source>
        <year>1997</year>
        <volume>278</volume>
        <issue>5338</issue>
        <fpage>631</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1126/science.278.5338.631</pub-id>
        <pub-id pub-id-type="pmid">9381173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sonnhammer</surname>
            <given-names>ELL</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>Orthology, paralogy and proposed classification for paralog subtypes</article-title>
        <source>Trends Genet</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>12</issue>
        <fpage>619</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1016/S0168-9525(02)02793-2</pub-id>
        <pub-id pub-id-type="pmid">12446146</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Heijden</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Snel</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>van Noort</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Huynen</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Orthology prediction at scalable resolution by phylogenetic tree analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>83</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-83</pub-id>
        <pub-id pub-id-type="pmid">17346331</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jensen</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Julien</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>von Mering</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Muller</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Doerks</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>eggNOG: automated construction and annotation of orthologous groups of genes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>36</volume>
        <issue>Database</issue>
        <fpage>250</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkm796</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kriventseva</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Rahman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Espinosa</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>OrthoDB: the hierarchical catalog of eukaryotic orthologs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>36</volume>
        <issue>Database</issue>
        <fpage>271</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkm845</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altenhoff</surname>
            <given-names>Adrian M.</given-names>
          </name>
          <name>
            <surname>Gil</surname>
            <given-names>Manuel</given-names>
          </name>
          <name>
            <surname>Gonnet</surname>
            <given-names>Gaston H.</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>Christophe</given-names>
          </name>
        </person-group>
        <article-title>Inferring Hierarchical Orthologous Groups from Orthologous Gene Pairs</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>e53786</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0053786</pub-id>
        <pub-id pub-id-type="pmid">23342000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaduk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Riegler</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lemp</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>ELL</given-names>
          </name>
        </person-group>
        <article-title>HieranoiDB: A database of orthologs inferred by Hieranoid</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>D1</issue>
        <fpage>687</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Szklarczyk</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Forslund</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Heller</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Rattei</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mende</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>von Mering</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>eggNOG 4.5: a hierarchical orthology framework with improved functional annotations for eukaryotic, prokaryotic and viral sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>D1</issue>
        <fpage>286</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Tegenfeldt</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kuznetsov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Waterhouse</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Simao</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Ioannidis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Seppey</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Loetscher</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kriventseva</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>OrthoDB v9.1: Cataloging evolutionary and functional annotations for animal, fungal, plant, archaeal, bacterial and viral orthologs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>D1</issue>
        <fpage>744</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw1119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altenhoff</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Šunca</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Glover</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Train</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Sueki</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Piližota</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gori</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tomiczek</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Redestig</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gonnet</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>The OMA orthology database in 2015: Function predictions, better plant support, synteny view and other improvements</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>D1</issue>
        <fpage>240</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1158</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Altenhoff</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Anisimova</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Inferring Orthology and Paralogy</article-title>
        <source>Evolutionary Genomics: Statistical and Computational Methods. Methods in Molecular Biology, vol. 856</source>
        <year>2012</year>
        <publisher-loc>Totowa</publisher-loc>
        <publisher-name>Humana Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Tekaia</collab>
        </person-group>
        <article-title>Inferring Orthologs: Open Questions and Perspectives</article-title>
        <source>Genomics Insights</source>
        <year>2016</year>
        <volume>9</volume>
        <fpage>17</fpage>
        <pub-id pub-id-type="doi">10.4137/GEI.S37925</pub-id>
        <pub-id pub-id-type="pmid">26966373</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altenhoff</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Boeckmann</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Capella-Gutierrez</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dalquen</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>DeLuca</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Forslund</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Linard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pereira</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pryszcz</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Schreiber</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>da Silva</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Szklarczyk</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Train</surname>
            <given-names>C-M</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lecompte</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>von Mering</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xenarios</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Sjölander</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Muffato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gabaldón</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Standardized benchmarking in the quest for orthologs</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>5</issue>
        <fpage>425</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3830</pub-id>
        <pub-id pub-id-type="pmid">27043882</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finn</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Attwood</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Babbitt</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bridge</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>H-Y</given-names>
          </name>
          <name>
            <surname>Dosztányi</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>El-Gebali</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gough</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Haft</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Holliday</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Marchler-Bauer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mistry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Natale</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Necci</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nuka</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Orengo</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pesseat</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Piovesan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Rawlings</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Redaschi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rivoire</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sangrador-Vegas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sigrist</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sillitoe</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Smithers</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Squizzato</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Thanki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Tosatto</surname>
            <given-names>SCE</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Xenarios</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Yeh</surname>
            <given-names>L-S</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>S-Y</given-names>
          </name>
          <name>
            <surname>Mitchell</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>InterPro in 2017—beyond protein family and domain annotations</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>D1</issue>
        <fpage>190</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw1107</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Snakemake—a scalable bioinformatics workflow engine</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>19</issue>
        <fpage>2520</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id>
        <pub-id pub-id-type="pmid">22908215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>MAFFT Multiple Sequence Alignment Software Version 7: Improvements in Performance and Usability</article-title>
        <source>Mol Biol Evol</source>
        <year>2013</year>
        <volume>30</volume>
        <issue>4</issue>
        <fpage>772</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>
        <pub-id pub-id-type="pmid">23329690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree 2 – Approximately Maximum-Likelihood Trees for Large Alignments</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>9490</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hess</surname>
            <given-names>PN</given-names>
          </name>
          <name>
            <surname>De Moraes Russo</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>An empirical test of the midpoint rooting method</article-title>
        <source>Biol J Linn Soc</source>
        <year>2007</year>
        <volume>92</volume>
        <issue>4</issue>
        <fpage>669</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1095-8312.2007.00864.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Serra</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>ETE 3: Reconstruction, Analysis, and Visualization of Phylogenomic Data</article-title>
        <source>Mol Biol Evol</source>
        <year>2016</year>
        <volume>33</volume>
        <issue>6</issue>
        <fpage>1635</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msw046</pub-id>
        <pub-id pub-id-type="pmid">26921390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stolzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sathaye</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vernot</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Inferring duplications, losses, transfers and incomplete lineage sorting with nonbinary species trees</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>18</issue>
        <fpage>409</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ku</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>WF</given-names>
          </name>
        </person-group>
        <article-title>A natural barrier to lateral gene transfer from prokaryotes to eukaryotes revealed from genomes: the 70 % rule</article-title>
        <source>BMC Biol</source>
        <year>2016</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>89</fpage>
        <pub-id pub-id-type="doi">10.1186/s12915-016-0315-9</pub-id>
        <pub-id pub-id-type="pmid">27751184</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Powell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Forslund</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Szklarczyk</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Trachana</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gabaldón</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rattei</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Creevey</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>von Mering</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>eggNOG v4.0: nested orthology inference across 3686 organisms</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>D1</issue>
        <fpage>231</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1253</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darby</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Stolzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ropp</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Barker</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Xenolog classification</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>33</volume>
        <issue>December 2016</issue>
        <fpage>686</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw686</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>YI</given-names>
          </name>
          <name>
            <surname>Karev</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>The structure of the protein universe and genome evolution</article-title>
        <source>Nature</source>
        <year>2002</year>
        <volume>420</volume>
        <issue>6912</issue>
        <fpage>218</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1038/nature01256</pub-id>
        <pub-id pub-id-type="pmid">12432406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gabaldon</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Functional and evolutionary implications of gene orthology</article-title>
        <source>Nat Rev Genet</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>360</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3456</pub-id>
        <pub-id pub-id-type="pmid">23552219</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shubin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tabin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Deep homology and the origins of evolutionary novelty</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>457</volume>
        <issue>7231</issue>
        <fpage>818</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07891</pub-id>
        <pub-id pub-id-type="pmid">19212399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tordai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nagy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Farkas</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bányai</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Patthy</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Modules, multidomain proteins and organismic complexity</article-title>
        <source>FEBS J</source>
        <year>2005</year>
        <volume>272</volume>
        <issue>19</issue>
        <fpage>5064</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1742-4658.2005.04917.x</pub-id>
        <pub-id pub-id-type="pmid">16176277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Basu</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Poliakov</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rogozin</surname>
            <given-names>IB</given-names>
          </name>
        </person-group>
        <article-title>Domain mobility in proteins: Functional and evolutionary implications</article-title>
        <source>Brief Bioinform</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>205</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbn057</pub-id>
        <pub-id pub-id-type="pmid">19151098</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <mixed-citation publication-type="other">EBIsupport. What are entry types and why are they important? <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/interpro/faqs.html">https://www.ebi.ac.uk/interpro/faqs.html</ext-link>. Accessed 10 Oct 2017.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dlakić</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>3D models of yeast RNase P/MRP proteins Rpp1p and Pop3p</article-title>
        <source>RNA (New York, N.Y.)</source>
        <year>2005</year>
        <volume>11</volume>
        <issue>2</issue>
        <fpage>123</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.7128905</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Libeskind-Hadas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y-C</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Pareto-optimal phylogenetic tree reconciliation</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>12</issue>
        <fpage>87</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu289</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Megill</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Pavicic</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Estimating Bernoulli trial probability from a small sample</article-title>
        <source>arXiv</source>
        <year>2011</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>779</fpage>
        <lpage>804</lpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wasserman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <source>All of Statistics: A Concise Course in Statistical Inference. Springer Texts in Statistics</source>
        <year>2004</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Górecki</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Eulenstein</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Tiuryn</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Unrooted tree reconciliation: A unified approach</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinform</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>2</issue>
        <fpage>522</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2013.22</pub-id>
        <pub-id pub-id-type="pmid">23929875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <mixed-citation publication-type="other">Lafond M, Chauve C, El-Mabrouk N, Ouangraoua A. Gene Tree Construction and Correction using SuperTree and Reconciliation. IEEE/ACM Trans Comput Biol Bioinform. 2017;5963(c).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simão</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Waterhouse</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Ioannidis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kriventseva</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>BUSCO: assessing genome assembly and annotation completeness with single-copy orthologs</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>19</issue>
        <fpage>3210</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv351</pub-id>
        <pub-id pub-id-type="pmid">26059717</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stolzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Siewert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Event inference in multidomain families with phylogenetic reconciliation</article-title>
        <source>BMC Bioinformatics</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>Suppl 14</issue>
        <fpage>8</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-16-S14-S8</pub-id>
        <pub-id pub-id-type="pmid">25592117</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>An Integrated Reconciliation Framework for Domain, Gene, and Species Level Evolution</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinform</source>
        <year>2018</year>
        <volume>ii</volume>
        <fpage>1</fpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterhouse</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Tegenfeldt</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Kriventseva</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>OrthoDB: A hierarchical catalog of animal, fungal and bacterial orthologs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>D1</issue>
        <fpage>358</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1116</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
