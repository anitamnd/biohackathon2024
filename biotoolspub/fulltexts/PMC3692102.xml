<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub May-13-2013?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3692102</article-id>
    <article-id pub-id-type="pmid">23671333</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkt382</article-id>
    <article-id pub-id-type="publisher-id">gkt382</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>IgBLAST: an immunoglobulin variable domain sequence analysis tool</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ye</surname>
          <given-names>Jian</given-names>
        </name>
        <xref ref-type="corresp" rid="gkt382-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Ning</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Madden</surname>
          <given-names>Thomas L.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ostell</surname>
          <given-names>James M.</given-names>
        </name>
      </contrib>
    </contrib-group>
    <aff>National Center for Biotechnology Information, National Library of Medicine, National Institutes of Health, Bethesda, MD 20894, USA</aff>
    <author-notes>
      <corresp id="gkt382-COR1">*To whom correspondence should be addressed. Tel: <phone>+1 301 594 8046</phone>; Fax: <fax>+1 301 594 5166</fax>; Email: <email>jianye@ncbi.nlm.nih.gov</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>5</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>5</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>41</volume>
    <issue>Web Server issue</issue>
    <fpage>W34</fpage>
    <lpage>W40</lpage>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>1</month>
        <year>2013</year>
      </date>
      <date date-type="rev-recd">
        <day>12</day>
        <month>4</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>4</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Published by Oxford University Press 2013. This work is written by US Government employees and is in the public domain in the US.</copyright-statement>
      <copyright-year>2013</copyright-year>
    </permissions>
    <abstract>
      <p>The variable domain of an immunoglobulin (IG) sequence is encoded by multiple genes, including the variable (V) gene, the diversity (D) gene and the joining (J) gene. Analysis of IG sequences typically requires identification of each gene, as well as a comparison of sequence variations in the context of defined regions. General purpose tools, such as the BLAST program, have only limited use for such tasks, as the rearranged nature of an IG sequence and the variable length of each gene requires multiple rounds of BLAST searches for a single IG sequence. Additionally, manual assembly of different genes is difficult and error-prone. To address these issues and to facilitate other common tasks in analysing IG sequences, we have developed the sequence analysis tool IgBLAST (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/igblast/">http://www.ncbi.nlm.nih.gov/igblast/</ext-link>). With this tool, users can view the matches to the germline V, D and J genes, details at rearrangement junctions, the delineation of IG V domain framework regions and complementarity determining regions. IgBLAST has the capability to analyse nucleotide and protein sequences and can process sequences in batches. Furthermore, IgBLAST allows searches against the germline gene databases and other sequence databases simultaneously to minimize the chance of missing possibly the best matching germline V gene.</p>
    </abstract>
    <counts>
      <page-count count="7"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>1 July 2013</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>The immunoglobulins (IG) are a group of antigen-binding proteins produced by the B lymphocytes. They serve as critical defensive components that protect our bodies against invading pathogens. An IG consists of two heavy (H) chains and two light (L) chains. Structurally, each chain can be divided into the variable (V) domain and the constant (C) domain. The V domain is responsible for binding the antigens and can be further divided into the framework regions (FR) and the complementarity determining regions (CDR) (<xref ref-type="bibr" rid="gkt382-B1">1</xref>).</p>
    <p>To counter a vast repertoire of antigens, the immune system has devised multi-layer mechanisms to produce an extraordinarily diverse pool of IG proteins (<xref ref-type="bibr" rid="gkt382-B2">2</xref>). One critical mechanism is that the actual antigen-binding domain (i.e. the V domain) is jointly encoded by multiple genes (the VH domain is encoded by V, D and J genes, whereas the VL domain is encoded by V and J genes). These genes are initially separated in the germline genome but are subsequently joined by a process called the V-(D)-J rearrangement in the precursor B cells. As there are multiple genes for each gene type, and any of these genes can combine into an IG V domain, the resulting repertoire of V domain is very large. Other mechanisms contributing to the V domain diversity include imprecise joining between any of the recombining genes, nucleotide trimming of the V, D and/or J genes, addition of P nucleotides and random addition of nucleotides (N regions) at rearranging junctions, pairing of different H and L chains, as well as somatic mutations that occur in the V domains and are then selected when B lymphocytes encounter antigens. Thus, the total diversity in IG molecules is virtually unlimited.</p>
    <p>Studying IG proteins often requires a detailed analysis of their gene sequences. This includes, but is not limited to, identifying the contributing germline V, D and J genes, analysing the V-(D)-J junction details, finding the boundaries for FR and CDR and comparing with other IG sequences in a database. Although the popular BLAST program (<xref ref-type="bibr" rid="gkt382-B3">3</xref>) can be used to search against various databases of nucleotide and protein sequences at the National Center for Biotechnology Information (NCBI), it has only limited capability for IG sequences. Different IG genes have different characteristic lengths, with the D genes being as short as ∼10 bases and V genes being ∼290 bases long. BLAST needs special parameters to identify short matches, but these parameters are not optimal for longer matches. Therefore, it is necessary to perform multiple searches for a single IG sequence. In addition, manual assembly of different genes together from BLAST results is difficult and error-prone. Finally, because BLAST was developed as a general purpose sequence similarity search program, it does not provide information specific for IG sequences.</p>
    <p>There are several software tools that have been developed for IG sequence analysis. Notably, IMGT®, the international ImMunoGeneTics information system®, offers IMGT/JunctionAnalysis (<xref ref-type="bibr" rid="gkt382-B4">4</xref>), IMGT/V-QUEST (<xref ref-type="bibr" rid="gkt382-B5">5</xref>,<xref ref-type="bibr" rid="gkt382-B6">6</xref>) and its version for next-generation sequencing, IMGT/HighV-QUEST (<xref ref-type="bibr" rid="gkt382-B7">7</xref>). It also maintains many widely used reference germline gene databases. Other tools include VBASE2 (<xref ref-type="bibr" rid="gkt382-B8">8</xref>), iHMMune-align (<xref ref-type="bibr" rid="gkt382-B9">9</xref>) and JoinSolver (<xref ref-type="bibr" rid="gkt382-B10">10</xref>). Although these tools provide valuable analysis capabilities, such as germline gene identification, FR and CDR delineation and mutational analysis, they have various limitations. For example, they all lack the ability to search against more comprehensive databases like the NCBI nr or genomic databases, as well as the ability to search protein sequences. In addition, these tools either are slow to process a large batch of query sequences or lack that ability altogether. Other limitations include the inability to analyse short sequences and no support for FR/CDR delineation in the Kabat (<xref ref-type="bibr" rid="gkt382-B11">11</xref>) system. To address these issues, we have developed a more flexible IG V domain sequence analysis tool named IgBLAST. This tool uses the well-known BLAST algorithm (<xref ref-type="bibr" rid="gkt382-B3">3</xref>) to perform sequence similarity search and provides commonly sought information for IG sequences.</p>
  </sec>
  <sec>
    <title>SEARCH STRATEGY AND IMPLEMENTATION</title>
    <p>IgBLAST consists of several components that are responsible for finding matches to the individual V, D and J genes, finding IG V region annotation information and combining all information to produce the final result. IgBLAST is implemented using the NCBI C++ toolkit. Default BLAST search parameters are used unless indicated otherwise. The implementation details are described below.</p>
    <sec>
      <title>Identifying the FR/CDR boundaries</title>
      <p>A query is searched with BLAST against the IMGT or NCBI germline V gene database (the sequences in such databases have been pre-annotated for the FR/CDR boundaries). The top database sequence hit is used to map the pre-annotated FR/CDR boundary information to the query sequence. The BLAST search parameters are Expect cut-off, 20; word size 9; mismatch penalty, −1; Dust filtering, off.</p>
    </sec>
    <sec>
      <title>Identifying the V, D and J gene hits</title>
      <p>Multiple BLAST searches are performed to identify all genes. To identify the germline V gene hits, a query is searched against a user-selected germline V gene database (search parameters: Expect cut-off, 20; word size 9; mismatch penalty, −1; Dust filtering, off). To avoid irrelevant BLAST hits when searching the D and J gene databases, the query region matching the top germline V gene is masked. A BLAST search is then performed with the masked query against the user-selected J gene database (search parameters: Expect cut-off 1000, word size 7, mismatch penalty, −3; Dust filtering, off) and against the user-selected D gene database if the query is a heavy chain (search parameters: Expect cut-off 100 000; Dust filtering, off). As a D gene is short, its identification is more likely subject to spurious matches that are caused by random nucleotide additions, somatic mutations, as well as other homologous D genes. Therefore, the word size and the mismatch penalty for the D gene search are adjustable by users who have different requirements for the match stringency for D genes. The default word size is 5, which requires a minimum of five consecutive nucleotide matches for a D gene to be found. The default mismatch penalty is conservatively set to a relatively high value (−4) to minimize the chance of spurious matches. However, this setting inevitably favours finding D gene alignments that have few mismatches rather than those that have more mismatches but are longer.</p>
      <p>Some rearrangement constraints are assumed when searching for the V, D and J genes. These assumptions include that a valid D gene must be positioned between the V and J gene, and that only genes from the same locus [i.e. the heavy locus (IGH), the κ locus (IGK) or the λ locus (IGL)] are allowed in a rearrangement.</p>
    </sec>
    <sec>
      <title>Determination of rearrangement frame</title>
      <p>A rearrangement frame (or V-J frame) is tagged in-frame if the last complete coding triplet for the V gene in the query is in-frame with the first complete coding triplet for the J genes. Otherwise it is tagged out-of-frame. A rearrangement is tagged productive only when it is in-frame and contains no stop codon.</p>
    </sec>
  </sec>
  <sec>
    <title>RESULTS AND DISCUSSION</title>
    <sec>
      <title>Program input</title>
      <p>IgBLAST is a robust tool for IG sequence analysis. A query sequence can be a full length or a partial IG V domain sequence and does not need to contain a D or J gene (although a V gene sequence containing at least nine bases of a germline V gene is required). Deletions and insertions in the V, D or J genes of a query sequence are allowed, as the underlying BLAST algorithm has the capability to handle such cases (<xref ref-type="bibr" rid="gkt382-B3">3</xref>). IgBLAST accepts several different query formats, including raw sequences, FASTA sequences, GenBank accessions or GI numbers.</p>
      <p>IgBLAST offers a few options for custom parameter adjustment. These include setting the stringency for D gene detection, choosing the Kabat or IMGT V region delineation system and selecting different views of alignments. IgBLAST has the flexibility to search against germline V, D and J gene databases separately. A few germline gene databases are available from different sources, including the IMGT/V-QUEST reference directory sets (<xref ref-type="bibr" rid="gkt382-B5">5</xref>), UNSWIg human heavy chain repertoire (<xref ref-type="bibr" rid="gkt382-B12">12</xref>) and the NCBI germline gene collections. Currently supported organisms are human, mouse, rat and rabbit. IgBLAST also provides an option to search a custom database, which is useful when a user believes there is discrepancy in the germline gene composition between the study subjects and available databases. For example, one study suggests that some entries in the human germline gene collection may represent errors and should be removed (<xref ref-type="bibr" rid="gkt382-B12">12</xref>). On the other hand, a user may wish to include a germline gene sequence that is not present in available germline gene databases. To make a custom database, a user need only save sequences in FASTA format in a text file.</p>
      <p>IgBLAST offers the unique capability to search sequence databases such as the NCBI nr or genomic database. In particular, the NCBI nr database is a large collection of the annotated nucleotide sequences submitted to GenBank. Its content is updated daily to reflect the latest submissions. Although searching the germline V gene database is fast and is sufficient for many users, it should be pointed out that, as it takes time and efforts to collect germline gene sequences, there might be a delay before a new germline gene is added to a germline gene database. Therefore, users should consider adding additional database, such as the NCBI nr database if it is absolutely essential to include any potential new germline V genes in the search.</p>
      <p>For users who are interested in analysing IG V domain protein sequences (for example, antibody modelling and peptide mapping), IgBLAST can be used to identify the V gene with FR/CDR delineation.</p>
      <p>IgBLAST is capable of processing multiple queries (we recommend not exceeding 1000 sequences per batch). For users desiring maximal flexibility in high-throughput searches, we provide a stand-alone version of IgBLAST (user instruction can be found by following the ‘Stand-alone IgBLAST’ link on the IgBLAST web page).</p>
    </sec>
    <sec>
      <title>Program output</title>
      <p>IgBLAST output presents a clear and informative view of the search result. <xref ref-type="fig" rid="gkt382-F1">Figure 1</xref> shows the result of searching a human IG sequence against the IMGT germline gene databases. In addition to showing the actual detailed alignment between the query and various hits, the report includes a tabulated summary of results based on the alignments between the query and the top matched germline V, D and J gene. The summary information includes the identifiers of the best matched V, D and J gene, the relationship between the coding frames of the V and J genes, the details of the V-(D)-J junctions and the match statistics for various FR/CDR. All fields in the summary table should be self-evident.
<fig id="gkt382-F1" position="float"><label>Figure 1.</label><caption><p>IgBLAST result page. This example used a human IG sequence (GenBank accession AY671579) to search against the default germline gene databases [IMGT human V genes (F + ORF + in-frame P), IMGT human D genes (F + ORF) and IMGT human J genes (F + ORF)]. The search used default values for all parameters. A red box was added to indicate the overlapping nucleotides TAC at the D–J junction. The search was performed on 25 February 2013.</p></caption><graphic xlink:href="gkt382f1p"/></fig></p>
      <p>It is worth noting that the IgBLAST report provides information on overlapping nucleotides at a rearrangement junction that might have been contributed by either of the rearranging genes because of homology-directed recombination events (<xref ref-type="bibr" rid="gkt382-B13">13</xref>). Such nucleotides are listed inside a parenthesis under the relevant junction in the summary table (i.e. the bases TAC under the D–J junction field in <xref ref-type="fig" rid="gkt382-F1">Figure 1</xref>) and are also evident by examining the alignment details (as highlighted by the red box in <xref ref-type="fig" rid="gkt382-F1">Figure 1</xref>).</p>
      <p>The alignment section uses a familiar multiple alignment view with the hits aligned to the query (shown in the first row). The alignments show the three top hits from the V, D and J gene matches by default, but this is user adjustable. The far left column indicates the gene category (i.e. V, D or J) for the germline gene hits. The second column shows the percent identity between the query and each hit (the number of matches and the alignment length are indicated in parenthesis in the third column). Each line is preceded by a number indicating the starting nucleotide position for the line and ends with a number indicating the ending nucleotide position. Users can choose the format with a dot, indicating that the hit is identical to the query (<xref ref-type="fig" rid="gkt382-F1">Figure 1</xref>) or the format showing the original letters for the hit. A dash in the alignment indicates a gap in the relevant sequence. FR/CDR boundaries are directly annotated on top of the query sequence.</p>
      <p>To make it easier to view the effect of a nucleotide substitution on a protein sequence, IgBLAST offers the option to show translations for a nucleotide query. If there is a difference in the amino acid between the query and the germline V gene, the corresponding amino acid in the germline V gene is coloured purple (<xref ref-type="fig" rid="gkt382-F1">Figure 1</xref>).</p>
      <p>As indicated previously, IgBLAST has the capability to search against the germline gene databases, as well as other sequence databases at the same time. <xref ref-type="fig" rid="gkt382-F2">Figure 2</xref> shows one such example. Similar to the result of searching against the germline gene databases only, the alignment section first lists the hits from germline gene databases where one can see the top matched germline V gene hit is IGHV1-9*01 (97.9% similarity to the query over 290 bases). Below the germline gene database hits, the result page lists hits from the NCBI nr database, including the 16 hits (excluding the self-hit AF104468) that show a 100% match to the query over 290 bases. IgBLAST offers a convenient feature that displays the sequence titles when a user mouses over the sequence identifiers (for example, the accession AF021857). A quick examination of sequence titles suggests that many of these 16 hits come from different sources [for example, M17723 is from an anti-dextran hybridoma, whereas BC018315 is a cDNA clone from the Mammalian Gene Collection project (<ext-link ext-link-type="uri" xlink:href="http://mgc.nci.nih.gov/">http://mgc.nci.nih.gov/</ext-link>)]. As independent isolation of identical IG V gene sequences is often used as an indication of a germline sequence (<xref ref-type="bibr" rid="gkt382-B14">14</xref>), these 16 hits may represent a possible new germline V gene. In fact, sequence titles from three of these 16 sequences (AF021857, AF021859 and AF021861) indicate that these are un-mutated (i.e. germline) sequences. Obviously, whether these hits definitively represent a germline V gene remains to be investigated and is out of scope for this article. Thus, the IgBLAST results from searching against the germline gene databases and the NCBI nr database together alert a user about a possible germline V gene that is a better match than the one from the germline V gene database.
<fig id="gkt382-F2" position="float"><label>Figure 2.</label><caption><p>Example IgBLAST result of searching against the germline gene databases and the NCBI nr database simultaneously. A mouse IG sequence (GenBank accession AF104468) was searched against the default mouse germline gene databases [IMGT mouse V genes (F + ORF + in-frame P), IMGT mouse D genes (F + ORF + in-frame P) and IMGT mouse J genes (F + ORF + in-frame P)]. The ‘organism’ field was set to mouse, and the nr database was selected for the ‘additional database’ field. Default values are used for all other parameters, except the ‘number of alignments for additional database’ was 25. The light blue pop-up message box is a feature that displays the sequence title when the mouse pointer is moved over the sequence identifier (i.e. the accession AF021857 in the example). Only part of the result page is shown because of space limitation. A red box was added to indicate the hits from the nr databases that have 100% matches to the query over the 290 bases. The search was performed on 25 February 2013.</p></caption><graphic xlink:href="gkt382f2p"/></fig></p>
    </sec>
    <sec>
      <title>Performance</title>
      <p>Searching a single IG sequence against a germline gene database typically generates the result page instantly. For batch submission, a test search of 1000 human IG heavy chain sequences (between 300 and 600 bases) takes ∼44 s to return the results.</p>
    </sec>
    <sec>
      <title>Program evaluation</title>
      <p>Identifying original germline genes from a rearranged sequence with certainty (particularly for short D genes) is a difficult task, as there are multiple germline genes that share high similarity. This task is further complicated by the random nucleotide additions at rearrangement junctions, as well as somatic mutations. As a result, a rearranged sequence is often similar to multiple germline gene sequences. The quality of IG sequence analysis is typically judged by expert visual examination of the assigned V, D and J genes, but this can be subjective. Hence, Gaeta <italic>et al.</italic> (<xref ref-type="bibr" rid="gkt382-B9">9</xref>) propose some tests using objective criteria, and the results from that study suggest that iHMMune-align performs best for germline gene identification among several IG sequence analysis tools. Although IgBLAST results have been subject to numerous visual examinations during development, it is also important to test IgBLAST objectively. Thus, we use the same strategy as Gaeta <italic>et al.</italic> and compare the results with iHMMune-align.</p>
      <p>The first test data set includes 100 randomly chosen IG heavy chain sequences without V gene mutations. Gaeta <italic>et al.</italic> (<xref ref-type="bibr" rid="gkt382-B9">9</xref>) argue that the D and J elements in these sequences should contain few or no mutations, as mutation rates drops rapidly from 5′ side of the V gene. The test results are summarized in <xref ref-type="table" rid="gkt382-T1">Table 1</xref>. IgBLAST reports that the average length of assigned D and J genes are 16 and 44 bases, respectively, with 0.04 and 0.08 nucleotide mismatches (per sequence) on average to germline D and J genes, respectively. Thus, IgBLAST indeed reports very low mutations in D and J genes for sequences that have no mutations in V genes. The test with iHMMune-align shows similar results.
<table-wrap id="gkt382-T1" position="float"><label>Table 1.</label><caption><p>Characteristics of the D and J genes identified in 100 random IG heavy chain sequences<xref ref-type="table-fn" rid="gkt382-TF1"><sup>a</sup></xref></p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">IgBLAST</th><th rowspan="1" colspan="1">iHMMune-align</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Average D gene mutations per sequence (average D gene length)</td><td rowspan="1" colspan="1">0.04 (16.29)</td><td rowspan="1" colspan="1">0.056 (17.43)</td></tr><tr><td rowspan="1" colspan="1">Average J gene mutations per sequence (average J gene length)</td><td rowspan="1" colspan="1">0.08 (44.29)</td><td rowspan="1" colspan="1">0.23 (44.52)</td></tr></tbody></table><table-wrap-foot><fn id="gkt382-TF1"><p><sup>a</sup>One hundred IG heavy chain sequences are randomly selected from NCBI nr database (available in <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/lookup/suppl/doi:10.1093/nar/gkt382/-/DC1">Supplementary File S1</ext-link>). The selection is based on 100% identity match to any heavy chain germline gene from IMGT database as determined by BLAST program with default parameters; therefore, there is no previous knowledge about their D and J gene compositions. Tests were performed using web IgBLAST and stand-alone iHMMune-align (version iHMMune-align_26-11-2007.zip) with default search parameters. iHMMune-align did not return a D gene match for 11 sequences that were excluded from D gene analysis.</p></fn></table-wrap-foot></table-wrap></p>
      <p>We next use clonally related sequences to test IgBLAST. The rational for this test (<xref ref-type="bibr" rid="gkt382-B9">9</xref>) is that these sequences originate from the same rearrangement but are then divergent because of somatic mutations (most sequences carry 20+ mutations in these data sets); therefore, a good sequence analysis tool should report the same V, D and J genes for most or all sequences. Data set 1 contains 57 sequences with the IGHV4-34*01-IGHD7-27*01-IGHJ3*02 rearrangement identified as the dominant alignment by iHMMune-align (<xref ref-type="bibr" rid="gkt382-B9">9</xref>). <xref ref-type="table" rid="gkt382-T2">Table 2</xref> presents results for this test. IgBLAST reports that 52 sequences have IGHV4-34*01 and IGHJ3*02 as the closest-matched germline V and J genes, respectively, and 54 sequences have IGHD7-27*01 as the closest-matched germline D gene. The iHMMune-align results are similar. IgBLAST and iHMMune-align both find the dominant IGHV4-34*01-IGHD7-27*01-IGHJ3*02 rearrangement in 47 sequences.
<table-wrap id="gkt382-T2" position="float"><label>Table 2.</label><caption><p>Number of sequences with correctly identified V, D and J genes or rearrangements in clonally related sequence data sets<xref ref-type="table-fn" rid="gkt382-TF2"><sup>a</sup></xref></p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">IgBLAST</th><th rowspan="1" colspan="1">iHMMune-align</th></tr></thead><tbody align="left"><tr><td colspan="3" rowspan="1">Data set 1 (57 sequences)</td></tr><tr><td rowspan="1" colspan="1">    IGHV4-34*01</td><td rowspan="1" colspan="1">52</td><td rowspan="1" colspan="1">51</td></tr><tr><td rowspan="1" colspan="1">    IGHD7-27*01</td><td rowspan="1" colspan="1">54</td><td rowspan="1" colspan="1">55</td></tr><tr><td rowspan="1" colspan="1">    IGHJ3*02</td><td rowspan="1" colspan="1">52</td><td rowspan="1" colspan="1">52</td></tr><tr><td rowspan="1" colspan="1">    IGHV4-34*01-IGHD7-27*01- IGHJ3*02 rearrangement</td><td rowspan="1" colspan="1">47</td><td rowspan="1" colspan="1">47</td></tr><tr><td colspan="3" rowspan="1">Data set 2 (101 sequences)</td></tr><tr><td rowspan="1" colspan="1">    IGHV4-34*01</td><td rowspan="1" colspan="1">96 (96)<xref ref-type="table-fn" rid="gkt382-TF3"><sup>b</sup></xref></td><td rowspan="1" colspan="1">95</td></tr><tr><td rowspan="1" colspan="1">    IGHD6-6*01</td><td rowspan="1" colspan="1">87 (48)<xref ref-type="table-fn" rid="gkt382-TF3"><sup>b</sup></xref></td><td rowspan="1" colspan="1">86</td></tr><tr><td rowspan="1" colspan="1">    IGHJ6*02</td><td rowspan="1" colspan="1">101 (101)<xref ref-type="table-fn" rid="gkt382-TF3"><sup>b</sup></xref></td><td rowspan="1" colspan="1">97</td></tr><tr><td rowspan="1" colspan="1">    IGHV4-34*01- IGHD6-6*01- IGHJ6*02 rearrangement</td><td rowspan="1" colspan="1">82</td><td rowspan="1" colspan="1">80</td></tr></tbody></table><table-wrap-foot><fn id="gkt382-TF2"><p><sup>a</sup>The clonally related sequences were obtained from Wilson and co-workers (<xref ref-type="bibr" rid="gkt382-B15">15</xref>). Tests were performed using web IgBLAST and stand-alone iHMMune-align (version iHMMune-align_26-11-2007.zip) with default search parameters, except that the mismatch penalty for D gene is set to −1 (instead of default −4) for IgBLAST test with data set 2. The identified germline genes are the top hits (or one of the top equivalent hits that have identical match scores, as well as identical per cent identity) from IgBLAST or iHMMune-align searches. iHMMune-align did not return a D gene match for 1 and 6 sequences for data set 1 and data set 2, respectively. IHMMune-align also did not return any germline gene matches for one sequence in both data sets because of presence of deletions in V gene.</p></fn><fn id="gkt382-TF3"><p><sup>b</sup>Results from IgBLAST using default mismatch penalty for D genes.</p></fn></table-wrap-foot></table-wrap></p>
      <p>A second set of clonally related sequences (data set 2) with more mutations in the V-(D)-J junction regions are also analysed. The dominant rearrangement was previously identified as IGHV4-34*01 IGHD6-6*01- IGHJ6*02 by iHMMune-align (<xref ref-type="bibr" rid="gkt382-B9">9</xref>). As shown in <xref ref-type="table" rid="gkt382-T2">Table 2</xref>, IgBLAST reports 96 sequences use IGHV4-34*01 and all use IGHJ6*02, whereas iHMMune-align finds similar number for IGHV4-34*01 (95) but slightly lower number for IGHJ6*02 (97). For D genes, although iHMMune-align finds 86 sequences that use IGHD6-6*01, IgBLAST only finds 48 sequences with this D gene. As discussed in the ‘Search Strategy and Implementation’ section, IgBLAST uses a high mismatch penalty (−4) for D genes by default that is not optimal for identifying D genes with more mismatches (as is the case for data set 2). Therefore, we reduced the D gene mismatch penalty to −1 for this test. Indeed, reducing the D gene mismatch penalty results in identification of IGHD6-6*01 in 87 sequences (which is similar to iHMMune-align result) while not affecting the V and J gene findings. IgBLAST also finds the previously identified dominant IGHV4-34*01 IGHD6-6*01- IGHJ6*02 rearrangement in 82 sequences, whereas iHMMune-align finds such rearrangement in 80 sequences.</p>
      <p>Overall, IgBLAST produces expected results for all three test data sets involving IG heavy chain sequences with and without mutations. iHMMune-align generates similar results, although it has an advantage that no search parameter adjustment is needed, at least for our test cases.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>CONCLUSIONS</title>
    <p>IgBLAST is a web tool that we have developed for analysis of IG V domain sequences. It is robustly implemented to handle a variety of query sequences in different formats and addresses common analysis tasks, such as identifying the V, D and J genes, viewing rearrangement junction details and delineation of FR/CDR for the V gene. IgBLAST also offers the unique capability to search against germline gene databases, as well as other sequence databases (such as the NCBI nr database) simultaneously to minimize the chance of missing possibly the best matching germline V gene. IgBLAST is a free public tool with no login requirement.</p>
  </sec>
  <sec>
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/lookup/suppl/doi:10.1093/nar/gkt382/-/DC1">Supplementary Data</ext-link> are available at NAR Online: Supplementary File 1.</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p>Intramural Research Program of the <funding-source>National Institutes of Health (NIH)</funding-source>, <funding-source>National Library of Medicine</funding-source>. Funding for open access charge: <funding-source>NIH</funding-source>.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors would like to acknowledge members of the BLAST group, the user help group and the C++ toolkit group at the NCBI for their work that has made this tool possible.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="gkt382-B1">
      <label>1</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lefranc</surname>
            <given-names>M-P</given-names>
          </name>
          <name>
            <surname>Lefranc</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>The Immunoglobulin Factsbook</source>
        <year>2001</year>
        <publisher-loc>San Diego</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="gkt382-B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schatz</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Oettinger</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Schlissel</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>V(D)J recombination: molecular biology and regulation</article-title>
        <source>Annu. Rev. Immunol.</source>
        <year>1992</year>
        <volume>10</volume>
        <fpage>359</fpage>
        <lpage>383</lpage>
        <pub-id pub-id-type="pmid">1590991</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt382-B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Schaffer</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1997</year>
        <volume>25</volume>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt382-B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yousfi Monod</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Giudicelli</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Chaume</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lefranc</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>IMGT/JunctionAnalysis: the first tool for the analysis of the immunoglobulin and T cell receptor complex V-J and V-D-J JUNCTIONs</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>Suppl. 1</issue>
        <fpage>i379</fpage>
        <lpage>i385</lpage>
        <pub-id pub-id-type="pmid">15262823</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt382-B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brochet</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lefranc</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Giudicelli</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>IMGT/V-QUEST: the highly customized and integrated system for Ig and TR standardized V-J and V-D-J sequence analysis</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>W503</fpage>
        <lpage>W508</lpage>
        <pub-id pub-id-type="pmid">18503082</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt382-B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giudicelli</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Brochet</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lefranc</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>IMGT/V-QUEST: IMGT standardized analysis of the immunoglobulin (Ig) and T cell receptor (TR) nucleotide sequences</article-title>
        <source>Cold Spring Harb. Protoc.</source>
        <year>2011</year>
        <volume>2011</volume>
        <fpage>695</fpage>
        <lpage>715</lpage>
        <pub-id pub-id-type="pmid">21632778</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt382-B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alamyar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Giudicelli</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Duroux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lefranc</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>IMGT/HighV-QUEST: the IMGT(R) web portal for immunoglobulin (Ig) or antibody and T cell receptor (TR) analysis from NGS high throughput and deep sequencing</article-title>
        <source>Immunome Res.</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>26</fpage>
        <pub-id pub-id-type="pmid">22647994</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt382-B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Retter</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Althaus</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Munch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Muller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>VBASE2, an integrative V gene database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>D671</fpage>
        <lpage>D674</lpage>
        <pub-id pub-id-type="pmid">15608286</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt382-B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaeta</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Malming</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Bain</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>iHMMune-align: hidden Markov model-based alignment and identification of germline genes in rearranged immunoglobulin gene sequences</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>1580</fpage>
        <lpage>1587</lpage>
        <pub-id pub-id-type="pmid">17463026</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt382-B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Souto-Carneiro</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Longo</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Russ</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Lipsky</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>Characterization of the human Ig heavy chain antigen binding complementarity determining region 3 using a newly developed software algorithm, JOINSOLVER</article-title>
        <source>J. Immunol.</source>
        <year>2004</year>
        <volume>172</volume>
        <fpage>6790</fpage>
        <lpage>6802</lpage>
        <pub-id pub-id-type="pmid">15153497</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt382-B11">
      <label>11</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kabat</surname>
            <given-names>EA</given-names>
          </name>
        </person-group>
        <source>Sequences of Proteins of Immunological Interest, National Institutes of Health Publication</source>
        <year>1991</year>
        <edition>5th edn</edition>
        <publisher-loc>Bethesda</publisher-loc>
        <publisher-name>United States Department of Health and Human Services</publisher-name>
      </element-citation>
    </ref>
    <ref id="gkt382-B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Sewell</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Many human immunoglobulin heavy-chain IGHV gene polymorphisms have been reported in error</article-title>
        <source>Immunol. Cell. Biol.</source>
        <year>2008</year>
        <volume>86</volume>
        <fpage>111</fpage>
        <lpage>115</lpage>
        <pub-id pub-id-type="pmid">18040280</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt382-B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Forster</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Rajewsky</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Sequence homologies, N sequence insertion and JH gene utilization in VHDJH joining: implications for the joining mechanism and the ontogenetic timing of Ly1 B cell and B-CLL progenitor generation</article-title>
        <source>EMBO J.</source>
        <year>1990</year>
        <volume>9</volume>
        <fpage>2133</fpage>
        <lpage>2140</lpage>
        <pub-id pub-id-type="pmid">2113468</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt382-B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tarlinton</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Muller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Rajewsky</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Forster</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Most peripheral B cells in mice are ligand selected</article-title>
        <source>J. Exp. Med.</source>
        <year>1991</year>
        <volume>173</volume>
        <fpage>1357</fpage>
        <lpage>1371</lpage>
        <pub-id pub-id-type="pmid">1903427</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt382-B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>NY</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Boston</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kolar</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Pascual</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Capra</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Human immunoglobulin selection associated with class switch and possible tolerogenic origins for C delta class-switched B cells</article-title>
        <source>J. Clin. Invest.</source>
        <year>2004</year>
        <volume>113</volume>
        <fpage>1188</fpage>
        <lpage>1201</lpage>
        <pub-id pub-id-type="pmid">15085198</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
