<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9502236</article-id>
    <article-id pub-id-type="pmid">34021745</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab401</article-id>
    <article-id pub-id-type="publisher-id">btab401</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Jutils: a visualization toolkit for differential alternative splicing events</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Guangyu</given-names>
        </name>
        <aff><institution>Department of Computer Science, Johns Hopkins University</institution>, Baltimore, MD 21205, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cope</surname>
          <given-names>Leslie</given-names>
        </name>
        <aff><institution>Department of Oncology, Johns Hopkins School of Medicine</institution>, Baltimore, MD 21205, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>He</surname>
          <given-names>Zitong</given-names>
        </name>
        <aff><institution>Department of Computer Science, Johns Hopkins University</institution>, Baltimore, MD 21205, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8124-2324</contrib-id>
        <name>
          <surname>Florea</surname>
          <given-names>Liliana</given-names>
        </name>
        <xref rid="btab401-cor1" ref-type="corresp"/>
        <aff><institution>Department of Computer Science, Johns Hopkins University</institution>, Baltimore, MD 21205, <country country="US">USA</country></aff>
        <aff><institution>Department of Genetic Medicine, Johns Hopkins School of Medicine</institution>, Baltimore, MD 21205, <country country="US">USA</country></aff>
        <!--florea@jhu.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab401-cor1">To whom correspondence should be addressed. <email>florea@jhu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-05-22">
      <day>22</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>22</issue>
    <fpage>4272</fpage>
    <lpage>4274</lpage>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>20</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>6</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab401.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Gene alternative splicing plays an important role in development, tissue specialization and disease and differences in splicing patterns can reveal important factors for phenotypic differentiation. While multiple computational methods exist to determine splicing differences, there is a need for user-friendly visualizations that present an intuitive view of the data and work across methods.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed a toolkit, Jutils, for visualizing differential splicing events at the intron (splice junction) level. Jutils is method-agnostic, converting individual tools’ output into a unified representation and using it to create visualizations. Jutils creates three types of visualizations, namely heatmaps of absolute and Z-score normalized splice ratios, sashimi plots and Venn diagrams of results from multiple comparisons. Jutils is lightweight, relying solely on the unified data file for visualizations.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Jutils is implemented in Python and is available from <ext-link xlink:href="https://github.com/Splicebox/Jutils" ext-link-type="uri">https://github.com/Splicebox/Jutils</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM129085</award-id>
        <award-id>R01GM124531</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Alternative splicing is a fundamental gene regulatory mechanism in plants and animals. On the evolutionary scale, alternative splicing has contributed to species diversification, and within organisms it has been broadly implicated in physiology and disease. Alternative splicing has high prevalence in eukaryotic species, with more than 95% of human genes having multiple splice isoforms (<xref rid="btab401-B4" ref-type="bibr">Pan <italic toggle="yes">et al.</italic>, 2008</xref>) and high levels reported in other species. Characterizing splicing variation between cellular conditions is therefore important to identify molecular markers of phenotypic differentiation.</p>
    <p>While multiple methods have been developed to determine differential splicing patterns from RNA-seq data (LeafCutter, MAJIQ, rMATS, MntJULiP; <xref rid="btab401-B3" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab401-B5" ref-type="bibr">Shen <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab401-B6" ref-type="bibr">Vaquero-Garcia <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab401-B7" ref-type="bibr">Yang <italic toggle="yes">et al.</italic>, 2020</xref>), there is a scarcity of tools to present the results to the user in a way that is intuitive and easy to explore. Moreover, most visualization tools are designed for a particular differential splicing method, such as rmats2sashimiplot (<ext-link xlink:href="https://github.com/Xinglab/rmats2sashimiplot" ext-link-type="uri">https://github.com/Xinglab/rmats2sashimiplot</ext-link>) and LeafViz (<ext-link xlink:href="https://leafcutter.shinyapps.io/leafviz/" ext-link-type="uri">https://leafcutter.shinyapps.io/leafviz/</ext-link>), and are not adapted for general use. To fill this gap, we developed Jutils, a toolkit for visualizing alternative splicing differences that can be used across methods.</p>
  </sec>
  <sec>
    <title>2 System design</title>
    <p>Jutils works with the output of a differential splicing tool, converting it into a unified data file that contains the information necessary for the visualizations. (Additional information, such as the BAM files, can be optionally provided.) Metadata about experiment design, such as the condition associated with each sample, can be provided in a specification file. Jutils then extracts events to include in the visualizations based on user specified criteria. Lastly, it generates one of three types of visualizations: heatmap, sashimi plot and Venn diagram. Details of each component are provided below.</p>
    <sec>
      <title>2.1 The unified file format</title>
      <p>Jutils uses an intermediate Tab Separated Values (TSV) file format to collect event information generated by a differential splicing program, which it then uses to create visualizations. Jutils has built-in output conversion modules for several analysis programs, including LeafCutter, MAJIQ, MntJULiP and rMATS, and users can develop their own conversion scripts for other programs of interest.</p>
      <p>The TSV file has 14 columns containing, in order: gene name, group id, feature id, feature type (e.g. intron, exon skipping), feature label (derived from the chromosomal location), strand, <italic toggle="yes">p</italic>-value, <italic toggle="yes">q</italic>-value, dPSI (difference in Percent Splice In values), read count 1, read count 2 and PSI values, per sample and averaged by condition. The default feature for Jutils is introns, but the program can represent more complex events such as those reported by rMATS, for instance exon inclusion and exon exclusion constituted as a single exon skipping event. Programs may further aggregate features into groups, for instance LeafCutter and MntJULiP group introns that share a splice junction. Jutils supports identifiers and operations on individual features as well as groups. Read count 1 and read count 2 represent vectors of per sample values and correspond to the paired splice forms in a complex feature (e.g. exon skipping), whereas for simple features (e.g. introns) read count 2 is marked with ‘.’.</p>
    </sec>
    <sec>
      <title>2.2 Heatmaps</title>
      <p>Jutils generates heatmaps of differential splicing events represented in the TSV file. A metadata file contains the classification of each sample. Jutils generates heatmaps of PSI values, either <italic toggle="yes">Z</italic>-score normalized or absolute values (<xref rid="btab401-F1" ref-type="fig">Fig. 1A</xref>). The software allows clustering by rows (events) and columns (samples), using different distance metrics and clustering methods. By default, the ‘cityblock’ (Manhattan distance) metric with the ‘weighted’ (weighted pair group with arithmetic mean) method is used. Events can be filtered at run time based on quality and confidence measures such as <italic toggle="yes">p</italic>-value, <italic toggle="yes">q</italic>-value and dPSI and the user may choose to visualize all relevant features or select a representative feature per group or per gene. Lastly, while Jutils is intended to work primarily with the output of differential splicing tools, it can also be used to display the features with the highest variance (option ‘-unsupervised’).</p>
      <fig position="float" id="btab401-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Jutils visualization of differential splicing events from the comparison of hippocampus samples of 12 healthy and 10 epileptic mice (GenBank ProjectID: <ext-link xlink:href="PRJEB18790" ext-link-type="DDBJ/EMBL/GenBank">PRJEB18790</ext-link>). (<bold>A</bold>) Heatmaps of absolute (top) and <italic toggle="yes">Z</italic>-score normalized (bottom) PSI values generated with MntJULiP shown, respectively, at the intron and group level. Top: darker red indicates PSI values closer to 1; bottom: blue colors mark values lower than the row average, and red ones values higher than the row average. (<bold>B</bold>) Sashimi plot of events at the <italic toggle="yes">Dync1i2</italic> gene, predicted by LeafCutter. (<bold>C</bold>) Venn diagram of gene predictions from four analysis methods</p>
        </caption>
        <graphic xlink:href="btab401f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.3 Sashimi plots</title>
      <p>Sashimi plots have been previously introduced to visually represent differences in splicing. A traditional sashimi plot shows raw RNA-seq densities along with exons and junctions for multiple samples. The Jutils sashimi visualization utilizes a modified version of the ggsashimi package (<xref rid="btab401-B2" ref-type="bibr">Garrido-Martin <italic toggle="yes">et al.</italic>, 2018</xref>) to display graphical representations of intron read counts within a specified genomic region, intron or intron group (<xref rid="btab401-F1" ref-type="fig">Fig. 1B</xref>). By default, Jutils provides a lightweight representation based solely on the intron read counts provided in the TSV file, without the flanking exon read depth information. When alignment files are also provided, Jutils extracts alignments from the BAM files and provides full sashimi representations reflecting the accurate exonic coverage.</p>
    </sec>
    <sec>
      <title>2.4 Venn diagrams</title>
      <p>Methods for differential splicing detection employ a variety of models for features and objective functions. Therefore, it becomes desirable to compare the outputs of different programs, and for different parameter settings, to obtain a complete view of the predicted differential splicing and to gauge support from multiple methods. Jutils provides a Venn diagram visualization of the predicted gene sets (<xref rid="btab401-F1" ref-type="fig">Fig. 1C</xref>), along with a text file containing the list of genes in each category.</p>
      <p>In summary, we developed a lightweight toolkit, Jutils, for visualizing differential alternative splicing between cellular conditions. Jutils can be used automatically with the popular differential splicing analysis tools LeafCutter, MAJIQ, MntJULiP and rMATS, and can be easily adapted to any other program, and thus represents a useful and practical tool to explore the landscape of alternative splicing.</p>
    </sec>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported in part by grants [R01GM129085, R01GM124531] from the National Institutes of Health.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab401-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Garrido-Martin</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Ggsashimi: sashimi plot revised for browser and annotation-independent splicing visualization</article-title>. <source>PLoS Comput. Biol</source>., <volume>14</volume>, <fpage>e1006360</fpage>.<pub-id pub-id-type="pmid">30118475</pub-id></mixed-citation>
    </ref>
    <ref id="btab401-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Y.I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Annotation-free quantification of RNA splicing using LeafCutter</article-title>. <source>Nat. Genet</source>., <volume>50</volume>, <fpage>151</fpage>–<lpage>158</lpage>.<pub-id pub-id-type="pmid">29229983</pub-id></mixed-citation>
    </ref>
    <ref id="btab401-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pan</surname><given-names>Q.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Deep surveying of alternative splicing complexity in the human transcriptome by high-throughput sequencing</article-title>. <source>Nat. Genet</source>., <volume>40</volume>, <fpage>1413</fpage>–<lpage>1415</lpage>.<pub-id pub-id-type="pmid">18978789</pub-id></mixed-citation>
    </ref>
    <ref id="btab401-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shen</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>rMATS: robust and flexible detection of differential alternative splicing from replicate RNA-seq data</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>111</volume>, <fpage>E5593</fpage>–<lpage>E5601</lpage>.<pub-id pub-id-type="pmid">25480548</pub-id></mixed-citation>
    </ref>
    <ref id="btab401-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vaquero-Garcia</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>A new view of transcriptome complexity and regulation through the lens of local splicing variations</article-title>. <source>Elife</source>, <volume>5</volume>, <fpage>e11752</fpage>.<pub-id pub-id-type="pmid">26829591</pub-id></mixed-citation>
    </ref>
    <ref id="btab401-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) Comprehensive and scalable quantification of splicing differences with MntJULiP. bioRxiv, 2020.10.26.355941.</mixed-citation>
    </ref>
  </ref-list>
</back>
