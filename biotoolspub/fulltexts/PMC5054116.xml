<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.4.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art540.dtd?>
<?SourceDTD.Version 5.4.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<?origin publisher?>
<?FILEmeta_GPB60008 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genomics Proteomics Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genomics Proteomics Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Genomics, Proteomics &amp; Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1672-0229</issn>
    <issn pub-type="epub">2210-3244</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5054116</article-id>
    <article-id pub-id-type="publisher-id">S1672-0229(10)60008-3</article-id>
    <article-id pub-id-type="doi">10.1016/S1672-0229(10)60008-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>KaKs_Calculator 2.0: A Toolkit Incorporating Gamma-Series Methods and Sliding Window Strategies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Dapeng</given-names>
        </name>
        <xref rid="aff0005" ref-type="aff">1</xref>
        <xref rid="aff0015" ref-type="aff">3</xref>
        <xref rid="fn1" ref-type="fn">#</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Yubin</given-names>
        </name>
        <xref rid="aff0005" ref-type="aff">1</xref>
        <xref rid="aff0010" ref-type="aff">2</xref>
        <xref rid="aff0015" ref-type="aff">3</xref>
        <xref rid="fn1" ref-type="fn">#</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Zhang</given-names>
        </name>
        <xref rid="aff0020" ref-type="aff">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Jiang</given-names>
        </name>
        <xref rid="aff0005" ref-type="aff">1</xref>
        <xref rid="aff0015" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Jun</given-names>
        </name>
        <email>junyu@big.ac.cn</email>
        <xref rid="aff0005" ref-type="aff">1</xref>
        <xref rid="aff0010" ref-type="aff">2</xref>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff0005"><label>1</label>CAS Key Laboratory of Genome Sciences and Information, Beijing Institute of Genomics, Chinese Academy of Sciences, Beijing 100029, China</aff>
    <aff id="aff0010"><label>2</label>Institute of Computing Technology, Chinese Academy of Sciences, Beijing 100190, China</aff>
    <aff id="aff0015"><label>3</label>Graduate University of Chinese Academy of Sciences, Beijing 100049, China</aff>
    <aff id="aff0020"><label>4</label>Plant Stress Genomics Research Center, Division of Chemical and Life Sciences &amp; Engineering, King Abdullah University of Science and Technology, Thuwal 23955-6900, Saudi Arabia</aff>
    <author-notes>
      <corresp id="cor1"><label>*</label>Corresponding author. <email>junyu@big.ac.cn</email></corresp>
      <fn id="fn1">
        <label>#</label>
        <p id="ntp0005">Equal contribution.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>5</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="ppub">
      <month>3</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>05</day>
      <month>5</month>
      <year>2010</year>
    </pub-date>
    <volume>8</volume>
    <issue>1</issue>
    <fpage>77</fpage>
    <lpage>80</lpage>
    <permissions>
      <copyright-statement>© 2010 Beijing Institute of Genomics</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="CC BY-NC-SA" xlink:href="http://creativecommons.org/licenses/by-nc-sa/3.0/">
        <license-p>This is an open access article under the CC BY-NC-SA license (http://creativecommons.org/licenses/by-nc-sa/3.0/).</license-p>
      </license>
    </permissions>
    <abstract id="ab0005">
      <p>We present an integrated stand-alone software package named KaKs_Calculator 2.0 as an updated version. It incorporates 17 methods for the calculation of nonsynonymous and synonymous substitution rates; among them, we added our modified versions of several widely used methods as the gamma series including <italic>γ</italic>-NG, <italic>γ</italic>-LWL, <italic>γ</italic>-MLWL, <italic>γ</italic>-LPB, <italic>γ</italic>-MLPB, <italic>γ</italic>-YN and <italic>γ</italic>-MYN, which have been demonstrated to perform better under certain conditions than their original forms and are not implemented in the previous version. The package is readily used for the identification of positively selected sites based on a sliding window across the sequences of interests in 5’ to 3’ direction of protein-coding sequences, and have improved the overall performance on sequence analysis for evolution studies. A toolbox, including C++ and Java source code and executable files on both Windows and Linux platforms together with a user instruction, is downloadable from the website for academic purpose at <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/kakscalculator2/" id="ir5555">https://sourceforge.net/projects/kakscalculator2/</ext-link>.</p>
    </abstract>
    <kwd-group id="keys0005">
      <title>Key words</title>
      <kwd>Ka/Ks</kwd>
      <kwd>gamma-series methods</kwd>
      <kwd>sliding window</kwd>
      <kwd>positively selected sites</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="s0005">
    <title>Introduction</title>
    <p>Calculating nonsynonymous (Ka) and synonymous (Ks) substitution rates is a useful way for evaluating sequence variations for protein orthologs across different species or taxonomical lineages with unknown evolutionary status. Furthermore, it is often important to recognize positively selected sites and to identify genes with selective hotspots. There have been numerous methods and software tools developed for such purposes in the public domain, including PAML <xref rid="bib1" ref-type="bibr">(<italic>1</italic>)</xref>, MEGA <xref rid="bib2" ref-type="bibr">(<italic>2</italic>)</xref>, DnaSP <xref rid="bib3" ref-type="bibr">(<italic>3</italic>)</xref>, HyPhy <xref rid="bib4" ref-type="bibr">(<italic>4</italic>)</xref> and certain modules from Bioperl <xref rid="bib5" ref-type="bibr">(<italic>5</italic>)</xref>. However, after careful simulations and real data analysis, we believe that a single method will not be readily identified to be used under all circumstances <xref rid="bib6" ref-type="bibr">6</xref>, <xref rid="bib7" ref-type="bibr">7</xref>, therefore we created the version of the KaKs_Calculator 1.0 <xref rid="bib8" ref-type="bibr">(<italic>8</italic>)</xref>, which adopted model-selected and model-averaged techniques to compute Ka/Ks values by means of a group of existing nucleotide substitution models.</p>
    <p>Since the majority of DNA sequence sites are considered to be invariable due to functional restraints and evolutionary distances, the selective pressure varies among different sites in a sequence, thus Ka/Ks calculations only based on the entire gene are not enough to detect the individual sites subjected to adaptive selection. To conquer this problem, a “sliding window” strategy has been introduced to several web servers such as SWAPSC <xref rid="bib9" ref-type="bibr">(<italic>9</italic>)</xref> and WSPMaker <xref rid="bib10" ref-type="bibr">(<italic>10</italic>)</xref>, while these tools adopted fewer (mostly one) models for Ka and Ks calculations. Here we provide an updated version of KaKs_Calculator, which solves these two questions in a simple way. In particular, we have embedded gamma-series methods into this new version.</p>
  </sec>
  <sec id="s0010">
    <title>New Features</title>
    <p>We have brought up three novel features into KaKs_Calculator 2.0. First, unlike the existent Ka/Ks algorithms, the new software can take the variable mutation rates across sequence sites into account, which contain vital information for molecular evolutionary studies. We created seven related methods namely <italic>γ</italic>-NG, <italic>γ</italic>-LWL, <italic>γ</italic>-MLWL, <italic>γ</italic>-LPB, <italic>γ</italic>-MLPB, <italic>γ</italic>-YN and <italic>γ</italic>-MYN by introducing gamma distribution to model the mutation rates; the importance of the new methods has been demonstrated as the ignorance gives rise to biased computational results <xref rid="bib11" ref-type="bibr">11</xref>, <xref rid="bib12" ref-type="bibr">12</xref>. We therefore implemented these new methods into the updated core tool of version 2.0, whose core toolset has seventeen algorithms including seven original approximate methods, seven gamma-series methods, one maximum likelihood method (GY), and two expanding methods (model selected and model averaged). The methods provide not only the values of Ka, Ks and Ka/Ks, but also other key information from paired orthologous sequences, including the number of synonymous/nonsynonymous sites, substitutions, divergence time, substitution-rate-ratio, GC content, and AICc. Second, we added three new modules—<italic>split</italic>, <italic>plot</italic>, <italic>dpss</italic>—to evaluate adaptive selection at the gene sequence level. As an expanding toolset, they adopt a sliding window with user’s definition on window length and step length. <italic>Split</italic> is responsible for the division of the raw paired orthologous sequences into portions on the basis of dynamic windows in the positive direction. <italic>Plot</italic> deals with the outcome of the core toolset after the nucleotide sequences from <italic>Split</italic> have been computed, resulting in a massive collection of figures illustrating Ka, Ks and Ka/Ks (omega) in intervals. <italic>Dpss</italic> identifies the positions of positively selected sites based on the initial analyses. Third, it should be emphasized that all above-mentioned processes are capable of handling massive data in a timely fashion. In particular, all transferrable data including sequences and resulting information are contained in a single file. We provide executable files as well as source codes for the package and tested all programs on both Windows 2000/XP/Vista and Linux (Red Hat 3.4.6-8) platforms. The toolkit is freely available (licensed under GPLv3) online at <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/kakscalculator2/" id="ir6665">https://sourceforge.net/projects/kakscalculator2/</ext-link>.</p>
  </sec>
  <sec id="s0015">
    <title>Implementation</title>
    <p>In order to conveniently update the algorithm and to friendly communicate with users, we implement the new version with a “toolkit” idea in mind. Therefore, the integrated software is divided into two essential parts to better serve for different functionality: the core toolset that calculates Ka and Ks, and the expanding toolset that is responsible for additional computation activities based on the Ka and Ks calculation (<italic>e.g</italic>., with a sliding window strategy) (<xref rid="f0005" ref-type="fig">Figure 1</xref>). In the core toolset, we design the GUI with visual C++’s MFC (Microsoft Foundation Classes) that manages documents and allows users to view the objects, and the entire program is object-oriented. Each main method has its own class in the code and the multi-thread operations among them use the CPU time allocations very efficiently. We adopt Java-6 to program the expanding toolset because of its advantages across different platforms. We choose R language (<ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/" id="ir7500">http://www.r-project.org/</ext-link>) to draw high-level graphics from inputting data. To call for the R function from Java, we employ a package named “Rserve” (<ext-link ext-link-type="uri" xlink:href="http://www.rforge.net/Rserve/index.html" id="ir0005">http://www.rforge.net/Rserve/index.html</ext-link>), which is a program responding to requests from clients based on the TCP/IP protocol. In details, we use java to invoke the JRclient suite and connect it after Rserve starts on R environment; under this circumstance each connection has its workspace and directory. Moreover, the server allows many clients to plot their data simultaneously. In consideration of the running speed, it is so fast that a graph covering thousands of data points can be plotted in a few seconds.</p>
  </sec>
  <sec id="s0020">
    <title>Evaluation</title>
    <p>We have evaluated the performance of the gamma-series methods in Ka/Ks calculations in previous studies <xref rid="bib11" ref-type="bibr">11</xref>, <xref rid="bib12" ref-type="bibr">12</xref>. In the process of identifying positively selected sites, we have also successfully applied the toolbox to two real cases, including the animal alpha-defensin genes investigated in Lynn <italic>et al</italic>. <xref rid="bib13" ref-type="bibr">(<italic>13</italic>)</xref> and the <italic>TAS1R3</italic> (taste receptor type 1 member 3) genes reported to be responsible for the ability to recognize the sweetness <xref rid="bib14" ref-type="bibr">(<italic>14</italic>)</xref> (<xref rid="f0010" ref-type="fig">Figure 2</xref>). It is important to combine the gamma-series methods with a sliding window strategy; the former represents the variation of raw mutation across sites and the latter reveals if each site is driven by different selective pressure based on the assumption that the omega (Ka/Ks) values are not equal across orthologous gene sequences. In particular, when window slices become dense enough, it approaches the “site models” <xref rid="bib1" ref-type="bibr">(<italic>1</italic>)</xref>, similar to the thought of “integral” definition in mathematics. We believe that the software provides an excellent choice when one calculates for positively selected sites. A final note is that we will construct ancestral sequences for the measurement of lineage-specific selective strength in our next update.</p>
    <sec id="s0025">
      <title>Authors’ contributions</title>
      <p>DW and JY conceived and designed this study. DW and YZ programmed the software and drafted the manuscript. ZZ supplied several bug reports and modified schemes in the previous version of the software. DW and JZ contributed to data analyses and software testing. JY managed this project and revised the manuscript. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="s0030">
      <title>Competing interests</title>
      <p>The authors have declared that no competing interests exist.</p>
    </sec>
  </sec>
</body>
<back>
  <ref-list id="bibliog0005">
    <title>References</title>
    <ref id="bib1">
      <label>1</label>
      <element-citation publication-type="journal" id="sbref1">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>PAML 4: phylogenetic analysis by maximum likelihood</article-title>
        <source>Mol. Biol. Evol.</source>
        <volume>24</volume>
        <year>2007</year>
        <fpage>1586</fpage>
        <lpage>1591</lpage>
        <pub-id pub-id-type="pmid">17483113</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <label>2</label>
      <element-citation publication-type="journal" id="sbref2">
        <person-group person-group-type="author">
          <name>
            <surname>Tamura</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>MEGA4: Molecular Evolutionary Genetics Analysis (MEGA) software version 4.0</article-title>
        <source>Mol. Biol. Evol.</source>
        <volume>24</volume>
        <year>2007</year>
        <fpage>1596</fpage>
        <lpage>1599</lpage>
        <pub-id pub-id-type="pmid">17488738</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <label>3</label>
      <element-citation publication-type="journal" id="sbref3">
        <person-group person-group-type="author">
          <name>
            <surname>Librado</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Rozas</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>DnaSP v5: a software for comprehensive analysis of DNA polymorphism data</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <year>2009</year>
        <fpage>1451</fpage>
        <lpage>1452</lpage>
        <pub-id pub-id-type="pmid">19346325</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <label>4</label>
      <element-citation publication-type="journal" id="sbref4">
        <person-group person-group-type="author">
          <name>
            <surname>Pond</surname>
            <given-names>S.L.</given-names>
          </name>
        </person-group>
        <article-title>HyPhy: hypothesis testing using phylogenies</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <year>2005</year>
        <fpage>676</fpage>
        <lpage>679</lpage>
        <pub-id pub-id-type="pmid">15509596</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <label>5</label>
      <element-citation publication-type="journal" id="sbref5">
        <person-group person-group-type="author">
          <name>
            <surname>Stajich</surname>
            <given-names>J.E.</given-names>
          </name>
        </person-group>
        <article-title>The Bioperl toolkit: Perl modules for the life sciences</article-title>
        <source>Genome Res.</source>
        <volume>12</volume>
        <year>2002</year>
        <fpage>1611</fpage>
        <lpage>1618</lpage>
        <pub-id pub-id-type="pmid">12368254</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <label>6</label>
      <element-citation publication-type="journal" id="sbref6">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Correlation between Ka/Ks and Ks is related to substitution model and evolutionary lineage</article-title>
        <source>J. Mol. Evol.</source>
        <volume>68</volume>
        <year>2009</year>
        <fpage>414</fpage>
        <lpage>423</lpage>
        <pub-id pub-id-type="pmid">19308632</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <label>7</label>
      <element-citation publication-type="journal" id="sbref7">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of six methods for estimating synonymous and nonsynonymous substitution rates</article-title>
        <source>Genomics Proteomics Bioinformatics</source>
        <volume>4</volume>
        <year>2006</year>
        <fpage>173</fpage>
        <lpage>181</lpage>
        <pub-id pub-id-type="pmid">17127215</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <label>8</label>
      <element-citation publication-type="journal" id="sbref8">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>KaKs_Calculator: calculating Ka and Ks through model selection and model averaging</article-title>
        <source>Genomics Proteomics Bioinformatics</source>
        <volume>4</volume>
        <year>2006</year>
        <fpage>259</fpage>
        <lpage>263</lpage>
        <pub-id pub-id-type="pmid">17531802</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <label>9</label>
      <element-citation publication-type="journal" id="sbref9">
        <person-group person-group-type="author">
          <name>
            <surname>Fares</surname>
            <given-names>M.A.</given-names>
          </name>
        </person-group>
        <article-title>SWAPSC: sliding window analysis procedure to detect selective constraints</article-title>
        <source>Bioinformatics</source>
        <volume>20</volume>
        <year>2004</year>
        <fpage>2867</fpage>
        <lpage>2868</lpage>
        <pub-id pub-id-type="pmid">15130925</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <label>10</label>
      <element-citation publication-type="journal" id="sbref10">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>Y.S.</given-names>
          </name>
        </person-group>
        <article-title>WSPMaker: a web tool for calculating selection pressure in proteins and domains using window-sliding</article-title>
        <source>BMC Bioinformatics</source>
        <volume>9</volume>
        <year>2008</year>
        <fpage>S13</fpage>
      </element-citation>
    </ref>
    <ref id="bib11">
      <label>11</label>
      <element-citation publication-type="journal" id="sbref11">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>D.P.</given-names>
          </name>
        </person-group>
        <article-title>Gamma-MYN: a new algorithm for estimating Ka and Ks with consideration of variable substitution rates</article-title>
        <source>Biol. Direct</source>
        <volume>4</volume>
        <year>2009</year>
        <fpage>20</fpage>
        <pub-id pub-id-type="pmid">19531225</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <label>12</label>
      <element-citation publication-type="journal" id="sbref12">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>How do variable substitution rates influence Ka and Ks calculations?</article-title>
        <source>Genomics Proteomics Bioinformatics</source>
        <volume>7</volume>
        <year>2009</year>
        <fpage>116</fpage>
        <lpage>127</lpage>
        <pub-id pub-id-type="pmid">19944384</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <label>13</label>
      <element-citation publication-type="journal" id="sbref13">
        <person-group person-group-type="author">
          <name>
            <surname>Lynn</surname>
            <given-names>D.J.</given-names>
          </name>
        </person-group>
        <article-title>Evidence of positively selected sites in mammalian alpha-defensins</article-title>
        <source>Mol. Biol. Evol.</source>
        <volume>21</volume>
        <year>2004</year>
        <fpage>819</fpage>
        <lpage>827</lpage>
        <pub-id pub-id-type="pmid">14963090</pub-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <label>14</label>
      <element-citation publication-type="journal" id="sbref14">
        <person-group person-group-type="author">
          <name>
            <surname>Max</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Tas1r3, encoding a new candidate taste receptor, is allelic to the sweet responsiveness locus Sac</article-title>
        <source>Nat. Genet.</source>
        <volume>28</volume>
        <year>2001</year>
        <fpage>58</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">11326277</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <ack id="ack0005">
    <title>Acknowledgements</title>
    <p>This work was funded by the <funding-source id="gs1">National Basic Research Program of China</funding-source> (973 Program) to JY (Grant No. 2006CB910404).</p>
  </ack>
</back>
<floats-group>
  <fig id="f0005">
    <label>Figure 1</label>
    <caption>
      <p>A flowchart of software design on KaKs_Calculator 2.0.</p>
    </caption>
    <alt-text id="at0005">Figure 1</alt-text>
    <graphic xlink:href="gr1"/>
  </fig>
  <fig id="f0010">
    <label>Figure 2</label>
    <caption>
      <p>An example for displaying Ka, Ks and Ka/Ks to identify positively selected sites. This analysis was performed based on the <italic>TAS1R3</italic> gene pairs from <italic>Homo sapiens</italic> (NM_152228) and <italic>Canis familiaris</italic> (XM_843615).</p>
    </caption>
    <alt-text id="at0010">Figure 2</alt-text>
    <graphic xlink:href="gr2"/>
  </fig>
</floats-group>
