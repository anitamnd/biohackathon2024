<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10155362</article-id>
    <article-id pub-id-type="publisher-id">5252</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05252-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MBECS: Microbiome Batch Effects Correction Suite</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2789-3382</contrib-id>
        <name>
          <surname>Olbrich</surname>
          <given-names>Michael</given-names>
        </name>
        <address>
          <email>roland.olbrich@ku.ac.ae</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Künstner</surname>
          <given-names>Axel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Busch</surname>
          <given-names>Hauke</given-names>
        </name>
        <address>
          <email>hauke.busch@uksh.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.4562.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 0057 2672</institution-id><institution>Lübeck Institute for Experimental Dermatology, </institution><institution>University of Lübeck, </institution></institution-wrap>Lübeck, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4562.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 0057 2672</institution-id><institution>Institute for Cardiogenetics, </institution><institution>University of Lübeck, </institution></institution-wrap>Lübeck, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.440568.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1762 9729</institution-id><institution>Center for Biotechnology, </institution><institution>Khalifa University, </institution></institution-wrap>Abu Dhabi, United Arab Emirates </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>182</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Despite the availability of batch effect correcting algorithms (BECA), no comprehensive tool that combines batch correction and evaluation of the results exists for microbiome datasets. This work outlines the Microbiome Batch Effects Correction Suite development that integrates several BECAs and evaluation metrics into a software package for the statistical computation framework R.
</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05252-w.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Microbiome</kwd>
      <kwd>Batch effects</kwd>
      <kwd>R-package</kwd>
      <kwd>phyloseq</kwd>
      <kwd>Bioconductor</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>German Research Foundation, DFG</institution>
        </funding-source>
        <award-id>EXC 22167-390884018</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Universität zu Lübeck (3165)</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open Access funding enabled and organized by Projekt DEAL.</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">The emergence of unwanted variation in next-generation sequencing applications is a well-researched challenge. A particular form of unwanted technical variation are batch effects (BE) that potentially result from any distinct grouping of samples during the processing steps. Hence, the introduced variability reflects the differences in, for example, the environmental conditions, batches of reagents, sequencing machines, or sample handling for corresponding batches [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Consequently, unwanted variation can negatively affect the downstream statistical analyses as it represents a confounding factor that can obscure or exacerbate the biological truth in a dataset [<xref ref-type="bibr" rid="CR3">3</xref>]. The comprehensive scientific research into causes and strategies for preventing and correcting batch effects indicates this topic's importance [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. While appropriate measures during the planning and execution of an experiment can limit the emergence and magnitude of batch effects, they are not entirely preventable and thus need to be accounted for before statistical analyses [<xref ref-type="bibr" rid="CR6">6</xref>]. Despite the availability of batch effect correcting algorithms (BECA) and instructive guides on mitigating of BEs [<xref ref-type="bibr" rid="CR4">4</xref>], no comprehensive tool that combines batch correction and evaluation of the results exists for microbiome datasets. This work introduces the Microbiome Batch Effects Correction Suite (MBECS), which integrates several established BECAs and evaluation metrics into a software package for the R statistical computation framework.</p>
  </sec>
  <sec id="Sec2">
    <title>Features</title>
    <p id="Par3">The Microbiome Batch Effect Correction Suite is designed as a software toolbox that enables users to estimate the severity of batch effects, facilitates the utilization of different BECAs, and finally provides comparative metrics to evaluate the success of each method. To that end, the package offers a convenient 5-step workflow that produces a report to guide the user in selecting the optimal results for downstream analyses.</p>
    <p id="Par4">The software builds upon the phyloseq [<xref ref-type="bibr" rid="CR7">7</xref>] package, which facilitates the intuitive import and export of existing microbiome datasets and enables the use of other count-based datasets. The packages' data object extends the phyloseq class with additional fields that store normalized and batch-corrected feature abundance tables. All operations are performed on this single data object that keeps track of the results, promoting tidy scripts and enabling MBECS comparative reporting.</p>
    <p id="Par5">The normalization methods implemented in MBECS are total-sum scaling (TSS) and centered log-ratio transformation (CLR) [<xref ref-type="bibr" rid="CR8">8</xref>]. Available BECAs include established correction algorithms such as ComBat and Remove Batch Effects from the SVA package [<xref ref-type="bibr" rid="CR9">9</xref>] and Remove Unwanted Variation 3 implemented in the RUV package [<xref ref-type="bibr" rid="CR10">10</xref>]. Additionally, the package implements batch mean centering, Percentile Normalization, and Singular Value Decomposition as correction approaches [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par6">Quantifying the variability in a dataset that can be attributed to batch effects is not trivial. A relative log expression (RLE) plot, for example, can indicate the presence of batch effects, yet it is not a suitable approach to determining whether or not they have been removed successfully by a correction algorithm [<xref ref-type="bibr" rid="CR12">12</xref>]. Thus, the suite implements several distinct metrics to provide the user with comprehensive information to assess the severity of BEs before and after batch-correction procedures. Available methods include constructing linear models from recorded biological and batch factors to estimate the variability attributed to batch effects before and after the correction procedures. Further approaches implemented are partial redundancy analysis and principal variance components analysis [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. Finally, the silhouette coefficient is a qualitative measure of the goodness of fit of samples to their respective biological groupings [<xref ref-type="bibr" rid="CR15">15</xref>].
</p>
    <p id="Par7">The packages' native workflow depicted in Fig. <xref rid="Fig1" ref-type="fig">1</xref> will create a preliminary report upon importing the dataset. This report summarizes the data concerning covariate information, distribution of samples into biological groups and known batches, heatmaps, and box plots of the most variable features concerning the batch factor and relative log-expression plots. The preliminary report also provides the metrics mentioned above to assess variability for the uncorrected data. The user can decide whether or not batch correction is required based on that account. The subsequent processing step allows the application of selected correction methods depending on the experimental design. Methods like RUV-3 specifically require technical replicates in different batches to work; Batch mean centering is only applicable to datasets that comprise two-factor biological groupings, i.e., case–control studies [<xref ref-type="bibr" rid="CR10">10</xref>]. Therefore, it is up to the user which methods to use, and all the correction results are stored within the data object.<fig id="Fig1"><label>Fig. 1</label><caption><p>The MBECS processing pipeline comprises five main steps that provide users with the means to investigate potential batch effects and mitigate them before downstream statistical analyses: The preliminary report provides an overview of a data set to assess the presence and gravity of batch effects. The correction step can apply and store the output of various BECAs. The available correction methods are Remove Unwanted Variation 3 (ruv3), Batch Mean Centering (bmc), ComBat (bat), RemoveBatchEffects (rbe), Percentile Normalization (pn), and Singular Value Decomposition (svd). Several variance assessment methods, e.g., linear modeling, principal variance component analysis, and redundancy analysis are employed in the post-processing reports to produce a comparative qualitative analysis between the uncorrected data set and the selected BECAs. The export functionality allows extraction of the transformed or corrected counts in tabular or phyloseq formats to facilitate downstream statistical analyses</p></caption><graphic xlink:href="12859_2023_5252_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par8">The third step constructs the post-correction report. This report provides comparative analyses between uncorrected data and all the employed correction algorithms. The user can use these to evaluate the correction algorithms in terms of reduced unwanted variability while preserving the biological variation that is investigated with the experimental design. An instructive manual for the package and examples of preliminary and post-corrections reports are available as supplemental material accompanying the online article (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Additional file <xref rid="MOESM2" ref-type="media">2</xref>, Additional file <xref rid="MOESM3" ref-type="media">3</xref>).</p>
  </sec>
  <sec id="Sec3">
    <title>Implementation</title>
    <p id="Par9">The Microbiome Batch Effect Correction Suite is available as a software package for the R programming framework at Bioconductor. The latest development version can be obtained from the GitHub repository.</p>
    <sec id="Sec4">
      <title>Availability and requirements</title>
      <p id="Par10">
        <list list-type="bullet">
          <list-item>
            <p id="Par11">Project name: MBECS Microbiome Batch Effect Correction Suite</p>
          </list-item>
          <list-item>
            <p id="Par12">Project home page: <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/MBECS.html">http://www.bioconductor.org/packages/release/bioc/html/MBECS.html</ext-link></p>
          </list-item>
          <list-item>
            <p id="Par13">Operating system(s): Platform independent</p>
          </list-item>
          <list-item>
            <p id="Par14">Programming language: R (&gt; = 4.1)</p>
          </list-item>
          <list-item>
            <p id="Par15">Other requirements: CRAN and Bioconductor packages (methods, magrittr, phyloseq, limma, lme4, lmerTest, pheatmap, rmarkdown, cluster, dplyr, ggplot2, gridExtra, ruv, sva, tibble, tidyr, vegan, stats, utils, Matrix)</p>
          </list-item>
          <list-item>
            <p id="Par16">License: Artistic-2.0</p>
          </list-item>
          <list-item>
            <p id="Par17">Any restrictions to use by non-academics: None</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec5">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5252_MOESM1_ESM.html">
            <caption>
              <p><bold>Additional file 1.</bold> Vignette.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5252_MOESM2_ESM.html">
            <caption>
              <p><bold>Additional file 2.</bold> Preliminary report.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2023_5252_MOESM3_ESM.html">
            <caption>
              <p><bold>Additional file 3.</bold> Post-correction report.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Axel Künstner and Hauke Busch have contributed equally to this work</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>None.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Conceptualization, MO, AK, HB; Methodology, MO; Validation, MO; Formal analysis, MO; Investigation, MO; Resources, MO; Data curation, MO; Writing—original draft preparation, MO; Writing—review and editing, MO, AK, HB; Visualization, MO; Supervision, AK, HB; Project administration, AK, HB; Funding acquisition, HB. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open Access funding enabled and organized by Projekt DEAL. Hauke Busch acknowledges funding by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany`s Excellence Strategy (EXC 22167-390884018).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source code is freely available under Artistic-2.0 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/rmolbrich/MBECS">https://github.com/rmolbrich/MBECS</ext-link> and at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/MBECS.html">https://bioconductor.org/packages/release/bioc/html/MBECS.html</ext-link>. The packages vignette and examples utilize artificial mockup data to illustrate workflow and execution. The package vignette and two exemplary reports are available as supplementary data.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par18">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par19">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par20">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Removing batch effects in analysis of expression microarray data: an evaluation of six batch adjustment methods</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e17238</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0017238</pub-id>
        <?supplied-pmid 21386892?>
        <pub-id pub-id-type="pmid">21386892</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Čuklina</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Matthiesen</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Review of batch effects prevention, diagnostics, and correction approaches</article-title>
        <source>Mass spectrometry data analysis in proteomics, methods in molecular biology</source>
        <year>2020</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>373</fpage>
        <lpage>387</lpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goh</surname>
            <given-names>WWB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Why batch effects matter in omics data, and how to avoid them</article-title>
        <source>Trends Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>498</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tibtech.2017.02.012</pub-id>
        <?supplied-pmid 28351613?>
        <pub-id pub-id-type="pmid">28351613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>LêCao</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Managing batch effects in microbiome data</article-title>
        <source>Brief Bioinform</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1954</fpage>
        <lpage>1970</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbz105</pub-id>
        <?supplied-pmid 31776547?>
        <pub-id pub-id-type="pmid">31776547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="editor">
          <name>
            <surname>Scherer</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Batch effects and noise in microarray experiments: sources and solutions</source>
        <year>2009</year>
        <publisher-loc>Chichester</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Examining the practical limits of batch effect-correction algorithms: when should you care about batch effects?</article-title>
        <source>J Genet Genomics</source>
        <year>2019</year>
        <volume>46</volume>
        <fpage>433</fpage>
        <lpage>443</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jgg.2019.08.002</pub-id>
        <?supplied-pmid 31611172?>
        <pub-id pub-id-type="pmid">31611172</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>phyloseq: An R package for reproducible interactive analysis and graphics of microbiome census data</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e61217</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0061217</pub-id>
        <?supplied-pmid 23630581?>
        <pub-id pub-id-type="pmid">23630581</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kucera</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Malmgren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Logratio transformation of compositional data—a resolution of the constant sum constraint</article-title>
        <source>Mar Micropaleontol</source>
        <year>1998</year>
        <volume>34</volume>
        <fpage>117</fpage>
        <lpage>120</lpage>
        <pub-id pub-id-type="doi">10.1016/S0377-8398(97)00047-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The SVA package for removing batch effects and other unwanted variation in high-throughput experiments</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>882</fpage>
        <lpage>883</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts034</pub-id>
        <?supplied-pmid 22257669?>
        <pub-id pub-id-type="pmid">22257669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gagnon-Bartsch</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Using control genes to correct for unwanted variation in microarray data</article-title>
        <source>Biostatistics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>539</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxr034</pub-id>
        <?supplied-pmid 22101192?>
        <pub-id pub-id-type="pmid">22101192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Gibbons SM et al. Correcting for batch effects in case-control microbiome studies. 17</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gandolfo</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>RLE plots: Visualizing unwanted variation in high dimensional data</article-title>
        <source>PLoS ONE</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>e0191629</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0191629</pub-id>
        <?supplied-pmid 29401521?>
        <pub-id pub-id-type="pmid">29401521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Scherer</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Principal variance components analysis: estimating batch effects in microarray gene expression data</article-title>
        <source>Batch effects and noise in microarray experiments</source>
        <year>2009</year>
        <publisher-loc>Chichester</publisher-loc>
        <publisher-name>Wiley</publisher-name>
        <fpage>141</fpage>
        <lpage>154</lpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Variation partitioning by partial redundancy analysis (RDA)</article-title>
        <source>Environmetrics</source>
        <year>1997</year>
        <volume>8</volume>
        <fpage>75</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1099-095X(199703)8:2&lt;75::AID-ENV250&gt;3.0.CO;2-N</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0377-0427(87)90125-7</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10155362</article-id>
    <article-id pub-id-type="publisher-id">5252</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05252-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MBECS: Microbiome Batch Effects Correction Suite</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2789-3382</contrib-id>
        <name>
          <surname>Olbrich</surname>
          <given-names>Michael</given-names>
        </name>
        <address>
          <email>roland.olbrich@ku.ac.ae</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Künstner</surname>
          <given-names>Axel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Busch</surname>
          <given-names>Hauke</given-names>
        </name>
        <address>
          <email>hauke.busch@uksh.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.4562.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 0057 2672</institution-id><institution>Lübeck Institute for Experimental Dermatology, </institution><institution>University of Lübeck, </institution></institution-wrap>Lübeck, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4562.5</institution-id><institution-id institution-id-type="ISNI">0000 0001 0057 2672</institution-id><institution>Institute for Cardiogenetics, </institution><institution>University of Lübeck, </institution></institution-wrap>Lübeck, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.440568.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1762 9729</institution-id><institution>Center for Biotechnology, </institution><institution>Khalifa University, </institution></institution-wrap>Abu Dhabi, United Arab Emirates </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>182</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Despite the availability of batch effect correcting algorithms (BECA), no comprehensive tool that combines batch correction and evaluation of the results exists for microbiome datasets. This work outlines the Microbiome Batch Effects Correction Suite development that integrates several BECAs and evaluation metrics into a software package for the statistical computation framework R.
</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05252-w.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Microbiome</kwd>
      <kwd>Batch effects</kwd>
      <kwd>R-package</kwd>
      <kwd>phyloseq</kwd>
      <kwd>Bioconductor</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>German Research Foundation, DFG</institution>
        </funding-source>
        <award-id>EXC 22167-390884018</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Universität zu Lübeck (3165)</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open Access funding enabled and organized by Projekt DEAL.</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">The emergence of unwanted variation in next-generation sequencing applications is a well-researched challenge. A particular form of unwanted technical variation are batch effects (BE) that potentially result from any distinct grouping of samples during the processing steps. Hence, the introduced variability reflects the differences in, for example, the environmental conditions, batches of reagents, sequencing machines, or sample handling for corresponding batches [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Consequently, unwanted variation can negatively affect the downstream statistical analyses as it represents a confounding factor that can obscure or exacerbate the biological truth in a dataset [<xref ref-type="bibr" rid="CR3">3</xref>]. The comprehensive scientific research into causes and strategies for preventing and correcting batch effects indicates this topic's importance [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. While appropriate measures during the planning and execution of an experiment can limit the emergence and magnitude of batch effects, they are not entirely preventable and thus need to be accounted for before statistical analyses [<xref ref-type="bibr" rid="CR6">6</xref>]. Despite the availability of batch effect correcting algorithms (BECA) and instructive guides on mitigating of BEs [<xref ref-type="bibr" rid="CR4">4</xref>], no comprehensive tool that combines batch correction and evaluation of the results exists for microbiome datasets. This work introduces the Microbiome Batch Effects Correction Suite (MBECS), which integrates several established BECAs and evaluation metrics into a software package for the R statistical computation framework.</p>
  </sec>
  <sec id="Sec2">
    <title>Features</title>
    <p id="Par3">The Microbiome Batch Effect Correction Suite is designed as a software toolbox that enables users to estimate the severity of batch effects, facilitates the utilization of different BECAs, and finally provides comparative metrics to evaluate the success of each method. To that end, the package offers a convenient 5-step workflow that produces a report to guide the user in selecting the optimal results for downstream analyses.</p>
    <p id="Par4">The software builds upon the phyloseq [<xref ref-type="bibr" rid="CR7">7</xref>] package, which facilitates the intuitive import and export of existing microbiome datasets and enables the use of other count-based datasets. The packages' data object extends the phyloseq class with additional fields that store normalized and batch-corrected feature abundance tables. All operations are performed on this single data object that keeps track of the results, promoting tidy scripts and enabling MBECS comparative reporting.</p>
    <p id="Par5">The normalization methods implemented in MBECS are total-sum scaling (TSS) and centered log-ratio transformation (CLR) [<xref ref-type="bibr" rid="CR8">8</xref>]. Available BECAs include established correction algorithms such as ComBat and Remove Batch Effects from the SVA package [<xref ref-type="bibr" rid="CR9">9</xref>] and Remove Unwanted Variation 3 implemented in the RUV package [<xref ref-type="bibr" rid="CR10">10</xref>]. Additionally, the package implements batch mean centering, Percentile Normalization, and Singular Value Decomposition as correction approaches [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par6">Quantifying the variability in a dataset that can be attributed to batch effects is not trivial. A relative log expression (RLE) plot, for example, can indicate the presence of batch effects, yet it is not a suitable approach to determining whether or not they have been removed successfully by a correction algorithm [<xref ref-type="bibr" rid="CR12">12</xref>]. Thus, the suite implements several distinct metrics to provide the user with comprehensive information to assess the severity of BEs before and after batch-correction procedures. Available methods include constructing linear models from recorded biological and batch factors to estimate the variability attributed to batch effects before and after the correction procedures. Further approaches implemented are partial redundancy analysis and principal variance components analysis [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. Finally, the silhouette coefficient is a qualitative measure of the goodness of fit of samples to their respective biological groupings [<xref ref-type="bibr" rid="CR15">15</xref>].
</p>
    <p id="Par7">The packages' native workflow depicted in Fig. <xref rid="Fig1" ref-type="fig">1</xref> will create a preliminary report upon importing the dataset. This report summarizes the data concerning covariate information, distribution of samples into biological groups and known batches, heatmaps, and box plots of the most variable features concerning the batch factor and relative log-expression plots. The preliminary report also provides the metrics mentioned above to assess variability for the uncorrected data. The user can decide whether or not batch correction is required based on that account. The subsequent processing step allows the application of selected correction methods depending on the experimental design. Methods like RUV-3 specifically require technical replicates in different batches to work; Batch mean centering is only applicable to datasets that comprise two-factor biological groupings, i.e., case–control studies [<xref ref-type="bibr" rid="CR10">10</xref>]. Therefore, it is up to the user which methods to use, and all the correction results are stored within the data object.<fig id="Fig1"><label>Fig. 1</label><caption><p>The MBECS processing pipeline comprises five main steps that provide users with the means to investigate potential batch effects and mitigate them before downstream statistical analyses: The preliminary report provides an overview of a data set to assess the presence and gravity of batch effects. The correction step can apply and store the output of various BECAs. The available correction methods are Remove Unwanted Variation 3 (ruv3), Batch Mean Centering (bmc), ComBat (bat), RemoveBatchEffects (rbe), Percentile Normalization (pn), and Singular Value Decomposition (svd). Several variance assessment methods, e.g., linear modeling, principal variance component analysis, and redundancy analysis are employed in the post-processing reports to produce a comparative qualitative analysis between the uncorrected data set and the selected BECAs. The export functionality allows extraction of the transformed or corrected counts in tabular or phyloseq formats to facilitate downstream statistical analyses</p></caption><graphic xlink:href="12859_2023_5252_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par8">The third step constructs the post-correction report. This report provides comparative analyses between uncorrected data and all the employed correction algorithms. The user can use these to evaluate the correction algorithms in terms of reduced unwanted variability while preserving the biological variation that is investigated with the experimental design. An instructive manual for the package and examples of preliminary and post-corrections reports are available as supplemental material accompanying the online article (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Additional file <xref rid="MOESM2" ref-type="media">2</xref>, Additional file <xref rid="MOESM3" ref-type="media">3</xref>).</p>
  </sec>
  <sec id="Sec3">
    <title>Implementation</title>
    <p id="Par9">The Microbiome Batch Effect Correction Suite is available as a software package for the R programming framework at Bioconductor. The latest development version can be obtained from the GitHub repository.</p>
    <sec id="Sec4">
      <title>Availability and requirements</title>
      <p id="Par10">
        <list list-type="bullet">
          <list-item>
            <p id="Par11">Project name: MBECS Microbiome Batch Effect Correction Suite</p>
          </list-item>
          <list-item>
            <p id="Par12">Project home page: <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/MBECS.html">http://www.bioconductor.org/packages/release/bioc/html/MBECS.html</ext-link></p>
          </list-item>
          <list-item>
            <p id="Par13">Operating system(s): Platform independent</p>
          </list-item>
          <list-item>
            <p id="Par14">Programming language: R (&gt; = 4.1)</p>
          </list-item>
          <list-item>
            <p id="Par15">Other requirements: CRAN and Bioconductor packages (methods, magrittr, phyloseq, limma, lme4, lmerTest, pheatmap, rmarkdown, cluster, dplyr, ggplot2, gridExtra, ruv, sva, tibble, tidyr, vegan, stats, utils, Matrix)</p>
          </list-item>
          <list-item>
            <p id="Par16">License: Artistic-2.0</p>
          </list-item>
          <list-item>
            <p id="Par17">Any restrictions to use by non-academics: None</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec5">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5252_MOESM1_ESM.html">
            <caption>
              <p><bold>Additional file 1.</bold> Vignette.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5252_MOESM2_ESM.html">
            <caption>
              <p><bold>Additional file 2.</bold> Preliminary report.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2023_5252_MOESM3_ESM.html">
            <caption>
              <p><bold>Additional file 3.</bold> Post-correction report.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Axel Künstner and Hauke Busch have contributed equally to this work</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>None.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Conceptualization, MO, AK, HB; Methodology, MO; Validation, MO; Formal analysis, MO; Investigation, MO; Resources, MO; Data curation, MO; Writing—original draft preparation, MO; Writing—review and editing, MO, AK, HB; Visualization, MO; Supervision, AK, HB; Project administration, AK, HB; Funding acquisition, HB. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open Access funding enabled and organized by Projekt DEAL. Hauke Busch acknowledges funding by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany`s Excellence Strategy (EXC 22167-390884018).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source code is freely available under Artistic-2.0 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/rmolbrich/MBECS">https://github.com/rmolbrich/MBECS</ext-link> and at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/MBECS.html">https://bioconductor.org/packages/release/bioc/html/MBECS.html</ext-link>. The packages vignette and examples utilize artificial mockup data to illustrate workflow and execution. The package vignette and two exemplary reports are available as supplementary data.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par18">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par19">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par20">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Removing batch effects in analysis of expression microarray data: an evaluation of six batch adjustment methods</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e17238</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0017238</pub-id>
        <?supplied-pmid 21386892?>
        <pub-id pub-id-type="pmid">21386892</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Čuklina</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Matthiesen</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Review of batch effects prevention, diagnostics, and correction approaches</article-title>
        <source>Mass spectrometry data analysis in proteomics, methods in molecular biology</source>
        <year>2020</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>373</fpage>
        <lpage>387</lpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goh</surname>
            <given-names>WWB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Why batch effects matter in omics data, and how to avoid them</article-title>
        <source>Trends Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>498</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tibtech.2017.02.012</pub-id>
        <?supplied-pmid 28351613?>
        <pub-id pub-id-type="pmid">28351613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>LêCao</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Managing batch effects in microbiome data</article-title>
        <source>Brief Bioinform</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1954</fpage>
        <lpage>1970</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbz105</pub-id>
        <?supplied-pmid 31776547?>
        <pub-id pub-id-type="pmid">31776547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="editor">
          <name>
            <surname>Scherer</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Batch effects and noise in microarray experiments: sources and solutions</source>
        <year>2009</year>
        <publisher-loc>Chichester</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Examining the practical limits of batch effect-correction algorithms: when should you care about batch effects?</article-title>
        <source>J Genet Genomics</source>
        <year>2019</year>
        <volume>46</volume>
        <fpage>433</fpage>
        <lpage>443</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jgg.2019.08.002</pub-id>
        <?supplied-pmid 31611172?>
        <pub-id pub-id-type="pmid">31611172</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>phyloseq: An R package for reproducible interactive analysis and graphics of microbiome census data</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e61217</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0061217</pub-id>
        <?supplied-pmid 23630581?>
        <pub-id pub-id-type="pmid">23630581</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kucera</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Malmgren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Logratio transformation of compositional data—a resolution of the constant sum constraint</article-title>
        <source>Mar Micropaleontol</source>
        <year>1998</year>
        <volume>34</volume>
        <fpage>117</fpage>
        <lpage>120</lpage>
        <pub-id pub-id-type="doi">10.1016/S0377-8398(97)00047-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The SVA package for removing batch effects and other unwanted variation in high-throughput experiments</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>882</fpage>
        <lpage>883</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts034</pub-id>
        <?supplied-pmid 22257669?>
        <pub-id pub-id-type="pmid">22257669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gagnon-Bartsch</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Using control genes to correct for unwanted variation in microarray data</article-title>
        <source>Biostatistics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>539</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxr034</pub-id>
        <?supplied-pmid 22101192?>
        <pub-id pub-id-type="pmid">22101192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Gibbons SM et al. Correcting for batch effects in case-control microbiome studies. 17</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gandolfo</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>RLE plots: Visualizing unwanted variation in high dimensional data</article-title>
        <source>PLoS ONE</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>e0191629</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0191629</pub-id>
        <?supplied-pmid 29401521?>
        <pub-id pub-id-type="pmid">29401521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Scherer</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Principal variance components analysis: estimating batch effects in microarray gene expression data</article-title>
        <source>Batch effects and noise in microarray experiments</source>
        <year>2009</year>
        <publisher-loc>Chichester</publisher-loc>
        <publisher-name>Wiley</publisher-name>
        <fpage>141</fpage>
        <lpage>154</lpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Variation partitioning by partial redundancy analysis (RDA)</article-title>
        <source>Environmetrics</source>
        <year>1997</year>
        <volume>8</volume>
        <fpage>75</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1099-095X(199703)8:2&lt;75::AID-ENV250&gt;3.0.CO;2-N</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0377-0427(87)90125-7</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
