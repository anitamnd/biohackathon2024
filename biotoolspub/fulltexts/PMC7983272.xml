<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7983272</article-id>
    <article-id pub-id-type="publisher-id">4054</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04054-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CytoTree: an R/Bioconductor package for analysis and visualization of flow and mass cytometry data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Dai</surname>
          <given-names>Yuting</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Xu</surname>
          <given-names>Aining</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Jianfeng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Liang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Shanhe</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Jun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhao</surname>
          <given-names>Weili</given-names>
        </name>
        <address>
          <email>zhao.weili@yahoo.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Sun</surname>
          <given-names>Xiao-Jian</given-names>
        </name>
        <address>
          <email>xjsun@sibs.ac.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Huang</surname>
          <given-names>Jinyan</given-names>
        </name>
        <address>
          <email>huangjy@sjtu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.16821.3c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0368 8293</institution-id><institution>Shanghai Institute of Hematology, State Key Laboratory of Medical Genomics, National Research Center for Translational Medicine at Shanghai, Ruijin Hospital Affiliated to Shanghai Jiao Tong University School of Medicine and School of Life Sciences and Biotechnology, </institution><institution>Shanghai Jiao Tong University, </institution></institution-wrap>197 Ruijin Er Road, Shanghai, 200025 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.66875.3a</institution-id><institution-id institution-id-type="ISNI">0000 0004 0459 167X</institution-id><institution>Division of Biomedical Statistics and Informatics, Department of Health Sciences Research and Center for Individualized Medicine, </institution><institution>Mayo Clinic, </institution></institution-wrap>200 1st St SW, Rochester, MN 55905 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>138</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>2</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The rapidly increasing dimensionality and throughput of flow and mass cytometry data necessitate new bioinformatics tools for analysis and interpretation, and the recently emerging single-cell-based algorithms provide a powerful strategy to meet this challenge.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we present CytoTree, an R/Bioconductor package designed to analyze and interpret multidimensional flow and mass cytometry data. CytoTree provides multiple computational functionalities that integrate most of the commonly used techniques in unsupervised clustering and dimensionality reduction and, more importantly, support the construction of a tree-shaped trajectory based on the minimum spanning tree algorithm. A graph-based algorithm is also implemented to estimate the pseudotime and infer intermediate-state cells. We apply CytoTree to several examples of mass cytometry and time-course flow cytometry data on heterogeneity-based cytology and differentiation/reprogramming experiments to illustrate the practical utility achieved in a fast and convenient manner.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">CytoTree represents a versatile tool for analyzing multidimensional flow and mass cytometry data and to producing heuristic results for trajectory construction and pseudotime estimation in an integrated workflow.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04054-2.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Flow cytometry</kwd>
      <kwd>Mass cytometry</kwd>
      <kwd>Single-cell</kwd>
      <kwd>Tree</kwd>
      <kwd>Pseudotime</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par22">Multidimensional flow and mass cytometric assays are widely used to identify cell subpopulations, determine tissue microenvironment compositions, perform clinical immunophenotyping and reconstruct differential lineages [<xref ref-type="bibr" rid="CR1">1</xref>]. Modern fluorescence-based flow cytometers can detect up to 20 features, and their capacity can be increased to detect as many as 50 features with mass cytometers [<xref ref-type="bibr" rid="CR2">2</xref>]. Traditional manual gating strategies can visualize flow cytometry data in only two or three dimensions [<xref ref-type="bibr" rid="CR3">3</xref>], and effective visualizations and related workflows are still greatly needed [<xref ref-type="bibr" rid="CR4">4</xref>]. With the rapid development of single-cell RNA sequencing (scRNA-seq), many computational workflows, such as Seurat [<xref ref-type="bibr" rid="CR5">5</xref>], Monocle [<xref ref-type="bibr" rid="CR6">6</xref>] and scmap [<xref ref-type="bibr" rid="CR7">7</xref>], have been developed for scRNA-seq data. Unlike scRNA-seq data, however, flow and mass cytometry can focus on a subset of cellular markers or protein expression levels, producing data without many missing values [<xref ref-type="bibr" rid="CR5">5</xref>]. The design of an scRNA-seq data analysis workflow could provide capabilities such as trajectory inference (studying the dynamic cellular processes [<xref ref-type="bibr" rid="CR8">8</xref>]) and pseudotime estimation (reordering cells by their biological state to recapitulate the dynamics of biological processes [<xref ref-type="bibr" rid="CR9">9</xref>]). The methods for trajectory inference and pseudotime estimation usually involve clustering, dimensionality reduction, and topological analysis based on a cell-to-cell network [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par23">The data format flow cytometry standard (FCS) for both flow and mass cytometry data has been well established. For R users, tools such as flowCore [<xref ref-type="bibr" rid="CR10">10</xref>] and OpenCyto [<xref ref-type="bibr" rid="CR11">11</xref>], have been developed for reading and manipulating FCS data inputs and outputs, and provide basic functions for standardization, normalization and manual/automated gating control. Other existing tools, such as FlowSOM [<xref ref-type="bibr" rid="CR12">12</xref>], SPADE [<xref ref-type="bibr" rid="CR13">13</xref>] and PhenoGraph [<xref ref-type="bibr" rid="CR14">14</xref>], can be used to classify the cells into different clusters. Dimensionality reduction algorithms for single-cell level data analysis were also repurposed for flow and mass cytometry data [<xref ref-type="bibr" rid="CR15">15</xref>]. These include linear dimensionality reduction techniques such as principal component analysis (PCA) and nonlinear dimensionality reduction techniques, including t-distributed stochastic neighbor embedding (t-SNE, renamed viSNE) [<xref ref-type="bibr" rid="CR16">16</xref>], diffusion maps [<xref ref-type="bibr" rid="CR17">17</xref>] and uniform manifold approximation and projection (UMAP) [<xref ref-type="bibr" rid="CR18">18</xref>]. Various clustering and dimensionality reduction algorithms make it difficult for users to test, compare, choose and evaluate for their data analysis. Furthermore, several emerging single-cell specific algorithms, such as developmental trajectory inference, lineage tracing and pseudotime estimation, have not been integrated into one analysis workflow with existing FCS tools. In accordance with well-established standards and practices [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR21">21</xref>], we present CytoTree, a trajectory inference, pseudotime estimation and visualization toolkit for flow and mass cytometry data. The CytoTree package is built in R and offers a completely up-to-date and feature-rich analysis workflow for flow and mass cytometry data, supporting a wide range of functionalities including classification, dimensionality reduction, trajectory construction, differentially expressed marker calculation, pseudotime estimation, intermediate state identification and visualization. To demonstrate these functionalities of CytoTree, we used two datasets, one for heterogeneity-based mass cytometry data and and the other for time-course flow cytometry data.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Generation of cytometry data</title>
      <p id="Par24">To generate time-course flow cytometry data, we involved the in vitro hematopoietic differentiation system from human embryonic stem cells (HUES9) to capture cells at different developmental stages. Specific antibodies used for staining hESCs-derived cells at different time were CD90 (BV421), CD49f (BV650), FLK1 (PE), CD34 (APC), CD31 (BV605), CD73 (BV711), CD43 (FITC), CD45(BV786-A), CD45RA (BV510), CD38 (PE-CY7). All antibodies were purchased from BD Biosciences. Brilliant Stain Buffer (BD Biosciences) was added to exclude staining artefacts that fluorescent dye interactions may cause. Compensation adjustments were made based on single stains. Flow cytometric analyses were performed on LSRFortessa (BD Biosciences). For mass cytometry of healthy human bone marrow, data was downloaded from FlowRepository database[<xref ref-type="bibr" rid="CR22">22</xref>] (<ext-link ext-link-type="uri" xlink:href="https://flowrepository.org/id/FR-FCM-ZY9R">https://flowrepository.org/id/FR-FCM-ZY9R</ext-link>). This data was generated by Bendall et al. [<xref ref-type="bibr" rid="CR23">23</xref>] and the preprocessing steps were implemented by Herring et al. [<xref ref-type="bibr" rid="CR24">24</xref>]</p>
    </sec>
    <sec id="Sec4">
      <title>Preprocessing of the FCS data</title>
      <p id="Par25">The preprocessing was facilitated by base packages obtained from Bioconductor, mainly flowCore [<xref ref-type="bibr" rid="CR10">10</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1, the preprocessing panel). CytoTree provides two functions that convert FCS files into an expression matrix, <italic>CytoTree::runExprsExtract</italic> and <italic>CytoTree::runExprsMerge</italic>. The two main steps that need to be implemented are compensation and filtration (also called gating). Compensation in the flow cytometry workflow has always been necessary. The manual adjustment of different fluorescence channels can be seen as the basic function of normalization and batch correction. Users could compensate the FCS files via the built-in functions in CytoTree. Regarding gating, CytoTree also provides functions to gate the matrix generated after compensation. We compared the scatter plot using FlowJo and CytoTree, and there was no difference (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2), proving that CytoTree could be a reliable tool for performing compensation and gating on FCS data. If there was more than one sample in the study, such as a time-course study, a downsampling step was recommended to be preprocessed to ensure that the sample sizes at each time point were equal. In the case presented in this study, we used <italic>CytoTree::runExprsMerge</italic> to extract 2,000 cells at each time point and then merged them directly. A built-in function based on ComBat in the sva package [<xref ref-type="bibr" rid="CR25">25</xref>] is integrated in the design of the CytoTree workflow for batch effect correction at different time points.<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of CytoTree package functionalities and algorithm. The preprocessing panel reveals the preparation steps before creating the CYT object. CytoTree provided functions to extract the expression matrix through a single FSC file or multiple FSC files. Both the clean expression matrix and meta-information are required to build the CYT object. The trajectory panel shows a the summary of the CytoTree workflow in constructing the tree-shaped trajectory. When the clustering was performed using all cells, all clusters of cells were linked by MST to illustrate the differentiation relationship based on the <italic>n</italic>-dimensional hull after dimensionality reduction. The analysis panel shows the model of pseudotime estimation and intermediate state identification. Each point represents one cell. A graph is built to connect all cells based on the KNN algorithm. Cells 1 and 2 (colored in yellow) are defined as the root cells. All the shortest paths from cells 1 and 2 to other cells are calculated to estimate the pseudotime. Cell 10 shows the maximum pseudotime and is then defined as the leaf cell (colored in purple). Forward and backward walks from the root cells and leaf cells are performed based on the shortest path. Cells 4 and 7 had the highest frequencies of occurrence during the walks and are considered to be the intermediate state cells. The running example panel shows the brief R code used to complete the entire workflow of CytoTree. Functions with “optional step” annotation are not the necessary steps in the CytoTree workflow</p></caption><graphic xlink:href="12859_2021_4054_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Clustering in CytoTree</title>
      <p id="Par26">Five unsupervised methods were integrated into CytoTree (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1, the trajectory panel): self-organizing maps (SOM) [<xref ref-type="bibr" rid="CR12">12</xref>], k-means clustering (kmeans) [<xref ref-type="bibr" rid="CR26">26</xref>], clustering large applications (clara), PhenoGraph [<xref ref-type="bibr" rid="CR14">14</xref>] and hierarchical clustering (hclust). Each method is independent and can be performed via <italic>CytoTree::runCluster</italic> by specifying different parameters. After clustering, cluster-dependent downsampling and dimensionality reduction were applied to each cluster. If the total cell sample size is over 100,000, it is better to perform downsampling to reduce the computational time. In the step of processing the clusters, four-dimensional reduction methods were applied to each cluster, including PCA, tSNE, diffusion maps and UMAP. The functions in the visualization part could be used to visualize and generate customizable, publication-quality plots. Visualization in CytoTree was mainly developed based on the R package ggplot2 (<ext-link ext-link-type="uri" xlink:href="https://ggplot2.tidyverse.org/">https://ggplot2.tidyverse.org/</ext-link>).</p>
    </sec>
    <sec id="Sec6">
      <title>Dimensionality reduction and trajectory reconstruction</title>
      <p id="Par27">Four methods (PCA, tSNE, diffusion maps, and UMAP) were integrated for dimensionality reduction enabling multidimensional data visualization in two or three dimensions. A trajectory could be constructed either from the expression profile or based on the dimensionality reduction coordinates; both were performed by the <italic>CytoTree::buildTree</italic> function. The trajectory construction was based on the minimum spanning tree (MST) algorithm [<xref ref-type="bibr" rid="CR23">23</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1, the trajectory panel). The use of the MST method in cytometry data was first proposed by Bendall et al. [<xref ref-type="bibr" rid="CR23">23</xref>], and its accuracy, scalability, stability and usability were validated by Saelens et al. in scRNA-seq data [<xref ref-type="bibr" rid="CR8">8</xref>]. To construct the trajectory, the coordinates of each cluster were first calculated. When using the expression matrix to construct the trajectory, the coordinates of the cluster were the expression value of each marker in the cluster.<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Expression\,of\,marker\,i\,in\,cluster\,j = \frac{1}{n}\mathop \sum \limits_{k = 1}^{n} e_{i, j,k}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi>E</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.166667em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.166667em"/><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.166667em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="12859_2021_4054_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{i, j,k}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq1.gif"/></alternatives></inline-formula> is the expression of marker <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M6"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq2.gif"/></alternatives></inline-formula> in cell <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M8"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq3.gif"/></alternatives></inline-formula>, cell <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M10"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq4.gif"/></alternatives></inline-formula> is a cell in cluster <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M12"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq5.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M14"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq6.gif"/></alternatives></inline-formula> is the number of cells in cluster <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M16"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq7.gif"/></alternatives></inline-formula>.</p>
      <p id="Par28">When using the dimensionality reduction method to construct the trajectory, the coordinates of each cluster were the mean values of the coordinates of the cells in the cluster.<disp-formula id="Equb"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Coordinates\,of\,dimension\,i\,in\,cluster\,j = \frac{1}{n}\mathop \sum \limits_{k = 1}^{n} c_{i, j,k}$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.166667em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.166667em"/><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.166667em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="12859_2021_4054_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{i, j,k}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq8.gif"/></alternatives></inline-formula> is the coordinate of dimension <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M22"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq9.gif"/></alternatives></inline-formula> in cell <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M24"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq10.gif"/></alternatives></inline-formula>, cell <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M26"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq11.gif"/></alternatives></inline-formula> is a cell in cluster <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M28"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq12.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M30"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq13.gif"/></alternatives></inline-formula> is the number of cells in cluster <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M32"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq14.gif"/></alternatives></inline-formula>.</p>
      <p id="Par29">After all the coordinates of the clusters were determined, an undirected graph was built to connect all clusters based on the MST algorithm, which was invoked from the igraph package (<ext-link ext-link-type="uri" xlink:href="https://igraph.org/">https://igraph.org/</ext-link>). After the trajectory was built, branch analysis will be performed, and all clusters were divided into different branches according to the Louvain algorithm [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. The differentially expressed markers in each branch could then be calculated. The algorithm for calculating differentially expressed markers was based on the limma package [<xref ref-type="bibr" rid="CR27">27</xref>], and this method was also integrated in the diffcyt package [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Strategies for pseudotime estimation and intermediate state calculation</title>
      <p id="Par30">The algorithm used to estimate pseudotime was based on prior knowledge derivation. The estimation of pseudotime from the cell-to-cell shortest path was used in several algorithms and packages [<xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR31">31</xref>]. The steps in CytoTree to estimate pseudotime can be divided into four parts (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1, the analysis panel).<list list-type="bullet"><list-item><p id="Par31">Step 1: Define the root cells. A root cell is the initiation site of differentiation or the starting point of the biological process. The pseudotime in root cells was first set up to zero.</p></list-item><list-item><p id="Par32">Step 2: Construct a graph to connect all cells using the k-nearest neighbors (KNN) algorithm [<xref ref-type="bibr" rid="CR32">32</xref>].</p></list-item><list-item><p id="Par33">Step 3: Calculate the distance from the root cells to all other cells by the shortest paths.</p></list-item><list-item><p id="Par34">Step 4: Calculate the pseudotime of each cell. The algorithm to transform distance to pseudotime was,<disp-formula id="Equc"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Distance\,of\,cell\,i \left( {D_{i} } \right) &amp; = \frac{1}{n}\mathop \sum \limits_{j = 1}^{n} dist_{i, j} \\ Pseudotime\,of\,cell\,i &amp; = \frac{{D_{i} - Min\left( D \right) }}{Max\left( D \right) - Min\left( D \right) } \\ \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.166667em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>P</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>u</mml:mi><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.166667em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>M</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mi>D</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mfenced close=")" open="("><mml:mi>D</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>M</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:mi>D</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4054_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dist_{i, j}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq15.gif"/></alternatives></inline-formula> is the shortest distance from cell <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M38"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq16.gif"/></alternatives></inline-formula> to the cell <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M40"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq17.gif"/></alternatives></inline-formula>, cell <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M42"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq18.gif"/></alternatives></inline-formula> is a root cell, and <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M44"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq19.gif"/></alternatives></inline-formula> is the number of root cells. <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{i}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq20.gif"/></alternatives></inline-formula> is the mean distance from cell <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M48"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq21.gif"/></alternatives></inline-formula> to all root cells. <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M50"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq22.gif"/></alternatives></inline-formula> is the set of <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{i}.$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq23.gif"/></alternatives></inline-formula></p></list-item></list></p>
      <p id="Par35">The root cells needed to be defined by users, and then the pseudotime was calculated. Users could identify the cell types based on marker expression and then set the ﻿initial cells as root cells. After pseudotime estimation, all cells were reordered by pseudotime and the KNN network could be modified based on pseudotime. When the pseudotime of cell <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M54"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq24.gif"/></alternatives></inline-formula> was greater than that of cell <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M56"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq25.gif"/></alternatives></inline-formula>, the path from cell <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M58"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq26.gif"/></alternatives></inline-formula> to cell <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M60"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4054_Article_IEq27.gif"/></alternatives></inline-formula> could be accessed. To calculate the intermediate state cells, the leaf cells first needed to be defined first. The leaf cells were the terminal sites of differentiation. During the biological process, the differentiation was always multidirectional. The intermediate state cells were the cells that occurred were most likely to occur on the shortest path between the leaf cells and root cells based on the modified KNN network. Then, the leaf cells could be defined and used to estimate the intermediate state cells.</p>
      <p id="Par36">The source code and the detailed tutorial of CytoTree are all made available via our online tutorial <ext-link ext-link-type="uri" xlink:href="https://ytdai.github.io/CytoTree/index.html">https://ytdai.github.io/CytoTree/index.html</ext-link>.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <sec id="Sec9">
      <title>Overview of functionalities in CytoTree</title>
      <p id="Par37">The CytoTree package was developed as an analysis and visualization software for flow and mass cytometry data. Throughout the workflow, inputs/outputs, parameters and intermediate results are stored in an R S4 object (which we called “CYT”; Fig. <xref rid="Fig1" ref-type="fig">1</xref>). This design has two advantages, (i) it packages most computational approaches into an integrated analysis workflow, and (ii) it is convenient for users to adjust the parameters and obtain results. The main functionalities of CytoTree can be divided into four categories (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1): preprocessing, trajectory, analysis and visualization.</p>
      <sec id="Sec10">
        <title>Preprocessing</title>
        <p id="Par38">This step involves data import, compensation, quality control, filtration, normalization and sample merging. The main aim is to prepare a clean expression matrix containing only clean cytometric signaling data for CYT object creation. CytoTree provides functions to deal with a single FCS file or multiple FSC files, such as in time-course experiments.</p>
      </sec>
      <sec id="Sec11">
        <title>Trajectory</title>
        <p id="Par39">This step constructs a tree-shaped trajectory using the clean expression matrix prepared above. The first step in the trajectory part is clustering. All cells in the CYT object are grouped into clusters without supervision. CytoTree provides multiple methods for clustering, including SOM (by default), kmeans and many others. The second step is dimensionality reduction for both cells and clusters. The third step is constructing the tree that reveals subpopulation connections and cellular dynamic processes. In CytoTree, we use MST to construct the trajectory for all clusters.</p>
      </sec>
      <sec id="Sec12">
        <title>Analysis</title>
        <p id="Par40">This step is designed for feature extraction and cell state refinement. Based on the tree built above, all branches are extracted to analyze the community structure of the trajectory topologies. The differentially expressed markers in each branch are identified, which can be further used to define the subbranches. For specific analysis of FCS data, such as tracing the cell of origin during differentiation and reprogramming, the pseudotime can be estimated. CytoTree provides algorithms and functions for pseudotime estimation and intermediate state cell identification (see Methods). It can help to reconstruct the processes of cell state changes based on dynamically expressed markers and provide an in-depth understanding of the differentiation and reprogramming process.</p>
      </sec>
      <sec id="Sec13">
        <title>Visualization</title>
        <p id="Par41">This step offers various plotting functions to generate customizable and publication-quality plots. A two- or three-dimensional plot can be generated to illustrate the dimensionality reduction results, and a tree-based plot can be generated to visualize cell trajectories. Other special plots, such as heatmaps, marker density plots, specific scatterplots and violin plots, can also be generated in CytoTree for better interpretation and presentation of the data.</p>
        <p id="Par42">CytoTree provides a clear and concise workflow for dealing with cytometry data in an effective and easy-to-comprehend manner. Figure <xref rid="Fig1" ref-type="fig">1</xref> gives a graphical illustration of this workflow with the template codes included, while Fig. <xref rid="Fig2" ref-type="fig">2</xref> summarizes the analysis workflow of CytoTree. After the CYT object was created, we integrated the most populated clustering method into CytoTree to make the analysis workflow more complete. Generally, the SOM clustering method is recommended, for better performance in precision, coherence, and stability than other unsupervised tools by Liu et al. [<xref ref-type="bibr" rid="CR33">33</xref>] and Weber et al. [<xref ref-type="bibr" rid="CR34">34</xref>] and also is recommended in the mass cytometry workflow [<xref ref-type="bibr" rid="CR21">21</xref>]. At the dimensionality reduction step, it is recommended to perform cluster-dependent downsampling (if the cell number &gt; 100,000) to reduce the computational runtime and speed up visual optimization. The trajectory is built from dimensionality reduction coordinates, allowing users to interpret the data by building the tree-shaped trajectory. If the trajectory constructed by the default parameters does not reflect the known biological process, CytoTree also provides the optimization step via parameter adjustment (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Users can construct the trajectory based on the expression matrix or by using the coordinates generated by the four dimensionality reduction, namely PCA, tSNE, diffusion maps and UMAP (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3A, Fig. S3B). The default option is using the SOM clustering method and using the expression matrix. The performance of the tree-shaped trajectory calculated by different compensations of the clustering methods and dimensionality reduction methods was different (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3B). The way of choosing the trajectory was based on two baselines: (i) whether the trajectory fits the real biological progress, and (ii) whether the tendency of the trajectory was maintained, which was determined by trying more combinations of the parameters of the cluster numbers, cluster methods, and dimensionality reduction methods. After the trajectory was built, the pseudotime estimation and intermediate state analysis could be performed for better interpretation of the biological process.<fig id="Fig2"><label>Fig. 2</label><caption><p>Summary of the analysis workflow of CytoTree. Summary of the CytoTree workflow for constructing the tree-shaped trajectory and performing pseudotime estimation and intermediate analysis. One single FCS file or multiple FCS files can be read and used to build the CYT object. The procedures of clustering, dimensionality reduction and the construction of tree-shaped trajectories can be run step by step. The optimization of the trajectory is an optional step consisting of the different combinations of clustering methods and dimensionality reduction methods. After that, we can define root cells and estimate the pseudotime, and then perform intermediate state analysis</p></caption><graphic xlink:href="12859_2021_4054_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par43">To demonstrate the practical utility of these functionalities in CytoTree, we introduce three use cases: (i) constructing a trajectory from single-cell mass cytometry data to recapitulate the human hematopoietic differentiation hierarchy, (ii) using the constructed trajectory to further analyze marker expression changes in different cell lineages during differentiation, and (iii) constructing the trajectory construction from time-course flow cytometry data to interpret the induced differentiation process of HUES9 cells.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Use case 1. Identification of cellular subpopulations and construction of the trajectory to recapitulate the human hematopoietic differentiation hierarchy</title>
      <p id="Par44">Through this case, in addition to demonstrating the power of cellular subpopulation identification and trajectory construction, we also intended to show two advantages of CytoTree: (1) the ability for data visualization and interpretation, and (2) the convenient and efficient workflow for cellular subpopulation analysis. To do this, we used a 13-marker panel mass cytometry dataset obtained from healthy human bone marrow cells [<xref ref-type="bibr" rid="CR23">23</xref>]. As the hematopoietic differentiation hierarchy model represents a developmental relationship of the hematopoietic cells that reside in the bone marrow, the aim of this use case was to identify the cellular subpopulations and construct a tree-shaped trajectory, which could reveal the human hematopoietic differentiation hierarchy using the 13-marker panel mass cytometry data. According to the classical hematopoietic model, hematopoietic stem cells (HSCs) are at the apex of the hematopoietic hierarchy and can replicate themselves and produce precursors of various blood cell lineages [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>], such as megakaryocytes, erythrocytes, monocytes, granulocytes, B cells and T cells (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). In this use case, the raw FCS file was read and normalized using CytoTree. The raw FCS file contained 236,187 cells in total. After reading the FCS file and performing clustering by SOM, cluster-dependent downsampling was performed and only 10% of the cells were kept for further analysis and tSNE to build the tree-shaped trajectory and identify the cell types in different branches (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). According to the marker expression of each cluster, the cell type and differential lineage could be identified based on the trajectory (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). By using the tree plot of the trajectory, hematopoietic stem/progenitor cells (HSPCs, including HSCs and progenitor cells) could be identified by the expression of the marker combination CD45<sup>+</sup>CD34<sup>+</sup>CD3<sup>−</sup>CD19<sup>−</sup> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c, d). Branch analysis revealed two different lineages of hematopoietic cells according to the trajectory: lymphoid lineage cells, including T cells and B cells and myeloid lineage cells, including monocytes and granulocytes, megakaryocytes and erythrocytes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). In the lymphoid lineage branch, the subpopulations of the T-cell lineage, including CD4 T cells and CD8 T cells, showed the characteristic markers CD45<sup>+</sup>CD3<sup>+</sup> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). Regarding other lymphoid cells, the surface markers of B cells were CD45<sup>+</sup>CD3<sup>−</sup>CD19<sup>+</sup>CD20<sup>+</sup>. In addition to the B-cell branch, a small branch with high CD123 expression indicated the dendritic cells. For the myeloid lineage branch, monocytes and granulocytes showed the characteristic markers CD45<sup>+</sup>CD3<sup>−</sup>CD19<sup>−</sup>CD33<sup>+</sup>CD11b<sup>+</sup>, and megakaryocytes and erythrocytes were negative for these markers (CD45<sup>−</sup>CD45RA<sup>−</sup>) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). In summary, we used CytoTree to identify hematopoietic cellular subpopulations and to construct a tree-shaped trajectory, recapitulating relationships that are consistent with the classical hematopoietic hierarchy model.<fig id="Fig3"><label>Fig. 3</label><caption><p>Analysis of mass cytometry data to identify the hematopoietic differentiation hierarchy. <bold>a</bold> Known hematopoietic hierarchy in the healthy human bone marrow. Hematopoietic stem cells (HSCs) are at the apex of the hematopoietic hierarchy and can produce progenitor cells, such as multipotent progenitors (MPPs), common myeloid progenitors (CMPs) and common lymphoid progenitors (CLPs). CLPs can give rise to T-lineage cells and B-lineage cells. CMPs can differentiate into either megakaryocyte-erythroid progenitors (MEPs) or granulocyte–macrophage progenitors (GMPs). MEPs can further differentiate into megakaryocytes and erythrocytes, whereas GMPs will become monocytes and granulocytes. <bold>b</bold> Workflow of constructing the tree-shaped trajectory using the 13-panel mass cytometry data. Raw FCS files were read using CytoTree. SOM clustering was performed using all cells. The cells were downsampled in a cluster-dependent fashion. The clusters of all cells were linked by MST to illustrate the differentiation relationship based on the <italic>n</italic>-dimensional hull after dimensionality reduction. <bold>c</bold> Tree plot with putative cell subpopulations annotated manually in yellow circles. The tree plot was constructed using 13 cell surface antigens present in healthy human bone marrow and revealed the hematopoietic differentiation lineages. The color of each cluster represents the branches identified. <bold>d</bold> Expression markers of CD4, CD8, CD11b, CD19, CD20, CD33, CD34, CD38, CD45, CD45RA, and CD123 expression markers are overlaid on the tree plot. The expression levels of the markers in each cluster were calculated by SOM clustering. These markers were used for the clustering to help define the different cell lineages</p></caption><graphic xlink:href="12859_2021_4054_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec15">
      <title>Use case 2. Analysis of marker expression to illustrate the dynamic process of cell lineage differentiation</title>
      <p id="Par45">Through this case, by using a workflow including the progress of pseudotime estimation and intermediate state identification, we illustrate the framework for heterogeneity-based cytology experiments using CytoTree and show two advantages: (1) pseudotime estimation is applicable, and (2) cells in the intermediate state reveal key markers during differentiation. HSCs are at the apex of the hematopoietic trajectory, and their differentiation is multidirectional [<xref ref-type="bibr" rid="CR35">35</xref>]. For differentiation-based research, reconstructing lineage relationships and studying the dynamic process during differentiation are important. To infer the cells of origin of different blood cell lineages from a tree-shaped differentiation trajectory, the times of all cells were deconformed and rebuilt, which is also called pseudotime estimation. In this use case, we used the same dataset from use case 1 above to estimate the pseudotime for mass cytometry data and to trace the origins of cells according to the trajectory. Based on the tree-shaped trajectory, we first defined HSPCs as root cells according to the classical hematopoietic differentiation hierarchy model [<xref ref-type="bibr" rid="CR35">35</xref>]; they were placed in the middle and surrounded by various blood cell lineages (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Based on the results of the pseudotime estimation, the cells that were closer to the HSPCs had earlier pseudotime (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). According to the distribution of the pseudotime of all blood cell lineages, HSPCs had the earliest pseudotime, whereas dendritic cells, monocytes and granulocytes, megakaryocytes and erythrocytes followed closely behind (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The lymphoid cells differentiated immediately after, and CD8 T cells were last (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). To illustrate the dynamic differentiation processes of different blood cell lineages, we set the terminal clusters of the different branches of the trajectory as the leaf cells and then used CytoTree to identify the intermediate state cells. The marker expression changes during pseudotime progression revealed the dynamic processes of the different cell lineages. For example, during the formation of B cells, the expression levels of CD19, CD20, CD45 and CD45RA were increased. During the development of CD8 T cells, the expression levels of CD8, CD45 and CD3 were increased during pseudotime progression, and for CD4 T cells, CD4, CD45 and CD3 were increased (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). For dendritic cells, CD123 was increased during differentiation (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). Monocytes and granulocytes, it showed increases in CD11b and CD45, whereas all markers of megakaryocytes and erythrocytes showed decreases (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). In summary, this use case illustrated how to calculate pseudotime and how to identify intermediate state cells using CytoTree. Overall, CD34 expression was gradually decreased and was mutually exclusive for markers such as CD4, CD8, CD19, CD20 and CD11b. Through pseudotime estimation, we could better understand the biological progression during hematopoiesis and the hypothetical marker changes occurring during the formation of different blood cell lineages. CytoTree demonstrated its advantages during the analysis of use cases 1 and 2. We used trajectory construction to reveal the hematopoietic differentiation hierarchy and then performed pseudotime estimation to reveal the differentiation stages of the blood cell lineages during hematopoiesis. Through the identification of the intermediate state cells, differences in marker expression could be used to illustrate biological changes in cells and to analyze the formation of different cell lineages.<fig id="Fig4"><label>Fig. 4</label><caption><p>Pseudotime estimation and the identification of intermediate states in the hematopoiesis of different cell lineages. <bold>a</bold> tSNE visualization of the cells in each branch. The cells are colored according to the branches identified in use case 1. <bold>b</bold> tSNE visualization of the cells according to the hematopoietic differentiation process identified in use case 1. The cells are colored according to the pseudotimes calculated in CytoTree. <bold>c</bold> Density plot of the pseudotime for different cell lineages. <bold>d</bold> Heatmap plot of the intermediate state cells along with the pseudotime progression. Each column represents a cell. The expression values of the intermediate cells of each lineage are scaled by row and visualized using the z-score</p></caption><graphic xlink:href="12859_2021_4054_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>Use case 3. Differential trajectory construction using time-course flow cytometry data</title>
      <p id="Par46">In this case, by illustrating the usage of differential trajectory reconstruction of time-course FCS data, CytoTree shows two advantages: (1) the ability to reveal real induced differentiation progress with the tree-shaped trajectory, and (2) the ability to reveal biological changes and cells of origin via the analysis of differential experiments. This use case also provides a framework for time-course cytometric data analysis and could provide support for research on stem cell reprogramming. In this case, we used a flow cytometry dataset of ten-day hematopoietic differentiation from the hESC line HUES9 on the basis of some modifications of the previous work [<xref ref-type="bibr" rid="CR37">37</xref>]. By adding different cytokines on different days, HUES9 cells (cells on Day 0, D0) were directionally differentiated. Mesodermal cells (D4), hemogenic endothelial cells and hematopoietic stem/progenitor cells (HSPCs, cells generated on D8) were generated from HUES9 cells in succession (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). Ten cell surface markers (CD90, CD49f, FLK1, CD34, CD31, CD73, CD43, CD45, CD45RA, and CD38) were used for flow cytometry analysis to monitor the generation of these cells. In particular, the initial expression of CD31 and CD43 at D6 and D8, respectively, reflected the emergence of endothelial cells and the endothelial-to-hematopoietic transition (EHT) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). The aim of this use case was to reconstruct the cellular differentiation trajectory of HUES9 cells and identify the cell of origin of HSPCs using CytoTree. For this use case, the FCS file for each time point was filtered and compensated independently to exclude variance caused by unstable voltages from different experiments. Manual compensation correction was performed based on isotype control. After compensation and gating, 2,000 cells from each time point were collected and merged together to build the object. By using the default parameters, 36 clusters were identified using the SOM algorithm. After processing the clusters, the time-course cytometric data were visualized and interpreted in two or three dimensions using the four dimensionality reduction methods in sequence (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6A). Based on the dimensionality reduction results, the two-dimensional UMAP visualization method obtained results that best fit the real-time biological processes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6A, Fig. S6B). In this use case, we used UMAP coordinates to build a tree-shaped trajectory through the MST (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). As both shown by both the tree-shaped trajectory and cluster-based dimensionality reduction results, the cells at each time point were gradually distributed along with the branch extension and were differentiated into two directions at the terminal state (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). Together with the marker expression for each cluster, the cells in clusters 18 and 12 showed the characteristic markers CD90<sup>+</sup>CD49f<sup>+</sup>CD34<sup>−</sup>CD43<sup>−</sup>, and the majority of the cells were on D0 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d), revealing that these clusters were HUES9 cells and were in the initial state of differentiation. Branch analysis was then performed to identify the cellular subpopulation composition, and six branches were clustered (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7A). Branch A comprised HUES9 cells, branches B and C included FLK1<sup>+</sup> mesodermal cells, and branch D comprised hemogenic endothelium expressing the markers CD34<sup>+</sup>CD31<sup>+</sup>CD43<sup>−</sup>. At the end of the trajectory, the clusters were divided into two different branches, branches E and F (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7A, Fig. S7B); one branch was characterized by the markers CD31<sup>+</sup>CD34<sup>+</sup>CD43<sup>+</sup>CD49f<sup>−</sup>, and the other branch expressed the markers CD31<sup>+</sup>CD34<sup>+</sup>CD43<sup>+</sup>CD49f<sup>+</sup>. The two branches showed the characteristic markers of hematopoietic progenitor cells (HPCs, CD49f<sup>−</sup>) and hematopoietic stem cells (HSCs, CD49f<sup>+</sup>) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7B). This result was consistent with our previously induced hematopoietic differential model of HUES9 cells and suggested CD49f as a determining factor for the terminus of differentiation [<xref ref-type="bibr" rid="CR38">38</xref>] (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d). In summary, by constructing the induced differentiation trajectory of HUES9 cells using CytoTree, this use case demonstrates the utility of CytoTree for investigating cell-to-cell heterogeneity during induced differentiation.<fig id="Fig5"><label>Fig. 5</label><caption><p>Analysis of time-course flow cytometry data reveals the induced differentiation process. <bold>a</bold> Experimental workflow and kinetics of CD43 and CD31 expression during the hematopoietic differentiation of HUES9 cells from D0 to D10. HUES9 cells were directionally differentiated into mesodermal cells (D4, cells with flattened shapes), hemogenic endothelium (D6, cells with squamous shapes) and HSPCs (cells in red) in succession. <bold>b</bold> UMAP visualization of the merged cells from the hematopoietic differentiation process. Cells are colored according to the time point from D0 to D10. <bold>c</bold> Construction of the hematopoietic differentiation trajectory based on UMAP coordinates using MST. <bold>d</bold> CD31, CD34, CD43, CD49f and CD90 expression markers are overlaid. <bold>e</bold> UMAP visualization of cells according to the hematopoietic differentiation process. Cells are colored according to the pseudotime. <bold>f</bold> Differentiation tree colored according to pseudotime. The cluster color is scaled to the mean value of the pseudotime for the cells within each cluster. <bold>g</bold> Density plot of the pseudotime for different differentiation days. <bold>h</bold> Heatmap of marker expression along with pseudotime progression. Each column represents a cell. The expression values are scaled by row and visualized using the z-score</p></caption><graphic xlink:href="12859_2021_4054_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par47">After completing the cellular subpopulation identification and differentiation lineage reconstruction, a subpopulation of cells could be identified as root cells that were almost at the origin on D0 and had a marker composition similar to that of hESCs according to prior knowledge (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d). We estimated the pseudotime by considering the cells in cluster 15 as root cells (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). After the pseudotime for each cell was calculated, the pseudotime distribution was found to be consistent with the UMAP visualization plot and remained consistent with the real-time change (Fig. <xref rid="Fig5" ref-type="fig">5</xref>e–g). By analyzing the correlation between the pseudotime and marker expression, we observed that CD45RA, CD43, CD34 and CD31 were increased and CD90 was decreased, whereas FLK1 increased at first and then decreased during pseudotime progression (Fig. <xref rid="Fig5" ref-type="fig">5</xref>h, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8). In summary, this use case illustrates how to construct the trajectory and calculate the pseudotime using time-course FCS data. Through pseudotime estimation, we could better understand the biological changes occurring during the induced differentiation of cells and reveal which types of markers or cells might play the most important roles in this process.</p>
    </sec>
    <sec id="Sec17">
      <title>Comparison to other software tools and workflows used for flow and mass cytometry data analysis</title>
      <p id="Par48">We compared the functionalities between CytoTree and other commonly used software packages and workflows including OpenCyto [<xref ref-type="bibr" rid="CR11">11</xref>], MetaCyto [<xref ref-type="bibr" rid="CR39">39</xref>], FlowIO [<xref ref-type="bibr" rid="CR40">40</xref>], FlowCal [<xref ref-type="bibr" rid="CR41">41</xref>], AutoGate [<xref ref-type="bibr" rid="CR42">42</xref>], cytofkit [<xref ref-type="bibr" rid="CR14">14</xref>], diffcyt [<xref ref-type="bibr" rid="CR28">28</xref>], CytoSOM (<ext-link ext-link-type="uri" xlink:href="https://github.com/gautierstoll/CytoSOM">https://github.com/gautierstoll/CytoSOM</ext-link>) and CyTOF workflow [<xref ref-type="bibr" rid="CR21">21</xref>] (Table <xref rid="Tab1" ref-type="table">1</xref>). In preprocessing, all methods support the filtration, concatenation and normalization of FCS data. For the clustering, CytoTree has integrates the greatest number of clustering methods. To calculate the features of the clusters, both the CyTOF workflow [<xref ref-type="bibr" rid="CR21">21</xref>] and CytoTree provided a clustering processing step to select the features of the clusters identified in the previous step. After constructing the tree-shaped trajectory, CytoTree provides unsupervised clustering on the clusters to define branches. For the dimensionality reduction procedure, four methods are integrated into CytoTree workflow, and these methods have been widely used in current single-cell analysis workflows. In these packages and workflows, the CyTOF workflow and CytoTree integrated the UMAP method. In addition, cytofkit [<xref ref-type="bibr" rid="CR14">14</xref>], CyTOF workflow and CytoTree provided functions to perform cluster-based downsampling to avoid mistakenly dropping small clusters. Unlike other tools and workflows, CytoSOM and CytoTree provided functions to construct a tree-shaped trajectory based on MST. CytoTree also provided functions to optimize the tree, e.g. constructing the trajectory using different dimensionality reduction coordinates. Of special note is that for time-course data analysis, CytoTree provides pseudotime estimation to analyze the experimental data obtained during induced differentiation as well as functions to determine the intermediate state cells and to identify their expression characteristics. Thus, CytoTree provides a complete analysis workflow for flow and mass cytometry data based on a variety of methods used in other software tools and workflows, and it also integrates algorithms to estimate the pseudotime and to define the intermediate state cells according to time-course data. In summary, CytoTree is a competitive workflow that can comprehensively analyze flow and mass cytometry data, featuring user-defined parameters and styles in the construction of tree-shaped trajectories and pseudotime estimation.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison between other tools and workflows and CytoTree</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Computational modules</th><th align="left">Functions</th><th align="left">OpenCyto</th><th align="left">MetaCyto</th><th align="left">FlowIO</th><th align="left">FlowCal</th><th align="left">AutoGate</th><th align="left">cytofkit</th><th align="left">diffcyt</th><th align="left">CytoSOM</th><th align="left">CyTOF workflow</th><th align="left">CytoTree</th></tr></thead><tbody><tr><td align="left" rowspan="4">Preprocessing</td><td align="left">Denisty plot</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left"/><td align="left"/><td align="left">√</td><td align="left">√</td></tr><tr><td align="left">Gating</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left"/><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td></tr><tr><td align="left">Concatenation</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td></tr><tr><td align="left">Normalization</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td></tr><tr><td align="left" rowspan="5">Clustering</td><td align="left">SOM</td><td align="left"/><td align="left">√</td><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td></tr><tr><td align="left">kmeans</td><td align="left"/><td align="left">√</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td><td align="left">√</td></tr><tr><td align="left">clara</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td></tr><tr><td align="left">PhenoGraph</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td><td align="left"/><td align="left"/><td align="left">√</td><td align="left">√</td></tr><tr><td align="left">hclust</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td></tr><tr><td align="left" rowspan="3">Processing clusters and branches</td><td align="left">Downsampling</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td><td align="left"/><td align="left"/><td align="left">√</td><td align="left">√</td></tr><tr><td align="left">DR-clusters</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td><td align="left"/><td align="left">√</td><td align="left"/><td align="left">√</td><td align="left">√</td></tr><tr><td align="left">Diff-exp</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td><td align="left"/><td align="left">√</td><td align="left">√</td><td align="left">√</td><td align="left">√</td></tr><tr><td align="left" rowspan="4">Dimensionality reduction</td><td align="left">PCA</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td><td align="left"/><td align="left"/><td align="left">√</td><td align="left">√</td></tr><tr><td align="left">tSNE</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td><td align="left"/><td align="left"/><td align="left">√</td><td align="left">√</td></tr><tr><td align="left">Diff-maps</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td></tr><tr><td align="left">UMAP</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td><td align="left">√</td></tr><tr><td align="left">Trajectory</td><td align="left">Tree</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td><td align="left"/><td align="left">√</td></tr><tr><td align="left" rowspan="2">Analysis</td><td align="left">Pseudotime</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td></tr><tr><td align="left">Inter-state</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">√</td></tr></tbody></table><table-wrap-foot><p><italic>DR-clusters</italic> dimensionality reduction for clusters, <italic>diff-maps</italic> diffusion maps, <italic>diff-exp</italic> differentially expressed markers, <italic>inter-state</italic> intermediate state analysis</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec18">
      <title>Computational scalability and analysis framework of CytoTree</title>
      <p id="Par49">In terms of computational scalability, CytoTree has been developed as a lightweight software package and can process workflows involving as many as 20,000 cells and 13 markers in less than 10 min on a MacBook platform with 8 Gb of RAM and a 2.7 GHz Dual-Core Intel Core i5. To improve the runtime and performance of CytoTree, we tested a series of simulated data with different cell numbers and marker numbers (Table <xref rid="Tab2" ref-type="table">2</xref>). The simulation tests were performed on a LINUX platform with a 56-core Intel(R) Xeon(R) CPU E5-2695 v3 @ 2.30 GHz with 512-GB RAM. Only one thread was used when running the tests. CytoTree can handle up hundreds of thousands of cells in all computational parts. It took a great amount of time for dimensionality reduction, such as running tSNE, obtaining diffusion maps, and performing UMAP (Table <xref rid="Tab2" ref-type="table">2</xref>), but the dimensionality reduction step is optional. For example, when the cell number was 100,000, it took more than an hour to complete all processes. Without running this optional step, it would take less than ten minutes.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Running time of different functions in CytoTree with different cell numbers and marker numbers</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Functions in CytoTree</th><th align="left">C 1*10<sup>3</sup><break/>M 10</th><th align="left">C 1*10<sup>3</sup><break/>M 50</th><th align="left">C 1*10<sup>4</sup><break/>M 10</th><th align="left">C 1*10<sup>4</sup><break/>M 50</th><th align="left">C 5*10<sup>4</sup><break/>M: 10</th><th align="left">C 5*10<sup>4</sup><break/>M 50</th><th align="left">C 1*10<sup>5</sup><break/>M 10</th><th align="left">C 1*10<sup>5</sup><break/>M 50</th><th align="left">C 5*10<sup>5</sup><break/>M 10</th><th align="left">C 5*10<sup>5</sup><break/>M 50</th></tr></thead><tbody><tr><td align="left">createCYT</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">2s</td><td align="left">2s</td><td align="left">2s</td></tr><tr><td align="left">runCluster</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">2s</td><td align="left">2s</td><td align="left">2s</td><td align="left">4s</td><td align="left">5s</td><td align="left">16s</td></tr><tr><td align="left">processingCluster</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">2s</td><td align="left">2s</td><td align="left">2s</td><td align="left">2s</td><td align="left">2s</td><td align="left">2s</td></tr><tr><td align="left">runFastPCA*</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">2s</td><td align="left">2s</td><td align="left">2s</td><td align="left">3s</td><td align="left">9s</td><td align="left">13s</td></tr><tr><td align="left">runTSNE*</td><td align="left">4s</td><td align="left">4s</td><td align="left">7s</td><td align="left">1m35s</td><td align="left">5m54s</td><td align="left">13m22s</td><td align="left">13m52s</td><td align="left">36m30s</td><td align="left">2h11m19s</td><td align="left">10h57m17s</td></tr><tr><td align="left">runDiffusionMap*</td><td align="left">1s</td><td align="left">2s</td><td align="left">21s</td><td align="left">36s</td><td align="left">8m8s</td><td align="left">18m42s</td><td align="left">36m54s</td><td align="left">1h35m15s</td><td align="left">16h16m33s</td><td align="left">&gt; 2 days</td></tr><tr><td align="left">runUMAP*</td><td align="left">5s</td><td align="left">7s</td><td align="left">1m32s</td><td align="left">2m32s</td><td align="left">9m17s</td><td align="left">20m28s</td><td align="left">21m35s</td><td align="left">51m46s</td><td align="left">2h17m28s</td><td align="left">7h57m58s</td></tr><tr><td align="left">buildTree</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">2s</td><td align="left">2s</td><td align="left">2s</td><td align="left">2s</td><td align="left">4s</td><td align="left">8s</td></tr><tr><td align="left">defRootCells</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">2s</td><td align="left">2s</td></tr><tr><td align="left">runPseudotime</td><td align="left">1s</td><td align="left">1s</td><td align="left">9s</td><td align="left">13s</td><td align="left">3m17s</td><td align="left">6m25s</td><td align="left">5m46s</td><td align="left">17m9s</td><td align="left">12m41s</td><td align="left">2h58m21s</td></tr><tr><td align="left">defLeafCells</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">1s</td><td align="left">2s</td><td align="left">2s</td></tr><tr><td align="left">runWalk</td><td align="left">1s</td><td align="left">1s</td><td align="left">7s</td><td align="left">7s</td><td align="left">2m1s</td><td align="left">1m48s</td><td align="left">2m1s</td><td align="left">1m51s</td><td align="left">2m18s</td><td align="left">2m30s</td></tr><tr><td align="left">Total time (all steps)</td><td align="left">19s</td><td align="left">22s</td><td align="left">2m23s</td><td align="left">5m10s</td><td align="left">28m48s</td><td align="left">1h56s</td><td align="left">1h20m19s</td><td align="left">3h22m46s</td><td align="left">21h45s</td><td align="left">&gt; 3 days</td></tr></tbody></table><table-wrap-foot><p><italic>C</italic> cell number, <italic>M</italic> marker number, <italic>3h22m46s</italic> 3 hours 22 minutes and 46 seconds. Functions with * were optional steps, which are not the necessary steps in the CytoTree workflow. Calculation of total time contains all steps, including the optional steps</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion</title>
    <p id="Par50">CytoTree was capable of performing clustering, dimensionality reduction, trajectory inference and pseudotime estimation, which collectively forming an integrated workflow for flow and mass cytometry data analysis. During the analysis of time-course flow cytometry data in use case 3, batch effects in FCS data are usually caused by unstable voltages and different experimental environments or instruments. To minimize the impact of batch effects, we collected a cell sample at a specific time every two days to ensure that the interval times between each time point were equal and performed manual compensation correction based on the isotype control. However, the batch effect was unavoidable. Effective and appropriate methods to correct for the batch effect in flow and mass cytometry data are still needed. Therefore, it is recommended to perform batch effect correction in the preprocessing step prior to building the CYT object. Using a clean matrix instead of raw FCS files as input data can increase the expansibility of CytoTree.</p>
    <p id="Par51">In the dimensionality reduction procedure, the expression matrix was used for the tSNE and UMAP calculations, which is different from scRNA-seq analysis software such as Seurat [<xref ref-type="bibr" rid="CR5">5</xref>] and Monocle [<xref ref-type="bibr" rid="CR6">6</xref>]. This design is motivated by the fact that the number of markers of mass cytometry data is much less than that of scRNA-seq. There are several public trajectory inference strategies for single-cell data, such as PAGA Tree [<xref ref-type="bibr" rid="CR43">43</xref>], Wanderlust [<xref ref-type="bibr" rid="CR20">20</xref>], Wishbone [<xref ref-type="bibr" rid="CR44">44</xref>], SCUBA [<xref ref-type="bibr" rid="CR45">45</xref>], and SCOUP [<xref ref-type="bibr" rid="CR46">46</xref>]. According to the benchmarking of different trajectory inference strategies for single-cell data [<xref ref-type="bibr" rid="CR8">8</xref>], the MST algorithm proved to be a valuable tree construction method that can quickly construct a trajectory depending on the topology of the clusters. CytoTree can perform trajectory construction quickly and simply using MST. Moreover, we present several prevailing methods from clustering to dimensionality reduction. The topology of a trajectory is mainly based on the interrelation of cell clusters, coordinates and dimensions. Therefore, the robustness of the trajectory largely depends on construction methods. CytoTree is flexible in trajectory inference, and provides an optimization step. Trajectory inference through MST according to dimensionality reduction coordinates has been proven to be capable of reproducing known hematopoietic differentiation trajectories (use case 1) and reconstructing a differential trajectory (use case 3). The choice of the tree-shaped trajectory is however still led by biological characteristics and user preferences. Through multiple parameter combinations and adjustments, various options are available for constructing a tree, and users can choose the options that best suit the biological characteristics under study.</p>
  </sec>
  <sec id="Sec20">
    <title>Conclusion</title>
    <p id="Par52">In summary, our comprehensive analysis using both flow and mass cytometry data suggests that CytoTree is flexible in terms of trajectory construction. As the use cases illustrated the utility of CytoTree in facilitating time-course flow cytometry data analysis, CytoTree may be used to better interpret multidimensional single-cell cytometric data in an integrated analysis workflow. We believe that CytoTree can be a valuable tool for applications ranging from clustering and dimensionality reduction to trajectory inference and pseudotime estimation for flow and mass cytometry data analysis.</p>
  </sec>
  <sec id="Sec21">
    <title>Availability and implementation</title>
    <p id="Par53">Project name: CytoTree.</p>
    <p id="Par54">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/JhuangLab/CytoTree">https://github.com/JhuangLab/CytoTree</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/CytoTree/">https://bioconductor.org/packages/CytoTree/</ext-link>.</p>
    <p id="Par55">Project tutorial page: <ext-link ext-link-type="uri" xlink:href="https://ytdai.github.io/CytoTree/index.html">https://ytdai.github.io/CytoTree/index.html</ext-link>.</p>
    <p id="Par56">Archived version: 1.0.3.</p>
    <p id="Par57">Operating system(s): Platform independent.</p>
    <p id="Par58">Programming language: R.</p>
    <p id="Par59">Other requirements: None.</p>
    <p id="Par60">License: GPL-3.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec22">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4054_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary figures of CytoTree.<bold> Figure S1</bold>–<bold>S8</bold>.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>SOM</term>
        <def>
          <p id="Par4">Self-organizing maps</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p id="Par5">Principal component analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>t-SNE</term>
        <def>
          <p id="Par6">T-distributed stochastic neighbor embedding</p>
        </def>
      </def-item>
      <def-item>
        <term>UMAP</term>
        <def>
          <p id="Par7">Uniform manifold approximation and projection</p>
        </def>
      </def-item>
      <def-item>
        <term>FCS</term>
        <def>
          <p id="Par8">Flow cytometry standard</p>
        </def>
      </def-item>
      <def-item>
        <term>MST</term>
        <def>
          <p id="Par9">Minimum spanning tree</p>
        </def>
      </def-item>
      <def-item>
        <term>hESC</term>
        <def>
          <p id="Par10">Human embryonic stem cell</p>
        </def>
      </def-item>
      <def-item>
        <term>HSC</term>
        <def>
          <p id="Par11">Hematopoietic stem cell</p>
        </def>
      </def-item>
      <def-item>
        <term>MPP</term>
        <def>
          <p id="Par12">Multipotent progenitor</p>
        </def>
      </def-item>
      <def-item>
        <term>CMP</term>
        <def>
          <p id="Par13">Common myeloid progenitor</p>
        </def>
      </def-item>
      <def-item>
        <term>CLP</term>
        <def>
          <p id="Par14">Common lymphoid progenitor</p>
        </def>
      </def-item>
      <def-item>
        <term>GMP</term>
        <def>
          <p id="Par15">Granulocyte–macrophage progenitor</p>
        </def>
      </def-item>
      <def-item>
        <term>HSPC</term>
        <def>
          <p id="Par16">Hematopoietic stem/progenitor cell</p>
        </def>
      </def-item>
      <def-item>
        <term>HPC</term>
        <def>
          <p id="Par17">Hematopoietic progenitor cell</p>
        </def>
      </def-item>
      <def-item>
        <term>EHT</term>
        <def>
          <p id="Par18">Endothelial-to-hematopoietic transition</p>
        </def>
      </def-item>
      <def-item>
        <term>KNN</term>
        <def>
          <p id="Par19">K-nearest neighbours</p>
        </def>
      </def-item>
      <def-item>
        <term>DC</term>
        <def>
          <p id="Par20">Diffusion component</p>
        </def>
      </def-item>
      <def-item>
        <term>FMO</term>
        <def>
          <p id="Par21">Fluorescence minus one</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Yuting Dai and Aining Xu contributed equally to this work</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the Center for High Performance Computing of Shanghai Jiao Tong University for providing computing support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>YD, JH and XS conceived and designed the study. YD designed and implemented CytoTree pseudotime and trajectory algorithm with the help of JH. AX provided the time-course flow cytometry dataset. YD and AX performed the data analysis and manual gating of flow cytometry data. JL, LW and SY performed the software testing. JH, XS, JC and WZ supervised the overall study. YD wrote the major of manuscript and JH, XS, JC and WZ revised the paper. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the National Key Research and Development Plan of China Grants (No. 2018YFA0107802), the National Natural Science Foundation of China (NSFC) General Program (Nos. 81570122, 81670094, 81770205, 81830007), the National Key Research and Development Program (No. 2016YFC0902800), and the Shanghai Municipal Education Commission-Gaofeng Clinical Medicine Grant Support (No. 20161303), Shanghai Rising-Star Program (20QC1400100), Shanghai Collaborative Innovation Program on Regenerative Medicine and Stem Cell Research (No. 2019CXJQ01), Mayo Clinic Center for Individualized Medicine. We thank the Center for High Performance Computing of Shanghai Jiao Tong University for providing computing support.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets generated and/or analysed during the current study are available in the GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/JhuangLab/CytoTree-dataset">https://github.com/JhuangLab/CytoTree-dataset</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par61">The authors have declared no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spitzer</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Mass cytometry: single cells, many features</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <issue>4</issue>
        <fpage>780</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.04.019</pub-id>
        <?supplied-pmid 27153492?>
        <pub-id pub-id-type="pmid">27153492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olsen</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Leipold</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Maecker</surname>
            <given-names>HT</given-names>
          </name>
        </person-group>
        <article-title>The anatomy of single cell mass cytometry data</article-title>
        <source>Cytometry A</source>
        <year>2019</year>
        <volume>95</volume>
        <issue>2</issue>
        <fpage>156</fpage>
        <lpage>172</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23621</pub-id>
        <?supplied-pmid 30277658?>
        <pub-id pub-id-type="pmid">30277658</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Standardization, calibration, and control in flow cytometry</article-title>
        <source>Curr Protoc Cytom</source>
        <year>2017</year>
        <volume>79</volume>
        <issue>1</issue>
        <fpage>1.3.1</fpage>
        <lpage>1.3.27</lpage>
        <pub-id pub-id-type="pmid">28055116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chattopadhyay</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Winters</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Lomas</surname>
            <given-names>WE</given-names>
            <suffix>3rd</suffix>
          </name>
          <name>
            <surname>Laino</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Woods</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>High-parameter single-cell analysis</article-title>
        <source>Annu Rev Anal Chem (Palo Alto Calif)</source>
        <year>2019</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>411</fpage>
        <lpage>430</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-anchem-061417-125927</pub-id>
        <pub-id pub-id-type="pmid">30699035</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id>
        <?supplied-pmid 29608179?>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cacchiarelli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grimsby</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pokharel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Morse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Livak</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>4</issue>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id>
        <?supplied-pmid 24658644?>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>359</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4644</pub-id>
        <?supplied-pmid 29608555?>
        <pub-id pub-id-type="pmid">29608555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saelens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cannoodt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Todorov</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A comparison of single-cell trajectory inference methods</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>5</issue>
        <fpage>547</fpage>
        <lpage>554</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id>
        <?supplied-pmid 30936559?>
        <pub-id pub-id-type="pmid">30936559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Buttner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Diffusion pseudotime robustly reconstructs lineage branching</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>845</fpage>
        <lpage>848</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3971</pub-id>
        <?supplied-pmid 27571553?>
        <pub-id pub-id-type="pmid">27571553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hahne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>LeMeur</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Haaland</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sarkar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Spidlen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Strain</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>flowCore: a Bioconductor package for high throughput flow cytometry</article-title>
        <source>BMC Bioinform</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>106</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-106</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Frelinger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Newell</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Ramey</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Kalams</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>De Rosa</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>OpenCyto: an open source infrastructure for scalable, robust, reproducible, and automated, end-to-end flow cytometry data analysis</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>8</issue>
        <fpage>e1003806</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003806</pub-id>
        <?supplied-pmid 25167361?>
        <pub-id pub-id-type="pmid">25167361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Callebaut</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Van Helden</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Lambrecht</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Demeester</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dhaene</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>FlowSOM: using self-organizing maps for visualization and interpretation of cytometry data</article-title>
        <source>Cytometry A</source>
        <year>2015</year>
        <volume>87</volume>
        <issue>7</issue>
        <fpage>636</fpage>
        <lpage>645</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22625</pub-id>
        <?supplied-pmid 25573116?>
        <pub-id pub-id-type="pmid">25573116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Simonds</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Bendall</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>KD</given-names>
            <suffix>Jr</suffix>
          </name>
          <name>
            <surname>Bruggner</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Linderman</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Sachs</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Plevritis</surname>
            <given-names>SK</given-names>
          </name>
        </person-group>
        <article-title>Extracting a cellular hierarchy from high-dimensional cytometry data with SPADE</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <issue>10</issue>
        <fpage>886</fpage>
        <lpage>891</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1991</pub-id>
        <?supplied-pmid 21964415?>
        <pub-id pub-id-type="pmid">21964415</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Newell</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Poidinger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Cytofkit: a bioconductor package for an integrated mass cytometry data analysis pipeline</article-title>
        <source>PLoS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>9</issue>
        <fpage>e1005112</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005112</pub-id>
        <?supplied-pmid 27662185?>
        <pub-id pub-id-type="pmid">27662185</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimball</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Oko</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Bullock</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Nemenoff</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>van Dyk</surname>
            <given-names>LF</given-names>
          </name>
          <name>
            <surname>Clambey</surname>
            <given-names>ET</given-names>
          </name>
        </person-group>
        <article-title>A beginner's guide to analyzing and visualizing mass cytometry data</article-title>
        <source>J Immunol</source>
        <year>2018</year>
        <volume>200</volume>
        <issue>1</issue>
        <fpage>3</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.1701494</pub-id>
        <?supplied-pmid 29255085?>
        <pub-id pub-id-type="pmid">29255085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amir</surname>
            <given-names>E-D</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Tadmor</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Simonds</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Bendall</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Shenfeld</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Krishnaswamy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Pe'er D (2013) viSNE enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>31</volume>
        <issue>6</issue>
        <fpage>545</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2594</pub-id>
        <?supplied-pmid 4076922?>
        <pub-id pub-id-type="pmid">23685480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Diffusion maps for high-dimensional single-cell analysis of differentiation data</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>18</issue>
        <fpage>2989</fpage>
        <lpage>2998</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv325</pub-id>
        <?supplied-pmid 26002886?>
        <pub-id pub-id-type="pmid">26002886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becht</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McInnes</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dutertre</surname>
            <given-names>C-A</given-names>
          </name>
          <name>
            <surname>Kwok</surname>
            <given-names>IWH</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>LG</given-names>
          </name>
          <name>
            <surname>Ginhoux</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Newell</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>37</volume>
        <issue>1</issue>
        <fpage>38</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sarkar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Le Meur</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Using flowViz to visualize flow cytometry data</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>6</issue>
        <fpage>878</fpage>
        <lpage>879</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn021</pub-id>
        <?supplied-pmid 18245128?>
        <pub-id pub-id-type="pmid">18245128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bendall</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>el Amir</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Tadmor</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Simonds</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Shenfeld</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Pe'er</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>157</volume>
        <issue>3</issue>
        <fpage>714</fpage>
        <lpage>725</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.04.005</pub-id>
        <?supplied-pmid 24766814?>
        <pub-id pub-id-type="pmid">24766814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nowicka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Krieg</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Crowell</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Guglietta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Becher</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Levesque</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>CyTOF workflow: differential discovery in high-throughput high-dimensional cytometry datasets</article-title>
        <source>F1000Research</source>
        <year>2019</year>
        <volume>6</volume>
        <fpage>748</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.11622.3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spidlen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Breuer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kotecha</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>FlowRepository: a resource of annotated flow cytometry datasets associated with peer-reviewed publications</article-title>
        <source>Cytometry A</source>
        <year>2012</year>
        <volume>81</volume>
        <issue>9</issue>
        <fpage>727</fpage>
        <lpage>731</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22106</pub-id>
        <?supplied-pmid 22887982?>
        <pub-id pub-id-type="pmid">22887982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bendall</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Simonds</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>el Amir</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Krutzik</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Finck</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bruggner</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Melamed</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Trejo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ornatsky</surname>
            <given-names>OI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mass cytometry of differential immune and drug responses across a human hematopoietic continuum</article-title>
        <source>Science</source>
        <year>2011</year>
        <volume>332</volume>
        <issue>6030</issue>
        <fpage>687</fpage>
        <lpage>696</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1198704</pub-id>
        <?supplied-pmid 21551058?>
        <pub-id pub-id-type="pmid">21551058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herring</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Banerjee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McKinley</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Ping</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roland</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Franklin</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Gerdes</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Coffey</surname>
            <given-names>RJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unsupervised trajectory analysis of single-cell RNA-Seq and imaging data reveals alternative tuft cell origins in the gut</article-title>
        <source>Cell Syst</source>
        <year>2018</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>37</fpage>
        <lpage>51 e39</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2017.10.012</pub-id>
        <?supplied-pmid 29153838?>
        <pub-id pub-id-type="pmid">29153838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>The sva package for removing batch effects and other unwanted variation in high-throughput experiments</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>6</issue>
        <fpage>882</fpage>
        <lpage>883</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts034</pub-id>
        <?supplied-pmid 22257669?>
        <pub-id pub-id-type="pmid">22257669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aghaeepour</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nikolic</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hoos</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Rapid cell population identification in flow cytometry data</article-title>
        <source>Cytometry A</source>
        <year>2011</year>
        <volume>79</volume>
        <issue>1</issue>
        <fpage>6</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.21007</pub-id>
        <?supplied-pmid 21182178?>
        <pub-id pub-id-type="pmid">21182178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>7</issue>
        <fpage>e47</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id>
        <?supplied-pmid 4402510?>
        <pub-id pub-id-type="pmid">25605792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Nowicka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>diffcyt: Differential discovery in high-dimensional cytometry via high-resolution clustering</article-title>
        <source>Commun Biol</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>183</fpage>
        <pub-id pub-id-type="doi">10.1038/s42003-019-0415-5</pub-id>
        <?supplied-pmid 31098416?>
        <pub-id pub-id-type="pmid">31098416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Spielmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mundlos</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Christiansen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Steemers</surname>
            <given-names>FJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>566</volume>
        <issue>7745</issue>
        <fpage>496</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-0969-x</pub-id>
        <?supplied-pmid 30787437?>
        <pub-id pub-id-type="pmid">30787437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Riesenfeld</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
        </person-group>
        <article-title>Single-cell reconstruction of developmental trajectories during zebrafish embryogenesis</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>360</volume>
        <issue>6392</issue>
        <fpage>eaar3131</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aar3131</pub-id>
        <?supplied-pmid 29700225?>
        <pub-id pub-id-type="pmid">29700225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Costa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Grun</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>GraphDDP: a graph-embedding approach to detect differentiation pathways in single-cell-data using prior class knowledge</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>3685</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-05988-7</pub-id>
        <?supplied-pmid 30206223?>
        <pub-id pub-id-type="pmid">30206223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liaw</surname>
            <given-names>Y-C</given-names>
          </name>
          <name>
            <surname>Leou</surname>
            <given-names>M-L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>C-M</given-names>
          </name>
        </person-group>
        <article-title>Fast exact k nearest neighbors search using an orthogonal search tree</article-title>
        <source>Pattern Recogn</source>
        <year>2010</year>
        <volume>43</volume>
        <issue>6</issue>
        <fpage>2351</fpage>
        <lpage>2358</lpage>
        <pub-id pub-id-type="doi">10.1016/j.patcog.2010.01.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>BY</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>GN</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>A comparison framework and guideline of clustering methods for mass cytometry data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>297</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1917-7</pub-id>
        <?supplied-pmid 31870419?>
        <pub-id pub-id-type="pmid">31870419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Comparison of clustering methods for high-dimensional single-cell flow and mass cytometry data</article-title>
        <source>Cytometry A</source>
        <year>2016</year>
        <volume>89</volume>
        <issue>12</issue>
        <fpage>1084</fpage>
        <lpage>1096</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23030</pub-id>
        <?supplied-pmid 27992111?>
        <pub-id pub-id-type="pmid">27992111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doulatov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Notta</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Laurenti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dick</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>Hematopoiesis: a human perspective</article-title>
        <source>Cell Stem Cell</source>
        <year>2012</year>
        <volume>10</volume>
        <issue>2</issue>
        <fpage>120</fpage>
        <lpage>136</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2012.01.006</pub-id>
        <?supplied-pmid 22305562?>
        <pub-id pub-id-type="pmid">22305562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laurenti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gottgens</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>From haematopoietic stem cells to complex differentiation landscapes</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>553</volume>
        <issue>7689</issue>
        <fpage>418</fpage>
        <lpage>426</lpage>
        <pub-id pub-id-type="doi">10.1038/nature25022</pub-id>
        <?supplied-pmid 29364285?>
        <pub-id pub-id-type="pmid">29364285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lv</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TGFbeta inhibition enhances the generation of hematopoietic progenitors from human ES cell-derived hemogenic endothelial cells using a stepwise strategy</article-title>
        <source>Cell Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>194</fpage>
        <lpage>207</lpage>
        <pub-id pub-id-type="doi">10.1038/cr.2011.138</pub-id>
        <?supplied-pmid 21862970?>
        <pub-id pub-id-type="pmid">21862970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>A-N</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>Y-T</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>C-L</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>C-H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y-L</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Y-Y</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Q-H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential expression of CD49f discriminates the independently emerged hematopoietic stem cells and erythroid-biased progenitors</article-title>
        <source>Blood</source>
        <year>2019</year>
        <volume>134</volume>
        <issue>Supplement_1</issue>
        <fpage>3700</fpage>
        <lpage>3701</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2019-130429</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jujjavarapu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hughey</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Andorf</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Gherardini</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Spitzer</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MetaCyto: a tool for automated meta-analysis of mass and flow cytometry data</article-title>
        <source>Cell Rep</source>
        <year>2018</year>
        <volume>24</volume>
        <issue>5</issue>
        <fpage>1377</fpage>
        <lpage>1388</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2018.07.003</pub-id>
        <?supplied-pmid 30067990?>
        <pub-id pub-id-type="pmid">30067990</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koblizek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lebedeva</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fiser</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>flowIO: flow cytometry standard conformance testing, editing, and export tool</article-title>
        <source>Cytometry A</source>
        <year>2018</year>
        <volume>93</volume>
        <issue>8</issue>
        <fpage>848</fpage>
        <lpage>853</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23563</pub-id>
        <?supplied-pmid 30110138?>
        <pub-id pub-id-type="pmid">30110138</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castillo-Hair</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Sexton</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Landry</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Igoshin</surname>
            <given-names>OA</given-names>
          </name>
          <name>
            <surname>Tabor</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>FlowCal: a user-friendly, open source software tool for automatically converting flow cytometry data from arbitrary to calibrated units</article-title>
        <source>ACS Synth Biol</source>
        <year>2016</year>
        <volume>5</volume>
        <issue>7</issue>
        <fpage>774</fpage>
        <lpage>780</lpage>
        <pub-id pub-id-type="doi">10.1021/acssynbio.5b00284</pub-id>
        <?supplied-pmid 27110723?>
        <pub-id pub-id-type="pmid">27110723</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meehan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kolyagin</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Parks</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Youngyunpipatkul</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Herzenberg</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Walther</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ghosn</surname>
            <given-names>EEB</given-names>
          </name>
          <name>
            <surname>Orlova</surname>
            <given-names>DY</given-names>
          </name>
        </person-group>
        <article-title>Automated subset identification and characterization pipeline for multidimensional flow and mass cytometry data clustering and visualization</article-title>
        <source>Commun Biol</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>229</fpage>
        <pub-id pub-id-type="doi">10.1038/s42003-019-0467-6</pub-id>
        <?supplied-pmid 31240267?>
        <pub-id pub-id-type="pmid">31240267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Hamey</surname>
            <given-names>FK</given-names>
          </name>
          <name>
            <surname>Plass</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Solana</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dahlin</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Gottgens</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rajewsky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>59</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1663-x</pub-id>
        <?supplied-pmid 30890159?>
        <pub-id pub-id-type="pmid">30890159</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Setty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tadmor</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Reich-Zeliger</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Angel</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Salame</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Kathail</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bendall</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pe'er</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Wishbone identifies bifurcating developmental trajectories from single-cell data</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <issue>6</issue>
        <fpage>637</fpage>
        <lpage>645</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3569</pub-id>
        <?supplied-pmid 27136076?>
        <pub-id pub-id-type="pmid">27136076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marco</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Karp</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Robson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hart</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Trippa</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <article-title>Bifurcation analysis of single-cell gene expression data reveals epigenetic landscape</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>52</issue>
        <fpage>E5643</fpage>
        <lpage>5650</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1408993111</pub-id>
        <?supplied-pmid 25512504?>
        <pub-id pub-id-type="pmid">25512504</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsumoto</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kiryu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>SCOUP: a probabilistic model based on the Ornstein–Uhlenbeck process to analyze single-cell expression data during differentiation</article-title>
        <source>BMC Bioinform</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>232</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1109-3</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
