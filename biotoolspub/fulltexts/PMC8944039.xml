<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8944039</article-id>
    <article-id pub-id-type="publisher-id">4633</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04633-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Single cell lineage reconstruction using distance-based algorithms and the R package, DCLEAR</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gong</surname>
          <given-names>Wuming</given-names>
        </name>
        <address>
          <email>gongx030@umn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Hyunwoo J.</given-names>
        </name>
        <address>
          <email>hyunwoojkim@korea.ac.kr</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Garry</surname>
          <given-names>Daniel J.</given-names>
        </name>
        <address>
          <email>garry@umn.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7117-7669</contrib-id>
        <name>
          <surname>Kwak</surname>
          <given-names>Il-Youp</given-names>
        </name>
        <address>
          <email>ikwak2@cau.ac.kr</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.17635.36</institution-id><institution-id institution-id-type="ISNI">0000000419368657</institution-id><institution>Lillehei Heart Institute, </institution><institution>University of Minnesota, </institution></institution-wrap>Minneapolis, USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.222754.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 0840 2678</institution-id><institution>Department of Computer Science and Engineering, </institution><institution>Korea University, </institution></institution-wrap>Seoul, Republic of Korea </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.254224.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0789 9563</institution-id><institution>Department of Applied Statistics, </institution><institution>Chung-Ang University, </institution></institution-wrap>Seoul, Republic of Korea </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>103</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">DCLEAR is an R package used for single cell lineage reconstruction. The advances of CRISPR-based gene editing technologies have enabled the prediction of cell lineage trees based on observed edited barcodes from each cell. However, the performance of existing reconstruction methods of cell lineage trees was not accessed until recently. In response to this problem, the Allen Institute hosted the Cell Lineage Reconstruction Dream Challenge in 2020 to crowdsource relevant knowledge from across the world. Our team won sub-challenges 2 and 3 in the challenge competition.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">The DCLEAR package contained the R codes, which was submitted in response to sub-challenges 2 and 3. Our method consists of two steps: (1) distance matrix estimation and (2) the tree reconstruction from the distance matrix. We proposed two novel methods for distance matrix estimation as outlined in the DCLEAR package. Using our method, we find that two of the more sophisticated distance methods display a substantially improved level of performance compared to the traditional Hamming distance method. DCLEAR is open source and freely available from R CRAN and from under the GNU General Public License, version 3.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">DCLEAR is a powerful resource for single cell lineage reconstruction.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Cell lineage tracing</kwd>
      <kwd>Lineage reconstruction</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Simulation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003725</institution-id>
            <institution>National Research Foundation of Korea</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2020R1C1C1A01013020</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kwak</surname>
            <given-names>Il-Youp</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par17">A multicellular organism or animal develops from one to two to four to an exponential number of cells. One of the challenges is the ability to predict the lineage tree representing the cell differentiation process starting from the single parental cell, based on cells extracted from the adult body. McKenna et al. [<xref ref-type="bibr" rid="CR1">1</xref>] used gene editing technology and the immune system (CRISPR-CAS9) as the basis for proposing a methodology called GESTALT for estimating a cell-level lineage tree using the data generated using CRISPR-CAS9 barcode edits from each cell. Subsequently, Raj et al. [<xref ref-type="bibr" rid="CR2">2</xref>] proposed scGESTALT, which further considers cell type identification as an extension of GESTALT. Researchers have developed a number of additional CRISPR recorder-based technologies [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par18">This field lacked experimentation or analyses regarding the effectiveness of these proposed algorithms for comprehensive evaluation. To improve the evaluation process, the Allen Institute established The Cell Lineage Reconstruction DREAM Challenge [<xref ref-type="bibr" rid="CR6">6</xref>]. The Allen Institute proposed three different sub-challenges to benchmark reconstruction algorithms of cell lineage trees: (1) the reconstruction of in vitro cell lineages of 76 trees with fewer than 100 cells; (2) the reconstruction of an in silico cell lineage tree of 1000 cells; (3) the reconstruction of an in silico cell lineage tree of 10,000 cells. Our proposed <italic>DCLEAR</italic> method won sub-challenges 2 and 3 of this challenge competition.</p>
    <p id="Par19">We outline and define the problem setting addressed in cell lineage reconstruction in the next section. We then present two core methods for distance matrix construction and outline how <italic>DCLEAR</italic> software may be applied to a simulated dataset.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Problem setup</title>
      <p id="Par20">Assume we have <italic>n</italic> number of training data pairs. Each data pair consists of a set of cell sequences and a true cell lineage tree. One example of such a pair is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>a</bold> is the observed set of cell sequences, and <bold>b</bold> is the cell lineage tree. The goal is to predict the cell lineage tree in (<bold>b</bold>) using the cell sequences in (<bold>a</bold>)</p></caption><graphic xlink:href="12859_2022_4633_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par21">For the <italic>i</italic>th data pair, let <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_i$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq1.gif"/></alternatives></inline-formula> be the number of cell sequences in the <italic>i</italic>th data pair and let <italic>t</italic> be the sequence length. Let the sequence information in data pair <italic>i</italic> be written as <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C^i$$\end{document}</tex-math><mml:math id="M4"><mml:msup><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq2.gif"/></alternatives></inline-formula>, an <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_i\times t$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq3.gif"/></alternatives></inline-formula> matrix. The matrix element <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C^i_{jk}$$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq4.gif"/></alternatives></inline-formula> describes the <italic>j</italic>th sequence and the <italic>k</italic>th letter of the <italic>i</italic>th training data pair. Furthermore, we represent <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq5.gif"/></alternatives></inline-formula>, the cell lineage tree structure, in the form of a Newick format string.</p>
      <p id="Par22">For example, if Fig. <xref rid="Fig1" ref-type="fig">1</xref> represents <italic>i</italic>th data pair, (a) shows the sequence information. It has <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_i=4$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq6.gif"/></alternatives></inline-formula> cell sequences, each sequence length has a length (<italic>t</italic>) of 10, and the first letter of the 3rd sequence is <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C^i_{3,1}=\text {E}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>E</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq7.gif"/></alternatives></inline-formula>. The cell lineage tree is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b. In Newick format, <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i = ((1:0.5,2:0.5):2,(3:1.2,4:1):2)$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>:</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo>:</mml:mo><mml:mn>1.2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>:</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq8.gif"/></alternatives></inline-formula>.</p>
      <p id="Par23">We built our model (<inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m(C;{\hat{\theta }})$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq9.gif"/></alternatives></inline-formula>) with <italic>n</italic> training pairs. The input matrix, <italic>C</italic> is an <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_i\times t$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq10.gif"/></alternatives></inline-formula> sequence information matrix. The output is the Newick format string representing the tree structure while <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M22"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq11.gif"/></alternatives></inline-formula> represents the parameter set related to model <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m(C;\theta )$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq12.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\theta }}$$\end{document}</tex-math><mml:math id="M26"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq13.gif"/></alternatives></inline-formula> represents the estimated parameter with <italic>n</italic> training data pairs.</p>
      <p id="Par24">To evaluate the model, we have <italic>l</italic> number of unused data. The loss is indicated as <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(m(C^i;{\hat{\theta }}), L_i)$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq14.gif"/></alternatives></inline-formula>. The loss increases when the predicted tree structure (<inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m(C;{\hat{\theta }})$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq15.gif"/></alternatives></inline-formula>) differs from the true tree structure (<inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq16.gif"/></alternatives></inline-formula>). We use the averaged loss metric (<italic>AL</italic>) defined below to evaluate the model <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m(C;{\hat{\theta }})$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq17.gif"/></alternatives></inline-formula>.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} AL = \frac{\sum _{i=1}^{l} L(m(C^i;{\hat{\theta }}), L_i)}{l}. \end{aligned}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4633_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>Next, we need to define the quantity <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(L_1, L_2)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq18.gif"/></alternatives></inline-formula> that represents the dissimilarity between the two lineage trees, <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_1$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_2$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq20.gif"/></alternatives></inline-formula>. The two widely used measures of this dissimilarity are the Robinson–Foulds (RF) distance [<xref ref-type="bibr" rid="CR7">7</xref>] and the Triplet distance [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
      <p id="Par25">Figure <xref rid="Fig2" ref-type="fig">2</xref> represents two lineage trees, <inline-formula id="IEq23"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_1$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_2$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq24.gif"/></alternatives></inline-formula>. The possible separations for tree 1 are <inline-formula id="IEq25"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,2\}, \{3,4,5\}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,2,5\}, \{3,4\}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq26.gif"/></alternatives></inline-formula>, and the possible separations for tree 2 are <inline-formula id="IEq27"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,2\}, \{3,4,5\}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq27.gif"/></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,2,3\}, \{4,5\}$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq28.gif"/></alternatives></inline-formula>. Among the four possible separations, <inline-formula id="IEq29"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,2\}, \{3,4,5\}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq29.gif"/></alternatives></inline-formula> in tree 1 and tree 2 are concordant separations. The RF distance is defined as the total number of concordant separations divided by the total number of separations. As an example: the RF score for Figure <xref rid="Fig2" ref-type="fig">2</xref> is 2/4 = 0.5.<fig id="Fig2"><label>Fig. 2</label><caption><p>Two different trees, <bold>a</bold>
<inline-formula id="IEq21"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_1$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq21.gif"/></alternatives></inline-formula> and <bold>b</bold>
<inline-formula id="IEq22"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_2$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq22.gif"/></alternatives></inline-formula>, are presented to explain how the RF and triplet distances are defined. There are two possible cuts for each tree to separate items in the tree with two different sets of more than two items. The red slanted lines represent the possible cuts for separation</p></caption><graphic xlink:href="12859_2022_4633_Fig2_HTML" id="MO3"/></fig></p>
      <p id="Par26">For triplet distance calculations, we sample three items among all items in the tree. We determine <inline-formula id="IEq30"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_5C_3=10$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mrow/><mml:mn>5</mml:mn></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq30.gif"/></alternatives></inline-formula> possible cases. We check whether the tree structure of the three items in tree 1 and tree 2 are the same. For example, the five cases of <inline-formula id="IEq31"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,2,3\}, \{1,2,4\}, \{1,2,5\}, \{1,4,5\}$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq31.gif"/></alternatives></inline-formula> and <inline-formula id="IEq32"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{2,4,5\}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq32.gif"/></alternatives></inline-formula> have the same tree structure in both tree 1 and tree 2. The triplet score is defined as the number of cases with the same tree structure divided by the number of possible cases. Accordingly, the triplet score for our example is 5/10 = 0.5.</p>
      <p id="Par27">We will use <inline-formula id="IEq33"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AL_{RF}$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi>A</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RF</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq33.gif"/></alternatives></inline-formula> to denote the RF distance and <inline-formula id="IEq34"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$AL_{TP}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>A</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq34.gif"/></alternatives></inline-formula> to denote the triplet distance.</p>
    </sec>
    <sec id="Sec4">
      <title>Overview of the modeling architecture</title>
      <p id="Par28">The two main issues that need to be answered in the lineage reconstruction problem are (1) how should the model <inline-formula id="IEq35"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m(C;\theta )$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq35.gif"/></alternatives></inline-formula> be built and (2) how should <inline-formula id="IEq36"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\theta }}$$\end{document}</tex-math><mml:math id="M74"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq36.gif"/></alternatives></inline-formula> be estimated? Our modeling architecture for <inline-formula id="IEq37"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m(C;\theta )$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq37.gif"/></alternatives></inline-formula> is described in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. We divide the model into two parts: (1) estimating the distance between cells and (2) constructing a tree using a distance matrix. Let <italic>D</italic>(<italic>C</italic>) be a function for estimating the distance matrix for an <inline-formula id="IEq38"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m \times t$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq38.gif"/></alternatives></inline-formula> input sequence matrix, <italic>C</italic>, and let <italic>t</italic>(<italic>D</italic>) be a function for predicting the lineage tree for an <inline-formula id="IEq39"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m \times m$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq39.gif"/></alternatives></inline-formula> distance matrix, <italic>D</italic>. Note that a knowledge of the triangular components in <italic>D</italic> is sufficient for defining the distance matrix. Subsequently, the challenge becomes how <inline-formula id="IEq40"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D(\cdot )$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t(\cdot )$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq41.gif"/></alternatives></inline-formula> should be defined.<fig id="Fig3"><label>Fig. 3</label><caption><p>Overview of our modeling architecture. Our model function <inline-formula id="IEq42"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m(C;\theta )$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq42.gif"/></alternatives></inline-formula> is divided into two parts: (1) estimating the distance between cells and (2) constructing a tree using the distance matrix</p></caption><graphic xlink:href="12859_2022_4633_Fig3_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Choice of distance</title>
      <p id="Par29">One notion for calculating the distance is to define the distance function for the two sequences. Let <inline-formula id="IEq43"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(C_{i\cdot }, C_{j\cdot }; \theta )=d_{ij}$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq43.gif"/></alternatives></inline-formula> be the calculated distance between the <italic>i</italic>th cell and the <italic>j</italic>th cell obtained from the given cell information matrix <italic>C</italic>. The quantities <inline-formula id="IEq44"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{i\cdot }, i = 1,\cdots ,m$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq44.gif"/></alternatives></inline-formula> represent the <italic>i</italic>th cell vector taken from <italic>C</italic>. The quantity <inline-formula id="IEq45"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{ij}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq45.gif"/></alternatives></inline-formula> is the (<italic>i</italic>, <italic>j</italic>)th element of the cell distance matrix <italic>D</italic>. The next challenge becomes how <inline-formula id="IEq46"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(\cdot , \cdot )$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq46.gif"/></alternatives></inline-formula> should be defined.</p>
      <sec id="Sec6">
        <title>Hamming distance method</title>
        <p id="Par30">One naive approach to modeling <inline-formula id="IEq47"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(\cdot , \cdot )$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq47.gif"/></alternatives></inline-formula> is to compute the Hamming distance expressed in equation (<xref rid="Equ2" ref-type="">2</xref>):<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d_H(C_{i\cdot }, C_{j\cdot }) = \sum _{l=1}^{t} 1(C_{il}\ne C_{jl}), \end{aligned}$$\end{document}</tex-math><mml:math id="M98" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4633_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq48"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1{(\text {condition})}$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>condition</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq48.gif"/></alternatives></inline-formula> is an indicator function with a value of 1 if the given condition is true and 0 otherwise. Note that the Hamming distance <inline-formula id="IEq49"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_H(C_{i\cdot }, C_{j\cdot })$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq49.gif"/></alternatives></inline-formula> simply counts unit differences between the two sequences <inline-formula id="IEq50"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{i\cdot }$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq50.gif"/></alternatives></inline-formula> and <inline-formula id="IEq51"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{j\cdot }$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq51.gif"/></alternatives></inline-formula>.</p>
        <p id="Par31">The simple calculation of the Hamming distance does not meet the challenges of the present study. Consider the cell differentiation process illustrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. Let the 2nd and the 3rd leaf cells (dotted) have <inline-formula id="IEq52"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{2\cdot } = \text {0AB-0}$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>0AB-0</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq52.gif"/></alternatives></inline-formula> and <inline-formula id="IEq53"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{3\cdot }= \text {00CB0}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>00CB0</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq53.gif"/></alternatives></inline-formula>. The corresponding Hamming distance is <inline-formula id="IEq54"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_H(C_{2\cdot }, C_{3\cdot }) = 3$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq54.gif"/></alternatives></inline-formula>. However, it is not reasonable to assign equal weights to each target position. This deficiency is addressed by the weighted Hamming approach described in the following sub-sub-section.<fig id="Fig4"><label>Fig. 4</label><caption><p>Example of cell differentiation process</p></caption><graphic xlink:href="12859_2022_4633_Fig4_HTML" id="MO6"/></fig></p>
        <p id="Par32">The code for using the Hamming distance method is available from the <italic>phangorn</italic> package [<xref ref-type="bibr" rid="CR9">9</xref>] using the dist.hamming function.</p>
      </sec>
      <sec id="Sec7">
        <title>Weighted Hamming distance (WHD) method</title>
        <p id="Par33">An example of the cell diffusion process is illustrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. Consider the objective of reconstructing the lineage tree based on information about the leaf nodes. What would be an appropriate measure for calculating the distance between 0AB-0 and 00CB0 (see the dotted circles in Fig. <xref rid="Fig4" ref-type="fig">4</xref>)? The character difference between ‘A’ and ‘0’ would be less than the character difference between ‘B’ and ‘C’ as the initial state ‘0’ can be differentiated to ‘A’ or to any other outcome states, whereas states ‘B’ and ‘C’ cannot be differentiated to other outcome states. In addition, the missing state ’-’ maybe any other state. Seeking a mathematical formula to accommodate these nuances, we propose the weighted Hamming distance (WHD) method:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d_{WH1}(C_{i\cdot }, C_{j\cdot }) = \sum _{l=1}^{t} w_{C_{il}}w_{C_{jl}}1(C_{il}\ne C_{jl}), \end{aligned}$$\end{document}</tex-math><mml:math id="M114" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4633_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where, <inline-formula id="IEq55"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{il}$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq55.gif"/></alternatives></inline-formula> is the <italic>l</italic>th character in the <italic>i</italic>th cell sequence, and <inline-formula id="IEq56"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{C_{il}}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>w</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq56.gif"/></alternatives></inline-formula> is a weight associated with the character <inline-formula id="IEq57"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{il}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq57.gif"/></alternatives></inline-formula>. The code for calculating the WHD method is available as the dist_weighted_hamming function in the <italic>DCLEAR</italic> package. For the estimation of weight parameters, we used Bayesian hyperparameter optimization using the BayesianOptimization function in the <italic>rBayesianOptimization</italic> package [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
      </sec>
      <sec id="Sec8">
        <title>k-mer replacement distance (KRD) method</title>
        <p id="Par34">The algorithm used to compute the k-mer replacement distance (KRD) method first uses the prominence of mutations in the character arrays to estimate the summary statistics used for the generation of the tree to be reconstructed. These statistics include the mutation rate, the mutation probability for each character in the array, the number of targets, and the number of cells. These estimated parameters were combined with pre-defined parameters, such as the number of cell divisions, to simulate multiple lineage trees starting from the non-mutated root. To generate trees with sizes and mutation distributions similar to the target tree, we generated 1000 lineage trees, each with 16 cell divisions of 216 leaves, a mutation rate of 0.1, arrays of 200 characters, 200 cells, and 30 states (‘A’-‘Z’ to ‘a’-‘c’, with an outcome probability following a Gamma distribution with a shape of 0.1 and a rate of 2). Different possibilities for the k-mer distance method were then estimated from the simulated lineage trees and used to compute the distances between the input sequences in the character arrays of internal nodes and tips. The KRD method is available from the <italic>DCLEAR</italic> package using the dist_replacement function.</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>Tree construction</title>
      <p id="Par35">We use existing methods such as Neighbor-Joining (NJ), UPGMA, and FastMe [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref>] for tree construction from the estimated distance matrix, <italic>D</italic>. The NJ method is implemented as the nj function in the Analysis of Phylogenetics and Evolution (<italic>ape</italic>) package, UPGMA is implemented as the upgma function in the <italic>phangorn</italic> package, and FastMe is implemented as fastme.bal, and fastme.ols in the <italic>ape</italic> package.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Results</title>
    <p id="Par36">This section reports the experimental results of applying the Hamming distance, WHD, and KRD methods using existing tree construction methods (NJ, UPGMA, and FastMe). For the use of NJ, UPGMA, and FastMe, the nj function in the <italic>ape</italic> package [<xref ref-type="bibr" rid="CR14">14</xref>] was used for the NJ method, the upgma function in the <italic>phangorn</italic> package [<xref ref-type="bibr" rid="CR9">9</xref>] was used for the UPGMA method, the fastme.ols function in the <italic>ape</italic> was used for the FastMe method, and the fastme.bal function in the <italic>ape</italic> was used for FastMe with tree rearrangement.</p>
    <sec id="Sec11">
      <title>Datasets</title>
      <sec id="Sec12">
        <title>Simulation dataset</title>
        <p id="Par37">The simulation dataset was generated from our simulation code. Parameter settings for the simulation were as follows: <list list-type="order"><list-item><p id="Par38">Number of targets: 50, 100, and 200</p></list-item><list-item><p id="Par39">Mutation probability: 0.02, 0.04, 0.06, 0.08, and 0.1</p></list-item><list-item><p id="Par40">Number of cells: 100</p></list-item><list-item><p id="Par41">Dropout probability: 0, 0.05, and 0.1</p></list-item><list-item><p id="Par42">Number of cell division: 16</p></list-item><list-item><p id="Par43">Existance of point deletion: True, False</p></list-item></list>We iterated all 90 combinations (<inline-formula id="IEq58"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3 \times 5 \times 3 \times 2$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq58.gif"/></alternatives></inline-formula>) of the parameter 5 times, result in 450 simulation datasets. For each iteration, We generated five training sets and one evaluation set. The averaged performance of the 450 evaluation sets was reported.</p>
      </sec>
      <sec id="Sec13">
        <title>Sub-challenge 2 and 3 datasets</title>
        <p id="Par44">The sub-challenge 2 and 3 datasets can be downloaded from the competition website of the Allen Institute Cell Lineage Reconstruction Challenge at <ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#%21Synapse:syn20692755">https://www.synapse.org/#!Synapse:syn20692755</ext-link> (accessed on 17 September 2021). The sub-challenge 2 dataset (the dataset for C.elegans cells) contained a 1000 cell tree from the 200 mutated/non-mutated targets in each cell induced by simulation, and the sub-challenge 3 dataset (the dataset for mouse cells) had a 10,000 cell tree from the 1000 mutated/non-mutated targets in each cell induced by simulation. The different simulation models were used for sub-challenges 2 and 3. Both datasets had 100 trees. We randomly divided the sub-challenge dataset into 75 trees for training and 25 trees for evaluation.</p>
      </sec>
      <sec id="Sec14">
        <title>Experimental results</title>
        <p id="Par45">We outlined our experimental results in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. The y-axis represented the RF distance, and the x-axis accommodated the different models. The Hamming distance, the KRD, and the WHD methods were used for distance calculation. NJ, UPGMA, and FastMe were methods for tree construction. For all three datasets, the KRD and the WHD methods displayed improved performance compared to the Hamming distance method. The performance achieved with the KRD was similar to that achieved with WHD. Among the tree construction methods, FastMe with tree rearrangement displayed improved performance compared to the other tree construction methods.<fig id="Fig5"><label>Fig. 5</label><caption><p>Experimental result</p></caption><graphic xlink:href="12859_2022_4633_Fig5_HTML" id="MO8"/></fig></p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Discussion</title>
    <p id="Par46">In these experiments, we only compared the Hamming distance, the WHD, and the KRD methods using the three datasets. Gong et al. [<xref ref-type="bibr" rid="CR6">6</xref>] presented the comparison of the WHD and the KRD with the other methods that participated in the Cell Lineage Reconstruction Dream Challenge (2020). Our proposed WHD method was used for sub-challenge 3, and the KRD method was used for sub-challenge 2. DCLEAR won both sub-challenges 2 and 3 but did not participate in sub-challenge 1. The sub-challenge 1 dataset has only ten target positions with two outcome states. The WHD and KRD methods were more powerful techniques with more complex settings, such as the existence of a dropout interval, the existence of missing target positions, and a larger number of outcome states. With the small target positions and the small outcome states of sub-challenge 1, the gain achieved by using the WHD and the KRD methods was not high. We were not able to show a comparison for sub-challenge 1 as DCLEAR did not participate in that sub-challenge. Thus, the future work of DCLEAR will contain an extension of the WHD and the KRD methods with small target and small outcome settings. Furthermore, for the WHD method, the hyperparameter tuning was performed using BayesianOptimization because the loss was not differentiable with respect to weight parameters. We could utilize the surrogate loss to address this non-differentiable loss [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
  </sec>
  <sec id="Sec16">
    <title>Conclusions</title>
    <p id="Par47"><italic>DCLEAR</italic> is a powerful resource for single cell lineage reconstruction.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec17">
        <title>Appendix</title>
        <sec id="Sec18">
          <title>Simulating trees with barcodes</title>
          <p id="Par51">For a simple illustration of lineage reconstruction, we simulated data using the sim_seqdata function in the <italic>DCLEAR</italic> package coded using the <italic>R</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] language. The sim_n parameter represented the number of cell samples. The prob_state parameter represented the cell state probability. The parameter m represented the number of targets. The parameter n_s represented the number of outcome states which equals the length quantified by prob_state. The parameter mu_d represented the mutation probability for each target position on every cell division. The parameter d represented the number of cell divisions. Finally, the parameter p_d represented the dropout probability of each target position for every cell division. The code is outlined below:</p>
          <graphic position="anchor" xlink:href="12859_2022_4633_Figa_HTML" id="MO9"/>
          <p id="Par52">With this code, we generate a lineage tree of 20 leaf barcodes with 10 target positions. The sD$seqs contains the sequence information, and the sD$tree has the true tree structure:</p>
          <graphic position="anchor" xlink:href="12859_2022_4633_Figb_HTML" id="MO10"/>
          <p id="Par53">We can also print character information of the simulated barcodes.</p>
          <graphic position="anchor" xlink:href="12859_2022_4633_Figc_HTML" id="MO11"/>
          <p id="Par54">The initial cell state is ‘0000000000’. There are <inline-formula id="IEq59"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d=12$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq59.gif"/></alternatives></inline-formula> number of cell divisions resulting in <inline-formula id="IEq60"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^{12}$$\end{document}</tex-math><mml:math id="M126"><mml:msup><mml:mn>2</mml:mn><mml:mn>12</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq60.gif"/></alternatives></inline-formula> leaf nodes. Every target position changes to a different outcome state for each cell division with a probability <inline-formula id="IEq61"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$mu\_d = 0.03$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>_</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq61.gif"/></alternatives></inline-formula>. The mutational positions randomly change to different outcomes, which follows a multinomial distribution with a probability <inline-formula id="IEq62"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p=out\_prob$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>_</mml:mi><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq62.gif"/></alternatives></inline-formula>. Every target position of leaf nodes randomly changes to a missing state (’-’) with a probability <inline-formula id="IEq63"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_d = 0.005$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq63.gif"/></alternatives></inline-formula>. Finally, <inline-formula id="IEq64"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$simn = 20$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq64.gif"/></alternatives></inline-formula> cells are randomly sampled. The true lineage tree structure of 20 cells (<inline-formula id="IEq65"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$simn = 20$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq65.gif"/></alternatives></inline-formula>) is recorded in sD$tree. The tree structure corresponding to <inline-formula id="IEq66"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$simn = 20$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4633_Article_IEq66.gif"/></alternatives></inline-formula> cells is illustrated in Fig. <xref rid="Fig6" ref-type="fig">6</xref>.<fig id="Fig6"><label>Fig. 6</label><caption><p>Tree structure of 20 leaf cells</p></caption><graphic position="anchor" xlink:href="12859_2022_4633_Fig6_HTML" id="MO12"/></fig></p>
          <p id="Par55">Subsequently, we prepared five lineage trees as a training dataset. Each lineage tree has 10 leaves with 40 barcode target positions:</p>
          <graphic position="anchor" xlink:href="12859_2022_4633_Figd_HTML" id="MO13"/>
          <p id="Par56">SDs is a list of 5 lineage trees. Each item of the SDs list is generated using sim_seqdata function:</p>
          <graphic position="anchor" xlink:href="12859_2022_4633_Fige_HTML" id="MO14"/>
          <graphic position="anchor" xlink:href="12859_2022_4633_Figf_HTML" id="MO15"/>
          <p id="Par57">The ten barcodes of the first training data are shown below.</p>
          <graphic position="anchor" xlink:href="12859_2022_4633_Figg_HTML" id="MO16"/>
          <p id="Par58">We observed interval missing (dropout) events by marking them with a sequence of hyphens. Weight parameters for the WHD method were trained using the WH_train function. We specified the weight for the initial state and the weight for the dropout state.</p>
          <p id="Par59">We printed out the state characters as indicated below:</p>
          <graphic position="anchor" xlink:href="12859_2022_4633_Figh_HTML" id="MO17"/>
          <p id="Par60">Since the initial state (‘0’) is in the first position and the dropout state (‘-’) is in the second position, we specify loc0=1 and locDroputout = 2:</p>
          <graphic position="anchor" xlink:href="12859_2022_4633_Figi_HTML" id="MO18"/>
          <p id="Par61">We simulated one evaluation datum and compared the ground truth tree with three generated trees using the Hamming, WHD, and KRD distances with the FastMe algorithm for tree construction:</p>
          <graphic position="anchor" xlink:href="12859_2022_4633_Figj_HTML" id="MO19"/>
          <p id="Par62">First, we calculated the distance matrix using the Hamming distance, the WHD, and the KRD methods:</p>
          <graphic position="anchor" xlink:href="12859_2022_4633_Figk_HTML" id="MO20"/>
          <p id="Par63">Second, we constructed the tree using the FastMe algorithm with the tree rearrangement using fastme.bal function. The ground truth tree and the three generated trees were demonstrated in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. As an alternative to fastme.bal function, we could use different tree construction algorithms using nj, upgma, and fastme.ols functions.<fig id="Fig7"><label>Fig. 7</label><caption><p>Tree structure of 10 leaf cells, as determined for various standard distance measures</p></caption><graphic position="anchor" xlink:href="12859_2022_4633_Fig7_HTML" id="MO21"/></fig></p>
          <p id="Par64">As outlined in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, it is challenging to compare and determine which generation is the optimal one. One useful metric for making a determination is the RF distance. We calculated and compared the RF distances for the various generations. The RF distances were calculated and compared as indicated below:</p>
          <graphic position="anchor" xlink:href="12859_2022_4633_Figl_HTML" id="MO22"/>
          <p id="Par65">The lower the value of the RF distance between the ground truth tree and the generated tree, the greater the similarity between the ground truth tree and the generated tree. Thus, for the given example data, the KRD method produced optimal results.</p>
        </sec>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>DCLEAR</term>
        <def>
          <p id="Par4">Distance based Cell LinEAge Reconstruction</p>
        </def>
      </def-item>
      <def-item>
        <term>CRISPR</term>
        <def>
          <p id="Par5">Clustered regularly interspaced short palindromic repeats</p>
        </def>
      </def-item>
      <def-item>
        <term>R</term>
        <def>
          <p id="Par6">Statistical Language R</p>
        </def>
      </def-item>
      <def-item>
        <term>CRAN</term>
        <def>
          <p id="Par7">Comprehensive R archive network</p>
        </def>
      </def-item>
      <def-item>
        <term>GESTALT</term>
        <def>
          <p id="Par8">Genome editing of synthetic target arrays for lineage tracing</p>
        </def>
      </def-item>
      <def-item>
        <term>scGESTALT</term>
        <def>
          <p id="Par9">An extended version of GESTALT considering single-cell RNA sequencing data</p>
        </def>
      </def-item>
      <def-item>
        <term>AL</term>
        <def>
          <p id="Par10">Averaged loss metric</p>
        </def>
      </def-item>
      <def-item>
        <term>RF</term>
        <def>
          <p id="Par11">Robinson–Foulds distance</p>
        </def>
      </def-item>
      <def-item>
        <term>WHD</term>
        <def>
          <p id="Par12">Weighted Hamming distance</p>
        </def>
      </def-item>
      <def-item>
        <term>KRD</term>
        <def>
          <p id="Par13">k-mer replacement distance</p>
        </def>
      </def-item>
      <def-item>
        <term>NJ</term>
        <def>
          <p id="Par14">Neighbor-joining</p>
        </def>
      </def-item>
      <def-item>
        <term>UPGMA</term>
        <def>
          <p id="Par15">Unweighted pair group method with arithmetic mean</p>
        </def>
      </def-item>
      <def-item>
        <term>FastMe</term>
        <def>
          <p id="Par16">Fast distance-based phylogeny inference program</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>IYK and WG participated in the design of the tool, implemented and tested the software, drafted the manuscript. HJK and DJG provided expert feedback in the design of the tool, the evaluation of the results and on the writing of the paper. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIP) (No. NRF-2020R1C1C1A01013020).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>DCLEAR is available from R cran at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/DCLEAR/index.html">https://cran.r-project.org/web/packages/DCLEAR/index.html</ext-link>, and Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/ikwak2/DCLEAR">https://github.com/ikwak2/DCLEAR</ext-link> Datasets are downlaodable from the challenge website, <ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#%21Synapse:syn20692755/wiki/">https://www.synapse.org/#!Synapse:syn20692755/wiki/</ext-link>. after agreeing the terms and conditions. The R/DCLEAR package is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License, version 3.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par48">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par49">The authors declare that they have no competing interests.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par50">Not applicable.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Findlay</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Gagnon</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Horwitz</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Whole-organism lineage tracing by combinatorial and cumulative genome editing</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>353</volume>
        <fpage>6298</fpage>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raj</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pandey</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gagnon</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous single-cell profiling of lineages and cell types in the vertebrate brain</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>442</fpage>
        <lpage>450</lpage>
        <?supplied-pmid 29608178?>
        <pub-id pub-id-type="pmid">29608178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frieda</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Linton</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Hormoz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chow</surname>
            <given-names>K-HK</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>ZS</given-names>
          </name>
          <name>
            <surname>Budde</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Elowitz</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Synthetic recording and in situ readout of lineage information in single cells</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>541</volume>
        <fpage>107</fpage>
        <lpage>111</lpage>
        <?supplied-pmid 27869821?>
        <pub-id pub-id-type="pmid">27869821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alemany</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Florescu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Baron</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Peterson-Maduro</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Whole-organism clone tracing using single-cell sequencing</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>556</volume>
        <fpage>108</fpage>
        <lpage>112</lpage>
        <pub-id pub-id-type="pmid">29590089</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Khodaverdian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Quinn</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Hussmann</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Inference of single-cell phylogenies from lineage tracing data using cassiopeia</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>92</fpage>
        <?supplied-pmid 32290857?>
        <pub-id pub-id-type="pmid">32290857</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Gong W, Granados AA, Hu J, Jones MG, Raz O, Salvador-Martínez I, Zhang H, Chow K-HK, Kwak I-Y, Retkute R, Prusokas A, Prusokas A, Khodaverdian A, Zhang R, Rao S, Wang R, Rennert P, Saipradeep VG, Sivadasan N, Rao A, Joseph T, Srinivasan R, Peng J, Han L, Shang X, Garry DJ, Yu T, Chung V, Mason M, Liu Z, Guan Y, Yosef N, Shendure J, Telford MJ, Shapiro E, Elowitz MB, Meyer P. Benchmarked approaches for reconstruction of in vitro cell lineages and in silico models of c. elegans and m. musculus developmental trees. Cell Syst. 2021. 10.1016/j.cels.2021.05.008</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math Biosci</source>
        <year>1981</year>
        <volume>53</volume>
        <issue>1</issue>
        <fpage>131</fpage>
        <lpage>147</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Dobson</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Street</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Wallis</surname>
            <given-names>WD</given-names>
          </name>
        </person-group>
        <article-title>Comparing the shapes of trees</article-title>
        <source>Combinatorial mathematics III</source>
        <year>1975</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>95</fpage>
        <lpage>100</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Schliep K, Paradis E, Martins LdO, Potts A, White TW, Stachniss C, Kendall M, Halabi K, Bilderbeek R, Winchell K, Revell L, Gilchrist M, Beaulieu J, O’Meara B, Jackman LQ. Phangorn: Phylogenetic Reconstruction and Analysis. 2015. R package version 2.5.5. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=phangorn">https://CRAN.R-project.org/package=phangorn</ext-link></mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Yan Y. rBayesianOptimization: Bayesian Optimization of Hyperparameters. 2016. R package version 1.1.0. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=rBayesianOptimization">https://CRAN.R-project.org/package=rBayesianOptimization</ext-link></mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saitou</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title>
        <source>Mol Biol Evol</source>
        <year>1987</year>
        <volume>4</volume>
        <issue>4</issue>
        <fpage>406</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="pmid">3447015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sokal</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Michener</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A statistical method for evaluating systematic relationships</article-title>
        <source>Univ Kansas Sci Bull</source>
        <year>1958</year>
        <volume>38</volume>
        <fpage>1409</fpage>
        <lpage>1438</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Desper</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gascuel</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate phylogeny reconstruction algorithms based on the minimum-evolution principle</article-title>
        <source>J Comput Biol</source>
        <year>2002</year>
        <volume>9</volume>
        <fpage>687</fpage>
        <lpage>705</lpage>
        <?supplied-pmid 12487758?>
        <pub-id pub-id-type="pmid">12487758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paradis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Claude</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>ape: Analyses of phylogenetics and evolution in R language</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>2</issue>
        <fpage>289</fpage>
        <lpage>90</lpage>
        <?supplied-pmid 14734327?>
        <pub-id pub-id-type="pmid">14734327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Grabocka J, Scholz R, Schmidt-Thieme L. Learning surrogate losses (2019). CoRR abs/1905.10108. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1905.10108">arXiv:1905.10108</ext-link></mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Team RC. R: a language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, 2017. R Foundation for Statistical Computing. <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
