<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8796379</article-id>
    <article-id pub-id-type="pmid">34734974</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab755</article-id>
    <article-id pub-id-type="publisher-id">btab755</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Peakhood: individual site context extraction for CLIP-seq peak regions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9563-4991</contrib-id>
        <name>
          <surname>Uhl</surname>
          <given-names>Michael</given-names>
        </name>
        <xref rid="btab755-cor1" ref-type="corresp"/>
        <aff><institution>Bioinformatics Group, Department of Computer Science, University of Freiburg</institution>, Freiburg im Breisgau, <country country="DE">Germany</country></aff>
        <!--uhlm@informatik.uni-freiburg.de-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6701-7753</contrib-id>
        <name>
          <surname>Rabsch</surname>
          <given-names>Dominik</given-names>
        </name>
        <aff><institution>Bioinformatics Group, Department of Computer Science, University of Freiburg</institution>, Freiburg im Breisgau, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9564-7525</contrib-id>
        <name>
          <surname>Eggenhofer</surname>
          <given-names>Florian</given-names>
        </name>
        <aff><institution>Bioinformatics Group, Department of Computer Science, University of Freiburg</institution>, Freiburg im Breisgau, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8231-3323</contrib-id>
        <name>
          <surname>Backofen</surname>
          <given-names>Rolf</given-names>
        </name>
        <xref rid="btab755-cor1" ref-type="corresp"/>
        <aff><institution>Bioinformatics Group, Department of Computer Science, University of Freiburg</institution>, Freiburg im Breisgau, <country country="DE">Germany</country></aff>
        <aff><institution>Signalling Research Centres BIOSS and CIBSS, University of Freiburg</institution>, Freiburg im Breisgau, <country country="DE">Germany</country></aff>
        <!--backofen@informatik.uni-freiburg.de-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab755-cor1">To whom correspondence should be addressed. <email>uhlm@informatik.uni-freiburg.de</email> or <email>backofen@informatik.uni-freiburg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>2</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-11-04">
      <day>04</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <volume>38</volume>
    <issue>4</issue>
    <fpage>1139</fpage>
    <lpage>1140</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>27</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>22</day>
        <month>11</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab755.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>CLIP-seq is by far the most widely used method to determine transcriptome-wide binding sites of RNA-binding proteins (RBPs). The binding site locations are identified from CLIP-seq read data by tools termed peak callers. Many RBPs bind to a spliced RNA (i.e. transcript) context, but all currently available peak callers only consider and report the genomic context. To accurately model protein binding behavior, a tool is needed for the individual context assignment to CLIP-seq peak regions.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here we present Peakhood, the first tool that utilizes CLIP-seq peak regions identified by peak callers, in tandem with CLIP-seq read information and genomic annotations, to determine which context applies, individually for each peak region. For sites assigned to transcript context, it further determines the most likely splice variant, and merges results for any number of datasets to obtain a comprehensive collection of transcript context binding sites. </p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Peakhood is freely available under MIT license at: <ext-link xlink:href="https://github.com/BackofenLab/Peakhood" ext-link-type="uri">https://github.com/BackofenLab/Peakhood</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Deutsche Forschungsgemeinschaft (DFG)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BA 2168/11-1 SPP 1738,</award-id>
        <award-id>BA2168/11-2 SPP 1738</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Bundesministerium für Bildung und Forschung (BMBF)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RNAProNet-031L0164B</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>DFG under Germany’s Excellence Strategy</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>CIBSS—EXC-2189-Project</institution>
          </institution-wrap>
        </funding-source>
        <award-id>390939984</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>CLIP-seq (cross-linking and immunoprecipitation followed by next generation sequencing) (<xref rid="btab755-B4" ref-type="bibr">Licatalosi <italic toggle="yes">et al.</italic>, 2008</xref>) is the most widely used procedure to experimentally determine the exact transcriptome-wide binding locations of RNA-binding proteins (RBPs). The most popular protocol variants are PAR-CLIP (<xref rid="btab755-B1" ref-type="bibr">Hafner <italic toggle="yes">et al.</italic>, 2010</xref>), iCLIP (<xref rid="btab755-B2" ref-type="bibr">König <italic toggle="yes">et al.</italic>, 2010</xref>) and eCLIP (<xref rid="btab755-B8" ref-type="bibr">Van Nostrand <italic toggle="yes">et al.</italic>, 2016</xref>). CLIP-seq is usually performed <italic toggle="yes">in vivo</italic> for a specific RBP, resulting in a library of reads bound by the target RBP. Binding sites are subsequently identified by mapping the reads back to the reference genome, and analyzing the read profiles with tools referred to as peak callers. A number of peak callers have been popular over the years, such as Piranha (<xref rid="btab755-B7" ref-type="bibr">Uren <italic toggle="yes">et al.</italic>, 2012</xref>), CLIPper (<xref rid="btab755-B5" ref-type="bibr">Lovci <italic toggle="yes">et al.</italic>, 2013</xref>) or PureCLIP (<xref rid="btab755-B3" ref-type="bibr">Krakau <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
    <p>Calling peaks in the genomic context, as done by all currently available peak callers, is unbiased for RBPs that predominantly bind to unspliced RNA. However, for RBPs that predominantly bind in a spliced (i.e. transcript) context, this is clearly suboptimal. Indeed, a recent study (<xref rid="btab755-B6" ref-type="bibr">Uhl <italic toggle="yes">et al.</italic>, 2020</xref>) has demonstrated this to be a substantial problem, and that the inclusion of transcript context can improve the identification of authentic binding sites. Peak callers applied to CLIP-seq data have produced millions of publicly available binding sites, e.g. from ENCODE (<xref rid="btab755-B10" ref-type="bibr">Van Nostrand <italic toggle="yes">et al.</italic>, 2020b</xref>). Consequently, a tool is required that can analyze CLIP-seq peak regions to extract the individual site context for each peak region.</p>
    <p>Here, we present Peakhood, the first tool capable of extracting the most likely site context, individually for each CLIP-seq peak region. The necessary information are extracted directly from the CLIP-seq read profiles, in combination with a genomic annotations file (both reference and custom annotations are supported). For sites assigned to transcript context, Peakhood further determines the most likely splice variant. In addition, Peakhood can merge extracted transcript context sets into comprehensive transcript context site collections. Peakhood also supports batch processing, i.e. context extraction of multiple datasets and merging in one run. As a supplement, we provide four precomputed transcript context site collections, using eCLIP datasets of 49 RBPs with known roles in posttranscriptional gene regulation (see Data availability section).</p>
  </sec>
  <sec>
    <title>2 Approach</title>
    <p>Here, we briefly describe how Peakhood works. A detailed description can be found in the <xref rid="sup1" ref-type="supplementary-material">Online Supplementary (Section 1.2)</xref>. For full details, please check out the comprehensive manual on GitHub. Peakhood first extracts the site context for each input peak region. <xref rid="btab755-F1" ref-type="fig">Figure  1a</xref> shows two peak regions inside a typical transcript context. Peakhood uses the given exon annotations (GTF) and CLIP-seq read information (BAM), essentially looking for differences in exon and surrounding intron coverage, as well as coverage drops at exon borders. If these differences exceed the configured thresholds, the site is assigned to transcript context, otherwise to genomic context (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref> example). In addition, sites at exon borders connected by intron-spanning reads are merged into single sites (as in <xref rid="btab755-F1" ref-type="fig">Fig.  1a</xref>). For sites assigned to transcript context, Peakhood further selects the most likely site-transcript combination, using various read, site and transcript statistics. Moreover, Peakhood can merge single datasets into comprehensive transcript context site collections (see <xref rid="btab755-F1" ref-type="fig">Fig.  1b</xref> for the extraction and merge workflow). The collections also include tabular data, e.g. to identify which sites on transcripts are in close distance, or if site distances decreased compared to the original genomic context. Percentages of extracted transcript context sites agree with known RBP roles (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 1.3 and Fig. S2</xref>). Peakhood requires a Linux operating system and is easy to install, e.g. via Conda (Conda package available). The tool was tested (Intel i7-8700k, Ubuntu 18.04 LTS), with single dataset site context extraction (example dataset with 2146 input peak regions, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 1.6</xref>) taking about 2 min and 30 s.</p>
    <fig position="float" id="btab755-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>a</bold>) Genomic region (IGV screenshot) with mapped PUM2 K562 eCLIP data (details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 1.4</xref>). 1: Read profile (coverage range in brackets), 2: read alignments, 3: gene annotations (thick blue regions are exons, thin blue regions introns), Peaks: peaks called by CLIPper IDR method (high-confidence peaks reproducible between replicates). Example transcript context region for the predominantly spliced RNA-binding RBP PUM2, where an exon border site is falsely split in two peaks. (<bold>b</bold>) Overview of the Peakhood workflow for the two main program modes extract and merge. Yellow boxes mark necessary inputs, blue boxes the two program modes and green boxes the outputs. Arrows show the dependencies between inputs, modes and outputs</p>
      </caption>
      <graphic xlink:href="btab755f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>Here we presented Peakhood, the first tool capable of extracting the most likely site context, individually for each CLIP-seq peak region. Peakhood is easy to install and use, thanks to its comprehensive online manual, and it works with standardized file formats (BAM, BED, GTF, 2 bit). We demonstrated Peakhood’s capabilities with eCLIP data and peak regions obtained from ENCODE (<xref rid="btab755-B10" ref-type="bibr">Van Nostrand <italic toggle="yes">et al.</italic>, 2020b</xref>). However, it is not limited to this type of data, and should work fine with other HTS peak data (iCLIP, PAR-CLIP, OOPS), as well as other peak caller outputs, e.g. from PureCLIP. The flexibility is further increased through Peakhood’s various command line parameters, to adapt it for individual datasets or new input types. Summing up, Peakhood allows for an improved modeling of protein binding behavior, by providing a more authentic sequence and structure context, especially for spliced RNA-binding proteins. </p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab755_supplementary_data</label>
      <media xlink:href="btab755_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>The authors thank the reviewers for their constructive comments.</p>
    <sec>
      <title>Funding</title>
      <p>M.U. was funded by Deutsche Forschungsgemeinschaft (DFG) [BA 2168/11-1 SPP 1738, BA2168/11-2 SPP 1738]. D.R. was funded by the Bundesministerium für Bildung und Forschung (BMBF) [RNAProNet-031L0164B]. The study was further supported by the DFG under Germany’s Excellence Strategy (CIBSS—EXC-2189-Project ID 390939984).</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared. </p>
    </sec>
    <sec sec-type="data-availability">
      <title>Data availability</title>
      <p>The transcript context site collections generated by Peakhood from eCLIP datasets of 49 RBPs (first collection with 36 RBPs from HepG2, second collection with 40 RBPs from K562) with known roles in posttranscriptional gene regulation (mRNA stability and decay, translational regulation; information taken from <xref rid="btab755-B9" ref-type="bibr">Van Nostrand <italic toggle="yes">et al.</italic>, 2020a</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 1 Table</xref>) can be downloaded from Zenodo (<ext-link xlink:href="https://doi.org/10.5281/zenodo.5557101" ext-link-type="uri">https://doi.org/10.5281/zenodo.5557101</ext-link>).</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab755-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hafner</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Transcriptome-wide identification of RNA-binding protein and microRNA target sites by PAR-CLIP</article-title>. <source>Cell</source>, <volume>141</volume>, <fpage>129</fpage>–<lpage>141</lpage>.<pub-id pub-id-type="pmid">20371350</pub-id></mixed-citation>
    </ref>
    <ref id="btab755-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>König</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>iCLIP reveals the function of hnRNP particles in splicing at individual nucleotide resolution</article-title>. <source>Nat. Struct. Mol. Biol</source>., <volume>17</volume>, <fpage>909</fpage>–<lpage>915</lpage>.<pub-id pub-id-type="pmid">20601959</pub-id></mixed-citation>
    </ref>
    <ref id="btab755-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krakau</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>PureCLIP: capturing target-specific protein–RNA interaction footprints from single-nucleotide CLIP-seq data</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>240</fpage>.<pub-id pub-id-type="pmid">29284540</pub-id></mixed-citation>
    </ref>
    <ref id="btab755-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Licatalosi</surname><given-names>D.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>HITS-CLIP yields genome-wide insights into brain alternative RNA processing</article-title>. <source>Nature</source>, <volume>456</volume>, <fpage>464</fpage>–<lpage>469</lpage>.<pub-id pub-id-type="pmid">18978773</pub-id></mixed-citation>
    </ref>
    <ref id="btab755-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lovci</surname><given-names>M.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Rbfox proteins regulate alternative mRNA splicing through evolutionarily conserved RNA bridges</article-title>. <source>Nat. Struct. Mol. Biol</source>., <volume>20</volume>, <fpage>1434</fpage>–<lpage>1442</lpage>.<pub-id pub-id-type="pmid">24213538</pub-id></mixed-citation>
    </ref>
    <ref id="btab755-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Uhl</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Improving CLIP-seq data analysis by incorporating transcript information</article-title>. <source>BMC Genomics</source>, <volume>21</volume>, <fpage>1</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btab755-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Uren</surname><given-names>P.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Site identification in high-throughput RNA–protein interaction data</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>3013</fpage>–<lpage>3020</lpage>.<pub-id pub-id-type="pmid">23024010</pub-id></mixed-citation>
    </ref>
    <ref id="btab755-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Nostrand</surname><given-names>E.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Robust transcriptome-wide discovery of RNA-binding protein binding sites with enhanced CLIP (eCLIP)</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>508</fpage>–<lpage>514</lpage>.<pub-id pub-id-type="pmid">27018577</pub-id></mixed-citation>
    </ref>
    <ref id="btab755-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Nostrand</surname><given-names>E.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020a</year>) <article-title>A large-scale binding and functional map of human RNA-binding proteins</article-title>. <source>Nature</source>, <volume>583</volume>, <fpage>711</fpage>–<lpage>719</lpage>.<pub-id pub-id-type="pmid">32728246</pub-id></mixed-citation>
    </ref>
    <ref id="btab755-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Nostrand</surname><given-names>E.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020b</year>) <article-title>Principles of RNA processing from analysis of enhanced CLIP maps for 150 RNA binding proteins</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>26</fpage>.<pub-id pub-id-type="pmid">32028986</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
