<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_MCPRO100432 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEfx1 jpg ?>
<?FILEmmc1 pdf ?>
<?FILEmmc2 xlsx ?>
<?FILEmmc3 pdf ?>
<?FILEmmc4 pdf ?>
<?FILEmmc5 xlsx ?>
<?FILEmmc6 xlsx ?>
<?FILEmmc7 xlsx ?>
<?FILEmmc8 xlsx ?>
<?FILEmmc9 xlsx ?>
<?FILEmmc10 xlsx ?>
<?FILEmmc11 xlsx ?>
<?FILEmmc12 pdf ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Cell Proteomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol Cell Proteomics</journal-id>
    <journal-title-group>
      <journal-title>Molecular &amp; Cellular Proteomics : MCP</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1535-9476</issn>
    <issn pub-type="epub">1535-9484</issn>
    <publisher>
      <publisher-name>American Society for Biochemistry and Molecular Biology</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9720494</article-id>
    <article-id pub-id-type="pii">S1535-9476(22)00240-7</article-id>
    <article-id pub-id-type="doi">10.1016/j.mcpro.2022.100432</article-id>
    <article-id pub-id-type="publisher-id">100432</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technological Innovation and Resources</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>inSPIRE: An Open-Source Tool for Increased Mass Spectrometry Identification Rates Using Prosit Spectral Prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Cormican</surname>
          <given-names>John A.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Horokhovskyi</surname>
          <given-names>Yehor</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Soh</surname>
          <given-names>Wai Tuck</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au4">
        <name>
          <surname>Mishto</surname>
          <given-names>Michele</given-names>
        </name>
        <email>michele.mishto@kcl.ac.uk</email>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff3" ref-type="aff">3</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
        <xref rid="fn1" ref-type="fn">‡</xref>
      </contrib>
      <contrib contrib-type="author" id="au5">
        <name>
          <surname>Liepe</surname>
          <given-names>Juliane</given-names>
        </name>
        <email>jliepe@mpinat.mpg.de</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
        <xref rid="fn1" ref-type="fn">‡</xref>
      </contrib>
      <aff id="aff1"><label>1</label>Max-Planck-Institute for Multidisciplinary Sciences (MPI-NAT), Göttingen, Germany</aff>
      <aff id="aff2"><label>2</label>Centre for Inflammation Biology and Cancer Immunology (CIBCI) &amp; Peter Gorer Department of Immunobiology, King's College London, London, United Kingdom</aff>
      <aff id="aff3"><label>3</label>The Francis Crick Institute, London, United Kingdom</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>For correspondence: Michele Mishto; Juliane Liepe <email>michele.mishto@kcl.ac.uk</email><email>jliepe@mpinat.mpg.de</email></corresp>
      <fn id="fn1">
        <label>‡</label>
        <p id="ntpara0010hh">These authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <volume>21</volume>
    <issue>12</issue>
    <elocation-id>100432</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 The Authors</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <p>Rescoring of mass spectrometry (MS) search results using spectral predictors can strongly increase peptide spectrum match (PSM) identification rates. This approach is particularly effective when aiming to search MS data against large databases, for example, when dealing with nonspecific cleavage in immunopeptidomics or inflation of the reference database for noncanonical peptide identification. Here, we present inSPIRE (<italic>in silico</italic> Spectral Predictor Informed REscoring), a flexible and performant open-source rescoring pipeline built on Prosit MS spectral prediction, which is compatible with common database search engines. inSPIRE allows large-scale rescoring with data from multiple MS search files, increases sensitivity to minor differences in amino acid residue position, and can be applied to various MS sample types, including tryptic proteome digestions and immunopeptidomes. inSPIRE boosts PSM identification rates in immunopeptidomics, leading to better performance than the original Prosit rescoring pipeline, as confirmed by benchmarking of inSPIRE performance on ground truth datasets. The integration of various features in the inSPIRE backbone further boosts the PSM identification in immunopeptidomics, with a potential benefit for the identification of noncanonical peptides.</p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical Abstract</title>
      <fig id="undfig1" position="anchor">
        <graphic xlink:href="fx1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">inSPIRE (<italic>in silico</italic> Spectral Predictor Informed REscoring).</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">inSPIRE is a flexible and performant open-source rescoring pipeline.</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">inSPIRE allows large-scale rescoring with multiple MS search files.</p>
          </list-item>
          <list-item id="u0025">
            <label>•</label>
            <p id="p0025">inSPIRE can be applied to various search engines.</p>
          </list-item>
          <list-item id="u0030">
            <label>•</label>
            <p id="p0030">inSPIRE has better performance than the original Prosit rescoring pipeline.</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0025">
      <title>In Brief</title>
      <p>inSPIRE (<italic>in silico</italic> Spectral Predictor Informed REscoring) is a flexible and performant open-source rescoring pipeline built on Prosit or MS<sup>2</sup>PIP MS spectral prediction. inSPIRE is compatible with several search engines, allows large-scale rescoring with data from multiple MS search files, enables Prosit prediction without specialized GPU hardware, increases sensitivity to minor differences in amino acid residue position, and can be applied to various MS sample types, including tryptic proteome digestions, but is specifically optimized for immunopeptidomes.</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Keywords</title>
      <kwd>mass spectrometry</kwd>
      <kwd>target-decoy</kwd>
      <kwd>large search space</kwd>
      <kwd>inSPIRE</kwd>
      <kwd>immunopeptidomics</kwd>
      <kwd>rescoring</kwd>
      <kwd>Prosit</kwd>
      <kwd>Percolator</kwd>
    </kwd-group>
    <kwd-group id="kwrds0015">
      <title>Abbreviations</title>
      <kwd>CPU, central processing unit</kwd>
      <kwd>FDR, false discovery rate</kwd>
      <kwd>GPU, graphics processing unit</kwd>
      <kwd>HCD, high collision–induced dissociation</kwd>
      <kwd>HLA, human leukocyte antigen</kwd>
      <kwd>inSPIRE, <italic>in silico</italic> Spectral Predictor Informed REscoring</kwd>
      <kwd>iRT, indexed retention time</kwd>
      <kwd>MS, mass spectrometry</kwd>
      <kwd>PPV, positive predictive value</kwd>
      <kwd>PR, precision–recall</kwd>
      <kwd>PSM, peptide spectrum match</kwd>
      <kwd>PTM, post-translational modification</kwd>
      <kwd>VZV, varicella-zoster virus</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <p id="p0035">Tandem mass spectrometry (MS) has been a successful tool for large-scale identification in proteomics and peptidomics (<xref rid="bib1" ref-type="bibr">1</xref>, <xref rid="bib2" ref-type="bibr">2</xref>, <xref rid="bib3" ref-type="bibr">3</xref>). In tandem MS, peptides in a sample are first ionized and separated by their <italic>m/z</italic>, resulting in MS1 spectra. Selected ions are then fragmented, often by collision-induced dissociation or high collision–induced dissociation (HCD), resulting in MS2 spectra. Commonly, peptide identifications are performed <italic>via</italic> database search engines comparing the experimentally observed MS2 spectra to the theoretical fragments produced by all possible peptides in a reference proteome (<italic>i.e.</italic>, the search space) (<xref rid="bib4" ref-type="bibr">4</xref>). The highest scoring match between theoretical and experimental spectra is then assigned to produce a peptide spectrum match (PSM). In order to quantify the probability that a PSM is correct, it is of importance to compute the false discovery rate (FDR). This is commonly estimated by searching a decoy database of reversed or randomized sequences, with a similar composition to the reference (or target) database (<xref rid="bib5" ref-type="bibr">5</xref>). The decoy database should contain no true peptide sequences present in the analyzed sample, and so the number of false discoveries above a given scoring threshold can be estimated by the number of PSMs from the decoy database with scores above that threshold.</p>
  <p id="p0040">This approach is adopted by many traditional search engines, such as Mascot, MaxQuant, or PEAKS DB, and it has been successful, particularly when dealing with a small well-informed reference proteome (<xref rid="bib6" ref-type="bibr">6</xref>). For example, in proteomics experiments, the digestion of a protein-containing sample with a specific protease such as trypsin results in a reduced search space compared with the digestion of the same sample with an unspecific protease. However, it is not always possible to achieve this reduced search space. One such case is the field of immunopeptidomics, where MS-mediated identifications of peptides presented by human leukocyte antigen class I and II (HLA-I and HLA-II) complexes can provide valuable insights into specific immune responses and potentially aid the development of targeted immunotherapies (<xref rid="bib7" ref-type="bibr">7</xref>). These immunopeptides are generated within the cell <italic>via</italic> various processing steps, including proteasomal processing (<xref rid="bib8" ref-type="bibr">8</xref>). Proteasomes are proteases that, in contrast to trypsin, can cleave after any amino acid, following complex dynamics (<xref rid="bib9" ref-type="bibr">9</xref>, <xref rid="bib10" ref-type="bibr">10</xref>), thereby impacting on the database search space. The size of the search space can be expanded even further with increasing interest in noncanonical peptides outside the commonly used reference proteomes (<xref rid="bib11" ref-type="bibr">11</xref>, <xref rid="bib12" ref-type="bibr">12</xref>, <xref rid="bib13" ref-type="bibr">13</xref>, <xref rid="bib14" ref-type="bibr">14</xref>). These enlarged search spaces can create a number of issues to traditional target-decoy search approaches, with a significant negative impact on both peptide yield and FDR estimation (<xref rid="bib15" ref-type="bibr">15</xref>, <xref rid="bib16" ref-type="bibr">16</xref>).</p>
  <p id="p0045">Postprocessing or rescoring approaches, which perform additional validation on the target and decoy PSMs outputted from the original database search, have been developed to achieve high peptide yield at low FDR estimates, even when confronted with enlarged search spaces. These algorithms have been used for many years as a method of validating peptide identifications and increasing identification rates in MS search results (<xref rid="bib17" ref-type="bibr">17</xref>, <xref rid="bib18" ref-type="bibr">18</xref>, <xref rid="bib19" ref-type="bibr">19</xref>). Percolator is one such algorithm that uses a semisupervised machine learning approach, which considers features beyond the original search engine score using Support Vector Machine models, and it has become the dominant approach for MS2 postprocessing (<xref rid="bib20" ref-type="bibr">20</xref>). Percolator makes use of a subset of high-confidence target PSMs as positive samples and all decoy PSMs as negative samples for training its model. The trained model then provides a better separation between target and decoy peptides, allowing a larger number of peptides to be identified at a similar FDR. Throughout this process, Percolator employs a crossvalidation mechanism to avoid overfitting (<xref rid="bib21" ref-type="bibr">21</xref>).</p>
  <p id="p0050">Percolator is highly flexible and allows its user to consider any set of features to describe a dataset of PSMs. Multiple researchers have taken advantage of this by integrating features from newly developed predictors to increase the number of high-confidence peptides identified. Such applications include the use of retention time predictors (<xref rid="bib22" ref-type="bibr">22</xref>) and the use of predictors of HLA-peptide binding affinities in immunopeptidomics (<xref rid="bib23" ref-type="bibr">23</xref>). One particularly fruitful approach has been the use of spectral predictors, as proposed by Silva <italic>et al.</italic> (<xref rid="bib24" ref-type="bibr">24</xref>).</p>
  <p id="p0055">Accurate prediction of the MS2 spectrum of a peptide has been an active area of research for a number of years (<xref rid="bib25" ref-type="bibr">25</xref>). While classic database search engines considered only the presence or the absence of possible MS2 fragment ions, that is, y- or b-ions for HCD, in an experimental MS2 spectrum, modern spectral predictors can accurately predict the relative intensities of the fragment ions (<xref rid="bib26" ref-type="bibr">26</xref>, <xref rid="bib27" ref-type="bibr">27</xref>, <xref rid="bib28" ref-type="bibr">28</xref>, <xref rid="bib29" ref-type="bibr">29</xref>). One of the most significant accomplishments in this field is the Prosit spectral predictor (<xref rid="bib28" ref-type="bibr">28</xref>, <xref rid="bib29" ref-type="bibr">29</xref>). Prosit is a deep learning tool that was trained on more than 20 million high-quality experimental MS2 spectra, and that has demonstrated state-of-the-art performance on both tryptic and immunopeptidomics datasets.</p>
  <p id="p0060">Wilhelm <italic>et al.</italic> (<xref rid="bib29" ref-type="bibr">29</xref>) combined metrics describing the match between the Prosit-predicted spectrum and the experimentally observed spectrum as Percolator input features to increase discovery rates on immunopeptidome search spaces. Significant increases in performance have also been demonstrated for the MS<sup>2</sup>Rescore software (Compomics), which uses predictions from the MS<sup>2</sup>PIP spectral predictor rather than from Prosit (<xref rid="bib30" ref-type="bibr">30</xref>). Both tools have also been compared when applied to a tryptic digest with an enlarged search space, showing a similar performance (<xref rid="bib31" ref-type="bibr">31</xref>).</p>
  <p id="p0065">Despite the clear potential of using Prosit-predicted spectra in rescoring pipelines, its use is limited by the fact that no fully open-source pipeline is available. The Prosit rescoring pipeline presented by Wilhelm <italic>et al.</italic> (<xref rid="bib29" ref-type="bibr">29</xref>) and recently updated (<xref rid="bib32" ref-type="bibr">32</xref>) is only available <italic>via</italic> a web server, which only allows search results from a single MS RAW file and only processes search results from the MaxQuant search engine. Reproducibility is also limited with this system as no versioning information is available. The alternative INFERYS pipeline removes some of these technical limitations but is only available as part of the commercial Thermo Fisher Proteome Discoverer software (<xref rid="bib33" ref-type="bibr">33</xref>).</p>
  <p id="p0070">To address these gaps, we developed inSPIRE, which stands for <italic>in silico</italic> Spectral Predictor Informed REscoring. inSPIRE is a flexible and performant open-source rescoring pipeline, primarily built on Prosit retention time and MS spectral prediction. In contrast to the Prosit rescoring pipeline, inSPIRE is compatible with multiple major database search engines and allows large-scale rescoring with data from multiple search files. Furthermore, the inSPIRE pipeline can perform spectral prediction with Prosit on standard central processing unit (CPU) hardware, whereas the original Prosit release required a specialized graphics processing unit (GPU). For added flexibility, inSPIRE can also use MS<sup>2</sup>PIP as the spectral predictor instead of Prosit and Pyteomics for retention time prediction (<xref rid="bib34" ref-type="bibr">34</xref>, <xref rid="bib35" ref-type="bibr">35</xref>), though this was not our primary focus given that the MS<sup>2</sup>Rescore pipeline already provides fully open-source rescoring using MS<sup>2</sup>PIP predictions. inSPIRE can be applied to various sample types including tryptic proteome digestions and immunopeptidomes. It is specifically optimized for enlarged immunopeptidome search spaces with increased sensitivity to minor differences in amino acid residue position (<xref rid="fig1" ref-type="fig">Fig. 1</xref>).<fig id="fig1"><label>Fig. 1</label><caption><p><bold>Schematic of the inSPIRE pipeline.</bold> Shown is an overview of the flow of execution for the inSPIRE pipeline. inSPIRE takes inputs from Mascot, PEAKS DB, or MaxQuant and interacts with Prosit, MS<sup>2</sup>PIP, and NetMHCpan, providing formatted inputs and using their respective predictions for rescoring. inSPIRE calls Percolator internally to execute the PSM rescoring. The user provides a configuration file for inSPIRE and must work with <italic>Prosit</italic> (and optionally NetMHCpan) to provide the predictions to inSPIRE. inSPIRE, <italic>in silico</italic> Spectral Predictor Informed REscoring; PSM, peptide spectrum match.</p></caption><graphic xlink:href="gr1"/></fig></p>
  <p id="p0075">In addition, we developed an inSPIRE variant, specifically for HLA-I immunopeptidomics—that is, inSPIRE-affinity—that allows the integration of NetMHCpan (DTU Health Tech) predictions to the inSPIRE backbone. NetMHCpan also uses a deep learning framework, in this case, to predict the binding affinity of a given peptide to given HLA molecules (<xref rid="bib36" ref-type="bibr">36</xref>, <xref rid="bib37" ref-type="bibr">37</xref>, <xref rid="bib38" ref-type="bibr">38</xref>). All details and information related to inSPIRE performance and the study outcomes are reported in <xref rid="appsec1" ref-type="sec">supplemental Files S1-S11</xref>, <xref rid="appsec1" ref-type="sec">supplemental Figs. S1–S14</xref> and <xref rid="appsec1" ref-type="sec">Tables S1–S4</xref>.</p>
  <sec id="sec1">
    <title>Experimental Procedures</title>
    <sec id="sec1.1">
      <title>Cell Lines</title>
      <p id="p0080">K562-B∗07:02 and K562-A∗02:01 cell line clones express either the single HLA-B∗07:02 or HLA-A∗02:01 alleles. They derive from the leukemia K562 cell line (American Type Culture Collection CCL-243), which does not express endogenous HLA-I and HLA-II molecules, and its generation and growing conditions are described elsewhere (<xref rid="bib13" ref-type="bibr">13</xref>).</p>
    </sec>
    <sec id="sec1.2">
      <title>HLA-I Immunopeptidome Elution and Tryptic Proteome Digestion</title>
      <p id="p0085">HLA-I-bound peptides were isolated from 10<sup>9</sup> cells of K562-B∗07:02 and K562-A∗02:01 cell line clones, through HLA-I-peptide elution using W6/32 antibody, as described elsewhere (<xref rid="bib13" ref-type="bibr">13</xref>). The MS files were already published (<xref rid="bib13" ref-type="bibr">13</xref>).</p>
      <p id="p0090">The HLA-I immunopeptidomes used as training datasets were previously published by Paes <italic>et al.</italic> (<xref rid="bib39" ref-type="bibr">39</xref>) and Bassani-Sternberg <italic>et al.</italic> (<xref rid="bib40" ref-type="bibr">40</xref>).</p>
      <p id="p0095">Tryptic digestions of cell proteome obtained from the K562 cell line were carried out as follows: cell pellet was lysed in cell lysis buffer (50 mM Hepes, pH 7.5, 150 mM NaCl, 4% SDS, 2 mM DTT, and 0.5% NP-40) and heated at 95 °C for 10 min. The cell lysate was then diluted to a final concentration of 1% SDS with 50 mM Hepes, pH 7.5. Pierce Universal Nuclease (Thermo Fisher Scientific) was added according to the manufacturer’s recommendations and incubated at 37 °C for 30 min under shaking condition (300 rpm). Protein concentration was determined using Pierce BCA protein assay kit (Thermo Fisher Scientific), and 50 μg of protein was used for proteome digestion. Proteins were reduced with 5 mM DTT for 30 min at 37 °C and alkylated by the addition of 20 mM iodoacetamide and incubation for 30 min at room temperature in the dark. The reaction was quenched by incubation with 20 mM DTT for 15 min at room temperature before purification with SP3 beads (<xref rid="bib41" ref-type="bibr">41</xref>) and elution for proteome digestion with trypsin (Promega) at protease to proteome weight ratio of 1:25 at 37 °C for 16 h.</p>
    </sec>
    <sec id="sec1.3">
      <title>Synthetic Peptide Library</title>
      <p id="p0100">The synthetic peptide library contained 9, 10, or 15 amino acid long peptides (n = 6876 unique peptide sequences and 13,868 PSMs) related to CD4<sup>+</sup> and CD8<sup>+</sup> T-cell response to dengue virus and varicella-zoster virus (VZV), as described elsewhere (<xref rid="bib42" ref-type="bibr">42</xref>). The dengue virus and VZV synthetic peptides utilized in this study were selected for analysis because they were already available in-house and synthesized for separate epitope identification studies. The selection and characterization of these peptides has been described previously (<xref rid="bib43" ref-type="bibr">43</xref>, <xref rid="bib44" ref-type="bibr">44</xref>, <xref rid="bib45" ref-type="bibr">45</xref>, <xref rid="bib46" ref-type="bibr">46</xref>, <xref rid="bib47" ref-type="bibr">47</xref>, <xref rid="bib48" ref-type="bibr">48</xref>, <xref rid="bib49" ref-type="bibr">49</xref>, <xref rid="bib50" ref-type="bibr">50</xref>). Each of the peptides in synthetic peptide libraries was derived from respective dengue and VZV proteomes. Peptides were originally selected for other studies based on bioinformatic analyses of predicted capacity to bind various common HLA-I and HLA-II alleles in the general worldwide population. The set of dengue protein sequences of provenance represents all four dengue serotypes and several different variant isolates. The VZV peptides were primarily derived from the attenuated varicella vaccine strain vOka and a few variant isolates. Peptides were grouped in eight library batches, with each peptide measured at the concentration of 0.0625 pmol/μl. For each pool, 8 μl was injected in the instrument, thereby measuring 500 fmol of each peptide. The synthetic peptide libraries are reported in <xref rid="appsec1" ref-type="sec">supplemental File S5</xref>.</p>
    </sec>
    <sec id="sec1.4">
      <title>MS</title>
      <p id="p0105">MS data of HLA-I immunopeptidomes were collected using Orbitrap Fusion Lumos mass spectrometer coupled to an Ultimate 3000 RSLC nano pump (both from Thermo Fisher Scientific), as described elsewhere (<xref rid="bib13" ref-type="bibr">13</xref>). The same method and instrument were used for the synthetic peptide library measurement. MS data of tryptic digestions of cell proteome were measured through Thermo Scientific Orbitrap Exploris 480 mass spectrometer. Digested proteome samples were injected using an Ultimate 3000 RSLC nano pump (both from Thermo Fisher Scientific). Briefly, 0.5 μg of each sample was loaded and separated by a nanoflow HPLC (RSLC Ultimate 3000) on an Easy-spray C18 nano column (30 cm length, 75 μm internal diameter). Peptides were eluted with a linear gradient of 5 to 45% buffer B (80% acetonitrile and 0.1% formic acid) at a flow rate of 300 nl/min over 58 min at 50 °C. The instrument was programmed within Xcalibur 3.1.66.10 (Thermo Fisher Scientific) to acquire MS data in a data-dependent acquisition mode using top 30 precursor ions. We acquired one full-scan MS spectrum at a resolution of 60,000 with a normalized automatic gain control target value of 300% and a scan range of 350 to 1600 <italic>m/z</italic>. The MS/MS fragmentation was conducted using HCD collision energy (28%) with an orbitrap resolution of 15,000. The normalized automatic gain control target value was set up at 100% with a maximum injection time of 40 ms. A dynamic exclusion of 22 s and 2 to 6 included charged states were defined within this method. The MS files used in each figure are reported in <xref rid="appsec1" ref-type="sec">supplemental Table S4</xref>.</p>
    </sec>
    <sec id="sec1.5">
      <title>MS Software Settings</title>
      <p id="p0110">For all sections where MaxQuant was used, RAW MS files were searched using MaxQuant GUI, version 1.6.17. First search peptide tolerance was set to 20 ppm, and the main search peptide tolerance was set to 4.5 ppm. Minimum peptide length was set to 7, and maximum peptide mass was set to 4600 Da. The mass tolerance for the fragment ions was set to 20 ppm. For identification, both PSM FDR and protein FDR were set to 1.0, allowing the maximum possible number of PSMs to be exported.</p>
      <p id="p0115">For the tryptic searches, we performed a specific search against the reference proteome with enzyme set to trypsin, allowing cleavage after proline. Up to two missed cleavages were allowed. Oxidation of methionine was set as the only variable post-translational modification (PTM), and carbamidomethylation of cysteine was set as a fixed modification. For the immunopeptidome searches, we performed an unspecific search against the reference proteome. Oxidation of methionine was set as the only variable PTM, and no fixed PTMs were set, with the exception of the datasets from Sarkizova <italic>et al.</italic> (<xref rid="bib51" ref-type="bibr">51</xref>) where carbamidomethylation of cysteine was also set. Before rescoring with inSPIRE or Prosit-rescoring, all hits containing unmodified cysteine were removed as Prosit assumes carbamidomethylation of cysteine. For the ground truth dataset, a nonspecific search was used. In this case, no modifications were selected, and again, the hits containing unmodified cysteine residues were removed before rescoring with inSPIRE or Prosit-rescoring.</p>
      <p id="p0120">For the identification of the synthetic peptides used in the synthetic peptide library, we searched RAW files using PEAKS, version 10.6 with precursor mass tolerance of 5 ppm and fragment ion mass tolerance of 0.02 Da. No PTMs were allowed, and the results were exported at an FDR of 1%.</p>
      <p id="p0125">For the comparison between rescoring on different search engines, we searched RAW files using PEAKS, version 10.6 with precursor mass tolerance of 5 ppm and fragment ion mass tolerance of 0.02 Da. As with the MaxQuant searches, the tryptic searches were performed with two missed cleavages allowed, and cleavage was allowed after proline. The same PTM settings were used, and again, all hits containing cysteine were filtered out before rescoring. Results were exported for all PSMs with PEAKS −10lgP score greater than 0.</p>
      <p id="p0130">In the case of Mascot, we used Mascot Distiller, version 2.8.0.1 to process the MS RAW files. To allow the detection of chimeric spectra with Mascot, we set the maximum number of precursor <italic>m/z</italic> values to 2 and set <italic>Allow multiple precursors per scan</italic> to true. Precursor mass tolerance was set to 5 ppm, and fragment ion mass tolerance was set to 0.02 Da for both tryptic and immunopeptidome searches. The tryptic searches were performed with two missed cleavages allowed, and cleavage was allowed after proline. The same PTMs were allowed as with PEAKS and MaxQuant, and hits containing unmodified cysteine residues were filtered out before rescoring. We used Mascot’s automatic decoy search and exported both target and decoy results with a homology significance threshold set to 0.999999 (<italic>i.e.</italic>, exporting essentially all hits).</p>
      <p id="p0135">In order to provide the experimental spectra to the inSPIRE pipeline, RAW files were converted to mgf format using the msConvertGUI. The ThermoRawFileParser, version 1.4.0 was used to generate data for mgf input in Prosit-<italic>delta</italic> training pipeline (<xref rid="bib52" ref-type="bibr">52</xref>).</p>
      <p id="p0140">Percolator, version 3.0.5 was for all rescoring jobs. All Prosit-rescoring jobs were submitted to the web server between March 10 and August 16, 2022. Rescoring with MS<sup>2</sup>Rescore was performed with version 2.1.2.</p>
      <p id="p0145">The search result files used for each figure are reported in <xref rid="appsec1" ref-type="sec">supplemental Table S5</xref>. The final identifications for all pipelines for all datasets are provided in <xref rid="appsec1" ref-type="sec">supplemental Files S6–S9</xref>.</p>
    </sec>
    <sec id="sec1.6">
      <title>Application of MS<sup>2</sup>Rescore</title>
      <p id="p0150">For both tryptic and immunopeptidome datasets, the general settings for MS<sup>2</sup>Rescore were set with “pipeline” to “infer,” “feature_sets” to a list of “searchengine,” “ms2pip,” and “rt,” “run_percolator” to false, “id_decoy_patter” to null, “num_cpu” to −1, “config_file” to null, “tmp_path” to null, “mgf_path” to null, “output_filename” to null, “log_level” to info, and “plotting” to false. The “ms2pip” settings were set with “model” as “Immuno-HCD” for the immunopeptidome datasets and “HCD2021” for the tryptic datasets. The “frag_error” was set to 0.02. Variable modification of oxidation of methionine was set in either case with the “modification_mapping” set with “Oxidation (M)” mapping to “Oxidation” for both datasets. In the case of the tryptic proteome digestion, “fixed_modifications” was also set with “C” mapping to “Carbamidomethyl.”</p>
    </sec>
    <sec id="sec1.7">
      <title>Application of Percolator</title>
      <p id="p0155">We reran Percolator for all pipelines because of the use of --subset-max-train command line argument in the Prosit rescoring pipeline. This command line argument can lead to a breakdown of the Percolator crossvalidation algorithm and should not be applied on small datasets according to The <italic>et al.</italic> (<xref rid="bib20" ref-type="bibr">20</xref>), as confirmed by the Percolator team <italic>via</italic> GitHub (personal communication). We have communicated this issue to the Prosit team <italic>via</italic> GitHub. In reapplying Percolator with the same command line arguments to all pipelines, we ensured that the only variation in the PSMs identified by a rescoring pipeline was not because of different applications of Percolator.</p>
      <p id="p0160">MS<sup>2</sup>Rescore allows the user to select the command line arguments passed to Percolator, but for convenience, we simply reran Percolator on the .pin file produced by MS2Rescore <italic>via</italic> terminal with the same command line arguments used for inSPIRE and Prosit rescoring.</p>
    </sec>
    <sec id="sec1.8">
      <title>RNA Sequencing and Reference Databases</title>
      <p id="p0165">The K562 RNA was extracted from K562 cell line pellets, processed for polyA enrichment, and sequenced by using NEBNext Ultra RNA Library Preparation Kit with random priming. Sequencing was performed using HiSeq 2x150 PE HO with a depth of 20 to 25 million reads per sample. Details about reads trimming, quantification, and data processing are described elsewhere (<xref rid="bib13" ref-type="bibr">13</xref>).</p>
      <p id="p0170">The RNA sequencing dataset generated by Paes <italic>et al.</italic> (<xref rid="bib39" ref-type="bibr">39</xref>) was generated as described in the original article and is available upon request to the authors.</p>
      <p id="p0175">RNA-informed reference databases were generated by imposing an expression cutoff of 10 estimated counts per transcript in Gencode transcriptome main annotation, release 33 (GRCh38.p13) (<xref rid="bib53" ref-type="bibr">53</xref>). Protein-coding transcript translation sequences from these transcripts were kept in an RNA-informed reference database.</p>
      <p id="p0180">The Gencode transcriptome main annotation, release 33 (GRCh38.p13) (<xref rid="bib53" ref-type="bibr">53</xref>) was searched alongside the RNA-informed reference database so that performance across different database size could be compared.</p>
      <p id="p0185">The UniProt <italic>Homo Sapiens</italic> proteome reference database used for PEAKS DB searches to generate PSMs for the Prosit-<italic>delta</italic> training data was downloaded on July 14, 2022.</p>
    </sec>
    <sec id="sec1.9">
      <title>HLA-I-Peptide Binding Affinity Prediction</title>
      <p id="p0190">HLA-I-peptide binding affinity was predicted by applying NetMHCpan 4.1. Specifically, we used a custom Docker image. The NetMHCpan input file is provided as part of the inSPIRE “prepare” pipeline, provided that “useBindingAffinity” setting in the configuration file is specified as “asValidation” or “asFeature.” When using binding affinity predictions as a validation (<italic>i.e.</italic>, comparing number of predicted HLA-I-peptide binders for inSPIRE compared with Prosit-rescoring), we only considered NetMHCpan predictions for peptides with length between 8 and 14 residues because of software limitations. For inSPIRE-affinity, we generated predictions for all peptides as null values were not allowed in the Percolator input file.</p>
      <p id="p0195">For our validation and reporting pipelines, we defined a peptide predicted by NetMHCpan to bind a given HLA-I complex, by evaluating against the %Rank value, according to Reynisson <italic>et al.</italic> (<xref rid="bib37" ref-type="bibr">37</xref>). The %Rank is a transformation on the original prediction, allowing comparison across HLA-I-peptide binding specificities. This system defined a “strong HLA-I binder” as a peptide with a %Rank &lt;0.5% for a given HLA-I allele and a “HLA-I binder” as a peptide with a %Rank &lt;2% for a given HLA-I allele.</p>
      <p id="p0200">We also used the values for the positive predictive value (PPV) reported by Reynisson <italic>et al.</italic> (<xref rid="bib37" ref-type="bibr">37</xref>) as a metric to understand the variation between NetMHCpan performance on different alleles. Reynisson <italic>et al.</italic> (<xref rid="bib37" ref-type="bibr">37</xref>) defined PPV as the number of positive binding peptides correctly predicted divided by 0.95 times the number of ligands predicted. By considering this metric for the different alleles analyzed, we could study how the strength of the NetMHCpan predictor for an HLA-I allele impacted the use of predicted HLA-I-peptide binding affinity both as an evaluation metric and as a feature for rescoring.</p>
    </sec>
    <sec id="sec1.10">
      <title>Experimental Design and Statistical Rationale</title>
      <p id="p0205">This study aimed to benchmark inSPIRE performance against other state-of-the-art tools, in particular the Prosit rescoring pipeline, to demonstrate its value on datasets that the original Prosit rescoring pipeline could not allow rescoring, and to demonstrate the value of our novel Prosit-<italic>delta</italic> predictor.</p>
      <p id="p0210">In benchmarking, we focused our analysis on HLA-I immunopeptidome datasets of the K562-A∗02:01 and K562-B∗07:02 cell lines, for which we had an RNA-informed dataset and for which the NetMHCpan predictor performs strongly (<xref rid="bib37" ref-type="bibr">37</xref>).</p>
      <p id="p0215">Since the Prosit web server only allowed the analysis of a single RAW file, and given that all the immunopeptidomics dataset came from previously published studies, we generally did not favor running multiple replicates of the same allele. This allowed us to explore a wider variety of HLA alleles with differing motifs rather than focusing on many replicates of a limited variety.</p>
      <p id="p0220">In <xref rid="fig2" ref-type="fig">Figure 2</xref>, the MaxQuant search results of the K562-A∗02:01-derived immunopeptidome datasets searched with the RNA-informed and Gencode reference databases contained 14,689 and 15,065 PSMs, respectively. The equivalent datasets for the K562-B∗07:02-derived immunopeptidome contained 14,738 and 14,741 PSMs, respectively, and for the tryptic proteome digestion, they contained 55,396 and 56,560 PSMs, respectively.<fig id="fig2"><label>Fig. 2</label><caption><p><bold>PSM identification by inSPIRE compared with the Prosit rescoring pipeline on tryptic proteome digestions and HLA-I immunopeptidomes.</bold><italic>A</italic>–<italic>M</italic>, analysis of the PSMs identified in HLA-I immunopeptidomes of K562-A∗02:01 (<italic>A</italic>–<italic>E</italic>) and K562-B∗07:02 (<italic>F</italic>–<italic>J</italic>) cell lines as well as the tryptic proteome digestion of the K562 cell line (<italic>K</italic>–<italic>M</italic>) by different pipelines. In (<italic>A</italic>, <italic>B</italic>, <italic>F</italic>, <italic>G</italic>, and <italic>K</italic>), the RNA-informed and in (<italic>C</italic>, <italic>D</italic>, <italic>H</italic>, <italic>I</italic>, and <italic>L</italic>) the full Gencode reference databases have been used. <italic>A</italic>, <italic>C</italic>, <italic>F</italic>, <italic>H</italic>, <italic>K</italic>, and <italic>L</italic>, number of PSMs identified by applying the pipelines on MaxQuant search results. <italic>B</italic>, <italic>D</italic>, <italic>G</italic>, and <italic>I</italic>, comparison of the percentage of identified peptides also predicted to bind the HLA-A∗02:01 (<italic>B</italic> and <italic>D</italic>) and HLA-B∗07:02 (<italic>G</italic> and <italic>I</italic>) complexes. Only peptides with lengths between 8 and 14 residues were included to allow the NetMHCpan HLA-I-peptide binding prediction. <italic>E</italic>, <italic>J</italic>, and <italic>M</italic>, the percentage of peptides identified by each pipeline on search results using the Gencode reference database, which were also found at any confidence level in the MaxQuant search of the RNA-informed database of the cognate cell line. HLA, human leukocyte antigen; inSPIRE, <italic>in silico</italic> Spectral Predictor Informed REscoring; PSM, peptide spectrum match.</p></caption><graphic xlink:href="gr2"/></fig></p>
      <p id="p0225">In <xref rid="fig3" ref-type="fig">Figure 3</xref>, in all cases, the total number of PSMs used to generate the figures was 12,924 PSMs.<fig id="fig3"><label>Fig. 3</label><caption><p><bold>Performance of inSPIRE compared with the Prosit rescoring pipeline on synthetic peptides’ ground truth dataset.</bold><italic>A</italic>–<italic>C</italic>, shown is the precision (number of correctly identified peptides over number of identified peptides) against the recall (number of correctly identified peptides over number of correct peptides) of different rescoring pipelines. <italic>A</italic>, performance of different rescoring pipelines on ground truth data from two MS files (mean of 2108 target PSMs and 824 decoy PSMs). <italic>B</italic>, performance of different rescoring pipelines on ground truth data from four MS files (mean 4216 target PSMs and 1647 decoy PSMs). <italic>C</italic>, performance of different rescoring pipelines on ground truth data from eight MS files (8631 target PSMs and 3293 decoy PSMs). <italic>Dash line</italic> represents a precision of 0.99, which approximately corresponds to 1% FDR. FDR, false discovery rate; inSPIRE, <italic>in silico</italic> Spectral Predictor Informed REscoring; MS, mass spectrometry; PSM, peptide spectrum match.</p></caption><graphic xlink:href="gr3"/></fig></p>
      <p id="p0230">In <xref rid="fig4" ref-type="fig">Figure 4</xref>, the immunopeptidome rescoring for RNA-informed and Gencode reference database searches was based, respectively, on 41,188 and 40,929 PSMs for MaxQuant, 29,802 and 30,833 PSMs for Mascot, and 22,958 and 22,504 PSMs for PEAKS DB. The tryptic proteome digestion rescoring using the same reference databases was based, respectively, on 339,609 and 339,470 PSMs for MaxQuant, 244,697 and 244,698 PSMs for Mascot, and 316,095 and 310,219 PSMs for PEAKS DB. The <italic>p</italic> values relevant to <xref rid="appsec1" ref-type="sec">supplemental Fig. S10</xref> were calculated using Student’s <italic>t</italic> test.<fig id="fig4"><label>Fig. 4</label><caption><p><bold>inSPIRE increases the PSM yield preferentially benefiting MaxQuant searches.</bold><italic>A</italic>–<italic>F</italic>, analysis of the PSMs identified in either the HLA-I immunopeptidomes of K562-B∗07:02 cell line (one biological and three technical replicates; <italic>A</italic>–<italic>C</italic>) or the tryptic proteome digestion of the K562 cell line (three biological and two technical replicates; <italic>D</italic>–<italic>F</italic>) by different pipelines. <italic>A</italic> and <italic>D</italic>, the RNA-informed and in (<italic>B</italic>, <italic>C</italic>, <italic>E</italic>, and <italic>F</italic>) the full Gencode reference databases have been used. <italic>A</italic>, <italic>B</italic>, <italic>D</italic>, and <italic>E</italic>, number of PSMs identified by the three search engines with or without inSPIRE rescoring. <italic>C</italic> and <italic>F</italic>, the percentage of peptides identified by each pipeline on search results using the Gencode reference database, which were also found at any confidence level in the MaxQuant search of the RNA-informed database for the two datasets. HLA, human leukocyte antigen; inSPIRE, <italic>in silico</italic> Spectral Predictor Informed REscoring; PSM, peptide spectrum match.</p></caption><graphic xlink:href="gr4"/></fig></p>
      <p id="p0235">The <italic>R</italic><sup>2</sup> values in <xref rid="fig5" ref-type="fig">Figure 5</xref>, <italic>E</italic> and <italic>F</italic> were based on 128,087 and 253,478 Prosit-<italic>delta</italic> values, respectively.<fig id="fig5"><label>Fig. 5</label><caption><p><bold>Prosit-<italic>delta</italic> feature and its impact on inSPIRE’s PSM yield in HLA-I immunopeptidomics.</bold><italic>A</italic>–<italic>D</italic>, Prosit-predicted MS2 spectra compared with experimentally measured MS2 spectra in representative cases wherein a switch of an amino acid residue pair results in either a large (<italic>A</italic> and <italic>C</italic>) or small (<italic>B</italic> and <italic>D</italic>) Prosit-<italic>delta</italic>. In each case, the pair plot is shown for the identified peptide (<italic>A</italic> and <italic>B</italic>) and for the peptide produced by the permutation of two adjacent amino acids in the original sequence (<italic>C</italic> and <italic>D</italic>). The peptide in (<italic>A</italic>) was identified in the synthetic peptide library sample SPL4-2 (scan number 11061). The peptide in (<italic>B</italic>) was identified in the synthetic peptide library sample SPL3-2 (scan number 15058). <italic>E</italic>, scatter plot of observed Prosit-<italic>delta</italic> values of PSMs in the search results of the K562-A∗02:01 and K562-B∗07:02 HLA-I immunopeptidomes against our model’s predictions. The data are downsampled to 10% of the original data to make the figure clearer. <italic>F</italic>, scatter plot of observed Prosit-<italic>delta</italic> values of PSMs in the search results of the K562 tryptic proteome digestion against our model’s predictions. The data are downsampled to 10% of the original data to make the figure clearer. <italic>G</italic> and <italic>H</italic>, relative increase in the number of identified PSMs by inSPIRE using different features as compared with Prosit rescoring pipeline. The analysis refers to the K562 tryptic proteome digestion (<italic>G</italic>) and the K562-B∗07:02 and K562-A∗02:01 HLA-I immunopeptidomes (<italic>H</italic>) searched by MaxQuant using either the RNA-informed or the full Gencode reference databases and 1% FDR. FDR, false discovery rate; HLA, human leukocyte antigen; inSPIRE, <italic>in silico</italic> Spectral Predictor Informed REscoring; PSM, peptide spectrum match.</p></caption><graphic xlink:href="gr5"/></fig></p>
      <p id="p0240">All analyses have been implemented in Python, if not stated otherwise. All statistics for performance measurement are described in the benchmarking framework.</p>
    </sec>
    <sec id="sec1.11">
      <title>Metrics Validating Rescoring Performance</title>
      <p id="p0245">Our simplest analysis of the performance of an identification method was to compare the number of PSMs identified at 1% FDR as estimated <italic>via</italic> Percolator, which was used as the final identification method for all rescoring pipelines presented.</p>
      <p id="p0250">In an attempt to ensure that all pipelines were applying FDR estimation fairly, we used two independent validations for our K562, K562-A∗02:01, K562-B∗07:02 cell line datasets. First, for HLA-I immunopeptidome data, if NetMHCpan was not used in rescoring, we investigated the percentage of HLA-I binders and strong binders predicted by NetMHCpan among the peptides identified. Second, when rescoring search results obtained using the Gencode reference database, we investigated the percentage of peptides identified, which were also found by the search engine at any confidence level when searching the RNA-informed reference database.</p>
      <p id="p0255">We acknowledge that neither of these validation techniques was perfect; it is possible that a correct peptide sequence was not predicted to be an HLA-I binder by NetMHCpan or that the RNA sequencing evidence was not sufficient for its substrate protein to be included in our RNA-informed database. Equally, it is possible that an incorrectly identified peptide was predicted as a strong HLA-I binder and was also found in the RNA-informed database.</p>
      <p id="p0260">However, we estimated that reasonable consistency between these metrics across identifications from different pipelines, combined with Percolator’s well-established FDR estimation method (<xref rid="bib21" ref-type="bibr">21</xref>), was a sufficient validation that an increased number of PSMs identified at a given threshold did represent better identification performance, indeed.</p>
    </sec>
    <sec id="sec1.12">
      <title>Benchmarking With the Synthetic Peptide Library as Ground Truth Dataset</title>
      <p id="p0265">As a validation of the increased number of PSMs for the inSPIRE pipeline, we benchmarked all rescoring methods using “ground truth” datasets, in line with the benchmarking tool iBench (QSB lab) (<xref rid="bib54" ref-type="bibr">54</xref>). In the approach applied in this study, we measured synthetic peptides <italic>via</italic> MS and selected MS2 scans that were identified with 1% FDR using PEAKS search engine. These peptides and their PSMs formed our “ground truth” dataset, although we note that our “ground truth” datasets represented an approximation to an absolute ground truth. Indeed, this strategy still had a minor degree of imperfection since it was based on MS measurement with 1% FDR rather than 0% FDR. Furthermore, although this strategy could contain a certain level of bias toward the PEAKS search engine, we estimated that this did not introduce any advantage for the rescoring methods used, and the use of synthetic peptide libraries greatly reduced the risk of identification errors.</p>
      <p id="p0270">We then embedded two-thirds of those synthetic peptide sequences into the Gencode reference database, thereby generating a constructed reference database, similarly as in the study of Mishto and collaborators (<xref rid="bib13" ref-type="bibr">13</xref>). In this constructed reference database, these peptide sequences were labeled as the “discoverable.” We ensured that the remaining one-third of the synthetic peptide sequences were not in the constructed reference database, and, hence, were “undiscoverable.” We also added fragments of these peptide sequences to the constructed reference database so that the composition of the database was not biased against these peptides after their removal. We then searched the RAW files with MaxQuant using the constructed database and extracted all PSMs (FDR = 1.0%). Any identification found in the MaxQuant search results for an MS2 scan, which was not identified by PEAKS in the original search of the synthetic peptides, was filtered out before any rescoring was applied. This removed the possible confounding influence of contamination peptides of unknown origin.</p>
      <p id="p0275">In our study, we were initially limited by the fact that there were approximately 1000 peptides identified per RAW file, and the Prosit rescoring pipeline only allowed a single RAW file to be scored against. Hence, to overcome these potential limitations, we ran Prosit rescoring for each of the eight RAW files of the synthetic peptide libraries (<italic>i.e.</italic>, SPL1-2 to SPL8-2) separately. We then concatenated the <italic>prosit.tab</italic> files from each run, which contained all the inputs for the final Percolator rescoring, and reran Percolator with the concatenated files. We used the –override flag to ensure that Percolator used the full feature set for all executions.</p>
      <p id="p0280">In order to quantify the impact of the small dataset size on each pipeline, we performed rescoring on search results from two, four, and eight RAW files and calculated precision–recall (PR) curves for each method. To remove the effects of differences between RAW files, we ran all rescoring pipelines on four combinations of two RAW files and two combinations of four RAW files, so that in each case, the final performance was measured on the same data.</p>
      <p id="p0285">The PR curves were generated by varying the cutoff between the minimum and maximum Percolator score for each rescoring method. This involved combining Percolator scores across different runs. To note, Percolator normalized scores based on <italic>q</italic> value and combined scores internally from the different cross-validated models. Hence, combining scores across models did not create any clear bias between the methods being benchmarked.</p>
      <p id="p0290">The precision at each cutoff was calculated as the number of correctly identified PSMs divided by the total number of PSMs above the threshold, whereas the recall was calculated as the number of correctly identified PSMs divided by the number of discoverable peptides in the modified database. In each case, the maximum possible recall was limited by the number of correct PSMs found in the original search engine results.</p>
    </sec>
    <sec id="sec1.13">
      <title>Development of inSPIRE Prosit-<italic>delta</italic> Predictor</title>
      <p id="p0295">The motivation for the Prosit-<italic>delta</italic> is explained in detail in the <xref rid="sec2" ref-type="sec">Results</xref> section. Briefly, we aimed to use a lightweight predictor to estimate the sensitivity of Prosit to adjacent residue permutation at each fragmentation site of the peptide. Although inSPIRE does allow for “brute force” computation of all Prosit-predicted MS2 spectra and resulting Prosit-<italic>delta</italic> values, this would result in doubling the run time and vastly increasing the memory consumption. As an alternative, we found that an xgboost Gradient Tree Boosting Regressor provided an appropriate and performant solution (<xref rid="bib55" ref-type="bibr">55</xref>), without incurring the same computational burden.</p>
      <p id="p0300">We developed the <italic>delta</italic> predictor for Prosit only and not MS<sup>2</sup>PIP for a number of reasons. For instance, inSPIRE was primarily developed to increase the availability of Prosit predictions. Also, one of the main reasons why an inSPIRE user would choose the inSPIRE-MS<sup>2</sup>PIP pipeline could be to predict MS2 spectra for peptides containing PTMs not available with Prosit. Including a broad range of PTMs—particularly those linked to the termini of a peptide—would significantly complicate the current version of the <italic>delta</italic> predictor. In addition, spectral angle was not the primary metric on which MS<sup>2</sup>PIP was trained, although it was an important feature in the inSPIRE-MS<sup>2</sup>PIP pipeline. Hence, the development of <italic>delta</italic> scoring within MS<sup>2</sup>PIP might need a specific investigation of the best metric to be considered.</p>
      <p id="p0305">In order to generate training data for the Prosit-<italic>delta</italic> predictor, we searched the HLA-I immunopeptidomes of Paes <italic>et al.</italic> (<xref rid="bib39" ref-type="bibr">39</xref>) and Bassani-Sternberg <italic>et al.</italic> (<xref rid="bib40" ref-type="bibr">40</xref>) using PEAKS 10.6, using an RNA-informed database and the UniProt Homo Sapiens database, respectively, and exported all hits with PEAKS -10lgP greater than 0. These data were combined with synthetic immunopeptides used by Wilhelm <italic>et al.</italic> (<xref rid="bib29" ref-type="bibr">29</xref>) for which we used the MaxQuant identifications provided in their PRIDE repository. A full description of the RAW files used and the number of PSMs are provided in <xref rid="appsec1" ref-type="sec">supplemental Table S2</xref>. The PEAKS DB searches were run with oxidation of methionine and carbamidomethylation of cysteine set as variable modifications. All hits containing unmodified cysteines were discarded before training. The PSMs were then divided between train (80% of the data) and test (20% of the data) ensuring that there was no overlap in the peptides used between train and test.</p>
      <p id="p0310">While we collected data for peptides with lengths 7 to 30 and precursor charge 1 to 6, the vast majority of our training comes from peptides of length less than 13 and precursor charge 1 to 3 (<xref rid="appsec1" ref-type="sec">supplemental Fig. S11</xref>, <italic>A</italic> and <italic>B</italic>). This feature was in agreement with one of the main objectives of the Prosit-<italic>delta</italic> predictor, which was its application to immunopeptidome datasets. We also show sequence logo plots for the peptides of length 8 to 11 residues in the combined dataset in <xref rid="appsec1" ref-type="sec">supplemental Fig. S11</xref>, <italic>C</italic>–<italic>F</italic>, thereby illustrating that the dataset was not biased toward any specific motif.</p>
      <p id="p0315">For each PSM, we selected five positions at random in the peptide sequence and generated Prosit predictions of MS2 spectra for the peptide created by flipping the adjacent amino acids at those positions. The target variable was the difference between the spectral angle of the modified sequence and the spectral angle of the original sequence. Hence, each PSM in the training dataset generated five training data points. The features used as input for the Prosit-<italic>delta</italic> predictor are detailed in <xref rid="appsec1" ref-type="sec">supplemental Table S3</xref>.</p>
      <p id="p0320">We performed hyperparameter tuning on the parameters minimum child weight, maximum tree depth, learning rate, gamma, and columns sampled by tree. We then used randomized search with five-fold cross-validation on the training set and compared performance for different sets of hyperparameters based both on predictive performance (<italic>r</italic><sup>2</sup> score) and speed of execution. The results of this first round of hyperparameter tuning are shown in <xref rid="appsec1" ref-type="sec">supplemental File S10</xref>. We then selected five sets of hyperparameters, which performed well in crossfold validation and which were then trained on the full training data and evaluated on the test set (<xref rid="appsec1" ref-type="sec">supplemental File S11</xref>). From this second round of evaluation, it was clear that the model with maximum tree depth 16, minimum child weight 2, learning rate 0.15, gamma 0.1, and columns sampled by tree 0.9 was the most performant model. This model showed the best performance on the test data (<italic>r</italic><sup>2</sup> score = 0.74) despite showing slightly lower performance on the train data.</p>
      <p id="p0325">The trained model was packaged within inSPIRE, and the minimum, maximum, median, first quartile, third quartile, fraction of predicted Prosit-<italic>deltas</italic> above −0.1 and fraction of predicted Prosit-<italic>deltas</italic> above 0.0 were passed as features for Percolator.</p>
      <p id="p0330">As with the inSPIRE source code, all the training the code for the Prosit-<italic>delta</italic> predictor is fully open source. Hence, a user of inSPIRE could retrain this predictor on their own data and use their Prosit-<italic>delta</italic> model in the inSPIRE pipeline.</p>
    </sec>
    <sec id="sec1.14">
      <title>inSPIRE Implementation and Application</title>
      <p id="p0335">All inSPIRE jobs presented in this study may be recreated by providing the required inSPIRE configuration file. Full details on the creation of the inSPIRE config file may be found in the README available on GitHub. For each experiment, “rescoreMethod” was set to “percolator,” and “mzAccuracy” was set to 0.02. The search engine and location of search results as well as the location of scan data converted to either mgf or mzML was provided <italic>via</italic> the config file. For inSPIRE-affinity, “useBindingAffinity” was set to “asFeature.” The calibrated collision energy was also set, which agreed between inSPIRE and the Prosit web server in all cases.</p>
      <p id="p0340">To generate Prosit predictions without specialized GPU hardware, we downloaded the Prosit model details and changed the definition of the CuDNNGRU layers in the model.yml file to GRU layers with the following settings, activation equal to tanh, recurrent_activation equal to sigmoid, unroll equal to false, use_bias equal to true, and reset_after equal to true. We also had to avoid using the Tensorflow graph as in the original Prosit code. We were then able to reload the model definition and weights using Tensorflow (Google Brain team), version 2.5 and execute predictions by modifying the open-source code available from the Prosit team (see <ext-link ext-link-type="uri" xlink:href="https://github.com/kusterlab/prosit" id="intref0010">https://github.com/kusterlab/prosit</ext-link>).</p>
      <p id="p0345">For timing comparisons of Prosit prediction on CPU against GPU, spectral prediction on CPU was run on Intel Sky Lake processors, whereas the GPU predictions were run on an NVIDIA Tesla K40m Graphics Card.</p>
      <p id="p0350">All Prosit spectral predictions were generated using the 2020 HCD model and indexed retention time (iRT) predictions using the 2019 model. For users who have very large datasets and easy access to GPU servers, we also provide the modified version of the original Prosit code, including a converted Singularity image so that Prosit can be run on a high-performance computing cluster, a change to the MSP export code so that Prosit predicted iRT values were included, and an option so that <italic>m/z</italic> values of all fragment ions were not calculated by Prosit. We found it was much more efficient to calculate the <italic>m/z</italic> values of the fragment ions in the inSPIRE pipeline and greatly reduce the required prediction time, particularly if a large number of predicted spectra were required.</p>
    </sec>
  </sec>
  <sec id="sec2">
    <title>Results</title>
    <sec id="sec2.1">
      <title>inSPIRE</title>
      <p id="p0355">We developed inSPIRE to be a flexible rescoring pipeline, which provides the power of Prosit prediction for users without specialized computational hardware and can be applied to a vast number of tandem MS proteomics datasets generated with HCD or collision-induced dissociation fragmentation. Although it is optimized for HLA-I immunopeptidomics, inSPIRE can also be applied to standard proteomics experiments. inSPIRE provides flexibility through compatibility with commonly used search engines, that is, MaxQuant, PEAKS, or Mascot, as well as compatibility with open data formats, that is, mgf and mzML formats. For HLA-I immunopeptidomics, the inSPIRE-affinity variant can be employed, which allows integration of NetMHCpan predictions of HLA-I-peptide binding affinity and potentially others in future releases.</p>
      <p id="p0360">When using Prosit, inSPIRE is subject to the limitations of the Prosit predictor and will filter out PSMs where the peptides are of length less than 7 or greater than 30. If the sample contains unmodified cysteines (noncarbamidomethylated) or variable modifications other than the oxidation of methionine, these PSMs will be filtered out by inSPIRE. Unmodified cysteines and a wider range of variable modifications are supported if the user selects MS<sup>2</sup>PIP as their spectral predictor (inSPIRE-MS<sup>2</sup>PIP supports a maximum of nine unique modifications). However, we did not prioritize the development of the MS<sup>2</sup>PIP pipeline given that there already exists a fully open-source rescoring pipeline, which utilizes MS<sup>2</sup>PIP prediction in MS<sup>2</sup>Rescore.</p>
      <p id="p0365">inSPIRE provides multiple pipelines to fulfill different user requirements. The core functionality is provided <italic>via</italic> the “core” pipeline (though individual steps may be run independently), which enables MS2 spectral rescoring (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). The first subsection of the “core” functionality, “prepare,” formats the search engine output for Prosit or MS<sup>2</sup>PIP (and NetMHCpan if required). The required Prosit predictions or MS<sup>2</sup>PIP predictions are then generated <italic>via</italic> the “predictSpectra” pipeline. For Prosit, this entailed the conversion of the GPU-only models available from the Prosit team to a version that could be run on an ordinary CPU (see for Tool Implementation and statistical analysis details). We found that execution of the “predictSpectra” pipeline on the CPU was effective, and timing even compared favorably with execution of the original Prosit code when we removed the calculation of <italic>m/z</italic> values for all possible fragment ions (<xref rid="appsec1" ref-type="sec">supplemental Fig. S1</xref>). We also validated that the predictions from the inSPIRE CPU implementation did not differ from the online Prosit model by running the spectral prediction pipelines for both tools on 13,054 unique peptide-charge combinations (the peptides identified by MaxQuant in the HLA-A∗02:01 immunopeptidome). We found that the predicted iRT values and MS2 spectra agreed to near machine single precision with a mean spectral angle between predicted spectra of 0.9999997 of a mean difference in iRT of the order of 10<sup>−5</sup> (<xref rid="appsec1" ref-type="sec">supplemental File S2</xref>).</p>
      <p id="p0370">NetMHCpan prediction is not currently integrated within inSPIRE because of license restrictions, but if the user wishes to employ the inSPIRE-affinity variant, they could generate the predictions independently (see instructions in the README on GitHub and <xref rid="appsec1" ref-type="sec">supplemental File S1</xref>). The final part of the inSPIRE core pipeline, “rescore” utilizes all available data for improved rescoring. This process generates all required features from search results, spectral predictions, and NetMHCpan-predicted binding affinities. Once all features are generated, inSPIRE calls Percolator to rescore the PSMs. These results are then benchmarked against Percolator rescoring without spectral features, and an HTML report is provided to the user (see the examples provided in <xref rid="appsec1" ref-type="sec">supplemental File S3</xref>). This report provides details of varying feature importance, feature distributions, and performance of the inSPIRE pipeline against Percolator with classical features (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). If inSPIRE-affinity was used, or binding affinity was selected as a validation technique, this report also shows the percentage of NetMHCpan-predicted binders that are identified.</p>
      <p id="p0375">In addition to the core functionality, inSPIRE also provides a calibration pipeline, which allows calibration of the collision energy setting passed to Prosit. The inSPIRE calibration pipeline is a simple pipeline as described by Wilhelm <italic>et al.</italic> (<xref rid="bib29" ref-type="bibr">29</xref>), where the highest scoring unmodified PSMs are considered based on search engine score, and spectral angles against Prosit predictions for each collision energy between 20 and 40 (inclusive) are generated. The collision energy that provides the highest mean spectral angle is selected as the recommended collision energy setting for further analysis.</p>
      <p id="p0380">In inSPIRE, we have introduced a number of changes to the feature set and feature selection approaches compared with other spectral rescoring pipelines such as Prosit rescoring and MS<sup>2</sup>Rescore. For example, rather than providing features matching y- and b-ions, we distinguished between the dominant ion series (the series with greater predicted coverage) and the lesser ion series. While this is unlikely to impact tryptic proteome digestion datasets, where the y-series is generally dominant, we found it a more useful distinction for HLA-I immunopeptidome rescoring, where there is more variation in which ion series is dominant. We also found that considering <italic>m/z</italic> error on the MS2 fragment ions was a useful feature. We provide a full description of all features used by inSPIRE in <xref rid="appsec1" ref-type="sec">supplemental Table S1</xref>.</p>
      <p id="p0385">Compared with other pipelines, another major change was the use of features from a Prosit-<italic>delta</italic> predictor (see the <xref rid="sec1" ref-type="sec">Experimental Procedures</xref> section). In our ground truth datasets, we found that swapping the position of certain pairs of adjacent amino acids in the true peptide sequence led to a very small change in the PSM spectral angle. We termed this change the “Prosit-<italic>delta</italic>.” In early development of inSPIRE, peptides that had a small Prosit-<italic>delta</italic> were often misassigned in the ground truth datasets, resulting in incorrect (although similar) peptide sequences. While generating Prosit-predicted spectra and spectral angles for swaps of every pair of adjacent amino acid residues would massively increase the computational load of the pipeline, we aimed to use a less intensive predictor to estimate the sensitivity of Prosit at each fragmentation site of the peptide. Therefore, the aim of including these Prosit-<italic>delta</italic> predictor features was to identify the sensitivity of the Prosit MS2 spectral prediction to minor changes in amino acid residue positions. These <italic>delta</italic> predictions are not available for the inSPIRE-MS<sup>2</sup>PIP pipeline (see the <xref rid="sec1" ref-type="sec">Experimental Procedures</xref> section for full details on the technical aspects of the Prosit-<italic>delta</italic> predictor).</p>
      <p id="p0390">In addition to its aforedescribed flexibility, inSPIRE provides several options to allow for manual feature inclusion or exclusion by the user. For example, if the user had a very small dataset where some features in the standard inSPIRE feature set could lead to the introduction of bias, they can simply add a list of “excludeFeatures” to the inSPIRE config file. Furthermore, if the user was particularly interested in certain sequence identifications and wished to examine their MS2 spectra more closely, inSPIRE provides a plotting tool, which generates pair plots in pdf format and compare the experimental MS2 spectrum to the Prosit-predicted MS2 spectrum. An example of these plots for PSMs of varying quality is provided in <xref rid="appsec1" ref-type="sec">supplemental File S4</xref>. All that is required is to select the rows of interest from the inSPIRE final assignments or provide a csv file with the peptides of interest along with their source file and scan number. This functionality may be of particular interest to users who wish to use inSPIRE, for example, for epitope target discovery in immunopeptidomics.</p>
    </sec>
    <sec id="sec2.2">
      <title>inSPIRE Boosts PSM Identifications in HLA-I Immunopeptidomes and Tryptic Proteome Digestions</title>
      <p id="p0395">We focused our initial benchmarking of inSPIRE against the Prosit rescoring pipeline and the MS<sup>2</sup>Rescore pipeline with MaxQuant search results as well as comparing it with a baseline rescoring without the use of spectral prediction. For comparison between the pipelines, we attempted to provide as fair a comparison between tools as possible; thereby, we reran the final Percolator rescoring with the same command line arguments used for all pipelines (see the <xref rid="sec1" ref-type="sec">Experimental Procedures</xref> section for details). However, one area of difference, which we could not correct for, was the fact that the current release of MS<sup>2</sup>Rescore dropped PSMs with duplicate scan numbers, meaning that chimeric spectra could not be discovered. This feature might be changed in the next release of MS<sup>2</sup>Rescore (personal communication), when we would expect an increase in PSMs identified.</p>
      <p id="p0400">We applied all pipelines—that is, Prosit rescoring, inSPIRE, inSPIRE-affinity, MS<sup>2</sup>Rescore, inSPIRE-MS<sup>2</sup>PIP, and inSPIRE-MS<sup>2</sup>PIP-affinity—to HLA-I immunopeptidomes derived from K562-A∗02:01 (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, <italic>A</italic>–<italic>E</italic> and <xref rid="appsec1" ref-type="sec">supplemental Fig. S2</xref>, <italic>A</italic> and <italic>B</italic>) and K562-B∗07:02 (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, <italic>F</italic>–<italic>J</italic> and <xref rid="appsec1" ref-type="sec">supplemental Fig. S2</xref>, <italic>C</italic> and <italic>D</italic>) cell lines and tryptic proteome digestions derived from K562 cell lines (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, <italic>K</italic>–<italic>M</italic>). Since the Prosit rescoring web server allowed only a single MS file per search, we analyzed a single MS file for both HLA-I immunopeptidomes (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, <italic>A</italic>–<italic>J</italic>) and tryptic proteome digestions (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, <italic>K</italic>–<italic>M</italic>).</p>
      <p id="p0405">In our initial MaxQuant analysis, we used a reference database informed by RNA sequencing of K562 cell lines, which consisted of 43,578 entries. Then, we repeated the analysis using the full Gencode reference database, which consisted of 100,551 entries. This strategy allowed evaluation of the impact of the reference database size on the PSM yield of inSPIRE compared with the other pipelines in the range of estimated FDRs 1 to 5% (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, <italic>A</italic>–<italic>M</italic>). We focused our analysis of the peptides identified on PSMs identified at 1% FDR as this is the most commonly employed FDR threshold in recent proteomics and immunopeptidomics studies (<xref rid="fig2" ref-type="fig">Fig. 2</xref> and <xref rid="appsec1" ref-type="sec">supplemental Figs. S2–S5</xref>).</p>
      <p id="p0410">It has already been demonstrated that the Prosit rescoring pipeline and MS<sup>2</sup>Rescore significantly increase PSM yield over baseline rescoring without spectral prediction (<xref rid="bib29" ref-type="bibr">29</xref>, <xref rid="bib30" ref-type="bibr">30</xref>). Similarly, we observed a significant impact of inSPIRE, with more than a 150% increase in PSMs discovered at 1% FDR for all immunopeptidome datasets as compared with the baseline rescoring (<xref rid="appsec1" ref-type="sec">supplemental Fig. S2</xref>).</p>
      <p id="p0415">For rescoring pipelines using spectral prediction applied to HLA-I immunopeptidomes, inSPIRE identified a slightly higher number of PSMs (4–6% increase) compared with the Prosit Rescoring pipeline, and inSPIRE-affinity showed the highest PSM yield (8–9% increase on the Prosit Rescoring pipeline). The increase in PSMs identified between Prosit Rescoring and inSPIRE using MS<sup>2</sup>PIP (3–6% increase) was similar to the increase of inSPIRE over Prosit Rescoring. In each case, MS<sup>2</sup>Rescore identified the fewest PSMs at 1% FDR (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, <italic>A</italic>, <italic>C</italic>, <italic>F</italic> and <italic>H</italic>). In the case of the immunopeptidome dataset, this difference was unlikely to be explained entirely by the dropping of chimeric MS2 spectra; it may be more related to the fact that MS<sup>2</sup>Rescore uses 100 features in its rescoring as opposed to the 40 features used by Prosit Rescoring and the 41 to 42 features used by inSPIRE and inSPIRE-affinity. This larger feature set may be less suitable when rescoring small immunopeptidome datasets as there is a greater risk of overfitting with a large number of features and a smaller dataset, leading to a reduced number of PSMs identified when cross-validation is applied within Percolator. In contrast to the performances on HLA-I immunopeptidomes, the performance of inSPIRE, Prosit Rescoring, and inSPIRE-MS<sup>2</sup>PIP was very similar on the tryptic proteome digestion dataset using both RNA-informed and full Gencode reference databases, with a marginal improvement in PSM yield by inSPIRE over Prosit Rescoring and a marginal increase by Prosit Rescoring over inSPIRE-MS<sup>2</sup>PIP (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, <italic>K</italic> and <italic>L</italic>). Again, fewer PSMs were identified by MS<sup>2</sup>Rescore, although, in this case, the difference could almost entirely be explained by the removal of chimeric MS2 spectra in the MS<sup>2</sup>Rescore pipeline. The number of unique scans identified at 1% FDR was very similar for all pipelines, with all identifying approximately 30,000 unique scans.</p>
      <p id="p0420">To validate the assignments of each pipeline, we initially computed the percentage of peptides, identified at 1% FDR for each pipeline, which were predicted to bind the cognate HLA-I allele by NetMHCpan among the peptides identified in the HLA-I immunopeptidomes. This percentage was high and similar across all pipelines (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, <italic>B</italic>, <italic>D</italic>, <italic>G</italic> and <italic>I</italic>). As a second validation step, we computed the percentage of peptides, identified using the Gencode reference database by each pipeline, which were also identified using RNA-informed reference database. The analysis of these metrics also pointed toward a reliable peptide identification in both HLA-I immunopeptidomes and tryptic proteome digestions (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, <italic>E</italic>, <italic>J</italic> and <italic>M</italic>).</p>
      <p id="p0425">By examining the incremental PSMs discovered by competing pipelines, that is, the PSMs exclusively discovered by one pipeline but not the other, we observed greater variation in these two validation metrics. We performed such “head-to-head” analysis for inSPIRE against baseline rescoring (<xref rid="appsec1" ref-type="sec">supplemental Fig. S2</xref>), inSPIRE against Prosit Rescoring (<xref rid="appsec1" ref-type="sec">supplemental Fig. S3</xref>), inSPIRE-affinity against inSPIRE (<xref rid="appsec1" ref-type="sec">supplemental Fig. S4</xref>), and inSPIRE-MS<sup>2</sup>PIP against MS<sup>2</sup>Rescore (<xref rid="appsec1" ref-type="sec">supplemental Fig. S5</xref>). The best performance on each metric was invariably observed in the pool of PSMs shared between pipelines. However, the incremental PSMs from the pipeline that identified the greater number of PSMs at 1% FDR generally showed higher values for the two validation metrics over the competing pipeline that identified fewer PSMs. Overall, we found that peptides exclusively identified by inSPIRE variants showed a higher percentage of peptides predicted to be HLA-I binders compared with those peptides that were exclusively identified by the baseline, Prosit rescoring, and MS<sup>2</sup>Rescore. Furthermore, in the latter comparisons, peptides exclusively identified by inSPIRE variants using the Gencode reference database were more frequently identified using RNA-informed reference database (<xref rid="appsec1" ref-type="sec">supplemental Figs. S2</xref>, <xref rid="appsec1" ref-type="sec">S3</xref> and <xref rid="appsec1" ref-type="sec">S5</xref>). Only two exceptions broke this homogenous pattern: (i) the percentage of peptides predicted to be HLA-I binders in the K562-B∗07:02 HLA-I immunopeptidomes using RNA-informed reference database comparing inSPIRE against Prosit rescoring pipeline (<xref rid="appsec1" ref-type="sec">supplemental Fig. S3</xref><italic>C</italic>); (ii) the percentage of peptides identified using the Genecode reference database that were also identified using the RNA-informed reference database in the K562-B∗07:02 HLA-I immunopeptidomes comparing inSPIRE-MS<sup>2</sup>PIP against MS<sup>2</sup>Rescore (<xref rid="appsec1" ref-type="sec">supplemental Fig. S5</xref><italic>B</italic>). These exceptions may indicate a level of noise in our validation metrics (see the caveats described in the <xref rid="sec1" ref-type="sec">Experimental Procedures</xref> section). However, overall, the evidence across all incremental PSM comparisons (<xref rid="appsec1" ref-type="sec">supplemental Figs. S2–S5</xref>) and pipelines (<xref rid="fig2" ref-type="fig">Fig. 2</xref>) indicated a consistent quality in the PSMs identified by Percolator at 1% FDR for each pipeline.</p>
      <p id="p0430">In addition to these independent metrics, we also examined MS2 coverage and spectral angle distribution for the incremental PSMs discovered by competing pipelines (<xref rid="appsec1" ref-type="sec">supplemental Figs. S2–S5</xref>), which could provide some insight into the features prioritized by each pipeline. Not surprisingly, we found that the PSMs identified by inSPIRE only had significant higher spectral angle distribution compared with the baseline rescoring pipeline, which does not use features from Prosit (<xref rid="appsec1" ref-type="sec">supplemental Fig. S2</xref>). Furthermore, PSMs exclusively identified by inSPIRE but not Prosit Rescoring typically had a greater MS2 coverage but a lower spectral angle than those exclusively identified by Prosit Rescoring but not by inSPIRE (<xref rid="appsec1" ref-type="sec">supplemental Fig. S3</xref>). In our comparison of inSPIRE-affinity to the standard inSPIRE pipeline, we noted that the incremental PSMs identified by inSPIRE-affinity showed higher mean spectral angle and MS2 coverage over inSPIRE standard, despite the added importance of binding affinity (<xref rid="appsec1" ref-type="sec">supplemental Fig. S4</xref>). Therefore, inSPIRE-affinity did not only identify peptides with higher HLA-I-peptide binding affinities but also with overall better spectral features. This suggested that the MS2 spectral and HLA-I-peptide binding affinity prediction features worked effectively in concert rather than one aspect being solely prioritized over the other. The MS<sup>2</sup>Rescore pipeline did not compute spectral angle between the experimental and MS<sup>2</sup>PIP predicted MS2 spectra. Therefore, it should not come as a surprise that the mean spectral angle was greater for the PSMs identified exclusively by inSPIRE-MS<sup>2</sup>PIP than for PSMs identified exclusively by MS<sup>2</sup>Rescore (<xref rid="appsec1" ref-type="sec">supplemental Fig. S5</xref>).</p>
      <p id="p0435">To study the impact of inSPIRE on PSM yield as compared with Prosit rescoring on a wide variety of HLA-I alleles, we performed rescoring on 12 monoallelic HLA-I cell lines from the large HLA-I immunopeptidome dataset published by Sarkizova <italic>et al.</italic> (<xref rid="bib51" ref-type="bibr">51</xref>). For this analysis, we focused on acquiring data using diverse HLA-I alleles and included datasets where peptide sequence motifs were less well understood (<italic>e.g.</italic>, the HLA-G alleles). This strategy allowed testing of the effect of inSPIRE-affinity in such challenging settings. Overall, we found that the resulting peptide sequence motifs from Prosit rescoring compared with inSPIRE rescoring were extremely similar (<xref rid="appsec1" ref-type="sec">supplemental Fig. S6</xref>). However, with regard to peptide identification, we observed a 0.1 to 7.6% increase (mean = 3.1%) in PSMs identified at 1% FDR with the inSPIRE pipeline over the Prosit rescoring pipeline and 0.6 to 10.6% increase (mean = 4.2%) over Prosit rescoring when using the inSPIRE-affinity pipeline (<xref rid="appsec1" ref-type="sec">supplemental Fig. S7</xref>).</p>
      <p id="p0440">We then compared the percentage of peptides predicted by NetMHCpan to be either binders or strong binders of the cognate HLA-I complex and identified at 1% FDR across different HLA-I alleles with a broad range of NetMHCpan performance (<xref rid="appsec1" ref-type="sec">supplemental Fig. S8</xref>). In this analysis, the variation in the percentage of peptides predicted to be HLA-I binders was larger between HLA-I alleles than between pipelines. In addition, in those HLA-I alleles for which NetMHCpan prediction reported a low NetMHCpan’s PPV, that is, where the HLA-I-peptide binding affinity was not efficiently predicted by NetMHCpan, inSPIRE-affinity showed a similar percentage of peptides predicted to be HLA-I binders than the other pipelines. This further indicates that inSPIRE-affinity did not blindly assign peptides based on predicted HLA-I-peptide binding affinity alone, particularly when the HLA-I-peptide binding affinity prediction was less reliable.</p>
    </sec>
    <sec id="sec2.3">
      <title>inSPIRE Shows High Specificity and Stable Performance on Ground Truth Datasets of Varying Size</title>
      <p id="p0445">Although the validation analyses performed so far suggested a high performance of inSPIRE and inSPIRE-affinity, we wished to further verify that the increased PSM yield observed by applying inSPIRE pipelines was due to an improved sensitivity of inSPIRE compared with the other pipelines, rather than the result of spurious identifications. To this end, we applied inSPIRE, Prosit Rescoring, and the baseline rescoring to ground truth datasets of synthetic peptide libraries of pathogen-derived 9, 10, and 15 amino acid long peptides (<xref rid="appsec1" ref-type="sec">supplemental File S5</xref>). The ground truth dataset construction followed the approach described by Cormican <italic>et al.</italic> (<xref rid="bib54" ref-type="bibr">54</xref>) and is explained in the <xref rid="sec1" ref-type="sec">Experimental Procedures</xref> section. The pipelines’ benchmarking on a ground truth dataset containing PSMs with characteristics similar to HLA-I immunopeptidomes could let us estimate the precision—that is, number of correctly identified peptides over the number of identified peptides—and recall—that is number of correctly identified peptides over the number of correct peptides—of a given method. The computation of PR is a standard strategy for performance evaluation of binary predictors and has also been applied to proteomics in other contexts (<xref rid="bib56" ref-type="bibr">56</xref>, <xref rid="bib57" ref-type="bibr">57</xref>). Optimal performance in terms of PR would show a tool achieving close to the maximum possible recall while maintaining high precision until very low scoring thresholds lead to a steep drop. The maximum possible recall for each rescoring pipeline was the fraction of the true PSMs correctly identified by the initial search engine at any identification cutoff. Hence, a lower limit on the recall indicates that there were more incorrect assignments in the original database search.</p>
      <p id="p0450">Within the immunopeptidomics field, we observed that implementing Percolator with a standard feature set on small datasets could lead to a lower precision (<xref rid="bib13" ref-type="bibr">13</xref>). Therefore, we tested inSPIRE performance in ground truth datasets with increasing size, from a mean of just under 3000 total PSMs using two RAW files to over 12,000 PSMs from eight RAW files (<xref rid="fig3" ref-type="fig">Fig. 3</xref>). To remove the effects of different performance on different RAW files, we performed rescoring on four sets of two RAW files (<xref rid="fig3" ref-type="fig">Fig. 3</xref><italic>A</italic>), two sets of four RAW files (<xref rid="fig3" ref-type="fig">Fig. 3</xref><italic>B</italic>), and a single set of eight RAW files (<xref rid="fig3" ref-type="fig">Fig. 3</xref><italic>C</italic>) and calculated PR across all sets (see <xref rid="sec1" ref-type="sec">Experimental Procedures</xref> section for more details). In the case of inSPIRE, we observed stable performance on all ground truth datasets, even when rescoring was performed on a small number of PSMs (<xref rid="fig3" ref-type="fig">Fig. 3</xref><italic>A</italic>).</p>
      <p id="p0455">For the baseline rescoring, we observed very similar performance no matter the size of the dataset, achieving 19 to 20% recall at 99% precision for any dataset size. The pipelines using spectral prediction saw a steady increase in performance with dataset size. The Prosit rescoring pipeline increased from 32% recall at 99% precision when rescoring on two RAW files (<xref rid="fig3" ref-type="fig">Fig. 3</xref><italic>A</italic>), to 36% recall at 99% precision when rescoring on four RAW files (<xref rid="fig3" ref-type="fig">Fig. 3</xref><italic>B</italic>), to 38% recall at 99% precision when rescoring on all eight RAW files (<xref rid="fig3" ref-type="fig">Fig. 3</xref><italic>C</italic>). Similarly, with inSPIRE, at 99% precision, we observed the recall of 36% when rescoring on two RAW files (<xref rid="fig3" ref-type="fig">Fig. 3</xref><italic>A</italic>), 40% when rescoring on four RAW files (<xref rid="fig3" ref-type="fig">Fig. 3</xref><italic>B</italic>), and 41% when rescoring on eight RAW files (<xref rid="fig3" ref-type="fig">Fig. 3</xref><italic>C</italic>). Therefore, under all conditions, we observed a performance improvement of inSPIRE over Prosit rescoring (<xref rid="fig3" ref-type="fig">Fig. 3</xref>, <italic>A</italic>–<italic>C</italic>), which was in line with the increase in PSMs observed on the HLA-I immunopeptidome datasets (<xref rid="fig2" ref-type="fig">Fig. 2</xref>). Hence, the results on the ground truth datasets provided further validation of the results on the HLA-I immunopeptidome datasets. To note, both Prosit-rescoring and inSPIRE obtained on average 98% precision at their respective estimated 1% FDRs across all datasets, indicating a slight underestimation of the FDR for both tools in these experimental conditions (<xref rid="fig3" ref-type="fig">Fig. 3</xref>, <italic>A</italic>–<italic>C</italic>).</p>
    </sec>
    <sec id="sec2.4">
      <title>inSPIRE Is Performant on Larger Scale Datasets and Across Search Engines</title>
      <p id="p0460">In contrast to Prosit rescoring pipeline, inSPIRE supports multiple MS files in a single run and can be combined with various database search engines (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). To estimate how inSPIRE would perform on results from larger datasets—for example, derived from multiple MS files—and different search engines, we tested inSPIRE on larger datasets of HLA-I immunopeptidomes and tryptic proteome digestions than those investigated in <xref rid="fig2" ref-type="fig">Figure 2</xref>. Indeed, we applied inSPIRE to search results from three MS files of K562-B∗07:02-derived HLA-I immunopeptidomes (<xref rid="fig4" ref-type="fig">Fig. 4</xref>, <italic>A</italic> and <italic>B</italic>). As reference database, we use both RNA-informed and Gencode reference databases, thereby evaluating the impact of the reference database size on inSPIRE’s PSM yield. Rescoring with inSPIRE increased the PSM yield at 1% FDR for all search engines by 31 to 33% for PEAKS DB, 225 to 281% for Mascot, and 120 to 127% for MaxQuant compared with the baseline Percolator rescoring. Interestingly, the larger increase in PSMs using inSPIRE with PEAKS DB and MaxQuant was observed when using the RNA-informed rather than Gencode reference database. The best performance came from the rescoring of PEAKS DB search results with a 15 to 18% increase over MaxQuant results (<xref rid="fig4" ref-type="fig">Fig. 4</xref>, <italic>A</italic> and <italic>B</italic>).</p>
      <p id="p0465">As with the performance using a single technical replicate (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, <italic>E</italic>, <italic>J</italic> and <italic>M</italic>), we observed a high and comparable percentage of peptides identified at 1% FDR when searching the Gencode reference database, which were also found in the search results of the RNA-informed reference database, with a minimum of 98.2% for Mascot search results after rescoring with inSPIRE and a maximum of 99.0% for the PEAKS DB baseline (<xref rid="fig4" ref-type="fig">Fig. 4</xref><italic>C</italic>).</p>
      <p id="p0470">We performed the same analysis on six MS files from K562 cell tryptic proteome digestions using MaxQuant, Mascot, and PEAKS DB. inSPIRE rescoring improved the PSM yield of all search engines compared with the baseline Percolator rescoring, which was even more pronounced than the HLA-I immunopeptidome datasets. As with the HLA-I immunopeptidome datasets, the best identification rate was achieved with inSPIRE rescoring of PEAKS DB search results (<xref rid="fig4" ref-type="fig">Fig. 4</xref>, <italic>D</italic> and <italic>E</italic>).</p>
      <p id="p0475">While the percentage of peptides identified using the Gencode reference database identified also using the RNA-informed reference database was high and consistent for results with Mascot and PEAKS with and without rescoring, a slight decrease of this percentage was observed by applying the inSPIRE rescoring to MaxQuant results (from 98.9% to 97.2% of identified peptides; <xref rid="fig4" ref-type="fig">Fig. 4</xref><italic>F</italic>).</p>
      <p id="p0480">The most remarkable variation in search engine performance from HLA-I immunopeptidome to tryptic proteome digestion searches came from Mascot. Indeed, this search engine identified the fewest PSMs on the HLA-I immunopeptidome datasets although showed performance similar to PEAKS DB on the tryptic proteome digestion search results (<xref rid="fig4" ref-type="fig">Fig. 4</xref>, <italic>A</italic>, <italic>B</italic>, <italic>D</italic> and <italic>E</italic>). This is in line with results obtained with other approaches (<xref rid="bib13" ref-type="bibr">13</xref>).</p>
      <p id="p0485">More generally, inSPIRE rescoring was particularly impactful relative to the original search engine choice in the enlarged HLA-I immunopeptidome search space. Indeed, rescoring of MaxQuant search results in the tryptic proteome digestion search space still provided fewer identifications than PEAKS DB and Mascot baseline results. In opposite, in the HLA-I immunopeptidome results, even Mascot, the lowest performing search engine in this case, identified more PSMs after rescoring than PEAKS DB without rescoring at 1% FDR (<xref rid="fig4" ref-type="fig">Fig. 4</xref>, <italic>A</italic> and <italic>B</italic>).</p>
      <p id="p0490">To understand the impact of the search engines on the pool of identified peptides, we analyzed the overlap among peptides identified using the three search engines with and without inSPIRE (<xref rid="appsec1" ref-type="sec">supplemental Fig. S9</xref>). In the HLA-I immunopeptidome dataset, we observed that inSPIRE rescoring led to a particularly large increase in the number of shared identified peptides among the search engines (<xref rid="appsec1" ref-type="sec">supplemental Fig. S9</xref>, <italic>A</italic> and <italic>B</italic>). In the tryptic proteome digestion dataset, the impact was less striking since even without inSPIRE rescoring, the majority of the identified peptides were discovered by all three search engines (<xref rid="appsec1" ref-type="sec">supplemental Fig. S9</xref>, <italic>C</italic> and <italic>D</italic>).</p>
      <p id="p0495">Furthermore, we investigated the impact of MS1 intensity on the ability of the search engines and inSPIRE rescoring to identify PSMs in HLA-I immunopeptidomes (<xref rid="appsec1" ref-type="sec">supplemental Fig. S10</xref>, <italic>A</italic>–<italic>C</italic>) and in tryptic proteome digestions (<xref rid="appsec1" ref-type="sec">supplemental Fig. S10</xref>, <italic>D</italic>–<italic>F</italic>). In HLA-I immunopeptidomes, PSMs identified by inSPIRE only showed significantly lower MS1 intensity distributions compared with PSMs identified by both inSPIRE and the search engines and inSPIRE. This suggested that the use of inSPIRE allowed the detection of lower intensity PSMs in HLA-I immunopeptidomics (<xref rid="appsec1" ref-type="sec">supplemental Fig. S10</xref>, <italic>A</italic>–<italic>C</italic>). Such differences were, however, absent when analyzing tryptic proteome digestion samples (<xref rid="appsec1" ref-type="sec">supplemental Fig. S10</xref>, <italic>D</italic>–<italic>F</italic>).</p>
    </sec>
    <sec id="sec2.5">
      <title>Insight into inSPIRE Optimization of Spectral Prediction Features by Modeling Amino Acid Pair Switch (Prosit-<italic>delta</italic>)</title>
      <p id="p0500">Beyond some improvements to the feature set and the integration of NetMHCpan predictions, the inSPIRE pipeline employs a novel approach to PSM rescoring, namely the prediction of the sensitivity of the Prosit MS2 spectrum prediction in case of switch of adjacent amino acid residue pairs. This switch (or permutation) had previously been noted by Collaert <italic>et al.</italic> (<xref rid="bib15" ref-type="bibr">15</xref>) as a difference that traditional search engines struggled to detect. This sensitivity, or lack thereof, is represented in the examples of Prosit MS2 spectrum prediction of the peptides MATYGWNLVK and AIKVLRGFKK identified in the synthetic peptide library samples (<xref rid="fig5" ref-type="fig">Fig. 5</xref>, <italic>A</italic> and <italic>B</italic>). For these peptides, we challenged Prosit MS2 spectrum prediction by switching the position of two adjacent amino acids and computed the difference in the spectral angle between the true and the modified peptides, which we named “Prosit-<italic>delta</italic>” value. In the case of the peptide MATYGWNLVK, the position switch between alanine (A) and threonine (T) in the true peptide MATYGWNLVK, which resulted in the modified peptide MTAYGWNLVK, led to a large Prosit-<italic>delta</italic> value, with the spectral angle dropping from 0.92 for the original sequence to 0.61 for the modified sequence (<xref rid="fig5" ref-type="fig">Fig. 5</xref><italic>C</italic>). In contrast, for the peptide AIKVLRGFKK, the switch in position between the phenylalanine (F) and lysine (K), which resulted in the theoretical peptide AIKVLRGKFK, led to a small Prosit-<italic>delta</italic> value (spectral angle drops from 0.88 to 0.86) as we saw only minor differences in predicted MS2 spectra between the original and the modified peptides (<xref rid="fig5" ref-type="fig">Fig. 5</xref><italic>D</italic>).</p>
      <p id="p0505">In early development of inSPIRE, we noticed that misassigned peptide sequences in the synthetic peptides’ ground truth datasets often occurred when a similar peptide sequence was found in the constructed reference database (data not shown); in particular, this often happened when a peptide sequence differed from the true peptide sequence without impacting on the spectral angle, that is, with a small Prosit-<italic>delta</italic> (see representative example in <xref rid="fig5" ref-type="fig">Fig. 5</xref>, <italic>B</italic> and <italic>D</italic>). Hence, we hypothesized that the distribution of these Prosit-<italic>delta</italic> values for each position in the sequence could be a useful feature in rescoring, and that sequences where the Prosit spectral angle was less sensitive to minor changes in amino acid position should be assigned with less confidence than those where the spectral angle was more sensitive. To avoid the heavy computational burden of generating Prosit-predicted spectra for all modified sequences, we developed a model to predict the Prosit-<italic>delta</italic> values as described in the <xref rid="sec1" ref-type="sec">Experimental Procedures</xref> section. To make the model as independent as possible of the datasets benchmarked with inSPIRE, we used large publicly available HLA-I immunopeptidome data from Paes <italic>et al.</italic> (<xref rid="bib39" ref-type="bibr">39</xref>) and Bassani-Sternberg <italic>et al.</italic> (<xref rid="bib40" ref-type="bibr">40</xref>), as well as the synthetic immunopeptide dataset used to train the Prosit model (<xref rid="bib29" ref-type="bibr">29</xref>) as training and test data (<xref rid="appsec1" ref-type="sec">supplemental Table S2</xref>). Peptide length and charge state distribution of the training data reflected those distributions typically observed in HLA-I immunopeptidome datasets (<xref rid="appsec1" ref-type="sec">supplemental Fig. S11</xref>, <italic>A</italic> and <italic>B</italic>). The peptide sequence motifs in the training dataset were evenly distributed, thereby confirming that we were not training the Prosit-<italic>delta</italic> predictor on peptides that were biased toward some specific sequence motifs (<xref rid="appsec1" ref-type="sec">supplemental Fig. S11</xref>, <italic>C</italic>–<italic>F</italic>).</p>
      <p id="p0510">The resulting Prosit-<italic>delta</italic> predictor was an ensemble learning–based model, which primarily focused on the local features of the permutation site, although further features such as precursor charge state were also considered (<xref rid="appsec1" ref-type="sec">supplemental Fig. S12</xref>). Interestingly, collision energy was one of the most important features, which highlights the need for careful calibration of Prosit before usage. The full feature set used by the Prosit-<italic>delta</italic> predictor is described in detail in <xref rid="appsec1" ref-type="sec">supplemental Table S3</xref>. Application of the trained Prosit-<italic>delta</italic> predictor to K562-A∗02:01 and K562-B∗07:02 HLA-I immunopeptidomes and tryptic proteome digestion dataset resulted in good performance (<xref rid="fig5" ref-type="fig">Fig. 5</xref>, <italic>E</italic> and <italic>F</italic>).</p>
      <p id="p0515">To understand the impact of these Prosit-<italic>delta</italic> predictions on inSPIRE performance, we rescored the search results of the HLA-I immunopeptidome and tryptic proteome digestion (<xref rid="fig2" ref-type="fig">Fig. 2</xref> and <xref rid="appsec1" ref-type="sec">supplemental Figs. S2–S4</xref>) with the Prosit-<italic>delta</italic> features excluded. We found that the Prosit-<italic>delta</italic> features had little to no impact when applied to the tryptic proteome digestion datasets, where the enzyme specificity reduced the search space and made the search engine more sensitive to changes in sequence (<xref rid="fig5" ref-type="fig">Fig. 5</xref><italic>G</italic>). On the HLA-I immunopeptidomes, the Prosit-<italic>delta</italic> implementation had an impact when the RNA-informed reference database was used, although the most impact was observed when the Gencode reference database was used (<xref rid="fig5" ref-type="fig">Fig. 5</xref><italic>H</italic> and <xref rid="appsec1" ref-type="sec">supplemental Fig. S13</xref>). For the search of the K562-B∗07:02 HLA-I immunopeptidome using the Gencode reference database, the increase in PSM yield over Prosit rescoring was almost entirely because of the Prosit-<italic>delta</italic> features (<xref rid="fig5" ref-type="fig">Fig. 5</xref><italic>H</italic>). As with the tryptic proteome digestions, the Prosit-<italic>delta</italic> features had little impact when applied to inSPIRE-affinity (<xref rid="fig5" ref-type="fig">Fig. 5</xref><italic>H</italic>). This could be explained by the fact that peptide sequence motifs driving the HLA-I-peptide–binding motifs—and, hence, the HLA-I-peptide binding affinity prediction—are already very sensitive to minor changes in peptide sequence. Therefore, in inSPIRE-affinity, the impact of Prosit-<italic>delta</italic> features might be attenuated by the impact of HLA-I-peptide–binding affinity prediction.</p>
      <p id="p0520">To validate these latter results, we again analyzed the percentage of peptides predicted by NetMHCpan to be HLA-I binders as well as the percentage of peptides identified using the Gencode reference database that were also identified using the RNA-informed reference database. As observed in the previous analyses, the various inSPIRE pipelines resulted in a high and comparable peptide percentage (<xref rid="appsec1" ref-type="sec">supplemental Fig. S14</xref>), which hinted toward a reliable peptide identification.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Discussion</title>
    <p id="p0525">The integration of MS2 spectral prediction with rescoring strategies is a fruitful area to boost MS identification performance and could find in the inSPIRE pipeline a versatile, high-performing, user-friendly, and open-source tool. The ability of inSPIRE to generate Prosit predictions on a standard CPU architecture significantly lowers the entry barrier for researchers, thereby “bringing Prosit to the people.” The standard implementation of inSPIRE has demonstrated similar performance to the Prosit Rescoring pipeline for search results of tryptic proteome digestions and improved performance for HLA-I immunopeptidomes. The integration of NetMHCpan prediction of HLA-I-peptide–binding affinity in inSPIRE-affinity pipeline raises the performance even further by optimizing inSPIRE for the analysis of HLA-I immunopeptidomes. In this study, the increased PSM identification rate of inSPIRE over the Prosit rescoring and MS<sup>2</sup>Rescore pipelines has further been validated by investigation of the peptides identified. We have observed consistency in the percentage of identified peptides predicted to bind to the cognate HLA-I complex and the percentage of peptides identified from the Gencode reference database that were validated by RNA sequencing evidence. Furthermore, we have demonstrated the improved recall of inSPIRE over Prosit rescoring at 99% precision on ground truth datasets. In comparison to Prosit rescoring, the inSPIRE pipeline also brings significant benefits in terms of data volume and flexibility across multiple search engines. We have demonstrated that inSPIRE can provide increased PSM identification rates in each of these scenarios. The ability to apply inSPIRE to PEAKS DB, in particular, allows for significant improvement over rescoring of MaxQuant search results. Finally, we provide a detailed documentation and a step-by-step user guide to achieve easy access to inSPIRE for both the coding-experienced and coding-inexperienced user.</p>
    <p id="p0530">The addition of the Prosit-<italic>delta</italic> predictor boosts identification rates and can open potential avenues for other features based on meta-analysis, that is, features considering not only the match between experimental and predicted MS2 spectrum of a given peptide but also the uniqueness and sensitivity of the prediction. These features showed a greater impact on analysis confronted with larger search spaces such as the full Gencode database. This suggests the Prosit-<italic>delta</italic> features may assist with the challenges raised by the expansion of database size through the increased interest in noncanonical peptide identification in proteomics and immunopeptidomics. For example, the impact of the database size on method performance has been demonstrated for post-translational spliced peptides (<xref rid="bib13" ref-type="bibr">13</xref>), and spectral prediction features as a solution for the search space size problem in proteogenomics have been proposed (<xref rid="bib31" ref-type="bibr">31</xref>).</p>
    <p id="p0535">As suggested by Verbruggen <italic>et al.</italic> (<xref rid="bib31" ref-type="bibr">31</xref>), we found the spectral prediction features far more impactful when dealing with the larger immunopeptidome search space compared with tryptic proteome digestion search spaces. Interestingly, this was not always the case when comparing results from the full Gencode reference database to the results from the RNA-informed reference databases. In fact, the increase in PSMs identified by applying inSPIRE and Prosit rescoring compared with the baseline, which was observed on the K562-B∗07:02 HLA-I immunopeptidomes, showed to be larger when the RNA-informed reference database rather than the full Gencode reference database was used. This could point toward a limitation on the potential improvement in peptide yield on rescoring, when the true peptide is not selected by the original search engine at any confidence threshold, and, hence, cannot be found through rescoring. This limitation may also contribute to the lack of variation between inSPIRE and Prosit Rescoring pipelines for the search results of the tryptic proteome digestions. In this case, the number of MS2 scans left unidentified in the rescored search results was similar to the number of decoy hits in the search results. Hence, any great increase in identification rate on the tryptic proteome digestion datasets would have to be treated with a certain degree of suspicion.</p>
    <p id="p0540">In conclusion, we speculate that the application of rescoring pipelines using MS2 spectral features will become the standard approach to tackle large search space problems in proteogenomics. We, here, provide a fully open-source tool, inSPIRE, which can aid flexible MS analysis pipeline development in a user-friendly manner in the future.</p>
  </sec>
  <sec sec-type="data-availability" id="sec4">
    <title>Data and Software Availability</title>
    <p id="p0545">Our MS proteomics data have been deposited to the ProteomeXchange Consortium <italic>via</italic> the PRIDE (<xref rid="bib58" ref-type="bibr">58</xref>) partner repository with the dataset identifiers PXD031709 (<xref rid="bib13" ref-type="bibr">13</xref>), PXD031812 (<xref rid="bib54" ref-type="bibr">54</xref>), and PXD034056.</p>
    <p id="p0550">The MS proteomics data published by Paes <italic>et al.</italic> (<xref rid="bib39" ref-type="bibr">39</xref>) are available at the PRIDE repository with the dataset identifier PXD015489.</p>
    <p id="p0555">The RNA sequencing data used for the analysis of our MS proteomics data have been deposited in the National Center for Biotechnology Information Sequence Read Archive database with the accession code PRJNA721129 (<xref rid="bib13" ref-type="bibr">13</xref>).</p>
    <p id="p0560">The inSPIRE software has been implemented with Python and is available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/QuantSysBio/inSPIRE" id="intref0015">https://github.com/QuantSysBio/inSPIRE</ext-link>).</p>
    <p id="p0565">The Prosit-<italic>delta</italic> training software has been implemented with Python and is available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/QuantSysBio/prosit-delta" id="intref0020">https://github.com/QuantSysBio/prosit-delta</ext-link>).</p>
    <p id="p0570">The modified version of the Prosit spectral prediction code is also available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/QuantSysBio/qsb-modified-prosit" id="intref0025">https://github.com/QuantSysBio/qsb-modified-prosit</ext-link>).</p>
    <p id="p0575">The models downloaded by the inSPIRE pipeline at run time have been deposited on figshare (<ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/software/inSPIRE_Models/20368035" id="intref0030">https://figshare.com/articles/software/inSPIRE_Models/20368035</ext-link>).</p>
    <p id="p0580">The RNA sequencing data generated by Peas <italic>et al.</italic> (<xref rid="bib39" ref-type="bibr">39</xref>) are available upon request to the authors.</p>
    <p id="p0585">Analyses were carried out in Python 3.8.</p>
    <p id="p0590">Figures have been generated in Python using the Plotly library and Logomaker for the sequence logo plots (<xref rid="bib59" ref-type="bibr">59</xref>). Postprocessing was done with Adobe Illustrator, version 26.2.</p>
    <p id="p0595">MS analysis was carried out with MaxQuant, version 1.16.17, Mascot, version 2.7.01, and PEAKS X Pro 10.6. Rescoring was carried out with Percolator, version 3.0.5. Preprocessing of MS RAW files for Mascot was performed with Mascot-Distiller, version 2.8.0.1, and RAW files were converted to mgf/mzML format for inSPIRE input using ms-convert GUI (ProteoWizard, version 3.0.9134) and ThermoRawFileParser, version 1.4.0, for input in Prosit-<italic>delta</italic> training pipeline (<xref rid="bib52" ref-type="bibr">52</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec5">
    <title>Supplemental data</title>
    <p id="p0600">This article contains <xref rid="appsec1" ref-type="sec">supplemental data</xref>.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p id="p0605">The authors declare no competing interests.</p>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <label>1</label>
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Abelin</surname>
            <given-names>J.G.</given-names>
          </name>
          <name>
            <surname>Keskin</surname>
            <given-names>D.B.</given-names>
          </name>
          <name>
            <surname>Sarkizova</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Hartigan</surname>
            <given-names>C.R.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Sidney</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mass spectrometry profiling of HLA-associated peptidomes in mono-allelic cells enables more accurate epitope prediction</article-title>
        <source>Immunity</source>
        <volume>46</volume>
        <year>2017</year>
        <fpage>315</fpage>
        <lpage>326</lpage>
        <pub-id pub-id-type="pmid">28228285</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <label>2</label>
      <element-citation publication-type="journal" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Aebersold</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Mann</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Mass-spectrometric exploration of proteome structure and function</article-title>
        <source>Nature</source>
        <volume>537</volume>
        <year>2016</year>
        <fpage>347</fpage>
        <lpage>355</lpage>
        <pub-id pub-id-type="pmid">27629641</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <label>3</label>
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Ouspenskaia</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Clauser</surname>
            <given-names>K.R.</given-names>
          </name>
          <name>
            <surname>Klaeger</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sarkizova</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Aguet</surname>
            <given-names>F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unannotated proteins expand the MHC-I-restricted immunopeptidome in cancer</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>40</volume>
        <year>2022</year>
        <fpage>209</fpage>
        <lpage>217</lpage>
        <pub-id pub-id-type="pmid">34663921</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <label>4</label>
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Verheggen</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Raeder</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Berven</surname>
            <given-names>F.S.</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Barsnes</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Vaudel</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Anatomy and evolution of database search engines-a central component of mass spectrometry based proteomic workflows</article-title>
        <source>Mass Spectrom. Rev.</source>
        <volume>39</volume>
        <year>2020</year>
        <fpage>292</fpage>
        <lpage>306</lpage>
        <pub-id pub-id-type="pmid">28902424</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <label>5</label>
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Kall</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>MacCoss</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>W.S.</given-names>
          </name>
        </person-group>
        <article-title>Posterior error probabilities and false discovery rates: two sides of the same coin</article-title>
        <source>J. Proteome Res.</source>
        <volume>7</volume>
        <year>2008</year>
        <fpage>40</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="pmid">18052118</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <label>6</label>
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Cravatt</surname>
            <given-names>B.F.</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>G.M.</given-names>
          </name>
          <name>
            <surname>Yates</surname>
            <given-names>J.R.</given-names>
            <suffix>3rd</suffix>
          </name>
        </person-group>
        <article-title>The biological impact of mass-spectrometry-based proteomics</article-title>
        <source>Nature</source>
        <volume>450</volume>
        <year>2007</year>
        <fpage>991</fpage>
        <lpage>1000</lpage>
        <pub-id pub-id-type="pmid">18075578</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <label>7</label>
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Caron</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Kowalewski</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Chiek Koh</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Sturm</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Analysis of major histocompatibility complex (MHC) immunopeptidomes using mass spectrometry</article-title>
        <source>Mol. Cell. Proteomics</source>
        <volume>14</volume>
        <year>2015</year>
        <fpage>3105</fpage>
        <lpage>3117</lpage>
        <pub-id pub-id-type="pmid">26628741</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <label>8</label>
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Barbosa</surname>
            <given-names>C.R.R.</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Shepherd</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Mishto</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Mechanistic diversity in MHC class I antigen recognition</article-title>
        <source>Biochem. J.</source>
        <volume>478</volume>
        <year>2021</year>
        <fpage>4187</fpage>
        <lpage>4202</lpage>
        <pub-id pub-id-type="pmid">34940832</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <label>9</label>
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <name>
            <surname>Liepe</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Holzhutter</surname>
            <given-names>H.G.</given-names>
          </name>
          <name>
            <surname>Bellavista</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Kloetzel</surname>
            <given-names>P.M.</given-names>
          </name>
          <name>
            <surname>Stumpf</surname>
            <given-names>M.P.</given-names>
          </name>
          <name>
            <surname>Mishto</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Quantitative time-resolved analysis reveals intricate, differential regulation of standard- and immuno-proteasomes</article-title>
        <source>Elife</source>
        <volume>4</volume>
        <year>2015</year>
        <object-id pub-id-type="publisher-id">e07545</object-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <label>10</label>
      <element-citation publication-type="journal" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Mishto</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Liepe</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Textoris-Taube</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Henklein</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Weberruss</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Proteasome isoforms exhibit only quantitative differences in cleavage and epitope generation</article-title>
        <source>Eur. J. Immunol.</source>
        <volume>44</volume>
        <year>2014</year>
        <fpage>3508</fpage>
        <lpage>3521</lpage>
        <pub-id pub-id-type="pmid">25231383</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <label>11</label>
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Mansurkhodzhaev</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Barbosa</surname>
            <given-names>C.R.R.</given-names>
          </name>
          <name>
            <surname>Mishto</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Liepe</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Proteasome-generated cis-spliced peptides and their potential role in CD8(+) T cell tolerance</article-title>
        <source>Front. Immunol.</source>
        <volume>12</volume>
        <year>2021</year>
        <object-id pub-id-type="publisher-id">614276</object-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <label>12</label>
      <element-citation publication-type="journal" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>Goodenough</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>T.M.</given-names>
          </name>
          <name>
            <surname>Zook</surname>
            <given-names>M.B.</given-names>
          </name>
          <name>
            <surname>Flanigan</surname>
            <given-names>K.M.</given-names>
          </name>
          <name>
            <surname>Atkins</surname>
            <given-names>J.F.</given-names>
          </name>
          <name>
            <surname>Howard</surname>
            <given-names>M.T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cryptic MHC class I-binding peptides are revealed by aminoglycoside-induced stop codon read-through into the 3' UTR</article-title>
        <source>Proc. Natl. Acad. Sci. U. S. A.</source>
        <volume>111</volume>
        <year>2014</year>
        <fpage>5670</fpage>
        <lpage>5675</lpage>
        <pub-id pub-id-type="pmid">24706797</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <label>13</label>
      <element-citation publication-type="journal" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Mishto</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Horokhovskyi</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Cormican</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Lynham</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Urlaub</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Database search engines and target database features impinge upon the identification of post-translationally cis-spliced peptides in HLA class I immunopeptidomes</article-title>
        <source>Proteomics</source>
        <volume>22</volume>
        <year>2022</year>
        <object-id pub-id-type="publisher-id">e2100226</object-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <label>14</label>
      <element-citation publication-type="journal" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Ruiz Cuevas</surname>
            <given-names>M.V.</given-names>
          </name>
          <name>
            <surname>Hardy</surname>
            <given-names>M.P.</given-names>
          </name>
          <name>
            <surname>Holly</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Bonneil</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Durette</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Courcelles</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Most non-canonical proteins uniquely populate the proteome or immunopeptidome</article-title>
        <source>Cell Rep.</source>
        <volume>34</volume>
        <year>2021</year>
        <object-id pub-id-type="publisher-id">108815</object-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <label>15</label>
      <element-citation publication-type="journal" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Colaert</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Degroeve</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Helsens</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Analysis of the resolution limitations of peptide identification algorithms</article-title>
        <source>J. Proteome Res.</source>
        <volume>10</volume>
        <year>2011</year>
        <fpage>5555</fpage>
        <lpage>5561</lpage>
        <pub-id pub-id-type="pmid">21995378</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <label>16</label>
      <element-citation publication-type="journal" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Krug</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Carpy</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Behrends</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Matic</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Soares</surname>
            <given-names>N.C.</given-names>
          </name>
          <name>
            <surname>Macek</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Deep coverage of the Escherichia coli proteome enables the assessment of false discovery rates in simple proteogenomic experiments</article-title>
        <source>Mol. Cell. Proteomics</source>
        <volume>12</volume>
        <year>2013</year>
        <fpage>3420</fpage>
        <lpage>3430</lpage>
        <pub-id pub-id-type="pmid">23908556</pub-id>
      </element-citation>
    </ref>
    <ref id="bib17">
      <label>17</label>
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>Kall</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Canterbury</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Weston</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>W.S.</given-names>
          </name>
          <name>
            <surname>MacCoss</surname>
            <given-names>M.J.</given-names>
          </name>
        </person-group>
        <article-title>Semi-supervised learning for peptide identification from shotgun proteomics datasets</article-title>
        <source>Nat. Methods</source>
        <volume>4</volume>
        <year>2007</year>
        <fpage>923</fpage>
        <lpage>925</lpage>
        <pub-id pub-id-type="pmid">17952086</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <label>18</label>
      <element-citation publication-type="journal" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Vitek</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Nesvizhskii</surname>
            <given-names>A.I.</given-names>
          </name>
        </person-group>
        <article-title>A statistical model-building perspective to identification of MS/MS spectra with PeptideProphet</article-title>
        <source>BMC Bioinformatics</source>
        <volume>13 Suppl 16</volume>
        <year>2012</year>
        <fpage>S1</fpage>
      </element-citation>
    </ref>
    <ref id="bib19">
      <label>19</label>
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>Searle</surname>
            <given-names>B.C.</given-names>
          </name>
        </person-group>
        <article-title>Scaffold: a bioinformatic tool for validating MS/MS-based proteomic studies</article-title>
        <source>Proteomics</source>
        <volume>10</volume>
        <year>2010</year>
        <fpage>1265</fpage>
        <lpage>1269</lpage>
        <pub-id pub-id-type="pmid">20077414</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <label>20</label>
      <element-citation publication-type="journal" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>The</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>MacCoss</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>W.S.</given-names>
          </name>
          <name>
            <surname>Kall</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate protein false discovery rates on large-scale proteomics data sets with percolator 3.0</article-title>
        <source>J. Am. Soc. Mass Spectrom.</source>
        <volume>27</volume>
        <year>2016</year>
        <fpage>1719</fpage>
        <lpage>1727</lpage>
        <pub-id pub-id-type="pmid">27572102</pub-id>
      </element-citation>
    </ref>
    <ref id="bib21">
      <label>21</label>
      <element-citation publication-type="journal" id="sref21">
        <person-group person-group-type="author">
          <name>
            <surname>Granholm</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>W.S.</given-names>
          </name>
          <name>
            <surname>Kall</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>A cross-validation scheme for machine learning algorithms in shotgun proteomics</article-title>
        <source>BMC Bioinformatics</source>
        <volume>13 Suppl 16</volume>
        <year>2012</year>
        <fpage>S3</fpage>
      </element-citation>
    </ref>
    <ref id="bib22">
      <label>22</label>
      <element-citation publication-type="journal" id="sref22">
        <person-group person-group-type="author">
          <name>
            <surname>Giese</surname>
            <given-names>S.H.</given-names>
          </name>
          <name>
            <surname>Sinn</surname>
            <given-names>L.R.</given-names>
          </name>
          <name>
            <surname>Wegner</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Rappsilber</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Retention time prediction using neural networks increases identifications in crosslinking mass spectrometry</article-title>
        <source>Nat. Commun.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>3237</fpage>
        <pub-id pub-id-type="pmid">34050149</pub-id>
      </element-citation>
    </ref>
    <ref id="bib23">
      <label>23</label>
      <element-citation publication-type="journal" id="sref23">
        <person-group person-group-type="author">
          <name>
            <surname>Bichmann</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Nelde</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Heumos</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Mohr</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Peltzer</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MHCquant: automated and reproducible data analysis for immunopeptidomics</article-title>
        <source>J. Proteome Res.</source>
        <volume>18</volume>
        <year>2019</year>
        <fpage>3876</fpage>
        <lpage>3884</lpage>
        <pub-id pub-id-type="pmid">31589052</pub-id>
      </element-citation>
    </ref>
    <ref id="bib24">
      <label>24</label>
      <element-citation publication-type="journal" id="sref24">
        <person-group person-group-type="author">
          <name>
            <surname>Silva</surname>
            <given-names>A.S.C.</given-names>
          </name>
          <name>
            <surname>Bouwmeester</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Degroeve</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Accurate peptide fragmentation predictions allow data driven approaches to replace and improve upon proteomics search engine scoring functions</article-title>
        <source>Bioinformatics</source>
        <volume>35</volume>
        <year>2019</year>
        <fpage>5243</fpage>
        <lpage>5248</lpage>
        <pub-id pub-id-type="pmid">31077310</pub-id>
      </element-citation>
    </ref>
    <ref id="bib25">
      <label>25</label>
      <element-citation publication-type="journal" id="sref25">
        <person-group person-group-type="author">
          <name>
            <surname>Elias</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Gibbons</surname>
            <given-names>F.D.</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>O.D.</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>F.P.</given-names>
          </name>
          <name>
            <surname>Gygi</surname>
            <given-names>S.P.</given-names>
          </name>
        </person-group>
        <article-title>Intensity-based protein identification by machine learning from a library of tandem mass spectra</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>22</volume>
        <year>2004</year>
        <fpage>214</fpage>
        <lpage>219</lpage>
        <pub-id pub-id-type="pmid">14730315</pub-id>
      </element-citation>
    </ref>
    <ref id="bib26">
      <label>26</label>
      <element-citation publication-type="journal" id="sref26">
        <person-group person-group-type="author">
          <name>
            <surname>Degroeve</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>MS2PIP: a tool for MS/MS peak intensity prediction</article-title>
        <source>Bioinformatics</source>
        <volume>29</volume>
        <year>2013</year>
        <fpage>3199</fpage>
        <lpage>3203</lpage>
        <pub-id pub-id-type="pmid">24078703</pub-id>
      </element-citation>
    </ref>
    <ref id="bib27">
      <label>27</label>
      <element-citation publication-type="journal" id="sref27">
        <person-group person-group-type="author">
          <name>
            <surname>Degroeve</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Maddelein</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>MS2PIP prediction server: compute and visualize MS2 peak intensity predictions for CID and HCD fragmentation</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>43</volume>
        <year>2015</year>
        <fpage>W326</fpage>
        <lpage>W330</lpage>
        <pub-id pub-id-type="pmid">25990723</pub-id>
      </element-citation>
    </ref>
    <ref id="bib28">
      <label>28</label>
      <element-citation publication-type="journal" id="sref28">
        <person-group person-group-type="author">
          <name>
            <surname>Gessulat</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Zolg</surname>
            <given-names>D.P.</given-names>
          </name>
          <name>
            <surname>Samaras</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Schnatbaum</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Zerweck</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prosit: proteome-wide prediction of peptide tandem mass spectra by deep learning</article-title>
        <source>Nat. Methods</source>
        <volume>16</volume>
        <year>2019</year>
        <fpage>509</fpage>
        <lpage>518</lpage>
        <pub-id pub-id-type="pmid">31133760</pub-id>
      </element-citation>
    </ref>
    <ref id="bib29">
      <label>29</label>
      <element-citation publication-type="journal" id="sref29">
        <person-group person-group-type="author">
          <name>
            <surname>Wilhelm</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zolg</surname>
            <given-names>D.P.</given-names>
          </name>
          <name>
            <surname>Graber</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Gessulat</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Schnatbaum</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning boosts sensitivity of mass spectrometry-based immunopeptidomics</article-title>
        <source>Nat. Commun.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>3346</fpage>
        <pub-id pub-id-type="pmid">34099720</pub-id>
      </element-citation>
    </ref>
    <ref id="bib30">
      <label>30</label>
      <element-citation publication-type="journal" id="sref30">
        <person-group person-group-type="author">
          <name>
            <surname>Declercq</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bouwmeester</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Hirschler</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Carapito</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Degroeve</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MS<sup>2</sup>Rescore: data-driven rescoring dramatically boosts immunopeptide identification rates</article-title>
        <source>Mol. Cell. Proteomics</source>
        <volume>21</volume>
        <year>2022</year>
        <object-id pub-id-type="publisher-id">100266</object-id>
      </element-citation>
    </ref>
    <ref id="bib31">
      <label>31</label>
      <element-citation publication-type="journal" id="sref31">
        <person-group person-group-type="author">
          <name>
            <surname>Verbruggen</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gessulat</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gabriels</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Matsaroki</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Van de Voorde</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Kuster</surname>
            <given-names>B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spectral prediction features as a solution for the search space size problem in proteogenomics</article-title>
        <source>Mol. Cell. Proteomics</source>
        <volume>20</volume>
        <year>2021</year>
        <object-id pub-id-type="publisher-id">100076</object-id>
      </element-citation>
    </ref>
    <ref id="bib32">
      <label>32</label>
      <element-citation publication-type="journal" id="sref32">
        <person-group person-group-type="author">
          <name>
            <surname>Gabriel</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>The</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zolg</surname>
            <given-names>D.P.</given-names>
          </name>
          <name>
            <surname>Bayer</surname>
            <given-names>F.P.</given-names>
          </name>
          <name>
            <surname>Shouman</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Lautenbacher</surname>
            <given-names>L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prosit-TMT: deep learning boosts identification of TMT-labeled peptides</article-title>
        <source>Anal. Chem.</source>
        <volume>94</volume>
        <year>2022</year>
        <fpage>7181</fpage>
        <lpage>7190</lpage>
        <pub-id pub-id-type="pmid">35549156</pub-id>
      </element-citation>
    </ref>
    <ref id="bib33">
      <label>33</label>
      <element-citation publication-type="journal" id="sref33">
        <person-group person-group-type="author">
          <name>
            <surname>Zolg</surname>
            <given-names>D.P.</given-names>
          </name>
          <name>
            <surname>Gessulat</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Paschke</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Graber</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Rathke-Kuhnert</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Seefried</surname>
            <given-names>F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>INFERYS rescoring: boosting peptide identifications and scoring confidence of database search results</article-title>
        <source>Rapid Commun. Mass Spectrom.</source>
        <year>2021</year>
        <object-id pub-id-type="publisher-id">e9128</object-id>
      </element-citation>
    </ref>
    <ref id="bib34">
      <label>34</label>
      <element-citation publication-type="journal" id="sref34">
        <person-group person-group-type="author">
          <name>
            <surname>Goloborodko</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Levitsky</surname>
            <given-names>L.I.</given-names>
          </name>
          <name>
            <surname>Ivanov</surname>
            <given-names>M.V.</given-names>
          </name>
          <name>
            <surname>Gorshkov</surname>
            <given-names>M.V.</given-names>
          </name>
        </person-group>
        <article-title>Pyteomics--a Python framework for exploratory data analysis and rapid software prototyping in proteomics</article-title>
        <source>J. Am. Soc. Mass Spectrom.</source>
        <volume>24</volume>
        <year>2013</year>
        <fpage>301</fpage>
        <lpage>304</lpage>
        <pub-id pub-id-type="pmid">23292976</pub-id>
      </element-citation>
    </ref>
    <ref id="bib35">
      <label>35</label>
      <element-citation publication-type="journal" id="sref35">
        <person-group person-group-type="author">
          <name>
            <surname>Levitsky</surname>
            <given-names>L.I.</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Ivanov</surname>
            <given-names>M.V.</given-names>
          </name>
          <name>
            <surname>Gorshkov</surname>
            <given-names>M.V.</given-names>
          </name>
        </person-group>
        <article-title>Pyteomics 4.0: five years of development of a Python proteomics framework</article-title>
        <source>J. Proteome Res.</source>
        <volume>18</volume>
        <year>2019</year>
        <fpage>709</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="pmid">30576148</pub-id>
      </element-citation>
    </ref>
    <ref id="bib36">
      <label>36</label>
      <element-citation publication-type="journal" id="sref36">
        <person-group person-group-type="author">
          <name>
            <surname>Jurtz</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Andreatta</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Marcatili</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>NetMHCpan-4.0: improved peptide-MHC class I interaction predictions integrating eluted ligand and peptide binding affinity data</article-title>
        <source>J. Immunol.</source>
        <volume>199</volume>
        <year>2017</year>
        <fpage>3360</fpage>
        <lpage>3368</lpage>
        <pub-id pub-id-type="pmid">28978689</pub-id>
      </element-citation>
    </ref>
    <ref id="bib37">
      <label>37</label>
      <element-citation publication-type="journal" id="sref37">
        <person-group person-group-type="author">
          <name>
            <surname>Reynisson</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Alvarez</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>NetMHCpan-4.1 and NetMHCIIpan-4.0: improved predictions of MHC antigen presentation by concurrent motif deconvolution and integration of MS MHC eluted ligand data</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>48</volume>
        <year>2020</year>
        <fpage>W449</fpage>
        <lpage>W454</lpage>
        <pub-id pub-id-type="pmid">32406916</pub-id>
      </element-citation>
    </ref>
    <ref id="bib38">
      <label>38</label>
      <element-citation publication-type="journal" id="sref38">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Lundegaard</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Blicher</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Lamberth</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Harndahl</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Justesen</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NetMHCpan, a method for quantitative predictions of peptide binding to any HLA-A and -B locus protein of known sequence</article-title>
        <source>PLoS One</source>
        <volume>2</volume>
        <year>2007</year>
        <fpage>e796</fpage>
        <pub-id pub-id-type="pmid">17726526</pub-id>
      </element-citation>
    </ref>
    <ref id="bib39">
      <label>39</label>
      <element-citation publication-type="journal" id="sref39">
        <person-group person-group-type="author">
          <name>
            <surname>Paes</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Leonov</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Partridge</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Chikata</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Murakoshi</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Frangou</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Contribution of proteasome-catalyzed peptide cis-splicing to viral targeting by CD8(+) T cells in HIV-1 infection</article-title>
        <source>Proc. Natl. Acad. Sci. U. S. A.</source>
        <volume>116</volume>
        <year>2019</year>
        <fpage>24748</fpage>
        <lpage>24759</lpage>
        <pub-id pub-id-type="pmid">31748275</pub-id>
      </element-citation>
    </ref>
    <ref id="bib40">
      <label>40</label>
      <element-citation publication-type="journal" id="sref40">
        <person-group person-group-type="author">
          <name>
            <surname>Bassani-Sternberg</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Chong</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Guillaume</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Solleder</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Pak</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Gannon</surname>
            <given-names>P.O.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deciphering HLA-I motifs across HLA peptidomes improves neo-antigen predictions and identifies allostery regulating HLA specificity</article-title>
        <source>PLoS Comput. Biol.</source>
        <volume>13</volume>
        <year>2017</year>
        <object-id pub-id-type="publisher-id">e1005725</object-id>
      </element-citation>
    </ref>
    <ref id="bib41">
      <label>41</label>
      <element-citation publication-type="journal" id="sref41">
        <person-group person-group-type="author">
          <name>
            <surname>Hughes</surname>
            <given-names>C.S.</given-names>
          </name>
          <name>
            <surname>Moggridge</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Muller</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Sorensen</surname>
            <given-names>P.H.</given-names>
          </name>
          <name>
            <surname>Morin</surname>
            <given-names>G.B.</given-names>
          </name>
          <name>
            <surname>Krijgsveld</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Single-pot, solid-phase-enhanced sample preparation for proteomics experiments</article-title>
        <source>Nat. Protoc.</source>
        <volume>14</volume>
        <year>2019</year>
        <fpage>68</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="pmid">30464214</pub-id>
      </element-citation>
    </ref>
    <ref id="bib42">
      <label>42</label>
      <element-citation publication-type="journal" id="sref42">
        <person-group person-group-type="author">
          <name>
            <surname>Gutman</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Gutman</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Sidney</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Chihab</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Mishto</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Liepe</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Predicting the success of Fmoc-based peptide synthesis</article-title>
        <source>ACS Omega</source>
        <volume>7</volume>
        <year>2022</year>
        <fpage>23771</fpage>
        <lpage>23781</lpage>
        <pub-id pub-id-type="pmid">35847273</pub-id>
      </element-citation>
    </ref>
    <ref id="bib43">
      <label>43</label>
      <element-citation publication-type="journal" id="sref43">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>N.L.</given-names>
          </name>
          <name>
            <surname>Rouphael</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Banton</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Maddur</surname>
            <given-names>M.S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metabolic phenotypes of response to vaccination in humans</article-title>
        <source>Cell</source>
        <volume>169</volume>
        <year>2017</year>
        <fpage>862</fpage>
        <lpage>877.e17</lpage>
        <pub-id pub-id-type="pmid">28502771</pub-id>
      </element-citation>
    </ref>
    <ref id="bib44">
      <label>44</label>
      <element-citation publication-type="journal" id="sref44">
        <person-group person-group-type="author">
          <name>
            <surname>Chiu</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>McCausland</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Sidney</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Duh</surname>
            <given-names>F.M.</given-names>
          </name>
          <name>
            <surname>Rouphael</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Broadly reactive human CD8 T cells that recognize an epitope conserved between VZV, HSV and EBV</article-title>
        <source>PLoS Pathog.</source>
        <volume>10</volume>
        <year>2014</year>
        <object-id pub-id-type="publisher-id">e1004008</object-id>
      </element-citation>
    </ref>
    <ref id="bib45">
      <label>45</label>
      <element-citation publication-type="journal" id="sref45">
        <person-group person-group-type="author">
          <name>
            <surname>Weiskopf</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Angelo</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Grifoni</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>O'Rourke</surname>
            <given-names>P.H.</given-names>
          </name>
          <name>
            <surname>Sidney</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HLA-DRB1 alleles are associated with different magnitudes of dengue virus-specific CD4+ T-cell responses</article-title>
        <source>J. Infect. Dis.</source>
        <volume>214</volume>
        <year>2016</year>
        <fpage>1117</fpage>
        <lpage>1124</lpage>
        <pub-id pub-id-type="pmid">27443615</pub-id>
      </element-citation>
    </ref>
    <ref id="bib46">
      <label>46</label>
      <element-citation publication-type="journal" id="sref46">
        <person-group person-group-type="author">
          <name>
            <surname>Weiskopf</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Angelo</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>de Azeredo</surname>
            <given-names>E.L.</given-names>
          </name>
          <name>
            <surname>Sidney</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Greenbaum</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Fernando</surname>
            <given-names>A.N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive analysis of dengue virus-specific responses supports an HLA-linked protective role for CD8+ T cells</article-title>
        <source>Proc. Natl. Acad. Sci. U. S. A.</source>
        <volume>110</volume>
        <year>2013</year>
        <fpage>E2046</fpage>
        <lpage>E2053</lpage>
        <pub-id pub-id-type="pmid">23580623</pub-id>
      </element-citation>
    </ref>
    <ref id="bib47">
      <label>47</label>
      <element-citation publication-type="journal" id="sref47">
        <person-group person-group-type="author">
          <name>
            <surname>Weiskopf</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Angelo</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Bangs</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Sidney</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human CD8+ T cell responses induced by a live attenuated tetravalent dengue vaccine are directed against highly conserved epitopes</article-title>
        <source>J. Virol.</source>
        <volume>89</volume>
        <year>2015</year>
        <fpage>120</fpage>
        <lpage>128</lpage>
        <pub-id pub-id-type="pmid">25320311</pub-id>
      </element-citation>
    </ref>
    <ref id="bib48">
      <label>48</label>
      <element-citation publication-type="journal" id="sref48">
        <person-group person-group-type="author">
          <name>
            <surname>Weiskopf</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Cerpas</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Angelo</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Bangs</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Sidney</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human CD8+ T-cell responses against the 4 dengue virus serotypes are associated with distinct patterns of protein targets</article-title>
        <source>J. Infect. Dis.</source>
        <volume>212</volume>
        <year>2015</year>
        <fpage>1743</fpage>
        <lpage>1751</lpage>
        <pub-id pub-id-type="pmid">25980035</pub-id>
      </element-citation>
    </ref>
    <ref id="bib49">
      <label>49</label>
      <element-citation publication-type="journal" id="sref49">
        <person-group person-group-type="author">
          <name>
            <surname>Weiskopf</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Bangs</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Sidney</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kolla</surname>
            <given-names>R.V.</given-names>
          </name>
          <name>
            <surname>De Silva</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>de Silva</surname>
            <given-names>A.M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dengue virus infection elicits highly polarized CX3CR1+ cytotoxic CD4+ T cells associated with protective immunity</article-title>
        <source>Proc. Natl. Acad. Sci. U. S. A.</source>
        <volume>112</volume>
        <year>2015</year>
        <fpage>E4256</fpage>
        <lpage>E4263</lpage>
        <pub-id pub-id-type="pmid">26195744</pub-id>
      </element-citation>
    </ref>
    <ref id="bib50">
      <label>50</label>
      <element-citation publication-type="journal" id="sref50">
        <person-group person-group-type="author">
          <name>
            <surname>Weiskopf</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Angelo</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Sidney</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Shresta</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sette</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Immunodominance changes as a function of the infecting dengue virus serotype and primary versus secondary infection</article-title>
        <source>J. Virol.</source>
        <volume>88</volume>
        <year>2014</year>
        <fpage>11383</fpage>
        <lpage>11394</lpage>
        <pub-id pub-id-type="pmid">25056881</pub-id>
      </element-citation>
    </ref>
    <ref id="bib51">
      <label>51</label>
      <element-citation publication-type="journal" id="sref55">
        <person-group person-group-type="author">
          <name>
            <surname>Sarkizova</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Klaeger</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>P.M.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L.W.</given-names>
          </name>
          <name>
            <surname>Oliveira</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Keshishian</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A large peptidome dataset improves HLA class I epitope prediction across most of the human population</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>38</volume>
        <year>2020</year>
        <fpage>199</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="pmid">31844290</pub-id>
      </element-citation>
    </ref>
    <ref id="bib52">
      <label>52</label>
      <element-citation publication-type="journal" id="sref51">
        <person-group person-group-type="author">
          <name>
            <surname>Hulstaert</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Shofstahl</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sachsenberg</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Walzer</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Barsnes</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ThermoRawFileParser: modular, scalable, and cross-platform RAW file conversion</article-title>
        <source>J. Proteome Res.</source>
        <volume>19</volume>
        <year>2020</year>
        <fpage>537</fpage>
        <lpage>542</lpage>
        <pub-id pub-id-type="pmid">31755270</pub-id>
      </element-citation>
    </ref>
    <ref id="bib53">
      <label>53</label>
      <element-citation publication-type="journal" id="sref52">
        <person-group person-group-type="author">
          <name>
            <surname>Frankish</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Jungreis</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Loveland</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GENCODE reference annotation for the human and mouse genomes</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>47</volume>
        <year>2019</year>
        <fpage>D766</fpage>
        <lpage>D773</lpage>
        <pub-id pub-id-type="pmid">30357393</pub-id>
      </element-citation>
    </ref>
    <ref id="bib54">
      <label>54</label>
      <element-citation publication-type="journal" id="sref53">
        <person-group person-group-type="author">
          <name>
            <surname>Cormican</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Soh</surname>
            <given-names>W.T.</given-names>
          </name>
          <name>
            <surname>Mishto</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Liepe</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>iBench: a ground truth approach for advanced validation of mass spectrometry identification method</article-title>
        <source>Proteomics</source>
        <year>2022</year>
        <object-id pub-id-type="publisher-id">e2200271</object-id>
      </element-citation>
    </ref>
    <ref id="bib55">
      <label>55</label>
      <element-citation publication-type="book" id="sref54">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>T.Q.</given-names>
          </name>
          <name>
            <surname>Guestrin</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <part-title>XGBoost: a scalable tree boosting system</part-title>
        <source>Kdd'16: Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</source>
        <year>2016</year>
        <publisher-name>Association for Computing Machinery</publisher-name>
        <publisher-loc>New York, NY</publisher-loc>
      </element-citation>
    </ref>
    <ref id="bib56">
      <label>56</label>
      <element-citation publication-type="journal" id="sref56">
        <person-group person-group-type="author">
          <name>
            <surname>Collatz</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Mock</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Barth</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Holzer</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Sachse</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Marz</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>EpiDope: a deep neural network for linear B-cell epitope prediction</article-title>
        <source>Bioinformatics</source>
        <volume>37</volume>
        <year>2021</year>
        <fpage>448</fpage>
        <lpage>455</lpage>
        <pub-id pub-id-type="pmid">32915967</pub-id>
      </element-citation>
    </ref>
    <ref id="bib57">
      <label>57</label>
      <element-citation publication-type="journal" id="sref57">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Hein</surname>
            <given-names>M.Y.</given-names>
          </name>
          <name>
            <surname>Luber</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Paron</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Nagaraj</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Mann</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Accurate proteome-wide label-free quantification by delayed normalization and maximal peptide ratio extraction, termed MaxLFQ</article-title>
        <source>Mol. Cell. Proteomics</source>
        <volume>13</volume>
        <year>2014</year>
        <fpage>2513</fpage>
        <lpage>2526</lpage>
        <pub-id pub-id-type="pmid">24942700</pub-id>
      </element-citation>
    </ref>
    <ref id="bib58">
      <label>58</label>
      <element-citation publication-type="journal" id="sref58">
        <person-group person-group-type="author">
          <name>
            <surname>Perez-Riverol</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Csordas</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bai</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Bernal-Llinares</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hewapathirana</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kundu</surname>
            <given-names>D.J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The PRIDE database and related tools and resources in 2019: improving support for quantification data</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>47</volume>
        <year>2019</year>
        <fpage>D442</fpage>
        <lpage>D450</lpage>
        <pub-id pub-id-type="pmid">30395289</pub-id>
      </element-citation>
    </ref>
    <ref id="bib59">
      <label>59</label>
      <element-citation publication-type="journal" id="sref59">
        <person-group person-group-type="author">
          <name>
            <surname>Tareen</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kinney</surname>
            <given-names>J.B.</given-names>
          </name>
        </person-group>
        <article-title>Logomaker: beautiful sequence logos in Python</article-title>
        <source>Bioinformatics</source>
        <volume>36</volume>
        <year>2020</year>
        <fpage>2272</fpage>
        <lpage>2274</lpage>
        <pub-id pub-id-type="pmid">31821414</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="appsec1" sec-type="supplementary-material">
    <title>Supplemental Data</title>
    <p id="p0625">
      <supplementary-material content-type="local-data" id="mmc1">
        <caption>
          <title>Supplemental File S1</title>
        </caption>
        <media xlink:href="mmc1.pdf"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc2">
        <caption>
          <title>Supplemental File S2</title>
        </caption>
        <media xlink:href="mmc2.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc3">
        <caption>
          <title>Supplemental File S3</title>
        </caption>
        <media xlink:href="mmc3.pdf"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc4">
        <caption>
          <title>Supplemental File S4</title>
        </caption>
        <media xlink:href="mmc4.pdf"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc5">
        <caption>
          <title>Supplemental File S5</title>
        </caption>
        <media xlink:href="mmc5.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc6">
        <caption>
          <title>Supplemental File S6</title>
        </caption>
        <media xlink:href="mmc6.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc7">
        <caption>
          <title>Supplemental File S7</title>
        </caption>
        <media xlink:href="mmc7.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc8">
        <caption>
          <title>Supplemental File S8</title>
        </caption>
        <media xlink:href="mmc8.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc9">
        <caption>
          <title>Supplemental File S9</title>
        </caption>
        <media xlink:href="mmc9.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc10">
        <caption>
          <title>Supplemental File S10</title>
        </caption>
        <media xlink:href="mmc10.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc11">
        <caption>
          <title>Supplemental File S11</title>
        </caption>
        <media xlink:href="mmc11.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc12">
        <caption>
          <title>Supplemental Figures S1–S14 and Tables S1–S4</title>
        </caption>
        <media xlink:href="mmc12.pdf"/>
      </supplementary-material>
    </p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p0610">We thank (i) H. Urlaub and L. Welp (MPI-NAT), X. Yang and S. Lynham (KCL) for MS assistance, (ii) the Gesellschaft fuer wissenschaftliche Datenverarbeitung mbH Goettingen (GWDG) for support and access to the GWDG GPU-cluster; (iii) the Proteomics Facility at MPI-NAT for computational infrastructure support; (iv) the Percolator and MS<sup>2</sup>Rescore teams for their support <italic>via</italic> GitHub; (v) A. Sette and J. Sidney (LJIAI) for providing the synthetic peptide library; N.C. Chiam (MPI-NAT) for designing the inSPIRE logo.</p>
    <sec id="sec6">
      <title>Funding and additional information</title>
      <p id="p0615">The study was in part supported by: (i) MPI-NAT collaboration agreement 2020, <funding-source id="gs1"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100000289</institution-id><institution>Cancer Research UK</institution></institution-wrap></funding-source> (grant nos.: C67500 and A29686) and <funding-source id="gs2">National Institute for Health Research Biomedical Research Centre based at Guy’s and St Thomas’ NHS Foundation Trust</funding-source> and <funding-source id="gs3"><institution-wrap><institution-id institution-id-type="doi">10.13039/100009360</institution-id><institution>King’s College London</institution></institution-wrap></funding-source> and/or the <funding-source id="gs4">National Institute for Health Research Clinical Research Facility</funding-source> to M. M.; (ii) <funding-source id="gs5"><institution-wrap><institution-id institution-id-type="doi">10.13039/100010663</institution-id><institution>European Research Council</institution></institution-wrap></funding-source> under the European Union’s Horizon 2020 research and innovation programme (grant agreement no.: 945528) to J. L. J. A. C. and Y. H. are supported by the <funding-source id="gs6">International Max-Planck Research School for Genome Science</funding-source>. W. T. S. is supported by the <funding-source id="gs7"><institution-wrap><institution-id institution-id-type="doi">10.13039/100010661</institution-id><institution>European Union’s Framework Programme for Research and Innovation Horizon Europe</institution></institution-wrap></funding-source> (2021–2027) under the Marie Skłodowska-Curie grant agreement no. 101065466.</p>
    </sec>
    <sec id="sec7">
      <title>Author contributions</title>
      <p id="p0620">J. A. C., M. M., and J. L. methodology; J. A. C., Y. H., W. T. S., M. M., and J. L. investigation; J. A. C., M. M., and J. L. writing–original draft; W. T. S. writing–review &amp; editing; M. M., and J. L. supervision.</p>
    </sec>
  </ack>
</back>
