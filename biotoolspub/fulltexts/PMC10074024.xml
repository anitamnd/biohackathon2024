<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10074024</article-id>
    <article-id pub-id-type="pmid">37033465</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad038</article-id>
    <article-id pub-id-type="publisher-id">vbad038</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetic and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HTRX: an R package for learning non-contiguous haplotypes associated with a phenotype</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4905-8097</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Yaoling</given-names>
        </name>
        <aff><institution>Department of Statistical Science, School of Mathematics, University of Bristol</institution>, Bristol BS8 1UG, <country country="GB">UK</country></aff>
        <aff><institution>Integrative Epidemiology Unit, Population Health Sciences, Bristol Medical School, University of Bristol</institution>, Bristol BS8 2BN, <country country="GB">UK</country></aff>
        <xref rid="vbad038-cor1" ref-type="corresp"/>
        <!--yaoling.yang@bristol.ac.uk-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lawson</surname>
          <given-names>Daniel John</given-names>
        </name>
        <aff><institution>Department of Statistical Science, School of Mathematics, University of Bristol</institution>, Bristol BS8 1UG, <country country="GB">UK</country></aff>
        <aff><institution>Integrative Epidemiology Unit, Population Health Sciences, Bristol Medical School, University of Bristol</institution>, Bristol BS8 2BN, <country country="GB">UK</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Bateman</surname>
          <given-names>Alex</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad038-cor1">To whom correspondence should be addressed. <email>yaoling.yang@bristol.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-03-23">
      <day>23</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad038</elocation-id>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>17</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>05</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad038.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Haplotype Trend Regression with eXtra flexibility (HTRX) is an R package to learn sets of interacting features that explain variance in a phenotype. Genome-wide association studies (GWAS) have identified thousands of single nucleotide polymorphisms (SNPs) associated with complex traits and diseases, but finding the true causal signal from a high linkage disequilibrium block is challenging. We focus on the simpler task of quantifying the total variance explainable not just with main effects but also interactions and tagging, using haplotype-based associations. HTRX identifies haplotypes composed of non-contiguous SNPs associated with a phenotype and can naturally be performed on regions with a GWAS hit before or after fine-mapping. To reduce the space and computational complexity when investigating many features, we constrain the search by growing good feature sets using ‘Cumulative HTRX’, and limit the maximum complexity of a feature set. As the computational time scales linearly with the number of SNPs, HTRX has the potential to be applied to large chromosome regions.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>HTRX is implemented in R and is available under GPL-3 licence from CRAN (<ext-link xlink:href="https://cran.r-project.org/web/packages/HTRX/readme/README.html" ext-link-type="uri">https://cran.r-project.org/web/packages/HTRX/readme/README.html</ext-link>). The development version is maintained on GitHub (<ext-link xlink:href="https://github.com/YaolingYang/HTRX" ext-link-type="uri">https://github.com/YaolingYang/HTRX</ext-link>).</p>
      </sec>
      <sec id="s3">
        <title>Contact</title>
        <p>
          <email>yaoling.yang@bristol.ac.uk</email>
        </p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>China Scholarship Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004543</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>202108060092</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Numerous single nucleotide polymorphisms (SNPs) associated with human complex traits and diseases have been discovered by genome-wide association studies (GWAS) (<xref rid="vbad038-B4" ref-type="bibr">Buniello <italic toggle="yes">et al.</italic>, 2019</xref>). Strategies to manage GWAS results, i.e. include one or multiple SNPs in a region, are realized either entirely by linkage disequilibrium (LD) considerations (<xref rid="vbad038-B12" ref-type="bibr">Yang <italic toggle="yes">et al.</italic>, 2012</xref>) or through fine-mapping (<xref rid="vbad038-B10" ref-type="bibr">Spain and Barrett, 2015</xref>). Haplotype-based association studies, incorporating LD information and combining gene–gene interaction into features, have the potential to be more powerful than methods based on independent SNPs (<xref rid="vbad038-B2" ref-type="bibr">Balliu <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    <p>Haplotype-based analysis, such as Haplotype Trend Regression (HTR) (<xref rid="vbad038-B13" ref-type="bibr">Zaykin <italic toggle="yes">et al.</italic>, 2002</xref>) [reviewed by <xref rid="vbad038-B8" ref-type="bibr">Schaid (2004)</xref> and <xref rid="vbad038-B7" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> (2008)</xref>], is limited to investigating haplotypes, which interact between all the specified SNPs, and they lose power if some of the SNPs do not have interaction effects. We recently (<xref rid="vbad038-B3" ref-type="bibr">Barrie <italic toggle="yes">et al.</italic>, 2022</xref>) proposed Haplotype Trend Regression with eXtra flexibility (HTRX), which searches non-contiguous haplotypes, including single SNP effects. As the number of haplotypes increases exponentially with the number of SNPs, inferring true interactions at scale is unrealistic (<xref rid="vbad038-B5" ref-type="bibr">Guan and Stephens, 2011</xref>). Consequently, the goal of HTRX is to make good predictions by selecting features, which have the best predictive performance. By estimating the out-of-sample variance explained (<italic toggle="yes">R</italic><sup>2</sup>), HTRX quantifies whether a tagging SNP is adequate, or whether interactions or LD with unobserved causal SNPs are present. Further, by treating out-of-sample <italic toggle="yes">R</italic><sup>2</sup> as an unbiased target of inference rather than a performance measure, we provide a lower bound on the predictive power gained by haplotypes compared to SNPs alone, informing the search for specific SNP interactions.</p>
    <p><xref rid="vbad038-B3" ref-type="bibr">Barrie <italic toggle="yes">et al.</italic> (2022)</xref> demonstrated the utility of this method by detecting interactions between fine-mapped SNPs in the human leukocyte antigen locus for Multiple Sclerosis. This note addresses two important improvements: controlling computational complexity, and ensuring that overfitting is controlled. We will control the former by limiting the flexibility of haplotypes to be considered, and the latter using penalization and cross-validation (CV). In addition to Bayesian Information Criteria (BIC) (<xref rid="vbad038-B9" ref-type="bibr">Schwarz, 1978</xref>) employed to select candidate models by <xref rid="vbad038-B3" ref-type="bibr">Barrie <italic toggle="yes">et al.</italic> (2022)</xref>, we incorporate other popular methods including Akaike’s information criterion (AIC) (<xref rid="vbad038-B1" ref-type="bibr">Akaike, 1974</xref>) and least absolute shrinkage and selection operator (lasso) (<xref rid="vbad038-B11" ref-type="bibr">Tibshirani, 1996</xref>) regularization in the R package ‘HTRX’.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>HTRX defines a template for each haplotype using the combination of ‘0’, ‘1’ and ‘X’, which represent the reference allele, alternative allele and either of the alleles, respectively, at each SNP. For example, a four-SNP haplotype ‘1XX0’ only refers to the interaction between the first and the fourth SNP. Each haplotype <italic toggle="yes">H<sub>ij</sub></italic> takes a value of 0, 0.5 or 1 if a diploid sample <italic toggle="yes">i</italic> has 0, 1 or 2 copies of haplotype <italic toggle="yes">j</italic>. This template creates <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mi>u</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> different haplotypes in a region containing <italic toggle="yes">u</italic> SNPs, while only <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>u</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> of them are independent. The models and methods that we quantify the variance explained are introduced in <xref rid="sup1" ref-type="supplementary-material">Supplementary Method S1.1</xref>.</p>
    <p>Fitting models using all possible haplotypes which we refer to as ‘Direct-Fit’ result in overfitting (<xref rid="vbad038-B6" ref-type="bibr">Hawkins, 2004</xref>). To address this, HTRX considers AIC, BIC and lasso penalization. AIC and BIC penalize the number of features in the model through forward regression, while lasso uses L1 norm to regularize parameters, and retains only the features whose parameters do not shrink to 0. Model performance is evaluated using the out-of-sample variance explained by haplotypes within a region, which assesses the model’s ability to generalize to new datasets. To evaluate the model’s predictive ability, we use <italic toggle="yes">k</italic>-fold CV, an ensemble learning method (<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> for all the algorithms below) as a natural score function:</p>
    <boxed-text id="vbad038-BOX1" position="float">
      <label>Algorithm 1</label>
      <caption>
        <p>Direct CV (function ‘do_direct_cv’)</p>
      </caption>
      <p>Generate haplotype features;</p>
      <p>Split data into <italic toggle="yes">k</italic> folds;</p>
      <p><bold>for</bold> <italic toggle="yes">i</italic> <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mo>←</mml:mo></mml:math></inline-formula> 1 to <italic toggle="yes">k</italic> <bold>do</bold></p>
      <p> Train in <italic toggle="yes">k –</italic> 1 folds (<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>) using penalization;</p>
      <p> Test in fold <italic toggle="yes">i</italic>, compute <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>; ▹ <italic toggle="yes">Out-of-sample R<sup>2</sup></italic></p>
      <p>Compute score: <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext>cv</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo> </mml:mo><mml:mo>←</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
    </boxed-text>
    <p>In <xref rid="vbad038-BOX1" ref-type="boxed-text">Algorithm 1</xref> and throughout, we use a linear regression or logistic regression model for training and testing. Other models could be applied to HTRX features as they are applied to SNP-based features. The ‘Generate haplotype features’ step involves enumerating the possible templates.</p>
    <p>Although <xref rid="vbad038-BOX1" ref-type="boxed-text">Algorithm 1</xref> reduces overfitting, it generates an ensemble of feature sets due to variation in the training data. To choose a fixed feature set, a more complicated ‘Two-stage CV’ algorithm (<xref rid="vbad038-BOX2" ref-type="boxed-text">Algorithm 2</xref>) is required. In the first stage, we generate a set of candidate models using penalization through simulations, the number of which is denoted by <italic toggle="yes">B</italic>. For each simulation, a fraction <italic toggle="yes">D</italic> of the available data is sampled for model training, and a total of <italic toggle="yes">q</italic> candidate models are selected. Following the simulations, we count the number of unique candidate models selected, denoted by <italic toggle="yes">z</italic>, which are subsequently passed to the second stage for the evaluation of their out-of-sample performance via k-fold CV.
<boxed-text id="vbad038-BOX2" position="float"><label>Algorithm 2</label><caption><p>Two-stage CV (function ‘do_cv’)</p></caption><p>Generate haplotype features;</p><p><bold>for</bold> <italic toggle="yes">b</italic> <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mo>←</mml:mo></mml:math></inline-formula> 1 to <italic toggle="yes">B</italic> <bold>do</bold> ▹ <italic toggle="yes">Stage 1: Generate candidate models</italic></p><p> Sample a fraction of data <italic toggle="yes">D</italic>;</p><p> Select the best <italic toggle="yes">q</italic> candidate models using penalization;</p><p>Count the number of different candidate models <italic toggle="yes">z</italic>;</p><p>Split data into <italic toggle="yes">k</italic> folds; ▹ <italic toggle="yes">Stage 2: Model fit via k-fold CV</italic></p><p><bold>for</bold> <italic toggle="yes">i</italic> <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mo>←</mml:mo></mml:math></inline-formula> 1 to <italic toggle="yes">k</italic> <bold>do</bold></p><p> <bold>for</bold> <italic toggle="yes">j</italic> <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mo>←</mml:mo></mml:math></inline-formula> 1 to <italic toggle="yes">z</italic> <bold>do</bold></p><p>  Train model <italic toggle="yes">j</italic> in <italic toggle="yes">k –</italic> 2 folds, without penalization;</p><p>  Validate in one fold, compute <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">vij</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>;</p><p>  Test in remaining one fold, compute <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">tij</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>;</p><p>Compute <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula><inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mo>←</mml:mo></mml:math></inline-formula><inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">vij</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>; so <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula><inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mo>←</mml:mo></mml:math></inline-formula><inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mrow><mml:mi>arg</mml:mi><mml:mo> </mml:mo><mml:mi>max</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:munder><mml:msubsup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>;</p><p>Compute <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>2-stage</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>←</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>.</p></boxed-text></p>
    <p>We provide a rigorous justification of the validity of <xref rid="vbad038-BOX2" ref-type="boxed-text">Algorithm 2</xref> in <xref rid="sup1" ref-type="supplementary-material">Supplementary Method S1.2</xref>. In addition, we demonstrate that the within-CV average out-of-sample <italic toggle="yes">R</italic><sup>2</sup>, as adopted by the ‘Two-stage CV’ approach, accurately estimates the out-of-sample <italic toggle="yes">R</italic><sup>2</sup> performance when tested on a completely independent dataset. However, this algorithm scales badly with <italic toggle="yes">u</italic> and is limited to around <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi>u</mml:mi><mml:mo>≤</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
    <p>To consider more features as commonly found in genetic LD blocks, ‘Cumulative HTRX’ (<xref rid="vbad038-BOX3" ref-type="boxed-text">Algorithm 3</xref>) controls the space and computational complexity. In specific, ‘Cumulative HTRX’ extends ‘Two-stage CV’ by initially sampling <italic toggle="yes">L</italic> out of the total <italic toggle="yes">u</italic> SNPs at each simulation, instead of generating the complete set of possible templates. From the templates generated exhaustively using <italic toggle="yes">L</italic> SNPs, the best <italic toggle="yes">M</italic> features are identified through a forward regression approach without penalization, which aims at retaining more ‘suffix’ of longer haplotypes. Subsequently, another SNP is sampled to create <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mn>3</mml:mn><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> possible haplotypes, and the top <italic toggle="yes">M</italic> features are selected through another forward regression with no penalization. Once all SNPs have been accounted for by repeating the above process, penalization is employed to choose the best <italic toggle="yes">q</italic> models. After simulating <italic toggle="yes">B</italic> times, the optimal model is determined using a <italic toggle="yes">k</italic>-fold CV process similar to that of <xref rid="vbad038-BOX2" ref-type="boxed-text">Algorithm 2</xref>, and its out-of-sample performance is evaluated.
<boxed-text id="vbad038-BOX3" position="float"><label>Algorithm 3</label><caption><p>Cumulative HTRX (function ‘do_cumulative_htrx’)</p></caption><p><bold>for</bold> <italic toggle="yes">i</italic> <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mo>←</mml:mo></mml:math></inline-formula> 1 to <italic toggle="yes">B</italic> <bold>do</bold> ▹ <italic toggle="yes">Stage 1: Extend haplotypes</italic></p><p> Sample a fraction of data <italic toggle="yes">D</italic>;</p><p> Sample <italic toggle="yes">L</italic> features (from <italic toggle="yes">u</italic>) to generate all possible haplotypes;</p><p> Retain best <italic toggle="yes">M</italic> features using forward regression with no penalization;</p><p> <bold>for</bold> <italic toggle="yes">j</italic> <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mo>←</mml:mo></mml:math></inline-formula><italic toggle="yes">L </italic>+<italic toggle="yes"> </italic>1 to <italic toggle="yes">u –</italic> 1 <bold>do</bold></p><p>  Sample another SNP from the remaining <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to generate all possible haplotypes;</p><p>  Retain best <italic toggle="yes">M</italic> features using forward regression with no penalization;</p><p> Add the last SNP to <italic toggle="yes">M</italic> to generate all possible haplotypes; ▹</p><p><italic toggle="yes">Stage 2: Generate a set of candidate models</italic></p><p> Select the best <italic toggle="yes">q</italic> candidate models using penalization;</p><p>Count the number of different candidate models <italic toggle="yes">z</italic>;</p><p>Apply <xref rid="vbad038-BOX2" ref-type="boxed-text">Algorithm 2</xref> Stage 2. ▹ <italic toggle="yes">Stage 3: Constrained CV</italic></p></boxed-text></p>
    <p>We refer to the HTRX Algorithm as using ‘Two-stage CV’ when <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≤</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> and ‘Cumulative HTRX’ for <italic toggle="yes">L </italic>&gt;<italic toggle="yes"> </italic>6. ‘Cumulative HTRX’ acts as a lower bound of the out-of-sample variance explainable by HTRX because the ‘suffix’ of significant longer haplotypes may be missed when extending haplotypes, which is the sacrifice of the considerably reduced computational cost. <xref rid="vbad038-F1" ref-type="fig">Figure 1</xref> illustrates that ‘Cumulative HTRX’ brings ‘HTRX’ significant memory saving compared to ‘Direct-Fit’, which implements all-feature multivariate regression and occupies the same memory space as ‘Two-stage CV’. Larger <italic toggle="yes">L</italic>, <italic toggle="yes">M</italic> and <italic toggle="yes">B</italic> may slightly improve the predictive performance, but they significantly increase complexity both spatially and computationally.</p>
    <fig position="float" id="vbad038-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>‘Cumulative HTRX’ bounds space complexity. Comparison of space complexity for Algorithm ‘Direct-Fit’ (all-feature multivariate regression) and ‘HTRX’ on different feature sets for both linear and logistic regression models. Feature set specifies the maximum number of features that can interact using ‘SNP’, ‘2SNP_hap’, ‘3SNP_hap’, etc., and ‘all_hap’ represents the all the possible haplotypes, while ‘HTR’ uses templates that interact between all features with no ‘X’ in the template. The space complexity for linear and logistic regression models is approximately proportional to the number of the input features, which is suggested to be below 1000 for ‘HTRX’. Algorithm ‘Direct-Fit’ and ‘HTRX’ begin with the same number of features <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≤</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>. When the number of SNPs increases, the number of features increases exponentially. ‘HTRX’ uses <xref rid="vbad038-BOX3" ref-type="boxed-text">Algorithm 3</xref> ‘Cumulative HTRX’ to reduce the space complexity significantly. When using haplotypes with at most two or three SNPs (‘2SNP_hap’ and ‘3SNP_hap’), or all the SNPs (‘HTR’), ‘HTRX’ allows the region spanning more SNPs while keeping the relative space complexity below 1000</p>
      </caption>
      <graphic xlink:href="vbad038f1" position="float"/>
    </fig>
    <p>It is rare that many features are involved in an interaction, and such interactions are statistically hard to identify. Because of this, we consider constraining the maximum number of SNPs permitted in a haplotype template. This reduces the computational and space complexity, and enforcing a strict limit (specifically for restricting the interaction between at most two or three SNPs) enables ‘Two-stage CV’ to be performed on longer regions (<xref rid="vbad038-F1" ref-type="fig">Fig. 1</xref>). Additionally, we implement the comparison of the computational cost of HTRX in regions containing different number of SNPs in <xref rid="sup1" ref-type="supplementary-material">Supplementary Method S1.3</xref>, which indicates that ‘Cumulative HTRX’ can be applied to larger regions with only linearly increasing processing time (<xref rid="vbad038-F2" ref-type="fig">Fig. 2</xref>).</p>
    <fig position="float" id="vbad038-F2">
      <label>Fig. 2.</label>
      <caption>
        <p>‘Cumulative HTRX’ has linear Computational Complexity. Computational time as a function of the number of SNPs, for which HTRX uses <xref rid="vbad038-BOX2" ref-type="boxed-text">Algorithm 2</xref> if there are no more than six SNPs and <xref rid="vbad038-BOX3" ref-type="boxed-text">Algorithm 3</xref> for 7–20 SNPs. Two fixed covariates are included, and the phenotype is either continuous or binary, for 2000 samples. The details are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Method S1.3</xref></p>
      </caption>
      <graphic xlink:href="vbad038f2" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We perform a simulation to compare the performance of different algorithms, penalization and feature sets. To generate a realistic dataset, we simulate data with the following features:</p>
    <list list-type="order">
      <list-item>
        <p>LD is strong within the region;</p>
      </list-item>
      <list-item>
        <p>main SNP effects are large and sparse;</p>
      </list-item>
      <list-item>
        <p>SNP interactions are also sparse, are weaker and may involve SNPs with and without a main effect;</p>
      </list-item>
      <list-item>
        <p>there is confounding from an observed variable correlated with the genetic structure;</p>
      </list-item>
      <list-item>
        <p>power is relatively low.</p>
      </list-item>
    </list>
    <p>In detail, we simulate six biallelic SNPs <italic toggle="yes">G<sub>ij</sub></italic> (<inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo> </mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula> denotes samples and <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> denotes SNPs) with frequency about 20% for the alternative allele ‘1’ from an LD block, leading to a correlation between each pair of SNPs of around 97.8%. We assume each sample is haploid, and the effect size of two SNPs <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, respectively. Two haplotypes have real effects: a two-SNP interaction <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (‘X0XX1X’) with effect size <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>0.3</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and a three-SNP interaction <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (‘1XX0X1’) with effect size <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>0.3</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. A confounder <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>0.8</mml:mn><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with effect size <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>C</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, a random error with large variance <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and an intercept term <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:mo>λ</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> are also generated.</p>
    <p>We investigate both continuous and binary phenotypes using linear and logistic regression models. The model is:
where for linear regression the phenotype <italic toggle="yes">Y<sup>c</sup></italic> is continuous, simulating from <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. For a binary phenotype, we sample <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>Bin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
    <disp-formula id="E1">
      <label>(1)</label>
      <mml:math id="M1" display="block" overflow="scroll">
        <mml:mrow>
          <mml:mi>f</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:msubsup>
            <mml:mrow>
              <mml:mi>Y</mml:mi>
            </mml:mrow>
            <mml:mi>i</mml:mi>
            <mml:mi>c</mml:mi>
          </mml:msubsup>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>=</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mo>β</mml:mo>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>G</mml:mi>
                </mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:msub>
            </mml:mrow>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>G</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mn>2</mml:mn>
            </mml:mrow>
          </mml:msub>
          <mml:mo>+</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mo>β</mml:mo>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>G</mml:mi>
                </mml:mrow>
                <mml:mn>4</mml:mn>
              </mml:msub>
            </mml:mrow>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>G</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mn>4</mml:mn>
            </mml:mrow>
          </mml:msub>
          <mml:mo>+</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mo>β</mml:mo>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>H</mml:mi>
                </mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:msub>
            </mml:mrow>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>H</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mn>1</mml:mn>
            </mml:mrow>
          </mml:msub>
          <mml:mo>+</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mo>β</mml:mo>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>H</mml:mi>
                </mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:msub>
            </mml:mrow>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>H</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mn>2</mml:mn>
            </mml:mrow>
          </mml:msub>
          <mml:mo>+</mml:mo>
          <mml:msub>
            <mml:mrow>
              <mml:mo>β</mml:mo>
            </mml:mrow>
            <mml:mi>C</mml:mi>
          </mml:msub>
          <mml:msub>
            <mml:mrow>
              <mml:mi>C</mml:mi>
            </mml:mrow>
            <mml:mi>i</mml:mi>
          </mml:msub>
          <mml:mo>+</mml:mo>
          <mml:mo>λ</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>The algorithms, penalization methods, and feature sets are then compared in terms of their out-of-sample performance under models with fixed parameters <italic toggle="yes">k</italic> = 10, <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>, <italic toggle="yes">B </italic>=<italic toggle="yes"> </italic>10 and <italic toggle="yes">q</italic> = 3 (<xref rid="vbad038-F3" ref-type="fig">Fig. 3</xref>). In linear models, there is little variation in out-of-sample performance regardless of the approaches above. However, for logistic regression models with binary phenotype, direct fitting the model using all features (‘Direct-Fit’) and using Algorithm ‘Direct-CV’ lead to significant overfitting, particularly when the feature set contains haplotypes with at least three SNPs (‘3SNP_hap’). This is because HTRX separates template selection as a validation step given fresh training data, which avoids overfitting, whereas ‘Direct-Fit’ does not.</p>
    <fig position="float" id="vbad038-F3">
      <label>Fig. 3.</label>
      <caption>
        <p>HTRX is accurate and necessary for Logistic Regression. Comparison of the average out-of-sample <italic toggle="yes">R</italic><sup>2</sup> through 10-fold CV for linear and logistic regression models in a simulated dataset. Feature set specifies the maximum number of features (of 6) that can interact using ‘SNP’, ‘2SNP_hap’, ‘3SNP_hap’, etc., and ‘all_hap’ represents the all the possible haplotypes, while ‘HTR’ uses templates that interact between all SNPs with no ‘X’ in the template. <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>, <italic toggle="yes">B</italic> = 10 and <italic toggle="yes">q</italic> = 3 are used for ‘Two-stage-CV’ (<xref rid="vbad038-BOX2" ref-type="boxed-text">Algorithm 2</xref>). ‘Direct-Fit’ refers to all-feature multivariate regression. ‘Direct CV’ is the implementations of <xref rid="vbad038-BOX1" ref-type="boxed-text">Algorithm 1</xref>. (<bold>a</bold>) Linear Models. (<bold>b</bold>) Logistic Regression Models</p>
      </caption>
      <graphic xlink:href="vbad038f3" position="float"/>
    </fig>
    <p>The simulation for logistic regression models also reveals that under HTRX, AIC and BIC slightly outperform lasso, indicating that lasso may fail to select the correct features. Moreover, the average out-of-sample <italic toggle="yes">R</italic><sup>2</sup> reaches the maximum when the feature set includes three SNP interactions as simulated in the data. This indicates that reducing the number of allowed interactions not only speeds up computation, but may also avoid power loss. Furthermore, adding the ‘X’ to the template, i.e. enabling the search for non-contiguous haplotypes including single SNPs, increases performance, as HTRX outperforms HTR when both are selected using either ‘Direct CV’ or ‘Two-stage CV’.</p>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We show in a simulated dataset of six interacting features that separating validation from feature selection using ‘Two-stage CV’ significantly outperforms ‘Direct CV’, especially when the phenotype is binary (<xref rid="vbad038-F3" ref-type="fig">Fig. 3</xref>). Also, penalization using AIC or BIC produces significantly better out-of-sample performance than lasso. ‘Two-stage CV’ uses a validation step to select a subset of all possible models to reduce computational cost and better estimate the out-of-sample predictive performance.</p>
    <p>Out-of-sample prediction is wasteful of scarce data, and for <italic toggle="yes">R</italic><sup>2</sup> prediction using less data creates a downward bias as well as increased variance. Whilst results throughout are shown for true out-of-sample prediction, for real data, we implement <italic toggle="yes">k</italic>-fold CV, which introduces a negligible bias compared to the variance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
    <p>‘Cumulative HTRX’ as currently implemented can be deployed on LD blocks containing all SNPs in principle, as the compute time scales linearly (<xref rid="vbad038-F2" ref-type="fig">Fig. 2</xref>). A natural question after conducting fine-mapping is whether some signals are lost due to interactions or the variation can totally be explained by SNPs only. It is appropriate to follow fine-mapping SNPs with a HTRX analysis to evaluate the potential for SNP interaction. Running HTRX before fine-mapping is also possible because of the linearly scaled computational cost, although power is the limiting factor in such an analysis. In both cases, it is important to remember that HTRX is limited by the power in the data, i.e. absence of evidence of interaction is not evidence of absence.</p>
    <p>More generally, these algorithms efficiently search features for interactions. One approach is reducing the number of interactions permitted, and another is growing the most promising interaction sets. Both exploit the diminishing marginal returns of complexity for prediction to quantify the total out-of-sample variance explained, which tests for the presence of feature interaction. It has general application in regression, but is specifically important for determining whether a single SNP is an adequate description of the effect of a genetic region on a phenotype.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Software and data availability</title>
    <p>The source code for R package HTRX is publicly available from GitHub at: <ext-link xlink:href="https://github.com/YaolingYang/HTRX" ext-link-type="uri">https://github.com/YaolingYang/HTRX</ext-link> and a tutorial for HTRX is available in the ‘vignette’ folder. The data underlying this article are available in the article and in its online <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad038_Supplementary_Data</label>
      <media xlink:href="vbad038_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was supported by China Scholarship Council [202108060092 to Y.Y.].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad038-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Akaike</surname><given-names>H.</given-names></string-name></person-group> (<year>1974</year>) <article-title>A new look at the statistical model identification</article-title>. <source>IEEE Trans. Automat. Contr</source>., <volume>19</volume>, <fpage>716</fpage>–<lpage>723</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad038-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Balliu</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Powerful testing via hierarchical linkage disequilibrium in haplotype association studies</article-title>. <source>Biom. J</source>., <volume>61</volume>, <fpage>747</fpage>–<lpage>768</lpage>.<pub-id pub-id-type="pmid">30693553</pub-id></mixed-citation>
    </ref>
    <ref id="vbad038-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Barrie</surname><given-names>W.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) Genetic risk for multiple sclerosis originated in pastoralist steppe populations. <source>biorXiv</source>. <pub-id pub-id-type="doi">10.1101/2022.09.23.509097</pub-id>.</mixed-citation>
    </ref>
    <ref id="vbad038-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buniello</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>The NHGRI-EBI GWAS catalog of published genome-wide association studies, targeted arrays and summary statistics 2019</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>D1005</fpage>–<lpage>D1012</lpage>.<pub-id pub-id-type="pmid">30445434</pub-id></mixed-citation>
    </ref>
    <ref id="vbad038-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guan</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>M.</given-names></string-name></person-group> (<year>2011</year>) <article-title>Bayesian variable selection regression for genome-wide association studies and other large-scale problems</article-title>. <source>Ann. Appl. Stat</source>., <volume>5</volume>, <fpage>1780</fpage>–<lpage>1815</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad038-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hawkins</surname><given-names>D.M.</given-names></string-name></person-group> (<year>2004</year>) <article-title>The problem of overfitting</article-title>. <source>J. Chem. Inf. Comput. Sci</source>., <volume>44</volume>, <fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">14741005</pub-id></mixed-citation>
    </ref>
    <ref id="vbad038-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>Haplotype-association analysis</article-title>. <source>Adv. Genet</source>., <volume>60</volume>, <fpage>335</fpage>–<lpage>405</lpage>.<pub-id pub-id-type="pmid">18358327</pub-id></mixed-citation>
    </ref>
    <ref id="vbad038-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaid</surname><given-names>D.J.</given-names></string-name></person-group> (<year>2004</year>) <article-title>Evaluating associations of haplotypes with traits</article-title>. <source>Genet. Epidemiol</source>., <volume>27</volume>, <fpage>348</fpage>–<lpage>364</lpage>.<pub-id pub-id-type="pmid">15543638</pub-id></mixed-citation>
    </ref>
    <ref id="vbad038-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schwarz</surname><given-names>G.</given-names></string-name></person-group> (<year>1978</year>) <article-title>Estimating the dimension of a model</article-title>. <source>Ann. Stat</source>., <volume>6</volume>, <fpage>461</fpage>–<lpage>464</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad038-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Spain</surname><given-names>S.L.</given-names></string-name>, <string-name><surname>Barrett</surname><given-names>J.C.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Strategies for fine-mapping complex traits</article-title>. <source>Hum. Mol. Genet</source>., <volume>24</volume>, <fpage>R111</fpage>–<lpage>R119</lpage>.<pub-id pub-id-type="pmid">26157023</pub-id></mixed-citation>
    </ref>
    <ref id="vbad038-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tibshirani</surname><given-names>R.</given-names></string-name></person-group> (<year>1996</year>) <article-title>Regression shrinkage and selection via the lasso</article-title>. <source>J. R. Stat. Soc. B Stat. Methodol</source>., <volume>58</volume>, <fpage>267</fpage>–<lpage>288</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad038-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal>; <collab>DIAbetes Genetics Replication And Meta-analysis (DIAGRAM) Consortium</collab>. (<year>2012</year>) <article-title>Conditional and joint multiple-SNP analysis of GWAS summary statistics identifies additional variants influencing complex traits</article-title>. <source>Nat. Genet</source>., <volume>44</volume>, <fpage>369</fpage>–<lpage>375</lpage>.<pub-id pub-id-type="pmid">22426310</pub-id></mixed-citation>
    </ref>
    <ref id="vbad038-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zaykin</surname><given-names>D.V.</given-names></string-name></person-group><etal>et al</etal> (<year>2002</year>) <article-title>Testing association of statistically inferred haplotypes with discrete and continuous traits in samples of unrelated individuals</article-title>. <source>Hum. Hered</source>., <volume>53</volume>, <fpage>79</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">12037407</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
