<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Integr Org Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Integr Org Biol</journal-id>
    <journal-id journal-id-type="publisher-id">iob</journal-id>
    <journal-title-group>
      <journal-title>Integrative Organismal Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2517-4843</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10461528</article-id>
    <article-id pub-id-type="pmid">37644979</article-id>
    <article-id pub-id-type="doi">10.1093/iob/obad030</article-id>
    <article-id pub-id-type="publisher-id">obad030</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GoodFibes: An R Package for The Detection of Muscle Fibers from diceCT Scans</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4506-158X</contrib-id>
        <name>
          <surname>Arbour</surname>
          <given-names>J H</given-names>
        </name>
        <!--jessica.arbour@mtsu.edu-->
        <aff><institution>Department of Biology, Middle Tennessee State University</institution>, <addr-line>Murfreesboro, 37132, TN</addr-line>, <country country="US">USA</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">E-mail: <email>jessica.arbour@mtsu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-17">
      <day>17</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>5</volume>
    <issue>1</issue>
    <elocation-id>obad030</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>31</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of the Society for Integrative and Comparative Biology.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="obad030.pdf"/>
    <abstract>
      <title>Synopsis</title>
      <p>Contrast enhanced computed-tomography imaging like diffusible iodine-based contrast-enhanced computed tomography (diceCT) can provide detailed information on muscle architecture important to comparative analyses of functional morphology, using non-destructive approaches. However, manual segmentation of muscle fascicles/fibers is time-consuming, and automated approaches are at times inaccessible and unaffordable. Here, we introduce GoodFibes, an R package for reconstructing muscle architecture in 3D from diceCT image stacks. GoodFibes uses textural analysis of image grayscale values to track straight or curved fiber paths through a muscle image stack. Accessory functions provide quality checking, fiber merging, and 3D visualization and export capabilities. We demonstrate the utility and effectiveness of GoodFibes using two datasets, from an ant and bat diceCT scans. In both cases, GoodFibes provides reliable measurements of mean fiber length compared to traditional approaches, and is as effective as currently available software packages. This open-source, free to use software package will help to improve access to tools in the analysis of muscle fiber anatomy using diceCT scans. The flexible and transparent R-language environment allows other users to build on the functions described here and permits direct statistical analysis of the resulting fiber metrics. We hope that this will increase the number of comparative and evolutionary studies incorporating these rich and functionally important datasets.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>DEB-2175927</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1">
    <title>Introduction</title>
    <p>While traditional approaches for anatomical and biomechanical studies relied primarily on destructive techniques like dissection, increases in accessibility of computed-tomography (CT) scanning resources have ushered in a renaissance of 3D biological imaging for comparative and biomechanical studies (e.g., <xref rid="bib13" ref-type="bibr">Gignac and Santana 2016</xref>; <xref rid="bib12" ref-type="bibr">Gignac et al. 2016</xref>; <xref rid="bib20" ref-type="bibr">Muñoz and Price 2019</xref>). CT scanning has long been used to visualize hard tissue structures like bones, however, more recently diceCT (diffusible iodine-based contrast-enhanced computed tomography), has been applied to the fine scale resolution of soft tissue structures like muscles and brains/nerves (<xref rid="fig1" ref-type="fig">Fig. 1</xref>; <xref rid="bib19" ref-type="bibr">Kupczik et al. 2015</xref>; <xref rid="bib12" ref-type="bibr">Gignac et al. 2016</xref>; <xref rid="bib11" ref-type="bibr">Gignac and Kley 2018</xref>; <xref rid="bib24" ref-type="bibr">Santana 2018</xref>; <xref rid="bib7" ref-type="bibr">Dickinson et al. 2019</xref>; <xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>; <xref rid="bib6" ref-type="bibr">Camilieri-Asch et al. 2020</xref>; <xref rid="bib16" ref-type="bibr">Holliday et al. 2022</xref>).</p>
    <fig position="float" id="fig1">
      <label>Fig. 1</label>
      <caption>
        <p>A diceCT scan of a North American river otter (<italic toggle="yes">Lontra canadensis</italic>, MEV0216) skinned head stained for 106 days in Lugol's iodine (1%). Scanned at 160 kV and 670 µA in a North Star Imaging System. Axial view showing visible muscle fascicles. Also, see B in <xref rid="fig3" ref-type="fig">Fig. 3</xref>.</p>
      </caption>
      <graphic xlink:href="obad030fig1" position="float"/>
    </fig>
    <p>In particular, diceCT may be particularly useful in the analysis of muscle tissue, as muscle fascicles can often be resolved (<xref rid="fig1" ref-type="fig">Fig. 1</xref>), permitting the collection of muscle architecture data, such as fiber length and pennation angle (<xref rid="bib8" ref-type="bibr">Dickinson et al. 2018</xref>; <xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>; <xref rid="bib17" ref-type="bibr">Katzke et al. 2022</xref>). Such variables are critical in estimating muscle strength and function, for example, in the calculation of physiological cross sectional area (<xref rid="bib15" ref-type="bibr">Herrel et al. 2008</xref>). However, the quantitative analysis of muscle architecture at the fiber/fascicle scale has been limited, especially compared to the abundant comparative analysis of skeletal shape from CT scanning projects (<xref rid="bib5" ref-type="bibr">Buser et al. 2018</xref>; <xref rid="bib3" ref-type="bibr">Arbour et al. 2019</xref>; <xref rid="bib21" ref-type="bibr">Paluh et al. 2020</xref>; among many other examples; <xref rid="bib10" ref-type="bibr">Evans et al. 2021</xref>). Manual segmentation of muscle fibers is tedious, time consuming, requires an expert knowledge of muscle anatomy, and is not feasible for all datasets (<xref rid="bib7" ref-type="bibr">Dickinson et al. 2019</xref>). While automated approaches exist (<xref rid="bib19" ref-type="bibr">Kupczik et al. 2015</xref>; <xref rid="bib8" ref-type="bibr">Dickinson et al. 2018</xref>; <xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>; <xref rid="bib22" ref-type="bibr">Püffel et al. 2021</xref>), their lack of widespread adaptation is partly due to the accessibility and cost associated with software options available.</p>
    <p><xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref> provided a thorough review and comparison of the effectiveness of all major approaches for the 3D reconstruction of muscle fibers currently available. But to briefly summarize the major available methods: The Xfiber module available for distribution with <bold>Avizo/Amira</bold> uses cylindrical template-based fiber tracking approach, and has been effectively applied to vertebrate datasets like crocodiles and birds (<xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>; <xref rid="bib16" ref-type="bibr">Holliday et al. 2022</xref>). This proprietary software package is costly, and while generally effective is sensitive to the input parameters and assumes that fibers have consistent diameter (<xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>). The <bold>ImageXd</bold> software package described by <xref rid="bib19" ref-type="bibr">Kupczik et al. (2015)</xref>, is a standalone command line application that applies textural analysis (i.e., variation in grayscale values) and reconstructs muscle fibers from streamlines of tensors. <xref rid="bib22" ref-type="bibr">Puffel et al. (2021)</xref> produced a stepwise approach in Python and Blender, which was developed to reconstruct straight-path fibers. This approach projects a trajectory down a muscle fiber based on the path of lowest grayscale variation, and was specifically developed for processing an ant muscle dataset; the intersection of the muscle with the apodeme of the exoskeleton must be known. Additionally, this approach cannot currently accommodate curved fibers commonly found in vertebrate muscle. Regardless of the different approaches used here, these methods produce similar results in terms of fiber length and pennation angle to each other, though vary in effectiveness across datasets (<xref rid="bib19" ref-type="bibr">Kupczik et al. 2015</xref>; <xref rid="bib8" ref-type="bibr">Dickinson et al. 2018</xref>, <xref rid="bib7" ref-type="bibr">2019</xref>; <xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>; <xref rid="bib17" ref-type="bibr">Katzke et al. 2022</xref>).</p>
    <p>Here, we introduce an R-language (v4.3.0, 2023) based software package (GoodFibes; <xref rid="bib2" ref-type="bibr">Arbour 2023</xref>) for the reconstruction of muscle fibers from diceCT datasets that incorporates aspects of the previously described methods, while making these approaches available in a widely used, open-source language. As input GoodFibes requires a sequential stack of grayscale images in PNG format, which can be exported from many CT reconstruction software packages or converted from other formats using ImageJ. The approach described here uses variation in grayscale values to track muscle fibers, under the assumption that variation in voxel radiopacity should be minimized along the fascicle/fiber track, similar to ImageXd and the approach described in <xref rid="bib22" ref-type="bibr">Puffel et al. (2021)</xref>. GoodFibes uses an iterative approach like <xref rid="bib22" ref-type="bibr">Puffel et al. (2021)</xref>, however, is able to change trajectories with each step.</p>
    <p>The main function of this package (good.fibes) is constructed such that only a small stack of images (= radius + 1, see arguments described below) are held in working memory in R at any given time. This drastically reduces the burden on memory usage, which can be quite high for large, micro-CT datasets consisting of 1000+ images and is often a major limiting factor in the analysis of such datasets. However, it does trade-off in decreasing the computational efficiency of the tracking algorithm, as images must be read in and removed repeatedly. Given the computational times observed by the author for several microCT datasets (and see example 1), this is a reasonable trade-off for a typically sized dataset. Here, we show that this approach performs similarly to previously mentioned software (Amira, ImageXd, <xref rid="bib22" ref-type="bibr">Puffel et al. 2021</xref>) in the estimation of fiber architecture and the quantification of fiber length in particular.</p>
  </sec>
  <sec sec-type="methods" id="sec2">
    <title>Methods</title>
    <p>The application of the major functions in this new package is illustrated in <xref rid="fig2" ref-type="fig">Fig. 2</xref>. Automated cropping (crop.stack) and equalization (equalize.stack) can be completed on the muscle stack, however, more advanced image adjustments can be made using the free software ImageJ. In particular, the tools “Process &gt; Math &gt; Gamma” and “Process &gt; Filters &gt; Unsharp Mask” in ImageJ/Fiji are effective at reducing noise and improving contrast between muscle fascicles (Jaimi Gray, pers. comm.). The automated cropping function (crop.stack) will ensure a sufficient buffer region of black voxels is present around the muscle to ensure the tracking algorithm will be able to evaluate all possible paths (see below). Subsequent functions are provided to help choose initial parameters (thresholdPlot), tracking muscle fibers (good.fibes), and visualizing the sequence in a tracked fiber (sequencePlot) (and see details below). Several functions are provided for cleaning, quality-checking and combining detected muscle fibers, and for quantifying metrics like length and tortuosity (curvature). Lastly, reconstructed muscle fibers can be visualized and exported as stereolithography; triangular surface mesh (STL) meshes.</p>
    <fig position="float" id="fig2">
      <label>Fig. 2</label>
      <caption>
        <p>Workflow for the use of the GoodFibes package and major functions.</p>
      </caption>
      <graphic xlink:href="obad030fig2" position="float"/>
    </fig>
    <p>The main function of this package, “good.fibes,” uses as input a sequential image stack (.png) containing only the grayscale values for the muscle of interest. The image stack must be isometric (the distance between images is the same as the pixel dimensions) and must occur in sequence in the folder (and when accessing image files names with list.files—see example code). Only one muscle can be analyzed at any given time, and multiple muscles must have their own individual image stack (and see the bat dataset in empirical examples). Images are converted to R compatible objects using the package imager (<xref rid="bib4" ref-type="bibr">Barthelme 2021</xref>). The muscle “region of interest” (region of interest (ROI)—i.e., the pixels representing the muscle in each image of the original scan) can be manually segmented through any available segmentation software that will allow the export of the substack (the complete grayscale data for just the muscle) or a binary ROI (an image stack with white representing the region of interest/muscle and black for all other pixels), such as Dragonfly ORS (<xref rid="bib9" ref-type="bibr">“Dragonfly ORS” 2022</xref>), Mimics (Materalise), Amira/Avizo (Thermo Fisher Scientific), or 3D Slicer (<xref rid="bib18" ref-type="bibr">Kikinis et al. 2014</xref>) (among others). For binary ROIs, the grayscale values can be isolated by importing both image stacks (original grayscale data and the binary ROI) into ImageJ and using the “Image Calculator” tool (under “Process”). In our experience processing stacks exported from Dragonfly, we first subtracted the original image stack <bold>from</bold> the binary ROI/muscle mask image stack, and then subtracted the resulting stack from the binary ROI again. This produced a stack with grayscale values between 0 (black) and 1 (white), with muscle being represented by gray values (between 0 and 1).</p>
    <p>The fiber tracking function “good.fibes” proceeds by first (1) determining a set of well-spaced seed points within an image plane, each of which will (potentially) produce a single muscle fiber (but see below), (2) completing a stepwise forward and backward walk from that seed point, and (3) smoothing the fiber path using splines. Subsequently, functions may be used to assess the quality of detected potential muscle fibers/fascicles, combining partial fiber paths or removing redundant ones, visualizing muscle fibers in 3D, and calculation of fiber length, orientation, and curvature. The order of use of the various functions available is shown in the flowchart in <xref rid="fig2" ref-type="fig">Fig. 2</xref>.</p>
    <sec id="sec2-1">
      <title>Selection of seed points</title>
      <p>The main function is designed to automatically select a set of well-spaced seed points across a plane of interest (image plane and number of seed points are user selected). We applied a hierarchical cluster analysis (using “UPGMA”) of a Euclidean distance matrix of all greyscale points above a threshold value, using the R function “hclust” (package “stats”; <xref rid="bib23" ref-type="bibr">R-Core 2023</xref>). This “threshold argument”—(values from 0 to 1, black to white, corresponding to the brightness of a voxel), is intended to isolate “bright” voxels with a high likelihood of representing muscle fibers. The initial value for threshold (and related parameter cutoff, see below) can be chosen after viewing different options with “thresholdPlot” (and see <xref rid="sup1" ref-type="supplementary-material">supplementary code</xref>). This step is computationally intensive, and increasing the threshold value can help to reduce runtime especially for very large image files. However, very high values for threshold may eliminate major portions of the muscle, especially if there is a slight gradient in grayscale values from staining, and thus fibers detected would not be representative of the whole muscle.</p>
      <p>The dendrogram produced was split into a number of selected clusters equal to the number of required seed points (argument “seed”) using the R function “cutree.” A single starting point was randomly selected from each cluster. We found that this procedure produces a series of starting points for the tracking algorithm, which will be well distributed throughout the muscle, but represent random starting positions. The argument “start.seed” can be used to set the same seed point for repeatable results. The number of muscle fibers detected will be less than or equal to the value for seed, as some starting points may represent noise with no possible pathway forward or backward. In these cases that seed point is dropped and no muscle fiber is produced from that location.</p>
    </sec>
    <sec id="sec2-2">
      <title>Tracking algorithm</title>
      <p>From the selected seed point, the tracking algorithm moves forward and backward through the image stack. To reduce noise and remove values that do not represent muscle tissue, all grayscale values (typically ranging between 0 and 1, for black to white respectively) below a certain threshold value (argument “cutoff,” which can be identical to argument “threshold” or lower/less restrictive) are set to zero (“black”). Setting “threshold” higher than “cutoff” (i.e., threshold considers fewer voxels as non-black) can minimize the time it takes for seed points to be selected, as this step is computationally intensive, and help to localize seed points in bright areas central to muscle fascicles and unlikely to represent interstitial space. However, “threshold” and “cutoff” may be supplied as the same value, especially in scans with good resolution and little noise. In the author's experience these values should be set conservatively/harshly (higher) to help the algorithm follow within one muscle fiber. Very short fibers or poor quality tracks can be filtered out later using “quality.check” or combined with “fuse.fibers,” but tracks that wander between muscle fascicles are more difficult to correct.</p>
      <p>From the selected seed point, a hemisphere/spherical cap of points is projected through the next sequence of images in the image stack. The dimensions of the hemisphere are determined by the value radius, which can currently be set up to 11 (though larger values create more possible paths). For most datasets a value between 5 and 9 will offer a reasonable number of paths that can be evaluated efficiently, with very curved fibers benefited by smaller values of radius. An option (“backstep”) allows paths within the same image plane as the seed point, or “behind” the seed point in the image stack to be considered in the spherical cap of possible paths. This permits particularly curved fibers that pass back through the image stack (e.g., see worked example 2) to be reconstructed, but may increase noise by allowing lateral movement with a muscle fascicle.</p>
      <p>To evaluate the possible paths from the seed point, the standard deviation (SD) in gray values is calculated from all possible unique straight-line paths. Muscle fibers tend to be arranged without abrupt changes in trajectory (generally are straight or curving, as opposed to sharp bends). To account for this, we calculated the deviation of the path from the proceeding trajectory as the Euclidean distance between the end points, scaled the values to lie between 0 and 1, and added this value to 1 (resulting values range from 1 to 2). The selected path was chosen as the path that minimized the following: diagnostic value = scaled grayscale SD * trajectory<sup>scalar</sup>. Paths with low grayscale variation and that follow a consistent trajectory through the image stack will produce the lowest diagnostic values and be selected. The scalar allows users to tailor the impact of trajectory changes (for example, a scalar of zero removes the trajectory penalization). Once the best path is selected (that minimized the above diagnostic value), the algorithm resets and a new hemisphere of paths is selected.</p>
      <p>The tracking algorithm continues this stepwise process until it reaches one of several stop conditions. These conditions are intended to prevent the tracker from passing out of a muscle fascicle and to terminate when reaching the end of the muscle fiber. The conditions under which the backward/forward walk from the seed point terminates include: (1) The only available remaining paths would either terminate or cross a black voxel. This prevents the tracker from passing out of the muscle fascicle. To accommodate noisy datasets, the tracker may be permitted to cross a small number of black voxels. (2) The number of black voxels in the possible paths exceeds a specified number (e.g., 95%). This is meant to isolate regions of noise toward the end of a muscle fascicle, where adjoining connective tissue may obscure the end of a fiber. (3) The remaining paths would terminate within a specified distance of the external “boundary” of the muscle (argument “bound.buffer,” suggested range of 2–5 voxels depending on image size). This prevents fibers from continuing to track along any connective tissue surrounding the muscle in noisy image stacks and to help with compressed boundaries, which can be observed in tightly packed specimens. The bound.buffer argument is particularly important in vertebrate muscle datasets like the otter, bat and darter shown, and less important in the well-defined fibers of the ant dataset.</p>
      <p>Once the tracker has reached a termination condition, it returns to the seed point and proceeds in the opposite direction through the image stack, using the exact same parameters described above. The forward and backward walks through the image stack are then merged into one continuous path, and the function moves to a new seed point.</p>
    </sec>
    <sec id="sec2-3">
      <title>Output and smoothing of muscle fibers</title>
      <p>The function good.fibes returns a list object (for each seed point) that contains <inline-formula><tex-math id="TM0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\$}$\end{document}</tex-math></inline-formula>fiber.points (the raw step-wise coordinates the tracking algorithm returned). Reconstructed fibers from “good.fibes” initially comprise straight line steps. The function “smoothed.fibers” (and several data processing function, like fiber.lengths) use natural cubic splines as implemented by function “nsp” (package “splines2”; <xref rid="bib26" ref-type="bibr">Wang and Yan 2021</xref>), which are piecewise polynomial functions defined by a number of breakpoints or “knots,” to smooth these stepwise tracks into realistically curved muscle fibers. Such splines can be defined using “knots” or “degrees of freedom” (knots = df–1), where “nsp” selects the knots at a suitable location for a shift in the polynomial function (i.e., a bend). Values over df &gt; 1 produce increasingly curved fiber paths, where df = 2 can produce an arched or “U” shape, df = 3 can produce “U” or “S” shaped paths, and so on. In the case of the straight fibers of the ant dataset below a df = 1 was used, and for the vertebrate datasets df = 2 was used as these had simple arching paths between origin and insertion locations. It is likely that df values between 2 and 4 would be sufficiently curved/“bendy” to accommodate most vertebrate muscle fibers.</p>
    </sec>
    <sec id="sec2-4">
      <title>Processing and checking of reconstructed muscle fibers</title>
      <p>We assessed the quality of fibers produced by “good.fibes” following the metrics outlined by <xref rid="bib22" ref-type="bibr">Puffel et al. (2021)</xref>—the ratio between the variation in grayscale values along a fiber track to the length of the reconstructed fiber. Those fibers with high variability compared to fiber length (and determined to be outliers) were removed from further analysis by the function “quality.check.” Optionally, fibers below a set length can also be excluded (similar to the ImageXd and Amira approaches), based on, for example, overall dimensions of the original muscle volume.</p>
      <p>Following removal of poor-quality fiber paths, two functions permit the merging of separate fiber tracks. This is meant to help combine paths from a single otherwise incomplete fiber that did not complete the full walk along its path due to noise or other irregularities in the dataset. The function “fuse.fibers” will combine two fibers into a single fiber path, if the new path is improved compared to the two separate paths (in length and mean residuals) and the function “check.overlap” is used to remove redundant fibers, produced from separate seed points within the same fascicle or fiber but resulting in slightly different fiber tracks. Both of these evaluate two fibers if they fall within a minimum distance in voxels (min.vox) of each other. This should be selected based on the width of the fascicles and the distance between fascicles, but we generally used ∼½ of an average fascicle width in cross section.</p>
    </sec>
    <sec id="sec2-5">
      <title>Quantification and visualization</title>
      <p>Package GoodFibes currently carries out the calculation of fiber length, orientation and curvature (tortuosity), based on spline-smooth fiber paths, via the functions “fiber.lengths,” “fiber.angle,” (in degrees) and “fiber.curve,” respectively. Fiber length can be output in units of voxel length or in the actual scale of the original scan data by providing the scan resolution (res). Orientation is currently in comparison to a specific axis (similar to the <xref rid="bib17" ref-type="bibr">Katzke et al. 2022</xref> visualization), but future updates to the package will permit the comparisons of fibers to a tendon.</p>
      <p>Visualization of 3D muscle fibers draws largely from the capabilities of the R package “rgl” (<xref rid="bib1" ref-type="bibr">Adler et al. 2003</xref>), and see <xref rid="fig3" ref-type="fig">Fig. 3</xref>. Correspondence between the original muscle fiber “track” and the smoothed fiber can be visualized using “muscle.plot” (<xref rid="fig4" ref-type="fig">Fig. 4</xref>). Processed fibers can be illustrated along with a boundary showing the muscle shape using “muscle.plot.multi” (<xref rid="fig3" ref-type="fig">Fig. 3</xref>). Finally, “muscle.plot.stl” can be used to export the 3D muscle fibers as a triangular surface mesh STL (.stl) file, with the option to first check the visual properties (save.plot = FALSE). If the resolution of the scan is provided, the muscle fibers will be scaled to actual size in the 3D mesh file and these can be opened in any 3D mesh editing software like “Geomagic,” “Meshmixer,” or “Blender” (among others). The visualization in <xref rid="fig6" ref-type="fig">Fig. 6</xref> was produced by exporting the bat muscles as individual STL files and importing them into Geomagic. The skull in this image was produced from a separate, non-stained scan and manually aligned with the generated muscle groups (based on dissection photos and anatomical landmarks) in Geomagic, as is already commonly done with volume reconstructions of muscles in other diceCT works (<xref rid="bib24" ref-type="bibr">Santana 2018</xref>).</p>
      <fig position="float" id="fig3">
        <label>Fig. 3</label>
        <caption>
          <p>Sample datasets processed using the GoodFibes package, showing a range of size, taxa, and visualizations. (A) Greenside darter (<italic toggle="yes">Etheostoma blennioides</italic>, MTSUZ-9) diceCT in coronal view (17.2 µm, stained with Lugol's iodine 1% for 3 days, scanned whole in a Scanco µCT50 system at 55 kV and 200 µA, at the Vanderbilt Center for Small Animal Imaging). (i) 3D reconstruction in Dragonfly ORS and (ii) single sample image from stack. The two major divisions of the adductor mandibular (AM1 and AM2) were segmented and muscle fascicles automatically detected. Visualized with “muscle.plot.stl,” (iii) showing the divisions labelled by colors and (iv) colored by orientation compared to the central axis. (B) North American river otter (<italic toggle="yes">Lontra canadensis MEV0216</italic>) head diceCT (70.8 µm, stained for 106 days, and scanned at 160 kV and 670 µA on a North Star Imaging System at the University of Washington). Specimen was skinned prior to staining. (i) 3D reconstruction of scan and (ii) single image from stack. Muscle fibers from the temporalis (purple) and superficial masseter (blue) in (iii) lateral and (iv) dorsal views.</p>
        </caption>
        <graphic xlink:href="obad030fig3" position="float"/>
      </fig>
      <fig position="float" id="fig4">
        <label>Fig. 4</label>
        <caption>
          <p>Mandibular muscle in an ant (<italic toggle="yes">Monomorium pharonis</italic>). See <xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref> for scanning parameters and other details. (A) Image from diceCT image stack, with muscle ROI segmented. Muscle fibers were oriented to pass through the image stack, rather than parallel to the image plane. (B) A single fiber track (points) and the smoothed path through the muscle, generated from a single automatically determined seed point. (C) A total of 198 muscle fibers detected and processed in GoodFibes, shown from three angles. Dataset from <xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref>, and detected fibers available as “ant.final” data object.</p>
        </caption>
        <graphic xlink:href="obad030fig4" position="float"/>
      </fig>
      <p>If multiple muscles are processed the results can be combined both within and outside of the R language environment. If all muscles are generated from stacks representing the same “space” (i.e., in the same view/plane, without cropping, and all images in the sequence are in each stack), then they will be automatically aligned in 3D coordinate space (with each other) and can be plotted together in R (as well as after export to programs like Geomagic and MeshLab). Using the concatenate function (“c”) the lists containing the two muscle fibers can be combined into one object for plotting (e.g., with “muscle.plot.stl”), while a vector of colors can be provided based on muscle group or other properties like length (<xref rid="fig3" ref-type="fig">Fig. 3</xref>, and see Supp. Mat. for example code). If the data are cropped prior to muscle fiber detection (either by image or fully black images were first removed), then values can be added to the fiber coordinates to realign the muscles (examples given in <xref rid="sup1" ref-type="supplementary-material">supplementary materials</xref>). The function “crop.stack” will output the necessary values for the x and y coordinates (xlim, ylim) and the number of deleted images at the beginning of the stack can be used to provide the z value if needed, and can be rerun on the original data again (without saving images) to reacquire these values if not recorded on the first use of the function. Once the impact of cropping has been corrected, the different muscles can be combined with “c” as described above and exported as anatomically aligned STL files.</p>
    </sec>
    <sec id="sec2-6">
      <title>Empirical examples</title>
      <p><xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref> use a diceCT dataset of an ant (<italic toggle="yes">Monomorium pharonis</italic>) mandibular muscle (resolution 0.67 µm) to demonstrate the effectiveness of the three previously listed applications in the estimation of fiber length and angle. This scan is high resolution, shows low noise, and the muscle fibers can be individually visualized, permitting a comparison to manually segmented values. The authors of that study kindly shared their dataset allowing a direct comparison. The muscle ROI was segmented using Dragonfly ORS software and the ROI was exported as a binary image stack. I used the image calculator functions in ImageJ to create an image stack of exclusively grayscale data for the muscle ROI, saved as .png format files. Using good.fibes, 250 seed points were applied across 5 image planes (50 each) to reconstruct muscle fibers across the image stack (threshold = 0.7, cutoff = 0.65, backstep = 0, allowed.black = 0, scaler = 1). We applied quality.check to remove fibers of low resolution, and check.overlap and fuse.fibers to combine fibers that were (1) redundant from seed points on different planes, or (2) terminated early but continued from a different starting point. We used a distance of 8 voxels in fuse.fibers and check.overlap (min.vox), as this was about half the width of a typical fiber in cross-section, so that fibers from different bundles would not be grouped together. No fibers were manually removed from the dataset. Runtime for 250 seed points was 92 min on an HP laptop with an Intel(R) i5-10300H CPU (2.50 GHz) with RAM utilization of &lt;1 GB. Example code is given in the help files associated with the various functions in the package (see <xref rid="sup1" ref-type="supplementary-material">supplementary files</xref>). Muscle fiber lengths were compared with the previous studies estimates from manual digital dissection and ImageXd and Amira.</p>
      <p>Image stacks were produced for the superficial, zygomatic, deep and medial temporalis, masseter, zygomaticomandibularis (ZM), and medial pterygoid from a diceCT scan of an Egyptian Fruit Bat (<italic toggle="yes">Rousettus aegyptiacus</italic>) stained for 28 days in 1% Lugol's Iodine, and scanned at a resolution = 10.05 µm and downsampled to 20.1 µm for processing in Mimics). Between 200 and 400 seed points across 4–6 images were used per muscle, with threshold and cutoff values visually selected using “thresholdPlot” (other arguments used across muscles: radius = 7, allowed.black = 1). Data cleaning and processing (with smoothing df = 2) follows that of the ant example, and a small number of fibers showing unusual curvature or orientation were removed (&lt;10 per muscle), following <xref rid="bib25" ref-type="bibr">Sullivan et al. (2019)</xref>. The tracking algorithm performed inconsistently when muscle fibers lay parallel to the image plane, so the deep temporalis and ZM were reprojected in Dragonfly ORS to an axial view (using the data inverter plugin &gt; axis transformation prior to exporting the binary image stack), while all other muscles were analyzed in coronal view. For the superficial temporalis and ZM, some fibers curve or are reoriented back into the image plane, and backstep = 1 was included. Mean fiber lengths were compared with those taken from traditional dissection (<italic toggle="yes">n</italic> = 15 per muscle) from previous (unpublished) work on bat bite biomechanics. For dissection and fiber separation protocol see <xref rid="bib14" ref-type="bibr">Hartstone-Rose et al. (2018)</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec3">
    <title>Results</title>
    <p>Both empirical datasets show reasonable effectiveness in estimating fiber lengths compared with previous software applications and traditional approaches. After application of “quality.check,” “fuse.fibers,” and “check.overlap,” a total of 198 smoothed muscle fiber paths (df = 1) were produced for the ant muscle. Reconstruction of muscle fibers in 3D appears visually similar to that produced in the prior study (<xref rid="fig4" ref-type="fig">Fig. 4</xref>). The mean fiber length calculated using “fiber.lengths” was 0.115 mm (sd = 0.025 mm). This was well matched to the mean length from manual segmentation reported by <xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref>, (mean = 0.114 mm, sd = 0.014 mm) and fell well within the estimates produced by other methods (0.106–0.117 mm, <xref rid="fig5" ref-type="fig">Fig. 5</xref>). Minimum fiber length was somewhat lower in our approach, although several of the other methods use a minimum fiber length cutoff as part of their reconstruction approach (e.g., Amira).</p>
    <fig position="float" id="fig5">
      <label>Fig. 5</label>
      <caption>
        <p>Comparison of GoodFibes to currently available approaches (see introduction for descriptions) on the ant mandibular muscle dataset. Data for manual, Amira, ImageXd, and <xref rid="bib22" ref-type="bibr">Puffel et al. 2021</xref> taken from <xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref>. Vertical line indicates mean value per method.</p>
      </caption>
      <graphic xlink:href="obad030fig5" position="float"/>
    </fig>
    <p>In the case of the cranial adductors in the Egyptian fruit bat, muscle fiber reconstructions were visually consistent with the diceCT reconstruction (<xref rid="fig6" ref-type="fig">Fig. 6</xref>) and as observed during the muscle dissections. Mean fiber lengths were strongly correlated with those produced by manual dissection (r = 0.86) and deviations were typically small (&lt;10% of average fiber length; <xref rid="tbl1" ref-type="table">Table 1</xref>). The superficial temporalis showed the greatest departure, though this was still within the performance range of previous approaches (e.g., <xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>). This may result from the orientation of the superficial temporalis, which in the image stack makes a sharp “downwards” turn as it approaches its attachment site.</p>
    <fig position="float" id="fig6">
      <label>Fig. 6</label>
      <caption>
        <p>Muscle fibers in <italic toggle="yes">Rousettus aegyptiacus</italic>, from the research collection of Sharlene Santana, University of Washington. (A) Original sample diceCT image, scanned on a Skyscan 1172 at 60 kV, shown in coronal view. (B) 3D Visualization of diceCT scan data. (C) Muscle fibers automatically detected by GoodFibes (red = s. temporalis, orange = m. temporalis, purple = z. temporalis, pink = d. temporalis, blue = masseter, yellow = ZM, green = pterygoid. Fibers were exported from R using “muscle.plot.stl” as STL files and imaged with the skull in Geomagic, see methods (“visualization”) for details.</p>
      </caption>
      <graphic xlink:href="obad030fig6" position="float"/>
    </fig>
    <table-wrap position="float" id="tbl1">
      <label>Table 1
</label>
      <caption>
        <p>Mean fiber lengths produced from manual dissection (<italic toggle="yes">n</italic> = 15) and reconstruction. Percent difference calculated from manual dissection estimates</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th align="center" rowspan="1" colspan="1">Manual</th>
            <th align="center" rowspan="1" colspan="1">Digital reconstruction</th>
            <th align="center" rowspan="1" colspan="1">Percent</th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th align="center" rowspan="1" colspan="1">dissection</th>
            <th align="center" rowspan="1" colspan="1">via GoodFibes</th>
            <th align="center" rowspan="1" colspan="1">difference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Masseter</td>
            <td rowspan="1" colspan="1">6.905</td>
            <td rowspan="1" colspan="1">7.335</td>
            <td rowspan="1" colspan="1">5.86%</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Medial pterygoid</td>
            <td rowspan="1" colspan="1">3.538</td>
            <td rowspan="1" colspan="1">3.82</td>
            <td rowspan="1" colspan="1">7.38%</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Deep temporalis</td>
            <td rowspan="1" colspan="1">6.223</td>
            <td rowspan="1" colspan="1">5.586</td>
            <td rowspan="1" colspan="1">−11.40%</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Medial temporalis</td>
            <td rowspan="1" colspan="1">6.427</td>
            <td rowspan="1" colspan="1">7.018</td>
            <td rowspan="1" colspan="1">8.42%</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Superficial temporalis</td>
            <td rowspan="1" colspan="1">7.877</td>
            <td rowspan="1" colspan="1">6.481</td>
            <td rowspan="1" colspan="1">−21.54%</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Zygomatic temporalis</td>
            <td rowspan="1" colspan="1">5.722</td>
            <td rowspan="1" colspan="1">5.905</td>
            <td rowspan="1" colspan="1">3.10%</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Zygomaticomandibularis</td>
            <td rowspan="1" colspan="1">5.34</td>
            <td rowspan="1" colspan="1">5.209</td>
            <td rowspan="1" colspan="1">−2.51%</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
  <sec sec-type="discussion" id="sec4">
    <title>Discussion</title>
    <p>Overall, GoodFibes presents a novel combination of features in automated muscle fiber detection, and produces reasonable reconstructions of muscle fascicles/fibers in two worked examples. The range of deviations from dissected muscle fiber lengths our approach (2.5–21.5%) was within the range observed for ImageXD and Amira from other examples in vertebrate muscle. <xref rid="bib25" ref-type="bibr">Sullivan et al. (2019)</xref>, found a deviation of 23% in mean fiber length using Amira in a starling pectoral muscle, while ImageXd produced differences between 8 and 42% in primate jaw muscles (<xref rid="bib19" ref-type="bibr">Kupczik et al. 2015</xref>; <xref rid="bib8" ref-type="bibr">Dickinson et al. 2018</xref>). Manual segmentation of fascicles from diceCT scans produced comparable differences to GoodFibes (2.3–18.0%; <xref rid="bib7" ref-type="bibr">Dickinson et al. 2019</xref>). We also note that our estimate of mean length from manual dissection in the Egyptian Fruit Bat is based on only 15 fibers per muscle. While this is typical practice for many biomechanics studies in bats and other mammals, this small sample is also likely to vary from the true parameter mean of the muscle.</p>
    <p>Like any approach using diceCT scan data to reconstruct muscle fibers, the effectiveness of this approach will be limited by the quality of the scan data, including: having an appropriately high-resolution scan with good contrast between muscle tissue and connective tissue; having no major artifacts in the scan (e.g., ring artifacts); having even perfusion of stain throughout a segmented muscle. Muscles with uneven staining (i.e., brighter outer regions of the muscle tissue on scans) may result in the tracking algorithm choosing paths that move between fascicles in brighter regions and having more paths end abruptly in less stained regions due to thresholding. Similar to the Amira fiber tracking module, GoodFibes requires estimation of a set of grayscale thresholds, and other input parameters like the radius of each step in the tracking algorithm, etc. In both cases there is no currently published approach for determining a reasonable set of starting values, and thus for both approaches the selection of these values is through subjective user assessment.</p>
    <p>As noted for the deep temporalis and ZM muscle from the bat dataset, the tracking algorithm performed more inconsistently when muscle fibers were oriented with the plane of the images (results not shown). However, exporting the image stack for these muscles in a different plane was sufficient to produce reasonable estimates of fiber length. Muscles with sections that vary substantially in orientation, such that some muscle fibers are oriented within the image plane, while others are more orthogonal to it (e.g., superficial temporalis), might produce a biased sample of fiber lengths (this muscle produces the largest discrepancy). In such a case, segmenting the regions of the muscle into individual stacks or reorienting the image stack could mitigate these issues, but other software options (e.g., Amira which uses template-based tracking), may be more suitable in these cases.</p>
    <p>GoodFibes provides reliable reconstruction of muscle fibers from diceCT scans in a flexible and open-source R language environment. While we have not evaluated this approach on datasets produced for other staining approaches (e.g., Phosphotungstic Acid), it is possible it could be effectively applied in these cases as well, but a separate evaluation with known (fiber length) datasets would be advisable. We hope that this package will address long-standing issues regarding accessibility and affordability in the automated detection of muscle fibers, and facilitate greater comparative and macroevolutionary analysis of muscle architecture from such non-destructive approaches.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>obad030_Supplemental_Files</label>
      <media xlink:href="obad030_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We are grateful to Julian Katzke and Sharlene Santana for access to the ant and bat datasets respectively, and to two reviewers who provided helpful comments. This work was supported by an NSF grant (DEB-2175927) and an FRCAC grant from MTSU to the author, and an NSF grant to Sharlene Santana (IOS-1557125).</p>
  </ack>
  <sec id="sec6">
    <title>Data Accessibility</title>
    <p>All functions required for the above analyses are distributed with the package GoodFibes available through CRAN (<ext-link xlink:href="https://cran.r-project.org/web/packages/GoodFibes" ext-link-type="uri">https://cran.r-project.org/web/packages/GoodFibes</ext-link>). The ant dataset is available via Dryad with the original publication <xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref>, and the segmented and reoriented files are hosted on <ext-link xlink:href="https://github.com/" ext-link-type="uri">github.com</ext-link> and accessible through the help files in the GoodFibes documentation. The finalized muscle fibers for the greenside darter and otter are available through the <xref rid="sup1" ref-type="supplementary-material">supplementary materials</xref>. The bat diceCT image stack is available via Morphosource (media ID: 000,541,794), the STLs are available in the <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref> and a color coded 3D model is viewable through the author's sketchfab account (<ext-link xlink:href="https://sketchfab.com/MTSUichthyology" ext-link-type="uri">https://sketchfab.com/MTSUichthyology</ext-link>).</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The author has no conflicts of interest to declare.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adler</surname><given-names>D</given-names></string-name>, <string-name><surname>Nenadic</surname><given-names>O</given-names></string-name>, <string-name><surname>Zucchini</surname><given-names>W</given-names></string-name></person-group>. <year>2003</year>. <article-title>RGL: a R-library for 3D visualization with OpenGL</article-title>. <source>Proc 35th Symp Interface Comput Sci Stat</source><fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation>
    </ref>
    <ref id="bib2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Arbour</surname><given-names>JH</given-names></string-name></person-group>. <year>2023</year>. <article-title>GoodFibes: detection and reconstruction of muscle fibers from diceCT image data</article-title>. <comment>R package version 0.1.10. The Comprehensive R Archive Network. <ext-link xlink:href="https://CRAN.R-project.org/package=GoodFibes" ext-link-type="uri">https://CRAN.R-project.org/package=GoodFibes</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arbour</surname><given-names>JH</given-names></string-name>, <string-name><surname>Curtis</surname><given-names>AA</given-names></string-name>, <string-name><surname>Santana</surname><given-names>SE</given-names></string-name></person-group>. <year>2019</year>. <article-title>Signatures of echolocation and dietary ecology in the adaptive evolution of skull shape in bats</article-title>. <source>Nat Commun</source><volume>10</volume>:<fpage>2036</fpage>.<pub-id pub-id-type="pmid">31048713</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Barthelme</surname><given-names>S</given-names></string-name></person-group>. <year>2021</year>. <article-title>imager: image processing library based on “CImg”</article-title>. <comment>R package version 0.42.11. The Comprehensive R Archive Network. <ext-link xlink:href="https://CRAN.R-project.org/package=imager" ext-link-type="uri">https://CRAN.R-project.org/package=imager</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buser</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Sidlauskas</surname><given-names>BL</given-names></string-name>, <string-name><surname>Summers</surname><given-names>AP</given-names></string-name></person-group>. <year>2018</year>. <article-title>2D or not 2D? Testing the utility of 2D vs. 3D landmark data in geometric morphometrics of the sculpin subfamily oligocottinae (Pisces; Cottoidea)</article-title>. <source>Anat Rec</source><volume>301</volume>:<fpage>806</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camilieri-Asch</surname><given-names>V</given-names></string-name>, <string-name><surname>Shaw</surname><given-names>JA</given-names></string-name>, <string-name><surname>Yopak</surname><given-names>KE</given-names></string-name>, <string-name><surname>Chapuis</surname><given-names>L</given-names></string-name>, <string-name><surname>Partridge</surname><given-names>JC</given-names></string-name>, <string-name><surname>Collin</surname><given-names>SP</given-names></string-name></person-group>. <year>2020</year>. <article-title>Volumetric analysis and morphological assessment of the ascending olfactory pathway in an elasmobranch and a teleost using diceCT</article-title>. <source>Brain Struct Funct</source><volume>225</volume>:<fpage>2347</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">32870419</pub-id></mixed-citation>
    </ref>
    <ref id="bib7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dickinson</surname><given-names>E</given-names></string-name>, <string-name><surname>Basham</surname><given-names>C</given-names></string-name>, <string-name><surname>Rana</surname><given-names>A</given-names></string-name>, <string-name><surname>Hartstone-Rose</surname><given-names>A</given-names></string-name></person-group>. <year>2019</year>. <article-title>Visualization and quantification of digitally dissected muscle fascicles in the masticatory muscles of <italic toggle="yes">Callithrix jacchus</italic> using nondestructive DiceCT</article-title>. <source>Anat Rec</source><volume>302</volume>:<fpage>1891</fpage>–<lpage>900</lpage>.</mixed-citation>
    </ref>
    <ref id="bib8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dickinson</surname><given-names>E</given-names></string-name>, <string-name><surname>Stark</surname><given-names>H</given-names></string-name>, <string-name><surname>Kupczik</surname><given-names>K</given-names></string-name></person-group>. <year>2018</year>. <article-title>Non-destructive determination of muscle architectural variables through the use of DiceCT</article-title>. <source>Anat Rec</source><volume>301</volume>:<fpage>363</fpage>–<lpage>77</lpage>.</mixed-citation>
    </ref>
    <ref id="bib9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>Dragonfly</collab></person-group>. <year>2022</year>. <article-title>Object Research Systems (ORS) Inc, Montreal, Canada</article-title>. <comment><ext-link xlink:href="http://www.theobjects.com/dragonfly" ext-link-type="uri">http://www.theobjects.com/dragonfly</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Evans</surname><given-names>KM</given-names></string-name>, <string-name><surname>Larouche</surname><given-names>O</given-names></string-name>, <string-name><surname>Watson</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Farina</surname><given-names>S</given-names></string-name>, <string-name><surname>Habegger</surname><given-names>ML</given-names></string-name>, <string-name><surname>Friedman</surname><given-names>M</given-names></string-name></person-group>. <year>2021</year>. <article-title>Integration drives rapid phenotypic evolution in flatfishes</article-title>. <source>Proc Natl Acad Sci USA</source><volume>118</volume>:<fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="bib11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gignac</surname><given-names>PM</given-names></string-name>, <string-name><surname>Kley</surname><given-names>NJ</given-names></string-name></person-group>. <year>2018</year>. <article-title>The utility of DiceCT imaging for high-throughput comparative neuroanatomical studies</article-title>. <source>Brain Behav Evol</source><volume>91</volume>:<fpage>180</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">30099463</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gignac</surname><given-names>PM</given-names></string-name>, <string-name><surname>Kley</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Clarke</surname><given-names>JA</given-names></string-name>, <string-name><surname>Colbert</surname><given-names>MW</given-names></string-name>, <string-name><surname>Morhardt</surname><given-names>AC</given-names></string-name>, <string-name><surname>Cerio</surname><given-names>D</given-names></string-name>, <string-name><surname>Cost</surname><given-names>IN</given-names></string-name>, <string-name><surname>Cox</surname><given-names>PG</given-names></string-name>, <string-name><surname>Daza</surname><given-names>JD</given-names></string-name>, <string-name><surname>Early</surname><given-names>CM</given-names></string-name><etal>et al.</etal></person-group><year>2016</year>. <article-title>Diffusible iodine-based contrast-enhanced computed tomography (diceCT): an emerging tool for rapid, high-resolution, 3-D imaging of metazoan soft tissues</article-title>. <source>J Anat</source><volume>228</volume>:<fpage>889</fpage>–<lpage>909</lpage>.<pub-id pub-id-type="pmid">26970556</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gignac</surname><given-names>PM</given-names></string-name>, <string-name><surname>Santana</surname><given-names>SE</given-names></string-name></person-group>. <year>2016</year>. <article-title>A bigger picture: organismal function at the nexus of development, ecology, and evolution: an introduction to the symposium</article-title>. <source>Integr Comp Biol</source><volume>56</volume>:<fpage>369</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">27413091</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hartstone-Rose</surname><given-names>A</given-names></string-name>, <string-name><surname>Deutsch</surname><given-names>AR</given-names></string-name>, <string-name><surname>Leischner</surname><given-names>CL</given-names></string-name>, <string-name><surname>Pastor</surname><given-names>F</given-names></string-name></person-group>. <year>2018</year>. <article-title>Dietary correlates of primate masticatory muscle fiber architecture</article-title>. <source>Anat Rec</source><volume>301</volume>:<fpage>311</fpage>–<lpage>24</lpage>.</mixed-citation>
    </ref>
    <ref id="bib15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Herrel</surname><given-names>A</given-names></string-name>, <string-name><surname>De Smet</surname><given-names>A</given-names></string-name>, <string-name><surname>Aguirre</surname><given-names>LF</given-names></string-name>, <string-name><surname>Aerts</surname><given-names>P</given-names></string-name></person-group>. <year>2008</year>. <article-title>Morphological and mechanical determinants of bite force in bats: do muscles matter?</article-title><source>J Exp Biol</source><volume>211</volume>:<fpage>86</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">18083736</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Holliday</surname><given-names>CM</given-names></string-name>, <string-name><surname>Sellers</surname><given-names>KC</given-names></string-name>, <string-name><surname>Lessner</surname><given-names>EJ</given-names></string-name>, <string-name><surname>Middleton</surname><given-names>KM</given-names></string-name>, <string-name><surname>Cranor</surname><given-names>C</given-names></string-name>, <string-name><surname>Verhulst</surname><given-names>CD</given-names></string-name>, <string-name><surname>Lautenschlager</surname><given-names>S</given-names></string-name>, <string-name><surname>Bader</surname><given-names>K</given-names></string-name>, <string-name><surname>Brown</surname><given-names>MA</given-names></string-name>, <string-name><surname>Colbert</surname><given-names>MW</given-names></string-name></person-group>. <year>2022</year>. <article-title>New frontiers in imaging, anatomy and mechanics of crocodylian jaw muscles</article-title>. <source>Anat Rec</source><volume>305</volume>:<fpage>3016</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="bib17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Katzke</surname><given-names>J</given-names></string-name>, <string-name><surname>Puchenkov</surname><given-names>P</given-names></string-name>, <string-name><surname>Stark</surname><given-names>H</given-names></string-name>, <string-name><surname>Economo</surname><given-names>EP</given-names></string-name></person-group>. <year>2022</year>. <article-title>A roadmap to reconstructing muscle architecture from CT data</article-title>. <source>Integr Org Biol</source><volume>4</volume>.</mixed-citation>
    </ref>
    <ref id="bib18">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kikinis</surname><given-names>R</given-names></string-name>, <string-name><surname>Pieper</surname><given-names>SD</given-names></string-name>, <string-name><surname>Vosburgh</surname><given-names>KG</given-names></string-name></person-group>. <year>2014</year>. <article-title>3D Slicer: a platform for subject-specific image analysis, visualization, and clinical support</article-title>. In: <source>Intraoperative imaging and image-guided therapy</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>New York, NY</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="bib19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kupczik</surname><given-names>K</given-names></string-name>, <string-name><surname>Stark</surname><given-names>H</given-names></string-name>, <string-name><surname>Mundry</surname><given-names>R</given-names></string-name>, <string-name><surname>Neininger</surname><given-names>FT</given-names></string-name>, <string-name><surname>Heidlauf</surname><given-names>T</given-names></string-name>, <string-name><surname>Röhrle</surname><given-names>O</given-names></string-name></person-group>. <year>2015</year>. <article-title>Reconstruction of muscle fascicle architecture from iodine-enhanced microCT images : a combined texture mapping and streamline approach</article-title>. <source>J Theor Biol</source><volume>382</volume>:<fpage>34</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">26141643</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muñoz</surname><given-names>MM</given-names></string-name>, <string-name><surname>Price</surname><given-names>SA</given-names></string-name></person-group>. <year>2019</year>. <article-title>The future is bright for evolutionary morphology and biomechanics in the era of big data</article-title>. <source>Integr Comp Biol</source><volume>59</volume>:<fpage>599</fpage>–<lpage>603</lpage>.<pub-id pub-id-type="pmid">31353403</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paluh</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Stanley</surname><given-names>EL</given-names></string-name>, <string-name><surname>Blackburn</surname><given-names>DC</given-names></string-name></person-group>. <year>2020</year>. <article-title>Evolution of hyperossification expands skull diversity in frogs</article-title>. <source>Proc Natl Acad Sci USA</source><volume>117</volume>:<fpage>8554</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">32220958</pub-id></mixed-citation>
    </ref>
    <ref id="bib22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Püffel</surname><given-names>F</given-names></string-name>, <string-name><surname>Pouget</surname><given-names>A</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Zuber</surname><given-names>M</given-names></string-name>, <string-name><surname>Van De Kamp</surname><given-names>T</given-names></string-name>, <string-name><surname>Roces</surname><given-names>F</given-names></string-name>, <string-name><surname>Labonte</surname><given-names>D</given-names></string-name></person-group>. <year>2021</year>. <article-title>Morphological determinants of bite force capacity in insects: a biomechanical analysis of polymorphic leaf-cutter ants</article-title>. <source>J R Soc Interface</source><volume>18</volume>:<fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="bib23">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>R Core Team</collab></person-group>. <year>2023</year>. <source>R: A language and environment for statistical computing</source>. <comment>R Foundation for Statistical Computing, Vienna, Austria. <ext-link xlink:href="https://www.R-project.org/" ext-link-type="uri">https://www.R-project.org/</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Santana</surname><given-names>SE</given-names></string-name></person-group>. <year>2018</year>. <article-title>Comparative anatomy of Bat jaw musculature via diffusible iodine-based contrast-enhanced computed tomography</article-title>. <source>Anat Rec</source><volume>301</volume>:<fpage>267</fpage>–<lpage>78</lpage>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sullivan</surname><given-names>SP</given-names></string-name>, <string-name><surname>McGechie</surname><given-names>FR</given-names></string-name>, <string-name><surname>Middleton</surname><given-names>KM</given-names></string-name>, <string-name><surname>Holliday</surname><given-names>CM</given-names></string-name></person-group>. <year>2019</year>. <article-title>3D muscle architecture of the pectoral muscles of European Starling (<italic toggle="yes">Sturnus vulgaris</italic>)</article-title>. <source>Integr Org Biol</source><volume>1</volume>:<fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="bib26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Yan</surname><given-names>J</given-names></string-name></person-group>. <year>2021</year>. <article-title>Shape-restricted regression splines with R package splines2</article-title>. <source>J Data Sci</source><volume>19</volume>:<fpage>498</fpage>–<lpage>517</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Integr Org Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Integr Org Biol</journal-id>
    <journal-id journal-id-type="publisher-id">iob</journal-id>
    <journal-title-group>
      <journal-title>Integrative Organismal Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2517-4843</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10461528</article-id>
    <article-id pub-id-type="pmid">37644979</article-id>
    <article-id pub-id-type="doi">10.1093/iob/obad030</article-id>
    <article-id pub-id-type="publisher-id">obad030</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GoodFibes: An R Package for The Detection of Muscle Fibers from diceCT Scans</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4506-158X</contrib-id>
        <name>
          <surname>Arbour</surname>
          <given-names>J H</given-names>
        </name>
        <!--jessica.arbour@mtsu.edu-->
        <aff><institution>Department of Biology, Middle Tennessee State University</institution>, <addr-line>Murfreesboro, 37132, TN</addr-line>, <country country="US">USA</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">E-mail: <email>jessica.arbour@mtsu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-17">
      <day>17</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>5</volume>
    <issue>1</issue>
    <elocation-id>obad030</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>31</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of the Society for Integrative and Comparative Biology.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="obad030.pdf"/>
    <abstract>
      <title>Synopsis</title>
      <p>Contrast enhanced computed-tomography imaging like diffusible iodine-based contrast-enhanced computed tomography (diceCT) can provide detailed information on muscle architecture important to comparative analyses of functional morphology, using non-destructive approaches. However, manual segmentation of muscle fascicles/fibers is time-consuming, and automated approaches are at times inaccessible and unaffordable. Here, we introduce GoodFibes, an R package for reconstructing muscle architecture in 3D from diceCT image stacks. GoodFibes uses textural analysis of image grayscale values to track straight or curved fiber paths through a muscle image stack. Accessory functions provide quality checking, fiber merging, and 3D visualization and export capabilities. We demonstrate the utility and effectiveness of GoodFibes using two datasets, from an ant and bat diceCT scans. In both cases, GoodFibes provides reliable measurements of mean fiber length compared to traditional approaches, and is as effective as currently available software packages. This open-source, free to use software package will help to improve access to tools in the analysis of muscle fiber anatomy using diceCT scans. The flexible and transparent R-language environment allows other users to build on the functions described here and permits direct statistical analysis of the resulting fiber metrics. We hope that this will increase the number of comparative and evolutionary studies incorporating these rich and functionally important datasets.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>DEB-2175927</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1">
    <title>Introduction</title>
    <p>While traditional approaches for anatomical and biomechanical studies relied primarily on destructive techniques like dissection, increases in accessibility of computed-tomography (CT) scanning resources have ushered in a renaissance of 3D biological imaging for comparative and biomechanical studies (e.g., <xref rid="bib13" ref-type="bibr">Gignac and Santana 2016</xref>; <xref rid="bib12" ref-type="bibr">Gignac et al. 2016</xref>; <xref rid="bib20" ref-type="bibr">Muñoz and Price 2019</xref>). CT scanning has long been used to visualize hard tissue structures like bones, however, more recently diceCT (diffusible iodine-based contrast-enhanced computed tomography), has been applied to the fine scale resolution of soft tissue structures like muscles and brains/nerves (<xref rid="fig1" ref-type="fig">Fig. 1</xref>; <xref rid="bib19" ref-type="bibr">Kupczik et al. 2015</xref>; <xref rid="bib12" ref-type="bibr">Gignac et al. 2016</xref>; <xref rid="bib11" ref-type="bibr">Gignac and Kley 2018</xref>; <xref rid="bib24" ref-type="bibr">Santana 2018</xref>; <xref rid="bib7" ref-type="bibr">Dickinson et al. 2019</xref>; <xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>; <xref rid="bib6" ref-type="bibr">Camilieri-Asch et al. 2020</xref>; <xref rid="bib16" ref-type="bibr">Holliday et al. 2022</xref>).</p>
    <fig position="float" id="fig1">
      <label>Fig. 1</label>
      <caption>
        <p>A diceCT scan of a North American river otter (<italic toggle="yes">Lontra canadensis</italic>, MEV0216) skinned head stained for 106 days in Lugol's iodine (1%). Scanned at 160 kV and 670 µA in a North Star Imaging System. Axial view showing visible muscle fascicles. Also, see B in <xref rid="fig3" ref-type="fig">Fig. 3</xref>.</p>
      </caption>
      <graphic xlink:href="obad030fig1" position="float"/>
    </fig>
    <p>In particular, diceCT may be particularly useful in the analysis of muscle tissue, as muscle fascicles can often be resolved (<xref rid="fig1" ref-type="fig">Fig. 1</xref>), permitting the collection of muscle architecture data, such as fiber length and pennation angle (<xref rid="bib8" ref-type="bibr">Dickinson et al. 2018</xref>; <xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>; <xref rid="bib17" ref-type="bibr">Katzke et al. 2022</xref>). Such variables are critical in estimating muscle strength and function, for example, in the calculation of physiological cross sectional area (<xref rid="bib15" ref-type="bibr">Herrel et al. 2008</xref>). However, the quantitative analysis of muscle architecture at the fiber/fascicle scale has been limited, especially compared to the abundant comparative analysis of skeletal shape from CT scanning projects (<xref rid="bib5" ref-type="bibr">Buser et al. 2018</xref>; <xref rid="bib3" ref-type="bibr">Arbour et al. 2019</xref>; <xref rid="bib21" ref-type="bibr">Paluh et al. 2020</xref>; among many other examples; <xref rid="bib10" ref-type="bibr">Evans et al. 2021</xref>). Manual segmentation of muscle fibers is tedious, time consuming, requires an expert knowledge of muscle anatomy, and is not feasible for all datasets (<xref rid="bib7" ref-type="bibr">Dickinson et al. 2019</xref>). While automated approaches exist (<xref rid="bib19" ref-type="bibr">Kupczik et al. 2015</xref>; <xref rid="bib8" ref-type="bibr">Dickinson et al. 2018</xref>; <xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>; <xref rid="bib22" ref-type="bibr">Püffel et al. 2021</xref>), their lack of widespread adaptation is partly due to the accessibility and cost associated with software options available.</p>
    <p><xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref> provided a thorough review and comparison of the effectiveness of all major approaches for the 3D reconstruction of muscle fibers currently available. But to briefly summarize the major available methods: The Xfiber module available for distribution with <bold>Avizo/Amira</bold> uses cylindrical template-based fiber tracking approach, and has been effectively applied to vertebrate datasets like crocodiles and birds (<xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>; <xref rid="bib16" ref-type="bibr">Holliday et al. 2022</xref>). This proprietary software package is costly, and while generally effective is sensitive to the input parameters and assumes that fibers have consistent diameter (<xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>). The <bold>ImageXd</bold> software package described by <xref rid="bib19" ref-type="bibr">Kupczik et al. (2015)</xref>, is a standalone command line application that applies textural analysis (i.e., variation in grayscale values) and reconstructs muscle fibers from streamlines of tensors. <xref rid="bib22" ref-type="bibr">Puffel et al. (2021)</xref> produced a stepwise approach in Python and Blender, which was developed to reconstruct straight-path fibers. This approach projects a trajectory down a muscle fiber based on the path of lowest grayscale variation, and was specifically developed for processing an ant muscle dataset; the intersection of the muscle with the apodeme of the exoskeleton must be known. Additionally, this approach cannot currently accommodate curved fibers commonly found in vertebrate muscle. Regardless of the different approaches used here, these methods produce similar results in terms of fiber length and pennation angle to each other, though vary in effectiveness across datasets (<xref rid="bib19" ref-type="bibr">Kupczik et al. 2015</xref>; <xref rid="bib8" ref-type="bibr">Dickinson et al. 2018</xref>, <xref rid="bib7" ref-type="bibr">2019</xref>; <xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>; <xref rid="bib17" ref-type="bibr">Katzke et al. 2022</xref>).</p>
    <p>Here, we introduce an R-language (v4.3.0, 2023) based software package (GoodFibes; <xref rid="bib2" ref-type="bibr">Arbour 2023</xref>) for the reconstruction of muscle fibers from diceCT datasets that incorporates aspects of the previously described methods, while making these approaches available in a widely used, open-source language. As input GoodFibes requires a sequential stack of grayscale images in PNG format, which can be exported from many CT reconstruction software packages or converted from other formats using ImageJ. The approach described here uses variation in grayscale values to track muscle fibers, under the assumption that variation in voxel radiopacity should be minimized along the fascicle/fiber track, similar to ImageXd and the approach described in <xref rid="bib22" ref-type="bibr">Puffel et al. (2021)</xref>. GoodFibes uses an iterative approach like <xref rid="bib22" ref-type="bibr">Puffel et al. (2021)</xref>, however, is able to change trajectories with each step.</p>
    <p>The main function of this package (good.fibes) is constructed such that only a small stack of images (= radius + 1, see arguments described below) are held in working memory in R at any given time. This drastically reduces the burden on memory usage, which can be quite high for large, micro-CT datasets consisting of 1000+ images and is often a major limiting factor in the analysis of such datasets. However, it does trade-off in decreasing the computational efficiency of the tracking algorithm, as images must be read in and removed repeatedly. Given the computational times observed by the author for several microCT datasets (and see example 1), this is a reasonable trade-off for a typically sized dataset. Here, we show that this approach performs similarly to previously mentioned software (Amira, ImageXd, <xref rid="bib22" ref-type="bibr">Puffel et al. 2021</xref>) in the estimation of fiber architecture and the quantification of fiber length in particular.</p>
  </sec>
  <sec sec-type="methods" id="sec2">
    <title>Methods</title>
    <p>The application of the major functions in this new package is illustrated in <xref rid="fig2" ref-type="fig">Fig. 2</xref>. Automated cropping (crop.stack) and equalization (equalize.stack) can be completed on the muscle stack, however, more advanced image adjustments can be made using the free software ImageJ. In particular, the tools “Process &gt; Math &gt; Gamma” and “Process &gt; Filters &gt; Unsharp Mask” in ImageJ/Fiji are effective at reducing noise and improving contrast between muscle fascicles (Jaimi Gray, pers. comm.). The automated cropping function (crop.stack) will ensure a sufficient buffer region of black voxels is present around the muscle to ensure the tracking algorithm will be able to evaluate all possible paths (see below). Subsequent functions are provided to help choose initial parameters (thresholdPlot), tracking muscle fibers (good.fibes), and visualizing the sequence in a tracked fiber (sequencePlot) (and see details below). Several functions are provided for cleaning, quality-checking and combining detected muscle fibers, and for quantifying metrics like length and tortuosity (curvature). Lastly, reconstructed muscle fibers can be visualized and exported as stereolithography; triangular surface mesh (STL) meshes.</p>
    <fig position="float" id="fig2">
      <label>Fig. 2</label>
      <caption>
        <p>Workflow for the use of the GoodFibes package and major functions.</p>
      </caption>
      <graphic xlink:href="obad030fig2" position="float"/>
    </fig>
    <p>The main function of this package, “good.fibes,” uses as input a sequential image stack (.png) containing only the grayscale values for the muscle of interest. The image stack must be isometric (the distance between images is the same as the pixel dimensions) and must occur in sequence in the folder (and when accessing image files names with list.files—see example code). Only one muscle can be analyzed at any given time, and multiple muscles must have their own individual image stack (and see the bat dataset in empirical examples). Images are converted to R compatible objects using the package imager (<xref rid="bib4" ref-type="bibr">Barthelme 2021</xref>). The muscle “region of interest” (region of interest (ROI)—i.e., the pixels representing the muscle in each image of the original scan) can be manually segmented through any available segmentation software that will allow the export of the substack (the complete grayscale data for just the muscle) or a binary ROI (an image stack with white representing the region of interest/muscle and black for all other pixels), such as Dragonfly ORS (<xref rid="bib9" ref-type="bibr">“Dragonfly ORS” 2022</xref>), Mimics (Materalise), Amira/Avizo (Thermo Fisher Scientific), or 3D Slicer (<xref rid="bib18" ref-type="bibr">Kikinis et al. 2014</xref>) (among others). For binary ROIs, the grayscale values can be isolated by importing both image stacks (original grayscale data and the binary ROI) into ImageJ and using the “Image Calculator” tool (under “Process”). In our experience processing stacks exported from Dragonfly, we first subtracted the original image stack <bold>from</bold> the binary ROI/muscle mask image stack, and then subtracted the resulting stack from the binary ROI again. This produced a stack with grayscale values between 0 (black) and 1 (white), with muscle being represented by gray values (between 0 and 1).</p>
    <p>The fiber tracking function “good.fibes” proceeds by first (1) determining a set of well-spaced seed points within an image plane, each of which will (potentially) produce a single muscle fiber (but see below), (2) completing a stepwise forward and backward walk from that seed point, and (3) smoothing the fiber path using splines. Subsequently, functions may be used to assess the quality of detected potential muscle fibers/fascicles, combining partial fiber paths or removing redundant ones, visualizing muscle fibers in 3D, and calculation of fiber length, orientation, and curvature. The order of use of the various functions available is shown in the flowchart in <xref rid="fig2" ref-type="fig">Fig. 2</xref>.</p>
    <sec id="sec2-1">
      <title>Selection of seed points</title>
      <p>The main function is designed to automatically select a set of well-spaced seed points across a plane of interest (image plane and number of seed points are user selected). We applied a hierarchical cluster analysis (using “UPGMA”) of a Euclidean distance matrix of all greyscale points above a threshold value, using the R function “hclust” (package “stats”; <xref rid="bib23" ref-type="bibr">R-Core 2023</xref>). This “threshold argument”—(values from 0 to 1, black to white, corresponding to the brightness of a voxel), is intended to isolate “bright” voxels with a high likelihood of representing muscle fibers. The initial value for threshold (and related parameter cutoff, see below) can be chosen after viewing different options with “thresholdPlot” (and see <xref rid="sup1" ref-type="supplementary-material">supplementary code</xref>). This step is computationally intensive, and increasing the threshold value can help to reduce runtime especially for very large image files. However, very high values for threshold may eliminate major portions of the muscle, especially if there is a slight gradient in grayscale values from staining, and thus fibers detected would not be representative of the whole muscle.</p>
      <p>The dendrogram produced was split into a number of selected clusters equal to the number of required seed points (argument “seed”) using the R function “cutree.” A single starting point was randomly selected from each cluster. We found that this procedure produces a series of starting points for the tracking algorithm, which will be well distributed throughout the muscle, but represent random starting positions. The argument “start.seed” can be used to set the same seed point for repeatable results. The number of muscle fibers detected will be less than or equal to the value for seed, as some starting points may represent noise with no possible pathway forward or backward. In these cases that seed point is dropped and no muscle fiber is produced from that location.</p>
    </sec>
    <sec id="sec2-2">
      <title>Tracking algorithm</title>
      <p>From the selected seed point, the tracking algorithm moves forward and backward through the image stack. To reduce noise and remove values that do not represent muscle tissue, all grayscale values (typically ranging between 0 and 1, for black to white respectively) below a certain threshold value (argument “cutoff,” which can be identical to argument “threshold” or lower/less restrictive) are set to zero (“black”). Setting “threshold” higher than “cutoff” (i.e., threshold considers fewer voxels as non-black) can minimize the time it takes for seed points to be selected, as this step is computationally intensive, and help to localize seed points in bright areas central to muscle fascicles and unlikely to represent interstitial space. However, “threshold” and “cutoff” may be supplied as the same value, especially in scans with good resolution and little noise. In the author's experience these values should be set conservatively/harshly (higher) to help the algorithm follow within one muscle fiber. Very short fibers or poor quality tracks can be filtered out later using “quality.check” or combined with “fuse.fibers,” but tracks that wander between muscle fascicles are more difficult to correct.</p>
      <p>From the selected seed point, a hemisphere/spherical cap of points is projected through the next sequence of images in the image stack. The dimensions of the hemisphere are determined by the value radius, which can currently be set up to 11 (though larger values create more possible paths). For most datasets a value between 5 and 9 will offer a reasonable number of paths that can be evaluated efficiently, with very curved fibers benefited by smaller values of radius. An option (“backstep”) allows paths within the same image plane as the seed point, or “behind” the seed point in the image stack to be considered in the spherical cap of possible paths. This permits particularly curved fibers that pass back through the image stack (e.g., see worked example 2) to be reconstructed, but may increase noise by allowing lateral movement with a muscle fascicle.</p>
      <p>To evaluate the possible paths from the seed point, the standard deviation (SD) in gray values is calculated from all possible unique straight-line paths. Muscle fibers tend to be arranged without abrupt changes in trajectory (generally are straight or curving, as opposed to sharp bends). To account for this, we calculated the deviation of the path from the proceeding trajectory as the Euclidean distance between the end points, scaled the values to lie between 0 and 1, and added this value to 1 (resulting values range from 1 to 2). The selected path was chosen as the path that minimized the following: diagnostic value = scaled grayscale SD * trajectory<sup>scalar</sup>. Paths with low grayscale variation and that follow a consistent trajectory through the image stack will produce the lowest diagnostic values and be selected. The scalar allows users to tailor the impact of trajectory changes (for example, a scalar of zero removes the trajectory penalization). Once the best path is selected (that minimized the above diagnostic value), the algorithm resets and a new hemisphere of paths is selected.</p>
      <p>The tracking algorithm continues this stepwise process until it reaches one of several stop conditions. These conditions are intended to prevent the tracker from passing out of a muscle fascicle and to terminate when reaching the end of the muscle fiber. The conditions under which the backward/forward walk from the seed point terminates include: (1) The only available remaining paths would either terminate or cross a black voxel. This prevents the tracker from passing out of the muscle fascicle. To accommodate noisy datasets, the tracker may be permitted to cross a small number of black voxels. (2) The number of black voxels in the possible paths exceeds a specified number (e.g., 95%). This is meant to isolate regions of noise toward the end of a muscle fascicle, where adjoining connective tissue may obscure the end of a fiber. (3) The remaining paths would terminate within a specified distance of the external “boundary” of the muscle (argument “bound.buffer,” suggested range of 2–5 voxels depending on image size). This prevents fibers from continuing to track along any connective tissue surrounding the muscle in noisy image stacks and to help with compressed boundaries, which can be observed in tightly packed specimens. The bound.buffer argument is particularly important in vertebrate muscle datasets like the otter, bat and darter shown, and less important in the well-defined fibers of the ant dataset.</p>
      <p>Once the tracker has reached a termination condition, it returns to the seed point and proceeds in the opposite direction through the image stack, using the exact same parameters described above. The forward and backward walks through the image stack are then merged into one continuous path, and the function moves to a new seed point.</p>
    </sec>
    <sec id="sec2-3">
      <title>Output and smoothing of muscle fibers</title>
      <p>The function good.fibes returns a list object (for each seed point) that contains <inline-formula><tex-math id="TM0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\$}$\end{document}</tex-math></inline-formula>fiber.points (the raw step-wise coordinates the tracking algorithm returned). Reconstructed fibers from “good.fibes” initially comprise straight line steps. The function “smoothed.fibers” (and several data processing function, like fiber.lengths) use natural cubic splines as implemented by function “nsp” (package “splines2”; <xref rid="bib26" ref-type="bibr">Wang and Yan 2021</xref>), which are piecewise polynomial functions defined by a number of breakpoints or “knots,” to smooth these stepwise tracks into realistically curved muscle fibers. Such splines can be defined using “knots” or “degrees of freedom” (knots = df–1), where “nsp” selects the knots at a suitable location for a shift in the polynomial function (i.e., a bend). Values over df &gt; 1 produce increasingly curved fiber paths, where df = 2 can produce an arched or “U” shape, df = 3 can produce “U” or “S” shaped paths, and so on. In the case of the straight fibers of the ant dataset below a df = 1 was used, and for the vertebrate datasets df = 2 was used as these had simple arching paths between origin and insertion locations. It is likely that df values between 2 and 4 would be sufficiently curved/“bendy” to accommodate most vertebrate muscle fibers.</p>
    </sec>
    <sec id="sec2-4">
      <title>Processing and checking of reconstructed muscle fibers</title>
      <p>We assessed the quality of fibers produced by “good.fibes” following the metrics outlined by <xref rid="bib22" ref-type="bibr">Puffel et al. (2021)</xref>—the ratio between the variation in grayscale values along a fiber track to the length of the reconstructed fiber. Those fibers with high variability compared to fiber length (and determined to be outliers) were removed from further analysis by the function “quality.check.” Optionally, fibers below a set length can also be excluded (similar to the ImageXd and Amira approaches), based on, for example, overall dimensions of the original muscle volume.</p>
      <p>Following removal of poor-quality fiber paths, two functions permit the merging of separate fiber tracks. This is meant to help combine paths from a single otherwise incomplete fiber that did not complete the full walk along its path due to noise or other irregularities in the dataset. The function “fuse.fibers” will combine two fibers into a single fiber path, if the new path is improved compared to the two separate paths (in length and mean residuals) and the function “check.overlap” is used to remove redundant fibers, produced from separate seed points within the same fascicle or fiber but resulting in slightly different fiber tracks. Both of these evaluate two fibers if they fall within a minimum distance in voxels (min.vox) of each other. This should be selected based on the width of the fascicles and the distance between fascicles, but we generally used ∼½ of an average fascicle width in cross section.</p>
    </sec>
    <sec id="sec2-5">
      <title>Quantification and visualization</title>
      <p>Package GoodFibes currently carries out the calculation of fiber length, orientation and curvature (tortuosity), based on spline-smooth fiber paths, via the functions “fiber.lengths,” “fiber.angle,” (in degrees) and “fiber.curve,” respectively. Fiber length can be output in units of voxel length or in the actual scale of the original scan data by providing the scan resolution (res). Orientation is currently in comparison to a specific axis (similar to the <xref rid="bib17" ref-type="bibr">Katzke et al. 2022</xref> visualization), but future updates to the package will permit the comparisons of fibers to a tendon.</p>
      <p>Visualization of 3D muscle fibers draws largely from the capabilities of the R package “rgl” (<xref rid="bib1" ref-type="bibr">Adler et al. 2003</xref>), and see <xref rid="fig3" ref-type="fig">Fig. 3</xref>. Correspondence between the original muscle fiber “track” and the smoothed fiber can be visualized using “muscle.plot” (<xref rid="fig4" ref-type="fig">Fig. 4</xref>). Processed fibers can be illustrated along with a boundary showing the muscle shape using “muscle.plot.multi” (<xref rid="fig3" ref-type="fig">Fig. 3</xref>). Finally, “muscle.plot.stl” can be used to export the 3D muscle fibers as a triangular surface mesh STL (.stl) file, with the option to first check the visual properties (save.plot = FALSE). If the resolution of the scan is provided, the muscle fibers will be scaled to actual size in the 3D mesh file and these can be opened in any 3D mesh editing software like “Geomagic,” “Meshmixer,” or “Blender” (among others). The visualization in <xref rid="fig6" ref-type="fig">Fig. 6</xref> was produced by exporting the bat muscles as individual STL files and importing them into Geomagic. The skull in this image was produced from a separate, non-stained scan and manually aligned with the generated muscle groups (based on dissection photos and anatomical landmarks) in Geomagic, as is already commonly done with volume reconstructions of muscles in other diceCT works (<xref rid="bib24" ref-type="bibr">Santana 2018</xref>).</p>
      <fig position="float" id="fig3">
        <label>Fig. 3</label>
        <caption>
          <p>Sample datasets processed using the GoodFibes package, showing a range of size, taxa, and visualizations. (A) Greenside darter (<italic toggle="yes">Etheostoma blennioides</italic>, MTSUZ-9) diceCT in coronal view (17.2 µm, stained with Lugol's iodine 1% for 3 days, scanned whole in a Scanco µCT50 system at 55 kV and 200 µA, at the Vanderbilt Center for Small Animal Imaging). (i) 3D reconstruction in Dragonfly ORS and (ii) single sample image from stack. The two major divisions of the adductor mandibular (AM1 and AM2) were segmented and muscle fascicles automatically detected. Visualized with “muscle.plot.stl,” (iii) showing the divisions labelled by colors and (iv) colored by orientation compared to the central axis. (B) North American river otter (<italic toggle="yes">Lontra canadensis MEV0216</italic>) head diceCT (70.8 µm, stained for 106 days, and scanned at 160 kV and 670 µA on a North Star Imaging System at the University of Washington). Specimen was skinned prior to staining. (i) 3D reconstruction of scan and (ii) single image from stack. Muscle fibers from the temporalis (purple) and superficial masseter (blue) in (iii) lateral and (iv) dorsal views.</p>
        </caption>
        <graphic xlink:href="obad030fig3" position="float"/>
      </fig>
      <fig position="float" id="fig4">
        <label>Fig. 4</label>
        <caption>
          <p>Mandibular muscle in an ant (<italic toggle="yes">Monomorium pharonis</italic>). See <xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref> for scanning parameters and other details. (A) Image from diceCT image stack, with muscle ROI segmented. Muscle fibers were oriented to pass through the image stack, rather than parallel to the image plane. (B) A single fiber track (points) and the smoothed path through the muscle, generated from a single automatically determined seed point. (C) A total of 198 muscle fibers detected and processed in GoodFibes, shown from three angles. Dataset from <xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref>, and detected fibers available as “ant.final” data object.</p>
        </caption>
        <graphic xlink:href="obad030fig4" position="float"/>
      </fig>
      <p>If multiple muscles are processed the results can be combined both within and outside of the R language environment. If all muscles are generated from stacks representing the same “space” (i.e., in the same view/plane, without cropping, and all images in the sequence are in each stack), then they will be automatically aligned in 3D coordinate space (with each other) and can be plotted together in R (as well as after export to programs like Geomagic and MeshLab). Using the concatenate function (“c”) the lists containing the two muscle fibers can be combined into one object for plotting (e.g., with “muscle.plot.stl”), while a vector of colors can be provided based on muscle group or other properties like length (<xref rid="fig3" ref-type="fig">Fig. 3</xref>, and see Supp. Mat. for example code). If the data are cropped prior to muscle fiber detection (either by image or fully black images were first removed), then values can be added to the fiber coordinates to realign the muscles (examples given in <xref rid="sup1" ref-type="supplementary-material">supplementary materials</xref>). The function “crop.stack” will output the necessary values for the x and y coordinates (xlim, ylim) and the number of deleted images at the beginning of the stack can be used to provide the z value if needed, and can be rerun on the original data again (without saving images) to reacquire these values if not recorded on the first use of the function. Once the impact of cropping has been corrected, the different muscles can be combined with “c” as described above and exported as anatomically aligned STL files.</p>
    </sec>
    <sec id="sec2-6">
      <title>Empirical examples</title>
      <p><xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref> use a diceCT dataset of an ant (<italic toggle="yes">Monomorium pharonis</italic>) mandibular muscle (resolution 0.67 µm) to demonstrate the effectiveness of the three previously listed applications in the estimation of fiber length and angle. This scan is high resolution, shows low noise, and the muscle fibers can be individually visualized, permitting a comparison to manually segmented values. The authors of that study kindly shared their dataset allowing a direct comparison. The muscle ROI was segmented using Dragonfly ORS software and the ROI was exported as a binary image stack. I used the image calculator functions in ImageJ to create an image stack of exclusively grayscale data for the muscle ROI, saved as .png format files. Using good.fibes, 250 seed points were applied across 5 image planes (50 each) to reconstruct muscle fibers across the image stack (threshold = 0.7, cutoff = 0.65, backstep = 0, allowed.black = 0, scaler = 1). We applied quality.check to remove fibers of low resolution, and check.overlap and fuse.fibers to combine fibers that were (1) redundant from seed points on different planes, or (2) terminated early but continued from a different starting point. We used a distance of 8 voxels in fuse.fibers and check.overlap (min.vox), as this was about half the width of a typical fiber in cross-section, so that fibers from different bundles would not be grouped together. No fibers were manually removed from the dataset. Runtime for 250 seed points was 92 min on an HP laptop with an Intel(R) i5-10300H CPU (2.50 GHz) with RAM utilization of &lt;1 GB. Example code is given in the help files associated with the various functions in the package (see <xref rid="sup1" ref-type="supplementary-material">supplementary files</xref>). Muscle fiber lengths were compared with the previous studies estimates from manual digital dissection and ImageXd and Amira.</p>
      <p>Image stacks were produced for the superficial, zygomatic, deep and medial temporalis, masseter, zygomaticomandibularis (ZM), and medial pterygoid from a diceCT scan of an Egyptian Fruit Bat (<italic toggle="yes">Rousettus aegyptiacus</italic>) stained for 28 days in 1% Lugol's Iodine, and scanned at a resolution = 10.05 µm and downsampled to 20.1 µm for processing in Mimics). Between 200 and 400 seed points across 4–6 images were used per muscle, with threshold and cutoff values visually selected using “thresholdPlot” (other arguments used across muscles: radius = 7, allowed.black = 1). Data cleaning and processing (with smoothing df = 2) follows that of the ant example, and a small number of fibers showing unusual curvature or orientation were removed (&lt;10 per muscle), following <xref rid="bib25" ref-type="bibr">Sullivan et al. (2019)</xref>. The tracking algorithm performed inconsistently when muscle fibers lay parallel to the image plane, so the deep temporalis and ZM were reprojected in Dragonfly ORS to an axial view (using the data inverter plugin &gt; axis transformation prior to exporting the binary image stack), while all other muscles were analyzed in coronal view. For the superficial temporalis and ZM, some fibers curve or are reoriented back into the image plane, and backstep = 1 was included. Mean fiber lengths were compared with those taken from traditional dissection (<italic toggle="yes">n</italic> = 15 per muscle) from previous (unpublished) work on bat bite biomechanics. For dissection and fiber separation protocol see <xref rid="bib14" ref-type="bibr">Hartstone-Rose et al. (2018)</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec3">
    <title>Results</title>
    <p>Both empirical datasets show reasonable effectiveness in estimating fiber lengths compared with previous software applications and traditional approaches. After application of “quality.check,” “fuse.fibers,” and “check.overlap,” a total of 198 smoothed muscle fiber paths (df = 1) were produced for the ant muscle. Reconstruction of muscle fibers in 3D appears visually similar to that produced in the prior study (<xref rid="fig4" ref-type="fig">Fig. 4</xref>). The mean fiber length calculated using “fiber.lengths” was 0.115 mm (sd = 0.025 mm). This was well matched to the mean length from manual segmentation reported by <xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref>, (mean = 0.114 mm, sd = 0.014 mm) and fell well within the estimates produced by other methods (0.106–0.117 mm, <xref rid="fig5" ref-type="fig">Fig. 5</xref>). Minimum fiber length was somewhat lower in our approach, although several of the other methods use a minimum fiber length cutoff as part of their reconstruction approach (e.g., Amira).</p>
    <fig position="float" id="fig5">
      <label>Fig. 5</label>
      <caption>
        <p>Comparison of GoodFibes to currently available approaches (see introduction for descriptions) on the ant mandibular muscle dataset. Data for manual, Amira, ImageXd, and <xref rid="bib22" ref-type="bibr">Puffel et al. 2021</xref> taken from <xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref>. Vertical line indicates mean value per method.</p>
      </caption>
      <graphic xlink:href="obad030fig5" position="float"/>
    </fig>
    <p>In the case of the cranial adductors in the Egyptian fruit bat, muscle fiber reconstructions were visually consistent with the diceCT reconstruction (<xref rid="fig6" ref-type="fig">Fig. 6</xref>) and as observed during the muscle dissections. Mean fiber lengths were strongly correlated with those produced by manual dissection (r = 0.86) and deviations were typically small (&lt;10% of average fiber length; <xref rid="tbl1" ref-type="table">Table 1</xref>). The superficial temporalis showed the greatest departure, though this was still within the performance range of previous approaches (e.g., <xref rid="bib25" ref-type="bibr">Sullivan et al. 2019</xref>). This may result from the orientation of the superficial temporalis, which in the image stack makes a sharp “downwards” turn as it approaches its attachment site.</p>
    <fig position="float" id="fig6">
      <label>Fig. 6</label>
      <caption>
        <p>Muscle fibers in <italic toggle="yes">Rousettus aegyptiacus</italic>, from the research collection of Sharlene Santana, University of Washington. (A) Original sample diceCT image, scanned on a Skyscan 1172 at 60 kV, shown in coronal view. (B) 3D Visualization of diceCT scan data. (C) Muscle fibers automatically detected by GoodFibes (red = s. temporalis, orange = m. temporalis, purple = z. temporalis, pink = d. temporalis, blue = masseter, yellow = ZM, green = pterygoid. Fibers were exported from R using “muscle.plot.stl” as STL files and imaged with the skull in Geomagic, see methods (“visualization”) for details.</p>
      </caption>
      <graphic xlink:href="obad030fig6" position="float"/>
    </fig>
    <table-wrap position="float" id="tbl1">
      <label>Table 1
</label>
      <caption>
        <p>Mean fiber lengths produced from manual dissection (<italic toggle="yes">n</italic> = 15) and reconstruction. Percent difference calculated from manual dissection estimates</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th align="center" rowspan="1" colspan="1">Manual</th>
            <th align="center" rowspan="1" colspan="1">Digital reconstruction</th>
            <th align="center" rowspan="1" colspan="1">Percent</th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th align="center" rowspan="1" colspan="1">dissection</th>
            <th align="center" rowspan="1" colspan="1">via GoodFibes</th>
            <th align="center" rowspan="1" colspan="1">difference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Masseter</td>
            <td rowspan="1" colspan="1">6.905</td>
            <td rowspan="1" colspan="1">7.335</td>
            <td rowspan="1" colspan="1">5.86%</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Medial pterygoid</td>
            <td rowspan="1" colspan="1">3.538</td>
            <td rowspan="1" colspan="1">3.82</td>
            <td rowspan="1" colspan="1">7.38%</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Deep temporalis</td>
            <td rowspan="1" colspan="1">6.223</td>
            <td rowspan="1" colspan="1">5.586</td>
            <td rowspan="1" colspan="1">−11.40%</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Medial temporalis</td>
            <td rowspan="1" colspan="1">6.427</td>
            <td rowspan="1" colspan="1">7.018</td>
            <td rowspan="1" colspan="1">8.42%</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Superficial temporalis</td>
            <td rowspan="1" colspan="1">7.877</td>
            <td rowspan="1" colspan="1">6.481</td>
            <td rowspan="1" colspan="1">−21.54%</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Zygomatic temporalis</td>
            <td rowspan="1" colspan="1">5.722</td>
            <td rowspan="1" colspan="1">5.905</td>
            <td rowspan="1" colspan="1">3.10%</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Zygomaticomandibularis</td>
            <td rowspan="1" colspan="1">5.34</td>
            <td rowspan="1" colspan="1">5.209</td>
            <td rowspan="1" colspan="1">−2.51%</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
  <sec sec-type="discussion" id="sec4">
    <title>Discussion</title>
    <p>Overall, GoodFibes presents a novel combination of features in automated muscle fiber detection, and produces reasonable reconstructions of muscle fascicles/fibers in two worked examples. The range of deviations from dissected muscle fiber lengths our approach (2.5–21.5%) was within the range observed for ImageXD and Amira from other examples in vertebrate muscle. <xref rid="bib25" ref-type="bibr">Sullivan et al. (2019)</xref>, found a deviation of 23% in mean fiber length using Amira in a starling pectoral muscle, while ImageXd produced differences between 8 and 42% in primate jaw muscles (<xref rid="bib19" ref-type="bibr">Kupczik et al. 2015</xref>; <xref rid="bib8" ref-type="bibr">Dickinson et al. 2018</xref>). Manual segmentation of fascicles from diceCT scans produced comparable differences to GoodFibes (2.3–18.0%; <xref rid="bib7" ref-type="bibr">Dickinson et al. 2019</xref>). We also note that our estimate of mean length from manual dissection in the Egyptian Fruit Bat is based on only 15 fibers per muscle. While this is typical practice for many biomechanics studies in bats and other mammals, this small sample is also likely to vary from the true parameter mean of the muscle.</p>
    <p>Like any approach using diceCT scan data to reconstruct muscle fibers, the effectiveness of this approach will be limited by the quality of the scan data, including: having an appropriately high-resolution scan with good contrast between muscle tissue and connective tissue; having no major artifacts in the scan (e.g., ring artifacts); having even perfusion of stain throughout a segmented muscle. Muscles with uneven staining (i.e., brighter outer regions of the muscle tissue on scans) may result in the tracking algorithm choosing paths that move between fascicles in brighter regions and having more paths end abruptly in less stained regions due to thresholding. Similar to the Amira fiber tracking module, GoodFibes requires estimation of a set of grayscale thresholds, and other input parameters like the radius of each step in the tracking algorithm, etc. In both cases there is no currently published approach for determining a reasonable set of starting values, and thus for both approaches the selection of these values is through subjective user assessment.</p>
    <p>As noted for the deep temporalis and ZM muscle from the bat dataset, the tracking algorithm performed more inconsistently when muscle fibers were oriented with the plane of the images (results not shown). However, exporting the image stack for these muscles in a different plane was sufficient to produce reasonable estimates of fiber length. Muscles with sections that vary substantially in orientation, such that some muscle fibers are oriented within the image plane, while others are more orthogonal to it (e.g., superficial temporalis), might produce a biased sample of fiber lengths (this muscle produces the largest discrepancy). In such a case, segmenting the regions of the muscle into individual stacks or reorienting the image stack could mitigate these issues, but other software options (e.g., Amira which uses template-based tracking), may be more suitable in these cases.</p>
    <p>GoodFibes provides reliable reconstruction of muscle fibers from diceCT scans in a flexible and open-source R language environment. While we have not evaluated this approach on datasets produced for other staining approaches (e.g., Phosphotungstic Acid), it is possible it could be effectively applied in these cases as well, but a separate evaluation with known (fiber length) datasets would be advisable. We hope that this package will address long-standing issues regarding accessibility and affordability in the automated detection of muscle fibers, and facilitate greater comparative and macroevolutionary analysis of muscle architecture from such non-destructive approaches.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>obad030_Supplemental_Files</label>
      <media xlink:href="obad030_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We are grateful to Julian Katzke and Sharlene Santana for access to the ant and bat datasets respectively, and to two reviewers who provided helpful comments. This work was supported by an NSF grant (DEB-2175927) and an FRCAC grant from MTSU to the author, and an NSF grant to Sharlene Santana (IOS-1557125).</p>
  </ack>
  <sec id="sec6">
    <title>Data Accessibility</title>
    <p>All functions required for the above analyses are distributed with the package GoodFibes available through CRAN (<ext-link xlink:href="https://cran.r-project.org/web/packages/GoodFibes" ext-link-type="uri">https://cran.r-project.org/web/packages/GoodFibes</ext-link>). The ant dataset is available via Dryad with the original publication <xref rid="bib17" ref-type="bibr">Katzke et al. (2022)</xref>, and the segmented and reoriented files are hosted on <ext-link xlink:href="https://github.com/" ext-link-type="uri">github.com</ext-link> and accessible through the help files in the GoodFibes documentation. The finalized muscle fibers for the greenside darter and otter are available through the <xref rid="sup1" ref-type="supplementary-material">supplementary materials</xref>. The bat diceCT image stack is available via Morphosource (media ID: 000,541,794), the STLs are available in the <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref> and a color coded 3D model is viewable through the author's sketchfab account (<ext-link xlink:href="https://sketchfab.com/MTSUichthyology" ext-link-type="uri">https://sketchfab.com/MTSUichthyology</ext-link>).</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The author has no conflicts of interest to declare.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adler</surname><given-names>D</given-names></string-name>, <string-name><surname>Nenadic</surname><given-names>O</given-names></string-name>, <string-name><surname>Zucchini</surname><given-names>W</given-names></string-name></person-group>. <year>2003</year>. <article-title>RGL: a R-library for 3D visualization with OpenGL</article-title>. <source>Proc 35th Symp Interface Comput Sci Stat</source><fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation>
    </ref>
    <ref id="bib2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Arbour</surname><given-names>JH</given-names></string-name></person-group>. <year>2023</year>. <article-title>GoodFibes: detection and reconstruction of muscle fibers from diceCT image data</article-title>. <comment>R package version 0.1.10. The Comprehensive R Archive Network. <ext-link xlink:href="https://CRAN.R-project.org/package=GoodFibes" ext-link-type="uri">https://CRAN.R-project.org/package=GoodFibes</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arbour</surname><given-names>JH</given-names></string-name>, <string-name><surname>Curtis</surname><given-names>AA</given-names></string-name>, <string-name><surname>Santana</surname><given-names>SE</given-names></string-name></person-group>. <year>2019</year>. <article-title>Signatures of echolocation and dietary ecology in the adaptive evolution of skull shape in bats</article-title>. <source>Nat Commun</source><volume>10</volume>:<fpage>2036</fpage>.<pub-id pub-id-type="pmid">31048713</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Barthelme</surname><given-names>S</given-names></string-name></person-group>. <year>2021</year>. <article-title>imager: image processing library based on “CImg”</article-title>. <comment>R package version 0.42.11. The Comprehensive R Archive Network. <ext-link xlink:href="https://CRAN.R-project.org/package=imager" ext-link-type="uri">https://CRAN.R-project.org/package=imager</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buser</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Sidlauskas</surname><given-names>BL</given-names></string-name>, <string-name><surname>Summers</surname><given-names>AP</given-names></string-name></person-group>. <year>2018</year>. <article-title>2D or not 2D? Testing the utility of 2D vs. 3D landmark data in geometric morphometrics of the sculpin subfamily oligocottinae (Pisces; Cottoidea)</article-title>. <source>Anat Rec</source><volume>301</volume>:<fpage>806</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camilieri-Asch</surname><given-names>V</given-names></string-name>, <string-name><surname>Shaw</surname><given-names>JA</given-names></string-name>, <string-name><surname>Yopak</surname><given-names>KE</given-names></string-name>, <string-name><surname>Chapuis</surname><given-names>L</given-names></string-name>, <string-name><surname>Partridge</surname><given-names>JC</given-names></string-name>, <string-name><surname>Collin</surname><given-names>SP</given-names></string-name></person-group>. <year>2020</year>. <article-title>Volumetric analysis and morphological assessment of the ascending olfactory pathway in an elasmobranch and a teleost using diceCT</article-title>. <source>Brain Struct Funct</source><volume>225</volume>:<fpage>2347</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">32870419</pub-id></mixed-citation>
    </ref>
    <ref id="bib7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dickinson</surname><given-names>E</given-names></string-name>, <string-name><surname>Basham</surname><given-names>C</given-names></string-name>, <string-name><surname>Rana</surname><given-names>A</given-names></string-name>, <string-name><surname>Hartstone-Rose</surname><given-names>A</given-names></string-name></person-group>. <year>2019</year>. <article-title>Visualization and quantification of digitally dissected muscle fascicles in the masticatory muscles of <italic toggle="yes">Callithrix jacchus</italic> using nondestructive DiceCT</article-title>. <source>Anat Rec</source><volume>302</volume>:<fpage>1891</fpage>–<lpage>900</lpage>.</mixed-citation>
    </ref>
    <ref id="bib8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dickinson</surname><given-names>E</given-names></string-name>, <string-name><surname>Stark</surname><given-names>H</given-names></string-name>, <string-name><surname>Kupczik</surname><given-names>K</given-names></string-name></person-group>. <year>2018</year>. <article-title>Non-destructive determination of muscle architectural variables through the use of DiceCT</article-title>. <source>Anat Rec</source><volume>301</volume>:<fpage>363</fpage>–<lpage>77</lpage>.</mixed-citation>
    </ref>
    <ref id="bib9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>Dragonfly</collab></person-group>. <year>2022</year>. <article-title>Object Research Systems (ORS) Inc, Montreal, Canada</article-title>. <comment><ext-link xlink:href="http://www.theobjects.com/dragonfly" ext-link-type="uri">http://www.theobjects.com/dragonfly</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Evans</surname><given-names>KM</given-names></string-name>, <string-name><surname>Larouche</surname><given-names>O</given-names></string-name>, <string-name><surname>Watson</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Farina</surname><given-names>S</given-names></string-name>, <string-name><surname>Habegger</surname><given-names>ML</given-names></string-name>, <string-name><surname>Friedman</surname><given-names>M</given-names></string-name></person-group>. <year>2021</year>. <article-title>Integration drives rapid phenotypic evolution in flatfishes</article-title>. <source>Proc Natl Acad Sci USA</source><volume>118</volume>:<fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="bib11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gignac</surname><given-names>PM</given-names></string-name>, <string-name><surname>Kley</surname><given-names>NJ</given-names></string-name></person-group>. <year>2018</year>. <article-title>The utility of DiceCT imaging for high-throughput comparative neuroanatomical studies</article-title>. <source>Brain Behav Evol</source><volume>91</volume>:<fpage>180</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">30099463</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gignac</surname><given-names>PM</given-names></string-name>, <string-name><surname>Kley</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Clarke</surname><given-names>JA</given-names></string-name>, <string-name><surname>Colbert</surname><given-names>MW</given-names></string-name>, <string-name><surname>Morhardt</surname><given-names>AC</given-names></string-name>, <string-name><surname>Cerio</surname><given-names>D</given-names></string-name>, <string-name><surname>Cost</surname><given-names>IN</given-names></string-name>, <string-name><surname>Cox</surname><given-names>PG</given-names></string-name>, <string-name><surname>Daza</surname><given-names>JD</given-names></string-name>, <string-name><surname>Early</surname><given-names>CM</given-names></string-name><etal>et al.</etal></person-group><year>2016</year>. <article-title>Diffusible iodine-based contrast-enhanced computed tomography (diceCT): an emerging tool for rapid, high-resolution, 3-D imaging of metazoan soft tissues</article-title>. <source>J Anat</source><volume>228</volume>:<fpage>889</fpage>–<lpage>909</lpage>.<pub-id pub-id-type="pmid">26970556</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gignac</surname><given-names>PM</given-names></string-name>, <string-name><surname>Santana</surname><given-names>SE</given-names></string-name></person-group>. <year>2016</year>. <article-title>A bigger picture: organismal function at the nexus of development, ecology, and evolution: an introduction to the symposium</article-title>. <source>Integr Comp Biol</source><volume>56</volume>:<fpage>369</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">27413091</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hartstone-Rose</surname><given-names>A</given-names></string-name>, <string-name><surname>Deutsch</surname><given-names>AR</given-names></string-name>, <string-name><surname>Leischner</surname><given-names>CL</given-names></string-name>, <string-name><surname>Pastor</surname><given-names>F</given-names></string-name></person-group>. <year>2018</year>. <article-title>Dietary correlates of primate masticatory muscle fiber architecture</article-title>. <source>Anat Rec</source><volume>301</volume>:<fpage>311</fpage>–<lpage>24</lpage>.</mixed-citation>
    </ref>
    <ref id="bib15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Herrel</surname><given-names>A</given-names></string-name>, <string-name><surname>De Smet</surname><given-names>A</given-names></string-name>, <string-name><surname>Aguirre</surname><given-names>LF</given-names></string-name>, <string-name><surname>Aerts</surname><given-names>P</given-names></string-name></person-group>. <year>2008</year>. <article-title>Morphological and mechanical determinants of bite force in bats: do muscles matter?</article-title><source>J Exp Biol</source><volume>211</volume>:<fpage>86</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">18083736</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Holliday</surname><given-names>CM</given-names></string-name>, <string-name><surname>Sellers</surname><given-names>KC</given-names></string-name>, <string-name><surname>Lessner</surname><given-names>EJ</given-names></string-name>, <string-name><surname>Middleton</surname><given-names>KM</given-names></string-name>, <string-name><surname>Cranor</surname><given-names>C</given-names></string-name>, <string-name><surname>Verhulst</surname><given-names>CD</given-names></string-name>, <string-name><surname>Lautenschlager</surname><given-names>S</given-names></string-name>, <string-name><surname>Bader</surname><given-names>K</given-names></string-name>, <string-name><surname>Brown</surname><given-names>MA</given-names></string-name>, <string-name><surname>Colbert</surname><given-names>MW</given-names></string-name></person-group>. <year>2022</year>. <article-title>New frontiers in imaging, anatomy and mechanics of crocodylian jaw muscles</article-title>. <source>Anat Rec</source><volume>305</volume>:<fpage>3016</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="bib17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Katzke</surname><given-names>J</given-names></string-name>, <string-name><surname>Puchenkov</surname><given-names>P</given-names></string-name>, <string-name><surname>Stark</surname><given-names>H</given-names></string-name>, <string-name><surname>Economo</surname><given-names>EP</given-names></string-name></person-group>. <year>2022</year>. <article-title>A roadmap to reconstructing muscle architecture from CT data</article-title>. <source>Integr Org Biol</source><volume>4</volume>.</mixed-citation>
    </ref>
    <ref id="bib18">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kikinis</surname><given-names>R</given-names></string-name>, <string-name><surname>Pieper</surname><given-names>SD</given-names></string-name>, <string-name><surname>Vosburgh</surname><given-names>KG</given-names></string-name></person-group>. <year>2014</year>. <article-title>3D Slicer: a platform for subject-specific image analysis, visualization, and clinical support</article-title>. In: <source>Intraoperative imaging and image-guided therapy</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>New York, NY</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="bib19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kupczik</surname><given-names>K</given-names></string-name>, <string-name><surname>Stark</surname><given-names>H</given-names></string-name>, <string-name><surname>Mundry</surname><given-names>R</given-names></string-name>, <string-name><surname>Neininger</surname><given-names>FT</given-names></string-name>, <string-name><surname>Heidlauf</surname><given-names>T</given-names></string-name>, <string-name><surname>Röhrle</surname><given-names>O</given-names></string-name></person-group>. <year>2015</year>. <article-title>Reconstruction of muscle fascicle architecture from iodine-enhanced microCT images : a combined texture mapping and streamline approach</article-title>. <source>J Theor Biol</source><volume>382</volume>:<fpage>34</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">26141643</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muñoz</surname><given-names>MM</given-names></string-name>, <string-name><surname>Price</surname><given-names>SA</given-names></string-name></person-group>. <year>2019</year>. <article-title>The future is bright for evolutionary morphology and biomechanics in the era of big data</article-title>. <source>Integr Comp Biol</source><volume>59</volume>:<fpage>599</fpage>–<lpage>603</lpage>.<pub-id pub-id-type="pmid">31353403</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paluh</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Stanley</surname><given-names>EL</given-names></string-name>, <string-name><surname>Blackburn</surname><given-names>DC</given-names></string-name></person-group>. <year>2020</year>. <article-title>Evolution of hyperossification expands skull diversity in frogs</article-title>. <source>Proc Natl Acad Sci USA</source><volume>117</volume>:<fpage>8554</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">32220958</pub-id></mixed-citation>
    </ref>
    <ref id="bib22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Püffel</surname><given-names>F</given-names></string-name>, <string-name><surname>Pouget</surname><given-names>A</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Zuber</surname><given-names>M</given-names></string-name>, <string-name><surname>Van De Kamp</surname><given-names>T</given-names></string-name>, <string-name><surname>Roces</surname><given-names>F</given-names></string-name>, <string-name><surname>Labonte</surname><given-names>D</given-names></string-name></person-group>. <year>2021</year>. <article-title>Morphological determinants of bite force capacity in insects: a biomechanical analysis of polymorphic leaf-cutter ants</article-title>. <source>J R Soc Interface</source><volume>18</volume>:<fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="bib23">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>R Core Team</collab></person-group>. <year>2023</year>. <source>R: A language and environment for statistical computing</source>. <comment>R Foundation for Statistical Computing, Vienna, Austria. <ext-link xlink:href="https://www.R-project.org/" ext-link-type="uri">https://www.R-project.org/</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Santana</surname><given-names>SE</given-names></string-name></person-group>. <year>2018</year>. <article-title>Comparative anatomy of Bat jaw musculature via diffusible iodine-based contrast-enhanced computed tomography</article-title>. <source>Anat Rec</source><volume>301</volume>:<fpage>267</fpage>–<lpage>78</lpage>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sullivan</surname><given-names>SP</given-names></string-name>, <string-name><surname>McGechie</surname><given-names>FR</given-names></string-name>, <string-name><surname>Middleton</surname><given-names>KM</given-names></string-name>, <string-name><surname>Holliday</surname><given-names>CM</given-names></string-name></person-group>. <year>2019</year>. <article-title>3D muscle architecture of the pectoral muscles of European Starling (<italic toggle="yes">Sturnus vulgaris</italic>)</article-title>. <source>Integr Org Biol</source><volume>1</volume>:<fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="bib26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Yan</surname><given-names>J</given-names></string-name></person-group>. <year>2021</year>. <article-title>Shape-restricted regression splines with R package splines2</article-title>. <source>J Data Sci</source><volume>19</volume>:<fpage>498</fpage>–<lpage>517</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
