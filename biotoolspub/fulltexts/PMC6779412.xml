<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Genet</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosgen</journal-id>
    <journal-title-group>
      <journal-title>PLoS Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-7390</issn>
    <issn pub-type="epub">1553-7404</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6779412</article-id>
    <article-id pub-id-type="pmid">31553718</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1008382</article-id>
    <article-id pub-id-type="publisher-id">PGENETICS-D-18-02429</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Gene Prediction</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Gene Prediction</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Animal Studies</subject>
          <subj-group>
            <subject>Experimental Organism Systems</subject>
            <subj-group>
              <subject>Model Organisms</subject>
              <subj-group>
                <subject>Drosophila Melanogaster</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Model Organisms</subject>
          <subj-group>
            <subject>Drosophila Melanogaster</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Animal Studies</subject>
          <subj-group>
            <subject>Experimental Organism Systems</subject>
            <subj-group>
              <subject>Animal Models</subject>
              <subj-group>
                <subject>Drosophila Melanogaster</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Animals</subject>
              <subj-group>
                <subject>Invertebrates</subject>
                <subj-group>
                  <subject>Arthropoda</subject>
                  <subj-group>
                    <subject>Insects</subject>
                    <subj-group>
                      <subject>Drosophila</subject>
                      <subj-group>
                        <subject>Drosophila Melanogaster</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Developmental Biology</subject>
          <subj-group>
            <subject>Embryology</subject>
            <subj-group>
              <subject>Embryos</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Biological Tissue</subject>
            <subj-group>
              <subject>Muscle Tissue</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Biological Tissue</subject>
            <subj-group>
              <subject>Muscle Tissue</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Transcriptome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Transcriptome Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
              <subj-group>
                <subject>Machine Learning Algorithms</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
            <subj-group>
              <subject>Machine Learning Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Artificial Intelligence</subject>
          <subj-group>
            <subject>Machine Learning</subject>
            <subj-group>
              <subject>Machine Learning Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Musculoskeletal System</subject>
            <subj-group>
              <subject>Muscles</subject>
              <subj-group>
                <subject>Pharyngeal Muscles</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Musculoskeletal System</subject>
            <subj-group>
              <subject>Muscles</subject>
              <subj-group>
                <subject>Pharyngeal Muscles</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Accurate genome-wide predictions of spatio-temporal gene expression during embryonic development</article-title>
      <alt-title alt-title-type="running-head">Prediction of tissue-specific and developmental gene expression</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3721-4550</contrib-id>
        <name>
          <surname>Zhou</surname>
          <given-names>Jian</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8566-6471</contrib-id>
        <name>
          <surname>Schor</surname>
          <given-names>Ignacio E.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3201-9983</contrib-id>
        <name>
          <surname>Yao</surname>
          <given-names>Victoria</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8379-6600</contrib-id>
        <name>
          <surname>Theesfeld</surname>
          <given-names>Chandra L.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6109-3840</contrib-id>
        <name>
          <surname>Marco-Ferreres</surname>
          <given-names>Raquel</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tadych</surname>
          <given-names>Alicja</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Furlong</surname>
          <given-names>Eileen E. M.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="author-notes" rid="econtrib001">
          <sup>‡</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Troyanskaya</surname>
          <given-names>Olga G.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
        <xref ref-type="author-notes" rid="econtrib001">
          <sup>‡</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Lewis-Sigler Institute for Integrative Genomics, Princeton University, Princeton, New Jersey, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Graduate Program in Quantitative and Computational Biology, Princeton University, Princeton, New Jersey, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Center for Computational Biology, Flatiron Institute, New York, New York, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Genome Biology Unit, European Molecular Biology Laboratory (EMBL), Heidelberg, Germany</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Computer Science, Princeton University, Princeton, New Jersey, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Desplan</surname>
          <given-names>Claude</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>New York University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="other" id="econtrib001">
        <p>‡ These authors also contributed equally to this work.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>furlong@embl.de</email> (EEMF); <email>ogt@cs.princeton.edu</email> (OGT)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <volume>15</volume>
    <issue>9</issue>
    <elocation-id>e1008382</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>12</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Zhou et al</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Zhou et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pgen.1008382.pdf"/>
    <abstract>
      <p>Comprehensive information on the timing and location of gene expression is fundamental to our understanding of embryonic development and tissue formation. While high-throughput <italic>in situ</italic> hybridization projects provide invaluable information about developmental gene expression patterns for model organisms like <italic>Drosophila</italic>, the output of these experiments is primarily qualitative, and a high proportion of protein coding genes and most non-coding genes lack any annotation. Accurate data-centric predictions of spatio-temporal gene expression will therefore complement current <italic>in situ</italic> hybridization efforts. Here, we applied a machine learning approach by training models on all public gene expression and chromatin data, even from whole-organism experiments, to provide genome-wide, quantitative spatio-temporal predictions for all genes. We developed structured in silico nano-dissection, a computational approach that predicts gene expression in &gt;200 tissue-developmental stages. The algorithm integrates expression signals from a compendium of 6,378 genome-wide expression and chromatin profiling experiments in a cell lineage-aware fashion. We systematically evaluated our performance via cross-validation and experimentally confirmed 22 new predictions for four different embryonic tissues. The model also predicts complex, multi-tissue expression and developmental regulation with high accuracy. We further show the potential of applying these genome-wide predictions to extract tissue specificity signals from non-tissue-dissected experiments, and to prioritize tissues and stages for disease modeling. This resource, together with the exploratory tools are freely available at our webserver <ext-link ext-link-type="uri" xlink:href="http://find.princeton.edu">http://find.princeton.edu</ext-link>, which provides a valuable tool for a range of applications, from predicting spatio-temporal expression patterns to recognizing tissue signatures from differential gene expression profiles.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>When and where a gene is expressed is fundamental information for understanding embryonic development. Current knowledge for such expression patterns is typically far from complete. Even for the long-standing model organism, <italic>Drosophila melanogaster</italic>, with large-scale <italic>in situ</italic> projects that have provided invaluable expression information for many genes, 40% of the genes still lack spatio-temporally resolved expression information. Such data is complemented by transcriptome datasets such as microarray and RNA-seq, which have whole-genome coverage and measure expression levels with greater dynamic range, but they typically lack precise spatio-temporal resolution. To bridge this gap, we developed a machine learning approach that combines the spatio-temporal resolution of <italic>in situ</italic> data with the accurate quantification and whole-genome coverage of genomic experiments, integrating information from 6,378 expression and chromatin profiling data sets. With this new approach, we present a genome-wide resource of spatio-temporal gene expression predictions for over 200 tissue-developmental stages during <italic>Drosophila</italic> embryogenesis. This resource is experimentally validated to have high-quality predictions, can guide the discovery of new tissue-specific genes, and provides a new tool to perform genome-wide analyses of spatio-temporal specificity.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work is supported by FP7 European Research Council (ERC) grant agreement 322851 (ERC advanced grant CisRegVar) to E.E.F., EU FP7 Marie Curie actions (299504, ncRNAsDevNet) to I.E.S., and NIH grants R01HG005998, U54HL117798 and R01GM071966, HHS grant HHSN272201000054C and Simons Foundation grant 395506 to O.G.T. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="1"/>
      <page-count count="20"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2019-10-07</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Data can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://find.princeton.edu/predictions/download/">http://find.princeton.edu/predictions/download/</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Data can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://find.princeton.edu/predictions/download/">http://find.princeton.edu/predictions/download/</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Spatio-temporal gene expression information is fundamental for understanding the intricate mechanisms of embryonic development, which involves both precisely controlled differentiation into dozens of tissue types, as well as dramatic temporal transitions such as gastrulation and segmentation.</p>
    <p>In the model organism <italic>Drosophila melanogaster</italic>, decade-long efforts in systematically characterizing developmental and tissue-specific expression patterns have greatly advanced the understanding of embryonic development and tissue formation [<xref rid="pgen.1008382.ref001" ref-type="bibr">1</xref>–<xref rid="pgen.1008382.ref003" ref-type="bibr">3</xref>]. Large-scale projects involving <italic>in situ</italic> hybridization and imaging, most representatively the Berkeley Drosophila Genome Project (BDGP) [<xref rid="pgen.1008382.ref001" ref-type="bibr">1</xref>], have resulted in thousands of gene expression patterns now manually annotated to very specific tissues with controlled vocabularies [<xref rid="pgen.1008382.ref001" ref-type="bibr">1</xref>]. These measurements render <italic>Drosophila</italic> embryonic development one of the most comprehensively characterized systems of spatio-temporal transcriptional regulation.</p>
    <p>However, the current compendium of embryonic expression is not without limitations, even for this deeply investigated model organism. For many tissues only a small number of gene’s have been annotated to be expressed, with a median of 80 genes for each tissue, which is likely an underrepresentation of the true number of tissue-expressed genes. In addition, more than 4,000 protein-coding genes, as well as many non-coding genes, have not been annotated at all [<xref rid="pgen.1008382.ref001" ref-type="bibr">1</xref>]. Moreover, the expression measurements <italic>via</italic> classical <italic>in situ</italic> hybridization and imaging are typically qualitative or grossly semi-quantitative [<xref rid="pgen.1008382.ref004" ref-type="bibr">4</xref>]. Lastly, the limited dynamic range of standard <italic>in situ</italic> hybridization protocols that are typically used in large-scale efforts restricts the detection of lowly expressed genes.</p>
    <p>To address these limitations, <italic>in situ</italic> data can be complemented by integrating them with the ever-growing transcriptome data measured by microarray or RNA-seq. With their whole-genome coverage and quantitative nature, the advantages of transcriptome profiles are highly complementary to those of <italic>in situ</italic> data. Even for cases where the transcriptome profiles are not tissue- or stage-specific, they are an information-rich source of co-regulated gene expression patterns, such as those of genes within the same regulatory or biochemical pathways. In these datasets, as gene expression is measured in a diversity of genetic or environmental conditions, functionally related genes are often co-expressed or perturbed together [<xref rid="pgen.1008382.ref005" ref-type="bibr">5</xref>,<xref rid="pgen.1008382.ref006" ref-type="bibr">6</xref>]. Using machine learning algorithms and known tissue-specific gene standards, these co-regulatory patterns can be extracted to infer tissue specific expression of genes, which combine advantages of both data types. Our previous work has shown that such an approach can accurately predict cell type-specific gene expression in the human kidney [<xref rid="pgen.1008382.ref006" ref-type="bibr">6</xref>] and worm tissues [<xref rid="pgen.1008382.ref005" ref-type="bibr">5</xref>] from non-tissue specific data, using manually curated cell type gene markers. In <italic>D</italic>. <italic>melanogaster</italic> embryonic development, the well-annotated resource of gene expression across tissues and developmental time, provide a unique opportunity to systematically predict not only tissue-specific expression but also the temporal stage of gene expression. Prior work has demonstrated the feasibility of making such predictions in a small set of 15 tissue-stages [<xref rid="pgen.1008382.ref007" ref-type="bibr">7</xref>]. Moreover, considering the established tissue lineage information for <italic>D</italic>. <italic>melanogaster</italic> development [<xref rid="pgen.1008382.ref001" ref-type="bibr">1</xref>], which has been curated into a tissue developmental ontology, the prediction algorithms can be further improved by integrating information across tissue-stages while considering the ontological relations between cell types.</p>
    <p>Here, we present an approach for the prediction of gene expression during embryonic development in <italic>D</italic>. <italic>melanogaster</italic> based on integrating the tissue specificity of <italic>in situ</italic> hybridization data with the quantitative and comprehensive measurements from public genomic data compendium. The algorithm, which we refer to as structured in silico nano-dissection (SIND), improves individual tissue predictions with a cell lineage-aware prediction integration stage. This stage learns and applies transcriptional dependencies between developmentally and anatomically related tissue-stages, with lineage knowledge encoded in the structure of a probabilistic graphical model based on the tissue developmental ontology.</p>
    <p>Using our SIND algorithm, together with <italic>in situ</italic> gene annotations and a compendium of 6,378 genome-wide expression and chromatin immunoprecipitation (ChIP) datasets, we predicted global expression patterns in 282 tissue-developmental stages, including &gt;4000 genes without prior <italic>in situ</italic> data. The predictions were validated both computationally, <italic>via</italic> hold-out validation, and experimentally in the case of new predictions without prior literature evidence. We verified predictions in muscle and brain for 13 novel genes with no prior <italic>in situ</italic> data or literature evidence to the extent of our knowledge, for both tissue-specificity and temporal specificity, including co-expression patterns in multiple tissues, demonstrating the accuracy of our predictions. The complete and quantitative nature of the predictions enables previously infeasible analysis of tissue specificities, such as analyzing tissue-specific signatures in whole-animal differential expression datasets and mapping human diseases to <italic>D</italic>. <italic>melanogaster</italic> tissue/stages for aiding the development of human disease models in the fly. We provide all our predictions and exploratory tools in a user-friendly web interface FIND (fly in silico nano-dissection, find.princeton.edu) that allows the user to query predicted gene expression pattern and perform tissue-specificity prediction task.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Integrating genomic data for embryonic tissue-developmental stage-specific gene expression prediction</title>
      <p>As an overview (<xref ref-type="fig" rid="pgen.1008382.g001">Fig 1</xref>, see also <xref ref-type="sec" rid="sec009">Methods</xref>), our approach first predicts gene expression probabilities for each tissue-stage term individually by learning linear models of transcription and chromatin signals that predict tissue-stage specific expression levels using a structural support vector machine (SVM) algorithm, and then integrates individual tissue-stage term predictions with a global developmental lineage-aware probabilistic graphical model. We named the <italic>Drosophila</italic> tissue-developmental stage gene expression prediction system FIND.</p>
      <fig id="pgen.1008382.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1008382.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Schematic overview of <italic>Drosophila melanogaster</italic> spatial-temporal gene expression prediction and validation strategy.</title>
          <p>The abundance and diversity of high-throughput genomic data, and the spatio-developmental specificity of large-scale <italic>in situ</italic> experiments allow us to train machine learning models that predict gene expression spatial-temporal specificity in a genome-wide scale. We developed a developmental cell lineage-aware machine learning algorithm, structured in silico nano-dissection (SIND), for this task. First, we trained an array of SVM-perf classifiers for all tissue-stage categories. We then integrated and improved predictions for each category by utilizing tissue-stage relationships with a conditional random field model based on tissue developmental ontology. The validation of predictions was done with prior literature, hold-out in situ data, and new in situ experiments. We verified the spatio-developmental expression pattern of a number of proteins without prior knowledge on expression specificity.</p>
        </caption>
        <graphic xlink:href="pgen.1008382.g001"/>
      </fig>
      <p>Conceptually, in the first stage, our method discovers and exploits the co-regulatory patterns of cell lineage-specific genes from high-throughput measurements of samples from diverse tissue origins and under a wide range of genetic, chemical, or environmental perturbations [<xref rid="pgen.1008382.ref005" ref-type="bibr">5</xref>,<xref rid="pgen.1008382.ref006" ref-type="bibr">6</xref>]. The cell lineage-specific genes were prioritized based on a weighted subset of conditions found to be informative by the algorithm. Notably, the high-throughput datasets we used as input do not have to be as tissue-specific as the predicted target tissue-stage, because we only require the co-regulatory patterns of tissue-specific genes to be shared across a subset of datasets [<xref rid="pgen.1008382.ref006" ref-type="bibr">6</xref>]. In fact, most of the tissues we make predictions for are fine embryonic structures without existing high-throughput microarray or RNA-seq data specific for those structures.</p>
      <p>In the second stage, we use prior developmental cell lineage knowledge to help integrate individual tissue-stage specific predictions with a conditional random field (CRF) probabilistic graphical model. Developmental lineage knowledge is expected to be informative for improving spatial-temporal predictions. This is both because gene expression in a precursor tissue usually provides informative insight into gene expression patterns of the tissue it develops into, and because related tissues, e.g. different cell types in the nervous system, are likely to share expression patterns for many genes. Specifically, we estimate the quantitative gene expression dependencies between developmentally related tissues empirically from <italic>in situ</italic> annotations and use it for integrating predictions. For each gene, the probabilistic graphical model treats expression in each tissue-stage term as a binary random variable. The value of each tissue-stage variable is dependent on both the input to the model, which are the SVM predictions from individual classifiers, and the values of other tissue-stage variables that are connected in the tissue developmental ontology. As the expression for each tissue is globally predicted considering dependencies between all tissue-stage terms, this approach allows for borrowing information from relevant tissues.</p>
      <p>Spatio-temporal gene expression during <italic>Drosophila</italic> embryogenesis has been extensively studied via large-scale <italic>in situ</italic> hybridization projects, such as the BDGP <italic>in situ</italic> database [<xref rid="pgen.1008382.ref001" ref-type="bibr">1</xref>] and Fly-FISH database [<xref rid="pgen.1008382.ref002" ref-type="bibr">2</xref>]. These studies provide a very rich resource of spatio-temporal specificity of gene expression and are used as training standards for our models. Our genome-wide data integration approach complements the current <italic>in situ</italic> hybridization data in multiple ways: our approach makes predictions for plenty of genes (&gt;4,000) unmeasured or undetected by <italic>in situ</italic>, computes quantitative scores comparable across genes and tissues and predict expression probabilities across all tissues, reducing the bias of manual annotation towards the most prominent or easy to recognize tissues.</p>
      <p>We first obtained a compendium of 6,378 high-throughput transcriptomic and chromatin profiling experiments, in addition to training standards consisting of <italic>in situ</italic> annotations for 282 tissue-stage terms spanning 6 time periods of fly embryonic development (outlined in <xref ref-type="supplementary-material" rid="pgen.1008382.s010">S1 File</xref>). The developmental cell lineage information is encoded by a tissue developmental ontology based on an earlier work [<xref rid="pgen.1008382.ref006" ref-type="bibr">6</xref>] (Supplementary File 1). We then used this data to train support vector machine classifiers and global integration model. We obtained a performance of median area under receiver-operating characteristics (AUROC) 0.87 across 282 tissue-stage terms (<xref ref-type="fig" rid="pgen.1008382.g002">Fig 2a and 2b</xref>, <xref ref-type="supplementary-material" rid="pgen.1008382.s011">S2 File</xref>). The predictions for each gene were made by five-fold cross-validation (see <xref ref-type="sec" rid="sec009">Methods</xref>).</p>
      <fig id="pgen.1008382.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1008382.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Tissue-developmental stage specificity of gene expression predictions.</title>
          <p>a. Gene expression prediction performances for selected tissue-stage categories measured by receiver-operating characteristics (ROC) curves. b. Integrating prediction across tissue-stages utilizing tissue developmental ontology information by ontology-CRF method improved prediction performances. The left panel compares area under ROC curves (AUROCs) for each tissue-stage category with and without using ontology-CRF integration. c. Global structure of predicted tissue-stage transcriptomes by embryonic layer of origin. The two dimensional projections of high-dimensional gene expression probability predictions were obtained with linear discriminant analysis (LDA) to best separate the tissue groups. Each point corresponds to a tissue-stage, the shape represent the tissue group and the color represent the embryonic layer of origin: light blue for mesoderm, yellow for endoderm and red for ectoderm. d-e. Example tissue-stage specificity predictions for CG12792. The observed expression patterns based on <italic>in situ</italic> hybridization were shown in d. The tissue-developmental categories and relationships were shown as a tree-like network (e), with nodes indicating tissue-stage categories and edges indicating “development from” and “part of” relationships. The color of each node represents the predicted probability of that category for the gene. Darker green color indicates higher predicted probability. Major tissue annotations and corresponding stages were labeled by text.</p>
        </caption>
        <graphic xlink:href="pgen.1008382.g002"/>
      </fig>
      <p>Integrating individual tissue predictions with our conditional random field (CRF) model is a major factor for enhancing performance, in addition to utilizing a wide range of datasets and data types (<xref ref-type="supplementary-material" rid="pgen.1008382.s001">S1 Fig</xref>). Using the ontology-based CRF method that we developed provides a consistent improvement across almost all tissues (<xref ref-type="fig" rid="pgen.1008382.g002">Fig 2b</xref>), demonstrating the importance of the integrative approach allowing sharing information cross tissue-stages with developmental cell lineage. The global topological structure of the predicted tissue-stage-specific transcriptomes, as visualized by LDA and PCA, shows organization by both developmental stage order (<xref ref-type="supplementary-material" rid="pgen.1008382.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pgen.1008382.s003">S3a</xref> Figs) and by embryonic layer of origin (<xref ref-type="fig" rid="pgen.1008382.g002">Fig 2c</xref> and <xref ref-type="supplementary-material" rid="pgen.1008382.s003">S3b Fig</xref>).</p>
    </sec>
    <sec id="sec004">
      <title>Specificity of embryonic tissue and developmental stage for individual genes predictions</title>
      <p>For each gene, our predictions specify the temporal range of expression and the specific cell lineages at multiple time points in the developmental trajectory. This is demonstrated for <italic>CG12792</italic>, which is a ubiquitously expressed genes at early developmental stages, with more restricted expression at 13 hours after egg laying (AEL) (<xref ref-type="fig" rid="pgen.1008382.g002">Fig 2d</xref>). This developmental trajectory is well captured by the cross-validated predictions when all expression labels for these genes were held out (<xref ref-type="fig" rid="pgen.1008382.g002">Fig 2e</xref>). Based on our predictions, the probabilities for ubiquitous expression decrease during development, while the probabilities for specific cell lineages (muscle and midgut) increase over time. Importantly, these increasingly restricted expression patterns in those specific tissues are an accurate recapitulation of the expression dynamics detected by the <italic>in situ</italic> experiments (<xref ref-type="fig" rid="pgen.1008382.g002">Fig 2d</xref>).</p>
      <p>To systematically measure the performance of spatial and temporal pattern predictions, we compared the predictions of each gene to the expected tissues and temporal stages defined by <italic>in situ</italic> and to the tissue-stages with no detectable <italic>in situ</italic> expression. This is another important dimension of prediction performance, besides correctly ranking genes for each tissue. The distribution of AUROC for genes is shown in (<xref ref-type="supplementary-material" rid="pgen.1008382.s004">S4 Fig</xref>). Even for genes with very complex expression patterns (&gt; 20 annotations), an average AUROC of 0.89 is obtained (<xref ref-type="supplementary-material" rid="pgen.1008382.s004">S4 Fig</xref>).</p>
    </sec>
    <sec id="sec005">
      <title>Experimental and literature-based validation of predictions across embryonic tissues and developmental stages</title>
      <p>We examined the ability of the model to predict expression patterns (outside of the training set) by both collecting gene expression information from the literature and performing fluorescent <italic>in situ</italic> hybridization (FISH) experiments for genes where no prior tissue-developmental mapping was available.</p>
      <p>We started by examining gene expression patterns in two tissues (BDGP <italic>in situ</italic> ontology categories) that had both a large number of genes with high scoring predictions (all predictions above threshold 0.8) and are easy to assess in <italic>in situ</italic> images: brain primordium (stages 11–12) and embryonic muscle system (stages 13 and later). We found that all genes newly predicted to be expressed in theses tissues with no prior annotations were confirmed. For brain primordium, all 5 genes with detectable FISH signals as predicted by FIND were indeed highly expressed in brain at stages 11 or 12 (<xref ref-type="supplementary-material" rid="pgen.1008382.s007">S1 Table</xref>, <xref ref-type="fig" rid="pgen.1008382.g003">Fig 3a</xref>). For 11 more genes, literature evidence corroborated the FIND predictions (<xref ref-type="supplementary-material" rid="pgen.1008382.s007">S1 Table</xref>). Thus 16/16 tested genes exhibit the FIND- predicted expression pattern for brain primordium. For the embryonic muscle system (stages 13 and later) all 8 genes with detectable FISH signals showed patterns in muscle systems, including in the somatic muscle, visceral muscle and dorsal vessel (the fly embryo heart) (<xref ref-type="supplementary-material" rid="pgen.1008382.s008">S2 Table</xref>, <xref ref-type="fig" rid="pgen.1008382.g003">Fig 3b–3d</xref>). For 5 more genes, literature evidence again corroborated the FIND predictions (<xref ref-type="supplementary-material" rid="pgen.1008382.s009">S3 Table</xref>). Thus 13/13 tested genes exhibited the FIND-predicted expression pattern for embryonic muscle system. Importantly, in all cases where we have spatio-temporal expression information, the transcript was expressed on the predicted tissue, underscoring the precision of the method.</p>
      <fig id="pgen.1008382.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1008382.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Experimental assessment of new expression pattern predictions.</title>
          <p>a. Two examples of genes tested by FISH in stage 12 embryos, showing expression in brain and ventral nerve cord (vnc). b. Two examples of genes tested by FISH showing expression in different muscle types. Embryos are stage 14 (<italic>left</italic>) and stage 13 (<italic>right</italic>). sm: somatic muscle, vm: visceral muscle. c. Accurate predictions of Ppn complex expression patterns in late embryo. <italic>Top</italic>. Predictions of Ppn gene expression for all stage 13–16 tissue-stage terms. Scores are indicated either as fold enrichment above random expectation. Terms with high fold enrichments are outlined and colored according to the tissue type. <italic>Bottom</italic>. FISH for Ppn on embryos of different stages. The first two images correspond to the same embryo, where different focal planes have been selected to show expression on the dorsal vessel and visceral muscle. d. Accurate prediction of frequent muscle and midgut co-expression. <italic>Top</italic>. Table showing values for expression predictions in muscle and midgut at late embryos in the 8 genes we performed <italic>in situ</italic>s for muscle expression validation. We bold the scores of genes with more than 10-fold enrichment in either tissue. <italic>Bottom</italic>. FISH images for the indicated genes in stage 13–14 embryos, with focal plane including both somatic muscle and gut. DAPI staining is included (blue signal) to show the shape of the embryo. Scale bar corresponds to 20μm in all images shown.</p>
        </caption>
        <graphic xlink:href="pgen.1008382.g003"/>
      </fig>
      <p>We have also tested predictions for very specific tissues and organs, such as late embryo Malpighian tubules or salivary glands. We performed FISH for four (Malpighian tubules) and five (salivary glands) genes with more than 20-fold enrichment above background, and in all cases we were able to detect expression on the respective tissues (<xref ref-type="supplementary-material" rid="pgen.1008382.s005">S5 Fig</xref>). Thus, we verified all high confidence predictions that we tested, indicating the utility of using FIND predictions to guide future studies.</p>
      <p>To determine how FIND predicts new multi-tissue expression patterns, we compared the predicted spatial-temporal patterns with experimentally measured gene expression across tissue and developmental stages. A particularly interesting example is the gene <italic>Ppn</italic> (<italic>Papilin</italic>). The main cell type where this gene is expressed is the plasmatocyte (<xref ref-type="fig" rid="pgen.1008382.g003">Fig 3c</xref>), which is consistent with previous observations from Fly-FISH [<xref rid="pgen.1008382.ref002" ref-type="bibr">2</xref>]. In addition, we could confirm the previously reported expression in the dorsal vessel [<xref rid="pgen.1008382.ref008" ref-type="bibr">8</xref>] and also detected <italic>Ppn</italic> expression in the visceral muscle and somatic muscle primordia (<xref ref-type="fig" rid="pgen.1008382.g003">Fig 3c</xref>, bottom). Importantly, our model gave all of these tissues high prediction scores for <italic>ppn</italic> expression (<xref ref-type="fig" rid="pgen.1008382.g003">Fig 3c</xref>, top), showing that complex expression patterns can be accurately predicted from our method.</p>
      <p>We next assessed how the variation of gene expression probabilities across stages are related to temporal variation in expression levels during development for specific genes. For example, in the case of <italic>TpnC47D</italic>, the predicted expression scores (<xref ref-type="fig" rid="pgen.1008382.g004">Fig 4a</xref>) are very high for the term embryonic larval muscle system (stages 13–16) but much lower for the precursor term muscle system primordium (stages 11–12). Indeed, experimental data confirmed this sharp up-regulation of expression, as expression in muscle is only detected from stage 13 and completely absent at earlier stages (<xref ref-type="fig" rid="pgen.1008382.g004">Fig 4a</xref>). Regulation of <italic>bsf</italic> expression provides another complex and interesting example. <italic>bsf</italic> is predicted to have similar expression level throughout stages 11–16 in midgut but with an increase of ~3 fold in muscle for the same temporal transition. As predicted, the <italic>bsf</italic> gene has a clear pattern of co-expression in the midgut and muscle at stage 13 and later, but when looking at stage 12, the expression in muscle is much lower than in the midgut primordia (<xref ref-type="fig" rid="pgen.1008382.g004">Fig 4b</xref>).</p>
      <fig id="pgen.1008382.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1008382.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>FISH validation of FIND temporal dynamics predictions.</title>
          <p>a. Expression prediction for TpnC47D up-regulation in muscle. Top. fold enrichment values of the TpnC47D gene for all BDGP terms including either “muscle” or “mesoderm”, ordered from earliest to latest. The terms “Stage 11–12 muscle system primordium” and “Stage 13–16 embryonic larval muscle system”, which represent the same group of structures in different stages, have been colored in red. Bottom. FISH images of the TpnC47D gene expression in stage 12 and stage 13 embryos. b. Prediction of relative changes in expression between muscle and gut for the bsf gene. Top. Same as in a, but also including gut-related terms. Midgut terms for Stage 11–12 and Stage 13–16 BDGP intervals have been colored in blue. Bottom. FISH images of the bsf gene expression in stage 12 and stage 13 embryos.</p>
        </caption>
        <graphic xlink:href="pgen.1008382.g004"/>
      </fig>
      <p>In conclusion, joint analysis of predictions for multiple tissue-developmental stage terms (either different tissues at a fixed time interval, or across time intervals for one tissue) can be a very valuable tool to guide the investigation of complex spatial-temporal expression patterns for individual genes or groups of genes.</p>
      <p>In addition to using spatiotemporal expression pattern predictions to generate hypotheses for individual genes, these predictions can also enable new spatio-temporal specificity analysis of high-throughput experimental data. In case studies below, we showcase two new directions of such applications.</p>
    </sec>
    <sec id="sec006">
      <title>Case study 1: Using spatio-developmental gene expression predictions for understanding tissue-specificity at transcriptome-scale</title>
      <p>High-throughput expression profiling and differential expression analysis are common and important techniques for exploratory analysis of molecular responses to different perturbations. While perturbations such as genetic ablation of a specific gene are expected to affect certain tissues preferentially, this is usually difficult to assess since, for practical reasons, expression profiling experiments are often performed on the whole body or tissue homogenates. FIND’s quantitative score for every tissue and stage for every gene in the genome can detect tissue-specificity signals from whole-organism differential expression experiments, even in the absence of reliable tissue-specific markers. This is particularly useful for tissues with few annotated marker genes. As a proof-of-concept, we used three differential gene expression datasets comparing whole-embryo mutant vs. wild type to predict the tissues most affected by these perturbations independently of any prior knowledge other than FIND predictions (<xref rid="pgen.1008382.t001" ref-type="table">Table 1</xref>).</p>
      <table-wrap id="pgen.1008382.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1008382.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Identification of relevant tissues from whole-embryo differential expression datasets.</title>
        </caption>
        <alternatives>
          <graphic id="pgen.1008382.t001g" xlink:href="pgen.1008382.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Rank</th>
                <th align="left" rowspan="1" colspan="1">Mef2 (9-19h)</th>
                <th align="left" rowspan="1" colspan="1">Twist (4-5h)</th>
                <th align="left" rowspan="1" colspan="1">Trh (5-16h)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <bold>1</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">somatic muscle primordium (stage 11–12)</td>
                <td align="left" rowspan="1" colspan="1">embryonic larval visceral muscle (stage 13–16)</td>
                <td align="left" rowspan="1" colspan="1">embryonic salivary gland common duct (stage 13–16)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <bold>2</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">embryonic larval visceral muscle (stage 13–16)</td>
                <td align="left" rowspan="1" colspan="1">dorsal pharyngeal muscle primordium (stage 11–12)</td>
                <td align="left" rowspan="1" colspan="1">embryonic larval posterior spiracle (tracheal system) (stage 13–16)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <bold>3</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">dorsal prothoracic pharyngeal muscle (stage 13–16)</td>
                <td align="left" rowspan="1" colspan="1">head visceral muscle primordium (stage 11–12)</td>
                <td align="left" rowspan="1" colspan="1">embryonic salivary gland duct (stage 13–16)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <bold>4</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">visceral muscle of esophagus (stage 13–16)</td>
                <td align="left" rowspan="1" colspan="1">visceral muscle primordium (stage 11–12)</td>
                <td align="left" rowspan="1" colspan="1">embryonic larval dorsal branch (tracheal system) (stage 13–16)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <bold>5</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">embryonic larval muscle system (stage 13–16)</td>
                <td align="left" rowspan="1" colspan="1">somatic muscle primordium (stage 11–12)</td>
                <td align="left" rowspan="1" colspan="1">embryonic larval dorsal trunk (tracheal system) (stage 13–16)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <bold>6</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">embryonic larval somatic muscle (stage 13–16)</td>
                <td align="left" rowspan="1" colspan="1">longitudinal visceral mesoderm primordium (stage 11–12)</td>
                <td align="left" rowspan="1" colspan="1">embryonic salivary gland common duct (stage 13–16)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>Top predicted tissue-stages among all 282 tissue-stage categories for three differential expression datasets—mef2 mutant (9-19h), twist mutant (4-5h) and trachealess mutant (5-16h).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>For example, <italic>Myocyte enhancer factor 2</italic> (<italic>Mef2)</italic> loss-of-function mutants have defects in myoblast fusion and terminal muscle differentiation [<xref rid="pgen.1008382.ref009" ref-type="bibr">9</xref>], consistent with the role of Mef2 as an essential conserved transcriptional regulator of muscle development. We use the transcriptome analysis of this mutant (E-TABM-57) as input for FIND-analysis, and indeed this affected tissue is precisely detected by our computational method: all top six terms (out of 282) predicted to be the most affected in the mutants are muscle tissues (<xref rid="pgen.1008382.t001" ref-type="table">Table 1</xref>). Specifically, we rank tissues based on Spearman correlation of the differential gene expression log fold changes and the prediction scores for each of the 282 tissue-stages. The second example is Twist, an upstream regulator of Mef2 that has an earlier and broader role in mesoderm development [<xref rid="pgen.1008382.ref010" ref-type="bibr">10</xref>]. <italic>Twist</italic> loss-of-function mutants lead to a block in gastrulation and a loss of mesodermal cells (E-TABM-162). Accordingly, our method predicts the loss of a wide range of mesoderm derivatives in <italic>twist</italic> loss-of-function mutants, and at earlier stages than those predicted for <italic>Mef2</italic> (<xref rid="pgen.1008382.t001" ref-type="table">Table 1</xref>). Finally, the third differential expression dataset analyzed a development time-course of <italic>trachealess</italic> (<italic>trh</italic>) mutant versus wildtype whole embryo samples. The <italic>trh</italic> gene codes for an essential transcription factor in the development of the tracheal system [<xref rid="pgen.1008382.ref011" ref-type="bibr">11</xref>] (E-GEOD-28780). In agreement with this role, four out of six of the top predictions are tracheal tissue terms. The other two top predictions are related to the salivary gland duct, another major tissue affected by <italic>trh</italic> loss-of-function mutants [<xref rid="pgen.1008382.ref011" ref-type="bibr">11</xref>] (<xref rid="pgen.1008382.t001" ref-type="table">Table 1</xref>).</p>
      <p>In summary, for all three mutants, we are able to make accurate and informative tissue-specificity predictions from experiments performed on whole embryos, without using any prior knowledge of the functions of these genes or phenotypes of their ablation, We therefore expect our tissue expression predictions and methods to be useful for improving detection of tissue signals in other high-throughput experiments where the available known tissue markers are insufficient.</p>
    </sec>
    <sec id="sec007">
      <title>Case study 2: Identifying potential human disease models in <italic>Drosophila</italic></title>
      <p>While <italic>Drosophila melanogaster</italic> provides a flexible and powerful genetic model for a wide range of human diseases, it is not always clear which tissue is the best choice for modeling a certain human disease. This is especially relevant when a direct tissue equivalent is absent in the fly. To address this challenge, we examined FIND-predicted tissue-stage patterns in the fly embryo for human disease genes. Specifically, we identified fly orthologs of human disease gene from OMIM database, using a functional mapping approach which identifies gene that are not only similar in sequence, but also share similar roles in pathways in human and fly [<xref rid="pgen.1008382.ref012" ref-type="bibr">12</xref>]. Then, embryonic tissues were ranked based on their enrichment of genes related to each disease, thus prioritizing fly tissues by their relevance to human disease.</p>
      <p>Among the diseases with most significant tissue enrichment, muscle diseases and cardiomyotrophy was mapped to somatic muscles (<xref ref-type="fig" rid="pgen.1008382.g005">Fig 5</xref>). Despite the distinct morphology of fly eyes, larval eye primordium is selected as the best tissue for modeling for eye diseases (<xref ref-type="fig" rid="pgen.1008382.g005">Fig 5</xref>). Indeed, fly eye is known to share key developmental biology with mammals, for example, the <italic>Drosophila eyeless</italic> and its mammal ortholog <italic>Pax6</italic> are both essential to eye development [<xref rid="pgen.1008382.ref013" ref-type="bibr">13</xref>]. Auditory system diseases are best mapped to the dorsal head epidermis, as well as sensory complex (<xref ref-type="fig" rid="pgen.1008382.g005">Fig 5</xref>). Even though flies lack a skeletal system, bone diseases are mapped best to mesoderm primordium tissues, suggesting that at least their early development during mesoderm stage may be modeled (<xref ref-type="fig" rid="pgen.1008382.g005">Fig 5</xref>). In conclusion, the results show that genome-wide predictions of tissue-stage expression can assist in identifying and developing new human disease models.</p>
      <fig id="pgen.1008382.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1008382.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Prioritization of fly developmental tissues and stages for modeling human disease.</title>
          <p>Heatmap showing false discovery rate (-log10 FDR) for enrichment of human OMIM disease gene functional orthologs in each tissue-stage combination, based on FIND predictions (p-value is computed based on PAGE). The number before tissue names indicate stages (1: stage 1–3, 2: stage 4–5, 3: stage 6–8, 4: stage 9–10, 5: stage 11–12, 6: stage 13–16).</p>
        </caption>
        <graphic xlink:href="pgen.1008382.g005"/>
      </fig>
    </sec>
    <sec id="sec008" sec-type="conclusions">
      <title>Discussion</title>
      <p>By integrating diverse expression and chromatin profiles with <italic>in situ</italic> tissue-specific gene standards, we provided accurate predictions of spatio-developmental expression patterns for all annotated genes, both coding and non-coding. Enabling our approach is a cell lineage-aware computational method, SIND, that uses a unified spatial-temporal transcription probabilistic graphical model to integrate predictions for developmentally related tissues informed by tissue developmental ontology. We have both computationally and experimentally verified the potential of these predictions, confirming the accuracy and predictive power of our method.</p>
      <p>The whole-genome coverage and quantitative resolution of our approach thus can not only provide researchers with predicted spatio-temporal expression patterns for over 4,000 genes that lack experimental evidence, but also power their data analyses, including detection of tissue-specificity signals in non-tissue resolved (e.g. whole embryo) expression datasets and identification of most relevant tissues for study of human disease.</p>
      <p>To facilitate the exploration of our spatio-developmental gene expression predictions and downstream analyses, we provide a user-friendly web interface (<ext-link ext-link-type="uri" xlink:href="http://find.princeton.edu">http://find.princeton.edu</ext-link>). This web tool allows for querying tissue-gene predictions, discovering genes with similar tissue-specific expression patterns and predicting tissue-stage specificity from a user specified list of genes (e.g. differential gene expression after a perturbation experiment).</p>
      <p>It is important to note that our approach currently covers only embryonic developmental stages due to limitations in availability of in-situ data at other stages for training; this could be addressed by applying this approach to additional temporal stages as training data becomes available. Furthermore, the ability to predict gene expression patterns in highly-specific cell types depends on the input data compendiums being informative of the gene co-expression patterns in these cell types and the availability of known expressed genes from these specific cell types as labels. Single cell data can thus potentially contribute to training both as input data and as labels in the future, although such an approach will need to address noisiness and the challenges of robust definition of cell types from single cell data. Lastly, of course, even with high accuracy and coverage, the resources that we provide are still computational predictions, and should be treated as such. Their power is in enabling analysis and directing follow-up experiments.</p>
      <p>Finally, we note that this resource is built upon, and complementary, to current genomic data, and will continually benefit from a progressively growing amounts of <italic>in situ</italic> tissue specificity standards and RNA-seq and chromatin profiling data, as well as integrating new types of genomic features like sequence features or new experimental techniques. This flexibility is an important property for such a dynamic field as functional genomics.</p>
    </sec>
  </sec>
  <sec sec-type="materials|methods" id="sec009">
    <title>Methods</title>
    <sec id="sec010">
      <title>Data</title>
      <p>The data for training the <italic>Drosophila melanogaster</italic> spatio-developmental expression prediction model are obtained and processed as follows. <italic>Drosophila melanogaster</italic> raw microarray data for the two major platforms GPL1322 and GPL72 were downloaded from NCBI Gene Expression Omnibus at May 2014 and processed with the <italic>GEO2R</italic> package. Missing values in microarrays were imputed with KNNImpute [<xref rid="pgen.1008382.ref014" ref-type="bibr">14</xref>]. Drosophila melanogaster RNA-seq and ChIP-seq raw reads data were downloaded from NCBI Sequence Read Archive (SRA) and aligned to BDGP5 fly genome assembly using bowtie2 with local alignment mode [<xref rid="pgen.1008382.ref015" ref-type="bibr">15</xref>]. RNA-seq alignment data was summarized by RPKM using BDGP v5.78 gene annotation (and lncRNA annotation from [<xref rid="pgen.1008382.ref016" ref-type="bibr">16</xref>]). Non-transcriptomic sequencing alignment data was summarized by RPKM within ± 500bp region to TSS. modENCODE RNA-seq dataset was downloaded from [<xref rid="pgen.1008382.ref016" ref-type="bibr">16</xref>]. The datasets used are listed in <xref ref-type="supplementary-material" rid="pgen.1008382.s012">S3 File</xref>. All sequencing samples were log-transformed after adding a pseudo-count. The pseudo-count was determined as half of the value of the lowest non-zero gene for each sample. All samples were standardized to mean 0 and variance 1.</p>
      <p>Tissue- and developmental stage- specific expression standards were obtained from BDGP <italic>in situ</italic> database (insitu.fruitfly.org) and FlyFISH database (fly-fish.ccbr.utoronto.ca) on May 2014. Genes included in both microarray platforms were used. Since BDGP <italic>in situ</italic> annotation are more comprehensive in fine tissue structures, we use BDGP as the main standards while using FlyFISH as assistance standards that were only used to train first-stage classifiers. The subset of genes mapped to microarray platforms were used, with a holdout set strictly not used in any steps of algorithm design and the decision of hyperparameters for evaluation.</p>
      <p>Our Drosophila embryonic development tissue developmental ontology is modified from [<xref rid="pgen.1008382.ref001" ref-type="bibr">1</xref>] with a few changes adapted from flybase tissue developmental ontology FBdv [<xref rid="pgen.1008382.ref017" ref-type="bibr">17</xref>]. The ontology we used is provided in <xref ref-type="supplementary-material" rid="pgen.1008382.s010">S1 File</xref>.</p>
    </sec>
    <sec id="sec011">
      <title>Structured in-silico nano-dissection for spatio-developmental gene expression prediction</title>
      <p>Our machine learning algorithm uses a cell-lineage aware approach to predict gene expression with spatio-developmental specificity based on whole-genome scale expression data. The cell lineage information is critical for specific tissues and stages that can benefit from considering developmental context including its precursor and descendant tissues.</p>
      <p>Our model takes <italic>in situ</italic> gene expression annotations and functional genomics data as input and performs prediction in the stages. In the first stage, one individual classifier was trained for each individual tissue-stage term. Specifically, for each tissue-stage term, a linear structural SVM model was trained to predict <italic>in situ</italic> annotations (whether a gene is annotated to a tissue-stage) from functional genomic datasets including transcriptome profiling data (microarray and RNA-seq) and chromatin profiling data (ChIP-seq). The model was trained using the SVMperfer tool in the Sleipnir library [<xref rid="pgen.1008382.ref018" ref-type="bibr">18</xref>].</p>
      <p>In the second stage, we use a conditional random field classifier, which integrates individual tissue-stage predictions using learned dependencies of gene expression between tissue-stage terms. The conditional random field model represents each tissue-stage as a node and cell-lineage relations as edges connecting the nodes. Tissue-stage nodes are connected with the following rules:</p>
      <list list-type="order">
        <list-item>
          <p>If they are in a developmental precursor-and-descendent relationship and in the same or adjacent stages.</p>
        </list-item>
        <list-item>
          <p>If they are directly connected in the tissue developmental ontology by the “part of “relationship and in the same or adjacent stages.</p>
        </list-item>
        <list-item>
          <p>If they are the same tissue type in adjacent stages.</p>
        </list-item>
        <list-item>
          <p>The “no staining” terms were connected to all other terms in the same stage (because of the expected negative dependencies).</p>
        </list-item>
      </list>
      <p>The CRF model that directly provides probability output for each gene and each tissue is formulated as the following
<disp-formula id="pgen.1008382.e001"><alternatives><graphic xlink:href="pgen.1008382.e001.jpg" id="pgen.1008382.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mi mathvariant="normal">P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Z</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi>X</mml:mi><mml:msub><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>ontology</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:math></alternatives></disp-formula></p>
      <p>P(Y│X) describes the conditional probability model. The conditional probability is determined by a term that describes dependencies on first-stage individual classifiers output ∑<sub><italic>m</italic></sub>(<italic>W</italic><sub><italic>m</italic></sub><italic>X</italic> + <italic>α</italic><sub><italic>m</italic></sub>)<italic>Y</italic><sub><italic>m</italic></sub> and a cell lineage dependency term <inline-formula id="pgen.1008382.e007"><alternatives><graphic xlink:href="pgen.1008382.e007.jpg" id="pgen.1008382.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>ontology</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Note that if the second term does not exist the model reduces to multiple logistic regression models. Specifically, Y is the vector of indicator variables for expression in tissue-stages, where <italic>Y</italic><sub><italic>m</italic></sub> = 1 indicates expression in the <italic>m</italic>-th tissue-stage and <italic>Y</italic><sub><italic>m</italic></sub> = 0 indicates no-expression in the tissue-stage indexed by <italic>m</italic>. <italic>X</italic> represents a matrix containing all SVM predictions from the first stage classifiers, in which a column corresponds to a classifier. The model is also illustrated by a diagram in <xref ref-type="supplementary-material" rid="pgen.1008382.s006">S6 Fig</xref>.</p>
      <p><italic>W</italic>, <italic>J</italic>, <italic>a</italic> are estimated from the input (first stage predictions and <italic>in situ</italic> annotations). Specifically in the first term <italic>W</italic><sub><italic>m</italic></sub> represents weight the <italic>m</italic>-th tissue-stage classifier from the first stage, which is analogous to coefficients of a logistic regression model and <italic>α</italic><sub><italic>m</italic></sub> is the intercept. We allow a tissue-stage to be informed by predictions for any tissue-stage classifiers in the first term, which integrate expression signals over expression predictions for multiple tissue-stage-specific classifiers based on annotations from both BDGP <italic>in situ</italic> and FlyFISH.</p>
      <p>In the second term, <italic>J</italic><sub><italic>mn</italic></sub> represents interaction between tissue-stage <italic>m</italic> and <italic>n</italic> and only edges in the tissue developmental ontology are allowed to be non-zero. G<sub>ontology</sub> represent the ontology based graph structure which is a set of edges built with rules described above. Prediction for a tissue-stage can either increase or decrease probability of a connected tissue-stage term depending on the estimated dependency scores <italic>J</italic>. <italic>Z</italic> is the normalizing constant which ensures the sum of probabilities equals 1, and it does not need to be explicitly computed in our learning algorithm.</p>
      <p>The model can be trained by minimizing the L1 Penalized likelihood ∑log P(Y│X) + <italic>λ</italic>|<italic>J</italic>|. The L1 regularization <italic>λ</italic>|<italic>J</italic>| is used to avoid overfitting to tissue-stage dependencies by encouraging <italic>J</italic> to be 0 if it contributes little to the likelihood. |<italic>J</italic>| represents the L1 norm of interactions J which equals sum of absolute values of all entries of <italic>J</italic>. <italic>λ</italic> is the L1-regularization parameter.</p>
      <p>To prevent overfitting to the <italic>in situ</italic> annotations, for the training of the second stage model, all predictions from the first stage were made on holdout genes with 5 fold cross-validation. Specifically, for each fold, 4/5 of the genes were used for training and the trained model was used to predict the rest 1/5 holdout genes. The concatenated predictions on the holdout set for each fold, which covers all the training set genes, were used as input to the second stage classifier. As the concatenated predictions were all predicted using models that have not seen the gene before, it minimizes the bias due to overfitting in the second stage.</p>
    </sec>
    <sec id="sec012">
      <title>Optimization of the structured in-silico nano-dissection model parameters</title>
      <p>Next, we describe the optimization algorithm for minimizing the objective function. Computing the exact gradient of the CRF likelihood over the ontology-based graph is intractable since the graph is not tree or chain structured. Approximation inference algorithms, such as pseudo-likelihood-based method is biased but computationally efficient, while Markov chain Monte Carlo (MCMC) sampling-based inference methods converge to the exact gradient in the limit of large sample size, but is computationally expensive to obtain low variance gradient estimate.</p>
      <p>To address both speed and accuracy, we choose to use a hybrid of both. We first obtain a fast approximation of parameters by optimizing a modified pseudo-likelihood objective,
<disp-formula id="pgen.1008382.e002"><alternatives><graphic xlink:href="pgen.1008382.e002.jpg" id="pgen.1008382.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:mrow><mml:mrow><mml:mtext>log</mml:mtext></mml:mrow><mml:mspace width="2pt"/><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi>X</mml:mi><mml:msub><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>ontology</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi>X</mml:mi><mml:msub><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>ontology</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
for which the gradient can be computed efficiently because it does not involve computing <italic>Z</italic> which is intractable, and initialize the second step optimization which optimizes the true objective with the estimators from first step. The L1 regularized optimization problem was solved with Projected scaled sub-gradient (Gafni-Bertsekas variant) as implemented in (<ext-link ext-link-type="uri" xlink:href="https://www.cs.ubc.ca/~schmidtm/Software/thesis.html">https://www.cs.ubc.ca/~schmidtm/Software/thesis.html</ext-link>).</p>
      <p>For the second step, we estimate the stochastic gradient of the model objective by Gibbs sampling and employ stochastic gradient descent with momentum for optimization. For Gibbs sampling based gradient estimation, we first rewrite the likelihood as
<disp-formula id="pgen.1008382.e003"><alternatives><graphic xlink:href="pgen.1008382.e003.jpg" id="pgen.1008382.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mi mathvariant="normal">P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Z</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>ontology</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:math></alternatives></disp-formula></p>
      <p>To compute the stochastic gradient for the log-likelihood when conditioned on X, we used the fact (ignored writing down conditioning on X for simplicity)
<disp-formula id="pgen.1008382.e004"><alternatives><graphic xlink:href="pgen.1008382.e004.jpg" id="pgen.1008382.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="2pt"/><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mover accent="false"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="2pt"/><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mover accent="false"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
where expectations E(Y<sub>m</sub>) and E(Y<sub>m</sub>Y<sub>n</sub>) are estimated by MCMC sampling. For each iteration, we run a separate Markov chain for each gene and average the stochastic gradients obtained from each chain over all genes. To address efficiency and burn-in time of MCMC, we initialize MCMC chains from the last sample of the previous iteration (also called persistent MCMC sampling), and for each iteration, we only run one sweep of Gibbs sampling which sample each node exactly once and use the single sample Y* to compute estimator <inline-formula id="pgen.1008382.e005"><alternatives><graphic xlink:href="pgen.1008382.e005.jpg" id="pgen.1008382.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mi mathvariant="normal">E</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1008382.e006"><alternatives><graphic xlink:href="pgen.1008382.e006.jpg" id="pgen.1008382.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mi mathvariant="normal">E</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. The Markov chains for all genes are parallelized for speeding up.</p>
      <p>For each iteration, we increment model parameters based on stochastic gradient descent with specified step size. We use a learning rate annealing scheme of 100,000 iterations of learning rate 1e-6, followed by 50,000 iterations of 1e-7 and 50,000 iterations of 1e-8. Additionally, a momentum term was used for stabilizing the update and improving convergence. L1 regularization was applied to control overfitting. We set momentum to 0.9 and L1-regularization parameter to 8.</p>
      <p>After the model is trained, for prediction from the second-stage CRF model we ran 80,000 rounds of Gibbs sampling and average over the samples. For genes with <italic>in situ</italic> annotations, we predict their expression with 5 fold cross-validation.</p>
    </sec>
    <sec id="sec013">
      <title>Mapping human disease to fly embryonic development tissue-stages</title>
      <p>Human disease gene sets were obtained from OMIM. We selected the functional ortholog of human genes in <italic>Drosophila melanogaster</italic> using functional knowledge transfer (FKT) method with p-value cutoff 0.1 [<xref rid="pgen.1008382.ref012" ref-type="bibr">12</xref>]. For each fly gene the lowest p-value human ortholog was chosen, then each tissue-stage expression prediction profile is mapped to human genes accordingly (a total of 4937 fly genes were mapped with above cutoff confidence). Statistical significance of gene set enrichment in each mapped tissue-stage expression prediction profile was computed with parametric analysis of gene set enrichment (PAGE) method [<xref rid="pgen.1008382.ref019" ref-type="bibr">19</xref>].</p>
    </sec>
    <sec id="sec014">
      <title>Fluorescent <italic>in situ</italic> hybridization</title>
      <p>Fluorescent <italic>in situ</italic> hybridizations were performed as previously described [<xref rid="pgen.1008382.ref020" ref-type="bibr">20</xref>]. Briefly, we used cDNA clones from the DGRC collections DGC1 and 2 [<xref rid="pgen.1008382.ref021" ref-type="bibr">21</xref>] for preparing digoxigenin-labelled or fluorescein-labeled RNA probes, except for the CG14688 gene for which we use a previously reported cDNA template [<xref rid="pgen.1008382.ref022" ref-type="bibr">22</xref>] and CG34284 for which we amplified a cDNA fragment. In this case, we performed Biozym Red HS Master Mix (Biozym) using as template total cDNA obtained from mixed stage of D. melanogaster wt embryos (an overnight embryo collection) and the primers GTCGGTCATTGAAAGTTTCC and CCGAACATATTCCAAATCTG). The amplified fragment (495 pb) was cloned into pGEM-T easy (Promega) and the positive clones were verified by sequencing. Probes were detected with peroxidase-conjugated antibodies (Roche) and developed using the TSA-plus Tyramide fluorescence system (Perkin Elmer) for fluorescein or Cy3 fluorophore deposition.</p>
      <p>Imaging was performed in a Zeiss LSM 780 confocal microscope, using a Plan-Apochromat 20x/0.8 objective. For fluorescein detection, we used the 488nm wavelength of a multiline Argon laser, a MSB 488/561 dichroic mirror and a spectral detector set for a 500-600nm detection range. For Cy3 detection, samples were excited with a DPSS laser at. For DAPI detection, samples were excited with a diode at 405nm and the emission fluorescence was detected with a MBS405 dichroic mirror. Other acquisition parameters, such as PMT gain and offset, were set independently for each probe, dependent on the signal. After the acquisition, images were processed using ImageJ 1.46r [<xref rid="pgen.1008382.ref023" ref-type="bibr">23</xref>]. Although a Z-stack was routinely acquired, a single focal plane was manually selected for visualization, except for the images of Malpighian tubules and salivary glands, where a Z-projection was used as indicated. Post-acquisition processing consisted on cropping and orienting single embryos and adjusting minimum and maximum intensity values for maximizing contrast.</p>
    </sec>
    <sec sec-type="data-availability" id="sec015">
      <title>Code and data availability</title>
      <p>The code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/FunctionLab/find_scripts">https://github.com/FunctionLab/find_scripts</ext-link>. The gene expression prediction dataset is available at <ext-link ext-link-type="uri" xlink:href="http://find.princeton.edu/predictions/download/">http://find.princeton.edu/predictions/download/</ext-link> or <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3408411">https://doi.org/10.5281/zenodo.3408411</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec016">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pgen.1008382.s001">
      <label>S1 Fig</label>
      <caption>
        <title>Comparison of different tissue-stage classifier performances.</title>
        <p>Classifiers trained using a single data type, ChIP or RNA-seq, from a large collaborative project, modENCODE, was compared to classifiers using all public data from NCBI GEO for a single data type, and classifiers using all public NCBI GEO data sets and all data types. Integrating prediction utilizing tissue relationships information by ontology-CRF method further improved prediction performances. The left panel compares AUCs for each tissue-stage category with and without using ontology-CRF integration. For every input type, the cross-validation performances for all tissue-stage categories measured by area under ROC curves (AUC) were shown with boxplot.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pgen.1008382.s001.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008382.s002">
      <label>S2 Fig</label>
      <caption>
        <title>Global structure of predicted tissue-stage transcriptomes by developmental stages.</title>
        <p>The two dimensional projections of high-dimensional gene expression probability predictions were obtained with linear discriminant analysis (LDA) to best separate the stages. Each point corresponds to a tissue-stage, and the color represent the developmental stage.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pgen.1008382.s002.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008382.s003">
      <label>S3 Fig</label>
      <caption>
        <title>Global structure of predicted tissue-stage transcriptomes visualized by multidimensional scaling.</title>
        <p>The two dimensional projections of high-dimensional gene expression probability predictions were obtained with multidimensional scaling (MDS). The first two principal coordinates approximately correspond to variation across stages (a) and the third and fourth principal coordinates approximately correspond to variation across tissue types (b). Each point corresponds to a tissue-stage, and the color represents developmental stage in (a) and tissue type in (b).</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pgen.1008382.s003.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008382.s004">
      <label>S4 Fig</label>
      <caption>
        <title>Consistent high performance of tissue-stage specificity predictions for genes of varying levels of expression complexity.</title>
        <p>The gene expression tissue specificity prediction performances for all genes are measured by AUROC based on cross-validation. The distribution of AUROCs for genes with different gene expression annotation complexities were compared, showing better prediction performance for low complexity genes but retaining good performance even for high complexity genes.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pgen.1008382.s004.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008382.s005">
      <label>S5 Fig</label>
      <caption>
        <title>Validation of FIND predictions in specific late-embryo organs.</title>
        <p>a. Four genes with more than 20-fold enrichment above background in the term "6.embryonic Malpighian tubule" were selected for FISH on late embryos (&gt; stage 13). Images show Z-projections of 2–3 focal planes from entire embryos, with the signal for the specific gene probe in red. mt: Malpighian tubules; hg: hindgut; mg: midgut. b. Five genes with more than 20-fold enrichment above background in the term "6.embryonic salivary gland" were selected for FISH on late embryos (&gt; stage 13). Images show Z-projections of 2–3 focal planes from zoomed anterior sections of embryos. Signal for the specific gene probe is shown in red and signal for the salivary gland marker Gld is shown in green. For clarity, in some cases we pointed at the salivary gland cells with arrowheads based on the Gld signal. DAPI staining is included (blue signal) to show the shape of the embryo. Scale bar corresponds to 20μm in all images shown.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pgen.1008382.s005.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008382.s006">
      <label>S6 Fig</label>
      <caption>
        <title>Schematic overview of the SIND algorithm.</title>
        <p>The structured in-silico nano-dissection(SIND) algorithm make prediction based on dependencies of each tissue-stage term on SVM prediction, represented by X, and network connectivities between each term and the terms connected in the developmental ontology, represented by J. The SVM prediction dependency parameters W, <italic>α</italic> and network connectivity parameter J are learned during training on tissue-stage labels Y.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pgen.1008382.s006.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008382.s007">
      <label>S1 Table</label>
      <caption>
        <title>Validation of brain expression predictions.</title>
        <p>List of the 17 genes selected to validate the expression prediction for the BDGP term “5.brain primordium”. Since 5<sup>th</sup> BDGP category corresponds to stages 11 and 12, we inform the range of modENCODE RNA-seq expression values for time points 6-8h and 8-10h, and we inform a positive result when expression in the predicted tissue is seen in stage 11 or 12 embryos (last column). Evidence from literature encompasses all references listed in FlyBase for each gene. Evidence from hold-out <italic>in situ</italic> data includes FlyFISH expression patterns as well as BDGP <italic>in situs</italic> that have not been included in the training set for any reason. In all cases, we report “yes” if the reported expression includes expression in the brain during stages 11 or 12. Related evidence is also stated.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pgen.1008382.s007.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008382.s008">
      <label>S2 Table</label>
      <caption>
        <title>Validation of muscle expression predictions.</title>
        <p>List of the 17 genes selected to validate the expression prediction for the BDGP term “6.embryonic larval muscle system”. Since 6<sup>th</sup> BDGP category corresponds to stages 13 and later, we inform the range of modENCODE RNA-seq expression values for time points from 10-12h to the end of embryogenesis. Similarly, we inform a positive result when expression in the predicted tissue is seen in stage 13 or later (last column). Evidence from literature encompasses all references listed in FlyBase for each gene. Evidence from hold-out <italic>in situ</italic> data includes FlyFISH expression patterns as well as BDGP <italic>in situs</italic> that have not been included in the training set for any reason. In all cases, we report “yes” if the reported expression includes expression in the brain during stages 13 or later. Related or contradictory evidence (in red) is also stated.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pgen.1008382.s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008382.s009">
      <label>S3 Table</label>
      <caption>
        <title>Summaries of experimental validation of genes outside training set.</title>
        <p>Table summarizing both the results of our FISH experiments (first three rows) and the whole evidence available to support the expression of the genes in the predicted tissue (last four rows).</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pgen.1008382.s009.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008382.s010">
      <label>S1 File</label>
      <caption>
        <title>The tissue-developmental ontology for Drosophila melanogaster embryonic development.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pgen.1008382.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008382.s011">
      <label>S2 File</label>
      <caption>
        <title>Cross-validation performance of our predictions for all tissue-stages.</title>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pgen.1008382.s011.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1008382.s012">
      <label>S3 File</label>
      <caption>
        <title>List of all genome-wide transcriptome and chromatin data sets used in this study.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pgen.1008382.s012.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors are pleased to acknowledge that a substantial portion of the work in this paper was performed at the TIGRESS high-performance computer center at Princeton University, which is jointly supported by the Princeton Institute for Computational Science and Engineering and the Princeton University Office of Information Technology’s Research Computing department. O.G.T. is a CIFAR fellow.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pgen.1008382.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Tomancak</surname><given-names>P</given-names></name>, <name><surname>Berman</surname><given-names>BP</given-names></name>, <name><surname>Beaton</surname><given-names>A</given-names></name>, <name><surname>Weiszmann</surname><given-names>R</given-names></name>, <name><surname>Kwan</surname><given-names>E</given-names></name>, <name><surname>Hartenstein</surname><given-names>V</given-names></name>, <etal>et al</etal><article-title>Global analysis of patterns of gene expression during Drosophila embryogenesis</article-title>. <source>Genome Biol</source>. <year>2007</year>; <pub-id pub-id-type="doi">10.1186/gb-2007-8-7-r145</pub-id><?supplied-pmid 17645804?><pub-id pub-id-type="pmid">17645804</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Lécuyer</surname><given-names>E</given-names></name>, <name><surname>Yoshida</surname><given-names>H</given-names></name>, <name><surname>Parthasarathy</surname><given-names>N</given-names></name>, <name><surname>Alm</surname><given-names>C</given-names></name>, <name><surname>Babak</surname><given-names>T</given-names></name>, <name><surname>Cerovina</surname><given-names>T</given-names></name>, <etal>et al</etal><article-title>Global Analysis of mRNA Localization Reveals a Prominent Role in Organizing Cellular Architecture and Function</article-title>. <source>Cell</source>. <year>2007</year>;<volume>131</volume>: <fpage>174</fpage>–<lpage>187</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2007.08.003</pub-id><?supplied-pmid 17923096?><pub-id pub-id-type="pmid">17923096</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Hammonds</surname><given-names>AS</given-names></name>, <name><surname>Bristow</surname><given-names>CA</given-names></name>, <name><surname>Fisher</surname><given-names>WW</given-names></name>, <name><surname>Weiszmann</surname><given-names>R</given-names></name>, <name><surname>Wu</surname><given-names>S</given-names></name>, <name><surname>Hartenstein</surname><given-names>V</given-names></name>, <etal>et al</etal><article-title>Spatial expression of transcription factors in Drosophila embryonic organ development</article-title>. <source>Genome Biol</source>. <year>2013</year>; <pub-id pub-id-type="doi">10.1186/gb-2013-14-12-r140</pub-id><?supplied-pmid 24359758?><pub-id pub-id-type="pmid">24359758</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Wunderlich</surname><given-names>Z</given-names></name>, <name><surname>Bragdon</surname><given-names>MD</given-names></name>, <name><surname>DePace</surname><given-names>AH</given-names></name>. <article-title>Comparing mRNA levels using in situ hybridization of a target gene and co-stain</article-title>. <source>Methods</source>. <year>2014</year>;<volume>68</volume>: <fpage>233</fpage>–<lpage>241</lpage>. <pub-id pub-id-type="doi">10.1016/j.ymeth.2014.01.003</pub-id><?supplied-pmid 24434507?><pub-id pub-id-type="pmid">24434507</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Chikina</surname><given-names>MD</given-names></name>, <name><surname>Huttenhower</surname><given-names>C</given-names></name>, <name><surname>Murphy</surname><given-names>CT</given-names></name>, <name><surname>Troyanskaya</surname><given-names>OG</given-names></name>. <article-title>Global Prediction of Tissue-Specific Gene Expression and Context-Dependent Gene Networks in Caenorhabditis elegans</article-title>. <source>PLOS Comput Biol</source>. <year>2009</year>;<volume>5</volume>: <fpage>e1000417</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000417</pub-id><?supplied-pmid 19543383?><pub-id pub-id-type="pmid">19543383</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Ju</surname><given-names>W</given-names></name>, <name><surname>Greene</surname><given-names>CS</given-names></name>, <name><surname>Eichinger</surname><given-names>F</given-names></name>, <name><surname>Nair</surname><given-names>V</given-names></name>, <name><surname>Hodgin</surname><given-names>JB</given-names></name>, <name><surname>Bitzer</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Defining cell-type specificity at the transcriptional level in human disease</article-title>. <source>Genome Res</source>. <year>2013</year>; <pub-id pub-id-type="doi">10.1101/gr.155697.113</pub-id><?supplied-pmid 23950145?><pub-id pub-id-type="pmid">23950145</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Samsonova</surname><given-names>AA</given-names></name>, <name><surname>Niranjan</surname><given-names>M</given-names></name>, <name><surname>Russell</surname><given-names>S</given-names></name>, <name><surname>Brazma</surname><given-names>A</given-names></name>. <article-title>Prediction of gene expression in embryonic structures of Drosophila melanogaster</article-title>. <source>PLoS Comput Biol</source>. <year>2007</year>; <pub-id pub-id-type="doi">10.1371/journal.pcbi.0030144</pub-id><?supplied-pmid 17658945?><pub-id pub-id-type="pmid">17658945</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Kramerova</surname><given-names>IA</given-names></name>, <name><surname>Kramerov</surname><given-names>AA</given-names></name>, <name><surname>Fessler</surname><given-names>JH</given-names></name>. <article-title>Alternative splicing of papilin and the diversity of Drosophila extracellular matrix during embryonic morphogenesis</article-title>. <source>Dev Dyn</source>. <year>2003</year>;<volume>226</volume>: <fpage>634</fpage>–<lpage>642</lpage>. <pub-id pub-id-type="doi">10.1002/dvdy.10265</pub-id><?supplied-pmid 12666201?><pub-id pub-id-type="pmid">12666201</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Sandmann</surname><given-names>T</given-names></name>, <name><surname>Jensen</surname><given-names>LJ</given-names></name>, <name><surname>Jakobsen</surname><given-names>JS</given-names></name>, <name><surname>Karzynski</surname><given-names>MM</given-names></name>, <name><surname>Eichenlaub</surname><given-names>MP</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>A Temporal Map of Transcription Factor Activity: Mef2 Directly Regulates Target Genes at All Stages of Muscle Development</article-title>. <source>Dev Cell</source>. <year>2006</year>;<volume>10</volume>: <fpage>797</fpage>–<lpage>807</lpage>. <pub-id pub-id-type="doi">10.1016/j.devcel.2006.04.009</pub-id><?supplied-pmid 16740481?><pub-id pub-id-type="pmid">16740481</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Sandmann</surname><given-names>T</given-names></name>, <name><surname>Girardot</surname><given-names>C</given-names></name>, <name><surname>Brehme</surname><given-names>M</given-names></name>, <name><surname>Tongprasit</surname><given-names>W</given-names></name>, <name><surname>Stolc</surname><given-names>V</given-names></name>, <name><surname>Furlong</surname><given-names>EEM</given-names></name>. <article-title>A core transcriptional network for early mesoderm development in Drosophila melanogaster</article-title>. <source>Genes Dev</source>. <year>2007</year>;<volume>21</volume>: <fpage>436</fpage>–<lpage>449</lpage>. <pub-id pub-id-type="doi">10.1101/gad.1509007</pub-id><?supplied-pmid 17322403?><pub-id pub-id-type="pmid">17322403</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Chung</surname><given-names>S</given-names></name>, <name><surname>Chavez</surname><given-names>C</given-names></name>, <name><surname>Andrew</surname><given-names>DJ</given-names></name>. <article-title>Trachealess (Trh) regulates all tracheal genes during Drosophila embryogenesis</article-title>. <source>Dev Biol</source>. <year>2011</year>;<volume>360</volume>: <fpage>160</fpage>–<lpage>172</lpage>. <pub-id pub-id-type="doi">10.1016/j.ydbio.2011.09.014</pub-id><?supplied-pmid 21963537?><pub-id pub-id-type="pmid">21963537</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Park</surname><given-names>CY</given-names></name>, <name><surname>Wong</surname><given-names>AK</given-names></name>, <name><surname>Greene</surname><given-names>CS</given-names></name>, <name><surname>Rowland</surname><given-names>J</given-names></name>, <name><surname>Guan</surname><given-names>Y</given-names></name>, <name><surname>Bongo</surname><given-names>LA</given-names></name>, <etal>et al</etal><article-title>Functional Knowledge Transfer for High-accuracy Prediction of Under-studied Biological Processes</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>; <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002957</pub-id><?supplied-pmid 23516347?><pub-id pub-id-type="pmid">23516347</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Quiring</surname><given-names>R</given-names></name>, <name><surname>Walldorf</surname><given-names>U</given-names></name>, <name><surname>Kloter</surname><given-names>U</given-names></name>, <name><surname>Gehring</surname><given-names>WJ</given-names></name>. <article-title>Homology of the eyeless gene of Drosophila to the Small eye gene in mice and Aniridia in humans</article-title>. <source>Science (80-)</source>. <year>1994</year>;<volume>265</volume>: <fpage>785</fpage>–<lpage>789</lpage>. <pub-id pub-id-type="doi">10.1126/science.7914031</pub-id><?supplied-pmid 7914031?><pub-id pub-id-type="pmid">7914031</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Troyanskaya</surname><given-names>OG</given-names></name>, <name><surname>Cantor</surname><given-names>M</given-names></name>, <name><surname>Sherlock</surname><given-names>G</given-names></name>, <name><surname>Brown</surname><given-names>P</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Missing value estimation methods for DNA microarrays</article-title>. <source>Bioinformatics</source>. <year>2001</year>;</mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>: <fpage>357</fpage>–<lpage>359</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id><?supplied-pmid 22388286?><pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Brown</surname><given-names>JB</given-names></name>, <name><surname>Boley</surname><given-names>N</given-names></name>, <name><surname>Eisman</surname><given-names>R</given-names></name>, <name><surname>May</surname><given-names>GE</given-names></name>, <name><surname>Stoiber</surname><given-names>MH</given-names></name>, <name><surname>Duff</surname><given-names>MO</given-names></name>, <etal>et al</etal><article-title>Diversity and dynamics of the Drosophila transcriptome</article-title>. <source>Nature</source>. <year>2014</year>;<volume>512</volume>: <fpage>393</fpage>–<lpage>399</lpage>. <pub-id pub-id-type="doi">10.1038/nature12962</pub-id><?supplied-pmid 24670639?><pub-id pub-id-type="pmid">24670639</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Gramates</surname><given-names>LS</given-names></name>, <name><surname>Marygold</surname><given-names>SJ</given-names></name>, <name><surname>dos Santos</surname><given-names>G</given-names></name>, <name><surname>Urbano</surname><given-names>J-M</given-names></name>, <name><surname>Antonazzo</surname><given-names>G</given-names></name>, <name><surname>Matthews</surname><given-names>BB</given-names></name>, <etal>et al</etal><article-title>FlyBase at 25: looking to the future</article-title>. <source>Nucleic Acids Res</source>. <year>2017</year>;<volume>45</volume>: <fpage>D663</fpage>–<lpage>D671</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw1016</pub-id><?supplied-pmid 27799470?><pub-id pub-id-type="pmid">27799470</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Huttenhower</surname><given-names>C</given-names></name>, <name><surname>Schroeder</surname><given-names>M</given-names></name>, <name><surname>Chikina</surname><given-names>MD</given-names></name>, <name><surname>Troyanskaya</surname><given-names>OG</given-names></name>. <article-title>The Sleipnir library for computational functional genomics</article-title>. <source>Bioinformatics</source>. <year>2008</year>; <pub-id pub-id-type="doi">10.1093/bioinformatics/btn237</pub-id><?supplied-pmid 18499696?><pub-id pub-id-type="pmid">18499696</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Wilczynski</surname><given-names>B</given-names></name>, <name><surname>Liu</surname><given-names>Y-H</given-names></name>, <name><surname>Yeo</surname><given-names>ZX</given-names></name>, <name><surname>Furlong</surname><given-names>EEM</given-names></name>. <article-title>Predicting Spatial and Temporal Gene Expression Using an Integrative Model of Transcription Factor Occupancy and Chromatin State</article-title>. <source>PLOS Comput Biol</source>. <year>2012</year>;<volume>8</volume>: <fpage>e1002798</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002798</pub-id><?supplied-pmid 23236268?><pub-id pub-id-type="pmid">23236268</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Schor</surname><given-names>IE</given-names></name>, <name><surname>Bussotti</surname><given-names>G</given-names></name>, <name><surname>Maleš</surname><given-names>M</given-names></name>, <name><surname>Forneris</surname><given-names>M</given-names></name>, <name><surname>Viales</surname><given-names>RR</given-names></name>, <name><surname>Enright</surname><given-names>AJ</given-names></name>, <etal>et al</etal><article-title>Non-coding RNA Expression, Function, and Variation during Drosophila Embryogenesis</article-title>. <source>Curr Biol</source>. <year>2018</year>; <pub-id pub-id-type="doi">10.1016/j.cub.2018.09.026</pub-id><?supplied-pmid 30393032?><pub-id pub-id-type="pmid">30393032</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Stapleton</surname><given-names>M</given-names></name>, <name><surname>Carlson</surname><given-names>J</given-names></name>, <name><surname>Brokstein</surname><given-names>P</given-names></name>, <name><surname>Yu</surname><given-names>C</given-names></name>, <name><surname>Champe</surname><given-names>M</given-names></name>, <name><surname>George</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>A Drosophilafull-length cDNA resource</article-title>. <source>Genome Biol</source>. <year>2002</year>;<volume>3</volume>: research0080. <pub-id pub-id-type="doi">10.1186/gb-2002-3-12-research0080</pub-id><?supplied-pmid 12537569?><pub-id pub-id-type="pmid">12537569</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Rembold</surname><given-names>M</given-names></name>, <name><surname>Ciglar</surname><given-names>L</given-names></name>, <name><surname>Omar Yáñez-Cuna</surname><given-names>J</given-names></name>, <name><surname>Zinzen</surname><given-names>RP</given-names></name>, <name><surname>Girardot</surname><given-names>C</given-names></name>, <name><surname>Jain</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>A conserved role for Snail as a potentiator of active transcription</article-title>. <source>Genes Dev</source>. <year>2014</year>; <pub-id pub-id-type="doi">10.1101/gad.230953.113</pub-id><?supplied-pmid 24402316?><pub-id pub-id-type="pmid">24402316</pub-id></mixed-citation>
    </ref>
    <ref id="pgen.1008382.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Schneider</surname><given-names>CA</given-names></name>, <name><surname>Rasband</surname><given-names>WS</given-names></name>, <name><surname>Eliceiri</surname><given-names>KW</given-names></name>. <article-title>NIH Image to ImageJ: 25 years of image analysis</article-title>. <source>Nat Methods</source>. <year>2012</year>;</mixed-citation>
    </ref>
  </ref-list>
</back>
