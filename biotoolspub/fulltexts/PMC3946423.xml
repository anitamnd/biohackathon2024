<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3946423</article-id>
    <article-id pub-id-type="pmid">24608116</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-13-51408</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0089694</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis Tools</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
          <subj-group>
            <subject>Genome Analysis Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer Science</subject>
        <subj-group>
          <subject>Algorithms</subject>
        </subj-group>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Engineering</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Mathematics</subject>
        <subj-group>
          <subject>Applied Mathematics</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Statistics</subject>
          <subj-group>
            <subject>Biostatistics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PolyaPeak: Detecting Transcription Factor Binding Sites from ChIP-seq Using Peak Shape Information</article-title>
      <alt-title alt-title-type="running-head">ChIP-seq Peak Detection Using Peak Shape</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Hao</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Hongkai</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Department of Biostatistics and Bioinformatics, Emory University, Atlanta, Georgia, United States of America</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Department of Biostatistics, Johns Hopkins University, Baltimore, Maryland, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Xing</surname>
          <given-names>Yi</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of California, Los Angeles, United States of America</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>hao.wu@emory.edu</email> (HW); <email>hji@jhsph.edu</email> (HJ)</corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: HW. Analyzed the data: HW. Wrote the paper: HW HJ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>3</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>3</issue>
    <elocation-id>e89694</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>12</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>1</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Wu, Ji</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Wu, Ji</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>ChIP-seq is a powerful technology for detecting genomic regions where a protein of interest interacts with DNA. ChIP-seq data for mapping transcription factor binding sites (TFBSs) have a characteristic pattern: around each binding site, sequence reads aligned to the forward and reverse strands of the reference genome form two separate peaks shifted away from each other, and the true binding site is located in between these two peaks. While it has been shown previously that the accuracy and resolution of binding site detection can be improved by modeling the pattern, efficient methods are unavailable to fully utilize that information in TFBS detection procedure.</p>
      <p>We present PolyaPeak, a new method to improve TFBS detection by incorporating the peak shape information. PolyaPeak describes peak shapes using a flexible Pólya model. The shapes are automatically learnt from the data using Minorization-Maximization (MM) algorithm, then integrated with the read count information via a hierarchical model to distinguish true binding sites from background noises.</p>
      <p>Extensive real data analyses show that PolyaPeak is capable of robustly improving TFBS detection compared with existing methods. An R package is freely available.</p>
    </abstract>
    <funding-group>
      <funding-statement>Research by HJ is supported by the National Institute of Health grant: R01HG006282. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>One major goal of functional genomics is to comprehensively characterize the regulatory circuitry behind coordinated spatial and temporal gene activities. In order to achieve this goal, a critical step is to monitor downstream regulatory programs of various transcription factors (TFs). ChIP-seq <xref rid="pone.0089694-Johnson1" ref-type="bibr">[1]</xref>, <xref rid="pone.0089694-Robertson1" ref-type="bibr">[2]</xref>, a technology that couples chromatin immunoprecipitation with massively parallel sequencing, is capable of mapping genome-wide transcription factor binding sites (TFBSs), and is increasingly used by scientists and nation-wide projects such as ENCODE <xref rid="pone.0089694-Thomas1" ref-type="bibr">[3]</xref> and modENCODE <xref rid="pone.0089694-Celniker1" ref-type="bibr">[4]</xref> to annotate functional sequence elements in human genome and genomes of model organisms. ChIP-seq data grow rapidly. The first ChIP-seq studies were published in 2007. Since then, several thousands studies have been performed and data are available in public databases <xref rid="pone.0089694-Chen1" ref-type="bibr">[5]</xref>. This highlights the importance of continuous development of robust and powerful ChIP-seq data analysis tools.</p>
    <p>The raw data produced by a ChIP-seq experiment are tens of millions of short (usually less than 100 base pairs) DNA sequences called “reads”. To identify TFBSs, the reads are first aligned to a reference genome and the uniquely aligned reads are retained. Next, the genome is scanned to identify “peaks”, or regions enriched in aligned sequence reads, which are the predicted TF binding sites. Since 2007, a number of peak calling algorithms and software tools have been developed. Examples include BayesPeak <xref rid="pone.0089694-Spyrou1" ref-type="bibr">[6]</xref>, CisGenome <xref rid="pone.0089694-Ji1" ref-type="bibr">[7]</xref>, FindPeaks <xref rid="pone.0089694-Fejes1" ref-type="bibr">[8]</xref>, GPS <xref rid="pone.0089694-Guo1" ref-type="bibr">[9]</xref>, Hpeak <xref rid="pone.0089694-Qin1" ref-type="bibr">[10]</xref>, MACS <xref rid="pone.0089694-Zhang1" ref-type="bibr">[11]</xref>, MOSAiCS <xref rid="pone.0089694-Kuan1" ref-type="bibr">[12]</xref>, PeakSeq <xref rid="pone.0089694-Rozowsky1" ref-type="bibr">[13]</xref>, PICS <xref rid="pone.0089694-Zhang2" ref-type="bibr">[14]</xref>, QuEST <xref rid="pone.0089694-Valouev1" ref-type="bibr">[15]</xref>, SISSRs <xref rid="pone.0089694-Jothi1" ref-type="bibr">[16]</xref>, T-PIC <xref rid="pone.0089694-Hower1" ref-type="bibr">[17]</xref>, etc. Several benchmark studies have also been conducted to compare different peak calling tools <xref rid="pone.0089694-Laajala1" ref-type="bibr">[18]</xref>, <xref rid="pone.0089694-Wilbanks1" ref-type="bibr">[19]</xref>.</p>
    <p>Early analyses revealed that ChIP-seq data for mapping TFBSs have a characteristic pattern: surrounding each true binding site, sequence reads aligned to the forward and reverse strands of the reference genome are clustered into two distinct peaks that are shifted away from each other, and the binding site is located in between them (<xref ref-type="fig" rid="pone-0089694-g001">Figure 1</xref>). This phenomenon is caused by the sequencing protocol which involves cutting chromatin into fragments and reading the sequences from both ends of the TF bound DNA fragments. The cutting points seldom fall within the binding sites since the DNA is protected by the TF. As a result, in most cases the binding sites sit within the DNA fragments, and their flanking sequences are read out by the sequencer. Since the machine reads the DNA sequences in a directional way, reads from one end of the DNA fragments are always aligned to the forward strand of the reference genome, and reads from the other end are always aligned to the reverse strand. This creates the bimodal peak pattern shown in <xref ref-type="fig" rid="pone-0089694-g001">Figure 1</xref>.</p>
    <fig id="pone-0089694-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0089694.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Illustration of peak shapes from three good binding sites (a, b, c) and one false positive (d).</title>
        <p>X-axis is genomic location centered at the summit of each peak. Y-axis represents ChIP read counts in 10 bp genomic windows. For each peak, data from the IP sample in a 800 bp window surrounding the MACS peak summit is shown. Bars above the middle represent counts from forward strand, and bars below represent the counts from reverse strand. The black rectangles illustrate the TF binding sites. (a) and (b) are two different binding sites from the same ChIP-seq dataset, and (c) is a binding site from a different dataset. They illustrate that peak shapes at true TFBSs are similar but can vary across binding sites and datasets.</p>
      </caption>
      <graphic xlink:href="pone.0089694.g001"/>
    </fig>
    <p>This pattern has been shown to be useful for improving TFBS detection. For example, SISSRs <xref rid="pone.0089694-Jothi1" ref-type="bibr">[16]</xref> uses the sign change of the forward and reverse strand read count difference along the genome to identify the true binding sites. CisGenome <xref rid="pone.0089694-Ji1" ref-type="bibr">[7]</xref> uses the summits of the two coupled peaks to determine the boundaries of binding sites. QuEST <xref rid="pone.0089694-Valouev1" ref-type="bibr">[15]</xref> and MACS <xref rid="pone.0089694-Zhang1" ref-type="bibr">[11]</xref> estimate the offset between the forward and reverse strand peaks, and shift these two peaks together based on the offset. They then merge signals from both peaks to increase accuracy for identifying true binding location. While many state-of-the-art peak callers use the bimodal pattern in their design, most methods only use the information contained in the offset between the two coupled peaks. Few method fully utilize the information contained in the peak shapes. As pointed out in a recent publication <xref rid="pone.0089694-Rye1" ref-type="bibr">[20]</xref>, many false positive TFBSs can be “filtered out by visual inspection on the peak sizes and appearance”. To demonstrate, <xref ref-type="fig" rid="pone-0089694-g001">Figure 1</xref> shows three examples of good binding sites along with an example of false positive. All examples have large read counts in both strands with certain offsets. Methods using the offset information alone would call all examples as binding sites. However, the example in <xref ref-type="fig" rid="pone-0089694-g001">Figure 1(d)</xref> is very likely to be sequencing artifacts. It does not contain DNA motifs for the TF, and clearly has very different shapes from the true binding sites. Thus if the peak shape information is used in the inference, this false positive can be eliminated.</p>
    <p>There are two existing methods fully incorporate the peak shape information in a rigorous statistical framework. PICS <xref rid="pone.0089694-Zhang2" ref-type="bibr">[14]</xref> uses two t-distributions with shifted centers to jointly model the positions of forward and reverse reads. A limitation of this approach is that it assumes that the peak shapes can be described by scaled t-distributions, which may not reflect the true peak shapes as they could be asymmetric. GPS <xref rid="pone.0089694-Guo1" ref-type="bibr">[9]</xref> implements a more flexible approach to use an empirical distribution to characterize the peak shapes. The estimation of the shapes and peak calling are iterated until convergence. Both PICS and GPS are computationally intensive, especially when the total read counts is large because they model the position of all aligned reads. T-PIC <xref rid="pone.0089694-Hower1" ref-type="bibr">[17]</xref> is another method that partially uses the peak shape information by summarizing it into a one-number statistic. However it only reflects certain aspects of the peak shape and cannot capture the full detail. Moreover, T-PIC does not treat the forward and reverse strand reads separately and ignores the offset between them.</p>
    <p>In this article we propose a new method called PolyaPeak to utilize the peak shape information for detecting TFBSs. PolyaPeak models the read counts from equal sized bins around the binding sites and describes the peak shapes using a multivariate Pólya distribution. It then uses a hierarchical model to integrate the peak shape and the read count information to identify binding sites. Compared with PICS and GPS, PolyaPeak models the bin counts so it's more computationally efficient and can be easily embedded into MACS or CisGenome as a downstream peak ranking algorithm. Therefore, PolyaPeak provides a more flexible and efficient model for utilizing the peak shape information. Our extensive real data analyses show that its performance is robustly among the bests compare to several state-of-the-art peak callers.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <p>We use a two-step procedure to detect binding sites. In the first step, a simple and fast peak calling algorithm based on smoothing is applied to roughly identify the locations and summits of candidate peaks. In this article we use MACS as the first step peak caller although one can easily replace MACS by other methods. In the second step, the candidate peaks are scored and ranked by a more sophisticated model which considers both the read count and the peak shape information. Since the first step is based on existing algorithms, this article focuses on the second step.</p>
    <sec id="s2a">
      <title>A hierarchical model for peak scoring</title>
      <p>Assume there are <inline-formula><inline-graphic xlink:href="pone.0089694.e001.jpg"/></inline-formula> candidate peaks obtained from the first step peak calling. For each peak, we take an <inline-formula><inline-graphic xlink:href="pone.0089694.e002.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0089694.e003.jpg"/></inline-formula> by default) base pair (bp) window centered at its summit. The window is divided into equal sized non-overlapping bins of <inline-formula><inline-graphic xlink:href="pone.0089694.e004.jpg"/></inline-formula> bp long (<inline-formula><inline-graphic xlink:href="pone.0089694.e005.jpg"/></inline-formula> by default). The number of reads within each bin is obtained. Reads aligned to the forward and reverse strands are counted separately. Hereinafter, “peak” refers to the <inline-formula><inline-graphic xlink:href="pone.0089694.e006.jpg"/></inline-formula> bp window. For peak <inline-formula><inline-graphic xlink:href="pone.0089694.e007.jpg"/></inline-formula>, denote the read counts on the forward and reverse strands in bin 0<inline-formula><inline-graphic xlink:href="pone.0089694.e008.jpg"/></inline-formula> and sample <inline-formula><inline-graphic xlink:href="pone.0089694.e009.jpg"/></inline-formula> by <inline-formula><inline-graphic xlink:href="pone.0089694.e010.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0089694.e011.jpg"/></inline-formula> respectively. Here <inline-formula><inline-graphic xlink:href="pone.0089694.e012.jpg"/></inline-formula> or <inline-formula><inline-graphic xlink:href="pone.0089694.e013.jpg"/></inline-formula> refers to IP or control sample, and <inline-formula><inline-graphic xlink:href="pone.0089694.e014.jpg"/></inline-formula>. Reads from replicate samples are pooled together. Define <inline-formula><inline-graphic xlink:href="pone.0089694.e015.jpg"/></inline-formula> to be read counts from all bins and all samples for peak <inline-formula><inline-graphic xlink:href="pone.0089694.e016.jpg"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="pone.0089694.e017.jpg"/></inline-formula> be the total read count in peak <inline-formula><inline-graphic xlink:href="pone.0089694.e018.jpg"/></inline-formula>: <inline-formula><inline-graphic xlink:href="pone.0089694.e019.jpg"/></inline-formula>.</p>
      <p>Let <inline-formula><inline-graphic xlink:href="pone.0089694.e020.jpg"/></inline-formula> indicate whether peak <inline-formula><inline-graphic xlink:href="pone.0089694.e021.jpg"/></inline-formula> is a true binding site ( = 1) or not ( = 0). We assume that <italic>a priori</italic>, the probability for a candidate peak being a true binding site is <inline-formula><inline-graphic xlink:href="pone.0089694.e022.jpg"/></inline-formula>, or <inline-formula><inline-graphic xlink:href="pone.0089694.e023.jpg"/></inline-formula>. Then the observed bin-level read counts <inline-formula><inline-graphic xlink:href="pone.0089694.e024.jpg"/></inline-formula> for each peak are assumed to be generated hierarchically. First, a total read count <inline-formula><inline-graphic xlink:href="pone.0089694.e025.jpg"/></inline-formula> is drawn from certain distribution. Second, the <inline-formula><inline-graphic xlink:href="pone.0089694.e026.jpg"/></inline-formula> reads are randomly allocated to different bins based on a probability distribution that specifies the peak shape.</p>
      <p>The distributions for generating <inline-formula><inline-graphic xlink:href="pone.0089694.e027.jpg"/></inline-formula> conditioned on <inline-formula><inline-graphic xlink:href="pone.0089694.e028.jpg"/></inline-formula> are:<disp-formula id="pone.0089694.e029"><graphic xlink:href="pone.0089694.e029.jpg" position="anchor" orientation="portrait"/><label>(1)</label></disp-formula>In other words, if <inline-formula><inline-graphic xlink:href="pone.0089694.e030.jpg"/></inline-formula>, the candidate peak <inline-formula><inline-graphic xlink:href="pone.0089694.e031.jpg"/></inline-formula> is a true binding site and <inline-formula><inline-graphic xlink:href="pone.0089694.e032.jpg"/></inline-formula> is assumed to follow a uniform distribution. If <inline-formula><inline-graphic xlink:href="pone.0089694.e033.jpg"/></inline-formula>, the candidate peak <inline-formula><inline-graphic xlink:href="pone.0089694.e034.jpg"/></inline-formula> represents background noise and <inline-formula><inline-graphic xlink:href="pone.0089694.e035.jpg"/></inline-formula> is assumed to follow a mixture of a negative binomial distribution and a uniform distribution. Negative binomial distribution is a popular choice for modeling the background read counts <xref rid="pone.0089694-Ji1" ref-type="bibr">[7]</xref>, <xref rid="pone.0089694-Kuan1" ref-type="bibr">[12]</xref>. Compared with Poisson, it allows over-dispersion and provides better fit to the data. Our choice of using a mixture of negative binomial and uniform for background is motivated by real data observation. It implies that for most background regions, the total counts follow a negative binomial distribution. However, some non-binding regions may have unusually large read counts due to artifacts. These outliers are modeled by the uniform mixing component. Technically, these model assumptions guarantee that the likelihood ratio <inline-formula><inline-graphic xlink:href="pone.0089694.e036.jpg"/></inline-formula> increases monotonically with <inline-formula><inline-graphic xlink:href="pone.0089694.e037.jpg"/></inline-formula>, but is bounded at <inline-formula><inline-graphic xlink:href="pone.0089694.e038.jpg"/></inline-formula> in interval <inline-formula><inline-graphic xlink:href="pone.0089694.e039.jpg"/></inline-formula>. Thus the inference will not be overly influenced by the outliers, and the results will be more robust. In PolyaPeak, we set <inline-formula><inline-graphic xlink:href="pone.0089694.e040.jpg"/></inline-formula> to 0.001 and treat it as fixed and known.</p>
      <p>Given <inline-formula><inline-graphic xlink:href="pone.0089694.e041.jpg"/></inline-formula>, the bin counts <inline-formula><inline-graphic xlink:href="pone.0089694.e042.jpg"/></inline-formula> are assumed to follow multinomial distributions with random bin level probabilities <inline-formula><inline-graphic xlink:href="pone.0089694.e043.jpg"/></inline-formula>: <inline-formula><inline-graphic xlink:href="pone.0089694.e044.jpg"/></inline-formula>. Here <inline-formula><inline-graphic xlink:href="pone.0089694.e045.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0089694.e046.jpg"/></inline-formula>. <inline-formula><inline-graphic xlink:href="pone.0089694.e047.jpg"/></inline-formula> characterizes the peak shape at peak <inline-formula><inline-graphic xlink:href="pone.0089694.e048.jpg"/></inline-formula>. We further assume that the peak-specific multinomial probabilities <inline-formula><inline-graphic xlink:href="pone.0089694.e049.jpg"/></inline-formula> follow Dirichlet distributions with different parameters at background and binding regions:<disp-formula id="pone.0089694.e050"><graphic xlink:href="pone.0089694.e050.jpg" position="anchor" orientation="portrait"/></disp-formula>Here <inline-formula><inline-graphic xlink:href="pone.0089694.e051.jpg"/></inline-formula>. Conceptually, at a true binding site the proportions of multinomial distribution, e.g., <inline-formula><inline-graphic xlink:href="pone.0089694.e052.jpg"/></inline-formula>, describe the peak shape. Using a Dirichlet prior for <inline-formula><inline-graphic xlink:href="pone.0089694.e053.jpg"/></inline-formula> is based on observation that peaks in real data vary in widths, heights, and shapes, possibly due to various biological and technical factors. The Dirichlet prior provides a flexible model to allow the heterogeneity and variation in the peak shapes.</p>
      <p>Integrating out the peak specific multinomial probabilities <inline-formula><inline-graphic xlink:href="pone.0089694.e054.jpg"/></inline-formula>, one can obtain the marginal bin counts distribution conditional on the total counts:<disp-formula id="pone.0089694.e055"><graphic xlink:href="pone.0089694.e055.jpg" position="anchor" orientation="portrait"/><label>(2)</label></disp-formula>Here MP represents multivariate Pólya distribution, also known as Dirichlet-multinomial compound distribution which generalizes the Beta-binomial distribution.</p>
      <p>In the model above, the bin counts <inline-formula><inline-graphic xlink:href="pone.0089694.e056.jpg"/></inline-formula> from all candidate peaks are the observed data. Unknown model parameters include <inline-formula><inline-graphic xlink:href="pone.0089694.e057.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0089694.e058.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0089694.e059.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0089694.e060.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0089694.e061.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0089694.e062.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0089694.e063.jpg"/></inline-formula>. These parameters can be either specified or estimated from the data. Given the parameters, one can compute the posterior probability for a candidate peak being a true binding site. Such posterior probability can be decomposed into three components:<disp-formula id="pone.0089694.e064"><graphic xlink:href="pone.0089694.e064.jpg" position="anchor" orientation="portrait"/><label>(3)</label></disp-formula>The first component is the prior probability for peak <inline-formula><inline-graphic xlink:href="pone.0089694.e065.jpg"/></inline-formula> to be a true binding site. The second component is the information from the total read count. The third component is the allocation of read counts in different bins conditional on the total count. This component characterizes the peak shape around the binding site and was ignored by many existing peak callers. PolyaPeak first determines the unknown parameters, then compute <inline-formula><inline-graphic xlink:href="pone.0089694.e066.jpg"/></inline-formula> for each candidate peak and rank the candidate peaks accordingly.</p>
    </sec>
    <sec id="s2b">
      <title>Choice of parameters</title>
      <sec id="s2b1">
        <title>Choosing <inline-formula><inline-graphic xlink:href="pone.0089694.e067.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0089694.e068.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0089694.e069.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0089694.e070.jpg"/></inline-formula>
</title>
        <p>Given a list of candidate peaks, the distributional parameters in <xref ref-type="disp-formula" rid="pone.0089694.e029">Equation 1</xref> are determined as follows. For each candidate peak, we obtain the total read count <inline-formula><inline-graphic xlink:href="pone.0089694.e071.jpg"/></inline-formula>. The minimum and maximum of <inline-formula><inline-graphic xlink:href="pone.0089694.e072.jpg"/></inline-formula> from all candidate peaks are taken as <inline-formula><inline-graphic xlink:href="pone.0089694.e073.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0089694.e074.jpg"/></inline-formula> for the uniform distribution.</p>
        <p>To estimate the negative binomial parameters <inline-formula><inline-graphic xlink:href="pone.0089694.e075.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0089694.e076.jpg"/></inline-formula>, we first obtain genomic regions not covered by candidate peaks. These regions are cut into <inline-formula><inline-graphic xlink:href="pone.0089694.e077.jpg"/></inline-formula> bp non-overlapping windows and read counts for each window are obtained. A large proportion of the genome (e.g., the repetitive regions) is unmappable. As a result, many background windows have zero count. In practice, if there are five consecutive regions with zero count, we exclude these regions from the analysis. The real data analyses show that the counts from the remaining regions can be fitted well by a negative binomial. Using these regions, we estimate <inline-formula><inline-graphic xlink:href="pone.0089694.e078.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0089694.e079.jpg"/></inline-formula> by a moment estimator. A negative binomial random variable <inline-formula><inline-graphic xlink:href="pone.0089694.e080.jpg"/></inline-formula> has <inline-formula><inline-graphic xlink:href="pone.0089694.e081.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0089694.e082.jpg"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="pone.0089694.e083.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0089694.e084.jpg"/></inline-formula> be the sample mean and variance for <inline-formula><inline-graphic xlink:href="pone.0089694.e085.jpg"/></inline-formula>, we get: <inline-formula><inline-graphic xlink:href="pone.0089694.e086.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0089694.e087.jpg"/></inline-formula>.</p>
      </sec>
      <sec id="s2b2">
        <title>Choosing <inline-formula><inline-graphic xlink:href="pone.0089694.e088.jpg"/></inline-formula>
</title>
        <p>The first step peak calling algorithm provides a FDR estimate for the candidate peaks. We simply estimate <inline-formula><inline-graphic xlink:href="pone.0089694.e089.jpg"/></inline-formula> by <inline-formula><inline-graphic xlink:href="pone.0089694.e090.jpg"/></inline-formula>. Here <inline-formula><inline-graphic xlink:href="pone.0089694.e091.jpg"/></inline-formula> is the total length of the candidate peaks, and <inline-formula><inline-graphic xlink:href="pone.0089694.e092.jpg"/></inline-formula> is the length of the genome after excluding the unmappable regions. Since the FDR estimate provided by the initial peak calling may be biased, the estimate of <inline-formula><inline-graphic xlink:href="pone.0089694.e093.jpg"/></inline-formula> may be inaccurate. However, <inline-formula><inline-graphic xlink:href="pone.0089694.e094.jpg"/></inline-formula> only affects the value of the posterior probability <inline-formula><inline-graphic xlink:href="pone.0089694.e095.jpg"/></inline-formula>. It will not change the final peak ranking provided by PolyaPeak. For this reason, we can tolerate the bias in estimating <inline-formula><inline-graphic xlink:href="pone.0089694.e096.jpg"/></inline-formula>, since it does not compromise our main goal of improving the peak ranking.</p>
      </sec>
      <sec id="s2b3">
        <title>Estimating <inline-formula><inline-graphic xlink:href="pone.0089694.e097.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0089694.e098.jpg"/></inline-formula>
</title>
        <p>The procedures for estimating the parameters of multivariate Pólya distribution has been proposed previously. Here we implement the MM algorithm (reviewed in <xref ref-type="supplementary-material" rid="pone.0089694.s001">File S1</xref>) introduced by <xref rid="pone.0089694-Zhou1" ref-type="bibr">[21]</xref> to estimate <inline-formula><inline-graphic xlink:href="pone.0089694.e099.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0089694.e100.jpg"/></inline-formula>.</p>
        <p>For <inline-formula><inline-graphic xlink:href="pone.0089694.e101.jpg"/></inline-formula>, we first randomly sample <inline-formula><inline-graphic xlink:href="pone.0089694.e102.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0089694.e103.jpg"/></inline-formula> by default) genomic intervals of <inline-formula><inline-graphic xlink:href="pone.0089694.e104.jpg"/></inline-formula> bps from the non-peak regions. Each interval is divided into equal sized bins of <inline-formula><inline-graphic xlink:href="pone.0089694.e105.jpg"/></inline-formula> bps, and the bin read counts are obtained. Using these counts as input, <inline-formula><inline-graphic xlink:href="pone.0089694.e106.jpg"/></inline-formula> can be estimated via an MM algorithm. For <inline-formula><inline-graphic xlink:href="pone.0089694.e107.jpg"/></inline-formula>, we first obtain <inline-formula><inline-graphic xlink:href="pone.0089694.e108.jpg"/></inline-formula> top ranked candidate peaks from the initial peak calling. These high-quality peaks are most likely to be true binding sites, and will be used as the training data to learn peak shapes. For each of the <inline-formula><inline-graphic xlink:href="pone.0089694.e109.jpg"/></inline-formula> top peaks, we obtain the bin read counts <inline-formula><inline-graphic xlink:href="pone.0089694.e110.jpg"/></inline-formula>. Using these bin counts as data, <inline-formula><inline-graphic xlink:href="pone.0089694.e111.jpg"/></inline-formula> can be estimated using MM algorithm.</p>
      </sec>
    </sec>
    <sec id="s2c">
      <title>Ranking the peaks</title>
      <p>With all parameters determined, PolyaPeak will compute <inline-formula><inline-graphic xlink:href="pone.0089694.e112.jpg"/></inline-formula>, the posterior probability that each candidate peak is a true binding site, and use these posterior probabilities to rank the peaks. Some peaks may have the same posterior probabilities due to constraints of numerical precision. For these peaks, we use the log likelihood ratio <inline-formula><inline-graphic xlink:href="pone.0089694.e113.jpg"/></inline-formula> to break the ties.</p>
    </sec>
    <sec id="s2d">
      <title>Implementation</title>
      <p>The proposed method is implemented as an R package titled “PolyaPeak” for re-ranking a list of peaks reported from another peak calling software. The computational intensive part (MM algorithm) was implemented in C for efficiency. The software package can be freely downloaded from <ext-link ext-link-type="uri" xlink:href="http://web1.sph.emory.edu/users/hwu30/polyaPeak.html">http://web1.sph.emory.edu/users/hwu30/polyaPeak.html</ext-link>.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results</title>
    <sec id="s3a">
      <title>Data</title>
      <p>We tested PolyaPeak on a large number of publicly available datasets and obtained similar results. Here we present representative results using six datasets generated by three different labs. The first two datasets were generated by <xref rid="pone.0089694-Chen2" ref-type="bibr">[22]</xref> for mapping binding sites of mouse TFs OCT4 (POU5F1) and MYCN in mouse embryonic stem cells (mESC). The reads aligned to mouse genome build mm8 were downloaded from the Gene Expression Omnibus (GEO) (accession number GSE11431). The number of uniquely aligned reads for each sample ranged from 3 to 9 million. Each dataset contained one IP and one control sample. Datasets 3 and 4 were generated by Snyder lab at Yale/Stanford University for mapping the binding sites of MYC and MAX TFs in human K562 cell line. The data were generated as part of the ENCODE project. Sequence reads aligned to human genome build hg18 were downloaded from the ENCODE data coordination center. Each dataset contained two IP and one Input control samples. There were 10 to 20 million uniquely aligned reads in each sample. Datasets 5 and 6 were generated by the HudsonAlpha Institute, also for ENCODE project, for mapping the binding sites of GABP and NRSF TFs in human HepG2 cell line (GEO accession numbers GSM803343 for GABP and GSM803344 for NRSF). We downloaded the raw sequence reads aligned to human genome build hg19. Each dataset contained two IP and one Input control samples. Each sample had 50 to 100 million uniquely aligned sequence reads.</p>
      <p>The diversity of the test data in terms of lab origin, cell type, species, reference genome and sequencing depth demonstrates the general applicability of PolyaPeak.</p>
    </sec>
    <sec id="s3b">
      <title>Exploratory analysis</title>
      <p>First, we explored various characteristics of the real data. <xref ref-type="fig" rid="pone-0089694-g002">Figure 2(a)–(c)</xref> shows histograms of background window read counts <inline-formula><inline-graphic xlink:href="pone.0089694.e114.jpg"/></inline-formula> in the mESC OCT4, K562 MYC, and HepG2 GABP data. In each plot, the density curve of a negative binomial distribution with parameters estimated from the proposed method of moment estimator is also shown. It shows that the background total counts can be approximately modeled by a negative binomial distribution, and the estimation procedure for choosing negative binomial parameters works well.</p>
      <fig id="pone-0089694-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0089694.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>(a)–(c): histogram of total read counts in background regions from different datasets: (a) TF OCT4 in mouse ES cells; (b) TF MYC in K562 cell line; and (c) TF GABP in HepG2 cell line.</title>
          <p>The black solid curve is the theoretical density for the negative binomial distribution with parameters estimated from the method of moment procedure. It can be seen that the total counts in background regions can be approximated well by a negative binomial distribution, and the method of moments for estimating negative binomial parameters works well. (d) Estimated peak shape from polyaPeak for K562 MYC data.</p>
        </caption>
        <graphic xlink:href="pone.0089694.g002"/>
      </fig>
      <p><xref ref-type="fig" rid="pone-0089694-g002">Figure 2(d)</xref> shows the estimated peak shapes from the K562 MYC data. Plotted in the figure are the mean shapes for binding sites, e.g., <inline-formula><inline-graphic xlink:href="pone.0089694.e115.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0089694.e116.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="pone.0089694.e117.jpg"/></inline-formula>. The estimated parameters are able to capture the location shift between the forward and reverse strand peaks, and the enrichment of IP compared with control samples. <xref ref-type="fig" rid="pone-0089694-g002">Figure 2</xref> are only representative examples to illustrate key data characteristics. Analyses of the other datasets produced similar results.</p>
    </sec>
    <sec id="s3c">
      <title>Comparison with other methods</title>
      <p>Next, we compared PolyaPeak with several existing peak calling methods: MACS, CisGenome, PICS, GPS and T-PIC. While a number of peak calling methods have been developed, two comprehensive and independent benchmark studies showed that MACS robustly performs among the best in terms of peak calling sensitivity and overall receiver operating characteristics <xref rid="pone.0089694-Laajala1" ref-type="bibr">[18]</xref>, <xref rid="pone.0089694-Wilbanks1" ref-type="bibr">[19]</xref>. For this reason, we used MACS as the baseline to benchmark our method. CisGenome is another popular software tool for peak calling with relatively high specificity. Currently, MACS and CisGenome are the two most cited ChIP-seq peak calling tools according to both the ISI Web of Science and Google Scholar using “ChIP-seq” as the query keyword. PICS, GPS and T-PIC are recently developed peak calling algorithms which attempt to use the peak shape information. This makes them different from other peak callers that do not fully utilize the shape information. Since the main point of this paper is to use peak shape to improve TFBS detection, we included PICS, GPS and T-PIC into our comparisons to test the effectiveness of our model.</p>
      <p>For each dataset and each peak calling method except T-PIC, the analysis produced a ranked peak list. We compared different methods based on the enrichment of DNA motifs in the reported peaks. To avoid biases caused by peak lengths, we truncated or extended all peaks to make them having the same length (200 bps) before the motif analysis. For each ranked peak list, we evaluated the percentage of top <inline-formula><inline-graphic xlink:href="pone.0089694.e118.jpg"/></inline-formula> peaks containing at least one DNA motif site for the TF. We then plotted this percentage as a function of <inline-formula><inline-graphic xlink:href="pone.0089694.e119.jpg"/></inline-formula>. The DNA motif sites were obtained using the motif mapping function matchPWM in the Biostrings packages in BioConductor. The position weight matrices (PWMs) were obtained from TRANSFAC <xref rid="pone.0089694-Matys1" ref-type="bibr">[23]</xref>.</p>
      <p><xref ref-type="fig" rid="pone-0089694-g003">Figure 3</xref> compares the motif contents in peaks ranked by different methods. The results show that top peaks reported by PolyaPeak consistently have higher or comparable motif enrichment level compared with peaks reported from MACS, CisGenome or PICS, and the improvement could be substantial. For example, in the HepG2 GABP data, 56% of of the top 1000 peaks reported by PolyaPeak contained at least one GABP motif, whereas the percentages was 40%, 38% and 40% for MACS, CisGenome and PICS respectively. Thus PolyaPeak improved MACS by 40%. Compared to GPS, PolyaPeak outperformed in mESC OCT4 and MYCN, as well as K562 MAX data. GPS outperformed PolyaPeak in K562 MYC and HepG2 GABP data. The two performed similarly in HepG2 NRSF data. These results showed that overall, the performance of PolyaPeak is slightly better than GPS in terms of motif enrichment. Among all existing methods, we found that overall GPS and PICS provides better results than MACS and CisGenome, which is not surprising since it has incorporated peak shape information. In all the data we have tested, PolyaPeak robustly performed among the bests.</p>
      <fig id="pone-0089694-g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0089694.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Comparison of motif enrichment in top ranked peaks reported from different methods (PolyaPeak, reduced PolyaPeak without peak shape information, MACS, CisGenome, PICS and GPS) for six public datasets.</title>
          <p>X-axis represents peak ranks. Y-axis represents the percentage of reported peaks containing at least one DNA motif site.</p>
        </caption>
        <graphic xlink:href="pone.0089694.g003"/>
      </fig>
      <p>The comparison to T-PIC was more difficult since T-PIC runs very slow and usually reports larger number of peaks without providing peak rankings. Therefore we were only able to roughly compare the performance based on the overall motif contents of all reported peaks. Details of this comparison are provided in <xref ref-type="supplementary-material" rid="pone.0089694.s001">File S1</xref>, and the results show that PolyaPeak again performed better than T-PIC.</p>
    </sec>
    <sec id="s3d">
      <title>The net gain by modeling peak shapes</title>
      <p>The observed differences between PolyaPeak and the other methods can be caused by many different factors, such as differences in statistical models, parameter estimation methods, or implementation details. MACS was used as the first step peak caller for PolyaPeak. Even for the relatively well-controlled comparison between PolyaPeak and MACS, the observed differences could be due to differences in (1) modeling the total read counts, i.e., <inline-formula><inline-graphic xlink:href="pone.0089694.e120.jpg"/></inline-formula>, or (2) using the peak shape information, i.e., <inline-formula><inline-graphic xlink:href="pone.0089694.e121.jpg"/></inline-formula>. In order to determine whether the peak shape information really played an important role in improving the peak ranking performance, we developed a reduced PolyaPeak model by removing the peak shape information, and compared the reduced model with the original PolyaPeak that uses the peak shapes. To develop the reduced PolyaPeak model, we did not break peaks into <inline-formula><inline-graphic xlink:href="pone.0089694.e122.jpg"/></inline-formula> bins. Instead, for each peak we only counted the number of IP and control reads in the <inline-formula><inline-graphic xlink:href="pone.0089694.e123.jpg"/></inline-formula> bp window centered at the peak summit. As a result, we obtained two numbers per peak: <inline-formula><inline-graphic xlink:href="pone.0089694.e124.jpg"/></inline-formula> where <inline-formula><inline-graphic xlink:href="pone.0089694.e125.jpg"/></inline-formula> is the read count from the IP sample, and <inline-formula><inline-graphic xlink:href="pone.0089694.e126.jpg"/></inline-formula> is the read count from the control sample. <inline-formula><inline-graphic xlink:href="pone.0089694.e127.jpg"/></inline-formula> is the total read counts. We then modeled <inline-formula><inline-graphic xlink:href="pone.0089694.e128.jpg"/></inline-formula> similarly as in Formulas 1–3. However, rather than having <inline-formula><inline-graphic xlink:href="pone.0089694.e129.jpg"/></inline-formula> numbers per peak as the observed data, now we only have two numbers per peak. The reduced model still allows one to use the information from the IP and control read count differences, but the peak shape information is lost. We fit the reduced model and applied it to rank peaks in the same way as the original PolyaPeak. <xref ref-type="fig" rid="pone-0089694-g003">Figure 3</xref> shows that the original PolyaPeak consistently outperformed the reduced model. This carefully controlled comparison clearly demonstrates that incorporating the peak shape information is able to substantially improve the accuracy for detecting true binding sites.</p>
    </sec>
    <sec id="s3e">
      <title>The change of peak rankings</title>
      <p>We further looked at the peaks with large rank changes between the results from MACS and PolyaPeak. <xref ref-type="fig" rid="pone-0089694-g004">Figure 4</xref> shows several examples of MACS peaks from the K562 MYC data that are down- or up-ranked by PolyaPeak. <xref ref-type="fig" rid="pone-0089694-g004">Figure 4 (a) and (b)</xref> show two peaks with high ranks from MACS and low ranks from PolyaPeak. This type of peaks often contain large read counts but do not have a clear shape. None of the peaks shown here contained MYC motif sites. Therefore the high read counts in these regions very likely represent artifacts. <xref ref-type="fig" rid="pone-0089694-g004">Figure 4 (c) and (d)</xref> are two examples of peaks up-ranked by PolyaPeak (ranked low from MACS but high from PolyaPeak). Both of them have nice shapes, and contain MYC motif.</p>
      <fig id="pone-0089694-g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0089694.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Examples of peaks showing large differences in ranks from MACS and PolyaPeak.</title>
          <p>(a) and (b): Peaks ranked high in MACS but low in PolyaPeak. (c) and (d): Peaks ranked low in MACS but high in PolyaPeak.</p>
        </caption>
        <graphic xlink:href="pone.0089694.g004"/>
      </fig>
      <p>Furthermore, it is found that the peaks ranked high in MACS could have huge rank reduction in PolyaPeak. On the other hand, the top ranked peaks from PolyaPeak usually are also ranked high in MACS and seldom have dramatic rank reduction. These results suggest that PolyaPeak mainly worked as a false positive filter to down-rank low-quality MACS peaks. In general, MACS peaks down-ranked by PolyaPeak have lower motif content. As a result, the overall motif enrichment level is higher from PolyaPeak results, as shown in <xref ref-type="fig" rid="pone-0089694-g003">Figure 3</xref>.</p>
    </sec>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>Previous benchmark studies have shown that MACS robustly performs among the best compared to other peak callers. Our results show that by fully utilizing the peak shape information, PolyaPeak is able to robustly outperform MACS. Compared with the other two packages that uses peak shape information (PICS and GPS), PolyaPeak also outperforms based on our tests. PolyaPeak is computationally efficient because it models the read counts from equal sized bins, whereas both PICS and GPS model the positions of all aligned reads so their computational burden grows with total reads. While we deliver PolyaPeak as an R package, the computation intensive parts were written in C. On a computer with 2.6 GHz CPU and 32 GB RAM running Linux, the total computation time (using MACS to call peaks then PolyaPeak to rank peaks) for an experiment with 25 million total aligned reads is around 15 minutes. As a comparison, GPS takes over an hour and PICS takes more than two hours on a single CPU.</p>
    <p>The performance difference between PolyaPeak and other peak callers can be caused by different factors. Even for the relatively well-controlled comparison between PolyaPeak and MACS, we do not have enough information to tell whether peak shape really helps. For this reason, and also because MACS has already been shown by others to have favorable performance, we did not include more peak callers into our comparisons as these comparisons will not produce generalizable principle for future algorithm design. Instead, we performed a well-controlled comparison between PolyaPeak and the reduced PolyaPeak. The only difference is that the reduced PolyaPeak does not use the peak shape information. This comparison is more informative than the comparison between PolyaPeak and the other peak callers since it clearly shows that peak shape information brings improvement. This produces a generalizable principle which in the future may be used together with other established principles (e.g., adjusting for GC content <xref rid="pone.0089694-Kuan1" ref-type="bibr">[12]</xref>) to continually improve the peak calling algorithms.</p>
    <p>PolyaPeak is specifically designed to re-rank the peaks using the shape information. It is important to point out that PolyaPeak does not model the clustering of multiple peaks within a small region, like in GPS and PICS. As a result, PolyaPeak could down rank regions with several closely spaced peaks. Nevertheless we found that overall the improvements overweigh the sacrifices as shown in the real data results.</p>
    <p>When modeling a shape, it is often helpful to encourage some smoothness. In our model, this can be achieved by introducing some regularization procedures such as to penalize the second-order derivative of the parameter <inline-formula><inline-graphic xlink:href="pone.0089694.e130.jpg"/></inline-formula> with respect to the bin locations. Such a model could potentially further improve the results, especially when the peaks are wider. This is a research topic worth exploring in the near future.</p>
    <p>PolyaPeak is able to improve TFBS detection because there is strong shape information at the true binding sites in TF ChIP-seq experiments. Examples shown in <xref ref-type="fig" rid="pone-0089694-g004">Figure 4</xref> shows that peaks containing large number of reads but didn't show the desired pattern are often down-ranked. On the other hand, peaks containing relatively less reads but showing strong pattern will be up-ranked. ChIP-seq can also be used to study histone modifications (HMs). However, HM ChIP-seq signals usually are highly variable in terms of their widths and shapes. Therefore, a future research topic is to explore whether peak shape is helpful for analyzing HM ChIP-seq data as well.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0089694.s001">
      <label>File S1</label>
      <caption>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0089694.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0089694-Johnson1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>D</given-names></name>, <name><surname>Mortazavi</surname><given-names>A</given-names></name>, <name><surname>Myers</surname><given-names>R</given-names></name>, <name><surname>Wold</surname><given-names>B</given-names></name> (<year>2007</year>) <article-title>Genome-wide mapping of in vivo protein-dna interactions</article-title>. <source>Science</source>
<volume>316</volume>: <fpage>1497</fpage>.<pub-id pub-id-type="pmid">17540862</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Robertson1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Robertson</surname><given-names>G</given-names></name>, <name><surname>Hirst</surname><given-names>M</given-names></name>, <name><surname>Bainbridge</surname><given-names>M</given-names></name>, <name><surname>Bilenky</surname><given-names>M</given-names></name>, <name><surname>Zhao</surname><given-names>Y</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>Genome-wide profiles of stat1 dna association using chromatin immunoprecipitation and massively parallel sequencing</article-title>. <source>Nature methods</source>
<volume>4</volume>: <fpage>651</fpage>–<lpage>657</lpage>.<pub-id pub-id-type="pmid">17558387</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Thomas1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Thomas</surname><given-names>D</given-names></name>, <name><surname>Rosenbloom</surname><given-names>K</given-names></name>, <name><surname>Clawson</surname><given-names>H</given-names></name>, <name><surname>Hinrichs</surname><given-names>A</given-names></name>, <name><surname>Trumbower</surname><given-names>H</given-names></name>, <etal>et al</etal> (<year>2006</year>) <article-title>The encode project at uc santa cruz</article-title>. <source>Nucleic acids research</source>
<volume>35</volume>: <fpage>D663</fpage>.<pub-id pub-id-type="pmid">17166863</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Celniker1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Celniker</surname><given-names>SE</given-names></name>, <name><surname>Dillon</surname><given-names>LA</given-names></name>, <name><surname>Gerstein</surname><given-names>MB</given-names></name>, <name><surname>Gunsalus</surname><given-names>KC</given-names></name>, <name><surname>Henikoff</surname><given-names>S</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>Unlocking the secrets of the genome</article-title>. <source>Nature</source>
<volume>459</volume>: <fpage>927</fpage>–<lpage>930</lpage>.<pub-id pub-id-type="pmid">19536255</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Chen1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>L</given-names></name>, <name><surname>Wu</surname><given-names>G</given-names></name>, <name><surname>Ji</surname><given-names>H</given-names></name> (<year>2011</year>) <article-title>hmchip: a database and web server for exploring publicly available human and mouse chip-seq and chip-chip data</article-title>. <source>Bioinformatics</source>
<volume>27</volume>: <fpage>1447</fpage>–<lpage>1448</lpage>.<pub-id pub-id-type="pmid">21450710</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Spyrou1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Spyrou</surname><given-names>C</given-names></name>, <name><surname>Stark</surname><given-names>R</given-names></name>, <name><surname>Lynch</surname><given-names>A</given-names></name>, <name><surname>Tavaré</surname><given-names>S</given-names></name> (<year>2009</year>) <article-title>Bayespeak: Bayesian analysis of chip-seq data</article-title>. <source>BMC bioinformatics</source>
<volume>10</volume>: <fpage>299</fpage>.<pub-id pub-id-type="pmid">19772557</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Ji1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Ji</surname><given-names>H</given-names></name>, <name><surname>Jiang</surname><given-names>H</given-names></name>, <name><surname>Ma</surname><given-names>W</given-names></name>, <name><surname>Johnson</surname><given-names>D</given-names></name>, <name><surname>Myers</surname><given-names>R</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>An integrated software system for analyzing ChIP-chip and ChIP-seq data</article-title>. <source>Nature Biotechnology</source>
<volume>26</volume>: <fpage>1293</fpage>–<lpage>1300</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0089694-Fejes1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Fejes</surname><given-names>AP</given-names></name>, <name><surname>Robertson</surname><given-names>G</given-names></name>, <name><surname>Bilenky</surname><given-names>M</given-names></name>, <name><surname>Varhol</surname><given-names>R</given-names></name>, <name><surname>Bainbridge</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Findpeaks 3.1: a tool for identifying areas of enrichment from massively parallel short-read sequencing technology</article-title>. <source>Bioin-formatics</source>
<volume>24</volume>: <fpage>1729</fpage>–<lpage>1730</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0089694-Guo1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>Y</given-names></name>, <name><surname>Papachristoudis</surname><given-names>G</given-names></name>, <name><surname>Altshuler</surname><given-names>R</given-names></name>, <name><surname>Gerber</surname><given-names>G</given-names></name>, <name><surname>Jaakkola</surname><given-names>T</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Discovering homotypic binding events at high spatial resolution</article-title>. <source>Bioinformatics</source>
<volume>26</volume>: <fpage>3028</fpage>–<lpage>3034</lpage>.<pub-id pub-id-type="pmid">20966006</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Qin1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Qin</surname><given-names>Z</given-names></name>, <name><surname>Yu</surname><given-names>J</given-names></name>, <name><surname>Shen</surname><given-names>J</given-names></name>, <name><surname>Maher</surname><given-names>C</given-names></name>, <name><surname>Hu</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Hpeak: an hmm-based algorithm for de_ning read-enriched regions in chip-seq data</article-title>. <source>BMC bioinformatics</source>
<volume>11</volume>: <fpage>369</fpage>.<pub-id pub-id-type="pmid">20598134</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Zhang1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>T</given-names></name>, <name><surname>Meyer</surname><given-names>C</given-names></name>, <name><surname>Eeckhoute</surname><given-names>J</given-names></name>, <name><surname>Johnson</surname><given-names>D</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Model-based analysis of chip-seq (macs)</article-title>. <source>Genome Biol</source>
<volume>9</volume>: <fpage>R137</fpage>.<pub-id pub-id-type="pmid">18798982</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Kuan1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Kuan</surname><given-names>P</given-names></name>, <name><surname>Chung</surname><given-names>D</given-names></name>, <name><surname>Pan</surname><given-names>G</given-names></name>, <name><surname>Thomson</surname><given-names>J</given-names></name>, <name><surname>Stewart</surname><given-names>R</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>A statistical framework for the analysis of chip-seq data</article-title>. <source>Journal of the American Statistical Association</source>
<comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/jasa.2011.ap09706">10.1198/jasa.2011.ap09706</ext-link></comment>
</mixed-citation>
    </ref>
    <ref id="pone.0089694-Rozowsky1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Rozowsky</surname><given-names>J</given-names></name>, <name><surname>Euskirchen</surname><given-names>G</given-names></name>, <name><surname>Auerbach</surname><given-names>R</given-names></name>, <name><surname>Zhang</surname><given-names>Z</given-names></name>, <name><surname>Gibson</surname><given-names>T</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>Peakseq enables systematic scoring of chip-seq experiments relative to controls</article-title>. <source>Nature biotechnology</source>
<volume>27</volume>: <fpage>66</fpage>–<lpage>75</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0089694-Zhang2">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Robertson</surname><given-names>G</given-names></name>, <name><surname>Krzywinski</surname><given-names>M</given-names></name>, <name><surname>Ning</surname><given-names>K</given-names></name>, <name><surname>Droit</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Pics: Probabilistic inference for chip-seq</article-title>. <source>Biometrics</source>
</mixed-citation>
    </ref>
    <ref id="pone.0089694-Valouev1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Valouev</surname><given-names>A</given-names></name>, <name><surname>Johnson</surname><given-names>D</given-names></name>, <name><surname>Sundquist</surname><given-names>A</given-names></name>, <name><surname>Medina</surname><given-names>C</given-names></name>, <name><surname>Anton</surname><given-names>E</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Genome-wide analysis of transcription factor binding sites based on chip-seq data</article-title>. <source>Nature methods</source>
<volume>5</volume>: <fpage>829</fpage>.<pub-id pub-id-type="pmid">19160518</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Jothi1">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Jothi</surname><given-names>R</given-names></name>, <name><surname>Cuddapah</surname><given-names>S</given-names></name>, <name><surname>Barski</surname><given-names>A</given-names></name>, <name><surname>Cui</surname><given-names>K</given-names></name>, <name><surname>Zhao</surname><given-names>K</given-names></name> (<year>2008</year>) <article-title>Genome-wide identification of in vivo protein–dna binding sites from chip-seq data</article-title>. <source>Nucleic acids research</source>
<volume>36</volume>: <fpage>5221</fpage>–<lpage>5231</lpage>.<pub-id pub-id-type="pmid">18684996</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Hower1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Hower</surname><given-names>V</given-names></name>, <name><surname>Evans</surname><given-names>S</given-names></name>, <name><surname>Pachter</surname><given-names>L</given-names></name> (<year>2011</year>) <article-title>Shape-based peak identification for chip-seq</article-title>. <source>BMC bioinfor-matics</source>
<volume>12</volume>: <fpage>15</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0089694-Laajala1">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Laajala</surname><given-names>T</given-names></name>, <name><surname>Raghav</surname><given-names>S</given-names></name>, <name><surname>Tuomela</surname><given-names>S</given-names></name>, <name><surname>Lahesmaa</surname><given-names>R</given-names></name>, <name><surname>Aittokallio</surname><given-names>T</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>A practical comparison of methods for detecting transcription factor binding sites in chip-seq experiments</article-title>. <source>BMC genomics</source>
<volume>10</volume>: <fpage>618</fpage>.<pub-id pub-id-type="pmid">20017957</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Wilbanks1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Wilbanks</surname><given-names>E</given-names></name>, <name><surname>Facciotti</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>Evaluation of algorithm performance in chip-seq peak detection</article-title>. <source>PLoS One</source>
<volume>5</volume>: <fpage>e11471</fpage>.<pub-id pub-id-type="pmid">20628599</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Rye1">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Rye</surname><given-names>M</given-names></name>, <name><surname>Sætrom</surname><given-names>P</given-names></name>, <name><surname>Drabløs</surname><given-names>F</given-names></name> (<year>2011</year>) <article-title>A manually curated chip-seq benchmark demonstrates room for improvement in current peak-finder programs</article-title>. <source>Nucleic acids research</source>
<volume>39</volume>: <fpage>e25</fpage>.<pub-id pub-id-type="pmid">21113027</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Zhou1">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>H</given-names></name>, <name><surname>Lange</surname><given-names>K</given-names></name> (<year>2010</year>) <article-title>Mm algorithms for some discrete multivariate distributions</article-title>. <source>Journal of Computational and Graphical Statistics</source>
<volume>19</volume>: <fpage>645</fpage>–<lpage>665</lpage>.<pub-id pub-id-type="pmid">20877446</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Chen2">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>X</given-names></name>, <name><surname>Xu</surname><given-names>H</given-names></name>, <name><surname>Yuan</surname><given-names>P</given-names></name>, <name><surname>Fang</surname><given-names>F</given-names></name>, <name><surname>Huss</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Integration of external signaling pathways with the core transcriptional network in embryonic stem cells</article-title>. <source>Cell</source>
<volume>133</volume>: <fpage>1106</fpage>–<lpage>1117</lpage>.<pub-id pub-id-type="pmid">18555785</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0089694-Matys1">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Matys</surname><given-names>V</given-names></name>, <name><surname>Fricke</surname><given-names>E</given-names></name>, <name><surname>Geffers</surname><given-names>R</given-names></name>, <name><surname>Goessling</surname><given-names>E</given-names></name>, <name><surname>Haubrock</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2003</year>) <article-title>Transfac R: transcriptional regulation, from patterns to profiles</article-title>. <source>Nucleic acids research</source>
<volume>31</volume>: <fpage>374</fpage>.<pub-id pub-id-type="pmid">12520026</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
