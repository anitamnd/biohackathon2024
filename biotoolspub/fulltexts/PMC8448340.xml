<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8448340</article-id>
    <article-id pub-id-type="pmid">34492011</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-20-01808</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009347</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Epidemiology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Epidemiology</subject>
          <subj-group>
            <subject>Infectious Disease Epidemiology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Medical Conditions</subject>
          <subj-group>
            <subject>Infectious Diseases</subject>
            <subj-group>
              <subject>Infectious Disease Epidemiology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Epidemiology</subject>
          <subj-group>
            <subject>Epidemiological Methods and Statistics</subject>
            <subj-group>
              <subject>Epidemiological Statistics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Medical Conditions</subject>
          <subj-group>
            <subject>Infectious Diseases</subject>
            <subj-group>
              <subject>Viral Diseases</subject>
              <subj-group>
                <subject>Covid 19</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>People and places</subject>
        <subj-group>
          <subject>Geographical locations</subject>
          <subj-group>
            <subject>Oceania</subject>
            <subj-group>
              <subject>New Zealand</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Medical Conditions</subject>
          <subj-group>
            <subject>Infectious Diseases</subject>
            <subj-group>
              <subject>Infectious Disease Control</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Epidemiology</subject>
          <subj-group>
            <subject>Pandemics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>RNA viruses</subject>
              <subj-group>
                <subject>Orthomyxoviruses</subject>
                <subj-group>
                  <subject>Influenza viruses</subject>
                  <subj-group>
                    <subject>Influenza A virus</subject>
                    <subj-group>
                      <subject>H1N1</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical microbiology</subject>
            <subj-group>
              <subject>Microbial pathogens</subject>
              <subj-group>
                <subject>Viral pathogens</subject>
                <subj-group>
                  <subject>Orthomyxoviruses</subject>
                  <subj-group>
                    <subject>Influenza viruses</subject>
                    <subj-group>
                      <subject>Influenza A virus</subject>
                      <subj-group>
                        <subject>H1N1</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and health sciences</subject>
        <subj-group>
          <subject>Pathology and laboratory medicine</subject>
          <subj-group>
            <subject>Pathogens</subject>
            <subj-group>
              <subject>Microbial pathogens</subject>
              <subj-group>
                <subject>Viral pathogens</subject>
                <subj-group>
                  <subject>Orthomyxoviruses</subject>
                  <subj-group>
                    <subject>Influenza viruses</subject>
                    <subj-group>
                      <subject>Influenza A virus</subject>
                      <subj-group>
                        <subject>H1N1</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>Viral pathogens</subject>
              <subj-group>
                <subject>Orthomyxoviruses</subject>
                <subj-group>
                  <subject>Influenza viruses</subject>
                  <subj-group>
                    <subject>Influenza A virus</subject>
                    <subj-group>
                      <subject>H1N1</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Improved estimation of time-varying reproduction numbers at low case incidence and between epidemic waves</article-title>
      <alt-title alt-title-type="running-head">EpiFilter: An improved time-varying reproduction number inference method</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7806-3605</contrib-id>
        <name>
          <surname>Parag</surname>
          <given-names>Kris V.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff"/>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>MRC Centre for Global Infectious Disease Analysis, Imperial College London, London, United Kingdom</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kosakovsky Pond</surname>
          <given-names>Sergei L.</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Temple University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>k.parag@imperial.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>9</issue>
    <elocation-id>e1009347</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Kris V. Parag</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Kris V. Parag</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pdf" xlink:href="pcbi.1009347.pdf"/>
    <abstract>
      <p>We construct a recursive Bayesian smoother, termed EpiFilter, for estimating the effective reproduction number, R, from the incidence of an infectious disease in real time and retrospectively. Our approach borrows from Kalman filtering theory, is quick and easy to compute, generalisable, deterministic and unlike many current methods, requires no change-point or window size assumptions. We model R as a flexible, hidden Markov state process and exactly solve forward-backward algorithms, to derive R estimates that incorporate all available incidence information. This unifies and extends two popular methods, EpiEstim, which considers past incidence, and the Wallinga-Teunis method, which looks forward in time. We find that this combination of maximising information and minimising assumptions significantly reduces the bias and variance of R estimates. Moreover, these properties make EpiFilter more statistically robust in periods of low incidence, where several existing methods can become destabilised. As a result, EpiFilter offers improved inference of time-varying transmission patterns that are advantageous for assessing the risk of upcoming waves of infection or the influence of interventions, in real time and at various spatial scales.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Inferring changes in the transmissibility of an infectious disease is crucial for understanding and controlling epidemic spread. The effective reproduction number, R, is widely used to assess transmissibility. R measures the average number of secondary cases caused by a primary case and has provided insight into many diseases including COVID-19. An upsurge in R can forewarn of upcoming infections, while suppression of R can indicate if public health interventions are working. Reliable estimates of temporal changes in R can contribute important evidence to policymaking. Popular R-inference methods, while powerful, can struggle when cases are few because data are noisy. This can limit detection of crucial variations in transmissibility that may occur, for example, when infections are waning or when analysing transmissibility over fine geographic scales. In this paper we improve the general reliability of R-estimates and specifically increase robustness when cases are few. By adapting principles from control engineering, we formulate EpiFilter, a novel method for inferring R in real time and retrospectively. EpiFilter can potentially double the information extracted from epidemic time-series (when compared to popular approaches), significantly filtering the noise within data, to minimise both bias and uncertainty of R-estimates and enhance the detection of salient change-points in transmissibility.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000265</institution-id>
            <institution>Medical Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MR/R015600/1</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7806-3605</contrib-id>
          <name>
            <surname>Parag</surname>
            <given-names>Kris V.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work is jointly funded to KVP under grant reference MR/R015600/1 by the UK Medical Research Council (MRC) and the UK Department for International Development (DFID) under the MRC/DFID Concordat agreement and is also part of the EDCTP2 programme supported by the European Union. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="7"/>
      <table-count count="0"/>
      <page-count count="23"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-09-17</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All data and code for EpiFilter available at: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/kpzoo/EpiFilter" ext-link-type="uri">https://github.com/kpzoo/EpiFilter</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All data and code for EpiFilter available at: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/kpzoo/EpiFilter" ext-link-type="uri">https://github.com/kpzoo/EpiFilter</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>During an unfolding epidemic, one of the most commonly available and useful types of surveillance data is the daily (or weekly) number of newly reported cases. This time-series of case counts, also known as the incidence curve, not only measures the epidemic size and burden, but also provides information about trends or changes in its transmissibility [<xref rid="pcbi.1009347.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1009347.ref002" ref-type="bibr">2</xref>]. These trends are captured by the time-varying effective or instantaneous reproduction number, denoted <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> at time <italic toggle="yes">s</italic>, which defines how the number of secondary cases generated per primary case varies across the outbreak [<xref rid="pcbi.1009347.ref003" ref-type="bibr">3</xref>]. Broadly, when <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> &gt; 1 we can expect and prepare for growing incidence, whereas sustained <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> &lt; 1 signifies that the epidemic is waning and likely to enter a more controlled phase [<xref rid="pcbi.1009347.ref004" ref-type="bibr">4</xref>].</p>
    <p>Inferring changes in <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> given an observed incidence curve is therefore crucial, both to understanding transmissibility and to forecasting upcoming case loads, especially for an ongoing epidemic, where it can help inform policymaking and intervention choices or predict healthcare demands [<xref rid="pcbi.1009347.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1009347.ref005" ref-type="bibr">5</xref>]. Real-time and retrospective <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> estimates have been used to characterise rates and patterns of spread in various diseases such as malaria [<xref rid="pcbi.1009347.ref006" ref-type="bibr">6</xref>] and Ebola virus disease [<xref rid="pcbi.1009347.ref007" ref-type="bibr">7</xref>]. Such estimates have proven valuable throughout the COVID-19 pandemic, providing updating synopses of global transmission [<xref rid="pcbi.1009347.ref008" ref-type="bibr">8</xref>] and evidencing the impact of past control actions (e.g., lockdowns and social distancing) [<xref rid="pcbi.1009347.ref009" ref-type="bibr">9</xref>] or the likelihood of a resurgence in infections when those controls are relaxed [<xref rid="pcbi.1009347.ref010" ref-type="bibr">10</xref>].</p>
    <p>Most studies that infer <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> or related quantities either apply the Wallinga-Teunis (WT) method [<xref rid="pcbi.1009347.ref002" ref-type="bibr">2</xref>] or the Cori <italic toggle="yes">et al</italic> method, known as EpiEstim [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>]. Both methods take complementary viewpoints on how incidence data inform on transmissibility and hence have diverse use-cases. The WT method reconstructs the average number of new cases caused by infectious individuals at <italic toggle="yes">s</italic> and so requires incidence data beyond time <italic toggle="yes">s</italic> for its estimate. It computes the case or cohort reproduction number, <inline-formula id="pcbi.1009347.e001"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e001.jpg" id="pcbi.1009347.e001g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" display="inline" overflow="scroll"><mml:msubsup><mml:mi>R</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, which is a function of <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic>+<italic toggle="yes">j</italic></sub> for future times <italic toggle="yes">j</italic> ≥ 0, and is suited for retrospective analyses [<xref rid="pcbi.1009347.ref012" ref-type="bibr">12</xref>]. Alternatively, EpiEstim infers how past infections propagate to form the incidence observed at <italic toggle="yes">s</italic>, only requiring data prior to time <italic toggle="yes">s</italic>. EpiEstim directly computes instantaneous reproduction numbers, <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, and is preferred for real-time investigations [<xref rid="pcbi.1009347.ref003" ref-type="bibr">3</xref>].</p>
    <p>While both methods provide useful and important estimators of transmission, they are not perfect. Two main limitations exist. First, each suffers from data censoring or edge-effects [<xref rid="pcbi.1009347.ref003" ref-type="bibr">3</xref>]. Because the WT method is forward-looking i.e., depends on data later than <italic toggle="yes">s</italic>, its estimates are right censored when <italic toggle="yes">s</italic> is close to the last observed time point [<xref rid="pcbi.1009347.ref012" ref-type="bibr">12</xref>]. In contrast, EpiEstim looks backward in time and suffers edge-effects when <italic toggle="yes">s</italic> is near the first observed time point [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>]. Estimates in the vicinity of the start and end of the incidence time-series are therefore unreliable under EpiEstim and the WT method, respectively. Techniques have been proposed to limit this unreliability [<xref rid="pcbi.1009347.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>], but the problem is intrinsic, and inevitable near the actual start and end times of an epidemic, where there is necessarily no or sparse data.</p>
    <p>This leads into the second key limitation: inference in periods of small incidence. This presents a fundamental challenge for any <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> estimation approach and effectively creates additional edge-effects. When few or no case counts are available to constrain inference, methods are largely driven by their inherent prior distributions and assumptions. This can result in misleading or unreliable estimates and mask subcritical (i.e., <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> &lt; 1) transmission patterns [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1009347.ref015" ref-type="bibr">15</xref>]. Small incidence may occur during sustained periods of interventions, when pathogens invade new susceptible regions and also naturally arise by division when analyses are performed at smaller spatial scales (e.g., regional or community levels). Understanding how to best mediate the trade-off between prior assumptions and data when incidence is small is of both statistical and epidemiological significance.</p>
    <p>Following a period of low incidence, two important outcomes are possible: either the epidemic continues to exhibit small or zero case counts until it goes extinct, or a resurgence in infections, also termed a second wave, occurs. Inferring, in real time, which of these conditions is likely presents a key challenge for infectious disease epidemiology given the information bottleneck at low incidence [<xref rid="pcbi.1009347.ref016" ref-type="bibr">16</xref>]. Better inference of transmission under these conditions is currently considered central to designing data-informed COVID-19 intervention exit or relaxation strategies [<xref rid="pcbi.1009347.ref017" ref-type="bibr">17</xref>]. With many countries facing multiple resurgent waves in this pandemic, estimating fluctuations in transmission during suspected epidemic troughs could be essential to achieving sustained control [<xref rid="pcbi.1009347.ref010" ref-type="bibr">10</xref>].</p>
    <p>Here we present and develop a novel method, termed EpiFilter, for reliably estimating <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> in real time, which ameliorates the above limitations. We take an engineering inspired approach and construct an exact, recursive and deterministic (i.e., EpiFilter produces the same output for fixed input data and requires no Monte Carlo steps) inference algorithm that is quick and easy to compute both across an unfolding outbreak and in retrospect. Our method solves what is called the smoothing problem in control engineering [<xref rid="pcbi.1009347.ref014" ref-type="bibr">14</xref>]. This means we compute instantaneous reproduction number, <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, estimates that formally integrate both forward and backward looking information. This unifies the WT method and EpiEstim, and largely nullifies their edge-effect issues.</p>
    <p>Further, EpiFilter only makes a minimal Markov assumption for <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, which allows it to avoid the strong prior window size and change-point assumptions that existing methods may apply to infer shifts in transmission [<xref rid="pcbi.1009347.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>]. Using simulated and empirical data, we demonstrate that EpiFilter accurately tracks changes in <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> and provides reliable one-step-ahead incidence predictions. Moreover, we show that EpiFilter is appreciably more robust and statistically efficient than even optimised versions of EpiEstim [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>]. We find that EpiFilter does not easily destabilise when performing real-time inference in periods of low incidence, such as in lulls between epidemic waves, and that generally (i.e., for outbreaks of any size) it minimises the mean squared error (MSE) of <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> estimates, while maintaining good coverage and predictive performance.</p>
    <p>We illustrate the practical utility of EpiFilter on the COVID-19 incidence curve of New Zealand, which exhibits a second wave that was seeded during a prolonged low incidence period. We find stark improvements in the transmission patterns EpiFilter uncovers. Our method, which is outlined in <xref rid="pcbi.1009347.g001" ref-type="fig">Fig 1</xref>, provides a straightforward yet formally optimal (in mean squared error sense [<xref rid="pcbi.1009347.ref018" ref-type="bibr">18</xref>]) solution to real-time and retrospective instantaneous reproduction number estimation. Because it couples minimal prior assumptions with maximum information extraction, it more gracefully handles periods with scarce data. Hopefully our approach will serve as a useful inference tool for investigating the transmissibility risks of COVID-19 and other epidemics. Matlab and R implementations of EpiFilter are available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/kpzoo/EpiFilter" ext-link-type="uri">https://github.com/kpzoo/EpiFilter</ext-link> and its mechanics are explored and validated in the <xref rid="pcbi.1009347.s001" ref-type="supplementary-material">S1 Appendix</xref>.</p>
    <fig position="float" id="pcbi.1009347.g001">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1009347.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>EpiFilter algorithm and relationship to other methods.</title>
        <p>In the left panels we consider three ways of inferring the instantaneous or effective reproduction number at time <italic toggle="yes">s</italic>, <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, from the incidence curve, <inline-formula id="pcbi.1009347.e002"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e002" id="pcbi.1009347.e002g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> (blue dots). The filtering solution produces the posterior distribution <bold>p</bold><sub><bold>s</bold></sub> from all data prior to time <italic toggle="yes">s</italic>. EpiEstim approximates this solution by using the subset of data in a window of size <italic toggle="yes">k</italic> into the past. Reverse-filtering considers the complementary part of the incidence curve, leading to <bold>r</bold><sub><bold>s</bold></sub>, which utilises data beyond <italic toggle="yes">s</italic>. The WT method, with future window <italic toggle="yes">k</italic>, approximates this type of solution. Smoothing uses all information from <inline-formula id="pcbi.1009347.e003"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e003" id="pcbi.1009347.e003g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> to generate <bold>q</bold><sub><bold>s</bold></sub>, which is precisely computed by EpiFilter. Blue windows show the portions of <inline-formula id="pcbi.1009347.e004"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e004" id="pcbi.1009347.e004g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> that inform on <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> for each of <bold>p</bold><sub><bold>s</bold></sub>, <bold>r</bold><sub><bold>s</bold></sub> and <bold>q</bold><sub><bold>s</bold></sub> while red windows highlight the subsets used by EpiEstim and the WT method. Double arrows indicate data used for constructing various posterior distributions, while square arrows pinpoint instances of those distributions at the edges of <inline-formula id="pcbi.1009347.e005"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e005" id="pcbi.1009347.e005g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. In the right panels we summarise the construction of EpiFilter. We outline the main assumptions (the model box) and computations (the algorithm box) necessary for realising EpiFilter, which allow us to obtain the most informative and minimum mean squared error (MSE) smoothing posterior distribution <bold>q</bold><sub><bold>s</bold></sub>. See the main text for the specific equations employed in our implementation [<xref rid="pcbi.1009347.ref014" ref-type="bibr">14</xref>].</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.g001" position="float"/>
    </fig>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <sec id="sec003">
      <title>Renewal models and inference problems</title>
      <p>We consider an infectious disease epidemic observed over some time period 1 ≤ <italic toggle="yes">s</italic> ≤ <italic toggle="yes">t</italic> in a homogeneous and well-mixed population. While epidemics actually spread on dynamic networks involving stratified contact structures, homogeneous models can provide useful real-time insight into key transmission patterns and are more easily fit and verified with routine surveillance data such as incidence curves [<xref rid="pcbi.1009347.ref019" ref-type="bibr">19</xref>]. If the incidence or number of newly infected cases at time <italic toggle="yes">s</italic> is <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> then the set <inline-formula id="pcbi.1009347.e006"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e006.jpg" id="pcbi.1009347.e006g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mo>…</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the incidence curve of the epidemic. We assume that incidence is available on a daily scale so that <inline-formula id="pcbi.1009347.e007"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e007.jpg" id="pcbi.1009347.e007g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is a vector of <italic toggle="yes">t</italic> daily counts but weeks or months could be used instead. A common problem in infectious disease is the inference of the transmissibility of the epidemic given this curve. The renewal model [<xref rid="pcbi.1009347.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1009347.ref020" ref-type="bibr">20</xref>] presents a general and popular framework for investigating this problem and its estimates, in some instances, can even approximate those from detailed network models [<xref rid="pcbi.1009347.ref021" ref-type="bibr">21</xref>].</p>
      <p>The renewal model posits that epidemic transmissibility, summarised by the effective or instantaneous reproduction number, <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, generates the observed incidence as in <xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref>. We assume incidence counts are Poisson distributed with Pois indicating Poisson noise. Here <inline-formula id="pcbi.1009347.e008"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e008.jpg" id="pcbi.1009347.e008g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> signifies equality in distributions and | means ‘conditioned on’.
<disp-formula id="pcbi.1009347.e009"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e009.jpg" id="pcbi.1009347.e009g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mover><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mover><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mtext>Pois</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>While <xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref> does not directly model how susceptible individuals become infected, these effects are encoded in the reproduction number <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, which measures the secondary cases generated per effective primary case at <italic toggle="yes">s</italic> [<xref rid="pcbi.1009347.ref003" ref-type="bibr">3</xref>]. The quantity <inline-formula id="pcbi.1009347.e010"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e010.jpg" id="pcbi.1009347.e010g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo>Λ</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mo>≔</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, known as the total infectiousness, counts how many effective past cases are still infectious at <italic toggle="yes">s</italic> i.e., it describes the number of circulating cases that can actively transmit.</p>
      <p>The generation time distribution of the epidemic, <inline-formula id="pcbi.1009347.e011"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e011.jpg" id="pcbi.1009347.e011g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mo>…</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, controls how past incidence influences Λ<sub><italic toggle="yes">s</italic></sub>, with <italic toggle="yes">w</italic><sub><italic toggle="yes">u</italic></sub> as the probability that a primary case takes between <italic toggle="yes">u</italic> − 1 and <italic toggle="yes">u</italic> days to generate a secondary case [<xref rid="pcbi.1009347.ref001" ref-type="bibr">1</xref>]. We make the standard assumption that <inline-formula id="pcbi.1009347.e012"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e012.jpg" id="pcbi.1009347.e012g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" display="inline" overflow="scroll"><mml:msubsup><mml:mi>w</mml:mi><mml:mn>1</mml:mn><mml:mi>∞</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is well approximated by the serial interval distribution of the epidemic of interest, which is known [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>]. The serial interval is the time between symptom onset of a primary and its secondary case. While onset times are more practically measurable than actual infection times they do not include asymptomatic or subclinical cases. This approximation can limit inference (for example, serial intervals often have larger variances than generation times), but methods are being developed to improve its quality [<xref rid="pcbi.1009347.ref022" ref-type="bibr">22</xref>].</p>
      <p>We focus on inferring the complete set of <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> values, denoted <inline-formula id="pcbi.1009347.e013"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e013.jpg" id="pcbi.1009347.e013g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mo>…</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, given the incidence curve <inline-formula id="pcbi.1009347.e014"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e014.jpg" id="pcbi.1009347.e014g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> with <italic toggle="yes">t</italic> as the last recorded time. Estimating <inline-formula id="pcbi.1009347.e015"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e015.jpg" id="pcbi.1009347.e015g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" display="inline" overflow="scroll"><mml:msubsup><mml:mi>R</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is important because changes in the values of instantaneous reproduction numbers often signify key transitions in epidemic transmissibility, which might be due to the imposition or relaxation of interventions. Instantaneous reproduction numbers are also the basis of other transmissibility metrics, such as cohort reproduction numbers or growth rates [<xref rid="pcbi.1009347.ref003" ref-type="bibr">3</xref>]. We define three main inference problems, based on how information in <inline-formula id="pcbi.1009347.e016"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e016.jpg" id="pcbi.1009347.e016g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is recruited to construct every <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> estimate. We represent these problems in terms of the posterior distribution their solutions induce over possible <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> values. Estimates are functions of these posteriors.</p>
      <p>The first is called filtering, where we sequentially compute the filtering posterior <inline-formula id="pcbi.1009347.e017"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e017.jpg" id="pcbi.1009347.e017g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for every <italic toggle="yes">s</italic> ≤ <italic toggle="yes">t</italic> [<xref rid="pcbi.1009347.ref023" ref-type="bibr">23</xref>]. Filtering only uses incidence data up to time <italic toggle="yes">s</italic>, <inline-formula id="pcbi.1009347.e018"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e018.jpg" id="pcbi.1009347.e018g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, for inferring <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>. Solving this problem is fundamental to real-time inference [<xref rid="pcbi.1009347.ref024" ref-type="bibr">24</xref>]. Filtering solutions are commonly employed for inferring instantaneous reproduction numbers. The second problem, which we call reverse-filtering, is the complement of the first. The reverse-filtering posterior <inline-formula id="pcbi.1009347.e019"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e019.jpg" id="pcbi.1009347.e019g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, is important for retrospective or backward-looking estimates and infers <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> from incidence beyond <italic toggle="yes">s</italic> i.e., <inline-formula id="pcbi.1009347.e020"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e020.jpg" id="pcbi.1009347.e020g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> [<xref rid="pcbi.1009347.ref025" ref-type="bibr">25</xref>]. Practical <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> calculations do not involve reverse-filtering. Instead, the information used by <bold>r</bold><sub><bold>s</bold></sub> is implicit to deriving cohort reproduction numbers, <inline-formula id="pcbi.1009347.e021"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e021.jpg" id="pcbi.1009347.e021g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> [<xref rid="pcbi.1009347.ref012" ref-type="bibr">12</xref>]. Later we show that estimates from EpiEstim and the WT method are related to the <bold>p</bold><sub><bold>s</bold></sub> and <bold>r</bold><sub><bold>s</bold></sub> distributions, respectively.</p>
      <p>The last problem, which is termed smoothing, is our main interest. It asks the question: how can we construct an <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, at every <italic toggle="yes">s</italic> ≤ <italic toggle="yes">t</italic>, that integrates all available incidence information from <inline-formula id="pcbi.1009347.e022"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e022.jpg" id="pcbi.1009347.e022g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. To solve this problem we must formulate the smoothing posterior distribution <inline-formula id="pcbi.1009347.e023"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e023.jpg" id="pcbi.1009347.e023g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">q</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> [<xref rid="pcbi.1009347.ref014" ref-type="bibr">14</xref>]. Functions of this posterior would then yield maximally informed instantaneous reproduction number estimates (and cohort reproduction number estimates by extension). Note that <bold>p</bold><sub><bold>s</bold></sub>, <bold>r</bold><sub><bold>s</bold></sub> and <bold>q</bold><sub><bold>s</bold></sub> depend on the choices of state space model, which describes the dynamics of <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> across time, and observation model, which explains how changes in <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> lead to trends in observed incidence data [<xref rid="pcbi.1009347.ref018" ref-type="bibr">18</xref>]. These models encode our assumptions about the epidemic of interest and determine how estimates trade off assumptions against data. We next explore how posterior distribution selection determines performance, especially when data are scarce, and examine how EpiEstim and the WT methods fit within this framework.</p>
    </sec>
    <sec id="sec004">
      <title>Inference methods and low incidence</title>
      <p>We mostly detail EpiEstim as instantaneous reproduction number, <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, estimates are the main focus of this work. EpiEstim assumes that the estimate of <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> at time <italic toggle="yes">s</italic> depends on a rolling past window of data, <italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>) = {<italic toggle="yes">s</italic>, <italic toggle="yes">s</italic> − 1, …, <italic toggle="yes">s</italic> − <italic toggle="yes">k</italic> + 1}, of size <italic toggle="yes">k</italic> [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>]. Consequently, at time <italic toggle="yes">s</italic>, only size <italic toggle="yes">k</italic> subsets of the incidence, <inline-formula id="pcbi.1009347.e024"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e024.jpg" id="pcbi.1009347.e024g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, and total infectiousness, <inline-formula id="pcbi.1009347.e025"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e025.jpg" id="pcbi.1009347.e025g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>Λ</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>Λ</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mo>…</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, are considered informative about <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>. Their sums over this window are <italic toggle="yes">i</italic><sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub> = ∑<sub><italic toggle="yes">u</italic>∈<italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub>
<italic toggle="yes">I</italic><sub><italic toggle="yes">u</italic></sub> and λ<sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub> = ∑<sub><italic toggle="yes">u</italic>∈<italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub> Λ<sub><italic toggle="yes">u</italic></sub>. When <italic toggle="yes">k</italic> = 1, EpiEstim only uses the most recent case count, <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub>, (and Λ<sub><italic toggle="yes">s</italic></sub>) to estimate <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>. While this maximises flexibility, it usually results in over-fitting and so larger windows are often employed to trade off estimate variance with bias [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1009347.ref026" ref-type="bibr">26</xref>].</p>
      <p>EpiEstim therefore effectively solves a filtering problem, as discussed in the previous section. The filtering posterior distribution produced by EpiEstim is restricted to the informative window <italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>) and denoted <inline-formula id="pcbi.1009347.e026"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e026.jpg" id="pcbi.1009347.e026g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. This is parametrised by the shape-scale gamma posterior distribution in <xref rid="pcbi.1009347.e027" ref-type="disp-formula">Eq (2)</xref>.
<disp-formula id="pcbi.1009347.e027"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e027.jpg" id="pcbi.1009347.e027g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mover><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mover><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mtext>Gam</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula></p>
      <p>The posterior <bold>p</bold><sub><bold><italic toggle="yes">τ</italic></bold>(<bold>s</bold>)</sub> results from combining a gamma prior distribution on <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, <inline-formula id="pcbi.1009347.e028"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e028.jpg" id="pcbi.1009347.e028g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mover><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mover><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mtext>Gam</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, with a Poisson observation likelihood for the incidence (see <xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref>), as detailed in [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>]. We never explicitly include Λ<sub><italic toggle="yes">s</italic></sub> terms in our notation (e.g., we could write <bold>p</bold><sub><bold><italic toggle="yes">τ</italic></bold>(<bold>s</bold>)</sub> as <inline-formula id="pcbi.1009347.e029"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e029.jpg" id="pcbi.1009347.e029g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mo>Λ</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>) since they appear naturally when using <xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref> and the key difference among our inference problems relate to <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> terms.</p>
      <p>The posterior mean estimate from <xref rid="pcbi.1009347.e027" ref-type="disp-formula">Eq (2)</xref> is constructed as <inline-formula id="pcbi.1009347.e030"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e030.jpg" id="pcbi.1009347.e030g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mtext>d</mml:mtext><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1009347.e124"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e124.jpg" id="pcbi.1009347.e124g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M124" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. The variance around this estimate is (<italic toggle="yes">a</italic> + <italic toggle="yes">i</italic><sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub>)(<italic toggle="yes">c</italic> + λ<sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub>)<sup>−2</sup>. The observation model is given by <xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref> but the state space model of EpiEstim is not explicit. However, if <italic toggle="yes">R</italic><sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub> is the assumed average reproduction number in <italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>) (which is used to estimate <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>) then λ<sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub>
<italic toggle="yes">R</italic><sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub> = ∑<sub><italic toggle="yes">u</italic>∈<italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub> Λ<sub><italic toggle="yes">u</italic></sub>
<italic toggle="yes">R</italic><sub><italic toggle="yes">u</italic></sub> [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>]. Thus, EpiEstim somewhat incorporates a linear moving average state space model, and assumes that the filtering distribution <bold>p</bold><sub><bold>s</bold></sub> ≈ <bold>p</bold><sub><bold><italic toggle="yes">τ</italic></bold>(<bold>s</bold>)</sub> by deeming data outside <italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>), <inline-formula id="pcbi.1009347.e031"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e031.jpg" id="pcbi.1009347.e031g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, as effectively uninformative [<xref rid="pcbi.1009347.ref012" ref-type="bibr">12</xref>]. Since <bold>p</bold><sub><bold><italic toggle="yes">τ</italic></bold>(<bold>s</bold>)</sub> can be computed sequentially across an ongoing epidemic, EpiEstim provides real-time inference.</p>
      <p>The WT method takes a complementary approach to EpiEstim, computing transmissibility over a forward-looking window <italic toggle="yes">γ</italic>(<italic toggle="yes">s</italic>) = {<italic toggle="yes">s</italic>, <italic toggle="yes">s</italic> + 1, …, <italic toggle="yes">s</italic> + <italic toggle="yes">k</italic> − 1} [<xref rid="pcbi.1009347.ref002" ref-type="bibr">2</xref>]. Often <italic toggle="yes">k</italic> = <italic toggle="yes">t</italic> − <italic toggle="yes">s</italic> + 1 i.e., the window extends to the last observed incidence. The WT method uses the observation model of <xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref> and has an implicit moving average state model <italic toggle="yes">R</italic><sub><italic toggle="yes">γ</italic>(<italic toggle="yes">s</italic>)</sub> = ∑<sub><italic toggle="yes">u</italic>∈<italic toggle="yes">γ</italic>(<italic toggle="yes">s</italic>)</sub>
<italic toggle="yes">R</italic><sub><italic toggle="yes">u</italic></sub>
<italic toggle="yes">w</italic><sub><italic toggle="yes">u</italic>−<italic toggle="yes">s</italic>+1</sub>, which leads to its cohort reproduction number estimates [<xref rid="pcbi.1009347.ref003" ref-type="bibr">3</xref>]. As this method effectively uses future information [<xref rid="pcbi.1009347.ref012" ref-type="bibr">12</xref>], it implicitly involves approximating the reverse-filtering distribution (see previous section) as <inline-formula id="pcbi.1009347.e032"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e032.jpg" id="pcbi.1009347.e032g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We illustrate the information windows employed by the WT method and EpiEstim, as well as the complete filtering and reverse-filtering windows in <xref rid="pcbi.1009347.g001" ref-type="fig">Fig 1</xref>. The goodness of the windowed distributions <bold>p</bold><sub><bold><italic toggle="yes">τ</italic></bold>(<bold>s</bold>)</sub> and <bold>r</bold><sub><bold>γ</bold>(<bold>s</bold>)</sub> as approximations to the general posterior distributions <bold>p</bold><sub><bold>s</bold></sub> and <bold>r</bold><sub><bold>s</bold></sub> will depend on <italic toggle="yes">k</italic> and the appropriateness of the state model underlying each method [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>].</p>
      <p>While EpiEstim and the WT methods are powerful tools for inferring transmissibility in real-time and in retrospect, they have two main and related limitations, which necessarily reduce the reliability of their outputs [<xref rid="pcbi.1009347.ref012" ref-type="bibr">12</xref>]. First, their performance degrades as <italic toggle="yes">s</italic> gets close to 1 for EpiEstim and <italic toggle="yes">t</italic> for the WT method [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>]. These edge or censoring effects correspond, at the extreme, to <inline-formula id="pcbi.1009347.e033"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e033.jpg" id="pcbi.1009347.e033g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mn mathvariant="bold">1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009347.e034"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e034.jpg" id="pcbi.1009347.e034g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mi>γ</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>I</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which are weakly informed posterior distributions. As a result, at the beginning of the incidence curve EpiEstim can be unreliable (and even unidentifiable). The WT method suffers similarly at the end of that curve [<xref rid="pcbi.1009347.ref001" ref-type="bibr">1</xref>] (see <xref rid="pcbi.1009347.g001" ref-type="fig">Fig 1</xref>).</p>
      <p>The second limitation occurs in phases of the epidemic where incidence is low for a prolonged period of time [<xref rid="pcbi.1009347.ref017" ref-type="bibr">17</xref>, <xref rid="pcbi.1009347.ref026" ref-type="bibr">26</xref>]. In these periods data are sparse and the quality of estimates depend on how well the method of choice mediates between the little available information and its inherent assumptions [<xref rid="pcbi.1009347.ref015" ref-type="bibr">15</xref>]. We illustrate this with EpiEstim, using the mean and variance of the posterior estimate from <xref rid="pcbi.1009347.e027" ref-type="disp-formula">Eq (2)</xref>, <inline-formula id="pcbi.1009347.e035"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e035.jpg" id="pcbi.1009347.e035g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, which are defined above. If incidence is small over the window <italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>) then the sum of incidence, <italic toggle="yes">i</italic><sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub>, and the total infectiousness λ<sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub> shrink, meaning that the prior hyperparameters, <italic toggle="yes">a</italic> and <italic toggle="yes">c</italic>, strongly influence the resulting estimate mean and variance. This contrasts the data-rich scenario when an epidemic is large, where <italic toggle="yes">i</italic><sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub> and λ<sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub> overpower <italic toggle="yes">a</italic> and <italic toggle="yes">c</italic>.</p>
      <p>Further, should a sequence of <italic toggle="yes">n</italic> ≥ <italic toggle="yes">k</italic> zero-incidence days occur, then <italic toggle="yes">i</italic><sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub> = 0 and λ<sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub> → 0 as <italic toggle="yes">n</italic> increases, with a rate controlled by the serial interval of the epidemic. Here the shape parameter of <bold>p</bold><sub><bold><italic toggle="yes">τ</italic></bold>(<bold>s</bold>)</sub> is exactly that of the prior distribution <inline-formula id="pcbi.1009347.e036"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e036.jpg" id="pcbi.1009347.e036g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. As λ<sub><italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>)</sub> decays, <inline-formula id="pcbi.1009347.e037"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e037.jpg" id="pcbi.1009347.e037g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (see <xref rid="pcbi.1009347.e027" ref-type="disp-formula">Eq (2)</xref>), <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> becomes statistically unidentifiable from the window of data and inference is completely prior driven [<xref rid="pcbi.1009347.ref026" ref-type="bibr">26</xref>, <xref rid="pcbi.1009347.ref027" ref-type="bibr">27</xref>]. While lack of data is a fundamental limitation, the point at which we lose inferential power is not fixed, and depends on the window size, <italic toggle="yes">k</italic>. Studies that formally optimised <italic toggle="yes">k</italic> for estimate reliability, found that small <italic toggle="yes">k</italic> is needed to infer sharp changes in transmissibility (e.g., due to lockdowns) [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>], indicating that these issues can be acute. Analogous effects occur in the WT method if there are few incident cases across its forward-looking window <italic toggle="yes">γ</italic>(<italic toggle="yes">s</italic>) [<xref rid="pcbi.1009347.ref012" ref-type="bibr">12</xref>].</p>
      <p>These prior-driven scenarios are realistic for epidemics in waning or tail phases, and can precede either elimination (i.e., epidemic extinction) or resurgence [<xref rid="pcbi.1009347.ref028" ref-type="bibr">28</xref>]. While some estimate degradation is guaranteed for any <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> inference method when faced with either edge-effects or low incidence, robustness can still be improved. Edge-effects can be largely overcome by constructing the smoothed posterior distribution for estimating the instantaneous reproduction number <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, denoted <bold>q</bold><sub><bold>s</bold></sub>. Solving the smoothing problem melds the advantages of the opposite looking windows of EpiEstim and the WT method, removing the vulnerability near the ends of the incidence curve <inline-formula id="pcbi.1009347.e038"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e038.jpg" id="pcbi.1009347.e038g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. This follows as <bold>q</bold><sub><bold>1</bold></sub> = <bold>r</bold><sub><bold>1</bold></sub> and <bold>q</bold><sub><bold>t</bold></sub> = <bold>p</bold><sub><bold>t</bold></sub> (see <xref rid="pcbi.1009347.g001" ref-type="fig">Fig 1</xref>). Further, by maximising the information used for inferring every <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> and by minimising our state model assumptions, we can ameliorate the impact of low incidence. We next develop a method, termed EpiFilter, to realise these improvements.</p>
    </sec>
    <sec id="sec005">
      <title>Bayesian (forward) recursive filtering</title>
      <p>We reformulate the inference problem of estimating instantaneous reproduction numbers <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> from past incidence <inline-formula id="pcbi.1009347.e039"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e039.jpg" id="pcbi.1009347.e039g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> as an optimal Markov state filtering problem. Filtering describes a general class of engineering problems aimed at optimally, usually in a MSE sense, inferring some hidden state in real time from noisy observations [<xref rid="pcbi.1009347.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1009347.ref018" ref-type="bibr">18</xref>]. Given some functions <italic toggle="yes">f</italic><sub><italic toggle="yes">s</italic></sub> and <italic toggle="yes">g</italic><sub><italic toggle="yes">s</italic></sub>, which describe the state (<italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> in our case) space dynamics and the process of generating noisy observations (the <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> here), the filtering problem tries to construct the posterior distribution <bold>p</bold><sub><bold>s</bold></sub> (see previous section) [<xref rid="pcbi.1009347.ref023" ref-type="bibr">23</xref>], which EpiEstim approximates. The conditional mean estimate <inline-formula id="pcbi.1009347.e040"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e040.jpg" id="pcbi.1009347.e040g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> leads to the minimum MSE of <inline-formula id="pcbi.1009347.e041"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e041.jpg" id="pcbi.1009347.e041g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M41" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> [<xref rid="pcbi.1009347.ref023" ref-type="bibr">23</xref>], which depends on all the past information.</p>
      <p>The famed Kalman filter [<xref rid="pcbi.1009347.ref024" ref-type="bibr">24</xref>] was the genesis of these methods. Here we focus on Bayesian recursive filters for models with noisy count observations. These generalise the Kalman filter [<xref rid="pcbi.1009347.ref023" ref-type="bibr">23</xref>] and have been successfully applied to similar problems in phylodynamics and computational biology [<xref rid="pcbi.1009347.ref029" ref-type="bibr">29</xref>–<xref rid="pcbi.1009347.ref031" ref-type="bibr">31</xref>]. We reconsider our renewal model inference problem within this engineering state-observation framework, as described in <xref rid="pcbi.1009347.e042" ref-type="disp-formula">Eq (3)</xref> [<xref rid="pcbi.1009347.ref014" ref-type="bibr">14</xref>].
<disp-formula id="pcbi.1009347.e042"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e042.jpg" id="pcbi.1009347.e042g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M42" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mspace width="8.5359pt"/><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>ν</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>Here <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> is the hidden Markov state that we wish to infer. It dynamically depends on the previous state <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic>−1</sub> and a noise term <italic toggle="yes">ϵ</italic><sub><italic toggle="yes">s</italic>−1</sub> via <italic toggle="yes">f</italic><sub><italic toggle="yes">s</italic></sub>. Observation <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> is then elicited due to <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> and a noise term <italic toggle="yes">ν</italic><sub><italic toggle="yes">s</italic></sub>, according to <italic toggle="yes">g</italic><sub><italic toggle="yes">s</italic></sub> [<xref rid="pcbi.1009347.ref032" ref-type="bibr">32</xref>].</p>
      <p>We develop our filter under two very mild assumptions. First, we define some closed space, <inline-formula id="pcbi.1009347.e043"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e043.jpg" id="pcbi.1009347.e043g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M43" display="inline" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi></mml:math></alternatives></inline-formula>, over which <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> is valid. For a given resolution <italic toggle="yes">m</italic>, extrema <italic toggle="yes">R</italic><sub>min</sub> and <italic toggle="yes">R</italic><sub>max</sub>, and grid size <italic toggle="yes">δ</italic> = <italic toggle="yes">m</italic><sup>−1</sup>(<italic toggle="yes">R</italic><sub>max</sub> − <italic toggle="yes">R</italic><sub>min</sub>) then <inline-formula id="pcbi.1009347.e044"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e044.jpg" id="pcbi.1009347.e044g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M44" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>≔</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mo form="prefix" movablelimits="true">min</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mo form="prefix" movablelimits="true">min</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. This means the instantaneous reproduction number <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> must take a discrete value in <inline-formula id="pcbi.1009347.e045"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e045.jpg" id="pcbi.1009347.e045g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M45" display="inline" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi></mml:math></alternatives></inline-formula>, the <italic toggle="yes">i</italic><sup>th</sup> element of which is denoted <inline-formula id="pcbi.1009347.e046"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e046.jpg" id="pcbi.1009347.e046g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M46" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We formalise this notion in <xref rid="pcbi.1009347.e047" ref-type="disp-formula">Eq (4a)</xref>.
<disp-formula id="pcbi.1009347.e047"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e047.jpg" id="pcbi.1009347.e047g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M47" display="block" overflow="scroll"><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>s</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives><label>(4a)</label></disp-formula>
<disp-formula id="pcbi.1009347.e048"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e048.jpg" id="pcbi.1009347.e048g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M48" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>η</mml:mi><mml:msqrt><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msqrt><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives><label>(4b)</label></disp-formula></p>
      <p>This is not restrictive since we can compute our filter for large <italic toggle="yes">m</italic> if needed and usually we are only interested in <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> on a coarse scale (e.g., policymakers may only want to know if <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> ≤ 1 or not). Other approaches, which depend on MCMC or related sampling methods (e.g., [<xref rid="pcbi.1009347.ref009" ref-type="bibr">9</xref>] and some implementations of EpiEstim), all implicitly assume some discretisation [<xref rid="pcbi.1009347.ref029" ref-type="bibr">29</xref>]. In Fig A of the <xref rid="pcbi.1009347.s001" ref-type="supplementary-material">S1 Appendix</xref> we show that convergence often occurs at small <italic toggle="yes">m</italic>.</p>
      <p>Second, we propose a linear model for <italic toggle="yes">f</italic><sub><italic toggle="yes">s</italic></sub>, as defined in <xref rid="pcbi.1009347.e048" ref-type="disp-formula">Eq (4b)</xref>. There <italic toggle="yes">ϵ</italic><sub><italic toggle="yes">s</italic>−1</sub> is a standard white noise term i.e., <inline-formula id="pcbi.1009347.e049"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e049.jpg" id="pcbi.1009347.e049g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M49" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mover><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mover><mml:mspace width="0.166667em"/><mml:mtext>Norm</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with Norm signifying a normal distribution and <italic toggle="yes">η</italic> as a free parameter. We assume that a noisy linear projection of states over consecutive time-points provides a good approximation of the state trajectory. Not only is this assumption standard in engineering [<xref rid="pcbi.1009347.ref023" ref-type="bibr">23</xref>] and epidemiology [<xref rid="pcbi.1009347.ref033" ref-type="bibr">33</xref>] but it is also more flexible than the state model inherent to EpiEstim and the WT method. We scale the noise of this projection by a fraction, <italic toggle="yes">η</italic> &lt; 1, of the magnitude of <inline-formula id="pcbi.1009347.e050"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e050.jpg" id="pcbi.1009347.e050g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M50" display="inline" overflow="scroll"><mml:msqrt><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msqrt></mml:math></alternatives></inline-formula>. This parameter controls the correlation among successive instantaneous reproduction numbers (and hence the state noise) but is set to ensure that <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> is a-priori non-negative.</p>
      <p>Our observation model, <italic toggle="yes">g</italic><sub><italic toggle="yes">s</italic></sub>, is implicit and leads to the probability law in <xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref>. As a result, both our observations and state models are discrete (see <xref rid="pcbi.1009347.g001" ref-type="fig">Fig 1</xref> for summaries). Because the state model governing <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> in <xref rid="pcbi.1009347.e048" ref-type="disp-formula">Eq (4b)</xref> is stochastic, <xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref> actually describes an over-dispersed (doubly stochastic) Poisson incidence curve. Consequently, <italic toggle="yes">η</italic>, allows us to partially model some heterogeneity in transmissibility, and may increase robustness to violations of the well-mixed assumption inherent to renewal models [<xref rid="pcbi.1009347.ref021" ref-type="bibr">21</xref>]. We can optimise our choice of <italic toggle="yes">η</italic> value by minimising the square error of the one-step-ahead predictions that result from our observation model [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>].</p>
      <p>We now define the Bayesian recursive filtering procedure, which is a main contribution of this work, and can be solved exactly, in real-time and with minimal computational effort. We adapt general recursive filtering equations from [<xref rid="pcbi.1009347.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1009347.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1009347.ref025" ref-type="bibr">25</xref>, <xref rid="pcbi.1009347.ref032" ref-type="bibr">32</xref>], which are valid for various types of observation and state models, to our renewal model inference problem. The proof of the equations we employ can be found in these works. While we solve discrete, univariate problems (our state model is one dimensional), extensions to continuous-time, multivariate problems also exist [<xref rid="pcbi.1009347.ref023" ref-type="bibr">23</xref>, <xref rid="pcbi.1009347.ref030" ref-type="bibr">30</xref>]. These recursive equations can also be approximately solved using particle filters [<xref rid="pcbi.1009347.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1009347.ref032" ref-type="bibr">32</xref>].</p>
      <p>Recursive filtering involves two steps: prediction and correction. The first, given in <xref rid="pcbi.1009347.e053" ref-type="disp-formula">Eq (5a)</xref>, constructs a sequential prior predictive distribution, <inline-formula id="pcbi.1009347.e051"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e051.jpg" id="pcbi.1009347.e051g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. This is informed by past incidence data <inline-formula id="pcbi.1009347.e052"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e052.jpg" id="pcbi.1009347.e052g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M52" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and the last state <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic>−1</sub>. The second step then corrects or updates this prior prediction into a posterior filtering distribution, <bold>p</bold><sub><bold>s</bold></sub>, which constrains <italic toggle="yes">p</italic><sub><italic toggle="yes">s</italic></sub> using the latest observation, <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub>, according to <xref rid="pcbi.1009347.e054" ref-type="disp-formula">Eq (5b)</xref>.
<disp-formula id="pcbi.1009347.e053"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e053.jpg" id="pcbi.1009347.e053g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M53" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>p</mml:mi></mml:mstyle><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>s</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:msub><mml:mtext>d</mml:mtext><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives><label>(5a)</label></disp-formula>
<disp-formula id="pcbi.1009347.e054"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e054.jpg" id="pcbi.1009347.e054g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M54" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>p</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>s</mml:mi></mml:mstyle></mml:msub><mml:mo>∝</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></alternatives><label>(5b)</label></disp-formula></p>
      <p>Here <inline-formula id="pcbi.1009347.e055"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e055.jpg" id="pcbi.1009347.e055g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M55" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mover><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mover><mml:mspace width="0.166667em"/><mml:mtext>Norm</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the state model from <xref rid="pcbi.1009347.e048" ref-type="disp-formula">Eq (4b)</xref>, <inline-formula id="pcbi.1009347.e056"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e056.jpg" id="pcbi.1009347.e056g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M56" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the observation model from <xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref> and the constant of proportionality for <xref rid="pcbi.1009347.e054" ref-type="disp-formula">Eq (5b)</xref> is simply a normalising factor.</p>
      <p>Solving <xref rid="pcbi.1009347.e053" ref-type="disp-formula">Eq (5)</xref> iteratively and simultaneously over the grid of <inline-formula id="pcbi.1009347.e057"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e057.jpg" id="pcbi.1009347.e057g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M57" display="inline" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi></mml:math></alternatives></inline-formula> leads to our novel real-time estimate of the time-varying effective reproduction number. We initialise this process with a uniform prior distribution over <inline-formula id="pcbi.1009347.e058"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e058.jpg" id="pcbi.1009347.e058g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M58" display="inline" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi></mml:math></alternatives></inline-formula> for <bold>p</bold><sub><bold>1</bold></sub> and note that <italic toggle="yes">p</italic><sub><italic toggle="yes">s</italic></sub> and <bold>p</bold><sub><bold>s</bold></sub> are <italic toggle="yes">m</italic> element vectors that sum to 1, with <italic toggle="yes">i</italic><sup>th</sup> term corresponding to when <inline-formula id="pcbi.1009347.e059"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e059.jpg" id="pcbi.1009347.e059g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M59" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. <xref rid="pcbi.1009347.e053" ref-type="disp-formula">Eq (5)</xref> forms the first half of EpiFilter, is flexible and can be adapted to many related problems [<xref rid="pcbi.1009347.ref014" ref-type="bibr">14</xref>]. A key difference between EpiFilter and the EpiEstim-type methods [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>] is that the latter approximate the distributions <inline-formula id="pcbi.1009347.e060"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e060.jpg" id="pcbi.1009347.e060g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M60" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009347.e061"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e061.jpg" id="pcbi.1009347.e061g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M61" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> with <inline-formula id="pcbi.1009347.e062"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e062.jpg" id="pcbi.1009347.e062g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M62" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009347.e063"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e063.jpg" id="pcbi.1009347.e063g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M63" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, respectively. Estimators based on these approximations can be suboptimal, especially when data (i.e., cases) are scarce.</p>
    </sec>
    <sec id="sec006">
      <title>Bayesian (backward) recursive smoothing</title>
      <p>While <xref rid="pcbi.1009347.e053" ref-type="disp-formula">Eq (5)</xref> provides a complete real-time solution to the filtering problem, it is necessarily limited at the starting edge of the incidence curve, where past data are sparse or unavailable. Further, because it does not update past estimates as new data accumulate, it cannot provide optimal retrospective estimates. Here we develop the second half of EpiFilter, which involves solving the optimal smoothing problem i.e., computing the smoothing posterior distribution <inline-formula id="pcbi.1009347.e064"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e064.jpg" id="pcbi.1009347.e064g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M64" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">q</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which provides maximally informed estimates of the instantaneous reproduction number <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, given the complete incidence curve <inline-formula id="pcbi.1009347.e065"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e065.jpg" id="pcbi.1009347.e065g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M65" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. To our knowledge, smoothing has not yet been explicitly considered in infectious disease epidemiology (either exactly or approximately).</p>
      <p>We specialise the general methodology from [<xref rid="pcbi.1009347.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1009347.ref025" ref-type="bibr">25</xref>] to obtain the recursive smoother of <xref rid="pcbi.1009347.e069" ref-type="disp-formula">Eq (6a)</xref>. This equation uses the filtering distribution, <inline-formula id="pcbi.1009347.e066"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e066.jpg" id="pcbi.1009347.e066g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M66" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the predictive distributions <inline-formula id="pcbi.1009347.e067"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e067.jpg" id="pcbi.1009347.e067g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M67" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which we obtain from <xref rid="pcbi.1009347.e053" ref-type="disp-formula">Eq (5)</xref>. Our state model means that <inline-formula id="pcbi.1009347.e068"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e068.jpg" id="pcbi.1009347.e068g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M68" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mover><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mover><mml:mspace width="0.166667em"/><mml:mtext>Norm</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
<disp-formula id="pcbi.1009347.e069"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e069.jpg" id="pcbi.1009347.e069g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M69" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>q</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>s</mml:mi></mml:mstyle></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>p</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>s</mml:mi></mml:mstyle></mml:msub><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>q</mml:mi></mml:mstyle><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>s</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:msub><mml:mspace width="4pt"/><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mtext>d</mml:mtext><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives><label>(6a)</label></disp-formula>
<disp-formula id="pcbi.1009347.e070"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e070.jpg" id="pcbi.1009347.e070g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M70" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>q</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>s</mml:mi></mml:mstyle></mml:msub><mml:mo>∝</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>s</mml:mi></mml:mstyle></mml:msub><mml:mspace width="4pt"/><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>p</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>s</mml:mi></mml:mstyle></mml:msub><mml:mtext mathvariant="double-struck">P</mml:mtext><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>s</mml:mi></mml:mstyle></mml:msub><mml:mo>≈</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives><label>(6b)</label></disp-formula></p>
      <p>We realise <xref rid="pcbi.1009347.e069" ref-type="disp-formula">Eq (6a)</xref> exactly by taking a forward-backward algorithmic approach (this is the backward pass whereas <xref rid="pcbi.1009347.e053" ref-type="disp-formula">Eq (5)</xref> is the forward one). We solve this equation by noting that <bold>q</bold><sub><bold>t</bold></sub> = <bold>p</bold><sub><bold>t</bold></sub> and iterating backwards in time to obtain the first smoothing distribution <bold>q</bold><sub><bold>1</bold></sub>. The integrals become sums over our grid <inline-formula id="pcbi.1009347.e071"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e071.jpg" id="pcbi.1009347.e071g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M71" display="inline" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi></mml:math></alternatives></inline-formula> and distributions are <italic toggle="yes">m</italic> element vectors. <xref rid="pcbi.1009347.e069" ref-type="disp-formula">Eq (6a)</xref> sequentially updates our earlier filtering solutions to include future data, forms the second half of EpiFilter and can also be approximately solved using particle smoothers [<xref rid="pcbi.1009347.ref014" ref-type="bibr">14</xref>].</p>
      <p>This approach neatly links the filtering and smoothing distributions <bold>p</bold><sub><bold>s</bold></sub> and <bold>q</bold><sub><bold>s</bold></sub>. If we assume that the reverse-filtering distribution <bold>r</bold><sub><bold>s</bold></sub> is reasonably approximated by <inline-formula id="pcbi.1009347.e072"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e072.jpg" id="pcbi.1009347.e072g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M72" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> then we can also apply the two-filter smoothing solution of [<xref rid="pcbi.1009347.ref025" ref-type="bibr">25</xref>] to get <xref rid="pcbi.1009347.e069" ref-type="disp-formula">Eq (6b)</xref>. If either future (<inline-formula id="pcbi.1009347.e073"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e073.jpg" id="pcbi.1009347.e073g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M73" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>) or past (<inline-formula id="pcbi.1009347.e074"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e074.jpg" id="pcbi.1009347.e074g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M74" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) incidence is uninformative then either <bold>r</bold><sub><bold>s</bold></sub> or <bold>p</bold><sub><bold>s</bold></sub> will reduce to the prior <inline-formula id="pcbi.1009347.e075"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e075.jpg" id="pcbi.1009347.e075g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M75" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, leading to <bold>q</bold><sub><bold>s</bold></sub> ∝ <bold>p</bold><sub><bold>s</bold></sub> or <bold>q</bold><sub><bold>s</bold></sub> ∝ <bold>r</bold><sub><bold>s</bold></sub>, respectively. The end and beginning of the epidemic provide important examples of each of these scenarios. Consequently, <xref rid="pcbi.1009347.e070" ref-type="disp-formula">Eq (6b)</xref> shows how smoothing connects EpiEstim and the WT methods, and explains why EpiFilter, which can be used for both real-time and retrospective inference, better overcomes edge-effects and periods of low data.</p>
      <p>Further, the smoothed posterior <bold>q</bold><sub><bold>s</bold></sub> yields the conditional mean estimate <inline-formula id="pcbi.1009347.e076"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e076.jpg" id="pcbi.1009347.e076g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M76" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which is known to significantly improve on the MSE of the filtered equivalent <inline-formula id="pcbi.1009347.e077"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e077.jpg" id="pcbi.1009347.e077g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M77" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (see previous section) [<xref rid="pcbi.1009347.ref023" ref-type="bibr">23</xref>]. While filtering provides the minimum MSE estimator of every instantaneous reproduction number <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> given past knowledge, smoothing provides the minimum given all knowledge. This relationship is formal, with filtered and smoothed MSE values mapping to the amount of mutual information that <inline-formula id="pcbi.1009347.e078"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e078.jpg" id="pcbi.1009347.e078g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M78" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> provides about <inline-formula id="pcbi.1009347.e079"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e079.jpg" id="pcbi.1009347.e079g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M79" display="inline" overflow="scroll"><mml:msubsup><mml:mi>R</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> [<xref rid="pcbi.1009347.ref034" ref-type="bibr">34</xref>]. Extracting the maximum information from the incidence curve <inline-formula id="pcbi.1009347.e080"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e080.jpg" id="pcbi.1009347.e080g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M80" display="inline" overflow="scroll"><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> should engender estimates that are more robust and statistically efficient in periods of low incidence. We summarise the EpiFilter algorithm in <xref rid="pcbi.1009347.g001" ref-type="fig">Fig 1</xref>.</p>
      <p>While our main interest is on optimised and rigorous real-time and retrospective estimates of transmissibility, which are completely defined by the smoothing distribution <bold>q</bold><sub><bold>s</bold></sub>, we may also want to predict future incidence, for informing epidemic preparedness plans and for validating past <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> estimates [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>, <xref rid="pcbi.1009347.ref035" ref-type="bibr">35</xref>]. We compute the filtered one-step-ahead posterior predictive distribution as in <xref rid="pcbi.1009347.e082" ref-type="disp-formula">Eq (7)</xref> (integrals are over <inline-formula id="pcbi.1009347.e081"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e081.jpg" id="pcbi.1009347.e081g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M81" display="inline" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi></mml:math></alternatives></inline-formula>) [<xref rid="pcbi.1009347.ref014" ref-type="bibr">14</xref>].
<disp-formula id="pcbi.1009347.e082"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e082.jpg" id="pcbi.1009347.e082g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M82" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mtext>d</mml:mtext><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula></p>
      <p>We assume, as in [<xref rid="pcbi.1009347.ref036" ref-type="bibr">36</xref>], that <inline-formula id="pcbi.1009347.e083"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e083.jpg" id="pcbi.1009347.e083g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M83" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mover><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mover><mml:mspace width="0.166667em"/><mml:mtext>Pois</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Λ</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Replacing <bold>p</bold><sub><bold>s</bold></sub> with <bold>q</bold><sub><bold>s</bold></sub> yields the smoothed equivalent of <xref rid="pcbi.1009347.e082" ref-type="disp-formula">Eq (7)</xref>. We will use <xref rid="pcbi.1009347.e082" ref-type="disp-formula">Eq (7)</xref> to compare EpiFilter against APEestim, which is the prediction-optimised version of EpiEstim, developed in [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>]. Since predictions depend strongly on <bold>p</bold><sub><bold>s</bold></sub> or <bold>q</bold><sub><bold>s</bold></sub>, optimising these distributions can be important, for example, when forecasting second waves of infection.</p>
      <p>Last, we comment on how we represent uncertainty in our estimates and predictions. Often we will provide 95% equal tailed Bayesian credible intervals. These are computed directly from the 2.5<sup>th</sup> and 97.5<sup>th</sup> quantiles of the relevant posterior distribution and used to assess performance statistics such as coverage of true values.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec007">
    <title>Results</title>
    <sec id="sec008">
      <title>Improved estimation at low incidence</title>
      <p>The reliable estimation of time-varying effective reproduction numbers, <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, at low incidence, <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub>, is a key challenge limiting our understanding of transmission [<xref rid="pcbi.1009347.ref017" ref-type="bibr">17</xref>]. Periods with small counts of new cases contain little information and so present necessary statistical difficulties [<xref rid="pcbi.1009347.ref026" ref-type="bibr">26</xref>]. Uncovering the transmissibility patterns in these periods can evidence intervention relaxation strategies, indicate potential elimination and provide insight into mechanisms of spread [<xref rid="pcbi.1009347.ref028" ref-type="bibr">28</xref>, <xref rid="pcbi.1009347.ref050" ref-type="bibr">50</xref>]. Here we compare EpiFilter, which allows exact inference over a state grid <inline-formula id="pcbi.1009347.e084"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e084.jpg" id="pcbi.1009347.e084g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M84" display="inline" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi></mml:math></alternatives></inline-formula>, with EpiEstim and APEestim at these data-poor settings. We use EpiEstim with weekly and monthly windows. Weekly windows are the default recommendation in [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>]. We include monthly ones as long windows can improve robustness at low incidence [<xref rid="pcbi.1009347.ref028" ref-type="bibr">28</xref>]. APEestim, developed in [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>], optimises the window choice of EpiEstim to minimise one-step-ahead prediction errors. The assumptions and choices inherent in estimation methods become important and visible when data are scarce, and can bias inference or support spurious predictions [<xref rid="pcbi.1009347.ref015" ref-type="bibr">15</xref>].</p>
      <p>We generate epidemics using the Poisson noise model of <xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref> under the serial interval distribution of Ebola virus disease described in [<xref rid="pcbi.1009347.ref037" ref-type="bibr">37</xref>]. We examine three diverse scenarios in <xref rid="pcbi.1009347.g002" ref-type="fig">Fig 2</xref>. These describe (A) rapidly controlled epidemics (<italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> step changes from 2 to 0.5 at <italic toggle="yes">s</italic> = 100), (B) small outbreaks with exponentially rising and falling <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> (change-point at <italic toggle="yes">s</italic> = 30 and rates of 0.02 and -0.008 per time unit) and (C) medium outbreaks that are initially controlled (<italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> changes from 4 to 0.6 at <italic toggle="yes">s</italic> = 40) then resurge (<italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> rebounds to 2 at <italic toggle="yes">s</italic> = 80) into large epidemics, before finally being suppressed (<italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> = 0.2 from <italic toggle="yes">s</italic> = 150). These scenarios are similar to ones investigated in [<xref rid="pcbi.1009347.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1009347.ref028" ref-type="bibr">28</xref>] and describe various epidemic dynamics that culminate in elimination. We simulate 200 incidence curves for each scenario and apply APEestim (optimal window <italic toggle="yes">k</italic>*), EpiEstim (<italic toggle="yes">k</italic> = 7 and 31) and EpiFilter (state noise <italic toggle="yes">η</italic> = 0.1) to estimate <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> and sequentially predict <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> (given data up to <italic toggle="yes">s</italic> − 1) for each curve.</p>
      <p>For the first two methods we compute mean one-step-ahead incidence predictions (<inline-formula id="pcbi.1009347.e085"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e085.jpg" id="pcbi.1009347.e085g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M85" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>) as in [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>] and instantaneous reproduction number estimates (<inline-formula id="pcbi.1009347.e086"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e086.jpg" id="pcbi.1009347.e086g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M86" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>) from <xref rid="pcbi.1009347.e027" ref-type="disp-formula">Eq (2)</xref> with <italic toggle="yes">τ</italic>(<italic toggle="yes">s</italic>) delimiting the window times used. We obtain smoothed EpiFilter estimates (<inline-formula id="pcbi.1009347.e087"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e087.jpg" id="pcbi.1009347.e087g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M87" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>) and filtered predictions (<inline-formula id="pcbi.1009347.e088"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e088.jpg" id="pcbi.1009347.e088g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M88" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>) from Eqs <xref rid="pcbi.1009347.e069" ref-type="disp-formula">(6)</xref> and <xref rid="pcbi.1009347.e082" ref-type="disp-formula">(7)</xref>. We could use smoothed predictions (<inline-formula id="pcbi.1009347.e089"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e089.jpg" id="pcbi.1009347.e089g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M89" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>), which implicitly include data beyond <italic toggle="yes">s</italic> − 1, to assess fit but as we want to test model adequacy <inline-formula id="pcbi.1009347.e090"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e090.jpg" id="pcbi.1009347.e090g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M90" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is more appropriate [<xref rid="pcbi.1009347.ref038" ref-type="bibr">38</xref>]. Our main focus is on real-time performance so we do not investigate the WT method. See [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1009347.ref012" ref-type="bibr">12</xref>] for comparisons of the WT method and EpiEstim. <xref rid="pcbi.1009347.g002" ref-type="fig">Fig 2A–2C</xref> provide representative single runs (we only show <italic toggle="yes">k</italic> = 31 for EpiEstim as <italic toggle="yes">k</italic> = 7 is often similar to APEestim) while <xref rid="pcbi.1009347.g002" ref-type="fig">Fig 2D</xref> presents reproduction number MSE and one-step-ahead predicted incidence MSE (PMSE) distributions from the 200 runs.</p>
      <fig position="float" id="pcbi.1009347.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009347.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Small or waning epidemics.</title>
          <p>We compare reproduction number estimates (<inline-formula id="pcbi.1009347.e091"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e091" id="pcbi.1009347.e091g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M91" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1009347.e092"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e092" id="pcbi.1009347.e092g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M92" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>) and one-step-ahead incidence predictions (<inline-formula id="pcbi.1009347.e093"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e093" id="pcbi.1009347.e093g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M93" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1009347.e094"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e094" id="pcbi.1009347.e094g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M94" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>) from APEestim with optimal window <italic toggle="yes">k</italic>*, EpiEstim with window <italic toggle="yes">k</italic> and EpiFilter with state noise <italic toggle="yes">η</italic>. We simulate 200 epidemics with low daily case numbers or long tails (long sequences of zero cases) using the standard renewal model (<xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref>) for three scenarios, representative examples of which are given in A-C. The true <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> and <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> are in black. All mean estimates or predictions are in red and blue with 95% credible intervals. APEestim and EpiEstim use a Gam(1, 2) prior distribution and EpiFilter a grid with <italic toggle="yes">m</italic> = 2000, <italic toggle="yes">R</italic><sub>min</sub> = 0.01 and <italic toggle="yes">R</italic><sub>max</sub> = 10. In D we provide statistics of the MSE of these estimates (relative to <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>) and the PMSE of these predictions (relative to <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub>) for all 200 runs. We find that EpiFilter is more robust to small incidence (better uncertainty), whereas the other approaches can quickly decay to their prior distribution. It achieves significantly smaller MSE (2–10 fold reductions) and comparable PMSE to APEestim (which is optimised for prediction).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.g002" position="float"/>
      </fig>
      <p>In the <xref rid="sec002" ref-type="sec">Methods</xref> we showed that since EpiEstim-type methods group data over some window into the past, they revert to their prior distribution as the total cases in this window becomes small. During low incidence periods, e.g., when the epidemic is waning, using long windows makes sense [<xref rid="pcbi.1009347.ref028" ref-type="bibr">28</xref>]. However, this reduces predictive accuracy as fluctuations in <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> are underfit. This is the use-case for APEestim, which optimises for prediction. The consequences of these trade-offs are made clear in <xref rid="pcbi.1009347.g002" ref-type="fig">Fig 2A–2C</xref> where APEestim provides the best one-step-ahead <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> predictions but quickly reverts to its prior (seen as wide credible intervals) when cases are few. Longer window EpiEstim improves on this destabilisation but cannot track salient fluctuations in <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>. <xref rid="pcbi.1009347.g002" ref-type="fig">Fig 2D</xref> verifies these trends. APEstim has the smallest PMSE but often worse MSE than the larger <italic toggle="yes">k</italic> EpiEstim choices.</p>
      <p>Interestingly, EpiFilter is able to jointly optimise both instantaneous reproduction number tracking and incidence predictions (computed via <xref rid="pcbi.1009347.e082" ref-type="disp-formula">Eq (7)</xref>). In <xref rid="pcbi.1009347.g002" ref-type="fig">Fig 2A–2C</xref> we see that EpiFilter maintains stable and accurate estimates of <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> and only slowly reverts to its prior (which has the same support as that of EpiEstim and APEesim). However, unlike long window methods it does not sacrifice prediction fidelity. The improvement in MSE shown in <xref rid="pcbi.1009347.g002" ref-type="fig">Fig 2D</xref> is stark (the numerical reduction in MSE when compared to the next best method is on average at least 2-fold and often 10-fold). The PMSE, while larger than that of APEestim (which is optimised for predictions) is still good. These points are reinforced in <xref rid="pcbi.1009347.g003" ref-type="fig">Fig 3</xref>, which expands on the statistics of scenarios A-C.</p>
      <fig position="float" id="pcbi.1009347.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009347.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Temporal statistics of small or waning epidemics.</title>
          <p>We expand on the results from <xref rid="pcbi.1009347.g002" ref-type="fig">Fig 2D</xref> by decomposing the MSE and one-step-ahead PMSE statistics across the 200 simulated trajectories for every scenario in <xref rid="pcbi.1009347.g002" ref-type="fig">Fig 2</xref>. We do not consider the <italic toggle="yes">k</italic> = 31 EpiEstim example given its poor performance. We present the <italic toggle="yes">k</italic> = 7 case, which is the generally recommended EpiEstim setting. We observe that EpiFilter significantly improves on MSE throughout the epidemic trajectory (and not only in periods of low incidence) while maintaining comparable prediction accuracies. Coverage statistics for these scenarios, which are given in Fig C of the <xref rid="pcbi.1009347.s001" ref-type="supplementary-material">S1 Appendix</xref>, confirm that EpiFilter also consistently contains the true <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> and <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> values within its credible intervals.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.g003" position="float"/>
      </fig>
      <p>There the MSE and PMSE computed over the 200 replicate simulations are plotted with time. We observe a clear and significant reduction in MSE at most time points (both at low and large incidence) for EpiFilter, with similar PMSE performance, as compared to EpiEstim and APEestim. This confirms the widespread benefits of smoothing solutions. Moreover, the coverage of both the true <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> and <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> of EpiFilter (i.e., the probability that <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> or <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> is contained within estimated or predicted 95% equal tailed credible intervals) is more consistent than all other approaches. We present this in Fig C of the <xref rid="pcbi.1009347.s001" ref-type="supplementary-material">S1 Appendix</xref>. Thus, EpiFilter combines the advantages of APEestim and long-window EpiEstim, strongly minimises estimation error and, further, is able to reliably detect transmission change-points automatically.</p>
    </sec>
    <sec id="sec009">
      <title>Improved estimation between epidemic waves</title>
      <p>Maintaining robust instantaneous reproduction number, <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, estimation when incidence, <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub>, becomes small is not just statistically important. Two possible outcomes may follow periods of small <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub>: either the epidemic goes extinct (elimination occurs, as in the previous section), or an additional wave of infection surfaces (resurgence) e.g., due to imports or unmonitored local transmission. Predicting which outcome is likely, in real-time, is of global concern as countries aim to relax interventions during the ongoing COVID-19 pandemic, while also minimising the risks of further cases [<xref rid="pcbi.1009347.ref017" ref-type="bibr">17</xref>, <xref rid="pcbi.1009347.ref039" ref-type="bibr">39</xref>]. As changes in instantaneous reproduction numbers signal variations in transmission and hence incidence, reliably identifying and inferring <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> trends in the trough preceding potential new peaks can be crucial for preparedness, providing evidence for timely and effective epidemic interventions [<xref rid="pcbi.1009347.ref010" ref-type="bibr">10</xref>].</p>
      <p>Reliable estimation of <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> between epidemic waves depends on the prior assumptions of the inference method used and on how that method relies on those assumptions when data are scarce [<xref rid="pcbi.1009347.ref040" ref-type="bibr">40</xref>, <xref rid="pcbi.1009347.ref041" ref-type="bibr">41</xref>]. Here we examine this dependence and investigate cases where resurgence follows a low-incidence period. As in the above section, we compare EpiFilter (<italic toggle="yes">η</italic> = 0.1) with APEestim (optimal window <italic toggle="yes">k</italic>*) and EpiEstim (weekly, <italic toggle="yes">k</italic> = 7, and monthly, <italic toggle="yes">k</italic> = 31, windows) over 200 simulated epidemics under the serial interval of Ebola virus. We explore scenarios depicting (A) epidemics that are initially controlled (<italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> falls from 2.5 to 0.5 at <italic toggle="yes">s</italic> = 70) but which resurge just as quickly (<italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> returns to 2.5 from <italic toggle="yes">s</italic> = 230), (B) periodic or seasonal transmission (<italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> is sinusoidal with magnitude 1.3 ±1.2 and period of 120 time units) and (C) outbreaks with exponentially rising and then falling transmissibility (change-points at <italic toggle="yes">s</italic> = 40 and 190 and exponent rates 0.03, -0.015 and 0.02).</p>
      <p>These examples are similar to some in [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>] and describe diverse epidemics with multiple peaks and troughs. We provide representative runs of each scenario in A-C and collect MSE (for <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>) and PMSE (relative to <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub>) distributions over the 200 runs of every scenario in <xref rid="pcbi.1009347.g004" ref-type="fig">Fig 4D</xref>. We also provide these statistics across time in <xref rid="pcbi.1009347.g005" ref-type="fig">Fig 5</xref>. We observe a similar pattern in performance among the methods as in our previous analyses of Figs <xref rid="pcbi.1009347.g002" ref-type="fig">2</xref> and <xref rid="pcbi.1009347.g003" ref-type="fig">3</xref>. APEestim is best able to predict upcoming incidence and achieves the lowest PMSE as expected. While the monthly window EpiEstim is less useful in these cases (since prior reversion does not occur as often, though could be an issue for more extended troughs), the weekly window version loses predictive fidelity for minor MSE improvements.</p>
      <fig position="float" id="pcbi.1009347.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009347.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Epidemics with multiple waves.</title>
          <p>We compare reproduction number estimates (<inline-formula id="pcbi.1009347.e095"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e095" id="pcbi.1009347.e095g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M95" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1009347.e096"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e096" id="pcbi.1009347.e096g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M96" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>) and one-step-ahead incidence predictions (<inline-formula id="pcbi.1009347.e097"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e097" id="pcbi.1009347.e097g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M97" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1009347.e098"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e098" id="pcbi.1009347.e098g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M98" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>) from APEestim with optimal window <italic toggle="yes">k</italic>*, EpiEstim with window <italic toggle="yes">k</italic> and EpiFilter with state noise <italic toggle="yes">η</italic>. We simulate 200 epidemics with multiple waves of infection using the standard renewal model (<xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref>) for three scenarios, representative examples of which are given in A-C. The true <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> and <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> are in black. All mean estimates or predictions are in red and blue with 95% equal tailed credible intervals. APEestim and EpiEstim use a Gam(1, 2) prior distribution and EpiFilter a grid with <italic toggle="yes">m</italic> = 2000, <italic toggle="yes">R</italic><sub>min</sub> = 0.01 and <italic toggle="yes">R</italic><sub>max</sub> = 10. In D we provide statistics of the MSE of these estimates (relative to <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>) and the PMSE of these predictions (relative to <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub>) for all 200 runs. We find EpiFilter is best able to negotiate troughs between epidemic peaks and hence infer resurging infectious dynamics, achieving significantly smaller MSE (2–10 fold reductions) and comparable PMSE to APEestim (which is optimised for prediction).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.g004" position="float"/>
      </fig>
      <fig position="float" id="pcbi.1009347.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009347.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Temporal statistics of epidemics with multiple waves.</title>
          <p>We expand on the results from <xref rid="pcbi.1009347.g004" ref-type="fig">Fig 4D</xref> by decomposing the MSE and one-step-ahead PMSE statistics across the 200 simulated trajectories for every scenario in <xref rid="pcbi.1009347.g004" ref-type="fig">Fig 4</xref>. We do not consider the <italic toggle="yes">k</italic> = 31 EpiEstim example given its poor performance. We present the <italic toggle="yes">k</italic> = 7 case, which is the generally recommended EpiEstim setting. We observe that EpiFilter significantly improves on MSE throughout the resurgent epidemic trajectory (whether incidence is small or large) while maintaining comparable prediction accuracies. Coverage statistics for these scenarios, which are given in Fig D of the <xref rid="pcbi.1009347.s001" ref-type="supplementary-material">S1 Appendix</xref>, confirm that EpiFilter consistently contains the true <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> and <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> values within its credible intervals.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.g005" position="float"/>
      </fig>
      <p>EpiFilter once again combines the advantages of the other approaches. For every scenario in <xref rid="pcbi.1009347.g004" ref-type="fig">Fig 4</xref> it provides accurate tracking of changes in <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> with stable credible intervals and a MSE that is at least <inline-formula id="pcbi.1009347.e099"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e099.jpg" id="pcbi.1009347.e099g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M99" display="inline" overflow="scroll"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:math></alternatives></inline-formula> and sometimes even <inline-formula id="pcbi.1009347.e100"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e100.jpg" id="pcbi.1009347.e100g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M100" display="inline" overflow="scroll"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>10</mml:mn></mml:mfrac></mml:math></alternatives></inline-formula> that of the next best method. The improvement in MSE is clear and maintained at almost every time point of each scenario, regardless of whether incidence is low or high. Concurrently, the incidence PMSE of EpiFilter rivals that of APEestim and it attains the most consistent coverage of the true <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> and <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> values, as shown in Fig D of the <xref rid="pcbi.1009347.s001" ref-type="supplementary-material">S1 Appendix</xref>. EpiFilter is therefore a proficient tool for inferring resurgence. We also find that the <italic toggle="yes">η</italic> = 0.1 parameter value seems to be an all-purpose heuristic, meaning that usage of EpiFilter can be simpler than EpiEstim and other window or change-point based methods. The improvements of EpiFilter likely result from its minimal assumptions (see <xref rid="pcbi.1009347.e047" ref-type="disp-formula">Eq (4)</xref>) and its increased information extraction. We next test our method on empirical data.</p>
    </sec>
    <sec id="sec010">
      <title>COVID-19 in New Zealand and H1N1 influenza in the USA</title>
      <p>The previous sections confirmed EpiFilter as a powerful inference and prediction tool, especially in data-poor conditions, using simulated epidemics. We now confront our method with empirical data from the 1918 H1N1 influenza pandemic in Baltimore (USA) [<xref rid="pcbi.1009347.ref042" ref-type="bibr">42</xref>] and the ongoing COVID-19 pandemic in New Zealand (up to 17 August 2020) [<xref rid="pcbi.1009347.ref043" ref-type="bibr">43</xref>]. The H1N1 dataset has been well-studied and so we first use this to benchmark EpiFilter. We clean this dataset by applying a 5-day moving average filter as recommended in [<xref rid="pcbi.1009347.ref042" ref-type="bibr">42</xref>]. Previous work [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>] analysed this dataset with EpiEstim and found that sensible instantaneous reproduction number, <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, estimates are obtained when a weekly window (<italic toggle="yes">k</italic> = 7) is applied. However, more recent work, using APEestim [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>], showed that while <italic toggle="yes">k</italic> = 7 provides stable estimates for this epidemic, it is a poor predictor of the incidence data. Instead, an optimised window of 2 days (<italic toggle="yes">k</italic>* = 2) yields good predictions but the resulting <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> estimates are noisy.</p>
      <p>We reproduce the instantaneous reproduction number estimates (<inline-formula id="pcbi.1009347.e101"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e101.jpg" id="pcbi.1009347.e101g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M101" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>) and incidence predictions (<inline-formula id="pcbi.1009347.e102"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e102.jpg" id="pcbi.1009347.e102g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M102" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>) from both studies in <xref rid="pcbi.1009347.g006" ref-type="fig">Fig 6</xref> and compare them against EpiFilter with <italic toggle="yes">η</italic> = 0.1 (<inline-formula id="pcbi.1009347.e103"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e103.jpg" id="pcbi.1009347.e103g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M103" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009347.e104"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e104.jpg" id="pcbi.1009347.e104g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M104" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>). Top and middle rows of <xref rid="pcbi.1009347.g006" ref-type="fig">Fig 6</xref> illustrate the aforementioned trade-off between estimate stability and prediction accuracy. The bottom row confirms the power of EpiFilter. Our <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> estimates are of comparable stability to those of EpiEstim at <italic toggle="yes">k</italic> = 7, yet our prediction fidelity matches that of APEestim. Our improved inference again benefits from using more information (i.e., the backward pass in <xref rid="pcbi.1009347.g001" ref-type="fig">Fig 1</xref>) and making less restrictive prior assumptions. We see the latter from the <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> credible intervals over 40 ≤ <italic toggle="yes">s</italic> ≤ 60. There EpiEstim seems overconfident, and this results in a rigid overestimation of incidence. However, EpiFilter mediates its estimate uncertainty to a level similar to APEestim.</p>
      <fig position="float" id="pcbi.1009347.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009347.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>H1N1 influenza transmission in Baltimore (1918).</title>
          <p>We compare APEestim (top), EpiEstim with recommended weekly window (middle) (both with Gam(1, 2) prior distribution) and EpiFilter (with <italic toggle="yes">m</italic> = 2000, <italic toggle="yes">η</italic> = 0.1, <italic toggle="yes">R</italic><sub>min</sub> = 0.01 and <italic toggle="yes">R</italic><sub>max</sub> = 10) on the H1N1 influenza dataset from [<xref rid="pcbi.1009347.ref042" ref-type="bibr">42</xref>]. We use a 5-day moving average filter, as in [<xref rid="pcbi.1009347.ref042" ref-type="bibr">42</xref>], to ameliorate known sampling biases. Estimates of reproduction numbers, <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, and corresponding 95% equal tailed credible intervals are in red. One-step-ahead predictions of incidence, <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub>, (with 95% credible intervals) are in blue with the actual incidence in black. We find that EpiFilter combines the benefits of APEestim and EpiEstim, achieving both good estimates and predictions.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.g006" position="float"/>
      </fig>
      <p>We explore COVID-19 transmission patterns in New Zealand using incidence data up to 17 August 2020 from [<xref rid="pcbi.1009347.ref043" ref-type="bibr">43</xref>]. New Zealand presents an insightful case study because officials combined swift lockdowns with intensive testing to achieve and sustain very low incidence levels that eventually led to local elimination of COVID-19 [<xref rid="pcbi.1009347.ref044" ref-type="bibr">44</xref>]. However, an upsurge in cases in early August inspired concerns about a second wave (which led to new interventions and is why we do not consider data beyond 17 August). Here we investigate the time-varying transmission in New Zealand to see if this uptick suggests that the epidemic was resurfacing in mid-August. We believe smoothing can confer important inferential advantages in exactly these types of low incidence scenarios.</p>
      <p>We make the common assumptions that case under-reporting is constant [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>], which seems reasonable given the intensive surveillance employed by New Zealand [<xref rid="pcbi.1009347.ref045" ref-type="bibr">45</xref>]. We ignore reporting delays, which are known to be small [<xref rid="pcbi.1009347.ref046" ref-type="bibr">46</xref>] and use the COVID-19 serial interval distribution from [<xref rid="pcbi.1009347.ref047" ref-type="bibr">47</xref>]. We do not explicitly distinguish imported from local cases in our analysis. The latter could bias our study [<xref rid="pcbi.1009347.ref028" ref-type="bibr">28</xref>, <xref rid="pcbi.1009347.ref039" ref-type="bibr">39</xref>] but our focus is on demonstrating differences between filtering and smoothing on instantaneous reproduction number, <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, trends and not on providing detailed <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> estimates during this period. We plot the results of our exploration in <xref rid="pcbi.1009347.g007" ref-type="fig">Fig 7</xref>.</p>
      <fig position="float" id="pcbi.1009347.g007">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009347.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>COVID-19 transmission in New Zealand.</title>
          <p>We compute smoothed and filtered reproduction number estimates, <inline-formula id="pcbi.1009347.e105"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e105" id="pcbi.1009347.e105g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M105" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (red) and <inline-formula id="pcbi.1009347.e106"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e106" id="pcbi.1009347.e106g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M106" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (blue) respectively, from the COVID-19 incidence curve for New Zealand (available at [<xref rid="pcbi.1009347.ref043" ref-type="bibr">43</xref>]) in the left panels. We use EpiFilter with <italic toggle="yes">m</italic> = 2000, <italic toggle="yes">η</italic> = 0.1, <italic toggle="yes">R</italic><sub>min</sub> = 0.01 and <italic toggle="yes">R</italic><sub>max</sub> = 10 with a uniform prior distribution over the grid <inline-formula id="pcbi.1009347.e107"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e107" id="pcbi.1009347.e107g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M107" display="inline" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi></mml:math></alternatives></inline-formula>. The top of 7A shows conditional mean estimates and 95% credible intervals for <inline-formula id="pcbi.1009347.e108"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e108" id="pcbi.1009347.e108g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M108" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (red) and <inline-formula id="pcbi.1009347.e109"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e109" id="pcbi.1009347.e109g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M109" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (blue). Vertical lines indicate the start and end of lockdown, a major intervention that was employed to halt transmission. The additional ‘future’ information used in smoothing has a notable effect. The bottom of 7A provides smoothed one-step-ahead predictions <inline-formula id="pcbi.1009347.e110"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e110" id="pcbi.1009347.e110g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M110" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (blue, with 95% credible intervals) of the actual reported cases <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> (black). The inset gives the estimated probability of <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> ≤ 1. We observe a clear trend of subcritical transmission that eventually seeds a second wave by August. In 7B we compare EpiFilter with EpiEstim (using weekly windows) and APEestim (both with Gam(1, 2) priors) with all left subfigures presenting <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> estimates and right ones providing filtered <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> predictions. We observe that both APEestim and EpiEstim lead to largely unusable estimates that mask transmission trends, in sharp contrast to EpiFilter.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.g007" position="float"/>
      </fig>
      <p>We apply EpiFilter and obtain filtered (<inline-formula id="pcbi.1009347.e111"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e111.jpg" id="pcbi.1009347.e111g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M111" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, blue) and smoothed (<inline-formula id="pcbi.1009347.e112"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e112.jpg" id="pcbi.1009347.e112g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M112" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, red) conditional mean estimates together with their 95% confidence intervals. These are in the left panels of <xref rid="pcbi.1009347.g007" ref-type="fig">Fig 7</xref> and computed from Eqs <xref rid="pcbi.1009347.e053" ref-type="disp-formula">(5)</xref> and <xref rid="pcbi.1009347.e069" ref-type="disp-formula">(6)</xref> respectively. The times of lockdown and release are included for reference. Interestingly, we see a notable difference in the quality of inference between <inline-formula id="pcbi.1009347.e113"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e113.jpg" id="pcbi.1009347.e113g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M113" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1009347.e114"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e114.jpg" id="pcbi.1009347.e114g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M114" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. The former, as expected, is unreliable at the beginning of the incidence curve and features wider uncertainty and noisier trends. The smoothed <inline-formula id="pcbi.1009347.e115"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e115.jpg" id="pcbi.1009347.e115g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M115" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, by using both forward and backward-looking data largely overcomes these issues and clarifies transmission dynamics. In the right panels we compare EpiFilter with EpiEstim (weekly windows) and APEestim. The difference is striking. Neither APEestim nor EpiEstim recovers a clear trend and both are appreciably worse than even the filtered estimate <inline-formula id="pcbi.1009347.e116"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e116.jpg" id="pcbi.1009347.e116g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M116" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.</p>
      <p>Our smoothed analysis suggests that <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> has resurged and supports the re-implementation of measures around 14 August. We recover suppression of the initial wave in April, likely associated with the implementation of key interventions, including lockdown [<xref rid="pcbi.1009347.ref046" ref-type="bibr">46</xref>]. Following this, we infer a prolonged period of subcritical transmission, where <inline-formula id="pcbi.1009347.e117"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e117.jpg" id="pcbi.1009347.e117g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M117" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Low and then zero incidence over this period strikingly destabilises both APEestim and EpiEstim and conceals the rise in <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> that occurs after July. EpiFilter signals this upsurge, which continually grows until August, where a second wave becomes likely. We also provide one-step-ahead predictions (which are from the smoothed <inline-formula id="pcbi.1009347.e118"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e118.jpg" id="pcbi.1009347.e118g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M118" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> hence the notation <inline-formula id="pcbi.1009347.e119"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e119.jpg" id="pcbi.1009347.e119g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M119" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>) and their equal tailed 95% credible intervals against the reported incidence from [<xref rid="pcbi.1009347.ref043" ref-type="bibr">43</xref>]. These verify that <inline-formula id="pcbi.1009347.e120"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e120.jpg" id="pcbi.1009347.e120g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M120" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> reasonably describes the data (we also present <inline-formula id="pcbi.1009347.e121"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e121.jpg" id="pcbi.1009347.e121g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M121" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> when comparing methods). We find that <inline-formula id="pcbi.1009347.e122"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e122.jpg" id="pcbi.1009347.e122g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M122" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> around July, further supporting this resurgence hypothesis.</p>
      <p>While the analyses of the H1N1 and COVID-19 data above illustrate the advantages of EpiFilter, these estimates can be further improved. We used case data and not actual infection times (which relates to the approximation of the generation time by the serial interval distribution) and did not account for introductions, case ascertainment fractions and reporting delays. For more practical analyses it may be necessary to first compensate for these biases to obtain the best possible incidence curve. Methods from [<xref rid="pcbi.1009347.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1009347.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1009347.ref048" ref-type="bibr">48</xref>] can be applied if relevant incubation period, reporting distributions and contact tracing data are available to diagnose and correct for these issues. The resulting pre-processed incidence curve can then be input to EpiFilter to obtain more realistic <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> estimates.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec011">
    <title>Discussion</title>
    <p>Estimating time-varying trends in the instantaneous or effective reproduction number, <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, reliably and in real-time is an important and popular problem in infectious disease epidemiology [<xref rid="pcbi.1009347.ref005" ref-type="bibr">5</xref>]. As the COVID-19 pandemic has unfolded, the interest in solving this problem has only elevated with <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> playing a central role both in aiding situational awareness [<xref rid="pcbi.1009347.ref008" ref-type="bibr">8</xref>] and informing policymaking [<xref rid="pcbi.1009347.ref049" ref-type="bibr">49</xref>]. Initially, interest was on understanding how changes in <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> may correlate with interventions such as lockdowns and social distancing [<xref rid="pcbi.1009347.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1009347.ref010" ref-type="bibr">10</xref>]. However, as countries have entered waning phases of the pandemic and vaccine deployment has begun, focus has shifted to charactering how existing interventions can be relaxed with minimum risk [<xref rid="pcbi.1009347.ref050" ref-type="bibr">50</xref>]. The literature on intervention exit strategies is, however, still in development, and several challenges remain to modelling transmission.</p>
    <p>One key challenge lies in understanding and inferring transmissibility during periods when the incidence of new cases is small [<xref rid="pcbi.1009347.ref017" ref-type="bibr">17</xref>]. Such periods may occur under sustained control measures and necessarily contain limited data, which make inferences difficult. Moreover, it is in these lulls that information on transmission may be crucial, helping to determine if the removal of interventions will lead to resurgence or if elimination is realistic by maintaining controls [<xref rid="pcbi.1009347.ref028" ref-type="bibr">28</xref>, <xref rid="pcbi.1009347.ref039" ref-type="bibr">39</xref>]. While reproduction numbers are not the only analytic for assessing these outcomes, they do provide an important real-time diagnostic since upticks in <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> generally precede elevations in case loads. Unfortunately, many current approaches to estimating <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> become underpowered, unstable or prior-constrained in these data-limited conditions [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1009347.ref026" ref-type="bibr">26</xref>, <xref rid="pcbi.1009347.ref050" ref-type="bibr">50</xref>]. These problems are only magnified when finer-scale analyses (where cases are fewer by division) are of interest (e.g., regional versus national level estimation).</p>
    <p>In this paper we re-examined existing methodology for inferring instantaneous reproduction numbers, <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, from an engineering perspective. We observed that two of the most useful and popular inference approaches, EpiEstim [<xref rid="pcbi.1009347.ref011" ref-type="bibr">11</xref>] and the WT method (this computes cohort reproduction numbers, which are functions of <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>) [<xref rid="pcbi.1009347.ref002" ref-type="bibr">2</xref>], only capitalise on a portion of the data available, deeming either upcoming or past incidence to be informative (see <xref rid="pcbi.1009347.g001" ref-type="fig">Fig 1</xref>) [<xref rid="pcbi.1009347.ref012" ref-type="bibr">12</xref>]. This informative portion is directly controlled by prior assumptions on the speed of possible <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> changes, which are often characterised by a window of size <italic toggle="yes">k</italic>. Other methods also apply similarly strong change-point or state assumptions on <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, explicitly linking its variations with specific dates or events, for example [<xref rid="pcbi.1009347.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1009347.ref026" ref-type="bibr">26</xref>]. When data are scarce these assumptions can unduly control or skew inference.</p>
    <p>In control engineering a common problem, known as filtering, involves optimally (in a MSE sense) estimating hidden Markov states, in real-time, from noisy and uncertain observations [<xref rid="pcbi.1009347.ref018" ref-type="bibr">18</xref>]. A related problem termed smoothing provides accompanying and optimal retrospective inferences [<xref rid="pcbi.1009347.ref014" ref-type="bibr">14</xref>]. By reinterpreting <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> as a Markov state <xref rid="pcbi.1009347.e047" ref-type="disp-formula">Eq (4)</xref> observed through a noisy renewal process (<xref rid="pcbi.1009347.e009" ref-type="disp-formula">Eq (1)</xref>) and defining <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> on a predetermined grid <inline-formula id="pcbi.1009347.e123"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.e123.jpg" id="pcbi.1009347.e123g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M123" display="inline" overflow="scroll"><mml:mi mathvariant="script">R</mml:mi></mml:math></alternatives></inline-formula>, we were able to construct exact filtering (<xref rid="pcbi.1009347.e053" ref-type="disp-formula">Eq (5)</xref>) and smoothing (<xref rid="pcbi.1009347.e069" ref-type="disp-formula">Eq (6)</xref>) solutions. This led to EpiFilter, which is our central contribution. Generally, filtering and smoothing can be involved and require sophisticated sequential Monte Carlo techniques [<xref rid="pcbi.1009347.ref032" ref-type="bibr">32</xref>]. However, because we make only minimal assumptions about <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub>, modelling it as a simple diffusion, we were able to solve these problems exactly and without complex sampling algorithms [<xref rid="pcbi.1009347.ref029" ref-type="bibr">29</xref>].</p>
    <p>Our solutions are computationally simple, often executing in a few minutes (see Fig A of the <xref rid="pcbi.1009347.s001" ref-type="supplementary-material">S1 Appendix</xref>), and deterministic i.e., precisely reproducible given the same data and settings. Our method replaces strong change-point or window size assumptions with one free parameter, <italic toggle="yes">η</italic>, which allows us to model some heterogeneity in transmission and sets the correlation among successive <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> values. We find that <italic toggle="yes">η</italic> = 0.1 serves as a general heuristic, providing good estimates and automatically detecting change-points and salient <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> dynamics over diverse scenarios (see Figs <xref rid="pcbi.1009347.g002" ref-type="fig">2</xref> and <xref rid="pcbi.1009347.g004" ref-type="fig">4</xref>, and Fig B in <xref rid="pcbi.1009347.s001" ref-type="supplementary-material">S1 Appendix</xref>). This heuristic is statistically justified by its good one-step-ahead predictive performance and consistent coverage of true simulated values (see Fig C-D of the <xref rid="pcbi.1009347.s001" ref-type="supplementary-material">S1 Appendix</xref>) [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>].</p>
    <p>Importantly, EpiFilter is able to look both forward and backward through the incidence data, and so maximise the information extracted at every time point [<xref rid="pcbi.1009347.ref034" ref-type="bibr">34</xref>]. This property means it combines advantages from both EpiEstim and the WT method (see <xref rid="pcbi.1009347.g001" ref-type="fig">Fig 1</xref>) and largely ameliorates their edge-effect issues [<xref rid="pcbi.1009347.ref012" ref-type="bibr">12</xref>]. These benefits, which also hold at large incidence, make EpiFilter a useful and robust tool for both real-time and retrospective <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> inference. We confirmed the advantages of EpiFilter by comparing it to EpiEstim and APEestim (a prediction optimised analogue to EpiEstim) on many simulated examples with periods of low incidence and epidemic resurgences (Figs <xref rid="pcbi.1009347.g002" ref-type="fig">2</xref> and <xref rid="pcbi.1009347.g004" ref-type="fig">4</xref>). Interestingly, we found EpiFilter was able to achieve significant 2–10 fold reductions in the MSE of <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> estimates without compromising predictive power or coverage of the true <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> and <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> values.</p>
    <p>EpiFilter was especially better at negotiating periods of low incidence, offering a graceful degradation to its prior distribution or assumptions without sacrificing predictive accuracy. When incidence is low, it can be beneficial to use longer windows with EpiEstim [<xref rid="pcbi.1009347.ref028" ref-type="bibr">28</xref>]. This keeps <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> estimates reasonably stable but often leads to poor predictions [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>]. APEestim, which optimises window size for prediction fidelity, showed that in many of the simulated scenarios short windows are necessary for describing transmission patterns. Consequently, we have a trade-off between estimate robustness and prediction accuracy. We found that EpiFilter overcomes this trade-off, concurrently achieving good estimates and predictions. In doing so, it revealed or clarified subcritical transmission trends and unmasked important signals of resurgence from noisy data in those periods.</p>
    <p>We verified the practical utility and performance of EpiFilter on empirical data from the H1N1 pandemic of 1918 (see <xref rid="pcbi.1009347.g006" ref-type="fig">Fig 6</xref>) and COVID-19 in New Zealand (see <xref rid="pcbi.1009347.g007" ref-type="fig">Fig 7</xref>). In the first, which is a standard dataset that has been used to test previous <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> methods, we found that EpiFilter integrated the benefits of EpiEstim and APEestim to achieve simultaneously good estimates and predictions. A key use-case for EpiFilter is in estimating resurgence during low incidence. The COVID-19 epidemic in New Zealand featured precisely those dynamics [<xref rid="pcbi.1009347.ref046" ref-type="bibr">46</xref>]. While EpiEstim and APEestim were destabilised and unable to extract clear transmission trends, EpiFilter inferred subcritical <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> values and warned of upcoming cases by signalling an uptick in <italic toggle="yes">R</italic><sub><italic toggle="yes">s</italic></sub> just before a second wave become apparent. Recent, more involved COVID-19 analyses [<xref rid="pcbi.1009347.ref039" ref-type="bibr">39</xref>], have confirmed EpiFilter as a useful outbreak analytics tool.</p>
    <p>Balancing the assumptions inherent to a model against the data it is applied on, to produce reliable inference is a non-trivial problem that is still under active investigation in several fields [<xref rid="pcbi.1009347.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1009347.ref040" ref-type="bibr">40</xref>, <xref rid="pcbi.1009347.ref041" ref-type="bibr">41</xref>]. EpiFilter, by maximising the information extracted from available incidence data and minimising its state space model assumptions, appears to strike this balance as an estimator of instantaneous or effective reproduction numbers. Consequently, it performs strongly on a wide range of problems, including those involving sparse data, where other methods might struggle. Given its demonstrated advantages, straightforward formulation and theoretical underpinning, we hope that EpiFilter will prove a useful diagnostic tool for robustly signalling waves of infection across multiple scales, improving the uncertainty quantification of transmissibility estimates and assessing dynamical transmission patterns, both in real time and retrospectively. EpiFilter is freely available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/kpzoo/EpiFilter" ext-link-type="uri">https://github.com/kpzoo/EpiFilter</ext-link>.</p>
  </sec>
  <sec id="sec012" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1009347.s001" position="float" content-type="local-data">
      <label>S1 Appendix</label>
      <caption>
        <title>Validating the mechanics and performance of EpiFilter.</title>
        <p>This includes analyses of computational complexity, further examples showing performance and calculation of coverage statistics (additionally supporting Figs <xref rid="pcbi.1009347.g002" ref-type="fig">2</xref>–<xref rid="pcbi.1009347.g005" ref-type="fig">5</xref> of the main text). Results are embedded within Figs A-D of the S1 Appendix. <bold>Fig A</bold>: <bold>EpiFilter mechanics</bold>. We examine the computational complexity (as a function of grid size <italic toggle="yes">m</italic> on the examples in Figs <xref rid="pcbi.1009347.g006" ref-type="fig">6</xref> and <xref rid="pcbi.1009347.g007" ref-type="fig">7</xref>) and accuracy (in terms of <italic toggle="yes">m</italic> and state noise <italic toggle="yes">η</italic>) of EpiFilter. <bold>Fig B</bold>: <bold>Validation against APEestim</bold>. We compare estimates from EpiFilter with optimised ones from APEestim [<xref rid="pcbi.1009347.ref013" ref-type="bibr">13</xref>] over various general epidemic scenarios (which may have large or small incidence). <bold>Fig C</bold>: <bold>Coverage statistics of waning epidemics</bold> We provide the probability that the true values of instantaneous reproduction numbers and incidence from scenarios in <xref rid="pcbi.1009347.g003" ref-type="fig">Fig 3</xref> are within EpiFilter’s 95% credible intervals. <bold>Fig D</bold>: <bold>Coverage statistics of resurging epidemics</bold>. We provide the probability that the true values of instantaneous reproduction numbers and incidence from scenarios in <xref rid="pcbi.1009347.g005" ref-type="fig">Fig 5</xref> are within EpiFilter’s 95% credible intervals.</p>
        <p>(PDF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009347.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>Thanks to Christl A Donnelly for thoughtful and helpful comments.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1009347.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Fraser</surname><given-names>C</given-names></name>. <article-title>Estimating Individual and Household Reproduction Numbers in an Emerging Epidemic</article-title>. <source>PLOS One</source>. <year>2007</year>;<volume>8</volume>:<fpage>e758</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0000758</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Wallinga</surname><given-names>J</given-names></name>, <name><surname>Teunis</surname><given-names>P</given-names></name>. <article-title>Different Epidemic Curves for Severe Acute Respiratory Syndrome Reveal Similar Impacts of Control Measures</article-title>. <source>Am J Epidemiol</source>. <year>2004</year>;<volume>160</volume>(<issue>6</issue>):<fpage>509</fpage>–<lpage>16</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/aje/kwh255</pub-id><?supplied-pmid 15353409?><pub-id pub-id-type="pmid">15353409</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref003">
      <label>3</label>
      <mixed-citation publication-type="book"><name><surname>Nishiura</surname><given-names>H</given-names></name>, <name><surname>Chowell</surname><given-names>G</given-names></name>. <part-title>The Effective Reproduction Number as a Prelude to Statistical Estimation of Time-Dependent Epidemic Trends</part-title>. In: <source>Mathematical and statistical estimation approaches in epidemiology</source>. <publisher-name>Springer</publisher-name>; <year>2009</year>. p. <fpage>103</fpage>–<lpage>21</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref004">
      <label>4</label>
      <mixed-citation publication-type="book"><name><surname>Anderson</surname><given-names>R</given-names></name>, <name><surname>May</surname><given-names>R</given-names></name>. <source>Infectious diseases of humans: dynamics and control</source>. <publisher-name>Oxford University Press</publisher-name>; <year>1991</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Cauchemez</surname><given-names>S</given-names></name>, <name><surname>Boelle</surname><given-names>P</given-names></name>, <name><surname>Thomas</surname><given-names>G</given-names></name>, <name><surname>Valleron</surname><given-names>A</given-names></name>. <article-title>Estimating in Real Time the Efficacy of Measures to Control Emerging Communicable Diseases</article-title>. <source>Am J Epidemiol</source>. <year>2006</year>;<volume>164</volume>(<issue>6</issue>):<fpage>591</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/aje/kwj274</pub-id><?supplied-pmid 16887892?><pub-id pub-id-type="pmid">16887892</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Churcher</surname><given-names>T</given-names></name>, <name><surname>Cohen</surname><given-names>J</given-names></name>, <name><surname>Novotny</surname><given-names>J</given-names></name>, <name><surname>Ntshalintshali</surname><given-names>N</given-names></name>, <name><surname>Kunene</surname><given-names>S</given-names></name>, <name><surname>Cauchemez</surname><given-names>S</given-names></name>. <article-title>Measuring the path toward malaria elimination</article-title>. <source>Science</source>. <year>2014</year>;<volume>344</volume>(<issue>6189</issue>):<fpage>1230</fpage>–<lpage>32</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1251449</pub-id><?supplied-pmid 24926005?><pub-id pub-id-type="pmid">24926005</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><collab>WHO Ebola Response Team</collab>. <article-title>Ebola Virus Disease in West Africa—The First 9 Months of the Epidemic and Forward Projections</article-title>. <source>N Engl J Med</source>. <year>2014</year>;<volume>371</volume>(<issue>16</issue>):<fpage>1481</fpage>–<lpage>95</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1056/NEJMoa1411100</pub-id><pub-id pub-id-type="pmid">25244186</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Bhatia</surname><given-names>S</given-names></name>, <name><surname>Parag</surname><given-names>K</given-names></name>, <name><surname>Wardle</surname><given-names>J</given-names></name>, <name><surname>Imai</surname><given-names>N</given-names></name>, <name><surname>Van Elsland</surname><given-names>S</given-names></name>, <name><surname>Lassmann</surname><given-names>B</given-names></name><etal>et al</etal>. <article-title>Global predictions of short- to medium-term COVID-19 transmission trends: a retrospective assessment</article-title>. <source>medRxiv</source><year>2021</year>;2021.07.19.21260746.</mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Flaxman</surname><given-names>S</given-names></name>, <name><surname>Mishra</surname><given-names>S</given-names></name>, <name><surname>Gandy</surname><given-names>A</given-names></name>, <name><surname>Unwin</surname><given-names>H</given-names></name>, <name><surname>Coupland</surname><given-names>H</given-names></name>, <name><surname>Mellan</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Estimating the effects of non-pharmaceutical interventions on COVID-19 in Europe</article-title>. <source>Nature</source>. <year>2020</year>;<volume>584</volume>:<fpage>257</fpage>–<lpage>261</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-020-2405-7</pub-id><?supplied-pmid 32512579?><pub-id pub-id-type="pmid">32512579</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Hao</surname><given-names>X</given-names></name>, <name><surname>Cheng</surname><given-names>S</given-names></name>, <name><surname>Wu</surname><given-names>D</given-names></name>, <name><surname>Wu</surname><given-names>T</given-names></name>, <name><surname>Lin</surname><given-names>X</given-names></name>, <name><surname>Wang</surname><given-names>C</given-names></name>. <article-title>Reconstruction of the full transmission dynamics of COVID-19 in Wuhan</article-title>. <source>Nature</source>. <year>2020</year>;<volume>584</volume>:<fpage>420</fpage>–<lpage>4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-020-2554-8</pub-id><?supplied-pmid 32674112?><pub-id pub-id-type="pmid">32674112</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Cori</surname><given-names>A</given-names></name>, <name><surname>Ferguson</surname><given-names>N</given-names></name>, <name><surname>Fraser</surname><given-names>C</given-names></name>, <name><surname>Cauchemez</surname><given-names>S</given-names></name>. <article-title>A New Framework and Software to Estimate Time-Varying Reproduction Numbers During Epidemics</article-title>. <source>Am J Epidemiol</source>. <year>2013</year>;<volume>178</volume>(<issue>9</issue>):<fpage>1505</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/aje/kwt133</pub-id><?supplied-pmid 24043437?><pub-id pub-id-type="pmid">24043437</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Gostic</surname><given-names>K</given-names></name>, <name><surname>McGough</surname><given-names>L</given-names></name>, <name><surname>Baskerville</surname><given-names>E</given-names></name>, <name><surname>Abbott</surname><given-names>S</given-names></name>, <name><surname>Joshi</surname><given-names>K</given-names></name>, <name><surname>Tedijanto</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Practical considerations for measuring the effective reproductive number, Rt</article-title>. <source>PLOS Comput Biol</source>. <year>2020</year>;<volume>16</volume>(<issue>12</issue>):<fpage>e1008409</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008409</pub-id><?supplied-pmid 33301457?><pub-id pub-id-type="pmid">33301457</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Parag</surname><given-names>K</given-names></name>, <name><surname>Donnelly</surname><given-names>C</given-names></name>. <article-title>Using information theory to optimise epidemic models for real-time prediction and estimation</article-title>. <source>PLOS Comput Biol</source>. <year>2020</year>;<volume>16</volume>(<issue>7</issue>):<fpage>e1007990</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007990</pub-id><?supplied-pmid 32609732?><pub-id pub-id-type="pmid">32609732</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref014">
      <label>14</label>
      <mixed-citation publication-type="book"><name><surname>Sarrka</surname><given-names>S</given-names></name>. <source>Bayesian Filtering and Smoothing</source>. <publisher-loc>Cambridge, UK</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>2013</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Parag</surname><given-names>K</given-names></name>, <name><surname>Pybus</surname><given-names>O</given-names></name>, <name><surname>Wu</surname><given-names>C</given-names></name>. <article-title>Are skyline plot-based demographic estimates overly dependent on smoothing prior assumptions?</article-title><source>Syst Biol</source>. <year>2021</year>;syab037. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syab037</pub-id><?supplied-pmid 33989428?><pub-id pub-id-type="pmid">33989428</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Britton</surname><given-names>T</given-names></name>, <name><surname>House</surname><given-names>T</given-names></name>, <name><surname>Lloyd</surname><given-names>A</given-names></name>, <name><surname>Mollison</surname><given-names>D</given-names></name>, <name><surname>Riley</surname><given-names>S</given-names></name>, <name><surname>Trapman</surname><given-names>P</given-names></name>. <article-title>Five challenges for stochastic epidemic models involving global transmission</article-title>. <source>Epidemics</source>. <year>2015</year>;<volume>10</volume>:<fpage>54</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.epidem.2014.05.002</pub-id><?supplied-pmid 25843384?><pub-id pub-id-type="pmid">25843384</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Thompson</surname><given-names>R</given-names></name>, <name><surname>Hollingsworth</surname><given-names>D</given-names></name>, <name><surname>Isham</surname><given-names>V</given-names></name>, <name><surname>Arribas-Bel</surname><given-names>D</given-names></name>, <name><surname>Ashby</surname><given-names>B</given-names></name>, <name><surname>Britton</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Key questions for modelling COVID-19 exit strategies</article-title>. <source>Proc R Soc B</source>. <year>2020</year>;<volume>287</volume>(<issue>1932</issue>):<fpage>20201405</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rspb.2020.1405</pub-id><?supplied-pmid 32781946?><pub-id pub-id-type="pmid">32781946</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref018">
      <label>18</label>
      <mixed-citation publication-type="book"><name><surname>Astrom</surname><given-names>K</given-names></name>, <name><surname>Murray</surname><given-names>R</given-names></name>. <source>Feedback Systems: An Introduction for Scientists and Engineers</source>. <publisher-loc>New Jersey</publisher-loc>: <publisher-name>Princeton University Press</publisher-name>; <year>2008</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Riley</surname><given-names>S</given-names></name>, <name><surname>Eames</surname><given-names>K</given-names></name>, <name><surname>Isham</surname><given-names>V</given-names></name>, <name><surname>Mollison</surname><given-names>D</given-names></name>, <name><surname>Trapman</surname><given-names>P</given-names></name>. <article-title>Five challenges for spatial epidemic models</article-title>. <source>Epidemics</source>. <year>2015</year>;<volume>10</volume>(<issue>68-71</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.epidem.2014.07.001</pub-id><?supplied-pmid 25843387?><pub-id pub-id-type="pmid">25843387</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Wallinga</surname><given-names>J</given-names></name>, <name><surname>Lipsitch</surname><given-names>M</given-names></name>. <article-title>How generation intervals shape the relationship between growth rates and reproductive numbers</article-title>. <source>Proc R Soc B</source>. <year>2007</year>;<volume>274</volume>:<fpage>599</fpage>–<lpage>604</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rspb.2006.3754</pub-id><?supplied-pmid 17476782?><pub-id pub-id-type="pmid">17476782</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Q</given-names></name>, <name><surname>Ajelli</surname><given-names>M</given-names></name>, <name><surname>Aleta</surname><given-names>A</given-names></name>, <name><surname>Merlerd</surname><given-names>S</given-names></name>, <name><surname>Morenoe</surname><given-names>Y</given-names></name>, <name><surname>Vespignani</surname><given-names>A</given-names></name>. <article-title>Measurability of the epidemic reproduction number in data-driven contact networks</article-title>. <source>PNAS</source>. <year>2018</year>;<volume>115</volume>(<issue>50</issue>):<fpage>12680</fpage>–<lpage>85</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1811115115</pub-id><?supplied-pmid 30463945?><pub-id pub-id-type="pmid">30463945</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Britton</surname><given-names>T</given-names></name>, <name><surname>Tomba</surname><given-names>G</given-names></name>. <article-title>Estimation in emerging epidemics: biases and remedies</article-title>. <source>J R Soc Interface</source>. <year>2019</year>;<volume>16</volume>(<issue>150</issue>):<fpage>20180670</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rsif.2018.0670</pub-id><?supplied-pmid 30958162?><pub-id pub-id-type="pmid">30958162</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref023">
      <label>23</label>
      <mixed-citation publication-type="book"><name><surname>Snyder</surname><given-names>D</given-names></name>, <name><surname>Miller</surname><given-names>M</given-names></name>. <source>Random Point Processes in Time and Space</source>. <edition designator="2">2nd ed</edition>. <publisher-name>Springer-Verlag</publisher-name>; <year>1991</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Kalman</surname><given-names>R</given-names></name>. <article-title>A new approach to linear filtering and prediction problems</article-title>. <source>Trans ASME J Basic Eng</source>. <year>1960</year>;<volume>82</volume>:<fpage>35</fpage>–<lpage>45</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1115/1.3662552</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Anderson</surname><given-names>B</given-names></name>, <name><surname>Rhodes</surname><given-names>I</given-names></name>. <article-title>Smoothing Algorithms for Nonlinear Finite-Dimensional Systems</article-title>. <source>Stochastics</source>. <year>1983</year>;<volume>9</volume>:<fpage>139</fpage>–<lpage>65</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/17442508308833251</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Parag</surname><given-names>K</given-names></name>, <name><surname>Donnelly</surname><given-names>C</given-names></name>. <article-title>Adaptive Estimation for Epidemic Renewal and Phylogenetic Skyline Models</article-title>. <source>Syst Biol</source>. <year>2020</year>;<volume>69</volume>(<issue>6</issue>):<fpage>1163</fpage>–<lpage>79</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syaa035</pub-id><?supplied-pmid 32333789?><pub-id pub-id-type="pmid">32333789</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Rothenberg</surname><given-names>T</given-names></name>. <article-title>Identification in Parametric Models</article-title>. <source>Econometrica</source>. <year>1971</year>;<volume>39</volume>(<issue>3</issue>):<fpage>577</fpage>–<lpage>91</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2307/1913267</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Parag</surname><given-names>K</given-names></name>, <name><surname>Donnelly</surname><given-names>C</given-names></name>, <name><surname>Jha</surname><given-names>R</given-names></name>, <name><surname>Thompson</surname><given-names>R</given-names></name>. <article-title>An exact method for quantifying the reliability of end-of-epidemic declarations in real time</article-title>. <source>PLOS Comput Biol</source>. <year>2020</year>;<volume>16</volume>(<issue>11</issue>):<fpage>e1008478</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1008478</pub-id><?supplied-pmid 33253158?><pub-id pub-id-type="pmid">33253158</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Parag</surname><given-names>K</given-names></name>, <name><surname>Pybus</surname><given-names>O</given-names></name>. <article-title>Exact Bayesian Inference for Phylogenetic Birth-death Models</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>21</issue>):<fpage>3638</fpage>–<lpage>45</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty337</pub-id><?supplied-pmid 29718104?><pub-id pub-id-type="pmid">29718104</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Parag</surname><given-names>K</given-names></name>, <name><surname>Vinnicombe</surname><given-names>G</given-names></name>. <article-title>Point Process Analysis of Noise in Early Invertebrate Vision</article-title>. <source>PLOS Comput Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>10</issue>):<fpage>e1005687</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005687</pub-id><?supplied-pmid 29077703?><pub-id pub-id-type="pmid">29077703</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Zechner</surname><given-names>C</given-names></name>, <name><surname>Koeppl</surname><given-names>H</given-names></name>. <article-title>Uncoupled Analysis of Stochastic Reaction Networks in Fluctuating Environments</article-title>. <source>PLOS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>12</issue>):<fpage>e1003942</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003942</pub-id><?supplied-pmid 25473849?><pub-id pub-id-type="pmid">25473849</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>Z</given-names></name>. <article-title>Bayesian Filtering: From Kalman Filters to Particle Filters, and Beyond</article-title>. <source>Statistics</source>. <year>2003</year>;<volume>182</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>69</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Allen</surname><given-names>L</given-names></name>. <article-title>A primer on stochastic epidemic models: Formulation, numerical simulation, and analysis</article-title>. <source>Infect Dis Model</source>. <year>2017</year>;<volume>2</volume>:<fpage>128</fpage>–<lpage>142</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.idm.2017.03.001</pub-id><?supplied-pmid 29928733?><pub-id pub-id-type="pmid">29928733</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>D</given-names></name>, <name><surname>Shamai</surname><given-names>D</given-names></name>, <name><surname>Verdu</surname><given-names>S</given-names></name>. <article-title>Mutual Information and Minimum Mean-Square Error in Gaussian Channels</article-title>. <source>IEEE Trans Info Theo</source>. <year>2005</year>;<volume>51</volume>(<issue>4</issue>):<fpage>1261</fpage>–<lpage>82</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TIT.2005.844072</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Funk</surname><given-names>S</given-names></name>, <name><surname>Camacho</surname><given-names>A</given-names></name>, <name><surname>Kucharski</surname><given-names>A</given-names></name>, <name><surname>LoweI</surname><given-names>R</given-names></name>, <name><surname>Eggo</surname><given-names>R</given-names></name>, <name><surname>Edmunds</surname><given-names>W</given-names></name>. <article-title>Assessing the performance of real-time epidemic forecasts: A case study of Ebola in the Western Area region of Sierra Leone, 2014-15</article-title>. <source>PLOS Comput Biol</source>. <year>2019</year>;<volume>15</volume>(<issue>2</issue>):<fpage>e1006785</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006785</pub-id><?supplied-pmid 30742608?><pub-id pub-id-type="pmid">30742608</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Nouvellet</surname><given-names>P</given-names></name>, <name><surname>Cori</surname><given-names>A</given-names></name>, <name><surname>Garske</surname><given-names>T</given-names></name>, <name><surname>Blake</surname><given-names>I</given-names></name>, <name><surname>Dorigattia</surname><given-names>I</given-names></name>, <name><surname>Hinsley</surname><given-names>W</given-names></name>, <etal>et al</etal>. <article-title>A simple approach to measure transmissibility and forecast incidence</article-title>. <source>Epidemics</source>. <year>2018</year>;<volume>22</volume>:<fpage>29</fpage>–<lpage>35</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.epidem.2017.02.012</pub-id><?supplied-pmid 28351674?><pub-id pub-id-type="pmid">28351674</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Van Kerkhove</surname><given-names>M</given-names></name>, <name><surname>Bento</surname><given-names>A</given-names></name>, <name><surname>Mills</surname><given-names>H</given-names></name>, <name><surname>Ferguson</surname><given-names>N</given-names></name>, <name><surname>Donnelly</surname><given-names>C</given-names></name>. <article-title>A review of epidemiological parameters from Ebola outbreaks to inform early public health decision-making</article-title>. <source>Sci Data</source>. <year>2015</year>;<volume>2</volume>:<fpage>150019</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/sdata.2015.19</pub-id><?supplied-pmid 26029377?><pub-id pub-id-type="pmid">26029377</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Wagenmakers</surname><given-names>E</given-names></name>, <name><surname>Grunwald</surname><given-names>P</given-names></name>, <name><surname>Steyvers</surname><given-names>M</given-names></name>. <article-title>Accumulative prediction error and the selection of time series models</article-title>. <source>J Math Psychol</source>. <year>2006</year>;<volume>50</volume>:<fpage>149</fpage>–<lpage>166</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.jmp.2006.01.004</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Parag</surname><given-names>K</given-names></name>, <name><surname>Cowling</surname><given-names>B</given-names></name>, <name><surname>Donnelly</surname><given-names>C</given-names></name>. <article-title>Deciphering early-warning signals of the elimination and resurgence potential of SARS-CoV-2 from limited data at multiple scales</article-title>. <source>medRxiv</source>. <year>2021</year>;2020.11.23.20236968.</mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Volz</surname><given-names>E</given-names></name>, <name><surname>Didelot</surname><given-names>X</given-names></name>. <article-title>Modeling the Growth and Decline of Pathogen Effective Population Size Provides Insight into Epidemic Dynamics and Drivers of Antimicrobial Resistance</article-title>. <source>Syst Biol</source>. <year>2018</year>;<volume>67</volume>(<issue>4</issue>):<fpage>719</fpage>–<lpage>28</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syy007</pub-id><?supplied-pmid 29432602?><pub-id pub-id-type="pmid">29432602</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Faulkner</surname><given-names>J</given-names></name>, <name><surname>Magee</surname><given-names>A</given-names></name>, <name><surname>Shapiro</surname><given-names>B</given-names></name>, <name><surname>Minin</surname><given-names>V</given-names></name>. <article-title>Horseshoe-based Bayesian Nonparametric Estimation of Effective Population Size Trajectories</article-title>. <source>Biometrics</source>. <year>2020</year>;<volume>76</volume>(<issue>3</issue>):<fpage>677</fpage>–<lpage>90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/biom.13273</pub-id><?supplied-pmid 32277713?><pub-id pub-id-type="pmid">32277713</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Frost</surname><given-names>W</given-names></name>, <name><surname>Sydenstricker</surname><given-names>E</given-names></name>. <article-title>Influenza in Maryland: preliminary statistics of certain localities</article-title>. <source>Public Health Rep</source>. <year>1919</year>;<volume>34</volume>:<fpage>491</fpage>–<lpage>504</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2307/4575056</pub-id><pub-id pub-id-type="pmid">19314660</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref043">
      <label>43</label>
      <mixed-citation publication-type="other">WHO. WHO Coronavirus Disease (COVID-19) Dashboard; 2020. Available from: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://covid19.who.int/" ext-link-type="uri">https://covid19.who.int/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Cousins</surname><given-names>S</given-names></name>. <article-title>New Zealand eliminates COVID-19</article-title>. <source>Lancet</source>. <year>2020</year>;<volume>395</volume>:<fpage>1474</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0140-6736(20)31097-7</pub-id><?supplied-pmid 32386582?><pub-id pub-id-type="pmid">32386582</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref045">
      <label>45</label>
      <mixed-citation publication-type="other">Ritchie H, Ortiz-Ospina E, Beltekian D, Mathieu E, Hasell J, Macdonald B, et al. Coronavirus Pandemic (COVID-19); 2020. Available from: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://ourworldindata.org/coronavirus" ext-link-type="uri">https://ourworldindata.org/coronavirus</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Jefferies</surname><given-names>S</given-names></name>, <name><surname>French</surname><given-names>N</given-names></name>, <name><surname>Gilkison</surname><given-names>C</given-names></name>, <name><surname>Graham</surname><given-names>G</given-names></name>, <name><surname>Hope</surname><given-names>V</given-names></name>, <name><surname>Marshall</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>COVID-19 in New Zealand and the impact of the national response: a descriptive epidemiological study</article-title>. <source>Lancet Public Health</source>. <year>2020</year>;<volume>5</volume>(<issue>11</issue>):<fpage>e612</fpage>–<lpage>23</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S2468-2667(20)30225-5</pub-id><?supplied-pmid 33065023?><pub-id pub-id-type="pmid">33065023</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref047">
      <label>47</label>
      <mixed-citation publication-type="book"><name><surname>Ferguson</surname><given-names>N</given-names></name>, <name><surname>Laydon</surname><given-names>D</given-names></name>, <name><surname>Nedjati-Gilani</surname><given-names>G</given-names></name>, <name><surname>Imai</surname><given-names>N</given-names></name>, <name><surname>Ainslie</surname><given-names>K</given-names></name>, <name><surname>Baguelin</surname><given-names>M</given-names></name>, <etal>et al</etal>. <source>Impact of non-pharmaceutical interventions (NPIs) to reduce COVID- 19 mortality and healthcare demand</source>. <publisher-name>Imperial College</publisher-name><publisher-loc>London</publisher-loc>; <year>2020</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Ganyani</surname><given-names>T</given-names></name>, <name><surname>Kremer</surname><given-names>C</given-names></name>, <name><surname>Dongxuan</surname><given-names>C</given-names></name>, <name><surname>Torneri</surname><given-names>A</given-names></name>, <name><surname>Faes</surname><given-names>C</given-names></name>, <name><surname>Wallinga</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Estimating the generation interval for coronavirus disease (COVID-19) based on symptom onset data, March 2020</article-title>. <source>Euro Surveill</source>. <year>2020</year>;<volume>25</volume>(<issue>17</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.2807/1560-7917.ES.2020.25.17.2000257</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref049">
      <label>49</label>
      <mixed-citation publication-type="book"><name><surname>Anderson</surname><given-names>R</given-names></name>, <name><surname>Donnelly</surname><given-names>C</given-names></name>, <name><surname>Hollingsworth</surname><given-names>D</given-names></name>, <name><surname>Keeling</surname><given-names>M</given-names></name>, <name><surname>Vegvari</surname><given-names>C</given-names></name>, <name><surname>Baggaley</surname><given-names>R</given-names></name><etal>et al</etal>. <source>Reproduction number (R) and growth rate (r) of the COVID-19 epidemic in the UK: methods of estimation, data sources, causes of heterogeneity, and use as a guide in policy formulation</source>. <publisher-name>The Royal Society</publisher-name>; <year>2020</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1009347.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Campbell</surname><given-names>H</given-names></name>, <name><surname>Kulkarni</surname><given-names>D</given-names></name>, <name><surname>Harpur</surname><given-names>A</given-names></name>, <name><surname>Nundy</surname><given-names>M</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <etal>et al</etal>. <article-title>The temporal association of introducing and lifting non-pharmaceutical interventions with the time-varying reproduction number (R) of SARS-CoV-2: a modelling study across 131 countries</article-title>. <source>Lancet Infect Dis</source>. <year>2020</year>;<volume>21</volume>(<issue>2</issue>):<fpage>193</fpage>–<lpage>202</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S1473-3099(20)30785-4</pub-id><?supplied-pmid 33729915?><pub-id pub-id-type="pmid">33729915</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
