<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NPG//DTD XML Article//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName NPG_XML_Article.dtd?>
<?SourceDTD.Version 2.7.10?>
<?ConverterInfo.XSLTName nature2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5353602</article-id>
    <article-id pub-id-type="pii">srep44437</article-id>
    <article-id pub-id-type="doi">10.1038/srep44437</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ThermoAlign: a genome-aware primer design tool for tiled amplicon resequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Francis</surname>
          <given-names>Felix</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dumas</surname>
          <given-names>Michael D.</given-names>
        </name>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wisser</surname>
          <given-names>Randall J.</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <aff id="a1"><label>1</label><institution>Center for Bioinformatics and Computational Biology, University of Delaware</institution>, Newark, DE 19714, <country>USA</country></aff>
      <aff id="a2"><label>2</label><institution>Department of Plant and Soil Sciences, University of Delaware, Newark</institution>, DE 19716-1304, <country>USA</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email>rjw@udel.edu</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>03</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>44437</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>10</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>08</day>
        <month>02</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2017, The Author(s)</copyright-statement>
      <copyright-year>2017</copyright-year>
      <copyright-holder>The Author(s)</copyright-holder>
      <license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <!--author-paid-->
        <license-p>This work is licensed under a Creative Commons Attribution 4.0 International License. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p>Isolating and sequencing specific regions in a genome is a cornerstone of molecular biology. This has been facilitated by computationally encoding the thermodynamics of DNA hybridization for automated design of hybridization and priming oligonucleotides. However, the repetitive composition of genomes challenges the identification of target-specific oligonucleotides, which limits genetics and genomics research on many species. Here, a tool called ThermoAlign was developed that ensures the design of target-specific primer pairs for DNA amplification. This is achieved by evaluating the thermodynamics of hybridization for full-length oligonucleotide-template alignments — <italic>thermoalignments</italic> — across the genome to identify primers predicted to bind specifically to the target site. For amplification-based resequencing of regions that cannot be amplified by a single primer pair, a directed graph analysis method is used to identify minimum amplicon tiling paths. Laboratory validation by standard and long-range polymerase chain reaction and amplicon resequencing with maize, one of the most repetitive genomes sequenced to date (≈85% repeat content), demonstrated the specificity-by-design functionality of ThermoAlign. ThermoAlign is released under an open source license and bundled in a dependency-free container for wide distribution. It is anticipated that this tool will facilitate multiple applications in genetics and genomics and be useful in the workflow of high-throughput targeted resequencing studies.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>Isolating homologous DNA sequence from individuals at specific regions of a genome is fundamental to research and applications in genetics and genomics. Despite the advent of high-throughput sequencing technologies, obtaining a fully contiguous and accurate region-specific consensus sequence for multiple individuals from whole-genome DNA libraries can be cost prohibitive, unnecessary or inefficient. This is particularly challenging for investigations of large genomes and when surveying variation in population studies where hundreds to thousands of individuals are concerned. Consequently, a number of techniques have been devised for targeted enrichment, including microarray-based sequence capture (e.g. refs <xref ref-type="bibr" rid="b1">1</xref> and <xref ref-type="bibr" rid="b2">2</xref>), molecular inversion probes (e.g. ref. <xref ref-type="bibr" rid="b3">3</xref>)and PCR (e.g. ref. <xref ref-type="bibr" rid="b4">4</xref>), each of which require the design of target-specific hybridization or priming oligonucleotides.</p>
  <p>Genomes contain varying degrees of repetitive DNA<xref ref-type="bibr" rid="b5">5</xref>, and for many species this represents the major fraction of the genome. It has been estimated that &gt;50%<xref ref-type="bibr" rid="b6">6</xref> and as much as 69%<xref ref-type="bibr" rid="b7">7</xref> of the human genome is repetitive, and over 80% of the genomes for some plant species is repetitive (e.g. refs <xref ref-type="bibr" rid="b8">8</xref> and <xref ref-type="bibr" rid="b9">9</xref>). This poses a significant challenge to designing oligonucleotides that will hybridize and prime only on-target. Targeted enrichment approaches relying on hybridization-based DNA capture can result in off-target sequences being captured due to nonspecific binding<xref ref-type="bibr" rid="b10">10</xref><xref ref-type="bibr" rid="b11">11</xref><xref ref-type="bibr" rid="b12">12</xref>. Similarly, primers used for amplification-based approaches may produce off-target products<xref ref-type="bibr" rid="b13">13</xref><xref ref-type="bibr" rid="b14">14</xref>. This presents the need for “genome-aware” oligonucleotide design tools that leverage reference genome sequence data to maximize the enrichment of on-target sequences.</p>
  <p>Although there are several computational tools now available that facilitate genome-aware primer design<xref ref-type="bibr" rid="b15">15</xref><xref ref-type="bibr" rid="b16">16</xref><xref ref-type="bibr" rid="b17">17</xref><xref ref-type="bibr" rid="b18">18</xref>, obtaining specific amplification of targeted sequences is still a difficult problem, especially for genomes with large amounts of repetitive DNA. A popular tool for choosing primers is Primer-BLAST<xref ref-type="bibr" rid="b19">19</xref>, which integrates Primer3 for primer design with BLAST and Needleman-Wunsch alignments for evaluating primer specificity. The number of non-complementary bases in sequence alignments is used as the basis for a specificity filter to select candidate primers. However, several factors contribute to the mispriming potential of primers including temperature, reaction chemistry, nucleotide composition and the position and type of mismatching nucleotides<xref ref-type="bibr" rid="b20">20</xref>, such that the number of mismatches alone is likely to be an insufficient measure of mispriming potential.</p>
  <p>Given the availability of empirical data on the thermodynamics of hybridization for complementary<xref ref-type="bibr" rid="b21">21</xref> and non-complementary<xref ref-type="bibr" rid="b22">22</xref><xref ref-type="bibr" rid="b23">23</xref><xref ref-type="bibr" rid="b24">24</xref><xref ref-type="bibr" rid="b25">25</xref><xref ref-type="bibr" rid="b26">26</xref> base pairings, genome-wide estimates of the thermodynamics of primer-template hybridization can be incorporated into the selection process for oligonucleotide design tools. Indeed, some algorithms have used this approach, including specificity-determining subsequence (SDSS)<xref ref-type="bibr" rid="b13">13</xref><xref ref-type="bibr" rid="b27">27</xref><xref ref-type="bibr" rid="b28">28</xref>, MFEprimer-2.0<xref ref-type="bibr" rid="b16">16</xref> and PRIMEGENSw3<xref ref-type="bibr" rid="b29">29</xref>. These particular tools differ in terms of the algorithms they use to evaluate priming specificity and to select primer pairs. Nevertheless, for all of these tools, the assessment of mispriming (a critical step for identifying target-specific primers) is restricted because it is initialized by evaluation of specificity at only the 3′-end region of a candidate primer against potential off-target binding sites. Only candidate primers with perfect complementarity at the 3′-end region are further evaluated in terms of binding stability. However, studies have demonstrated that mismatches within the 3′-end region can still lead to PCR amplification<xref ref-type="bibr" rid="b13">13</xref><xref ref-type="bibr" rid="b30">30</xref>, and Miura <italic>et al</italic>. (2005), who developed SDSS, discussed the need for more sophisticated methods to evaluate off-target hybridization and priming. In this study, such a method was developed which quantitatively evaluates the thermodynamics of hybridization for full-length primer-template binding at the target site relative to the remainder of the genome.</p>
  <p>In terms of selecting primers for DNA amplification, most tools assess specificity according to whether primer pairs (not individual primers) are predicted not to produce off-target amplicons within a specified size range (<xref ref-type="supplementary-material" rid="S1">Supplementary Table S1</xref>). This criteria can result in the selection of primers that individually produce single-strand synthesis products at multiple off-target sites. For instance, a primer with many perfectly complementary off-target binding sites could be selected by tools that use this approach. In turn, such primers can create byproducts that act as mega-primers in PCR, leading to background amplification<xref ref-type="bibr" rid="b14">14</xref>. This issue is expected to be exacerbated when working with repetitive genomes. Therefore, evaluating the specificity of individual primers could improve the selection of target-specific primer pairs.</p>
  <p>For targeted resequencing, it is still not feasible to enrich and sequence many tens of kilobases or more of contiguous DNA, particularly for large samples of individuals. Some techniques have been developed that might be used for this, but in our attempts neither region-specific enrichment<xref ref-type="bibr" rid="b31">31</xref> nor selective whole genome amplification<xref ref-type="bibr" rid="b32">32</xref> led to enrichment of targeted regions of the maize genome (<xref ref-type="supplementary-material" rid="S1">Supplementary Methods and Results</xref>). Further optimization may enable these techniques to work for our target regions, but our results suggested the repetitive nature of the genome prevented enrichment. Indeed, others have found that hybridization-based enrichment has proven difficult<xref ref-type="bibr" rid="b1">1</xref> or unsuccessful<xref ref-type="bibr" rid="b12">12</xref> in maize due to its repeat content. In contrast, given primer pairs that specifically prime on-target, DNA amplification is a highly effective method for enrichment. Thus, coupling target-specific primer design for DNA amplification with automated identification of primer pairs that amplify overlapping segments across a target region is an alternative solution to creating libraries for targeted resequencing. Unfortunately, existing tools are not suited for this and output only a subset of the higher scoring primer pairs designed to a region of interest. This leads to parts of the targeted locus not being covered or a situation where users need to manually pick from among numerous possible primer pairs. Therefore, the automated design of groups of primer pairs producing a tiling path of amplicons would be useful for resequencing studies. Some studies have approached the problem of designing amplicon tiling paths by segmentation of the genomic locus and evaluating potential amplicon sizes and their overlap (e.g. refs <xref ref-type="bibr" rid="b33">33</xref>, <xref ref-type="bibr" rid="b34">34</xref>, <xref ref-type="bibr" rid="b35">35</xref>). In ThermoAlign, a unique implementation of directed graph analysis was programmed for selecting the minimum number of primer pairs forming an amplicon tiling path with maximum coverage of the target region.</p>
  <p>Finally, while many algorithms and tools have been developed for target-specific primer design, not all of these have reported on their performance in laboratory tests, such that the application of some tools remains unknown (<xref ref-type="supplementary-material" rid="S1">Supplementary Table S1</xref>). This makes it difficult for end-users to assess the utility of a given tool amid a wide landscape of such tools. For those that have been tested in the laboratory, none have achieved 100% specificity in DNA amplification; however, reports have shown fairly good performance in a few species (yeast, human and soybean). Miura <italic>et al</italic>. (2005) evaluated their SDSS approach on the budding yeast genome and encountered some cases of off-target amplification. A study on a PrimerStation tool<xref ref-type="bibr" rid="b27">27</xref> that also uses SDSS showed that all 10 primer pairs amplified specific products on human chromosome X. Reports on PRIMEGENS showed that ≈90% of the primer pairs produced a single amplicon<xref ref-type="bibr" rid="b29">29</xref><xref ref-type="bibr" rid="b36">36</xref><xref ref-type="bibr" rid="b37">37</xref>. Working in a genome scenario with a substantially greater repeat content (maize), we sought to develop a method that achieves near perfection in the automated design of primer pairs that amplify only on-target.</p>
  <p>In this study, a genome-aware primer pair design algorithm embedded within a distributable tool called ThermoAlign was developed and validated. Priming specificity is determined based on genome-wide analysis of the hybridization for full-length primer-template interactions in the presence of non-complementary base pairings. For population studies, ThermoAlign is also capable of using prior information on the locations of genomic variants during the selection of primer pairs. In addition to the design of primer pairs for standard, single locus PCR amplification, a directed graph analysis method is used to design primer pairs forming amplicon tiling paths for targeted sequencing of large regions in a genome. Finally, the amplification specificity of primer pairs designed by ThermoAlign was validated on maize, one the most repetitive genomes (≈85% repetitive) for which a reference sequence is available<xref ref-type="bibr" rid="b8">8</xref>. ThermoAlign is expected to facilitate targeted genome sequence studies for any species.</p>
  <sec disp-level="1">
    <title>Results</title>
    <p>A schematic of the ThermoAlign pipeline is shown in <xref ref-type="fig" rid="f1">Fig. 1</xref>. In the following sections, results are presented pertaining to each module of the tool. A 24 kb target region of the maize genome (B73 RefGen_v3 Chr3:33490673..33514673) was used to demonstrate the pipeline and highlight features of ThermoAlign. Sixty-six percent of this region is annotated in the genome assembly as repeat-masked. Using the unmasked sequence and examining repetitiveness relevant to primer binding, 72% of the primers designed to this region would be predicted to produce off-target priming events at 1 to 215 sites for a given primer (<xref ref-type="fig" rid="f2">Fig. 2</xref>). This same region, along with other segments of the genome, was used to test the amplification specificity of primers designed by ThermoAlign.</p>
    <sec disp-level="2">
      <title>Target Region Selection (TRS)</title>
      <p>ThermoAlign produces an output file with summary information from the run (e.g. <xref ref-type="supplementary-material" rid="S1">Supplementary File S1</xref>). Output for the 24 kb target region showed that it contained no gaps in the reference sequence assembly, 1,073 SNPs, 93 indels and 46% GC content.</p>
    </sec>
    <sec disp-level="2">
      <title>Unique Oligo Design (UOD)</title>
      <p>The UOD algorithm was designed to identify every individual primer (not primer pairs) in a target region that is deemed favorable for PCR and has no identical matches elsewhere in the genome. For the 24 kb targeted region, among 184,145 total possible primers, 82,520 did not occur at sites containing polymorphisms in maize HapMap3<xref ref-type="bibr" rid="b38">38</xref>. Applying the full set of remaining UOD filters (for settings, see <xref ref-type="supplementary-material" rid="S1">Supplementary File S2</xref>) resulted in the selection of 877 candidate primers.</p>
      <p>The classification of the 82,520 primers into UOD filtering categories was examined to see which features had the largest effect on the removal of primers. This was split into two parts, starting with filters for primer sequence features and ending with filters for primer interactions (<xref ref-type="supplementary-material" rid="S1">Supplementary Fig. S1</xref>). In terms of sequence features, 75,073 primers were filtered. Considering primers that were associated with only one sequence feature category, the A/T-end filter removed the largest number of primers (n = 9,217), comprising ≈50% of the collective set of primers that were specific to only one feature (<xref ref-type="supplementary-material" rid="S1">Supplementary Fig. S1a</xref>). The A/T-end feature is a useful heuristic to eliminate primers with a greater potential for inefficient priming<xref ref-type="bibr" rid="b39">39</xref>. Optionally, the A/T-end filter or other filters may be excluded or re-parameterized to achieve a higher discovery rate of candidate primers, but this comes at the cost of increasing the computational time required for primer specificity evaluation (PSE; next section). For example, excluding the A/T-end filter from UOD resulted in 1,161 additional candidate primers (compared to 877 identified with the A/T-end filter applied), but this took approximately four times longer in runtime seconds for PSE.</p>
      <p>The primer interaction filters, which were applied to the 7,447 primers that remained after filtering based on sequence features, included the occurrence of an exact match at an off-target site in the genome, homodimer <italic>T</italic><sub><italic>m</italic></sub>, heterodimer <italic>T</italic><sub><italic>m</italic></sub> and hairpin <italic>T</italic><sub><italic>m</italic></sub><xref ref-type="bibr" rid="b40">40</xref> (<xref ref-type="supplementary-material" rid="S1">Supplementary Fig. S1b</xref>). This resulted in the filtering of an additional 6,570 primers, leaving 433 forward primers and 444 reverse primers with 136 being from the same position on the two strands.</p>
    </sec>
    <sec disp-level="2">
      <title>Priming Specificity Evaluation (PSE)</title>
      <p>A critical aspect of ThermoAlign is the algorithmic and quantitative approach used to characterize off-target hybridization sites. As part of the algorithm to determine the potential for mispriming, BLASTn alignments for each off-target match are edited into thermoalignments (full-length, ungapped primer-template alignments) that allow meaningful and accurate estimates of the <italic>T</italic><sub><italic>m</italic></sub> to be computed for a primer (<xref ref-type="fig" rid="f3">Fig. 3</xref>). Native BLASTn alignments with ≥70% sequence identity (which are mostly truncated local alignments) had an average <italic>T</italic><sub><italic>m</italic></sub> that was 7 °C higher than their thermoalignment (<xref ref-type="fig" rid="f3">Fig. 3b</xref>). However, the <italic>T</italic><sub><italic>m</italic></sub> for 10.8% (n = 18,834) of the BLASTn alignments was less than their thermoalignment (<xref ref-type="fig" rid="f3">Fig. 3b</xref>). The range of the difference in <italic>T</italic><sub><italic>m</italic></sub> for BLASTn alignments compared to corresponding thermoalignments was −14 °C to 272 °C. Considering the relationship between the number of mismatches and <italic>T</italic><sub><italic>m</italic></sub>, <xref ref-type="fig" rid="f3">Fig. 3c,d</xref> showed that the number of mismatches, although correlated with thermoalignment <italic>T</italic><sub><italic>m</italic></sub>, is not a suitable proxy for the potential of mispriming. Even in the presence of multiple mismatches, the <italic>T</italic><sub><italic>m</italic></sub> for binding at off-target sites can be at temperatures typical for PCR (e.g. &gt;60 °C; <xref ref-type="fig" rid="f3">Fig. 3c</xref>). Moreover, the off-target <italic>T</italic><sub><italic>m</italic></sub> may not always be sufficiently distant from the on-target <italic>T</italic><sub><italic>m</italic></sub> for specific priming to occur (<xref ref-type="fig" rid="f3">Fig. 3d</xref>). For the data in <xref ref-type="fig" rid="f3">Fig. 3d</xref>, ≈80% of the thermoalignments had an on-target <italic>T</italic><sub><italic>m</italic></sub> &gt; 10 °C of the off-target <italic>T</italic><sub><italic>m</italic></sub>.</p>
    </sec>
    <sec disp-level="2">
      <title>Primer Pair Selection (PPS)</title>
      <p>From among the 877 oligonucleoltides that were expected to stably hybridize and specifically prime on-target within the reference genome, 2,818 combinations of primer pairs were found to be compatible for standard PCR. The parameter settings used for PPS (<xref ref-type="supplementary-material" rid="S1">Supplementary File S2</xref>) included the requirement of a +10 °C difference in the <italic>T</italic><sub><italic>m</italic></sub> between the primer with the lower <italic>T</italic><sub><italic>m</italic></sub> of a given pair and the greatest off-target <italic>T</italic><sub><italic>m</italic></sub> for either of the two primers. Reducing this threshold can increase the discovery rate for primers, but one must consider a lower limit at which off-target amplicons would be likely to arise in actual PCR. When set to +6 °C, the number of primer pairs selected by the PPS module for the 24 kb region increased to 4,189. Adjusting this threshold along with the upper limit in the <italic>T</italic><sub><italic>m</italic></sub> range used for UOD can also increase the discovery rate. Increasing the <italic>T</italic><sub><italic>m</italic></sub> range by +5 °C (a change from 64–74 °C to 62–77 °C) while keeping a +10 °C maximum misprime difference led to the identification of 4,103 primer pairs via the UOD → PSE → PPS pipeline.</p>
      <p>With the 877 primers from above, a directed graph method was used to identify the minimum number of primer pairs (shortest path) providing the maximum amount of coverage for the targeted region. The amplicon size range setting was a critical factor in the amount of coverage that could be achieved for the region examined here (<xref ref-type="supplementary-material" rid="S1">Supplementary Table S2</xref>). Smaller amplicon size ranges led to relatively low coverage and the largest size ranges (≥15 kb) led to no coverage. Maximum coverage was achieved for amplicon sizes between 5 and 15 kb. However, recalling that the A/T-end filter resulted in the loss of over one thousand primers, excluding this filter increased the expected coverage from a maximum of 61.8% (with the filter) to 88.7% (without the filter).</p>
    </sec>
    <sec disp-level="2">
      <title>Empirical evaluation of priming specificity</title>
      <p>Primer pairs designed by ThermoAlign were tested using standardized conditions for standard PCR and long-range PCR (see Methods section). For standard PCR, 46 primer pairs associated with seven genes located on six chromosomes of maize were tested (<xref ref-type="supplementary-material" rid="S1">Supplementary File S3</xref>). Using the directed graph analysis method in PPS, these primer pairs were designed to tile from 1 kb upstream to 1 kb downstream of each gene. Thirty-eight of these primer pairs produced an amplicon, and for each of these a single specific amplicon of the expected size was observed; no off-target amplicons were detected for any of the primer pairs tested [<xref ref-type="fig" rid="f4">Fig. 4a</xref> shows the results for 29 of the 46 primer pairs, two of which failed to amplify (6:7,048,348 and 7:128,406,874)].</p>
      <p>ThermoAlign integrates MultiPLX<xref ref-type="bibr" rid="b41">41</xref> while customizing the input and output to obtain two groups of multiplexes compatible with the amplification of overlapping tiling paths. For each of the seven targeted genes tested using standard PCR, under the “normal” stringency settings, MultiPLX identified multiplexes with no more than two primer pairs (the possibility existed to combine as many as five primer pairs). The amplicons produced using multiplex PCR were generally consistent with those produced by each primer pair individually (one primer pair in one multiplex set failed in the multiplex reaction) and no alternative amplicons were observed (<xref ref-type="fig" rid="f4">Fig. 4a</xref>).</p>
      <p>For five of the seven genes mentioned above, 0.1–5.0 kb amplicon tiling paths were designed for each gene (independent of the standard PCR primers; <xref ref-type="supplementary-material" rid="S1">Supplementary File S3</xref>) and tested using long-range PCR. For each gene, two primer pairs were identified that would tile across the full length of the gene (one exception: with the settings used, primer pairs were not found that would cover the entire P450 gene on chromosome 3). Similar to standard PCR, not all ten primer pairs produced an amplicon, but the seven that did produced a single prominent amplicon of the expected size (<xref ref-type="fig" rid="f4">Fig. 4b</xref>). For long-range PCR amplicons that failed to amplify or had low yield, more of the reaction product was loaded into the gel in order to normalize the products for comparison. This showed some background smearing that was greater than the negative control, suggesting some amount of random off-target amplification had occurred during long-range PCR (potentially due to mega-primer amplification<xref ref-type="bibr" rid="b14">14</xref>).</p>
      <p>Because of the dependency of a reference genome for primer design and that some standard PCR and long-range PCR reactions failed to produce amplicons, we questioned whether these failed reactions were due to inaccuracies in the sequence assembly. Under the assumption that long-range PCR primer pairs that produced a specific amplicon of the expected size were an indication of an accurate assembly, the production of standard PCR amplicons nested within these long-range PCR amplicons was used to address this question.</p>
      <p>Twenty-nine standard PCR primer pairs were designed to the same five genes tested by long-range PCR and were nested within at least one of the expected long-range PCR amplicons. Some of the standard PCR amplicons were nested within overlapping sections of two long-range PCR amplicons where one of the primer pairs produced a product and the other did not. Excluding those standard PCR primer pairs from consideration, one out of 21 of the standard PCR primer pairs failed to produce an amplicon in regions where an amplicon was produced by long-range PCR. In contrast, all five standard PCR primer pairs produced an amplicon in regions where no amplicon was produced by long-range PCR. The association between successful and failed reactions for standard and long-range PCR was not significant (Fisher’s Exact Test, <italic>p</italic> = 1.0), which failed to implicate assembly errors as the cause for PCR failures.</p>
      <p>Considering the possibility that the sequence composition of the primers or amplification target affected success<xref ref-type="bibr" rid="b14">14</xref>, the addition of betaine to the reactions resulted in all 10 long-range PCR primer pairs producing a specific product of the expected size (<xref ref-type="fig" rid="f4">Fig. 4b</xref>). Subsequent testing of standard PCR primer pairs with betaine resulted in the recovery of a single specific amplicon for the two nested pairs that had failed in the absence of betaine, in addition to four primer pairs from the original set of 46. However, these products amplified poorly (data not shown). Additional PCR optimization could potentially improve the amplification efficiency of these primer pairs. The amplicons of reactions that were recovered by the addition of betaine for long-range PCR had a higher median GC content by 3.2 percentage points for the primers and 7.8 percentage points for the expected amplicons (B73 reference genome sequence). Similarly, standard PCR reactions that were recovered using betaine (considering all 46 of the primer pairs) had a higher median GC content for the primers (3.7 percentage points) and expected amplicons (19.7 percentage points).</p>
      <p>To confirm that the amplicons corresponded to the targeted loci, nine of the ten long-range PCR products in <xref ref-type="fig" rid="f4">Fig. 4b</xref> were pooled and sequenced by single molecule, real-time sequencing. A primer-based clustering and sequence analysis approach generated exactly nine consensus sequences with perfect identity to the expected sequence (<xref ref-type="table" rid="t1">Table 1</xref>; <xref ref-type="supplementary-material" rid="S1">Supplementary File S4</xref>).</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Discussion</title>
    <p>Through the current era of high-throughput sequencing, the design of oligonucleotides has remained a fundamental need for genome science research and applications. Models for designing hybridization and priming oligonucleotides can shed light on the understanding of oligonucleotide-template interactions while providing the design products for probing genomes. Two key aspects are whether hybridization and priming will occur and whether these events are specific to the targeted sequence. In this study, specificity of primer pair amplification was addressed in the development of ThermoAlign for the automated design of priming oligonucleotides. ThermoAlign assesses specificity by computing the nearest-neighbor thermodynamics of hybridization<xref ref-type="bibr" rid="b20">20</xref> for full-length oligonucleotide-template interactions across the genome. Computationally empirical results suggested there is no sufficient substitute for this. Approaches that rely on sub-sequences (characterized here based on local BLASTn alignments; <xref ref-type="fig" rid="f3">Fig. 3b</xref>) of a primer-template interaction or the number of mismatches in a thermoalignment (<xref ref-type="fig" rid="f3">Fig. 3d</xref>) for specificity evaluation are expected to have a greater risk of selecting primers that would hybridize at off-target sites and a lower discovery rate for identifying suitable primers.</p>
    <p>Examination of genome-wide thermoalignments for primers in a 24 kb region of the maize genome showed that the proportion of repeat content in the context of a primer space (25 bp) was greater than that based on transposable element repeat masking. This emphasizes the importance of a genome-aware primer specificity evaluation process. Applying this approach to the repetitive genome of maize resulted in a single and specific amplicon of expected size for every primer pair that produced a product by standard PCR, without any modifications to the reaction chemistry (<xref ref-type="fig" rid="f4">Fig. 4</xref>). Long-range PCR gave essentially the same results. Although some of those reactions produced some random background amplification, a single prominent amplicon was observed, and the expected sequence was obtained by sequencing. We have continued to observe near-perfect specificity for an additional 50 functional primer pairs tested on multiple samples of maize (data not shown). Our results demonstrate the accuracy of the nearest-neighbor thermodynamics model and the principles embedded in ThermoAlign for primer design. The results of this study lend support to prior studies that have developed chemistry-conditioned nearest-neighbor thermodynamic models to estimate energy parameters for DNA duplexes that may include non-complementary bases<xref ref-type="bibr" rid="b21">21</xref><xref ref-type="bibr" rid="b22">22</xref><xref ref-type="bibr" rid="b23">23</xref><xref ref-type="bibr" rid="b24">24</xref><xref ref-type="bibr" rid="b25">25</xref><xref ref-type="bibr" rid="b26">26</xref><xref ref-type="bibr" rid="b42">42</xref>.</p>
    <p>ThermoAlign is an elaborate pipeline that includes a suite of modules with a number of unique elements (<xref ref-type="supplementary-material" rid="S1">Supplementary Table S1</xref>). This includes the creation of thermoalignments to obtain accurate estimates of hybridization energies and a graph analysis approach for automated identification of amplicon tiling paths for resequencing studies. Therefore, ThermoAlign can be used not only to design primer pairs for standard, single-locus PCR applications, but also for resequencing studies of targeted regions that cannot be captured with a single primer pair. For population studies, a polymorphism-aware feature allows primers to be designed to monomorphic regions of the genome. However, this will be limited by the extent of prior information pertaining to the population(s) under study. To increase the efficiency of laboratory efforts to generate amplicons for resequencing, primer pairs constituting amplicon tiling paths are passed to the software MultiPLX<xref ref-type="bibr" rid="b41">41</xref> and organized into multiplex compatible sets (<xref ref-type="fig" rid="f5">Fig. 5</xref>). Finally, as a matter of extensibility, the graph analysis method used in ThermoAlign can be re-structured in terms of how edge weights are computed. For instance, as it is sometimes desirable to obtain more similarly sized amplicons for sequencing, we foresee that edge weights could be adjusted according to a probability function centered on a desired amplicon size.</p>
    <p>This study demonstrates that nearest-neighbor estimation of <italic>T</italic><sub><italic>m</italic></sub> on thermoalignments is a robust solution for target-specific primer design. ThermoAlign requires minimal computational power and quickly identifies suitable primer pairs for routine applications targeting a single locus of a few hundred to a few thousand base pairs. This makes the tool useful for routine PCR applications. However, <italic>de novo</italic> searches using BLASTn may be suboptimal and PSE requires greater computational resources for large target regions with run parameterizations having broad search settings. This is despite having optimized the settings for BLASTn such that the search was limited to obtaining sufficient information for PSE (see <xref ref-type="supplementary-material" rid="S1">Supplementary information</xref> and <xref ref-type="supplementary-material" rid="S1">Supplementary Fig. S2</xref>). Clocking the speed of each component showed that, not surprisingly, the genome-wide search for non-exact matches in the PSE module is a key component to focus on for reducing run times (<xref ref-type="supplementary-material" rid="S1">Supplementary File S1</xref>). Therefore, other alignment search methods or a database of pre-computed <italic>T</italic><sub><italic>m</italic></sub> (e.g. ref. <xref ref-type="bibr" rid="b27">27</xref>) could be considered for reducing the run time. Furthermore, the BLASTn approach may not identify all mispriming sites for a given primer because it does not allow for mismatches with the sequence used to seed an alignment. Ideally, the <italic>T</italic><sub><italic>m</italic></sub> of every possible thermoalignment across the genome would be computed for every candidate primer considered.</p>
    <p>Another critical aspect that remains to be addressed by primer design tools is determining the likelihood for successful amplification. This has received recent attention, leading to insights into how this might be predicted <italic>in silico</italic> from oligonucleotide and template features<xref ref-type="bibr" rid="b14">14</xref><xref ref-type="bibr" rid="b43">43</xref><xref ref-type="bibr" rid="b44">44</xref>. Methods for predicting amplification success could be readily integrated into ThermoAlign. By comparing the success of standard PCR primer pairs nested within long-range PCR primer pairs, we observed that assembly errors were not likely to have caused failures to amplify the regions tested in this study. The conversion of failed reactions into successful ones following the addition of betaine to PCR reactions suggested secondary structures as the likely cause of failure. Betaine has been shown to improve the amplification of GC rich regions by reducing the formation of secondary structures, making the template more accessible to DNA polymerase<xref ref-type="bibr" rid="b45">45</xref><xref ref-type="bibr" rid="b46">46</xref>. Indeed, as it has been widely documented, this study found an association between high GC content of primers and the target sequences with failure to amplify by PCR in the absence of betaine.</p>
    <p>ThermoAlign is founded upon thermodynamically relevant sequence alignments or thermoalignments for estimating hybridization energies of oligonucleotides across a sequenced genome. This results in the design of target-specific primer pairs for PCR and tiled amplicon resequencing. We have demonstrated that the selection of such primer pairs is fully automatable and was applicable to a species (<italic>Zea mays</italic> subsp. <italic>mays</italic>) with ≈85% repeat content in its genome. The model used to extend local alignments was developed with priming in mind, but an alternative model could be developed for hybridization probes, which would require evaluation of the <italic>T</italic><sub><italic>m</italic></sub> for bidirectional gap-adjusted end-filling models (if the BLASTn algorithm is maintained). The modular design of ThermoAlign and open source license provides an extensible resource for continued development that can be adapted for a range of other applications including the design of hybridization oligonucleotides and gene editing techniques. The applications for ThermoAlign currently range from standard PCR assays to long-molecule resequencing. Multiplexed libraries containing pools of separate, long-range PCR products, such as those tiling across a target region and amplified on multiple individuals, can be sequenced on current parallel sequencing platforms, placing ThermoAlign as a tool for studies using high-throughput sequencing.</p>
  </sec>
  <sec disp-level="1">
    <title>Methods</title>
    <sec disp-level="2">
      <title>ThermoAlign pipeline</title>
      <p>A thermodynamics-based, genome-wide specificity evaluation approach for designing priming oligonucleotides was developed. The approach consists of four stages: (1) selection of a targeted sequence in a genome and masking of variant sites; (2) extraction of all possible oligonucleotides from the target region that are unique and identification of those expected to stably hybridize with the DNA template; (3) evaluation of the mispriming potential for candidate primers; and (4) identification of all suitable primer pairs including a minimum set that provides maximum coverage of the targeted region (<xref ref-type="fig" rid="f1">Fig. 1</xref>). Users can modify run parameters corresponding to each of the ThermoAlign modules in a single settings file (parameters.py; see the GitHub repository referenced in the Availability section below). The ThermoAlign pipeline was developed in Python 2.7.5 and evaluated on a machine equipped with dual 64-bit 2.1 CPU GHz AMD Opteron processor 6172, using 5 of its cores, running on Fedora release 19 and 23 OS.</p>
    </sec>
    <sec disp-level="2">
      <title>Target region selection (TRS)</title>
      <p>The TRS module uses external files and custom pre-processing scripts to create a BLAST database and modify the targeted sequence for subsequent filters in the pipeline. For a given FASTA formatted reference genome sequence, the sequence for a target region is extracted based on user provided coordinates.</p>
      <sec disp-level="3">
        <title>External files</title>
        <p>ThermoAlign minimally requires FASTA formatted files for a reference genome. This is used to extract the targeted sequence for designing oligonucleotides and to create a BLAST database to search for off-target priming sites. Standard variant call format (<italic>vcf</italic> v4.0 and v4.1; <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://vcftools.github.io/index.html">https://vcftools.github.io/index.html</ext-link>) files based on the same coordinate system of the reference genome sequence may be optionally used for polymorphism-aware primer design.</p>
      </sec>
      <sec disp-level="3">
        <title>BLAST database</title>
        <p>The sequences for each pseudomolecule are required as separate FASTA files using a specific naming convention. Formatting details are provided at the GitHub repository cited in the Availability section below.</p>
      </sec>
      <sec disp-level="3">
        <title>Pre-processing <italic>vcf</italic> files (optional)</title>
        <p>A custom script (vcf_conversion.py) is used to convert input <italic>vcf</italic> files into files compatible with ThermoAlign scripts containing only the genome coordinates and corresponding variant information. These pre-processed, smaller sized data files enable more efficient parsing and annotation of polymorphic bases in the target region.</p>
      </sec>
      <sec disp-level="3">
        <title>Polymorphism annotation (optional)</title>
        <p>Nucleotides at variant sites are converted to “n” [single nucleotide polymorphism (SNP)] or “N” (indels), which are later used as indicator characters to filter primers associated with these sites. For this study, maize HapMap3<xref ref-type="bibr" rid="b38">38</xref> was used for prior variant information. Although indels may comprise multiple nucleotides, maize HapMap3 encodes indels as a single nucleotide position without information on the start and stop positions or length of the indel. Therefore, the individual nucleotide at the corresponding position for each indel in HapMap3 was converted to an N.</p>
      </sec>
      <sec disp-level="3">
        <title>Assembly gap consideration</title>
        <p>The maize reference genome contains strings of 100 and 1000 “N” characters to represent gaps for sequences from individual clones and between assembly scaffolds, respectively, which could be distinguished from SNP and indel locations encoded as a single “n” or “N.” In terms of coordinates, each and every “n” and “N” character were treated as having a position (as was the case for the original reference genome coordinates).</p>
      </sec>
    </sec>
    <sec disp-level="2">
      <title>Unique oligonucleotide design (UOD)</title>
      <p>The UOD algorithm was designed to extract candidate oligonucleotides from the target region and characterize their properties relevant to hybridization and priming. Across a user-defined range of oligonucleotide lengths, and using a 1 bp sliding window for each length, every possible oligonucleotide sequence was extracted from both the positive and negative strands. A series of filters were applied to the entire set of oligonucleotides in the following order of operations.</p>
      <sec disp-level="3">
        <title>Flanking primers (user-specified)</title>
        <p>UOD can optionally design primers that flank a given target locus. Forward primers with their 3′-end position that is less than or equal to the locus start and reverse primers with their 3′-end position that is greater than or equal to the locus stop are designed. Flanking primers are designed according to a specified flanking size.</p>
      </sec>
      <sec disp-level="3">
        <title>Base composition (polymorphism filter optional)</title>
        <p>Oligonucleotides containing any character other than A, C, G or T were filtered (this removed primers containing any “n” or “N” character). This ensured that oligonucleotides corresponding to polymorphic sites and gaps in the sequence were avoided. However, the filtering of oligonucleotides with polymorphic sites is optional.</p>
      </sec>
      <sec disp-level="3">
        <title>GC content (user-specified)</title>
        <p>Oligonucleotides that fell outside a defined range of percent GC were filtered. In this study, a range of 40–60% GC was used.</p>
      </sec>
      <sec disp-level="3">
        <title>A/T-end (optional)</title>
        <p>For primers, a single G or C nucleotide at the 3′-end helps to stabilize binding near the site of extension, which can reduce the possibility of “breathing” and improves priming efficiency<xref ref-type="bibr" rid="b39">39</xref>. Therefore, primers ending in an A or a T base could optionally be filtered. In this study, the filter was applied.</p>
      </sec>
      <sec disp-level="3">
        <title>GC clamp (optional)</title>
        <p>Oligonucleotides with more than three G or C nucleotides within the last five bases were filtered. This should help minimize mispriming at GC-rich binding sites<xref ref-type="bibr" rid="b39">39</xref>.</p>
      </sec>
      <sec disp-level="3">
        <title>Repeating nucleotides (user-specified)</title>
        <p>Oligonucleotides with four or more mononucleotide or dinucleotide repeats were filtered.</p>
      </sec>
      <sec disp-level="3">
        <title>Melting temperature (user-specified)</title>
        <p>An important component of the pipeline is estimation of melting temperature (<italic>T</italic><sub><italic>m</italic></sub>). The nearest-neighbor estimator was used as described by Santalucia and Hicks<xref ref-type="bibr" rid="b21">21</xref>:</p>
        <p>
          <disp-formula id="eq1">
            <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d32e684" xlink:href="srep44437-m1.jpg"/>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="eq2">
            <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d32e687" xlink:href="srep44437-m2.jpg"/>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="eq3">
            <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d32e690" xlink:href="srep44437-m3.jpg"/>
          </disp-formula>
        </p>
        <p>where Δ<italic>H</italic><sup>0</sup> and Δ<italic>S</italic><sup>0</sup> are enthalpy (<inline-formula id="d32e703"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d32e704" xlink:href="srep44437-m4.jpg"/></inline-formula>) and entropy (<italic>e.u.</italic>) respectively. We refer the reader to Santalucia and Hicks, 2004 for further details on equations, units and definitions. To obtain <italic>T</italic><sub><italic>m</italic></sub> for different reaction conditions, the <italic>Na</italic><sup>+</sup> equivalent of monovalent and divalent ions were calculated according to Von Ahsen, 2001<xref ref-type="bibr" rid="b42">42</xref>, which were used to adjust Δ<italic>S</italic><sup>0</sup>(<italic>total</italic>) [<xref ref-type="disp-formula" rid="eq7">equation 5</xref> in Santalucia and Hicks, 2004<xref ref-type="bibr" rid="b21">21</xref>], where:</p>
        <p>
          <disp-formula id="eq5">
            <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d32e739" xlink:href="srep44437-m5.jpg"/>
          </disp-formula>
        </p>
        <p>however, if <inline-formula id="d32e742"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d32e743" xlink:href="srep44437-m6.jpg"/></inline-formula>, then</p>
        <p>
          <disp-formula id="eq7">
            <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d32e747" xlink:href="srep44437-m7.jpg"/>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="eq8">
            <inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d32e750" xlink:href="srep44437-m8.jpg"/>
          </disp-formula>
        </p>
        <p>Primers that fell outside the specified range in <italic>T</italic><sub><italic>m</italic></sub> were filtered. In this study, a <italic>T</italic><sub><italic>m</italic></sub> range of 64–74 °C was used for primer design.</p>
      </sec>
      <sec disp-level="3">
        <title>Self-primer interactions (user-specified)</title>
        <p>The Primer3 thal.c library functions<xref ref-type="bibr" rid="b40">40</xref> were used to compute hairpin and self-dimer <italic>T</italic><sub><italic>m</italic></sub> values (functions: primer3.calcHairpin and primer3.calcHomodimer; Primer3 release 2.3.7). A primer was filtered if either of these <italic>T</italic><sub><italic>m</italic></sub> values were within 20 °C of the corresponding primer-DNA hybridization <italic>T</italic><sub><italic>m</italic></sub>.</p>
      </sec>
      <sec disp-level="3">
        <title>Exact match (user-specified)</title>
        <p>The remaining candidate primers were screened by BLASTn (ThermoAlign default optimized settings: e_value: 30000; word_size: smallest primer length; gapopen: 2; gapextend: 2; reward: 1; penalty: -3; max_target_seqs 2; max_hsps 2) to determine if at least one off-target exact match occurs within the reference genome, in which case the primer was filtered. Note: setting the max_target_seqs to 2 and max_hsps to 2 provides the quickest search that ensures at least one match other than the target priming site can be found. Setting either of these less than 2 could cause ThermoAlign to fail in identifying off-target exact matches.</p>
      </sec>
    </sec>
    <sec disp-level="2">
      <title>Priming specificity evaluation (PSE)</title>
      <p>Following the identification of unique primer sequences with adequate properties for amplification, a more computationally intensive algorithm, PSE, was used to evaluate specificity of the remaining primers as follows:</p>
      <sec disp-level="3">
        <title>Nearly identical match</title>
        <p>BLASTn (ThermoAlign default optimized settings: e_value: 30000; word_size: 7; gapopen: 2; gapextend: 2; reward: 1; penalty: -1; perc_identity: 70; max_target_seqs: 13; max_hsps: 20) was used to identify off-target sites across the reference genome that partially match candidate primers, considering that these could serve as mispriming sites.</p>
        <p>The parameters used for PSE required some consideration. A low stringency e-value cutoff was used to account for the higher probability that short sequences would have matches in the database. The word size value is an important parameter. A perfect match across the word size is required to seed a BLASTn alignment, but the PSE module seeks to find imperfectly matching sequences. The smallest word size available for BLASTn was used to provide the maximum sensitivity for discovery of potential off-target sites. Gapopen and gapextend scores of 2, a reward score of 1 and a penalty score of 1 were used to support the alignment of divergent sequences<xref ref-type="bibr" rid="b47">47</xref>. Selecting alignments with a percent identity of 70% or more ensures a thorough evaluation of potential off-target priming sites. <xref ref-type="fig" rid="f2">Figure 2</xref> shows that primers with ≥9 mismatches with off-target sites have a <italic>T</italic><sub><italic>m</italic></sub> that is at least 10 degrees less than the on-target site. The maximum number of target sequences (max_target_seqs) corresponded to the total number of FASTA sequences in the reference genome database (for maize this included 13 sequences comprising nuclear chromosomes 1–10, the mitochondrial genome, the chloroplast genome and a tethered set of unmapped sequences). To avoid extensive searches, based on a preliminary PSE algorithm it was found that 20 high-scoring segment pairs (HSPs) per target sequence identified most sites within the maize genome that candidate primers might hybridize with (i.e. this was a sufficient search space to provide information for filtering a primer; data not shown). While this max_hsps setting was used for designing primers in this study, an updated analysis suggested a max_hsps setting of 50 may be more appropriate for future work (<xref ref-type="supplementary-material" rid="S1">Supplementary Fig. S1</xref>). The low complexity filter was disabled to allow for an exhaustive search.</p>
      </sec>
      <sec disp-level="3">
        <title>Thermoalignments</title>
        <p>Since the alignment algorithm of BLASTn maximizes the scores on local alignments, it can return truncated alignments between the primer and template sequences. For each truncated alignment, given the alignment start and stop coordinate and the length of the primer, an end-filling algorithm was developed that extends the alignment to the full length of the primer sequence (<xref ref-type="fig" rid="f3">Fig. 3</xref>). This was done in a manner that maintains strandedness. Given the strand-specific 5′ and 3′ coordinates to which the full-length primer is expected to align, the corresponding region of the genomic sequence was extracted. In some cases, BLASTn may introduce gaps in the alignment while real primer-template interactions are gapless. To address this, strand-specific algorithms were developed to create full-length, ungapped primer-template alignments relevant to priming oligonucleotides (<xref ref-type="fig" rid="f3">Fig. 3</xref>). Gaps introduced in the primer sequence (deletions in the primer relative to the template) were corrected by shifting the bases in the primer that were 5′ of the gap toward the 3′-end of the primer, and then discarding the resulting overhanging nucleotides at the 5′ end of the template sequence. Gaps introduced in the template sequence (insertions in the primer relative to the template) were corrected by shifting the bases in the template that were 3′ of the gap toward the 5′ end of the template, and then extending the template sequence corresponding to the resulting overhang at the 5′ end of the primer. This algorithm was designed to maximize the number of complementary bases toward the 3′ end of the primer, i.e., the site of primer extension; a different approach could be considered if ThermoAlign is extended for the identification of hybridization probes. The <italic>T</italic><sub><italic>m</italic></sub> was calculated for each ungapped full-length primer-template alignment which we refer to as a thermoalignment.</p>
      </sec>
      <sec disp-level="3">
        <title>Misprime <italic>T</italic>
<sub><italic>m</italic></sub></title>
        <p>Using the same formulae outlined under the melting temperature calculations, the <italic>T</italic><sub><italic>m</italic></sub> was calculated for each thermoalignment between a primer and its off-target template locations. All of these thermoalignments contain at least one mismatch (oligonucleotides with exact matches at off-target sites were filtered in UOD). Therefore, parameters for G/T mismatches<xref ref-type="bibr" rid="b25">25</xref>, G/A mismatches<xref ref-type="bibr" rid="b24">24</xref>, A/C mismatches<xref ref-type="bibr" rid="b23">23</xref>, C/T mismatches<xref ref-type="bibr" rid="b22">22</xref> and A/A, C/C, G/G, T/T mismatches<xref ref-type="bibr" rid="b26">26</xref> were used for the computation of <italic>T</italic><sub><italic>m</italic></sub>.</p>
      </sec>
      <sec disp-level="3">
        <title>Maximum misprime <italic>T</italic>
<sub><italic>m</italic></sub> (user-defined)</title>
        <p>For each candidate primer, among each potential off-target hybridization site in the genome, the maximum <italic>T</italic><sub><italic>m</italic></sub> and the 90<sup><italic>th</italic></sup> percentile <italic>T</italic><sub><italic>m</italic></sub> of thermoalignments are identified. Primers are selected if their on-target <italic>T</italic><sub><italic>m</italic></sub> is greater than their maximum off-target <italic>T</italic><sub><italic>m</italic></sub> as defined by a user-defined threshold. In this study, a +10 °C threshold was used.</p>
      </sec>
      <sec disp-level="3">
        <title>3′-end mismatch</title>
        <p>Primers with a 3′-terminal mismatch at a biding site are not expected to produce off-target synthesis products under standard PCR conditions<xref ref-type="bibr" rid="b30">30</xref>. Therefore, off-target thermoalignments that included a mismatch at the 3′-terminal nucleotide were not considered in PSE. In addition, the proportion of thermoalignments with any number of mismatches within the last five bases at the 3′-end were recorded in output but not used for filtering.</p>
      </sec>
    </sec>
    <sec disp-level="2">
      <title>Primer pair selection (PPS)</title>
      <p>Once primers were determined by the TRS → UOD → PSE pipeline, primer pairs were identified using the following criteria.</p>
      <sec disp-level="3">
        <title>Amplicon length (user-specified)</title>
        <p>Amplicon length was calculated as the distance between the 5′-ends of the forward and reverse primers. Primer pairs that would produce an expected on-target amplicon within a user-defined range in length were maintained. In this study, different settings were used for different experiments.</p>
      </sec>
      <sec disp-level="3">
        <title>Assembly gaps and indels (including an optional gap filter)</title>
        <p>The presence of assembly gaps (represented as 100 or 1,000 nucleotide runs of an N) and indels (HapMap info) in the expected amplicon for a primer pair is indicated in the output. For this study, primer pairs expected to produce amplicons containing gaps in the reference genome were filtered while amplicons containing indels were not.</p>
      </sec>
      <sec disp-level="3">
        <title><italic>T</italic><sub><italic>m</italic></sub> difference (user-specified)</title>
        <p>Primer pairs differing by 10 °C or less in <italic>T</italic><sub><italic>m</italic></sub> were selected. Although it seems inappropriate to choose such a large difference in <italic>T</italic><sub><italic>m</italic></sub> between primer pairs, so long as the <italic>T</italic><sub><italic>m</italic></sub> of each primer is sufficiently greater than the maximum misprime <italic>T</italic><sub><italic>m</italic></sub> of either primer then the primer pair should still be capable of locus specific amplification, using an annealing temperature appropriate for the primer with the lowest <italic>T</italic><sub><italic>m</italic></sub>.</p>
      </sec>
      <sec disp-level="3">
        <title>Maximum misprime <italic>T</italic>
<sub><italic>m</italic></sub> (user-specified)</title>
        <p>The primer with the lowest <italic>T</italic><sub><italic>m</italic></sub> in a given primer pair must be greater than the maximum misprime <italic>T</italic><sub><italic>m</italic></sub> of both primers in the pair according to a user defined threshold value. In this study, a 10 °<italic>C</italic> threshold was used.</p>
      </sec>
      <sec disp-level="3">
        <title>Heterodimer ΔG (user-specified)</title>
        <p>The Primer3-py API 0.5.0 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://github.com/libnano/primer3-py">https://github.com/libnano/primer3-py</ext-link>) was used to compute heterodimer ΔG values. Primer pairs with less than −2000 kcal/mol ΔG values were filtered in this study. We note that during our development phase, using what had been the most current version of Primer3 (v. 2.3.6), we discovered that the entropy and enthalpy estimates for dimers depended upon the input order of the two primer sequences. In v. 2.3.7 the results are no longer a function of the primer input order.</p>
      </sec>
      <sec disp-level="3">
        <title>Amplicon features</title>
        <p>The amplicon sequence corresponding to each primer pair was summarized in terms of features such as GC content, presence of indels and assembly gaps.</p>
      </sec>
      <sec disp-level="3">
        <title>Minimum primer pair set identification</title>
        <p>In situations where amplification of a long section of the genome is the objective, a set of primer pairs producing a tiling path of overlapping amplicons may be designed. We employed a graph analysis strategy to identify the minimum set of primers to achieve maximum coverage of the target region, along with grouping of the resulting primers into multiplex compatible sets. For a given target region, a directed graph was constructed for all possible primer pairs (<xref ref-type="fig" rid="f5">Fig. 5</xref>). Each primer pair (potential amplicon) was represented as a node. Directed edges between any two nodes (<italic>N</italic><sub><italic>i</italic></sub>, <italic>N</italic><sub><italic>j</italic></sub>) were made for overlapping amplicons, given that the node <italic>N</italic><sub><italic>i</italic></sub> starts (5′ position of forward primer) at a position before that of the overlapping node <italic>N</italic><sub><italic>j</italic></sub>; and <italic>N</italic><sub><italic>j</italic></sub> ends (5′ position of reverse primer) after the corresponding end position of <italic>N</italic><sub><italic>i</italic></sub>. To handle instances in which a target region contained gaps because no pass-filter primer pairs could be identified to produce a continuous set of overlapping amplicons, subgraphs were created for the target region. Edge weights (<italic>E</italic><sub><italic>i</italic></sub>) were calculated based on the cumulative sequence coverage for each pair of overlapping amplicons (<italic>C</italic><sub><italic>jk</italic></sub>), after penalizing for the amount of overlap between them (<italic>O</italic><sub><italic>jk</italic></sub>): <italic>E</italic><sub><italic>i</italic></sub> = <italic>C</italic><sub><italic>jk</italic></sub> − <italic>O</italic><sub><italic>jk</italic></sub>. The highest possible edge weight for a given graph (<italic>M</italic><sub><italic>g</italic></sub>) was subtracted from the original edge weights to adjust the scale, such that the original higher scored edges were transformed into the lower scored edges for a given subgraph: <italic>W</italic><sub><italic>i</italic></sub> = <italic>M</italic><sub><italic>g</italic></sub> − <italic>E</italic><sub><italic>i</italic></sub>. From the directed graph with adjusted edge weights (<italic>W</italic><sub><italic>i</italic></sub>), the shortest path was identified based on Dijkstra’s shortest path algorithm<xref ref-type="bibr" rid="b48">48</xref><xref ref-type="bibr" rid="b49">49</xref>. The creation of the graph and identification of the shortest paths was implemented using the NetworkX 1.11<xref ref-type="bibr" rid="b50">50</xref> python package.</p>
        <p>The directed graph based approach identifies the minimum number of primers that gives the maximum coverage of a targeted genomic region in a computationally efficient manner. There was one exception in which we abandoned graph analysis. When two or more amplicons of different sizes covered the same genomic segment and started or ended with the same primer and did not overlap with other segments (i.e. amplicons were not offset on both sides), the single amplicon that gave the maximum coverage was used. Together, these strategies ensured that the minimum set of primer pairs with the maximum coverage for a given target region are identified.</p>
        <p>The resulting primer pairs were split into two sets where each set contained primer pairs that would not produce overlapping amplicons (<xref ref-type="fig" rid="f5">Fig. 5</xref>). The separate sets were evaluated as to whether they could form multiplex sets using MultiPLX<xref ref-type="bibr" rid="b41">41</xref>. Attempting to multiplex primer pairs that produce overlapping amplicons in one set would lead to PCR production of undesirable or small amplicons from primers at the ends of overlapping segments; due to their smaller size their production could dominate the reaction.</p>
      </sec>
      <sec disp-level="3">
        <title>ThermoAlign output</title>
        <p>ThermoAlign produces the following primary output files: (i) a text file summarizing pipeline settings and results; (ii) a text file for ordering primers; (iii) a text file with information about the primer pairs and resulting amplicon features; (iv) a text file with the minimum primer pairs giving maximum coverage that are also grouped into compatible multiplex sets; and (v).<italic>bed</italic> formatted files of the primers for further analysis and visualization. For further details on these and additional output files see the README documentation at the GitHub repository).</p>
      </sec>
    </sec>
    <sec disp-level="2">
      <title>PCR validation</title>
      <p>Standard PCR was performed using <italic>Taq</italic> DNA polymerase with standard <italic>Taq</italic> (Mg-free) Buffer (New England Biolabs, Ipswich, MA; Cat#M0320). Reactions with a final concentration of 1X standard <italic>Taq</italic> (Mg-free) reaction buffer, 1.5 mM MgCl<sub>2</sub>, 200 μM dNTPs, 0.1 μM forward primer, 0.1 μM reverse primer and 0.625 U <italic>Taq</italic> were combined with 20 ng of gDNA and brought to a volume of 25 μL with molecular-grade water. Some reactions were supplemented to include a final concentration of 1 M betaine. Amplification was carried out on an Eppendorf Mastercycler pro S with the following conditions: 5 min at 95 °C; 30 cycles of 20 s at 94 °C, 20 s at 4 °C below the minimum <italic>T</italic><sub><italic>m</italic></sub> for the primer pair as computed by ThermoAlign and 1 min at 68 °C; 5 min at 68 °C; and a hold at 4 °C. PCR products were assayed by electrophoresis in a 3% TBE gel (Bio-Rad, Hercules, CA; Cat#161-3040) and imaged using a FluorChem HD2 with AlphaView SA v3.4.0.</p>
      <p>Long-range PCR was performed using GoTaq Long PCR Master Mix (Promega, Madison, WI; Cat#M4021). Reactions with a final concentration of 1X GoTaq Long PCR Master Mix, 0.1 μM forward primer and 0.1 μM reverse primer were combined with 25 ng gDNA and brought to a volume of 16 μL with molecular-grade water. Some reactions were supplemented to include a final concentration of 1 M betaine. Amplification was carried out in an Eppendorf Mastercycler pro S with the following conditions: 2 min at 94 °C; 30 cycles of 30 s at 94 °C, 5.5 min at 65 °C (following a 1 min/kb guideline based of the longest expected amplicon in the set); 10 min at 72 °C; and a hold at 4 °C. PCR products were assayed via electrophoresis in a 1% TBE gel (Bio-Rad; Cat#161-3038) and imaged using a FluorChem HD2 with AlphaView SA v3.4.0.</p>
    </sec>
    <sec disp-level="2">
      <title>SMRT sequencing and analysis of long-range PCR amplicons</title>
      <p>Amplicons for each long-range PCR primer pair were cleaned with SPRIselect (Beckman Coulter, Brea, CA; Cat#: B23319) at a ratio of 1:1 (beads:sample). Fragment analysis confirming the expected size amplicons was performed using a bioanalyzer (data not shown). Cleaned samples were then quantified using PicoGreen dsDNA quantitation assay (ThermoFisher, Waltham, MA; Cat#P7589) and pooled so that each amplicon was at 0.4 nM. Additionally, the same set of samples was pooled following<xref ref-type="bibr" rid="b51">51</xref> to account for differences in molar mass. For each pool, approximately 900 ng of pooled amplicons was submitted to University of Delaware’s Sequencing and Genotyping Center (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www1.udel.edu/dnasequence/Site/Home.html">http://www1.udel.edu/dnasequence/Site/Home.html</ext-link>) for SMRTbell library construction and sequencing on one SMRTcell per library using the PacBio RSII.</p>
      <p>PacBio SMRT raw reads were clustered by the primer sequences. The number of circular consensus sequences per cluster were recorded. Each cluster of reads was error corrected using Quiver in PacBio SMRT analysis V2.3. LAA protocol to get their consensus sequences. These sequences were aligned to the B73 reference genome using BLASTn (Expect threshold: 0.0001, word size: 15, match/mismatch scores: 1,−2).</p>
    </sec>
    <sec disp-level="2">
      <title>Availability</title>
      <p>ThermoAlign is released under a GNU GPLv3 open source license at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://github.com/drmaize/ThermoAlign">https://github.com/drmaize/ThermoAlign</ext-link> and has been packaged as a distributable tool in Docker containers. The following Docker images are available: (i) TA_1.0.0_d is a general distributable version which requires user supplied files; (ii) TA_1.0.0_s is a sample run version containing a small set of sample files that can be used to test ThermoAlign; (iii) TA_1.0.0_Zm3 is a maize ready version. Instructions for using ThermoAlign and running these containers can be found at the GitHub repository.</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Additional Information</title>
    <p><bold>How to cite this article:</bold> Francis, F. <italic>et al</italic>. ThermoAlign: a genome-aware primer design tool for tiled amplicon resequencing. <italic>Sci. Rep.</italic>
<bold>7</bold>, 44437; doi: 10.1038/srep44437 (2017).</p>
    <p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
  </sec>
  <sec sec-type="supplementary-material" id="S1">
    <title>Supplementary Material</title>
    <supplementary-material id="d32e33" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep44437-s1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>This work was supported by the U.S. NSF Plant Genome Program IOS-1127076. We thank Dr. Karol Miaskiewicz at the Delaware Biotechnology Institute for assistance with using BIOMIX, a high performance computing cluster. BIOMIX was supported by Delaware INBRE grant NIH/NIGMS GM103446 and a number of investigators who have contributed nodes to the cluster. We are grateful to the Primer3 development team for rapidly fixing a bug in Primer3 thal.c heterodimer function.</p>
  </ack>
  <ref-list>
    <ref id="b1">
      <mixed-citation publication-type="journal"><name><surname>Fu</surname><given-names>Y.</given-names></name><etal/>. <article-title>Repeat subtraction-mediated sequence capture from a complex genome</article-title>. <source>Plant J</source>. <volume>62</volume>, <fpage>898</fpage>–<lpage>909</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20230488</pub-id></mixed-citation>
    </ref>
    <ref id="b2">
      <mixed-citation publication-type="journal"><name><surname>Mamanova</surname><given-names>L.</given-names></name><etal/>. <article-title>Target-enrichment strategies for next-generation sequencing</article-title>. <source>Nat. Methods</source><volume>7</volume>, <fpage>111</fpage>–<lpage>118</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20111037</pub-id></mixed-citation>
    </ref>
    <ref id="b3">
      <mixed-citation publication-type="journal"><name><surname>Krishnakumar</surname><given-names>S.</given-names></name><etal/>. <article-title>A comprehensive assay for targeted multiplex amplification of human DNA sequences</article-title>. <source>Proc. Natl. Acad. Sci. USA</source><volume>105</volume>, <fpage>9296</fpage>–<lpage>9301</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18599465</pub-id></mixed-citation>
    </ref>
    <ref id="b4">
      <mixed-citation publication-type="journal"><name><surname>Barnes</surname><given-names>W. M.</given-names></name><article-title>PCR amplification of up to 35-kb DNA with high fidelity and high yield from lambda bacteriophage templates</article-title>. <source>Proc. Natl. Acad. Sci. USA</source><volume>91</volume>, <fpage>2216</fpage>–<lpage>2220</lpage> (<year>1994</year>).<pub-id pub-id-type="pmid">8134376</pub-id></mixed-citation>
    </ref>
    <ref id="b5">
      <mixed-citation publication-type="journal"><name><surname>Haubold</surname><given-names>B.</given-names></name> &amp; <name><surname>Wiehe</surname><given-names>T.</given-names></name>
<article-title>How repetitive are genomes?</article-title>
<source>BMC Bioinformatics</source>
<volume>7</volume>, <fpage>541</fpage> (<year>2006</year>).<pub-id pub-id-type="pmid">17187668</pub-id></mixed-citation>
    </ref>
    <ref id="b6">
      <mixed-citation publication-type="journal"><name><surname>Lander</surname><given-names>E. S.</given-names></name><etal/>. <article-title>Initial sequencing and analysis of the human genome</article-title>. <source>Nature</source><volume>409</volume>, <fpage>860</fpage>–<lpage>921</lpage> (<year>2001</year>).<pub-id pub-id-type="pmid">11237011</pub-id></mixed-citation>
    </ref>
    <ref id="b7">
      <mixed-citation publication-type="journal"><name><surname>de Koning</surname><given-names>A. P. J.</given-names></name>, <name><surname>Gu</surname><given-names>W.</given-names></name>, <name><surname>Castoe</surname><given-names>T. A.</given-names></name>, <name><surname>Batzer</surname><given-names>M. A.</given-names></name> &amp; <name><surname>Pollock</surname><given-names>D. D.</given-names></name>
<article-title>Repetitive elements may comprise over Two-Thirds of the human genome</article-title>. <source>PLoS Genet.</source>
<volume>7</volume>, <fpage>e1002384</fpage> (<year>2011</year>).<pub-id pub-id-type="pmid">22144907</pub-id></mixed-citation>
    </ref>
    <ref id="b8">
      <mixed-citation publication-type="journal"><name><surname>Schnable</surname><given-names>P. S.</given-names></name><etal/>. <article-title>The B73 Maize Genome: Complexity, Diversity, and Dynamics</article-title>. <source>Science (80).</source><volume>326</volume>, <fpage>1112</fpage>–<lpage>1115</lpage> (<year>2009</year>).</mixed-citation>
    </ref>
    <ref id="b9">
      <mixed-citation publication-type="journal"><name><surname>Neale</surname><given-names>D. B.</given-names></name><etal/>. <article-title>Decoding the massive genome of loblolly pine using haploid DNA and novel assembly strategies</article-title>. <source>Genome Biol.</source><volume>15</volume>, <fpage>R59</fpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24647006</pub-id></mixed-citation>
    </ref>
    <ref id="b10">
      <mixed-citation publication-type="journal"><name><surname>Meldrum</surname><given-names>C.</given-names></name>, <name><surname>Doyle</surname><given-names>M. a.</given-names></name> &amp; <name><surname>Tothill</surname><given-names>R. W.</given-names></name>
<article-title>Next-Generation Sequencing for Cancer Diagnostics: a Practical Perspective</article-title>. <source>Clin. Biochem. Rev</source>. <volume>32</volume>, <fpage>177</fpage>–<lpage>195</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">22147957</pub-id></mixed-citation>
    </ref>
    <ref id="b11">
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>M.</given-names></name>, <name><surname>Schroeder</surname><given-names>R.</given-names></name>, <name><surname>Ko</surname><given-names>A.</given-names></name> &amp; <name><surname>Stoneking</surname><given-names>M.</given-names></name>
<article-title>Fidelity of capture-enrichment for mtDNA genome sequencing: Influence of NUMTs</article-title>. <source>Nucleic Acids Res</source>. <volume>40</volume>, <fpage>e137</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22649055</pub-id></mixed-citation>
    </ref>
    <ref id="b12">
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>Z.</given-names></name> &amp; <name><surname>Axtell</surname><given-names>M. J.</given-names></name>
<article-title>Long-range genomic enrichment, sequencing, and assembly to determine unknown sequences flanking a known microRNA</article-title>. <source>PLoS One</source>
<volume>8</volume>, <fpage>e83721</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">24376739</pub-id></mixed-citation>
    </ref>
    <ref id="b13">
      <mixed-citation publication-type="journal"><name><surname>Miura</surname><given-names>F.</given-names></name>, <name><surname>Uematsu</surname><given-names>C.</given-names></name>, <name><surname>Sakaki</surname><given-names>Y.</given-names></name> &amp; <name><surname>Ito</surname><given-names>T.</given-names></name>
<article-title>A novel strategy to design highly specific PCR primers based on the stability and uniqueness of 3′-end subsequences</article-title>. <source>Bioinformatics</source>
<volume>21</volume>, <fpage>4363</fpage>–<lpage>4370</lpage> (<year>2005</year>).<pub-id pub-id-type="pmid">16234322</pub-id></mixed-citation>
    </ref>
    <ref id="b14">
      <mixed-citation publication-type="journal"><name><surname>Hommelsheim</surname><given-names>C. M.</given-names></name>, <name><surname>Frantzeskakis</surname><given-names>L.</given-names></name>, <name><surname>Huang</surname><given-names>M.</given-names></name> &amp; <name><surname>Ülker</surname><given-names>B.</given-names></name>
<article-title>PCR amplification of repetitive DNA: a limitation to genome editing technologies and many other applications</article-title>. <source>Sci. Rep</source>. <volume>4</volume>, <fpage>5052</fpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24852006</pub-id></mixed-citation>
    </ref>
    <ref id="b15">
      <mixed-citation publication-type="journal"><name><surname>Eric Reppo</surname><given-names>Andreson</given-names></name>, <name><surname>Kaplinski</surname><given-names>Lauris</given-names></name> &amp; <name><surname>Maido Remm</surname><given-names>R.</given-names></name>
<article-title>Software Open Access GENOMEMASKER package for designing unique genomic PCR primers</article-title>. <source>BMC Bioinformatics</source>
<volume>7</volume>, <fpage>172</fpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16566824</pub-id></mixed-citation>
    </ref>
    <ref id="b16">
      <mixed-citation publication-type="journal"><name><surname>Qu</surname><given-names>W.</given-names></name><etal/>. <article-title>MFEprimer-2.0: A fast thermodynamics-based program for checking PCR primer specificity</article-title>. <source>Nucleic Acids Res</source>. <volume>40</volume>, <fpage>W205</fpage>–<lpage>8</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22689644</pub-id></mixed-citation>
    </ref>
    <ref id="b17">
      <mixed-citation publication-type="journal"><name><surname>Schuler</surname><given-names>G. D.</given-names></name><article-title>Sequence mapping by electronic PCR</article-title>. <source>Genome Res.</source><volume>7</volume>, <fpage>541</fpage>–<lpage>550</lpage> (<year>1997</year>).<pub-id pub-id-type="pmid">9149949</pub-id></mixed-citation>
    </ref>
    <ref id="b18">
      <mixed-citation publication-type="journal"><name><surname>Rotmistrovsky</surname><given-names>K.</given-names></name>, <name><surname>Jang</surname><given-names>W.</given-names></name> &amp; <name><surname>Schuler</surname><given-names>G. D.</given-names></name>
<article-title>A web server for performing electronic PCR</article-title>. <source>Nucleic Acids Res</source>. <volume>32</volume>, <fpage>W108</fpage>–<lpage>12</lpage> (<year>2004</year>).<pub-id pub-id-type="pmid">15215361</pub-id></mixed-citation>
    </ref>
    <ref id="b19">
      <mixed-citation publication-type="journal"><name><surname>Ye</surname><given-names>J.</given-names></name><etal/>. <article-title>Primer-BLAST: A tool to design target-specific primers for polymerase chain reaction</article-title>. <source>BMC Bioinformatics</source><volume>13</volume>, <fpage>134</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22708584</pub-id></mixed-citation>
    </ref>
    <ref id="b20">
      <mixed-citation publication-type="journal"><name><surname>SantaLucia</surname><given-names>J.</given-names></name><article-title>A unified view of polymer, dumbbell, and oligonucleotide DNA nearest-neighbor thermodynamics</article-title>. <source>Proc. Natl. Acad. Sci. USA</source><volume>95</volume>, <fpage>1460</fpage>–<lpage>5</lpage> (<year>1998</year>).<pub-id pub-id-type="pmid">9465037</pub-id></mixed-citation>
    </ref>
    <ref id="b21">
      <mixed-citation publication-type="journal"><name><surname>SantaLucia</surname><given-names>J.</given-names></name> &amp; <name><surname>Hicks</surname><given-names>D.</given-names></name>
<article-title>The thermodynamics of DNA structural motifs</article-title>. <source>Annu. Rev. Biophys. Biomol. Struct.</source>
<volume>33</volume>, <fpage>415</fpage>–<lpage>40</lpage> (<year>2004</year>).<pub-id pub-id-type="pmid">15139820</pub-id></mixed-citation>
    </ref>
    <ref id="b22">
      <mixed-citation publication-type="journal"><name><surname>Allawi</surname><given-names>H. T.</given-names></name> &amp; <name><surname>SantaLucia</surname><given-names>J.</given-names></name>
<article-title>Thermodynamics of internal C/T mismatches in DNA</article-title>. <source>Nucleic Acids Res</source>. <volume>26</volume>, <fpage>2694</fpage>–<lpage>2701</lpage> (<year>1998</year>).<pub-id pub-id-type="pmid">9592156</pub-id></mixed-citation>
    </ref>
    <ref id="b23">
      <mixed-citation publication-type="journal"><name><surname>Allawi</surname><given-names>H. T.</given-names></name> &amp; <name><surname>SantaLucia</surname><given-names>J.</given-names></name>
<article-title>Nearest-neighbor thermodynamics of internal A/C mismatches in DNA: Sequence dependence and pH effects</article-title>. <source>Biochemistry</source>
<volume>37</volume>, <fpage>9435</fpage>–<lpage>9444</lpage> (<year>1998</year>).<pub-id pub-id-type="pmid">9649326</pub-id></mixed-citation>
    </ref>
    <ref id="b24">
      <mixed-citation publication-type="journal"><name><surname>Allawi</surname><given-names>H. T.</given-names></name> &amp; <name><surname>SantaLucia</surname><given-names>J.</given-names></name>
<article-title>Nearest neighbor thermodynamic parameters for internal G/A mismatches in DNA</article-title>. <source>Biochemistry</source>
<volume>37</volume>, <fpage>2170</fpage>–<lpage>2179</lpage> (<year>1998</year>).<pub-id pub-id-type="pmid">9485363</pub-id></mixed-citation>
    </ref>
    <ref id="b25">
      <mixed-citation publication-type="journal"><name><surname>Allawi</surname><given-names>H. T.</given-names></name> &amp; <name><surname>Santalucia</surname><given-names>J.</given-names></name>
<article-title>Thermodynamics and NMR of internal G/T mismatches in DNA</article-title>. <source>Biochemistry</source>
<volume>36</volume>, <fpage>10581</fpage>–<lpage>10594</lpage> (<year>1997</year>).<pub-id pub-id-type="pmid">9265640</pub-id></mixed-citation>
    </ref>
    <ref id="b26">
      <mixed-citation publication-type="journal"><name><surname>Peyret</surname><given-names>N.</given-names></name>, <name><surname>Seneviratne</surname><given-names>P. A.</given-names></name>, <name><surname>Allawi</surname><given-names>H. T.</given-names></name> &amp; <name><surname>SantaLucia</surname><given-names>J.</given-names></name>
<article-title>Nearest-neighbor thermodynamics and NMR of DNA sequences with internal A/A, C/C, G/G, and T/T mismatches</article-title>. <source>Biochemistry</source>
<volume>38</volume>, <fpage>3468</fpage>–<lpage>3477</lpage> (<year>1999</year>).<pub-id pub-id-type="pmid">10090733</pub-id></mixed-citation>
    </ref>
    <ref id="b27">
      <mixed-citation publication-type="journal"><name><surname>Yamada</surname><given-names>T.</given-names></name>, <name><surname>Soma</surname><given-names>H.</given-names></name> &amp; <name><surname>Morishita</surname><given-names>S.</given-names></name>
<article-title>PrimerStation: A highly specific multiplex genomic PCR primer design server for the human genome</article-title>. <source>Nucleic Acids Res</source>. <volume>34</volume>, <fpage>W665</fpage>–<lpage>W669</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16845094</pub-id></mixed-citation>
    </ref>
    <ref id="b28">
      <mixed-citation publication-type="journal"><name><surname>Mann</surname><given-names>T.</given-names></name>, <name><surname>Humbert</surname><given-names>R.</given-names></name>, <name><surname>Dorschner</surname><given-names>M.</given-names></name>, <name><surname>Stamatoyannopoulos</surname><given-names>J.</given-names></name> &amp; <name><surname>Noble</surname><given-names>W. S.</given-names></name>
<article-title>A thermodynamic approach to PCR primer design</article-title>. <source>Nucleic Acids Res.</source>
<volume>37</volume>, <fpage>e95</fpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19528077</pub-id></mixed-citation>
    </ref>
    <ref id="b29">
      <mixed-citation publication-type="journal"><name><surname>Kushwaha</surname><given-names>G.</given-names></name>, <name><surname>Srivastava</surname><given-names>G. P.</given-names></name> &amp; <name><surname>Xu</surname><given-names>D.</given-names></name>
<article-title>PRIMEGENSw3: A web-based tool for high-throughput primer and probe design</article-title>. <source>Methods Mol. Biol.</source>
<volume>1275</volume>, <fpage>181</fpage>–<lpage>199</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25697661</pub-id></mixed-citation>
    </ref>
    <ref id="b30">
      <mixed-citation publication-type="journal"><name><surname>Kwok</surname><given-names>S.</given-names></name><etal/>. <article-title>Effects of primer-template mismatches on the polymerase chain reaction: human immunodeficiency virus type 1 model studies</article-title>. <source>Nucleic Acids Res.</source><volume>18</volume>, <fpage>999</fpage>–<lpage>1005</lpage> (<year>1990</year>).<pub-id pub-id-type="pmid">2179874</pub-id></mixed-citation>
    </ref>
    <ref id="b31">
      <mixed-citation publication-type="journal"><name><surname>Dapprich</surname><given-names>J.</given-names></name>, <name><surname>Ferriola</surname><given-names>D.</given-names></name>, <name><surname>Magira</surname><given-names>E. E.</given-names></name>, <name><surname>Kunkel</surname><given-names>M.</given-names></name> &amp; <name><surname>Monos</surname><given-names>D.</given-names></name>
<article-title>SNP-specific extraction of haplotype-resolved targeted genomic regions</article-title>. <source>Nucleic Acids Res</source>. <volume>36</volume>, <fpage>e94</fpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18611953</pub-id></mixed-citation>
    </ref>
    <ref id="b32">
      <mixed-citation publication-type="journal"><name><surname>Leichty</surname><given-names>A. R.</given-names></name> &amp; <name><surname>Brisson</surname><given-names>D.</given-names></name>
<article-title>Selective whole genome amplification for resequencing target microbial species from complex natural samples</article-title>. <source>Genetics</source>
<volume>198</volume>, <fpage>473</fpage>–<lpage>481</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25096321</pub-id></mixed-citation>
    </ref>
    <ref id="b33">
      <mixed-citation publication-type="journal"><name><surname>Gervais</surname><given-names>A. L.</given-names></name>, <name><surname>Marques</surname><given-names>M.</given-names></name> &amp; <name><surname>Gaudreau</surname><given-names>L.</given-names></name>
<article-title>PCRTiler: Automated design of tiled and specific PCR primer pairs</article-title>. <source>Nucleic Acids Res</source>. <volume>38</volume>, <fpage>W308</fpage>–<lpage>12</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20519202</pub-id></mixed-citation>
    </ref>
    <ref id="b34">
      <mixed-citation publication-type="journal"><name><surname>Andonov</surname><given-names>R.</given-names></name>, <name><surname>Yanev</surname><given-names>N.</given-names></name>, <name><surname>Lavenier</surname><given-names>D.</given-names></name> &amp; <name><surname>Veber</surname><given-names>P.</given-names></name>
<article-title>Combinatorial approaches for segmentingbacterium genomes</article-title>. <source>INRIA <bold>RR</bold></source> -<volume>4853</volume>, <fpage>1</fpage>–<lpage>18</lpage> (<year>2003</year>).</mixed-citation>
    </ref>
    <ref id="b35">
      <mixed-citation publication-type="journal"><name><surname>Zakour</surname><given-names>N. B.</given-names></name><etal/>. <article-title>GenoFrag: Software to design primers optimized for whole genome scanning by long-range PCR amplification</article-title>. <source>Nucleic Acids Res</source>. <volume>32</volume>, <fpage>17</fpage>–<lpage>24</lpage> (<year>2004</year>).<pub-id pub-id-type="pmid">14704339</pub-id></mixed-citation>
    </ref>
    <ref id="b36">
      <mixed-citation publication-type="journal"><name><surname>Srivastava</surname><given-names>G. P.</given-names></name> &amp; <name><surname>Xu</surname><given-names>D. Genome-Scale</given-names></name>
<source>Probe and Primer Design with PRIMEGENS</source>. <fpage>159</fpage>–<lpage>175</lpage> (<year>2007</year>).</mixed-citation>
    </ref>
    <ref id="b37">
      <mixed-citation publication-type="journal"><name><surname>Srivastava</surname><given-names>G. P.</given-names></name>, <name><surname>Hanumappa</surname><given-names>M.</given-names></name>, <name><surname>Kushwaha</surname><given-names>G.</given-names></name>, <name><surname>Nguyen</surname><given-names>H. T.</given-names></name> &amp; <name><surname>Xu</surname><given-names>D.</given-names></name>
<article-title>Homolog-specific PCR primer design for profiling splice variants</article-title>. <source>Nucleic Acids Res</source>. <volume>39</volume>, <fpage>e69</fpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21415011</pub-id></mixed-citation>
    </ref>
    <ref id="b38">
      <mixed-citation publication-type="journal"><name><surname>Bukowski</surname><given-names>R.</given-names></name><etal/>. <source>Construction of the third generation Zea mays haplotype map</source>. <italic>bioRxiv</italic><fpage>026963</fpage> (<year>2015</year>).</mixed-citation>
    </ref>
    <ref id="b39">
      <mixed-citation publication-type="other"><name><surname>Innis</surname><given-names>M. A.</given-names></name><article-title>Optimization of PCRs. PCR Protocols: A Guide to Methods and Applications</article-title>.(<name><surname>Innis</surname><given-names>M. A.</given-names></name> &amp; <name><surname>Gelfand</surname><given-names>D. H.</given-names></name>, <name><surname>Sninsky</surname><given-names>J. J.</given-names></name> &amp; <name><surname>White</surname><given-names>T. J.</given-names></name>, eds.) pp. <fpage>21</fpage>–<lpage>27</lpage> (<year>1990</year>).</mixed-citation>
    </ref>
    <ref id="b40">
      <mixed-citation publication-type="journal"><name><surname>Untergasser</surname><given-names>A.</given-names></name><etal/>. <article-title>Primer3-new capabilities and interfaces</article-title>. <source>Nucleic Acids Res.</source><volume>40</volume>, <fpage>e115</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22730293</pub-id></mixed-citation>
    </ref>
    <ref id="b41">
      <mixed-citation publication-type="journal"><name><surname>Kaplinski</surname><given-names>L.</given-names></name> &amp; <name><surname>Remm</surname><given-names>M.</given-names></name>
<article-title>MultiPLX: Automatic grouping and evaluation of PCR primers</article-title>. <source>Methods Mol. Biol.</source>
<volume>1275</volume>, <fpage>127</fpage>–<lpage>142</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25697656</pub-id></mixed-citation>
    </ref>
    <ref id="b42">
      <mixed-citation publication-type="journal"><name><surname>von Ahsen</surname><given-names>N.</given-names></name>, <name><surname>Wittwer</surname><given-names>C. T.</given-names></name> &amp; <name><surname>Schütz</surname><given-names>E.</given-names></name>
<article-title>Oligonucleotide melting temperatures under PCR conditions: nearest-neighbor corrections for Mg(2+), deoxynucleotide triphosphate, and dimethyl sulfoxide concentrations with comparison to alternative empirical formulas</article-title>. <source>Clin. Chem.</source>
<volume>47</volume>, <fpage>1956</fpage>–<lpage>61</lpage> (<year>2001</year>).<pub-id pub-id-type="pmid">11673362</pub-id></mixed-citation>
    </ref>
    <ref id="b43">
      <mixed-citation publication-type="journal"><name><surname>Benita</surname><given-names>Y.</given-names></name>, <name><surname>Oosting</surname><given-names>R. S.</given-names></name>, <name><surname>Lok</surname><given-names>M. C.</given-names></name>, <name><surname>Wise</surname><given-names>M. J.</given-names></name> &amp; <name><surname>Humphery-Smith</surname><given-names>I.</given-names></name>
<article-title>Regionalized GC content of template DNA as a predictor of PCR success</article-title>. <source>Nucleic Acids Res.</source>
<volume>31</volume>, <fpage>e99</fpage> (<year>2003</year>).<pub-id pub-id-type="pmid">12907751</pub-id></mixed-citation>
    </ref>
    <ref id="b44">
      <mixed-citation publication-type="journal"><name><surname>Andreson</surname><given-names>R.</given-names></name>, <name><surname>Mos</surname><given-names>T.</given-names></name> &amp; <name><surname>Remm</surname><given-names>M.</given-names></name>
<article-title>Predicting failure rate of PCR in large genomes</article-title>. <source>Nucleic Acids Res.</source>
<volume>36</volume>, <fpage>e66</fpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18492719</pub-id></mixed-citation>
    </ref>
    <ref id="b45">
      <mixed-citation publication-type="journal"><name><surname>Rees</surname><given-names>W. A.</given-names></name>, <name><surname>Yager</surname><given-names>T. D.</given-names></name>, <name><surname>Korte</surname><given-names>J.</given-names></name> &amp; <name><surname>von Hippel</surname><given-names>P. H.</given-names></name>
<article-title>Betaine can eliminate the base pair composition dependence of DNA melting</article-title>. <source>Biochemistry</source>
<volume>32</volume>, <fpage>137</fpage>–<lpage>144</lpage> (<year>1993</year>).<pub-id pub-id-type="pmid">8418834</pub-id></mixed-citation>
    </ref>
    <ref id="b46">
      <mixed-citation publication-type="journal"><name><surname>Henke</surname><given-names>W.</given-names></name>, <name><surname>Herdel</surname><given-names>K.</given-names></name>, <name><surname>Jung</surname><given-names>K.</given-names></name>, <name><surname>Schnorr</surname><given-names>D.</given-names></name> &amp; <name><surname>Loening</surname><given-names>S. A.</given-names></name>
<article-title>Betaine improves the PCR amplification of GC-rich DNA sequences</article-title>. <source>Nucleic Acids Res.</source>
<volume>25</volume>, <fpage>3957</fpage>–<lpage>3958</lpage> (<year>1997</year>).<pub-id pub-id-type="pmid">9380524</pub-id></mixed-citation>
    </ref>
    <ref id="b47">
      <mixed-citation publication-type="journal"><name><surname>States</surname><given-names>D. J.</given-names></name>, <name><surname>Gish</surname><given-names>W.</given-names></name> &amp; <name><surname>Altschul</surname><given-names>S. F.</given-names></name>
<article-title>Improved sensitivity of nucleic acid database searches using application-specific scoring matrices</article-title>. <source>Methods</source>
<volume>3</volume>, <fpage>66</fpage>–<lpage>70</lpage> (<year>1991</year>).</mixed-citation>
    </ref>
    <ref id="b48">
      <mixed-citation publication-type="journal"><name><surname>Dijkstra</surname><given-names>E. W.</given-names></name><article-title>A note on two problems in connexion with graphs</article-title>. <source>Numer. Math.</source><volume>1</volume>, <fpage>269</fpage>–<lpage>271</lpage> (<year>1959</year>).</mixed-citation>
    </ref>
    <ref id="b49">
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>J.</given-names></name><article-title>Dijkstra’s shortest path algorithm</article-title>. <source>J. Formaliz. Math</source>. <volume>15</volume> (<year>2003</year>).</mixed-citation>
    </ref>
    <ref id="b50">
      <mixed-citation publication-type="journal"><name><surname>Hagberg</surname><given-names>A. A.</given-names></name>, <name><surname>Schult</surname><given-names>D. A.</given-names></name> &amp; <name><surname>Swart</surname><given-names>P. J.</given-names></name>
<article-title>Exploring network structure, dynamics, and function using NetworkX</article-title>. <source>Proc. 7th Python Sci. Conf. (SciPy 2008)</source>
<fpage>11</fpage>–<lpage>15</lpage> (<year>2008</year>).</mixed-citation>
    </ref>
    <ref id="b51">
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>X.</given-names></name><etal/>. <article-title>Improving genome assemblies by sequencing PCR products with PacBio</article-title>. <source>Biotechniques</source><volume>53</volume>, <fpage>61</fpage>–<lpage>2</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22780321</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <fn-group>
    <fn fn-type="COI-statement">
      <p>The authors declare no competing financial interests.</p>
    </fn>
    <fn>
      <p><bold>Author Contributions</bold> RW guided the study. FF and RW conceived the design principles for ThermoAlign. FF wrote the program code and created docker containers. FF executed the computational analysis and program optimization, which iterated based on feedback from MD and RW. MD performed the laboratory validation experiments. FF, RW and MD wrote the manuscript.</p>
    </fn>
  </fn-group>
</back>
<floats-group>
  <fig id="f1">
    <label>Figure 1</label>
    <caption>
      <title>Schematic of the design strategy and workflow for ThermoAlign.</title>
      <p>A single run parameters file is used by all components of the pipeline. Colored boxes represent the four core modules of ThermoAlign, enumerated in their order of operation: (1) target region selection, (2) unique oligonucleotide design, (3) primer specificity evaluation, and (4) primer pair selection. Dashed boxes represent sub-routines within each of these modules and arrows depict their order of operation. The remaining elements are the database (reference genome sequence), external files (variant call format [<italic>.vcf</italic>] files and a run parameters file) and functions (nearest-neighbor model for the <italic>T</italic><sub><italic>m</italic></sub> of homodimer, heterodimer and hairpin interaction functions in Primer3). Connecting lines for these remaining components depict dependencies for the connected components (a filled dot is used to indicate the source from which information or a function is pulled). Required inputs for ThermoAlign are indicated by an asterisk.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep44437-f1"/>
  </fig>
  <fig id="f2">
    <label>Figure 2</label>
    <caption>
      <title>Repeat content and GC percentage across the 24 kb target region described in the text.</title>
      <p>The figure is based on analysis of each 25 bp sequence (26 bp sliding window) of the plus strand. For all subfigures, red lines show the number of thermoalignments with an off-target <italic>T</italic><sub><italic>m</italic></sub> within 10 °C of the corresponding on-target <italic>T</italic><sub><italic>m</italic></sub>. Yellow lines (orange when overlapping with red) show the number of thermoalignments between a given primer and off-target sites with ≥70 percent identity (pid). Blue lines show the percent GC content. The search for off-target sites was based on BLASTn settings used in this study for priming specificity evaluation (see Methods), which had a maximum of 20 potential sites per pseudomolecule or a total of 260 possible sites. <bold>(a)</bold> Cumulative distribution of the number of repeats and percent GC content. <bold>(b)</bold> Genomic distribution of repeat content and GC percentage. The pseudomolecule coordinate of the 5′-nucleotide of each 25 bp sequence was used to position the plotted data. Black horizontal bars on the x-axis show the two genes in this region [left: GRMZM2G031364; right: GRMZM2G031239]. Among 25-mers in the region ≈73% would be predicted to have a misprime <italic>T</italic><sub><italic>m</italic></sub> within 10 °C of the primer <italic>T</italic><sub><italic>m</italic></sub>. <bold>(c)</bold> The CIRCOS plot extends from a single primer in the region with the greatest number (n = 215) of predicted mispriming sites across the genome. Red lines of the CIRCOS plot connect the predicted mispriming sites on the pseudomolecules for chromosomes 1 to 10, the mitochondria (Mt), the plastid (Pt) and unmapped sequences (unkn).</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep44437-f2"/>
  </fig>
  <fig id="f3">
    <label>Figure 3</label>
    <caption>
      <title>Creation and characteristics of thermoalignments compared to local alignments and the number of mismatches.</title>
      <p><bold>(a.1)</bold> Examples of full-length primer sequences. <bold>(a.2)</bold> The top-ranking BLASTn high-scoring segment pair (HSP) alignment for two off-target sequences (bottom strand) is processed into a <bold>(a.3)</bold> thermoalignment by end-filling (ungapped BLASTn) or removing gaps and end-filling (gapped BLASTn) the original BLASTn HSP alignment. <bold>(b)</bold> For 877 candidate primers outputted by the UOD module for the 24 kb region described in the text, the <italic>T</italic><sub><italic>m</italic></sub> was calculated for each top-ranking BLASTn HSP alignment and the corresponding thermoalignment. <bold>(c)</bold> Using the subset of thermoalignments formed from ungapped BLASTn HSPs (n = 169,404 alignments), the plot shows the relationship between the off-target <italic>T</italic><sub><italic>m</italic></sub> for thermoalignments compared to the total number of mismatches. <bold>(d)</bold> Using the same subset of data in <bold>(c)</bold> the plot shows the difference between the on-target <italic>T</italic><sub><italic>m</italic></sub> and the off-target <italic>T</italic><sub><italic>m</italic></sub> of thermoalignments compared to the total number of mismatches.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep44437-f3"/>
  </fig>
  <fig id="f4">
    <label>Figure 4</label>
    <caption>
      <title>Empirical evaluation of ThermoAlign using standard and long-range PCR to tile five genes.</title>
      <p>The products from two additional genes amplified with standard PCR but not long-range PCR (as described in the text) are not shown. Labels indicate the chromosome number of the target locus, the forward primer start site and the expected size of the product. Details on each primer is available in <xref ref-type="supplementary-material" rid="S1">Supplementary File S3</xref>. <bold>(a)</bold> Standard PCR products were quantified without post-PCR purification and approximately ≈7.5 ng were loaded into each well. For the two reactions that had no product, a volume equivalent to the average volume loaded was used. Multiplex reactions composed of primer pairs corresponding to each set for a given gene was loaded alongside the primers belonging to that same set. <bold>(b)</bold> Long-range PCR products from reactions without (−) and with (+) betaine. PCR products were quantified without post-PCR purification and ≈29 ng were loaded into each well. For the three reactions that had a no product, the same volume used for the corresponding betaine reaction was loaded into the well. For the negative control, the maximum volume used among all of the reactions was loaded into the well. The negative control was composed of master mix, primer pair TA_1_25390617_27_F and TA_1_25395472_24_R (<xref ref-type="supplementary-material" rid="S1">Supplementary File S3</xref>) with no DNA template. Lanes with background smearing were associated with reactions that required a greater volume of the product be loaded to achieve a standardized amount of product across lanes.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep44437-f4"/>
  </fig>
  <fig id="f5">
    <label>Figure 5</label>
    <caption>
      <title>Directed graph analysis approach used in ThermoAlign to identify primer pairs for an amplicon tiling path at a targeted region.</title>
      <p><italic>x</italic><sub><italic>i</italic></sub> and <italic>y</italic><sub><italic>i</italic></sub> represent forward and reverse primers respectively. Nodes correspond to expected amplicons (depicted as colored bars), which are ordered by their base pair coordinates. Directed edges (lines with an arrowhead) are drawn between overlapping amplicons, which in this case forms two subgraphs. Edge weights (depicted by the thickness of the lines representing edges; here, thicker lines represent the smaller weighted edges that would be selected) are computed based on the cumulative coverage and amount of overlap. Dijktra’s shortest path algorithm is applied to each subgraph to identify the primer pairs comprising the minimum tiling path of amplicons (black colored edges). As portrayed by the blue and yellow coloring, two groups of non-overlapping primer pairs are designated for multiplex consideration. The expected coverage for this example minimum tiling path is indicated by black (covered) and white (gaps) fill.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep44437-f5"/>
  </fig>
  <table-wrap position="float" id="t1">
    <label>Table 1</label>
    <caption>
      <title>Results from BLASTn alignment of error corrected PacBio consensus sequences to the B73 genome.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="left" valign="top" charoff="50">Amplicon label</th>
          <th align="center" valign="top" charoff="50">Chr.</th>
          <th align="center" valign="top" charoff="50">Start position</th>
          <th align="center" valign="top" charoff="50">Stop position</th>
          <th align="center" valign="top" charoff="50">Alignment length (bp)</th>
          <th align="center" valign="top" charoff="50">Percent identity</th>
          <th align="center" valign="top" charoff="50">CCS depth<sup>1</sup></th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">1: 25,390,617 (4,856 bp)</td>
          <td align="center" valign="top" charoff="50">1</td>
          <td align="center" valign="top" charoff="50">25,390,617</td>
          <td align="center" valign="top" charoff="50">25,395,472</td>
          <td align="center" valign="top" charoff="50">4,856</td>
          <td align="center" valign="top" charoff="50">100%</td>
          <td align="center" valign="top" charoff="50">56</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">1: 25,391,952 (4,589 bp)</td>
          <td align="center" valign="top" charoff="50">1</td>
          <td align="center" valign="top" charoff="50">25,391,952</td>
          <td align="center" valign="top" charoff="50">25,396,540</td>
          <td align="center" valign="top" charoff="50">4,589</td>
          <td align="center" valign="top" charoff="50">100%</td>
          <td align="center" valign="top" charoff="50">2172</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">2: 37,562,840 (4,602 bp)</td>
          <td align="center" valign="top" charoff="50">2</td>
          <td align="center" valign="top" charoff="50">37,562,840</td>
          <td align="center" valign="top" charoff="50">37,567,441</td>
          <td align="center" valign="top" charoff="50">4,602</td>
          <td align="center" valign="top" charoff="50">100%</td>
          <td align="center" valign="top" charoff="50">3988</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">2: 37,564,580 (4,954 bp)</td>
          <td align="center" valign="top" charoff="50">2</td>
          <td align="center" valign="top" charoff="50">37,564,580</td>
          <td align="center" valign="top" charoff="50">37,569,533</td>
          <td align="center" valign="top" charoff="50">4,954</td>
          <td align="center" valign="top" charoff="50">100%</td>
          <td align="center" valign="top" charoff="50">1384</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">3: 33,503,980 (3,330 bp)</td>
          <td align="center" valign="top" charoff="50">3</td>
          <td align="center" valign="top" charoff="50">33,503,980</td>
          <td align="center" valign="top" charoff="50">33,507,309</td>
          <td align="center" valign="top" charoff="50">3,330</td>
          <td align="center" valign="top" charoff="50">100%</td>
          <td align="center" valign="top" charoff="50">2718</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">3: 33,506,037 (3,126 bp)</td>
          <td align="center" valign="top" charoff="50">3</td>
          <td align="center" valign="top" charoff="50">33,506,037</td>
          <td align="center" valign="top" charoff="50">33,509,162</td>
          <td align="center" valign="top" charoff="50">3,126</td>
          <td align="center" valign="top" charoff="50">100%</td>
          <td align="center" valign="top" charoff="50">732</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">6: 7,045,710 (4,786 bp)</td>
          <td align="center" valign="top" charoff="50">6</td>
          <td align="center" valign="top" charoff="50">7,045,710</td>
          <td align="center" valign="top" charoff="50">7,050,495</td>
          <td align="center" valign="top" charoff="50">4,786</td>
          <td align="center" valign="top" charoff="50">100%</td>
          <td align="center" valign="top" charoff="50">2031</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">6: 7,047,707 (4,343 bp)</td>
          <td align="center" valign="top" charoff="50">6</td>
          <td align="center" valign="top" charoff="50">7,047,707</td>
          <td align="center" valign="top" charoff="50">7,052,049</td>
          <td align="center" valign="top" charoff="50">4,343</td>
          <td align="center" valign="top" charoff="50">100%</td>
          <td align="center" valign="top" charoff="50">254</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">7: 128,406,316 (4,933 bp)</td>
          <td align="center" valign="top" charoff="50">7</td>
          <td align="center" valign="top" charoff="50">128,406,316</td>
          <td align="center" valign="top" charoff="50">128,411,248</td>
          <td align="center" valign="top" charoff="50">4,933</td>
          <td align="center" valign="top" charoff="50">100%</td>
          <td align="center" valign="top" charoff="50">4727</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t1-fn1">
        <p><sup>1</sup>Circular consensus sequence (CCS) is PacBio terminology for consensus sequences formed from subreads per zero-mode waveguide. The sequence used for BLASTn was the consensus of all CCSs for a given amplicon).</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
