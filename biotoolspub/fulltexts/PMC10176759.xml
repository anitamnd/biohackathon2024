<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10176759</article-id>
    <article-id pub-id-type="publisher-id">724</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-023-00724-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>UmetaFlow: an untargeted metabolomics workflow for high-throughput data processing and analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kontou</surname>
          <given-names>Eftychia E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Walter</surname>
          <given-names>Axel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Alka</surname>
          <given-names>Oliver</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pfeuffer</surname>
          <given-names>Julianus</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sachsenberg</surname>
          <given-names>Timo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mohite</surname>
          <given-names>Omkar S.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nuhamunada</surname>
          <given-names>Matin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kohlbacher</surname>
          <given-names>Oliver</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Weber</surname>
          <given-names>Tilmann</given-names>
        </name>
        <address>
          <email>tiwe@biosustain.dtu.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5170.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2181 8870</institution-id><institution>The Novo Nordisk Foundation Center for Biosustainability, </institution><institution>Technical University of Denmark, </institution></institution-wrap>Kemitorvet Building 220, 2800 Kgs. Lyngby, Denmark </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.10392.39</institution-id><institution-id institution-id-type="ISNI">0000 0001 2190 1447</institution-id><institution>Applied Bioinformatics, Department of Computer Science, </institution><institution>Eberhard Karls University Tübingen, </institution></institution-wrap>Sand 14, 72076 Tübingen, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.10392.39</institution-id><institution-id institution-id-type="ISNI">0000 0001 2190 1447</institution-id><institution>Institute for Bioinformatics and Medical Informatics, </institution><institution>University of Tübingen, </institution></institution-wrap>Sand 14, 72076 Tübingen, Germany </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.411544.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 0196 8249</institution-id><institution>Translational Bioinformatics, </institution><institution>University Hospital Tübingen, </institution></institution-wrap>Schaffhausenstr. 77, 72072 Tübingen, Germany </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.425649.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 1010 926X</institution-id><institution>Visual and Data-Centric Computing, </institution><institution>Zuse Institute Berlin, </institution></institution-wrap>Takustr. 7, 14195 Berlin, Germany </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.14095.39</institution-id><institution-id institution-id-type="ISNI">0000 0000 9116 4836</institution-id><institution>Algorithmic Bioinformatics, </institution><institution>Freie Universität Berlin, </institution></institution-wrap>Takustr. 9, 14195 Berlin, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>52</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Metabolomics experiments generate highly complex datasets, which are time and work-intensive, sometimes even error-prone if inspected manually. Therefore, new methods for automated, fast, reproducible, and accurate data processing and dereplication are required. Here, we present UmetaFlow, a computational workflow for untargeted metabolomics that combines algorithms for data pre-processing, spectral matching, molecular formula and structural predictions, and an integration to the GNPS workflows Feature-Based Molecular Networking and Ion Identity Molecular Networking for downstream analysis. UmetaFlow is implemented as a Snakemake workflow, making it easy to use, scalable, and reproducible. For more interactive computing, visualization, as well as development, the workflow is also implemented in Jupyter notebooks using the Python programming language and a set of Python bindings to the OpenMS algorithms (pyOpenMS). Finally, UmetaFlow is also offered as a web-based Graphical User Interface for parameter optimization and processing of smaller-sized datasets. UmetaFlow was validated with in-house LC–MS/MS datasets of actinomycetes producing known secondary metabolites, as well as commercial standards, and it detected all expected features and accurately annotated 76% of the molecular formulas and 65% of the structures. As a more generic validation, the publicly available MTBLS733 and MTBLS736 datasets were used for benchmarking, and UmetaFlow detected more than 90% of all ground truth features and performed exceptionally well in quantification and discriminating marker selection. We anticipate that UmetaFlow will provide a useful platform for the interpretation of large metabolomics datasets.</p>
      <sec>
        <title>Graphical Abstract</title>
        <p id="Par2">
          <graphic position="anchor" xlink:href="13321_2023_724_Figa_HTML" id="MO1"/>
        </p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13321-023-00724-w.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Untargeted metabolomics</kwd>
      <kwd>Processing</kwd>
      <kwd>Analysis</kwd>
      <kwd>High-throughput workflow</kwd>
      <kwd>Software</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100009708</institution-id>
            <institution>Novo Nordisk Fonden</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NNF20CC0035580</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>TRR 261/1, Z03</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Forschungscampus MODAL</institution>
        </funding-source>
        <award-id>3FO18501</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pfeuffer</surname>
            <given-names>Julianus</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002347</institution-id>
            <institution>Bundesministerium für Bildung und Forschung</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FKZ: 31A535A</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sachsenberg</surname>
            <given-names>Timo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Switzerland AG 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par3">Untargeted metabolomics is a rapidly developing field. It is widely used in research on natural products, environmental science, food science, and medicine, such as drug and biomarker discovery [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. This approach allows for the comprehensive and qualitative or semiquantitative analysis of as many metabolites as possible in a specimen [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p id="Par4">The sample preparation for metabolomics experiments is inexpensive and easy compared to other <italic>omics</italic> technologies [<xref ref-type="bibr" rid="CR5">5</xref>] and can be fully automated in many cases [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. In addition, constant improvements in throughput are taking place, such as UHPLC–MS systems for shorter chromatographic runtimes, as well as chromatography-free direct infusion [<xref ref-type="bibr" rid="CR8">8</xref>] and flow injection technologies [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. These techniques allow researchers to perform large-scale studies and achieve acquisition rates of hundreds to thousands of samples per day, with some methods reaching to less than 1 s per sample in acquisition time [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par5">These advancements have led to more accessible high-throughput experiments, with numerous institutes moving towards big data. However, even though high-throughput data acquisition is achieved, scaling up data processing and analysis in untargeted metabolomics remains a challenge [<xref ref-type="bibr" rid="CR11">11</xref>]. Most of the currently available tools are web-based, such as XCMS Online [<xref ref-type="bibr" rid="CR12">12</xref>] and MetaboAnalyst [<xref ref-type="bibr" rid="CR13">13</xref>], which can be limiting for sensitive data. Others are restricted to specific operating systems, such as MetAlign 3.0 [<xref ref-type="bibr" rid="CR14">14</xref>], MS-Dial [<xref ref-type="bibr" rid="CR15">15</xref>], or have limited scalability when analyzing hundreds or thousands of files, such as MZmine 2 [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
    <p id="Par6">Here, we report an open-source workflow, UmetaFlow, that applies combinatorial computational algorithms for high-throughput liquid chromatography tandem mass spectrometry (LC–MS/MS) data processing and analysis, using OpenMS [<xref ref-type="bibr" rid="CR17">17</xref>] 3.0 tools for feature detection, map alignment, adduct annotation, re-quantification and feature linking, spectral matching, and structural and formula predictions via SIRIUS [<xref ref-type="bibr" rid="CR18">18</xref>] and CSI:FingerID [<xref ref-type="bibr" rid="CR19">19</xref>]. OpenMS algorithms have been implemented for generating all the files necessary for GNPS Feature-Based Molecular Networking (FBMN) [<xref ref-type="bibr" rid="CR20">20</xref>] and Ion Identity Molecular Networking (IIMN) [<xref ref-type="bibr" rid="CR21">21</xref>]. All these steps are complemented with Python scripts for data integration. The workflow is implemented in a workflow manager, Snakemake [<xref ref-type="bibr" rid="CR22">22</xref>], making it easy to operate in diverse HPC or cloud environments. We evaluated and benchmarked UmetaFlow and demonstrated that it ranks as one of the best tools for feature detection, quantification and marker selection when compared with other untargeted metabolomics software tools, indicating that UmetaFlow can be used as a tool for large-scale metabolomics data processing and analysis.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>UmetaFlow overview</title>
      <p id="Par7">UmetaFlow was built for rapid processing of large LC–MS/MS datasets and for that purpose, it is implemented as a Snakemake [<xref ref-type="bibr" rid="CR23">23</xref>] workflow, allowing high scalability and speed due to parallelization. This version is compatible with macOS and Linux operating systems. In addition, UmetaFlow contains Python bindings to the OpenMS algorithms (pyOpenMS [<xref ref-type="bibr" rid="CR24">24</xref>]) and other Python modules that are commonly used in data science implemented as Jupyter notebooks. This allows for interactive computing, easy data exploration and visualization, as well as rapid prototyping and implementation of new steps. The python version is compatible with macOS, Linux and Windows operating systems.</p>
      <p id="Par8">UmetaFlow can be divided into four parts: (i) data pre-processing and optional re-quantification that generates a table of metabolic features, (ii) formula and structural predictions, (iii) a GNPS-export step that generates all the files necessary for FBMN [<xref ref-type="bibr" rid="CR20">20</xref>] and IIMN [<xref ref-type="bibr" rid="CR21">21</xref>], and (iv) spectral matching. The final output of the workflow is a feature matrix with mass-to-charge (<italic>m/z</italic>), retention time (RT), adduct and peak area (intensity) information of each feature in each input file, as well as fragmented mass spectrum (MS<sup>2</sup>) library matches, and structural and formula prediction annotations. In addition, a GraphML file format originally generated from GNPS is annotated with structural and formula prediction for visual inspection.</p>
      <p id="Par9">Initially, the raw files need to be converted from a vendor-specific format to the open community-driven mzML format. If the data are obtained in profile mode, a peak picking algorithm needs to be applied to convert them to centroided mode for compatibility with the OpenMS algorithms. After centroiding, the ion intensity distribution across <italic>m/z</italic> is reduced to a single point, the peak apex, which leads to significant data reduction. There is an optional initial step in the workflow for file conversion and peak picking of Thermo Fisher raw data through the OpenMS algorithm <italic>FileConverter</italic>. This algorithm uses the ThermoRawFileParser executable (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1a), which is a straightforward tool compatible with Linux, macOS and Windows operating systems [<xref ref-type="bibr" rid="CR25">25</xref>]. A popular alternative, which works for other vendor formats as well, is ProteoWizard’s msConvert [<xref ref-type="bibr" rid="CR26">26</xref>] that can be employed independently (Table <xref rid="Tab1" ref-type="table">1</xref>). ProteoWizard’s msConvert is compatible for Windows and Linux operating systems and thorough documentation is provided at <ext-link ext-link-type="uri" xlink:href="https://proteowizard.sourceforge.io/">https://proteowizard.sourceforge.io/</ext-link> [<xref ref-type="bibr" rid="CR26">26</xref>]. However, vendor software packages should be preferred for centroiding conversion to maintain data integrity.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Supported vendor-format files for conversion with ProteoWizard and analysis with UmetaFlow</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Vendor</th><th align="left">Formats</th></tr></thead><tbody><tr><td align="left">ABI</td><td align="left">T2D</td></tr><tr><td align="left">Agilent</td><td align="left">MassHunter.d</td></tr><tr><td align="left">Bruker</td><td align="left">Compass.d, YEP, BAF, FID, TDF</td></tr><tr><td align="left">Sciex</td><td align="left">WIFF/WIFF2</td></tr><tr><td align="left">Shimadzu</td><td align="left">LCD</td></tr><tr><td align="left">Thermo Scientific</td><td align="left">RAW</td></tr><tr><td align="left">Waters</td><td align="left">MassLynx.raw/UNIFI</td></tr></tbody></table></table-wrap></p>
      <sec id="Sec4">
        <title>Pre-processing</title>
        <p id="Par10">Pre-processing is a crucial step in metabolomics data mining for transforming the raw data to a table of metabolic features [<xref ref-type="bibr" rid="CR11">11</xref>]. This part of the workflow uses OpenMS [<xref ref-type="bibr" rid="CR17">17</xref>] algorithms for feature detection, adduct annotation, feature alignment and clustering (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Initially, the mzML files are processed with the OpenMS tool <italic>HighResPrecursorMassCorrector</italic>, which corrects for mistakenly assigned precursors of MS<sup>2</sup> spectra, by selecting the intact mass spectrum level (MS<sup>1</sup>) peak with the highest intensity using RT and mass range information. This algorithm is useful for Data-Dependent Acquisition (DDA) mode, where the most intense ions in a spectrum are selected for fragmentation but can be ignored for other acquisition methods. The feature detection algorithm <italic>FeatureFinderMetabo</italic> detects mass traces of similar <italic>m/z</italic> along the RT dimension, deconvolves (partially) overlapping chromatographic peaks and assembles co-eluting, single mass traces to metabolite features for data reduction [<xref ref-type="bibr" rid="CR27">27</xref>]. The most important parameters for feature detection are the mass error and noise threshold, defined by the instrument and method that is used to analyze the samples, as well as the peak width, which is directly correlated to the chromatographic system (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). The feature maps generated by <italic>FeatureFinderMetabo</italic> are containers that include information on each feature, such as <italic>m/z</italic>, RT, charge, and intensity, and are stored as featureXML files, an OpenMS file format for LC–MS data. Here, the user can optionally define blanks, quality controls (QCs) or control samples that will allow for background removal by setting an intensity ratio cutoff. The now filtered featureXML files, together with the corresponding mzML files, are then processed by <italic>HighResPrecursorMassCorrector</italic>, which corrects for mistakenly assigned MS<sup>2</sup> parent ions to monoisotopic masses. Next, <italic>MapAlignerPoseClustering</italic> [<xref ref-type="bibr" rid="CR28">28</xref>] performs a linear RT alignment between the featureXML files to correct for any chromatographic RT shifts (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1c). The file used as a reference for alignment is fetched automatically by the algorithm, if not specified by the user, and it is the file with the highest number of features (e.g., a pooled quality control sample). The mzML files are also introduced to <italic>MapRTTransformer</italic> for RT alignment, using transformation description files (.trafoXML) generated from <italic>MapAlignerPoseClustering</italic> [<xref ref-type="bibr" rid="CR28">28</xref>]<italic>.</italic> The aligned feature maps are subjected to analysis with <italic>MetaboliteAdductDecharger,</italic> which is used for adduct annotation (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1e), as well as to convert the charged features to neutral masses, and cluster features that originate from the same metabolite [<xref ref-type="bibr" rid="CR29">29</xref>]. This algorithm is important for information reduction, formula, and structural predictions, as well as for FBMN. Here, the most important parameter is the list of adducts that are possibly generated by the instrument, in positive or negative ionization, and the probability of their occurrence. <italic>IDMapper</italic> [<xref ref-type="bibr" rid="CR30">30</xref>] annotates the features that have MS<sup>2</sup> information to contain necessary metadata for the GNPS-export step. All feature files are finally linked by <italic>FeatureLinkerUnlabeledKD</italic> [<xref ref-type="bibr" rid="CR31">31</xref>] to match corresponding features over several runs by <italic>m/z</italic> and RT and store all feature information in a single consensus map (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1g). An optional step allows for filtering features with too many missing values across samples, by a user-defined number that represents the minimum fraction of samples for a feature to be present. Finally, the consensus map is converted to a table of features with information about <italic>m/z</italic>, RT, adduct, as well as presence and intensity of each feature in each input file (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S2, S3 and S4) in a tab-separated format (.tsv).<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of UmetaFlow. The user can clone UmetaFlow (Snakemake or Jupyter notebook version) from github and follow the step-by-step guide to set it up. <bold>a</bold> The pre-processing step is a set of algorithms that transforms the raw data to a table of metabolic features. One of the most important algorithms of this step is the one for feature detection, that detects mass traces, deconvolutes them and assembles single isotopic mass traces to metabolite features. Map alignment corrects for RT shifts and feature linking connects corresponding features across individual runs. <bold>b</bold> Right after, an optional step for re-quantification of features with missing values can be selected. <bold>c</bold> The generated feature files (re-quantified or not), together with the mzML files, are used as inputs to the SIRIUS executable for formula and structural predictions. <bold>d</bold> The clustered feature files and mzML files are introduced to the <italic>GNPSexport</italic> algorithm to generate all the files necessary for FBMN/IIMN. <bold>e</bold>, <bold>f</bold> The final output of UmetaFlow is a feature matrix and a GraphML network file with MS<sup>2</sup> library matches, and formula and structural prediction annotations</p></caption><graphic xlink:href="13321_2023_724_Fig1_HTML" id="MO2"/></fig></p>
      </sec>
      <sec id="Sec5">
        <title>Re-quantification</title>
        <p id="Par11">Untargeted feature detection unavoidably leads to missing values that represent undetected and low-quality features (e.g., missing intensity or mass trace length thresholds). To overcome this problem, a feature intensity value must be imputed, which is implemented in a lot of metabolomics tools by gap filling [<xref ref-type="bibr" rid="CR11">11</xref>]. Here, we introduce an optional step where if a feature has at least one missing value across all samples, re-quantification is performed to all files (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). In gap filling or any re-quantification step, a secondary feature detection algorithm is used that searches for signals across the mzML files. In UmetaFlow, this step replaces all values across the samples instead of solely the missing one, to maintain comparability of the feature intensities across all samples by using a single quantification algorithm. Using the pre-processed consensus file, a library of features is built from the ones that have at least one missing value along all feature files. This library contains exact mass, charge and RT information and is used as a list of targets for <italic>FeatureFinderMetaboIdent</italic>, a tool that detects and extracts features, commonly used for targeted analysis. The re-quantified feature files are then merged with the previously pre-processed feature files that have no missing values. The merged files are then introduced to <italic>MetaboliteAdductDecharger</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1e), <italic>IDMapper</italic>, and finally, to <italic>FeatureLinkerUnlabeledKD</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1g) for clustering. An optional step here allows again for filtering features with too many missing values across samples, a number that is user-defined. The resulting file is converted to a tab-separated table (.tsv) of metabolic features. Depending on the dataset to be processed, re-quantification of the feature intensities can be very beneficial for the imputation of missing values, especially when dealing with samples that include identical metabolites in varying concentrations. On the contrary, in a case such as the one of our in-house datasets that were used for validation, where there are very few common metabolites and most true features are present in high concentrations, re-quantification can lead to false positive signals.</p>
      </sec>
      <sec id="Sec6">
        <title>Formula and structural predictions with SIRIUS and CSI:FingerID</title>
        <p id="Par12">An optional (tentative) identification of the detected features with available fragmentation data is based on <italic>SiriusAdapter,</italic> an OpenMS tool that invokes an externally provided SIRIUS executable (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). SIRIUS [<xref ref-type="bibr" rid="CR18">18</xref>] generates formula predictions based on scores calculated from MS<sup>2</sup> fragmentation (ppm error and intensity) and MS<sup>1</sup> isotopic pattern scores. CSI:FingerID [<xref ref-type="bibr" rid="CR19">19</xref>] is a web service, which, after the formula predictions are uploaded via the SIRIUS executable, uses those formulas to predict their molecular structure fingerprint using a machine learning approach. The fingerprint is then used to search for matches in structural libraries. Within the <italic>SiriusAdapter</italic> step of UmetaFlow, the user can provide both the mzML and the corresponding pre-processed feature and adduct information (featureXML) as input files to SIRIUS. The algorithm then creates a .ms temporary file (SIRIUS internal format) that is used as an input for the SIRIUS executable, allowing SIRIUS to compute only the MS<sup>2</sup> spectra that are allocated to a feature, instead of all MS<sup>2</sup> data. The pre-processed or re-quantified feature matrix is then annotated with the highest ranked predictions from both algorithms using unique feature identifications (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e), classified as metabolite annotations level 3, according to the Metabolomics Standard Initiative nomenclature (MSI level 3) [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
      </sec>
      <sec id="Sec7">
        <title>Integrating a molecular networking tool: GNPS FBMN/IIMN</title>
        <p id="Par13">One of the most important and widely used tools for molecular networking, annotation and visualization in the metabolomics community is GNPS FBMN [<xref ref-type="bibr" rid="CR20">20</xref>]. In FBMN, MS<sup>2</sup> data are searched against publicly available, crowd-sourced spectral libraries and grouped with related molecules, creating networks within a metabolomics experiment. A new workflow, IIMN [<xref ref-type="bibr" rid="CR21">21</xref>], is also integrated in the GNPS FBMN environment, and allows for connecting and collapsing different adducts of the same feature, improving networks that with sole MS<sup>2</sup> comparisons often remain unconnected. Our GNPS export sub workflow at the end of the pipeline generates all the files necessary for FBNM and IIMN (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d).</p>
        <p id="Par14">FBMN can only analyze features that have associated fragmentation data, so the first step of the GNPS export is to filter the consensus file generated from <italic>FeatureLinkerUnlabeledKD</italic> with the <italic>FileFilter</italic> tool, keeping only features that have MS<sup>2</sup> information. The consensus file is then introduced to the <italic>GNPSExport</italic> tool together with all the mzML files. The tool is responsible for clustering of the MS<sup>2</sup> information to a single MGF file, conversion of the consensus file to a Feature Quantification table (TXT) and generation of a comma-separated supplementary table that allows for connecting and collapsing different adducts of the same feature. Additionally, a tab-separated metadata table is created that contains the filename and the map identification number, originally generated from the feature linking algorithm, but the user can manipulate the file to add more information that will provide an advantage to the visual exploration of the network. The OpenMS FBMN workflow in GNPS is still experimental, and the user can submit a job at <ext-link ext-link-type="uri" xlink:href="https://proteomics2.ucsd.edu">https://proteomics2.ucsd.edu</ext-link> by choosing the latest release of FBMN.</p>
        <p id="Par15">Once the FBMN/IIMN job is completed, the user can download the data and annotate the GraphML file with SIRIUS and CSI:FingerID predictions to facilitate visual inspection of the network (Fig. <xref rid="Fig1" ref-type="fig">1</xref>f).</p>
      </sec>
      <sec id="Sec8">
        <title>Spectral matching</title>
        <p id="Par16">A common strategy for LC–MS/MS data analysis is to perform spectral matching of the experimental spectra to a library of annotated ones. In untargeted metabolomics, correct spectral annotation helps to avoid rediscovery of already known metabolites. UmetaFlow offers this feature through the OpenMS algorithm <italic>MetaboliteSpectralMatcher</italic>. The user is required to provide a spectral library in an MGF, mzML or MSP file format, which could either be a publicly available spectral library (e.g., GNPS [<xref ref-type="bibr" rid="CR33">33</xref>] or MassBank of North America [<xref ref-type="bibr" rid="CR34">34</xref>] that aggregate spectra from various public libraries and user contributions to one location) or an in-house one. The experimental spectral file that is used as an input is the clustered MS<sup>2</sup> file (MGF) generated from the GNPS export step, and the final output is a feature matrix with MSI level 2 identifications [<xref ref-type="bibr" rid="CR32">32</xref>] with the highest matching scores (above 60%).</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>Workflow implementation</title>
      <p id="Par17">Workflow management tools, such as Snakemake, are ideal for scalability, reproducibility, and easy deployment to different cluster, cloud, or server environments [<xref ref-type="bibr" rid="CR35">35</xref>]. The workflow engine-enabled version of UmetaFlow is defined by a cascade of integrated rules with specified input and output sets of files. The user has the flexibility to assign a number of threads and achieve parallelization [<xref ref-type="bibr" rid="CR22">22</xref>] to optimize the runtime. This implementation uses primarily the command line tools of OpenMS 3.0. UmetaFlow is also available in Jupyter notebooks. This version uses Python scripts and, among others, the pyOpenMS 3.0 library. The modular structure of the workflow allows the user to easily add or omit steps, as well as to directly visualize them. Both repositories include a step-by-step guide to set up and run the workflow. Finally, UmetaFlow is also implemented as a web-based Graphical User Interface (GUI) for visualization, parameter optimization and processing of small datasets without the requirement of programming skills. In the GUI, the in silico formula and structural predictions are omitted due to the computational requirements.</p>
    </sec>
    <sec id="Sec10">
      <title>Method evaluation</title>
      <p id="Par18">UmetaFlow was validated and parameter-optimized (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2) with in-house LC–MS–MS/MS data obtained from an UHPLC coupled to a Thermo Orbitrap IDX mass spectrometer from extracts of actinomycete strains that are producing known secondary metabolites, as well as commercial standards. This validation was performed at a pair of Intel(R) Xeon(R) CPU E5-2695 v3 @ 2.30 GHz, with 14 cores per socket and 2 threads per core, with 512 GB of RAM.</p>
      <p id="Par19">The commercial standards that were used for the workflow validation were germicidins A and B, kanamycin, tetracycline hydrochloride, thiostrepton, globomycin, ampicillin and apramycin. The strain extracts that were used for benchmarking were derived from <italic>Streptomyces collinus</italic> Tü 365 (DSMZ 40733) that produces kirromycin and desferrioxamine B [<xref ref-type="bibr" rid="CR36">36</xref>], <italic>Kutzneria</italic> sp. CA-103260 that produces epemicins A and B [<xref ref-type="bibr" rid="CR37">37</xref>] and <italic>Streptomyces</italic> sp. NBC 00162 that produces pyracrimycin A [<xref ref-type="bibr" rid="CR38">38</xref>]. 100% of all expected features were detected in the samples and SIRIUS accurately predicted 76% of all formulas. CSI:FingerID accurately predicted approximately 62% of the structures (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S9). SIRIUS supports only singly charged ions with MS<sup>2</sup> information, so thiostreptone (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S10) and epemicin A (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S11) could not be computed, since only their doubly charged adduct was fragmented. Finally, the spectral matching step complemented the structural predictions with annotations for the germicidins A and B, kirromycin and siderophores of the desferrioxamine pathway (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S10, Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S11), reaching to a total of 65% accurate structural annotations.</p>
      <p id="Par20">For further validation, the workflow was benchmarked for feature detection, quantification and marker selection using the publicly available Thermo Q Exactive dataset with the MetaboLights accession MTBLS733 that includes two standard mixtures (SA, SB) obtained from <italic>Piper nigrum</italic> extracts with 5 replicates per mixture [<xref ref-type="bibr" rid="CR39">39</xref>]. Each mixture consists of the same compounds, some of which are in different concentrations. The concentration ratios between the two mixtures define different compound groups (G<sub>m</sub>, G<sub>d1</sub>–G<sub>d6</sub>), as previously described by Zhucui Li et al<italic>.</italic> [<xref ref-type="bibr" rid="CR39">39</xref>]. In the published research related to the dataset the authors performed targeted analysis using vendor software (refer to the relevant publication for further details) and identified 836 unique features, a number that represents the maximal number of features that can be detected with untargeted software packages and evaluated four untargeted metabolomics processing software (MS-Dial, MZmine 2, XCMS and Compound Discoverer) for feature detection, quantification, and marker selection. To evaluate the software performance quantitatively, all compound-derived true feature fold-changes (SB:SA) were calculated with targeted analysis [<xref ref-type="bibr" rid="CR39">39</xref>]. Following the author’s directions, and after parameter optimization (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4), UmetaFlow could detect 778 true features, a 93.1% untargeted versus targeted identification rate. Out of all true features detected, 736 were accurately quantified (94.6%). To assess the quantification accuracy of UmetaFlow, the fold-changes of the intensities between the mixtures SA and SB of all true features identified were calculated. Then, those fold-changes (FC) were log-transformed and plotted for comparison of the targeted and untargeted approach and the results indicated high accuracy and low variation between features of the same group (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The dataset included 50 discriminating markers with p values &lt; 0.05 and fold-changes &lt; 0.5 or &gt; 2. UmetaFlow could detect 47 true and only 5 false discriminating markers. The performance of the workflow is significantly enhanced with the re-quantification step, detecting 20 additional true features, as well as detecting 2 more true discriminating markers than if we omit this step (Fig. <xref rid="Fig3" ref-type="fig">3</xref>; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5).<fig id="Fig2"><label>Fig. 2</label><caption><p>Relative quantification of true features for compounds identified in the standard mixtures. Log-transformed fold changes of features in the benchmark list measured by targeted analysis of the QE HF dataset. Compound concentration ratios of the matrix group (G<sub>m</sub>) and differential groups (G<sub>d1</sub>–G<sub>d6</sub>) are specified in Fig. <xref rid="Fig1" ref-type="fig">1</xref> of the paper by Zhucui Li et al. [<xref ref-type="bibr" rid="CR39">39</xref>]</p></caption><graphic xlink:href="13321_2023_724_Fig2_HTML" id="MO3"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Feature detection, quantification, and marker selection performance between different untargeted metabolomic data processing software using the benchmark dataset MTBLS733 [<xref ref-type="bibr" rid="CR39">39</xref>]. UmetaFlow is compared with and without the re-quantification step. Refer to Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4 for further details</p></caption><graphic xlink:href="13321_2023_724_Fig3_HTML" id="MO4"/></fig></p>
      <p id="Par21">UmetaFlow was further benchmarked using the dataset generated also by Zhucui Li et al. [<xref ref-type="bibr" rid="CR39">39</xref>], with the MetaboLights accession MTBLS736, analyzed with an AB SCIEX TripleTOF 6600 instrument. After parameter optimization (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6), UmetaFlow could annotate 874 features out of the 970 that were detected using a targeted approach. The workflow could compete with widely used untargeted metabolomics tools (MarkerView, MS-Dial, MZmine2 and XCMS) when compared for feature detection (90.1% true feature ID rate), quantification rate (81.7% accurately quantified features) and discriminating marker selection (59 out of 68 true and 1 false discriminating marker) (Figs. <xref rid="Fig4" ref-type="fig">4</xref>, <xref rid="Fig5" ref-type="fig">5</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7). All benchmarking was performed on a MacBook Pro 2020 with 2 GHz Quad-Core Intel Core i5-1038NG7 with 16 GB RAM.<fig id="Fig4"><label>Fig. 4</label><caption><p>Relative quantification of true features for compounds identified in the standard mixtures. Log-transformed fold changes of features in the benchmark list measured by targeted analysis of the tripleTOF dataset. Compound concentration ratios of the matrix group (Gm) and differential groups (G<sub>d1</sub>–G<sub>d6</sub>) are specified in Fig. <xref rid="Fig1" ref-type="fig">1</xref> of the paper by Zhucui Li et al. [<xref ref-type="bibr" rid="CR39">39</xref>]</p></caption><graphic xlink:href="13321_2023_724_Fig4_HTML" id="MO5"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Feature detection, quantification, and marker selection performance between different untargeted metabolomic data processing software using the benchmark dataset MTBLS736 [<xref ref-type="bibr" rid="CR39">39</xref>]. UmetaFlow is compared with and without the re-quantification step. Refer to Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6 for further details</p></caption><graphic xlink:href="13321_2023_724_Fig5_HTML" id="MO6"/></fig></p>
      <p id="Par22">Furthermore, UmetaFlow was validated with the publicly available datasets MTBLS1129 and MTBLS1130 that include patient colon tumors (n = 197) and normal tissues (n = 39) from men and women, to investigate for sex-specific metabolic subphenotypes between cancer tissues on different anatomic locations. The system used for data acquisition in this experiment was a Waters UPLC coupled to a quadrupole time-of flight (QTOF) mass spectrometer and feature detection was performed using XCMS, and specifically the CAMERA package for metabolite annotation. After parameter optimization (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8), UmetaFlow could detect 90% of the features in positive and 100% of the features in negative mode with similar quantification patterns as the published data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2a, b) [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
      <p id="Par23">Finally, UmetaFlow was used to process and annotate a large metabolomic dataset of 1245 raw files acquired from a Thermo Orbitrap IDX instrument and derived from 100 actinomycete strains, grown in three different conditions with three biological replicates per treatment. The parameters used for that dataset were identical to the ones used for the in-house validation data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2) and they remain as the default parameters of UmetaFlow. Running all 1245 raw files through the pre-processing step was achieved in 1 h 12 m 24 s at a pair of Intel(R) Xeon(R) CPU E5-2695 v3 @ 2.30 GHz, with 14 cores per socket and 2 threads per core, with 512 GB of RAM. Re-quantification took 1 day 17 h 36 min. Acquiring the formula and structural predictions for all files took 9 days 23 h 58 min 16 s and GNPS-export took 29 min and 27 s. The final table consists of 106,578 putative metabolic features. Out of the 56,464 features with MS<sup>2</sup> information, 1684 (∼ 3%) were annotated with spectral matches (MSI level 2 [<xref ref-type="bibr" rid="CR32">32</xref>]), 25,976 (∼ 46%) were annotated with formula predictions and 13,722 (∼ 24%) were annotated with both formula and structural predictions (MSI level 3 [<xref ref-type="bibr" rid="CR32">32</xref>]).</p>
    </sec>
    <sec id="Sec11">
      <title>Opportunities and limitations</title>
      <p id="Par24">UmetaFlow is open-source, fast and scalable, and it allows for the combination of different tools and data integration to facilitate processing and analysis of large untargeted metabolomics datasets. It supports data generated in positive or negative mode and from most instrument types that can be converted to the mzML format (e.g., Thermo Orbitrap, QTOF from various vendors; see Table <xref rid="Tab1" ref-type="table">1</xref> for a list of supported file formats). By omitting SIRIUS and CSI:FingerID, the user can process low resolution data or data with only MS<sup>1</sup> information, and by omitting CSI:FingerID and FBMN/IIMN, the user can process sensitive data (e.g., clinical metabolomic datasets). The modular structure of UmetaFlow allows the user to select specific steps to process their dataset with, modify them, but also add supplemental functionality, for example, statistical analysis and visualization steps. The workflow also allows for re-quantification of features that have missing values across all samples, a unique method to impute missing values.</p>
      <p id="Par25">A limitation of UmetaFlow is the requirements for basic programming skills in order to implement and adapt the Snakemake workflow, as well as access to a server, cluster or cloud environment for processing very large datasets, due to storage requirements that exceed specifications of a common PC. However, the user can delete all the interim files at the end of a run. The most computationally demanding process in the workflow is SIRIUS step, which is optional. Nevertheless, for small(er) datasets, the user can run the workflow successfully using a common PC, such like the one used for benchmarking, either through the Snakemake workflow, the Jupyter Notebooks, or the web-based GUI.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Conclusions</title>
    <p id="Par26">Mass spectrometry data can be numerous and highly complex, creating a need for tools that can analyze large metabolomics datasets. UmetaFlow is a workflow built for automated, high-throughput untargeted mass spectrometry-based metabolomics data processing and analysis using OpenMS algorithms. It allows for fast, scalable, and reproducible analysis through a workflow manager, Snakemake, but also for prototyping or smaller-scale interactive data processing through the Jupyter notebooks. UmetaFlow connects OpenMS, SIRIUS and CSI:FingerID, as well as GNPS FBMN, for processing, annotation, and data interpretation. Here, we show that we have successfully processed 1245 raw files, validated UmetaFlow with in-house data, and benchmarked it using the publicly available datasets MTBLS733 and MTBLS736. UmetaFlow proved to be an efficient tool when compared with widely used untargeted metabolomics software, both in feature detection, quantification, and marker selection. We anticipate that it will become a broadly used tool for research groups that produce large metabolomics datasets or want to analyze large amounts of publicly available data.</p>
  </sec>
  <sec id="Sec13">
    <title>Methods</title>
    <sec id="Sec14">
      <title>Sample preparation</title>
      <p id="Par27">Germicidins A and B were purchased from Cayman Chemical (Ann Arbor, MI, USA) and were dissolved in 1MeOH:1H<sub>2</sub>O:2DMSO to a concentration of 10<sup>–4</sup> mg/mL. Globomycin from <italic>Streptomyces hagronensis</italic> was purchased from Sigma-Aldrich and was dissolved in 20% v/v DMSO to a concentration of 10<sup>–4</sup> mg/mL. Anhydrotetracycline hydrochloride was purchased from Cayman Chemical (Ann Arbor, MI, USA) and dissolved in 40% v/v MeOH to a concentration of 12.5·10<sup>–3</sup> mg/mL. Ampicillin sodium salt, kanamycin sulfate, apramycin sulfate salt and thiostrepton from <italic>Streptomyces azureus</italic> were purchased from Sigma-Aldrich and were dissolved in 40% v/v MeOH to a concentration of 10<sup>–3</sup>, 5.0·10<sup>–3</sup>, 5.0·10<sup>–3</sup> and 2.5·10<sup>–3</sup> mg/mL respectively.</p>
      <p id="Par28"><italic>Streptomyces</italic> sp. NBC 00162, <italic>Streptomyces eridani</italic> and <italic>Streptomyces</italic> sp. CA-210063 were grown, extracted, and analyzed as described by Nielsen et al. [<xref ref-type="bibr" rid="CR38">38</xref>].</p>
      <p id="Par29"><italic>Kutzneria</italic> sp. CA-103260 and <italic>Streptomyces collinus</italic> Tü 365, as well as all strains used for the acquisition of the large-scale study (1245 files) were initially cultivated in 250 mL Erlenmeyer flasks with a stainless-steel spring with 50 mL media ISP2 from in-house frozen stocks. After 48 h of incubation at 30 °C and 200 rpm, the strains were re-inoculated in 24-deep well plates with ISP2 (Yeast extract 4.0 g; Malt extract 10.0 g; Glucose 4.0 g; Distilled water 1000.0 mL; pH 7.2) only for <italic>Streptomyces collinus</italic> Tü 365, DNPM (Dextrin from corn Type I 40.0 g; Bacto soytone 7.5 g; Bacto yeast extract 5.0 g; MOPS 21.0 g; Distilled water 1000.0 mL; pH 7.0) and FPY12 (Fructose 20.0 g; Glucose 10.0 g; Maltose 10.0 g; Bacto peptone 5.0 g; Amicase 5.0 g; Trace elements FPY-12 1 mL; Distilled water 1000.0 mL; pH 7.0; Trace elements FPY-12: FeSO<sub>4</sub>·7 H<sub>2</sub>O 0.5 g; ZnSO<sub>4</sub>·7 H<sub>2</sub>O 0.5 g; MnSO<sub>4</sub>·H<sub>2</sub>O 0.1 g; CuSO<sub>4</sub>·5 H<sub>2</sub>O 0.05 g; CoCl<sub>2</sub>·6 H<sub>2</sub>O 0.05 g; Distilled water 1000.0 mL) media up to a volume of 3.7 mL and optical density (O.D.) of 0.1. After 7 days of incubation at 30 °C and 200 rpm, 200 μL of culture broth per well was transferred in a 96-well Sirocco protein precipitation plate (Waters; 186002448) and positive pressure was applied using a manifold. The supernatant was collected in a 96-well plate. The remaining cells on the filter were disrupted using 3 × 200 μL of methanol that was combined with the supernatant after applying positive pressure. The wells were dried using gentle nitrogen (N2) stream overnight and redissolved in 200 μL of Milli-Q water. Using an Oasis HLB 96-well plate with 60 mg sorbent per well (Waters; 186000679), the samples were purified using 100% v/v MeOH as eluent. The plate was again left overnight under an N<sub>2</sub> stream, re-dissolved in 150 μL 50% v/v methanol and the samples were transferred to glass sample vials.</p>
    </sec>
    <sec id="Sec15">
      <title>Metabolomic data acquisition with LC–MS–MS/MS</title>
      <p id="Par30">The analysis of the pyracrimycin A-containing samples was performed on a high-resolution mass spectrometer (HRMS) Orbitrap Fusion system, as previously described in Nielsen et al. [<xref ref-type="bibr" rid="CR38">38</xref>].</p>
      <p id="Par31">The instrumentation that was used for the analysis of the commercial standards, the large-scale study, and the extracts of <italic>Streptomyces collinus</italic> Tü 365 and <italic>Kutzneria</italic> sp. CA-103260 is a Dionex Ultimate 3000 ultra-high-performance liquid chromatography (UHPLC) coupled to a high-resolution mass spectrometer (HRMS) Orbitrap ID-X (ThermoFisher Scientific, Waltham, MA, USA). The UHPLC method used for the analysis was the following: column, Zorbax Eclipse Plus C-18 column (2.1 × 100 mm, 1.8 μm) (Agilent, Santa Clara, CA, USA); column temperature: 40 °C; solvent A (H<sub>2</sub>O buffered with 0.1% HCOOH) and solvent B (CH<sub>3</sub>OH buffered with 0.1% HCOOH); isocratic: 0–0.8 min, 2% B; gradient: 0.8–2.5 min, 2–5% B; gradient: 2.5–10 min, 5–100% B; isocratic: 10–11 min, 100% B; gradient: 11–11.7 min, 100–2% B; isocratic: 11.7–12.7 min, 2% B; flow rate, 0.350 mL/min. The HRMS was performed in positive mode (+ ESI), at 3500 V spray voltage, in the mass range (<italic>m/z</italic>) 100–1500 (70–100 for the DSMZ 40,733 samples) at a resolution of 120 K, RF Lens 60%, and AGC target 400 K. Before analysis, the MS instrument was calibrated using ESI Positive ion Calibration Solution Pierce™ LTQ Velos ESI Positive Ion Calibration Solution. The software Xcalibur 4.2 (Thermo Fisher Scientific Inc.) was used for targeted data analysis.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13321_2023_724_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. </bold>UmetaFlow: An untargeted metabolomics workflow for high-throughput data processing and analysis. <bold>Figure S1.</bold> A detailed overview of UmetaFlow. <bold>Table S1.</bold> Important instrument, method, and sample-specific parameters for UmetaFlow parameter optimization. <bold>Table S2.</bold> The optimal parameters for OpenMS (UmetaFlow) for feature detection, formula, and structural predictions of the in-house datasets. <bold>Table S3.</bold> Feature detection, structural and formula predictions for pyracrimycin A in <italic>Streptomyces</italic> sp. NBC 00162, <italic>Streptomyces</italic> sp. CA-210063 and <italic>Streptomyces eridani</italic>. <bold>Table S4.</bold> The optimal parameters for OpenMS (UmetaFlow) for feature detection, quantification, and marker selection of the MTBLS733 QE HF dataset. <bold>Table S5</bold>. Feature identification, quantification, and marker selection performance of different untargeted metabolomic data processing software using the benchmark dataset MTBLS733. <bold>Table S6</bold>. The optimal parameters for OpenMS (UmetaFlow) for feature detection, quantification, and marker selection of the MTBLS736 tripleTOF dataset. <bold>Table S7</bold>. Feature identification, quantification, and marker selection performance of different untargeted metabolomic data processing software using the benchmark dataset MTBLS736. <bold>Table S8</bold>. The optimal parameters for OpenMS (UmetaFlow) for feature detection and quantification of the MTBLS1129 and MTBLS1130 dataset. <bold>Figure S1.</bold> Plotted average metabolite intensities in normal and colon cancer tissue samples, detected and quantified with (a) XCMS and (b) UmetaFlow (dataset MTBLS1129).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13321_2023_724_MOESM2_ESM.xls">
            <caption>
              <p><bold>Additional file 2: Table S9.</bold> All the raw in-house data were both manually analyzed and through UmetaFlow for method validation.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13321_2023_724_MOESM3_ESM.xls">
            <caption>
              <p><bold>Additional file 3: Table S10.</bold> Feature detection, structural and formula predictions for commercial standards germicidins A and B, kanamycin, tetracycline hydrochloride, thiostreptone, globomycin, ampicillin and apramycin.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13321_2023_724_MOESM4_ESM.xls">
            <caption>
              <p><bold>Additional file 4: Table S11.</bold> Feature detection, structural and formula predictions for kirromycin and desferrioxamine B from extracts of <italic>Streptomyces collinus</italic> Tü 365 and epemicins A and B from extracts of <italic>Kutzneria sp</italic>. CA-103260.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to acknowledge Daniela Rago for the high-quality metabolomic data acquisition, as well as Ming Wang, Daniel Petras and Robin Schmid for their help and guidance on the GNPS tools and on integrating FBMN/IIMN with OpenMS. The authors would also like to thank the whole GNPS community for their efforts, as well as Kai Blin and Simon Shaw for their guidance with coding standards. Finally, the authors would like to acknowledge their collaborators, Fundación MEDINA, Granada, Spain, as well as their colleagues from DTU for providing the actinomycete strains that were used in this study.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>EEK, TW and OK conceived the work. EEK, AW, OA, TS and JP implemented the libraries, scripts and the workflow. EEK generated the samples and ran the analysis. OM and MN contributed to the Snakemake workflow implementation. All authors contributed to the interpretation of the results and the writing of the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The work of EEK, TW, OM and MN is supported by grants of the Novo Nordisk Foundation [NNF20CC0035580, NNF16OC0021746]. TS was supported by the German Ministry for Research and Education (BMBF) as part of the German Network for Bioinformatics infrastructure (FKZ: 31A535A). JP was funded as part of the Forschungscampus MODAL (project grant 3FO18501). AW and OK are supported by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation TRR 261/1,Z03).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>MS raw data has been deposited at GNPS (<ext-link ext-link-type="uri" xlink:href="https://gnps.ucsd.edu/">https://gnps.ucsd.edu/</ext-link>) under the following MassIVE ID numbers:</p>
    <p>- Commercial standards of antibiotics produced by Streptomyces: MassIVE MSV000090047 or at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/6948449">https://zenodo.org/record/6948449</ext-link>.</p>
    <p>- <italic>Streptomyces collinus</italic> Tü 365 and <italic>Kutzneria</italic> sp. CA-103260 metabolomics files: MassIVE MSV000090048.</p>
    <p>- <italic>Streptomyces</italic> sp. NBC00162, <italic>Streptomyces eridani</italic> and <italic>Streptomyces</italic> sp. CA-210063 metabolomics files: MassIVE MSV000090049.</p>
    <p>- Large-scale actinomycete-extract files: MassIVE MSV000090553.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The workflow engine-enabled version of UmetaFlow is freely available under the Apache License 2.0 at <ext-link ext-link-type="uri" xlink:href="https://github.com/biosustain/snakemake_UmetaFlow">https://github.com/biosustain/snakemake_UmetaFlow</ext-link>. The Jupyter notebooks are freely available under the Apache License 2.0 at <ext-link ext-link-type="uri" xlink:href="https://github.com/biosustain/pyOpenMS_UmetaFlow">https://github.com/biosustain/pyOpenMS_UmetaFlow</ext-link>. The web-based GUI is freely available under the Apache License 2.0 at <ext-link ext-link-type="uri" xlink:href="https://github.com/axelwalter/umetaflow-gui">https://github.com/axelwalter/umetaflow-gui</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par32">EEK, TW, OM, MN, OA and AW declare that they have no competing interests. OK and TS are principals of OpenMS LLC.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>Emerging applications of metabolomics in drug discovery and precision medicine</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>473</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd.2016.32</pub-id>
        <?supplied-pmid 26965202?>
        <pub-id pub-id-type="pmid">26965202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martín-Blázquez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Díaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>González-Flores</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Untargeted LC-HRMS-based metabolomics to identify novel biomarkers of metastatic colorectal cancer</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>20198</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-55952-8</pub-id>
        <?supplied-pmid 31882610?>
        <pub-id pub-id-type="pmid">31882610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Combining genomics, metabolome analysis, and biochemical modelling to understand metabolic networks</article-title>
        <source>Comp Funct Genomics</source>
        <year>2001</year>
        <volume>2</volume>
        <fpage>155</fpage>
        <lpage>168</lpage>
        <pub-id pub-id-type="doi">10.1002/cfg.82</pub-id>
        <?supplied-pmid 18628911?>
        <pub-id pub-id-type="pmid">18628911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sussulini</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Metabolomics: from fundamentals to clinical applications</source>
        <year>2017</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer International Publishing</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zampieri</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sekar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zamboni</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sauer</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Frontiers of high-throughput metabolomics</article-title>
        <source>Curr Opin Chem Biol</source>
        <year>2017</year>
        <volume>36</volume>
        <fpage>15</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cbpa.2016.12.006</pub-id>
        <?supplied-pmid 28064089?>
        <pub-id pub-id-type="pmid">28064089</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J-M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Development of an automated high-throughput sample preparation protocol for LC-MS/MS analysis of glycated peptides</article-title>
        <source>J Chromatogr B</source>
        <year>2018</year>
        <volume>1092</volume>
        <fpage>88</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jchromb.2018.05.036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J-M</given-names>
          </name>
          <name>
            <surname>Duong</surname>
            <given-names>V-A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An automated high-throughput sample preparation method using double-filtration for serum metabolite LC-MS analysis</article-title>
        <source>Anal Methods</source>
        <year>2019</year>
        <volume>11</volume>
        <fpage>4060</fpage>
        <lpage>4065</lpage>
        <pub-id pub-id-type="doi">10.1039/C9AY01137D</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haijes</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Willemsen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Van der Ham</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Direct infusion based metabolomics identifies metabolic disease in patients’ dried blood spots and plasma</article-title>
        <source>Metabolites</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>12</fpage>
        <pub-id pub-id-type="doi">10.3390/metabo9010012</pub-id>
        <?supplied-pmid 30641898?>
        <pub-id pub-id-type="pmid">30641898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fuhrer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zamboni</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>High-throughput discovery metabolomics</article-title>
        <source>Curr Opin Biotechnol</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>73</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.1016/j.copbio.2014.08.006</pub-id>
        <?supplied-pmid 25197792?>
        <pub-id pub-id-type="pmid">25197792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Link</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fuhrer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gerosa</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Real-time metabolome profiling of the metabolic switch between starvation and growth</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>1091</fpage>
        <lpage>1097</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3584</pub-id>
        <?supplied-pmid 26366986?>
        <pub-id pub-id-type="pmid">26366986</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Karaman I, Climaco Pinto R, Graça G (2018) Metabolomics data preprocessing: from raw data to features for statistical analysis. In: Comprehensive analytical chemistry. Elsevier, pp 197–225</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tautenhahn</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Patti</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Rinehart</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>XCMS online: a web-based platform to process untargeted metabolomic data</article-title>
        <source>Anal Chem</source>
        <year>2012</year>
        <volume>84</volume>
        <fpage>5035</fpage>
        <lpage>5039</lpage>
        <pub-id pub-id-type="doi">10.1021/ac300698c</pub-id>
        <?supplied-pmid 22533540?>
        <pub-id pub-id-type="pmid">22533540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MetaboAnalyst 5.0: narrowing the gap between raw spectra and functional insights</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>W388</fpage>
        <lpage>W396</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkab382</pub-id>
        <?supplied-pmid 34019663?>
        <pub-id pub-id-type="pmid">34019663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lommen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kools</surname>
            <given-names>HJ</given-names>
          </name>
        </person-group>
        <article-title>MetAlign 3.0: performance enhancement by efficient use of advances in computer hardware</article-title>
        <source>Metabolomics</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>719</fpage>
        <lpage>726</lpage>
        <pub-id pub-id-type="doi">10.1007/s11306-011-0369-1</pub-id>
        <?supplied-pmid 22833710?>
        <pub-id pub-id-type="pmid">22833710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsugawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cajka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kind</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MS-DIAL: data-independent MS/MS deconvolution for comprehensive metabolome analysis</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>523</fpage>
        <lpage>526</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3393</pub-id>
        <?supplied-pmid 25938372?>
        <pub-id pub-id-type="pmid">25938372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pluskal</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Castillo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Villar-Briones</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Orešič</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MZmine 2: Modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data</article-title>
        <source>BMC Bioinform</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>395</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-395</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pfeuffer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sachsenberg</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Alka</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>OpenMS—a platform for reproducible analysis of mass spectrometry data</article-title>
        <source>J Biotechnol</source>
        <year>2017</year>
        <volume>261</volume>
        <fpage>142</fpage>
        <lpage>148</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbiotec.2017.05.016</pub-id>
        <?supplied-pmid 28559010?>
        <pub-id pub-id-type="pmid">28559010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dührkop</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fleischauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ludwig</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SIRIUS 4: a rapid tool for turning tandem mass spectra into metabolite structure information</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>299</fpage>
        <lpage>302</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0344-8</pub-id>
        <?supplied-pmid 30886413?>
        <pub-id pub-id-type="pmid">30886413</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dührkop</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Meusel</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Searching molecular structure databases with tandem mass spectra using CSI:FingerID</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>12580</fpage>
        <lpage>12585</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1509788112</pub-id>
        <?supplied-pmid 26392543?>
        <pub-id pub-id-type="pmid">26392543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nothias</surname>
            <given-names>L-F</given-names>
          </name>
          <name>
            <surname>Petras</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Feature-based molecular networking in the GNPS analysis environment</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>905</fpage>
        <lpage>908</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-0933-6</pub-id>
        <?supplied-pmid 32839597?>
        <pub-id pub-id-type="pmid">32839597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmid</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Petras</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nothias</surname>
            <given-names>L-F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ion identity molecular networking for mass spectrometry-based metabolomics in the GNPS environment</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>3832</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-23953-9</pub-id>
        <?supplied-pmid 34158495?>
        <pub-id pub-id-type="pmid">34158495</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mölder</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jablonski</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Letcher</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sustainable data analysis with Snakemake. Version 2</article-title>
        <source>F1000Res</source>
        <year>2021</year>
        <volume>10</volume>
        <fpage>33</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.29032.2</pub-id>
        <?supplied-pmid 34035898?>
        <pub-id pub-id-type="pmid">34035898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Snakemake-a scalable bioinformatics workflow engine</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2520</fpage>
        <lpage>2522</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id>
        <?supplied-pmid 22908215?>
        <pub-id pub-id-type="pmid">22908215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Röst</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Malmström</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>pyOpenMS: A Python-based interface to the OpenMS mass-spectrometry algorithm library</article-title>
        <source>Proteomics</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>74</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.201300246</pub-id>
        <?supplied-pmid 24420968?>
        <pub-id pub-id-type="pmid">24420968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hulstaert</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Shofstahl</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sachsenberg</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ThermoRawFileParser: modular, scalable, and cross-platform RAW File conversion</article-title>
        <source>J Proteome Res</source>
        <year>2020</year>
        <volume>19</volume>
        <fpage>537</fpage>
        <lpage>542</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jproteome.9b00328</pub-id>
        <?supplied-pmid 31755270?>
        <pub-id pub-id-type="pmid">31755270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kessner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chambers</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ProteoWizard: open source software for rapid proteomics tools development</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>21</issue>
        <fpage>2534</fpage>
        <lpage>2536</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn323</pub-id>
        <?supplied-pmid 18606607?>
        <pub-id pub-id-type="pmid">18606607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kenar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Franken</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Forcisi</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated label-free quantification of metabolites from liquid chromatography-mass spectrometry data</article-title>
        <source>Mol Cell Proteomics</source>
        <year>2014</year>
        <volume>13</volume>
        <fpage>348</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="doi">10.1074/mcp.M113.031278</pub-id>
        <?supplied-pmid 24176773?>
        <pub-id pub-id-type="pmid">24176773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lange</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gröpl</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schulz-Trieglaff</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A geometric approach for the alignment of liquid chromatography-mass spectrometry data</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>i273</fpage>
        <lpage>i281</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm209</pub-id>
        <?supplied-pmid 17646306?>
        <pub-id pub-id-type="pmid">17646306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bielow</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ruzek</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Optimal decharging and clustering of charge ladders generated in ESI−MS</article-title>
        <source>J Proteome Res</source>
        <year>2010</year>
        <volume>9</volume>
        <fpage>2688</fpage>
        <lpage>2695</lpage>
        <pub-id pub-id-type="doi">10.1021/pr100177k</pub-id>
        <?supplied-pmid 20201597?>
        <pub-id pub-id-type="pmid">20201597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weisser</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Choudhary</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Targeted feature detection for data-dependent shotgun proteomics</article-title>
        <source>J Proteome Res</source>
        <year>2017</year>
        <volume>16</volume>
        <fpage>2964</fpage>
        <lpage>2974</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jproteome.7b00248</pub-id>
        <?supplied-pmid 28673088?>
        <pub-id pub-id-type="pmid">28673088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weisser</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nahnsen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Grossmann</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An automated pipeline for high-throughput label-free quantitative proteomics</article-title>
        <source>J Proteome Res</source>
        <year>2013</year>
        <volume>12</volume>
        <fpage>1628</fpage>
        <lpage>1644</lpage>
        <pub-id pub-id-type="doi">10.1021/pr300992u</pub-id>
        <?supplied-pmid 23391308?>
        <pub-id pub-id-type="pmid">23391308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sumner</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Amberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Proposed minimum reporting standards for chemical analysis Chemical Analysis Working Group (CAWG) Metabolomics Standards Initiative (MSI)</article-title>
        <source>Metabolomics Off J Metabolomic Soc</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>211</fpage>
        <lpage>221</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carver</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Phelan</surname>
            <given-names>VV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sharing and community curation of mass spectrometry data with Global Natural Products Social Molecular Networking</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <issue>8</issue>
        <fpage>828</fpage>
        <lpage>837</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3597</pub-id>
        <?supplied-pmid 27504778?>
        <pub-id pub-id-type="pmid">27504778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Arita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kanaya</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MassBank: a public repository for sharing mass spectral data for life sciences</article-title>
        <source>J Mass Spectrom</source>
        <year>2010</year>
        <volume>45</volume>
        <issue>7</issue>
        <fpage>703</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="doi">10.1002/jms.1777</pub-id>
        <?supplied-pmid 20623627?>
        <pub-id pub-id-type="pmid">20623627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perez-Riverol</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Moreno</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Scalable data analysis in proteomics and metabolomics using BioContainers and workflows engines</article-title>
        <source>Proteomics</source>
        <year>2020</year>
        <volume>20</volume>
        <fpage>1900147</fpage>
        <pub-id pub-id-type="doi">10.1002/pmic.201900147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iftime</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kulik</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Härtner</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification and activation of novel biosynthetic gene clusters by genome mining in the kirromycin producer <italic>Streptomyces collinus</italic> Tü 365</article-title>
        <source>J Ind Microbiol Biotechnol</source>
        <year>2016</year>
        <volume>43</volume>
        <fpage>277</fpage>
        <lpage>291</lpage>
        <pub-id pub-id-type="doi">10.1007/s10295-015-1685-7</pub-id>
        <?supplied-pmid 26433383?>
        <pub-id pub-id-type="pmid">26433383</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kontou</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Gren</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ortiz-López</surname>
            <given-names>FJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Discovery and characterization of epemicins A and B, New 30-membered macrolides from <italic>Kutzneria</italic> sp. CA-103260</article-title>
        <source>ACS Chem Biol</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>1456</fpage>
        <lpage>1468</lpage>
        <pub-id pub-id-type="doi">10.1021/acschembio.1c00318</pub-id>
        <?supplied-pmid 34279911?>
        <pub-id pub-id-type="pmid">34279911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Gren</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mohite</surname>
            <given-names>OS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of the biosynthetic gene cluster for pyracrimycin A, an antibiotic produced by <italic>Streptomyces</italic> sp</article-title>
        <source>ACS Chem Biol</source>
        <year>2022</year>
        <volume>7</volume>
        <fpage>2411</fpage>
        <lpage>2417</lpage>
        <pub-id pub-id-type="doi">10.1021/acschembio.2c00480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive evaluation of untargeted metabolomics data processing software in feature detection, quantification and discriminating marker selection</article-title>
        <source>Anal Chim Acta</source>
        <year>2018</year>
        <volume>1029</volume>
        <fpage>50</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1016/j.aca.2018.05.001</pub-id>
        <?supplied-pmid 29907290?>
        <pub-id pub-id-type="pmid">29907290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Rattray</surname>
            <given-names>NJW</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sex differences in colon cancer metabolism reveal a novel subphenotype</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>4905</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-61851-0</pub-id>
        <?supplied-pmid 32184446?>
        <pub-id pub-id-type="pmid">32184446</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
