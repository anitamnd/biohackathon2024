<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4380030</article-id>
    <article-id pub-id-type="pmid">25388150</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu745</article-id>
    <article-id pub-id-type="publisher-id">btu745</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>Taxator-tk</italic>: precise taxonomic assignment of metagenomes by fast approximation of evolutionary neighborhoods</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Dröge</surname>
          <given-names>J.</given-names>
        </name>
        <xref ref-type="aff" rid="btu745-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu745-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gregor</surname>
          <given-names>I.</given-names>
        </name>
        <xref ref-type="aff" rid="btu745-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu745-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McHardy</surname>
          <given-names>A. C.</given-names>
        </name>
        <xref ref-type="aff" rid="btu745-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu745-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu745-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="btu745-COR1">*</xref>
      </contrib>
      <aff id="btu745-AFF1"><sup>1</sup>Department for Algorithmic Bioinformatics, Heinrich Heine University, Universitätsstraße 1, 40225 Düsseldorf, Germany, <sup>2</sup>Max-Planck Research Group for Computational Genomics and Epidemiology, Max-Planck Institute for Informatics, University Campus E1 4, 66123 Saarbrücken, Germany and <sup>3</sup>Computational Biology of Infection Research, Helmholtz Centre for Infection Research, Inhoffenstraße 7, 38124 Braunschweig, Germany</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu745-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: John Hancock</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>3</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>11</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>11</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>6</issue>
    <fpage>817</fpage>
    <lpage>824</lpage>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>6</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>4</day>
        <month>11</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>11</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Metagenomics characterizes microbial communities by random shotgun sequencing of DNA isolated directly from an environment of interest. An essential step in computational metagenome analysis is taxonomic sequence assignment, which allows identifying the sequenced community members and reconstructing taxonomic bins with sequence data for the individual taxa. For the massive datasets generated by next-generation sequencing technologies, this cannot be performed with <italic>de-novo</italic> phylogenetic inference methods. We describe an algorithm and the accompanying software, <italic>taxator-tk</italic>, which performs taxonomic sequence assignment by fast approximate determination of evolutionary neighbors from sequence similarities.</p>
      <p><bold>Results:</bold><italic>Taxator-tk</italic> was precise in its taxonomic assignment across all ranks and taxa for a range of evolutionary distances and for short as well as for long sequences. In addition to the taxonomic binning of metagenomes, it is well suited for profiling microbial communities from metagenome samples because it identifies bacterial, archaeal and eukaryotic community members without being affected by varying primer binding strengths, as in marker gene amplification, or copy number variations of marker genes across different taxa. <italic>Taxator-tk</italic> has an efficient, parallelized implementation that allows the assignment of 6 Gb of sequence data per day on a standard multiprocessor system with 10 CPU cores and microbial <italic>RefSeq</italic> as the genomic reference data.</p>
      <p><bold>Availability and implementation</bold>: <italic>Taxator-tk</italic> source and binary program files are publicly available at <ext-link ext-link-type="uri" xlink:href="http://algbio.cs.uni-duesseldorf.de/software/">http://algbio.cs.uni-duesseldorf.de/software/</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>Alice.McHardy@uni-duesseldorf.de</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Metagenomics allows us to study microbial communities from natural environments without the need to obtain pure cultures of the individual member species (<xref rid="btu745-B14" ref-type="bibr">Hugenholtz, 2002</xref>; <xref rid="btu745-B30" ref-type="bibr">Riesenfeld <italic>et al</italic>., 2004</xref>). The shotgun sequencing of microbial community DNA with current techniques generates reads that range from less than 100 to several thousand nucleotides (<xref rid="btu745-B9" ref-type="bibr">Dröge and McHardy, 2012</xref>; <xref rid="btu745-B18" ref-type="bibr">Klumpp <italic>et al</italic>., 2012</xref>). By computational analyses of metagenome sequence samples, we can estimate the abundances of different taxa for the sampled communities, known as taxonomic profiling, characterize their functional and metabolic potential based on the predicted proteins and resolve the contributions of individual taxa to the latter by reconstructing ‘bins’ of unassembled or assembled sequences that originate from the same taxon.</p>
    <p>A taxonomic profile of a microbial community can be inferred by either targeted amplification and sequencing of taxonomic marker genes or from metagenome shotgun datasets (<xref rid="btu745-B21" ref-type="bibr">Lindner and Renard, 2013</xref>; <xref rid="btu745-B36" ref-type="bibr">Sunagawa <italic>et al.</italic>, 2013</xref>; <xref rid="btu745-B34" ref-type="bibr">Silva <italic>et al.</italic>, 2014</xref>). Most metagenome profiling methods classify reads based on predefined taxon-specific (<xref rid="btu745-B33" ref-type="bibr">Segata <italic>et al.</italic>, 2012</xref>) or ‘universal’ marker genes (<xref rid="btu745-B8" ref-type="bibr">Darling <italic>et al.</italic>, 2014</xref>), or directly estimate a taxonomic profile for the underlying microbial community from their <italic>k</italic>-mer composition (<xref rid="btu745-B19" ref-type="bibr">Koslicki <italic>et al.</italic>, 2013</xref>). Frequently used phylogenetic placement programs within such frameworks are <italic>pplacer</italic> (<xref rid="btu745-B23" ref-type="bibr">Matsen <italic>et al</italic>., 2010</xref>) or <italic>EPA/RAxML</italic> (<xref rid="btu745-B4" ref-type="bibr">Berger <italic>et al</italic>., 2011</xref>), which both operate in a probabilistic framework to place a query gene sequence in a pre-computed reference phylogeny of a particular gene family. If this gene tree is an approximate representation of the respective species tree—or reference taxonomy—this can be used to assign a taxon identifier (ID) to the query sequence (<xref rid="btu745-B35" ref-type="bibr">Stark <italic>et al</italic>., 2010</xref>; <xref rid="btu745-B24" ref-type="bibr">Matsen and Gallagher, 2012</xref>). Taxon abundances are then derived from the individual read counts or gene frequencies within each taxonomic group.</p>
    <p>Binning methods place the sequences of a shotgun metagenome sample into bins representing the different taxa of the sampled microbial community. If a bin represents a low-ranking taxon, such as species, then the set of reads or contigs of an individual taxonomic bin serves as a draft-genome reconstruction for a community member (<xref rid="btu745-B29" ref-type="bibr">Pope <italic>et al.</italic>, 2011</xref>). Binning methods are either based on clustering or classification. Clustering methods group sequences into bins without consideration of external reference sequences or taxonomic information. Instead, bins are inferred based on similarities in GC content, oligomer frequencies, the abundance of genes or contig coverage within one or multiple samples (<xref rid="btu745-B3" ref-type="bibr">Baran and Halperin, 2012</xref>; <xref rid="btu745-B1" ref-type="bibr">Albertsen <italic>et al.,</italic> 2013</xref>; <xref rid="btu745-B7" ref-type="bibr">Carr <italic>et al</italic>., 2013</xref>; <xref rid="btu745-B2" ref-type="bibr">Alneberg <italic>et al</italic>., 2014</xref>), or by using a combination of these (<xref rid="btu745-B17" ref-type="bibr">Iverson <italic>et al.</italic>, 2012</xref>). This allows draft genome recovery from deep lineages for sequences of sufficient length. Taxonomic binning, like profiling, uses the resemblance of a sequence to known taxa in either global sequence composition or local sequence similarity to assign a taxon ID. For the human gut microbiome, extensive genome sequencing of isolate cultures allowed species-level taxonomic binning for a substantial portion (∼40%) of a metagenome sample (<xref rid="btu745-B32" ref-type="bibr">Schloissnig <italic>et al</italic>., 2013</xref>) by mapping the reads to isolate genome sequences, which exist for many abundant species (<xref rid="btu745-B36" ref-type="bibr">Sunagawa <italic>et al.</italic>, 2013</xref>). However, this procedure is not suitable for environments in which most species are from deep-branching lineages without available reference genome sequences. Taxonomic binning of these requires more sophisticated similarity-based or composition-based taxonomic assignment methods (<xref rid="btu745-B26" ref-type="bibr">McHardy <italic>et al</italic>., 2007</xref>; <xref rid="btu745-B5" ref-type="bibr">Brady and Salzberg, 2011</xref>; <xref rid="btu745-B15" ref-type="bibr">Huson <italic>et al</italic>., 2011</xref>). Taxonomic binning by sequence composition also allows draft genome recovery from deep-branching lineages, based on limited amounts of sequences for the individual taxa (<xref rid="btu745-B26" ref-type="bibr">McHardy <italic>et al</italic>., 2007</xref>). Composition-based programs achieve linear classification times regarding metagenome sample size, whereas similarity-based binning methods require considerably more computational resources for sequence similarity searches in large reference sequence collections. Programs with a focus on processing large amounts of raw sequencing reads, such as <italic>Kraken</italic> (<xref rid="btu745-B37" ref-type="bibr">Wood and Salzberg, 2014</xref>), implement the fastest search strategies. Similarity-based programs are more accurate for the assignment of sequences shorter than 1 kb (<xref rid="btu745-B28" ref-type="bibr">Patil <italic>et al</italic>., 2011</xref>).</p>
    <p>A common aim in taxonomic profiling and taxonomic binning is the identification of known taxa from a sample. A taxonomic profiler estimates a taxonomic abundance profile for the entire sample, which can be inferred by analyzing a smaller number of marker genes, though one needs to account for variations in gene copy numbers for taxon-specific markers (<xref rid="btu745-B21" ref-type="bibr">Lindner and Renard, 2013</xref>). Taxonomic binning assigns taxon IDs to a large portion of the sample sequences for subsequent functional and metabolic analyses of individual taxon bins. In addition, one can generate a taxonomic profile by quantifying the assigned reads, based on read counts or coverage for each individual bin.</p>
    <p>From a methodological standpoint, the differences between the phylogenetic-placement-based methods for profiling and alignment-score-based methods for taxonomic binning and profiling, such as <italic>MEGAN</italic> (<xref rid="btu745-B15" ref-type="bibr">Huson <italic>et al</italic>., 2011</xref>), <italic>CARMA3</italic> (<xref rid="btu745-B11" ref-type="bibr">Gerlach and Stoye, 2011</xref>) or <italic>SOrT-ITEMS</italic> (<xref rid="btu745-B27" ref-type="bibr">Monzoorul Haque <italic>et al</italic>., 2009</xref>) are that the latter lack a well-motivated evolutionary framework. However, they have the advantages of being computationally lightweight and applicable to arbitrary genes, which is a necessity for taxonomic binning. Phylogenetic-placement-based methods cannot currently be used for binning, because the <italic>de-novo</italic> inference of trees for gene families on a metagenome-wide scale is computationally too demanding, particularly for next-generation sequencing (NGS) data.</p>
    <p>Our taxator toolkit (<italic>taxator-tk</italic>) is a software package for the taxonomic sequence assignment in shotgun metagenomics with applications to both profiling and binning. Conceptually, it lies between sequence similarity-based programs which use local sequence alignment scores and those using trees. <italic>Taxator-tk</italic> extends the alignment score-based approach by approximating phylogenetic gene trees and thereby provides more accurate taxonomic assignments, without assuming universal, rank or clade-specific gene conservation levels as parameters. We improve in terms of applicability to large datasets compared with phylogenetic methods by assigning genomic sequences without the computationally demanding steps of <italic>de-novo</italic> multiple sequence alignment (MSA) and tree inference. <italic>Taxator-tk</italic> determines a subset of homologs, which represent the approximate evolutionary neighbors for a query sequence, by a linear number of pairwise sequence comparisons with regard to the number of considered homologs and then assigns a taxon ID using a reference taxonomy based on the taxonomic IDs of these neighbors. We have furthermore reduced the run-time by limiting the analysis to distinct homology-supported regions of the query sequence, which we termed query segmentation. Our open-source (GPLv3) software can be applied to arbitrary nucleotide sequences, such as reads, contigs, scaffolds and complete genomes sequences. It can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://algbio.cs.uni-duesseldorf.de/software/">http://algbio.cs.uni-duesseldorf.de/software/</ext-link>.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 <italic>Taxator-tk</italic>’s workflow for taxonomic assignment</title>
      <p>The workflow for the taxonomic assignment of a nucleotide query sequence comprises three stages (<xref ref-type="fig" rid="btu745-F1">Fig. 1</xref>a–c). The first stage uses a local sequence aligner to identify similar regions from a reference sequence collection, such as microbial <italic>RefSeq</italic> (<italic>mRefSeq</italic>) (<xref rid="btu745-B31" ref-type="bibr">Sayers <italic>et al</italic>., 2009</xref>). The implemented workflows currently use <italic>BLAST+</italic> (<xref rid="btu745-B6" ref-type="bibr">Camacho <italic>et al</italic>., 2009</xref>) version 2.2.28+ using any of the <italic>blastn</italic>, <italic>megablast</italic> or <italic>tblastx</italic> algorithms and nucleotide <italic>LAST</italic> (<xref rid="btu745-B10" ref-type="bibr">Frith <italic>et al</italic>., 2010</xref>) version 320. Other aligners can be used via conversion to a TAB-separated format, if found to be more appropriate. We discuss our choice of the aligner in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Material</ext-link> (‘IX. Sequence homology search via local alignment’). At the beginning of the <italic>taxator</italic> algorithm in Stage 2, overlapping regions on the query, each defined by local alignment to a nucleotide reference sequence, are merged into larger subsequences called segments (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S1</ext-link>). These query segments are flanked by regions without similarity to any reference data (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S2</ext-link>) and are not considered further. This step reduces the overall number of positions in the following alignment computations and improves the taxonomic assignment of queries that have undergone genome rearrangements, resulting in a different order of these segments. The reference sequence regions corresponding to the local alignments are extended at both sides by the missing number of nucleotides to match to the corresponding query segment with respect to its length and we refer to these as reference segments. Each independent set of homologous segments is the input to the core algorithm in the program <italic>taxator</italic> in Stage 2 (<xref ref-type="fig" rid="btu745-F1">Fig. 1</xref>b), which calculates independent taxon IDs for every corresponding query segment.
<fig id="btu745-F1" position="float"><label>Fig. 1.</label><caption><p>Workflow diagram for the taxonomic assignment of a nucleotide query sequence with <italic>taxator-tk</italic>. Taxonomic assignment with <italic>taxator-tk</italic> includes three steps. (<bold>a</bold>) Homology search for query sequence in reference collection using a nucleotide local alignment program. (<bold>b</bold>) Program <italic>taxator</italic> splits the query into distinct segments and determines a taxon ID for each using the corresponding homologs. (<bold>c</bold>) Program <italic>binner</italic> determines a taxon ID for the entire query based on the taxonomic assignments of the individual segments</p></caption><graphic xlink:href="btu745f1p"/></fig></p>
      <p>In the third stage (<xref ref-type="fig" rid="btu745-F1">Fig. 1</xref>c), multiple segments belonging to the same query are considered and their IDs are combined in the program <italic>binner</italic>, to derive a consensus taxon ID. The corresponding algorithm weights the individual segment assignments by the number of identical bases to the closest reference sequence and assigns to the entire query the taxon ID supported by the majority (default = 70% identical bases) of weighted assignments with a minimum number of identical bases (default = 50 bp) (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Material</ext-link>, ‘II. Consensus binning algorithm’). <italic>Binner</italic> has the optional parameters minimum sequence identity and minimum sample abundance, but these were not applied in our analysis. If the taxonomic information is limited or contradictory, <italic>taxator</italic> and <italic>binner</italic> assign identifiers to higher ranking taxa in a conservative fashion to obtain the most reliable taxonomic assignments.</p>
    </sec>
    <sec>
      <title>2.2 The taxonomic assignment algorithm (<italic>taxator</italic>)</title>
      <p>The input to the algorithm is a segment <italic>q</italic> of the original query sequence from an (unknown) taxon Q and a set of homologous segments with known taxon IDs. The term ‘segment’ refers to a gap-less subsequence of either the query or a reference sequence. Given that for the set of homologs we know the correct underlying species tree of taxa (<xref ref-type="fig" rid="btu745-F2">Fig. 2</xref>a), we can see that for our query taxon Q, the closest evolutionary neighbors would be A, B and S. If we simply assign X, the parental taxon of A, B and S, as a taxon identifier, this would be inaccurate, as A, B and S are more closely related to each other than to Q. Instead, the correct taxonomic assignment would be a parent of X and Q, and of at least one additional outgroup taxon (O) in the reference tree, such that Q also becomes a descendant of the identified parent (R in <xref ref-type="fig" rid="btu745-F2">Fig. 2</xref>a). If we therefore identify the taxa A, B, S and O in the reference tree, we can determine the taxon ID of R as the lowest common ancestor (LCA) of these taxa and assign it to Q (and <italic>q</italic>).
<fig id="btu745-F2" position="float"><label>Fig. 2.</label><caption><p>Algorithm for taxonomic labeling of query segments (realignment placement algorithm/RPA). The RPA assigns a taxon ID to a query segment <italic>q</italic>. (<bold>a</bold>) Species reference tree with query taxon Q and reference taxa A, B, C, D, O and S. This will be approximated by the segment phylogenetic tree for the query segment and homologous segments of reference taxa. (<bold>b</bold>) Approximate graph representing pairwise distances between the taxa. The subgraph for clade X is highlighted. (<bold>c</bold> and <bold>d</bold>) The two alignment passes which add segment taxa to an (empty) set <italic>M</italic>. Segment <italic>s</italic> is the segment with the smallest local alignment score (distance) to <italic>q</italic> in the initial similarity search. (<bold>c</bold>) First, all segments are aligned to segment <italic>s</italic>. The resulting distances are ordered and the taxa with equal or smaller distances than <italic>distance(s,q)</italic> are added to <italic>M</italic>. The outgroup segment, here <italic>o</italic>, is the next most similar segment to <italic>s</italic> after <italic>q,</italic> with <italic>distance(o,s) &gt; distance(s,q).</italic> (<bold>d</bold>) All segments are aligned to <italic>o</italic>. From the ranked distances, taxa with distances smaller than <italic>distance(o,q)</italic> are also added to <italic>M</italic>. Thus, <italic>M</italic> includes all the nearest evolutionary neighbors for the query segment <italic>q</italic> (the taxa corresponding to segments <italic>a</italic>, <italic>b</italic>, <italic>c</italic>, <italic>d</italic>, <italic>o</italic> and <italic>s</italic>)<italic>.</italic> The taxon ID then assigned to <italic>q</italic> is the lowest common ancestor in the reference species tree (reference taxonomy) of these taxa in <italic>M</italic>. (<bold>e</bold>) Partially resolved segment subtree at node R that is implied by distances obtained in (c) and (d), where the exact position of some segments (<italic>a</italic>, <italic>b</italic>, <italic>c</italic> and <italic>d</italic>; dashed branches) is left unresolved by the RPA</p></caption><graphic xlink:href="btu745f2p"/></fig></p>
      <p>Assuming that the underlying segment tree for a set of homologs is similar to the species tree, a natural procedure to identify the segments corresponding to the leaf taxa within R among the homologs would be to construct a MSA for the segment and a phylogenetic tree with a corresponding subtree as in <xref ref-type="fig" rid="btu745-F2">Figure 2</xref>a. However, the computational effort for this approach is superlinear with respect to the number of homologs being compared and substantial for all the query segments in a large sample, even using fast techniques for MSA construction and tree inference. The <italic>taxator</italic> algorithm attempts to identify these segments with a linear number of pairwise segment comparisons. Let us consider an undirected graph in which nodes represent the segments (tree leaves) and edge lengths the evolutionary distances between pairs of segments within the underlying tree (<xref ref-type="fig" rid="btu745-F2">Fig. 2</xref>b). In this graph, a monophyletic group in the species tree is a subgraph. For all pairs of subgraph nodes, the following inequality is true, given that the segments have evolved with a constant rate of evolution (i.e. the segment tree is ultrametric): The distance between any two subgraph nodes is smaller than that to any other node outside the subgraph. The relationship becomes clearer when thinking of the evolutionary distance between two nodes as the divergence time from their most recent ancestor. Members of a monophyletic group derive from a single common ancestor and thus there is a maximum distance for all possible pairs. If one member’s distance to an outside node is smaller than this maximum, both must share a more recent common ancestor and the corresponding group is not monophyletic by definition. The stated inequality can be used to augment an incomplete group or corresponding subgraph iteratively by taking an internal distance, ideally close to the maximum, as a threshold and adding outside nodes to the group which have a smaller distance to some internal node.</p>
      <p>In this manner, <italic>taxator</italic> searches for the leaf node taxa of clade R among all segments based on a linear number of sequence comparisons between the input segments and adds them to an empty working set <italic>M:</italic>
<list list-type="simple"><list-item><p>0. A ranking by alignment scores from the input local alignments is used at the beginning to identify the reference segment <italic>s</italic> that is most similar to the query <italic>q</italic>.</p></list-item></list></p>
      <p>The working set <italic>M</italic> is then augmented in two passes:
<list list-type="order"><list-item><p>In the first pass, all segments are aligned to <italic>s</italic> using fast nucleotide alignment and the edit distance. These scores in the following serve to approximate the evolutionary distances in the underlying segment phylogeny. All segment taxa with a distance less than or equal to the threshold <italic>distance(s,q)</italic> are added to <italic>M</italic> (<xref ref-type="fig" rid="btu745-F2">Fig. 2</xref>c).</p></list-item><list-item><p>The outgroup segment <italic>o</italic> is determined as the first segment for which <italic>distance(s,o)</italic> is larger than <italic>distance(s,q)</italic>. In the second pass, all segments are then aligned to <italic>o</italic> and segment taxa with distances smaller than or equal to <italic>distance(o,q)</italic> are added to <italic>M</italic> as well (<xref ref-type="fig" rid="btu745-F2">Fig. 2</xref>d).</p></list-item></list></p>
      <p>This procedure requires approximately 2<italic>n</italic> alignments, where <italic>n</italic> is the number of reference segments.
<list list-type="simple"><list-item><p>3. The resulting set <italic>M</italic> of taxa (implicit in the partially resolved tree in <xref ref-type="fig" rid="btu745-F2">Fig. 2</xref>e) is used to determine the taxon ID for <italic>q</italic>, corresponding to the LCA of these taxa in a reference taxonomy, such as the NCBI taxonomy.</p></list-item></list></p>
      <p>If no outgroup could be determined or if <italic>M</italic> is so diverse that the LCA corresponds to the taxonomy root, <italic>q</italic> is left unassigned. The algorithm requires at least two homologous segments (<italic>s</italic> and <italic>o</italic>) to determine a meaningful taxon ID. The taxa in <italic>M</italic> become more diverse if the alignment scores are inaccurate ultrametric distance estimates, if the species subtree’s topology deviates from the respective part of the taxonomy or if the gene tree’s topology deviates from the species tree, for instance due to varying rates of evolution or the inclusion of non-homologous segments in the analysis. The robustness of the algorithm in avoiding incorrect assignments under these circumstances relies on the number of taxa in <italic>M</italic> and the subsequent LCA operation. Further details relating to the robustness of the implementation are given in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Materials</ext-link>, ‘I. Taxonomic assignment of sequence segments’.</p>
    </sec>
    <sec>
      <title>2.3 Evaluation procedures</title>
      <p>Before evaluating any method, we removed the smallest predicted bins (1%) as likely errors. We used the macro-precision and macro-recall as measures of assignment performance (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Materials</ext-link>, ‘Performance measures’). The macro-precision specifies the fraction of correct assignments per predicted bin (precision), averaged over all such bins, whereas the macro-recall measures the fraction of correctly recovered sequence data per truly existing bin (recall), averaged over all such bins. To account for strong differences in bin size, we also pooled the species, genus and family assignments, and reported the overall precision for these ranks as the total fraction of correct assignments. We tested the assignment performance of different methods using three simulated short read datasets, simulated 16S rRNA data, three simulated metagenome contig datasets and using assembled cow rumen metagenome contigs. For every simulated dataset, we performed seven cross-validation experiments (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Materials</ext-link>, ‘VII. Cross-validation’). In each experiment, we simulated a specific minimum taxonomic distance between a query sequence and the reference sequences. For the first experiment, all reference data, including the species genome data from which the query had been sampled, were made available to the method for assigning a single query sequence as an idealized test case. In the other six scenarios, all reference data belonging to the species, genus, family, order, class or phylum of the query sequence, respectively, were made inaccessible for the method in leave-one-taxon-out cross-validation experiments. We summarized the sequence assignments from these experiments to characterize a method’s assignment performance across the entire range of taxonomic distances. For evaluation with the cow rumen metagenome sample, for which no true taxonomic labels were known, we divided the assembled contigs into multiple sequence ‘chunks’ and characterized the consistency of taxonomic assignments for chunks originating from same contig (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Material</ext-link>, ‘VIII. Consistency analysis’).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Evaluation with unassembled data</title>
      <p>We first evaluated the performance of <italic>taxator-tk</italic> for classification of the most widely used taxonomic marker in bacterial diversity studies—the 16S rRNA gene (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S3</ext-link>). This served as a proof of concept, as <italic>taxator-tk</italic> classifies arbitrary sequence regions including taxonomic marker genes. We did not expect it to perform better than sophisticated phylogenetic models for this task, but wanted to confirm a satisfactory performance. The macro-precision for the taxonomic assignment of 7176 16S rRNA genes (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S4</ext-link>) was constantly above 92% (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S3a</ext-link>) in the combined cross-validation (Methods), using the whole-genome reference sequences in <italic>mRefSeq47</italic> (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S5</ext-link>), not just the 16S genes. More precisely, the average error rate per bin (one minus precision) was 7.4% at the species level and 4.6% at the order level.</p>
      <p>Next, we simulated 100 000 reads at 100, 500 and 1000 bp by subsampling randomly from 1729 species in <italic>mRefSeq47</italic> and evaluated <italic>taxator-tk</italic> with these three datasets using the (combined) cross-validation experiments. The performance was very similar for the different fragment sizes (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Figs S6–S8a</ext-link>). Overall, <italic>taxator-tk</italic> showed high precision in simulated read assignment: the macro-precision for all short read lengths remained above 74% and was 82–99% for the genus to kingdom ranks, about 10% lower on average than for the 16S data. This was still good for the assignment of short sequence fragments from arbitrary genomic regions compared with a marker gene. At genus level, the macro-recall was 19–23% (∼33% genera recovered) if genome sequences of the same species as the query sequence were provided in the reference (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Figs S6–S8b</ext-link>) and as low as 5–7% (∼16% genera recovered) otherwise (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Figs S6–S8c</ext-link>). The macro-recall depends on the availability of related reference data at the respective ranks. It decreases when removing reference data for cross-validation. For example, if all reference data at genus level are removed, then no correct assignments to the genus rank are possible. For lower taxonomic ranks, the macro-recall was also low due to the large number of sample taxa and their uneven representation caused by the taxonomic bias toward a few abundant phyla in <italic>mRefSeq47</italic>. The longer reads had a slightly higher macro-recall than the shorter ones. Since longer sequences yield better recall and because overlapping reads contain redundant information, leading to more alignment computations, we recommend applying <italic>taxator-tk</italic> to (partially) assembled data. For longer query sequences, we were more likely to find segments for processing and therefore to assign a larger portion of the sample.</p>
    </sec>
    <sec>
      <title>3.2 Evaluation with simulated metagenome contigs</title>
      <p>For our tests on three simulated contig samples, we compared <italic>taxator-tk</italic> to <italic>CARMA3</italic> and <italic>MEGAN4/5</italic> using the same taxonomy and the same nucleotide alignments against <italic>mRefSeq54</italic> (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S9</ext-link>). Additionally, we applied these three methods to two datasets using protein-level alignments which we inferred using <italic>BLAST+/tblastx</italic>. When doing so, we used the programs recommended parameter settings (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Material</ext-link>, ‘X. Program parameters and versions’) and cross-validation, as before (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Material</ext-link>, ‘V. Cross-validation’).</p>
      <p>We created a simulated NGS metagenome dataset (simArt49e, composition in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S10</ext-link>) for our evaluation. This sample includes 49 equally abundant species (51 strains) and was created by Illumina paired read simulation with <italic>pIRS</italic> (<xref rid="btu745-B16" ref-type="bibr">Hu <italic>et al</italic>., 2012</xref>), followed by <italic>SOAPdenovo</italic> version 1.05 (<xref rid="btu745-B22" ref-type="bibr">Luo <italic>et al.,</italic> 2012</xref>) assembly. Around 160 Mb or 267 178 contigs remained after removal of 0.03% chimeric sequences. In the combined cross-validation with this dataset (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Figs S11–S13a</ext-link>), <italic>taxator-tk</italic> produced substantially fewer errors: sequence assignments to species, genus and family were 91% correct for <italic>taxator-tk</italic>, compared with 52% for <italic>CARMA3</italic> and 59% for <italic>MEGAN4</italic>. Accordingly, <italic>taxator-tk</italic> showed the highest macro-precision of all methods, e.g. 61% at the species level, compared with 3% (<italic>CARMA3</italic>) and 5% (<italic>MEGAN4</italic>). The low macro-precision observed for <italic>CARMA3</italic> and <italic>MEGAN4</italic> is largely due to the prediction of many small bins with many false assignments (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Material</ext-link>, ‘V. Performance measures’). The majority of assignments were to bacteria, archaea or undetermined in the case of <italic>CARMA3</italic>, because we restricted the availability of similar reference sequences in each of the individual cross-validations, which we then jointly assessed.</p>
      <p>When only the sequences from the corresponding species and genus were removed from the reference (new genus scenario, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Figs S11–S13d</ext-link>), <italic>taxator-tk</italic> was also the most precise, though it had a lower recall than the other methods (<italic>taxator-tk</italic>: 56% family macro-precision, 60% overall precision for species to family, 10% family macro-recall; <italic>CARMA3</italic>: 13%, 27% and 20%; <italic>MEGAN4</italic>: 22%, 27% and 31%). Differences in assignment precision were also evident in the number of predicted taxon bins: for instance, when simulating novel families (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Figs S11–S13e</ext-link>), many more species bins were predicted by <italic>CARMA3</italic> (1672) and <italic>MEGAN4</italic> (824) than by <italic>taxator-tk</italic> (65), with 49 species being present in the sample. Similarly, <italic>MEGAN4</italic> predicted 69 orders, <italic>CARMA3</italic> 81 and <italic>taxator-tk</italic> 27, compared with the existing 32 orders in simArt49e (<xref ref-type="fig" rid="btu745-F3">Fig. 3</xref>). Overall, taxonomic assignments of <italic>taxator-tk</italic> were more rarely to false taxa at low ranks than with the other methods, and instead were to higher-ranking correct taxa. The other two methods assigned a substantial amount of sequence data incorrectly to bins at the family level or below. This can be seriously misleading if the results were to be used to estimate species diversity or to reconstruct genomes. Therefore, <italic>taxator-tk</italic> is better suited for taxonomic profiling in addition to its primary task—the recovery of individual taxonomic sequence bins from shotgun datasets.
<fig id="btu745-F3" position="float"><label>Fig. 3.</label><caption><p>Comparison of three classifiers for a novel-family simulation using a simulated metagenome sample (simArt49e) with 49 species. <italic>CARMA3</italic>, <italic>MEGAN4</italic> and <italic>taxator-tk</italic>: the outer ring with red background shading shows family-level assignments for all orders included in the simulated dataset. These are all false in the chosen evaluation scenario, as no data from the families of the query sequences were included in the reference collection in the leave-one-taxon-out cross-validation experiments. Clearly, taxator-tk had the fewest assignments at family level, demonstrating its high precision in assignments. Assignments at inner rings, gray background shading, can be correct in principle, demonstrating at which taxonomic ranks the different methods tend to make their assignments, with taxator-tk tending toward producing higher ranking assignments, as a trade-off for the high precision</p></caption><graphic xlink:href="btu745f3p"/></fig></p>
      <p>To investigate the reason for the observed differences between overall and macro-precision, which reflect variations in assignment precision for bins of different sizes, we plotted the per-bin precision at the family level in the combined cross-validation, as a function of predicted bin size with a <italic>k</italic>-nearest-neighbor (kNN) estimate of macro-precision (<xref ref-type="fig" rid="btu745-F4">Fig. 4</xref>; see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S14</ext-link> for all ranks). Overall, the bins predicted by <italic>taxator-tk</italic> were smaller, more precise and much more likely to represent truly existing taxa than those predicted by the other programs although larger bins tended to be more accurate for all methods. <italic>CARMA3</italic> and <italic>MEGAN4</italic> predicted a substantial number of mostly smaller-sized incorrect bins. Although the size-dependent kNN precision curves at large bin sizes is unaffected by these small bins, the curves remained below 70% (<italic>CARMA3</italic>) or 80% (<italic>MEGAN4</italic>), whereas the <italic>taxator-tk</italic> curve reached almost 100%. For the smallest bins, <italic>taxator-tk</italic>’s kNN precision was approximately 20% whereas bins below 500 kb for <italic>CARMA3</italic> and <italic>MEGAN4</italic> were practically indistinguishable from noise. This shows that the high macro-precision with <italic>taxator-tk</italic> is not only due to a lower frequency of falsely predicted bins, but also due to a substantially higher precision for the large bins.
<fig id="btu745-F4" position="float"><label>Fig. 4.</label><caption><p>Family-level bin precision for the simulated metagenome sample with 49 species (simArt49e). (<bold>a–c</bold>) Each family bin’s assignment precision related to logarithmic bin size for seven cross-validation experiments with simArt49e. The results of the single experiments were added to assess the taxonomic assignment performance across a range of evolutionary distances between the query and the reference sequences, excluding the least abundant bins (1% of total basepairs). We calculated the precision values for (<bold>a</bold>) <italic>CARMA3</italic>, (<bold>b</bold>) <italic>MEGAN4</italic> and (<bold>c</bold>) <italic>taxator-tk</italic>, counting assignments to lower-ranking taxa at the family level, and added a smoothed <italic>k</italic>-nearest-neighbor estimate of the mean precision in R using <italic>wapply</italic> (width = 0.3) followed by <italic>smooth.spline</italic> (df = 10). <italic>CARMA3</italic> and <italic>MEGAN4</italic> incorrectly identified many small taxonomic bins, substantially more than <italic>taxator-tk</italic>. (<bold>d</bold>) The amount of correct, false and undetermined family-level assignments for the different classifiers with simArt49e</p></caption><graphic xlink:href="btu745f4p"/></fig></p>
      <p>Next, we performed cross-validation on the FAMeS (<xref rid="btu745-B25" ref-type="bibr">Mavromatis <italic>et al</italic>., 2007</xref>) SimMC/AMD (∼17 Mb/7307 contigs) and SimHC/soil (∼1 Mb/578 contigs) simulated metagenome datasets. These contigs were assembled from simulated Sanger (not NGS) reads and represent considerably smaller samples than those which are generated with the current NGS technologies (<xref rid="btu745-B9" ref-type="bibr">Dröge and McHardy, 2012</xref>). We also measured the methods’ performance on these data for a direct comparison to previous works. As before, <italic>taxator-tk</italic> had the highest macro-precision and the most realistic number of predicted taxon bins (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Figs S15–S20</ext-link>; <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Material ‘XII</ext-link>. FAMeS cross-validation’).</p>
      <p>For the contig assignments of the composition-based program <italic>PhyloPythiaS</italic> (<xref rid="btu745-B28" ref-type="bibr">Patil <italic>et al</italic>., 2011</xref>), we could not apply cross-validation, due to the computational effort of training many models. Therefore, we adopted the published evaluation scenario from <xref rid="btu745-B28" ref-type="bibr">Patil <italic>et al</italic> (2011)</xref>, in which all genome sequences of the SimMC genera were removed from the reference genome sequence before classifying the contigs. All programs were provided with the remaining sequenced genomes and an additional 100 kb of reference data for each of the three dominant strains. The latter could be used by <italic>PhyloPythiaS</italic> to infer a corresponding species model, but were less helpful for the similarity-based classifiers. We generated assignments with <italic>taxator-tk</italic>, <italic>CARMA3</italic> and <italic>MEGAN4/5</italic> under equivalent conditions, once with nucleotide and once separately with protein local alignments, and compared them with both <italic>Kraken</italic> and the published <italic>PhyloPythiaS</italic> assignments (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S21</ext-link>). The performance and error distributions for the similarity-based programs (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S21c</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">d</ext-link>) were consistent with our previous evaluations with SimMC. <italic>MEGAN4</italic> and <italic>MEGAN5</italic> produced almost identical results. Using protein local alignments, we observed a moderate increase in overall species to family precision for <italic>MEGAN5</italic> and <italic>CARMA3</italic>, while <italic>taxator-tk</italic> improved in macro-recall. Notably, <italic>taxator-tk</italic> showed the best macro-precision of all similarity-based programs and all ranks, regardless of which alignment kind was used. <italic>Kraken</italic> produced most errors and the lowest macro-precision, because it assigned almost exclusively at species level. This would make it generally unsuitable in situations where sequences of closely related genomes are unavailable. However, it had a comparatively high macro-recall up to the order level.</p>
      <p>Assignment with <italic>PhyloPythiaS</italic> showed that composition-based classification, when supplied with limited amounts of additional training data from the relevant species, correctly assigned most data at the genus and family levels (species assignments were not assessed in the original publication), which were either rarely assigned by <italic>taxator-tk</italic> or mostly incorrectly assigned by <italic>CARMA3</italic>, <italic>MEGAN</italic> and <italic>Kraken</italic>. However, <italic>PhyloPythiaS</italic> predicted only 6 families compared with 29 underlying families, versus 43 (<italic>Kraken</italic>), 14/18 (<italic>taxator-tk</italic>), 50/32 (<italic>CARMA3</italic>) and 17/18 (<italic>MEGAN5</italic>) with nucleotide or protein alignments, respectively. <italic>PhyloPythiaS</italic> had the highest macro-recall. The macro-precision (∼50% for genus, family and order level) was also higher than for <italic>Kraken</italic> (∼4–13%), <italic>MEGAN</italic> (∼7–31%) or <italic>CARMA3</italic> (∼7–48%) but less than for <italic>taxator-tk</italic> (∼32–68%). However, unlike for the other programs, the modeled taxa for <italic>PhyloPythiaS</italic> should be specified <italic>a priori</italic> to achieve optimal performance. It is therefore best applied when the taxonomic composition of a microbial community has already been determined and sufficient training data are available for the identified taxa.</p>
    </sec>
    <sec>
      <title>3.3 Evaluation with real metagenome contigs</title>
      <p>For microbial communities in many environments, only distantly related reference genome sequences are available. We analyzed a medium complex metagenome sample of such a microbial community from cow rumen (<xref rid="btu745-B13" ref-type="bibr">Hess <italic>et al</italic>., 2011</xref>) with <italic>taxator-tk</italic>, <italic>CARMA3</italic>, <italic>MEGAN4/5</italic> and <italic>PhyloPythiaS</italic> (the general model with the 100 most abundant species among sequenced prokaryotes). We considered scaffolds to be less reliable than contigs, which we reconstructed by splitting the available scaffolds at gaps of more than 200 positions (A.Sczyrba, personal communication). We subsequently divided contigs longer than 10 kb into sequence ‘chunks’ of 2 kb, resulting in a 319-Mb dataset, which we used to assess the assignment consistency for chunks originating from the same contig. The chunk sequences were assigned with <italic>taxator-tk</italic>, <italic>CARMA3</italic>, <italic>MEGAN</italic> (given identical nucleotide/protein alignments), <italic>Kraken</italic> and <italic>PhyloPythiaS</italic>. As the standard of truth for each contig, we determined the taxon minimizing the inconsistency between all corresponding chunk assignments (<xref rid="btu745-B12" ref-type="bibr">Gregor <italic>et al.</italic>, 2014</xref>; unpublished data) for each method independently. A chunk assignment was considered consistent, if it was to the same taxon as the assignment of the entire contig, and inconsistent otherwise. The consistency of a taxonomic bin is the fraction of chunk sequences with matching contig assignments and the macro-consistency is the consistency averaged over all predicted taxa, similar to the macro-precision.</p>
      <p>In agreement with the results for the simulated metagenome datasets, the <italic>taxator-tk</italic> results were the most consistent among all tested methods, regardless of the alignment type (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S22</ext-link>): 76–89% macro-consistency at species-to-order level, in comparison to <italic>MEGAN</italic> (34–40%), <italic>CARMA</italic> (0–55%), <italic>Kraken</italic> (32–35%) and <italic>PhyloPythiaS</italic> (56–65%). The overall consistency (analogous to overall precision) for species-to-family levels was 97%/97% with <italic>taxator-tk</italic>, 39%/48% with <italic>CARMA3</italic>, 62%/64% with <italic>MEGAN</italic> (nucleotide/protein-level), 42% with <italic>Kraken</italic> and 82% with <italic>PhyloPythiaS</italic>. Likewise, <italic>taxator-tk</italic> assigned less data at species-to-family level, with a total of 13/12 Mb being consistent compared with <italic>CARMA3</italic> (8/26 Mb), <italic>MEGAN</italic> (42/47 Mb), <italic>Kraken</italic> (19 Mb) or <italic>PhyloPythiaS</italic> (14 Mb). The different methods again determined different numbers of taxa: <italic>CARMA3</italic> predicted 572/611 genera with a macro-consistency of 53%/31%, <italic>MEGAN</italic> 264/203 genera (34%/37%), <italic>Kraken</italic> 661 (32%), <italic>PhyloPythiaS</italic> 33 (63%) and <italic>taxator-tk</italic> found 110/27 genera (76%/81%). The high consistency values observed for <italic>taxator-tk</italic> indicate that it is a precise taxonomic classifier for real metagenomic contigs.</p>
    </sec>
    <sec>
      <title>3.4 Run-time analyses</title>
      <p>The run-time for the taxonomic metagenome assignment was measured as the time to find homologs and to assign taxon IDs to all sequences. We evaluated the run-times of all methods using the same set of alignments generated with either <italic>BLAST</italic> or <italic>LAST</italic>. Thus, the run-time for the initial similarity search was identical for all methods. We determined the time for the taxonomic assignment of simArt49e for all methods when performing a cross-validation with families present in the test dataset removed from the reference data (<xref ref-type="fig" rid="btu745-F3">Fig. 3</xref>). This took 2 min with <italic>Kraken</italic> (single CPU core and ∼100 GiB RAM), 1 h for <italic>MEGAN4</italic> (interactive mode), 6 h for <italic>taxator-tk</italic> (∼10 CPU cores) and almost a week for <italic>CARMA3</italic> (∼20 CPU cores). The parallelization of <italic>taxator-tk</italic> led to a linear decrease in time with the number of CPU cores for up to 15 cores, which became sublinear for 20 cores or more (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S23</ext-link>). To provide a more specific estimate of the throughput of <italic>taxator-tk</italic>, we aligned ∼1 Gb of cow rumen sequence data with <italic>BLAST</italic> against <italic>mRefSeq54</italic> and assigned the data with <italic>taxator-tk</italic> on 10 CPU cores (AMD Opteron 6386 SE). We measured an average throughput of 5.9 Gb per day for the combined alignment and taxonomic assignment steps with this dataset. We also determined how our implementation scaled for increasing input sequence lengths and reference exclusion scenarios (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S24a</ext-link>). The run-time scaled approximately linearly except when the same or very similar species were among the reference genome sequences. In general, the greater the number of similar sequences in the reference data, the longer <italic>taxator-tk’s</italic> run-time was for the alignment of longer sequence stretches with more homologs. Simultaneously, we investigated the impact of the query segmentation on <italic>taxator-tk’s</italic> run-time (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Fig. S24b</ext-link>) and found that it reduced the total run-time by up to 30%.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p><italic>Taxator-tk</italic> is a taxonomic assignment software package which generates very precise taxonomic assignments with few errors for metagenome shotgun sequences. To provide a fair comparison, we invested extensive effort into ensuring that we evaluated all methods under identical conditions with the same reference sequences, test datasets and background taxonomies, using their recommended settings. We evaluated <italic>taxator-tk</italic> on 16S gene sequences, on simulated short reads, with simulated assembled contigs and with 2 kb contig fragments from a real cow rumen metagenome. For each simulated sample, we evaluated a wide range of evolutionary distances between the query and reference sequences using leave-one-taxon-out cross-validation. <italic>Taxator-tk</italic> was the most precise of all tested methods with the most realistic number of identified taxa overall. This property was very pronounced for lower taxonomic ranks from species-to-family level. However, <italic>taxator-tk</italic> assigned fewer data overall than other methods from species to family. For the small assembled SimMC dataset, it assigned fewer data, particularly in comparison to the composition-based classifier <italic>PhyloPythiaS</italic>, when 100 kb of data were provided for individual community members to train species-level models. For the real cow rumen dataset, <italic>taxator-tk</italic> was the most consistent in terms of classifying multiple pieces of one contig. Our results consistently indicate that <italic>taxator-tk</italic>’s strength is its high precision of assignments, which allows us to confidently assign a core of sample sequences and thereby to infer the taxonomic composition of the community. In comparison to assignments based on marker genes, it has the advantages that it makes assignments across all domains of life and that corresponding abundance estimates from shotgun sequences are less affected by copy number variations of individual genes. Such shotgun estimates are also unaffected by PCR primer amplification biases, unlike marker gene sequencing techniques, and do not require high-quality reference gene phylogenies for marker genes. We confirmed this by in depth analysis of six 15 Gb shotgun samples from the barley rhizosphere, where we applied <italic>taxator-tk</italic> to characterize the taxonomic composition of bacteria, archaea and eukaryotes, which correlated with results from 16S rRNA profiling and showed the most notable deviations for taxa known to be affected by primer biases or having multiple copies of the 16S rRNA gene (Bulgarelli <italic>et al</italic>., unpublished data). To target draft genome reconstructions, the data assigned to individual taxonomic bins by <italic>taxator-tk</italic> can be used as training data for complementary approaches, such as composition-based methods, or as independent information in combination with recently proposed clustering methods using the abundance of genes or contigs across multiple samples.</p>
    <p>From a methodological point of view, we have introduced a method for the fast approximation of the evolutionary neighborhood of a query sequence with a run-time that increases linearly with the number of homologs. In <italic>de-novo</italic> phylogenetic inference methods, the run-time increases at least log-linearly with the number of homologs or they rely on time-consuming optimizations of parameter-rich phylogenetic models, which generates excessive computational requirements for the analysis of Gb-sized NGS samples. Our software provides an easy to use and scalable alternative to taxonomic classification of marker genes that is applicable to any nucleotide fragment. Unlike other similarity-based taxonomic classifiers for shotgun data, our algorithm handles different degrees of sequence conservation without preset or user-specified parameters such as alignment scores (overall or per gene family) and without being restricted to the analysis of a number of high-quality homologs with a minimal length. At the same time, the inferred evolutionary neighborhood is extended by the identification of an outgroup, leading to more precise taxonomic assignments, while regions without detectable taxonomic signal are instantly discarded. We post-process independent taxonomic assignments of query segments to infer an assignment for the entire query and do this using a majority vote algorithm with a few robust default parameters. This computationally lightweight step can be quickly repeated with other values for the majority and minimum support parameters, if required. In addition to the algorithmic considerations and other run-time optimizations, we implemented query sequence segmentation and program parallelization, which allow large-scale data analysis with a throughput of several Gbs per day on a standard multiprocessor system.</p>
    <p>The program’s scope is also not limited to the taxonomic assignment of metagenomes: It can be applied to any DNA or RNA sequence. For instance, another successful in-house application is the detection of contaminations in isolate sequencing data. Furthermore, the program <italic>taxator</italic> within <italic>taxator-tk</italic> provides taxonomic information for individual query segments (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">Supplementary Figs S2</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu745/-/DC1">S25</ext-link>), which could be used to identify assembly errors or regions acquired by lateral gene transfer.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_6_817__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btu745_Supplementary_Material_Taxator-tk_updated.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>Computational support and infrastructure were provided by the ‘Centre for Information and Media Technology’ (ZIM) at the University of Düsseldorf (Germany).</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>The authors gratefully acknowledge funding by the <funding-source>Max-Planck society</funding-source> and <funding-source>Heinrich Heine University Düsseldorf</funding-source>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btu745-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albertsen</surname><given-names>M.</given-names></name><etal/></person-group><italic>.</italic> (<year>2013</year>) <article-title>Genome sequences of rare, uncultured bacteria obtained by differential coverage binning of multiple metagenomes</article-title>. <source>Nat. Biotechnol.</source>, <volume>31</volume>, <fpage>533</fpage>–<lpage>538</lpage>.<pub-id pub-id-type="pmid">23707974</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alneberg</surname><given-names>J.</given-names></name><etal/></person-group><italic>.</italic> (<year>2014</year>) <article-title>Binning metagenomic contigs by coverage and composition</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>1144</fpage>–<lpage>1146</lpage>.<pub-id pub-id-type="pmid">25218180</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baran</surname><given-names>Y.</given-names></name><name><surname>Halperin</surname><given-names>E.</given-names></name></person-group> (<year>2012</year>) <article-title>Joint analysis of multiple metagenomic samples</article-title>. <source>PLoS Comput. Biol.</source>, <volume>8</volume>, <fpage>e1002373</fpage>.<pub-id pub-id-type="pmid">22359490</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berger</surname><given-names>S.A.</given-names></name><etal/></person-group><italic>.</italic> (<year>2011</year>) <article-title>Performance, accuracy, and web server for evolutionary placement of short sequence reads under maximum likelihood</article-title>. <source>Syst. Biol.</source>, <volume>60</volume>, <fpage>291</fpage>–<lpage>302</lpage>.<pub-id pub-id-type="pmid">21436105</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brady</surname><given-names>A.</given-names></name><name><surname>Salzberg</surname><given-names>S.</given-names></name></person-group> (<year>2011</year>) <article-title>PhymmBL expanded: confidence scores, custom databases, parallelization and more</article-title>. <source>Nat. Methods</source>, <volume>8</volume>, <fpage>367</fpage>.<pub-id pub-id-type="pmid">21527926</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Camacho</surname><given-names>C.</given-names></name><etal/></person-group><italic>.</italic> (<year>2009</year>) <article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>, <volume>10</volume>, <fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carr</surname><given-names>R.</given-names></name><etal/></person-group><italic>.</italic> (<year>2013</year>) <article-title>Reconstructing the genomic content of microbiome taxa through shotgun metagenomic deconvolution</article-title>. <source>PLoS Comput. Biol.</source>, <volume>9</volume>, <fpage>e1003292</fpage>.<pub-id pub-id-type="pmid">24146609</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Darling</surname><given-names>A.E.</given-names></name><etal/></person-group><italic>.</italic> (<year>2014</year>) <article-title>PhyloSift: phylogenetic analysis of genomes and metagenomes</article-title>. <source>PeerJ</source>, <volume>2</volume>, <fpage>e243</fpage>.<pub-id pub-id-type="pmid">24482762</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dröge</surname><given-names>J.</given-names></name><name><surname>McHardy</surname><given-names>A.C.</given-names></name></person-group> (<year>2012</year>) <article-title>Taxonomic binning of metagenome samples generated by next-generation sequencing technologies</article-title>. <source>Brief. Bioinform.</source>, <volume>13</volume>, <fpage>646</fpage>–<lpage>655</lpage>.<pub-id pub-id-type="pmid">22851513</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frith</surname><given-names>M.C.</given-names></name><etal/></person-group><italic>.</italic> (<year>2010</year>) <article-title>Parameters for accurate genome alignment</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>80</fpage>.<pub-id pub-id-type="pmid">20144198</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerlach</surname><given-names>W.</given-names></name><name><surname>Stoye</surname><given-names>J.</given-names></name></person-group> (<year>2011</year>) <article-title>Taxonomic classification of metagenomic shotgun sequences with CARMA3</article-title>. <source>Nucleic Acids Res.</source>, <volume>39</volume>, <fpage>e91</fpage>.<pub-id pub-id-type="pmid">21586583</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gregor</surname><given-names>I.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>PhyloPythiaS+: a self-training method for the rapid reconstruction of low-ranking taxonomic bins from metagenomes</article-title>. <comment><ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1406.7123">http://arxiv.org/abs/1406.7123</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="btu745-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hess</surname><given-names>M.</given-names></name><etal/></person-group><italic>.</italic> (<year>2011</year>) <article-title>Metagenomic discovery of biomass-degrading genes and genomes from cow rumen</article-title>. <source>Science</source>, <volume>331</volume>, <fpage>463</fpage>–<lpage>467</lpage>.<pub-id pub-id-type="pmid">21273488</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hugenholtz</surname><given-names>P.</given-names></name></person-group> (<year>2002</year>) <article-title>Exploring prokaryotic diversity in the genomic era</article-title>. <source>Genome Biol.</source>, <volume>3</volume>, <fpage>1</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btu745-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huson</surname><given-names>D.H.</given-names></name><etal/></person-group><italic>.</italic> (<year>2011</year>) <article-title>Integrative analysis of environmental sequences using MEGAN4</article-title>. <source>Genome Res.</source>, <volume>21</volume>, <fpage>1552</fpage>–<lpage>1560</lpage>.<pub-id pub-id-type="pmid">21690186</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>X.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) <article-title>pIRS: profile-based Illumina pair-end reads simulator</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1533</fpage>–<lpage>1535</lpage>.<pub-id pub-id-type="pmid">22508794</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iverson</surname><given-names>V.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) <article-title>Untangling genomes from metagenomes: revealing an uncultured class of marine Euryarchaeota</article-title>. <source>Science</source>, <volume>335</volume>, <fpage>587</fpage>–<lpage>590</lpage>.<pub-id pub-id-type="pmid">22301318</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klumpp</surname><given-names>J.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) <article-title>Next generation sequencing technologies and the changing landscape of phage genomics</article-title>. <source>Bacteriophage</source>, <volume>2</volume>, <fpage>190</fpage>–<lpage>199</lpage>.<pub-id pub-id-type="pmid">23275870</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koslicki</surname><given-names>D.</given-names></name><etal/></person-group><italic>.</italic> (<year>2013</year>) <article-title>Quikr: a method for rapid reconstruction of bacterial communities via compressive sensing</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2096</fpage>–<lpage>2102</lpage>.<pub-id pub-id-type="pmid">23786768</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kunin</surname><given-names>V.</given-names></name><etal/></person-group><italic>.</italic> (<year>2008</year>) <article-title>A bioinformatician’s guide to metagenomics</article-title>. <source>Microbiol. Mol. Biol. Rev.</source>, <volume>72</volume>, <fpage>557</fpage>–<lpage>578</lpage>.<pub-id pub-id-type="pmid">19052320</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindner</surname><given-names>M.S.</given-names></name><name><surname>Renard</surname><given-names>B.Y.</given-names></name></person-group> (<year>2013</year>) <article-title>Metagenomic abundance estimation and diagnostic testing on species level</article-title>. <source>Nucleic Acids Res.</source>, <volume>41</volume>, <fpage>e10</fpage>.<pub-id pub-id-type="pmid">22941661</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>R.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) <article-title>SOAPdenovo2: an empirically improved memory-efficient short-read <italic>de novo</italic> assembler</article-title>. <source>Gigascience</source>, <volume>1</volume>, <fpage>18</fpage>.<pub-id pub-id-type="pmid">23587118</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsen</surname><given-names>F.A.</given-names></name><etal/></person-group><italic>.</italic> (<year>2010</year>) <article-title>pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>538</fpage>.<pub-id pub-id-type="pmid">21034504</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsen</surname><given-names>F.A.</given-names></name><name><surname>Gallagher</surname><given-names>A.</given-names></name></person-group> (<year>2012</year>) <article-title>Reconciling taxonomy and phylogenetic inference: formalism and algorithms for describing discord and inferring taxonomic roots</article-title>. <source>Algorithms Mol. Biol.</source>, <volume>7</volume>, <fpage>8</fpage>.<pub-id pub-id-type="pmid">22549005</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mavromatis</surname><given-names>K.</given-names></name><etal/></person-group><italic>.</italic> (<year>2007</year>) <article-title>Use of simulated data sets to evaluate the fidelity of metagenomic processing methods</article-title>. <source>Nat. Methods</source>, <volume>4</volume>, <fpage>495</fpage>–<lpage>500</lpage>.<pub-id pub-id-type="pmid">17468765</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McHardy</surname><given-names>A.C.</given-names></name><etal/></person-group><italic>.</italic> (<year>2007</year>) <article-title>Accurate phylogenetic classification of variable-length DNA fragments</article-title>. <source>Nat. Methods</source>, <volume>4</volume>, <fpage>63</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">17179938</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monzoorul Haque</surname><given-names>M.</given-names></name><etal/></person-group><italic>.</italic> (<year>2009</year>) <article-title>SOrt-ITEMS: sequence orthology based approach for improved taxonomic estimation of metagenomic sequences</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1722</fpage>–<lpage>1730</lpage>.<pub-id pub-id-type="pmid">19439565</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patil</surname><given-names>K.R.</given-names></name><etal/></person-group><italic>.</italic> (<year>2011</year>) <article-title>Taxonomic metagenome sequence assignment with structured output models</article-title>. <source>Nat. Methods</source>, <volume>8</volume>, <fpage>191</fpage>–<lpage>192</lpage>.<pub-id pub-id-type="pmid">21358620</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pope</surname><given-names>P.B.</given-names></name><etal/></person-group><italic>.</italic> (<year>2011</year>) <article-title>Isolation of Succinivibrionaceae implicated in low methane emissions from Tammar wallabies</article-title>. <source>Science</source>, <volume>333</volume>, <fpage>646</fpage>–<lpage>648</lpage>.<pub-id pub-id-type="pmid">21719642</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riesenfeld</surname><given-names>C.S.</given-names></name><etal/></person-group><italic>.</italic> (<year>2004</year>) <article-title>Metagenomics: genomic analysis of microbial communities</article-title>. <source>Annu. Rev. Genet.</source>, <volume>38</volume>, <fpage>525</fpage>–<lpage>552</lpage>.<pub-id pub-id-type="pmid">15568985</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sayers</surname><given-names>E.W.</given-names></name><etal/></person-group><italic>.</italic> (<year>2009</year>) <article-title>Database resources of the National Center for Biotechnology Information</article-title>. <source>Nucleic Acids Res.</source>, <volume>37</volume>, <fpage>D5</fpage>–<lpage>D15</lpage>.<pub-id pub-id-type="pmid">18940862</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schloissnig</surname><given-names>S.</given-names></name><etal/></person-group><italic>.</italic> (<year>2013</year>) <article-title>Genomic variation landscape of the human gut microbiome</article-title>. <source>Nature</source>, <volume>493</volume>, <fpage>45</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">23222524</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Segata</surname><given-names>N.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) <article-title>Metagenomic microbial community profiling using unique clade-specific marker genes</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>811</fpage>–<lpage>814</lpage>.<pub-id pub-id-type="pmid">22688413</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silva</surname><given-names>G.G.Z.</given-names></name><etal/></person-group><italic>.</italic> (<year>2014</year>) <article-title>FOCUS: an alignment-free model to identify organisms in metagenomes using non-negative least squares</article-title>. <source>PeerJ</source>, <volume>2</volume>, <fpage>e425</fpage>.<pub-id pub-id-type="pmid">24949242</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stark</surname><given-names>M.</given-names></name><etal/></person-group><italic>.</italic> (<year>2010</year>) <article-title>MLTreeMap—accurate maximum likelihood placement of environmental DNA sequences into taxonomic and functional reference phylogenies</article-title>. <source>BMC Genomics</source>, <volume>11</volume>, <fpage>461</fpage>.<pub-id pub-id-type="pmid">20687950</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sunagawa</surname><given-names>S.</given-names></name><etal/></person-group><italic>.</italic> (<year>2013</year>) <article-title>Metagenomic species profiling using universal phylogenetic marker genes</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>1196</fpage>–<lpage>1199</lpage>.<pub-id pub-id-type="pmid">24141494</pub-id></mixed-citation>
    </ref>
    <ref id="btu745-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wood</surname><given-names>D.E.</given-names></name><name><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group> (<year>2014</year>) <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol.</source>, <volume>15</volume>, <fpage>R46</fpage>.<pub-id pub-id-type="pmid">24580807</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
