<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8607637</article-id>
    <article-id pub-id-type="publisher-id">4473</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04473-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HaplotypeTools: a toolkit for accurately identifying recombination and recombinant genotypes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8456-7458</contrib-id>
        <name>
          <surname>Farrer</surname>
          <given-names>Rhys A.</given-names>
        </name>
        <address>
          <email>r.farrer@exeter.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.8391.3</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8024</institution-id><institution>Medical Research Council Centre for Medical Mycology at the University of Exeter, </institution></institution-wrap>Exeter, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>560</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>11</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Identifying haplotypes is central to sequence analysis in diploid or polyploid genomes. Despite this, there remains a lack of research and tools designed for physical phasing and its downstream analysis.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">HaplotypeTools is a new toolset to phase variant sites using VCF and BAM files and to analyse phased VCFs. Phasing is achieved via the identification of reads overlapping ≥ 2 heterozygous positions and then extended by additional reads, a process that can be parallelized across a computer cluster. HaplotypeTools includes various utility scripts for downstream analysis including crossover detection and phylogenetic placement of haplotypes to other lineages or species. HaplotypeTools was assessed for accuracy against WhatsHap using simulated short and long reads, demonstrating higher accuracy, albeit with reduced haplotype length. HaplotypeTools was also tested on real Illumina data to determine the ancestry of hybrid fungal isolate <italic>Batrachochytrium dendrobatidis</italic> (<italic>Bd</italic>) SA-EC3, finding 80% of haplotypes across the genome phylogenetically cluster with parental lineages <italic>Bd</italic>GPL (39%) and <italic>Bd</italic>CAPE (41%), indicating those are the parental lineages. Finally, ~ 99% of phasing was conserved between overlapping phase groups between SA-EC3 and either parental lineage, indicating mitotic gene conversion/parasexuality as the mechanism of recombination for this hybrid isolate. HaplotypeTools is open source and freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/rhysf/HaplotypeTools">https://github.com/rhysf/HaplotypeTools</ext-link> under the MIT License.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">HaplotypeTools is a powerful resource for analyzing hybrid or recombinant diploid or polyploid genomes and identifying parental ancestry for sub-genomic regions.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Haplotype</kwd>
      <kwd>Phasing</kwd>
      <kwd>Recombination</kwd>
      <kwd>Software</kwd>
      <kwd>
        <italic>Batrachochytrium dendrobatidis</italic>
      </kwd>
      <kwd>Hybridization</kwd>
      <kwd>Recombination</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010269</institution-id>
            <institution>wellcome trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>215239/Z/19/Z</award-id>
        <principal-award-recipient>
          <name>
            <surname>Farrer</surname>
            <given-names>Rhys A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">DNA sequence analysis based on alignments to unphased diploid or polyploid genome assemblies can result in errors and misleading results [<xref ref-type="bibr" rid="CR1">1</xref>]. These errors will scale with the abundance of heterozygosity. Such reference genomes and accompanying gene annotation typically consist of haploid sequences representing a ‘patchwork’ of haplotypes (nucleotides that co-occur in a single chromosome), and thus, any given base may derive from either chromosome. Genome sequencing and alignment rarely distinguishes variants found together (cis) or on homologous chromosomes (trans), and therefore neglects to identify the allelic variation of genes, and instead describes only the sum of all variants in both homologous genes. In the most extreme case of two or three heterozygous positions co-localizing in a codon, nonsense or readthrough mutations may be unidentified or misidentified through lack of or inaccurate phasing information. For example, the codon WGW (where W = IUPAC for Weak bond = A or T) reflects either AGA (Arg) and TGT (Cys) or AGT (Ser) and TGA (Stop) in the standard genetic code.</p>
    <p id="Par5">Identifying haplotypes (nucleotides in phase) is central to determining genotype–phenotype associations from heterozygous alleles, identifying recombinant or hybrid isolates in microbial populations, and determining parental ancestry. Haplotyping is also a precursor to a range of genetic attributes including effective population size, signatures of selection and evolution e.g. Integrated Haplotype Scores and Extended Haplotype Homozygosity tests [<xref ref-type="bibr" rid="CR2">2</xref>]. Haplotyping can reveal candidate genes for mendelian disorders [<xref ref-type="bibr" rid="CR3">3</xref>], given haplotype variation impacts gene expression [<xref ref-type="bibr" rid="CR4">4</xref>], splice variants, folding and function [<xref ref-type="bibr" rid="CR5">5</xref>]. For example, hundreds of ‘phase-sensitive’ human genes have been identified, including olfactory receptors and proteins related to the immune system such as the MHC (Class I and II) which contain two or more potentially functionally significant mutations that can reside in either cis or trans configurations. Thus, the phase of many mutations is likely to be of critical importance for protein function, phenotype and clinical genome interpretation. Ongoing initiatives to understand the associations of haplotypes with human disease include the HapMap Project [<xref ref-type="bibr" rid="CR6">6</xref>] and the Genomics England’s 100,000 Genomes Project [<xref ref-type="bibr" rid="CR7">7</xref>]. Haplotyping in non-model organisms including diverse Emerging Fungal Pathogens remains largely unexplored [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par6">Despite the importance of haplotyping, there remains a lack of research into the physiological consequences of having variants co-reside on chromosomes, or distributed across two homologues chromosomes [<xref ref-type="bibr" rid="CR9">9</xref>]. Research using haplotypes is limited for a variety of reasons including the computational complexity of haplotyping, lack of haplotyping tools, lack of tools to perform analysis of those haplotypes, and increased complexity of haplotype analysis given the extra step of phasing and its imperfect outputs. Current methods that have been developed to phase sequence data include experimental phasing methods, along with computational phasing with related individuals and computational phasing with unrelated individuals [<xref ref-type="bibr" rid="CR10">10</xref>]. Experimental phasing is achieved by direct sequencing encompassing two or more heterozygous genotypes of an individual, while the other methods rely on a priori knowledge of haplotypes, or modelling haplotypes based on factors such as patterns of linkage disequilibrium [<xref ref-type="bibr" rid="CR11">11</xref>]. Recombination maps are often not known or challenging to infer particularly in non-model organisms. Experimental phasing is limited by sequence read-length, and is not feasible on genomes lacking sufficiently heterozygous and proximal variants. However, the deep coverage of next-generation sequencing and paired-end information can cheaply and confidently yield haplotypes in a wide range of genomes.</p>
    <p id="Par7">Experimental phasing has been implemented by several tools, including some under active development. For example, experimental phasing is part of the GATK HaplotypeCaller algorithm [<xref ref-type="bibr" rid="CR12">12</xref>], which forms part of its genotyping algorithm. GATK stores the physical phasing information in Pre-Implantation Genetic Testing (PGT) and Physical phasing ID information (PID) format fields of the VCF [<xref ref-type="bibr" rid="CR13">13</xref>]. Other tools specifically designed to perform physical phasing for large and accurate haplotype construction include WhatsHap [<xref ref-type="bibr" rid="CR14">14</xref>], HapCut2 [<xref ref-type="bibr" rid="CR15">15</xref>], and SmartPhase [<xref ref-type="bibr" rid="CR16">16</xref>]. The underlying algorithms of each method include weighted minimum error correction, maximum-likelihood, and read-based (either RNAseq or DNAseq) phasing respectively. HapCut2 works on a range of sequencing data including Hi-C and long read sequencing [<xref ref-type="bibr" rid="CR15">15</xref>]. WhatsHap takes a dynamic programming approach that is both fast and more accurate than statistical phasers [<xref ref-type="bibr" rid="CR14">14</xref>]. PoolhapX infers haplotypes across naturally pooled samples [<xref ref-type="bibr" rid="CR17">17</xref>]. Accuracy for these tools has been determined by consensus to other methods or using simulated data. One potential drawback for each of these tools is that there are not easily (no options to) parallelize across multiple nodes on a computer cluster. Where such resources are available, this approach may decrease computational time.</p>
    <p id="Par8">Here, I present a toolset to phase diploid variant calls from whole genome sequencing data, validating phasing accuracy, phylogenetically placing haplotypes to other lineages or species, and identifying crossovers between pairs of phased VCFs. HaplotypeTools phasing performed better overall in terms of accuracy, at the cost of smaller haplotypes, in comparison to WhatsHap [<xref ref-type="bibr" rid="CR14">14</xref>]. Both tools performed considerably better than GATK HaplotypeCaller physical phasing alone. HaplotypeTools was also used to identify the parental lineages and loci of crossovers for a hybrid fungal isolate belonging to the species <italic>Batrachochytrium dendrobatidis</italic>.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Benchmarking with simulated data</title>
      <p id="Par9">HaplotypeTools was benchmarked against WhatsHap using simulated reads from the genome of the fungal pathogen <italic>Batrachochytrium dendrobatidis</italic> (<italic>Bd</italic>) JEL423 (see methods), highlighting several differences between the tools. First, the accuracy of the variant caller Pilon [<xref ref-type="bibr" rid="CR18">18</xref>] to call heterozygous positions from short (100nt) and long-read (10 kb) paired end alignments (20X depth) was assessed (Table <xref rid="Tab1" ref-type="table">1</xref>) revealing high levels of sensitivity (&gt; 0.91), specificity (&gt; 0.99) and overall accuracy (&gt; 0.98), which is suitable for testing downstream phasing.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Accuracy of heterozygous variant calling by Pilon was assessed</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Test</th><th align="left">1</th><th align="left">2</th><th align="left">3</th><th align="left">4</th><th align="left">5</th><th align="left">6</th></tr></thead><tbody><tr><td align="left">Introduced HET</td><td align="left">23,13,700</td><td align="left">23,13,700</td><td align="left">2,31,370</td><td align="left">2,31,370</td><td align="left">23,137</td><td align="left">23,137</td></tr><tr><td align="left">Introduced HET (/kb)</td><td align="left">100</td><td align="left">100</td><td align="left">10</td><td align="left">10</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left">Read Length (nt, paired)</td><td align="left">100</td><td align="left">10,000</td><td align="left">100</td><td align="left">10,000</td><td align="left">100</td><td align="left">10,000</td></tr><tr><td align="left">SNP</td><td align="left">86,808</td><td align="left">1,89,498</td><td align="left">7,752</td><td align="left">16,583</td><td align="left">1,075</td><td align="left">1,633</td></tr><tr><td align="left">HET</td><td align="left">20,90,044</td><td align="left">17,81,654</td><td align="left">2,30,380</td><td align="left">1,91,558</td><td align="left">37,153</td><td align="left">22,365</td></tr><tr><td align="left">INS</td><td align="left">43</td><td align="left">66</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left">DEL</td><td align="left">48</td><td align="left">69</td><td align="left">2</td><td align="left">1</td><td align="left">2</td><td align="left">1</td></tr><tr><td align="left">AMB</td><td align="left">2</td><td align="left">92</td><td align="left">2</td><td align="left">59</td><td align="left">2</td><td align="left">67</td></tr><tr><td align="left">TP</td><td align="left">20,27,722</td><td align="left">17,45,567</td><td align="left">2,13,362</td><td align="left">1,87,637</td><td align="left">21,429</td><td align="left">18,807</td></tr><tr><td align="left">TN</td><td align="left">2,08,11,068</td><td align="left">1,97,41,846</td><td align="left">2,28,43,007</td><td align="left">2,19,30,208</td><td align="left">2,30,49,406</td><td align="left">2,20,49,041</td></tr><tr><td align="left">FP</td><td align="left">62,322</td><td align="left">36,087</td><td align="left">17,018</td><td align="left">3,921</td><td align="left">15,724</td><td align="left">3,558</td></tr><tr><td align="left">FN</td><td align="left">98,679</td><td align="left">1,65,971</td><td align="left">9,073</td><td align="left">16,227</td><td align="left">904</td><td align="left">1,572</td></tr><tr><td align="left">FP other</td><td align="left">86,901</td><td align="left">1,89,725</td><td align="left">7,756</td><td align="left">16,643</td><td align="left">1,079</td><td align="left">1,701</td></tr><tr><td align="left">TP (%)</td><td align="left">87.64</td><td align="left">75.44</td><td align="left">92.22</td><td align="left">81.10</td><td align="left">92.62</td><td align="left">81.29</td></tr><tr><td align="left">TN (%)</td><td align="left">89.94</td><td align="left">85.32</td><td align="left">98.73</td><td align="left">94.78</td><td align="left">99.62</td><td align="left">95.29</td></tr><tr><td align="left">FP (%)</td><td align="left">2.98</td><td align="left">2.03</td><td align="left">7.39</td><td align="left">2.05</td><td align="left">42.32</td><td align="left">15.91</td></tr><tr><td align="left">FN (%)</td><td align="left">4.26</td><td align="left">7.17</td><td align="left">3.92</td><td align="left">7.01</td><td align="left">3.91</td><td align="left">6.79</td></tr><tr><td align="left">Sensitivity</td><td align="left">0.95</td><td align="left">0.91</td><td align="left">0.96</td><td align="left">0.92</td><td align="left">0.96</td><td align="left">0.92</td></tr><tr><td align="left">Specificity</td><td align="left">0.99</td><td align="left">0.99</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">Accuracy</td><td align="left">0.99</td><td align="left">0.98</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td></tr></tbody></table><table-wrap-foot><p>Paired reads (100nt or 10 kb) were simulated at 20X depth from reference <italic>Bd</italic> JEL423 genome that was duplicated to create an in silico diploid. In silico mutations were then randomly introduced throughout (1/kb, 10/kb or 100/kb). Reads were aligned to the original reference sequence (non-duplicated, non-mutated version), and diploid variants called by Pilon. Counts of variants are shown including single nucleotide polymorphisms (SNP), heterozygous positions (HET), insertions (INS), deletions (DEL) and ambiguous (AMB). Accuracy was assessed according to Comparison of FDR tool [<xref ref-type="bibr" rid="CR28">28</xref>], that calculated TN = true negatives (correct reference bases), TP = true positives (correct HET), FN = false negatives (incorrect reference bases) and FP = false positives (incorrect HET). FP (other) is a count of all additional (non-heterozygous) incorrect bases including SNPs, INS, DEL and AMB. &gt; 99% of FP (other) were SNPs. TP (%) and FN (%) are precents of Introduced HET, FN (%) is a percent of assembly length, and FP (%) is a percent of HETs called. Sensitivity = TP/(TP + FN), Specificity = TN/(TN + FP + FP (other)), Accuracy = (TN + TP)/(TN + TP + FN + FP + FP (other))</p></table-wrap-foot></table-wrap></p>
      <p id="Par10">Haplotypes defined by HaplotypeTools and WhatsHap were assessed for haplotype length, coverage, accuracy and computational time (Table <xref rid="Tab2" ref-type="table">2</xref>). HaplotypeTools outperformed WhatsHap in terms of phasing accuracy, while it underperformed in terms of haplotype length, genome coverage of those haplotypes, sensitivity and QAN50 values (an assessment of haplotype length and quality in terms of Switch Errors). For example, the longest haplotype block/pair from HaplotypeTools was ~ 11.7 kb, compared with ~ 874 kb for WhatsHap.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Assessment of HaplotypeTools and WhatsHap on simulated paired reads (100nt or 10 kb) from 100/kb, 10/kb and 1/kb heterozygosity levels</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Tool</th><th align="left">Param</th><th align="left">Het. (/Kb)</th><th align="left">Read Length (nt, paired)</th><th align="left">Hap n</th><th align="left">Genome coverage (%)</th><th align="left">Hap N<sub>max</sub></th><th align="left">Hap N<sub>50</sub></th><th align="left">SE</th><th align="left">SER</th><th align="left">QAN50</th><th align="left">Time</th></tr></thead><tbody><tr><td align="left">HT</td><td align="left">default</td><td char="." align="char">100</td><td char="." align="char">100</td><td char="." align="char">95,532</td><td char="." align="char">83.2</td><td char="." align="char">2867</td><td char="." align="char">342</td><td char="." align="char">6248</td><td char="." align="char">0.0031</td><td align="left">248</td><td align="left">27 m41 s</td></tr><tr><td align="left">HT</td><td align="left">default</td><td char="." align="char">10</td><td char="." align="char">100</td><td char="." align="char">33,962</td><td char="." align="char">12.0</td><td char="." align="char">620</td><td char="." align="char">109</td><td char="." align="char">25</td><td char="." align="char">0.0002</td><td align="left">N.D</td><td align="left">32 m33 s</td></tr><tr><td align="left">HT</td><td align="left">-m 2</td><td char="." align="char">10</td><td char="." align="char">100</td><td char="." align="char">34,423</td><td char="." align="char">12.1</td><td char="." align="char">620</td><td char="." align="char">109</td><td char="." align="char">32</td><td char="." align="char">0.0003</td><td align="left">N.D</td><td align="left">30 m14 s</td></tr><tr><td align="left">HT</td><td align="left">default</td><td char="." align="char">1</td><td char="." align="char">100</td><td char="." align="char">728</td><td char="." align="char">0.2</td><td char="." align="char">211</td><td char="." align="char">66</td><td char="." align="char">0</td><td char="." align="char">0.0000</td><td align="left">N.D</td><td align="left">32 m59 s</td></tr><tr><td align="left">HT</td><td align="left">-m 2</td><td char="." align="char">1</td><td char="." align="char">100</td><td char="." align="char">875</td><td char="." align="char">0.2</td><td char="." align="char">211</td><td char="." align="char">64</td><td char="." align="char">1</td><td char="." align="char">0.0005</td><td align="left">N.D</td><td align="left">29 m42 s</td></tr><tr><td align="left">HT</td><td align="left">default</td><td char="." align="char">100</td><td char="." align="char">10,000</td><td char="." align="char">61,536</td><td char="." align="char">73.3</td><td char="." align="char">6455</td><td char="." align="char">528</td><td char="." align="char">4242</td><td char="." align="char">0.0024</td><td align="left">267</td><td align="left">31 m13 s</td></tr><tr><td align="left">HT</td><td align="left">-m 2</td><td char="." align="char">100</td><td char="." align="char">10,000</td><td char="." align="char">56,825</td><td char="." align="char">80.5</td><td char="." align="char">6455</td><td char="." align="char">605</td><td char="." align="char">4185</td><td char="." align="char">0.0022</td><td align="left">353</td><td align="left">27 m53 s</td></tr><tr><td align="left">HT</td><td align="left">-m 2 -r 100 kb</td><td char="." align="char">100</td><td char="." align="char">10,000</td><td char="." align="char">56,903</td><td char="." align="char">80.3</td><td char="." align="char">11,694</td><td char="." align="char">612</td><td char="." align="char">4185</td><td char="." align="char">0.0022</td><td align="left">350</td><td align="left">23 m13 s</td></tr><tr><td align="left">HT</td><td align="left">default</td><td char="." align="char">10</td><td char="." align="char">10,000</td><td char="." align="char">5,965</td><td char="." align="char">78.6</td><td char="." align="char">9995</td><td char="." align="char">6480</td><td char="." align="char">35</td><td char="." align="char">0.0002</td><td align="left">4254</td><td align="left">29 m14 s</td></tr><tr><td align="left">HT</td><td align="left">default</td><td char="." align="char">1</td><td char="." align="char">10,000</td><td char="." align="char">2,492</td><td char="." align="char">57.7</td><td char="." align="char">9946</td><td char="." align="char">7774</td><td char="." align="char">0</td><td char="." align="char">0.0000</td><td align="left">5888</td><td align="left">27 m</td></tr><tr><td align="left">WH</td><td align="left">default</td><td char="." align="char">100</td><td char="." align="char">100</td><td char="." align="char">366</td><td char="." align="char">95.1</td><td char="." align="char">8,43,884</td><td char="." align="char">3,08,400</td><td char="." align="char">35,461</td><td char="." align="char">0.0163</td><td align="left">9,91,296</td><td align="left">95 m56 s</td></tr><tr><td align="left">WH</td><td align="left">default</td><td char="." align="char">10</td><td char="." align="char">100</td><td char="." align="char">2,496</td><td char="." align="char">92.7</td><td char="." align="char">74,839</td><td char="." align="char">17,864</td><td char="." align="char">1570</td><td char="." align="char">0.0070</td><td align="left">19,555</td><td align="left">14 m29 s</td></tr><tr><td align="left">WH</td><td align="left">default</td><td char="." align="char">1</td><td char="." align="char">100</td><td char="." align="char">6,540</td><td char="." align="char">12.1</td><td char="." align="char">3932</td><td char="." align="char">578</td><td char="." align="char">235</td><td char="." align="char">0.0192</td><td align="left">N.D</td><td align="left">43 s</td></tr><tr><td align="left">WH</td><td align="left">default</td><td char="." align="char">100</td><td char="." align="char">10,000</td><td char="." align="char">128</td><td char="." align="char">89.1</td><td char="." align="char">8,43,900</td><td char="." align="char">3,60,273</td><td char="." align="char">29,373</td><td char="." align="char">0.0144</td><td align="left">9,36,966</td><td align="left">23 m27 s</td></tr><tr><td align="left">WH</td><td align="left">default</td><td char="." align="char">10</td><td char="." align="char">10,000</td><td char="." align="char">130</td><td char="." align="char">90.0</td><td char="." align="char">8,74,030</td><td char="." align="char">4,00,757</td><td char="." align="char">347</td><td char="." align="char">0.0016</td><td align="left">4,64,693</td><td align="left">3 m11 s</td></tr><tr><td align="left">WH</td><td align="left">default</td><td char="." align="char">1</td><td char="." align="char">10,000</td><td char="." align="char">196</td><td char="." align="char">88.0</td><td char="." align="char">7,52,451</td><td char="." align="char">2,03,122</td><td char="." align="char">18</td><td char="." align="char">0.0009</td><td align="left">97,221</td><td align="left">24 s</td></tr></tbody></table><table-wrap-foot><p>Haplotype (Hap) count (n) and their coverage across the genome assembly is shown as a percent. Haplotype lengths are described by Hap N<sub>max</sub> (the maximum haplotype length found) and Hap N<sub>50</sub> (the shortest haplotype length that includes ≥ 50% of haplotype sequence.). Switch Errors (SE), Switch Error Rate (SER), Quality Adjusted N50 (QAN50) and Computational Time were calculated and compared as described in methods (code to calculate these values are part of HaplotypeTools)</p></table-wrap-foot></table-wrap></p>
      <p id="Par11">HaplotypeTools achieved higher accuracy overall than WhatsHap according to a range of metrics (Table <xref rid="Tab2" ref-type="table">2</xref>). HaplotypeTools resulted in fewer (&lt; 14%) Switch Errors (SE), and lower Switch Error Rate (SER) for every test, which had a value of between 0 and 0.0031 compared with 0.007 and 0.016 for WhatsHap. Indeed, for two of the tests (100nt reads with 1/kb heterozygosity and 10 kb reads with 1/kb heterozygosity), HaplotypeTools did not produce a single switch error (SER = 0), demonstrating the high accuracy achieved by HaplotypeTools even using default settings.</p>
      <p id="Par12">Lowering the minimum haplotype coverage parameter in HaplotypeTools achieved better SE and SER for one of the tests (10 kb reads for 100/kb heterozygosity). For the same test data, increasing the maximum phasing length resulted in longer haplotypes and reduced computational time, at the cost of a slightly decreased genome coverage (Table <xref rid="Tab2" ref-type="table">2</xref>). Therefore, adjusting HaplotypeTools’ parameters may achieve better results than the default settings depending on the use case (e.g. read length and heterozygosity level) and desired outcome (sensitivity vs specificity).</p>
      <p id="Par13">While optional, HaplotypeTools was designed to run in parallel across a computer cluster – first splitting up the VCF and BAM files into windows that can be processed in parallel. HaplotypeTools was scatter gathered across ~ 100 low-spec nodes (8 Gb RAM, Intel Xeon CPU E5-2680 v2 @ 2.80 GHz), which took between 23m13s and 32m59s till completion (Table <xref rid="Tab2" ref-type="table">2</xref>). WhatsHap is not designed to run in parallel (although such a process could be achieved with a custom pipeline if desired). Thus, WhatsHap was tested locally on a single high-spec laptop (32 Gb RAM, Intel Core i9-9980HK CPU @ 2.40 GHz). WhatsHap required some preprocessing to run (e.g. removing reference bases from VCFs). After pre-processing, WhatsHap was overall computationally faster: taking between 95m56s for 100 nt reads with 100/kb heterozygous positions, to as quickly as just 24 s on 10 kb reads with 1/kb heterozygous positions.</p>
    </sec>
    <sec id="Sec4">
      <title>Results on real data</title>
      <p id="Par14">HaplotypeTools was used to phase real Illumina data (100nt paired reads, 43X depth) to determine the parental lineages of the hybrid <italic>Bd</italic> isolate SA-EC3 with several settings. GATK v4 HaplotypeCaller was used for variant calling, which includes its own physical phasing, and could therefore also be compared to the results from HaplotypeCaller and WhatsHap (Table <xref rid="Tab3" ref-type="table">3</xref>).<table-wrap id="Tab3"><label>Table 3</label><caption><p>Details of haplotypes from phasing a single-isolate VCF from hybrid <italic>Bd</italic> isolate SA-EC3 using GATK v4 HaplotypeCaller, HaplotypeTools (default settings), and WhatsHap (default settings)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">HaplotypeCaller</th><th align="left">HaplotypeTools</th><th align="left">WhatsHap</th></tr></thead><tbody><tr><td align="left">Number of haplotypes</td><td align="left">5545</td><td align="left">7975</td><td align="left">9982</td></tr><tr><td align="left">Total phased nucleotides</td><td align="left">1,35,334</td><td align="left">6,74,408</td><td align="left">50,02,469</td></tr><tr><td align="left">Haplotype Nmax (nt)</td><td align="left">230</td><td align="left">1083</td><td align="left">8485</td></tr><tr><td align="left">Haplotype N50 (nt)</td><td align="left">26</td><td align="left">115</td><td align="left">1107</td></tr><tr><td align="left">Haplotype N90 (nt)</td><td align="left">13</td><td align="left">44</td><td align="left">314</td></tr><tr><td align="left">Overlap with HT (default) (#haps)</td><td align="left">2027</td><td align="left">N/A</td><td align="left">7948</td></tr><tr><td align="left">Overlap with HT (nt)</td><td align="left">44,157</td><td align="left">N/A</td><td align="left">6,58,713</td></tr><tr><td align="left">Computational time</td><td align="left">N/A</td><td align="left">41m56s</td><td align="left">5m54s</td></tr></tbody></table><table-wrap-foot><p>Rows include the number of haplotypes produced by each tool, the total number of nucleotides included in those haplotypes, the maximum haplotype length found (Haplotype N<sub>max</sub>), the Hap N<sub>50</sub> and N<sub>90</sub> (the shortest haplotype length that includes ≥ 50% and ≥ 90% of haplotype sequence, respectively.). The number of haplotypes (#haps) that overlap on the genome assembly with haplotypes produced by HaplotypeTools (HT), and the number of nucleotides (nt) in those haplotpes. Computational time is also given for HaplotypeTools and Whatshap, but omitted for GATK given its primary role was variant calling, which both HaplotypeTools and WhatsHap were also based on, and the time taken for phasing alone can neither be determined or distinguished from that process</p></table-wrap-foot></table-wrap></p>
      <p id="Par15">The five isolates representing each of the lineages were assessed for ploidy and aneuploidy. Non-overlapping windows presenting normalized depth of coverage revealed evidence for aneuploidies in all isolates apart from <italic>Bd</italic>CH ACON (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Supercontig (sc) 1 is the largest supercontig and therefore the best evidence for the baseline ploidy from genomic data alone. Therefore, based on this depth of coverage and allele frequencies (percent of reads agreeing with the reference base), Asia1 KRBOOR323 is diploid with sc2 and sc3 trisomies, Asia2 CLFT065 and CAPE TF5a1 are triploid with a sc2 tetrasomy, CH ACON is triploid with no aneuploidies, GPL JEL423 is diploid with a sc3 trisomy, and Hybrid SA-EC3 is diploid with possible sc2 and sc3 tetrasomy. WhatsHap and HaplotypeTools were therefore tested on polyploid and aneuploid genomes, which could impact the accuracy of phasing.<fig id="Fig1"><label>Fig. 1</label><caption><p>The five isolates representing each of the lineages were assessed for ploidy and aneuploidy (largest five supercontigs presented). <bold>A</bold> Non-overlapping 10 kb windows of the normalized depth of coverage (normalized by total sequencing depth across percentiles of GC content, and excluding ambiguous sites) shows evidence for aneuploidies (supercontig 2, 3 and 5) among each of the <italic>Bd</italic> isolates apart from <italic>Bd</italic>CH ACON. <bold>B</bold> Allele frequencies (percent of reads agreeing with the reference base) are shown from 25% agree to 75% disagree, with red-dotted lines indicating greatest support for bi-allelic/diploidy between 47 and 53% and greatest support for tri-allelic/triploidy between 30–36% and 63–69%</p></caption><graphic xlink:href="12859_2021_4473_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par16">In accordance with the benchmarking using simulated reads, Haplotypes from HaplotypeTools covered 5X more of the genome (674 kb; 2.9%) than GATK physical phasing alone, while WhatsHap covered 7.4X more of the genome (5 Mb; 21.4%) than GATK alone (135 kb; 0.6%). Haplotypes were also longer with both HaplotypeTools (N<sub>max</sub> 1.1 kb, N<sub>50</sub> 115nt) and WhatsHap (N<sub>max</sub> 8.5 kb, N<sub>50</sub> 1.1 kb) compared with GATK alone (N<sub>max</sub> 230 nt, N<sub>50</sub> 26 nt). HaplotypeTools phased genomic regions overlapped with WhatsHap by 98%. Only 7% of HaplotypeTools phased genomic regions were also phased by GATK, primarily reflecting the fewer sites phased by GATK.</p>
      <p id="Par17">Phased SA-EC3 VCF’s from each tool were compared to consensus genomes for each lineage (generated by a HaplotypeTools utility script). First, pairs of haplotypes from single locations were compared for length and sequence similarity (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A) demonstrating that most of the haplotypes in all tools were short and as a proportion of their total length, contained a greater number of nucleotide differences between them. The longest and most divergent haplotypes are the most informative in terms of ancestry, and example haplotypes and their phylogenetic placement are shown for each tool for illustrative purposes only (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). One haplotype is phylogenetically closest to <italic>Bd</italic>CAPE for all three haplotype-based trees chosen. For trees based on HaplotypeTools and WhatsHap haplotypes, the second haplotype is closest to <italic>Bd</italic>GPL, while the second haplotype is <italic>Bd</italic>CH for HaplotypeCaller physical phasing alone.<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparisons of haplotypes for the hybrid <italic>Bd</italic> isolate SA-EC3, generated by GATK v4 HaplotypeCaller physical phasing, HaplotypeTools and WhatsHap. <bold>A</bold> The length in nucleotides of haplotype pairs vs the difference between those haplotypes pairs (%). The red line indicates the minimum haplotype length used for all analysis, and the red arrow indicates the haplotype pairs illustrated in part B of this figure. <bold>B</bold> HaplotypeTools’ utility script HaplotypePlacer constructs haplotype trees with FastTree. Among the longest representative haplotype pairs (shown by the red arrow) are shown including supercontig 1.7 positions 1,335,923–1,336,143 for HaplotypeCaller, supercontig 1.17 positions 206,141–207,223 for HaplotypeTools and supercontig 1.4 positions 319,655–328,139 for WhatsHap. In each of these examples, one haplotype is closest to <italic>Bd</italic>CAPE. For HaplotypeTools and WhatsHap that have several advantages over HaplotypeCaller’s physical phasing presented, the second haplotype is closest to <italic>Bd</italic>GPL</p></caption><graphic xlink:href="12859_2021_4473_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par18">The HaplotypeTools utility script HaplotypePlacer iteratively constructs approximately-maximum-likelihood phylogenetic trees using FastTree for every haplotype (with a default 100 nt minimum haplotype length parameter) in order to identify overall trends in haplotype relatedness to other lineages or species. HaplotypePlacer also outputs a summary for the closest relative across all the haplotypes (Table <xref rid="Tab4" ref-type="table">4</xref>) and generates non-overlapping window plots showing the genomic region for each haplotype pairs, which are colored according to their closest relative (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Using this iterative approach for every haplotype, the majority of haplotypes from hybrid <italic>Bd</italic> isolate SA-EC3 were phylogenetically clustered with <italic>Bd</italic>GPL for one of the haplotypes and <italic>Bd</italic>CAPE for the other, confirmed by each of the three tools tested (65% for HaplotypeCaller, 80% for HaplotypeTools and 91% for WhatsHap). Therefore, the parental lineages of <italic>Bd</italic> SA-EC3 are most likely <italic>Bd</italic>GPL and <italic>Bd</italic>CAPE.<table-wrap id="Tab4"><label>Table 4</label><caption><p>HaplotypeTools’ utility script HaplotypePlacer constructs haplotype trees with FastTree and identifies the closest relative to each</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Lineage</th><th align="left"><bold><italic>Bd</italic></bold>Asia1</th><th align="left"><bold><italic>Bd</italic></bold>Asia2</th><th align="left"><bold><italic>Bd</italic></bold>CAPE</th><th align="left"><bold><italic>Bd</italic></bold>CH</th><th align="left"><bold><italic>Bd</italic></bold>GPL</th></tr></thead><tbody><tr><td align="left">HaplotypeCaller (nt)</td><td align="left">2556</td><td align="left">1637</td><td align="left">5180</td><td align="left">2418</td><td align="left">7089</td></tr><tr><td align="left">HaplotypeCaller (%)</td><td align="left">14</td><td align="left">9</td><td align="left">27</td><td align="left">13</td><td align="left">38</td></tr><tr><td align="left">HaplotypeTools (nt)</td><td align="left">52,806</td><td align="left">55,341</td><td align="left">3,22,642</td><td align="left">51,476</td><td align="left">3,14,161</td></tr><tr><td align="left">HaplotypeTools (%)</td><td align="left">7</td><td align="left">7</td><td align="left">41</td><td align="left">6</td><td align="left">39</td></tr><tr><td align="left">Whatshap (nt)</td><td align="left">3,86,839</td><td align="left">2,58,519</td><td align="left">43,96,845</td><td align="left">2,61,089</td><td align="left">44,56,306</td></tr><tr><td align="left">Whatshap (%)</td><td align="left">4</td><td align="left">3</td><td align="left">45</td><td align="left">3</td><td align="left">46</td></tr><tr><td align="left">Overlapping phase groups</td><td align="left">889</td><td align="left">940</td><td align="left">1344</td><td align="left">758</td><td align="left">1018</td></tr><tr><td align="left">Overlapping phased positions (OPP)</td><td align="left">1941</td><td align="left">2131</td><td align="left">3457</td><td align="left">1661</td><td align="left">2487</td></tr><tr><td align="left">OPP Same phase (nt)</td><td align="left">1758</td><td align="left">1922</td><td align="left">3421</td><td align="left">1486</td><td align="left">2467</td></tr><tr><td align="left">OPP Same phase (%)</td><td align="left">91</td><td align="left">90</td><td align="left">99</td><td align="left">89</td><td align="left">99</td></tr><tr><td align="left">OPP Cross-over (nt)</td><td align="left">183</td><td align="left">209</td><td align="left">36</td><td align="left">175</td><td align="left">20</td></tr><tr><td align="left">OPP Cross-over (%)</td><td align="left">9</td><td align="left">10</td><td align="left">1</td><td align="left">11</td><td align="left">1</td></tr></tbody></table><table-wrap-foot><p>Hybrid <italic>Bd</italic> isolate SA-EC3 haplotypes from GATK v4 HaplotypeCaller physical phasing, HaplotypeTools and WhatsHap were analysed using HaplotypePlacer, finding that the majority of haplotypes from each of the three tools are closest in those trees to <italic>Bd</italic>GPL (38–46%) and <italic>Bd</italic>CAPE (27–45%). A HaplotypeTools utility script was used to compare phasing between SA-EC3 and each of the lineages. For each comparison, the script identified overlapping phase groups, comprising overlapping phased positions (OPP), which were either in the same phase, or showed evidence of crossovers</p></table-wrap-foot></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><p>HaplotypeTools’ utility script HaplotypePlacer was used to produce 10 kb windows showing the genomic region for each haplotype pairs and colored according to their closest relative (light blue = <italic>Bd</italic>Asia1, blue = <italic>Bd</italic>Asia2, light green = <italic>Bd</italic>CAPE, green = <italic>Bd</italic>CH, red = <italic>Bd</italic>GPL). Windows are for <bold>A</bold> GATK v4 HaplotypeCaller, <bold>B</bold> HaplotypeTools and <bold>C</bold> WhatsHap</p></caption><graphic xlink:href="12859_2021_4473_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par19">To explore recombination in SA-EC3, phased regions between SA-EC3 and phased representatives for each of the lineages were compared using other HaplotypeTools utility scripts (Table <xref rid="Tab4" ref-type="table">4</xref>). The parental lineages identified by HaplotypePlacer (<italic>Bd</italic>GPL and <italic>Bd</italic>CAPE) had the highest number of overlapping phase groups compared with other lineages (1018–1344 compared to 758–940) and highest number of overlapping phased positions/nucleotides (OPP; 2487–3457 compared to 1661–2131), corroborating those lineages as parental lineages, given a greater sequence divergence result in fewer conserved heterozygous positions that can be phased. Only 20 crossovers were detected between SA-EC3 and <italic>Bd</italic>GPL (0.8% of all OPP), and only 36 crossovers were detected between SA-EC3 and <italic>Bd</italic>CAPE (1% of all OPP), compared with 9.43–10.54% for the other lineages, which again supports those relationships, given a greater divergence time may result in greater numbers of ancestral crossovers.</p>
      <p id="Par20">Crossovers between SA-EC3 and its parental lineages were distributed across the genome. For example, SA-EC3 and <italic>Bd</italic>GPL JEL423 had five OPP’s in one overlapping phase group between supercontig 15 positions 473,179–477,410. These phased positions included the following haplotype variant positions for SA-EC3: C-C-<bold>A</bold>-A-A and T-A-<bold>G</bold>-G-C, and for <italic>Bd</italic>GPL JEL423: C-C-<bold>G</bold>-A-A and T-A-<bold>A</bold>-G-C, indicating a crossover in the middle position (473,194), which is located in an intergenic region between hypothetical protein BDEG_28268 and hypothetical protein BDEG_28269 with PFAM Cytochrome P450. The very low levels of crossovers identified between either parent indicate that the parental haplotypes have remained physically separated, suggesting that SA-EC3 is a result of mitotic recombination/parasexuality i.e. genetic exchange without meiosis, and those few crossovers likely resulting from either (1) double mutations, and (2) mitotic gene conversion events.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Discussion</title>
    <p id="Par21">Correctly identifying haplotypes is central to understanding diploid organisms, including determining genotype–phenotype associations, identifying recombinant or hybrid isolates in microbial populations, determining parental ancestry, and a precursor to a range of population genetic tests. Here, I present a new toolset called HaplotypeTools that is able to accurately phase heterozygous positions from short or long whole genome sequencing data in a fungal genome, and perform a variety of processing steps to recover FASTA files of haplotypes, plot haplotype relatedness to other species across genomic windows, and identify loci of potential crossovers between isolates. HaplotypeTools achieved greater accuracy than two other tools tested (GATK v4 HaplotypeCaller physical phasing and WhatsHap [<xref ref-type="bibr" rid="CR14">14</xref>]), while also highlighting room for further improvement including computational speed, haplotype length and benefiting from additional data-types such as Hi-C. Currently, regions lacking alignment data or variant calls due to complex genomic regions (such as very repeat rich regions) are ignored by HaplotypeTools, and present a further challenge and opportunity for development.</p>
    <p id="Par22">HaplotypeTools was tested on the hybrid <italic>Bd</italic> isolate SA-EC3 from the Amahlathi Local Municipality of the Eastern Cape in South Africa [<xref ref-type="bibr" rid="CR19">19</xref>]. Comparing the output of HaplotypeTools to GATK HaplotypeCaller physical phasing revealed that HaplotypeTools was able to recover ~ 5X the total phased nucleotides, and &gt; 4X the haplotype length in terms of haplotype N<sub>max</sub> and N<sub>50</sub>. HaplotypeTools phased regions were almost entirely contained within WhatsHap [<xref ref-type="bibr" rid="CR14">14</xref>] phased regions, and based on simulation data, HaplotypeTools phased regions were likely to include a greater number of true positives and fewer false positive phased sites. Phylogenetic placement of those haplotypes by HaplotypePlacer indicated that SA-EC3 is a recombinant of <italic>Bd</italic>GPL and <italic>Bd</italic>CAPE haplotypes, which was supported by all three tools tested. South Africa has endemic <italic>Bd</italic>GPL and <italic>Bd</italic>CAPE lineages present [<xref ref-type="bibr" rid="CR20">20</xref>], thereby facilitating such an event. ~ 1% of overlapping phased positions indicated crossovers between SA-EC3 and either parental lineage, indicating that meiotic recombination has not occurred between the parental lineages, and the recombinant genotype is more likely to have arisen via mitotic recombination/parasexuality: a process characterised in disparate fungal relatives [<xref ref-type="bibr" rid="CR21">21</xref>]. <italic>Bd</italic> recombining via parasexuality is parsimonious with polyploidy isolates commonly found [<xref ref-type="bibr" rid="CR22">22</xref>], and has been hypothesized previously [<xref ref-type="bibr" rid="CR23">23</xref>]. These results highlight the threat of emerging novel genotypes of pathogens following anthropomorphic spread [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p id="Par23">HaplotypeTools is designed for phasing bi-allelic data, with tri-alleles phasing a possible upgrade route in the future. However, as shown in the real data experiments, HaplotypeTools works on polyploid genomes and over aneuploidies. HaplotypeTools also has no clear upper limit on genome size or depth of coverage. HaplotypeTools has been tested using variant calls from GATK v4 HaplotypeCaller [<xref ref-type="bibr" rid="CR12">12</xref>] and Pilon [<xref ref-type="bibr" rid="CR18">18</xref>], although additional variant callers such as FreeBayes [<xref ref-type="bibr" rid="CR24">24</xref>] that output in standard VCF should also work, as should other alignment and sequencing strategies. Sequencing technologies Nanopore and PacBio have not been tested with HaplotypeTools, although simulated long reads have been, which showed a particular advantage in accuracy tests. Indeed, given the shorter haplotypes offered by HaplotypeTools, a particular strength may be high accuracy haplotypes stemming from such long-read data. Sequencing strategies that yield higher sequencing errors could be accommodated by adjusting the ‘cut-off percent reads supporting phase group’ parameter. Lower sequencing depth could be accommodated by adjusting minimum read depth. Where the use case is very different from those presented here, the tools to perform accuracy checks have been included in the HaplotypeTools toolset, and ideally will be used to validate phasing accuracy and thereby optimized for individual use cases.</p>
    <p id="Par24">The interpretation and usefulness of HaplotypePlacer will rely on the lineages or species that the phased isolate is compared to. For example, it is advisable that a comprehensive set of possible parental lineages are included in the analysis or HaplotypePlacer will be unlikely to yield a clear answer. The phylogenetic relationships from HaplotypePlacer are not currently tested for significance, and therefore for more robust results, haplotype trees should be examined individually and further phylogenetic tests and tools applied to the multiple alignments output. Future areas of development may include updates to efficiency and computational speed, as well as exploring where haplotypes could be extended further without impacting accuracy, and expanding the toolset to include new tools for population genetic tests such as Four-gamete tests.</p>
  </sec>
  <sec id="Sec6">
    <title>Conclusions</title>
    <p id="Par25">HaplotypeTools is powerful resource that is able to accurately phase and extract haplotypes for population genetic tests and can determine parental ancestry for hybrid or recombinant diploid isolates or individuals. The toolset will be useful for benchmarking new tools or parameter space for phasing accuracy, and visualizing haplotype coverage across a genome and their phylogenetic placement. Therefore, HaplotypeTools should prove valuable for a range of research questions in model and non-model organism genomes.</p>
  </sec>
  <sec id="Sec7">
    <title>Availability and requirements</title>
    <p id="Par26">Project name: HaplotypeTools.</p>
    <p id="Par27">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/rhysf/HaplotypeTools">https://github.com/rhysf/HaplotypeTools</ext-link>.</p>
    <p id="Par28">Operating systems: Linux, MacOS.</p>
    <p id="Par29">Programming language: Perl and Python.</p>
    <p id="Par30">Other requirements: Perl modules (Bioperl [<xref ref-type="bibr" rid="CR25">25</xref>], BIO::DB::HTC, Hash::Merge) and Samtools [<xref ref-type="bibr" rid="CR26">26</xref>]. HaplotypePlacer and associated scripts currently require installations of R and several modules (plyr, RColorBrewer) and FastTree [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
    <p id="Par31">License: MIT License.</p>
    <p id="Par32">Any restrictions to use by non-academics: Not applicable.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>HaplotypeTools algorithm</title>
      <p id="Par33">The algorithm for HaplotypeTools comprises on five steps. The first step splits the VCF into windows of a specified length (default 10 kb), and BAM files into windows of the same length. Step 3 combines pairs of BAM and VCFs for each sample by assigning read information to intermediate VCF files (i.e. VCF-[contig]-[start window]-[stop window]-phased-[sample number]). Step 4 assigns phase groups based on 5 conditions, outputting intermediate tabulated files (i.e. VCF-[contig]-[start window]-[stop window]-phased-[sample number]-and-assigned.tab). Step 5 merges all phased samples for a given window into VCFs (i.e. VCF-[contig]-[start window]-[stop window]-phased), and then concatenates those into a final phased VCF. Splitting input data into windows allows steps 3 and 4 to be run in parallel on a cluster (Platform Load Sharing Facility (LSF), Sun GridEngine (SGE) or Univa GridEngine (UGE) currently supported). HaplotypeTools can also be run on an individual computer in serial at the expense of slower computational time.</p>
      <p id="Par34">Step 3 of HaplotypeTools assigns Phase Positions (PP) for all reads that overlap ≥ 2 heterozygous positions, which are separated by semicolons and stored in the ID column of the output. PPs consist of:<list list-type="order"><list-item><p id="Par35">unique read count (RC) and</p></list-item><list-item><p id="Par36">read genotype values (rGT) or read nucleotide values (rNT)</p></list-item></list></p>
      <p id="Par37">RCs serve as simple integer identifiers (0, 1, 2, <italic>n</italic>) for step 4 to identify reads that overlap multiple VCF positions, the value of which is incremented for each new read in the BAM. rGT are variant positions in sequence reads corresponding to a sequence match to the VCF REF column (0) or ALT column (1,2 etc.). rNT are used instead of rGT for variant positions in sequence reads that do not match a VCF REF or ALT base (based on the CIGAR flag), e.g. rNT = A or rNT = ATCC. For example, following step 3, an ID column could be’0-PP-0;1-PP-0;2-PP-1;3-PP-1;4-NT-A’, indicating 5 reads align over this VCF position in total, two of which have the REF allele, two that have the ALT allele, and one that has an adenosine, which is not described in the VCF REF or ALT column at that position.</p>
      <p id="Par38">Step 4 runs through pairs of consecutively found heterozygous positions named Previous Heterozygous Position (PHP) and Current Heterozygous Position (CHP), checking them for 5 conditions:<list list-type="order"><list-item><p id="Par39">Check for ≥ 2 rGT’s in CHP.</p></list-item><list-item><p id="Par40">Check the 2 CHP rGT’s with the highest depth &gt; min. haplotype depth parameter.</p></list-item><list-item><p id="Par41">Check the 2 CHP rGT combined depth (percent) &gt; phase cutoff parameter.</p></list-item><list-item><p id="Par42">Check PHP passed conditions 1–3.</p></list-item><list-item><p id="Par43">Check for ≥ 2 haplotypes from PHP and CHP PPs.</p></list-item></list></p>
      <p id="Par44">If any of those 5 conditions are not fulfilled, the PHP ID column is replaced by a comment stating the sample number and the reason it was not phased. A Phase Block (PB) integer value (identifier for separate haplotypes) is also incremented. The following pair of PHP and CHP are then assessed. Providing all 5 conditions are met, the reads that match the two PHP rGT’s and the two CHP rGT’s are identified, and used to construct a new CHP phased genotype. In the case &gt; 2 rGT’s are found, the two with the highest depth are selected. A phase group (PG) is assigned to PHP (if not already assigned) and CHP, which is appended to the SAMPLEINFO column. The PG consists of the contig, sample number, start window and PB separated by dashed (e.g. supercont1.1-0-350,000-1), ensuring every PG is unique e.g. the same phase block identifier in the same window (350,000–360,000) for a 2nd sample in a multi sample VCF will be supercont1.1-1-350,000-1. A summary file for each window is printed including contig, position, ID and SAMPLEINFO, which is used to update the final phased VCF during concatenation in Step 5.</p>
    </sec>
    <sec id="Sec10">
      <title>Benchmarking using simulated data</title>
      <p id="Par45">HaplotypeTools and WhatsHap (downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/whatshap">https://github.com/whatshap</ext-link> on 1st March 2021) were benchmarked using simulated data from the <italic>Batrachochytrium dendrobatidis</italic> (<italic>Bd</italic>) JEL423 genome. First, 40 contigs each of &lt; 10 kb were removed from the reference sequence, ensuring we could simulate 10 kb reads across the genome (updated reference = 29 contigs, 23.44 Mb, N50 = 1.7 Mb). Next, the Biscap utility script “Introduce Random Mutations (IRMS)” [<xref ref-type="bibr" rid="CR28">28</xref>] was used with the heterozygous setting (HET), which duplicates every chromosome (homologous versions), followed by selecting random nucleotides to ‘mutate’ into other random nucleotides across both chromosomes and homologous chromosomes. Three such modified reference genomes were generated including 1 SNP/Kb (23,137 total), 10 SNP/Kb (231,370 total) and 100 SNP/Kb (2,313,700 total). Next, sequence reads were simulated from this duplicated and modified reference sequence using WGSim (<ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/wgsim">https://github.com/lh3/wgsim</ext-link>) to ~ 20X depth using either short (100 nt) paired reads (2,313,797 pairs) or long (10 kb) paired reads (23,138 pairs) with no introduced errors (-r 0). Aligning these reads back to the unduplicated and unmodified reference genome will then appear to contain heterozygous positions, for which each position changed is known (the truth set). Reads were aligned to the genome using BWA v0.7.4-r385 mem, and a clean BAM created using Samtools v1.8 view -b -h -f 0 × 2. For WhatsHap compatibility, Picard AddOrReplaceReadGroups was applied to the clean BAM files.</p>
      <p id="Par46">Variants were called from the simulated data alignments using Pilon v1.9 with the diploid flag [<xref ref-type="bibr" rid="CR18">18</xref>]. For WhatsHap compatibility, reference bases were removed from the VCF. GATK v.4.1.2.0 [<xref ref-type="bibr" rid="CR12">12</xref>] was not used for calling heterozygous positions from simulated data alignments owing to failing the StrandBiasBySample filter used by HaplotypeCaller. Accuracy of Pilon was assessed using Biscap utility script “Comparison of FDR (CFDR)” [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
      <p id="Par47">Phased VCF’s from both HaplotypeTools and WhatsHap were assessed for accuracy using HaplotypeTools utility scripts. Specifically, Phased in Any (PIA) regions were identified (VCF_phased_to_PIA.pl), with parameter -t PS for WhatsHap and -t PID (default) for HaplotypeTools. FASTA sequences of haplotypes blocks/pairs were extracted using VCF_phased_and_PIA_to_FASTA.pl. Accuracy was assessed using Haplotype_FASTA_files_to_compare_to_IRMS_het_sites.pl, which calculates for every haplotype block/pair the number of sites that are correctly phased, sites that are incorrectly phased (False Positive type 1) and sites that have been incorrectly variant called and also been phased (False Positive type 2), false negatives within haplotype blocks (not presented), and Switch Errors (incorrect crossovers between haplotypes). To calculate Switch Errors, false negatives were ignored, while False Positive type 2 were considered as a switch error. Additionally, the script produces two summary statistics including overall Switch Error Rate, where the switch error is divided by the number of opportunities for switch errors. Finally, the Quality adjusted N50 (QAN50) was calculated for each test, where each haplotype block/pair is divided into sub-blocks with no switch errors, which are multiplied to the proportion of phased alleles inside that block (called an adjusted span), sorted from largest to smallest, and then the QAN50 is the size of the adjusted span that includes more than half of the total variants [<xref ref-type="bibr" rid="CR29">29</xref>].</p>
    </sec>
    <sec id="Sec11">
      <title>HaplotypeTools using real data</title>
      <p id="Par48">To test HaplotypeTools on real data, variant calling was first applied to a major fungal pathogen of amphibians, <italic>Batrachochytrium dendrobatidis</italic>, which has a 23 Mb diploid or triploid (with frequent aneuploid [<xref ref-type="bibr" rid="CR22">22</xref>]) genome. Paired-end Illumina data from representatives of all five known lineages (<italic>Bd</italic>GPL JEL423, <italic>Bd</italic>CAPE TF5a1, <italic>Bd</italic>CH ACON, <italic>Bd</italic>Asia-1 KRBOOR_323, <italic>Bd</italic>Asia-2 CLFT065, and a hybrid of unknown parentage SA-EC3) were obtained from the NCBI Sequence Read Archive (SRA) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. The Genome Analysis Toolkit (GATK) v.4.1.2.0 [<xref ref-type="bibr" rid="CR12">12</xref>] was used to call variants. Our Workflow Description Language (WDL) scripts were executed by Cromwell workflow execution engine v.48 [<xref ref-type="bibr" rid="CR31">31</xref>]. Briefly, raw sequences were pre-processed by mapping reads to the reference genome <italic>Bd</italic> JEL423 using BWA-MEM v.0.7.17 [<xref ref-type="bibr" rid="CR32">32</xref>]. Next, duplicates were marked, and the resulting file was sorted by coordinate order. Intervals were created using a custom bash script allowing parallel analysis of large batches of genomics data. Using the scatter–gather approach, HaplotypeCaller was executed in GVCF mode with the diploid ploidy flag. Variants were imported to GATK 4 GenomicsDB and hard filtered (QD &lt; 2.0, FS &gt; 60.0, MQ &lt; 40.0, GQ ≥ 50, AD ≥ 0.8, DP ≥ 10). HaplotypeTools and WhatsHap were used individually to phase each VCF with default parameters, and HaplotypeTools utility scripts to phylogenetically place and visualise haplotype placement across the genome, as well as explore crossovers between pairs of phased VCFs.
</p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>I would like to thank Dr. Lucy van Dorp and Prof. Francois Balloux for valuable discussions, comments and feedback.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>RF wrote the code for HaplotypeTools and wrote the manuscript. The author read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>R.A.F is part of the Medical Research Council Centre for Medical Mycology MR/N006364/2. R.A.F. is supported by a Wellcome Trust Seed Award (215239/Z/19/Z). The funding bodies had no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>HaplotypeTools is open source and freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/rhysf/HaplotypeTools">https://github.com/rhysf/HaplotypeTools</ext-link>. The <italic>Bd</italic> genome is available from NCBI (PRJNA13653). DNAseq for isolates JEL423, KRBOOR_323, CLFT065 and SA-EC3 are available from NCBI (PRJNA413876). DNAseq for isolates TF5a1 and ACON, are available from NCBI (PRJNA174849).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par49">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par50">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par51">The author declares that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Belsare</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluating the quality of the 1000 genomes project data</article-title>
        <source>BMC Genomics</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>620</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-019-5957-x</pub-id>
        <pub-id pub-id-type="pmid">31416423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sabeti</surname>
            <given-names>PC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide detection and characterization of positive selection in human populations</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>449</volume>
        <fpage>913</fpage>
        <lpage>918</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06250</pub-id>
        <pub-id pub-id-type="pmid">17943131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roach</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of genetic inheritance in a family quartet by whole genome sequencing</article-title>
        <source>Science</source>
        <year>2010</year>
        <volume>328</volume>
        <fpage>636</fpage>
        <lpage>639</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1186802</pub-id>
        <pub-id pub-id-type="pmid">20220176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype variation in structure and expression of a gene cluster associated with a quantitative trait locus for improved yield in rice</article-title>
        <source>Genome Res</source>
        <year>2006</year>
        <volume>16</volume>
        <fpage>618</fpage>
        <lpage>626</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.4814006</pub-id>
        <pub-id pub-id-type="pmid">16606701</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoehe</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiple haplotype-resolved genomes reveal population patterns of gene and protein diplotypes</article-title>
        <source>Nat Commun</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>5569</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms6569</pub-id>
        <pub-id pub-id-type="pmid">25424553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thorisson</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Krishnan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>LD</given-names>
          </name>
        </person-group>
        <article-title>The International HapMap Project Web site</article-title>
        <source>Genome Res</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>1592</fpage>
        <lpage>1593</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.4413105</pub-id>
        <pub-id pub-id-type="pmid">16251469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Samuel</surname>
            <given-names>GN</given-names>
          </name>
          <name>
            <surname>Farsides</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>The UK’s 100,000 Genomes Project: manifesting policymakers’ expectations</article-title>
        <source>New Genet Soc</source>
        <year>2017</year>
        <volume>36</volume>
        <fpage>336</fpage>
        <lpage>353</lpage>
        <pub-id pub-id-type="doi">10.1080/14636778.2017.1370671</pub-id>
        <pub-id pub-id-type="pmid">29238265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Farrer</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Describing genomic and epigenomic traits underpinning emerging fungal pathogens</article-title>
        <source>Adv Genet</source>
        <year>2017</year>
        <volume>100</volume>
        <fpage>73</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1016/bs.adgen.2017.09.009</pub-id>
        <pub-id pub-id-type="pmid">29153405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <article-title>Haplotype phasing: existing methods and new developments</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>703</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3054</pub-id>
        <pub-id pub-id-type="pmid">21921926</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loh</surname>
            <given-names>P-R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference-based phasing using the Haplotype Reference Consortium panel</article-title>
        <source>Nat Genet</source>
        <year>2016</year>
        <volume>48</volume>
        <fpage>1443</fpage>
        <lpage>1448</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3679</pub-id>
        <pub-id pub-id-type="pmid">27694958</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <article-title>Rapid and accurate haplotype phasing and missing-data inference for whole-genome association studies by use of localized haplotype clustering</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <fpage>1084</fpage>
        <lpage>1097</lpage>
        <pub-id pub-id-type="doi">10.1086/521987</pub-id>
        <pub-id pub-id-type="pmid">17924348</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danecek</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The variant call format and VCFtools</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2156</fpage>
        <lpage>2158</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr330</pub-id>
        <pub-id pub-id-type="pmid">21653522</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>WhatsHap: weighted haplotype assembly for future-generation sequencing reads</article-title>
        <source>J Comput Biol J Comput Mol Cell Biol</source>
        <year>2015</year>
        <volume>22</volume>
        <fpage>498</fpage>
        <lpage>509</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2014.0157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edge</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>HapCUT2: robust and accurate haplotype assembly for diverse sequencing technologies</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>801</fpage>
        <lpage>812</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.213462.116</pub-id>
        <pub-id pub-id-type="pmid">27940952</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hager</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mewes</surname>
            <given-names>H-W</given-names>
          </name>
          <name>
            <surname>Rohlfs</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jeske</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>SmartPhase: Accurate and fast phasing of heterozygous variant pairs for genetic diagnosis of rare diseases</article-title>
        <source>PLoS Comput Biol</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>e1007613</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007613</pub-id>
        <pub-id pub-id-type="pmid">32032351</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reconstruction of microbial haplotypes by integration of statistical and physical linkage in scaffolding</article-title>
        <source>bioRxiv</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1101/2020.03.29.014704</pub-id>
        <?supplied-pmid 34341794?>
        <pub-id pub-id-type="pmid">34341794</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walker</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pilon: an integrated tool for comprehensive microbial variant detection and genome assembly improvement</article-title>
        <source>PLoS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>e112963</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0112963</pub-id>
        <pub-id pub-id-type="pmid">25409509</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Hanlon</surname>
            <given-names>SJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recent Asian origin of chytrid fungi causing global amphibian declines</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>360</volume>
        <fpage>621</fpage>
        <lpage>627</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aar1965</pub-id>
        <pub-id pub-id-type="pmid">29748278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghosh</surname>
            <given-names>PN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Discriminating lineages of <italic>Batrachochytrium dendrobatidis</italic> using quantitative PCR</article-title>
        <source>Mol Ecol Resour</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1111/1755-0998.13299</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bennett</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>Completion of a parasexual cycle in <italic>Candida albicans</italic> by induced chromosome loss in tetraploid strains</article-title>
        <source>EMBO J</source>
        <year>2003</year>
        <volume>22</volume>
        <fpage>2505</fpage>
        <lpage>2515</lpage>
        <pub-id pub-id-type="doi">10.1093/emboj/cdg235</pub-id>
        <pub-id pub-id-type="pmid">12743044</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Farrer</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromosomal copy number variation, selection and uneven rates of recombination reveal cryptic genome diversity linked to pathogenicity</article-title>
        <source>PLoS Genet</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003703</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1003703</pub-id>
        <pub-id pub-id-type="pmid">23966879</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>James</surname>
            <given-names>TY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid global expansion of the fungal disease chytridiomycosis into declining and healthy amphibian populations</article-title>
        <source>PLoS Pathog</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000458</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.ppat.1000458</pub-id>
        <pub-id pub-id-type="pmid">19478871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Garrison E, Marth G. Haplotype-based variant detection from short-read sequencing. ArXiv12073907 Q-Bio. 2012.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stajich</surname>
            <given-names>JE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Bioperl Toolkit: perl modules for the life sciences</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>1611</fpage>
        <lpage>1618</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.361602</pub-id>
        <pub-id pub-id-type="pmid">12368254</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
        <source>Bioinform Oxf Engl</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree: computing large minimum evolution trees with profiles instead of a distance matrix</article-title>
        <source>Mol Biol Evol</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>1641</fpage>
        <lpage>1650</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp077</pub-id>
        <pub-id pub-id-type="pmid">19377059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Farrer</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Henk</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>MacLean</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Studholme</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Using false discovery rates to benchmark SNP-callers in next-generation sequencing projects</article-title>
        <source>Sci Rep</source>
        <year>2013</year>
        <volume>3</volume>
        <fpage>1512</fpage>
        <pub-id pub-id-type="doi">10.1038/srep01512</pub-id>
        <pub-id pub-id-type="pmid">23518929</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duitama</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fosmid-based whole genome haplotyping of a HapMap trio child: evaluation of Single Individual Haplotyping techniques</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>2041</fpage>
        <lpage>2053</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr1042</pub-id>
        <pub-id pub-id-type="pmid">22102577</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Farrer</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiple emergences of genetically diverse amphibian-infecting chytrids include a globalized hypervirulent recombinant lineage</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2011</year>
        <volume>108</volume>
        <fpage>18732</fpage>
        <lpage>18736</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1111915108</pub-id>
        <pub-id pub-id-type="pmid">22065772</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Voss K, der Auwera GV, Gentry J. Full-stack genomics pipelining with GATK4 + WDL + Cromwell. In: 18th Annual Bioinformatics Open Source Conference (BOSC 2017), vol. 6. 2017.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Li H. Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. ArXiv13033997 Q-Bio. 2013.</mixed-citation>
    </ref>
  </ref-list>
</back>
