<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9983268</article-id>
    <article-id pub-id-type="publisher-id">2879</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-023-02879-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SRTsim: spatial pattern preserving simulations for spatially resolved transcriptomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zhu</surname>
          <given-names>Jiaqiang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Shang</surname>
          <given-names>Lulu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4331-7599</contrib-id>
        <name>
          <surname>Zhou</surname>
          <given-names>Xiang</given-names>
        </name>
        <address>
          <email>xzhousph@umich.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Department of Biostatistics, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, MI 48109 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Center for Statistical Genetics, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, MI 48109 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>39</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Spatially resolved transcriptomics (SRT)-specific computational methods are often developed, tested, validated, and evaluated in silico using simulated data. Unfortunately, existing simulated SRT data are often poorly documented, hard to reproduce, or unrealistic. Single-cell simulators are not directly applicable for SRT simulation as they cannot incorporate spatial information. We present SRTsim, an SRT-specific simulator for scalable, reproducible, and realistic SRT simulations. SRTsim not only maintains various expression characteristics of SRT data but also preserves spatial patterns. We illustrate the benefits of SRTsim in benchmarking methods for spatial clustering, spatial expression pattern detection, and cell-cell communication identification.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-023-02879-z.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Institutes of Health</institution>
        </funding-source>
        <award-id>R01GM126553</award-id>
        <award-id>R01HG011883</award-id>
        <award-id>R01GM144960</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhou</surname>
            <given-names>Xiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">A wide variety of spatially resolved transcriptomics (SRT) techniques have been recently developed to enable gene expression profiling with spatial localization information on complex tissues. Some of these SRT techniques are based on single-molecule fluorescence in situ hybridization (smFISH) and examples include seqFISH [<xref ref-type="bibr" rid="CR1">1</xref>], seqFISH+ [<xref ref-type="bibr" rid="CR2">2</xref>], MERFISH [<xref ref-type="bibr" rid="CR3">3</xref>], and split-FISH [<xref ref-type="bibr" rid="CR4">4</xref>]. Some are based on in situ array capturing with examples including ST [<xref ref-type="bibr" rid="CR5">5</xref>], 10x Visium [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], Slide-seq [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], DBiT-seq [<xref ref-type="bibr" rid="CR9">9</xref>], and Seq-Scope [<xref ref-type="bibr" rid="CR10">10</xref>]. Some are based on in situ sequencing with examples including FISSEQ [<xref ref-type="bibr" rid="CR11">11</xref>], ISS [<xref ref-type="bibr" rid="CR12">12</xref>], and STARmap [<xref ref-type="bibr" rid="CR13">13</xref>], while some are based on microdissection with examples including LCM [<xref ref-type="bibr" rid="CR14">14</xref>] and TIVA [<xref ref-type="bibr" rid="CR15">15</xref>]. The collection of these SRT techniques has revolutionized many areas of biology [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR22">22</xref>] and has motivated the development of computational methods and bioinformatics tools [<xref ref-type="bibr" rid="CR23">23</xref>] to enable a wide variety of SRT-specific analyses. In particular, the newly developed SRT methods allow us to identify genes with spatial expression patterns [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR28">28</xref>], perform deconvolution [<xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR34">34</xref>] and clustering [<xref ref-type="bibr" rid="CR35">35</xref>–<xref ref-type="bibr" rid="CR39">39</xref>] to characterize the spatial distribution of cell types, detect local structures and microenvironments on the tissue [<xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR42">42</xref>], and examine cell-cell communications [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR42">42</xref>–<xref ref-type="bibr" rid="CR46">46</xref>] and gene-gene interactions [<xref ref-type="bibr" rid="CR46">46</xref>–<xref ref-type="bibr" rid="CR48">48</xref>] in a spatially informed fashion.</p>
    <p id="Par3">The development of SRT-specific computational methods and software tools requires the routine use of simulated/synthetic SRT data. Synthetic SRT data contains a known underlying truth, which enables objective evaluation of method performance. Synthetic SRT data also allows method evaluation to be carried out under a wide range of parameter settings, helping characterize the unique benefits and limitations of the developed method across different scenarios. In addition, synthetic SRT data allows the power and accuracy of specific analytical tasks to be evaluated under different SRT techniques, sequencing depths, and other experimental conditions, thus facilitating experimental design for maximizing the benefits of SRT experiments. Unfortunately, many existing simulations of SRT data in different methodology studies are often poorly documented, not reproducible, and/or fail to generate synthetic data that resemble real SRT datasets. In addition, simulations for assessing a particular method are often carried out under the same modeling assumptions underlying the method, which can lead to an overestimation of method performance. Therefore, it is important to develop an independent, reproducible, and realistic SRT simulation framework that can be used to facilitate the development of SRT methods for a wide variety of SRT-specific analyses. Such simulation frameworks have long been established in the parallel research field of single-cell RNA sequencing (scRNA-seq) studies, with multiple popular scRNA-seq simulators available for facilitating scRNA-seq methodology development and scRNA-seq analysis [<xref ref-type="bibr" rid="CR49">49</xref>–<xref ref-type="bibr" rid="CR55">55</xref>]. Unfortunately, while both SRT data and scRNA-seq data are in the similar form of over-dispersed counts [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR57">57</xref>], SRT data contains additional spatial localization information that makes it challenging to directly make use of existing scRNA-seq simulators. Indeed, as we will show below, because scRNA-seq simulators cannot incorporate spatial information, they will fail to preserve the important spatial and structural patterns of the tissue transcriptome that are key features of SRT datasets.</p>
    <p id="Par4">Here, we develop the first SRT-specific simulator, which we call SRTsim (<italic>S</italic>patially <italic>R</italic>esolved <italic>T</italic>ranscriptomic <italic>sim</italic>ulator), for generating synthetic SRT data based on a wide variety of SRT techniques. SRTsim incorporates spatial localization information to simulate SRT expression count data in a reproducible and scalable fashion, thus facilitating SRT experimental design and methodology development. A key benefit of SRTsim is its ability to not only maintain various location-wise and gene-wise SRT count properties but also preserve the spatial expression patterns of the SRT data on the tissue, thus making it feasible to evaluate SRT method performance for various SRT-specific analytic tasks using the synthetic data. We characterize the properties of the synthetic data generated by SRTsim in a comprehensive way and illustrate the benefits of SRTsim for assessing the performance of spatial clustering methods, spatial expression analysis methods, and cell-cell communication identification methods.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>An overview of SRTsim</title>
      <p id="Par5">SRTsim is a general and flexible computational framework for simulating gene expression count data for spatial transcriptomics. SRTsim allows users to perform either reference-based simulations with a reference spatial transcriptomics dataset or reference-free simulations without such a reference. In the reference-based simulations, SRTsim first relies on the reference spatial transcriptomics data to either obtain the spatial coordinates of the measured locations or generate new spatial locations on the tissue as requested by the user. SRTsim then simulates the expression count data for one gene at a time using count models inferred from the reference data and allocates the simulated counts to spatial locations in the synthetic data in a way that preserves the spatial expression pattern of the gene observed in the reference (Fig. <xref rid="Fig1" ref-type="fig">1</xref>; see details in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). In the reference-free simulations, SRTsim allows the user to create a tissue section with an arbitrary shape, generate spatial locations on the tissue, simulate gene expression count data on each location based on a user-specified count model, and allocate the simulated expression counts to locations in the synthetic data based on user-designed domain-specific spatial expression patterns (Fig. <xref rid="Fig1" ref-type="fig">1</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1; see details in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). The key difference between reference-based and reference-free simulations is that the gene expression from the reference-based simulations either preserves or builds upon the spatial expression pattern observed in the reference while the gene expression from the reference-free simulations displays de novo spatial expression patterns defined by the user (regardless whether the tissue shape profile is obtained from an SRT data or created in a de novo fashion). SRTsim is implemented in an R package, which, along with an R-shiny app, is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.xzlab.org/software.html">www.xzlab.org/software.html</ext-link>.<fig id="Fig1"><label>Fig. 1</label><caption><p>A schematic of SRTsim. SRTsim is a flexible SRT simulator that can perform either reference-based or reference-free simulations. Both types of simulations can be carried out in a tissue-based or a domain-specific fashion. In the reference-based simulations, SRTsim requires a reference SRT data in the form of a gene expression count matrix, a location matrix, and, for domain-specific simulations, an additional domain annotation matrix. SRTsim can directly use the reference data locations or create new locations and can redesign the target tissue region (Step 1). SRTsim then fits an appropriate count distribution to each gene in the reference and simulates the gene-specific counts in the synthetic data (Step 2). Finally, SRTsim assigns the simulated counts to the locations in the synthetic data in a way that preserves the spatial expression pattern observed in the reference data. In reference-free simulations, SRTsim allows users to design spatial patterns either from a customized shape or a predefined shape of interest and generate synthetic data with user-specified model parameters. P, Poisson; NB, negative binomial; ZIP, zero-inflated Poisson; ZINB, zero-inflated negative binomial</p></caption><graphic xlink:href="13059_2023_2879_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Synthetic data generated by SRTsim resemble real SRT data</title>
      <p id="Par6">We benchmarked SRTsim along with eight existing single-cell expression simulators that include ZINB-WaVE [<xref ref-type="bibr" rid="CR49">49</xref>], SPARSim [<xref ref-type="bibr" rid="CR50">50</xref>], SymSim [<xref ref-type="bibr" rid="CR51">51</xref>], two variants of scDesign2 (with/without copula) [<xref ref-type="bibr" rid="CR52">52</xref>], and three variants of Splat in the Splatter package (Splat Simple, Splat, and Kersplat) [<xref ref-type="bibr" rid="CR53">53</xref>]. To do so, we obtained 49 SRT datasets collected from eight different SRT platforms that include 10x Visium, MERFISH, seqFISH+, STARmap, DBiT-seq, ST, CosMx SMI, and SlideseqV2 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). For each SRT dataset in turn, we applied all nine simulators to perform reference-based simulations. In the synthetic data, we calculated six metrics to characterize the critical properties of the simulated expression counts. The six metrics include four gene-wise metrics that characterize the expression properties for each gene across locations and two location-wise metrics that characterize the expression properties for each location across genes. The four gene-wise metrics include gene-wise mean, variance, coefficient of variation, and zero proportion, while the location-wise metrics include location-wise zero proportion and library size. With the calculated metrics, we compared each of them with that calculated in the reference data to evaluate how similar the synthetic data resembles the real data. Because the results are generally consistent across datasets, we will use the simulation results based on the 10x Visium data on the human dorsolateral prefrontal cortex (DLPFC) [<xref ref-type="bibr" rid="CR17">17</xref>] and CosMx SMI data on the non-small-cell lung cancer (NSCLC) tissue [<xref ref-type="bibr" rid="CR58">58</xref>] as the primary examples and list the simulation results for the other 47 datasets in the supplements.</p>
      <p id="Par7">We compared the empirical distribution of each metric, either across genes for gene-wise metrics or across locations for location-wise metrics, between the synthetic data and the reference data for each simulator (Figs. <xref rid="Fig2" ref-type="fig">2</xref>A and <xref rid="Fig3" ref-type="fig">3</xref>A). The distributions of the six metrics suggest that only SRTsim and ZINB-WaVE are capable of producing synthetic data that preserve both gene-wise and location-wise properties in the reference. Both variants of scDesign2 can only preserve the gene-wise properties but not location-wise properties, while SPARSim is only able to preserve the location-wise properties but not gene-wise properties. In contrast, SymSim and three variants of Splat cannot preserve either gene-wise or location-wise properties (Figs. <xref rid="Fig2" ref-type="fig">2</xref>A and <xref rid="Fig3" ref-type="fig">3</xref>A). Quantifications with the Kolmogorov–Smirnov tests support the same conclusion. In particular, all metrics computed on the synthetic data by SRTsim are not statistically significantly different from those computed on the reference data (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2 and Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S3). However, almost all metrics on the synthetic data by the other simulators are substantially different from that of the reference data, with the only exception of the two location-wise metrics for ZINB-WaVE. The comparison results hold across different samples and different spatial transcriptomics techniques (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S2, S3, S4, and S5; Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S4), except for the seqFISH+ data. For the seqFISH+ dataset, all the simulators, including SRTsim, fail to preserve the similarity for one gene-wise metric—the coefficient of variation (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S4), suggesting that certain data properties from seqFISH+ techniques may not be easy to capture fully. Indeed, consistent with [<xref ref-type="bibr" rid="CR57">57</xref>], we found that while the negative binomial model is the preferred model for most datasets, the zero-inflated negative binomial model is the most preferred model for the seqFISH+ datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>C), supporting distinct data features of seqFISH+.<fig id="Fig2"><label>Fig. 2</label><caption><p>Benchmarking SRTsim against eight existing scRNAseq simulators for generating SRT data based on the DLPFC reference data. <bold>A</bold> Violin plots show the distributions of six metrics (six panels) in the reference data (real; <italic>x</italic>-axis) and in the synthetic data generated by different simulators (<italic>x</italic>-axis). The six metrics include four gene-wise metrics (expression mean; variance; coefficient of variation, cv; and zero proportion) and two location-wise metrics (zero proportion and library size). The examined simulators include SRTsim, scDesign2, scDesign2 without copula (scDesign2 (ind)), ZINB-WaVE, SPARSim, SymSim, and three variants of the splatter package (kersplat, splat simple, and splat). Results are shown for the reference sample DLPFC 151673. Results for the other reference samples are provided in the supplemental figures. <bold>B</bold> The spatial expression patterns of three representative genes (<italic>MOBP</italic>, <italic>PCP4</italic>, <italic>SNAP25</italic>) are displayed in the reference data and in the synthetic data generated by SRTsim, scDesign2, ZINB-WaVE, and SPARSim</p></caption><graphic xlink:href="13059_2023_2879_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Benchmarking SRTsim against six existing scRNAseq simulators for generating SRT data based on the CosMx SMI reference data. <bold>A</bold> Violin plots show the distributions of six metrics (six panels) in the reference data (real; <italic>x</italic>-axis) and in the synthetic data generated by different simulators (<italic>x</italic>-axis). The six metrics include four gene-wise metrics (expression mean; variance; coefficient of variation, cv; and zero proportion) and two location-wise metrics (zero proportion and library size). The examined simulators include SRTsim, scDesign2, scDesign2 without copula (scDesign2 (ind)), ZINB-WaVE, SymSim, and three variants of the splatter package (splat simple, and splat). SPARsim and kersplat were unable to generate the synthetic data for this sample, therefore were excluded from the comparison. Results are shown for the reference sample Lung12 FOV1. Results for the other four reference samples are provided in the supplemental figures. <bold>B</bold> The spatial expression patterns of three representative genes (<italic>IGHA1</italic>, <italic>KRT19</italic>, <italic>SLPI</italic>) are displayed in the reference data and in the synthetic data generated by SRTsim, scDesign2, and ZINB-WaVE. <bold>C</bold> The heatmap shows the proportion of the preferred count model in each dataset. The right color bar represents the SRT techniques: 10X (orange), Spatial Transcriptomics (dark green), DBiT-seq(pink), seqFISH+ (cyan), STARmap (purple), SlideseqV2 (yellow), CosMx SMI (red), and MERFISH (blue). The corresponding dataset names are listed in Table S<xref rid="MOESM1" ref-type="media">1</xref>. NB, negative binomial; ZIP, zero-inflated Poisson; ZINB, zero-inflated negative binomial</p></caption><graphic xlink:href="13059_2023_2879_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par8">A unique feature of SRTsim is its ability to preserve the spatial expression pattern of genes in the synthetic data, a feature not possessed by any single-cell expression simulators. To illustrate this benefit, we examined the spatial expression patterns of multiple layer-specific genes in DLPFC and compared them with the corresponding genes in the synthetic data generated by different simulators. Specifically, we examined three well-known marker genes [<xref ref-type="bibr" rid="CR17">17</xref>]: <italic>MOBP</italic>, which is highly enriched in the white matter; <italic>PCP4</italic>, which is highly enriched in the L5; and <italic>SNAP25</italic>, which is enriched in neurons. We examined all simulators except for SymSim and the three variants of Splat, as these four methods preserve neither gene-wise nor location-wise properties (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). In the analysis, we found that only SRTsim can preserve the spatial expression pattern for all three marker genes in the synthetic data, while none of the other simulators can (Figs. <xref rid="Fig2" ref-type="fig">2</xref>B and <xref rid="Fig3" ref-type="fig">3</xref>B). In addition, we quantified the spatial expression pattern of all genes using Moran’s I and found that the Moran’s I statistics in the synthetic data generated by SRTsim are highly consistent with those calculated in the reference data, much more so than the other simulators (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6), supporting the benefits of SRTsim in preserving spatial expression pattern for spatial transcriptomics simulations.</p>
      <p id="Par9">Another desirable feature of SRTsim is its ability to simulate data with a user-specified number of tissue locations, a feature that only scDesign2 and SymSim possess among the single-cell simulators. Simulating data with a user-specified number of tissue locations would allow us to determine the needed spatial resolution and/or sequencing depth for achieving certain analytical tasks in spatial transcriptomics, thus facilitating experimental design. To illustrate this feature, we applied SRTsim, along with scDesign2 and SymSim, to generate synthetic data on 1000 or 6000 spatial locations based on DLPFC. SRTsim and scDesign2, but not SymSim, preserve gene-wise metrics in the synthetic data regardless of the location number (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7A). SRTsim also preserves location-wise metrics in the synthetic data, more so than scDesign2 and SymSim. In addition, SRTsim is the only method that can preserve the spatial expression patterns of the marker genes, though such patterns become less apparent with a lower number of spatial locations as one might expect (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7).</p>
      <p id="Par10">Finally, we compared the computational resources required by different simulators on seven example datasets from different SRT platforms. We found that both SRTsim and the three variants of Splat achieve the best computational efficiency, while scDesign2 and ZINB-WaVE achieve the least (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8). For example, for a SlideseqV2 data with 23,124 genes and 51,649 locations, it took SRTsim ~2 h to generate the synthetic data, while it took ~64 h for scDesign2 and 83 h for ZINB-WaVE. ZINB-WaVE also requires more than 250 gigabytes (GB) of physical RAM, while SRTsim only requires 50 GB. In terms of computational stability, SRTsim, scDesign2, ZINB-WaVE, Splat Simple, and Splat can generate synthetic data for all real datasets. In contrast, SPARSim failed to generate synthetic data for 20 out of the 49 datasets, and Kersplat failed for three datasets, while SymSim failed for one dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5).</p>
      <p id="Par11">Overall, SRTsim can generate synthetic datasets that closely resemble the real data for all eight SRT platforms in a computationally efficient fashion.</p>
      <sec id="Sec5">
        <title>Application 1: Benchmarking spatial clustering methods using synthetic SRT data</title>
        <p id="Par12">We demonstrated the utility of SRTsim in benchmarking spatial transcriptomics methods for three analytical tasks. The first analytical task is spatial clustering for tissue domain detection, which aims to detect potentially functional domains or structures in the tissue using spatial transcriptomics information. Here, we focused on six spatial clustering methods for tissue domain detection that include five methods originally developed for spatial clustering (BayesSpace [<xref ref-type="bibr" rid="CR59">59</xref>], stLearn with Kmeans, stLearn with Louvain [<xref ref-type="bibr" rid="CR36">36</xref>], SpaGCN [<xref ref-type="bibr" rid="CR39">39</xref>], HMRF [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]), and one method originally developed for non-spatial clustering but previously used for spatial clustering (SNN in Seurat [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR60">60</xref>]). For the benchmarking study, we performed reference-based simulations using two reference datasets: a non-single-cell resolution 10x Visium data on DLPFC and another single-cell resolution STARmap data on mouse visual cortex (details in the see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). For each data, we considered two types of simulations: tissue-based simulations where we directly simulated expression across all tissue locations, and domain-specific simulations where we simulated expression across locations within each tissue domain separately before combing them across the tissue. The domain-specific simulations create sharper contrasts among the spatial domains compared to the tissue-based simulations, thus representing a likely simpler scenario for domain detection.</p>
        <p id="Par13">We first examined the performance of different spatial clustering methods using the synthetic data generated based on DLPFC, which consisted of seven spatial domains, including six cortical layers and white matter (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). The synthetic data from both tissue-based and domain-specific simulations resemble the real data well (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig.S9). In the tissue-based simulations, BayesSpace achieves the highest ARI (mean across replicates = 0.54, median = 0.55, Fig. <xref rid="Fig4" ref-type="fig">4</xref>B) and identifies a clear layered structure that qualitatively follows the expected pattern (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig.S10). The performance of BayesSpace is followed by refined SpaGCN (mean = 0.48, median=0.49). In contrast, stLearn with Kmeans produces the lowest ARI (mean=0.24, median=0.23) with the inferred spatial clusters almost randomly distributed across tissue locations. In the domain-specific simulations, all methods, except for the HMRF, achieve higher ARI when compared to tissue-based simulations, as one would expect. Here, stLearn with Louvain achieves the highest ARI (mean=0.88, median=0.88) and accurately detects all layers (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig.S11). Its performance is followed by refined SpaGCN (mean=0.57, median=0.58) and BayesSpace (mean=0.56, median=0.58, Fig. <xref rid="Fig4" ref-type="fig">4</xref>C), both of which detect all seven layers but with layers 2–4 being wider than expected. The distinct clustering performances of these methods in tissue-based and domain-specific simulations suggest that spatial location information can help improve clustering accuracy, especially when the difference in gene expression across different domains is small.<fig id="Fig4"><label>Fig. 4</label><caption><p>Benchmarking spatial clustering methods using synthetic data from SRTsim. The synthetic data are either generated based on the DLPFC reference data with seven original layers (<bold>A–D</bold>) or the STARmap data with four layers (<bold>E–G</bold>). <bold>A</bold> The reference DLPFC data contains seven layers, including six DLPFC layers and white matter (WM). Sample 151673 in the DLPFC data is used to serve as the reference. <bold>B</bold>, <bold>C</bold> The performances of six spatial clustering methods (<italic>x</italic>-axis) are evaluated based on the adjusted Rand index (<italic>y-</italic>axis) using synthetic data generated from SRTsim via either the tissue-based simulations (<bold>B</bold>) or the domain-specific simulations (<bold>C</bold>) based on the DLPFC reference. The six spatial clustering methods include BayesSpace, SNN, stLearn with Louvain, stLearn with Kmeans, spaGCN, and HMRF. <bold>D</bold> The reference STARmap data contains four cortical layers. <bold>E</bold>, <bold>F</bold> The performances of six spatial clustering methods (<italic>x</italic>-axis) are evaluated based on the adjusted Rand index (<italic>y</italic>-axis) using synthetic data generated from SRTsim via either the tissue-based simulations (<bold>E</bold>) or the domain-specific simulations (<bold>F</bold>) based on the STARmap reference. For <bold>B</bold>, <bold>C</bold> and <bold>E</bold>, <bold>F</bold>, ARI results are summarized across 100 simulation replicates. For the HMRF, we included the best result obtained by examining a range of values for the spatial parameter beta. For the SpaGCN, there is no refined version for the STARmap-based simulation, as no histology image is available for the data generated by this platform. <bold>G</bold> The performances of six spatial clustering methods in terms of ARI (<italic>x</italic>-axis) are evaluated under varying-sequencing-depth (scenario I), varying-location-number (scenario II), and fixing-average-sequencing-depth (scenario III)</p></caption><graphic xlink:href="13059_2023_2879_Fig4_HTML" id="MO4"/></fig></p>
        <p id="Par14">We next examined the performance of different spatial clustering methods using the synthetic data generated based on STARmap, which contains four distinct cortical layers (Fig. <xref rid="Fig4" ref-type="fig">4</xref>D). Again, the synthetic data from both tissue-based and domain-specific simulations resemble the real data well (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig.S12). In the tissue-based simulations, HMRF achieves the highest ARI (mean = 0.53, median = 0.53, Fig. <xref rid="Fig4" ref-type="fig">4</xref>E) and identifies L5 and L6 layers but with mixed L2/3 and L4 layers (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig.S13). The performance of HMRF is followed by BayesSpace (mean = 0.32, median=0.31). In contrast, stLearn with Kmeans produces the lowest ARI (mean=0.19, median=0.20). In the domain-specific simulations, all methods again achieve higher ARI as compared to the tissue-based simulations. There, HMRF also reaches the highest ARI (mean=0.56, median=0.56), and its performance is followed by BayesSpace (mean=0.4, median=0.38, Fig. <xref rid="Fig4" ref-type="fig">4</xref>F and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14). Note that HMRF performs poorly in the synthetic data generated from DLPFC but reasonably well in the synthetic data generated from STARmap data; we discuss the potential reasons in the “<xref rid="Sec8" ref-type="sec">Discussion</xref>” section.</p>
        <p id="Par15">We performed additional simulations to examine the influence of three crucial experimental design parameters on the performance of spatial clustering. The three design parameters include the total sequencing depth, the average sequencing depth per location, and the number of measured tissue locations. We performed domain-specific simulations based on DLPFC for three scenarios: (I) varying the total sequencing depth while keeping the number of measured locations constant, (II) varying the number of measured locations while keeping the total sequencing depth constant, and (III) keeping the average sequencing depth per-location constant, while varying both the number of locations and the total sequencing depth (Fig. <xref rid="Fig4" ref-type="fig">4</xref>G). We found that the performance of all methods initially improves with increasing total sequencing depth in scenario I and reaches a saturation point beyond which further increase in total sequencing depth no longer substantially improves spatial clustering performance. Similarly, the performance of all methods initially improves with the increasing number of locations in both scenarios II and III. Afterwards, their performance reaches an optimal point in scenario II beyond which further increasing the number of locations reduces spatial clustering performance, and reaches a saturation point in scenario III beyond which further increasing the number of locations does not substantially influence spatial clustering performance. These results allow us to identify the optimal number of spatial locations and the optimal number of sequencing depths (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S15). For example, measuring 1000 tissue locations with a total sequencing depth of 16.6 million reads is reasonably optimal for spatial clustering analysis on a cortex tissue measured with 10x Visium technology.</p>
        <p id="Par16">Finally, we carried out simulations to examine the influence of the number and size of tissue domains on the performance of spatial clustering. In particular, we used a modified version of the domain-specific simulations to create synthetic data based on DLPFC, where the modification allows us to change the number and size of the tissue domains. To do so, we merged the original seven cortical layers (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A) into three new layers (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). We designed the simulation such that the genes on each new layer inherit the spatial expression pattern from one of the original layers. Specifically, the new layer NL1 contains the original layers 1–3 and displays a similar expression pattern as layer 3; the new layer NL2 contains the original layers 4–5 and displays a similar expression pattern as layer 5; the new layer NL3 contains the original layer 6 and white matter and displays similar expression pattern of the white matter layer. The synthetic data preserved the expression characteristics of the reference data (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E) and the spatial expression patterns of the marker genes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>C, D). With this simulation, the stLearn with Louvain achieves the highest ARI on average (mean = 0.70, median = 0.69, Fig. <xref rid="Fig5" ref-type="fig">5</xref>F). The performance of the stLearn with Louvain is followed by refined SpaGCN (mean = 0.70, median=0.60) and SpaGCN (mean = 0.69, median = 0.59). The results suggest that the performance of different spatial clustering methods depends on the number and size of tissue domains. Note that the ARI from SpaGCN displays a bimodal pattern, with relatively high values in five replicates with slightly clearer spatial domain patterns and relatively low ARI in five remaining replicates with slightly less clear spatial domain patterns (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S16), suggesting the potentially sensitive performance of SpaGCN across replicates.<fig id="Fig5"><label>Fig. 5</label><caption><p>Benchmarking spatial clustering methods using synthetic data from SRTsim based on the DLPFC reference data with redesigned layers. <bold>A</bold> The reference DLPFC data contains seven layers, including six DLPFC layers and white matter (WM). Sample 151673 in the DLPFC data is used to serve as the reference. <bold>B</bold> The spatial distribution of three redesigned layers. NL1 corresponds to the original layers 1–3. NL2 corresponds to the original layers 4–5. NL3 corresponds to the original layer 6—white matter. <bold>C</bold> The spatial expression patterns of three representative genes (<italic>MOBP</italic>, <italic>PCP4</italic>, <italic>SNAP25</italic>) are displayed in the reference data. <bold>D</bold> Spatial expression patterns of three representative genes are displayed in the synthetic data with redesigned layers (nearest neighbors k=20). <bold>E</bold> Violin plots show the distributions of six metrics (six panels) in the reference data (real; <italic>x</italic>-axis) and in the synthetic data generated by SRTsim (<italic>x</italic>-axis). The six metrics include four gene-wise metrics (expression mean; variance; coefficient of variation, cv; and zero proportion) and two location-wise metrics (zero proportion and library size). <bold>F</bold> The performance of six spatial clustering methods (<italic>x</italic>-axis) is evaluated based on the adjusted Rand index (<italic>y</italic>-axis) using synthetic data with redesigned layers generated from SRTsim</p></caption><graphic xlink:href="13059_2023_2879_Fig5_HTML" id="MO5"/></fig></p>
      </sec>
      <sec id="Sec6">
        <title>Application 2: Benchmarking SE analysis methods using synthetic SRT data</title>
        <p id="Par17">We further demonstrated the utility of SRTsim in benchmarking spatial expression (SE) analysis methods that aim to identify genes with spatial expression patterns. Here, we used synthetic data generated by SRTsim for benchmarking four SE methods that include SPARK [<xref ref-type="bibr" rid="CR27">27</xref>], SPARK-G, SPARK-X [<xref ref-type="bibr" rid="CR25">25</xref>], and SpatialDE [<xref ref-type="bibr" rid="CR24">24</xref>]. To make simulations as realistic as possible, we simulated the data based on the parameters inferred from the same two datasets used in the previous section: the 10x Visium DLPFC data and the STARmap data (see details in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). Rather than preserving the gene-specific spatial expression pattern as shown in the reference-based simulations in the previous section, the synthetic data here are generated in a reference-free fashion to create artificial spatial expression patterns of interest (even though we used the tissue shape profile from the reference). For each data, we considered a set of null simulation settings and a set of alternative simulation settings, with 1000 simulated genes in each setting. Under the null settings, all genes are non-SE genes with expression levels randomly distributed across spatial locations without any spatial expression patterns (Fig. <xref rid="Fig6" ref-type="fig">6</xref>A, E). Under the alternative settings, 900 genes are non-SE genes while 100 genes are SE genes with domain-specific spatial expression patterns. In particular, the SE genes display one of the seven spatial patterns corresponding to each spatial domain for the 10x Visium-based simulations (Fig. <xref rid="Fig6" ref-type="fig">6</xref>B and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig.S17A) and show one of the four spatial patterns corresponding to each spatial domain for STARmap-based simulations (Fig. <xref rid="Fig6" ref-type="fig">6</xref>F). For each alternative simulation setting, we consider two scenarios: a scenario where the SE genes display strong spatial expression patterns and another scenario where the SE genes show weak spatial expression patterns. With the synthetic data, we applied different SE methods to identify SE genes in different simulation settings. In total, we examined two null settings and 22 alternative settings (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6, details in Methods). We examined type I error control under the null and examined power under the alternatives.<fig id="Fig6"><label>Fig. 6</label><caption><p>Benchmarking spatial expression analysis methods using synthetic data from SRTsim. Synthetic data are either generated based on the DLPFC reference (<bold>A–D</bold>) or the STARmap reference (<bold>E–H</bold>). <bold>A</bold> A representative gene in the DLPFC reference data (sample 151673) displays a random spatial expression pattern. <bold>B</bold> Representative genes in the DLPFC reference data display four distinct spatial expression patterns corresponding to four different layered structures (Layer1, Layer 2, Layer 3, and WM, respectively). <bold>C</bold> Quantile–quantile plot of the observed −log<sub>10</sub>(<italic>P</italic>) from different methods against the expected −log<sub>10</sub>(<italic>P</italic>) under the null SRTsim simulations based on the DLPFC reference. <italic>P</italic> values were combined across ten simulation replicates. <bold>D</bold> Power plots show the proportion of true positives (<italic>y</italic>-axis) detected by different methods at a range of FDRs (<italic>x</italic>-axis) for the alternative SRT simulations based on the DLPFC reference. Each panel corresponds to the spatial expression pattern displayed in <bold>B</bold>. SE strength is set to be <italic>five-fold</italic>. <bold>E</bold> A representative gene in the STARmap reference data displays a random spatial expression pattern. <bold>F</bold> Representative genes in the STARmap reference data display four distinct spatial expression patterns that correspond to four different layered structures (Layer2/3, Layer 4, Layer 5, and Layer 6, respectively). <bold>G</bold> Quantile–quantile plot of the observed −log<sub>10</sub>(<italic>P</italic>) from different methods against the expected −log<sub>10</sub>(<italic>P</italic>) under the null SRTsim simulations based on the STARmap reference. <italic>P</italic> values were combined across ten simulation replicates. <bold>H</bold> Power plots show the proportion of true positives (<italic>y</italic>-axis) detected by different methods at a range of FDRs (<italic>x</italic>-axis) for the alternative SRT simulations based on the STARmap reference. Each panel corresponds to the spatial expression pattern displayed in <bold>F</bold>. SE strength is set to be <italic>three-fold</italic></p></caption><graphic xlink:href="13059_2023_2879_Fig6_HTML" id="MO6"/></fig></p>
        <p id="Par18">In the two null simulation settings based on the two datasets, SPARK, SPARK-G, and SPARK-X produce well-calibrated <italic>P</italic> values, while SpatialDE yields overly conservative <italic>P</italic> values (Fig. <xref rid="Fig6" ref-type="fig">6</xref>C, G). As SpatialDE produced overly conservative <italic>P</italic> values under the null, we measured power in the alternative simulations based on false discovery rate (FDR) to ensure fair comparison among methods. In the alternative simulations based on DLPFC, we found that SPARK and SPARK-G are more powerful than SPARK-X and SpatialDE for most spatial expression patterns, except for the layer 1 specific expression pattern for which SPARK-X is more powerful than the other three methods. In the simulations, we found that the power of SE analysis depends on two critical factors: the SE strength and the size of the tissue domain on which the SE gene displays a domain-specific expression pattern. For example, it is challenging to detect genes that display layer-specific expression patterns in the thin layers 2 and 4 compared to the other wider layers (Fig. <xref rid="Fig6" ref-type="fig">6</xref>D and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S17B), unless the SE expression pattern is strong (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S17C). Similar conclusions hold in the alternative simulations based on the STARmap data. For example, SPARK outperforms all three other methods in detecting SE genes across all patterns (Fig. <xref rid="Fig6" ref-type="fig">6</xref>H and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S18B). All methods achieve higher power in detecting genes that display layer-specific expression patterns in the thin layer 4 compared to the wide layer 5. Overall, SRTsim allows us to effectively evaluate the performance of different SE analysis methods using synthetic data that highly resembles the real data but with known underlying truth.</p>
      </sec>
      <sec id="Sec7">
        <title>Application 3: Benchmarking cell-cell communication identification methods using synthetic SRT data</title>
        <p id="Par19">We performed comprehensive and realistic simulations to evaluate the performance of Giotto [<xref ref-type="bibr" rid="CR37">37</xref>] and CellphoneDBv3 [<xref ref-type="bibr" rid="CR61">61</xref>]. The simulation details are provided in the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section. Briefly, we first estimated the shape profile based on the spatial locations of the reference data and randomly generated 5000 locations within the estimated shape profile to serve as the single cell locations. We assumed that these single cells belong to four different cell types and created four equal size regions on the tissue with distinct cell type compositions in each region. In parallel, we simulated expression counts for 5000 genes and 2000 single cells from the four cell types in two ways. In the first way (homogenous expression setting), we simulated the expression level for each gene for all cells from a common negative binomial distribution and randomly assigned these cells into four cell types. In the second way (heterogeneous expression setting), in each simulation replicate, we randomly selected four cell types in the STARmap dataset and simulated the expression level for each gene in each cell type using a cell type-specific negative binomial distribution, with parameters estimated based on the particular cell type in the reference data. We then assigned the simulated cells onto the single-cell locations of the regions based on the specified cell type composition in each region to create a spatial transcriptomics dataset at single-cell resolution. We finally randomly assigned ligand-receptor (L-R) gene pairs expressed in cell type pairs (A-B) to the simulated cells. We compared the performance of four methods including Giotto with spatial information, Giotto without spatial information, CellphoneDBv3 with spatial information, and CellphoneDBv3 without spatial information.</p>
        <p id="Par20">Overall, we found that Giotto with spatial information achieves the best performance. Specifically, in the heterogeneous expression settings, in the absence of interaction (fold change=1), Giotto with spatial information achieves the lowest F1 scores. For example, at a <italic>p</italic> value threshold of 0.05, the mean F1 score for Giotto with spatial information is 0.007, 0.006, 0.007, and 0 for the four scenarios, respectively. In contrast, Giotto without spatial information has the highest F1 score (mean=0.117, 0.117, 0.117, and 0.117 for the four scenarios, Fig. <xref rid="Fig7" ref-type="fig">7</xref>A). The CellphonDBv3 with spatial information (mean=0.085, 0.085, 0.086 and 0.085) and CellphoneDBv3 without spatial information (mean=0.086, 0.085, 0.086, and 0.084) have similar mean F1 score values. In the presence of moderate cell-cell communications, Giotto with spatial information achieves the highest F1 scores (mean=0.204, 0.188, 0.191, and 0.196 for four scenarios, Fig. <xref rid="Fig7" ref-type="fig">7</xref>A), demonstrating its power. Giotto without spatial information (mean=0.117, 0.117, 0.116, and 0.117) performs slightly better than CellphoneDBv3 with spatial information (mean=0.081, 0.08, 0.082, and 0.079) and without spatial information (mean=0.08, 0.081, 0.08, and 0.08, Fig. <xref rid="Fig7" ref-type="fig">7</xref>A). The two methods of CellphoneDBv3 perform similarly and are worse than the two Giotto methods, possibly because CellphoneDBv3 only incorporates regional spatial information without fully utilizing cell-cell spatial proximity as used in Giotto with spatial information. Finally, in the presence of high cell-cell communications, Giotto with spatial information also achieves the highest F1 score (Fig. <xref rid="Fig7" ref-type="fig">7</xref>A). The results are somewhat similar in the homogenous expression settings (Fig. <xref rid="Fig7" ref-type="fig">7</xref>B).<fig id="Fig7"><label>Fig. 7</label><caption><p>Benchmarking cell-cell communication identification methods using synthetic data from SRTsim. <bold>A</bold> The power of different methods for identifying cell-cell communications is measured by mean F1 scores across a range of adjusted <italic>p</italic>-value thresholds in the heterogeneous expression settings. Compared methods include CellphoneDBv3 with spatial information (green dash line), CellphoneDBv3 without spatial information (yellow dash line), Giotto with spatial information (pink dash line), and Giotto without spatial information (blue dash line). Results are shown for four different scenarios (columns) with different cell-cell communication strength (rows). <bold>B</bold> The power of different methods for identifying cell-cell communications is measured by mean F1 scores across a range of adjusted <italic>p</italic>-value thresholds in the homogeneous expression settings. Results are again shown for four different scenarios (columns) with different cell-cell communication strengths (rows). Each setting includes 10 simulation replicates</p></caption><graphic xlink:href="13059_2023_2879_Fig7_HTML" id="MO7"/></fig></p>
        <p id="Par21">While Giotto with spatial information achieves the best performance in terms of F1 score, we note that all methods can be advantageous when measured with the other metrics. In particular, Giotto with spatial information achieves the highest precision (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S21A-B); Giotto without spatial information achieves the highest recall (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S19A-B); and the two CellphoneDBv3 methods generally achieve the highest specificity (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S20A-B).</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par22">We have presented SRTsim, an efficient and flexible framework for reproducible simulations of SRT data. We have benchmarked SRTsim along with eight scRNA-seq simulators using 49 SRT datasets from eight distinct SRT platforms, demonstrating the ability of SRTsim in capturing various gene expression characteristics in real data. Importantly, SRTsim is the only current method capable of preserving the spatial gene expression patterns observed on the tissue, facilitating SRT-specific applications. SRTsim is also computationally efficient and is an order of magnitude faster than scDesign2 and ZINB-WaVE, which are the only two scRNA-seq simulators capable of preserving certain gene expression characteristics in real data. In addition, SRTsim is well-documented and reproducible, with a simulation strategy that is independent of any specific SRT-analysis method, ensuring transparent, reproducible, and fair comparisons across SRT methods. We have illustrated the benefits of SRTsim in assessing the performance of spatial clustering methods, spatial expression analysis methods, and cell-cell communication identification methods.</p>
    <p id="Par23">SRTsim relies on four popular count models that include Poisson, ZIP, NB, and ZINB for generating the synthetic data. Two of the count models, ZIP and ZINB, are zero-inflated models that model zero-inflation not accounted for on top of the Poisson and NB models, respectively. While previous scRNA-seq literature has observed excessive dropouts in non-UMI datasets and subsequently recommended the modeling of zero-inflation, recent studies have shown that modeling zero-inflation is not necessary for UMI-based scRNA-seq datasets [<xref ref-type="bibr" rid="CR62">62</xref>]. Similarly, studies in SRT have also shown that modeling zero inflation may not be necessary for the majority of spatial transcriptomics datasets [<xref ref-type="bibr" rid="CR57">57</xref>], as excessive zero values in those data can often be accounted for by over-dispersion rather than zero-inflation on top of the Poisson model. Consequently, using the NB model or other types of over-dispersed Poisson models such as the Poisson mixed model [<xref ref-type="bibr" rid="CR63">63</xref>, <xref ref-type="bibr" rid="CR64">64</xref>] is sufficient for effective SRT simulation for the majority of genes in almost all spatial transcriptomics techniques, with the only exception of seqFISH+. Indeed, ZINB is the preferred model for more than 60% of genes in the two seqFISH+ datasets, suggesting distinctive data features of seqFISH+.</p>
    <p id="Par24">In the analysis, we found that HMRF performs poorly in the synthetic data generated from DLPFC but reasonably well in the synthetic data generated from STARmap data. The performance disparity of HMRF is presumably due to two reasons. First, the two data are of different sparsity: the DLPFC data has 93.4% zero entries in the gene expression matrix, while the STARmap data only has 69.5%. The high sparsity in the gene expression could violate the Gaussian assumption of HMRF and lead to poor performance in the DLPFC data. The second reason is that the DLPFC tissue structure is more complex than the STARmap tissue structure. In particular, DLPFC data was collected in a large capture area (6.5×6.5mm) that contains 7 spatial domains, while STARmap data was collected in a much smaller capture area (11.78×11.78um) with only 4 spatial domains. Because HMRF relies on a Potts model to incorporate neighborhood similarity in the spatial domain assignment, it may perform well when the tissue structure is simple and small but less so when the tissue structure is large and complex.</p>
    <p id="Par25">We have demonstrated SRTsim’s ability to generate synthetic datasets resembling the real data collected from eight different SRT techniques. These techniques include the three commonly applied commercial platforms such as 10x Visium, NanoString CosMx SME, and Vizgen MERFISH. We note that another SRT commercial platform is NanoString GeoMx DSP [<xref ref-type="bibr" rid="CR65">65</xref>–<xref ref-type="bibr" rid="CR67">67</xref>], which is primarily used to measure gene expression on a few targeted regions of interest (ROI). Because each ROI from GeoMx is relatively large and contains many cells, the GeoMx data likely resemble bulk RNAseq. Consequently, GeoMx data may be simulated directly using standard bulk RNA simulators, potentially with some additional modifications to account for the general correlation structure among different ROIs. Therefore, we did not explore the simulations for GeoMx data in the present study.</p>
    <p id="Par26">One important benefit of SRTsim is its ability to produce realistic synthetic datasets under different parameter settings for evaluating the performance of various SRT-specific methods in a cost-effective fashion. We have illustrated such benefit by using SRTsim to assess the performance of spatial clustering methods, spatial expression analysis methods, and cell-cell communication identification methods. Importantly, SRTsim is not limited to these three applications and can be used for method evaluation in many other SRT analytic tasks. For example, one can generate synthetic SRT data with continuous expression programs using the reference-free module in SRTsim for evaluating trajectory analysis in the spatial context [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR68">68</xref>]. In addition, one can generate synthetic SRT data using SRTsim with the single-cell resolution for spatial charting analysis [<xref ref-type="bibr" rid="CR69">69</xref>, <xref ref-type="bibr" rid="CR70">70</xref>]. Certainly, SRTsim focuses directly on simulating gene expression data without explicitly modeling the underlying cell type composition and is thus not applicable for evaluating certain SRT analytical tasks such as cell type deconvolution [<xref ref-type="bibr" rid="CR29">29</xref>]. Subsequently, an important future direction of SRTsim is to incorporate cell type composition into the SRT simulation framework, while properly accounting for the spatial correlation of cell type composition across tissue locations. Overall, SRTsim represents an effective SRT simulation framework that is expected to benefit and facilitate the rapid development of computational methods for various SRT-specific analytic tasks, in a similar way as scRNA-seq simulators have benefited the development of scRNA-seq methods and systematic benchmark studies there [<xref ref-type="bibr" rid="CR71">71</xref>–<xref ref-type="bibr" rid="CR74">74</xref>].</p>
    <p id="Par27">While we have primarily focused on using synthetic data from SRTsim to evaluate computational method performance, we note that SRTsim also has the potential to guide experimental design. For example, in the spatial clustering application, we have explored how the accuracy of spatial clustering for different computational methods may change under the influence of sequencing depth and the number of spatial locations measured on the tissue. In that setting, we showed that SRTsim could help us identify the likely optimal sequencing depth and the number of measured locations for detecting spatial domains on the mouse cortex, thus facilitating experimental design for maximizing the effectiveness of spatial transcriptomics.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par28">In conclusion, SRTsim is an effective simulation tool for SRT studies. SRTsim provides scalable, reproducible, and realistic simulations, while preserving expression characteristics and spatial patterns. We have demonstrated the utility of SRTsim in evaluating the performance of spatial clustering methods, spatial expression analysis methods, and cell-cell communication identification methods.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>The SRTsim framework</title>
      <p id="Par29">SRTsim is a general and flexible computational framework for simulating gene expression count data for spatial transcriptomics. SRTsim primarily performs reference-based simulations where the simulated gene expression resembles a reference spatial transcriptomics data supplied by the user. SRTsim can also perform reference-free simulations without using a reference dataset, which will be described in detail later. In the reference-based simulations, SRTsim relies on the reference spatial transcriptomics data to obtain the spatial coordinates of the measured locations, create a new set of tissue locations for a user-specified location number if needed, and simulate expression count data based on the parameters estimated in the reference data. SRTsim provides two simulation options. The first option is a tissue-based simulation, where the expression data are directly simulated on all spatial locations of the entire tissue. The second option is a domain-specific simulation, where the expression data are first simulated on locations within each tissue domain separately before being combined across domains. Like existing scRNA-seq simulators, the gene expression data simulated by SRTsim resembles the gene expression pattern in the reference data based on a wide variety of count characteristics. Unlike existing scRNA-seq simulators, the expression data simulated by SRTsim also preserves the spatial expression pattern of the reference data. The spatial expression pattern is preserved either on the entire tissue for tissue-based simulations or on each specific tissue domain for domain-specific simulations. The reference-based simulations in SRTsim consist of the following three steps:<list list-type="bullet"><list-item><p id="Par30">Step 1. Obtain or create location coordinates in the synthetic data. This is achieved by either directly obtaining the coordinates of the tissue locations measured in the reference data to serve as the locations in the synthetic data, or, if requested by the user, creating new locations in the synthetic data with the number of locations specified by the user. To create new locations, SRTsim first fits the measured locations in the reference data using a concave hull algorithm [<xref ref-type="bibr" rid="CR75">75</xref>] to obtain a list of measured locations that define the outskirt of the tissue in the shape of a polygon. SRTsim then creates a set of new locations within the polygon using two different approaches chosen by the user. In the first approach, SRTsim creates a square grid within the polygon, with the number of the grid points inside the polygon determined by the user. In the second approach, SRTsim uses a random point process to create locations within the polygon using the R function <italic>spsample</italic>, again with the number of locations determined by the user. The first approach mimics the spatial location layout in certain spatial transcriptomics technologies such as 10x Visium while the second approach mimics the spatial location layout in certain spatial transcriptomics technologies such as MERFISH or seqFISH+.</p></list-item></list></p>
      <p id="Par31">Once the coordinates for the locations are obtained or created in the synthetic data, the user can then proceed to perform either tissue-based or domain-specific simulations. For tissue-based simulations, only the location coordinates are needed for the next two steps described below. For domain-specific simulations, SRTsim also requires the user to input the tissue domain labels for the measured locations in the reference data. The input tissue domain labels are either directly used when the locations in the synthetic data are the same as the measured locations in the reference data or are used to extrapolate the tissue domain labels for the newly created locations in the synthetic data. In the latter case, for each new location, SRTsim assigns its domain label based on the domain labels from the <italic>k</italic> (default = 3) nearest measured locations through a Boyer-Moore majority voting algorithm. The domain labels are then used along with the location coordinates in the next two steps for the domain-specific simulations.<list list-type="bullet"><list-item><p id="Par32">Step 2. Infer the gene-specific expression count model based on the reference data and generate the expression counts for each gene in the synthetic data. For tissue-based simulations, SRTsim uses all measured locations on the entire tissue to infer the expression model. For domain-specific simulations, SRTsim uses the measured locations on each tissue domain to infer domain-specific expression models. In either case, SRTsim examines one gene at a time and fits the reference expression count data using four different count models. The four count models include the Poisson model, the zero-inflated Poisson model (ZIP), the negative binomial model (NB), and the zero-inflated negative binomial model (ZINB). After modeling fitting, SRTsim selects the model with the lowest Akaike information criterion (AIC) as the gene-specific count model and uses the estimated model parameters to generate expression counts for the gene of focus in the synthetic data. The expression counts are generated for all locations on the entire tissue in the tissue-based simulations or locations on each tissue domain in turn in the domain-specific simulations.</p></list-item><list-item><p id="Par33">Step 3. Assign the generated gene expression counts to the locations in the synthetic data in a way that preserves the spatial expression pattern of every gene. To preserve the spatial expression pattern, SRTsim first rank orders the locations in the synthetic data for every gene based on its expression level across locations in the reference data. Afterwards, SRTsim assigns the simulated gene expression to the locations in the synthetic data based on the obtained rank order. Specifically, in the setting where the locations in the synthetic data are identical to the locations in the reference data, SRTsim directly ranks the locations in the synthetic data based on the reference and assigns the simulated expression counts to locations in the synthetic data based on the rank. In the setting where new locations are created in the synthetic data, SRTsim first identifies for each new location the <italic>k</italic> (default = 3) nearest neighboring locations measured in the reference data, randomly samples an expression count for the gene of focus from the identified neighbors, assigns the sampled count to the new location, ranks all new locations in the synthetic data based on the assigned reference expression counts, and finally assigns the simulated expression counts to the new locations based on the resulting rank. This way, the spatial expression pattern of the gene of focus in the synthetic data will mimic the spatial expression pattern of the same gene in the reference data, thus preserving the spatial expression pattern. In the tissue-based simulations, the ranking of locations and the assignment of the simulated expression counts are performed for all locations on the entire tissue. In the domain-specific simulations, the ranking of locations and the assignment of the simulated expression counts are performed on each tissue domain in turn.</p></list-item></list></p>
      <p id="Par34">In the reference-based simulations, besides preserving the spatial expression pattern of the gene of focus, SRTsim can also allow the user to redesign the spatial expression pattern of the gene in any target tissue region in the synthetic data by extrapolating the spatial expression pattern of the gene from another tissue region in the reference. To do so, SRTsim first uses a concave hull algorithm to obtain the shape profile for the target region, which consists of a set of measured locations that define the outskirt of the target tissue region in the synthetic data. In addition, SRTsim obtains the shape profile for the reference region, which consists of a set of measured locations that define the outskirt of the reference tissue region. SRTsim then maps the estimated shape profile of the reference region to the shape profile of the target region through the affine transformation [<xref ref-type="bibr" rid="CR76">76</xref>], projects the spatial locations inside the reference region into a new set of projected locations inside the target region using the calculated affine transformation matrix, and directly assigns the reference expression counts of the reference locations to the projected locations. The projected locations then served as the new reference locations for the target region. In particular, for each location in the target region in the synthetic data, SRTsim identifies the <italic>k</italic> (default = 3) nearest neighboring projected locations, randomly samples an expression count for the gene of focus from the identified neighbors, assigns the sampled count to the location of focus, ranks all locations in the target region in the synthetic data based on the assigned projected reference expression counts, and finally assigns the simulated expression counts to locations in the target region based on the resulting rank. This way, the spatial expression pattern of the gene of focus in the target region will mimic the spatial expression pattern of the same gene in the reference region, thus creating potentially new and realistic spatial patterns on the tissue.</p>
      <p id="Par35">Besides reference-based simulations, SRTsim can also perform reference-free simulations without using a reference spatial transcriptomics dataset. To do so, SRTsim allows the user to first create an arbitrary tissue shape in two different ways: the user can either choose from a set of customizable shapes that are constructed based on various circles and squares, or provide a shape profile in the form of a set of location coordinates that define the outskirt of the desired tissue shape. With the defined tissue shape, SRTsim creates spatial locations on the tissue based on a user-specified location number. The spatial locations are then created either through a grid-based approach or a random sampling-based approach, as detailed in Step 1. For domain-specific simulations, the user is also required to assign a tissue domain label for each spatial location and specify a domain-specific fold change parameter that defines the mean expression fold-change for gene expression inside the domain versus that on the entire tissue. SRTsim then simulates the expression count data for one gene at a time on each location based on a user-specified count model. The user has the option to choose one of the four count models described in Step 2 and provide a set of model parameters that include the mean parameter (for all models), the dispersion parameter (for the two over-dispersed models), and the zero-proportion parameter (for the two zero-inflated models). Afterwards, SRTsim allocates the simulated expression counts to locations either randomly across all locations on the entire tissue for tissue-based simulations or randomly across locations within each tissue domain for domain-specific simulations. Note that the genes in the reference-free simulations are restricted to display domain-specific expression patterns but not general spatial expression patterns obtainable in reference-based simulations. Importantly, all reference-free simulations can be carried out in an R shiny framework, which allows the user to easily visualize the simulated spatial transcriptomics data.</p>
      <p id="Par36">For both reference-based and reference-free simulations, the output is an S4 object that mainly contains two matrices for the synthetic data: one matrix contains the spatial coordinates for all tissue locations, along with their domain labels for domain-specific simulations; and the other matrix contains the simulated expression counts for all genes across all locations. The output S4 object also contains all the estimated model parameters and user-defined parameter inputs, which, when paired further with the input random seed, ensure the reproducibility of the synthetic data. After the simulation, user can also compare the synthetic dataset to the corresponding reference dataset using functions implemented in the package.</p>
      <p id="Par37">Both reference-based and reference-free simulation procedures are implemented in an R CRAN package, SRTsim. The R package contains the R shiny app, which can be easily installed and accessed on any local computer. The reference-free simulations in SRTsim can also be carried out through an online shiny app available at <ext-link ext-link-type="uri" xlink:href="https://jiaqiangzhu.shinyapps.io/srtsim">https://jiaqiangzhu.shinyapps.io/srtsim</ext-link>, which is powered by RStudio. The software SRTsim, along with the scripts for reproducing all results in the present study, is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.xzlab.org/software.html">www.xzlab.org/software.html</ext-link>.</p>
    </sec>
    <sec id="Sec12">
      <title>Real data-based simulations and benchmarking</title>
      <p id="Par38">We obtained 49 SRT datasets across eight different spatial transcriptomics platforms (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Among them, 22 datasets are generated with the 10x Visium technique, including 10 obtained from the 10x Visium spatial gene-expression repository on various tissues and 12 obtained from the spatialLIBD study on the human dorsolateral prefrontal cortex [<xref ref-type="bibr" rid="CR17">17</xref>]. Two datasets are generated with the original spatial transcriptomics technique, including one collected on a human breast cancer tissue and the other collected on the mouse olfactory bulb [<xref ref-type="bibr" rid="CR5">5</xref>]. Eleven datasets are generated with DBiT-seq on various tissues [<xref ref-type="bibr" rid="CR9">9</xref>]. Five datasets are generated with MERFISH on various tissues. Five datasets are generated with CosMx SMI on the human NSCLC tissue [<xref ref-type="bibr" rid="CR58">58</xref>]. Two datasets are generated with seqFISH+, including one on the mouse olfactory bulb and the other on the mouse cortex [<xref ref-type="bibr" rid="CR2">2</xref>]. One dataset is generated with STARmap on the mouse visual cortex [<xref ref-type="bibr" rid="CR13">13</xref>]. One dataset is generated with SlideseqV2 on the mouse embryo [<xref ref-type="bibr" rid="CR8">8</xref>]. The number of genes in these datasets ranges from 140 to 25,072, and the number of locations ranges from 251 to 51,649. We used all 45 SRT datasets for reference-based simulations.</p>
      <p id="Par39">We benchmarked SRTsim against eight existing single-cell simulators that include ZINB-WaVE (implemented in Splatter v.1.14.1), SPARSim (v.0.9.5), SymSim (v.0.0.0.9000), two variations of scDesign2 (with/without copula, v.0.1.0), and three variations of Splat in the Splatter package (Splat Simple, Splat, and Kersplat, v1.14.1). These single-cell simulators allow users to perform reference-based simulations with provided single-cell reference data. We supplied each of the 40 SRT datasets one at a time to serve as the reference data and applied these simulators to simulate spatial transcriptomics. We evaluated the performance of different simulators by six metrics that include four gene-specific metrics and two location-specific metrics. The gene-specific metrics measure for each gene how similar the simulated gene expression counts resemble that of the reference data across locations. The four gene-specific metrics include expression mean, variance, coefficient of variation, and the proportion of zero counts. The location-specific metrics measure for each location how similar the simulated gene expression counts resemble that of the reference data across genes. The two location-specific metrics include the proportion of zero counts and the library size. We examined the empirical distribution of each gene-specific metric across genes and the distribution of each location-specific metric across locations. In addition, we examined whether the simulated gene expression counts preserve the spatial expression pattern of the reference gene through visualization. We also examined the computational efficiency of different simulators by recording the computation time and memory usage and examined their stability by recording the number of datasets each simulator failed. For computation time and memory usage, we focused on eight datasets, one from each spatial transcriptomics platform: ST (Rep11_MOB), 10x Visium (LIBD_151673), DBiT (GSM4189615_0719cL), STARmap (visual_1020), seqFISH+ (cortex_svz), CosMx SMI (Lung12_FOV1), MERFISH (HumanOvarianCancerPatient1_FOV1051), and SlideseqV2 (Puck_190926_03). The number of genes in these seven datasets ranges from 550 to 23,124, and the number of locations ranges from 262 to 51,649.</p>
    </sec>
    <sec id="Sec13">
      <title>Evaluating spatial clustering performance based on simulations</title>
      <p id="Par40">We illustrate the benefits of SRTsim for benchmarking spatial domain detection methods using simulations. To do so, we obtained two reference SRT datasets for simulations: a non-single-cell resolution 10x Visium dataset, which has relatively low gene expression counts with the median value of the mean gene-specific expression count across genes being 0.03, and a single-cell resolution STARmap dataset, which has relatively moderate gene expression counts with the median value of the mean gene-specific expression count across genes being 0.38.</p>
      <p id="Par41">The 10x Visium dataset is a human dorsolateral pre-frontal cortex (DLPFC) data obtained from spatialLIBD and has been widely used for benchmarking studies [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR59">59</xref>]. For this dataset, we obtained the sample 151673, with 21,842 genes measured on 3639 locations on the tissue. The majority of these locations (<italic>n</italic>=3611) were clustered by the original study based on cytoarchitecture and gene markers into seven tissue domains that include six dorsolateral prefrontal cortex (DLPFC) layers and the white matter (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). We focused on the locations with known domain annotations and discarded the remaining unannotated locations (<italic>n</italic>=28) for analysis.</p>
      <p id="Par42">The STARmap dataset is a primary visual cortex data, with 1020 measured genes on 930 cells. Following the annotations based on the spatial expression pattern of gene markers in [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR77">77</xref>], we focused on the 673 cortical layer cells in L2-L6 and treated the layer annotations as the ground truth for evaluating the performance of spatial clustering methods.</p>
      <p id="Par43">For either dataset, we performed both tissue-based and domain-specific simulations. In the domain-specific simulations, in addition to directly using the tissue domains from the reference data, we also examined an alternative simulation scenario where we varied the number of tissue domains and their sizes while maintaining their domain-specific spatial gene expression pattern. To do so, we focused on the DLPFC data and grouped the original seven cortical layers into three new layers (NL1, NL2, and NL3; Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). NL1 corresponds to the original layers 1–3 and has a spatial expression pattern extrapolated from the original layer 3. NL2 corresponds to the original layers 4–5 and has a spatial expression pattern extrapolated from the original layer 5. NL3 corresponds to the original layer 6—white matter and has a spatial expression pattern extrapolated from the original WM. We performed ten simulation replicates for each of the five simulation scenarios (2 datasets × 2 types of simulations + 1 alternative simulation with modified domain number and size).</p>
      <p id="Par44">To guide experimental design, we also performed additional domain-specific simulations using the DLPFC data. In particular, we considered three different scenarios, where we examined the influence of three critical experimental parameters on the accuracy of different spatial clustering methods in detecting spatial domains. In scenario I, we examined the influence of overall sequencing depth, where we varied the overall sequencing depth while keeping the number of spatial locations constant. In this scenario, we explored five choices for the overall sequencing depth (8.3, 16.6, 24.9, 33.2, and 49.8 million), representing 50%, 100%, 150%, 200%, and 300% of the observed sequencing depth of the reference data, respectively. In scenario II, we examined the influence of the measured location number, where we varied the number of locations on the tissue but kept the overall sequencing depth constant. In this scenario, we varied the number of spatial locations on the tissue to be 100, 300, 1000, 2000, 3611 (=observed location number in the reference), and 5000. In scenario III, we varied both the number of locations and the overall sequencing depth but kept the average number of reads in each spatial location fixed. In this scenario, we examined all pairs of combinations based on the six location number choices in scenario II and five overall sequencing depth choices in scenario I.</p>
      <p id="Par45">We evaluated the performance of six different spatial clustering methods in detecting spatial domains on the tissue in the synthetic data. The six evaluated methods include the SNN (shared nearest neighbor) implemented in Seurat (v.4.0.1), BayesSpace (v.1.2.0), stLearn with Kmeans, stLearn with Louvain (v.0.3.2), SpaGCN (v.1.0.0), and HMRF (implemented in Giotto, v.1.0.3). For stLearn, its two methods would ignore the spatial location information and perform regular Louvain and Kmeans clustering, as the synthetic data do not contain corresponding histological images. For Seurat and Louvain, we examined a range of resolution values and chose the one value that leads to the number of clusters closest to the truth. For SpaGCN, we also included the results with the cluster refinement (refined-SpaGCN) in the DLPFC-based simulation, which utilizes the array coordinates on top of the pixel coordinates information. For HMRF, we varied the spatial parameter beta (from 0 to 100, with an increment of 5) and only reported the results for the beta value that achieves the highest performance in the fitted data—because of this, the results from HMRF may represent model over-fitting and may over-state its performance. BayesSpace is developed specifically for ST/Visium platforms, where the neighborhood structures are well-defined in either square or hexagonal arrangements. Therefore, when applied to the STARmap data, where the spatial locations are randomly distributed, BayesSpace can only perform regular mclust-based clustering. Following [<xref ref-type="bibr" rid="CR17">17</xref>], we measured spatial clustering performance using the adjusted Rand index (ARI) [<xref ref-type="bibr" rid="CR78">78</xref>, <xref ref-type="bibr" rid="CR79">79</xref>], which quantifies the similarity between the inferred spatial cluster labels and the ground truth. For each method, we used ten different random seeds to account for algorithmic variability in each simulation replicate and obtained ten ARI values per replicate.</p>
    </sec>
    <sec id="Sec14">
      <title>Evaluating spatial expression analysis with simulations</title>
      <p id="Par46">We also illustrate the benefits of SRTsim for benchmarking spatial expression analysis methods using simulations. To do so, we performed similar reference-based simulations using the two reference datasets (DLPFC and STARmap). For each reference data, we considered two simulation settings: a null setting where we simulated 1000 non-SE genes with random spatial expression patterns and an alternative setting where we simulated 100 SE genes that display spatial expression patterns along with 900 non-SE genes with random spatial expression patterns. Here, we used a negative binomial model to simulate the expression counts for both SE and non-SE genes, following the recommendations of [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR57">57</xref>] for spatial expression analysis. In the model, we set the dispersion parameter for all genes to be the global dispersion parameter estimated in the corresponding data (0.3 for DLPFC and 0.35 for STARmap). We set the mean parameter for the non-SE genes as the median of the mean gene-specific expression level across genes in the corresponding data (0.03 for DLPFC and 0.4 for STARmap). In addition, we set the mean parameter for the SE genes differently in each tissue domain to create different simulation scenarios. Specifically, for 10x Visium-based simulations, we considered seven simulation scenarios, each representing a layer-specific expression pattern for one of the seven cortical layers. In each scenario, we set the mean parameter for locations outside the layer of focus to be 0.03 and set the mean parameter for locations inside the layer to be either 5 or 10 times higher than (for 50 SE genes) or 1/5 or 1/10 of (for 50 SE genes) that for the locations outside the layer, representing low (5 or 1/5) or high (10 or 1/10) SE signal strength, respectively. For STARmap-based simulations, we considered five simulation scenarios, each representing a layer-specific expression pattern for one of the five cortical layers (L2–L6). In each scenario, we set the mean parameter for locations outside the layer of focus to be 0.4 and set the mean parameter for locations inside the layer to be either 3 or 4 times higher than (for 50 SE genes) or 1/3 or 1/4 of (for 50 SE genes) that for the locations outside the layer, representing low (3 or 1/3) or high (4 or 1/4) SE signal strength, respectively. Note that the SE strength in the STARmap-based simulations is lower than that in the DLPFC-based simulations—this is because the expression levels are lower in DLPFC, and thus strong SE strengths are needed for all methods to have sufficient power there.</p>
      <p id="Par47">We evaluated the performance of four SE methods for identifying genes with spatial expression patterns. The four SE methods include SPARK (v.1.1.1), which relies on an over-dispersed Poisson model; SPARK-G, which relies on Gaussian approximation to SPARK; SPARK-X, which uses a non-parametric test; and SpatialDE (v.1.1.3), which relies on a linear mixed model. The first three methods are implemented in the R package SPARK while the last method is implemented in the SpatialDE python package. Besides these four methods, we also explored three other SE methods that include trendsceek [<xref ref-type="bibr" rid="CR28">28</xref>], BOOST-GP [<xref ref-type="bibr" rid="CR80">80</xref>], and SOMDE [<xref ref-type="bibr" rid="CR26">26</xref>]. However, both trendsceek and BOOST-GP incurred a heavy computational burden and were not applicable to the synthetic data: it took trendsceek (v.1.0.0) 10 h and BOOST-GP 8 h to analyze even one synthetic data with 1000 genes and 673 locations, which were 24,000 and 17,700 times slower than SPARK-X, respectively. In addition, SOMDE (v.0.1.8) failed to run in approximately 90% of the genes and produced NA values. Therefore, we did not include these three SE methods for comparison.</p>
    </sec>
    <sec id="Sec15">
      <title>Evaluating method performance in identifying cell-cell communications based on simulations</title>
      <p id="Par48">We illustrate the benefits of SRTsim for benchmarking cell-cell communication methods using simulations. We focus on two commonly used cell-cell communication methods for spatial transcriptomics that include Giotto (v1.0.3) and CellphoneDBv3, both examining the expression of ligand-receptor gene pairs to identify pairs that are used for communication between interacting cells from two cell types. We performed simulations to evaluate and compare the performance of these methods.</p>
      <p id="Par49">Specifically, we used the single-cell resolution STARmap dataset to serve as the tissue shape to generate gene expression on the tissue. To do so, we first estimated the shape profile based on the spatial locations of the reference data and randomly generated 5000 locations within the estimated shape profile to serve as the single-cell locations. We assumed that these single cells belong to four different cell types and we created four equal-sized regions on the tissue with distinct cell type composition in each region. In particular, we set the cell types with the highest to lowest proportions to be cell type 1, 2, 3, and 4 in the first spatial region; to be 2, 3, 4, 1 in the second spatial region; to be 3, 4, 1, 2 in the third spatial region; and to be 4, 1, 2, 3 in the fourth spatial region. We then considered four cell-type composition scenarios in the simulations. In the first scenario, each layer contains one dominant cell type, with 70% of the cells belonging to the dominant cell type and 10% of the cells belonging to each of the three minor cell types. In the second scenario, each layer contains two dominant cell types with equal proportions, each consisting of 45% of the cells, along with two minor cell types each consisting of 5% of the cells. In the third scenario, each layer contains two major cell types with unequal proportion, with one consisting of 60% of the cells and the other consisting of 30% of the cells, along with two minor cell types each consisting of 5% of the cells. In the fourth scenario, each layer contains three major cell types and one minor cell type, consisting of 35%, 30%, 30%, or 5% of the cells, respectively. In each scenario, we randomly assigned each single cell in each region to one of the four cell types based on a multinomial distribution with parameters set to be the cell type composition in the region. We performed 10 simulation replicates for each simulation scenario.</p>
      <p id="Par50">In each simulation replicate, we first simulated the expression level of 5000 genes for each single cell in two different ways. In the first way, we simulated homogeneous gene expression by generating expression level for each gene for a total of 8000 cells from a common negative binomial distribution, with parameters inferred based on all cells in the reference data. We then randomly assigned these cells into four cell types, with 2000 cells for each cell type. In the second way, we simulated heterogeneous gene expression by randomly selecting four cell types in the STARmap dataset and then generating the expression level of each gene in 2000 cells for each cell type using a cell type-specific negative binomial distribution, where the distribution parameters are estimated based on the particular cell type in the reference data. In either way, we randomly sampled cells from the 2000 cells in each cell type and assigned them to the spatial locations according to the cell type composition described in the above paragraph.</p>
      <p id="Par51">Next, we increased the expression levels for the ligand-receptor pairs that mediate the cell-cell communications. To do so, we obtained 445 ligands and 471 receptors from CellphoneDBv3. These ligands and receptors correspond to 691 unique genes and form 930 ligand-receptor (L-R) gene pairs. For each L-R pair in turn, we randomly assign it to a pair of cell types (A-B), in order to create the scenario that cell type A communicate with cell type B through the ligand on cell type A and the receptor on cell type B. We denote such interaction as L-R-A-B pair. For four cell types, we obtained a total of 16 combinations of (ordered) cell type pairs, with the number of L-R pairs for each cell type pair ranging from 47 to 77 (median=57) in the simulations. With the allocated L-R-A-B pairs, we increased the gene expression for the L and R genes so that the L-R pair on adjacent A-B cell types are higher than that in the other cell types. In particular, for each cell in turn, we first identified its nearest four cells on the tissue and treat them as adjacent cells. If an A cell is adjacent to a B cell, we then increased the expression level of the L gene in the A cell by a fixed fold, with the fold increase set to be either 1 (null), 5, or 10, representing zero, moderate, or high level of cell-cell communications.</p>
      <p id="Par52">For each simulated spatial transcriptomics dataset, we evaluated the performance of four cell-cell communication methods to detect interacting L-R-A-B pairs on the tissue. These four methods include (1) Giotto with spatial information; (2) Giotto without spatial information; (3) CellphoneDBv3 with spatial information; and (4) CellphoneDBv3 without spatial information. Each method examines one L-R-A-B pair at a time and tests whether the examined pair is significant. Specifically, for Giotto with spatial information, it calculates the mean of two values: the average ligand expression level of cells in cell type A that interact with cell type B; and the average receptor expression level of cells in cell type B that interact with cell type A. Afterwards, it calculates the proportion of the means in the permutations that are higher or lower than the actual mean. For Giotto without spatial information, it calculates the mean of two values: the average ligand expression level of all cells in cell type A and the average receptor expression level of all cells in cell type B. Afterwards, it calculates the proportion of the means in the permutations that are higher or lower than the observed mean. For CellphoneDBv3 with spatial information, it calculates the mean of the average receptor expression level of cell type A and the average ligand expression level of the cell type B. Afterwards, it calculates the proportion of the means in the permutations that are as high or higher than the actual mean, considering only combinations of cell type pairs that co-exist in a spatial domain. For CellphoneDBv3 without spatial information, it calculates the mean of the average receptor expression level of cell type A and the average ligand expression level of the cell type B. Afterwards, it calculates the proportion of the means in the permutations that are as high or higher than the actual mean, considering all combinations of cell type pairs.</p>
      <p id="Par53">We evaluated the performances of different methods in detecting the L-R-A-B pairs based on the F1 score, which is the harmonic mean of precision and recall, at different adjusted <italic>p</italic>-value thresholds of 0.001, 0.005, 0.01, 0.025, 0.05, or 0.1 [<xref ref-type="bibr" rid="CR81">81</xref>]. While we primarily focused on using F1 score, which is the most commonly used metric in the literature of cell-cell communications [<xref ref-type="bibr" rid="CR81">81</xref>–<xref ref-type="bibr" rid="CR83">83</xref>], we also examined other metrics including precision (TP/TP+FP), recall (TP/TP+FN), and specificity (TN/TN+FP).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2023_2879_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Fig. S1.</bold> An overview of the Shiny-app component of SRTsim for reference-free simulations. <bold>Fig. S2.</bold> Benchmarking SRTsim against eight existing scRNA-seq simulators for generating SRT data based on seven SRT data by 10x Visium. <bold>Fig. S3.</bold> Benchmarking SRTsim against eight existing scRNA-seq simulators for generating SRT data based on eight DLPFC SRT data by 10x Visium. <bold>Fig. S4.</bold> Benchmarking SRTsim against eight existing scRNA-seq simulators for generating SRT data based on six SRT data by DBiT-seq and one SRT data by ST. <bold>Fig. S5.</bold> Benchmarking SRTsim against eight existing scRNA-seq simulators for generating SRT data based on SRT data by single-cell resolution SRT techniques. <bold>Fig. S6.</bold> Scatter plots comparing Moran’s I in the synthetic data generated by different simulators versus that in the reference data. <bold>Fig. S7.</bold> Benchmarking SRTsim against scDesign2 and SymSim for generating SRT data with a different number of locations. <bold>Fig. S8.</bold> Computational cost of different simulators for generating synthetic data based on references from different spatial transcriptomics techniques. <bold>Fig. S9.</bold> Distributions of six metrics and Moran’s I for the simulation based on the reference DLPFC sample 151673. <bold>Fig. S10.</bold> Spatial distributions of the domain assignments by six spatial clustering methods on the synthetic data generated by SRTsim in the tissue-based simulations. <bold>Fig. S11.</bold> Spatial distributions of domain assignments by six spatial clustering methods on the synthetic data generated by SRTsim in the domain-specific simulations. <bold>Fig. S12.</bold> Distributions of six metrics for the simulations based on STARmap data. <bold>Fig. S13.</bold> Spatial distributions of domain assignments by six spatial clustering methods based on the synthetic data generated by SRTsim via the tissue-based simulation. <bold>Fig. S14.</bold> Spatial distributions of domain assignments by six spatial clustering methods based on the synthetic data generated by SRTsim via the domain-specific simulation. <bold>Fig. S15.</bold> The performance of stLearn with Louvain measured by the adjusted Rand index is evaluated under simulations with varying-sequencing-depth (y-axis) and varying-location-number (x-axis). <bold>Fig. S16.</bold> Comparisons between the reference and synthetic data generated by SRTsim. <bold>Fig. S17.</bold> Benchmarking spatial expression analysis methods using synthetic data from SRTsim based on the DLPFC reference. <bold>Fig. S18.</bold> Benchmarking spatial expression analysis methods using synthetic data from SRTsim based on the STARmap reference. <bold>Fig. S19.</bold> Benchmarking cell-cell communication identification methods using synthetic data from SRTsim (precision). <bold>Fig. S20.</bold> Benchmarking cell-cell communication identification methods using synthetic data from SRTsim (recall rate). <bold>Fig. S21.</bold> Benchmarking cell-cell communication identification methods using synthetic data from SRTsim (specificity). <bold>Table S1.</bold> Summary of 49 SRT datasets used in the present study. <bold>Table S5.</bold> Computational stability of all simulators. X represents failure, while – represents success. <bold>Table S6.</bold> Total number of alternatives in SE analysis.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2023_2879_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2: Supplementary Table S2.</bold><italic>P</italic>-values from the Kolmogorov–Smirnov (KS) test for the DFPLC 151673 sample. The KS test is performed for each metrics between the synthetic data and reference data.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2023_2879_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3: Supplementary Table S3.</bold><italic>P</italic>-values from the Kolmogorov–Smirnov (KS) test for the Lung12 FOV1 sample. The KS test is performed for each metrics between the synthetic data and reference data.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2023_2879_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4: Supplementary Table S4.</bold> Number of significance (<italic>P</italic>-value &lt; 0.05) in the Kolmogorov–Smirnov (KS) test across ten replicates for all the data (n=29). Datasets with at least one failure in selected simulators were excluded. The KS test is performed for each metrics between the synthetic data and reference data.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2023_2879_MOESM5_ESM.docx">
            <caption>
              <p><bold>Additional file 5.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Jiaqiang Zhu and Lulu Shang contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par54">Stephanie McClelland and Wenjing She were the primary editors of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par55">The review history is available as Additional file <xref rid="MOESM5" ref-type="media">5</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>XZ conceived the idea and provided funding support. JZ and XZ designed the experiments. JZ and LS conducted the research. JZ, LS, and XZ wrote the manuscript. The authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This study was supported by the National Institutes of Health (NIH) Grants R01GM126553, R01HG011883, and R01GM144960.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All codes, processed data, and analysis results in this paper are publicly available at GitHub [<xref ref-type="bibr" rid="CR84">84</xref>] and Zenodo [<xref ref-type="bibr" rid="CR85">85</xref>]. The source code is released under the GPL-3.0 license. The R package SRTsim is also available at CRAN. The 10x Visium data are available at <ext-link ext-link-type="uri" xlink:href="https://www.10xgenomics.com/resources/datasets">https://www.10xgenomics.com/resources/datasets</ext-link>. The DFPLC data generated with 10x Visium are available at <ext-link ext-link-type="uri" xlink:href="http://spatial.libd.org/spatialLIBD/">http://spatial.libd.org/spatialLIBD/</ext-link>. The ST data are available at <ext-link ext-link-type="uri" xlink:href="https://www.spatialresearch.org/resources-published-datasets/doi-10-1126science-aaf2403/">https://www.spatialresearch.org/resources-published-datasets/doi-10-1126science-aaf2403/</ext-link>. The DBiT-seq data are available at <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE137986">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE137986</ext-link>. The seqFISH+ data are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/CaiGroup/seqFISH-PLUS">https://github.com/CaiGroup/seqFISH-PLUS</ext-link>. The STARmap data are available at <ext-link ext-link-type="uri" xlink:href="https://xzhoulab.github.io/SRTsim/">https://xzhoulab.github.io/SRTsim/</ext-link>.The Slide-seqV2 data are available at the Broad institute’s single-cell repository <ext-link ext-link-type="uri" xlink:href="https://singlecell.broadinstitute.org/single_cell/study/SCP815">https://singlecell.broadinstitute.org/single_cell/study/SCP815</ext-link>. The CosMx SMI data are available at <ext-link ext-link-type="uri" xlink:href="https://nanostring.com/products/cosmx-spatial-molecular-imager/ffpe-dataset/">https://nanostring.com/products/cosmx-spatial-molecular-imager/ffpe-dataset/</ext-link>. The MERFISH data are available at <ext-link ext-link-type="uri" xlink:href="https://vizgen.com/data-release-program/">https://vizgen.com/data-release-program/</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par56">No ethical approval was required for this study. All utilized public data sets were generated by other organizations that obtained ethical approval.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par57">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lubeck</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Coskun</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Zhiyentayev</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ahmad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Single-cell in situ RNA profiling by sequential hybridization</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>360</fpage>
        <lpage>361</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2892</pub-id>
        <?supplied-pmid 24681720?>
        <pub-id pub-id-type="pmid">24681720</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eng</surname>
            <given-names>C-HL</given-names>
          </name>
          <name>
            <surname>Lawson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Dries</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Koulena</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Takei</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH+</article-title>
        <source>Nature.</source>
        <year>2019</year>
        <volume>568</volume>
        <issue>7751</issue>
        <fpage>235</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1049-y</pub-id>
        <?supplied-pmid 30911168?>
        <pub-id pub-id-type="pmid">30911168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Boettiger</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Moffitt</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved, highly multiplexed RNA profiling in single cells</article-title>
        <source>Science.</source>
        <year>2015</year>
        <volume>348</volume>
        <issue>6233</issue>
        <fpage>aaa6090</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa6090</pub-id>
        <?supplied-pmid 25858977?>
        <pub-id pub-id-type="pmid">25858977</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goh</surname>
            <given-names>JJL</given-names>
          </name>
          <name>
            <surname>Chou</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Seow</surname>
            <given-names>WY</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>CPP</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>Y-C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly specific multiplexed RNA imaging in tissues with split-FISH</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>7</issue>
        <fpage>689</fpage>
        <lpage>693</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-0858-0</pub-id>
        <?supplied-pmid 32541852?>
        <pub-id pub-id-type="pmid">32541852</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ståhl</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Salmén</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vickovic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lundmark</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Magnusson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>
        <source>Science.</source>
        <year>2016</year>
        <volume>353</volume>
        <issue>6294</issue>
        <fpage>78</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaf2403</pub-id>
        <?supplied-pmid 27365449?>
        <pub-id pub-id-type="pmid">27365449</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Habern</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Bridging genomics and tissue pathology: 10x genomics explores new frontiers with the visium spatial gene expression solution</article-title>
        <source>Genet Eng Biotechnol News</source>
        <year>2020</year>
        <volume>40</volume>
        <issue>2</issue>
        <fpage>50</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1089/gen.40.02.16</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriques</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Stickels</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Goeva</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vanderburg</surname>
            <given-names>CR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Slide-seq: A scalable technology for measuring genome-wide expression at high spatial resolution</article-title>
        <source>Science.</source>
        <year>2019</year>
        <volume>363</volume>
        <issue>6434</issue>
        <fpage>1463</fpage>
        <lpage>1467</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaw1219</pub-id>
        <?supplied-pmid 30923225?>
        <pub-id pub-id-type="pmid">30923225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stickels</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Di Bella</surname>
            <given-names>DJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly sensitive spatial transcriptomics at near-cellular resolution with Slide-seqV2</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <volume>39</volume>
        <issue>3</issue>
        <fpage>313</fpage>
        <lpage>319</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0739-1</pub-id>
        <?supplied-pmid 33288904?>
        <pub-id pub-id-type="pmid">33288904</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Enninful</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>CC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-spatial-resolution multi-omics sequencing via deterministic barcoding in tissue</article-title>
        <source>Cell.</source>
        <year>2020</year>
        <volume>183</volume>
        <issue>6</issue>
        <fpage>1665</fpage>
        <lpage>1681</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.10.026</pub-id>
        <?supplied-pmid 33188776?>
        <pub-id pub-id-type="pmid">33188776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>C-S</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Si</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>S-R</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>J-E</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microscopic examination of spatial transcriptome using Seq-Scope</article-title>
        <source>Cell.</source>
        <year>2021</year>
        <volume>184</volume>
        <fpage>3559</fpage>
        <lpage>3572</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.05.010</pub-id>
        <?supplied-pmid 34115981?>
        <pub-id pub-id-type="pmid">34115981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Daugharthy</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Scheiman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kalhor</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ferrante</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fluorescent in situ sequencing (FISSEQ) of RNA for gene expression profiling in intact cells and tissues</article-title>
        <source>Nat Protoc</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>442</fpage>
        <lpage>458</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2014.191</pub-id>
        <?supplied-pmid 25675209?>
        <pub-id pub-id-type="pmid">25675209</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mignardi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pacureanu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Svedlund</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Botling</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wählby</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>In situ sequencing for RNA analysis in preserved tissue and cells</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>9</issue>
        <fpage>857</fpage>
        <lpage>860</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2563</pub-id>
        <?supplied-pmid 23852452?>
        <pub-id pub-id-type="pmid">23852452</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Sylwestrak</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Samusik</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Vesuna</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Three-dimensional intact-tissue sequencing of single-cell transcriptional states</article-title>
        <source>Science.</source>
        <year>2018</year>
        <volume>361</volume>
        <issue>6400</issue>
        <fpage>eaat5691</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aat5691</pub-id>
        <?supplied-pmid 29930089?>
        <pub-id pub-id-type="pmid">29930089</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emmert-Buck</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Bonner</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Chuaqui</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Goldstein</surname>
            <given-names>SR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Laser capture microdissection</article-title>
        <source>Science.</source>
        <year>1996</year>
        <volume>274</volume>
        <fpage>998</fpage>
        <lpage>1001</lpage>
        <pub-id pub-id-type="doi">10.1126/science.274.5289.998</pub-id>
        <?supplied-pmid 8875945?>
        <pub-id pub-id-type="pmid">8875945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lovatt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ruble</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dueck</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome in vivo analysis (TIVA) of spatially defined single cells in live tissue</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>2</issue>
        <fpage>190</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2804</pub-id>
        <?supplied-pmid 24412976?>
        <pub-id pub-id-type="pmid">24412976</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>W-T</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Craessaerts</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pavie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Frigerio</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Corthout</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial transcriptomics and in situ sequencing to study Alzheimer’s disease</article-title>
        <source>Cell.</source>
        <year>2020</year>
        <volume>182</volume>
        <issue>4</issue>
        <fpage>976</fpage>
        <lpage>991</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.06.038</pub-id>
        <?supplied-pmid 32702314?>
        <pub-id pub-id-type="pmid">32702314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maynard</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Collado-Torres</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Uytingco</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>SR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome-scale spatial gene expression in the human dorsolateral prefrontal cortex</article-title>
        <source>Nat Neurosci</source>
        <year>2021</year>
        <volume>24</volume>
        <issue>3</issue>
        <fpage>425</fpage>
        <lpage>436</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-020-00787-0</pub-id>
        <?supplied-pmid 33558695?>
        <pub-id pub-id-type="pmid">33558695</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Morriss</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>LaFave</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Del Priore</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial genomics enables multi-modal study of clonal heterogeneity in tissues</article-title>
        <source>Nature.</source>
        <year>2022</year>
        <volume>601</volume>
        <issue>7891</issue>
        <fpage>85</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-04217-4</pub-id>
        <?supplied-pmid 34912115?>
        <pub-id pub-id-type="pmid">34912115</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moncada</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Barkley</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Chiodin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Devlin</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrating microarray-based spatial transcriptomics and single-cell RNA-seq reveals tissue architecture in pancreatic ductal adenocarcinomas</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>38</volume>
        <issue>3</issue>
        <fpage>333</fpage>
        <lpage>342</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0392-8</pub-id>
        <?supplied-pmid 31932730?>
        <pub-id pub-id-type="pmid">31932730</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bogdanoff</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hartoularos</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Woo</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Mowery</surname>
            <given-names>CT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>XYZeq: Spatially resolved single-cell RNA sequencing reveals expression heterogeneity in the tumor microenvironment</article-title>
        <source>Sci Adv</source>
        <year>2021</year>
        <volume>7</volume>
        <issue>17</issue>
        <fpage>eabg4755</fpage>
        <pub-id pub-id-type="doi">10.1126/sciadv.abg4755</pub-id>
        <?supplied-pmid 33883145?>
        <pub-id pub-id-type="pmid">33883145</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Giacomello</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Larsson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fürth</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A spatiotemporal organ-wide gene expression and cell atlas of the developing human heart</article-title>
        <source>Cell.</source>
        <year>2019</year>
        <volume>179</volume>
        <issue>7</issue>
        <fpage>1647</fpage>
        <lpage>1660</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.11.025</pub-id>
        <?supplied-pmid 31835037?>
        <pub-id pub-id-type="pmid">31835037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Biancalani</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Scalia</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Buffoni</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Avasthi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sanger</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning and alignment of spatially resolved single-cell transcriptomes with Tangram</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <issue>11</issue>
        <fpage>1352</fpage>
        <lpage>1362</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01264-7</pub-id>
        <?supplied-pmid 34711971?>
        <pub-id pub-id-type="pmid">34711971</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Moses L, Pachter L. Museum of spatial transcriptomics. Nat Methods. 2022. 10.1038/s41592-022-01409-2 PubMed PMID: 35273392. Epub 20220310.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>SpatialDE: identification of spatially variable genes</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>343</fpage>
        <lpage>346</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4636</pub-id>
        <?supplied-pmid 29553579?>
        <pub-id pub-id-type="pmid">29553579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>SPARK-X: non-parametric modeling enables scalable and robust detection of spatial expression patterns for large spatial transcriptomic studies</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02404-0</pub-id>
        <pub-id pub-id-type="pmid">33397451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Hao M, Hua K, Zhang X. SOMDE: a scalable method for identifying spatially variable genes with self-organizing map. Bioinformatics. 2021. 10.1093/bioinformatics/btab471.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Statistical analysis of spatial expression patterns for spatially resolved transcriptomic studies</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>2</issue>
        <fpage>193</fpage>
        <lpage>200</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0701-7</pub-id>
        <?supplied-pmid 31988518?>
        <pub-id pub-id-type="pmid">31988518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edsgärd</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Johnsson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Identification of spatial expression trends in single-cell gene expression data</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>339</fpage>
        <lpage>342</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4634</pub-id>
        <?supplied-pmid 29553578?>
        <pub-id pub-id-type="pmid">29553578</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Ma Y, Zhou X. Spatially informed cell-type deconvolution for spatial transcriptomics. Nat Biotechnol. 2022. 10.1038/s41587-022-01273-7.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Cable DM, Murray E, Zou LS, Goeva A, Macosko EZ, Chen F, et al. Robust decomposition of cell type mixtures in spatial transcriptomics. Nature Biotechnol. 2022;40(4):517–26.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elosua-Bayes</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nieto</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mereu</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gut</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Heyn</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>SPOTlight: seeded NMF regression to deconvolute spatial transcriptomics spots with single-cell transcriptomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <issue>9</issue>
        <fpage>e50</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkab043</pub-id>
        <?supplied-pmid 33544846?>
        <pub-id pub-id-type="pmid">33544846</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>G-C</given-names>
          </name>
        </person-group>
        <article-title>SpatialDWLS: accurate deconvolution of spatial transcriptomic data</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02362-7</pub-id>
        <pub-id pub-id-type="pmid">33397451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>DSTG: deconvoluting spatial transcriptomics data through graph-based artificial intelligence</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>bbaa414</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbaa414</pub-id>
        <?supplied-pmid 33480403?>
        <pub-id pub-id-type="pmid">33480403</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andersson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bergenstråhle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Asp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bergenstråhle</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jurek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>JF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell and spatial transcriptomics enables probabilistic inference of cell type topography</article-title>
        <source>Commun Biol</source>
        <year>2020</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/s42003-020-01247-y</pub-id>
        <pub-id pub-id-type="pmid">31925316</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Andersen-Nissen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
            <suffix>III</suffix>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell.</source>
        <year>2021</year>
        <volume>184</volume>
        <fpage>3573</fpage>
        <lpage>3587</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
        <?supplied-pmid 34062119?>
        <pub-id pub-id-type="pmid">34062119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Pham D, Tan X, Xu J, Grice LF, Lam PY, Raghubar A, et al. stLearn: integrating spatial location, tissue morphology and gene expression to find cell types, cell-cell interactions and spatial trajectories within undissociated tissues. BioRxiv. 2020:2020.05.31.125658.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dries</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>C-HL</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Giotto: a toolbox for integrative analysis and visualization of spatial expression data</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02286-2</pub-id>
        <pub-id pub-id-type="pmid">33397451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dries</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>G-C</given-names>
          </name>
        </person-group>
        <article-title>Identification of spatially associated subpopulations by combining scRNAseq and sequential fluorescence in situ hybridization data</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>12</issue>
        <fpage>1183</fpage>
        <lpage>1190</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4260</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Coleman</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schroeder</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Irwin</surname>
            <given-names>DJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SpaGCN: Integrating gene expression, spatial location and histology to identify spatial domains and spatially variable genes by graph convolutional network</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <issue>11</issue>
        <fpage>1342</fpage>
        <lpage>1351</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01255-8</pub-id>
        <?supplied-pmid 34711970?>
        <pub-id pub-id-type="pmid">34711970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Shang L, Zhou X. Spatially aware dimension reduction for spatial transcriptomics. Nature Commun. 2022;13(1):7203.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Kleshchevnikov V, Shmatko A, Dann E, Aivazidis A, King HW, Li T, et al. Cell2location maps fine-grained cell types in spatial transcriptomics. Nature Biotechnol. 2022;40(5):661–71.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Thrane</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reynolds</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Meyers</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multimodal analysis of composition and spatial architecture in human squamous cell carcinoma</article-title>
        <source>Cell.</source>
        <year>2020</year>
        <volume>182</volume>
        <issue>2</issue>
        <fpage>497</fpage>
        <lpage>514</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.05.039</pub-id>
        <?supplied-pmid 32579974?>
        <pub-id pub-id-type="pmid">32579974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arnol</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schapiro</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bodenmiller</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Saez-Rodriguez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Modeling cell-cell interactions from spatial molecular data with spatial variance component analysis</article-title>
        <source>Cell Rep</source>
        <year>2019</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>202</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2019.08.077</pub-id>
        <?supplied-pmid 31577949?>
        <pub-id pub-id-type="pmid">31577949</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>BF</given-names>
          </name>
          <name>
            <surname>Bambah-Mukku</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dulac</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Characterizing spatial gene expression heterogeneity in spatially resolved single-cell transcriptomics data with nonuniform cellular densities</article-title>
        <source>Genome Res</source>
        <year>2021</year>
        <volume>31</volume>
        <fpage>1843</fpage>
        <lpage>1855</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.271288.120</pub-id>
        <?supplied-pmid 34035045?>
        <pub-id pub-id-type="pmid">34035045</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Nie</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Inferring spatial and signaling relationships between cells from single cell transcriptomic data</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-15968-5</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tanevski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Flores</surname>
            <given-names>ROR</given-names>
          </name>
          <name>
            <surname>Gabor</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schapiro</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Saez-Rodriguez</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Explainable multiview framework for dissecting spatial relationships from highly multiplexed data</article-title>
        <source>Genome Biol</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>97</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02663-5</pub-id>
        <?supplied-pmid 35422018?>
        <pub-id pub-id-type="pmid">35422018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghazanfar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Patrick</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Z-G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Investigating higher-order interactions in single-cell data with scHOT</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>8</issue>
        <fpage>799</fpage>
        <lpage>806</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-0885-x</pub-id>
        <?supplied-pmid 32661426?>
        <pub-id pub-id-type="pmid">32661426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Identifying signaling genes in spatial single-cell expression data</article-title>
        <source>Bioinformatics.</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>7</issue>
        <fpage>968</fpage>
        <lpage>975</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa769</pub-id>
        <?supplied-pmid 32886099?>
        <pub-id pub-id-type="pmid">32886099</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Perraudeau</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gribkova</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>J-P</given-names>
          </name>
        </person-group>
        <article-title>A general and flexible method for signal extraction from single-cell RNA-seq data</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-02554-5</pub-id>
        <pub-id pub-id-type="pmid">29317637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baruzzo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Patuzzi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Di Camillo</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>SPARSim single cell: a count data simulator for scRNA-seq data</article-title>
        <source>Bioinformatics.</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>1468</fpage>
        <lpage>1475</lpage>
        <?supplied-pmid 31598633?>
        <pub-id pub-id-type="pmid">31598633</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Simulating multiple faceted variability in single cell RNA sequencing</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>WV</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>scDesign2: a transparent simulator that generates high-fidelity single-cell gene expression count data with gene correlations captured</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="pmid">33397451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zappia</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1305-0</pub-id>
        <pub-id pub-id-type="pmid">28077169</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Li B, Zhang W, Guo C, Xu H, Li L, Fang M, et al. Benchmarking spatial and single-cell transcriptomics integration methods for transcript distribution prediction and cell type deconvolution. Nature Methods. 2022;19(6):662–70.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yeong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Joint dimension reduction and clustering analysis of single-cell RNA-seq and spatial transcriptomics data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2022</year>
        <volume>50</volume>
        <issue>12</issue>
        <fpage>e72</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkac219</pub-id>
        <?supplied-pmid 35349708?>
        <pub-id pub-id-type="pmid">35349708</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Droplet scRNA-seq is not zero-inflated</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>38</volume>
        <issue>2</issue>
        <fpage>147</fpage>
        <lpage>150</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0379-5</pub-id>
        <?supplied-pmid 31937974?>
        <pub-id pub-id-type="pmid">31937974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Modeling zero inflation is not necessary for spatial transcriptomics</article-title>
        <source>Genome Biol</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02684-0</pub-id>
        <pub-id pub-id-type="pmid">34980209</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">He S, Bhatt R, Brown C, Brown EA, Buhr DL, Chantranuvatana K, et al. High-plex imaging of RNA and proteins at subcellular resolution in fixed tissue by spatial molecular imaging. Nature Biotechnol. 2022;40(12):1794–806.</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Zhao E, Stone MR, Ren X, Guenthoer J, Smythe KS, Pulliam T, et al. Spatial transcriptomics at subspot resolution with BayesSpace. Nature Biotechnol. 2021;39(11):1375–84.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id>
        <?supplied-pmid 25867923?>
        <pub-id pub-id-type="pmid">25867923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garcia-Alonso</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Handfield</surname>
            <given-names>L-F</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nikolakopoulou</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fernando</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Gardner</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping the temporal and spatial dynamics of the human endometrium in vivo and in vitro</article-title>
        <source>Nat Genet</source>
        <year>2021</year>
        <volume>53</volume>
        <issue>12</issue>
        <fpage>1698</fpage>
        <lpage>1711</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00972-2</pub-id>
        <?supplied-pmid 34857954?>
        <pub-id pub-id-type="pmid">34857954</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Demystifying “drop-outs” in single-cell UMI data</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02096-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mozaffari</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ober</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Heritability estimation and differential analysis of count data with generalized linear mixed models in genomic sequencing studies</article-title>
        <source>Bioinformatics.</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>3</issue>
        <fpage>487</fpage>
        <lpage>496</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty644</pub-id>
        <?supplied-pmid 30020412?>
        <pub-id pub-id-type="pmid">30020412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hood</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tung</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential expression analysis for RNAseq using Poisson mixed models</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>11</issue>
        <fpage>e106</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx204</pub-id>
        <?supplied-pmid 28369632?>
        <pub-id pub-id-type="pmid">28369632</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Foox</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hether</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Danko</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>System-wide transcriptome damage and tissue identity loss in COVID-19 patients</article-title>
        <source>Cell Rep Med</source>
        <year>2022</year>
        <volume>3</volume>
        <issue>2</issue>
        <fpage>100522</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xcrm.2022.100522</pub-id>
        <?supplied-pmid 35233546?>
        <pub-id pub-id-type="pmid">35233546</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yerly</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pich-Bavastro</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Di Domizio</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wyss</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tissot-Renaud</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cangkrama</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated multi-omics reveals cellular and molecular interactions governing the invasive niche of basal cell carcinoma</article-title>
        <source>Nat Commun</source>
        <year>2022</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-32670-w</pub-id>
        <pub-id pub-id-type="pmid">34983933</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pujadas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Beaumont</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Schrode</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Francoeur</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Shroff</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular profiling of coronavirus disease 2019 (COVID-19) autopsies uncovers novel disease mechanisms</article-title>
        <source>Am J Pathol</source>
        <year>2021</year>
        <volume>191</volume>
        <issue>12</issue>
        <fpage>2064</fpage>
        <lpage>2071</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajpath.2021.08.009</pub-id>
        <?supplied-pmid 34506752?>
        <pub-id pub-id-type="pmid">34506752</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Emanuel</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Spatial transcriptome profiling by MERFISH reveals subcellular RNA compartmentalization and cell cycle-dependent gene expression</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2019</year>
        <volume>116</volume>
        <issue>39</issue>
        <fpage>19490</fpage>
        <lpage>19499</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1912459116</pub-id>
        <?supplied-pmid 31501331?>
        <pub-id pub-id-type="pmid">31501331</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nitzan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Karaiskos</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rajewsky</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Gene expression cartography</article-title>
        <source>Nature.</source>
        <year>2019</year>
        <volume>576</volume>
        <issue>7785</issue>
        <fpage>132</fpage>
        <lpage>137</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1773-3</pub-id>
        <?supplied-pmid 31748748?>
        <pub-id pub-id-type="pmid">31748748</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <mixed-citation publication-type="other">Wei R, He S, Bai S, Sei E, Hu M, Thompson A, et al. Spatial charting of single-cell transcriptomes in tissues. Nature Biotechnol. 2022;40(8):1190–9.</mixed-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cats</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hoogduin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1795-z</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tran</surname>
            <given-names>HTN</given-names>
          </name>
          <name>
            <surname>Ang</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Chevrier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>NYS</given-names>
          </name>
          <name>
            <surname>Goh</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A benchmark of batch-effect correction methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1850-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xi</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking computational doublet-detection methods for single-cell RNA sequencing data</article-title>
        <source>Cell Syst</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>176</fpage>
        <lpage>194</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2020.11.008</pub-id>
        <?supplied-pmid 33338399?>
        <pub-id pub-id-type="pmid">33338399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saelens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cannoodt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Todorov</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A comparison of single-cell trajectory inference methods</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>5</issue>
        <fpage>547</fpage>
        <lpage>554</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id>
        <?supplied-pmid 30936559?>
        <pub-id pub-id-type="pmid">30936559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Moreira</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Santos</surname>
            <given-names>MY</given-names>
          </name>
        </person-group>
        <source>Concave hull: A k-nearest neighbours approach for the computation of the region occupied by a set of points</source>
        <year>2007</year>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Weisstein</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <source>Affine transformation</source>
        <year>2004</year>
      </element-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Li </surname>
            <given-names>ZZ</given-names>
          </name>
          <name>
            <surname>Xiang</surname>
          </name>
        </person-group>
        <source>Multi-scale and multi-sample analysis enables accurate cell type clustering and spatial domain detection in spatial transcriptomic studies</source>
        <year>2022</year>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vinh</surname>
            <given-names>NX</given-names>
          </name>
          <name>
            <surname>Epps</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Information theoretic measures for clusterings comparison: Variants, properties, normalization and correction for chance</article-title>
        <source>J Mach Learn Res</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>2837</fpage>
        <lpage>2854</lpage>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <mixed-citation publication-type="other">Li Q, Zhang M, Xie Y, Xiao G. Bayesian modeling of spatial molecular profiling data via Gaussian process. Bioinformatics. 2021. 10.1093/bioinformatics/btab455.</mixed-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>C-Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shyr</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Dysregulated ligand–receptor interactions from single-cell transcriptomics</article-title>
        <source>Bioinformatics.</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>12</issue>
        <fpage>3216</fpage>
        <lpage>3221</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac294</pub-id>
        <?supplied-pmid 35482476?>
        <pub-id pub-id-type="pmid">35482476</pub-id>
      </element-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Ou-Yang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Predicting the impacts of mutations on protein-ligand binding affinity based on molecular dynamics simulations and machine learning methods</article-title>
        <source>Comput Struct Biotechnol J</source>
        <year>2020</year>
        <volume>18</volume>
        <fpage>439</fpage>
        <lpage>454</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csbj.2020.02.007</pub-id>
        <?supplied-pmid 32153730?>
        <pub-id pub-id-type="pmid">32153730</pub-id>
      </element-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A systematic evaluation of the computational tools for ligand-receptor-based cell–cell interaction inference</article-title>
        <source>Brief Funct Genomics</source>
        <year>2022</year>
        <volume>21</volume>
        <issue>5</issue>
        <fpage>339</fpage>
        <lpage>356</lpage>
        <pub-id pub-id-type="doi">10.1093/bfgp/elac019</pub-id>
        <?supplied-pmid 35822343?>
        <pub-id pub-id-type="pmid">35822343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <mixed-citation publication-type="other">Zhu J, Shang L, Zhou X. SRTsim: Spatial pattern preserving simulations for spatially resolved transcriptomics. Github. 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/xzhoulab/SRTsim">https://github.com/xzhoulab/SRTsim</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <mixed-citation publication-type="other">Zhu J, Shang L, Zhou X. SRTsim: Spatial pattern preserving simulations for spatially resolved transcriptomics. Zendo. 2023. 10.5281/zenodo.7592392.</mixed-citation>
    </ref>
  </ref-list>
</back>
