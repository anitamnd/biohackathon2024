<?properties open_access?>
<?subarticle pcbi.1007219.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6938380</article-id>
    <article-id pub-id-type="pmid">31846452</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007219</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-01048</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Prediction</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Prediction</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Social Sciences</subject>
        <subj-group>
          <subject>Economics</subject>
          <subj-group>
            <subject>Labor Economics</subject>
            <subj-group>
              <subject>Employment</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
              <subj-group>
                <subject>Machine Learning Algorithms</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
            <subj-group>
              <subject>Machine Learning Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Artificial Intelligence</subject>
          <subj-group>
            <subject>Machine Learning</subject>
            <subj-group>
              <subject>Machine Learning Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Comparison</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Comparison</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Optimization</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Revisiting the “satisfaction of spatial restraints” approach of MODELLER for protein homology modeling</article-title>
      <alt-title alt-title-type="running-head">Revisiting the MODELLER approach for protein homology modeling</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1757-4193</contrib-id>
        <name>
          <surname>Janson</surname>
          <given-names>Giacomo</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2168-5075</contrib-id>
        <name>
          <surname>Grottesi</surname>
          <given-names>Alessandro</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5129-6065</contrib-id>
        <name>
          <surname>Pietrosanto</surname>
          <given-names>Marco</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ausiello</surname>
          <given-names>Gabriele</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Guarguaglini</surname>
          <given-names>Giulia</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Paiardini</surname>
          <given-names>Alessandro</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Biochemical Sciences “A. Rossi Fanelli”, “Sapienza” University of Rome, Roma, Italy</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Super Computing Applications and Innovation (CINECA), Roma, Italy</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Centre for Molecular Bioinformatics, Department of Biology, University of Rome Tor Vergata, Roma, Italy</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Biology and Biotechnology, Institute of Molecular Biology and Pathology, “Sapienza” University of Rome, Roma, Italy</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>de Groot</surname>
          <given-names>Bert L.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Max Planck Institute for Biophysical Chemistry, GERMANY</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>giacomo.janson@uniroma1.it</email>(GJ); <email>alessandro.paiardini@uniroma1.it</email> (AP)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <volume>15</volume>
    <issue>12</issue>
    <elocation-id>e1007219</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>11</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Janson et al</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Janson et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007219.pdf"/>
    <abstract>
      <p>The most frequently used approach for protein structure prediction is currently homology modeling. The 3D model building phase of this methodology is critical for obtaining an accurate and biologically useful prediction. The most widely employed tool to perform this task is MODELLER. This program implements the “modeling by satisfaction of spatial restraints” strategy and its core algorithm has not been altered significantly since the early 1990s. In this work, we have explored the idea of modifying MODELLER with two effective, yet computationally light strategies to improve its 3D modeling performance. Firstly, we have investigated how the level of accuracy in the estimation of structural variability between a target protein and its templates in the form of <italic>σ</italic> values profoundly influences 3D modeling. We show that the <italic>σ</italic> values produced by MODELLER are on average weakly correlated to the true level of structural divergence between target-template pairs and that increasing this correlation greatly improves the program’s predictions, especially in multiple-template modeling. Secondly, we have inquired into how the incorporation of statistical potential terms (such as the DOPE potential) in the MODELLER’s objective function impacts positively 3D modeling quality by providing a small but consistent improvement in metrics such as GDT-HA and lDDT and a large increase in stereochemical quality. Python modules to harness this second strategy are freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/pymodproject/altmod">https://github.com/pymodproject/altmod</ext-link>. In summary, we show that there is a large room for improving MODELLER in terms of 3D modeling quality and we propose strategies that could be pursued in order to further increase its performance.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Proteins are fundamental biological molecules that carry out countless activities in living beings. Since the function of proteins is dictated by their three-dimensional atomic structures, acquiring structural details of proteins provides deep insights into their function. Currently, the most frequently used computational approach for protein structure prediction is template-based modeling. In this approach, a target protein is modeled using the experimentally-derived structural information of a template protein assumed to have a similar structure to the target. MODELLER is the most frequently used program for template-based 3D model building. Despite its success, its predictions are not always accurate enough to be useful in Biomedical Research. Here, we show that it is possible to greatly increase the performance of MODELLER by modifying two aspects of its algorithm. First, we demonstrate that providing the program with accurate estimations of local target-template structural divergence greatly increases the quality of its predictions. Additionally, we show that modifying MODELLER’s scoring function with statistical potential energetic terms also helps to improve modeling quality. This work will be useful in future research, since it reports practical strategies to improve the performance of this core tool in Structural Bioinformatics.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>Associazione Italiana per la Ricerca sul Cancro (IT)</institution>
        </funding-source>
        <award-id>MFAG 20447</award-id>
        <principal-award-recipient>
          <name>
            <surname>Paiardini</surname>
            <given-names>Alessandro</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>Associazione Italiana per la Ricerca sul Cancro (IT)</institution>
        </funding-source>
        <award-id>MFAG 20447</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1757-4193</contrib-id>
          <name>
            <surname>Janson</surname>
            <given-names>Giacomo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>Associazione Italiana per la Ricerca sul Cancro (IT)</institution>
        </funding-source>
        <award-id>IG Grant 17390</award-id>
        <principal-award-recipient>
          <name>
            <surname>Guarguaglini</surname>
            <given-names>Giulia</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>GJ and AP received support from Associazione Italiana Ricerca sul Cancro (AIRC, <ext-link ext-link-type="uri" xlink:href="https://www.airc.it/">https://www.airc.it/</ext-link>) MFAG 20447 and Progetti Ateneo Sapienza University of Rome (<ext-link ext-link-type="uri" xlink:href="https://www.uniroma1.it">https://www.uniroma1.it</ext-link>). GG received support from Associazione Italiana Ricerca sul Cancro (AIRC, <ext-link ext-link-type="uri" xlink:href="https://www.airc.it/">https://www.airc.it/</ext-link>) IG Grant 17390. AP, AG and GJ acknowledge the CINECA award under the ISCRA initiative, for the availability of high performance computing resources and support (IsC68_altmod). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="4"/>
      <page-count count="23"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2019-12-31</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the manuscript and its Supporting Information files. The data underlying the results presented in the study are also available from <ext-link ext-link-type="uri" xlink:href="https://github.com/pymodproject/altmod/tree/master/data">https://github.com/pymodproject/altmod/tree/master/data</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the manuscript and its Supporting Information files. The data underlying the results presented in the study are also available from <ext-link ext-link-type="uri" xlink:href="https://github.com/pymodproject/altmod/tree/master/data">https://github.com/pymodproject/altmod/tree/master/data</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p><italic>In silico</italic> protein structure prediction constitutes an invaluable tool in Biomedical Research, since it allows to obtain structural information on a large number of proteins currently lacking an experimentally-determined 3D structure [<xref rid="pcbi.1007219.ref001" ref-type="bibr">1</xref>]. Template-based modeling (TBM) is the most frequently employed prediction strategy. In the past years it has been considered as the most accurate one [<xref rid="pcbi.1007219.ref002" ref-type="bibr">2</xref>], but recently it has been shown that template-free strategies have reached comparable levels of performance with protein targets that lack good templates [<xref rid="pcbi.1007219.ref003" ref-type="bibr">3</xref>] (for example, with members of several membrane protein families [<xref rid="pcbi.1007219.ref004" ref-type="bibr">4</xref>]). Despite this fact, TBM methods, thanks to their speed, flexibility and growing template libraries [<xref rid="pcbi.1007219.ref005" ref-type="bibr">5</xref>], currently remain the instrument of choice for many researchers.</p>
    <p>Homology modeling (HM) is a fast and reliable TBM method in which a target protein is modeled by using as a structural template an homologous protein. HM predictions usually consist of three phases. In the first, the sequence of the target is used to search for suitable templates in the PDB [<xref rid="pcbi.1007219.ref006" ref-type="bibr">6</xref>–<xref rid="pcbi.1007219.ref007" ref-type="bibr">7</xref>]. In the second, a sequence alignment between the target and templates is built with the goal of inferring the equivalences between their residues [<xref rid="pcbi.1007219.ref008" ref-type="bibr">8</xref>]. In the final, the information of the templates is used to build a 3D atomic model of the target.</p>
    <p>The overall accuracy of HM has remarkably increased in the last 25 years. While a major factor for this advancement has been the increase of the size of sequence and structural databases [<xref rid="pcbi.1007219.ref005" ref-type="bibr">5</xref>], it has been shown that progress in HM algorithms has also played a key role [<xref rid="pcbi.1007219.ref009" ref-type="bibr">9</xref>]. These improvements have consisted mainly in advances in template searching and alignment building algorithms, while only minor advances have been witnessed in the 3D model building step [<xref rid="pcbi.1007219.ref010" ref-type="bibr">10</xref>]. However, recent breakthroughs in protein structure refinement methods [<xref rid="pcbi.1007219.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1007219.ref012" ref-type="bibr">12</xref>] envisage a large room for improvement in HM which could originate from advances in 3D model building.</p>
    <p>MODELLER [<xref rid="pcbi.1007219.ref013" ref-type="bibr">13</xref>] is the most frequently used program for 3D model building in HM. One of the main reasons of its success has been its accurate [<xref rid="pcbi.1007219.ref014" ref-type="bibr">14</xref>], yet fast algorithm. In MODELLER, the information contained in an input target-template alignment is used to generate a series of homology-derived spatial restraints (HDSRs), acting on the atoms of the 3D protein model. Sigma (“<italic>σ</italic>”) values of homology-derived distance restraints (HDDRs) determine the amount of conformational freedom which the model is allowed to have with respect to its templates. MODELLER uses a statistical “histogram-based” strategy to estimate <italic>σ</italic> values [<xref rid="pcbi.1007219.ref015" ref-type="bibr">15</xref>]. These restraints are incorporated into an objective function which also includes physical energetic terms from CHARMM22 [<xref rid="pcbi.1007219.ref016" ref-type="bibr">16</xref>]. A fast, but effective optimization algorithm based on a combination of conjugate gradients (CG) and molecular dynamics with simulated annealing (MDSA) is then used to identify a model conformation that satisfies as much as possible the HDSRs, while retaining stereochemical realism.</p>
    <p>The core MODELLER algorithm was developed in the early 1990s and it was essentially left unchanged over the years. Despite its importance, there have been relatively few attempts to improve it.</p>
    <p>In 2015, Meier and Söding designed a novel probabilistic framework for building HDDRs [<xref rid="pcbi.1007219.ref010" ref-type="bibr">10</xref>], whose aim was to help MODELLER tolerate alignment errors and to combine the information from multiple templates in a statistically rigorous way. This system increased 3D modeling quality, especially for multiple-template modeling. However, since it is integrated in the HHsuite project [<xref rid="pcbi.1007219.ref017" ref-type="bibr">17</xref>] it can be employed only when the first two phases of HM are carried out by programs of the HHsuite package.</p>
    <p>Researchers from Lee’s group developed a modified version of MODELLER which they have been using in CASP experiments [<xref rid="pcbi.1007219.ref018" ref-type="bibr">18</xref>–<xref rid="pcbi.1007219.ref020" ref-type="bibr">20</xref>]. First, they replaced the MODELLER optimization algorithm with the more thorough conformational space annealing (CSA) method [<xref rid="pcbi.1007219.ref021" ref-type="bibr">21</xref>]. Secondly, they pioneered a new strategy to assign <italic>σ</italic> values to HDDRs relying on machine learning [<xref rid="pcbi.1007219.ref022" ref-type="bibr">22</xref>]. Finally, they included a series of additional terms to the MODELLER objective function, such as terms for the DFIRE [<xref rid="pcbi.1007219.ref023" ref-type="bibr">23</xref>] and DFA [<xref rid="pcbi.1007219.ref024" ref-type="bibr">24</xref>] knowledge-based potentials, for hydrogen bond formation [<xref rid="pcbi.1007219.ref025" ref-type="bibr">25</xref>] and to enforce in models predictions of structural properties. In terms of 3D modeling quality, this system outperformed the original MODELLER [<xref rid="pcbi.1007219.ref020" ref-type="bibr">20</xref>]. Unfortunately, the separated contribution of several of these modifications is not reported and much of this system remains in-house (only the CSA algorithm is publicly available).</p>
    <p>Although these seminal studies have shown that the core MODELLER algorithm has room for improvement, most of its users employ its original version, probably because existing modifications either depend on additional packages to install, or are computationally too expensive (e.g., the CSA algorithm alone was reported to increase computational times by a factor of ~130). Since MODELLER is a core tool in Structural Bioinformatics, it is of paramount importance to investigate in detail the inner working of its algorithm and to develop it further. Here, we have explored two computationally light strategies to improve it in terms of 3D modeling quality.</p>
    <p>Particular attention has been dedicated in understanding how the level of accuracy in the estimation of structural variability between the target and templates expressed as <italic>σ</italic> values influences 3D modeling. Although in this work we have not modified the MODELLER algorithm for <italic>σ</italic> values assignment, we propose strategies that could be likely pursued in the next-future in order to greatly increase the performance of the program. Additionally, we have investigated how the incorporation of statistical potential terms, such as DOPE [<xref rid="pcbi.1007219.ref026" ref-type="bibr">26</xref>], in the program’s objective function is able to impact positively 3D modeling and under certain conditions (for example in single-template modeling) it can be coupled synergistically to the previous strategy.</p>
    <p>To rigorously validate these approaches, we have benchmarked them using protein targets from a diverse set of high-resolution structures from the PDB and we quantified the individual impact on 3D modeling of each modification. This information will be useful in future research, since it shows in which areas there is still room for improvement and in which areas it might be difficult to advance further.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Outline of MODELLER’s homology-derived distance restraints</title>
      <p>The MODELLER approach relies on the generation of HDSRs for interatomic distances and dihedral angles [<xref rid="pcbi.1007219.ref015" ref-type="bibr">15</xref>]. Each HDSR is treated as a probability density function (<italic>pdf</italic>). HDSRs acting on interatomic distances (that is, HDDRs) have a predominant role in determining the 3D structure of a model. The way they are built is summarized here.</p>
      <p>For a couple of atoms <italic>i</italic> and <italic>j</italic> of the model, the program finds in the template the equivalent atoms <italic>k</italic> and <italic>l</italic> which have a distance in space of <italic>d</italic><sub><italic>t</italic></sub>. The distance <italic>d</italic><sub><italic>m</italic></sub> between <italic>i</italic> and <italic>j</italic> is assumed to be normally distributed around <italic>d</italic><sub><italic>t</italic></sub> with a standard deviation <italic>σ</italic> and the <italic>pdf</italic> restraining it is:
<disp-formula id="pcbi.1007219.e001"><alternatives><graphic xlink:href="pcbi.1007219.e001.jpg" id="pcbi.1007219.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>In MODELLER <italic>pdfs</italic> are converted in objective function terms as follows:
<disp-formula id="pcbi.1007219.e002"><alternatives><graphic xlink:href="pcbi.1007219.e002.jpg" id="pcbi.1007219.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives><label>(2)</label></disp-formula>
therefore Gaussian HDDRs correspond to harmonic potential terms. Since HDDRs are considered to be independent, their objective function terms are summed. HDDRs are built for four groups of atoms: the Cα-Cα, backbone NO, side chain-main chain (SCMC) and side chain-side chain (SCSC) groups (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s002">S2 Table</xref></bold>). MODELLER generates its <italic>σ</italic> values (hereinafter named <italic>σ</italic><sub><italic>MOD</italic></sub> values) through an histogram-based approach [<xref rid="pcbi.1007219.ref015" ref-type="bibr">15</xref>].</p>
      <p>MODELLER allows to take advantage of multiple templates, a strategy that (when templates are chosen adequately) usually outperforms single-template modeling [<xref rid="pcbi.1007219.ref027" ref-type="bibr">27</xref>]. When employing <italic>U</italic> templates to restrain a distance <italic>d</italic><sub><italic>m</italic></sub>, MODELLER uses the following <italic>pdf</italic>:
<disp-formula id="pcbi.1007219.e003"><alternatives><graphic xlink:href="pcbi.1007219.e003.jpg" id="pcbi.1007219.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>U</mml:mi></mml:mrow></mml:msubsup></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula>
where <italic>u</italic> is the template index, <italic>w</italic><sub><italic>u</italic></sub> is a template-specific weight, <italic>d</italic><sub><italic>t</italic>,<italic>u</italic></sub> and <italic>σ</italic><sub><italic>u</italic></sub> are the distance observed in template <italic>u</italic> and its <italic>σ</italic> value respectively. In MODELLER, <italic>w</italic><sub><italic>u</italic></sub> is a function of the local sequence similarity between the target and template <italic>u</italic>.</p>
      <p>The total objective function of MODELLER (<italic>F</italic><sub><italic>TOT</italic></sub>) can be expressed as follows:
<disp-formula id="pcbi.1007219.e004"><alternatives><graphic xlink:href="pcbi.1007219.e004.jpg" id="pcbi.1007219.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>O</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>H</mml:mi><mml:mi>Y</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>O</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></alternatives><label>(4)</label></disp-formula>
where <italic>F</italic><sub><italic>PHYS</italic></sub> contains five physical terms (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s001">S1 Table</xref></bold>) and <italic>F</italic><sub><italic>HOM</italic></sub> contains HDSRs terms. In this work, the weights for <italic>F</italic><sub><italic>PHYS</italic></sub> and <italic>F</italic><sub><italic>HOM</italic></sub> were always left to 1.0 (therefore they are omitted from the formula above).</p>
    </sec>
    <sec id="sec004">
      <title>Benchmarking MODELLER modifications with an analysis set</title>
      <p>In order to benchmark modifications of MODELLER, we built an analysis set of selected target proteins. We obtained 926 X-ray structure chains from PISCES [<xref rid="pcbi.1007219.ref028" ref-type="bibr">28</xref>], using the following criteria to filter the PDB:</p>
      <list list-type="bullet">
        <list-item>
          <p>the maximum mutual sequence identity (SeqId) among the chains was 10%;</p>
        </list-item>
        <list-item>
          <p>their structures had a resolution &lt; 2.0 Å and R-factor &lt; 0.25;</p>
        </list-item>
        <list-item>
          <p>they contained no missing residues due to lacking electron density;</p>
        </list-item>
        <list-item>
          <p>their length was between 70 and 700 residues.</p>
        </list-item>
      </list>
      <p>These chains were our target candidates. To obtain their templates, we culled from PISCES another set using similar filters, except that this time the maximum mutual SeqId was 90%. We removed from this larger set all the targets, obtaining 6224 chains. Each target was then aligned to these chains using TM-align [<xref rid="pcbi.1007219.ref029" ref-type="bibr">29</xref>] and we selected as template candidates the chains meeting the following criteria:</p>
      <list list-type="bullet">
        <list-item>
          <p>the SeqId in the structural alignment built by TM-align was between 15% and 95%;</p>
        </list-item>
        <list-item>
          <p>the two TM-scores [<xref rid="pcbi.1007219.ref030" ref-type="bibr">30</xref>] produced by TM-align (each score is normalized by the length of one of the aligned proteins) were at least 0.6, a threshold to consider two proteins as homologous [<xref rid="pcbi.1007219.ref031" ref-type="bibr">31</xref>].</p>
        </list-item>
      </list>
      <p>We retained for each target only its top five templates in terms of TM-score (normalized on the target length). In this way, we obtained a final set of 225 target chains (suitable templates could not be found for 701 targets, a result of using only high-resolution template structures). For each target, we performed single-template modeling only with its top template and therefore we had 225 single-template models, which constituted the Analysis Single-template (AS) set. 118 targets had at least two templates (with an average of 3.3), which constituted the Analysis Multiple-templates (AM) set.</p>
      <p>The average SeqId for the AS target-template alignments is 0.38. Improving the performance of MODELLER with targets having templates with a SeqId &lt; 0.40 is important, because these cases are the most frequent ones in Biomedical Research [<xref rid="pcbi.1007219.ref005" ref-type="bibr">5</xref>] and the accuracy of TBM is often low in this regimen. The well-equilibrated distributions of SeqId, target coverage, target length and of CATH structural classes [<xref rid="pcbi.1007219.ref032" ref-type="bibr">32</xref>] of the analysis set (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s005">S1 Fig</xref></bold>) assure that our results have a general validity.</p>
    </sec>
    <sec id="sec005">
      <title>Alignment building</title>
      <p>In order to align target-template pairs we employed the accurate HHalign program [<xref rid="pcbi.1007219.ref007" ref-type="bibr">7</xref>], which confronts two profile hidden Markov models. To build input profiles for HHalign, we ran HHblits [<xref rid="pcbi.1007219.ref033" ref-type="bibr">33</xref>] with its default parameters and three search iterations against the <italic>uniprot20_2016_02</italic> database. After employing HHalign to align pairs of target-template profiles, we extracted from the program’s output their pairwise alignments. Multiple target-templates alignments were obtained by joining pairwise alignments.</p>
      <p>Whenever specified, we also employed target-template alignments built with TM-align in order to assess the effect on 3D modeling of HDDRs derived from error-free structural alignments.</p>
    </sec>
    <sec id="sec006">
      <title>3D model building and evaluation</title>
      <p>For all benchmarks we used MODELLER version 9.21. In order to modify its objective function terms and optimization schedules we interfaced with its Python API. To modify the restraints parameters we employed Python scripts to edit the default restraints files generated by the program (see the “Restraints files building” section).</p>
      <p>In MODELLER, the final quality of a model is largely determined in the MDSA phase. In this work, unless otherwise stated, we employed the default <italic>very_fast</italic> MDSA protocol of the program (corresponding to a 5.4 ps run). When specified, we also employed the more thorough <italic>slow</italic> protocol (corresponding to a 18.4 ps run). The CG protocol was always left to its default parameters.</p>
      <p>The approach used to evaluate the quality of an homology model was to build 16 different copies of it (hereinafter defined as decoys), and to report as an overall quality score (see below) the average score of the 16 decoys.</p>
      <p>To evaluate the quality of the backbones we used the GDT-HA metric [<xref rid="pcbi.1007219.ref009" ref-type="bibr">9</xref>] computed by the TM-score program. In order to evaluate the quality of local structures and side chains, we used the lDDT metric [<xref rid="pcbi.1007219.ref034" ref-type="bibr">34</xref>], computed by the lDDT program. Detailed descriptions of these two metrics are given in <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s010">S1 Text</xref></bold>. To evaluate the stereochemical quality of models we employed MolProbity scores computed by the MolProbity suite [<xref rid="pcbi.1007219.ref035" ref-type="bibr">35</xref>]. A MolProbity score expresses the global stereochemical quality of a 3D model. The lower it is, the higher is the quality of the model.</p>
    </sec>
    <sec id="sec007">
      <title>Optimal <italic>σ</italic> values for homology-derived distance restraints</title>
      <p><italic>σ</italic> values of HDDRs have a fundamental role in MODELLER. A natural question is: given a target-template alignment, what is the set of <italic>σ</italic> values which will maximize 3D modeling accuracy? The concept of optimal <italic>σ</italic> values in single-template modeling was addressed for the first time by the Lee group [<xref rid="pcbi.1007219.ref022" ref-type="bibr">22</xref>]. They reported that for a Gaussian HDDR acting on a distance <italic>d</italic><sub><italic>m</italic></sub> between atoms <italic>i</italic> and <italic>j</italic> in a 3D model, the optimal <italic>σ</italic> value is:
<disp-formula id="pcbi.1007219.e005"><alternatives><graphic xlink:href="pcbi.1007219.e005.jpg" id="pcbi.1007219.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives><label>(5)</label></disp-formula>
where <italic>d</italic><sub><italic>t</italic></sub> is the distance between the template atoms equivalent to <italic>i</italic> and <italic>j</italic> and <italic>d</italic><sub><italic>n</italic></sub> is the distance between <italic>i</italic> and <italic>j</italic> observed in the experimentally-determined native target structure. We show that the use of <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values for Gaussian HDDRs is supported by theory, as it can be analytically proven that they maximize the likelihood of obtaining a model in which each restrained <italic>d</italic><sub><italic>m</italic></sub> is equal to its corresponding <italic>d</italic><sub><italic>n</italic></sub> (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s011">S2 Text</xref></bold>).</p>
      <p>In the case of multiple-template HDDRs, we demonstrate that the combination of optimal <italic>σ</italic> values and weights can be found again analytically (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s012">S3 Text</xref></bold>). In this situation, the optimal <italic>σ</italic> values are again <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values. The associated template weighting scheme assigns a weight of 0 to all templates with the exception of the template with the lowest <italic>σ</italic>, which should have a weight of 1. We termed this scheme as the “only-lowest” (OL) scheme. Note that the OL scheme is an extreme case of the weighting scheme proposed in [<xref rid="pcbi.1007219.ref036" ref-type="bibr">36</xref>] (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s012">S3 Text</xref></bold>).</p>
      <p>Whenever using <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values as <italic>σ</italic> parameters, we had to modify them by setting their minimum value at 0.05 Å. Raw <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values are extracted directly from pairs of homologous protein structures and they are often close to 0 Å (see <bold><xref ref-type="fig" rid="pcbi.1007219.g001">Fig 1A</xref></bold>). In MODELLER, HDDRs having very small <italic>σ</italic> values will seldom be satisfied because their quadratic objective function terms will penalize enormously even minimal deviations from templates. In fact, using unmodified <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values often leads to modeling failures, since the total objective function of models surpasses the allowed limit of MODELLER, stopping the model building process. Setting a lower limit to their value, allows their use in 3D modeling.</p>
      <fig id="pcbi.1007219.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007219.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Distribution of <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> and <italic>σ</italic><sub><italic>MOD</italic></sub> values.</title>
          <p>Distributions of the <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> (A) and <italic>σ</italic><sub><italic>MOD</italic></sub> (B) values observed in the AS models for the four HDDR groups of MODELLER. Beside the names of the restraints groups, their mean values are reported.</p>
        </caption>
        <graphic xlink:href="pcbi.1007219.g001"/>
      </fig>
    </sec>
    <sec id="sec008">
      <title>Restraints file building</title>
      <p>In MODELLER, the restraints used in the 3D model building phase are supplied in a specific file. In this work, we explored how the choice of parameters for the HDDRs influences 3D modeling. Therefore, our approach for building restraints files was to let MODELLER generate its default restraints files and then to modify it by leaving unaltered all the stereochemical and homology-derived dihedral angle restraints and by modifying only the HDDRs parameters. The Python code we used to customize restraints files is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/pymodproject/altmod">https://github.com/pymodproject/altmod</ext-link>. This code allows to modify the list of HDDRs of a model by supplying a list of user-specified parameters for them. Users may specify both the location and scale parameters of the Gaussian HDDRs, see Eq (<xref ref-type="disp-formula" rid="pcbi.1007219.e001">1</xref>). Additionally, we provide code for running MODELLER with optimal HDDRs, which can be employed whenever users can supply a native structure file for the target protein.</p>
    </sec>
    <sec id="sec009">
      <title>Perturbing optimal <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values</title>
      <p>To understand the effect of using error-containing <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> estimations on 3D modeling, we randomly perturbed the <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values of target-template pairs. Our aim was to simulate a series of <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> estimators having different performances in terms of the Pearson correlation coefficient (PCC) between the perturbed values and their unperturbed counterparts. To perturb a <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> list of a target-template pair in order to reach a selected PCC (referred to as <italic>PCC</italic><sub><italic>SEL</italic></sub>), we added to the <italic>Δd</italic><sub><italic>n</italic></sub> values of the pair a list <italic>ε</italic> of errors in order to obtain a list <italic>p</italic> of perturbed values, whose elements are:
<disp-formula id="pcbi.1007219.e006"><alternatives><graphic xlink:href="pcbi.1007219.e006.jpg" id="pcbi.1007219.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives><label>(6)</label></disp-formula>
where <italic>p</italic><sub><italic>i</italic></sub> is the <italic>i</italic>-th perturbed value and <italic>ε</italic><sub><italic>i</italic></sub> is a random error extracted from a Laplace distribution with location 0 and scale parameter <italic>b</italic>. We chose Laplace distributions since adding errors extracted from them results in <italic>p</italic><sub><italic>i</italic></sub> values being distributed approximately as exponentials, which resemble the original <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> distributions (see <bold><xref ref-type="fig" rid="pcbi.1007219.g001">Fig 1A</xref></bold> and also <bold>Fig F</bold> in <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s006">S2 Fig</xref></bold>). To obtain the desired <italic>PCC</italic><sub><italic>SEL</italic></sub>, a <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> list was perturbed in 5000 trials by drawing <italic>ε</italic> from Laplace distributions with different <italic>b</italic> values and in each trial the PCCs between <italic>p</italic> and the original <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> list was computed (<italic>b</italic> was linearly increased from 0.005*<italic>m</italic><sub><italic>obs</italic></sub> to 25.0*<italic>m</italic><sub><italic>obs</italic></sub>, where <italic>m</italic><sub><italic>obs</italic></sub> is the mean of the <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> list). At the end of these trials, the <italic>p</italic> list having the observed PCC as close as possible to <italic>PCC</italic><sub><italic>SEL</italic></sub> was selected. The <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values of each HDDR group (that is, the Cα-Cα, NO, SCMC and SCSC groups) were perturbed independently. This heuristic procedure usually selects PCCs being not more than 0.003 units away from <italic>PCC</italic><sub><italic>SEL</italic></sub> (thus giving practically the same level of perturbation of <italic>PCC</italic><sub><italic>SEL</italic></sub>). Note that larger <italic>b</italic> values result in larger amounts of noise (and in lower PCCs), but they also increase the mean of <italic>p</italic> lists far beyond the typical values observed for <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> data. Therefore, the <italic>p</italic> lists of the four HDDR groups were always scaled so that their mean (referred to as <italic>m</italic><sub><italic>pt</italic></sub>) would be equal to:
<disp-formula id="pcbi.1007219.e007"><alternatives><graphic xlink:href="pcbi.1007219.e007.jpg" id="pcbi.1007219.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></alternatives><label>(7)</label></disp-formula>
where <italic>m</italic><sub><italic>grp</italic></sub> is the mean <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> value observed in all our AS models for HDDR group <italic>grp</italic> (see <bold><xref ref-type="fig" rid="pcbi.1007219.g001">Fig 1A</xref></bold>). In this way, if <italic>PCC</italic><sub><italic>SEL</italic></sub> is near 1, the mean of a <italic>p</italic> list tends to the mean of the unperturbed <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> list, while if <italic>PCC</italic><sub><italic>SEL</italic></sub> is near 0, its mean tends to the “global” mean observed for the corresponding group in our whole <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> data sets. This whole perturbation scheme has three important characteristics. (i) Adding noise to every <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> value of a target-template pair allows us to properly simulate the effect of a real-life <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> estimator in which every estimation would have some uncertainty. (ii) Since 3D modeling quality tends to decrease when the average <italic>σ</italic> value of a model increases (see <xref ref-type="fig" rid="pcbi.1007219.g002"><bold>Fig 2A</bold> and <bold>2B</bold></xref>), the scaling procedure ensures that when employing highly perturbed <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> lists, alterations in the quality of 3D models will not be caused by just unrealistically increasing their mean <italic>σ</italic>. (iii) The choice of Laplace distributions as error-generators ensures that alterations in quality will not be caused by drastically changing the shape of the perturbed values distributions with respect to the observed <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> ones. An example of the effects of this perturbation scheme are found in <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s006">S2 Fig</xref></bold> (while the code that implements it is available in our Git repository, see above).</p>
      <fig id="pcbi.1007219.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007219.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Modeling with uniform <italic>σ</italic> values.</title>
          <p>Average GDT-HA (A) and lDDT (B) scores of the AS models as a function of the uniform <italic>σ</italic> value (ranging from 0.01 to 7.0 Å) applied to their HDDRs. The horizontal dashed lines represent the average scores obtained with the original <italic>σ</italic><sub><italic>MOD</italic></sub> values.</p>
        </caption>
        <graphic xlink:href="pcbi.1007219.g002"/>
      </fig>
      <p>To simulate various levels of accuracy in <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> estimation, we used 10 <italic>PCC</italic><sub><italic>SEL</italic></sub> values (linearly spacing from 0.0 to 0.9). For each <italic>PCC</italic><sub><italic>SEL</italic></sub>, we generated 5 sets of perturbed <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values per target-template pair, which allowed to better sample the effect of perturbations. For each perturbed set, we built 8 decoys per target with MODELLER (resulting in a total of 5*8 = 40 decoys per target for each <italic>PCC</italic><sub><italic>SEL</italic></sub> value). For a certain <italic>PCC</italic><sub><italic>SEL</italic></sub> value, the quality score for a 3D model was recorded as the average score of all its 40 decoys.</p>
      <p>To quantify in terms of PCC the actual amount of perturbation introduced in the <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values of a single model, we used a score defined as <italic>PCC</italic><sub><italic>MODEL</italic></sub>. This score is computed as:
<disp-formula id="pcbi.1007219.e008"><alternatives><graphic xlink:href="pcbi.1007219.e008.jpg" id="pcbi.1007219.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>O</mml:mi><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>U</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>U</mml:mi></mml:mrow></mml:msubsup></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(8)</label></disp-formula>
where <italic>n</italic><sub><italic>R</italic></sub> is the number of perturbed <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> sets (in our case 5), <italic>r</italic> is the index for these sets, <italic>U</italic> is the number of templates of the model and <italic>PCC</italic><sub><italic>u</italic>,<italic>r</italic></sub> indicates the observed PCC between the list of <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values associated with the <italic>u</italic>-th template and the corresponding list of perturbed values in set <italic>r</italic>. For each HDDR group, the relationship between <italic>PCC</italic><sub><italic>SEL</italic></sub> values and the average <italic>PCC</italic><sub><italic>MODEL</italic></sub> observed in the AS and AM sets is almost perfectly linear (see <bold>Fig G</bold> and <bold>H</bold> in <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s006">S2 Fig</xref></bold>), confirming the efficacy of the perturbation scheme.</p>
    </sec>
    <sec id="sec010">
      <title>Inclusion of statistical potential terms in the objective function of MODELLER</title>
      <p>In this work, we explored the effect of including in the objective function of MODELLER terms for interatomic distance statistical potentials. These potentials are developed with the aim of recognizing native-like protein conformations [<xref rid="pcbi.1007219.ref037" ref-type="bibr">37</xref>], therefore their use could help MODELLER to approach these conformations [<xref rid="pcbi.1007219.ref038" ref-type="bibr">38</xref>].</p>
      <p>We employed the DOPE potential [<xref rid="pcbi.1007219.ref026" ref-type="bibr">26</xref>], which is integrated in the MODELLER package where it is commonly used to evaluate qualities of 3D models. DOPE is an “all atom” potential. Its 12561 terms are approximated with interpolating cubic splines, which can be differentiated analytically and used in the gradient-based optimization algorithm of the program.</p>
      <p>The Lee group previously included the DFIRE [<xref rid="pcbi.1007219.ref023" ref-type="bibr">23</xref>] potential in the MODELLER objective function [<xref rid="pcbi.1007219.ref018" ref-type="bibr">18</xref>]. To compare their performances in 3D model building, we also integrated DFIRE in MODELLER (DFIRE parameters were obtained from its source code).</p>
      <p>When including statistical potential terms, the MODELLER objective function becomes:
<disp-formula id="pcbi.1007219.e009"><alternatives><graphic xlink:href="pcbi.1007219.e009.jpg" id="pcbi.1007219.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>O</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>H</mml:mi><mml:mi>Y</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>O</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></alternatives><label>(9)</label></disp-formula>
where <italic>F</italic><sub><italic>SP</italic></sub> contains the statistical potentials terms and <italic>w</italic><sub><italic>SP</italic></sub> is their weight. For obtaining best 3D modeling results, we tested several values of <italic>w</italic><sub><italic>SP</italic></sub>.</p>
      <p>We employed statistical potentials using a contact shell value of 8.0 Å. Higher values can be safely avoided because the terms of DOPE and DFIRE start to acquire a flat shape over the 8.0 Å threshold (see <bold>Fig A</bold> in <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s007">S3 Fig</xref></bold>). The code we used to employ these potentials in MODELLER is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/pymodproject/altmod">https://github.com/pymodproject/altmod</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec011">
    <title>Results</title>
    <sec id="sec012">
      <title>Effects of optimal <italic>σ</italic> values on 3D modeling</title>
      <sec id="sec013">
        <title>Effects on single-template modeling</title>
        <p>Gaussian HDDRs are the heart of the MODELLER approach. At first, we explored how the use of optimal <italic>σ</italic> values (that is, <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values) influences single-template modeling. The Lee group already reported it to bring significant improvements for a small number of proteins. Here, we extended the analysis to a larger set to derive general conclusions. As shown in <bold><xref rid="pcbi.1007219.t001" ref-type="table">Table 1</xref></bold>, employing restraints bearing <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values greatly increases 3D modeling accuracy. In terms of global Cα backbone quality, the average GDT-HA score of the AS models increases by 6.0% with respect to the score obtained with <italic>σ</italic><sub><italic>MOD</italic></sub> values. An improvement is also observed for local all-atom quality, as the average lDDT score increases by 4.2%. Increments in GDT-HA and lDDT are seen for 224/225 and 225/225 AS models respectively (see <xref ref-type="fig" rid="pcbi.1007219.g003"><bold>Fig 3A</bold> and <bold>3B</bold></xref>).</p>
        <fig id="pcbi.1007219.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007219.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>The use of optimal parameters for HDDRs improves 3D modeling quality.</title>
            <p>(A) and (B) GDT-HA and lDDT scores of the AS models built with <italic>σ</italic><sub><italic>MOD</italic></sub> (reported on the x-axis) and with optimal <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> (y-axis) values. (C) and (D) GDT-HA and lDDT scores for the AM models obtained with MODELLER-generated (x-axis) and optimal (y-axis) HDDRs.</p>
          </caption>
          <graphic xlink:href="pcbi.1007219.g003"/>
        </fig>
        <table-wrap id="pcbi.1007219.t001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007219.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>3D modeling qualities of the AS single-template models built with optimal HDDRs and alignments.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi.1007219.t001g" xlink:href="pcbi.1007219.t001"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="justify" rowspan="1" colspan="1">Strategy</th>
                  <th align="justify" rowspan="1" colspan="1">GDT-HA</th>
                  <th align="justify" rowspan="1" colspan="1">lDDT</th>
                  <th align="justify" rowspan="1" colspan="1">MolProbity score</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER<xref ref-type="table-fn" rid="t001fn002"><sup>a</sup></xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6014 (-)</td>
                  <td align="left" rowspan="1" colspan="1">0.6563 (-)</td>
                  <td align="left" rowspan="1" colspan="1">3.0104 (-)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL<xref ref-type="table-fn" rid="t001fn003"><sup>b</sup></xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6377 (+6.0%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6842 (+4.2%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.0311 (+0.7%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER-SLOW<xref ref-type="table-fn" rid="t001fn004"><sup>c</sup></xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6036 (+0.4%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6594 (+0.5%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">2.8512 (-5.3%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL-SLOW</td>
                  <td align="left" rowspan="1" colspan="1">0.6377 (+6.0%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6853 (+4.4%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">2.9039 (-3.5%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER-TMalign<xref ref-type="table-fn" rid="t001fn005"><sup>d</sup></xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6383 (+6.1%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6951 (+5.9%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.0411 (+1.0%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL-TMalign</td>
                  <td align="left" rowspan="1" colspan="1">0.6805 (+13.2%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.7259 (+10.6%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.0870 (+2.5%)<xref ref-type="table-fn" rid="t001fn006">*</xref></td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="t001fn001">
              <p>The “GDT-HA”, “lDDT” and “MolProbity score” columns report the average values for those metrics. Percent improvements are computed with respect to the scores of the default MODELLER (first row).</p>
            </fn>
            <fn id="t001fn002">
              <p><sup>a</sup>The “MODELLER” prefix indicates that the strategy employs HDDRs generated by MODELLER.</p>
            </fn>
            <fn id="t001fn003">
              <p><sup>b</sup>The “OPTIMAL” prefix indicates the use of optimal HDDRs.</p>
            </fn>
            <fn id="t001fn004">
              <p><sup>c</sup>The “SLOW” suffix indicates the use of the <italic>slow</italic> MDSA protocol instead of the default <italic>very_fast</italic> one.</p>
            </fn>
            <fn id="t001fn005">
              <p><sup>d</sup>The “TMalign” prefix indicates the use of target-template alignment built through TM-align.</p>
            </fn>
            <fn id="t001fn006">
              <p>*Asterisks denote a statistically significant difference (according to a Wilcoxon signed-rank test with a significance level of 0.05) between the scores of a strategy and the scores of the default MODELLER. See <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s003">S3 Table</xref></bold> for a full list of the numerical p-values.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>Increasing target-template alignment quality is one of the current challenges in TBM. In our AS models, the average accuracy of HHalign sequence alignments with respect to error-free TM-align structural alignments is 0.87 (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s008">S4 Fig</xref></bold>). When rebuilding the AS models using <italic>σ</italic><sub><italic>MOD</italic></sub> values and TM-align alignments, the average GDT-HA and lDDT scores improve by 6.1% and 5.9% respectively over the scores obtained with <italic>σ</italic><sub><italic>MOD</italic></sub> values and HHalign alignments (see <bold><xref rid="pcbi.1007219.t001" ref-type="table">Table 1</xref></bold>). These results show that by optimizing parameters of the 3D model building phase of single-template HM, the same improvement obtainable by optimizing alignment building can be reached.</p>
        <p>It might be thought that <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values aid 3D modeling by compensating for alignment errors, that is, by assigning misaligned residues more conformational freedom to help MODELLER repositioning them in a correct way. However, their effect can not be explained only by this mechanism, since they yield a 6.6% and 4.4% increase in GDT-HA and lDDT also when models are built with TM-align alignments (see <bold><xref rid="pcbi.1007219.t001" ref-type="table">Table 1</xref></bold>).</p>
      </sec>
      <sec id="sec014">
        <title>Effects on multiple-template modeling</title>
        <p>Next, we explored the effect of optimal HDDRs in multiple-template modeling, which has never been assessed before. As shown in <bold><xref rid="pcbi.1007219.t002" ref-type="table">Table 2</xref></bold>, applying an optimal set of <italic>σ</italic> values and template weights results in an enormous improvement in the quality of 3D models (see also <xref ref-type="fig" rid="pcbi.1007219.g003"><bold>Fig 3C</bold> and <bold>3D</bold></xref>). When building the AM models with optimal restraints, their average GDT-HA and lDDT scores improve by 38.9% and 18.9% over the scores obtained by using MODELLER-generated restraints. These increments are larger than the one observed when performing multiple-template modeling with MODELLER-generated restraints and error-free TM-align structural alignments, which results in a 5.7% and 5.1% improvements in GDT-HA and lDDT.</p>
        <table-wrap id="pcbi.1007219.t002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007219.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>3D modeling qualities of the AM multiple-template models built with optimal HDDRs and alignments.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi.1007219.t002g" xlink:href="pcbi.1007219.t002"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="justify" rowspan="1" colspan="1">Strategy</th>
                  <th align="justify" rowspan="1" colspan="1">GDT-HA</th>
                  <th align="justify" rowspan="1" colspan="1">lDDT</th>
                  <th align="justify" rowspan="1" colspan="1">MolProbity score</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER</td>
                  <td align="left" rowspan="1" colspan="1">0.6287 (-)</td>
                  <td align="left" rowspan="1" colspan="1">0.6819 (-)</td>
                  <td align="left" rowspan="1" colspan="1">3.0725 (-)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL</td>
                  <td align="left" rowspan="1" colspan="1">0.8733 (+38.9%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.8106 (+18.9%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.1478 (+2.4%)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER-SLOW</td>
                  <td align="left" rowspan="1" colspan="1">0.6310 (+0.4%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6850 (+0.5%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">2.9143 (-5.2%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL-SLOW</td>
                  <td align="left" rowspan="1" colspan="1">0.8747 (+39.1%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.8133 (+19.3%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.0475 (-0.8%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL-U<xref ref-type="table-fn" rid="t002fn002"><sup>a</sup></xref></td>
                  <td align="left" rowspan="1" colspan="1">0.7438 (+18.3%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.7427 (+8.9%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.1744 (+3.3%)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER-ST<xref ref-type="table-fn" rid="t002fn003"><sup>b</sup></xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6168 (-1.9%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6683 (-2.0%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.0231 (-1.6%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL-ST</td>
                  <td align="left" rowspan="1" colspan="1">0.6557 (+4.3%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6986 (+2.5%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.0398 (-1.1%)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER-TMalign</td>
                  <td align="left" rowspan="1" colspan="1">0.6645 (+5.7%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.7165 (+5.1%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.0529 (-0.6%)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL-TMalign</td>
                  <td align="left" rowspan="1" colspan="1">0.9222 (+46.7%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.8498 (+24.6%)<xref ref-type="table-fn" rid="t002fn004">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.1044 (+1.0%)</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="t002fn001">
              <p>See <bold><xref rid="pcbi.1007219.t001" ref-type="table">Table 1</xref></bold> for the description of contents, columns and most modeling strategies names.</p>
            </fn>
            <fn id="t002fn002">
              <p><sup>a</sup>The “U” suffix indicates the use of uniform template weights for multiple-template HDDRs.</p>
            </fn>
            <fn id="t002fn003">
              <p><sup>b</sup>The “ST” suffix indicates that only the top template for each target was used (thus resulting in single-template modeling).</p>
            </fn>
            <fn id="t002fn004">
              <p>*Asterisks denote a statistically significant difference (according to a Wilcoxon signed-rank test with a significance level of 0.05) between the scores of a strategy and the scores of the default MODELLER. See <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s004">S4 Table</xref></bold> for a full list of the numerical p-values.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>Optimal HDDRs increase even more the beneficial effect of using multiple templates. With MODELLER-generated restraints, employing multiple templates leads to an improvement of 1.9% and 2.0% in the average GDT-HA and lDDT of the AM models over single-template modeling performed with top-templates (see the MODELLER-ST strategy in <bold><xref rid="pcbi.1007219.t002" ref-type="table">Table 2</xref></bold>). On the other hand, with optimal HDDRs, it leads to an improvement of 33.2% and 16.0% in GDT-HA and lDDT over single-template modeling performed with optimal HDDRs (see the OPTIMAL-ST strategy in <bold><xref rid="pcbi.1007219.t002" ref-type="table">Table 2</xref></bold>).</p>
        <p>The reason for this large improvement is the following. In MODELLER, the <italic>pdf</italic> for a multiple-template HDDR includes a weighted contribution from each template. In optimal HDDRs, <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values are employed as <italic>σ</italic> values in conjunction with the OL weighting scheme (see the “<xref ref-type="sec" rid="sec002">Methods</xref>” section). In this scheme, only the contribution of the best template is selected for each HDDR (when considering a single HDDR, the best template is defined as the one having a distance <italic>d</italic><sub><italic>t</italic></sub> as close as possible to the target distance <italic>d</italic><sub><italic>n</italic></sub>, that is, the template with lowest <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> value). On the other hand, in MODELLER-generated HDDRs, the weights are usually non-zero for every template, meaning that the contribution of the best template is always weakened. This effect increases the allowed conformational space for the restrained distance, thus making it less likely to build a model with a near-native distance.</p>
        <p>The importance of the template-weighting scheme [<xref rid="pcbi.1007219.ref010" ref-type="bibr">10</xref>] is illustrated by the fact that when employing <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values and a uniform weighting scheme (that is, for an HDDR with <italic>U</italic> templates each template is given a weight <italic>w</italic><sub><italic>u</italic></sub> = <italic>1/U</italic>), the average GDT-HA and lDDT scores of the AM models improve only by 18.3% and 8.9% over the standard MODELLER (see the OPTIMAL-U strategy in <bold><xref rid="pcbi.1007219.t002" ref-type="table">Table 2</xref></bold>).</p>
        <p>Our data shows that if the best template can be identified for each restrained distance, a substantial improvement in 3D modeling quality can be reached. A relevant matter is therefore to understand whether for a single residue (on which several HDDRs are usually acting) or for some stretch of contiguous residues, the best template always happens to be the same, or instead if multiple templates are effectively used together. <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s013">S4 Text</xref></bold> shows that in the AM set, for regions of the target sequences covered by multiple templates, all templates are frequently used at the same time. When every template has the same level of sequence similarity with the target (e.g.: all of them have around 30% SeqId), usually no template dominates over some extended region of the target sequence. Even when considering only the HDDRs acting on a single residue, different best templates are most often used concomitantly (see <bold>Fig A</bold> and <bold>C</bold> in <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s013">S4 Text</xref></bold>). In situations where there is a large difference in SeqId among the templates, even if the template with the highest SeqId tends to be picked more frequently, also other templates may maintain a significant contribution throughout the target sequence (see <bold>Fig B</bold> in <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s013">S4 Text</xref></bold>). Therefore, in order to optimally model most target residues, multiple templates have to be effectively used. This fact suggests that in order to harness the full potential of multiple-templates in homology modeling, the concept of the “best template” for single restrained distances should be considered. In a real-life protein structure prediction scenario (where the structure of the target protein is unknown), the ability to select the best template for each distance would be related to our ability to directly estimate <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values. If our accuracy in estimation is sufficiently high, the impact on multiple-template 3D modeling quality will be largely beneficial (see the “Perturbing optimal σ values” section).</p>
      </sec>
      <sec id="sec015">
        <title>Effects on stereochemical quality</title>
        <p>In both single and multiple-template modeling, the use of optimal HDDRs appears to decrease the stereochemical quality of models, as seen by increased MolProbity scores (see <bold><xref rid="pcbi.1007219.t001" ref-type="table">Table 1</xref></bold> and <bold><xref rid="pcbi.1007219.t002" ref-type="table">Table 2</xref></bold>). The increment is more prominent in multiple-template modeling (2.4%) than in single-template modeling (0.7%). While optimal restraints may guide the models in conformations near the native state, at the same time they probably force stereochemical inaccuracies. However, employing a more through MDSA protocol is sufficient to almost entirely relax these inaccuracies, while maintaining high GDT-HA and lDDT scores (see the strategies with the “SLOW” suffix in the tables).</p>
      </sec>
    </sec>
    <sec id="sec016">
      <title>Perturbing optimal <italic>σ</italic> values</title>
      <p>As first demonstrated in [<xref rid="pcbi.1007219.ref022" ref-type="bibr">22</xref>], <italic>σ</italic><sub><italic>MOD</italic></sub> values are weakly correlated with their optimal counterparts. In the AS models, the distributions of <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> and <italic>σ</italic><sub><italic>MOD</italic></sub> values are markedly different (see <xref ref-type="fig" rid="pcbi.1007219.g001"><bold>Fig 1A</bold> and <bold>1B</bold></xref>) and the average PCCs between them are 0.262, 0.277, 0.183 and 0.221 for the Cα-Cα, NO, SCMC and SCSC restraints groups respectively (see <bold><xref ref-type="fig" rid="pcbi.1007219.g004">Fig 4A</xref></bold>). Even with accurate alignments built through TM-align, the histogram-based approach of MODELLER produces <italic>σ</italic> values which are weakly correlated to <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values (see <bold><xref ref-type="fig" rid="pcbi.1007219.g004">Fig 4B</xref></bold>).</p>
      <fig id="pcbi.1007219.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007219.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Correlation between <italic>σ</italic><sub><italic>MOD</italic></sub> and <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values in the AS models.</title>
          <p>(A) Distributions for the PCCs between <italic>σ</italic><sub><italic>MOD</italic></sub> and <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values for the HDDRs of the 225 AS models. (B) PCC distributions for the AS models rebuilt with TM-align alignments.</p>
        </caption>
        <graphic xlink:href="pcbi.1007219.g004"/>
      </fig>
      <p>In the previous section we have seen that the use of optimal <italic>σ</italic> values greatly improves MODELLER’s predictions. However, since <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values can not be directly inferred without the prior knowledge of the actual 3D structure that we are trying to predict, a strategy to improve MODELLER would consist in accurately estimating them. Irrespective of the predictive algorithm, it is reasonable to suppose that <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> estimations will always bear a certain amount of error. In order to understand how 3D modeling quality changes as a function of this error, we rebuilt the models of the analysis set by perturbing their <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values with random noise.</p>
      <sec id="sec017">
        <title>Effects on single-template modeling</title>
        <p><bold><xref ref-type="fig" rid="pcbi.1007219.g005">Fig 5A</xref></bold> shows how the average GDT-HA of the AS models changes when increasing the fraction of <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values substituted with a random <italic>σ</italic> (see <bold><xref ref-type="fig" rid="pcbi.1007219.g005">Fig 5B</xref></bold> for the relationship with lDDT). In the absence of any perturbation, the average GDT-HA is at its maximum of 0.6377. When the mean Cα-Cα <italic>PCC</italic><sub><italic>MODEL</italic></sub> of the AS models is approximately 0.9, the average GDT-HA decreases by 2.6%. Further increasing the amount of random perturbation in <italic>σ</italic> values leads to a continuous decrease in quality. When the average Cα-Cα <italic>PCC</italic><sub><italic>MODEL</italic></sub> approximates 0, the average GDT-HA is 0.6056 (resulting in a 5.0% decrease with respect to the optimal state). This score is 0.8% higher than the average GDT-HA obtained using the default <italic>σ</italic><sub><italic>MOD</italic></sub> values, which is 0.6009. Although the difference between these two scores is statistically significant (Wilcoxon signed-rank test, p-value = 1.6e-5) it is only minimal from a structural point of view. In other words, in single-template modeling, provided that the average <italic>σ</italic> of a model does not surpass a certain threshold (that is, the average <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> observed in nature), randomly generated <italic>σ</italic> values are surprisingly as effective as those generated by the MODELLER histogram-based approach. This is also confirmed by the fact that the use of uniform <italic>σ</italic> values &lt; 1.0 Å does not significantly alter the GDT-HA and lDDT scores of models with respect to the standard MODELLER algorithm (see <xref ref-type="fig" rid="pcbi.1007219.g002"><bold>Fig 2A</bold> and <bold>2B</bold></xref>).</p>
        <fig id="pcbi.1007219.g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007219.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <title>Effect of <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> perturbation on 3D modeling.</title>
            <p>(A) and (B) Average GDT-HA and lDDT scores of the AS models as a function of their average Cα-Cα <italic>PCC</italic><sub><italic>MODEL</italic></sub> values (see the “<xref ref-type="sec" rid="sec002">Methods</xref>” section). (C) and (D) Similar data obtained for the multiple-templates AM models. In (A) through (D), the dashed horizontal lines represent the average quality scores obtained by the default MODELLER.</p>
          </caption>
          <graphic xlink:href="pcbi.1007219.g005"/>
        </fig>
      </sec>
      <sec id="sec018">
        <title>Effects on multiple-template modeling</title>
        <p>Next, we performed perturbation experiments with multiple-template models (see <xref ref-type="fig" rid="pcbi.1007219.g005"><bold>Fig 5C</bold> and <bold>5D</bold></xref>). Again, the average quality decreases as perturbation increases. However, when the average Cα-Cα <italic>PCC</italic><sub><italic>MODEL</italic></sub> approximates 0, the average GDT-HA now becomes 9.1% lower than the one obtained using the default MODELLER. This behavior is likely to be explained by the fact that in perturbation experiments the OL template weighting scheme was employed. When this scheme is applied with optimal (or near-optimal) <italic>σ</italic> values, it boosts 3D modeling quality, but when it is applied with <italic>σ</italic> values being weakly correlated with <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values, it has a detrimental effect (since for each HDDR it uses only the contribution of a randomly chosen template, while the contribution from the best template is likely to be suppressed).</p>
        <p>This data shows that if we were able to predict <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values with sufficiently high accuracy, the performance of MODELLER would greatly increase. In single-template modeling, obtaining predictions with a PCC of ~0.6 would lead to an increase in GDT-HA of ~2.0%. In multiple-template modeling, the potential gain is higher, as the same PCC would increase GDT-HA by a larger ~8.0%.</p>
      </sec>
    </sec>
    <sec id="sec019">
      <title>Modifying the objective function of MODELLER with statistical potential terms</title>
      <sec id="sec020">
        <title>Effect on single-template modeling</title>
        <p>In order to identify the optimal way to incorporate the DOPE potential within MODELLER, we performed benchmarks with the AS single-template models by tuning <italic>w</italic><sub><italic>SP</italic></sub> values from 0.1 to 3.5 and by employing HDDRs bearing either <italic>σ</italic><sub><italic>MOD</italic></sub> or <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values. <xref ref-type="fig" rid="pcbi.1007219.g006"><bold>Fig 6A</bold> to <bold>6C</bold></xref> show that, with both types of <italic>σ</italic>, the inclusion of DOPE leads to improvements in 3D modeling. Strikingly, depending on the type of <italic>σ</italic>, the amount of improvement and the best <italic>w</italic><sub><italic>SP</italic></sub> vary greatly.</p>
        <fig id="pcbi.1007219.g006" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007219.g006</object-id>
          <label>Fig 6</label>
          <caption>
            <title>Average quality scores of the models of the analysis set as a function of the <italic>w</italic><sub><italic>SP</italic></sub> with which the DOPE potential has been included in the objective function of MODELLER.</title>
            <p>(A) to (C) Quality scores of the AS models. (D) to (F) Quality scores of the AM models. (A) through (F) The horizontal dashed lines correspond to the scores obtained when modeling with MODELLER-generated (blue color) or optimal (orange) HDDRs without the use of DOPE.</p>
          </caption>
          <graphic xlink:href="pcbi.1007219.g006"/>
        </fig>
        <p>With <italic>σ</italic><sub><italic>MOD</italic></sub> values, the maximum increase in GDT-HA is observed with a <italic>w</italic><sub><italic>SP</italic></sub> of 0.5. As shown in <bold><xref rid="pcbi.1007219.t003" ref-type="table">Table 3</xref></bold>, when employing DOPE with this <italic>w</italic><sub><italic>SP</italic></sub>, the average GDT-HA improves by a statistically significant 1.3% with respect to the default MODELLER. At the same time, the average lDDT score increases by 2.0%, showing that the use of DOPE also aids local modeling. Of note, when applying DOPE along with the <italic>slow</italic> MDSA protocol, an additional improvement is obtained: the average GDT-HA and lDDT scores now increase by 1.6% and 2.8%.</p>
        <table-wrap id="pcbi.1007219.t003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007219.t003</object-id>
          <label>Table 3</label>
          <caption>
            <title>3D modeling qualities of the AS single-template models built by including DOPE in the objective function of MODELLER.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi.1007219.t003g" xlink:href="pcbi.1007219.t003"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="justify" rowspan="1" colspan="1">Strategy</th>
                  <th align="justify" rowspan="1" colspan="1">GDT-HA</th>
                  <th align="justify" rowspan="1" colspan="1">lDDT</th>
                  <th align="justify" rowspan="1" colspan="1">MolProbity score</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER</td>
                  <td align="left" rowspan="1" colspan="1">0.6014 (-)</td>
                  <td align="left" rowspan="1" colspan="1">0.6563 (-)</td>
                  <td align="left" rowspan="1" colspan="1">3.0104 (-)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL</td>
                  <td align="left" rowspan="1" colspan="1">0.6377 (+6.0%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6842 (+4.2%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.0311 (+0.7%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER-DOPE-0.5<xref ref-type="table-fn" rid="t003fn002"><sup>a</sup></xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6089 (+1.3%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6692 (+2.0%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">2.1138 (-29.8%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER-SLOW-DOPE-0.5</td>
                  <td align="left" rowspan="1" colspan="1">0.6112 (+1.6%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6746 (+2.8%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">2.0344 (-32.4%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER-DOPE-3.5</td>
                  <td align="left" rowspan="1" colspan="1">0.5631 (-6.4%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6397 (-2.5%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">2.9977 (-0.4%)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL-DOPE-0.5</td>
                  <td align="left" rowspan="1" colspan="1">0.6549 (+8.9%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.7029 (+7.1%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">2.2960 (-23.7%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL-DOPE-3.5</td>
                  <td align="left" rowspan="1" colspan="1">0.6885 (+14.5%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.7158 (+9.1%)<xref ref-type="table-fn" rid="t003fn003">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">2.6280 (-12.7%)</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="t003fn001">
              <p>See <bold><xref rid="pcbi.1007219.t001" ref-type="table">Table 1</xref></bold> for the description of contents, columns and most modeling strategies names.</p>
            </fn>
            <fn id="t003fn002">
              <p><sup>a</sup>The “DOPE-X.X” suffix indicates the use of DOPE with a <italic>w</italic><sub><italic>SP</italic></sub> of X.X.</p>
            </fn>
            <fn id="t003fn003">
              <p>*Asterisks denote a statistically significant difference (according to a Wilcoxon signed-rank test with a significance level of 0.05) between the scores of a strategy and the scores of the default MODELLER. See <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s003">S3 Table</xref></bold> for a full list of the numerical p-values.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>When modeling with <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values, the best results are instead obtained with a <italic>w</italic><sub><italic>SP</italic></sub> of 3.5. In this case, DOPE increases the average GDT-HA and lDDT scores by 8.0% and 4.6% with respect to the scores obtained with the same restraints and the standard objective function of MODELLER. The increments in these two metrics are extremely large if computed with respect to the default MODELLER protocol (14.5% and 9.1%). <bold><xref ref-type="fig" rid="pcbi.1007219.g007">Fig 7</xref></bold> shows that with the default MODELLER, secondary structure elements that show divergence in the target and template structures are most often modeled in the template conformation. By using optimal HDDRs and DOPE, it is common to see these elements shifting towards target conformations.</p>
        <fig id="pcbi.1007219.g007" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007219.g007</object-id>
          <label>Fig 7</label>
          <caption>
            <title>Effects on 3D modeling of optimal <italic>σ</italic> values and DOPE.</title>
            <p>Effects brought by the use <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values and DOPE (with a <italic>w</italic><sub><italic>SP</italic></sub> of 3.5) on the 3D modeling of target <italic>1yd0_chain_A</italic> (colored in orange) using as a template <italic>1yd6_chain_D</italic> (pale green). In the model built using the default MODELLER (colored in white, superposed to its target and template on the left image) the three helices shown in the image are positioned in the same conformation of the template. In the model built employing <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values and DOPE with a <italic>w</italic><sub><italic>SP</italic></sub> of 3.5 (pale cyan, shown on the right) the helices are repositioned in a native-like conformation. Figures rendered with PyMOL [<xref rid="pcbi.1007219.ref039" ref-type="bibr">39</xref>].</p>
          </caption>
          <graphic xlink:href="pcbi.1007219.g007"/>
        </fig>
        <p>Remarkably, the same <italic>w</italic><sub><italic>SP</italic></sub> of 3.5 leads to a large decrease in modeling quality when DOPE is applied along with <italic>σ</italic><sub><italic>MOD</italic></sub> values: in this case, the average GDT-HA and lDDT scores decrease by a large 6.4% and 2.5% with respect to the score obtained without using DOPE.</p>
        <p>This data shows that in single-template modeling, the addition of DOPE is much more effective with <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values than with <italic>σ</italic><sub><italic>MOD</italic></sub> values. Additional insights into this behaviour were provided by the analysis of DOPE energetic landscapes. <bold><xref ref-type="fig" rid="pcbi.1007219.g008">Fig 8</xref></bold> shows the representative case of the <italic>1lam_chain_A</italic> and <italic>1dk8_chain_A</italic> targets, where the DOPE energies of models are plotted as a function of their GDT-HA scores. When using single-template HDDRs with <italic>σ</italic><sub><italic>MOD</italic></sub> values, applying DOPE with increasingly high <italic>w</italic><sub><italic>SP</italic></sub> values leads to a decrease in both GDT-HA and DOPE energies. These energies eventually become even lower than the native target structure one. It seems that in the DOPE landscape, near-native conformations are not at an absolute minimum. On the other hand, when modeling with single-template optimal HDDRs, increasing <italic>w</italic><sub><italic>SP</italic></sub> values leads to improvements in GDT-HA while maintaining DOPE energies relatively high. Similar trends are observed in the landscapes of almost all AS models. We speculate that this behaviour is caused by the fact that optimal HDDRs strongly restrain those regions of models which are structurally conserved between the native structures and templates, while they weakly restrain divergent regions. This probably allows to pinpoint the effect of DOPE in the divergent regions (where its addition likely improves modeling over the use of the standard MODELLER objective function) and to keep “rigid” the conserved regions (which are already extremely well-modeled and where DOPE can hardly improve the situation), thus giving rise to a synergistic effect.</p>
        <fig id="pcbi.1007219.g008" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007219.g008</object-id>
          <label>Fig 8</label>
          <caption>
            <title>DOPE energy landscapes.</title>
            <p>DOPE energy landscapes for target (A) <italic>1dk8_chain_A</italic> and (B) <italic>1lam_chain_A</italic> modeled using different strategies. 100 decoys were built for each strategy and their GDT-HA scores are plotted here against their DOPE energies. The strategies with the “MOD-ST” prefix adopted MODELLER-generated HDDRs and a single template (blue-shaded dots), those with the “OPT-ST” prefix adopted optimal HDDRs and a single template (orange-shaded dots) and those with the “OPT-MT” prefix adopted optimal HDDRs and multiple templates (red-shaded dots). The “SP-X.X” suffix indicates the use of DOPE with a <italic>w</italic><sub><italic>SP</italic></sub> of X.X. The green dots correspond to the DOPE-minimized native target structure.</p>
          </caption>
          <graphic xlink:href="pcbi.1007219.g008"/>
        </fig>
      </sec>
      <sec id="sec021">
        <title>Effect on multiple-template modeling</title>
        <p>Next, we explored the effect of DOPE in multiple-template modeling (see <bold><xref ref-type="fig" rid="pcbi.1007219.g006">Fig 6D</xref></bold> to <bold><xref ref-type="fig" rid="pcbi.1007219.g006">6F</xref></bold>). The trend observed when employing MODELLER-generated restraints is reminiscent of the single-template modeling one, although the improvements are slightly smaller. <bold><xref rid="pcbi.1007219.t004" ref-type="table">Table 4</xref></bold> shows that the best <italic>w</italic><sub><italic>SP</italic></sub> is 0.5, which results in an average increase in GDT-HA and lDDT of 0.6% and 1.6% with respect to the scores obtained with the default MODELLER. By employing DOPE with this <italic>w</italic><sub><italic>SP</italic></sub> along with the <italic>slow</italic> MDSA protocol, an additional improvement can be reached: the average GDT-HA and lDDT scores now improve by 1.0% and 2.2%. When further increasing <italic>w</italic><sub><italic>SP</italic></sub>, we assist to a decrease in 3D modeling qualities.</p>
        <table-wrap id="pcbi.1007219.t004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007219.t004</object-id>
          <label>Table 4</label>
          <caption>
            <title>3D modeling qualities of the AM multiple-template models built by including DOPE in the objective function of MODELLER.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi.1007219.t004g" xlink:href="pcbi.1007219.t004"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="justify" rowspan="1" colspan="1">Strategy</th>
                  <th align="justify" rowspan="1" colspan="1">GDT-HA</th>
                  <th align="justify" rowspan="1" colspan="1">lDDT</th>
                  <th align="justify" rowspan="1" colspan="1">MolProbity score</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER</td>
                  <td align="left" rowspan="1" colspan="1">0.6287 (-)</td>
                  <td align="left" rowspan="1" colspan="1">0.6819 (-)</td>
                  <td align="left" rowspan="1" colspan="1">3.0725 (-)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL</td>
                  <td align="left" rowspan="1" colspan="1">0.8733 (+38.9%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.8106 (+18.9%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.1478 (+2.4%)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER-DOPE-0.5</td>
                  <td align="left" rowspan="1" colspan="1">0.6327 (+0.6%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6926 (+1.6%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">2.2086 (-28.1%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER-SLOW-DOPE-0.5</td>
                  <td align="left" rowspan="1" colspan="1">0.6347 (+1.0%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6971 (+2.2%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">2.1152 (-31.2%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MODELLER-DOPE-3.5</td>
                  <td align="left" rowspan="1" colspan="1">0.5646 (-10.2%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.6453 (-5.4%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">3.1267 (+1.8%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL-DOPE-0.5</td>
                  <td align="left" rowspan="1" colspan="1">0.8736 (+39.0%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.8229 (+20.7%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">2.5635 (-16.6%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">OPTIMAL-DOPE-3.5</td>
                  <td align="left" rowspan="1" colspan="1">0.8519 (+35.5%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">0.8061 (+18.2%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                  <td align="left" rowspan="1" colspan="1">2.7520 (-10.4%)<xref ref-type="table-fn" rid="t004fn002">*</xref></td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="t004fn001">
              <p>See <bold><xref rid="pcbi.1007219.t001" ref-type="table">Table 1</xref></bold> for the description of contents, columns and most modeling strategies names.</p>
            </fn>
            <fn id="t004fn002">
              <p>*Asterisks denote a statistically significant difference (according to a Wilcoxon signed-rank test with a significance level of 0.05) between the scores of a strategy and the scores of the default MODELLER. See <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s004">S4 Table</xref></bold> for a full list of the numerical p-values.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>The results observed when combining DOPE with optimal multiple-template HDDRs are different. No value of <italic>w</italic><sub><italic>SP</italic></sub> is able to bring a relevant improvement in GDT-HA. As <italic>w</italic><sub><italic>SP</italic></sub> increases over 1.0, the scores even start to decrease in a significant way, although it seems that DOPE is able to bring at least a small improvement in lDDT.</p>
        <p>This counterintuitive behaviour can in part be explained from the analysis of DOPE energy landscapes. <bold><xref ref-type="fig" rid="pcbi.1007219.g008">Fig 8</xref></bold> shows that when using optimal multiple-template HDDRs, the quality of models is already higher than the one obtained with optimal single-template HDDRs. In this case, applying large <italic>w</italic><sub><italic>SP</italic></sub> values leads to a decrease in DOPE energies and GDT-HA. The plots show that the models built with optimal HDDRs seem to be attracted towards a local energy minimum of DOPE, which does not correspond to the native state, but is located relatively near it. Therefore, when using optimal restraints, minimizing the DOPE of a structure distant from the native state (like in the case of single-template modeling), tends to increase its GDT-HA, but when the structure is already very close to the native state (such as in the case of multiple-template modeling), it tends to decrease its GDT-HA.</p>
      </sec>
      <sec id="sec022">
        <title>Effects on stereochemical quality</title>
        <p>In terms of stereochemichal quality, the use of DOPE seems to be highly beneficial in both single and multiple-template modeling and with both MODELLER-generated and optimal HDDRs (see <bold><xref ref-type="fig" rid="pcbi.1007219.g006">Fig 6</xref>, Tables <xref rid="pcbi.1007219.t003" ref-type="table">3</xref></bold> and <bold><xref rid="pcbi.1007219.t004" ref-type="table">4</xref></bold>). For example, when employing <italic>σ</italic><sub><italic>MOD</italic></sub> values and DOPE with a <italic>w</italic><sub><italic>SP</italic></sub> of 0.5, the average MolProbity score of the AS models decreases by a large 29.8% with respect to the default MODELLER. Additional improvements in MolProbity scores are observed when coupling DOPE to the <italic>slow</italic> MDSA protocol. We found that the MolProbity score component in which DOPE brings the largest improvement is by far the “Clash Score”, meaning that the potential helps to remove steric clashes from models. Therefore, the inclusion of DOPE in the objective function of MODELLER represents a fast and effective way of improving the stereochemical quality of its models. This approach increases computational times by a factor of ~6.5 when employing the <italic>very_fast</italic> MDSA protocol (and ~16.5 with the <italic>slow</italic> protocol), but on modern hardware the default MODELLER algorithm usually takes a few seconds to complete a model, therefore in absolute terms the model building process is still relatively fast.</p>
      </sec>
      <sec id="sec023">
        <title>Comparison between DOPE and DFIRE in 3D modeling</title>
        <p>We also tested the effect of adding DFIRE in the objective function of MODELLER. Overall, DFIRE seems to have very similar effects to the ones described for DOPE (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s003">S3 Table</xref></bold>, <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s008">S4 Table</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s009">S5 Fig</xref></bold>), because their terms have very similar forms (see <bold>Fig B</bold> in <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s007">S3 Fig</xref></bold>). However, when modeling with <italic>σ</italic><sub><italic>MOD</italic></sub> values, DOPE seems to slightly outperform DFIRE in terms of all-atom local quality (expressed by lDDT scores). When using a <italic>w</italic><sub><italic>SP</italic></sub> of 0.5 and <italic>σ</italic><sub><italic>MOD</italic></sub> values, DOPE yields for the AS models an average lDDT score 0.5% higher than the one obtained with DFIRE, a small but statistically significant improvement (Wilcoxon signed-rank test, p-value = 4.6e-35). Therefore, we suggest that in MODELLER, DOPE should be preferred over DFIRE.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec024">
    <title>Discussion</title>
    <p>Improving the quality of HM predictions is clearly an area of great relevance in Biomedical Research [<xref rid="pcbi.1007219.ref040" ref-type="bibr">40</xref>], given that the applicability of this methodology is expected to increase in the next years [<xref rid="pcbi.1007219.ref005" ref-type="bibr">5</xref>]. Right now, a large portion of targets can be modeled only with low accuracy, due to the remote homology relationship (under 30% SeqId) with their templates. A solution to this problem could potentially come from advances in 3D model building or refinement algorithms. In this work, we have explored two main promising strategies to increase the accuracy of the original MODELLER algorithm.</p>
    <p>The use of optimal <italic>σ</italic> values (that is, <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values) greatly increases the 3D modeling quality of the program. Since <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values can only be obtained by knowing the exact amount of divergence between the structure of a target and its templates, they can not be used in real-life protein structure prediction scenarios (where the target structure is of course unknown).</p>
    <p>However, as first shown by the Lee group [<xref rid="pcbi.1007219.ref022" ref-type="bibr">22</xref>], <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values may be estimated through a machine learning system. These authors developed a random forest which obtained estimations with an average Cα-Cα PCC of ~0.35. The use of this predictor led to only a very small improvement in terms of 3D modeling quality. Our data (which describes the relationship between 3D modeling quality and errors in <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> estimations) shows that increasing the PCC of a similar predictor by at least 0.2–0.3 units could translate in a significant improvement of MODELLER.</p>
    <p>The other strategy that we have investigated is the inclusion of statistical potential terms, such as DOPE, in the objective function of MODELLER. We show that employing such potentials in the 3D model building phase of MODELLER robustly increases 3D modeling quality and provides a fast and effective way to improve the stereochemical details models. In order to allow the user community of MODELLER to deploy this strategy in their modeling pipelines, we share the Python code implementing it. In future research, it will be interesting to see if there exist potentials with an even more beneficial effect on 3D model building in MODELLER.</p>
    <p>Our results have implications also for other Structural Bioinformatics tools. RosettaCM and I-TASSER borrow from MODELLER the use of HDDRs [<xref rid="pcbi.1007219.ref036" ref-type="bibr">36</xref>, <xref rid="pcbi.1007219.ref041" ref-type="bibr">41</xref>–<xref rid="pcbi.1007219.ref042" ref-type="bibr">42</xref>] and programs like MULTICOM [<xref rid="pcbi.1007219.ref043" ref-type="bibr">43</xref>] and Pcons [<xref rid="pcbi.1007219.ref044" ref-type="bibr">44</xref>] implement MODELLER at some point in their protein modeling pipelines. The strategies presented in this work can certainly be implemented in these protocols to improve their quality.</p>
    <p>Of note, in the protein structure refinement field, restraints are built from a starting model and the aim is to guide the model towards its native conformation [<xref rid="pcbi.1007219.ref045" ref-type="bibr">45</xref>]. While in the HM context we may estimate <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values between a target native structure and a template, in protein structure refinement they could be similarly estimated between a native structure and its unrefined model. Methods to predict the local accuracy of 3D models already reach good performances [<xref rid="pcbi.1007219.ref046" ref-type="bibr">46</xref>]. It is reasonable to think that with a sufficiently accurate predictor, the <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> prediction strategy could also lead to improvements in current refinement strategies.</p>
    <p>The development of deep learning techniques [<xref rid="pcbi.1007219.ref047" ref-type="bibr">47</xref>] has recently brought advances in the field of contact and distance map prediction [<xref rid="pcbi.1007219.ref048" ref-type="bibr">48</xref>]. We suggest that such methodologies could be well adapted to the problem of <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> estimation. In future studies, we will concentrate on using this type approach to tackle the problem of <italic>σ</italic> values assignment. Since a machine learning model usually performs predictions in a relatively small amount of time, the <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> estimation approach has the potential to greatly improve the “modeling by satisfaction of spatial restraints” strategy of MODELLER at the price of small computational cost.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec025">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s001">
      <label>S1 Table</label>
      <caption>
        <title>Physical terms of the MODELLER objective function.</title>
        <p>Note how by default the objective function does not include any “physical” attractive term between non-bonded atoms (Lennard-Jones and Coulomb potential terms from CHARMM22 [<xref rid="pcbi.1007219.ref001" ref-type="bibr">1</xref>] are missing). The only attractive terms in the objective function are homology-derived distance restraints (see <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s002">S2 Table</xref></bold>).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s002">
      <label>S2 Table</label>
      <caption>
        <title>Homology-derived terms of the MODELLER objective function.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s003">
      <label>S3 Table</label>
      <caption>
        <title>3D modeling qualities of the AS single-template models built with different modeling strategies.</title>
        <p>See <bold><xref rid="pcbi.1007219.t001" ref-type="table">Table 1</xref></bold> in the main text for the description of contents, columns and most modeling strategies names.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s004">
      <label>S4 Table</label>
      <caption>
        <title>3D modeling qualities of the AM multiple-templates models built with different modeling strategies.</title>
        <p>See <bold>Tables <xref rid="pcbi.1007219.t001" ref-type="table">1</xref></bold> and <bold><xref rid="pcbi.1007219.t002" ref-type="table">2</xref></bold> in the main text and <bold><xref ref-type="supplementary-material" rid="pcbi.1007219.s003">S3 Table</xref></bold> for the description of contents, columns and most modeling strategies names.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s005">
      <label>S1 Fig</label>
      <caption>
        <title>Properties of the analysis set.</title>
        <p>(A) SeqId histogram of the pairwise target-template alignments in the AS models obtained using TM-align and HHalign. (B) Target coverage histograms of the same alignments. (C) Chain length histograms of the 225 AS targets, the 118 AM targets and all the 472 template chains of the analysis set. (D) CATH classes frequencies of the AS and AM targets compared to those in the entire CATH 4.2.0 database [<xref rid="pcbi.1007219.ref001" ref-type="bibr">1</xref>].</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s006">
      <label>S2 Fig</label>
      <caption>
        <title>Details of the <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> perturbation scheme.</title>
        <p>(A) to (E) the Cα-Cα <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values of the <italic>5jwo_chain_B</italic> (target) - <italic>1thx_chain_A</italic> (template) pair were perturbed to various <italic>PCC</italic><sub><italic>SEL</italic></sub> levels using the perturbation scheme described in the “Methods” section of the main text. The observed PCCs between the perturbed and the original <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values are reported. (F) Distributions of the original <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> values and three perturbed values lists shown in previous figures. The mean values of the lists are reported in brackets. Thanks to the use of Laplace distributions for extracting random errors, the perturbed values are distributed approximately as exponentials, which resemble the original <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> distribution. (G) and (H) average <italic>PCC</italic><sub><italic>MODEL</italic></sub> values of the AS and AM models in <italic>|Δd</italic><sub><italic>n</italic></sub><italic>|</italic> perturbation experiments plotted as a function of <italic>PCC</italic><sub><italic>SEL</italic></sub>. On average, each <italic>PCC</italic><sub><italic>SEL</italic></sub> value allows to obtain almost exactly the desired level of perturbation (quantified as <italic>PCC</italic><sub><italic>MODEL</italic></sub>). Data for the four HDDRs groups of MODELLER is shown. (G) AS models. (H) AM models.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s007">
      <label>S3 Fig</label>
      <caption>
        <title>Analysis of the terms of the DOPE and DFIRE potentials.</title>
        <p>(A) Forms of the 12561 terms of DOPE [<xref rid="pcbi.1007219.ref001" ref-type="bibr">1</xref>]. Each term is associated to a couple of heavy atom types from the 20 standard residues. Irrespective of the atom types, all the functions start to acquire a flat shape above the 8.0 Å threshold. (B) Confrontation of DOPE and DFIRE [<xref rid="pcbi.1007219.ref002" ref-type="bibr">2</xref>] terms. An hexbin density plot compares 364269 data points from all the 12561 terms of DOPE (x-axis) and DFIRE (y-axis) (each term has 29 points, which report the score of the potential in a linear space from 0.75 to 14.75 Å). The scores of the two potentials are highly correlated (Pearson correlation coefficient = 0.99).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s008">
      <label>S4 Fig</label>
      <caption>
        <title>Accuracy of the pairwise target-template HHalign alignments of the AS models.</title>
        <p>The x-axis reports the SeqId between the target and template sequences in TM-align alignments. The y-axis reports the accuracy of the corresponding HHalign alignment. The accuracy is computed as the ratio <italic>H</italic><sub><italic>m</italic></sub>/<italic>T</italic><sub><italic>m</italic></sub>, where <italic>T</italic><sub><italic>m</italic></sub> is the total number of matches in the TM-align alignment and <italic>H</italic><sub><italic>m</italic></sub> is the number of “correct” matches in HHalign alingments (that is, those HHalign matches which are also found in the TM-align alignment). The average accuracy is 0.87.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s009">
      <label>S5 Fig</label>
      <caption>
        <title>Average quality scores of the analysis set models as a function of the <italic>w</italic><sub><italic>sp</italic></sub> value with which the DFIRE or DOPE statistical potentials have been included in the objective function of MODELLER.</title>
        <p>The horizontal dashed lines correspond to the scores obtained when modeling with MODELLER-generated (blue color) or optimal (orange) HDDRs without the use of statistical potentials. (A) to (C) quality scores of the AS models. (D) to (F) quality scores of the AM models.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s010">
      <label>S1 Text</label>
      <caption>
        <title>Description of the GDT-HA and lDDT metrics for model quality evaluation.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s011">
      <label>S2 Text</label>
      <caption>
        <title>Obtaining optimal parameters for single-template HDDRs.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s012">
      <label>S3 Text</label>
      <caption>
        <title>Obtaining optimal parameters for multiple-template HDDRs.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007219.s013">
      <label>S4 Text</label>
      <caption>
        <title>Distribution of best templates for multiple-template HDDRs along target sequences.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007219.s013.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors wish to acknowledge Fabio Mastrantuono and Fransceso Pesce for helpful discussions and their precious help.</p>
    <p>This work is dedicated to the memory of our beloved mentor Prof. Francesco Bossa.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007219.ref001">
      <label>1</label>
      <mixed-citation publication-type="book"><name><surname>Rigden</surname><given-names>DJ</given-names></name>, editor. <source>From Protein Structure to Function with Bioinformatics</source>. <edition>2nd ed</edition><publisher-name>Springer</publisher-name><publisher-loc>Netherlands</publisher-loc>; <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Moult</surname><given-names>J</given-names></name>, <name><surname>Fidelis</surname><given-names>K</given-names></name>, <name><surname>Kryshtafovych</surname><given-names>A</given-names></name>, <name><surname>Schwede</surname><given-names>T</given-names></name>, <name><surname>Tramontano</surname><given-names>A</given-names></name>. <article-title>Critical assessment of methods of protein structure prediction (CASP)-Round XII</article-title>. <source>Proteins</source>. <year>2018</year>;<volume>86</volume> Suppl <issue>1</issue>: <fpage>7</fpage>–<lpage>15</lpage>. <pub-id pub-id-type="doi">10.1002/prot.25415</pub-id>
<?supplied-pmid 29082672?><pub-id pub-id-type="pmid">29082672</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Croll</surname><given-names>TI</given-names></name>, <name><surname>Sammito</surname><given-names>MD</given-names></name>, <name><surname>Kryshtafovych</surname><given-names>A</given-names></name>, <name><surname>Read</surname><given-names>RJ</given-names></name>. <article-title>Evaluation of template-based modeling in CASP13</article-title>. <source>Proteins</source>. <year>2019</year><pub-id pub-id-type="doi">10.1002/prot.25800</pub-id><?supplied-pmid 31407380?><pub-id pub-id-type="pmid">31407380</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Nugent</surname><given-names>T.</given-names></name><article-title>De novo membrane protein structure prediction</article-title>. <source>Methods Mol Biol</source>. <year>2015</year>;<volume>1215</volume>: <fpage>331</fpage>–<lpage>350</lpage>. <pub-id pub-id-type="doi">10.1007/978-1-4939-1465-4_15</pub-id><?supplied-pmid 25330970?><pub-id pub-id-type="pmid">25330970</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Schwede</surname><given-names>T.</given-names></name><article-title>Protein modeling: what happened to the “protein structure gap”?</article-title><source>Structure</source>. <year>2013</year>;<volume>21</volume>: <fpage>1531</fpage>–<lpage>1540</lpage>. <pub-id pub-id-type="doi">10.1016/j.str.2013.08.007</pub-id><?supplied-pmid 24010712?><pub-id pub-id-type="pmid">24010712</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Madden</surname><given-names>TL</given-names></name>, <name><surname>Schäffer</surname><given-names>AA</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>Z</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <etal>et al</etal><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res</source>. <year>1997</year>;<volume>25</volume>: <fpage>3389</fpage>–<lpage>3402</lpage>. <pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id><?supplied-pmid 9254694?><pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Söding</surname><given-names>J.</given-names></name><article-title>Protein homology detection by HMM-HMM comparison</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>: <fpage>951</fpage>–<lpage>960</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bti125</pub-id><?supplied-pmid 15531603?><pub-id pub-id-type="pmid">15531603</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Yan</surname><given-names>R</given-names></name>, <name><surname>Xu</surname><given-names>D</given-names></name>, <name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Walker</surname><given-names>S</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>. <article-title>A comparative assessment and analysis of 20 representative sequence alignment methods for protein structure prediction</article-title>. <source>Sci Rep</source>. <year>2013</year>;<volume>3</volume>: <fpage>2619</fpage><pub-id pub-id-type="doi">10.1038/srep02619</pub-id><?supplied-pmid 24018415?><pub-id pub-id-type="pmid">24018415</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Kryshtafovych</surname><given-names>A</given-names></name>, <name><surname>Monastyrskyy</surname><given-names>B</given-names></name>, <name><surname>Fidelis</surname><given-names>K</given-names></name>, <name><surname>Moult</surname><given-names>J</given-names></name>, <name><surname>Schwede</surname><given-names>T</given-names></name>, <name><surname>Tramontano</surname><given-names>A</given-names></name>. <article-title>Evaluation of the template-based modeling in CASP12</article-title>. <source>Proteins</source>. <year>2018</year>;<volume>86</volume> Suppl <issue>1</issue>: <fpage>321</fpage>–<lpage>334</lpage>. <pub-id pub-id-type="doi">10.1002/prot.25425</pub-id>
<?supplied-pmid 29159950?><pub-id pub-id-type="pmid">29159950</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Meier</surname><given-names>A</given-names></name>, <name><surname>Söding</surname><given-names>J</given-names></name>. <article-title>Automatic Prediction of Protein 3D Structures by Probabilistic Multi-template Homology Modeling</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>: <fpage>e1004343</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004343</pub-id><?supplied-pmid 26496371?><pub-id pub-id-type="pmid">26496371</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Park</surname><given-names>H</given-names></name>, <name><surname>Ovchinnikov</surname><given-names>S</given-names></name>, <name><surname>Kim</surname><given-names>DE</given-names></name>, <name><surname>DiMaio</surname><given-names>F</given-names></name>, <name><surname>Baker</surname><given-names>D</given-names></name>. <article-title>Protein homology model refinement by large-scale energy optimization</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2018</year>;<volume>115</volume>: <fpage>3054</fpage>–<lpage>3059</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1719115115</pub-id><?supplied-pmid 29507254?><pub-id pub-id-type="pmid">29507254</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Heo</surname><given-names>L</given-names></name>, <name><surname>Feig</surname><given-names>M</given-names></name>. <article-title>Experimental accuracy in protein structure refinement via molecular dynamics simulations</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2018</year>;<volume>115</volume>: <fpage>13276</fpage>–<lpage>13281</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1811364115</pub-id><?supplied-pmid 30530696?><pub-id pub-id-type="pmid">30530696</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Webb</surname><given-names>B</given-names></name>, <name><surname>Sali</surname><given-names>A</given-names></name>. <article-title>Comparative Protein Structure Modeling Using MODELLER</article-title>. <source>Curr Protoc Bioinformatics</source>. <year>2016</year>;<volume>54</volume>: <fpage>5.6.1</fpage>–<lpage>5.6.37</lpage>. <pub-id pub-id-type="doi">10.1002/cpbi.3</pub-id><?supplied-pmid 27322406?><pub-id pub-id-type="pmid">27322406</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Wallner</surname><given-names>B</given-names></name>, <name><surname>Elofsson</surname><given-names>A</given-names></name>. <article-title>All are not equal: a benchmark of different homology modeling programs</article-title>. <source>Protein Sci</source>. <year>2005</year>;<volume>14</volume>: <fpage>1315</fpage>–<lpage>1327</lpage>. <pub-id pub-id-type="doi">10.1110/ps.041253405</pub-id><?supplied-pmid 15840834?><pub-id pub-id-type="pmid">15840834</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Sali</surname><given-names>A</given-names></name>, <name><surname>Blundell</surname><given-names>TL</given-names></name>. <article-title>Comparative protein modelling by satisfaction of spatial restraints</article-title>. <source>J Mol Biol</source>. <year>1993</year>;<volume>234</volume>: <fpage>779</fpage>–<lpage>815</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.1993.1626</pub-id><?supplied-pmid 8254673?><pub-id pub-id-type="pmid">8254673</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Brooks</surname><given-names>BR</given-names></name>, <name><surname>Brooks</surname><given-names>CL</given-names></name>, <name><surname>Mackerell</surname><given-names>AD</given-names></name>, <name><surname>Nilsson</surname><given-names>L</given-names></name>, <name><surname>Petrella</surname><given-names>RJ</given-names></name>, <name><surname>Roux</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>CHARMM: the biomolecular simulation program</article-title>. <source>J Comput Chem</source>. <year>2009</year>;<volume>30</volume>: <fpage>1545</fpage>–<lpage>1614</lpage>. <pub-id pub-id-type="doi">10.1002/jcc.21287</pub-id><?supplied-pmid 19444816?><pub-id pub-id-type="pmid">19444816</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Zimmermann</surname><given-names>L</given-names></name>, <name><surname>Stephens</surname><given-names>A</given-names></name>, <name><surname>Nam</surname><given-names>S-Z</given-names></name>, <name><surname>Rau</surname><given-names>D</given-names></name>, <name><surname>Kübler</surname><given-names>J</given-names></name>, <name><surname>Lozajic</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>A Completely Reimplemented MPI Bioinformatics Toolkit with a New HHpred Server at its Core</article-title>. <source>J Mol Biol</source>. <year>2017</year>; <pub-id pub-id-type="doi">10.1016/j.jmb.2017.12.007</pub-id><?supplied-pmid 29258817?><pub-id pub-id-type="pmid">29258817</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Joo</surname><given-names>K</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>, <name><surname>Sim</surname><given-names>S</given-names></name>, <name><surname>Lee</surname><given-names>SY</given-names></name>, <name><surname>Lee</surname><given-names>K</given-names></name>, <name><surname>Heo</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Protein structure modeling for CASP10 by multiple layers of global optimization</article-title>. <source>Proteins</source>. <year>2014</year>;<volume>82</volume> Suppl <issue>2</issue>: <fpage>188</fpage>–<lpage>195</lpage>. <pub-id pub-id-type="doi">10.1002/prot.24397</pub-id>
<?supplied-pmid 23966235?><pub-id pub-id-type="pmid">23966235</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Joo</surname><given-names>K</given-names></name>, <name><surname>Joung</surname><given-names>I</given-names></name>, <name><surname>Lee</surname><given-names>SY</given-names></name>, <name><surname>Kim</surname><given-names>JY</given-names></name>, <name><surname>Cheng</surname><given-names>Q</given-names></name>, <name><surname>Manavalan</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>Template based protein structure modeling by global optimization in CASP11</article-title>. <source>Proteins</source>. <year>2016</year>;<volume>84</volume> Suppl <issue>1</issue>: <fpage>221</fpage>–<lpage>232</lpage>. <pub-id pub-id-type="doi">10.1002/prot.24917</pub-id>
<?supplied-pmid 26329522?><pub-id pub-id-type="pmid">26329522</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Hong</surname><given-names>SH</given-names></name>, <name><surname>Joung</surname><given-names>I</given-names></name>, <name><surname>Flores-Canales</surname><given-names>JC</given-names></name>, <name><surname>Manavalan</surname><given-names>B</given-names></name>, <name><surname>Cheng</surname><given-names>Q</given-names></name>, <name><surname>Heo</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Protein structure modeling and refinement by global optimization in CASP12</article-title>. <source>Proteins</source>. <year>2018</year>;<volume>86</volume> Suppl <issue>1</issue>: <fpage>122</fpage>–<lpage>135</lpage>. <pub-id pub-id-type="doi">10.1002/prot.25426</pub-id>
<?supplied-pmid 29159837?><pub-id pub-id-type="pmid">29159837</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Joo</surname><given-names>K</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>, <name><surname>Seo</surname><given-names>J-H</given-names></name>, <name><surname>Lee</surname><given-names>K</given-names></name>, <name><surname>Kim</surname><given-names>B-G</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>. <article-title>All-atom chain-building by optimizing MODELLER energy function using conformational space annealing</article-title>. <source>Proteins</source>. <year>2009</year>;<volume>75</volume>: <fpage>1010</fpage>–<lpage>1023</lpage>. <pub-id pub-id-type="doi">10.1002/prot.22312</pub-id><?supplied-pmid 19089941?><pub-id pub-id-type="pmid">19089941</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>J</given-names></name>, <name><surname>Lee</surname><given-names>K</given-names></name>, <name><surname>Joung</surname><given-names>I</given-names></name>, <name><surname>Joo</surname><given-names>K</given-names></name>, <name><surname>Brooks</surname><given-names>BR</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>. <article-title>Sigma-RF: prediction of the variability of spatial restraints in template-based modeling by random forest</article-title>. <source>BMC Bioinformatics</source>. <year>2015</year>;<volume>16</volume>: <fpage>94</fpage><pub-id pub-id-type="doi">10.1186/s12859-015-0526-z</pub-id><?supplied-pmid 25886990?><pub-id pub-id-type="pmid">25886990</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>H</given-names></name>, <name><surname>Zhou</surname><given-names>Y</given-names></name>. <article-title>Distance-scaled, finite ideal-gas reference state improves structure-derived potentials of mean force for structure selection and stability prediction</article-title>. <source>Protein Sci</source>. <year>2002</year>;<volume>11</volume>: <fpage>2714</fpage>–<lpage>2726</lpage>. <pub-id pub-id-type="doi">10.1110/ps.0217002</pub-id><?supplied-pmid 12381853?><pub-id pub-id-type="pmid">12381853</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>J</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>, <name><surname>Sasaki</surname><given-names>TN</given-names></name>, <name><surname>Sasai</surname><given-names>M</given-names></name>, <name><surname>Seok</surname><given-names>C</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>. <article-title>De novo protein structure prediction by dynamic fragment assembly and conformational space annealing</article-title>. <source>Proteins</source>. <year>2011</year>;<volume>79</volume>: <fpage>2403</fpage>–<lpage>2417</lpage>. <pub-id pub-id-type="doi">10.1002/prot.23059</pub-id><?supplied-pmid 21604307?><pub-id pub-id-type="pmid">21604307</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Kortemme</surname><given-names>T</given-names></name>, <name><surname>Morozov</surname><given-names>AV</given-names></name>, <name><surname>Baker</surname><given-names>D</given-names></name>. <article-title>An orientation-dependent hydrogen bonding potential improves prediction of specificity and structure for proteins and protein-protein complexes</article-title>. <source>J Mol Biol</source>. <year>2003</year>;<volume>326</volume>: <fpage>1239</fpage>–<lpage>1259</lpage>. <pub-id pub-id-type="doi">10.1016/s0022-2836(03)00021-4</pub-id><?supplied-pmid 12589766?><pub-id pub-id-type="pmid">12589766</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Shen</surname><given-names>M-Y</given-names></name>, <name><surname>Sali</surname><given-names>A</given-names></name>. <article-title>Statistical potential for assessment and prediction of protein structures</article-title>. <source>Protein Sci</source>. <year>2006</year>;<volume>15</volume>: <fpage>2507</fpage>–<lpage>2524</lpage>. <pub-id pub-id-type="doi">10.1110/ps.062416606</pub-id><?supplied-pmid 17075131?><pub-id pub-id-type="pmid">17075131</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Larsson</surname><given-names>P</given-names></name>, <name><surname>Wallner</surname><given-names>B</given-names></name>, <name><surname>Lindahl</surname><given-names>E</given-names></name>, <name><surname>Elofsson</surname><given-names>A</given-names></name>. <article-title>Using multiple templates to improve quality of homology models in automated homology modeling</article-title>. <source>Protein Sci</source>. <year>2008</year>;<volume>17</volume>: <fpage>990</fpage>–<lpage>1002</lpage>. <pub-id pub-id-type="doi">10.1110/ps.073344908</pub-id><?supplied-pmid 18441233?><pub-id pub-id-type="pmid">18441233</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>G</given-names></name>, <name><surname>Dunbrack</surname><given-names>RL</given-names></name>. <article-title>PISCES: recent improvements to a PDB sequence culling server</article-title>. <source>Nucleic Acids Res</source>. <year>2005</year>;<volume>33</volume>: <fpage>W94</fpage>–<lpage>98</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gki402</pub-id><?supplied-pmid 15980589?><pub-id pub-id-type="pmid">15980589</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Skolnick</surname><given-names>J</given-names></name>. <article-title>TM-align: a protein structure alignment algorithm based on the TM-score</article-title>. <source>Nucleic Acids Res</source>. <year>2005</year>;<volume>33</volume>: <fpage>2302</fpage>–<lpage>2309</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gki524</pub-id><?supplied-pmid 15849316?><pub-id pub-id-type="pmid">15849316</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Skolnick</surname><given-names>J</given-names></name>. <article-title>Scoring function for automated assessment of protein structure template quality</article-title>. <source>Proteins</source>. <year>2004</year>;<volume>57</volume>: <fpage>702</fpage>–<lpage>710</lpage>. <pub-id pub-id-type="doi">10.1002/prot.20264</pub-id><?supplied-pmid 15476259?><pub-id pub-id-type="pmid">15476259</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>. <article-title>How significant is a protein structure similarity with TM-score = 0.5</article-title>? <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>: <fpage>889</fpage>–<lpage>895</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq066</pub-id><?supplied-pmid 20164152?><pub-id pub-id-type="pmid">20164152</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Dawson</surname><given-names>NL</given-names></name>, <name><surname>Lewis</surname><given-names>TE</given-names></name>, <name><surname>Das</surname><given-names>S</given-names></name>, <name><surname>Lees</surname><given-names>JG</given-names></name>, <name><surname>Lee</surname><given-names>D</given-names></name>, <name><surname>Ashford</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>CATH: an expanded resource to predict protein function through structure and sequence</article-title>. <source>Nucleic Acids Res</source>. <year>2017</year>;<volume>45</volume>: <fpage>D289</fpage>–<lpage>D295</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw1098</pub-id><?supplied-pmid 27899584?><pub-id pub-id-type="pmid">27899584</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Remmert</surname><given-names>M</given-names></name>, <name><surname>Biegert</surname><given-names>A</given-names></name>, <name><surname>Hauser</surname><given-names>A</given-names></name>, <name><surname>Söding</surname><given-names>J</given-names></name>. <article-title>HHblits: lightning-fast iterative protein sequence searching by HMM-HMM alignment</article-title>. <source>Nat Methods</source>. <year>2011</year>;<volume>9</volume>: <fpage>173</fpage>–<lpage>175</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1818</pub-id><?supplied-pmid 22198341?><pub-id pub-id-type="pmid">22198341</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Mariani</surname><given-names>V</given-names></name>, <name><surname>Biasini</surname><given-names>M</given-names></name>, <name><surname>Barbato</surname><given-names>A</given-names></name>, <name><surname>Schwede</surname><given-names>T</given-names></name>. <article-title>lDDT: a local superposition-free score for comparing protein structures and models using distance difference tests</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>: <fpage>2722</fpage>–<lpage>2728</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt473</pub-id><?supplied-pmid 23986568?><pub-id pub-id-type="pmid">23986568</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>VB</given-names></name>, <name><surname>Arendall</surname><given-names>WB</given-names></name>, <name><surname>Headd</surname><given-names>JJ</given-names></name>, <name><surname>Keedy</surname><given-names>DA</given-names></name>, <name><surname>Immormino</surname><given-names>RM</given-names></name>, <name><surname>Kapral</surname><given-names>GJ</given-names></name>, <etal>et al</etal><article-title>MolProbity: all-atom structure validation for macromolecular crystallography</article-title>. <source>Acta Crystallogr D Biol Crystallogr</source>. <year>2010</year>;<volume>66</volume>: <fpage>12</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1107/S0907444909042073</pub-id><?supplied-pmid 20057044?><pub-id pub-id-type="pmid">20057044</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Thompson</surname><given-names>J</given-names></name>, <name><surname>Baker</surname><given-names>D</given-names></name>. <article-title>Incorporation of evolutionary information into Rosetta comparative modeling</article-title>. <source>Proteins</source>. <year>2011</year>;<volume>79</volume>: <fpage>2380</fpage>–<lpage>2388</lpage>. <pub-id pub-id-type="doi">10.1002/prot.23046</pub-id><?supplied-pmid 21638331?><pub-id pub-id-type="pmid">21638331</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Rykunov</surname><given-names>D</given-names></name>, <name><surname>Fiser</surname><given-names>A</given-names></name>. <article-title>New statistical potential for quality assessment of protein models and a survey of energy functions</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>: <fpage>128</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-11-128</pub-id><?supplied-pmid 20226048?><pub-id pub-id-type="pmid">20226048</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Chopra</surname><given-names>G</given-names></name>, <name><surname>Kalisman</surname><given-names>N</given-names></name>, <name><surname>Levitt</surname><given-names>M</given-names></name>. <article-title>Consistent refinement of submitted models at CASP using a knowledge-based potential</article-title>. <source>Proteins</source>. <year>2010</year>;<volume>78</volume>: <fpage>2668</fpage>–<lpage>2678</lpage>. <pub-id pub-id-type="doi">10.1002/prot.22781</pub-id><?supplied-pmid 20589633?><pub-id pub-id-type="pmid">20589633</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref039">
      <label>39</label>
      <mixed-citation publication-type="other">Schrödinger, LLC. The PyMOL Molecular Graphics System, Version 1.8. 2015.</mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Schwede</surname><given-names>T</given-names></name>, <name><surname>Sali</surname><given-names>A</given-names></name>, <name><surname>Honig</surname><given-names>B</given-names></name>, <name><surname>Levitt</surname><given-names>M</given-names></name>, <name><surname>Berman</surname><given-names>HM</given-names></name>, <name><surname>Jones</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Outcome of a workshop on applications of protein models in biomedical research</article-title>. <source>Structure</source>. <year>2009</year>;<volume>17</volume>: <fpage>151</fpage>–<lpage>159</lpage>. <pub-id pub-id-type="doi">10.1016/j.str.2008.12.014</pub-id><?supplied-pmid 19217386?><pub-id pub-id-type="pmid">19217386</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Song</surname><given-names>Y</given-names></name>, <name><surname>DiMaio</surname><given-names>F</given-names></name>, <name><surname>Wang</surname><given-names>RY-R</given-names></name>, <name><surname>Kim</surname><given-names>D</given-names></name>, <name><surname>Miles</surname><given-names>C</given-names></name>, <name><surname>Brunette</surname><given-names>T</given-names></name>, <etal>et al</etal><article-title>High-resolution comparative modeling with RosettaCM</article-title>. <source>Structure</source>. <year>2013</year>;<volume>21</volume>: <fpage>1735</fpage>–<lpage>1742</lpage>. <pub-id pub-id-type="doi">10.1016/j.str.2013.08.005</pub-id><?supplied-pmid 24035711?><pub-id pub-id-type="pmid">24035711</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Yan</surname><given-names>R</given-names></name>, <name><surname>Roy</surname><given-names>A</given-names></name>, <name><surname>Xu</surname><given-names>D</given-names></name>, <name><surname>Poisson</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>. <article-title>The I-TASSER Suite: protein structure and function prediction</article-title>. <source>Nat Methods</source>. <year>2015</year>;<volume>12</volume>: <fpage>7</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3213</pub-id><?supplied-pmid 25549265?><pub-id pub-id-type="pmid">25549265</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Eickholt</surname><given-names>J</given-names></name>, <name><surname>Cheng</surname><given-names>J</given-names></name>. <article-title>MULTICOM: a multi-level combination approach to protein structure prediction and its assessments in CASP8</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>: <fpage>882</fpage>–<lpage>888</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq058</pub-id><?supplied-pmid 20150411?><pub-id pub-id-type="pmid">20150411</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Wallner</surname><given-names>B</given-names></name>, <name><surname>Fang</surname><given-names>H</given-names></name>, <name><surname>Elofsson</surname><given-names>A</given-names></name>. <article-title>Automatic consensus-based fold recognition using Pcons, ProQ, and Pmodeller</article-title>. <source>Proteins</source>. <year>2003</year>;<volume>53</volume> Suppl <issue>6</issue>: <fpage>534</fpage>–<lpage>541</lpage>. <pub-id pub-id-type="doi">10.1002/prot.10536</pub-id>
<?supplied-pmid 14579343?><pub-id pub-id-type="pmid">14579343</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Feig</surname><given-names>M.</given-names></name><article-title>Computational protein structure refinement: Almost there, yet still so far to go</article-title>. <source>Wiley Interdiscip Rev Comput Mol Sci</source>. <year>2017</year>;<volume>7</volume><pub-id pub-id-type="doi">10.1002/wcms.1307</pub-id><?supplied-pmid 30613211?><pub-id pub-id-type="pmid">30613211</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Uziela</surname><given-names>K</given-names></name>, <name><surname>Menéndez Hurtado</surname><given-names>D</given-names></name>, <name><surname>Shu</surname><given-names>N</given-names></name>, <name><surname>Wallner</surname><given-names>B</given-names></name>, <name><surname>Elofsson</surname><given-names>A</given-names></name>. <article-title>ProQ3D: improved model quality assessments using deep learning</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>: <fpage>1578</fpage>–<lpage>1580</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw819</pub-id><?supplied-pmid 28052925?><pub-id pub-id-type="pmid">28052925</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>LeCun</surname><given-names>Y</given-names></name>, <name><surname>Bengio</surname><given-names>Y</given-names></name>, <name><surname>Hinton</surname><given-names>G</given-names></name>. <article-title>Deep learning</article-title>. <source>Nature</source>. <year>2015</year>;<volume>521</volume>: <fpage>436</fpage>–<lpage>444</lpage>. <pub-id pub-id-type="doi">10.1038/nature14539</pub-id><?supplied-pmid 26017442?><pub-id pub-id-type="pmid">26017442</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007219.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Schaarschmidt</surname><given-names>J</given-names></name>, <name><surname>Monastyrskyy</surname><given-names>B</given-names></name>, <name><surname>Kryshtafovych</surname><given-names>A</given-names></name>, <name><surname>Bonvin</surname><given-names>AMJJ</given-names></name>. <article-title>Assessment of contact predictions in CASP12: Co-evolution and deep learning coming of age</article-title>. <source>Proteins</source>. <year>2018</year>;<volume>86</volume> Suppl <issue>1</issue>: <fpage>51</fpage>–<lpage>66</lpage>. <pub-id pub-id-type="doi">10.1002/prot.25407</pub-id>
<?supplied-pmid 29071738?><pub-id pub-id-type="pmid">29071738</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1007219.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007219.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>de Groot</surname>
          <given-names>Bert L.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2019 de Groot, Elofsson</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>de Groot, Elofsson</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007219" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">1 Oct 2019</named-content>
    </p>
    <p>Dear Dr JANSON,</p>
    <p>Thank you very much for submitting your manuscript 'Revisiting the “satisfaction of spatial restraints” approach of MODELLER for protein homology modeling' for review by PLOS Computational Biology. Your manuscript has been fully evaluated by the PLOS Computational Biology editorial team and in this case also by independent peer reviewers. The reviewers appreciated the attention to an important problem, but raised some substantial concerns about the manuscript as it currently stands. While your manuscript cannot be accepted in its present form, we are willing to consider a revised version in which the issues raised by both reviewers have been adequately addressed. We cannot, of course, promise publication at that time.</p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>Your revisions should address the specific points made by each reviewer. Please return the revised version within the next 60 days. If you anticipate any delay in its return, we ask that you let us know the expected resubmission date by email at <email>ploscompbiol@plos.org</email>. Revised manuscripts received beyond 60 days may require evaluation and peer review similar to that applied to newly submitted manuscripts.</p>
    <p>In addition, when you are ready to resubmit, please be prepared to provide the following:</p>
    <p>(1) A detailed list of your responses to the review comments and the changes you have made in the manuscript. We require a file of this nature before your manuscript is passed back to the editors.</p>
    <p>(2) A copy of your manuscript with the changes highlighted (encouraged). We encourage authors, if possible to show clearly where changes have been made to their manuscript e.g. by highlighting text.</p>
    <p>(3) A striking still image to accompany your article (optional). If the image is judged to be suitable by the editors, it may be featured on our website and might be chosen as the issue image for that month. These square, high-quality images should be accompanied by a short caption. Please note as well that there should be no copyright restrictions on the use of the image, so that it can be published under the Open-Access license and be subject only to appropriate attribution.</p>
    <p>Before you resubmit your manuscript, please consult our Submission Checklist to ensure your manuscript is formatted correctly for PLOS Computational Biology: <ext-link ext-link-type="uri" xlink:href="http://www.ploscompbiol.org/static/checklist.action">http://www.ploscompbiol.org/static/checklist.action</ext-link>. Some key points to remember are:</p>
    <p>- Figures uploaded separately as TIFF or EPS files (if you wish, your figures may remain in your main manuscript file in addition).</p>
    <p>- Supporting Information uploaded as separate files, titled Dataset, Figure, Table, Text, Protocol, Audio, or Video.</p>
    <p>- Funding information in the 'Financial Disclosure' box in the online system.</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com">https://pacev2.apexcovantage.com</ext-link> PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods">here</ext-link>. </p>
    <p>We are sorry that we cannot be more positive about your manuscript at this stage, but if you have any concerns or questions, please do not hesitate to contact us.</p>
    <p>Sincerely,</p>
    <p>Bert L. de Groot</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Arne Elofsson</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The manuscript describes an analysis of the potential to improve homology modelling using “satisfaction of spatial restraints” in the widely used MODELLER package. If the structural divergence between target and template is optimally modelled there is a large room for improvement in particular for multiple templates. Improvements (2% for single and 11% for multiple templates) are expected if the predicted structural divergence correlate &gt;0.6 compared to the true divergence. In addition, the authors also investigate the possibility to include a statistical potential in the objective function of the MODELLER and show that using the build in DOPE statistical potential yields a small but consistent improvement in model quality. Code to for the latter is provided in a git repo.</p>
    <p>Overall this manuscript was a nice read and present results that can be used to consistently improve modelling results. It also establish an upper limit on model quality that can be gained if the templates are used optimally. However, if I should provide some criticism, a large part of the analysis is done using information from the native structure when setting the local weights. If you know exactly which residues to move and to which degree, you should expect large improvements.</p>
    <p>1) The authors provide some perturbation analysis by randomly changing some fraction of weights from their optimal value, thereby reducing the correlation from 1.0 to 0.0 and show that improvements are expected when the correlation is &gt;0.6 (Fig 5). Looking at Fig S2, 0.6 correlation corresponds to changing only 30% (0.3) of the residues. Thus, 70% of the residues have their structural divergence at their optimal and 30% are random. This scenario is highly unrealistic; 0.6 correlation doesn’t seem too high, but since correlation is really effected by small number of random points buried among perfect predictions, the actual required prediction performance might be much higher. I suggest that the perturbation analysis is performed in a more rigorous way that sample distributions more likely to originate from a model quality assessment prediction method, where each estimate would have some uncertainty, Or better use a proper model quality assessment program, like ProQ3D or QMEAN to get realistic estimates.</p>
    <p>2) Best performance gain can potentially be obtained using multiple templates. However, again here, the fact the authors are using the knowledge on which template is optimal obfuscates the true value of this results. We already know that if you are able to always pick the best model you would outperform any group in CASP, the problem is to pick the best model/template. Thus, it is crucial that effect of errors in the estimates are investigated more throughly.</p>
    <p>3) For multiple templates how are the delta(d_ij) for different templates distributed through the target sequence? Is it different templates that dominates in different regions, or are they intertwined? i.e. is it effectively using more than one template for any given region or is it more picking the best template for each region?</p>
    <p>4) It is a bit unclear on how the local weights are implemented, do you provide a custom made restraints file to Modeller? or did you find any other API to interface with the Modeller functions? Anyway I think it would be useful if you in addition to the code you already provide, also provide code for running Modeller with the optimal weight (if native is available), or user-specified given a list of local predicted CA-CA distances.</p>
    <p>Reviewer #2: This manuscript describes a study of MODELLER, a widely-used software tool for protein homology modeling.</p>
    <p>Given that MODELLER is widely used, further study of this program and even a small improvement are always desirable.</p>
    <p>In this manuscript, the authors have studied the relationship between modeling quality and estimation of the difference of an inter-atom distance between target and template. The authors claim that 1) a more accurate estimation of the difference may improve modeling accuracy and 2) modeling quality may be increased by incorporating some statistical potentials into MODELLER. These findings are not very new, but the manuscript provides sufficient data and analysis to back up them, which to the best of my knowledge is not widely available in the literature. The authors have also released source code for the incorporation of DOPE and DFIRE into MODELLER, although this is not very new (Similar code is available at the MODELLER website).</p>
    <p>Some minor concerns:</p>
    <p>1) lines 46-47, it is fine to say that template-based modeling is the most popular, but I am not sure if it is fine to claim that the most successful approach is template-based modeling since this method fails on the modeling of many membrane proteins. In particular, in the past 2-3 years template-free modeling has made a very good progress and now its accuracy is comparable or even better as long as the target protein does not have very good templates. Further, currently the best template-free modeling also works well on membrane proteins.</p>
    <p>2) lines 69-71, some revision is needed here. In addition to algorithm advance, the enlargement of both sequence and structure databases is also a very important factor for the improvement of HM modeling.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: Yes: Björn Wallner</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article id="pcbi.1007219.r002" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007219.r002</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>de Groot</surname>
          <given-names>Bert L.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2019 de Groot, Elofsson</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>de Groot, Elofsson</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007219" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">13 Nov 2019</named-content>
    </p>
    <p>Dear Dr JANSON,</p>
    <p>We are pleased to inform you that your manuscript 'Revisiting the “satisfaction of spatial restraints” approach of MODELLER for protein homology modeling' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. Please be aware that it may take several days for you to receive this email; during this time no action is required by you. Once you have received these formatting requests, please note that your manuscript will not be scheduled for publication until you have made the required changes.</p>
    <p>In the meantime, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pcompbiol/">https://www.editorialmanager.com/pcompbiol/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information to ensure an efficient production and billing process.</p>
    <p>One of the goals of PLOS is to make science accessible to educators and the public. PLOS staff issue occasional press releases and make early versions of PLOS Computational Biology articles available to science writers and journalists. PLOS staff also collaborate with Communication and Public Information Offices and would be happy to work with the relevant people at your institution or funding agency. If your institution or funding agency is interested in promoting your findings, please ask them to coordinate their releases with PLOS (contact <email>ploscompbiol@plos.org</email>).</p>
    <p>Thank you again for supporting Open Access publishing. We look forward to publishing your paper in PLOS Computational Biology.</p>
    <p>Sincerely,</p>
    <p>Bert L. de Groot</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Arne Elofsson</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Reviewer's Responses to Questions</p>
    <p>Comments to the Authors:</p>
    <p>Please note here if the review is uploaded as an attachment.</p>
    <p>Reviewer #1: All my comments have been adequately addressed.</p>
    <p>**********</p>
    <p>Have all data underlying the figures and results presented in the manuscript been provided?</p>
    <p>Large-scale datasets should be made available via a public repository as described in the </p>
    <p>PLOS Computational Biology</p>
    <p><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p>Do you want your identity to be public for this peer review?</p>
    <p> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: Yes: Björn Wallner</p>
  </body>
</sub-article>
<sub-article id="pcbi.1007219.r003" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007219.r003</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>de Groot</surname>
          <given-names>Bert L.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2019 de Groot, Elofsson</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>de Groot, Elofsson</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007219" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">10 Dec 2019</named-content>
    </p>
    <p>PCOMPBIOL-D-19-01048R1 </p>
    <p>Revisiting the “satisfaction of spatial restraints” approach of MODELLER for protein homology modeling</p>
    <p>Dear Dr JANSON,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Laura Mallard</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
