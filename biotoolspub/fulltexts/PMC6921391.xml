<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6921391</article-id>
    <article-id pub-id-type="publisher-id">1852</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1852-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Genotype-free demultiplexing of pooled single-cell RNA-seq</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Jun</given-names>
        </name>
        <address>
          <email>jun.xu@uq.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Falconer</surname>
          <given-names>Caitlin</given-names>
        </name>
        <address>
          <email>caitlin@uqconnect.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nguyen</surname>
          <given-names>Quan</given-names>
        </name>
        <address>
          <email>quan.nguyen@imb.uq.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Crawford</surname>
          <given-names>Joanna</given-names>
        </name>
        <address>
          <email>j.crawford@imb.uq.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McKinnon</surname>
          <given-names>Brett D.</given-names>
        </name>
        <address>
          <email>b.mckinnon@imb.uq.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mortlock</surname>
          <given-names>Sally</given-names>
        </name>
        <address>
          <email>s.mortlock@imb.uq.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Senabouth</surname>
          <given-names>Anne</given-names>
        </name>
        <address>
          <email>a.senabouth@garvan.org.au</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Andersen</surname>
          <given-names>Stacey</given-names>
        </name>
        <address>
          <email>s.andersen2@uq.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chiu</surname>
          <given-names>Han Sheng</given-names>
        </name>
        <address>
          <email>h.chiu@imb.uq.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Longda</given-names>
        </name>
        <address>
          <email>longda.jiang@imb.uq.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Palpant</surname>
          <given-names>Nathan J.</given-names>
        </name>
        <address>
          <email>n.palpant@uq.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Jian</given-names>
        </name>
        <address>
          <email>jian.yang@uq.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff10">10</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mueller</surname>
          <given-names>Michael D.</given-names>
        </name>
        <address>
          <email>michel.mueller@insel.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hewitt</surname>
          <given-names>Alex W.</given-names>
        </name>
        <address>
          <email>hewitt.alex@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>PÃ©bay</surname>
          <given-names>Alice</given-names>
        </name>
        <address>
          <email>apebay@unimelb.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Montgomery</surname>
          <given-names>Grant W.</given-names>
        </name>
        <address>
          <email>g.montgomery1@uq.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Powell</surname>
          <given-names>Joseph E.</given-names>
        </name>
        <address>
          <email>j.powell@garvan.org.au</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4300-455X</contrib-id>
        <name>
          <surname>Coin</surname>
          <given-names>Lachlan J.M</given-names>
        </name>
        <address>
          <email>lachlan.coin@unimelb.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff11">11</xref>
        <xref ref-type="aff" rid="Aff12">12</xref>
        <xref ref-type="aff" rid="Aff13">13</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9320 7537</institution-id><institution-id institution-id-type="GRID">grid.1003.2</institution-id><institution>Genome Innovation Hub, The University of Queensland, </institution></institution-wrap>306 Carmody Road, St Lucia, Brisbane, QLD 4072 Australia </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9320 7537</institution-id><institution-id institution-id-type="GRID">grid.1003.2</institution-id><institution>Institute for Molecular Bioscience, The University of Queensland, </institution></institution-wrap>306 Carmody Road, St Lucia, Brisbane, QLD 4072 Australia </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 4902 0432</institution-id><institution-id institution-id-type="GRID">grid.1005.4</institution-id><institution>UNSW Cellular Genomics Futures Institute, </institution></institution-wrap>School of Medical Sciences, University of New South Wales, Sydney, NSW 2052 Australia </aff>
      <aff id="Aff4"><label>4</label>Garvan-Weizmann Centre for Cellular Genomics, Garvan Institute, 384 Victoria St, Darlinghurst, Sydney, NSW 2010 Australia </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0479 0855</institution-id><institution-id institution-id-type="GRID">grid.411656.1</institution-id><institution>Department of Obstetrics and Gynaecology, Berne University Hospital, </institution></institution-wrap>Bern, 3012 Switzerland </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2179 088X</institution-id><institution-id institution-id-type="GRID">grid.1008.9</institution-id><institution>Department of Anatomy and Neuroscience, The University of Melbourne, </institution></institution-wrap>Parkville, 3010 Australia </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2179 088X</institution-id><institution-id institution-id-type="GRID">grid.1008.9</institution-id><institution>Department of Surgery, The University of Melbourne, </institution></institution-wrap>Parkville, 3010 Australia </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0446 3256</institution-id><institution-id institution-id-type="GRID">grid.418002.f</institution-id><institution>Centre for Eye Research Australia, Royal Victorian Eye and Ear Hospital, </institution></institution-wrap>East Melbourne, 3002 Australia </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 826X</institution-id><institution-id institution-id-type="GRID">grid.1009.8</institution-id><institution>School of Medicine, Menzies Institute for Medical Research, University of Tasmania, </institution></institution-wrap>Hobart, 7005 Australia </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0348 3990</institution-id><institution-id institution-id-type="GRID">grid.268099.c</institution-id><institution>Institute for Advanced Research, Wenzhou Medical University, </institution></institution-wrap>Wenzhou, 325027 Zhejiang China </aff>
      <aff id="Aff11"><label>11</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2179 088X</institution-id><institution-id institution-id-type="GRID">grid.1008.9</institution-id><institution>Department of Microbiology and Immunology, The University of Melbourne, </institution></institution-wrap>Parkville, 3010 Australia </aff>
      <aff id="Aff12"><label>12</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2179 088X</institution-id><institution-id institution-id-type="GRID">grid.1008.9</institution-id><institution>Department of Clinical Pathology, The University of Melbourne, </institution></institution-wrap>Parkville, 3010 Australia </aff>
      <aff id="Aff13"><label>13</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2113 8111</institution-id><institution-id institution-id-type="GRID">grid.7445.2</institution-id><institution>Department of Infectious Disease, Imperial College London, </institution></institution-wrap>London, W2 1NY UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>290</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">A variety of methods have been developed to demultiplex pooled samples in a single cell RNA sequencing (scRNA-seq) experiment which either require hashtag barcodes or sample genotypes prior to pooling. We introduce scSplit which utilizes genetic differences inferred from scRNA-seq data alone to demultiplex pooled samples. scSplit also enables mapping clusters to original samples. Using simulated, merged, and pooled multi-individual datasets, we show that scSplit prediction is highly concordant with demuxlet predictions and is highly consistent with the known truth in cell-hashing dataset. scSplit is ideally suited to samples without external genotype information and is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/jon-xu/scSplit">https://github.com/jon-xu/scSplit</ext-link></p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>scSplit</kwd>
      <kwd>scRNA-seq</kwd>
      <kwd>Demultiplexing</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Unsupervised</kwd>
      <kwd>Hidden Markov Model</kwd>
      <kwd>Expectation-maximization</kwd>
      <kwd>Genotype-free</kwd>
      <kwd>Allele fraction</kwd>
      <kwd>Doublets</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>Â© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Using single-cell RNA sequencing (scRNA-seq) to cell biology at cellular level provides greater resolution than âbulkâ level analyses, thus allowing more refined understanding of cellular heterogeneity. For example, it can be used to cluster cells into sub-populations based on their differential gene expression, so that different fates of cells during development can be discovered. Droplet-based scRNA-seq (for example Drop-Seq [<xref ref-type="bibr" rid="CR1">1</xref>] or 10X Genomics Systems [<xref ref-type="bibr" rid="CR2">2</xref>]) allows profiling large numbers of cells for sequencing by dispersing liquid droplets in a continuous oil phase [<xref ref-type="bibr" rid="CR3">3</xref>]s in an automated microfluidics system, and as a result is currently the most popular approach to scRNA-seq despite a high cost per run. Methods that lower the per sample cost of running scRNA-seq are required in order to scale this approach up to a population scale. An effective method for lowering scRNA-seq cost is to pool samples prior to droplet-based barcoding with subsequent demultiplexing of sequence reads.</p>
    <p>Cell hashing [<xref ref-type="bibr" rid="CR4">4</xref>] based on Cite-seq [<xref ref-type="bibr" rid="CR5">5</xref>] is one such experimental approach to demultiplex pooled samples. This approach uses oligo-tagged antibodies to label cells prior to mixing, but use of these antibodies increases both the cost and sample preparation time per run. Moreover, it requires access to universal antibodies for organism of interest, thus limiting applicability at this stage to human and mouse. Alternatively, computational tools like demuxlet [<xref ref-type="bibr" rid="CR6">6</xref>] have been developed to demultiplex cells from multiple individuals, although this requires additional genotyping information to assign individual cells back to their samples of origin. This limits the utility of demuxlet, as genotype data might not be available for different species; biological material may not be available to extract DNA; or the genetic differences between samples might be somatic in origin.</p>
    <p>Another issue for droplet-based scRNA-seq protocols is the presence of doublets, which occurs when two cells are encapsulated in same droplet and acquire the same barcode. The proportion of doublets increases with increasing number of cells barcoded in a run. It is imperative that these are flagged and removed prior to downstream analysis. Demuxlet [<xref ref-type="bibr" rid="CR6">6</xref>] uses external genotype information to address this issue, and other tools have been developed to solve this issue based on expression data alone, including Scrublet [<xref ref-type="bibr" rid="CR7">7</xref>] and Doubletfinder [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p>Here we introduce a simple, accurate, and efficient tool, mainly for droplet-based scRNA-seq, called "scSplit", which uses a hidden state model approach to demultiplex individual samples from mixed scRNA-seq data with high accuracy. Our approach does not require genotype information from the individual samples to demultiplex them, which also makes it suitable for applications where genotypes are unavailable or difficult to obtain. scSplit uses existing bioinformatics tools to identify putative variant sites from scRNA-seq data, then models the allelic counts to assign cells to clusters using an expectation-maximisation framework.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p>Our new tool, scSplit for demultiplexing pooled samples from scRNA-seq data, only requires the FASTQ files obtained from single cell sequencing, together with a white-list of barcodes, while it does not require genotype data, nor a list of common variants if not available. Result data are available in <ext-link ext-link-type="uri" xlink:href="https://github.com/jon-xu/scSplit_paper_data">https://github.com/jon-xu/scSplit_paper_data</ext-link>.</p>
    <sec id="Sec3">
      <title>Simulation run showed high accuracy and efficiency of scSplit</title>
      <p>We used a single scRNA-seq BAM file from Zheng et al. [<xref ref-type="bibr" rid="CR2">2</xref>] as a template for simulation. Additionally, we took 32 samples from genoptype information used in figure 2 supplementary data of Kang et al. [<xref ref-type="bibr" rid="CR6">6</xref>], as the source of multi-sample genotype likelihoods for simulation (see â<xref rid="Sec22" ref-type="sec">Data simulation</xref>â in <xref rid="Sec10" ref-type="sec">Methods</xref>). We ran simulation tests using our scSplit tool and used the distinguishing variants to identify the individual donor for each cluster. In order to assess the accuracy of the method, we calculated both the proportion of cells from each cluster which were correctly assigned to it among the true correct number of cells in each cluster (True Positive Rate or TPR), as well as the proportion of cells assigned to a cluster which were incorrect against the total assigned cells (false discovery rate or FDR). We also report the average TPR and average FDR. We obtained very high overall TPR (0.97) and low FDR (less than 1e â4) for from 2- to 32-mixed samples, with very accurate doublet predictions (TableÂ <xref rid="Tab1" ref-type="table">1</xref>, Fig.Â <xref rid="Fig1" ref-type="fig">1</xref>a). To test the limit of our tool on genotype difference, we downloaded three pairs of full sibling genotypes from the UK Biobank and simulated pooled samples by mixing one pair at a time, the average singlet TPR was beyond 0.87 (Table S2 in Additional fileÂ <xref rid="MOESM2" ref-type="media">2</xref>).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Results on simulated, merged hash-tagged scRNA-seq datasets confirmed scSplit a useful tool to demultiplex pooled single cells. <bold>a</bold> Confusion matrix showing scSplit demultiplexing results on simulated 2-, 3-, 4- and 8-mix; <bold>b</bold> TPR and FDR of for singlets and doublets predicted by scSplit and demuxlet compared to known truth before merging; <bold>c</bold> TPR and FDR of for singlets and doublets predicted by scSplit and demuxlet compared to cell hashing tags</p></caption><graphic xlink:href="13059_2019_1852_Fig1_HTML" id="MO1"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Overview of accuracy and performance of scSplit on simulated mixed samples, with one CPU and 30GB RAM</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Simulation</th><th align="left">sim2</th><th align="left">sim3</th><th align="left">sim4</th><th align="left">sim8</th><th align="left">sim12</th><th align="left">sim16</th><th align="left">sim24</th><th align="left">sim32</th></tr></thead><tbody><tr><td align="left">Mixed samples</td><td align="left">2</td><td align="left">3</td><td align="left">4</td><td align="left">8</td><td align="left">12</td><td align="left">16</td><td align="left">24</td><td align="left">32</td></tr><tr><td align="left">Number of cells</td><td align="left">12 383</td><td align="left">12 383</td><td align="left">12 383</td><td align="left">12 383</td><td align="left">12 383</td><td align="left">12 383</td><td align="left">12 383</td><td align="left">12 383</td></tr><tr><td align="left">Reads per cell</td><td align="left">4 973</td><td align="left">4 973</td><td align="left">4 973</td><td align="left">4 973</td><td align="left">4 973</td><td align="left">4 973</td><td align="left">4 973</td><td align="left">4 973</td></tr><tr><td align="left">Informative SNVs</td><td align="left">34 116</td><td align="left">34 116</td><td align="left">34 116</td><td align="left">34 116</td><td align="left">34 116</td><td align="left">34 116</td><td align="left">34 116</td><td align="left">34 116</td></tr><tr><td align="left">Assigning cells</td><td align="left">41 min</td><td align="left">41 min</td><td align="left">46 min</td><td align="left">47 min</td><td align="left">1h54m</td><td align="left">2h11</td><td align="left">2h33</td><td align="left">2h55</td></tr><tr><td align="left">Singlet TPR</td><td align="left">0.97</td><td align="left">0.97</td><td align="left">0.97</td><td align="left">0.97</td><td align="left">0.97</td><td align="left">0.97</td><td align="left">0.96</td><td align="left">0.96</td></tr><tr><td align="left">Singlet FDR</td><td align="left">0</td><td align="left">9E â5</td><td align="left">9E â5</td><td align="left">9E â5</td><td align="left">0</td><td align="left">0</td><td align="left">5E â3</td><td align="left">8E â3</td></tr><tr><td align="left">Doublet TPR</td><td align="left">0.997</td><td align="left">0.997</td><td align="left">0.997</td><td align="left">0.997</td><td align="left">0.997</td><td align="left">0.997</td><td align="left">0.995</td><td align="left">0.997</td></tr><tr><td align="left">Doublet FDR</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left">Cohenâs Kappa</td><td align="left">1.0</td><td align="left">1.0</td><td align="left">1.0</td><td align="left">1.0</td><td align="left">1.0</td><td align="left">1.0</td><td align="left">0.97</td><td align="left">0.98</td></tr></tbody></table><table-wrap-foot><p>We used PBMC donor B [<xref ref-type="bibr" rid="CR2">2</xref>] and genotype data from demuxlet [<xref ref-type="bibr" rid="CR6">6</xref>] as simulation templates</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec4">
      <title>scSplit performed similarly well to demuxlet in demultiplexing merged individually sequenced three stromal samples</title>
      <p>We then tried running scSplit on a manual merging of three individually sequenced samples. We merged the BAM files from three individual samples (<xref rid="Sec10" ref-type="sec">Methods</xref>). In order to create synthetic doublets, we randomly chose 500 barcodes whose reads were merged with another 500 barcodes. We ended up with 9067 singlets and 500 doublets, knowing their sample origins prior to merging. Both scSplit and demuxlet [<xref ref-type="bibr" rid="CR6">6</xref>] pipelines were run on the merged samples, and the results were compared with the known individual sample data. We observed high concordance of singlet prediction between both tools (TPR/FDR: 0.94/0.02 vs 0.93/0.02), and a better doublet prediction from scSplit compared to demuxlet (TPR/FDR: 0.65/0.04 vs 0.66/0.47) (Fig.Â <xref rid="Fig1" ref-type="fig">1</xref>b and TableÂ <xref rid="Tab2" ref-type="table">2</xref>). We then downsampled the mixed sample to 2800 reads per cell in order to test the performance under low sequencing depth and the overall result was still good (TPR = 0.91, FDR = 0.03), which indicated that scSplit can work under shallow read depth.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of scSplit and demuxlet performance in demultiplexing merged three individually genotyped stromal samples (<italic>TPR</italic> true positive rate, <italic>FDR</italic> false discovery rate); Total cell numbers: 9567; Reads per cell: 14,495; Informative SNVs: 63,129; Runtime for matrices building: 67 min, Runtime for cell assignment: 55 min</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2">Predictions vs Truth</th><th align="left">TPR</th><th align="left">FDR</th><th align="left">Cohenâs Kappa</th></tr></thead><tbody><tr><td align="left">scSplit</td><td align="left">Singlet</td><td align="left">0.94</td><td align="left">0.02</td><td align="left">0.95</td></tr><tr><td align="left"/><td align="left">Doublet</td><td align="left">0.65</td><td align="left">0.04</td><td align="left"/></tr><tr><td align="left">demuxlet</td><td align="left">Singlet</td><td align="left">0.93</td><td align="left">0.02</td><td align="left">0.77</td></tr><tr><td align="left"/><td align="left">Doublet</td><td align="left">0.66</td><td align="left">0.47</td><td align="left"/></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec5">
      <title>scSplit predictions highly consistent with known source of hashtagged and pooled eight PBMC samples</title>
      <p>Next, we tested scSplit on a published scRNA-seq dataset (GSE108313) which used cell-hashing technology to mark samples of the cells before multiplexing [<xref ref-type="bibr" rid="CR4">4</xref>]. We ran through the scSplit pipeline with the SNVs filtered by common SNVs provided on The International Genome Sample Resource (IGSR) [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
      <p>According to the scSplit pipeline, distinguishing variants were identified, and the P/A matrix was generated to assign the cells to clusters (<xref rid="Sec10" ref-type="sec">Methods</xref>). We then extracted the reference and alternative allele absence information at these distinguishing variants from the sample genotypes and generated a similar P/A matrix. Both matrices were compared so that clusters were mapped to samples (Figure S1 in Additional fileÂ <xref rid="MOESM1" ref-type="media">1</xref>).</p>
      <p>Our results were highly consistent with the known cell hashing tags (TableÂ <xref rid="Tab3" ref-type="table">3</xref>). We saw higher TPR for singlets in scSplit (0.98) than demuxlet (0.79) and similar singlet FDRs (0.10 vs 0.13). Although the doublet TPR of scSplit (0.35) was lower than for demuxlet (0.65), the doublet FDR (0.28) was better than demuxlet (0.46). If the expected number of doublets was selected higher, cells with largest read depth could be moved from singlet clusters to the doublet cluster to increase the TPR for doublets with a decrease of TPR for singlets.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Comparison of scSplit and demuxlet performance in demultiplexing hashtagged and multiplexed eight individually genotyped PBMC samples (<italic>TPR</italic> true positive rate, <italic>FDR</italic> false discovery rate); total cell numbers: 7932; reads per cell: 5835; informative SNVs: 16,058; runtime for matrices building: 35 min, runtime for cell assignment: 20 min</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2">Predictions vs Truth</th><th align="left">TPR</th><th align="left">FDR</th><th align="left">Cohenâs Kappa</th></tr></thead><tbody><tr><td align="left">scSplit</td><td align="left">Singlet</td><td align="left">0.98</td><td align="left">0.13</td><td align="left">0.75</td></tr><tr><td align="left"/><td align="left">Doublet</td><td align="left">0.35</td><td align="left">0.28</td><td align="left"/></tr><tr><td align="left">demuxlet</td><td align="left">Singlet</td><td align="left">0.79</td><td align="left">0.10</td><td align="left">0.74</td></tr><tr><td align="left"/><td align="left">Doublet</td><td align="left">0.65</td><td align="left">0.46</td><td align="left"/></tr></tbody></table></table-wrap></p>
      <p>We also compared the performance of overall P/A genotyping matrices generated based on scSplit and demuxlet predictions against that from the known genotypes (â<xref rid="Sec20" ref-type="sec">Alternative allele presence/absence genotyping for clusters</xref>â section of <xref rid="Sec10" ref-type="sec">Methods</xref>). The results show that genotypes inferred from both scSplit and demuxlet predictions have good concordance with sample genotypes (Table S1 in Additional fileÂ <xref rid="MOESM2" ref-type="media">2</xref>).</p>
    </sec>
    <sec id="Sec6">
      <title>Comparing scSplit with demuxlet on more pooled scRNA-seq samples</title>
      <p>We ran scSplit with common SNV filtering on published data from the demuxlet paper [<xref ref-type="bibr" rid="CR6">6</xref>]. By taking demuxlet predictions as ground truth, we achieved high singlet TPR (0.80), although the doublet prediction of the two tools were quite distinct to each other (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>a and TableÂ <xref rid="Tab4" ref-type="table">4</xref>).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Results of scSplit on pooled PBMC scRNA-seq and that on a set of pooled fibroblast samples. <bold>a</bold> Singlet TPR and FDR compared to demuxlet predictions on pooled PBMC scRNA-seq. <bold>b</bold> Violin plot of singlet TPR and FDR for five 7- or 8-mixed samples based on scSplit vs demuxlet</p></caption><graphic xlink:href="13059_2019_1852_Fig2_HTML" id="MO2"/></fig>
<table-wrap id="Tab4"><label>Table 4</label><caption><p>Comparison of scSplit and demuxlet performance in demultiplexing multiplexed eight individually genotyped PBMC samples (<italic>TPR</italic> true positive rate, <italic>FDR</italic> false discovery rate); total cell numbers: 6145; reads per cell: 33,119; informative SNVs: 22,757; runtime for matrices building: 45 min; runtime for cell assignment: 35 min</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">scSplit vs demuxlet</th><th align="left">TPR</th><th align="left">FDR</th><th align="left">Cohenâs Kappa</th></tr></thead><tbody><tr><td align="left">Singlets</td><td align="left">0.80</td><td align="left">0.18</td><td align="left">0.63</td></tr><tr><td align="left">Doublets</td><td align="left">0.12</td><td align="left">0.92</td><td align="left"/></tr></tbody></table></table-wrap></p>
      <p>We also ran our tool on a set of genotyped and then pooled fibroblast scRNA-seq datasets. Predictions from scSplit and demuxlet showed high concordance in singlet prediction (TPR: 0.93â0.94, FDR: 0.06â0.07), although not on doublets (TPR: 0.08â0.52, FDR: 0.45â0.92) when demuxlet was treated as gold standard (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>b and TableÂ <xref rid="Tab5" ref-type="table">5</xref>). Mapping between clusters and samples were recorded (Figure S2 in Additional fileÂ <xref rid="MOESM1" ref-type="media">1</xref>).
<table-wrap id="Tab5"><label>Table 5</label><caption><p>Overview of accuracy and performance running scSplit on five multiplexed scRNA-seq datasets, with one CPU and 30 GB RAM</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">scSplit vs demuxlet</th><th align="left">Mix 1</th><th align="left">Mix 2</th><th align="left">Mix 3</th><th align="left">Mix 4</th><th align="left">Mix 5</th></tr></thead><tbody><tr><td align="left">Mixed samples</td><td align="left">7</td><td align="left">8</td><td align="left">8</td><td align="left">8</td><td align="left">7</td></tr><tr><td align="left">Number of cells</td><td align="left">914</td><td align="left">8 137</td><td align="left">5 165</td><td align="left">6 977</td><td align="left">7 428</td></tr><tr><td align="left">Reads per cell</td><td align="left">86 148</td><td align="left">16 386</td><td align="left">21 265</td><td align="left">18 572</td><td align="left">19 657</td></tr><tr><td align="left">informative SNVs</td><td align="left">15 848</td><td align="left">26 830</td><td align="left">26 162</td><td align="left">23 224</td><td align="left">41 993</td></tr><tr><td align="left">Build matrices</td><td align="left">10 min</td><td align="left">23 min</td><td align="left">18 min</td><td align="left">21 min</td><td align="left">35 min</td></tr><tr><td align="left">Assign cells</td><td align="left">4 min</td><td align="left">47 min</td><td align="left">23 min</td><td align="left">45 min</td><td align="left">50 min</td></tr><tr><td align="left">Singlet TPR</td><td align="left">0.94</td><td align="left">0.93</td><td align="left">0.94</td><td align="left">0.93</td><td align="left">0.93</td></tr><tr><td align="left">Singlet FDR</td><td align="left">0.06</td><td align="left">0.07</td><td align="left">0.06</td><td align="left">0.07</td><td align="left">0.07</td></tr><tr><td align="left">Doublet TPR</td><td align="left">0.52</td><td align="left">0.17</td><td align="left">0.15</td><td align="left">0.17</td><td align="left">0.08</td></tr><tr><td align="left">Doublet FDR</td><td align="left">0.48</td><td align="left">0.83</td><td align="left">0.85</td><td align="left">0.83</td><td align="left">0.92</td></tr><tr><td align="left">Cohenâs Kappa</td><td align="left">0.86</td><td align="left">0.78</td><td align="left">0.68</td><td align="left">0.77</td><td align="left">0.76</td></tr></tbody></table><table-wrap-foot><p>(TPR: True Positive Rate; FDR: False Discovery Rate)</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec7">
      <title>Pooling samples together showed similar effects as normalizing individually sequenced samples</title>
      <p>We further checked the gene expression profiles of the previously illustrated three individual stromal samples (Fig.Â <xref rid="Fig1" ref-type="fig">1</xref>b and TableÂ <xref rid="Tab2" ref-type="table">2</xref>). We plotted Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP) [<xref ref-type="bibr" rid="CR10">10</xref>] for non-pooled and pooled scenarios with and without normalization. The samples were more separated from each other in non-pooled and non-normalized scenario (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>a), and got less distant for other scenarios including non-pooled but normalized (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>b), pooled and non-normalized (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>c), and pooled and normalized (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>d). We calculated Silhouette values for each of the UMAPs and got 0.28 for Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>a, 0.12 for Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>b, 0.14 for Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>c, and 0.19 for Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>d. As bigger Silhouette values indicate larger difference between samples, we could say both normalization and pooling could reduce the batch effects between individually sequenced samples. However, by pooling samples together for sequencing could minimize the potential information loss during normalization.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Batch effect during sequencing runs found in comparison of individual runs was obvious compared to that in pooled scRNA-seq data. <bold>a</bold> UMAP for three individually sequenced samples. <bold>b</bold> UMAP for three individually sequenced and normalized samples. <bold>c</bold> UMAP for pooled sequencing of same three individual samples, samples marked based on demultiplexing results using scSplit. <bold>d</bold> UMAP for pooled sequencing of same three individual samples, normalized by total sample reads</p></caption><graphic xlink:href="13059_2019_1852_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="discussion">
    <title>Discussion</title>
    <p>We developed the scSplit toolset to facilitate accurate, cheap, and fast demultiplexing of mixed scRNA samples, without needing sample genotypes prior to mixing. scSplit also generates a minimum set of alleles (as few as the sample numbers), enabling researchers to link the resulting clusters with the actual samples by comparing the allele presence at these distinguishing loci. When predefined individual genotypes are not available as a reference, this can be achieved by designing a simple assay focused on these distinguishing variants (such as a Massarray or multiplexed PCR assay). Although the tool was mainly designed for droplet-based scRNA-seq, it can also be used for scRNA-seq data generated from other types of scRNA-seq protocols.</p>
    <p>We filtered out indels, MNPs, and complex rearrangements when building the model and were able to show that SNVs alone provide adequate information to delineate the differences between multiple samples. As an alternative to using allele fractions to model multiple samples, genotype likelihoods could also be used for the same purpose; however, more memory and running time would likely be needed, especially when barcode numbers in mixed sample experiments increase. Our tests showed no discernable difference in accuracy between these two methods.</p>
    <p>The current version of scSplit assumes that the number of mixed samples is known. It is possible to run the scSplit tool for different sample numbers and compare the model log-likelihoods to select the most likely number of samples being modeled, but this would require significant computational resources and time. Alternatively, the reference and alternative allele counts in different samples and the size of the doublet cluster could be used to determine the sample number. Further optimization of the tool would be needed to effectively implement these options.</p>
    <p>Although scSplit was mainly tested on human samples, it can also be applied to other organisms and is especially useful for those species without dense genotyping chips available. We also expect the application of scSplit in cancer -related studies, to distinguish tumor cells from healthy cells, as well as to distinguish tumor sub-clones.</p>
  </sec>
  <sec id="Sec9" sec-type="conclusion">
    <title>Conclusions</title>
    <p>scSplit is an accurate, fast, and computationally efficient method with which to conduct demultiplexing of individual cells from pooled samples of scRNA-seq. In the next version, we plan to enable auto-detection of the mixed sample number, which will help to broaden the application of our tool to more biological and medical research areas, including but not limited to, distinguishing mixed infections, delineating tumor sub-clones and sequence analysis in non-model organisms.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <p>All relevant source code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/jon-xu/scSplit/">https://github.com/jon-xu/scSplit/</ext-link>.</p>
    <sec id="Sec11">
      <title>Overview</title>
      <p>The overall pipeline for the scSplit tool includes seven major steps (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>):
<list list-type="order"><list-item><p>Data quality control and filtering: The mixed sample BAM file is first filtered to keep only the reads with a list of valid barcodes to reduce technical noise. Additional filtering is then performed to remove reads that meet any of the following: mapping quality score less than 10, unmapped, failing quality checks, secondary or supplementary alignment, or PCR or optical duplicate. The BAM file is then marked for duplication, sorted and indexed.
<fig id="Fig4"><label>Fig. 4</label><caption><p>The overall pipeline of scSplit tool. <bold>a</bold> SNV identified based on reads from all cells which have similar or different genotypes. <bold>b</bold> Alternative and reference allele count matrices built from each read in the pooled-sequenced BAM at the identified informative SNVs. <bold>c</bold> Initial allele fraction model constructed from the initial cell seeds and their allele counts. <bold>d</bold> Expectation-maximization process to find the most optimized allele fraction model, based on which the cells are assigned to clusters. <bold>e</bold> Presence/Absence matrix of alternative alleles generated from the cell assignments. <bold>f</bold> Minimum set of distinguishing variants found to be used to map clusters with samples</p></caption><graphic xlink:href="13059_2019_1852_Fig4_HTML" id="MO4"/></fig></p></list-item><list-item><p>SNV calling (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>a): Freebayes v1.2 [<xref ref-type="bibr" rid="CR11">11</xref>] is used to call SNVs on the filtered BAM file, set to ignore insertions and deletions (indels), multi-nucleotide polymorphisms (MNPs), and complex events. A minimum base quality score of one and minimum allele count of two is required to call a variant. The output VCF file is further filtered to keep only SNVs with quality scores greater than 30.</p></list-item><list-item><p>Building allele count matrices (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>b): The âmatrices.pyâ script is run which produces two.csv files, one for each of reference and alternate allele counts as output.</p></list-item><list-item><p>Model initialization (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>c): find the distinct groups of cells in the scRNA-seq and use them to initialize the Allele Fraction Model (SNVs by samples).</p></list-item><list-item><p>E-M iterations till convergence (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>d): Initialized allele fraction model and the two allele count matrices are used together to calculate the probability of each cell belonging to the clusters. After each round, allele fraction model is updated based on the probability of cell assignment and this is iterated until overall likelihood of the model reaches convergence.</p></list-item><list-item><p>Alternative presence/absence genotypes (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>e): matrix indicating cluster genotypes at each SNV is built in this step.</p></list-item><list-item><p>Find distinguishing variants for clusters and use to assign samples to clusters (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>f): In order to assign each model cluster back to the specific sample, distinguishing variants are identified so that genotyping of the least number of loci using the a suitable platform may be performed. Gram-Schmidt orthogonalization [<xref ref-type="bibr" rid="CR12">12</xref>] is used to get the minimum set of informative P/A genotypes.</p></list-item></list></p>
    </sec>
    <sec id="Sec12">
      <title>Data quality control</title>
      <p>Samtools was used to filter the reads with verified barcodes for mapping and alignment status, mapping quality, and duplication (samtools view -S -bh -q 10 -F 3844 [input] &gt;[output]). Duplicates were removed (samtools rmdup [input] [output]) followed by sorting and indexing.</p>
    </sec>
    <sec id="Sec13">
      <title>SNV calling on scRNA-seq dataset</title>
      <p>SNVs were called on the scRNA-seq mixed sample BAM file with freebayes [<xref ref-type="bibr" rid="CR11">11</xref>], a widely used variant calling tool. The freebayes arguments â-iXu -q 1â were set to ignore indels and MNPs and exclude alleles with supporting base quality scores of less than one. This generated a VCF file containing all SNVs from the mixed sample BAM file. Common SNPs of a population (for example results from The international Genome Sample Resource [<xref ref-type="bibr" rid="CR9">9</xref>]) were recommended be used to filter out noisy SNVs.</p>
    </sec>
    <sec id="Sec14">
      <title>Building allele count matrices</title>
      <p>Allele count matrices were then built from (1) the provided mixed sample BAM file and (2) the VCF file obtained from the SNV calling program. Two allele count matrices were generated, one for the reference alleles and one for the alternate alleles, each with SNVs in rows and barcodes in columns. Each data element in the matrix indicated either the number of reference or alternate alleles detected in one cell barcode at that specific SNV position. This provided a full map of the distribution of reference and alternate alleles across all barcodes at each SNV.</p>
      <p>The allele count matrices captured information from all reads overlapping SNVs to reflect the different allele fraction patterns from different barcodes or samples. To build the allele count matrices, pysam fetch [<xref ref-type="bibr" rid="CR13">13</xref>] was used to extract reads from the BAM file. The reads overlapping each SNV position were fetched and counted for the presence of the reference or alternate allele. In order to increase overall accuracy and efficiency, SNVs whose GL(RA)(likelihood of heterozygous genotypes) was lower than log10(1â<italic>e</italic><italic>r</italic><italic>r</italic><italic>o</italic><italic>r</italic>) where error = 0.01 were filtered out. These were more homozygous and thus less informative for detecting the differences between the multiple samples. The generated matrices were exported</p>
    </sec>
    <sec id="Sec15">
      <title>Model initialization by using maximally informative cluster representatives</title>
      <p>To initialize the model, initial probabilities of observing an alternative allele on each SNV position in each cluster were calculated. The overall matrix was sparse and a dense sub-matrix with a small number of zero count cells was generated. To do that, cells were first sorted according to their number of zero allele counts (sum of reference and alternative alleles) at all SNVs and SNVs were similarly sorted according to their number of zero allele counts (sum of reference and alternative alleles) across all cells. Next, we selected and filtered out 10% of the cells among those with the most number of zero expressed SNVs and 10% of the SNVs among those where the most number cells had zero counts. This was repeated until all remaining cells had more than 90% of their SNVs with non-zero allele counts and all SNVs had non-zero counts in more than 90% of cells. This subset of matrices was the basis for the seed barcodes to initialize the whole model. The sub-matrix was transformed using PCA with reduced dimensions and then K-means clustering was performed to split the cell subset into expected number of clusters. By using the allele fractions on the subset of SNVs in these initially assigned cells, each cluster of the model could be initialized. Let <italic>N</italic>(<italic>A</italic><sub><italic>c</italic>,<italic>v</italic></sub>) and <italic>N</italic>(<italic>R</italic><sub><italic>c</italic>,<italic>v</italic></sub>) be the Alternative and Reference allele counts on SNV <italic>v</italic> and cell <italic>c</italic> accordingly, and let pseudo <sub><italic>A</italic></sub><italic>R</italic> be the pseudo allele count for both Alternative and Reference alleles, and pseudo <sub><italic>A</italic></sub> be the pseudo allele count for Alternative alleles, we calculated <italic>P</italic>(<italic>A</italic><sub><italic>v</italic></sub>|<italic>S</italic><sub><italic>n</italic></sub>), the probability of observing Alternative allele on SNV <italic>v</italic> in Sample <italic>n</italic>, according to below equation:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ P(A_{v}|S_{n}) = \frac{\left[\sum\limits_{c}N(A_{c,v}) + \text{pseudo}_{A}) \right]} {\left[\sum\limits_{c}N(A_{c,v}) + \sum\limits_{c}N(R_{c,v}) + \text{pseudo}_{AR} \right]}  $$ \end{document}</tex-math><mml:math id="M2"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>pseudo</mml:mtext></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>pseudo</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1852_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>We also initiated the probability of seeing the <italic>n</italic>th sample as evenly distributed across all samples. Let <italic>P</italic>(<italic>S</italic><sub><italic>n</italic></sub>) be the probability of seeing the <italic>n</italic>-th sample, and <italic>N</italic>(<italic>S</italic>) be the number of samples to be demultiplexed:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ P(S_{n}) = \frac{1}{N(S)}  $$ \end{document}</tex-math><mml:math id="M4"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1852_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec16">
      <title>Expectationâmaximization approach</title>
      <p>The expectation-maximization (EM) algorithm [<xref ref-type="bibr" rid="CR14">14</xref>] was used to conduct iterations using the full allele count matrices (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>). Each iteration consisted of an E-step to calculated the probability of seeing cells in all clusters, based on the allele fraction model, and an M-step to use the new probability of seeing cells in all clusters to update the allele fraction model. EM iterations stopped when convergence was reached, so that the overall probability of observing the cells, or the reference/alternative alleles count matrices, was maximized.</p>
      <p>During the E-step, the tool first calculated <italic>P</italic>(<italic>C</italic><sub><italic>i</italic></sub>|<italic>S</italic><sub><italic>n</italic></sub>), the likelihood of observing a cell <italic>C</italic><sub><italic>i</italic></sub> in sample <italic>S</italic><sub><italic>n</italic></sub>, which was equal to the product of the probability of observing the allele fraction pattern over each SNV, which in turn equaled to the product of probability of having observed the count of alternative alleles and probability of having observed the count of reference alleles. Let <italic>c</italic><sub><italic>i</italic></sub> be the i-th cell, <italic>S</italic><sub><italic>n</italic></sub> be the n-th sample, <italic>A</italic><sub><italic>v</italic></sub> be the Alternative allele on SNV v, and N(A), N(R) be the quantity of Alternative and Reference alleles:
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\begin{aligned} P(C_{i}|S_{n}) &amp;= P(A_{c_{i}}, R_{c_{i}}|S_{n}) \\&amp;= \prod\limits_{v}\left[P(A_{v}|S_{n})^{N(A_{c_{i},v})}[1\,-\,P(A_{v}|S_{n})]^{N(R_{c_{i},v})}\right] \end{aligned}}  $$ \end{document}</tex-math><mml:math id="M6"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>P</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.3em"/><mml:mo>â</mml:mo><mml:mspace width="0.3em"/><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1852_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>And then <italic>P</italic>(<italic>C</italic><sub><italic>i</italic></sub>|<italic>S</italic><sub><italic>n</italic></sub>) was transformed to <italic>P</italic>(<italic>S</italic><sub><italic>n</italic></sub>|<italic>C</italic><sub><italic>i</italic></sub>), the cell-sample probability, i.e. the probability of a cell <italic>C</italic><sub><italic>i</italic></sub> belonging to sample <italic>S</italic><sub><italic>n</italic></sub>, using Bayesâ theorem, assuming equal sample prior probabilities (<italic>P</italic>(<italic>S</italic><sub>1</sub>) = <italic>P</italic>(<italic>S</italic><sub>2</sub>) =... = <italic>P</italic>(<italic>S</italic><sub><italic>n</italic></sub>)):
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ P(S_{n}|C_{i}) = \frac{P(C_{i}|S_{n})}{\sum\limits_{x=1}^{N}P(C_{i}|S_{x})}  $$ \end{document}</tex-math><mml:math id="M8"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1852_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Next, weighted allele counts were distributed to the different cluster models according to the cell-sample probability, followed by the M-step, where the allele fraction model represented by the alternative allele fractions was updated using the newly distributed allele counts, so that allele fractions at all SNV positions in each sample model were recalculated:
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ P(A_{v}|S_{n}) = \frac{\sum\limits_{i}N(A_{c,v})P(S_{n}|C_{i})+\text{pseudo}_{A}}{\sum\limits_{i}N(T_{c,v})P(S_{n}|C_{i})+\text{pseudo}_{AR}}  $$ \end{document}</tex-math><mml:math id="M10"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>pseudo</mml:mtext></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>pseudo</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AR</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1852_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>And the sample probability <italic>P</italic>(<italic>S</italic><sub><italic>n</italic></sub>) was also updated by the newly calculated cell likelihoods:
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ P(S_{n}) = \frac{\sum\limits_{i}P(S_{n}|C_{i})}{\sum\limits_{n}\sum\limits_{i}P(S_{n}|C_{i})}  $$ \end{document}</tex-math><mml:math id="M12"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1852_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The overall log-likelihood of the whole model [<xref ref-type="bibr" rid="CR15">15</xref>] was calculated as:
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\begin{aligned} \mathcal{L}_{\text{model}} &amp;= \sum\limits_{i}\log\sum\limits_{n}P(C_{i}|S_{n}) \\&amp;= \sum\limits_{i}\log\sum\limits_{n}\prod\limits_{v}\left[P(C_{i,v}|S_{n,v})P(S_{n})\right] \end{aligned}}  $$ \end{document}</tex-math><mml:math id="M14"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="script">â</mml:mi></mml:mrow><mml:mrow><mml:mtext>model</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1852_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec17">
      <title>Multiple runs to avoid local maximum likelihood</title>
      <p>The entire process was repeated for 30 rounds with the addition of randomness during model initialization and the round with the largest sum of log likelihood was taken as the final result. Randomness was introduced by randomly selecting the 10% of cells and SNVs to be removed from the matrices during initialization from a range of the lowest ranked cells and SNVs as detailed previously.</p>
    </sec>
    <sec id="Sec18">
      <title>Cell cluster assignment</title>
      <p>Next, probability of a cell belonging to a cluster <italic>P</italic>(<italic>S</italic><sub><italic>n</italic></sub>|<italic>C</italic><sub><italic>i</italic></sub>) was calculated. Cells were assigned to a cluster based on a minimum threshold of <italic>P</italic> &gt; 0.99. Those cells with no <italic>P</italic>(<italic>S</italic><sub><italic>n</italic></sub>|<italic>C</italic><sub><italic>i</italic></sub>) larger than the threshold were regarded as unassigned.</p>
    </sec>
    <sec id="Sec19">
      <title>Handling of doublets</title>
      <p>During scRNA-seq experiments, a small proportion of droplets can contain cells from more than one sample. These so called doublets, contain cells from same or different samples sharing the same barcode, which if not addressed would cause bias. Our model took these doublets into consideration. During our hidden state based demultiplexing approach, we included an additional cluster so that doublets could be captured. To identify which cluster in the model was the doublet cluster in each round, the sum of log-likelihood of cross assignments was checked:
<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ P(c ~is~ \text{doublet}) = \sum\limits_{i\notin c}\prod\limits_{v}\left[P(C_{i,v}|S_{c,v})P(S_{c})\right]  $$ \end{document}</tex-math><mml:math id="M16"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mspace width="1em"/><mml:mtext mathvariant="italic">is</mml:mtext><mml:mspace width="1em"/><mml:mtext>doublet</mml:mtext><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>â</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>â</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1852_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The sum log-likelihood of cells from all other clusters being assigned to a specific cluster was calculated for each cluster in turn and compared. The cluster with the largest sum log-likelihood of cross assignment was designated as the doublet cluster. We allow user input on the expected proportion of doublets. If the expected number of doublets was larger than those detected in the doublet cluster, cells with largest read depth were moved from singlet clusters to doublet cluster, so that the total number of doublets meet expectation as input.</p>
    </sec>
    <sec id="Sec20">
      <title>Alternative allele presence/absence genotyping for clusters</title>
      <p>To identify a minimum set of variants, which can distinguish between sample clusters, we generated alternative allele P/A genotype matrix (SNVs by clusters). To do that, sum of reference and alternate allele counts across all cells assigned to each cluster were calculated. And for each SNV and each cluster, âPâ was marked if there were more than 10 alternative allele counts, and âAâ for more than 10 reference allele counts but no alternative allele count. "NA" was set if neither criterion was met.</p>
    </sec>
    <sec id="Sec21">
      <title>Mapping clusters back to individual samples using minimal set of P/A genotypes</title>
      <p>Based on the P/A matrix, we started from informative SNVs which had variations of âPâ or âAâ across clusters and avoid picking those with âNAsâ. Then, unique patterns involved in those SNVs were derived and for each unique P/A pattern, one allele was selected to subset the whole matrix. Next, Gram-Schmidt orthogonalization [<xref ref-type="bibr" rid="CR12">12</xref>] was applied on the subset of P/A matrix, in order to find the variants which can be basis vectors to effectively distinguish the clusters. If not enough SNVs were found to distinguish all the clusters, the clusters were split into smaller groups so that for each group there was enough variants to distinguish the clusters within that group. And to distinguish clusters from different smaller groups, if the selected variants could not be used to distinguish any pair of clusters, additional variants were selected from the whole list of variants where no NAs were involved and P/A was different between the pair of clusters. Ideal situation was N variants for N clusters, but it was possible that &gt;N variants were needed to distinguish N clusters.</p>
      <p>As such, the P/A genotyping of each cluster, on the minimum set of distinguishing variants, could be used as a reference to map samples to clusters. After running genotyping on this minimum set of loci for each of the individual samples, a similar matrix based on sample genotypes could be generated, by setting the alternative presence flag when genotype probability (GP) was larger than 0.9 for RA or AA, or absence flag when GP was larger than 0.9 for RR. By comparing both P/A matrices, we could link the identified clusters in scSplit results to the actual individual samples.</p>
      <p>In practice, samples can be genotyped only on the few distinguishing variants, so that scSplit-predicted clusters can be mapped with individual samples, while the whole genotyping is not needed. When the whole genotyping is available, we also provide an option for users to generate distinguishing variants only from variants with R2 &gt;0.9, so that they can compare the distinguishing matrix from scSplit with that from known genotypes on more confident variants.</p>
    </sec>
    <sec id="Sec22">
      <title>Data simulation</title>
      <p>To test the consistency of the model, and the performance of our demultiplexing tool, reference/alternative count matrices were simulated from a randomly selected scRNA-seq BAM file from Zheng et al. [<xref ref-type="bibr" rid="CR2">2</xref>] and a 32-sample VCF file used in Fig. 2 supplementary data of Kang et al. [<xref ref-type="bibr" rid="CR6">6</xref>]. We assume the randomly selected BAM file had a representative gene expression profile.</p>
      <p>First, data quality was checked and the BAM and VCF files were filtered. Second, barcodes contained in the BAM file were randomly assigned to samples in the VCF file, which gave us the gold-standard of cell-sample assignments to check against after demultiplexing. Then, all the reads in the BAM file were processed, that if a read overlapped with any SNV position contained in the merged VCF file, its barcode was checked to get its assigned sample and the probability <italic>P</italic>(<italic>A</italic><sub><italic>c</italic>,<italic>v</italic></sub>) of having the alternative allele for that sample was calculated using the logarithm-transformed genotype likelihood (GL) or genotype probability (GP) contained in the VCF file. The probability of an allele being present at that position could then be derived so that the ALT/REF count at the SNV/barcode in the matrices could be simulated based on the alternative allele probability. Let <inline-formula id="IEq1"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {L}(AA)$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="script">â</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">AA</mml:mtext><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2019_1852_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {L}(RA)$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="script">â</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">RA</mml:mtext><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2019_1852_Article_IEq2.gif"/></alternatives></inline-formula> be the likelihood of seeing AA and RA of a certain cell c on a certain SNV v:
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {P(A_{c,v}) = \frac{1}{2}10^{[\log_{10}\mathcal{L}(RA)]}+ 10^{[\log_{10}\mathcal{L}(AA)]}}  $$ \end{document}</tex-math><mml:math id="M22"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:munder><mml:mi mathvariant="script">â</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">RA</mml:mtext><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:munder><mml:mi mathvariant="script">â</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">AA</mml:mtext><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:msup></mml:math><graphic xlink:href="13059_2019_1852_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Finally, doublets were simulated by merging randomly chosen 3% barcodes with another 3% without overlapping in the matrix. This was repeated for every single read in the BAM file. This simulation modeled the number of reads mapped to the reference and alternative alleles directly. In our simulations, there were 61 576 853 reads in the template BAM file for 12 383 cells, which was equivalent to 4973 rpc.</p>
      <p>With the simulated allele fraction matrices, the barcodes were demultiplexed using scSplit and the results were compared with the original random barcode sample assignments to validate.</p>
    </sec>
    <sec id="Sec23">
      <title>Result evaluation</title>
      <p>We used both TPR/FDR and Cohenâs Kappa [<xref ref-type="bibr" rid="CR16">16</xref>] to evaluate the demultiplexing results against ground truth. R package âclusterâ [<xref ref-type="bibr" rid="CR17">17</xref>] was used in evaluating the clusters on UMAPs in Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>.</p>
    </sec>
    <sec id="Sec24">
      <title>Single cell RNA-seq data used in testing scSplit</title>
      <p>In TablesÂ <xref rid="Tab3" ref-type="table">3</xref> and <xref rid="Tab4" ref-type="table">4</xref>, we used published hashtagged data from GSE108313 and PBMC data from GSE96583. For TablesÂ <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab5" ref-type="table">5</xref>, endometrial stromal cells cultured from 3 women and fibroblast cells cultured from 38 healthy donors over the age of 18 years respectively were run through the 10x Genomics Chromium 3â scRNA-seq protocol. The libraries were sequenced on the Illumina Nextseq 500. FASTQ files were generated and aligned to Homo sapiens GRCh38p10 using Cell Ranger. Individuals were genotyped prior to pooling using the Infinium PsychArray.</p>
    </sec>
    <sec id="Sec25">
      <title>Full sibling data from UK biobank used in simulation</title>
      <p>In Table S2 in Additional fileÂ <xref rid="MOESM2" ref-type="media">2</xref>, we used genotype data of three pairs of full siblings from UK Biobank, which contained 564 981 SNVs, from which we used 258 077 SNVs within gene ranges, provided on the resource website of plink [<xref ref-type="bibr" rid="CR18">18</xref>]: <ext-link ext-link-type="uri" xlink:href="https://www.cog-genomics.org/plink/1.9/resources">https://www.cog-genomics.org/plink/1.9/resources</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec26">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1852_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold><bold>Figure S1</bold>. Illustration of presence absence matrices calculated on pooled and hashtagged scRNA-seq datasets. <bold>Figure S2</bold>. Illustration of presence absence matrices calculated on pooled fibroblast scRNA-seq datasets.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1852_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2</bold><bold>Table S1</bold>. Accuracy of alternative allele Presence/Absence genotypes built from scSplit/demuxlet clusters compared with that from sample genotyping, based on Hashtag scRNA-seq dataset. <bold>Table S2</bold>. Simulation using full sibling genotypes from UK Biobank shows scSplit can work for very closely related pooled samples.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2019_1852_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisherâs Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-019-1852-7.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Rahul Satija and Shiwei Zheng for providing helpful data from CITE-Seq based hashtagged scRNA-seq study [<xref ref-type="bibr" rid="CR4">4</xref>]. And we appreciate Yang Ouâs support on scRNA-seq normalization. This research has been conducted using the UK Biobank Resource under Application Number â12514â.</p>
    <sec id="d29e3247">
      <title>Review history</title>
      <p>The review history is available as Additional fileÂ <xref rid="MOESM3" ref-type="media">3</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <sec id="FPar1">
      <title>Authorsâ contributions</title>
      <p>LC and CF initiated the project. LC and JX designed the algorithms. JX implemented the tools in Python and tested it on multiple datasets. MDM generated the endometrial stromal samples. AP and AH generated the fibroblast samples. QN, SM and AS preprocessed the sample datasets. JY and LJ provided the sibling data for simulation and helped in analysis. JP, QN, GWM, BM, SM, JC, and SA participated in important discussions and provided useful suggestions on multiple issues. JX drafted the manuscript, LC, JP, GWM, JY, QN, and JC reviewed and revised the manuscript. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="FPar2">
      <title>Authorsâ information</title>
      <p>Jun Xu: Twitter(@xujun_jon) Lachlan J.M Coin: Twitter(@lachlancoin)</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>National Health and Medical Research Council Career Development Fellowship (LC, APP1130084; JP, APP1107599) National Health and Medical Research Council (JP, APP1143163 LC, APP1149029) Practitioner Fellowship (AWH) Senior Research Fellowship (AP), 1154389 Australian Research Council Future Fellowship (AP, FT140100047) Australian Research Council Discovery Project (JP, DP180101405) Stem Cells Australia â the Australian Research Council Special Research Initiative in Stem Cell Science (JP, AWH, AP, NP) Australian Research Council Development Early Career Researcher (QN, DE190100116)</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>PBMC dataset [<xref ref-type="bibr" rid="CR2">2</xref>] can be found under <ext-link ext-link-type="uri" xlink:href="http://support.10xgenomics.com/single-cell/datasets">http://support.10xgenomics.com/single-cell/datasets</ext-link></p>
    <p>Hashtagged dataset [<xref ref-type="bibr" rid="CR4">4</xref>] can be found under the accession number GSE108313</p>
    <p>Demuxlet dataset [<xref ref-type="bibr" rid="CR6">6</xref>] can be found under the accession number GSE96583</p>
    <p>Result data are available in <ext-link ext-link-type="uri" xlink:href="https://github.com/jon-xu/scSplit_paper_data">https://github.com/jon-xu/scSplit_paper_data</ext-link></p>
    <p>scSplit software is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/jon-xu/scSplit/">https://github.com/jon-xu/scSplit/</ext-link></p>
    <p>The software release is archived in zenodo [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Tissue samples collection for endometrial stromal cells was approved by Cantonal ethics commission Bern (149/03) and experimental procedures approved by the Cantonal ethics commission Bern (2019-01146) and the University of Queensland Human Research ethics committee (2016001723). Experimental work for fibroblast cells was approved by the Human Research Ethics committees of the Royal Victorian Eye and Ear Hospital (11/1031), University of Melbourne (1545394), University of Tasmania (H0014124)in accordance with the requirements of the National Health &amp; Medical Research Council of Australia (NHMRC) and conformed with the Declaration of Helsinki.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EvanÂ Z.</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>Anindita</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>Rahul</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>James</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>Karthik</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>Melissa</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>Itay</given-names>
          </name>
          <name>
            <surname>Bialas</surname>
            <given-names>AllisonÂ R.</given-names>
          </name>
          <name>
            <surname>Kamitaki</surname>
            <given-names>Nolan</given-names>
          </name>
          <name>
            <surname>Martersteck</surname>
            <given-names>EmilyÂ M.</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JohnÂ J.</given-names>
          </name>
          <name>
            <surname>Weitz</surname>
            <given-names>DavidÂ A.</given-names>
          </name>
          <name>
            <surname>Sanes</surname>
            <given-names>JoshuaÂ R.</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AlexÂ K.</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>Aviv</given-names>
          </name>
          <name>
            <surname>McCarroll</surname>
            <given-names>StevenÂ A.</given-names>
          </name>
        </person-group>
        <article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <mixed-citation publication-type="other">Zheng GXY, Terry JM, Belgrader P, Ryvkin P, Bent ZW, Wilson R, et al.Massively parallel digital transcriptional profiling of single cells. Nat Commun. 2017; 8. 10.1038/ncomms14049.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Xiannian</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Tianqi</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Feng</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Yaqi</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>Jiacheng</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Zeyao</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Yanyi</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Jianbin</given-names>
          </name>
        </person-group>
        <article-title>Comparative Analysis of Droplet-Based Ultra-High-Throughput Single-Cell RNA-Seq Systems</article-title>
        <source>Molecular Cell</source>
        <year>2019</year>
        <volume>73</volume>
        <issue>1</issue>
        <fpage>130-142.e5</fpage>
        <?supplied-pmid 30472192?>
        <pub-id pub-id-type="pmid">30472192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Houck-Loomis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yeung</surname>
            <given-names>BZ</given-names>
          </name>
          <collab>MauckIII WM</collab>
          <etal/>
        </person-group>
        <article-title>Cell Hashing with barcoded antibodies enables multiplexing and doublet detection for single cell genomics</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>224</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1603-1</pub-id>
        <pub-id pub-id-type="pmid">30567574</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stephenson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Houck-Loomis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chattopadhyay</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Swerdlow</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>865</fpage>
        <lpage>868</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4380</pub-id>
        <pub-id pub-id-type="pmid">28759029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>Hyun Min</given-names>
          </name>
          <name>
            <surname>Subramaniam</surname>
            <given-names>Meena</given-names>
          </name>
          <name>
            <surname>Targ</surname>
            <given-names>Sasha</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>Michelle</given-names>
          </name>
          <name>
            <surname>Maliskova</surname>
            <given-names>Lenka</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>Elizabeth</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>Eunice</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>Simon</given-names>
          </name>
          <name>
            <surname>Byrnes</surname>
            <given-names>Lauren</given-names>
          </name>
          <name>
            <surname>Lanata</surname>
            <given-names>Cristina M</given-names>
          </name>
          <name>
            <surname>Gate</surname>
            <given-names>Rachel E</given-names>
          </name>
          <name>
            <surname>Mostafavi</surname>
            <given-names>Sara</given-names>
          </name>
          <name>
            <surname>Marson</surname>
            <given-names>Alexander</given-names>
          </name>
          <name>
            <surname>Zaitlen</surname>
            <given-names>Noah</given-names>
          </name>
          <name>
            <surname>Criswell</surname>
            <given-names>Lindsey A</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Chun Jimmie</given-names>
          </name>
        </person-group>
        <article-title>Multiplexed droplet single-cell RNA-sequencing using natural genetic variation</article-title>
        <source>Nature Biotechnology</source>
        <year>2017</year>
        <volume>36</volume>
        <issue>1</issue>
        <fpage>89</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4042</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolock</surname>
            <given-names>Samuel L.</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>Romain</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>Allon M.</given-names>
          </name>
        </person-group>
        <article-title>Scrublet: Computational Identification of Cell Doublets in Single-Cell Transcriptomic Data</article-title>
        <source>Cell Systems</source>
        <year>2019</year>
        <volume>8</volume>
        <issue>4</issue>
        <fpage>281-291.e9</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2018.11.005</pub-id>
        <pub-id pub-id-type="pmid">30954476</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McGinnis</surname>
            <given-names>Christopher S.</given-names>
          </name>
          <name>
            <surname>Murrow</surname>
            <given-names>Lyndsay M.</given-names>
          </name>
          <name>
            <surname>Gartner</surname>
            <given-names>Zev J.</given-names>
          </name>
        </person-group>
        <article-title>DoubletFinder: Doublet Detection in Single-Cell RNA Sequencing Data Using Artificial Nearest Neighbors</article-title>
        <source>Cell Systems</source>
        <year>2019</year>
        <volume>8</volume>
        <issue>4</issue>
        <fpage>329-337.e4</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2019.03.003</pub-id>
        <pub-id pub-id-type="pmid">30954475</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clarke</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fairley</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zheng-Bradley</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Streeter</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lowy</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The international Genome sample resource (IGSR): A worldwide collection of genome variation incorporating the 1000 Genomes Project data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>D854</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw829</pub-id>
        <pub-id pub-id-type="pmid">27638885</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becht</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McInnes</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dutertre</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Kwok</surname>
            <given-names>IWH</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>LG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>38</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>E</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Haplotype-based variant detection from short-read sequencing</article-title>
        <source>arXiv preprint</source>
        <year>2012</year>
        <volume>ArXiv</volume>
        <fpage>1207.3907</fpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cheney</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kincaid</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>Linear Algebra: Theory and Applications</source>
        <year>2009</year>
        <publisher-loc>Sudbury</publisher-loc>
        <publisher-name>Jones and Barlett Publishers</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <mixed-citation publication-type="other">Heger A, Jacobs K, contributors. pysam: htslib interface for python. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/pysam-developers/pysam">https://github.com/pysam-developers/pysam</ext-link>. Accessed 1 Aug 2018.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Do</surname>
            <given-names>Chuong B</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>Serafim</given-names>
          </name>
        </person-group>
        <article-title>What is the expectation maximization algorithm?</article-title>
        <source>Nature Biotechnology</source>
        <year>2008</year>
        <volume>26</volume>
        <issue>8</issue>
        <fpage>897</fpage>
        <lpage>899</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Borodovsky</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ekisheva</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>Problems and Solutions in Biological Sequence Analysis</source>
        <year>2006</year>
        <publisher-loc>Sudbury</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>J</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Weighted kappa: Nominal scale agreement provision for scaled disagreement or partial credit</article-title>
        <source>Psychol Bull</source>
        <year>1968</year>
        <volume>70</volume>
        <fpage>213</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1037/h0026256</pub-id>
        <pub-id pub-id-type="pmid">19673146</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">Maechler M, Rousseeuw P, Struyf A, Hubert M, Hornik K. cluster: Cluster Analysis Basics and Extensions. R package version 2.0.9. 2019.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Neale</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Todd-Brown</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>MAR</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PLINK: a toolset for whole-genome association and population-based linkage analysis</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <fpage>559</fpage>
        <lpage>575</lpage>
        <pub-id pub-id-type="doi">10.1086/519795</pub-id>
        <pub-id pub-id-type="pmid">17701901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <mixed-citation publication-type="other">Xu J, Falconer C, Nguyen Q, Crawford J, McKinnon BD, Mortlock S, et al.Genotype-free demultiplexing of pooled single-cell RNA-seq (Version 1.0.0). 2019. Available from: <pub-id pub-id-type="doi">10.5281/zenodo.3464622</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
