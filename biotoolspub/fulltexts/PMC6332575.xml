<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6332575</article-id>
    <article-id pub-id-type="publisher-id">2450</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-018-2450-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Optimum contribution selection for animal breeding and conservation: the R package optiSel</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4748-8042</contrib-id>
        <name>
          <surname>Wellmann</surname>
          <given-names>Robin</given-names>
        </name>
        <address>
          <email>r.wellmann@uni-hohenheim.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2290 1502</institution-id><institution-id institution-id-type="GRID">grid.9464.f</institution-id><institution>Institute of Animal Science, University of Hohenheim, </institution></institution-wrap>Garbenstraße, Stuttgart, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>1</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>1</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>25</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>8</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>10</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Selecting animals for breeding in the optimum way plays an essential role for the management of genetic resources and in selective breeding of livestock species. It requires to compute the optimum genetic contribution of each selection candidate to the next generation. Current software packages for optimum contribution selection (OCS) are not able to handle the main conflicting objectives of animal breeding programs simultaneously, which includes to increase genetic gain, to increase or to maintain genetic diversity, to recover the original genetic background of endangered breeds with historic introgression, and to maintain or increase genetic diversity at native alleles.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The free R package <bold>optiSel</bold> offers functions for estimating the above mentioned parameters from pedigree and marker data, and for solving OCS problems. One parameter can be optimized, whereas the remaining ones can be constrained. The results reveal the optimum numbers of offspring of all selection candidates, and can subsequently be used for mate allocation. Different solvers can be used. Solver slsqp was superior when the genetic diversity at native alleles was to be maximized, whereas solvers cccp and cccp2 were superior for all other OCS problems.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>Optimum contribution selection applied to local breeds requires special attention due to the conflicting objectives of their breeding programs. The free R package <bold>optiSel</bold> is an easy-to-use software taking these conflicting objectives into account.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-018-2450-5) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Optimum contribution selection</kwd>
      <kwd>Animal breeding</kwd>
      <kwd>Conservation</kwd>
      <kwd>Segment-based kinship</kwd>
      <kwd>Native kinship</kwd>
      <kwd>Native contribution</kwd>
      <kwd>Runs of homozygosity</kwd>
      <kwd>optiSel</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Deutsche Forschungsgemeinschaft</institution>
        </funding-source>
        <award-id>DFG-GZ: WE4235/2-1</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The objectives of breeding programs for livestock breeds, companion animals, and zoo populations of endangered species may be quite different. In any case, however, selecting animals for breeding in the optimum way requires to compute the genetic contribution each selection candidate should have to the next generation.</p>
    <p>For high-performance livestock breeds, the objective of a breeding program is to maximize genetic gain while at the same time a sufficient effective size of the breed should be maintained to avoid inbreeding depression or a depletion of the additive genetic variance. Maintenance of a sufficient effective size is achieved by restricting the rate of increase in mean kinship. Thus, the optimum contributions of the selection candidates are the solution of an optimization problem where the objective is to maximize the mean breeding value in the offspring while the increase in mean kinship in the population is constrained. This approach is the classical optimum contribution selection (OCS) proposed by [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
    <p>High performance livestock breeds, however, have often been used for upgrading local breeds [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. This displacement crossing has often progressed to the point where the original genetic background of the local breed must be considered endangered. Hence, breeding programs for local breeds with historic introgression have the additional objective to recover the original genetic background of the breed. This means to reduce their genetic contribution from non-endangered breeds [<xref ref-type="bibr" rid="CR4">4</xref>], to conserve the genetic diversity at native haplotype segments [<xref ref-type="bibr" rid="CR5">5</xref>], and to maintain a sufficient genetic distance to non-endangered breeds [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p>In contrast, for many companion breeds (e.g. dog breeds), accurate breeding values for total merit are not available and historical genetic bottlenecks have depleted their gene pool. For these breeds, the main objective of the breeding program is to maintain or to increase genetic diversity by minimizing the mean kinship in the population. In this case, genetic introgression with other breeds may be not avoidable but should be restricted.</p>
    <p>In summary, animal breeding programs can have different objectives simultanously, which are to increase genetic gain, to increase or to maintain genetic diversity, to recover the original genetic background of breeds with historic introgression, and to maintain or increase genetic diversity at native haplotype segments. Optimizing one of these criteria and restricting the others is called advanced OCS [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p>Current software packages for OCS are not able to handle all conflicting objectives of animal breeding programs simultaneously and many of them may not find the global optimum. The implementation of classical OCS in the program <bold>GenCont</bold> uses Lagrangian multipliers [<xref ref-type="bibr" rid="CR9">9</xref>], but is not guaranteed to find the optimal solution [<xref ref-type="bibr" rid="CR10">10</xref>]. An alternative is the free software <bold>EVA</bold> [<xref ref-type="bibr" rid="CR11">11</xref>] that uses an evolutionary algorithm for optimization. Methods using evolutionary algorithms are also described e.g., by [<xref ref-type="bibr" rid="CR12">12</xref>] and are implemented in the commercial software <bold>TGRM</bold>. Some of these software packages provide flexible opportunities for mate allocation, but breeding programs that aim at recovering the native genetic background of a breed cannot be optimized with the software. An alternative is the use of general purpose software for optimization. Pong-Wong and Woolliams [<xref ref-type="bibr" rid="CR10">10</xref>] demonstrated how OCS problems can be reformulated as semidefinite programming problems and used software <bold>SDPA</bold> [<xref ref-type="bibr" rid="CR13">13</xref>] for optimization. Since the free software R is widely used by statisticians, of particular interest is general purpose software for optimization available as an R package. A variety of suitable packages exist. However, preparing animal data for use with general purpose software is a quite complex task, so it is rarely used by animal breeders or breeding organizations.</p>
    <p>This paper introduces the free R package <bold>optiSel</bold> which provides a framework for solving advanced OCS problems with little R code. It also offers functions for estimating various parameters from pedigree and marker data. These are the kinships, kinships at native haplotype segments, and genetic contributions from native ancestors. The advanced OCS methods currently implemented include maximizing genetic gain, minimizing the average kinship, maximizing contributions from native ancestors, and minimizing the mean kinship at native haplotype segments, while criteria not included in the objective function can be used as constraints. This results in a table from which the optimum numbers of offspring of all selection candidates can be obtained, and which can subsequently be used for mate allocation to minimize the average inbreeding in the offspring.</p>
    <p>The package enables to use a variety of free solvers for optimization and allows for easy switching between solvers by setting the parameter solver of function opticont() appropriately. Optimization problems can currently be solved by augmented lagrangian minimization as implemented in the R package <bold>alabama</bold> [<xref ref-type="bibr" rid="CR14">14</xref>] (solver="alabama"), by semidefinite programming using the CSDP library introduced by [<xref ref-type="bibr" rid="CR15">15</xref>] (solver="csdp"), by gradient-based optimization with sequential least-squares quadratic programming as implemented in function slsqp() [<xref ref-type="bibr" rid="CR16">16</xref>] from package <bold>nloptr</bold> (solver="slsqp"), and by function cccp() from package <bold>cccp</bold> [<xref ref-type="bibr" rid="CR17">17</xref>] for solving cone constrained convex programs (solver="cccp" or solver=~cccp2~).</p>
    <p>The aims of this paper are to demonstrate how the free package optiSel can be used for the estimation of genetic parameters and for OCS. In addition, the suitability of the different solvers for solving a variety of OCS problems is compared.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>The software package optiSel is implemented in R and C++. This section demonstrates the functionality of the package. This includes the estimation of genetic parameters and their use in OCS. Exact mathematical formulas for objective functions and constraints in OCS and their derivations can be found in (Wellmann R, Bennewitz J: Key genetic parameters for optimal population management, submitted).</p>
    <p>The required packages optiSel and data.table can be downloaded from cran and then loaded as follows:</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2018_2450_Figa_HTML" id="MO1"/>
    </p>
    <p>Package data.table is used because it provides a fast file reader. A simulated data set consisting of phenotypes, genotypes and pedigrees of simulated Angler cattle and a replication script can be found in the electronic appendix (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Estimation of genetic parameters and OCS are described below at the example of 1132 simulated genotyped individuals. Vector animals contains the IDs of these individuals. All estimated genetic parameters will be displayed for three related animals, which are an individual and its parents. These are the individuals included in vector I.</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2018_2450_Figb_HTML" id="MO2"/>
    </p>
    <sec id="Sec3">
      <title>Kinships</title>
      <p>The kinship <italic>f</italic><sub><italic>IBD</italic></sub>(<italic>i</italic>,<italic>j</italic>) of two individuals <italic>i</italic>,<italic>j</italic> is the probability that two alleles <italic>X</italic><sub><italic>i</italic></sub>, and <italic>Y</italic><sub><italic>j</italic></sub>, randomly chosen from both individuals from a single locus, are identical by descent (IBD). This means that they descend from a common ancestor. That is, 
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$f_{IBD}(i, j) = P\left(X_{i} \stackrel{IBD}{=} Y_{j}\right). $$ \end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IBD</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mover><mml:mrow><mml:mo>=</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IBD</mml:mtext></mml:mrow></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2018_2450_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Kinships can be estimated either from the pedigree or from marker data. In order to distinguish between segment-based estimates and pedigree-based estimates, we use for pedigree-based estimates the prefix or suffix PED, and for segment-based estimates SEG in this paper.</p>
      <p>The <bold>pedigree-based kinship</bold> or <bold>geneological coancestry</bold><inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {f}_{PED}(i, j)$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">PED</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq1.gif"/></alternatives></inline-formula> between each pair of individuals <italic>i</italic>,<italic>j</italic> can be computed with function pedIBD(). The function allows to define a relationship matrix for the founders. By default, the founders are unrelated and not inbred. However, before a pedigree can be used, it needs to be prepared with function prePed(). This function sorts the pedigree, adds new lines for founders, and corrects some pedigree errors.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figc_HTML" id="MO3"/>
      </p>
      <p>The additive relationship matrix A=2*fPED can also be computed with function makeA().</p>
      <p>Pedigree-based evaluations require sufficiently complete pedigrees. Parameters quantifying the completeness of the pedigrees of all individuals can be obtained with function summary(). Of particular interest is the number of equivalent complete generations, which can be found in column equiGen. It is the sum of the proportions of known ancestors of an individual over all generations traced [<xref ref-type="bibr" rid="CR18">18</xref>]. Below, data table phen, which contains the simulated breeding values in column EBV is loaded, and column equiGen is appended.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figd_HTML" id="MO4"/>
      </p>
      <p>Pedigree-based estimates have the disadvantage that Mendelian sampling in all ancestors is considered to be random, so it cannot account for the alleles the ancestors actually inherited from their parents. In general, the usage of segment-based estimates is recommended in order to account for Mendelian sampling. The most useful marker-based kinship estimates are based on runs of homozygosity (ROH). A ROH with respect to two haplotypes is a segment consisting of consecutive base pairs which are identical in both haplotypes [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
      <p>The <bold>segment-based kinship</bold><inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {f}_{SEG}(i, j)$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">SEG</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq2.gif"/></alternatives></inline-formula> between individual <italic>i</italic> and <italic>j</italic> is the probability that two alleles, taken at random from both individuals from a single locus, belong to identical segments. The matrix containing the segment-based kinships of all individuals can be computed with function segIBD(). The number of cores to be used can be specified by argument cores, so different chromosomes can be processed in parallel.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Fige_HTML" id="MO5"/>
      </p>
      <p>Important arguments of function segIBD() are minSNP and minL. A segment needs to have a minimum length for being taken into account. By default, the minimum number of markers to be included in a segment is minSNP=20 because considerably smaller sections of a haplotype may be identical by chance. The minimum length of a segment is by default minL=1.0 Mb. For the example data set we used minL=2.5 in accordance with [<xref ref-type="bibr" rid="CR8">8</xref>]. Since short shared segments predominantly originate from early common ancestors, this value should be chosen depending on the age of the inbreeding that should be taken into account, but also dependent on the size of the marker panel [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>Native contribution</title>
      <p>The native contribution <italic>N</italic>(<italic>i</italic>) of an individual <italic>i</italic> is the proportion of its genome which is native [<xref ref-type="bibr" rid="CR8">8</xref>]. In other words, it is the genetic contribution it has from native ancestors, or the probability that an allele <italic>X</italic><sub><italic>i</italic></sub>, randomly chosen from the individual, is native. That is, 
<disp-formula id="Equb"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$N(i) = P\left(X_{i} \in \mathcal{A}_{N}\right), $$ \end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2018_2450_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {A}_{N}$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq3.gif"/></alternatives></inline-formula> is the set of alleles originating from native ancestors. It is usually defined with respect to a base population, i.e. a time <italic>t</italic><sub>0</sub> before which all registered individuals were considered native. Native contributions can be estimated either from pedigree or from marker data.</p>
      <p>The <bold>pedigree-based native contribution</bold><inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {N}_{PED}(i)$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">PED</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq4.gif"/></alternatives></inline-formula> of individual <italic>i</italic> is the sum of the genetic contributions individual <italic>i</italic> has from native founders, whereby a founder is an individual with unknown parents. For estimating native contributions, the pedigree needs to be prepared differently than for estimating kinships. Below, arguments lastNative=1970 and thisBreed=~Angler~ ensure that the breed name of founders born after <italic>t</italic><sub>0</sub>=1970 is shifted from ~Angler~ to "unknown". The native contributions and the contributions of other breeds to the genome of each individual are estimated with function pedBreedComp(). Thereafter, the column with native contributions is appended to data table phen and renamed as pedNC.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figf_HTML" id="MO6"/>
      </p>
      <p>It can be seen that the selected individuals have a low native contribution, a high contribution from Holstein, and also a substantial contribution from individuals of unknown origin.</p>
      <p>The <bold>segment-based native contribution</bold><inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {N}_{SEG}(i)$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">SEG</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq5.gif"/></alternatives></inline-formula> of individual <italic>i</italic> is the proportion of its genome included in native haplotype sections. Thereby, an allele is considered native, if the segment containing the allele has low frequency in all breeds that might have been used for upgrading. That is, a marker <italic>m</italic> is native in a haplotype, if the frequency of the segment containing the marker is smaller than some threshold value ubFreq in all breeds that might have been used for upgrading the breed of interest. If a segment is substantially more frequent than (say) 0.01 in another non-endangered breed that was used for upgrading, then it does not need to be conserved and has likely been introgressed. Short segments predominantly arose from early introgression events, so segments are required to have a minimum length minL, which enables to neglect very old introgression.</p>
      <p>Below, function haplofreq() is used to determine the most likely origin of each allele from each haplotype. The results are written to files in directory w.dir=~Population~, and a list with file names is returned. The first letters of the breed names are used in the files for labeling the origins of the markers, so care should be taken that these letters are different for the different breeds. Function segBreedComp() is used to compute the native contribution of each individual. Thereafter, the column with native contributions is appended to data table phen and renamed as segNC.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figg_HTML" id="MO7"/>
      </p>
      <p>The scatter plot in Fig. <xref rid="Fig1" ref-type="fig">1</xref> shows the pedigree-based estimate of the genetic contribution from Holstein cattle vs. the segment-based estimate. Thereby, contributions from Holstein and Red Holstein are added and only individuals with real parents are included that have at least 6 equivalent complete generations in the pedigree. It can be seen that the segment-based contribution from Holstein is highly correlated with the pedigree-based estimate. Probably, both estimates are slightly biased downward. The pedigree-based estimate could be too low because of wrong and missing ancestors in the pedigree, whereas the marker-based estimate could be too low because some Holstein cattle with rare haplotypes are missing in the reference set.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Joint Distribution. Pedigree-based estimates of the genetic contribution from Holstein cattle vs. segment-based estimates for simulated Angler cattle</p></caption><graphic xlink:href="12859_2018_2450_Fig1_HTML" id="MO8"/></fig>
</p>
    </sec>
    <sec id="Sec5">
      <title>Native kinship</title>
      <p>The native kinship <italic>f</italic><sub><italic>I</italic><italic>B</italic><italic>D</italic>|<italic>N</italic></sub>(<italic>i</italic>,<italic>j</italic>) of two individuals <italic>i</italic>,<italic>j</italic> is the conditional probability that two alleles <italic>X</italic><sub><italic>i</italic></sub>, and <italic>Y</italic><sub><italic>j</italic></sub>, taken at random from both individuals from a single locus, are identical by descent (IBD), given that they are native. That is, 
<disp-formula id="Equc"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$f_{IBD|N}(i, j) = P\left(X_{i} \stackrel{IBD}{=} Y_{j}\left|X_{i},Y_{j} \in \mathcal{A}_{N}\right.\right).$$ \end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IBD</mml:mtext><mml:mo>|</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mover><mml:mrow><mml:mo>=</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IBD</mml:mtext></mml:mrow></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close="" open="|" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2018_2450_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>In other words, it is the kinship computed only from the alleles that are native in both individuals. Note that the native kinship depends neither on the way, the migrant ancestors were related with each other, nor on their genetic contribution to the population. Since the kinship is defined as a conditional probability, it can be computed by the ratio 
<disp-formula id="Equd"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} {f}_{IBD|N}(i, j) &amp;=&amp;\frac{{f}_{IBD\&amp;N}(i, j)}{ {f}_{N}(i, j)}, \end{array} $$ \end{document}</tex-math><mml:math id="M18"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IBD</mml:mtext><mml:mo>|</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IBD</mml:mtext><mml:mo>&amp;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2018_2450_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>f</italic><sub><italic>I</italic><italic>B</italic><italic>D</italic>&amp;<italic>N</italic></sub>(<italic>i</italic>,<italic>j</italic>) is the probability that two alleles taken at random from both individuals are IBD and native, whereas <italic>f</italic><sub><italic>N</italic></sub>(<italic>i</italic>,<italic>j</italic>) is the probability that both alleles are native. The numerator and the denominator, and thus the native kinships, can be estimated either from pedigree or from marker data.</p>
      <p>The <bold>pedigree-based native kinship</bold><inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {f}_{PED|N}(i, j)$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">PED</mml:mtext><mml:mo>|</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq6.gif"/></alternatives></inline-formula> between individuals <italic>i</italic>,<italic>j</italic> can be computed with function pedIBDatN(), whereby the native founders are assumed to be unrelated and non-inbred.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figh_HTML" id="MO9"/>
      </p>
      <p>The native kinships of these individuals are rather high, which means that the sets of native ancestors in their pedigrees are considerably overlapping.</p>
      <p>The <bold>segment-based native kinship</bold><inline-formula id="IEq7"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {f}_{SEG|N}(i, j)$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">SEG</mml:mtext><mml:mo>|</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq7.gif"/></alternatives></inline-formula> between individuals <italic>i</italic>,<italic>j</italic> is the conditional probability that two alleles from the same locus taken at random from these individuals belong to identical segments, given that the alleles are native. It can be computed with function segIBDatN().</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figi_HTML" id="MO10"/>
      </p>
    </sec>
    <sec id="Sec6">
      <title>Population means</title>
      <p>The mean values of the genetic parameters in the population depend on the contributions the different age ×sex classes have to the population. The time interval covered by an age class needs to ensure that no individual can have offspring in the same age class. Typically, each age class spans one year.</p>
      <p>Function agecont() estimates the contributions of the classes to the population. It assumes that the percentage of the population that is attributed to a particular class is proportional to the expected proportion of its offspring that is not yet born. Since these values are estimated from the past, this requires some continuity in the breeding program when this function is used for estimation. The total contributions of non-juvenile males and females to the population are assumed to be equal, whereby non-juvenile animals are all individuals that are not born in the current year. Note that the contributions are idealized and may not coincide with the proportions of living animals included in the classes. The contributions of the age classes are estimated from the ages of the parents at the time when their offspring was born. The offspring consists of the individuals indicated by argument use.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figj_HTML" id="MO11"/>
      </p>
      <p>In this example, males have lower contributions to young age classes than females. This is because the males were predominantly progeny tested, so they were used for breeding at an older age. Hence, their contributions spread over a longer period of time.</p>
      <p>Before we compute the population means, data frame phen should be completed by appending column isCandidate, which indicates the selection candidates for OCS. In this example, the selection candidates are the individuals that are at least one year old.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figk_HTML" id="MO12"/>
      </p>
      <p>Function candes() computes the population means for all numeric columns in data table phen and for all kinships and native kinships that are supplied as additional arguments. Note that these additional arguments can have arbitrary names and they can be omitted if the respective kinship is not of interest. The population means depend on the contributions the different age ×sex classes have to the population as defined by argument cont. If argument cont is omitted, then discrete generations are assumed and the total contributions of males and females to the population are equal.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figl_HTML" id="MO13"/>
      </p>
      <p>It can be seen that the average number of equivalent complete generations in the pedigree is rather high, even though the proportion of the genome with unknown origin is also moderately high. The results deviate from results of other studies for this breed [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>] because the data set used in this paper for demonstration purposes was not obtained from a random sample of the population. However, they demonstrate several interesting relationships between the parameters.</p>
      <p>The pedigree-based native contribution of 0.1671 is probably underestimated because some of the founders with unknown origin may be native. The pedigree-based kinship is smaller than the segment-based kinship because pedigrees are incomplete. Native kinships are higher than the kinships because the diversity of native alleles is usually smaller than the total diversity of all alleles. The segment-based estimates of the native kinships are lower than the pedigree-based estimates. This has two reasons. First, the individuals have a substantial genetic contribution from founders with unknown origin. Alleles from these individuals do not contribute to the pedigree-based diversity of native alleles, even though some of them could have been native. This results in overestimating the pedigree-based native kinships. Second, crossing overs have shortened some haplotype segments, so that some segments can no longer be considered identical. This results in a slight underestimation of segment-based estimates.</p>
    </sec>
    <sec id="Sec7">
      <title>Constraint settings for kinships</title>
      <p>Since the inbreeding coefficient of an individual is equal to the kinship of its parents, constraining the increase in mean kinship in the population enables breeders to avoid inbreeding. The rate of increase in mean kinship is measured by the variance effective size <italic>N</italic><sub><italic>e</italic></sub> of the population. The critical effective size, i.e. the size below which the fitness of the population steadily decreases, depends on the population and is usually assumed to be between 50 and 100 [<xref ref-type="bibr" rid="CR21">21</xref>]. For most populations, maintenance of an effective size of <italic>N</italic><sub><italic>e</italic></sub>≥100 should be envisaged. Hence, we define</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figm_HTML" id="MO14"/>
      </p>
      <p>The effective size of the population is at least <italic>N</italic><sub><italic>e</italic></sub>, if the rate of increase in mean kinship per generation is <inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta f_{g} \leq \frac {1}{2N_{e}}$\end{document}</tex-math><mml:math id="M24"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq8.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR22">22</xref>]. In a population with overlapping generations and generation interval <italic>L</italic>, the rate of increase in mean kinship per year <italic>Δ</italic><italic>f</italic><sub><italic>y</italic></sub> is of interest for OCS, which should satisfy 
<disp-formula id="Eque"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\Delta f_{y} \leq \frac{1}{2N_{e}L}.$$ \end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2018_2450_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The generation interval can be approximated from the results of function agecont() as</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Fign_HTML" id="MO15"/>
      </p>
      <p>This enables to define upper bounds for the mean kinships in the population at the next evaluation time <italic>t</italic>+1 as</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figo_HTML" id="MO16"/>
      </p>
      <p>Of course, upper bounds need to be defined only for the parameters that should be constrained in OCS. The expected mean kinship in the population at time <italic>t</italic>+1 depends on the vector <bold>c</bold> containing the genetic contribution of each individual to the offspring, which is the parameter that will be optimized. The expected mean kinship can be computed by the quadratic function 
<disp-formula id="Equf"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${f}_{{IBD}}(\mathbf{c}) = {\left(r_{0} \mathbf{c} + \mathbf{v}\right)}^{\top} \mathbf{f}_{{IBD}} {\left(r_{0} \mathbf{c} + \mathbf{v}\right)} + l_{{IBD}}(\mathbf{c}), $$ \end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IBD</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IBD</mml:mtext></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IBD</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2018_2450_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> where <italic>r</italic><sub>0</sub> is the percentage of the population represented by the offspring, and component <italic>v</italic><sub><italic>i</italic></sub> of <bold>v</bold> is the percentage of the population represented by individual <italic>i</italic> itself. The small linear correction term <italic>l</italic><sub><italic>IBD</italic></sub>(<bold>c</bold>) accounts, for example, for genetic drift (Wellmann R, Bennewitz J: Key genetic parameters for optimal population management, submitted). Estimates <inline-formula id="IEq9"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {f}_{PED}(\mathbf {c})$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">PED</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {f}_{SEG}(\mathbf {c})$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">SEG</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq10.gif"/></alternatives></inline-formula> can be obtained by replacing <bold>f</bold><sub><italic>IBD</italic></sub> and <italic>l</italic><sub><italic>IBD</italic></sub>(<bold>c</bold>) with their estimates obtained from pedigrees or marker data, respectively. Hence, constraining a kinship means to add a quadratic constraint of the form 
<disp-formula id="Equg"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \hat{f}_{{PED}}(\mathbf{c}) &amp;\leq&amp; \text{ub.fPED}, \text{ or }\\ \hat{f}_{{SEG}}(\mathbf{c}) &amp;\leq&amp; \text{ub.fSEG} \end{array} $$ \end{document}</tex-math><mml:math id="M34"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">PED</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>≤</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mtext>ub.fPED</mml:mtext><mml:mo>,</mml:mo><mml:mtext>or</mml:mtext></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">SEG</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>≤</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mtext>ub.fSEG</mml:mtext></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2018_2450_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>to the programming problem. Native kinships are of particular interest for populations with historic introgression if removal of the introgressed genetic material is envisaged in the future. Defining the upper bound for the mean kinship in accordance with the desired effective size ensures that enough genetic diversity will be maintained in the population after the introgressed genetic material has been removed. Hence, upper bounds are defined as</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figp_HTML" id="MO17"/>
      </p>
      <p>The expected mean native kinship in the population at time <italic>t</italic>+1 can be computed by the rational function 
<disp-formula id="Equh"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} {f}_{IBD|N}(\mathbf{c}) &amp;=&amp;\frac{{\left(r_{0} \mathbf{c} + \mathbf{v}\right)}^{\top} \mathbf{f}_{IBD\&amp;N}{\left(r_{0} \mathbf{c} + \mathbf{v}\right)} + l_{IBD\&amp;N}(\mathbf{c})}{ {\left(r_{0} \mathbf{c} + \mathbf{v}\right)}^{\top} \mathbf{f}_{N}{\left(r_{0} \mathbf{c} + \mathbf{v}\right)} + l_{N}(\mathbf{c})}, \end{array} $$ \end{document}</tex-math><mml:math id="M36"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IBD</mml:mtext><mml:mo>|</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IBD</mml:mtext><mml:mo>&amp;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IBD</mml:mtext><mml:mo>&amp;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2018_2450_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>l</italic><sub><italic>S</italic><italic>E</italic><italic>G</italic>&amp;<italic>N</italic></sub>(<bold>c</bold>) and <italic>l</italic><sub><italic>N</italic></sub>(<bold>c</bold>) are the small linear correction terms defined in (Wellmann R, Bennewitz J: Key genetic parameters for optimal population management, submitted). Estimates <inline-formula id="IEq11"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {f}_{PED|N}(\mathbf {c})$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">PED</mml:mtext><mml:mo>|</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq11.gif"/></alternatives></inline-formula> and <inline-formula id="IEq12"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {f}_{SEG|N}(\mathbf {c})$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">SEG</mml:mtext><mml:mo>|</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq12.gif"/></alternatives></inline-formula> are obtained by replacing the terms by their estimates obtained from pedigrees or marker data, respectively. Hence, constraining a native kinship means to add a rational constraint of the form 
<disp-formula id="Equi"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \hat{f}_{PED|N}(\mathbf{c}) &amp;\leq&amp; \mathrm{ub.fPEDN}, \text{ or }\\ \hat{f}_{SEG|N}(\mathbf{c}) &amp;\leq&amp; \mathrm{ub.fSEGN} \end{array} $$ \end{document}</tex-math><mml:math id="M42"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">PED</mml:mtext><mml:mo>|</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>≤</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mi mathvariant="normal">ub.fPEDN</mml:mi><mml:mo>,</mml:mo><mml:mtext>or</mml:mtext></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">SEG</mml:mtext><mml:mo>|</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>≤</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mi mathvariant="normal">ub.fSEGN</mml:mi></mml:mtd><mml:mtd><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2018_2450_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>to the programming problem.</p>
    </sec>
    <sec id="Sec8">
      <title>Traditional OCS</title>
      <p>The goal of OCS is finding the optimum contribution <italic>c</italic><sub><italic>i</italic></sub> each selection candidate <italic>i</italic> should have to the next birth cohort. It is the fraction of genes in the birth cohort that should originate from individual <italic>i</italic>. Since 50% of the genes originate from males and 50% originate from females, the proportion of individuals in the birth cohort having individual <italic>i</italic> as a parent should be 2<italic>c</italic><sub><italic>i</italic></sub>.</p>
      <p>Traditionally, OCS maximizes the mean breeding value in the population in the next year or generation, while the average kinship is required not to exceed a predefined threshold value. The usage of package optiSel is demonstrated below at the example of this optimization problem.</p>
      <p>Since pedigree data is used, care must be taken that the completeness of the pedigrees is taken into account. Individuals with a low number of equivalent complete generations in their pedigree would otherwise be favored for breeding because they appear to be less related with the population. The constraints of the optimization problem are defined in a list:</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figq_HTML" id="MO18"/>
      </p>
      <p>In this example, only the contributions of males are to be optimized, which is achieved by adding component uniform="female". That is, all females within a particular age cohort are assumed to have equal contributions to the offspring. This optimization problem is of interest if the contributions of the females cannot be centrally controlled.</p>
      <p>Component ub.fPED=ub.fPED defines the upper bound for the mean kinship in the population to be equal to the value ub.fPED. This component has name ub.fPED because the kinship was named fPED in the call of function candes().</p>
      <p>Component lb.equiGen=cand$mean$equiGen defines a lower bound for the average number of equivalent complete generations in the population. This constraint is only needed if incomplete pedigree data is used. The threshold value should be chosen such that individuals with incomplete pedigrees are not unduly favored for breeding. This component has name lb.equiGen because the column in data table cand$phen that contains the numbers of equivalent complete generations was named equiGen.</p>
      <p>Optimization is carried out below with function opticont(). The first argument defines the objective of the optimization problem, which is to maximize the average breeding value in the population at time <italic>t</italic>+1. This is achieved with character string ~max.EBV~ because the column of data table cand$phen that contains the breeding values is named EBV.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figr_HTML" id="MO19"/>
      </p>
      <p>Argument solver defines the algorithm to be used for optimization. If numerical problems are encountered then it is advisable to use another solver or to adjust the tuning parameters of the solver, which can be supplied as additional arguments to function opticont(). Available solvers are</p>
      <p><bold>cccp:</bold> Function cccp() from R package <bold>cccp</bold> for solving cone constrained convex problems is called. Quadratic constraints are defined as second order cone constraints.</p>
      <p><bold>cccp2:</bold> Function cccp() from R package <bold>cccp</bold> is called, but quadratic constraints are defined by functions.</p>
      <p><bold>alabama:</bold> This solver calls function auglag() from R package <bold>alabama</bold> for optimizing smooth nonlinear objective functions with constraints.</p>
      <p><bold>csdp:</bold> This solver calls function csdp() from R package <bold>Rcsdp</bold> for solving semidefinite programming problems.</p>
      <p><bold>slsqp:</bold> Function slsqp() from package <bold>nloptr</bold> is called, which optimizes successive second-order approximations of the objective function with first-order approximations of the constraints.</p>
      <p>The result of function opticont() is a list with several components. Data frame fit$info contains information on the success of the optimization. That is, component valid is TRUE, if all constraints are fulfilled by the optimized contributions, whereas component status describes the solution as reported by the solver.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figs_HTML" id="MO20"/>
      </p>
      <p>Data frame fit$mean contains the predicted mean values of heritable traits, kinships, and native kinships in the population at the next evaluation time <italic>t</italic>+1. For other variables, such as component equiGen, the weighted mean (<italic>r</italic><sub>0</sub><bold>c</bold>+<bold>v</bold>)<sup>⊤</sup><bold><italic>X</italic></bold> is shown, where <bold><italic>X</italic></bold> is the corresponding column vector from data frame cand$phen.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figt_HTML" id="MO21"/>
      </p>
      <p>The optimized contributions of the breeding individuals can be found in column oc of data frame fit$parent:</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figu_HTML" id="MO22"/>
      </p>
      <p>The example above optimizes only the contributions of males. For optimizing the contributions of both sexes, component uniform="female" needs to be removed from the list of constraints. Moreover, since the number of offspring a female can have is usually limited, upper limits need to be defined for the female contributions. More generally, upper and lower limits for the contributions of arbitrary individuals can be specified. If each birth cohort consists of <italic>N</italic><sub>0</sub>=200 individuals and if a female can have at most 5 offspring per year, then the upper limit for the contributions of females needs to be <inline-formula id="IEq13"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {5}{2N_{0}}=0.0125$\end{document}</tex-math><mml:math id="M44"><mml:mfrac><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.0125</mml:mn></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq13.gif"/></alternatives></inline-formula>. The corresponding list of constraints can be created as follows:</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figv_HTML" id="MO23"/>
      </p>
      <p>Computation of the optimum contributions with this list of constraints takes about 3 min. Their computation with constraint uniform="female" is in general much faster.</p>
    </sec>
    <sec id="Sec9">
      <title>Advanced OCS</title>
      <p>This section provides an overview on the constraints and objective functions that can be handled by function opticont() and are of interest in many breeding programs. In general, all kinship and native kinships, and all numeric traits in data frame phen can be constrained. These parameters can also be optimized, but only one at a time. In animal breeding, the groups of males and females contribute equally to the offspring. This may, however, not be relevant in plant breeding. The constraint that males and females have equal contributions to the offspring is omitted, if column Sex in data frame phen contains only NA.</p>
      <p>For most breeding programs, traditional OCS turned out to be not sufficient. This has several reasons. First, marker data enables to obtain more accurate estimates of kinships, native kinships and breeding values than pedigree data. In the examples below, we assume that marker data is available. However, if only pedigree data is available, then the examples can easily be adjusted by replacing terms SEG and seg with PED and ped. In particular, for maximizing breeding values while restricting the segment-based kinship, constraint ub.fPED=ub.fPED needs to be replaced with ub.fSEG=ub.fSEG:</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figw_HTML" id="MO24"/>
      </p>
      <p>While the above setting is appropriate for most livestock breeds, many companion breeds and endangered breeds have different breeding objectives. Several companion breeds suffer from historic bottlenecks, which resulted in high inbreeding coefficients and inbreeding depression. For these breeds, the primary breeding goal is minimizing the average kinship in order to reduce inbreeding depression and the loss of genetic variation. This is achieved with the following call to function opticont():</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figx_HTML" id="MO25"/>
      </p>
      <p>If breeding values are available, then they can be constrained in order to achieve genetic gain:</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figy_HTML" id="MO26"/>
      </p>
      <p>For some companion breeds, the erosion of genetic diversity has proceeded to a point that crossings with other breeds are not avoidable. However, the genetic contribution from other breeds should be restricted to the necessary minimum. Hence, a lower bound for the native contribution should be defined:</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figz_HTML" id="MO27"/>
      </p>
      <p>Note that the example above cannot be executed for the example data set because the optimization problem has no solution.</p>
      <p>Some endangered livestock breeds, such as the breed used in the examples, have been continuously upgraded with high performance breeds in order to maintain economic competitiveness. Replacement of the original genetic background can have proceeded to the point that the original breed can be considered genetically extinct. For some of these breeds, de-extinction efforts are made with the aim to recover the original genetic background. Such breeding programs need to restrict the increase in native kinship in accordance with the desired effective size in order to ensure that enough genetic diversity persists in the breed after the foreign genetic material has been removed. Hence, the call to function opticont() would be</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figaa_HTML" id="MO28"/>
      </p>
      <p>In general, recovering the native genetic background is not the only objective of the breeding program, but genetic gain should be achieved as well. In this case, breeding values for the native contribution should be estimated from marker data and included in the total merit index. Then, the total merit index would be maximized instead of the native contribution. It may be desirable to maintain specific introgressed QTL in the population, which could be achieved by giving them an appropriate weight in the total merit index.</p>
    </sec>
    <sec id="Sec10">
      <title>Mate allocation</title>
      <p>After the optimum contributions of the selection candidates have been computed, males and females can be allocated for mating such that the mean inbreeding coefficient in the offspring is minimized. This can be done with function matings(). Since the kinship of the parents is equal to the inbreeding coefficient of the offspring, the objective is to minimize 
<disp-formula id="Equj"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\frac{1}{N_{0}} \sum\limits_{i\in\mathcal{M}}\sum\limits_{j\in\mathcal{F}} n_{ij} f_{ij}, $$ \end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">F</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2018_2450_Article_Equj.gif" position="anchor"/></alternatives></disp-formula> where <italic>n</italic><sub><italic>ij</italic></sub> is the number of offspring from the mating of individual <italic>i</italic> with individual <italic>j</italic>, <inline-formula id="IEq14"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}$\end{document}</tex-math><mml:math id="M48"><mml:mi mathvariant="script">ℳ</mml:mi></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq14.gif"/></alternatives></inline-formula> contains all male selection candidates, <inline-formula id="IEq15"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {F}$\end{document}</tex-math><mml:math id="M50"><mml:mi mathvariant="script">F</mml:mi></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq15.gif"/></alternatives></inline-formula> contains all female selection candidates, <italic>N</italic><sub>0</sub> is the total number of offspring, and <italic>f</italic><sub><italic>ij</italic></sub> is either the segment-based kinship, or the pedigree-based kinship, or another user-supplied similarity measure for individuals <italic>i</italic> and <italic>j</italic>.</p>
      <p>In any case, the genetic contribution of each parent must be equal to its optimum contribution. That is, for all males <italic>i</italic>, the following equation holds 
<disp-formula id="Equk"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\sum\limits_{j\in\mathcal{F}} n_{ij} = n_{i}, $$ \end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">F</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2018_2450_Article_Equk.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>and for all females <italic>j</italic>, we have 
<disp-formula id="Equl"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\sum\limits_{i\in\mathcal{M}} n_{ij} =n_{j}. $$ \end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2018_2450_Article_Equl.gif" position="anchor"/></alternatives></disp-formula> where <italic>n</italic><sub><italic>i</italic></sub>≈2<italic>c</italic><sub><italic>i</italic></sub><italic>N</italic><sub>0</sub> is the number of offspring of individual <italic>i</italic>.</p>
      <p>The maximum number of offspring per mating can be constrained to be ub.nOff at most. In this case, for all males <italic>i</italic>, and for all females <italic>j</italic> the following inequality holds 
<disp-formula id="Equm"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$n_{ij} \leq \mathrm{ub.nOff}. $$ \end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi mathvariant="normal">ub.nOff</mml:mi><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2018_2450_Article_Equm.gif" position="anchor"/></alternatives></disp-formula> Without this constraint, some superior animals may always be mated to the same inferior individual, so all their offspring may not be good enough for breeding.</p>
      <p>Moreover, for each herd, the proportion of offspring sired by the same male can be constrained to be at most <italic>α</italic>. This increases genetic connectedness between herds, so it enables to estimate more accurate breeding values. Take <inline-formula id="IEq16"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {F}_{h}$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2018_2450_Article_IEq16.gif"/></alternatives></inline-formula> to be the set of females from herd <italic>h</italic>. For all herds <italic>h</italic> and all males <italic>i</italic> we have 
<disp-formula id="Equn"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\sum\limits_{j\in\mathcal{F}_{h}} n_{ij} \leq \alpha \&gt; N_{h}. $$ \end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2018_2450_Article_Equn.gif" position="anchor"/></alternatives></disp-formula> where <italic>N</italic><sub><italic>h</italic></sub> is the number of individuals in the birth cohort that will be born in herd <italic>h</italic>. Mate allocation is demonstrated at the example of OCS with segment-based kinship matrix. Recall that the optimization problem can be solved with</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figab_HTML" id="MO29"/>
      </p>
      <p>Function noffspring() is used below to compute the desired number of offspring per selection candidate by assuming that the birth cohort covers 200 individuals. The result of function matings(), which is used for mate allocation, is a data frame with columns Sire, Dam, and n. Column n contains the desired number of offspring from matings between the respective sire and dam. Note that this is the number of offspring that should be used as selection candidates in the next generation. The total number of offspring from the matings may be larger.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figac_HTML" id="MO30"/>
      </p>
      <p>The average inbreeding coefficient of the offspring is</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2018_2450_Figad_HTML" id="MO31"/>
      </p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="results">
    <title>Results</title>
    <sec id="Sec12">
      <title>Comparison of solvers</title>
      <p>The ability of different solvers to find optimum solutions for different OCS problems was compared at the example of a data set containing genotypes, breeding values, and migrant contributions of 11000 simulated Angler cattle. These simulated individuals were generated from genotypes of 131 Angler bulls and 137 Angler cows during 2 generations of selection. Male selection candidates were sampled at random from the population that consisted of all 11000 individuals. Females were assumed to have equal contributions within each age class. Breeding values were simulated as described in [<xref ref-type="bibr" rid="CR8">8</xref>]. Segment-based kinships, native kinships, and native contributions were estimated from haplotypes consisting of 23448 SNPs.</p>
      <p>The following OCS-scenarios for populations with overlapping generations were considered:</p>
      <p><bold>max.EBV:</bold> This is traditional OCS with segment-based kinship matrix. The mean breeding value in population was maximized, while the mean kinship was constrained such that <italic>N</italic><sub><italic>e</italic></sub>≥100.</p>
      <p><bold>max.segNC:</bold> This OCS approach is suitable for breeding programs whose main objective is to recover the native genetic background. The mean native contribution in the population was maximized, while the mean native kinship was constrained such that <italic>N</italic><sub><italic>e</italic></sub>≥100.</p>
      <p><bold>min.fSEG:</bold> This objective function is suitable for breeds suffering from inbreeding depression. The mean kinship was minimized, while the mean native contribution was constrained, and the mean breeding value was constrained not to decrease.</p>
      <p><bold>min.fSEGN:</bold> This OCS approach may be suitable for breeding programs that aim at maximizing the genetic diversity at native alleles and at recovering the native genetic background. The mean kinship at native alleles was minimized, while the mean native contribution was constrained to increase by at least 2.5% per year.</p>
      <p>The results shown in Figs. <xref rid="Fig2" ref-type="fig">2</xref> - <xref rid="Fig3" ref-type="fig">3</xref> were obtained from 50 replicates for scenarios with less than 300 selection candidates, and from 10 replicates for scenarios with more than 300 selection candidates. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the proportions of correct results (green), the proportions of suboptimal results (blue), and the proportions of cases in which no feasible solution was found (red). These proportions are shown for the different solvers, OCS-methods, and numbers of selection candidates. A result was classified as correct if the ratio between the value found by the solver and the best solution deviates from one by less than 1%. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the relative computation times needed by the different solvers. Computation times are standardized and can be compared directly only for a given number of selection candidates. Bars representing computation times of solvers that did not produce correct results in at least 80% of the cases are red.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Classification of results. Proportion of correct results (green), the proportions of suboptimal results (blue), and the proportions of cases in which no feasible solution was found (red) for different solvers, OCS-methods and numbers of selection candidates. A solution was classified as not correct if the value of the objective function at the solution deviates from the best estimate by more than 1%</p></caption><graphic xlink:href="12859_2018_2450_Fig2_HTML" id="MO32"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Relative computation time. Relative computation time needed by different solvers to find optimum solutions for different OCS-methods. Computation times are standardized and can be compared directly only for a given number of selection candidates, which are displayed at the right-hand side. Bars representing computation times of solvers that did not produce correct results in at least 80% of the cases are red</p></caption><graphic xlink:href="12859_2018_2450_Fig3_HTML" id="MO33"/></fig>
</p>
      <p>All solvers were able to find correct solutions when the number of selection candidates was small. Solver alabama provided suboptimal results for larger optimization problems and had the longest runtime, so its use can not be recommended. Solvers cccp and cccp2 had the shortest runtime for problems with linear or quadratic objective function and provided correct results, so their use can be recommended for breeding programs that aim at maximizing genetic gain, at recovering the native genetic background, or at minimizing kinships.</p>
      <p>Minimization of the native kinship is in general not a convex problem, so solver csdp could not be used for this. Solvers cccp and cccp2 are also not designed to solve non-convex problems, but were able to find the solution when the number of selection candidates was small. When the number of candidates was large, then their solutions did not satisfy the constraints. Hence, only solver slsqp can be recommended for breeding programs that aim at maximizing the genetic diversity at native alleles.</p>
    </sec>
    <sec id="Sec13">
      <title>Computation of pedigree-based kinships</title>
      <p>Different R packages exist to compute pedigree-based kinships, or, equivalently, the additive relationship matrix <bold>A</bold>. Table <xref rid="Tab1" ref-type="table">1</xref> shows the computation time needed to compute the kinship matrix for different numbers of individuals. The pedigree size was the number of individuals included in the pedigree, which are the individuals for which the kinships were to be computed and their ancestors. R package <bold>optiSel</bold> was 10 times faster than all other packages. Moreover, all other packages failed to compute the kinship matrix for the example data set with 32698 individuals because the memory that would have been needed by those packages was larger than 32 GB RAM.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Time needed for computing kinship matrices on a 3.40 GHz PC with 32GB RAM</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Pedigree size</th><th align="left">Individuals</th><th align="left">nadiv</th><th align="left">optiSel</th><th align="left">Pedigree</th><th align="left">pedigreeR</th><th align="left">pedigreemm</th></tr></thead><tbody><tr><td align="justify">47064</td><td align="left">4705</td><td align="left">189</td><td align="left">13</td><td align="left">648</td><td align="left">184</td><td align="left">184</td></tr><tr><td align="justify">70075</td><td align="left">12269</td><td align="left">1082</td><td align="left">64</td><td align="left">-</td><td align="left">930</td><td align="left">1080</td></tr><tr><td align="justify">96411</td><td align="left">32698</td><td align="left">-</td><td align="left">153</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr></tbody></table></table-wrap>
</p>
    </sec>
  </sec>
  <sec id="Sec14" sec-type="conclusion">
    <title>Conclusion</title>
    <p>Optimum contribution selection applied to local breeds requires special attention due to the conflicting objectives of their breeding programs. The free R package <bold>optiSel</bold> is an easy-to-use software taking these conflicting objectives into account. It enables to estimate the genetic parameters that need to be controlled, and which can subsequently be used to define the objective and constraints of a breeding program. The optimization problem can be solved with a variety of solvers, which provide a list with the optimum numbers of offspring for all selection candidates, and which can subsequently be used for mate allocation.</p>
  </sec>
  <sec id="Sec15">
    <title>Availability and requirements</title>
    <p>Project name: optiSel 2.0.1</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=optiSel">https://CRAN.R-project.org/package=optiSel</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: R and C++</p>
    <p>Other requirements: None</p>
    <p>License: The software is free</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2018_2450_MOESM1_ESM.zip">
            <label>Additional file 1</label>
            <caption>
              <p>Example data set and replication script. (ZIP 14700 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The author thanks Yu Wang for providing the data set used in this study.</p>
    <sec id="d29e3018">
      <title>Funding</title>
      <p>The study was supported by the German Research Foundation (Deutsche Forschungsgemeinschaft, DFG).</p>
    </sec>
    <sec id="d29e3023" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p>The example data set and a replication R-script are included as an electronic appendix. It is a subset of the data generated by [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>RW wrote the manuscript and the R package optiSel. The author read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec>
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec>
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec>
      <title>Competing interests</title>
      <p>The author declares that he has no competing interests.</p>
    </sec>
    <sec>
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meuwissen</surname>
            <given-names>THE</given-names>
          </name>
        </person-group>
        <article-title>Maximising the response of selection with a predefined rate of inbreeding</article-title>
        <source>J Animal Sci</source>
        <year>1997</year>
        <volume>75</volume>
        <fpage>934</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.2527/1997.754934x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartwig</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wellmann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hamann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bennewitz</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The contribution of migrant breeds to the genetic gain of beef traits of german vorderwald and hinterwald cattle</article-title>
        <source>J Anim Breeding Genet</source>
        <year>2014</year>
        <volume>131</volume>
        <fpage>496</fpage>
        <lpage>503</lpage>
        <pub-id pub-id-type="doi">10.1111/jbg.12099</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartwig</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wellmann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Emmerling</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hamann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bennewitz</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Short communication: Importance of introgression for milk traits in the german vorderwald and hinterwald cattle</article-title>
        <source>J Dairy Sci</source>
        <year>2015</year>
        <volume>98</volume>
        <fpage>2033</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.3168/jds.2014-8571</pub-id>
        <pub-id pub-id-type="pmid">25529416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amador</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Toro</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Removing exogeneous information using pedigree data</article-title>
        <source>Conserv Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>1565</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1007/s10592-011-0255-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wellmann</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimum contribution selection for conserved populations with historic migration</article-title>
        <source>Genet Sel Evol</source>
        <year>2012</year>
        <volume>44</volume>
        <fpage>34</fpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-44-34</pub-id>
        <pub-id pub-id-type="pmid">23153196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bennewitz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Simianer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Meuwissen</surname>
            <given-names>THE</given-names>
          </name>
        </person-group>
        <article-title>Investigations on merging breeds in genetic conservation schemes</article-title>
        <source>J Dairy Sci</source>
        <year>2008</year>
        <volume>91</volume>
        <fpage>2512</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.3168/jds.2007-0924</pub-id>
        <pub-id pub-id-type="pmid">18487675</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <mixed-citation publication-type="other">Wang Y, Wellmann R, Bennewitz J. Novel optimum contribution selection methods accounting for conflicting objectives in breeding programs for livestock breeds with historical migration. GSE. 2017; 49:45.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Segelke</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Emmerling</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bennewitz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wellmann</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Long-term impact of optimum contribution selection strategies on local livestock breeds with historical introgression</article-title>
        <source>G3</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>4009</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.117.300272</pub-id>
        <pub-id pub-id-type="pmid">29089375</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meuwissen</surname>
            <given-names>THE</given-names>
          </name>
        </person-group>
        <article-title>GENCONT: An operational tool for controlling inbreeding in selection and conservation schemes</article-title>
        <source>Proc. 7th World Congr. Genet. Applied to Livest. Prod., Montpellier, France</source>
        <year>2002</year>
        <volume>33</volume>
        <fpage>769</fpage>
        <lpage>70</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pong-Wong</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Woolliams</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Optimisation of contribution of candidate parents to maximise genetic gain and restricting inbreeding using semidefinite programming</article-title>
        <source>Genet Sel Evol</source>
        <year>2007</year>
        <volume>39</volume>
        <fpage>3</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-39-1-3</pub-id>
        <pub-id pub-id-type="pmid">17212945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <mixed-citation publication-type="other">Berg P, Nielsen J, Sørensen MK. EVA: Realized and predicted optimal genetic contributions. Proc 8th World Cong Genet Appl Livest Prod Belo Horizonte, Brazil. 2006;:246.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kinghorn</surname>
            <given-names>BP</given-names>
          </name>
        </person-group>
        <article-title>An algorithm for efficient constrained mate selection</article-title>
        <source>Genet Sel Evol</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>4</fpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-43-4</pub-id>
        <pub-id pub-id-type="pmid">21251244</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <mixed-citation publication-type="other">Fujisawa K, Kojima M, Nakata K, Yamashita M. SDPA (SemiDefinite Programming Algorithm) user’s manual—Version 6.0; 2002. Research Report B-308, Dept. of Mathematical and Computing Sciences, Tokyo Institute of Technology, Oh-Okayama, Meguro, Tokyo 152-8552, Japan, 1995. Revised July 2002.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <mixed-citation publication-type="other">Varadhan R. Alabama: Constrained Nonlinear Optimization. 2015. R package version 2015.3-1. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=alabama">https://CRAN.R-project.org/package=alabama</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Borchers</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Csdp, a c library for semidefinite programming</article-title>
        <source>Optim Methods Softw</source>
        <year>1999</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>613</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1080/10556789908805765</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <mixed-citation publication-type="other">Kraft D. A software package for sequential quadratic programming. 1988. Tech Rep DFVLR-FB 88-28, DLR German Aerospace Center—Institute for Flight Mechanics, Köln, Germany.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">Pfaff B. The R package cccp: Design for solving cone constrained convex programs. R Financ 16-17 May 2014 Chic. 2014.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maignel</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Boichard</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Verrier</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Genetic variability of french dairy breeds estimated from pedigree information</article-title>
        <source>Interbull Bull</source>
        <year>1996</year>
        <volume>14</volume>
        <fpage>49</fpage>
        <lpage>54</lpage>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peripolli</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Munari</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>MVGB</given-names>
          </name>
          <name>
            <surname>Lima</surname>
            <given-names>ALF</given-names>
          </name>
          <name>
            <surname>Irgang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Baldi</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Runs of homozygosity: current knowledge and applications in livestock</article-title>
        <source>Anim Genet</source>
        <year>2016</year>
        <volume>48</volume>
        <fpage>255</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1111/age.12526</pub-id>
        <pub-id pub-id-type="pmid">27910110</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <mixed-citation publication-type="other">Ferenčaković M, Sölkner J, Curik I. Estimating autozygosity from high-throughput information: effects of snp density and genotyping errors. Genet Sel Evol. 2013;45(42).</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meuwissen</surname>
            <given-names>THE</given-names>
          </name>
        </person-group>
        <article-title>Genetic management of small populations: A review</article-title>
        <source>Acta Agric Scand Sect A</source>
        <year>2009</year>
        <volume>59</volume>
        <fpage>71</fpage>
        <lpage>9</lpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Falconer</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <source>Introduction to Quantitative Genetics</source>
        <year>1989</year>
        <publisher-loc>Essex</publisher-loc>
        <publisher-name>Longman Group UK Limited</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
