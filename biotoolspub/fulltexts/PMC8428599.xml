<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8428599</article-id>
    <article-id pub-id-type="pmid">33523116</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab060</article-id>
    <article-id pub-id-type="publisher-id">btab060</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>M2R: a Python add-on to cobrapy for modifying human genome-scale metabolic reconstruction using the gut microbiota models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Weglarz-Tomczak</surname>
          <given-names>Ewelina</given-names>
        </name>
        <xref rid="btab060-cor1" ref-type="corresp"/>
        <aff><institution>Swammerdam Institute for Life Sciences, Faculty of Science, University of Amsterdam</institution>, Amsterdam, <country country="NL">The Netherlands</country></aff>
        <!--ewelina.weglarz.tomczak@gmail.com-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8634-694X</contrib-id>
        <name>
          <surname>Tomczak</surname>
          <given-names>Jakub M.</given-names>
        </name>
        <aff><institution>Department of Computer Science, Faculty of Science, Vrije Universiteit Amsterdam</institution>, Amsterdam, <country country="NL">The Netherlands</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brul</surname>
          <given-names>Stanley</given-names>
        </name>
        <aff><institution>Swammerdam Institute for Life Sciences, Faculty of Science, University of Amsterdam</institution>, Amsterdam, <country country="NL">The Netherlands</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Przytycka</surname>
          <given-names>Teresa</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab060-cor1">To whom correspondence should be addressed. <email>ewelina.weglarz.tomczak@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-02-01">
      <day>01</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>17</issue>
    <fpage>2785</fpage>
    <lpage>2786</lpage>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>31</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>24</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab060.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The gut microbiota is the human body’s largest population of microorganisms that interact with human intestinal cells. They use ingested nutrients for fundamental biological processes and have important impacts on human physiology, immunity and metabolome in the gastrointestinal tract.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present <monospace>M2R</monospace>, a Python add-on to <monospace>cobrapy</monospace> that allows incorporating information about the gut microbiota metabolism models to human genome-scale metabolic models (GEMs) like RECON3D. The idea behind the software is to modify the lower bounds of the exchange reactions in the model using aggregated in- and out-fluxes from selected microbes. <monospace>M2R</monospace> enables users to quickly and easily modify the pool of the metabolites that enter and leave the GEM, which is particularly important for those looking into an analysis of the metabolic interaction between the gut microbiota and human cells and its dysregulation.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><monospace>M2R</monospace> is freely available under an MIT License at <ext-link xlink:href="https://github.com/e-weglarz-tomczak/m2r" ext-link-type="uri">https://github.com/e-weglarz-tomczak/m2r</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Mobilność Plus V from the Polish Ministry of Science and Higher Education</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1639/MOB/V/2017/0</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The human cell metabolism is regulated by cell-intrinsic and cell-extrinsic factors. For instance, cell-intrinsic factors are genes and hormones, while cell-extrinsic factors are associated with the environment, and include nutrients availability, tissue-specific context and microbiota that resides on or within human tissues. Genome-wide modeling provides a useful approach to uncover the molecular basis of metabolism (<xref rid="btab060-B5" ref-type="bibr">Mendoza <italic toggle="yes">et al.</italic>, 2019</xref>). Most comprehensive human genome-wide model (GEM) Recon3D constitutes a computational resource that includes three-dimensional (3D) metabolite and protein structure data, and enable accurate integrated analyses of metabolic functions in humans (<xref rid="btab060-B2" ref-type="bibr">Brunk <italic toggle="yes">et al.</italic>, 2018</xref>). Human GEMs have been extensively used for analyzing mRNA expression data to elucidate how changes in gene expression impact cell physiology (<xref rid="btab060-B7" ref-type="bibr">Pandey <italic toggle="yes">et al.</italic>, 2019</xref>). However, genetics is not the only determinant of nutrient utilization by human cells. Metabolism is also influenced by metabolic constraints imposed by the environmental context. Integration of the nutrients availability data into genome-wide models improves prediction of metabolic phenotypes (<xref rid="btab060-B9" ref-type="bibr">Węglarz-Tomczak <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab060-B11" ref-type="bibr">Zampieri <italic toggle="yes">et al.</italic>, 2019</xref>). From the human metabolism perspective, the gut microbiota is especially important (<xref rid="btab060-B4" ref-type="bibr">Gentile and Weir, 2018</xref>). Its role is apparent in the proper functioning of the host body and any abnormalities of their constitution could lead to diseases like colon cancer (<xref rid="btab060-B10" ref-type="bibr">Wong and Yu, 2019</xref>). All these facts clearly show that modeling of the human metabolism in isolation from external factors like the gut microbiota is at best only partially true. Therefore, there is an increasing interest in combining human and microbe models (<xref rid="btab060-B1" ref-type="bibr">Baldini <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab060-B8" ref-type="bibr">Thiele <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    <p>Here, we consider a problem of the host-microbiota co-metabolism and the influence of the gut microbiota on the pool of metabolites available to a host. The goal of this work is to provide a method and software that modifies a human genome-scale metabolic model (e.g. Recon3D) using information about in- and out-fluxes obtained through the Flux Balance Analysis (<xref rid="btab060-B6" ref-type="bibr">Orth <italic toggle="yes">et al.</italic>, 2010</xref>) from the chosen gut microbiota metabolic model(s). The software is a stand-alone Python add-on to <monospace>cobrapy</monospace> (<xref rid="btab060-B3" ref-type="bibr">Ebrahim <italic toggle="yes">et al.</italic>, 2013</xref>), a standard framework for constraint-based modeling of metabolism. It loads metabolic models of the gut microbe(s) provided by a user and adapts lower bounds of the exchange reactions in a genome-wide reconstruction model that contains metabolites associated with the gut microbe(s). We refer to this software as Microbiota-to-Recon (<monospace>M2R</monospace>).</p>
  </sec>
  <sec>
    <title>2 Methods and features</title>
    <p><monospace>M2R</monospace> consists of five steps: (i) loading microbiota models, (ii) reading in- and out-fluxes of metabolites, (iii) aggregating all in- and out-fluxes, (iv) normalizing all in- and out-fluxes and (v) modifying reactions in a genome-scale reconstruction metabolic model that contain metabolites present in the loaded gut microbiota models. A schematic representation of our framework is presented in<xref rid="btab060-F1" ref-type="fig">Figure 1</xref>. <monospace>M2R</monospace> is implemented in Python (the code could be run using Python 2.x or Python 3.x), using <monospace>cobrapy</monospace> for loading, writing and processing models.</p>
    <fig position="float" id="btab060-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>A schematic representation of our framework. (<bold>A</bold>) Five steps in <monospace>M2R</monospace>: (i) loading microbiota models from a folder specified by a user, (ii) reading in- and out-fluxes of all metabolites from microbe(s) models, (iii) aggregating in- and out-fluxes of all metabolites, (iv) normalizing values of in- and out-fluxes of metabolites to a value specified by a user, (v) modifying lower bounds of reactions in a model with normalized in- and out-fluxes. (<bold>B</bold>) Software components used in our program: Virtual Metabolic Human database for microbiota models, and <monospace>cobrapy</monospace> for processing models. (<bold>C</bold>) Examples of results for normalizing fluxes. (<bold>D</bold>) Examples of results of modified reaction lower bounds in a model</p>
      </caption>
      <graphic xlink:href="btab060f1" position="float"/>
    </fig>
    <p>The main idea of the presented program is to modify a metabolic model by taking into account information of metabolites that take part in the external reactions of the selected gut microbiota models. Typically, genome-scale metabolic models are assumed to be in their steady-state. Hence, it is possible to consider only those metabolites of the gut microbe(s) that are part of their external reactions, because these are responsible for the consumption or production of nutrients.</p>
    <p>In analyses based on fluxes, a lower/upper bound of a reaction determines a possible uptake/secretion. Further, if there is no prior knowledge available like gene expressions or proteomics, and/or nutrients availability data the lower/upper bounds of reactions in the model are typically set to an arbitrary value, e.g. 1000.</p>
    <p>The gut microbiota could consume nutrients or produce metabolites, thus, we can use this information to modify the lower bounds of the reactions in the host model. First, we need to read and aggregate fluxes of the microbe(s) metabolites associated with the microbe(s) external reactions. Then, we normalize them to a given value, i.e. by dividing aggregated in- and out-fluxes by the maximum value of all fluxes and then multiplying them by the desired value, e.g. 1000. Finally, we update the lower bounds associated with the microbe(s) metabolites as follows: 
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>α</mml:mo><mml:mi>L</mml:mi><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">LB<sub>r</sub></italic> is a lower-bound of a reaction <italic toggle="yes">r</italic>, <italic toggle="yes">f<sub>i</sub></italic> and <italic toggle="yes">f<sub>o</sub></italic> denote an in-flux and an out-flux of the considered gut microbe(s) metabolite involved in the reaction <italic toggle="yes">r</italic>, respectively, and <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is a weight that scales the original value of the lower bound and the in- and out-fluxes. Note that in most cases <italic toggle="yes">f<sub>i</sub></italic> and/or <italic toggle="yes">f<sub>o</sub></italic> equals 0.</p>
    <p>We introduce the factor <italic toggle="yes">α</italic> that defines the weight of the biological systems. Since it is estimated that in a human body there are at least as many microbes as nucleated human cells, we set <italic toggle="yes">α</italic> to 0.5 in our demonstration.</p>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>In this work, we present Python-based software for modifying the human genome-scale metabolic model with the gut microbe(s) model(s). Its development in Python, an open-source platform, simplifies distribution and enables the use on most operating systems. <monospace>M2R</monospace> is easy-to-use and allows us to update the pool of nutrients/metabolites available for the host based on the gut microbiota metabolism. Lastly, the code is freely available and it could be further developed in the future.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>E.W.-T. was financed by a grant within Mobilność Plus V from the Polish Ministry of Science and Higher Education [1639/MOB/V/2017/0].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab060_Supplementary_Data</label>
      <media xlink:href="btab060_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab060-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baldini</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>The microbiome modeling toolbox: from microbial interactions to personalized microbial communities</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>2332</fpage>–<lpage>2334</lpage>.<pub-id pub-id-type="pmid">30462168</pub-id></mixed-citation>
    </ref>
    <ref id="btab060-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brunk</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Recon3d enables a three-dimensional view of gene variation in human metabolism</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>272</fpage>–<lpage>281</lpage>.<pub-id pub-id-type="pmid">29457794</pub-id></mixed-citation>
    </ref>
    <ref id="btab060-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ebrahim</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>COBRApy: constraints-based reconstruction and analysis for Python</article-title>. <source>BMC Syst. Biol</source>., <volume>7</volume>, <fpage>74</fpage>.<pub-id pub-id-type="pmid">23927696</pub-id></mixed-citation>
    </ref>
    <ref id="btab060-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gentile</surname><given-names>C.L.</given-names></string-name>, <string-name><surname>Weir</surname><given-names>T.L.</given-names></string-name></person-group> (<year>2018</year>) 
<article-title>The gut microbiota at the intersection of diet and human health</article-title>. <source>Science</source>, <volume>362</volume>, <fpage>776</fpage>–<lpage>780</lpage>.<pub-id pub-id-type="pmid">30442802</pub-id></mixed-citation>
    </ref>
    <ref id="btab060-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mendoza</surname><given-names>S.N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>A systematic assessment of current genome-scale metabolic reconstruction tools</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>1</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="btab060-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Orth</surname><given-names>J.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>What is flux balance analysis?</article-title>  <source>Nat. Biotechnol</source>., <volume>28</volume>, <fpage>245</fpage>–<lpage>248</lpage>.<pub-id pub-id-type="pmid">20212490</pub-id></mixed-citation>
    </ref>
    <ref id="btab060-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pandey</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Enhanced flux prediction by integrating relative expression and relative metabolite abundance into thermodynamically consistent metabolic models</article-title>. <source>PLoS Comput. Biol</source>., <volume>15</volume>, <fpage>e1007036</fpage>.<pub-id pub-id-type="pmid">31083653</pub-id></mixed-citation>
    </ref>
    <ref id="btab060-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thiele</surname><given-names>I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) 
<article-title>Personalized whole-body models integrate metabolism, physiology, and the gut microbiome</article-title>. <source>Mol. Syst. Biol</source>., <volume>16</volume>, <fpage>e8982</fpage>.<pub-id pub-id-type="pmid">32463598</pub-id></mixed-citation>
    </ref>
    <ref id="btab060-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Węglarz-Tomczak</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) 
<article-title>Simultaneous integration of gene expression and nutrient availability for studying metabolism of hepatocellular carcinoma</article-title>. <source>BioRxiv</source>, <fpage>674150</fpage>. <pub-id pub-id-type="doi">10.1101/674150</pub-id>.</mixed-citation>
    </ref>
    <ref id="btab060-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wong</surname><given-names>S.H.</given-names></string-name>, <string-name><surname>Yu</surname><given-names>J.</given-names></string-name></person-group> (<year>2019</year>) 
<article-title>Gut microbiota in colorectal cancer: mechanisms of action and clinical applications</article-title>. <source>Nat. Rev. Gastroenterol. Hepatol</source>., <volume>16</volume>, <fpage>690</fpage>–<lpage>704</lpage>.<pub-id pub-id-type="pmid">31554963</pub-id></mixed-citation>
    </ref>
    <ref id="btab060-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zampieri</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Regulatory mechanisms underlying coordination of amino acid and glucose catabolism in <italic toggle="yes">Escherichia coli</italic></article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>1</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">30602773</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
