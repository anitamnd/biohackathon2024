<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9813222</article-id>
    <article-id pub-id-type="pmid">36599879</article-id>
    <article-id pub-id-type="publisher-id">27057</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-022-27057-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>End-to-end differentiable blind tip reconstruction for noisy atomic force microscopy images</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Matsunaga</surname>
          <given-names>Yasuhiro</given-names>
        </name>
        <address>
          <email>ymatsunaga@mail.saitama-u.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fuchigami</surname>
          <given-names>Sotaro</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ogane</surname>
          <given-names>Tomonori</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Takada</surname>
          <given-names>Shoji</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.263023.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 0703 3735</institution-id><institution>Graduate School of Science and Engineering, </institution><institution>Saitama University, </institution></institution-wrap>Saitama, 338-8570 Japan </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.258799.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 0372 2033</institution-id><institution>Department of Biophysics, Graduate School of Science, </institution><institution>Kyoto University, </institution></institution-wrap>Kyoto, 606-8502 Japan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>129</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Observing the structural dynamics of biomolecules is vital to deepening our understanding of biomolecular functions. High-speed (HS) atomic force microscopy (AFM) is a powerful method to measure biomolecular behavior at near physiological conditions. In the AFM, measured image profiles on a molecular surface are distorted by the tip shape through the interactions between the tip and molecule. Once the tip shape is known, AFM images can be approximately deconvolved to reconstruct the surface geometry of the sample molecule. Thus, knowing the correct tip shape is an important issue in the AFM image analysis. The blind tip reconstruction (BTR) method developed by Villarrubia (J Res Natl Inst Stand Technol 102:425, 1997) is an algorithm that estimates tip shape only from AFM images using mathematical morphology operators. While the BTR works perfectly for noise-free AFM images, the algorithm is susceptible to noise. To overcome this issue, we here propose an alternative BTR method, called <italic>end-to-end differentiable</italic> BTR, based on a modern machine learning approach. In the method, we introduce a loss function including a regularization term to prevent overfitting to noise, and the tip shape is optimized with automatic differentiation and backpropagations developed in deep learning frameworks. Using noisy pseudo-AFM images of myosin V motor domain as test cases, we show that our end-to-end differentiable BTR is robust against noise in AFM images. The method can also detect a double-tip shape and deconvolve doubled molecular images. Finally, application to real HS-AFM data of myosin V walking on an actin filament shows that the method can reconstruct the accurate surface geometry of actomyosin consistent with the structural model. Our method serves as a general post-processing for reconstructing hidden molecular surfaces from any AFM images. Codes are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/matsunagalab/differentiable_BTR">https://github.com/matsunagalab/differentiable_BTR</ext-link>.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Biophysics</kwd>
      <kwd>Image processing</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Atomic force microscopy</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002241</institution-id>
            <institution>Japan Science and Technology Agency</institution>
          </institution-wrap>
        </funding-source>
        <award-id>JPMJCR1762</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001700</institution-id>
            <institution>Ministry of Education, Culture, Sports, Science and Technology</institution>
          </institution-wrap>
        </funding-source>
        <award-id>JPMXP1020200101</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001691</institution-id>
            <institution>Japan Society for the Promotion of Science</institution>
          </institution-wrap>
        </funding-source>
        <award-id>20K21380</award-id>
        <principal-award-recipient>
          <name>
            <surname>Matsunaga</surname>
            <given-names>Yasuhiro</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Network Joint Research Center for Materials and Devices</institution>
        </funding-source>
        <award-id>20221300</award-id>
        <principal-award-recipient>
          <name>
            <surname>Matsunaga</surname>
            <given-names>Yasuhiro</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Atomic force microscopy (AFM) is a unique technique for imaging structures of sample molecules bound to a surface at ambient conditions<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Recently, high-speed AFM (HS-AFM) with dramatically faster imaging rates (up to tens of frames per second) has been developed, enabling us to directly observe biomolecules in action<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup>. HS-AFM can investigate detailed structure–function relationships in biomolecules that cannot be observed with other methods, and it has been established as one of indispensable techniques in modern biophysics. Example applications of HS-AFM include myosin V walking along an actin filament<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, rotary catalysis of F<sub>1</sub>-ATPase<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, structural dynamics of intrinsically disordered protein<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, and the functional dynamics of CRISPR-Cas9 in action<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. Currently, the spatial resolutions of HS-AFM instruments are ~ 2 nm in the lateral direction and ~ 0.15 nm in the vertical direction to the AFM stage<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>.</p>
    <p id="Par3">Importantly, separately from the resolution of the image profile, the resolutions of the obtained sample surface information are further limited by the tip geometry and the tip-sample interactions. The relationship among the tip geometry, the image profile, and the sample surface is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a and b. When the tip is sufficiently thin, the obtained image profile is nearly the same as the sample surface (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). On the other hand, when the tip is blunt compared to the scale of samples, the image profile is blurred from the sample surface (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Once the tip shape is known, algorithms, called <italic>erosion</italic>, have been proposed to “deconvolve” the image profile for reconstructing approximate sample surface geometry<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>. Thus, to reconstruct the surface geometry of the sample molecule, it is crucial to know the tip shape accurately. Tip shape estimation is also important for inferring 3D molecular structures from AFM images. In the recent analysis of AFM images, pseudo-AFM images are emulated from 3D molecular structures (obtained with different experimental or computational techniques, e.g., X-ray crystallography or molecular dynamics simulations) and an assumed tip shape and then compared with the experimental AFM image<sup><xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR21">21</xref></sup>. In the analysis, the 3D structure which generates the pseudo-AFM images most similar to the experimental AFM image is selected as the best estimate for 3D molecular structure. In this kind of analysis, the accuracy of pseudo-AFM images crucially depends on the tip shape. Thus, the tip shape should be determined as accurately as possible.<fig id="Fig1"><label>Figure 1</label><caption><p>Morphology operators and schematic of end-to-end differentiable blind tip reconstruction (BTR). (<bold>a</bold>) Image profile obtained by scanning a surface with a thin tip. (<bold>b</bold>) Image profile obtained by scanning the same surface as (<bold>a</bold>) with a blunt tip. (<bold>c</bold>) Schematic picture illustrating a morphology operator, <italic>dilation</italic>. (<bold>d</bold>) Schematic picture illustrating a morphology operator, <italic>erosion</italic>. Here, for the sake of intuitive explanation, erosion is represented with a non-inverted tip instead of its inversion. (<bold>e</bold>) Relation of a contact point and tip apex position, explaining the idea behind the original BTR. (<bold>f</bold>) Schematic of end-to-end differentiable BTR.</p></caption><graphic xlink:href="41598_2022_27057_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par4">Currently, there are three possible approaches to obtain a tip shape<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup>. The first approach is the direct imaging of a tip using either a scanning or transmission electron microscope (SEM or TEM). However, both SEM and TEM provide only a two-dimensional projection of the sample. It is unrealistic to install special equipment for imaging the tip from various angles as a routine for determining the tip shape. Moreover, as the tip can be damaged over time during AFM measurement, determining tip shape before or after the AFM measurement is not necessarily appropriate. The second approach is to estimate the tip shape during the AFM measurement. This approach determines the tip shape from samples whose geometry is a priori known<sup><xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref></sup>. With the combination of mathematical modeling, an approximate tip shape can be reconstructed. For example, Niina et al. recently proposed a method to estimate a tip shape by comparing the pseudo-AFM images generated from 3D molecular structures with AFM images<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. By assuming that the tip shape is a hemisphere (radius <italic>r</italic>) combined with a circular frustum of a cone (half angle <italic>θ</italic>), they proposed to estimate these two geometric parameters. However, since real tips can be of any shape, e.g., double-tip shape with two separate acutes, the assumption of a shape limits the application of the method.</p>
    <p id="Par5">The third approach estimates the tip shape through the image analysis of AFM data without any prior knowledge of sample molecule and tip shape. The blind tip reconstruction<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> developed by Villarrubia is a classical method to estimate arbitrary tip shapes from AFM images. The idea behind the algorithm is to recognize that sizes and depths of dents in the image profile must be smoother than the sharpness of the tip. Then, the algorithm “carves” an initially blunt tip according to the sizes and depths of dents (details will be described below). While the BTR works perfectly for noise-free AFM images, its algorithm is susceptible to noise, or it is difficult to determine a threshold parameter against noise. This is a crucial issue for the analysis of HS-AFM images because HS-AFM is generally more prone to noise than conventional AFM. Over these two decades, several improvements or new methods have been proposed for better estimation of tip shape; Dongmo et al. proposed monitoring tip volume for tuning <italic>thresh</italic> parameter for noisy AFM images. Tian et al. extended Villarrubia’s original BTR with the dexel representation for reconstructing general 3D tip shapes and proposed an improved regularization scheme against noise<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. Jóźwiak et al. simplified Tian’s idea to the case of standard AFM tips<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. Flater et al. proposed a systematic way to determine the threshold parameter against noisy AFM images<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. By approximating mathematical morphology operators by linear operators, Bakucz et al. proposed a reconstruction method based on the Expectation–Maximization (EM) algorithm with the tip shape represented as a hidden variable<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Despite these studies, the original BTR is not routinely utilized in the analysis of noisy AFM data, especially for the analysis of HS-AFM data, due to its susceptibility to noise and difficulty in tuning the parameter.</p>
    <p id="Par6">The reason why Villarrubia’s BTR is susceptible to noise is that it is difficult to correctly determine whether the tip shape geometry or noise causes an individual dent in the image profile. In the algorithm of the BTR, once a dent caused by noise is misinterpreted as the cause of the geometry of the tip, the tip is “carved” to be fitted to the noise. This leads to a reconstruction of very thin tip shape. In terms of machine learning theory, this can be regarded as overfitting the tip shape to noise.</p>
    <p id="Par7">To prevent such overfitting, we here introduce an appropriate loss function including a regularization term considering noise statistics, which are absent in the original BTR. As the morphology operators (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c,d) used in the loss function are complicated nonlinear functions, minimizing such a complicated loss function over tip shape is challenging. The technologies developed by recent advances in deep learning studies<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> can potentially overcome this problem. Automatic differentiation and smart optimizers are recently being applied to optimize not only the parameters of neural networks but also the parameters of physical models, by implementing physical functions as differentiable functions<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup>. For example, Zhou et al. recently modeled the Lorentz TEM observation process as a differentiable neural network layer and successfully solved the inverse problem of phase retrieval stably by backpropagation<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. In the current study, we propose to use these technologies to optimize the loss function over the tip shape. Our method (called the end-to-end differentiable BTR) implements morphology operators as differentiable functions and optimizes the loss function in the same way as neural networks under a deep learning framework. Using pseudo-AFM images generated from a known molecular structure (myosin V motor domain) as a test case, we show that the differentiable BTR is robust against noise in AFM images, as well as lower parameter dependence compared to the original BTR. Furthermore, the differentiable BTR can correctly detect double tips, one of the artifacts that frequently occur in AFM measurements. Finally, we applied the method to real noisy HS-AFM images, myosin V walking along an actin filament.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par8">We briefly review the original BTR by Villarrubia<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, then introduce the end-to-end differentiable BTR. First, let the AFM stage be the <italic>xy</italic>-plane, and the height perpendicular to the stage be <italic>z</italic>-coordinate, where the stage position corresponds to <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z=0$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq1.gif"/></alternatives></inline-formula>. Then, the height of the sample surface at coordinates (<italic>x</italic>, <italic>y</italic>) is denoted by <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s(x,y)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq2.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a,b). The image profile obtained by scanning the sample surface with a tip is denoted by <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i(x,y)$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq3.gif"/></alternatives></inline-formula>. Then, the coordinate system for tip shape is introduced. We define the <italic>uv</italic>-plane parallel to the <italic>xy</italic>-plane, and its origin is located at the top of the tip apex, i.e., the tip apex corresponds to <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z=0$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq4.gif"/></alternatives></inline-formula> in the <italic>uv</italic>-coordinate system. The <italic>uv</italic>-coordinate system is a moving coordinate that moves with the tip. The height of the tip surface is represented by <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t(u,v)\ge 0$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq5.gif"/></alternatives></inline-formula>, which determines the tip shape. For convenience, let us consider an inversion of the tip shape through the origin and define the surface of the inverted tip as <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(u,v\right)=-t\left(-u,-v\right)\le 0$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>t</mml:mi><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mi>v</mml:mi></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq6.gif"/></alternatives></inline-formula>. Then, the image profile <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i(x,y)$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq7.gif"/></alternatives></inline-formula> can be obtained using <italic>dilation</italic>, which is an operator in the mathematical morphology<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>,<disp-formula id="Equa"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\left(x,y\right)=\underset{u,v}{\mathrm{max}}\left[s\left(x-u, y-v\right)+p\left(u,v\right)\right]$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mrow><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mi mathvariant="normal">max</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mi>v</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41598_2022_27057_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par9">Conceptually, this would be viewed as a “convolution” of the molecular surface <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s(x,y)$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq8.gif"/></alternatives></inline-formula> with a kernel function <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(u,v\right)$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq9.gif"/></alternatives></inline-formula> (the inverted tip shape) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). But note that the dilation is not the same as convolution because convolution is a linear transformation while dilation is a nonlinear transformation, representing the physical interaction between tip and sample. Following the terminology of mathematical morphology, let us denote the sets of all points on or below the surfaces as <italic>umbras</italic>, and three umbras for surface <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s(x,y)$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq10.gif"/></alternatives></inline-formula>, <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i(x,y)$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq11.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(x,y)$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq12.gif"/></alternatives></inline-formula> defined by <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S=\left\{\left(x,y,z\right) | z\le s(x,y)\right\}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo>≤</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq13.gif"/></alternatives></inline-formula>, <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I=\left\{\left(x,y,z\right) | z\le i(x,y)\right\}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq14.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P=\left\{\left(u,v,z\right) | z\le p(u,v)\right\}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo>≤</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq15.gif"/></alternatives></inline-formula>, respectively. Then the dilation can be simply written as <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I=S\oplus P$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mo>⊕</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq16.gif"/></alternatives></inline-formula>. Given the umbras <italic>I</italic> of a measured image profile <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i(x,y)$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq17.gif"/></alternatives></inline-formula> and an inverted tip shape <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M38"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq18.gif"/></alternatives></inline-formula>, the sample surface <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M40"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq19.gif"/></alternatives></inline-formula> can be approximately reconstructed by <italic>erosion</italic>, written as <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}^{\left(r\right)}=I\ominus P$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mo>⊖</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq20.gif"/></alternatives></inline-formula>, which is another operator in the mathematical morphology defined by,<disp-formula id="Equb"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}^{\left(r\right)}\left(x,y\right)=\underset{u,v}{\mathrm{min}}\left[i\left(x+u,y+v\right)+t\left(u,v\right)\right]=\underset{u,v}{\mathrm{min}}\left[i\left(x+u,y+v\right)-p\left(u,v\right)\right]$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mrow><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mi mathvariant="normal">min</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mi mathvariant="normal">min</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41598_2022_27057_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par10">Erosion “carves” dents in the image profile <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i(x,y)$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq21.gif"/></alternatives></inline-formula> that are smaller than the tip shape <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(u,v\right)$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq22.gif"/></alternatives></inline-formula>. Conceptually, this would be viewed as a “deconvolution” that “carves” the image profile with a kernel function <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(u,v\right)$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq23.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). But note again that the erosion is a nonlinear transformation. From the properties of the erosion, we can say that <inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}^{\left(r\right)}\oplus P=\left(I\ominus P\right)\oplus P=I$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mo>⊕</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mi>I</mml:mi><mml:mo>⊖</mml:mo><mml:mi>P</mml:mi></mml:mfenced><mml:mo>⊕</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq24.gif"/></alternatives></inline-formula> and <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}^{\left(r\right)}\supseteq S$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mo>⊇</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq25.gif"/></alternatives></inline-formula>, which means that <inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}^{\left(r\right)}$$\end{document}</tex-math><mml:math id="M56"><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq26.gif"/></alternatives></inline-formula> is the (least) upper bound on sample surfaces that reproduces the image profile <inline-formula id="IEq27"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I$$\end{document}</tex-math><mml:math id="M58"><mml:mi>I</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq27.gif"/></alternatives></inline-formula> with the tip shape <inline-formula id="IEq28"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M60"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq28.gif"/></alternatives></inline-formula>. The dilation of the erosion of A by B is called <italic>opening</italic>, and is written as <inline-formula id="IEq29"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(A\ominus B\right)\oplus B=A\circ B$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mfenced close=")" open="("><mml:mi>A</mml:mi><mml:mo>⊖</mml:mo><mml:mi>B</mml:mi></mml:mfenced><mml:mo>⊕</mml:mo><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>∘</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq29.gif"/></alternatives></inline-formula>, so the above relation can be written simply as <inline-formula id="IEq30"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\circ P=I$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>I</mml:mi><mml:mo>∘</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq30.gif"/></alternatives></inline-formula>. Note that the relation <inline-formula id="IEq31"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\circ P=I$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>I</mml:mi><mml:mo>∘</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq31.gif"/></alternatives></inline-formula> does not always hold for any <inline-formula id="IEq32"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M68"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq32.gif"/></alternatives></inline-formula>. Instead, the relation holds only for the correct tip shape <inline-formula id="IEq33"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M70"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq33.gif"/></alternatives></inline-formula> that generated <inline-formula id="IEq34"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I$$\end{document}</tex-math><mml:math id="M72"><mml:mi>I</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq34.gif"/></alternatives></inline-formula> or very thin shapes like the δ-function. In general, opening removes dents smaller than tip shape <inline-formula id="IEq35"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M74"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq35.gif"/></alternatives></inline-formula> because erosion “carves” such minor dents while the subsequent dilation cannot reconstruct them. Thus, <inline-formula id="IEq36"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\circ P=I$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>I</mml:mi><mml:mo>∘</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq36.gif"/></alternatives></inline-formula> does not hold, e.g., for extremely blunt tips.</p>
    <p id="Par11">The algorithm of Villarrubia’s BTR (hereafter called the <italic>original</italic> BTR) estimates an upper bound on the tip shape from AFM images. The original BTR starts from the relation, <inline-formula id="IEq37"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\circ P=I$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi>I</mml:mi><mml:mo>∘</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq37.gif"/></alternatives></inline-formula>, and constructs an upper bound condition on <inline-formula id="IEq38"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M80"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq38.gif"/></alternatives></inline-formula> from this relation. An important property of opening is <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\circ P=\bigcup \left\{P+{\varvec{a}} | P+{\varvec{a}}\subset I\right\}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>I</mml:mi><mml:mo>∘</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mo>⋃</mml:mo><mml:mfenced close="}" open="{"><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mo>⊂</mml:mo><mml:mi>I</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq39.gif"/></alternatives></inline-formula> where <inline-formula id="IEq40"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{a}}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq40.gif"/></alternatives></inline-formula> is a three-dimensional translation<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. Combined with the relation <inline-formula id="IEq41"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\circ P=I$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi>I</mml:mi><mml:mo>∘</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq41.gif"/></alternatives></inline-formula>, we can say <inline-formula id="IEq42"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I=\bigcup \left\{P+{\varvec{a}} | P+{\varvec{a}}\subset I\right\}$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mo>⋃</mml:mo><mml:mfenced close="}" open="{"><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mo>⊂</mml:mo><mml:mi>I</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq42.gif"/></alternatives></inline-formula>. This means that every point of <inline-formula id="IEq43"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I$$\end{document}</tex-math><mml:math id="M90"><mml:mi>I</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq43.gif"/></alternatives></inline-formula> is contained in one or more translates of <inline-formula id="IEq44"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M92"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq44.gif"/></alternatives></inline-formula> while the translates are limited by the requirement that no part of the translated inverted tip extends above the surface of <inline-formula id="IEq45"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I$$\end{document}</tex-math><mml:math id="M94"><mml:mi>I</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq45.gif"/></alternatives></inline-formula>. In particular, every point on the surface of <inline-formula id="IEq46"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I$$\end{document}</tex-math><mml:math id="M96"><mml:mi>I</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq46.gif"/></alternatives></inline-formula> must be touched by the surface of one or more of these translates of <inline-formula id="IEq47"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M98"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq47.gif"/></alternatives></inline-formula>. Suppose that the translated inverted tip touches the surface of <inline-formula id="IEq48"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I$$\end{document}</tex-math><mml:math id="M100"><mml:mi>I</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq48.gif"/></alternatives></inline-formula> at <inline-formula id="IEq49"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}\in I,$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq49.gif"/></alternatives></inline-formula> and the vector from the origin (tip apex) of the moving <inline-formula id="IEq50"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$uv$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi mathvariant="italic">uv</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq50.gif"/></alternatives></inline-formula>-coordinates to <inline-formula id="IEq51"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq51.gif"/></alternatives></inline-formula> is defined as <inline-formula id="IEq52"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{d}}$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq52.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e). Then, the translated inverted tip can be written as <inline-formula id="IEq53"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P+{\varvec{c}}-{\varvec{d}}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq53.gif"/></alternatives></inline-formula>, and the upper bound condition on the inverted tip shape is that the translated inverted tip is entirely on or below the surface of <inline-formula id="IEq54"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I$$\end{document}</tex-math><mml:math id="M112"><mml:mi>I</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq54.gif"/></alternatives></inline-formula>, that is,<disp-formula id="Equc"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\subseteq I-{\varvec{c}}+{\varvec{d}}$$\end{document}</tex-math><mml:math id="M114" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⊆</mml:mo><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:mrow></mml:math><graphic xlink:href="41598_2022_27057_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par12">This condition holds for any <inline-formula id="IEq55"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{c}}$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq55.gif"/></alternatives></inline-formula> on the surface or inside of <inline-formula id="IEq56"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I$$\end{document}</tex-math><mml:math id="M118"><mml:mi>I</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq56.gif"/></alternatives></inline-formula> where <inline-formula id="IEq57"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{d}}$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq57.gif"/></alternatives></inline-formula> exists.</p>
    <p id="Par13">The original BTR finds <italic>P</italic> that satisfies this upper bound condition. The algorithm starts from a thick tip shape (typically, a square pillar with a flat top), as an initial condition, that includes the true <italic>P</italic> as a subset. When the tip touches on the surface of image profile umbra <italic>I</italic> at point <inline-formula id="IEq58"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i({c}_{x},{c}_{y})$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq58.gif"/></alternatives></inline-formula>, the height of the image profile in terms of the moving <italic>uv</italic>-coordinate is <inline-formula id="IEq59"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\left({c}_{x},{c}_{y}\right)=p\left({d}_{u},{d}_{v}\right)$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>d</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq59.gif"/></alternatives></inline-formula> at <inline-formula id="IEq60"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{d}}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq60.gif"/></alternatives></inline-formula>, and the heights of the image profile at other (<italic>u</italic>, <italic>v</italic>) locations are <inline-formula id="IEq61"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\left({c}_{x}+u-{d}_{u},{c}_{y}+y-{d}_{v}\right)$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq61.gif"/></alternatives></inline-formula>. By adding the height of the tip at the touch point <inline-formula id="IEq62"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({d}_{u},{d}_{v}\right)$$\end{document}</tex-math><mml:math id="M130"><mml:mfenced close=")" open="("><mml:msub><mml:mi>d</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq62.gif"/></alternatives></inline-formula> to the difference between the two heights above, we get <inline-formula id="IEq63"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dill=i\left({c}_{x}+u-{d}_{u},{c}_{y}+y-{d}_{v}\right)-i\left({c}_{x},{c}_{y}\right)+p\left({d}_{u},{d}_{v}\right)$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>d</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq63.gif"/></alternatives></inline-formula>. By calculating <inline-formula id="IEq64"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dill$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi mathvariant="italic">dill</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq64.gif"/></alternatives></inline-formula> for all possible <inline-formula id="IEq65"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{d}}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq65.gif"/></alternatives></inline-formula>, we find the minimum value of <inline-formula id="IEq66"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dill$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi mathvariant="italic">dill</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq66.gif"/></alternatives></inline-formula>, written as <inline-formula id="IEq67"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${dill}_{min}$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mrow><mml:mi mathvariant="italic">dill</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq67.gif"/></alternatives></inline-formula>. If <inline-formula id="IEq68"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${dill}_{min}+thresh&lt;p(u, v)$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">dill</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq68.gif"/></alternatives></inline-formula>, then the tip shape is updated (or “carved”) with a smaller height, <inline-formula id="IEq69"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(u, v\right)={dill}_{min}+thresh$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">dill</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq69.gif"/></alternatives></inline-formula>. Here, <inline-formula id="IEq70"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$thresh&gt;0$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq70.gif"/></alternatives></inline-formula> is a parameter that determines a tolerance of inconsistency between the image profile and the tip estimate. The above calculations are performed for all <inline-formula id="IEq71"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({c}_{x},{c}_{y}\right)$$\end{document}</tex-math><mml:math id="M148"><mml:mfenced close=")" open="("><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq71.gif"/></alternatives></inline-formula> positions on the image profile <inline-formula id="IEq72"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\left({c}_{x},{c}_{y}\right)$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq72.gif"/></alternatives></inline-formula>. All the computational steps are repeated until the tip shape is converged. In the end, the upper bound on the true shape <italic>P</italic>, <inline-formula id="IEq73"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}^{\left(r\right)}\supseteq P$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mo>⊇</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq73.gif"/></alternatives></inline-formula>, is reconstructed. In this algorithm, <inline-formula id="IEq74"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$thresh$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mi mathvariant="italic">thresh</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq74.gif"/></alternatives></inline-formula> is a critical parameter for the accuracy of the tip reconstruction. Indeed, if noise is contained in the image profile, the reconstructed tip shape is strongly influenced by the geometries or dents of noise in the image profile. To choose the best <inline-formula id="IEq75"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$thresh$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mi mathvariant="italic">thresh</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq75.gif"/></alternatives></inline-formula> value, however, it is necessary to find a scale that well discriminates the heights of the sample surface geometry from the heights of the noise geometry, which is a difficult task, especially for novice users.</p>
    <p id="Par14">In the following, the end-to-end differentiable BTR is introduced (Fig. <xref rid="Fig1" ref-type="fig">1</xref>f). The fact that the tip reconstruction is affected by noise in the original BTR can be regarded as an overfitting problem in machine learning. In machine learning, a typical approach to prevent overfitting is to use an appropriate loss function including a regularization. The point of our idea is to statistically determine whether or not to carve the tip from the entire AFM data according to a loss function that takes noise into account, rather than individually determining whether or not to carve the tip from each dent in the image profile, as in the original BTR. Following the original BTR, our differentiable BTR is based on the relation <inline-formula id="IEq76"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\circ P=I$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi>I</mml:mi><mml:mo>∘</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq76.gif"/></alternatives></inline-formula>, but the condition is relaxed because the equality does not hold in the presence of noise. Specifically, assuming that the noise is spatially independent Gaussian noise, the loss function to be minimized would be the mean square error,<disp-formula id="Equd"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}\left(p\right)=\frac{1}{N}{\Vert {i}^{\left(r\right)}-i\Vert }^{2}=\frac{1}{N}\sum_{x,y}{\left({i}^{\left(r\right)}\left(x,y\right)-i\left(x,y\right)\right)}^{2}$$\end{document}</tex-math><mml:math id="M160" display="block"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><graphic xlink:href="41598_2022_27057_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq77"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M162"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq77.gif"/></alternatives></inline-formula> is the number of pixels, and <inline-formula id="IEq78"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Vert \Vert }^{2}$$\end{document}</tex-math><mml:math id="M164"><mml:msup><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq78.gif"/></alternatives></inline-formula> is the L2 norm. <inline-formula id="IEq79"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}^{\left(r\right)}$$\end{document}</tex-math><mml:math id="M166"><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq79.gif"/></alternatives></inline-formula> is an image created by the opening <inline-formula id="IEq80"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}^{\left(r\right)}=I\circ P=\left(I\ominus P\right)\oplus P$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mo>∘</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mi>I</mml:mi><mml:mo>⊖</mml:mo><mml:mi>P</mml:mi></mml:mfenced><mml:mo>⊕</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq80.gif"/></alternatives></inline-formula> with some tip shape <italic>P</italic>. Expanding <inline-formula id="IEq81"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}^{\left(r\right)}\left(x,y\right)$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq81.gif"/></alternatives></inline-formula> by morphology operators, it can be written as<disp-formula id="Eque"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}^{\left(r\right)}\left(x,y\right)=\underset{u,v}{\mathrm{max}}\left[\underset{u{^{\prime}},v{^{\prime}}}{\mathrm{min}}\left[i\left(x-u+{u}^{^{\prime}},y-v+v{^{\prime}}\right)-p\left(u{^{\prime}},v{^{\prime}}\right)\right]+p\left(u,v\right)\right]$$\end{document}</tex-math><mml:math id="M172" display="block"><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mi mathvariant="normal">max</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:munder><mml:mi mathvariant="normal">min</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:mfenced><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41598_2022_27057_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par15">The differentiable BTR finds the optimal tip shape <inline-formula id="IEq82"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(u,v\right)$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq82.gif"/></alternatives></inline-formula> by minimizing the mean square error over tip shape through its gradient. Because max and min functions appeared in dilation and erosion seem to be non-differentiable at first glance, we treat this problem following the implementations of Max Pooling layer in convolutional neural networks (CNNs). For example, consider a one-dimensional tip shape <inline-formula id="IEq83"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u}$$\end{document}</tex-math><mml:math id="M176"><mml:msub><mml:mi>p</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq83.gif"/></alternatives></inline-formula> with <italic>u</italic> discretized by the index of pixels. The gradient of <inline-formula id="IEq84"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h=\mathrm{max}\left[{p}_{1},{p}_{2},{p}_{3}\right]$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mfenced close="]" open="["><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq84.gif"/></alternatives></inline-formula> is, if <inline-formula id="IEq85"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{3}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq85.gif"/></alternatives></inline-formula> is the maximum, <inline-formula id="IEq86"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial h/\partial {p}_{1}=0$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi>∂</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>∂</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq86.gif"/></alternatives></inline-formula>, <inline-formula id="IEq87"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial h/\partial {p}_{2}=0$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mi>∂</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>∂</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq87.gif"/></alternatives></inline-formula>, <inline-formula id="IEq88"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial h/\partial {p}_{3}=1$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:mi>∂</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>∂</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq88.gif"/></alternatives></inline-formula>, which is equivalent to argmax function. In image processing, some studies try to apply morphology operators to image processing by using argmax and argmin functions for differentiations<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. In this study, we also use argmax and argmin functions for the differentiations of max and min functions, respectively.</p>
    <p id="Par16">Unfortunately, minimizing the above loss function is an ill-posed problem<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. Other than the correct tip shape, for example, a very thin tip like the δ-function can make the value of the loss function almost zero (resulting in an overfit to noise for noisy AFM images). Therefore, regularization is introduced to find the upper bound on tip shape without an overfit while keeping the loss function small. In this study, we add the L2 norm of tip shape <italic>P</italic> as a regularization term. Finally, the loss function used in the differentiable BTR becomes<disp-formula id="Equf"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}\left(p\right)+\lambda {\Vert p\Vert }^{2}=\frac{1}{N}\sum_{x,y}{\left({i}^{\left(r\right)}\left(x,y\right)-i\left(x,y\right)\right)}^{2}+\lambda \sum_{u,v}{p}^{2}(u,v)$$\end{document}</tex-math><mml:math id="M188" display="block"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="41598_2022_27057_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par17">The purpose of introducing the regularization term is to find a blunt tip because unreasonably thin tips may be ascribed to the overfitting to noise. We minimize the sum of <inline-formula id="IEq89"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq89.gif"/></alternatives></inline-formula> and the regularization term (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e). By applying the regularization term, a blunter tip shape is expected to be obtained because thin tips have large <inline-formula id="IEq90"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Vert p\Vert }^{2}$$\end{document}</tex-math><mml:math id="M192"><mml:msup><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq90.gif"/></alternatives></inline-formula> values. Here, the L2 norm was chosen for the availability of optimizers. To find an appropriate value of <inline-formula id="IEq91"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M194"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq91.gif"/></alternatives></inline-formula>, it is typical to start with <inline-formula id="IEq92"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda =0$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq92.gif"/></alternatives></inline-formula> or very small <inline-formula id="IEq93"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M198"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq93.gif"/></alternatives></inline-formula>, then gradually increase <inline-formula id="IEq94"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M200"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq94.gif"/></alternatives></inline-formula> to find a blunt tip keeping <inline-formula id="IEq95"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}\left(p\right)$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq95.gif"/></alternatives></inline-formula> small. To systematically find an appropriate <inline-formula id="IEq96"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M204"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq96.gif"/></alternatives></inline-formula> value, this study propose to use the so-called <italic>the one standard error rule</italic><sup><xref ref-type="bibr" rid="CR37">37</xref></sup> (discussed below).</p>
    <p id="Par18">Moreover, we used a square pillar (<inline-formula id="IEq97"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(u,v\right)=0$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq97.gif"/></alternatives></inline-formula> for all <inline-formula id="IEq98"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(u,v\right)$$\end{document}</tex-math><mml:math id="M208"><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq98.gif"/></alternatives></inline-formula> over the defined area for representing the tip) as an initial condition for the tip reconstruction, which is the same strategy as the original BTR. This choice of initial condition contributes to finding a blunt tip or the upper bound on tip shape. The optimization algorithm was implemented in a neural network/machine learning framework (the Flux.jl package<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> in Julia programming language). Specifically, we implemented the dilation and the erosion as differentiable parts of neural network layers and optimized the tip shape in the same way in the training of neural networks (see “<xref rid="Sec8" ref-type="sec">Methods</xref>” for details).</p>
    <sec id="Sec3">
      <title>Twin experiment: noise-free AFM images</title>
      <p id="Par19">By performing twin experiments, we compared the accuracies of two blind tip reconstruction algorithms, the original and end-to-end differentiable BTRs (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). In the experiments, 20 frames of artificial pseudo-AFM images were generated from the structure of myosin V motor domain (PDB ID: 1OE9<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>) using a typical tip shape (a hemisphere combined with a circular frustum of a cone<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, which serves as the ground truth tip). The reconstructed tip shape and molecular surface were compared to those of the ground truth (see Methods for details). For each pseudo-AFM image, the structure was randomly oriented. To investigate the relationship between the parameters (<italic>thresh</italic> and λ) of the algorithms and the identity <inline-formula id="IEq99"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\circ P=I$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:mi>I</mml:mi><mml:mo>∘</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq99.gif"/></alternatives></inline-formula>, we applied wide range of parameter values and monitored the mean square error <inline-formula id="IEq100"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq100.gif"/></alternatives></inline-formula> and reconstructed tip shapes.<fig id="Fig2"><label>Figure 2</label><caption><p>Schematic of twin experiments. From the structural model, the images of molecular surfaces are generated. Then, the molecular surfaces are converted to pseudo atomic force microscopy (AFM) images by dilation with a given tip shape. These molecular surfaces and tip shape are used as ground truths in the experiments. The 3D molecular structure is drawn with PyMOL<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>.</p></caption><graphic xlink:href="41598_2022_27057_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par20">Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the results of BTRs from noise-free AFM images. Note that some of the pixels around the sample molecule in the image are cropped and enlarged for visual clarity. The full-size images are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>. Under the noise-free condition, the original BTR can perfectly reconstruct the ground truth tip with <inline-formula id="IEq101"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$thresh\ll 1$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq101.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d, left). <inline-formula id="IEq102"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq102.gif"/></alternatives></inline-formula> increases as <inline-formula id="IEq103"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$thresh$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:mi mathvariant="italic">thresh</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq103.gif"/></alternatives></inline-formula> increases (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b), correlated with the thickness of the reconstructed tip shape (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d, right). The rate of the increase is slow for a range of small <inline-formula id="IEq104"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$thresh$$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:mi mathvariant="italic">thresh</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq104.gif"/></alternatives></inline-formula>, but is gradually accelerated later. The same is true for the differentiable BTR. The differentiable BTR also works perfectly to reconstruct the true tip shape with <inline-formula id="IEq105"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda \ll 1$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq105.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e, left). <inline-formula id="IEq106"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq106.gif"/></alternatives></inline-formula> increases as λ increases (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c), reconstructing thicker tips (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e, right). Notably, the slope of <inline-formula id="IEq107"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq107.gif"/></alternatives></inline-formula> with respect to λ increases suddenly.<fig id="Fig3"><label>Figure 3</label><caption><p>Results of twin experiment in noise-free condition. (<bold>a</bold>) 1st frame of 20 images used for the twin experiment. (<bold>b</bold>, <bold>c</bold>) Mean square errors at various parameter values. (<bold>d</bold>, <bold>e</bold>) Cross sections of reconstructed tip shapes along the <italic>x</italic>-axis with the original and differentiable blind tip reconstructions (indicated by dashed blue lines and dashed green lines, respectively), compared with the ground truth (red line). (<bold>f</bold>, <bold>g</bold>) Root mean square deviations (RMSDs) of the reconstructed tips from the ground truth (with the same coloring scheme). (<bold>h</bold>) Reconstructed molecular surfaces by the deconvolutions with the reconstructed tips. (<bold>i</bold>) RMSDs of the deconvoluted molecular surfaces of all 20 frames from the ground truth visualized by violin plots.</p></caption><graphic xlink:href="41598_2022_27057_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par21">Figure <xref rid="Fig3" ref-type="fig">3</xref>h shows the molecular surfaces reconstructed by deconvolving the 1st frame of the pseudo-AFM images (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a) of the data set with the reconstructed tips. Here, the deconvolution was performed by using the erosion. The results show the shape outlines of myosin V motor domain recovered by using both BTRs. Although the reconstructed molecular surfaces <inline-formula id="IEq108"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}^{\left(r\right)}$$\end{document}</tex-math><mml:math id="M228"><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq108.gif"/></alternatives></inline-formula> by the erosion have a property of <inline-formula id="IEq109"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}^{\left(r\right)}\supseteq S$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mo>⊇</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq109.gif"/></alternatives></inline-formula>, making the reconstructed surface thicker than the ground truth, the reconstructed molecular surfaces look qualitatively similar to that of myosin V motor domain for both BTRs. The accuracies of the reconstructed molecular surfaces are quantitatively evaluated by root mean square deviations (RMSDs) from the ground truth surfaces (Fig. <xref rid="Fig3" ref-type="fig">3</xref>i). In the calculation, deconvolutions were performed for all 20 frames of the images and compared with the ground truth. The RMSDs show that both BTRs have good accuracies for reconstructing molecular surfaces from noise-free AFM images.</p>
    </sec>
    <sec id="Sec4">
      <title>Twin experiment: noisy AFM images</title>
      <p id="Par22">We then compared the robustness of the two BTRs against noise by adding spatially independent Gaussian noise with a standard deviation of <inline-formula id="IEq110"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =0.3$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq110.gif"/></alternatives></inline-formula> nm to the 20 frames of pseudo-AFM images used in the previous noise-free condition. Here, <inline-formula id="IEq111"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =0.3$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq111.gif"/></alternatives></inline-formula> nm is a typical noise size in the current HS-AFM measurements<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. 100 sets of noisy pseudo-AFM data (each containing 20 frames) were created using 100 different noise realizations. Again, to investigate the relationship between the parameters (<italic>thresh</italic> and λ) and the identity <inline-formula id="IEq112"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\circ P=I$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:mi>I</mml:mi><mml:mo>∘</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq112.gif"/></alternatives></inline-formula>, we applied parameter values in a wide range and monitored <inline-formula id="IEq113"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq113.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b,c). The mean and standard deviation of <inline-formula id="IEq114"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq114.gif"/></alternatives></inline-formula> was calculated only from the single set of 20-frame images by using the cross validation (see “<xref rid="Sec8" ref-type="sec">Methods</xref>” for details). The accuracies of reconstructed tip shapes and surfaces were evaluated by 100 sets of different noise realizations.<fig id="Fig4"><label>Figure 4﻿</label><caption><p>Results of twin experiment in noisy condition. (<bold>a</bold>) 1st frame of 20 images used for the twin experiment. (<bold>b</bold>, <bold>c</bold>) Mean square errors (MSEs) optimized at various parameter values. The mean and standard deviation of MSE was calculated only from the single set of 20-frame images using the cross validation. Shaded area indicates the one standard error bound. (<bold>d</bold>, <bold>e</bold>) Cross sections of reconstructed tip shapes along the <italic>x</italic>-axis with the original and differentiable blind tip reconstructions (indicated by dashed blue lines and dashed green lines, respectively), compared with the ground truth (red line). Shaded area represents the standard deviation. The tip shapes used for deconvolution are indicated by the black lines. (<bold>f</bold>, <bold>g</bold>) Root mean square deviations (RMSDs) of the reconstructed tips from the ground truth visualized by violin plots (with the same coloring scheme). (<bold>h</bold>) Reconstructed molecular surfaces by the deconvolutions with the reconstructed tips. (<bold>i</bold>) RMSDs of the deconvoluted molecular surfaces of all frames (20 images) from the ground truths visualized by violin plots.</p></caption><graphic xlink:href="41598_2022_27057_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par23">In both BTRs, <inline-formula id="IEq115"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq115.gif"/></alternatives></inline-formula> sharply increases. When the tip shapes are plotted for the original BTR, reconstructed tip shapes seem to depend not only on parameters but also on noise realization (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). Indeed, even with the same <italic>thresh</italic> parameter 4.0 nm, the original BTR reconstructed the tip shape thinner or thicker than the ground truth, depending on the realization of the noise (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d, right). The tip shape tends to be thin for <inline-formula id="IEq116"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$thresh\ll 1$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq116.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d, left). This means that the original BTR algorithm overfitted the tip shape to the noise in the pseudo-AFM images. The RMSD from the ground truth tip shows that <italic>thresh</italic>
<inline-formula id="IEq117"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx$$\end{document}</tex-math><mml:math id="M246"><mml:mo>≈</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq117.gif"/></alternatives></inline-formula> 4.0 nm is the best parameter value for accurate tip reconstruction (Fig. <xref rid="Fig4" ref-type="fig">4</xref>f). Parameter tuning of <italic>thresh</italic> has been discussed in previous studies. Villarrubia proposed, from the analysis of a single-frame pseudo-AFM image, to use 2–4 <inline-formula id="IEq118"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M248"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq118.gif"/></alternatives></inline-formula> for thresh<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Although Villarrubia analyzed only a single-frame image, this value may depend on the number of frames used because the chance for noise level exceeding <italic>thresh</italic> changes by the number of samples. In this sense, <italic>thresh</italic> = 4.0 nm would be reasonable for the current 20-frame AFM images. Dongmo et al.<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> proposed to monitor the change of tip volume by changing <italic>thresh</italic> parameter from low to high values. They discussed that the parameter where tip volume change becomes large would be regarded as the optimal one<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. In the current context, that parameter value might correspond to the value where the mean square error <inline-formula id="IEq119"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}\left(p\right)$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq119.gif"/></alternatives></inline-formula> starts to increase sharply (<italic>thresh</italic>
<inline-formula id="IEq120"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx$$\end{document}</tex-math><mml:math id="M252"><mml:mo>≈</mml:mo></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq120.gif"/></alternatives></inline-formula> 4.0 nm in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b).</p>
      <p id="Par24">On the other hand, the reconstructed tip shapes by the differentiable BTR show less dependence than the original BTR, and similar tip shapes (close to the ground truth) are reconstructed more stably for most noise realizations (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e). Some tip shapes look distorted in the reconstructed tips of <inline-formula id="IEq121"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda ={10}^{-3}$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq121.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e, right), partially due to the boundary conditions of the tip image. Interestingly, while the tip shape became thicker as λ increases due to the regularization penalty (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e, right), the reconstructed tip shape did not fall into thin tip shapes even when the <inline-formula id="IEq122"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M256"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq122.gif"/></alternatives></inline-formula> becomes small (<inline-formula id="IEq123"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda \ll 1$$\end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq123.gif"/></alternatives></inline-formula>, Fig. <xref rid="Fig4" ref-type="fig">4</xref>e, left). This robustness in the differentiable BTR enables novice users to reproduce accurate reconstructions using a parameter value from a wide range. The average RMSD of the reconstructed tips from the ground truth is 2.0 nm for the original BTR with <italic>thresh</italic> = 4.0 nm, and 0.4 nm for the differentiable BTR with <inline-formula id="IEq124"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda ={10}^{-7}$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq124.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig4" ref-type="fig">4</xref>f,g).</p>
      <p id="Par25">Figure <xref rid="Fig4" ref-type="fig">4</xref>h shows the molecular surfaces obtained by deconvolving the 1st frame of the pseudo-AFM images (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a) using ones of the reconstructed tips. In Fig. <xref rid="Fig4" ref-type="fig">4</xref>h, the reconstructed molecular surface by the original BTR looks somewhat blurred because the erosion “carves” the shape edges in the image profile by the reconstructed tip shape with a larger half angle (the black line in Fig. <xref rid="Fig4" ref-type="fig">4</xref>d) than the ground truth. On the other hand, the differentiable BTR successfully deconvolved the shape outlines of myosin V motor domain. The accuracies of the reconstructed surfaces were quantitatively evaluated by RMSDs from the ground truth (Fig. <xref rid="Fig4" ref-type="fig">4</xref>i). The surface reconstructions by the differentiable BTR outperform the original BTR in this noisy condition. The average RMSD of the reconstructed molecular surfaces from the ground truth is 2.1 nm for the original BTR with <italic>thresh</italic> = 4.0 nm, and 1.1 nm for the differentiable BTR with <inline-formula id="IEq125"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda ={10}^{-4}$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq125.gif"/></alternatives></inline-formula>.</p>
      <p id="Par26">Thus far, we have not found the lower limit of <inline-formula id="IEq126"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M264"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq126.gif"/></alternatives></inline-formula> even in the above noisy AFM images, suggesting the noise level was small enough for the current loss function to avoid the overfit. To explore the lower limit of <inline-formula id="IEq127"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M266"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq127.gif"/></alternatives></inline-formula>, we intentionally increased the noise level and conducted another twin experiment. In this twin experiment, we have applied a large noise level with a standard deviation of <inline-formula id="IEq128"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =1.2$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq128.gif"/></alternatives></inline-formula> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). From the results, we found the estimation accuracy becomes worse for small values of <inline-formula id="IEq129"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M270"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq129.gif"/></alternatives></inline-formula>, suggesting that the tips with lower values of <inline-formula id="IEq130"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M272"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq130.gif"/></alternatives></inline-formula> tend to be overfitted to the noise.</p>
      <p id="Par27">For selecting an appropriate value of <inline-formula id="IEq131"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M274"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq131.gif"/></alternatives></inline-formula> in this situation, we here propose to use the so-called <italic>the one standard error rule</italic><sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. In this rule, we first perform the cross validation and calculate the mean and standard deviation of <inline-formula id="IEq132"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq132.gif"/></alternatives></inline-formula>. Then, we find the <inline-formula id="IEq133"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M278"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq133.gif"/></alternatives></inline-formula> value with the minimum <inline-formula id="IEq134"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq134.gif"/></alternatives></inline-formula>, and select the largest <inline-formula id="IEq135"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M282"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq135.gif"/></alternatives></inline-formula> whose mean falls within or around the one standard deviation of the minimum. The idea behind this rule is to choose the bluntest tip shape from a set of tip shapes appearing to be more or less equally good in terms of <inline-formula id="IEq136"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq136.gif"/></alternatives></inline-formula>. In the case of this twin experiment, we found that <inline-formula id="IEq137"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda ={10}^{-3}$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq137.gif"/></alternatives></inline-formula>, slightly above the one standard error bound, yields the most accurate tip reconstruction (indicated by the red arrow in Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>c).</p>
    </sec>
    <sec id="Sec5">
      <title>Twin experiment: double-tip effect</title>
      <p id="Par28">The double-tip effect is one of the most frequent artifacts in AFM measurements, which occurs when the tip is damaged or contaminated during the measurement<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. Since AFM images measured by damaged or contaminated tips are often discarded without further analysis, it would be helpful if the double-shaped tip could be reconstructed only from AFM images and the doubled images were deconvolved to obtain true molecular surfaces. In this twin experiment, we mimicked the double tip effect with a double-peaked tip shape created by aligning the single tips used in the previous twin experiments along the <italic>x</italic>-axis. As in the previous twin experiment, we added spatially independent Gaussian noise with a standard deviation of <inline-formula id="IEq138"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =0.3$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq138.gif"/></alternatives></inline-formula> nm to the pseudo-AFM images emulated by the double tips (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Again, to investigate the relationship between the parameters (<italic>thresh</italic> and λ) and the identity <inline-formula id="IEq139"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\circ P=I$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:mi>I</mml:mi><mml:mo>∘</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq139.gif"/></alternatives></inline-formula>, we applied parameter values in a wide range and monitored <inline-formula id="IEq140"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq140.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b,c). The mean and standard deviation of <inline-formula id="IEq141"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq141.gif"/></alternatives></inline-formula> was calculated only from the single set of 20-frame images by using the cross validation (see “<xref rid="Sec8" ref-type="sec">Methods</xref>” for details). The accuracies of reconstructed tip shapes and surfaces were evaluated by 100 sets of different noise realizations.<fig id="Fig5"><label>﻿Figure 5</label><caption><p>Results of twin experiment in a double-tip case. (<bold>a</bold>) 1st frame of 20 images used for the twin experiment. (<bold>b</bold>, <bold>c</bold>) Mean square errors at various parameter values. The mean and standard deviation of MSE was calculated only from the single set of 20-frame images using the cross validation. Shaded area indicates the one standard error bound. (<bold>d</bold>, <bold>e</bold>) Cross sections of reconstructed tip shapes along the <italic>x</italic>-axis with the original and differentiable blind tip reconstructions (indicated by dashed blue lines and dashed green lines, respectively), compared with the ground truth (red line). The tip shapes used for deconvolution are indicated by the black lines. (<bold>f–g</bold>) Root mean square deviations (RMSDs) of the reconstructed tips from the ground truth visualized by violin plots (with the same coloring scheme). (<bold>h</bold>) Reconstructed molecular surfaces by the deconvolutions with the reconstructed tips. (<bold>i</bold>) RMSDs of the deconvoluted molecular surfaces of all frames (20 images) from the ground truths visualized by violin plots.</p></caption><graphic xlink:href="41598_2022_27057_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par29">Figure <xref rid="Fig5" ref-type="fig">5</xref>d shows tip shapes reconstructed with the original BTR. The original BTR failed to detect double tips, and the reconstruction resulted in single-peak tips for most parameter values. On the other hand, the differentiable BTR successfully detected double tips, and their shapes are roughly consistent with the ground truth over a wide parameter range (Fig. <xref rid="Fig5" ref-type="fig">5</xref>e). Again, translational shifts in some of the reconstructed tips are observed due to the boundary effect of the tip image. The result does not mean that the original BTR algorithm inherently cannot detect double tips. Indeed, under noise-free condition, the original BTR is able to reconstruct the double-tip shape with high accuracy. In the original BTR algorithm, the tip apex is set to be at the origin of the <italic>uv</italic>-coordinates, and the apex should be fixed at the origin during the reconstruction without any modifications. In noisy conditions, while one of two tip apexes is fixed at the origin, the other tip apex is irreversibly “carved” by chance due to noise, making it difficult to detect double tips. On the other hand, since the algorithm of the differentiable BTR can reconstruct the tip without imposing any constraints on the tip apex, it can stably detect double tips. In the differentiable BTR, the origin of the <italic>uv</italic>-coordinates is set to the center of mass of the tip (see “<xref rid="Sec8" ref-type="sec">Methods</xref>” for details). The average RMSD of the reconstructed tips from the ground truth is 2.9 nm for the original BTR with <italic>thresh</italic> = 4.0 nm, and 0.5 nm for the differentiable BTR with <inline-formula id="IEq142"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda ={10}^{-5}$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq142.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig5" ref-type="fig">5</xref>f,g).</p>
      <p id="Par30">Figure <xref rid="Fig5" ref-type="fig">5</xref>h shows the molecular surfaces obtained by deconvolving the 1st frame of the pseudo-AFM images (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a) using one of the reconstructed tips (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d,e). With a single tip reconstructed by the original BTR, the molecular surface looks blurred because the erosion “carves” the shape edges in the image profile by the reconstructed tip shape with a larger half angle (the black line in Fig. <xref rid="Fig5" ref-type="fig">5</xref>d) than the ground truth double-tip. Note also that the maximum height of the reconstructed surface decreases because the reconstructed tip with a large half angle can erode smaller edges, including the top edge of the image profile. On the other hand, double tips reconstructed with the differentiable BTR can remove the doubled molecular shapes and reconstruct a molecular surface much closer to the ground truth. The accuracies of the reconstructed surfaces were quantitatively evaluated by RMSDs from the ground truth ones (Fig. <xref rid="Fig5" ref-type="fig">5</xref>i). The average RMSD of the reconstructed molecular surfaces from the ground truth is 2.0 nm for the original BTR with <italic>thresh</italic> = 4.0 nm, and 0.9 nm for the differentiable BTR with <inline-formula id="IEq143"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda ={10}^{-4}$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq143.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec6">
      <title>Real experimental data: Myosin V walking along actin filament</title>
      <p id="Par31">Finally, we compared the two BTR algorithms by analyzing real AFM data. We analyzed the HS-AFM data of myosin V measured by Kodera et al.<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Myosin V is a homo-dimeric molecular motor that moves linearly along the actin filament driven by ATP hydrolysis free energy. Myosin V serves to transport cargos attached to the center of the dimer. The HS-AFM movies by Kodera et al. successfully capture the events that myosin V walks on the actin filament coupled with its ATP-dependent conformational change. It is important to deconvolve the AFM images to obtain the detailed shape of the Myosin V’s molecular surface during the walking step. Here, we analyzed 30 frames of a HS-AFM movie that capture a single walking step of Myosin V.</p>
      <p id="Par32">As illustrated in Fig. <xref rid="Fig6" ref-type="fig">6</xref>a, the HS-AFM images contain numerous horizontal scars emanating from the molecules to the right direction along the <italic>x</italic>-axis, which corresponds to the scanning direction of the tip. These scars are often called the parachuting artifact<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. The “parachuting” means that, when the tip scan velocity is high and the target molecular height suddenly decreases along the tip scanning line, the tip can completely detach from the molecular surface. It takes some time for the tip to land on the stage or the sample surface at a different point, creating scars in the direction of scanning<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. The appearance of scars is stochastic because the parachuting caused by thermal fluctuations of the sample molecule that lift the tip from the stage. On the other hand, after a parachuting happened, the decreasing pattern of the scar’s height is deterministic and could be modeled as a part of dilation. Thus, we here recognize the decreasing pattern of the scars as part of the signal and try to reflect them in the effective tip shape.<fig id="Fig6"><label>﻿Figure 6</label><caption><p>Blind tip reconstruction (BTR) from the high-speed atomic force microscopy (HS-AFM) data of myosin V walking. (<bold>a</bold>) 27th frame of 30 images used for the analysis. (<bold>b</bold>, <bold>c</bold>) Mean square errors at various parameter values. The mean and standard deviation of MSE was calculated using the cross validation. Shaded area indicates the one standard error bound. The red arrow indicates the selected <inline-formula id="IEq151"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M300"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq151.gif"/></alternatives></inline-formula> for deconvolution. (<bold>d</bold>, <bold>e</bold>) Cross sections of reconstructed tip shapes along the <italic>x</italic>-axis with the original and differentiable BTR. (<bold>f</bold>) Representative structure of 10 structures taken from previous flexible fitting molecular dynamics simulations. (<bold>g</bold>) Maximum correlation coefficients between the 27th HS-AFM image and pseudo-AFM images generated from each of 10 structures. (<bold>h</bold>) Reconstructed molecular surfaces created by deconvolutions with the BTR tips compared with the molecular surfaces of structured models with the maximum correlation coefficients. The white dashed lines indicate the cross sections used in (<bold>j</bold>) and (<bold>k</bold>). (<bold>j</bold>, <bold>k</bold>) Cross sections of the molecular surfaces along the <italic>y</italic>-axis. Red lines are the image profiles, blue lines are the reconstructed molecular surfaces, and gray lines are the molecular surfaces created from the structural models.</p></caption><graphic xlink:href="41598_2022_27057_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par33">Figure <xref rid="Fig6" ref-type="fig">6</xref>b and c show the means and standard deviations of <inline-formula id="IEq144"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq144.gif"/></alternatives></inline-formula> calculated from the 30-frame HS-AFM images by using the cross validation at various <italic>thresh</italic> and λ parameters with the original and differentiable BTRs, respectively. Figure <xref rid="Fig6" ref-type="fig">6</xref>d and e show the <italic>x</italic>- and <italic>y</italic>-axes cross sections of the tip shapes reconstructed from the real HS-AFM images by both BTRs. The tip shapes reconstructed with the original BTR tend to be thicker along the <italic>x</italic>-axis (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d, left) while very thin along the <italic>y</italic>-axis (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d, right). This is largely due to the scars of the parachuting artifact. After the parachuting occur in a stochastic manner, the decreasing pattern of the scar’s height would be modeled as a part of dilation along the <italic>x</italic>-axis. However, along the <italic>y</italic>-axis, whether the parachuting appears or not are quite stochastic: The parachuting appears only when the fluctuating molecular surface happens to be high (large <italic>z</italic>-coordinates). Therefore, along the <italic>y</italic>-axis, dents caused by the differences between parachuting and non-parachuting lines should be recognized as stochastic noise. The original BTR misinterpreted that the large dents along the <italic>y</italic>-axis can be ascribed to the tip shape and excessively “carved” the tip shape. While the tip shapes reconstructed by the differentiable BTR well capture a smooth attenuation by parachuting on the right side of the <italic>x</italic>-axis (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e, left), those along the <italic>y</italic>-axis do not become thin as in the original BTR but maintain a certain degree of thickness with less parameter dependence (except for a very small weight, <inline-formula id="IEq145"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda =0.0010$$\end{document}</tex-math><mml:math id="M304"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0010</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq145.gif"/></alternatives></inline-formula>, Fig. <xref rid="Fig6" ref-type="fig">6</xref>e, right).</p>
      <p id="Par34">Figure <xref rid="Fig6" ref-type="fig">6</xref>h and i show the molecular surfaces of the 27th frame of the HS-AFM movie deconvolved with the reconstructed tip shapes by the original and differentiable BTRs, respectively. The 27th frame was chosen because flexible fitting molecular dynamics simulations were performed for this frame in our previous study<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. Following the result of the twin experiment with a large noise level (<inline-formula id="IEq146"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =1.2$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq146.gif"/></alternatives></inline-formula> nm), we here used the one standard error rule for selecting a <inline-formula id="IEq147"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M308"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq147.gif"/></alternatives></inline-formula> value of the differentiable BTR. Specifically, we selected λ = 0.0051, which is slightly above the one standard error bound (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c), for the deconvolution. For the original BTR, we used the tip of <italic>thresh</italic> = 1.95 nm because the tip apex radius of this parameter value is comparable to (or slightly larger than) that of the differentiable BTR with the chosen λ = 0.0051 (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>d,e) along the <italic>x</italic>-axis. In the molecular surface deconvolved by the tip of the original BTR (Fig. <xref rid="Fig6" ref-type="fig">6</xref>h), the legs of Myosin V are thinner than in the image profile, but there are still horizontal scars due to the parachuting artifact. On the other hand, the molecular surface deconvolved by the tip shape of the differentiable BTR has fewer parachuting lines (Fig. <xref rid="Fig6" ref-type="fig">6</xref>i). This is because the differentiable BTR has a thicker tip shape along the <italic>y</italic>-axis direction, which contributes to more extensive “carvings” by the erosion of the image profiles along the <italic>y</italic>-axis. The same trend can be seen in all the frames (Supplemental Movie <xref rid="MOESM2" ref-type="media">1</xref>).</p>
      <p id="Par35">Are the molecular surfaces obtained by the deconvolutions accurate? To verify this, we compared these surfaces with structural models. Here we used 10 structures taken from our previous flexible fitting molecular dynamics simulation study of the 27th frame of the same data<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. In the study, the structures of myosin V and actin filament were modeled using the crystal structure by homology modeling, and then coarse-grained molecular dynamics simulations were performed, imposing restraints on the structure fitted to the 27th frame of the experimental HS-AFM movie. Since the tip shape used in the flexible fitting is not the same as the current study, we selected 10 plausible structures as templates to make a comparison with the deconvoluted surfaces (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). Each structure was exhaustively translated and rotated to create pseudo-AFM images, and the correlation coefficients of those images with the target frame of the HS-AFM data were calculated. We recorded the maximum correlation coefficients and corresponding poses (translation and rotation) for the 10 structures. Figure <xref rid="Fig6" ref-type="fig">6</xref>g compares the maximum correlation coefficients of the 10 structures for both BTRs. Although the improvement in the coefficients by the differentiable BTR is marginal, the distributions of both BTRs are non-overlapping with each other implying that the improvement is statistically meaningful. This further means that the tip shape is consistent with structural models and the HS-AFM data. Figure <xref rid="Fig6" ref-type="fig">6</xref>j and k show the cross sections of the deconvoluted molecular surfaces and the surfaces obtained by the structural models that have the maximum correlation coefficients for two BTRs, respectively. In the figure, actin filament is located at around <italic>y</italic> = 13 nm. The reconstructed tip of the original BTR barely “carves” the image profile with erosion (the red and blue lines are almost same in Fig. <xref rid="Fig6" ref-type="fig">6</xref>j) due to its thin shape along the <italic>y</italic>-axis while the tip of the differentiable BTR “carves” the image profile. In particular, the deconvoluted surface of the differentiable BTR is consistent with the structural model. Here, the height of the molecular surface of a structural model is modeled by modeled by <inline-formula id="IEq148"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\alpha }z+\overline{\beta }$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mover><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mover><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq148.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq149"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\alpha }$$\end{document}</tex-math><mml:math id="M312"><mml:mover><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq149.gif"/></alternatives></inline-formula> and <inline-formula id="IEq150"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\beta }$$\end{document}</tex-math><mml:math id="M314"><mml:mover><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq150.gif"/></alternatives></inline-formula> were determined by the least squares fitting to each deconvoluted surface (see “<xref rid="Sec8" ref-type="sec">Methods</xref>” for details). Again, this result implies the improved accuracy of the reconstructed tip by the differentiable BTR.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Discussion</title>
    <p id="Par36">In this study, we have proposed the end-to-end differentiable BTR method based on a loss function including a regularization term considering noise in AFM image to avoid overfitting. The loss function is systematically optimized following the framework developed by the recent advances in deep learning studies. The results of the twin experiments showed that the differentiable BTR is more robust to noise than the original BTR. Finally, demonstration of real HS-AFM data shows that the differentiable BTR reconstructs tip shapes and the deconvoluted molecular surface is consistent with the structural model. Since the method is a quite general, we expect that the method would become a routine method for analyzing noisy AFM images as well as HS-AFM data.</p>
    <p id="Par37">The twin experiments have shown that reconstructed tip shapes with the differentiable BTR are less dependent on the parameter <inline-formula id="IEq152"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M316"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq152.gif"/></alternatives></inline-formula>. For relatively small noise (<inline-formula id="IEq153"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =0.3$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq153.gif"/></alternatives></inline-formula> nm), any small <inline-formula id="IEq154"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M320"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq154.gif"/></alternatives></inline-formula> values (<inline-formula id="IEq155"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda \ll 1$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq155.gif"/></alternatives></inline-formula>) are expected to reproduce tip shapes close to the ground truth one. For relatively large noise (<inline-formula id="IEq156"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =1.2$$\end{document}</tex-math><mml:math id="M324"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq156.gif"/></alternatives></inline-formula> nm), small <inline-formula id="IEq157"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M326"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq157.gif"/></alternatives></inline-formula> may reconstruct unreasonably thin tip shapes even with the differentiable BTR. In such cases, the one standard error rule is recommended to reconstruct reasonably thick tip shapes. As with the case of neural network frameworks, there are several hyperparameters in the optimization process in the differentiable BTR. For example, if the number of epochs is too large, that increases the chance to overfit to noise, while too small epochs result in insufficient learning. Using techniques such as early stopping, or hyperparameter optimization tools<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, may help to choose appropriate hyperparameters.</p>
    <p id="Par38">As mentioned in Introduction, Tian et al. proposed an improved regularization scheme against noise in the framework of original BTR<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, and Jóźwiak et al. simplified Tian’s idea to the case of standard AFM tips<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. In this scheme, the update procedure of tip shape becomes more conservative, and it is thus expected to be robust against noise, as shown by Jóźwiak et al.<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref> shows the results of the original BTR using this regularization scheme for noisy single-tip and double-tip twin experiments. As expected, the regularization scheme improves the estimation and reconstructs blunter tip shapes compared to the original BTR. However, the RMSDs from the ground truth tip shape and molecular surface show that the differentiable BTR still outperforms the original BTR with the regularization scheme.</p>
    <p id="Par39">Since this study mainly targets the analysis of HS-AFM data, pseudo and real AFM data consisting of 20–30 frames were mainly analyzed. To check the dependence of reconstruction accuracy on the number of frames, we conducted noisy single-tip twin experiments using 1, 10, and 100 pseudo-AFM frames (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>). Although the accuracies of tip and surface reconstructions are comparable in both BTRs for a single frame, the differentiable BTR outperforms the original BTR for 10 and 100 frames. An only drawback of the differentiable BTR here is that the computation time is much longer than the original BTR, especially for the analysis of 100 frames. For example, in our twin experiment (the single-tip case, 20 frames), the original BTR took 0.02 s to estimate the tip shape of a specific <italic>thresh</italic> while the differentiable BTR took 5.7 s for a specific λ with Intel Xeon Gold 6330 CPU (without multi-threads). Implementing GPU kernels for dilation and erosion, or using smooth functions instead of max and min, would accelerate the optimization.</p>
    <p id="Par40">A concern with differentiable BTR is the relationship between ground truth tip shape and erosion. To reconstruct the tip accurately with differentiable BTR, erosion must be a good approximation to the inverse function of dilation. If the ground truth tip has a cone shape, the half angle must be small for the erosion to approximate the inverse function of the dilation well. As the half angle increases and exceeds a threshold value (e.g., 30 degrees), the accuracy of tip reconstruction deteriorates quickly because erosion fails to approximate the inverse function. However, as shown by the numerical study by Sumikama et al.<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, in the tapping mode of HS-AFM, the half angle is expected to become rarely large because the effective tip shape becomes thinner. Also, one possible direction to overcome this problem would be to employ a CNN as a substitute for erosion. If the amount of data is large enough, a CNN is expected to approximate the inverse function of dilation well.</p>
    <p id="Par41">In the analysis of the HS-AFM data of Myosin V, we reconstructed the effective tip shape regarding the scars caused by the parachuting effect as a signal. However, there may be cases where we want to estimate the real physical tip shape after removing the parachuting effect. In this case, it may be possible to divide the dilation into two layers in the differentiable BTR. The first dilation introduces a tip shape that adds lines linearly on the right side of the molecule, and the slope of the lines is parametrized. The second dilation is a standard dilation with a tip shape <inline-formula id="IEq158"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(u,v)$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq158.gif"/></alternatives></inline-formula>. In such a framework, it would be possible to estimate both parameters simultaneously from AFM images. Since dilation is implemented as a part of the neural network layers, it is straightforward to extend the current BTR algorithm in this way. From another perspective, the loss function can be changed according to the types of AFM data. For examples, if AFM data contain large noise as outliers, using the L1 norm instead of the mean squared error (used in this work) for the loss function may work better for tip reconstruction.</p>
    <p id="Par42">Recently, Heath et al. developed localization AFM (LAFM)<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, an elegant image reconstruction technique to overcome resolution limitations in AFM. In this approach, peak positions contacted with the tip apex in AFM image profiles are detected and accumulated to increase the resolution. Although the LAFM currently only uses the peak positions in the localization algorithm, it might be possible to accumulate positions contacted with the side of the tip for the localization algorithm if the tip shape is accurately reconstructed with the differentiable BTR in the future.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Original blind tip reconstruction</title>
      <p id="Par43">The C language source codes provided by Villarrubia<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> were ported to the Julia programming language. Inside the codes, <italic>xy</italic>-coordinates and <italic>uv</italic>-coordinates are discretized by pixel indices (<italic>x</italic>, <italic>y</italic>) and (<italic>u</italic>, <italic>v</italic>), respectively. Starting with a square pillar tip, i.e., <inline-formula id="IEq159"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u,v}=0$$\end{document}</tex-math><mml:math id="M330"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq159.gif"/></alternatives></inline-formula> (for any (<italic>u</italic>, <italic>v</italic>), zero is the maximum height for the inverted tip) as an initial condition, the tip shape was iteratively “carved” according to the dents in neighboring pixels until no “carving” events occur. For the analysis of multiple frames, the algorithm was sequentially applied to frames as proposed by Villarrubia<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>.</p>
    </sec>
    <sec id="Sec10">
      <title>End-to-end differentiable blind tip reconstruction</title>
      <p id="Par44">We implemented the differentiable BTR in Julia programming language. In the following, the <italic>xy</italic>-coordinate and <italic>uv</italic>-coordinate coordinates were discretized and used as pixel indices. The following algorithm was designed to minimize the loss function <inline-formula id="IEq160"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L\left(p\right)=\frac{1}{N}\sum_{x,y}{\left({i}_{x,y}^{\left(r\right)}-{i}_{x,y}\right)}^{2}+\lambda \sum_{u,v}{p}_{u,v}^{2}$$\end{document}</tex-math><mml:math id="M332"><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>i</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq160.gif"/></alternatives></inline-formula> with respect to <inline-formula id="IEq161"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u,v}$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq161.gif"/></alternatives></inline-formula> (where <inline-formula id="IEq162"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M336"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq162.gif"/></alternatives></inline-formula> is the number of pixels):<list list-type="order"><list-item><p id="Par45">Initialize the tip shape to be a square pillar shape, <inline-formula id="IEq163"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u,v}=0$$\end{document}</tex-math><mml:math id="M338"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq163.gif"/></alternatives></inline-formula> (for any <italic>u</italic> and <italic>v</italic>). Here, zero is the maximum height for the inverted tip.</p></list-item><list-item><p id="Par46">Calculate the gradient of the loss function <inline-formula id="IEq164"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L\left(p\right)$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq164.gif"/></alternatives></inline-formula> for the entire frames. Here, only the gradient of the mean square error is needed because the regularization term is implicitly imposed by AdamW<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> optimizer.</p></list-item><list-item><p id="Par47">Update <inline-formula id="IEq165"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u,v}$$\end{document}</tex-math><mml:math id="M342"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq165.gif"/></alternatives></inline-formula> according to the computed gradient using AdamW optimizer imposing a regularization term <inline-formula id="IEq166"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda \sum_{u,v}{p}_{u,v}^{2}$$\end{document}</tex-math><mml:math id="M344"><mml:mrow><mml:mi>λ</mml:mi><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq166.gif"/></alternatives></inline-formula>. Learning rate of 0.1 nm, exponential decay for the first <inline-formula id="IEq167"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{1}$$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq167.gif"/></alternatives></inline-formula> of 0.9 and the second <inline-formula id="IEq168"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{2}$$\end{document}</tex-math><mml:math id="M348"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq168.gif"/></alternatives></inline-formula> of 0.999 were used.</p></list-item><list-item><p id="Par48">Trim <inline-formula id="IEq169"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u,v}$$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq169.gif"/></alternatives></inline-formula> values greater than zero. Positive <inline-formula id="IEq170"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u,v}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq170.gif"/></alternatives></inline-formula>’s are changed to zero, <inline-formula id="IEq171"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u,v}=0$$\end{document}</tex-math><mml:math id="M354"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq171.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par49">Using the height of <inline-formula id="IEq172"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u,v}$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq172.gif"/></alternatives></inline-formula> relative to the minimum height of <inline-formula id="IEq173"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u,v}$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq173.gif"/></alternatives></inline-formula> as weights, translate <inline-formula id="IEq174"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u,v}$$\end{document}</tex-math><mml:math id="M360"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq174.gif"/></alternatives></inline-formula> so that its center of weight is located at the origin of the <italic>uv</italic>-coordinate. For the unknown <inline-formula id="IEq175"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u,v}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq175.gif"/></alternatives></inline-formula> near the boundary (edge) created due to the translation, the minimum value of <inline-formula id="IEq176"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{u,v}$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq176.gif"/></alternatives></inline-formula> was assigned.</p></list-item><list-item><p id="Par50">Repeat step 2 to step 5 using a batch size of 1 image until 100–2000 epochs.</p></list-item></list></p>
      <p id="Par51">Dilation and erosion were implemented as layers of the neural network framework (the Flux.jl package<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> in Julia language), and their custom pullbacks were defined using the ChainRulesCore.jl package<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. Differentiation of opening and the backpropagation of the loss function were computed with the automatic differentiation by the package Zygote.jl<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>. The gradient of each dilation and erosion was tested during the development.</p>
    </sec>
    <sec id="Sec11">
      <title>Twin experiments</title>
      <p id="Par52">To evaluate the accuracy of the tip shape reconstruction, we performed twin experiments. We first generated pseudo-AFM images from a structure of myosin V motor domain without bound nucleotide (PDB ID: 1OE9<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>) using a specific tip shape, which serves as a ground-truth tip shape. The light chains were removed from the original crystal structure. Using the pseudo-AFM images, we performed the BTR and compared the tip shape reconstructed from the images with the ground truth tip shape. We set the <italic>z</italic>-axis of the <italic>xy</italic>-plane system to be the direction orthogonal to the stage (i.e., the <italic>xy</italic>-plane is parallel to the stage). Generated pseudo-AFM images consist of 30 × 30 pixels, where the width and height of each pixel are both 1.5 nm. In the simulation, the center of mass of the motor domain was placed at the origin of the <italic>xy</italic>-coordinate. Then the motor domain was randomly rotated in three dimensions. The heights of the van der Waals (vdW) sphere surfaces at the <italic>xy</italic>-coordinates at the pixel centers were calculated for neighboring atoms of each center, and the largest height was taken as the molecular surface. After obtaining the molecular surface at the pixel centers, the tip shape was used to create a pseudo-AFM image by performing dilation. We used the pixel size of 10 × 10 for the single-tip, 14 × 10 for the double-tip, and 17 × 11 for the HS-AFM data of myosin V walking. Finally, spatially independent Gaussian noise with a standard deviation of 0.3 nm was added to each pixel to obtain noisy pseudo-AFM images. The standard deviation of 0.3 nm is a typical noise size for the current HS-AFM<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Then, we performed another experiment by increasing the noise level to a standard deviation of 1.2 nm. For the single tip twin experiment, the tip shape of a hemisphere (with radius <italic>r</italic>) combined with a circular frustum of a cone, its apex radius of 2.5 nm and half angle of 10 degrees were used as the ground truth. For the double-tip twin experiment, two single tips were aligned in the <italic>x</italic>-axis direction. By repeating the above procedure, 20 pseudo-AFM images were simulated for each setup.</p>
      <p id="Par53">At various values of parameters, <italic>thresh</italic> and <inline-formula id="IEq177"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M366"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq177.gif"/></alternatives></inline-formula>, we calculated the mean square errors, <inline-formula id="IEq178"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq178.gif"/></alternatives></inline-formula>. The mean and standard deviation of <inline-formula id="IEq179"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MSE}(p)$$\end{document}</tex-math><mml:math id="M370"><mml:mrow><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq179.gif"/></alternatives></inline-formula> were evaluated from the single set of 20-frame images by using the leave-one-out cross-validation (LOOCV). These quantities were used for applying the one standard error rule for selecting an appropriate <inline-formula id="IEq180"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M372"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq180.gif"/></alternatives></inline-formula>. The accuracies of reconstructed tips and surfaces were evaluated from 100 different noise realization sets of 20-frame images. In the calculation of the root mean square deviation (RMSD) from the ground truth tip shape, <italic>uv</italic>–coordinates where the ground tip <inline-formula id="IEq181"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left(u,v\right)&gt;-7.0$$\end{document}</tex-math><mml:math id="M374"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mo>-</mml:mo><mml:mn>7.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq181.gif"/></alternatives></inline-formula> nm were used. 7.0 nm roughly corresponds to the height of myosin V motor domain. In the calculation of the RMSD from the ground truth molecular surface, <italic>xy</italic>-coordinates where the surface height <inline-formula id="IEq182"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}^{\left(r\right)}\left(x,y\right)&gt;1.0$$\end{document}</tex-math><mml:math id="M376"><mml:mrow><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq182.gif"/></alternatives></inline-formula> were used. 1.0 nm roughly corresponds to <inline-formula id="IEq183"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\sigma$$\end{document}</tex-math><mml:math id="M378"><mml:mrow><mml:mn>3</mml:mn><mml:mi>σ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq183.gif"/></alternatives></inline-formula> (0.9 nm) of noise. Considering translational shifts in the reconstructed tips, we translated the tips exhaustively and recorded the minimum RMSD value for each tip.</p>
    </sec>
    <sec id="Sec12">
      <title>HS-AFM data of myosin V</title>
      <p id="Par54">HS-AFM measurements of myosin V walking along actin filaments were carried out by Kodera et al., and details for the experiments are given in the paper<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. In the measurements, the ATP-driven translocations of Myosin V (M5-HMM) along actin filaments were observed by the HS-AFM. Actin filaments were partially biotinylated and immobilized using streptavidin on biotin-containing lipid bilayers formed on a mica surface (stage). A positively charged lipid was included in the bilayer to facilitate the weak sideways adsorption of M5-HMM onto the bilayer surface. HS-AFM measurements were conducted with the tapping mode. This study used 30 frames of HS-AFM data sets, which well captured single-step walks of M5-HMM. Each image consists of 80 × 40 pixels, and the resolution of each pixel is 1.875 nm × 1.875 nm. We used these 30 frames to perform original and differentiable BTRs over various parameters. The tilt of the stage in the HS-AFM data was corrected by fitting a <italic>xy</italic>-plane to the data.</p>
    </sec>
    <sec id="Sec13">
      <title>Analysis of HS-AFM data</title>
      <p id="Par55">Structural modeling and flexible fitting molecular dynamics simulations of Myosin V and actin filament were performed in the same way as in the previous study by Fuchigami and Takada<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. First, we generated all-atom models of a tail-truncated myosin V (each of two heads is in the lever-arm down and up conformations) and an actin 31-mer filament using MODELLER version 9.25<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. Then, we constructed coarse-grained models of the actin-myosin complex in the down-down state using CafeMol version 3.2.0<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>. We performed ten flexible fitting simulations of the actin-myosin complex in the down-down state using structure-based AICG2 + potential<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>, AFM stage potential, and AFM image-based bias potential<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>. See the reference<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> for more details.</p>
      <p id="Par56">Using ten structures with the highest cosine similarity in each of the ten flexible fitting simulations, we performed the rigid-body fitting of 3D structures to 2D HS-AFM images of Myosin V. For each structural model, we exhaustively rotated the structure around the rotation axis (roll axis) of the helix of actin filament by 3 degrees (within the range of 60 degrees), combined with the rotation around the yaw axis of the filament by 3 degrees (within the range from − 30 to 30 degrees starting from the actin filament parallel to the <italic>x</italic>-axis). For all the combinations of two angles, we created pseudo-AFM images from the structure. The pseudo-AFM images were created in the same way as in the twin experiment. For the radii of coarse-grained Cα beads, we used the effective radius of amino acid residues used in CryoEM data analysis<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>. The coiled coil domain of myosin V were ignored in the generation of the pseudo-AFM images because this domain was not clearly observed in the HS-AFM. Since the height scale in the real HS-AFM data roughly corresponds to half of the structural model, we doubled the height of the tips reconstructed from the real HS-AFM images. Using it, we then applied the dilation to the structure-model molecular surface. The pseudo-AFM images from the structure model were translated over possible locations on the real HS-AFM image (note that the pseudo-AFM image is smaller than the HS-AFM images because it contains only a single myosin V and a fragment of actin filament), and we computed the correlation coefficient between the overlapped regions of two images. We recorded the maximum correlation coefficient between the pseudo-AFM image and the real AFM image and its corresponding pose (translation and rotation). The structure, of which pseudo-AFM image has the maximum correlation coefficient, was compared with the molecular surface obtained by the deconvolution of the HS-AFM image. In the comparison, the height of the molecular surface of the structural model was transformed by <inline-formula id="IEq184"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\alpha }z+\overline{\beta }$$\end{document}</tex-math><mml:math id="M380"><mml:mrow><mml:mover><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mover><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq184.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq185"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\alpha }$$\end{document}</tex-math><mml:math id="M382"><mml:mover><mml:mi>α</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq185.gif"/></alternatives></inline-formula> and <inline-formula id="IEq186"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{\beta }$$\end{document}</tex-math><mml:math id="M384"><mml:mover><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41598_2022_27057_Article_IEq186.gif"/></alternatives></inline-formula> were determined by the least squares fitting to the deconvoluted surface. This transformation was needed to adjust the calibration and the offset level.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec14">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2022_27057_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Figures.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41598_2022_27057_MOESM2_ESM.mp4">
            <caption>
              <p>Supplementary Video 1.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1038/s41598-022-27057-2.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Noriyuki Kodera for giving the HS-AFM data of myosin V walking and suggesting us to apply the method to a double tip case. We thank Tohru Niina for stimulating discussion on the blind tip reconstruction. We also thank Ryuhei Oshima for his help to prepare Fig. <xref rid="Fig1" ref-type="fig">1</xref>. This work was supported by JST CREST (Grant Number: JPMJCR1762 to Y.M. and S.T.), MEXT as “Program for Promoting Researches on the Supercomputer Fugaku” (Biomolecular dynamics in a living cell, Grant Number: JPMXP1020200101 to Y.M. and S.T.), JSPS KAKENHI (Grant Number: 20K21380 to Y.M.), and the Cooperative Research Program of “Network Joint Research Center for Materials and Devices” (Grant Number: 20221300 to Y.M.).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Y.M., S.F, S.T. wrote the manuscript. Y.M. developed the code for the method. Y.M., T.O. performed the twin experiments. Y.M., S.F., S.T. analyzed the real experimental data (Myosin V walking on an actin filament). All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Jupyter notebooks to reproduce the results of this paper are publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/matsunagalab/differentiable_BTR">https://github.com/matsunagalab/differentiable_BTR</ext-link>. Some notebooks automatically download the structure of the target molecule from Protein Data Bank and calculate pseudo-AFM images used in twin experiments. The structural models of myosin V and actin filament are included in the repository. Real HS-AFM data of myosin V walking along actin filament are available upon reasonable request to corresponding author and with the permission of Kodera et al.<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par57">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Binnig</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Quate</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Gerber</surname>
            <given-names>Ch</given-names>
          </name>
        </person-group>
        <article-title>Atomic force microscope</article-title>
        <source>Phys. Rev. Lett.</source>
        <year>1986</year>
        <volume>56</volume>
        <fpage>930</fpage>
        <lpage>933</lpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevLett.56.930</pub-id>
        <pub-id pub-id-type="pmid">10033323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ando</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Uchihashi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fukuma</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>High-speed atomic force microscopy for nano-visualization of dynamic biomolecular processes</article-title>
        <source>Prog. Surf. Sci.</source>
        <year>2008</year>
        <volume>83</volume>
        <fpage>337</fpage>
        <lpage>437</lpage>
        <pub-id pub-id-type="doi">10.1016/j.progsurf.2008.09.001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ando</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>High-Speed Atomic Force Microscopy in Biology</source>
        <year>2022</year>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kodera</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Yamamoto</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ishikawa</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ando</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Video imaging of walking myosin V by high-speed atomic force microscopy</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>468</volume>
        <fpage>72</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09450</pub-id>
        <pub-id pub-id-type="pmid">20935627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Uchihashi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Iino</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ando</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Noji</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>High-speed atomic force microscopy reveals rotary catalysis of rotorless F<sub>1</sub>-ATPase</article-title>
        <source>Science</source>
        <year>2011</year>
        <volume>333</volume>
        <fpage>755</fpage>
        <lpage>758</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1205510</pub-id>
        <pub-id pub-id-type="pmid">21817054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kodera</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structural and dynamics analysis of intrinsically disordered proteins by high-speed atomic force microscopy</article-title>
        <source>Nat. Nanotechnol.</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>181</fpage>
        <lpage>189</lpage>
        <pub-id pub-id-type="doi">10.1038/s41565-020-00798-9</pub-id>
        <pub-id pub-id-type="pmid">33230318</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shibata</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Real-space and real-time dynamics of CRISPR-Cas9 visualized by high-speed atomic force microscopy</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1430</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-01466-8</pub-id>
        <pub-id pub-id-type="pmid">29127285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ando</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>High-speed atomic force microscopy and its future prospects</article-title>
        <source>Biophys. Rev.</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>285</fpage>
        <lpage>292</lpage>
        <pub-id pub-id-type="doi">10.1007/s12551-017-0356-5</pub-id>
        <pub-id pub-id-type="pmid">29256119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Villarrubia</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Algorithms for scanned probe microscope image simulation, surface reconstruction, and tip estimation</article-title>
        <source>J. Res. Natl. Inst. Stand. Technol.</source>
        <year>1997</year>
        <volume>102</volume>
        <fpage>425</fpage>
        <pub-id pub-id-type="doi">10.6028/jres.102.030</pub-id>
        <pub-id pub-id-type="pmid">27805154</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keller</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Reconstruction of STM and AFM images distorted by finite-size tips</article-title>
        <source>Surf. Sci.</source>
        <year>1991</year>
        <volume>253</volume>
        <fpage>353</fpage>
        <lpage>364</lpage>
        <pub-id pub-id-type="doi">10.1016/0039-6028(91)90606-S</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keller</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Franke</surname>
            <given-names>FS</given-names>
          </name>
        </person-group>
        <article-title>Envelope reconstruction of probe microscope images</article-title>
        <source>Surf. Sci.</source>
        <year>1993</year>
        <volume>294</volume>
        <fpage>409</fpage>
        <lpage>419</lpage>
        <pub-id pub-id-type="doi">10.1016/0039-6028(93)90126-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ando</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-speed atomic force microscopy for capturing dynamic behavior of protein molecules at work</article-title>
        <source>J. Surf. Sci. Nanotechnol.</source>
        <year>2005</year>
        <volume>3</volume>
        <fpage>384</fpage>
        <lpage>392</lpage>
        <pub-id pub-id-type="doi">10.1380/ejssnt.2005.384</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheuring</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Busselez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lévy</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Structure of the dimeric PufX-containing core complex of rhodobacter blasticus by in situ atomic force microscopy</article-title>
        <source>J. Biol. Chem.</source>
        <year>2005</year>
        <volume>280</volume>
        <fpage>1426</fpage>
        <lpage>1431</lpage>
        <pub-id pub-id-type="doi">10.1074/jbc.M411334200</pub-id>
        <pub-id pub-id-type="pmid">15522874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheuring</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Boudier</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sturgis</surname>
            <given-names>JN</given-names>
          </name>
        </person-group>
        <article-title>From high-resolution AFM topographs to atomic models of supramolecular assemblies</article-title>
        <source>J. Struct. Biol.</source>
        <year>2007</year>
        <volume>159</volume>
        <fpage>268</fpage>
        <lpage>276</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jsb.2007.01.021</pub-id>
        <pub-id pub-id-type="pmid">17399998</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asakawa</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Submolecular-scale imaging of α-helices and C-terminal domains of tubulins by frequency modulation atomic force microscopy in liquid</article-title>
        <source>Biophys. J.</source>
        <year>2011</year>
        <volume>101</volume>
        <fpage>1270</fpage>
        <lpage>1276</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2011.07.020</pub-id>
        <pub-id pub-id-type="pmid">21889465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trinh</surname>
            <given-names>M-H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational reconstruction of multidomain proteins using atomic force microscopy data</article-title>
        <source>Structure</source>
        <year>2012</year>
        <volume>20</volume>
        <fpage>113</fpage>
        <lpage>120</lpage>
        <pub-id pub-id-type="doi">10.1016/j.str.2011.10.023</pub-id>
        <pub-id pub-id-type="pmid">22244760</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaves</surname>
            <given-names>RC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Conformational dynamics of individual antibodies using computational docking and AFM: Conformational dynamics of IGG using docking and AFM</article-title>
        <source>J. Mol. Recognit.</source>
        <year>2013</year>
        <volume>26</volume>
        <fpage>596</fpage>
        <lpage>604</lpage>
        <pub-id pub-id-type="doi">10.1002/jmr.2310</pub-id>
        <pub-id pub-id-type="pmid">24089367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dasgupta</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Miyashita</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Tama</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Reconstruction of low-resolution molecular structures from simulated atomic force microscopy images</article-title>
        <source>Biochim. Biophys. Acta Gen. Subj.</source>
        <year>2020</year>
        <volume>1864</volume>
        <fpage>129420</fpage>
        <pub-id pub-id-type="doi">10.1016/j.bbagen.2019.129420</pub-id>
        <pub-id pub-id-type="pmid">31472175</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amyot</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Flechsig</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>BioAFMviewer: An interactive interface for simulated AFM scanning of biomolecular structures and dynamics</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>e1008444</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008444</pub-id>
        <pub-id pub-id-type="pmid">33206646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Niina</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Matsunaga</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Takada</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Rigid-body fitting to atomic force microscopy images for inferring probe shape and biomolecular structure</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2021</year>
        <volume>17</volume>
        <fpage>e1009215</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1009215</pub-id>
        <pub-id pub-id-type="pmid">34283829</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amyot</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Marchesi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Franz</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Casuso</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Flechsig</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Simulation atomic force microscopy for atomic reconstruction of biomolecular structures from resolution-limited experimental images</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2022</year>
        <volume>18</volume>
        <fpage>e1009970</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1009970</pub-id>
        <pub-id pub-id-type="pmid">35294442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flater</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Zacharakis-Jutz</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Dumba</surname>
            <given-names>BG</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Clifford</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Towards easy and reliable AFM tip shape determination using blind tip reconstruction</article-title>
        <source>Ultramicroscopy</source>
        <year>2014</year>
        <volume>146</volume>
        <fpage>130</fpage>
        <lpage>143</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ultramic.2013.06.022</pub-id>
        <pub-id pub-id-type="pmid">24934394</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruggeri</surname>
            <given-names>FS</given-names>
          </name>
          <name>
            <surname>Šneideris</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vendruscolo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knowles</surname>
            <given-names>TPJ</given-names>
          </name>
        </person-group>
        <article-title>Atomic force microscopy for single molecule characterisation of protein aggregation</article-title>
        <source>Arch. Biochem. Biophys.</source>
        <year>2019</year>
        <volume>664</volume>
        <fpage>134</fpage>
        <lpage>148</lpage>
        <pub-id pub-id-type="doi">10.1016/j.abb.2019.02.001</pub-id>
        <pub-id pub-id-type="pmid">30742801</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takenaka</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>AFM tip characterizer fabricated by Si/SiO<sub>2</sub> multilayers</article-title>
        <source>J. Surf. Sci. Nanotechnol.</source>
        <year>2011</year>
        <volume>9</volume>
        <fpage>293</fpage>
        <lpage>296</lpage>
        <pub-id pub-id-type="doi">10.1380/ejssnt.2011.293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeng</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A simple method for AFM tip characterization by polystyrene spheres</article-title>
        <source>Ultramicroscopy</source>
        <year>2008</year>
        <volume>108</volume>
        <fpage>975</fpage>
        <lpage>980</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ultramic.2008.04.001</pub-id>
        <pub-id pub-id-type="pmid">18514419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dongmo</surname>
            <given-names>LS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Experimental test of blind tip reconstruction for scanning probe microscopy</article-title>
        <source>Ultramicroscopy</source>
        <year>2000</year>
        <volume>85</volume>
        <fpage>141</fpage>
        <lpage>153</lpage>
        <pub-id pub-id-type="doi">10.1016/S0304-3991(00)00051-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Villarrubia</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Blind estimation of general tip shape in AFM imaging</article-title>
        <source>Ultramicroscopy</source>
        <year>2008</year>
        <volume>109</volume>
        <fpage>44</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ultramic.2008.08.002</pub-id>
        <pub-id pub-id-type="pmid">18835101</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jóźwiak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Henrykowski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Masalska</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gotszalk</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Regularization mechanism in blind tip reconstruction procedure</article-title>
        <source>Ultramicroscopy</source>
        <year>2012</year>
        <volume>118</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ultramic.2012.04.013</pub-id>
        <pub-id pub-id-type="pmid">22728398</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bakucz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Krüger-Sehm</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Koenders</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Investigation of blind tip estimation</article-title>
        <source>Rev. Sci. Instrum.</source>
        <year>2008</year>
        <volume>79</volume>
        <fpage>073703</fpage>
        <pub-id pub-id-type="doi">10.1063/1.2901616</pub-id>
        <pub-id pub-id-type="pmid">18681704</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Goodfellow</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Courville</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Deep Learning</source>
        <year>2016</year>
        <publisher-name>MIT Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schoenholz</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Jax</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>A framework for differentiable physics</article-title>
        <source>J. Stat. Mech.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greener</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>Differentiable molecular simulation can learn all the parameters in a coarse-grained force field for proteins</article-title>
        <source>PLoS ONE</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>e0256990</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0256990</pub-id>
        <pub-id pub-id-type="pmid">34473813</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cherukara</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Phatak</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Differential programming enabled functional imaging with Lorentz transmission electron microscopy</article-title>
        <source>NPJ Comput. Mater.</source>
        <year>2021</year>
        <volume>7</volume>
        <fpage>141</fpage>
        <pub-id pub-id-type="doi">10.1038/s41524-021-00600-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Villarrubia</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <source>Morphological Estimation of Tip Geometry for Scanned Probe Microscopy</source>
        <year>2022</year>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Franchi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fehri</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Deep morphological networks</article-title>
        <source>Pattern Recogn.</source>
        <year>2020</year>
        <volume>102</volume>
        <fpage>107246</fpage>
        <pub-id pub-id-type="doi">10.1016/j.patcog.2020.107246</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Nakashizuka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ashihara</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Iiguni</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <source>Morphological Regularization for Adaptation of Image Opening</source>
        <year>2022</year>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Stone</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <source>Classification And Regression Trees</source>
        <year>2017</year>
        <publisher-name>Routledge</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Innes</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fashionable modelling with Flux</article-title>
        <source>Pattern Recogn.</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.48550/ARXIV.1811.01457</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Schrödinger, LLC. <italic>The PyMOL Molecular Graphics System</italic>. (2015).</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coureux</surname>
            <given-names>P-D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A structural state of the myosin V motor without bound nucleotide</article-title>
        <source>Nature</source>
        <year>2003</year>
        <volume>425</volume>
        <fpage>419</fpage>
        <lpage>423</lpage>
        <pub-id pub-id-type="doi">10.1038/nature01927</pub-id>
        <pub-id pub-id-type="pmid">14508494</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Elucidation and identification of double-tip effects in atomic force microscopy studies of biological structures</article-title>
        <source>JSEMAT</source>
        <year>2012</year>
        <volume>02</volume>
        <fpage>238</fpage>
        <lpage>247</lpage>
        <pub-id pub-id-type="doi">10.4236/jsemat.2012.223037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kodera</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sakashita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ando</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Dynamic proportional-integral-differential controller for high-speed atomic force microscopy</article-title>
        <source>Rev. Sci. Instrum.</source>
        <year>2006</year>
        <volume>77</volume>
        <fpage>083704</fpage>
        <pub-id pub-id-type="doi">10.1063/1.2336113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fuchigami</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Takada</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Inferring conformational state of myosin motor in an atomic force microscopy image via flexible fitting molecular simulations</article-title>
        <source>Front. Mol. Biosci.</source>
        <year>2022</year>
        <volume>9</volume>
        <fpage>882989</fpage>
        <pub-id pub-id-type="doi">10.3389/fmolb.2022.882989</pub-id>
        <pub-id pub-id-type="pmid">35573735</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Akiba, T., Sano, S., Yanase, T., Ohta, T. &amp; Koyama, M. Optuna: A Next-generation Hyperparameter Optimization Framework. in <italic>Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</italic> 2623–2631 (ACM, 2019). 10.1145/3292500.3330701.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sumikama</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Foster</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Fukuma</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Computed atomic force microscopy images of chromosomes by calculating forces with oscillating probes</article-title>
        <source>J. Phys. Chem. C</source>
        <year>2020</year>
        <volume>124</volume>
        <issue>2213</issue>
        <fpage>2218</fpage>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heath</surname>
            <given-names>GR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Localization atomic force microscopy</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>594</volume>
        <fpage>385</fpage>
        <lpage>390</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03551-x</pub-id>
        <pub-id pub-id-type="pmid">34135520</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Loshchilov, I. &amp; Hutter, F. <italic>Decoupled Weight Decay Regularization</italic>. (2017) 10.48550/ARXIV.1711.05101.</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Frames Catherine White <italic>et al.</italic><italic>JuliaDiff/ChainRulesCore.jl: v1.15.2</italic>. (2022) 10.5281/ZENODO.6835210.</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Innes, M. <italic>Don’t Unroll Adjoint: Differentiating SSA-Form Programs</italic>. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1810.07951">http://arxiv.org/abs/1810.07951</ext-link> (2019).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Webb</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sali</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Comparative protein structure modeling using MODELLER</article-title>
        <source>Curr. Protoc. Bioinform.</source>
        <year>2016</year>
        <volume>54</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="doi">10.1002/cpbi.3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kenzaki</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CafeMol: A coarse-grained biomolecular simulator for simulating proteins at work</article-title>
        <source>J. Chem. Theory Comput.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>1979</fpage>
        <lpage>1989</lpage>
        <pub-id pub-id-type="doi">10.1021/ct2001045</pub-id>
        <pub-id pub-id-type="pmid">26596457</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Takada</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Energy landscape views for interplays among folding, binding, and allostery of calmodulin domains</article-title>
        <source>Proc. Natl. Acad. Sci. USA.</source>
        <year>2014</year>
        <volume>111</volume>
        <fpage>10550</fpage>
        <lpage>10555</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1402768111</pub-id>
        <pub-id pub-id-type="pmid">25002491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Niina</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fuchigami</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Takada</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Flexible fitting of biomolecular structures to atomic force microscopy images via biased molecular simulations</article-title>
        <source>J. Chem. Theory Comput.</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>1349</fpage>
        <lpage>1358</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.9b00991</pub-id>
        <pub-id pub-id-type="pmid">31909999</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cossio</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hummer</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Bayesian analysis of individual electron microscopy images: Towards structures of dynamic and heterogeneous biomolecular assemblies</article-title>
        <source>J. Struct. Biol.</source>
        <year>2013</year>
        <volume>184</volume>
        <fpage>427</fpage>
        <lpage>437</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jsb.2013.10.006</pub-id>
        <pub-id pub-id-type="pmid">24161733</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
