<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5830442</article-id>
    <article-id pub-id-type="publisher-id">3282</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-018-03282-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Characterizing the replicability of cell types defined by single cell RNA-sequencing data using MetaNeighbor</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Crow</surname>
          <given-names>Megan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Paul</surname>
          <given-names>Anirban</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4701-3020</contrib-id>
        <name>
          <surname>Ballouz</surname>
          <given-names>Sara</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Z. Josh</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Gillis</surname>
          <given-names>Jesse</given-names>
        </name>
        <address>
          <email>jgillis@cshl.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0387 3667</institution-id><institution-id institution-id-type="GRID">grid.225279.9</institution-id><institution>Cold Spring Harbor Laboratory, </institution></institution-wrap>One Bungtown Road, Cold Spring Harbor, NY 11724 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>884</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>11</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>2</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Single-cell RNA-sequencing (scRNA-seq) technology provides a new avenue to discover and characterize cell types; however, the experiment-specific technical biases and analytic variability inherent to current pipelines may undermine its replicability. Meta-analysis is further hampered by the use of ad hoc naming conventions. Here we demonstrate our replication framework, MetaNeighbor, that quantifies the degree to which cell types replicate across datasets, and enables rapid identification of clusters with high similarity. We first measure the replicability of neuronal identity, comparing results across eight technically and biologically diverse datasets to define best practices for more complex assessments. We then apply this to novel interneuron subtypes, finding that 24/45 subtypes have evidence of replication, which enables the identification of robust candidate marker genes. Across tasks we find that large sets of variably expressed genes can identify replicable cell types with high accuracy, suggesting a general route forward for large-scale evaluation of scRNA-seq data.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Single cell RNA-sequencing analysis poses challenges in replication due to technical biases and analytic variability among bioinformatics pipelines. Here, Crow et al develop MetaNeighbor for measuring cell-type replication across datasets, and use it to identify marker genes for neuron subtypes with evidence of replication.</p>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Single-cell RNA-sequencing (scRNA-seq) has emerged as an important new technology enabling the dissection of heterogeneous biological systems into ever more refined cellular components. One popular application of the technology has been to try to define novel cell subtypes within a tissue or within an already refined cell class, as in the lung<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, pancreas<sup><xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>, retina<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>, or others<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref></sup>. Because they aim to discover completely new cell subtypes, the majority of this work relies on unsupervised clustering, with most studies using customized pipelines with many unconstrained parameters, particularly in their inclusion criteria and statistical models<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>. While there has been steady refinement of these techniques as the field has come to appreciate the biases inherent to current scRNA-seq methods, including prominent batch effects<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, expression drop-outs<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref></sup>, and the complexities of normalization-given differences in cell size or cell state<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>, the question remains: how well do novel transcriptomic cell subtypes replicate across studies?</p>
    <p id="Par4">In order to answer this, we turned to the issue of cell diversity in the brain, a prime target of scRNA-seq as deriving a taxonomy of cell types has been a long-standing goal in neuroscience<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. Already more than 50 single-cell RNA-seq experiments have been performed using mouse nervous tissue (e.g., ref. <sup><xref ref-type="bibr" rid="CR19">19</xref></sup>) and remarkable strides have been made to address fundamental questions about the diversity of cells in the nervous system, including efforts to describe the cellular composition of the cortex and hippocampus<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>, to exhaustively discover the subtypes of bipolar neurons in the retina<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, and to characterize similarities between human and mouse midbrain development<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. This wealth of data has inspired attempts to compare data<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup> and more generally there has been a growing interest in using batch correction and related approaches to fuse scRNA-seq data across replicate samples or across experiments<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup>. Historically, data fusion has been a necessary step when individual experiments are underpowered or results do not replicate without correction<sup><xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref></sup>, although even sophisticated approaches to merge data come with their own perils<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. The technical biases of scRNA-seq have motivated interest in correction as a seemingly necessary fix, yet evaluation of whether results replicate remains largely unexamined, and no systematic or formal method has been developed for accomplishing this task.</p>
    <p id="Par5">To address this gap in the field, we propose a simple, supervised framework, MetaNeighbor (meta-analysis via neighbor voting), to assess how well cell-type-specific transcriptional profiles replicate across datasets. Our basic rationale is that if a cell type has a biological identity rooted in the transcriptome, then knowing its expression features in one dataset will allow us to find cells of the same type in another dataset. We make use of the cell-type labels supplied by data providers, and assess the correspondence of cell types across datasets by taking the following approach (see schematic, Fig. <xref rid="Fig1" ref-type="fig">1</xref>):<list list-type="order"><list-item><p id="Par6">We calculate correlations between all pairs of cells that we aim to compare across datasets based on the expression of a set of genes. This generates a network where each cell is a node and the edges are the strength of the correlations between them.</p></list-item><list-item><p id="Par7">Next, we do cross-dataset validation: we hide all cell-type labels (“identity”) for one dataset at a time. This dataset will be used as our test set. Cells from all other datasets remain labeled, and are used as the training set.</p></list-item><list-item><p id="Par8">Finally, we predict the cell-type labels of the test set: we use a neighbor-voting algorithm to predict the identity of the held-out cells based on their similarity to the training data.</p></list-item></list><fig id="Fig1"><label>Fig. 1</label><caption><p>MetaNeighbor quantifies cell-type identity across experiments. <bold>a</bold> Schematic representation of gene set co-expression across individual cells. Cell types are indicated by their color. <bold>b</bold> Similarity between cells is measured by taking the correlation of gene set expression between individual cells. On the top left of the panel, gene set expression between two cells, A and B, is plotted. There is a weak correlation between these cells. On the bottom left of the panel we see the correlation between cells A and C, which are strongly correlated. By taking the correlations between all pairs of cells we can build a cell network (right), where every node is a cell and the edges represent how similar each cell is to each other cell. <bold>c</bold> The cell network that was generated in <bold>b</bold> can be extended to include data from multiple experiments (multiple datasets). The generation of this multi-dataset network is the first step of MetaNeighbor. <bold>d</bold> The cross-validation and scoring scheme of MetaNeighbor is demonstrated in this panel. To assess cell-type identity across experiments we use neighbor voting in cross-validation, systematically hiding the labels from one dataset at a time for testing. Cells within the test set are predicted as similar to the cell types from other training sets using a neighbor-voting formalism. Whether these scores prioritize cells as the correct type within the dataset determines the performance, expressed as the AUROC. In other words, comparative assessment of cells occurs only within a dataset, but is based only on training information from outside that dataset. This is then repeated for all gene sets of interest</p></caption><graphic xlink:href="41467_2018_3282_Fig1_HTML" id="d29e371"/></fig></p>
    <p id="Par9">Conceptually, this resembles approaches for the validation of sample clustering<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>, which have primarily been applied to compare microarray results with respect to tumor subtyping<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR31">31</xref></sup>. Our method builds on these ideas, adapting and applying them for the first time to the question of cell identity in scRNA-seq, and specifically exploiting the patterns of co-expression believed to drive results<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. Because our implementation is extremely fast, this approach readily permits carefully defined control experiments to investigate the data features that drive high performance, such as the dependence on expression variability, gene set size, rarity of cell types, or subtlety of transcriptional identity.</p>
    <p id="Par10">We evaluate the replicability of cell-type transcriptional identity by taking sequential steps according to the basic taxonomy of brain cells: first classifying neurons vs. non-neuronal cells across eight scRNA-seq studies, then classifying cortical inhibitory neurons vs. excitatory neurons, and for our final step, we align interneuron subtypes across three studies. With detailed control experiments and empirical modeling, we validate the use of HVGs for cross-dataset cell identification, a common approach for feature selection within individual experiments<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR35">35</xref></sup>. Testing hundreds of gene sets, we find strong replication of neuronal identity when compared to non-neurons, and excitatory vs. inhibitory neurons, even across widely varying techniques such as nuclear RNA-sequencing or Drop-seq. Furthermore, we readily identify 11 interneuron subtypes that appear to replicate across datasets, including Chandelier cells and five novel subtypes defined by transcriptional clustering in previous work. Meta-analysis of differential expression across these highly replicable interneuron subtypes correctly identified canonical marker genes, as well as new candidates that may be used for improved molecular genetic targeting and to understand the diverse phenotypes of these cells.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Assessing neuronal identity with MetaNeighbor</title>
      <p id="Par11">We aimed to measure the replicability of cell identity across tasks of varying specificity. Broadly, these are divided into tasks where we are recapitulating known cell identities, and ones where we are measuring the replicability of novel cell identities discovered in recent research. The former is the focus of this subsection: first, by assessing how well we could distinguish neurons from non-neuronal cells (“task one”), and next assessing the discriminability of excitatory and inhibitory neurons (“task two”). As detailed in the Methods, MetaNeighbor outputs a performance score for each gene set and task. This score is the mean area under the receiver operator characteristic curve (AUROC) across all folds of cross-dataset validation, and it can be interpreted as the probability that we will rank a cell of the type we aim to characterize (a “positive”) higher than a cell from the out-group (a “negative”). For example, given information from a training dataset that labels neurons as positives and non-neurons as negatives and asking the algorithm to identify neurons within a testing dataset, the AUROC is the probability a neuron will be ranked above a non-neuron. The AUROC varies between 0 and 1, with 1 being perfect classification, 0.5 meaning that we have performed as well as if we had randomly guessed the cell’s identity (null), and 0.9 or above being extremely high. Low scores (0–0.3) can be interpreted with as much confidence as high scores, and mean that, for example, a neuron is definitely not a non-neuron. Comparison of scores across gene sets allows us to discover their relative capacity to discriminate cell types.</p>
      <p id="Par12">As described above, in task one we assessed how well we could identify neurons and non-neuronal cells across eight datasets<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR36">36</xref>–<xref ref-type="bibr" rid="CR40">40</xref></sup> with a total of 13,928 cells (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). Although this was designed to be fairly simple, we were interested to discover that AUROC scores are significantly higher than chance for all gene sets tested, including all randomly chosen sets (mean AUROC ± SD reported throughout; AUROC = 0.80 ± 0.1, Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). A bootstrapped sampling of the datasets showed a trend toward increased performance with the inclusion of additional training data, indicating that we are recognizing an aggregate signal across datasets (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). However, the significant improvement of random sets over the null (i.e., AUROC = 0.5) means that prior knowledge about gene function is not required to differentiate between these cell classes. Randomly chosen sets of genes have decidedly non-random expression patterns that enable discrimination between these cell types. This is particularly surprising in the context of cross-dataset assessment, where the low dimensionality of cell identity observed within laboratories<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> is confounded by the even lower dimensionality of experimental identity. This result recalls the startling finding by Venet et al. that “most random gene expression signatures are related to breast cancer outcome”<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>; cell identity appears to be as clearly ascertainable.<fig id="Fig2"><label>Fig. 2</label><caption><p>Cell-type identity is widely represented in the transcriptome. <bold>a</bold>,<bold>b</bold> Distribution of AUROC scores from MetaNeighbor for discriminating neurons from non-neuronal cells (“task one”, <bold>a</bold>) and for distinguishing excitatory vs. inhibitory neurons (“task two”, <bold>b</bold>). GO scores are in black and random gene set scores are plotted in gray. Dashed gray lines indicate the null expectation for correctly guessing cell identity (AUROC = 0.5). For both tasks, almost any gene set can be used to improve performance above the null, suggesting widespread encoding of cell identity across the transcriptome. <bold>c</bold> Comparison of GO group scores across tasks. GO groups at the extremes of the distribution are labeled. Most gene sets have higher performance for task one, and a number of groups have high performance for both tasks (e.g., transmembrane transport). <bold>d</bold> Task one AUROC scores for each gene set are plotted with respect to the number of genes. A strong, positive relationship is observed between gene set size and AUROC score, regardless of whether genes were chosen randomly or based on shared functions. <bold>e</bold> Distribution of AUROC scores for task one using 100 sets of 100 randomly chosen genes, or 800 randomly chosen genes. The mean AUROC score is significantly improved with the use of larger gene sets (mean 100 = 0.80 ± 0.05, mean 800 = 0.90 ± 0.03). <bold>f</bold> Relationship between AUROC score and coefficient of variation. Points indicate individual gene set performances, the line shows the running average and the SD of the line is indicated by the shaded region. Task one was re-run using sets of genes chosen based on mean coefficient of variation across datasets. A strong positive relationship was observed between this factor and performance (<italic>r</italic><sub>s</sub> ~ 0.67)</p></caption><graphic xlink:href="41467_2018_3282_Fig2_HTML" id="d29e486"/></fig></p>
      <p id="Par13">Task two aimed to assess how well we could discriminate between cortical excitatory and inhibitory neurons across four studies with a total of 2809 excitatory and 1162 inhibitory neurons<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR36">36</xref></sup>. Similar to our previous results, we saw that AUROC scores are significantly higher than chance (AUROC = 0.69 ± 0.1, Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). While performance is high for both tasks, it is unclear whether the same gene sets are useful for distinguishing between neurons and non-neurons and between excitatory and inhibitory neurons. Comparing GO group performance we find that a handful of gene sets have high performance for both tasks (e.g., GO:0055085 transmembrane transport, AUROC &gt; 0.85, Fig. <xref rid="Fig2" ref-type="fig">2c</xref>), while many GO groups show divergent performance. For example, we find that GO:0019748 (secondary metabolic process) is only useful for distinguishing between neurons and non-neurons, but not at all for distinguishing between the two neuron classes, perhaps because of cell cycling among non-neuronal cells. On the other extreme, we find that GO:0040011 (cell adhesion) is only useful for distinguishing between neuron classes but not between neurons and non-neuronal cells, which is in line with previous work that found that cell adhesion factors show neuron-type-specific expression<sup><xref ref-type="bibr" rid="CR43">43</xref>,<xref ref-type="bibr" rid="CR44">44</xref></sup>. These results indicate some degree of functional specificity for gene set performance, but the near equivalent performance of randomly chosen gene sets suggests that transcriptional differences are likely to be encoded in a large number of genes, in line with previous observations<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>. The properties of high-performing sets are investigated in the following section.</p>
    </sec>
    <sec id="Sec4">
      <title>Characterizing features associated with high performance</title>
      <p id="Par14">Consistent with the view that a large fraction of transcripts are useful for determining cell identity, we find a positive dependency of AUROC scores on gene set size, regardless of whether genes within the sets are randomly selected or share some biological functions (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>). This was further supported by a comparison of scores for task one when using randomly chosen sets of genes constrained to a given size. Here we used set sizes of 100 or 800, similar to the extremes of the distribution of set sizes used in the GO analysis. AUROC score distributions and means are significantly different between gene sets of different sizes: sets of 100 genes have lower scores but higher variability in performance, whereas sets of 800 genes are more restricted in variance and have higher performance on average (Fig. <xref rid="Fig2" ref-type="fig">2e</xref>, AUROC<sub>100</sub> = 0.75 ± 0.06, AUROC<sub>800</sub> = 0.87 ± 0.02, <italic>P</italic> &lt; 2.2E−16, Wilcoxon rank-sum test). The variability in performance observed while keeping set size constant suggests that even in random sets there are transcriptional features that contribute to cell identity. We delved into this further by comparing AUROC scores across gene sets chosen based on coefficient of variation, as MetaNeighbor relies on co-variation between genes to detect differences in cell-type profiles. Performing task one again, we find a strong positive relationship between variance and our ability to classify cells (Fig. <xref rid="Fig2" ref-type="fig">2f</xref>, Spearman correlation coefficient = 0.67), although interestingly, genes in the top centile are completely uninformative (AUROC = 0.47). Taken together, these observations support the idea that transcriptional identity is broadly encoded across many genes, and suggests that it should be straightforward to select an informative gene set that takes advantage of properties associated with high performance. Testing our capacity to detect and exploit this signal requires us to refine the cell classes that we are characterizing, ideally beyond what is present in existing data to anticipate a wide range of use cases.</p>
    </sec>
    <sec id="Sec5">
      <title>Empirical modeling to determine precision</title>
      <p id="Par15">Our ultimate aim is to identify all replicable cell types across datasets, some of which may be rare and/or only subtly different from other cell types. To assess the ability of MetaNeighbor to identify cell types in these more realistic scenarios, we set up an empirical model for cell-type rarity and subtlety (Schematic Fig. <xref rid="Fig3" ref-type="fig">3a</xref>), using inhibitory and excitatory neuron datasets with &gt;100 cells for each type as these allow us to model cell-type incidence down to 1%<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. We define a rare cell type as one in which only a few differing cells are present, and a subtle transcriptional identity is one in which only a few differing genes are present. Thus, to address the impact of rarity on MetaNeighbor’s performance, we alter the incidence of excitatory neurons to be within our observed range of subtype incidences, repeatedly sampling different combinations of cells to obtain mean performance estimates. Subtlety is modeled by swapping out gene information, e.g., the same 95% of the transcriptional profiles across all excitatory cell transcriptional data for data from inhibitory cells, so that all cells sample from the same cell class for 95% of their profile (sampled without replacement to ensure there are no confounding overlaps). At each level of rarity and subtlety we measure AUROCs across datasets with MetaNeighbor, using the highest-performing GO group for these data as a positive control for gene set selection (GO:0022857) and a randomly chosen set of 20 genes as a negative control, having established that small gene sets tend to have low performance.<fig id="Fig3"><label>Fig. 3</label><caption><p>Empirical modeling demonstrates that MetaNeighbor readily identifies rare and transcriptionally subtle cell types. <bold>a</bold> Schematic of the empirical model. For simplicity only a single dataset is depicted. (Top left) In this dataset, we begin with an expression matrix containing gene expression levels for two cell types comprising 10 cells each. Here we will be assessing the replicability of cell type 1 (“positives”) relative to cell type 2 (“negatives”). (Top right) We first adjust cell rarity by randomly sampling subsets of the original expression matrix. In the schematic, incidence is set to 20% (two positives and eight negatives). In addition, we partition two negatives from the original data for later use. (Middle) Next, we adjust transcriptional subtlety by randomly sampling genes from a given fraction of the transcriptome. Gene expression in the positives will be replaced with data from the unused negatives, creating a modeled cell type varying from the negative class only in a subset of its genes. (Bottom) All datasets are combined and MetaNeighbor is run to assess the replicability of the positives at each level of rarity and subtlety. <bold>b</bold> MetaNeighbor results for empirical modeling of excitatory neuron rarity and subtlety, repeated 100 times. Mean performance for the top GO group is in black; performance for 20 randomly chosen genes is shown in red; dashed lines indicate 20% rarity and solid lines show 1% rarity. MetaNeighbor is robust to differences in cell rarity, and can reliably distinguish between types even when they are very similar (AUROC &gt; 0.7 at &gt;88% subtlety). <bold>c</bold> MetaNeighbor results for empirical modeling of excitatory neuron rarity and subtlety using highly variable genes (HVGs), repeated 100 times. Performance for the HVG varying set is shown in black, performance for the HVG static is shown in red; dashed lines indicate 20% rarity and solid lines show 1% rarity. HVGs allow for robust identification of positives even when cells are rare or differences are subtle</p></caption><graphic xlink:href="41467_2018_3282_Fig3_HTML" id="d29e578"/></fig></p>
      <p id="Par16">As expected, GO:0022857 performance is higher than the random set of 20 genes at both 1 and 20% incidences (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). Importantly, MetaNeighbor performance is nearly unaffected by differences in rarity: GO set performance is equally high when excitatory neurons make up 1 or 20% of all cells in each dataset, with <italic>n</italic> as low as 1 cell in the tested data. Of interest is the robustness of MetaNeighbor to transcriptional subtlety. Of course, increasing subtlety leads to worse performance at both incidences, and falls to chance levels at subtleties &gt;99% (AUROC = 0.5). However, even at almost 90% subtlety MetaNeighbor correctly identifies excitatory neurons with a mean AUROC of 0.71. Since this subtlety is relative to the transcriptional variability that exists between inhibitory and excitatory cells, it is quite extreme. Consistent with our previous results comparing performance across all GO functions, this suggests that there are marked and widespread differences in excitatory and inhibitory neuron gene expression, such that even sampling a small fraction of genes (&lt;10%) allows for identification of these two classes. In sum, these results provide strong evidence that MetaNeighbor is robust to differences in rarity, and gives guidance for the interpretation of AUROC scores in light of this factor, suggesting the subtlety of cell identity relative to the outside control.</p>
    </sec>
    <sec id="Sec6">
      <title>Empirical modeling to evaluate gene set selection</title>
      <p id="Par17">In the previous section we demonstrated that the highest-performing GO group is robust to variation in either incidence or transcriptional subtlety, still permitting cell identification when cells are rare or only subtly distinguishable. Determining this gene set requires known concordance of cell types across datasets. When concordance is unknown, for example, when cell-type labeling is idiosyncratic, it is necessary to have a strategy to identify informative gene sets ab initio. Expert knowledge of marker genes is one possibility, although this approach may not be extensible to newly described cell subtypes and suffers from potential ascertainment bias. As a more general alternative, the selection of highly variable genes (HVGs) is commonly used in a single-cell analysis prior to dimension reduction and clustering<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR35">35</xref></sup>, as it is thought that differentially expressed genes or marker genes should be preferentially variable, and less subject to joint low-level noise. This is in line with our previous observation that gene sets containing HVGs are high-performing. Indeed, when we select a set of HVG (detailed in Methods) we can almost perfectly identify excitatory neurons compared to inhibitory neurons across datasets (AUROC = 0.99), which is equivalent to the highest-performing GO group, but without any prior knowledge.</p>
      <p id="Par18">In parallel to our previous analyses, we assessed the robustness of HVG selection at different levels of rarity and subtlety, using either HVG picked from the original dataset that includes all cells (HVG static), or HVG re-calculated based on the precise subset of data included in each run of the empirical model (HVG varying; Fig. <xref rid="Fig3" ref-type="fig">3c</xref>). Here, we see that our HVG selection strategy performs equally to or better than the highest-performing GO group for both rare cell types (1–20% of total), and for subtle cell types (differing from out-group by &lt;10%). Interestingly, the HVG heuristic is even responsive to the precise data sampling, yielding modestly improved performance when it is selected based on the precise data generated by the empirical model.</p>
      <p id="Par19">These results provide evidence that MetaNeighbor can readily identify cells of the same type across datasets, without relying on specific knowledge of marker genes, even when cells are rare or only subtly different from the out-group. Importantly, these results also provide guidelines for interpreting AUROCs at cell incidences ≥1% in terms of their implications for the promiscuity of cell identity across the transcriptome.</p>
    </sec>
    <sec id="Sec7">
      <title>Investigating interneuron subtypes with MetaNeighbor</title>
      <p id="Par20">Cortical inhibitory interneurons have diverse characteristics based on their morphology, connectivity, electrophysiology, and developmental origins, and it has been an ongoing goal to define cell subtypes based on these properties<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. In a related paper<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, we describe the transcriptional profiles of GABAergic interneuron types, which were targeted using intersectional marker gene expression, cell lineage, laminar distribution, and birth timing, and have been extensively phenotyped both electrophysiologically and morphologically<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. Previously, two studies were published in which new interneuron subtypes were defined based on scRNA-seq transcriptional profiles<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. Because of differences in experimental design and analytic choices, the two studies found different numbers of subtypes (16 in one and 23 in the other). The authors of the later paper compared their outcomes by looking at the expression of a handful of marker genes, which yielded mixed results: a small number of cell types seemed to have a direct match but for others the results were more conflicting, with multiple types matching to one another, and others having no match at all. Here we aimed to more quantitatively assess the similarity of their results, and compare them with our own data that derives from phenotypically characterized subpopulations; i.e., not from unsupervised expression clustering (see Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref> for sample information).</p>
      <p id="Par21">To examine how the previously identified interneuron subtypes are represented across the three studies, we tested the similarity of each pair of subtypes across datasets using HVGs. This was done by alternately considering each subtype as the positive training set, and each other subtype as the positive test set, answering questions of the class, e.g., “How well does the Zeisel_Int1 HVG expression predict the identity of the Tasic_Smad3 subtype relative to all interneurons in the Tasic data?”. Each subtype ranges in incidence from 1 to 24% of the total number of cells within its own dataset, well within the range of the sensitivity of MetaNeighbor as established above. Corroborating earlier results, we find that for each interneuron type profiled by Paul et al. we find a reciprocal best match in the pre-existing data (Table <xref rid="Tab1" ref-type="table">1</xref>, all scores in Supplementary Data <xref rid="MOESM3" ref-type="media">1</xref>). In addition, expanding our criteria to include all reciprocal best matches, and those with AUROC scores ≥0.95, we find additional matches for the Paul subtypes, as well as correspondence among five subtypes that were assessed only in the Tasic and Zeisel data. Overall, we identified 11 subtypes representing 24/45 (53%) types (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>), with total <italic>n</italic> for each subtype ranging from 25 to 189 out of 1583 interneurons across all datasets (1.5–11%). Our corresponding subtypes also confirm the marker gene analysis performed by Tasic et al. (Supplementary Data <xref rid="MOESM3" ref-type="media">1</xref>), without requiring manual gene curation. Because we quantify the similarity among types, we can prioritize matches and use these as input to MetaNeighbor for further evaluation.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Putatively replicated interneuron subtypes and their MetaNeighbor scores for HVG and top GO groups</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Interneuron subtype (author, label)</th><th>AUROC HVG</th><th>AUROC Top GO</th><th>Top GO group</th><th>Description</th></tr></thead><tbody><tr><td>Tasic, Sst Chodl Paul, Som-Nos1 Zeisel, Int1</td><td char=".">1.00</td><td char=".">1.00</td><td>GO:0071407</td><td>Cellular response to organic cyclic compound</td></tr><tr><td>Tasic, Pvalb Cpne5 Paul, ChC</td><td char=".">0.99</td><td char=".">0.98</td><td>GO:0043005</td><td>Neuron projection</td></tr><tr><td>Tasic, Sst Cbln Paul, Sst-CR</td><td char=".">0.98</td><td char=".">0.96</td><td>GO:0090257</td><td>Regulation of muscle system process</td></tr><tr><td>Tasic, Smad3 Zeisel, Int14</td><td char=".">0.97</td><td char=".">0.98</td><td>GO:0007169</td><td>Transmembrane receptor protein tyrosine kinase signaling pathway</td></tr><tr><td>Tasic, Pvalb Wt1 Paul, Pv</td><td char=".">0.96</td><td char=".">0.97</td><td>GO:0045202</td><td>Synapse</td></tr><tr><td>Tasic, Vip Chat Paul, Vip-CR Zeisel, Int10</td><td char=".">0.96</td><td char=".">0.95</td><td>GO:0007188</td><td>Adenylate cyclase-modulating G-protein-coupled receptor signaling pathway</td></tr><tr><td>Tasic, Vip Sncg Paul, Vip-Cck</td><td char=".">0.95</td><td char=".">0.99</td><td>GO:0097458</td><td>Neuron part</td></tr><tr><td>Tasic, Sncg Zeisel, Int6</td><td char=".">0.95</td><td char=".">0.95</td><td>GO:0097458</td><td>Neuron part</td></tr><tr><td>Tasic, Ndnf Car4 Zeisel, Int15</td><td char=".">0.95</td><td char=".">0.94</td><td>GO:0007610</td><td>Behavior</td></tr><tr><td>Tasic, Igtp Zeisel, Int13</td><td char=".">0.94</td><td char=".">0.94</td><td>GO:0010975</td><td>Regulation of neuron projection development</td></tr><tr><td>Tasic, Ndnf Cxcl14 Zeisel, Int12</td><td char=".">0.91</td><td char=".">0.89</td><td>GO:0007611</td><td>Learning or memory</td></tr></tbody></table><table-wrap-foot><p>Subtypes are listed from highest to lowest AUROC using the HVGs. HVGs perform comparably to or better than the top-ranking GO group for most subtypes</p></table-wrap-foot></table-wrap><fig id="Fig4"><label>Fig. 4</label><caption><p>Cross-dataset analysis of interneuron diversity. <bold>a</bold> Heatmap of AUROC scores between interneuron subtypes based on the highly variable gene set (HVG). Dendrograms were generated by hierarchical clustering of Euclidean distances using average linkage. Row and column colors indicate data origin and marker expression. Clustering of AUROC score profiles recapitulates known cell-type structure, with major branches representing the Pv, Sst, and Htr3a lineages. <bold>b</bold> Boxplots of GO performance (3888 sets) for each putatively replicated subtype, ordered by their AUROC score from the highly variable gene set. Subtypes are labeled with the names from Tasic et al. A positive relationship is observed between AUROC scores from the highly variable set and the average AUROC score for each subtype</p></caption><graphic xlink:href="41467_2018_3282_Fig4_HTML" id="d29e881"/></fig></p>
      <p id="Par22">To assess cell identification more broadly, we ran MetaNeighbor with these new across-dataset subtype labels, measuring predictive validity across all gene sets in GO (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). The distribution of AUROC scores varies across subtypes but we find that the score from the high variability gene set is representative of overall trends, with high-performing groups showing higher mean AUROC scores over many gene sets. Both the high mean AUROCs across all putative replicate subtypes, and the similarity of maximum performance suggest that distinctive gene co-expression can be observed in each subtype (maximum AUROC = 0.92 ± 0.04). As with previous tasks, we find little difference between functional gene sets and random sets (AUROC<sub>Random</sub> = 0.67 ± 0.06, AUROC<sub>GO</sub> = 0.68 ± 0.1). Top performing GO groups for each of the 11 replicate interneuron subtypes are primarily related to neuronal function, which is expected because of the large size of these gene sets and their likelihood of expression and variation in these cells (Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
      <p id="Par23">These results suggest that HVG sets can be used alongside pairwise testing and training as a heuristic to identify replicable subtypes for further evaluation. Indeed, while outside the scope of our primary analysis, we have found that re-analysis of tens of thousands of cells from mouse cortical and hippocampal pyramidal neurons<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>, retina<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>, and human pancreas<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR47">47</xref>,<xref ref-type="bibr" rid="CR48">48</xref></sup> provide strong evidence for the broad applicability of this approach (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>, Supplementary Data <xref rid="MOESM4" ref-type="media">2</xref>, and Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    </sec>
    <sec id="Sec8">
      <title>Identifying subtype-specific genes</title>
      <p id="Par24">ScRNA-seq experiments often seek to define marker genes for novel subtypes, although typically only a small number of genes are reported in single-cell papers because of the complexity of discussing dozens of cell types as well as the potential technical confounds, which would limit the expected replicability of a more comprehensive list<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. Here we aimed to identify possible marker genes that would allow discrimination among interneuron subtypes. For each of our identified replicate subtypes we generated a ranked list of possible marker genes by performing differential expression analysis within each study (e.g., Int1 vs. all other interneurons in the Zeisel study) and combining <italic>P</italic> values across studies using Fisher’s method (Supplementary Data <xref rid="MOESM5" ref-type="media">3</xref>). Figure <xref rid="Fig5" ref-type="fig">5a</xref> shows the FDR-adjusted <italic>P</italic> values for the top candidates based on fold change for the 10 replicated interneuron subtypes with overlapping differential expression patterns. The majority of these genes have previously been characterized as having some degree of subtype-specific expression, for example, we readily identify genes that were used for the Cre-driver lines in the Tasic and Paul studies (<italic>Sst, Pvalb, Vip, Cck</italic>, and <italic>Htr3a</italic>), as well as all markers previously reported to intersect between the Tasic and Zeisel data (Supplementary Data <xref rid="MOESM5" ref-type="media">3</xref>). Even though we filtered for genes with high fold changes, we see that many genes are differentially expressed in more than one subtype. Notably, considerable overlap can be observed among the <italic>Htr3a</italic>-expressing types. For example, the Vip Sncg subtype is only subtly different from the Sncg subtype across this subset of genes, with the Sncg cells lacking differential expression of <italic>Cxcl14</italic> and <italic>Nr2f2</italic>.<fig id="Fig5"><label>Fig. 5</label><caption><p>Replicated subtypes show consistent differential expression. <bold>a</bold> (Top) Heatmap of FDR-adjusted <italic>P </italic>values of top differentially expressed genes among replicated interneuron subtypes (NB only 10 subtypes are shown as no differentially expressed genes were found for the Ndnf Car4 subtype). Subtype names are listed at the top of the columns and are labeled as in Tasic et al<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Many genes are commonly differentially expressed among multiple subtypes, but combinatorial patterns distinguish them. <bold>b</bold> Standardized <italic>Ptn</italic> expression is plotted across the three experiments, where each box represents an interneuron subtype. Boxes bound the quartiles, middle lines represent the median, whiskers extend to 1.5 times the interquartile range, and values outside of this range are shown as individual points. High, but variable expression is observed across the three Sst Chodl types. <bold>c</bold> Confocal images of co-immunostaining for <italic>Ptn</italic>-CreER;Ai14 with RFP and Nos1 antibodies in adult mouse cortex. <italic>Ptn</italic>-CreER;Ai14 expression was induced with low-dose tamoxifen postnatally. Clear co-labeling is observed in a deep layer (L6) long projecting neuron</p></caption><graphic xlink:href="41467_2018_3282_Fig5_HTML" id="d29e1025"/></fig></p>
      <p id="Par25">We also identify some novel candidates, including <italic>Ptn</italic>, or pleiotrophin, which is significantly more expressed in the three <italic>Sst</italic> and <italic>Nos1</italic>-expressing subtypes than in the others (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). It is thus expected to be discriminative of these neurons compared to other interneuron types. We validated <italic>Ptn</italic> expression with genetic targeting<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, and we show clear expression in neurons that stain positively for Nos1 and have morphological features characteristic of long projecting interneurons (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). <italic>Ptn</italic> is a growth factor, and we suggest that its expression may be required for maintaining the long-range axonal connections that characterize these cells. These cells are well described by current markers; however, this approach is likely to be of particular value for novel subtypes that lack markers, allowing researchers to prioritize genes for follow-up by assessing robustness across multiple data sources.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par26">Single-cell transcriptomics promises to have a revolutionary impact by enabling comprehensive sampling of cellular heterogeneity; nowhere is this variability more profound than within the brain, making it a particular focus of both single-cell transcriptomics and our own analysis into its replicability. The substantial history of transcriptomic analysis and meta-analysis gives us guidance about bottlenecks that will be critical to consider in order to characterize cellular heterogeneity. The most prominent of these is laboratory-specific bias, likely deriving from the adherence to a strict set of internal standards that may filter for some classes of biological signal (e.g., poly-A selection) or induce purely technical grouping (e.g., by sequencing depth). Because of this, it is imperative to be able to compare data across studies and determine some form of consensus. Indeed, while this work was under review, five manuscripts became available that tackle different aspects of this problem, including robust low-dimensional representation and the use of reference data for cell classification<sup><xref ref-type="bibr" rid="CR49">49</xref>,<xref ref-type="bibr" rid="CR50">50</xref></sup>, batch correction using nearest neighbors<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, and data fusion via manifold alignment<sup><xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR51">51</xref></sup>. These papers collectively add to existing techniques for correcting expression data or predicting sample identity, topics closely related to our own interest. However, all take as their premise that replicable signatures occur and data can either be aligned to obtain them or novel identities predicted to best fit them. Our study is unique in its aim and ability to not only identify replicable cell types but to rigorously quantify the degree to which replicability occurs, making use of interpretable methods and concrete performance metrics. Historically, cross-laboratory validation has been regarded as extremely challenging<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>, but using carefully defined controls, our work demonstrates that single-cell identities exhibit cross-lab replication. Importantly, we do not rely on novel statistical metrics; our work provides a formal means to quantitatively assess cell-type replicability using existing statistical concepts. The essential premise of our method is that if a cell type has a distinct transcriptional profile within a dataset, then an algorithm trained from that dataset will correctly identify the same type within an independent dataset.</p>
    <p id="Par27">The ease-of-use and quantitative output of our approach allowed us to canvas existing data broadly and draw a number of important conclusions. We validated the identity of 11 interneuron subtypes, and described replicate transcriptional profiles to prioritize possible marker genes, including <italic>Ptn</italic>, a growth factor that is preferentially expressed in Sst Chodl cells. One major surprise of our analysis is the degree of replicability in the current data. AUROC scores are exceptionally high, particularly when considered in the context of the well-described technical confounds of single-cell data. We suspect that this reflects the fundamental nature of the biological problem we are facing: cell types can be identified by their transcriptional profiles, and the biological clarity of the problem overcomes technical variation. Echoing earlier work on cancer subtyping<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, we caution that orthogonal data will be required to more firmly establish the biological basis of cell identity; the current estimates must be regarded as optimistic since most clusters are defined from gene expression to begin with. However, the clarity of cell identity is further suggested by our result that cell identity has promiscuous effects within transcriptional data. While in-depth investigation of the most salient gene functions is required to characterize cell types, to simply identify cell types is relatively straightforward. This is necessarily a major factor in the apparent successes of unsupervised methods in determining novel cell types and suggests that cell-type identity is clearly defined by transcriptional profiles, regardless of cell selection protocols, library preparation techniques, or fine-tuning of clustering algorithms.</p>
    <p id="Par28">Our empirical modeling suggests that this clear signal will permit cell types to be identified down to even greater specificity, but not indefinitely, and some areas of concern within even the present data are worth highlighting. In this work we opted to use the cluster labels provided by the original authors, in essence to characterize both the underlying data as well as current analytic practices. However, this has limitations where studies cluster to different levels of specificity. This reflects quite real ambiguity about the degree of specificity associated with the term “cell type”. For example, nearly all Pvalb subtypes from the Tasic dataset and the Zeisel Int3 type have AUROC scores &gt;0.9 for the Paul Pv type, as can be seen in the bottom left corner of the heatmap in Fig. <xref rid="Fig4" ref-type="fig">4a</xref>, suggesting that these may form one larger or more general Parvalbumin-positive type. It is here that the concrete meaning of AUROCs helps. While reciprocal top hits and AUROCs &gt;0.95 reflect extreme confidence in a highly concordant cell type, more moderate scores are still meaningful. In most domains of biological study, AUROCs &gt;0.9 are extraordinarily high (e.g., refs. <sup><xref ref-type="bibr" rid="CR53">53</xref>,<xref ref-type="bibr" rid="CR54">54</xref></sup>), and we suggest that any such pairing is worthy of discussion. Moving past this point and distinguishing between only subtly different types will be difficult for any analysis, and their discovery will require consideration of appropriate controls and comparisons. The notion of experimental control is built into our scoring method (AUROCs), which by definition compares positive and negative cases across the data. As in all classification tasks, choice of an unreasonable out-group or control will generate misleading results, and the closest out-group is usually the most appropriate. Within our current framework we suggest that a hierarchical approach, moving from broad to subtle categories, will provide a comprehensive, multiscale view of cell-type replicability. We note that our implementation is both robust and fast, but further development of MetaNeighbor and its basic framework may yield improvements (e.g., optimization of feature selection, multikernel approaches for cell similarity network estimation, more sophisticated machine-learning algorithms).</p>
    <p id="Par29">A key bottleneck, however, is the availability of the data itself. While many groups make their data available in some format, without field-wide standards these data are necessarily more difficult to wrangle than it need be. A common issue is the absence of inferred cell-type labels. While it will likely take time and concerted effort for naming conventions to be established, it is crucial that authors make cell labels publicly available in easy-to-access flat text files along with the final parsed expression data matrix to which those labels were applied (or derived). Our wish list for study metadata would also include standardized reporting of cell viability estimates, cell capture method, library preparation method and batch identifiers, alongside biological covariates such as age, sex, and strain. More comprehensive reporting would allow for deeper evaluation of technical and biological factors that influence single-cell expression results. As the project of assembling a human cell atlas gets underway<sup><xref ref-type="bibr" rid="CR55">55</xref></sup>, we hope that participants continue to learn lessons from MAQC and other large consortia projects, making results quickly and readily available to the public, and recognizing the value of heterogeneity in experimental and computational approaches to generate biologically robust results with independent and replicable evidence.</p>
  </sec>
  <sec id="Sec10" sec-type="materials|methods">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Public expression data</title>
      <p id="Par30">Data analysis was performed in R using custom scripts<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>. Processed expression data tables were downloaded from GEO directly, and then subset to genes appearing on both Affymetrix GeneChip Mouse Gene 2.0 ST array (902119) and the UCSC known gene list to generate a merged matrix containing all samples from each experiment. The mean value was taken for all genes with more than one expression value assigned. Where no gene name match could be found, a value of 0 was input. We considered only samples that were explicitly labeled as single cells, and removed cells that expressed fewer than 1000 genes with expression &gt;0. Cell-type labels were manually curated using sample labels and metadata from GEO (see Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>).</p>
    </sec>
    <sec id="Sec12">
      <title>Gene sets</title>
      <p id="Par31">Gene annotations were obtained from the GO Consortium ‘goslim_generic’ (August 2015). These were filtered for terms appearing in the GO Consortium mouse annotations “gene_association.mgi.gz” (December 2014) and for gene sets with between 20 and 1000 genes, leaving 106 GO groups with 9221 associated genes. Random gene sets were generated by randomly choosing genes with the same set size distribution as GO slim. Gene sets based on coefficient of variation were generated by measuring the coefficient of variation for each gene within each dataset, ranking these lists, and then taking the average across datasets. The average was then binned into centiles. Sets of HVGs were generated by binning data from each dataset into deciles based on expression level, and then making lists of the top 25% of the most variable genes for each decile, excluding the most highly expressed bin. The HVG set was then defined as the intersect of the HVG lists across the relevant datasets. Although this did not occur within our analysis, the use of the intersect is likely to be too stringent as the number of datasets for comparison increases. In this case, a majority rule on the highly variable set across datasets appears to be a practicable strategy. Further commentary regarding highly variable gene set selection may be found in Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="Sec13">
      <title>MetaNeighbor</title>
      <p id="Par32">The input to MetaNeighbor is a set of genes, a data matrix, and two sets of labels: one set for labeling each experiment and one set for labeling the cell types of interest. For each gene set, the method generates a cell–cell similarity network by measuring the Spearman correlation between all cells across the genes within the set, and then ranking and standardizing the network so that all values lie between 0 and 1. The use of rank correlations means that the method is robust to any rank-preserving normalization (i.e., log2, TPM, and RPKM). Ranking and standardizing the networks ensures that distributions remain uniform across gene sets, and diminishes the role outlier similarities can play since values are constrained. In previous work we have demonstrated that networks constructed in this way are both robust and highly effective for capturing gene co-expression as evaluated by a variety of machine-learning methods<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>.</p>
      <p id="Par33">The node degree of each cell is defined as the sum of the weights of all edges connected to it (i.e., the sum of the standardized correlation coefficients between each cell and all others), and this is used as the null predictor in the neighbor-voting algorithm to standardize for a cell’s hubness: cells that are generically linked to many cells are preferentially downweighted, whereas those with fewer connections are less penalized. For each cell-type assessment, the neighbor-voting predictor produces a weighted matrix of predicted labels by performing matrix multiplication between the network and the binary vector (0,1) indicating cell-type membership, and then dividing each element by the null predictor (i.e., node degree). In other words, each cell is given a score equal to the fraction of its neighbors, including itself, which are part of a given cell type<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>. Unlike K-Nearest Neighbors, all cells are neighbors to one another to varying degrees (defined by the weighted cell–cell similarity network). For cross-validation, we permute through all possible combinations of leave-one-dataset-out cross-validation, sequentially hiding each experiment’s cell labels in turn, and then reporting how well we can recover cells of the same type as the mean AUROC across all folds. A key difference from conventional cross-validation is that there are no labeled data within the dataset for which predictions are being made. Labeled data come only from external datasets, ensuring that predictions are driven by signals that are replicable across data sources. To improve speed, AUROCs are calculated analytically, where the AUROC for each cell type <italic>j</italic>, is calculated based on the sum of the ranks of the scores for each cell <italic>i</italic> (Ranks<sub><italic>i</italic></sub>), belonging to that cell type, ranked out of all cells within the dataset. This can be expressed as follows:<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm AUROC}_j = \mathop {\sum }\limits_i^{\mathrm{N}} \frac{{{\rm Ranks}_i}}{{N \ast N_{{\rm Neg}}}} - \frac{{N + 1}}{{2 \ast N_{\rm Neg}}}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi>U</mml:mi><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2018_3282_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <italic>N</italic> is the number of true-positives (cells of type <italic>j</italic>), and <italic>N</italic><sub>Neg</sub> is the number of true-negatives (cells not of type <italic>j</italic>). Thus, the AUROC calculates the probability that the classifier correctly predicts that a cell of type <italic>j</italic> outranks a cell not of type <italic>j</italic> within the test dataset based on similarity to the labeled data in the training dataset(s). Note that for experiments with only one cell type this cannot be computed as there are no true-negatives. For each gene set, AUROCs are reported as averages across all folds of cross-validation (excluding NAs from experiments with no negatives), and the distribution of mean AUROCs across gene sets is plotted. When reporting performance across many gene sets, results are presented as the mean ± SD across gene sets (e.g., AUROC<sub>GO</sub> = 0.6 ± 0.1). Estimated run times for MetaNeighbor may be found in Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>. </p>
    </sec>
    <sec id="Sec14">
      <title>Empirical model of cell-type rarity and subtlety</title>
      <p id="Par34">To test the impact of cell-type rarity and transcriptional subtlely on MetaNeighbor performance, we repeated the excitatory vs. inhibitory cell discrimination task using the Tasic, Zeisel, and Habib datasets, which contained &gt;100 cells per cell type, allowing us to assess cell incidences as low as 1%. The essence of the model is to construct a gene-by-cell matrix in which the biclustering problem to identify cell types from their variation in expression would be increasingly challenging, with both a smaller and smaller fraction of cells (rarity) within the minority class and a smaller and smaller fraction of transcripts distinguishing those cells (subtlety). We model this variability in transcriptional subtlety by sampling different fractions of the transcriptome from the minority class; therefore, for example, a dataset could be generated in which only 1% of cells have only 10% of their gene expression values sampled from the minority class with the remainder sampled from the majority class. Each minority class cell’s expression vector would thus be the discrete combination of two real cells, one excitatory and one inhibitory. In all cases, real expression values are used with strict partitioning, e.g., sampling without replacement from expression vectors defining cells. Each analysis for a given value of rarity and subtlety was repeated 100 times and means across random subsamplings of genes and cells are plotted in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.</p>
    </sec>
    <sec id="Sec15">
      <title>Identifying putative replicates</title>
      <p id="Par35">In cases where cell identity was undefined across datasets (i.e., cortical interneuron subtypes) we treated each subtype label as a positive for each other subtype, and assessed similarity using HVGs. For example, Int1 from the Zeisel dataset was used as the positive (training) set, and all other subtypes were considered the test set in turn. Mean AUROCs from both testing and training folds are plotted in the heatmap in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. Reciprocal best matches across datasets and AUROCs ≥0.95 were used to identify putative replicated types for further assessment with our supervised framework (detailed above). New cell-type labels encompassing these replicate types (e.g., a combined Sst Chodl label containing Int1 (Zeisel), Sst Chodl (Tasic), and Sst Nos1 (Paul)) were generated for MetaNeighbor across random and GO sets, and for meta-analysis of differential expression. While only reciprocal top hits across laboratories were used to define putative replicate cell types, cross-validation within laboratories was performed to fill in AUROC scores for cell types within each laboratory.</p>
    </sec>
    <sec id="Sec16">
      <title>Differential expression</title>
      <p id="Par36">For each cell type within a dataset (defined by the authors’ original labeling), differential gene expression was calculated using a one-sided Wilcoxon rank-sum test, comparing gene expression within a given cell type to all other cells within the dataset (e.g., Zeisel_Int1 vs. all other Zeisel interneurons). Meta-analytic <italic>P</italic> values were calculated for each putative replicated type using Fisher’s method<sup><xref ref-type="bibr" rid="CR59">59</xref></sup>, and then a multiple hypothesis test correction was performed with the Benjamini–Hochberg method<sup><xref ref-type="bibr" rid="CR60">60</xref></sup>. Top differentially expressed genes were those with an adjusted meta-analytic FDR &lt; 0.001 and with log2 fold change &gt;2 in each dataset. All differential expression data for putative replicated subtypes can be found in Supplementary Data <xref rid="MOESM5" ref-type="media">3</xref>. Details regarding the generation of <italic>Ptn</italic>-CreER transgenic mice, immunostaining and imaging may be found in Paul et al. The image in panel 5c was taken at the same time as those presented in Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref> of that paper, but this image has never been published.</p>
    </sec>
    <sec id="Sec17">
      <title>Data availability</title>
      <p id="Par37">All scripts, data, and detailed directions to run MetaNeighbor in R can be found on our Github page<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>. Accession codes for publicly available data analyzed in this study can be found in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Electronic supplementary material</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2018_3282_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2018_3282_MOESM2_ESM.pdf">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2018_3282_MOESM3_ESM.xlsx">
            <caption>
              <p>Supplementary Data 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2018_3282_MOESM4_ESM.xlsx">
            <caption>
              <p>Supplementary Data 2</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2018_3282_MOESM5_ESM.xlsx">
            <caption>
              <p>Supplementary Datat 3</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p><bold>Supplementary Information</bold> accompanies this paper at 10.1038/s41467-018-03282-0.</p>
    </fn>
    <fn>
      <p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>M.C. was supported by NIH F32MH114501 and a NARSAD Young Investigator Grant from the Brain &amp; Behavior Research Foundation. S.B. and J.G. were supported by NIH R01MH113005 and R01LM012736. Z.J.H. was supported by NIH 5R01MH094705-04, R01MH109665-01, and the CSHL Robertson Neuroscience Fund. A.P. was supported by a NARSAD Postdoctoral Fellowship. We thank Paul Pavlidis, Bo Li, and Jessica Tollkuhn for their thoughtful feedback on earlier drafts of this manuscript. We would also like to thank the dedicated researchers who have made their data publicly available. Our work would not be possible without their valuable contributions.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.G. conceived the study. J.G., M.C. and Z.J.H. designed experiments. M.C. and J.G. wrote the manuscript. M.C. and S.B. performed computational experiments. A.P. performed immunostaining. Z.J.H. supervised wet-lab data collection. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar1">
      <title>Competing interests</title>
      <p id="Par38">The authors declare no competing interests.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Treutlein</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>509</volume>
        <fpage>371</fpage>
        <lpage>375</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13173</pub-id>
        <?supplied-pmid 24739965?>
        <pub-id pub-id-type="pmid">24739965</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Wang, Y. J. et al. Single cell transcriptomics of the human endocrine pancreas. <italic>Diabetes</italic><bold>65</bold>, 3028–3030 (2016).</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>MauroJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptome atlas of the human pancreas</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>385</fpage>
        <lpage>394</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.09.002</pub-id>
        <?supplied-pmid 27693023?>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab.</source>
        <year>2016</year>
        <volume>24</volume>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id>
        <?supplied-pmid 27667667?>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals Inter- and Intra-cell population structure</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>346</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id>
        <?supplied-pmid 27667365?>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>166</volume>
        <fpage>1308</fpage>
        <lpage>1323</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.07.054</pub-id>
        <?supplied-pmid 27565351?>
        <pub-id pub-id-type="pmid">27565351</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grun</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>525</volume>
        <fpage>251</fpage>
        <lpage>255</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14966</pub-id>
        <?supplied-pmid 26287467?>
        <pub-id pub-id-type="pmid">26287467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Min</surname>
            <given-names>JW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of distinct tumor subpopulations in lung adenocarcinoma via single-cell RNA-seq</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <fpage>e0135817</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0135817</pub-id>
        <?supplied-pmid 26305796?>
        <pub-id pub-id-type="pmid">26305796</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1187</fpage>
        <lpage>1201</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.04.044</pub-id>
        <?supplied-pmid 26000487?>
        <pub-id pub-id-type="pmid">26000487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <fpage>1138</fpage>
        <lpage>1142</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id>
        <?supplied-pmid 25700174?>
        <pub-id pub-id-type="pmid">25700174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Habib</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Div-Seq: single-nucleus RNA-Seq reveals dynamics of rare adult newborn neurons</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>353</volume>
        <fpage>925</fpage>
        <lpage>928</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aad7038</pub-id>
        <?supplied-pmid 27471252?>
        <pub-id pub-id-type="pmid">27471252</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Hicks, S. C., Townes, F. W., Teng, M. &amp; Irizarry, R. A. Missing data and technical variability in single-cell RNA-sequencing experiments. Preprint available from:10.1093/biostatistics/kxx053 (2017).</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pierson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>ZIFA: dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>
        <source>Genome Biol.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>241</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0805-z</pub-id>
        <?supplied-pmid 26527291?>
        <pub-id pub-id-type="pmid">26527291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Bach</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>75</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0947-7</pub-id>
        <?supplied-pmid 27122128?>
        <pub-id pub-id-type="pmid">27122128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallejos</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>BASiCS: Bayesian analysis of Single-Cell sequencing data</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>e1004333</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004333</pub-id>
        <?supplied-pmid 26107944?>
        <pub-id pub-id-type="pmid">26107944</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>155</fpage>
        <lpage>160</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3102</pub-id>
        <?supplied-pmid 25599176?>
        <pub-id pub-id-type="pmid">25599176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ascoli</surname>
            <given-names>GA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Petilla terminology: nomenclature of features of GABAergic interneurons of the cerebral cortex</article-title>
        <source>Nat. Rev. Neurosci.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>557</fpage>
        <lpage>568</lpage>
        <pub-id pub-id-type="doi">10.1038/nrn2402</pub-id>
        <?supplied-pmid 18568015?>
        <pub-id pub-id-type="pmid">18568015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poulin</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Tasic</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hjerling-Leffler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Trimarchi</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Awatramani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Disentangling neural cell diversity using single-cell transcriptomics</article-title>
        <source>Nat. Neurosci.</source>
        <year>2016</year>
        <volume>19</volume>
        <fpage>1131</fpage>
        <lpage>1141</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.4366</pub-id>
        <?supplied-pmid 27571192?>
        <pub-id pub-id-type="pmid">27571192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tasic</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>
        <source>Nat. Neurosci.</source>
        <year>2016</year>
        <volume>19</volume>
        <fpage>335</fpage>
        <lpage>346</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.4216</pub-id>
        <?supplied-pmid 26727548?>
        <pub-id pub-id-type="pmid">26727548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular diversity of midbrain development in mouse, human, and stem cells</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>167</volume>
        <fpage>566</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.09.027</pub-id>
        <?supplied-pmid 27716510?>
        <pub-id pub-id-type="pmid">27716510</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Haghverdi, L., Lun, A. T. L., Morgan, M. D. &amp; Marioni, J. C. Correcting batch effects in single-cell RNA sequencing data by matching mutual nearest neighbours. Preprint available from: 10.1101/165118 (2017).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Butler, A. &amp; Satija, R. Integrated analysis of single cell transcriptomic data across conditions, technologies, and species. Preprint available from: 10.1101/164889 (2017).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warnat</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Eils</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Brors</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Cross-platform analysis of cancer microarray data improves gene expression based classification of phenotypes</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>265</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-265</pub-id>
        <?supplied-pmid 16271137?>
        <pub-id pub-id-type="pmid">16271137</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Parts</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Winn</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A bayesian framework to account for complex non-genetic factors in gene expression levels greatly increases power in eQTL studies</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1000770</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000770</pub-id>
        <?supplied-pmid 20463871?>
        <pub-id pub-id-type="pmid">20463871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sullivan</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>The psychiatric GWAS consortium: big science comes to psychiatry</article-title>
        <source>Neuron</source>
        <year>2010</year>
        <volume>68</volume>
        <fpage>182</fpage>
        <lpage>186</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2010.10.003</pub-id>
        <?supplied-pmid 20955924?>
        <pub-id pub-id-type="pmid">20955924</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nygaard</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Rødland</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Hovig</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Methods that remove batch effects while retaining group differences may lead to exaggerated confidence in downstream analyses</article-title>
        <source>Biostatistics</source>
        <year>2015</year>
        <volume>17</volume>
        <fpage>29</fpage>
        <lpage>39</lpage>
        <?supplied-pmid 26272994?>
        <pub-id pub-id-type="pmid">26272994</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fridlyand</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Comparison of discrimination methods for the classification of tumors using gene expression data</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>2002</year>
        <volume>97</volume>
        <fpage>77</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="doi">10.1198/016214502753479248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kapp</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Are clusters found in one dataset present in another dataset?</article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>9</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxj029</pub-id>
        <?supplied-pmid 16613834?>
        <pub-id pub-id-type="pmid">16613834</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sorlie</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Repeated observation of breast tumor subtypes in independent gene expression data sets</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>8418</fpage>
        <lpage>8423</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0932692100</pub-id>
        <?supplied-pmid 12829800?>
        <pub-id pub-id-type="pmid">12829800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kapp</surname>
            <given-names>AV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Discovery and validation of breast cancer subtypes</article-title>
        <source>BMC Genome</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>231</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-7-231</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Revealing the vectors of cellular identity with single-cell genomics</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>1145</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3711</pub-id>
        <?supplied-pmid 27824854?>
        <pub-id pub-id-type="pmid">27824854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brennecke</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1093</fpage>
        <lpage>1095</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2645</pub-id>
        <?supplied-pmid 24056876?>
        <pub-id pub-id-type="pmid">24056876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolodziejczyk</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>The technology and biology of single-cell RNA sequencing</article-title>
        <source>Mol. Cell</source>
        <year>2015</year>
        <volume>58</volume>
        <fpage>610</fpage>
        <lpage>620</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2015.04.005</pub-id>
        <?supplied-pmid 26000846?>
        <pub-id pub-id-type="pmid">26000846</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>JN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A molecular census of arcuate hypothalamus and median eminence cell types</article-title>
        <source>Nat. Neurosci.</source>
        <year>2017</year>
        <volume>20</volume>
        <fpage>484</fpage>
        <lpage>496</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.4495</pub-id>
        <?supplied-pmid 28166221?>
        <pub-id pub-id-type="pmid">28166221</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dueck</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep sequencing reveals cell-type-specific patterns of single-cell transcriptome variation</article-title>
        <source>Genome Biol.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>122</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0683-4</pub-id>
        <?supplied-pmid 26056000?>
        <pub-id pub-id-type="pmid">26056000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Usoskin</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unbiased classification of sensory neuron types by large-scale single-cell RNA sequencing</article-title>
        <source>Nat. Neurosci.</source>
        <year>2015</year>
        <volume>18</volume>
        <fpage>145</fpage>
        <lpage>153</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.3881</pub-id>
        <?supplied-pmid 25420068?>
        <pub-id pub-id-type="pmid">25420068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>CL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Somatosensory neuron types identified by high-coverage single-cell RNA-sequencing and functional heterogeneity</article-title>
        <source>Cell Res.</source>
        <year>2016</year>
        <volume>26</volume>
        <fpage>83</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="doi">10.1038/cr.2015.149</pub-id>
        <?supplied-pmid 26691752?>
        <pub-id pub-id-type="pmid">26691752</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fuzik</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integration of electrophysiological recordings with single-cell RNA-seq data identifies neuronal subtypes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>175</fpage>
        <lpage>183</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3443</pub-id>
        <?supplied-pmid 26689544?>
        <pub-id pub-id-type="pmid">26689544</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanchate</surname>
            <given-names>NK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics reveals receptor transformations during olfactory neurogenesis</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>350</volume>
        <fpage>1251</fpage>
        <lpage>1255</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aad2456</pub-id>
        <?supplied-pmid 26541607?>
        <pub-id pub-id-type="pmid">26541607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heimberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bhatnagar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>El-Samad</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Low dimensionality in gene expression data enables the accurate extraction of transcriptional programs from shallow sequencing</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>2</volume>
        <fpage>239</fpage>
        <lpage>250</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.04.001</pub-id>
        <?supplied-pmid 27135536?>
        <pub-id pub-id-type="pmid">27135536</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venet</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dumont</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Detours</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Most random gene expression signatures are significantly associated with breast cancer outcome</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1002240</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002240</pub-id>
        <?supplied-pmid 22028643?>
        <pub-id pub-id-type="pmid">22028643</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Foldy</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNAseq reveals cell adhesion molecule profiles in electrophysiologically defined neurons</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2016</year>
        <volume>113</volume>
        <fpage>E5222</fpage>
        <lpage>5231</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1610155113</pub-id>
        <?supplied-pmid 27531958?>
        <pub-id pub-id-type="pmid">27531958</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paul</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional architecture of synaptic communication delineates GABAergic neuron identity</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>522</fpage>
        <lpage>539</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.08.032</pub-id>
        <?supplied-pmid 28942923?>
        <pub-id pub-id-type="pmid">28942923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kluger</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lineage specificity of gene expression patterns</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2004</year>
        <volume>101</volume>
        <fpage>6508</fpage>
        <lpage>6513</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0401136101</pub-id>
        <?supplied-pmid 15096607?>
        <pub-id pub-id-type="pmid">15096607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Strategies and tools for combinatorial targeting of GABAergic Neurons in mouse cerebral cortex</article-title>
        <source>Neuron</source>
        <year>2016</year>
        <volume>91</volume>
        <fpage>1228</fpage>
        <lpage>1243</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2016.08.021</pub-id>
        <?supplied-pmid 27618674?>
        <pub-id pub-id-type="pmid">27618674</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single‐cell transcriptomes reveal characteristic features of human pancreatic islet cell types</article-title>
        <source>EMBO Rep.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>178</fpage>
        <lpage>187</lpage>
        <pub-id pub-id-type="doi">10.15252/embr.201540946</pub-id>
        <?supplied-pmid 26691212?>
        <pub-id pub-id-type="pmid">26691212</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xin</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA sequencing of single human islet cells reveals type 2 diabetes genes</article-title>
        <source>Cell. Metab.</source>
        <year>2016</year>
        <volume>24</volume>
        <fpage>608</fpage>
        <lpage>615</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.018</pub-id>
        <?supplied-pmid 27667665?>
        <pub-id pub-id-type="pmid">27667665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Using neural networks for reducing the dimensions of single-cell RNA-Seq data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>e156</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx681</pub-id>
        <?supplied-pmid 28973464?>
        <pub-id pub-id-type="pmid">28973464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Kiselev, V. Y. &amp; Hemberg, M. Scmap - a tool for unsupervised projection of single cell RNA-seq data. Preprint available from: 10.1101/150292 (2017).</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Welch</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Hartemink</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Prins</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>MATCHER: manifold alignment reveals correspondence between single cell transcriptome and epigenome dynamics</article-title>
        <source>Genome Biol.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>138</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1269-0</pub-id>
        <?supplied-pmid 28738873?>
        <pub-id pub-id-type="pmid">28738873</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The microarray quality control (MAQC)-II study of common practices for the development and validation of microarray-based predictive models</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>827</fpage>
        <lpage>838</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1665</pub-id>
        <?supplied-pmid 20676074?>
        <pub-id pub-id-type="pmid">20676074</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peña-Castillo</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A critical assessment of <italic>Mus musculus</italic> gene function prediction using integrated genomic evidence</article-title>
        <source>Genome Biol.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>S2</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-s1-s2</pub-id>
        <?supplied-pmid 18613946?>
        <pub-id pub-id-type="pmid">18613946</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ambaru</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Thakkar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marcotte</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Rhee</surname>
            <given-names>SY</given-names>
          </name>
        </person-group>
        <article-title>Rational association of genes with traits using a genome-scale gene network for <italic>Arabidopsis thaliana</italic></article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>149</fpage>
        <lpage>156</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1603</pub-id>
        <?supplied-pmid 20118918?>
        <pub-id pub-id-type="pmid">20118918</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <mixed-citation publication-type="other">Regev, A. et al. The human cell atlas. Preprint available from: 10.1101/121202 (2017).</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">MetaNeighbor: a method to rapidly assess cell type identity using both functional and random gene sets. <ext-link ext-link-type="uri" xlink:href="https://github.com/gillislab/MetaNeighbor">https://github.com/gillislab/MetaNeighbor</ext-link> (2017).</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ballouz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Verleyen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Gillis</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Guidance for RNA-seq co-expression network construction and analysis: safety in numbers</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>2123</fpage>
        <lpage>2130</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv118</pub-id>
        <?supplied-pmid 25717192?>
        <pub-id pub-id-type="pmid">25717192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Ballouz, S., Weber, M., Pavlidis, P. &amp; Gillis, J. EGAD: ultra-fast functional analysis of gene networks. <italic>Bioinformatics</italic> <bold>33</bold>, 612-614 (2016).</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Fisher, R. A. <italic>Statistical Methods for Research Workers</italic> (Oliver and Boyd, 1925).</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J. R. Stat. Soc. Ser. B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
