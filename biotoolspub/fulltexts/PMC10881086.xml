<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10881086</article-id>
    <article-id pub-id-type="pmid">38366652</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae072</article-id>
    <article-id pub-id-type="publisher-id">btae072</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SpatialDDLS: an R package to deconvolute spatial transcriptomics data using neural networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mañanes</surname>
          <given-names>Diego</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rivero-García</surname>
          <given-names>Inés</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
        <aff><institution>Departamento de Ingeniería Biomédica, ETSI de Telecomunicaciones, Universidad Politécnica de Madrid</institution>, 28040 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Relaño</surname>
          <given-names>Carlos</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Torres</surname>
          <given-names>Miguel</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sancho</surname>
          <given-names>David</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jimenez-Carretero</surname>
          <given-names>Daniel</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Torroja</surname>
          <given-names>Carlos</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1881-1664</contrib-id>
        <name>
          <surname>Sánchez-Cabo</surname>
          <given-names>Fátima</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
        <xref rid="btae072-cor1" ref-type="corresp"/>
        <!--fscabo@cnic.es-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae072-cor1">Corresponding author. Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC), 28029 Madrid, Spain. E-mail: <email>fscabo@cnic.es</email> (F.S-.C.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-02-15">
      <day>15</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>2</issue>
    <elocation-id>btae072</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>31</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae072.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Spatial transcriptomics has changed our way to study tissue structure and cellular organization. However, there are still limitations in its resolution, and most available platforms do not reach a single cell resolution. To address this issue, we introduce SpatialDDLS, a fast neural network-based algorithm for cell type deconvolution of spatial transcriptomics data. SpatialDDLS leverages single-cell RNA sequencing data to simulate mixed transcriptional profiles with predefined cellular composition, which are subsequently used to train a fully connected neural network to uncover cell type diversity within each spot. By comparing it with two state-of-the-art spatial deconvolution methods, we demonstrate that SpatialDDLS is an accurate and fast alternative to the available state-of-the art tools.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The R package SpatialDDLS is available via CRAN-The Comprehensive R Archive Network: <ext-link xlink:href="https://CRAN.R-project.org/package=SpatialDDLS" ext-link-type="uri">https://CRAN.R-project.org/package=SpatialDDLS</ext-link>. A detailed manual of the main functionalities implemented in the package can be found at <ext-link xlink:href="https://diegommcc.github.io/SpatialDDLS" ext-link-type="uri">https://diegommcc.github.io/SpatialDDLS</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Instituto de Salud Carlos III</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004587</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ministerio de Ciencia e Innovación</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004837</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Pro CNIC Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Severo Ochoa Center of Excellence</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell omics have represented one of the main technological advances toward the understanding of physiological and pathological states. However, the spatial context and location of cells are key elements with functional relevance that are missing with these techniques. In the last few years, spatial transcriptomics (ST) have revolutionized our ability to investigate biological processes by providing an unbiased way to understand tissue structure, cellular interaction, and function. Rather than studying cells as isolated and independent entities, it incorporates context through the spatial dimension while preserving the powerful information provided by whole transcriptome sequencing. However, due to the limitations of most available techniques, which fail to achieve single-cell resolution, computational methods are needed to identify the precise combination of cells within each spot. Deconvolution methods have been previously applied to bulk RNA-seq data in order to disentangle the cellular composition of samples from whole tissues or organs (<xref rid="btae072-B3" ref-type="bibr">Avila Cobos <italic toggle="yes">et al.</italic> 2018</xref>). For example, being able to quantify the different types of infiltrated lymphocytes in a given tumor starting from RNA-seq of the whole sample can serve as a very accurate method to predict the time-to-death from colorectal or breast cancer patients (<xref rid="btae072-B17" ref-type="bibr">Torroja and Sanchez-Cabo 2019</xref>). A natural extension of these methods is to apply them to deconvolute the transcriptomics data from each sequenced spot in ST data to estimate their exact cellular composition. There is a broad spectrum of tools which follow different approaches to solve this problem (<xref rid="btae072-B8" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2022</xref>), but most utilize single-cell RNA-seq (scRNA-seq) datasets from the same biological context as references, thereby addressing the issue as a supervised task. However, they usually rely on predefined markers defined either manually or through differential expression analysis, and typically have long running times that pose challenges for their practical application (<xref rid="btae072-B8" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    <p>In this work, we introduce SpatialDDLS, an R package that provides a fast neural network-based solution for cell type deconvolution of spatial transcriptomics data. The algorithm employs scRNA-seq data to simulate mixed transcriptional profiles with known cell composition, with which a deep neural network (NN) is trained with the aim to uncover cell type diversity within each spot (<xref rid="btae072-F1" ref-type="fig">Fig. 1</xref>). In contrast to other methods which are computationally intensive and rely on a predefined and biased set of cell type markers, SpatialDDLS does not require the definition of cell identity signatures and has a lightweight computational processing. To demonstrate its performance and efficiency, we have benchmarked our tool against two state-of-the-art spatial deconvolution methods in five ST datasets, three of which containing single-cell resolution and thus allowing a quantitative comparison. SpatialDDLS’ predictions reproduced known cell type location patterns and yielded similar results while requiring unexpensive computational resources compared to other methods, thereby making it a competitive alternative to already available tools.</p>
    <fig position="float" id="btae072-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Schematic overview of SpatialDDLS. SpatialDDLS takes both an annotated single-cell RNA-seq dataset to be used as reference, and the spatial transcriptomics datasets to be deconvoluted. Then, it simulates mixed transcriptional profiles with known cell composition and trains a fully connected neural network able to make accurate predictions of cell type proportions. These predictions are adapted based on the spatial context of every spot (spatial regularization) and can be used for further analyses.</p>
      </caption>
      <graphic xlink:href="btae072f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>2 SpatialDDLS</title>
    <p>SpatialDDLS is an extension of our deconvolution tool for bulk RNA-seq (<xref rid="btae072-B17" ref-type="bibr">Torroja and Sanchez-Cabo 2019</xref>) implemented in the open-source R package digitalDLSorteR (<xref rid="btae072-B11" ref-type="bibr">Mañanes <italic toggle="yes">et al.</italic> 2022</xref>). The algorithm uses scRNA-seq to simulate mixed transcriptional profiles for training neural network models capable of estimating the cell proportions of new mixed transcriptional profiles typically present in ST data. It consists of four main steps (<xref rid="btae072-F1" ref-type="fig">Fig. 1</xref>):</p>
    <list list-type="order">
      <list-item>
        <p>Simulation of mixed transcriptional profiles with known cellular proportions. SpatialDDLS begins by using a pre-identified scRNA-seq dataset that is partitioned into training and test cell subsets. Then, cell proportions are simulated from each labeled subset of cells, and training and test mixed transcriptional profiles are generated.</p>
      </list-item>
      <list-item>
        <p>NN training and evaluation. A NN model is trained and evaluated using the simulated mixed profiles. Thanks to the inclusion of a test subset, this workflow allows for an assessment of whether the model is correctly identifying the transcriptional features of every cell type considered in the reference.</p>
      </list-item>
      <list-item>
        <p>Deconvolution and spatial regularization. The trained model is then used to predict the cell composition of two sets of ST profiles:</p>
        <list list-type="bullet">
          <list-item>
            <p><underline>Intrinsic profiles</underline>: actual transcriptional profiles of each spot to be deconvoluted.</p>
          </list-item>
          <list-item>
            <p><underline>Extrinsic profiles</underline>: simulated profiles generated from the k-nearest spots of every spot. This set of samples represents the transcriptional profile of the surroundings of each spot.</p>
            <p>The latter are used to spatially regularize the original predicted proportions by considering how similar each intrinsic profile is to its extrinsic counterpart (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9a–c</xref>). This procedure assumes that cell composition/transcriptional status of every spot is influenced by its location in a tissue, and thus there is some continuity in the transcriptional profiles of neighboring spots. Consequently, this step is optional depending on the particularities of the ST dataset being analyzed, as there might be situations in which this assumption is not met.</p>
          </list-item>
        </list>
      </list-item>
      <list-item>
        <p>Optionally, and to facilitate downstream analyses, SpatialDDLS provides a module for NN interpretation based on gradients (<xref rid="btae072-B16" ref-type="bibr">Simonyan <italic toggle="yes">et al.</italic> 2014</xref>), which allows to gain insights into the decision-making process of the model (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10a–d</xref>), and a module for clustering based on predicted cell proportions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10e</xref>).</p>
      </list-item>
    </list>
    <p>All these steps are implemented using the S4 object-oriented programming system of R to centralize all intermediate data generated during the workflow, making the process completely transparent and providing a user-friendly usage. Regarding its implementation, SpatialDDLS makes use of the keras (<xref rid="btae072-B1" ref-type="bibr">Allaire and Chollet 2021</xref>) and tensorflow (<xref rid="btae072-B2" ref-type="bibr">Allaire and Tang 2021</xref>) R packages for all NN-related tasks, and S4-classes from the Bioconductor’s environment (<xref rid="btae072-B6" ref-type="bibr">Huber <italic toggle="yes">et al.</italic> 2015</xref>) for the storage of gene expression matrices (scRNA-seq and ST). Therefore, it can be entirely integrated into the typical workflow used for analyzing transcriptomics data in R. In addition, it offers the possibility to work with The Hierarchical Data Format version 5 (HDF5) files as back-end by using the DelayedArray (<xref rid="btae072-B13" ref-type="bibr">Pagès 2021a</xref>) and HDF5Array (<xref rid="btae072-B14" ref-type="bibr">Pagès 2021b</xref>) R packages to provide a way to handle large amounts of data on RAM-constrained machines. For a detailed explanation of each step with code and examples, see the website of the package (<ext-link xlink:href="https://diegommcc.github.io/SpatialDDLS" ext-link-type="uri">https://diegommcc.github.io/SpatialDDLS</ext-link>).</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>To evaluate its performance, we benchmarked SpatialDDLS against two state-of-the-art methods in the spatial transcriptomics field: cell2location (<xref rid="btae072-B7" ref-type="bibr">Kleshchevnikov <italic toggle="yes">et al.</italic> 2022</xref>) and RCTD (<xref rid="btae072-B4" ref-type="bibr">Cable <italic toggle="yes">et al.</italic> 2022</xref>). We chose these tools because of their superior performance in different recently published benchmarks (<xref rid="btae072-B8" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btae072-B9" ref-type="bibr">2023</xref>, <xref rid="btae072-B19" ref-type="bibr">Yan and Sun 2023</xref>). First, we analyzed two ST datasets from tissues with clear spatial cell type-distribution patterns: mouse hippocampus (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1a</xref>) (<xref rid="btae072-B15" ref-type="bibr">Saunders <italic toggle="yes">et al.</italic> 2018</xref>) and mouse lymph node (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3a</xref>) (<xref rid="btae072-B10" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic> 2022</xref>). SpatialDDLS obtained excellent results in mixed transcriptional profiles simulated from every experiment [mean PCC = 0.97 (Pearson’s correlation coefficient) and mean CCC = 0.97 (concordance correlation coefficient) for mouse hippocampus; and mean PCC = 0.99 and mean CCC = 0.98 for mouse lymph node; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1b and S3b</xref>, respectively], indicating that the trained NN models were able to effectively detect biological signals for every cell type. Next, we compared the predictions from each method by calculating the PCC between them at the cell type level. SpatialDDLS made similar predictions to those of cell2location and RCTD, demonstrating a high PCC for the most abundant cell types of each tissue (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1c and S3c</xref>). In addition, the three tools showed similar spatial patterns of cell type proportions that indeed co-localized with the expression of their markers (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S2 and S4</xref>).</p>
    <p>Then, to perform a quantitative comparison among SpatialDDLS, cell2location and RCTD, we decided to analyze three single-cell resolution ST datasets simulating spots with a mixture of cell types by binning neighboring cells: seqFISH (<xref rid="btae072-B5" ref-type="bibr">Eng <italic toggle="yes">et al.</italic> 2019</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5a</xref>), STARmap (<xref rid="btae072-B18" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2018</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6a</xref>), and MERFISH (<xref rid="btae072-B12" ref-type="bibr">Moffitt <italic toggle="yes">et al.</italic> 2018</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7a</xref>). The three methods yielded highly comparable predictions for the predominant cell types in each dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5b, S6b, and S7b</xref>), although some differences were observed for specific cell types. For instance, SpatialDDLS outperformed cell2location and RCTD at predicting the most important cell types in the mouse neo-cortex samples (STARmap and seqFISH datasets): the excitatory L2/L3, L4, L5, and L6 neurons (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5b and c, S6b and c, and S8b</xref>). Indeed, its overall performance for these datasets was superior according to CCC and JSD evaluation metrics (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8a</xref>), although not reflected in PCC and RMSE, the latter being better only for STARmap. Nevertheless, we believe that CCC is a more reliable metric for evaluating this problem, as it considers not only the linear relationship between two variables but also their distance to the identity (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). Altogether, the results across all datasets were comparable among the three methods, showcasing a high level of agreement. Nonetheless, specific tendencies were observed, making their predictions complementary to each other for a better understanding of the structure of the tissue under study. In contrast to other methods, SpatialDDLS offers interpretability to predicted cell proportions by reporting gradient-based gene scores that highlight important genes for the predictions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>). In dditiona, it incorporates functionalities that might help to understand structural features of tissues, such as visualizing distances between extrinsic and intrinsic spots to explore the spatial consistency of each region at the transcriptional level (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9b</xref>).</p>
    <p>Finally, we evaluated the performance of each method at the computational level (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8c</xref>). While both SpatialDDLS and RCTD demonstrated comparable running times across all datasets, cell2location exhibited the longest durations. On the other hand, in terms of RAM consumption, cell2location was superior in performance to SpatialDDLS and RCTD. It is important to note that SpatialDDLS allocates all intermediate steps generated during the deconvolution process in order to let users explore them, although this may be dispensable if memory optimization is prioritized.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>SpatialDDLS is a flexible spatial deconvolution tool of easy use and fully integrated in the R/Bioconductor ecosystem. We have demonstrated that it generates comparable results to those of two state-of-the-art methods while uses unexpensive computational resources that allow its implementation in the regular workflow for ST data analysis. In addition, SpatialDDLS does not need the definition of a set of markers for each cell type and performs whole-transcriptome predictions. We think that this fact can be useful in the context of paired scRNA-seq and ST datasets, as SpatialDDLS could account for specific transcriptional features that cell types may undergo depending on the biological context. Finally, even though the algorithm is based on NN models, SpatialDDLS makes the deconvolution process quite transparent thanks to two features: when a model is trained, it allows the users to check out whether every cell type is being correctly detected in simulated samples (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1b and S3b</xref>); and by making use of gradient-based interpretation techniques, SpatialDDLS integrates functions that allow to gain insights into the model’s decision-making process (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10a–d</xref>). Overall, these features make SpatialDDLS a robust alternative to existing methods that might be useful for the field.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae072_Supplementary_Data</label>
      <media xlink:href="btae072_supplementary_data.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank the Bioinformatics Unit for the support and the insightful discussions about the project.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>The CNIC was supported by the Instituto de Salud Carlos III (ISCIII), the Ministerio de Ciencia e Innovación (MCIN) and the Pro CNIC Foundation, and is a Severo Ochoa Center of Excellence [CEX2020-001041-S funded by MICIN/AEI/10.13039/501100011033]. F.S.-C. received funding [RTI2018-102084-B-I00 and PID2022-141527OB-I00] by the MCIN/AEI/10.13039/501100011033/and by FEDER Una manera de hacer Europa. C.T. and C.R. received funding [TED2021-132296B-C54] from MCIN/AEI/10.13039/501100011033 and by European Union NextGenerationEU/PRTR. D.M. was supported by a predoctoral grant from the Spanish Government [PRE2020-092578 MCIN/AEI/10.13039/501100011033]. I.R.-G. received the support of a fellowship from “la Caixa” Foundation [100010434, fellowship code: LCF/BQ/DR20/11790019].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>No new data were generated or analysed in support of this research.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae072-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Allaire</surname><given-names>J</given-names></string-name>, <string-name><surname>Chollet</surname><given-names>F.</given-names></string-name></person-group><italic toggle="yes">Package Keras. R Package Available at CRAN</italic>. <year>2021</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=keras" ext-link-type="uri">https://CRAN.R-project.org/package=keras</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae072-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Allaire</surname><given-names>J</given-names></string-name>, <string-name><surname>Tang</surname><given-names>Y.</given-names></string-name></person-group><italic toggle="yes">Package Tensorflow. R Package Available at CRAN</italic>. <year>2021</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=tensorflow" ext-link-type="uri">https://CRAN.R-project.org/package=tensorflow</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae072-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Avila Cobos</surname><given-names>F</given-names></string-name>, <string-name><surname>Vandesompele</surname><given-names>J</given-names></string-name>, <string-name><surname>Mestdagh</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Computational deconvolution of transcriptomics data from mixed cell populations</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>1969</fpage>–<lpage>79</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty019</pub-id><pub-id pub-id-type="pmid">29351586</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cable</surname><given-names>DM</given-names></string-name>, <string-name><surname>Murray</surname><given-names>E</given-names></string-name>, <string-name><surname>Zou</surname><given-names>LS</given-names></string-name></person-group><etal>et al</etal><article-title>Robust decomposition of cell type mixtures in spatial transcriptomics</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>517</fpage>–<lpage>26</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-021-00830-w</pub-id><pub-id pub-id-type="pmid">33603203</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eng</surname><given-names>C-HL</given-names></string-name>, <string-name><surname>Lawson</surname><given-names>M</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q</given-names></string-name></person-group><etal>et al</etal><article-title>Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH+</article-title>. <source>Nature</source><year>2019</year>;<volume>568</volume>:<fpage>235</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-019-1049-y</pub-id><pub-id pub-id-type="pmid">30911168</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huber</surname><given-names>W</given-names></string-name>, <string-name><surname>Carey</surname><given-names>VJ</given-names></string-name>, <string-name><surname>Gentleman</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>. <source>Nat Methods</source><year>2015</year>;<volume>12</volume>:<fpage>115</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3252</pub-id><pub-id pub-id-type="pmid">25633503</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kleshchevnikov</surname><given-names>V</given-names></string-name>, <string-name><surname>Shmatko</surname><given-names>A</given-names></string-name>, <string-name><surname>Dann</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Cell2location maps fine-grained cell types in spatial transcriptomics</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>661</fpage>–<lpage>71</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-021-01139-4</pub-id><pub-id pub-id-type="pmid">35027729</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>W</given-names></string-name>, <string-name><surname>Guo</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Benchmarking spatial and single-cell transcriptomics integration methods for transcript distribution prediction and cell type deconvolution</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>662</fpage>–<lpage>70</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-022-01480-9</pub-id><pub-id pub-id-type="pmid">35577954</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>A comprehensive benchmarking with practical guidelines for cellular deconvolution of spatial transcriptomics</article-title>. <source>Nat Commun</source><year>2023</year>;<volume>14</volume>:<fpage>1548</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-023-37168-7</pub-id><pub-id pub-id-type="pmid">36941264</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Keren-Shaul</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>DestVI identifies continuums of cell types in spatial transcriptomics data</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>1360</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-022-01272-8</pub-id><pub-id pub-id-type="pmid">35449415</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Mañanes</surname><given-names>D</given-names></string-name>, <string-name><surname>Torroja</surname><given-names>C</given-names></string-name>, <string-name><surname>Sánchez-Cabo</surname><given-names>F.</given-names></string-name></person-group><italic toggle="yes">digitalDLSorteR: Deconvolution of Bulk RNA-Seq Data Based on Deep Learning. R Package Available at CRAN</italic>. <year>2022</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=digitalDLSorteR" ext-link-type="uri">https://CRAN.R-project.org/package=digitalDLSorteR</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae072-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moffitt</surname><given-names>JR</given-names></string-name>, <string-name><surname>Bambah-Mukku</surname><given-names>D</given-names></string-name>, <string-name><surname>Eichhorn</surname><given-names>SW</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular, spatial, and functional single-cell profiling of the hypothalamic preoptic region</article-title>. <source>Science</source><year>2018</year>;<volume>362</volume>:<fpage>eaau5324</fpage>. <pub-id pub-id-type="doi">10.1126/science.aau5324</pub-id><pub-id pub-id-type="pmid">30385464</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Pagès</surname><given-names>H.</given-names></string-name></person-group><italic toggle="yes">DelayedArray: A Unified Framework for Working Transparently with On-Disk and In-Memory Array-Like Datasets. R Package Available at CRAN</italic>. <year>2021a</year>. <pub-id pub-id-type="doi">10.18129/B9.bioc.DelayedArray</pub-id>.</mixed-citation>
    </ref>
    <ref id="btae072-B14">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Pagès</surname><given-names>H.</given-names></string-name></person-group><italic toggle="yes">HDF5Array: HDF5 Backend for DelayedArray Objects. R Package Available at CRAN</italic>. <year>2021b</year>. <pub-id pub-id-type="doi">10.18129/B9.bioc.HDF5Array</pub-id>.</mixed-citation>
    </ref>
    <ref id="btae072-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saunders</surname><given-names>A</given-names></string-name>, <string-name><surname>Macosko</surname><given-names>EZ</given-names></string-name>, <string-name><surname>Wysoker</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular diversity and specializations among the cells of the adult mouse brain</article-title>. <source>Cell</source><year>2018</year>;<volume>174</volume>:<fpage>1015</fpage>–<lpage>30.e16</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2018.07.028</pub-id><pub-id pub-id-type="pmid">30096299</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Simonyan</surname><given-names>K</given-names></string-name>, <string-name><surname>Vedaldi</surname><given-names>A</given-names></string-name>, <string-name><surname>Zisserman</surname><given-names>A.</given-names></string-name></person-group><italic toggle="yes">Deep Inside Convolutional Networks: Visualising Image Classification Models and Saliency Maps</italic>. arXiv preprint arXiv:1312.6034 <year>2014</year>. <pub-id pub-id-type="doi">10.48550/arXiv.1312.6034</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Torroja</surname><given-names>C</given-names></string-name>, <string-name><surname>Sanchez-Cabo</surname><given-names>F.</given-names></string-name></person-group><article-title>Digitaldlsorter: deep-learning on scRNA-Seq to deconvolute gene expression data</article-title>. <source>Front Genet</source><year>2019</year>;<volume>10</volume>:<fpage>1373</fpage>.<pub-id pub-id-type="pmid">32117421</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <string-name><surname>Allen</surname><given-names>WE</given-names></string-name>, <string-name><surname>Wright</surname><given-names>MA</given-names></string-name></person-group><etal>et al</etal><article-title>Three-dimensional intact-tissue sequencing of single-cell transcriptional states</article-title>. <source>Science</source><year>2018</year>;<volume>361</volume>:<fpage>eaat5691</fpage>. <pub-id pub-id-type="doi">10.1126/science.aat5691</pub-id><pub-id pub-id-type="pmid">29930089</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yan</surname><given-names>L</given-names></string-name>, <string-name><surname>Sun</surname><given-names>X.</given-names></string-name></person-group><article-title>Benchmarking and integration of methods for deconvoluting spatial transcriptomic data</article-title>. <source>Bioinformatics</source><year>2023</year>;<volume>39</volume>:<fpage>btac805</fpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btac805</pub-id><pub-id pub-id-type="pmid">36515467</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10881086</article-id>
    <article-id pub-id-type="pmid">38366652</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae072</article-id>
    <article-id pub-id-type="publisher-id">btae072</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SpatialDDLS: an R package to deconvolute spatial transcriptomics data using neural networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mañanes</surname>
          <given-names>Diego</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rivero-García</surname>
          <given-names>Inés</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
        <aff><institution>Departamento de Ingeniería Biomédica, ETSI de Telecomunicaciones, Universidad Politécnica de Madrid</institution>, 28040 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Relaño</surname>
          <given-names>Carlos</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Torres</surname>
          <given-names>Miguel</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sancho</surname>
          <given-names>David</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jimenez-Carretero</surname>
          <given-names>Daniel</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Torroja</surname>
          <given-names>Carlos</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1881-1664</contrib-id>
        <name>
          <surname>Sánchez-Cabo</surname>
          <given-names>Fátima</given-names>
        </name>
        <aff><institution>Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC)</institution>, 28029 Madrid, <country country="ES">Spain</country></aff>
        <xref rid="btae072-cor1" ref-type="corresp"/>
        <!--fscabo@cnic.es-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae072-cor1">Corresponding author. Centro Nacional de Investigaciones Cardiovasculares Carlos III (CNIC), 28029 Madrid, Spain. E-mail: <email>fscabo@cnic.es</email> (F.S-.C.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-02-15">
      <day>15</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>2</issue>
    <elocation-id>btae072</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>31</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae072.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Spatial transcriptomics has changed our way to study tissue structure and cellular organization. However, there are still limitations in its resolution, and most available platforms do not reach a single cell resolution. To address this issue, we introduce SpatialDDLS, a fast neural network-based algorithm for cell type deconvolution of spatial transcriptomics data. SpatialDDLS leverages single-cell RNA sequencing data to simulate mixed transcriptional profiles with predefined cellular composition, which are subsequently used to train a fully connected neural network to uncover cell type diversity within each spot. By comparing it with two state-of-the-art spatial deconvolution methods, we demonstrate that SpatialDDLS is an accurate and fast alternative to the available state-of-the art tools.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The R package SpatialDDLS is available via CRAN-The Comprehensive R Archive Network: <ext-link xlink:href="https://CRAN.R-project.org/package=SpatialDDLS" ext-link-type="uri">https://CRAN.R-project.org/package=SpatialDDLS</ext-link>. A detailed manual of the main functionalities implemented in the package can be found at <ext-link xlink:href="https://diegommcc.github.io/SpatialDDLS" ext-link-type="uri">https://diegommcc.github.io/SpatialDDLS</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Instituto de Salud Carlos III</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004587</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ministerio de Ciencia e Innovación</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004837</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Pro CNIC Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Severo Ochoa Center of Excellence</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell omics have represented one of the main technological advances toward the understanding of physiological and pathological states. However, the spatial context and location of cells are key elements with functional relevance that are missing with these techniques. In the last few years, spatial transcriptomics (ST) have revolutionized our ability to investigate biological processes by providing an unbiased way to understand tissue structure, cellular interaction, and function. Rather than studying cells as isolated and independent entities, it incorporates context through the spatial dimension while preserving the powerful information provided by whole transcriptome sequencing. However, due to the limitations of most available techniques, which fail to achieve single-cell resolution, computational methods are needed to identify the precise combination of cells within each spot. Deconvolution methods have been previously applied to bulk RNA-seq data in order to disentangle the cellular composition of samples from whole tissues or organs (<xref rid="btae072-B3" ref-type="bibr">Avila Cobos <italic toggle="yes">et al.</italic> 2018</xref>). For example, being able to quantify the different types of infiltrated lymphocytes in a given tumor starting from RNA-seq of the whole sample can serve as a very accurate method to predict the time-to-death from colorectal or breast cancer patients (<xref rid="btae072-B17" ref-type="bibr">Torroja and Sanchez-Cabo 2019</xref>). A natural extension of these methods is to apply them to deconvolute the transcriptomics data from each sequenced spot in ST data to estimate their exact cellular composition. There is a broad spectrum of tools which follow different approaches to solve this problem (<xref rid="btae072-B8" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2022</xref>), but most utilize single-cell RNA-seq (scRNA-seq) datasets from the same biological context as references, thereby addressing the issue as a supervised task. However, they usually rely on predefined markers defined either manually or through differential expression analysis, and typically have long running times that pose challenges for their practical application (<xref rid="btae072-B8" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    <p>In this work, we introduce SpatialDDLS, an R package that provides a fast neural network-based solution for cell type deconvolution of spatial transcriptomics data. The algorithm employs scRNA-seq data to simulate mixed transcriptional profiles with known cell composition, with which a deep neural network (NN) is trained with the aim to uncover cell type diversity within each spot (<xref rid="btae072-F1" ref-type="fig">Fig. 1</xref>). In contrast to other methods which are computationally intensive and rely on a predefined and biased set of cell type markers, SpatialDDLS does not require the definition of cell identity signatures and has a lightweight computational processing. To demonstrate its performance and efficiency, we have benchmarked our tool against two state-of-the-art spatial deconvolution methods in five ST datasets, three of which containing single-cell resolution and thus allowing a quantitative comparison. SpatialDDLS’ predictions reproduced known cell type location patterns and yielded similar results while requiring unexpensive computational resources compared to other methods, thereby making it a competitive alternative to already available tools.</p>
    <fig position="float" id="btae072-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Schematic overview of SpatialDDLS. SpatialDDLS takes both an annotated single-cell RNA-seq dataset to be used as reference, and the spatial transcriptomics datasets to be deconvoluted. Then, it simulates mixed transcriptional profiles with known cell composition and trains a fully connected neural network able to make accurate predictions of cell type proportions. These predictions are adapted based on the spatial context of every spot (spatial regularization) and can be used for further analyses.</p>
      </caption>
      <graphic xlink:href="btae072f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>2 SpatialDDLS</title>
    <p>SpatialDDLS is an extension of our deconvolution tool for bulk RNA-seq (<xref rid="btae072-B17" ref-type="bibr">Torroja and Sanchez-Cabo 2019</xref>) implemented in the open-source R package digitalDLSorteR (<xref rid="btae072-B11" ref-type="bibr">Mañanes <italic toggle="yes">et al.</italic> 2022</xref>). The algorithm uses scRNA-seq to simulate mixed transcriptional profiles for training neural network models capable of estimating the cell proportions of new mixed transcriptional profiles typically present in ST data. It consists of four main steps (<xref rid="btae072-F1" ref-type="fig">Fig. 1</xref>):</p>
    <list list-type="order">
      <list-item>
        <p>Simulation of mixed transcriptional profiles with known cellular proportions. SpatialDDLS begins by using a pre-identified scRNA-seq dataset that is partitioned into training and test cell subsets. Then, cell proportions are simulated from each labeled subset of cells, and training and test mixed transcriptional profiles are generated.</p>
      </list-item>
      <list-item>
        <p>NN training and evaluation. A NN model is trained and evaluated using the simulated mixed profiles. Thanks to the inclusion of a test subset, this workflow allows for an assessment of whether the model is correctly identifying the transcriptional features of every cell type considered in the reference.</p>
      </list-item>
      <list-item>
        <p>Deconvolution and spatial regularization. The trained model is then used to predict the cell composition of two sets of ST profiles:</p>
        <list list-type="bullet">
          <list-item>
            <p><underline>Intrinsic profiles</underline>: actual transcriptional profiles of each spot to be deconvoluted.</p>
          </list-item>
          <list-item>
            <p><underline>Extrinsic profiles</underline>: simulated profiles generated from the k-nearest spots of every spot. This set of samples represents the transcriptional profile of the surroundings of each spot.</p>
            <p>The latter are used to spatially regularize the original predicted proportions by considering how similar each intrinsic profile is to its extrinsic counterpart (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9a–c</xref>). This procedure assumes that cell composition/transcriptional status of every spot is influenced by its location in a tissue, and thus there is some continuity in the transcriptional profiles of neighboring spots. Consequently, this step is optional depending on the particularities of the ST dataset being analyzed, as there might be situations in which this assumption is not met.</p>
          </list-item>
        </list>
      </list-item>
      <list-item>
        <p>Optionally, and to facilitate downstream analyses, SpatialDDLS provides a module for NN interpretation based on gradients (<xref rid="btae072-B16" ref-type="bibr">Simonyan <italic toggle="yes">et al.</italic> 2014</xref>), which allows to gain insights into the decision-making process of the model (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10a–d</xref>), and a module for clustering based on predicted cell proportions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10e</xref>).</p>
      </list-item>
    </list>
    <p>All these steps are implemented using the S4 object-oriented programming system of R to centralize all intermediate data generated during the workflow, making the process completely transparent and providing a user-friendly usage. Regarding its implementation, SpatialDDLS makes use of the keras (<xref rid="btae072-B1" ref-type="bibr">Allaire and Chollet 2021</xref>) and tensorflow (<xref rid="btae072-B2" ref-type="bibr">Allaire and Tang 2021</xref>) R packages for all NN-related tasks, and S4-classes from the Bioconductor’s environment (<xref rid="btae072-B6" ref-type="bibr">Huber <italic toggle="yes">et al.</italic> 2015</xref>) for the storage of gene expression matrices (scRNA-seq and ST). Therefore, it can be entirely integrated into the typical workflow used for analyzing transcriptomics data in R. In addition, it offers the possibility to work with The Hierarchical Data Format version 5 (HDF5) files as back-end by using the DelayedArray (<xref rid="btae072-B13" ref-type="bibr">Pagès 2021a</xref>) and HDF5Array (<xref rid="btae072-B14" ref-type="bibr">Pagès 2021b</xref>) R packages to provide a way to handle large amounts of data on RAM-constrained machines. For a detailed explanation of each step with code and examples, see the website of the package (<ext-link xlink:href="https://diegommcc.github.io/SpatialDDLS" ext-link-type="uri">https://diegommcc.github.io/SpatialDDLS</ext-link>).</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>To evaluate its performance, we benchmarked SpatialDDLS against two state-of-the-art methods in the spatial transcriptomics field: cell2location (<xref rid="btae072-B7" ref-type="bibr">Kleshchevnikov <italic toggle="yes">et al.</italic> 2022</xref>) and RCTD (<xref rid="btae072-B4" ref-type="bibr">Cable <italic toggle="yes">et al.</italic> 2022</xref>). We chose these tools because of their superior performance in different recently published benchmarks (<xref rid="btae072-B8" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btae072-B9" ref-type="bibr">2023</xref>, <xref rid="btae072-B19" ref-type="bibr">Yan and Sun 2023</xref>). First, we analyzed two ST datasets from tissues with clear spatial cell type-distribution patterns: mouse hippocampus (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1a</xref>) (<xref rid="btae072-B15" ref-type="bibr">Saunders <italic toggle="yes">et al.</italic> 2018</xref>) and mouse lymph node (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3a</xref>) (<xref rid="btae072-B10" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic> 2022</xref>). SpatialDDLS obtained excellent results in mixed transcriptional profiles simulated from every experiment [mean PCC = 0.97 (Pearson’s correlation coefficient) and mean CCC = 0.97 (concordance correlation coefficient) for mouse hippocampus; and mean PCC = 0.99 and mean CCC = 0.98 for mouse lymph node; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1b and S3b</xref>, respectively], indicating that the trained NN models were able to effectively detect biological signals for every cell type. Next, we compared the predictions from each method by calculating the PCC between them at the cell type level. SpatialDDLS made similar predictions to those of cell2location and RCTD, demonstrating a high PCC for the most abundant cell types of each tissue (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1c and S3c</xref>). In addition, the three tools showed similar spatial patterns of cell type proportions that indeed co-localized with the expression of their markers (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S2 and S4</xref>).</p>
    <p>Then, to perform a quantitative comparison among SpatialDDLS, cell2location and RCTD, we decided to analyze three single-cell resolution ST datasets simulating spots with a mixture of cell types by binning neighboring cells: seqFISH (<xref rid="btae072-B5" ref-type="bibr">Eng <italic toggle="yes">et al.</italic> 2019</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5a</xref>), STARmap (<xref rid="btae072-B18" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2018</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6a</xref>), and MERFISH (<xref rid="btae072-B12" ref-type="bibr">Moffitt <italic toggle="yes">et al.</italic> 2018</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7a</xref>). The three methods yielded highly comparable predictions for the predominant cell types in each dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5b, S6b, and S7b</xref>), although some differences were observed for specific cell types. For instance, SpatialDDLS outperformed cell2location and RCTD at predicting the most important cell types in the mouse neo-cortex samples (STARmap and seqFISH datasets): the excitatory L2/L3, L4, L5, and L6 neurons (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5b and c, S6b and c, and S8b</xref>). Indeed, its overall performance for these datasets was superior according to CCC and JSD evaluation metrics (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8a</xref>), although not reflected in PCC and RMSE, the latter being better only for STARmap. Nevertheless, we believe that CCC is a more reliable metric for evaluating this problem, as it considers not only the linear relationship between two variables but also their distance to the identity (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). Altogether, the results across all datasets were comparable among the three methods, showcasing a high level of agreement. Nonetheless, specific tendencies were observed, making their predictions complementary to each other for a better understanding of the structure of the tissue under study. In contrast to other methods, SpatialDDLS offers interpretability to predicted cell proportions by reporting gradient-based gene scores that highlight important genes for the predictions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>). In dditiona, it incorporates functionalities that might help to understand structural features of tissues, such as visualizing distances between extrinsic and intrinsic spots to explore the spatial consistency of each region at the transcriptional level (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9b</xref>).</p>
    <p>Finally, we evaluated the performance of each method at the computational level (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8c</xref>). While both SpatialDDLS and RCTD demonstrated comparable running times across all datasets, cell2location exhibited the longest durations. On the other hand, in terms of RAM consumption, cell2location was superior in performance to SpatialDDLS and RCTD. It is important to note that SpatialDDLS allocates all intermediate steps generated during the deconvolution process in order to let users explore them, although this may be dispensable if memory optimization is prioritized.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>SpatialDDLS is a flexible spatial deconvolution tool of easy use and fully integrated in the R/Bioconductor ecosystem. We have demonstrated that it generates comparable results to those of two state-of-the-art methods while uses unexpensive computational resources that allow its implementation in the regular workflow for ST data analysis. In addition, SpatialDDLS does not need the definition of a set of markers for each cell type and performs whole-transcriptome predictions. We think that this fact can be useful in the context of paired scRNA-seq and ST datasets, as SpatialDDLS could account for specific transcriptional features that cell types may undergo depending on the biological context. Finally, even though the algorithm is based on NN models, SpatialDDLS makes the deconvolution process quite transparent thanks to two features: when a model is trained, it allows the users to check out whether every cell type is being correctly detected in simulated samples (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1b and S3b</xref>); and by making use of gradient-based interpretation techniques, SpatialDDLS integrates functions that allow to gain insights into the model’s decision-making process (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10a–d</xref>). Overall, these features make SpatialDDLS a robust alternative to existing methods that might be useful for the field.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae072_Supplementary_Data</label>
      <media xlink:href="btae072_supplementary_data.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank the Bioinformatics Unit for the support and the insightful discussions about the project.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>The CNIC was supported by the Instituto de Salud Carlos III (ISCIII), the Ministerio de Ciencia e Innovación (MCIN) and the Pro CNIC Foundation, and is a Severo Ochoa Center of Excellence [CEX2020-001041-S funded by MICIN/AEI/10.13039/501100011033]. F.S.-C. received funding [RTI2018-102084-B-I00 and PID2022-141527OB-I00] by the MCIN/AEI/10.13039/501100011033/and by FEDER Una manera de hacer Europa. C.T. and C.R. received funding [TED2021-132296B-C54] from MCIN/AEI/10.13039/501100011033 and by European Union NextGenerationEU/PRTR. D.M. was supported by a predoctoral grant from the Spanish Government [PRE2020-092578 MCIN/AEI/10.13039/501100011033]. I.R.-G. received the support of a fellowship from “la Caixa” Foundation [100010434, fellowship code: LCF/BQ/DR20/11790019].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>No new data were generated or analysed in support of this research.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae072-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Allaire</surname><given-names>J</given-names></string-name>, <string-name><surname>Chollet</surname><given-names>F.</given-names></string-name></person-group><italic toggle="yes">Package Keras. R Package Available at CRAN</italic>. <year>2021</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=keras" ext-link-type="uri">https://CRAN.R-project.org/package=keras</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae072-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Allaire</surname><given-names>J</given-names></string-name>, <string-name><surname>Tang</surname><given-names>Y.</given-names></string-name></person-group><italic toggle="yes">Package Tensorflow. R Package Available at CRAN</italic>. <year>2021</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=tensorflow" ext-link-type="uri">https://CRAN.R-project.org/package=tensorflow</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae072-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Avila Cobos</surname><given-names>F</given-names></string-name>, <string-name><surname>Vandesompele</surname><given-names>J</given-names></string-name>, <string-name><surname>Mestdagh</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Computational deconvolution of transcriptomics data from mixed cell populations</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>1969</fpage>–<lpage>79</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty019</pub-id><pub-id pub-id-type="pmid">29351586</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cable</surname><given-names>DM</given-names></string-name>, <string-name><surname>Murray</surname><given-names>E</given-names></string-name>, <string-name><surname>Zou</surname><given-names>LS</given-names></string-name></person-group><etal>et al</etal><article-title>Robust decomposition of cell type mixtures in spatial transcriptomics</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>517</fpage>–<lpage>26</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-021-00830-w</pub-id><pub-id pub-id-type="pmid">33603203</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eng</surname><given-names>C-HL</given-names></string-name>, <string-name><surname>Lawson</surname><given-names>M</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q</given-names></string-name></person-group><etal>et al</etal><article-title>Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH+</article-title>. <source>Nature</source><year>2019</year>;<volume>568</volume>:<fpage>235</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-019-1049-y</pub-id><pub-id pub-id-type="pmid">30911168</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huber</surname><given-names>W</given-names></string-name>, <string-name><surname>Carey</surname><given-names>VJ</given-names></string-name>, <string-name><surname>Gentleman</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>. <source>Nat Methods</source><year>2015</year>;<volume>12</volume>:<fpage>115</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3252</pub-id><pub-id pub-id-type="pmid">25633503</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kleshchevnikov</surname><given-names>V</given-names></string-name>, <string-name><surname>Shmatko</surname><given-names>A</given-names></string-name>, <string-name><surname>Dann</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Cell2location maps fine-grained cell types in spatial transcriptomics</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>661</fpage>–<lpage>71</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-021-01139-4</pub-id><pub-id pub-id-type="pmid">35027729</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>W</given-names></string-name>, <string-name><surname>Guo</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Benchmarking spatial and single-cell transcriptomics integration methods for transcript distribution prediction and cell type deconvolution</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>662</fpage>–<lpage>70</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-022-01480-9</pub-id><pub-id pub-id-type="pmid">35577954</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>A comprehensive benchmarking with practical guidelines for cellular deconvolution of spatial transcriptomics</article-title>. <source>Nat Commun</source><year>2023</year>;<volume>14</volume>:<fpage>1548</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-023-37168-7</pub-id><pub-id pub-id-type="pmid">36941264</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Keren-Shaul</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>DestVI identifies continuums of cell types in spatial transcriptomics data</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>1360</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-022-01272-8</pub-id><pub-id pub-id-type="pmid">35449415</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Mañanes</surname><given-names>D</given-names></string-name>, <string-name><surname>Torroja</surname><given-names>C</given-names></string-name>, <string-name><surname>Sánchez-Cabo</surname><given-names>F.</given-names></string-name></person-group><italic toggle="yes">digitalDLSorteR: Deconvolution of Bulk RNA-Seq Data Based on Deep Learning. R Package Available at CRAN</italic>. <year>2022</year>. <ext-link xlink:href="https://CRAN.R-project.org/package=digitalDLSorteR" ext-link-type="uri">https://CRAN.R-project.org/package=digitalDLSorteR</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae072-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moffitt</surname><given-names>JR</given-names></string-name>, <string-name><surname>Bambah-Mukku</surname><given-names>D</given-names></string-name>, <string-name><surname>Eichhorn</surname><given-names>SW</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular, spatial, and functional single-cell profiling of the hypothalamic preoptic region</article-title>. <source>Science</source><year>2018</year>;<volume>362</volume>:<fpage>eaau5324</fpage>. <pub-id pub-id-type="doi">10.1126/science.aau5324</pub-id><pub-id pub-id-type="pmid">30385464</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Pagès</surname><given-names>H.</given-names></string-name></person-group><italic toggle="yes">DelayedArray: A Unified Framework for Working Transparently with On-Disk and In-Memory Array-Like Datasets. R Package Available at CRAN</italic>. <year>2021a</year>. <pub-id pub-id-type="doi">10.18129/B9.bioc.DelayedArray</pub-id>.</mixed-citation>
    </ref>
    <ref id="btae072-B14">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Pagès</surname><given-names>H.</given-names></string-name></person-group><italic toggle="yes">HDF5Array: HDF5 Backend for DelayedArray Objects. R Package Available at CRAN</italic>. <year>2021b</year>. <pub-id pub-id-type="doi">10.18129/B9.bioc.HDF5Array</pub-id>.</mixed-citation>
    </ref>
    <ref id="btae072-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saunders</surname><given-names>A</given-names></string-name>, <string-name><surname>Macosko</surname><given-names>EZ</given-names></string-name>, <string-name><surname>Wysoker</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular diversity and specializations among the cells of the adult mouse brain</article-title>. <source>Cell</source><year>2018</year>;<volume>174</volume>:<fpage>1015</fpage>–<lpage>30.e16</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2018.07.028</pub-id><pub-id pub-id-type="pmid">30096299</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Simonyan</surname><given-names>K</given-names></string-name>, <string-name><surname>Vedaldi</surname><given-names>A</given-names></string-name>, <string-name><surname>Zisserman</surname><given-names>A.</given-names></string-name></person-group><italic toggle="yes">Deep Inside Convolutional Networks: Visualising Image Classification Models and Saliency Maps</italic>. arXiv preprint arXiv:1312.6034 <year>2014</year>. <pub-id pub-id-type="doi">10.48550/arXiv.1312.6034</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Torroja</surname><given-names>C</given-names></string-name>, <string-name><surname>Sanchez-Cabo</surname><given-names>F.</given-names></string-name></person-group><article-title>Digitaldlsorter: deep-learning on scRNA-Seq to deconvolute gene expression data</article-title>. <source>Front Genet</source><year>2019</year>;<volume>10</volume>:<fpage>1373</fpage>.<pub-id pub-id-type="pmid">32117421</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <string-name><surname>Allen</surname><given-names>WE</given-names></string-name>, <string-name><surname>Wright</surname><given-names>MA</given-names></string-name></person-group><etal>et al</etal><article-title>Three-dimensional intact-tissue sequencing of single-cell transcriptional states</article-title>. <source>Science</source><year>2018</year>;<volume>361</volume>:<fpage>eaat5691</fpage>. <pub-id pub-id-type="doi">10.1126/science.aat5691</pub-id><pub-id pub-id-type="pmid">29930089</pub-id></mixed-citation>
    </ref>
    <ref id="btae072-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yan</surname><given-names>L</given-names></string-name>, <string-name><surname>Sun</surname><given-names>X.</given-names></string-name></person-group><article-title>Benchmarking and integration of methods for deconvoluting spatial transcriptomic data</article-title>. <source>Bioinformatics</source><year>2023</year>;<volume>39</volume>:<fpage>btac805</fpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btac805</pub-id><pub-id pub-id-type="pmid">36515467</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
