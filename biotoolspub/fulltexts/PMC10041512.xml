<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10041512</article-id>
    <article-id pub-id-type="pmid">36973282</article-id>
    <article-id pub-id-type="publisher-id">37432</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-37432-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A comprehensive platform for analyzing longitudinal multi-omics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9763-3899</contrib-id>
        <name>
          <surname>Vasaikar</surname>
          <given-names>Suhas V.</given-names>
        </name>
        <address>
          <email>suhas.vasaikar@alleninstitute.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1913-5485</contrib-id>
        <name>
          <surname>Savage</surname>
          <given-names>Adam K.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gong</surname>
          <given-names>Qiuyu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0351-6446</contrib-id>
        <name>
          <surname>Swanson</surname>
          <given-names>Elliott</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Talla</surname>
          <given-names>Aarthi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lord</surname>
          <given-names>Cara</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9312-4090</contrib-id>
        <name>
          <surname>Heubeck</surname>
          <given-names>Alexander T.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8533-3992</contrib-id>
        <name>
          <surname>Reading</surname>
          <given-names>Julian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8814-6818</contrib-id>
        <name>
          <surname>Graybuck</surname>
          <given-names>Lucas T.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5535-0399</contrib-id>
        <name>
          <surname>Meijer</surname>
          <given-names>Paul</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Torgerson</surname>
          <given-names>Troy R.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Skene</surname>
          <given-names>Peter J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4319-1006</contrib-id>
        <name>
          <surname>Bumol</surname>
          <given-names>Thomas F.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0832-9479</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Xiao-jun</given-names>
        </name>
        <address>
          <email>xiaojun.li@alleninstitute.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.507731.7</institution-id><institution>Allen Institute for Immunology, </institution></institution-wrap>Seattle, WA 98109 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.34477.33</institution-id><institution-id institution-id-type="ISNI">0000000122986657</institution-id><institution>Present Address: Department of Genome Sciences, </institution><institution>University of Washington School of Medicine, </institution></institution-wrap>Seattle, WA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.418019.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 0393 4335</institution-id><institution>Present Address: GlaxoSmithKline, </institution></institution-wrap>Collegeville, PA 19426 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>1684</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Longitudinal bulk and single-cell omics data is increasingly generated for biological and clinical research but is challenging to analyze due to its many intrinsic types of variations. We present PALMO (<ext-link ext-link-type="uri" xlink:href="https://github.com/aifimmunology/PALMO">https://github.com/aifimmunology/PALMO</ext-link>), a platform that contains five analytical modules to examine longitudinal bulk and single-cell multi-omics data from multiple perspectives, including decomposition of sources of variations within the data, collection of stable or variable features across timepoints and participants, identification of up- or down-regulated markers across timepoints of individual participants, and investigation on samples of same participants for possible outlier events. We have tested PALMO performance on a complex longitudinal multi-omics dataset of five data modalities on the same samples and six external datasets of diverse background. Both PALMO and our longitudinal multi-omics dataset can be valuable resources to the scientific community.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">The analysis of longitudinal bulk and single-cell multi-omics data is a highly complex task. Here, the authors introduce PALMO, a software platform with five modules to analyse longitudinal bulk and single-cell multi-omics data, which is extensively tested in external datasets that include multiple omics modalities.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational platforms and environments</kwd>
      <kwd>Time series</kwd>
      <kwd>Translational immunology</kwd>
      <kwd>Genomics</kwd>
      <kwd>Bioinformatics</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Applying multi-omics technologies to measure longitudinal specimens of human participants provides unprecedented insights on disease such as COVID-19<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>, diabetes<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> and lymphoma<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Single-cell technologies such as single-cell ribonucleic acid sequencing (scRNA-seq) and single-cell assay for transposase-accessible chromatin sequencing (scATAC-seq) can offer granular details on disease mechanisms and are increasingly utilized in biological and clinical research<sup><xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref></sup>. It is anticipated that more and more longitudinal bulk and single-cell omics data will be generated by the scientific community.</p>
    <p id="Par4">Different statistical methods are used to analyze longitudinal data to account for the diversities in research interest, study design, and/or data type (continuous or categorical)<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup>. Generalized linear mixed model (GLMM) is a popular approach for analyzing continuous longitudinal data. It is common that the same dataset can be examined from multiple perspectives with different methods. Complications such as human heterogeneity, interdependency between multiple samples of same participant, missing and/or incomplete data, unbalanced dataset, and unexpected outlier events (e.g., severe adverse events in clinical trials) are all intrinsic to longitudinal data. The usage of single-cell technologies brings additional complications such as dropout, sparseness, interdependency between cells of same sample, and unbalanced cell counts in individual samples<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>. Advanced methods have been applied to analyze longitudinal bulk omics data with customized codes for specific projects<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup>. Sophisticated methods for analyzing cross-sectional single-cell omics data have also been developed with mixed performance<sup><xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR18">18</xref></sup>. While software tools such as variancePartition<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> and tcR<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> can be repurposed to examine longitudinal omics data either from a single perspective and/or collected on a single technical platform, we are not aware of any well-accepted software package that is specifically designed to analyze longitudinal bulk and single-cell omics data. Instead, researchers rely on customized codes to analyze such data, which is time-consuming, error-prone and a non-small challenge to many people. A comprehensive yet simple-to-use software tool to extract insightful information from longitudinal omics data is desired.</p>
    <p id="Par5">Here, we present PALMO (<ext-link ext-link-type="uri" xlink:href="https://github.com/aifimmunology/PALMO">https://github.com/aifimmunology/PALMO</ext-link>), a software package designed to analyze longitudinal bulk and single-cell omics data (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). Five analytical modules are implemented in PALMO (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>): (i) Variance decomposition analysis (VDA) evaluates contributions of factors of interest to the total variance of individual features (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). (ii) Coefficient of variation (CV) profiling (CVP) assesses intra-participant variation over time in bulk data and identifies consistently stable or variable features among participants (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). (iii) Stability pattern evaluation across cell types (SPECT) assesses longitudinal stability patterns of features in single-cell omics data and identifies stable or variable features that are unique to individual cell types but consistent among participants (Fig. <xref rid="Fig1" ref-type="fig">1e</xref>). (iv) Outlier detection analysis (ODA) examines the possibility of abnormal events occurring during a longitudinal study (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>). (v) Time course analysis (TCA) evaluates transcriptomic changes over time based on longitudinal scRNA-seq data of the same participant and identifies genes that exhibit significant temporal changes (Fig. <xref rid="Fig1" ref-type="fig">1g</xref>). Together these five modules provide unique insights on longitudinal omics data from multiple perspectives. We also developed functions to display CVs of features of interest in circos plots (Fig. <xref rid="Fig1" ref-type="fig">1h</xref>). We test PALMO performance on a complex longitudinal multi-omics dataset of five data modalities and six external datasets of diverse background.<fig id="Fig1"><label>Fig. 1</label><caption><title>General workflow and analysis schema of PALMO.</title><p><bold>a</bold> PALMO can work with complex longitudinal data, including clinical data, bulk omics data, and single-cell omics data. <bold>b</bold> Overview of five analytical modules implemented in PALMO. <bold>c</bold> Variance decomposition analysis (VDA) applies generalized linear mixed model to assess contributions of factors of interest (such as disease status, sex, individual participant, cell type, experimental batch, etc.) to the total variance of individual features in the data. <bold>d</bold> Coefficient of variation (CV) profiling (CVP) is designed for bulk longitudinal data, calculates CV of repeated measurements on the same participant to assess the corresponding longitudinal stability, and compares CVs of different participants to identify consistently stable or variable features. <bold>e</bold> Stability pattern evaluation across cell types (SPECT) is the CVP counterpart for single-cell omics data, analyzes stability patterns of features across different cell types and different participants, classifies features based on how often they are stable or variable in cell type-donor combinations, and identifies features that are unique to individual cell types and consistent among participants. <bold>f</bold> Outlier detection analysis (ODA) evaluates how many features in a sample are outliers when compared with the corresponding features in other samples of same participant, assesses whether the number of outlier features in the sample is significantly higher than expectation, and identifies possible abnormal events occurred during a longitudinal study. <bold>g</bold> Time course analysis (TCA) uses the hurdle model to evaluate transcriptomic changes over time based on longitudinal scRNA-seq data of same participants, models time as a continuous variable for data with at least three timepoints, and identifies up- or down-regulated genes over time. <bold>h</bold> PALMO uses circos plots to display CVs of features of interest and reveal stability patterns across features, participants, cell types, and data modalities. Adobe Illustrator (version 27.1.1; <ext-link ext-link-type="uri" xlink:href="https://www.adobe.com/products/illustrator.html">https://www.adobe.com/products/illustrator.html</ext-link>) was used to draw (<bold>a</bold>), arrange panels, and edit text. PowerPoint (version 16.69; <ext-link ext-link-type="uri" xlink:href="https://www.microsoft.com/en-us/microsoft-365/powerpoint">https://www.microsoft.com/en-us/microsoft-365/powerpoint</ext-link>) was used to draw (<bold>b</bold>).</p></caption><graphic xlink:href="41467_2023_37432_Fig1_HTML" id="d32e472"/></fig></p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>A complex longitudinal multi-omics dataset to demonstrate PALMO performance</title>
      <p id="Par6">To demonstrate PALMO performance, we collected sixty blood samples (plasma and peripheral blood mononuclear cells (PBMCs)) from six healthy, non-smoking Caucasian donors (three females and three males) between 25 to 38 years old over a 10-week period (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1a</xref>). Complete blood count (CBC) was collected on all these samples (Supplementary Data <xref rid="MOESM5" ref-type="media">1a</xref>). The abundance of 1,156 plasma proteins were measured on these samples as well (Supplementary Data <xref rid="MOESM5" ref-type="media">1c</xref>), but only 1,042 (68%) proteins had reliable quantification results (Supplementary Data <xref rid="MOESM6" ref-type="media">2a</xref>). High-dimensional flow cytometry and droplet-based scRNA-seq assays were performed on a subset of 24 PBMC samples from four donors (one female and three males) over Week 2 to 7. A total of 27 cell types were identified from flow cytometry data (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>, Supplementary Data <xref rid="MOESM5" ref-type="media">1b</xref>). Droplet-based scATAC-seq assay was also performed on 18 out of the 24 PBMC samples. This multi-omics dataset of five data modalities on the same samples can be a valuable resource to the scientific community for immune health study and/or software development.</p>
      <p id="Par7">We retrieved high quality scRNA-seq data of 472,464 cells and labeled them to 31 different cell types using Seurat level2 labelling<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3a, b</xref>, Supplementary Data <xref rid="MOESM7" ref-type="media">3a</xref>). Among the nineteen overlapping cell types identified by both scRNA-seq and flow cytometry, the corresponding cell frequencies as measured by the two data modalities were highly correlated (two-sided <italic>p</italic> &lt; 0.05 on Pearson correlation as evaluated by R function “cor.test()”) except for those of double negative T (dnT) cells (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3c</xref>). Unless specified otherwise, we filtered out low frequent cell types (average frequency &lt;0.5%) and kept 19 out of the 31 cell types for downstream analysis (Supplementary Data <xref rid="MOESM7" ref-type="media">3b</xref>). We also kept only 11,191 genes that had an average (across timepoints) expression of 0.1 or higher in at least one cell type of one donor.</p>
      <p id="Par8">scATAC-seq data was analyzed using the ArchR<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> package. We observed 294,623 peaks in 135,566 cells after removing doublets. Cells were labeled to 28 different cell types using genescore matrix as implemented in ArchR (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3d, e</xref>). We noticed the labeling scores on scATAC-seq data were much lower than the corresponding scores on scRNA-seq data, likely reflecting the challenge in cell labeling on scATAC-seq data. We filtered out low quality cells (labeling score &lt;0.5), removed cell types having less than 50 remaining cells, and kept 14 out of the 28 cell types for downstream analysis (Supplementary Data <xref rid="MOESM7" ref-type="media">3b</xref>). We also kept only 24,769 genes that had an average (across timepoints) gene score of 0.1 or higher in at least one cell type of one donor.</p>
      <p id="Par9">In addition to our own data, we also evaluated PALMO performance against six external omics datasets of diverse complexities, different sample types and/or different technical platforms (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1b</xref>). More examples of PALMO usage beyond those presented here can be found in PALMO vignettes (<ext-link ext-link-type="uri" xlink:href="https://github.com/aifimmunology/PALMO/blob/main/Vignette-PALMO.pdf">https://github.com/aifimmunology/PALMO/blob/main/Vignette-PALMO.pdf</ext-link>), including performance on unbalanced data, data with replicates, and data of a single donor with multiple timepoints.</p>
    </sec>
    <sec id="Sec4">
      <title>Application of VDA to assess sources of variations</title>
      <p id="Par10">We applied VDA to evaluate inter- and intra-donor variations in our bulk data (CBC, PBMC frequencies from flow cytometry, and plasma proteomics data), using donor and week (timepoint) as factors of interest. CBC measurements showed strong inter-donor variations and minuscule intra-donor variations (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4a, b</xref>). PBMC frequencies from flow cytometry showed very strong inter-donor variations (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4c, d</xref>) with intra-class correlation (ICC) ranging from 51% (IgD CD27<sup>−</sup> B cells) to 98% (CD4 Temra: CD4<sup>+</sup> effector memory T cells re-expressing CD45RA). In comparison, the highest ICC on intra-donor variations was 19% (cDC1: conventional type 1 dendritic cells). Plasma proteins followed a similar trend with some exceptions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4e, f</xref>, Supplementary Data <xref rid="MOESM6" ref-type="media">2a</xref>). Inter-donor variations of 621 (60%) out of the 1042 quantified proteins contributed more than 50% to the corresponding total variance. Only 75 proteins (7%) had more intra-donor variation than inter-donor variation, but none contributed more than 50% to the total. A previous study<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> identified 155 proteins having high inter-donor variations, 81% (126) of which overlapped with the 621 inter-donor variable proteins.</p>
      <p id="Par11">We added cell type as a factor of interest in the VDA of our scRNA-seq and scATAC-seq data. Inter-cell-type variations were more prominent than inter- and intra-donor variations in both single-cell data modalities. Based on our scRNA-seq data, 10, 0, and 4384 genes had more than 50% of total variance from inter-donor, intra-donor, and inter-cell-type variations, respectively (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>, Supplementary Data <xref rid="MOESM7" ref-type="media">3c</xref>). Nine of the top ten inter-cell-type variable genes (ICC: 98–99%, Fig. <xref rid="Fig2" ref-type="fig">2b</xref>) have known immune functions (Supplementary Data <xref rid="MOESM7" ref-type="media">3d</xref>). The top gene, LILRA4, is predominantly expressed in plasmacytoid dendritic cells (pDCs) and prevents pDCs from overblown reaction to viral infections<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. Six of the top ten inter-donor variable genes (ICC: 53–94%, Fig. <xref rid="Fig2" ref-type="fig">2c</xref>) are linked to the X or Y chromosome and seven of them showed differential expression between ovary and prostate/testis, reflecting the sex difference between male and female donors. Contributions from intra-donor variations to the total variance were small (ICC ≤ 3%, Fig. <xref rid="Fig2" ref-type="fig">2d</xref>), indicating the immune systems of the four healthy donors were quite stable over the study period.<fig id="Fig2"><label>Fig. 2</label><caption><title>Variance decomposition on longitudinal single-cell omics data.</title><p><bold>a</bold> Overall distributions of variance explained by inter-donor variations (Donor), longitudinal intra-donor variations (Week), variations among cell types (Celltype), or residual variations (Residual) based on scRNA-seq data. The scRNA-seq data was collected on 24 independent peripheral blood mononuclear cell (PBMC) samples from <italic>n</italic> = 4 healthy participants with each participant contributing one sample a week for 6 weeks. The distributions were evaluated based on pseudo-bulk intensities of <italic>n</italic> = 11,191 genes in 19 cell types. <bold>b</bold>, <bold>c</bold> Examples of genes whose total expression variance was most explained by inter-cell-type variations (<bold>b</bold>) or inter-donor variations (<bold>c</bold>). <bold>d</bold> Examples of genes that had the most but still minuscular intra-donor variations in expression. <bold>b</bold>–<bold>d</bold> Pseudo-bulk intensities of the corresponding genes in 19 cell types were displayed in boxplots. <bold>e</bold> Same as (<bold>a</bold>) but based on scATAC-seq data from <italic>n</italic> = 18 out of the 24 PBMC samples with 2 participants contributing 6 samples while other 2 participants contributing 3 samples. The distributions were evaluated based on gene scores of <italic>n</italic> = 24,769 genes in 14 cell types. <bold>f</bold>, <bold>g</bold> The top list of genes whose inter-cell-type (<bold>f</bold>) or inter-donor (<bold>g</bold>) variations contributed most to the total variance in scATAC-seq data. <bold>h</bold> The top list of genes that had the most intra-donor variations in scATAC-seq data. <bold>a</bold>–<bold>e</bold> Each boxplot displays the median (centerline), the first and third quartiles (the lower and upper bound of the box), and the 1.5x interquartile range (whiskers) of the data. ICC: intra-class correlation. Adobe Illustrator (version 27.1.1; <ext-link ext-link-type="uri" xlink:href="https://www.adobe.com/products/illustrator.html">https://www.adobe.com/products/illustrator.html</ext-link>) was used to arrange panels and edit text. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_37432_Fig2_HTML" id="d32e677"/></fig></p>
      <p id="Par12">The VDA results on our scATAC-seq data, using genescore matrix, showed similar trends as that on our scRNA-seq data (Fig. <xref rid="Fig2" ref-type="fig">2e</xref>). A total of 33, 0, and 7847 genes had more than 50% of total variance from inter-donor, intra-donor, and inter-cell-type variations, respectively (Supplementary Data <xref rid="MOESM7" ref-type="media">3e</xref>). All the top ten inter-cell-type variable genes (ICC: 95–97%, Fig. <xref rid="Fig2" ref-type="fig">2f</xref>) have known immune functions (Supplementary Data <xref rid="MOESM7" ref-type="media">3f</xref>). The top gene, SPIB, is an enhancer regulating pDC development<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. Among the top ten inter-donor variable genes (ICC: 58–89%, Fig. <xref rid="Fig2" ref-type="fig">2g</xref>), XIST, ZNF705D, GTF2IRD2, and USP32P2 have differential expression between ovary and prostate/testis; RHD encodes a key protein in the Rh blood group system; and GSTM1 belongs to a highly polymorphic supergene family and affects heterogeneous response to toxicity<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. These genes appeared to capture more diverse types of differences among donors than their counterparts from scRNA-seq data. The ICCs of the top five intra-donor variable genes (ICC: 32–34%, Fig. <xref rid="Fig2" ref-type="fig">2h</xref>) were about 10-fold higher than that of the corresponding top gene, JUN, by scRNA-seq data, suggesting chromatin accessibility might be more sensitive to biological changes than gene expression.</p>
      <p id="Par13">variancePartition<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> was previously developed to study variations in gene expression data and can be applied to longitudinal omics data for the same purpose. VDA generated almost identical results as variancePartition on two tested datasets after removing missing values (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>), which was needed to run variancePartition but not VDA.</p>
      <p id="Par14">VDA can be used to study T-cell receptor (TCR) repertoires. Previously sorted CD4<sup>+</sup> and CD8<sup>+</sup> non-naïve T cells were isolated from PBMC samples of four systemic sclerosis (SSc) donors and analyzed to obtain sequencing data of TCR β-chains<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. The data was originally analyzed using tcR<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, which was developed specifically for TCR data with functions either providing sample-level views on the whole repertories or treating clonotype data as binary (present or absent). We downloaded the TCRβ data (GSE156980) and calculated the frequency of unique clonotypes from both CD4<sup>+</sup> and CD8<sup>+</sup> T cells. A total of 288,597 unique clonotypes were obtained from CD4<sup>+</sup> T cells and 11,739 from CD8<sup>+</sup> T cells, respectively. We treated the clonotype data as continuous and used donor, time, and subtype (limited SSc versus diffuse SSc) as factors of interest in VDA. We identified from CD4<sup>+</sup> T cells 6,625, 3, and 41 clonotypes having more than 50% of total variance from inter-donor, intra-donor, and inter-subtype variations, respectively (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6a–d</xref>, Supplementary Data <xref rid="MOESM8" ref-type="media">4a</xref>). The corresponding counts from CD8<sup>+</sup> T cells were 650, 0, and 1 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6e–h</xref>, Supplementary Data <xref rid="MOESM8" ref-type="media">4b</xref>). As illustrated in Supplementary Fig. <xref rid="MOESM1" ref-type="media">6b, f</xref>, many inter-donor variable clonotypes were donor-specific and stable over time, making them potential candidates responsible for SSc pathogenesis. The identification of inter-subtype variable clonotypes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6d, h</xref>) is interesting since some of them might be specific to either limited SSc or diffuse SSc. VDA provided additional insights on the TCR data beyond the original study<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>.</p>
    </sec>
    <sec id="Sec5">
      <title>Application of CVP to evaluate longitudinal stability</title>
      <p id="Par15">We applied CVP to identify longitudinally stable and variable proteins from our proteomics data (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). The distribution of median CV (among donors) peaked near 5% (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7a</xref>), which we used as a cut-off to separate variable (median CV &gt; 5%) and stable (median CV &lt; 5%) proteins (Supplementary Data <xref rid="MOESM6" ref-type="media">2b–d</xref>). A total of 413 proteins were longitudinally variable, among which SNAP23, GRAP2, ARG1, AIFM1, and MESD had the highest median CV (24.6-27.7%, Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). Such moderate CV values are consistent with the observed low intra-donor variations by VDA. A total of 629 proteins were longitudinally stable, among which SOD2, NRP2, OSCAR, NRCAM, and MIA had the lowest median CV (0.6–0.8%, Fig. <xref rid="Fig3" ref-type="fig">3c</xref>). These stable proteins may be interesting biomarker candidates if they change under some disease conditions. They can also be used to bridge proteomics data of different experimental batches.<fig id="Fig3"><label>Fig. 3</label><caption><title>Longitudinal stability of plasma proteome.</title><p><bold>a</bold> Scatter plots of coefficient of variation (CV) versus mean of normalized protein expression (NPX) over 10 timepoints in <italic>n</italic> = 6 participants. One plasma sample per week was collected from <italic>n</italic> = 6 participants over 10 weeks. The evaluation for each participant was based on measurements on 1042 proteins in the corresponding 10 plasma samples. The longitudinal stable and variable proteins are represented in blue and red, respectively. <bold>b</bold>, <bold>c</bold> Heatmap of CV of top 50 longitudinally variable (<bold>b</bold> CV &gt; 5%) or stable (<bold>c</bold> CV &lt; 5%) plasma proteins. <bold>d</bold> Top panel: Number of proteins with <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z &gt; 2.5$$\end{document}</tex-math><mml:math id="M2"><mml:mi>z</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2.5</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq1.gif"/></alternatives></inline-formula> (red) or <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z &lt; -2.5$$\end{document}</tex-math><mml:math id="M4"><mml:mi>z</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:mn>2.5</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq2.gif"/></alternatives></inline-formula> (blue) in individual samples, where <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z=({NPX}-\overline{{NPX}})/{SD}$$\end{document}</tex-math><mml:math id="M6"><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi><mml:mi>X</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi><mml:mi>X</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq3.gif"/></alternatives></inline-formula> with <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{{NPX}}$$\end{document}</tex-math><mml:math id="M8"><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi><mml:mi>X</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq4.gif"/></alternatives></inline-formula> and <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${SD}$$\end{document}</tex-math><mml:math id="M10"><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq5.gif"/></alternatives></inline-formula> being the mean and the standard deviation, respectively, of <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${NPX}$$\end{document}</tex-math><mml:math id="M12"><mml:mi>N</mml:mi><mml:mi>P</mml:mi><mml:mi>X</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq6.gif"/></alternatives></inline-formula> across samples of the same participant. Bottom panel: <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-{\log }_{10}({p})$$\end{document}</tex-math><mml:math id="M14"><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq7.gif"/></alternatives></inline-formula> for individual samples being possible outliers, where <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}$$\end{document}</tex-math><mml:math id="M16"><mml:mi>p</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq8.gif"/></alternatives></inline-formula> is calculated based on a binomial test (two-sided). <bold>e</bold> Protein examples clearly demonstrate that Week 6 of participant PTID3 was an outlier. <bold>b</bold>, <bold>c</bold>, <bold>e</bold> Each boxplot displays the median (centerline), the first and third quartiles (the lower and upper bound of the box), and the 1.5x interquartile range (whiskers) of the data. Adobe Illustrator (version 27.1.1; <ext-link ext-link-type="uri" xlink:href="https://www.adobe.com/products/illustrator.html">https://www.adobe.com/products/illustrator.html</ext-link>) was used to arrange panels and edit text. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_37432_Fig3_HTML" id="d32e999"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Application of ODA to discover a possible abnormal event</title>
      <p id="Par16">We noticed that proteomics data of donor PTID3 exhibited higher CV values than those of other donors (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>) and weaker intra-donor correlations at week 6 than at other weeks (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7b</xref>). We applied ODA to check whether donor PTID3 had an abnormal event at week 6. We selected <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|z\right| &gt; 2.5$$\end{document}</tex-math><mml:math id="M18"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mn>2.5</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq9.gif"/></alternatives></inline-formula> as the criterion for outliers so that just above 1% of all quantifiable proteins are expected to be outliers. More accurately, we expected 1.24% of proteins, i.e., 19 proteins per donor per time point, to be outliers by chance (Methods). A total of 71 outlier proteins were identified at Week 6 on donor PTID3 (adjusted <italic>p</italic> = 2.7 × 10<sup>−26</sup>, Fig. <xref rid="Fig3" ref-type="fig">3d, e</xref>, Supplementary Data <xref rid="MOESM6" ref-type="media">2e, f</xref>). Eight of the top ten proteins having the highest <italic>z</italic> scores (2.84–2.85) play important roles in immune response and immunity (Supplementary Data <xref rid="MOESM6" ref-type="media">2g</xref>). Gene set enrichment analysis (GSEA) revealed the outlier proteins were enriched in immunological processes such as adaptive immune responses, antigen processing and presentation via major histocompatibility complex (MHC) class II, T cell activation, etc. (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7c</xref>). Single-sample GSEA (ssGSEA)<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> on all PTID3 samples identified Week 6 as an outlier and revealed increased activity at Week 6 in important immune processes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7d</xref>), including MYC targets (v1 and v2)<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, interferon-alpha and gamma responses<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, androgen response<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, pancreas beta cells<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, and peroxisome<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. Although further validation is required, these results suggest the possible occurrence of an immunological perturbation event (such as infection) experienced by PTID3 at week 6. Such outlier phenotypes can be obscured by analyses focusing on differences between sample groups.</p>
    </sec>
    <sec id="Sec7">
      <title>Application of SPECT to reveal diverse gene stability patterns</title>
      <p id="Par17">We applied SPECT to analyze our scRNA-seq data. Noticing the two well-known housekeeping genes, ACTB and GAPDH, had CVs (across timepoints) just above 10% in some cell types (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>), we used a CV cut-off of 10% to separate longitudinally variable (CV &gt; 10%) or stable (CV &lt; 10%) genes in individual cell types of individual donors. We then counted how many times individual genes were variable and/or stable in the 76 combinations between donor (<italic>n</italic> = 4) and cell type (<italic>n</italic> = 19). A gene was denoted as super variable (SUV) or super stable (SUS) if it was variable or stable in at least 40 donor-cell type combinations. A gene was denoted as variable across time in cell-types (VATIC) or stable across time in cell-types (STATIC) if it was variable or stable in at least one cell type across all donors but in less than 40 donor-cell type combinations. We identified a total of 700 SUV genes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9a</xref>), 2129 SUS genes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9b</xref>), 5750 VATIC genes, and 4004 STATIC genes from the dataset. Since a gene can be consistently variable in one cell type and consistently stable in another, VATIC and STATIC genes are not mutually exclusive (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9c</xref>).</p>
      <p id="Par18">The SUV genes were enriched in 57 pathways, many of which are associated with cellular proliferation and activity (Supplementary Data <xref rid="MOESM7" ref-type="media">3g</xref>). Eight of the top ten SUV genes (Supplementary Data <xref rid="MOESM7" ref-type="media">3h</xref>) have distinct roles in gene regulation, including four transcription factors (FOS, FOSB, JUN, and KLF9), two phosphatases (DUSP1 and PPP1R15A), one regulator of mTOR pathway (DDIT4)<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, and one inhibitor of NF-κB pathway (TNFAIP3)<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. In comparison, the SUS genes were enriched in 501 pathways of rather diverse, basic cellular processes (Supplementary Data <xref rid="MOESM7" ref-type="media">3i</xref>). Among the top ten SUS genes (Supplementary Data <xref rid="MOESM7" ref-type="media">3j</xref>), five (RPS12, RPL10, RPL13, RPLP1, and RPL41) encode ribosomal proteins and two (FTL and FTH1) encode ferritin for iron storage. Many SUS genes are more stable than ACTB and GAPDH and may be good candidates for estimating batch effects in scRNA-seq data<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>.</p>
    </sec>
    <sec id="Sec8">
      <title>STATIC genes as potential biomarkers for cell types or biological conditions</title>
      <p id="Par19">We collected up to 25 top STATIC genes from each cell type and obtained 220 unique genes (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>, Supplementary Data <xref rid="MOESM9" ref-type="media">5a</xref>). These 220 STATIC genes are enriched in pathways such as innate (adjusted <italic>p</italic> = 1.43 × 10<sup>−9</sup>) and adaptive (adjusted <italic>p</italic> = 1.33 × 10<sup>−9</sup>) immune response, allograft rejection (adjusted <italic>p</italic> = 3.06 × 10<sup>−16</sup>), lymphocyte mediated immunity (adjusted <italic>p</italic> = 3.72 × 10<sup>−8</sup>), myeloid mediated immunity (adjusted <italic>p</italic> = 2.71 × 10<sup>−5</sup>), B/T-cell proliferation (adjusted <italic>p</italic> &lt; 1.46 × 10<sup>−3</sup>), acute inflammatory response (adjusted <italic>p</italic> = 7.48 × 10<sup>−3</sup>), hematopoietic cell lineage (adjusted <italic>p</italic> = 2.44 × 10<sup>−4</sup>), etc. (Supplementary Data <xref rid="MOESM9" ref-type="media">5b</xref>). Examples of top STATIC genes for major cell types were shown in Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, including: GIMAP7, LEF1, CD27, CCR7, and TSHZ2 for T cells; CD79A, MS4A1, TCL1A, CD79B, and TNFRSF13C for B cells; PRF1, FGFBP2, SPON2, CST7, and KLRD1 for natural killer (NK) cells; CD14, FCN1, MNDA, SEPINA1, and SPI1 for monocytes; and LILRA4, IRF7, FCER1A, SERPINF1, and SPIB for dendritic cells (DCs). All these genes demonstrated cell type-specific stability patterns and have well-documented roles in the corresponding cell types (Supplementary Data <xref rid="MOESM9" ref-type="media">5c</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><title>Properties of 220 STATIC genes of PBMC.</title><p><bold>a</bold> Heatmap of coefficient of variation (CV) evaluated on 93 out of the 220 stable across time in cell-types (STATIC) genes that were identified from 19 cell types in the longitudinal scRNA-seq data of <italic>n</italic> = 4 healthy participants. The CVs for each of the <italic>n</italic> = 4 participants were evaluated based on pseudo-bulk intensities in the corresponding 6 independent peripheral blood mononuclear cell (PBMC) samples. The 93 STATIC genes include up to ten top STATIC genes from individual cell types. <bold>b</bold> Circos plots displaying CV of five example STATIC genes identified from each of five major cell types: T cells, B cells, natural killer (NK) cells, monocytes (Mono), and dendritic cells (DCs). <bold>c</bold> Uniform Manifold Approximation and Projection (UMAP) using only the 220 STATIC genes as input features (sUMAP) on the same longitudinal scRNA-seq data. <bold>d</bold>–<bold>f</bold> sUMAP using the same 220 STATIC genes on three external PBMC datasets ((<bold>d</bold>) CNP0001102<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, (<bold>e</bold>) GSE149689<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, (<bold>f</bold>) GSE164378<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>), where cells are labeled as in the original studies. <bold>g</bold> Distributions of Pearson correlation coefficient between gene expression (pseudo-bulk intensity) in scRNA-seq data and gene score in scATAC-seq data, one for the 220 STATIC genes (median correlation 0.70), one for the top 500 highly variable genes (HVGs, median correlation 0.40), one for the 10,608 reliable genes (average expression ≥0.1, median correlation 0.21), and one for random gene pairs (95% upper confidence bound at 0.399). The correlations were calculated across 14 cell types in 18 PBMC samples (<italic>n</italic> = 252 data points). <bold>h</bold>, <bold>i</bold> Venn diagrams showing the overlaps between the 220 STATIC genes and biomarkers distinguishing either healthy controls (Normal) versus participants infected with influenza (FLU, left panel) or Normal versus participants infected with SARS-CoV-2 (COVID19, right panel). The biomarkers were identified from either (<bold>h</bold>) CNP0001102<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> or (<bold>i</bold>) GSE149689<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. Adobe Illustrator (version 27.1.1; <ext-link ext-link-type="uri" xlink:href="https://www.adobe.com/products/illustrator.html">https://www.adobe.com/products/illustrator.html</ext-link>) was used to arrange panels and edit text. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_37432_Fig4_HTML" id="d32e1284"/></fig></p>
      <p id="Par20">We used the 220 STATIC genes as input features and projected PBMCs in our scRNA-seq data onto a two-dimensional Uniform Manifold Approximation and Projection<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> (UMAP; Fig. <xref rid="Fig4" ref-type="fig">4c</xref>), which we refer to as sUMAP from now on. We also generated sUMAPs using the same 220 STATIC genes on three independent scRNA-seq datasets<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup> of PBMCs (Fig. <xref rid="Fig4" ref-type="fig">4d–f</xref>) in which cells were labeled as in the original studies. In all four cases, the 220 STATIC genes separated major cell types and most of their subtypes very well, suggesting that some STATIC genes are potentially good markers for cell types.</p>
      <p id="Par21">Gene scores are routinely computed from scATAC-seq data to infer expression of the corresponding genes and used to label cells in scATAC-seq data based on a scRNA-seq reference<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. We calculated the Pearson correlation between expression in scRNA-seq data and gene score in scATAC-seq data of the same genes across cell types and samples. Due to data sparseness, incomplete reference assembly, non-coding RNAs, and uncharacterized sequences, Pearson correlation could be calculated only on 10,608 (94.7%) of the 11,191 reliable genes (Fig. <xref rid="Fig4" ref-type="fig">4g</xref>). Interestingly, among genes with strong correlations (Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>), the correlation was mainly influenced by differences between cell types, which partially justifies the use of gene score for cell labeling on scATAC-seq data. Within individual cell types, the correlation however appeared to be poor across different samples, likely reflecting the complexity of gene regulation. Pearson correlation was obtained on 206 (93.6%) of the 220 STATIC genes with a median value of 0.70. In comparison, Pearson correlation was obtained on 403 (80%) of the top 500 highly variable genes (HVGs), which are widely used in dimension reduction on scRNA-seq data<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, with a significantly lower median value of 0.40 (<italic>p</italic> = 1.98 × 10<sup>−13</sup>, Mann–Whiney test; Supplementary Data <xref rid="MOESM9" ref-type="media">5d</xref>). We randomly paired unrelated genes, calculated the corresponding correlations between expression and gene score, and found that the obtained distribution had a 95% upper confidence bound at R<sub>0</sub> = 0.399 (Methods). Thus, any correlations below R<sub>0</sub> were not statistically better than those between random, unrelated gene pairs. A total of 7252 (68%) out of the 10,608 reliable genes and 201 (49.8%) out of the 403 HVGs had a correlation below R<sub>0</sub>, in comparison with 40 (19%) out of the 206 STATIC genes. To properly label cells in scATAC-seq data based on gene score approach, one should only use genes whose expression versus gene score correlations are above R<sub>0</sub>. Some STATIC genes might be good candidates for this purpose.</p>
      <p id="Par22">We further investigated how the 220 STATIC genes fared as potential disease biomarkers. Previously, two studies<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup> applied scRNA-seq to analyze PBMCs of healthy controls (Normal) and of patients infected with either influenza (FLU) or SARS-CoV-2 (COVID19). We reanalyzed the data using methods described in the original studies and identified differential expression genes (DEGs) distinguishing Normal versus FLU or Normal versus COVID19. For simplicity, DEGs from individual cell types were combined when compared with the 220 STATIC genes. Out of the 18,824 genes measured in the first study (CNP0001102)<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, 681 and 632 DEGs were identified for distinguishing Normal versus FLU and Normal versus COVID19, respectively. The corresponding overlap with the STATIC genes was 49 for Normal versus FLU (one-side hypergeometric <italic>p</italic> = 4.8 × 10<sup>−26</sup>) and 50 for Normal versus COVID19 (one-side hypergeometric <italic>p</italic> = 1.7 × 10<sup>−28</sup>, Fig. <xref rid="Fig4" ref-type="fig">4h</xref>). A total of 33,538 genes were measured in the second study (GSE149689)<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. A total of 126 STATIC genes (one-side hypergeometric <italic>p</italic> = 4.8 × 10<sup>−74</sup>) overlapped with the 3040 DEGs for Normal versus FLU while 86 STATIC genes (one-side hypergeometric <italic>p</italic> = 2.1 × 10<sup>−61</sup>) overlapped with the 1396 DEGs for Normal versus COVID19 (Fig. <xref rid="Fig4" ref-type="fig">4i</xref>). In all cases, the 220 STATIC genes were significantly enriched as DEGs, suggesting their potential for monitoring some disease conditions.</p>
      <p id="Par23">To illustrate that SPECT can handle scRNA-seq data of diverse sample types, we applied it to scRNA-seq data from a mouse brain study (GSE129788)<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. In the study scRNA-seq data was collected from brain tissues of eight young (2–3 months) and eight old (21–23 months) mice, from which 37,069 cells of high-quality data were labeled to 25 cell types, 14,699 genes were detected, marker genes for each of the 25 cell types were collected, and 1113 DEGs distinguishing young versus old mouse brains were identified from a subset of 15 cell types. The study was not longitudinal per se. We treated data from the eight samples of each age group as repeated measurements for the group, just like repeated measurements at different timepoints in a longitudinal study. Since SPECT does not utilize the ordering of timepoints, its usage to the data is justified. We collected up to 25 STATIC genes per cell type and obtained 304 unique genes from all 25 cell types (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>, Supplementary Data <xref rid="MOESM10" ref-type="media">6a</xref>). sUMAP using these 304 STATIC genes was able to separate the cell types as labeled in the original study very well (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>). Out of the 304 STATIC genes, 299 genes were identified in the original study as marker genes for the corresponding cell types (Fig. <xref rid="Fig5" ref-type="fig">5c</xref>, Supplementary Data <xref rid="MOESM10" ref-type="media">6b</xref>). From the 15 cell types having DEGs, we collected 234 STATIC genes that were significantly overlapped with the 1113 young versus old DEGs (<italic>n</italic> = 123, one-side hypergeometric <italic>p</italic> = 6.2 × 10<sup>−77</sup>, Fig. <xref rid="Fig5" ref-type="fig">5d</xref>). These results further demonstrated that some STATIC genes are good markers for cell types or biological conditions in the mouse brain study.<fig id="Fig5"><label>Fig. 5</label><caption><title>Properties of 304 STATIC genes of mouse brain tissue.</title><p><bold>a</bold> Heatmap of coefficient of variation (CV) of the 304 stable across time in cell-types (STATIC) genes that were identified from 25 cell types in the scRNA-seq data of a mouse brain study (GSE129788<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>). The CVs were evaluated based on pseudo-bulk intensities in brain tissues from either <italic>n</italic> = 8 young or <italic>n</italic> = 8 old mice. <bold>b</bold> Uniform Manifold Approximation and Projection (UMAP) using only the 304 STATIC genes as input features (sUMAP) on the same scRNA-seq data. Cells are labeled as in the original study. <bold>c</bold> Percentage of top STATIC genes that overlap with cell-type marker genes identified in the original study. Up to 25 top STATIC genes from each cell type are compared with the corresponding marker genes of the same cell type. <bold>d</bold> Venn diagram showing the overlap between the 234 STATIC genes identified from 15 out of the 25 cell types and biomarkers distinguishing young versus old mice that were identified in the original study from the same 15 cell types. Adobe Illustrator (version 27.1.1; <ext-link ext-link-type="uri" xlink:href="https://www.adobe.com/products/illustrator.html">https://www.adobe.com/products/illustrator.html</ext-link>) was used to arrange panels and edit text. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_37432_Fig5_HTML" id="d32e1465"/></fig></p>
    </sec>
    <sec id="Sec9">
      <title>Circos plots to reveal stability patterns of protein families</title>
      <p id="Par24">PALMO implements circos plots to display stability patterns from multiple single-cell data modalities together. We displayed the stability pattern of gene expression and gene score of six protein families that are essential for immunity in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, including human leukocyte antigens (HLAs, Fig. <xref rid="Fig6" ref-type="fig">6a</xref>), interferon regulatory factors (IRFs, Fig. <xref rid="Fig6" ref-type="fig">6b</xref>), interleukins (ILs, Fig. <xref rid="Fig6" ref-type="fig">6c</xref>), chemokine (C-X-C motif) receptor/ligand (CXCR/L) family (Fig. <xref rid="Fig6" ref-type="fig">6d</xref>), Janus kinases (JAKs) and signal transducer and activator of transcription proteins (STATs, Fig. <xref rid="Fig6" ref-type="fig">6e</xref>), and tumor necrosis factor receptor superfamily (TNFRSF, Fig. <xref rid="Fig6" ref-type="fig">6f</xref>). All these protein families showed diverse stability patterns among members and across cell types, with HLAs and ILs having the most striking contrasts. The rich variety in such stability patterns suggests that different members of same protein superfamilies may play different roles in individual cell types. We noticed that gene expression and gene score generally did not exhibit the same stability patterns despite the rather strong correlations between them (Supplementary Fig. <xref rid="MOESM1" ref-type="media">11</xref>). It turns out that strong correlations were mainly driven by difference between cell types rather than difference between samples, likely reflecting the complexity of gene regulation as mentioned before.<fig id="Fig6"><label>Fig. 6</label><caption><title>Circos plots showing stability patterns of five protein families.</title><p><bold>a</bold> Circos plot displaying stability patterns of gene expression (outer circles) and gene score (inner circles) of human leukocyte antigen (HLA) protein family (member: HLA-A, HLA-B, HLA-C, HLA-DRA, HLA-DPA1, and HLA-DRB1). Samples with missing data or cell types with low cell counts are shown in grey. <bold>b</bold>–<bold>f</bold> Same as (<bold>a</bold>) but for (<bold>b</bold>) interferon regulatory factors (IRFs; member: IRF1, IRF2, IRF3, IRF4, IRF5, and IRF8), (<bold>c</bold>) interleukins (ILs; member: IL32, IL7R, IL10RA, IL2RB, IL1B and IL18), (<bold>d</bold>) chemokine (C-X-C motif) receptor/ligand (CXCR/L) protein family (member: CXCR4, CXCR5, CXCR6, CXCL8, CXCL10, and CXCL16), (<bold>e</bold>) Janus kinase (JAK) and signal transducer and activator of transcription (STAT) protein family (member: JAK1, JAK2, JAK3, STAT3, STAT4, and STAT6), and (<bold>f</bold>) tumor necrosis factor receptor superfamily (TNFRSF; member: TNFRSF1B, TNFRSF13C, TNFRSF10B, TNFRSF25, TNFRSF11A, and TNFRSF17). The CV of gene expression for each of <italic>n</italic> = 4 participants was calculated from pseudo-bulk intensities in the corresponding 6 independent peripheral blood mononuclear cell (PBMC) samples. The CV of gene score for each participant was based on either 6 (for <italic>n</italic> = 2 participants) or 3 (for other <italic>n</italic> = 2 participants) PBMC samples. Adobe Illustrator (version 27.1.1; <ext-link ext-link-type="uri" xlink:href="https://www.adobe.com/products/illustrator.html">https://www.adobe.com/products/illustrator.html</ext-link>) was used to arrange panels and edit text. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_37432_Fig6_HTML" id="d32e1548"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Application of TCA to reveal heterogenous immune responses among COVID-19 patients</title>
      <p id="Par25">We applied TCA to analyze longitudinal scRNA-seq data of four COVID-19 patients, each having data of at least three timepoints, in a previous study<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> and identified significantly up- or down-regulated genes over time (adjusted <italic>p</italic> &lt; 0.05 and slope magnitude &gt;0.1, Fig. <xref rid="Fig7" ref-type="fig">7a–d</xref>, Supplementary Data <xref rid="MOESM11" ref-type="media">7a</xref>) and the corresponding pathways (Supplementary Data <xref rid="MOESM11" ref-type="media">7b</xref>). We observed rather heterogeneous immune responses by these patients during recovery (Fig. <xref rid="Fig7" ref-type="fig">7e</xref>), which was not presented in the original study.<fig id="Fig7"><label>Fig. 7</label><caption><title>Heterogeneous immune responses by COVID19 patients during recovery.</title><p><bold>a</bold> Volcano plot showing temporal expression changes of individual genes in different cell types during the recovery of patient COV-3 (female, 41 years old, mild symptoms, data on day D1/D4/D16), based on longitudinal scRNA-seq data in CNP0001102<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. The x-axis shows the slope (coefficient) of gene expression change as a linear function of time. The y-axis shows the corresponding adjusted p value of the slope. <bold>b</bold>–<bold>d</bold> Same as (<bold>a</bold>) but for patients (<bold>b</bold>) COV-2 (male, 45 years old, mild symptoms, data on D1/D4/D7/D10/D16), (<bold>c</bold>) COV-1 (male, 15 years old, mild symptoms, data on D1/D4/D16), and (<bold>d</bold>) COV−5 (female, 85 years old, severe symptoms, data on D1/D7/D13). <bold>a</bold>–<bold>d</bold> Each plot contains results on up to 18,824 genes in 13 cell types (up to 244,712 data points). <bold>e</bold> Counts of significantly upregulated (adjusted <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p &lt; 0.05$$\end{document}</tex-math><mml:math id="M20"><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${slope} &gt; 0.1$$\end{document}</tex-math><mml:math id="M22"><mml:mi>s</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.1</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq11.gif"/></alternatives></inline-formula>, red) and significantly downregulated (adjusted <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p &lt; 0.05$$\end{document}</tex-math><mml:math id="M24"><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${slope} &lt; -0.1$$\end{document}</tex-math><mml:math id="M26"><mml:mi>s</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:mn>0.1</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq13.gif"/></alternatives></inline-formula>, blue) genes during the recovery of the four COVID-19 patients in individual cell types. <bold>a</bold>–<bold>d</bold> The <italic>p</italic>-value for slope was calculated based on two-sided likelihood-ratio test and adjusted by Benjamini and Hochberg procedure for testing many genes. Adobe Illustrator (version 27.1.1; <ext-link ext-link-type="uri" xlink:href="https://www.adobe.com/products/illustrator.html">https://www.adobe.com/products/illustrator.html</ext-link>) was used to arrange panels and edit text. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_37432_Fig7_HTML" id="d32e1708"/></fig></p>
      <p id="Par26">Patient COV-3 had barely any significant genes except that IFI27 decreased in DCs, IFI44L decreased in naïve B cells, and IGLC3 decreased in plasma cells, suggesting possible dampening of immune modulation.</p>
      <p id="Par27">The significant genes of patient COV-2 included eighteen upregulated genes in monocytes, four genes each in memory B cells and naïve B cells, and twelve genes split among other six cell types. Gene enrichment analysis on the eighteen upregulated genes in monocytes revealed only one significant pathway: myeloid leukocyte mediated immunity (adjusted <italic>p</italic> = 0.044).</p>
      <p id="Par28">The significant genes of COV-1 included eleven upregulated and six downregulated genes in cycling plasma cells, seven upregulated and sixteen downregulated genes in cycling T cells, six downregulated genes in naïve B cells, and fifteen genes split among other seven cell types. The significant genes in cycling plasma cells were significantly enriched in five pathways including regulation of humoral immune response (adjusted <italic>p</italic> = 3.92 × 10<sup>−3</sup>), Fc receptor mediated stimulatory signaling pathway (adjusted <italic>p</italic> = 3.92 × 10<sup>−3</sup>), and immunoglobulin production (adjusted <italic>p</italic> = 0.011), indicating a predominant role of humoral immunity in the recovery of the patient.</p>
      <p id="Par29">Patient COV-5 had significant genes in almost all cell types except for DCs and monocytes, including eight upregulated and eight downregulated genes in memory B cells, six upregulated and six downregulated genes in naïve B cells, one upregulated and ten downregulated genes in activated CD4<sup>+</sup> T cells, two upregulated and eight downregulated genes in plasma cells, and 43 genes split among other seven cell types. Seven (58%) of the twelve significant genes in naïve B cells were also significant in memory B cells and in the same direction of change, suggesting common responses by the two cell types. The significant genes in memory B cells were enriched in interferon gamma (adjusted <italic>p</italic> = 3.28 × 10<sup>−6</sup>) and alpha (adjusted <italic>p</italic> = 4.86 × 10<sup>−5</sup>) response, antigen processing and presentation (adjusted <italic>p</italic> = 0.036), and antigen processing and presentation of peptide or polysaccharide antigen via MHC class II (adjusted <italic>p</italic> = 0.044). The significant genes in naïve B cells were enriched in interferon alpha (adjusted <italic>p</italic> = 1.96 × 10<sup>−5</sup>) and gamma (adjusted <italic>p</italic> = 1.96 × 10<sup>−5</sup>) response. The significant genes in plasma cells were enriched in innate and humoral immune responses (<italic>p</italic> = 3.46 × 10<sup>−4</sup> and <italic>p</italic> = 5.79 × 10<sup>−4</sup>, respectively) although both with an adjusted <italic>p</italic> = 0.084. These results aligned to the patient’s disease severity and advanced age.</p>
      <p id="Par30">For comparison, we also used Seurat to analyze patient COV-5 data of activated CD4<sup>+</sup> T cells. To satisfy Seurat’s requirement of selecting two contrast groups, we did the analysis in two iterations, i.e., day 1 (D1) versus D7 + D13 and D1 + D7 versus D13. We obtained 942 and 1018 DEGs (adjusted <italic>p</italic> &lt; 0.05), respectively, with an overlap of 813 DEGs (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12a</xref>). TCA identified 921 significantly up- or down-regulated genes (adjusted <italic>p</italic> &lt; 0.05), only 21 of which overlapped with both Seurat results. The genes obtained from TCA or Seurat were quite different. We collected top ten up- and top ten down-regulated genes from all three approaches and plotted the corresponding gene expression in heatmaps (Supplementary Fig. <xref rid="MOESM1" ref-type="media">12b–d</xref>). TCA results showed better dynamic changes over time than Seurat results in our opinion.</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par31">The five modules in PALMO analyze longitudinal omics data from multiple perspectives as continuous data. VDA provides a global view on the sources of variance within the whole dataset. TCA studies the time series of individual participants. CVP and SPECT first examine data of individual participants separately and then summarize the observations across different participants. All these four methods focus on individual features. ODA is the only method to provide a sample-level analysis. Which module(s) to use on a specific dataset depends on the research question of interest. Additional methods need to be developed for research interest not covered here.</p>
    <p id="Par32">We observed that a small set of STATIC genes, 220 for PBMC and 304 for mouse brain tissues, distinguished cell types well and captured some biological differences. The PBMC STATIC genes showed better correlation between gene expression in scRNA-seq data and gene score in scATAC-seq data than HVGs. It would be interesting to see whether these observations can be extended to scRNA-seq data of other sample types. We selected up to 25 STATIC genes per cell type in our analysis. It is possible that a better set of genes can be selected with a more sophisticated selection procedure.</p>
    <p id="Par33">Plasma proteins are often targeted as disease biomarkers, thus understanding their temporal stability is of particular interest. Conceptually, highly variable proteins are poor biomarker candidates since their values likely have very high sampling variations. The rather moderate CV values of the most variable proteins in our study suggest sampling variations are not a big concern on these proteins. The small CV values of the most stable proteins, on the other hand, indicate they do not change much under normal, healthy conditions. So, if they ever change under some disease conditions, they should be closely explored as potential biomarkers.</p>
    <p id="Par34">We condensed single-cell data into pseudo-bulk data in VDA, SPECT and ODA. Recent literature<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup> revealed that many single-cell methods fail to properly account for variations in cross-sectional scRNA-seq data and generate many false DEGs as a result. In comparison, pseudo-bulk approaches mostly generate reliable results although they may be underpowered. Longitudinal single-cell omics data is even more complicated than cross-sectional scRNA-seq data and may require new statistical methods to properly handle its many types of variations. Furthermore, memory and CPU requirements for using GLMMs to analyze longitudinal single-cell omics data at single-cell level may be challenging even for cloud-based computing. We adopted the pseudo-bulk approach in VDA, SPECT and ODA as a practical compromise. In TCA we bypassed some of the complications by analyzing data of individual cell types and of individual participants separately.</p>
    <p id="Par35">The lack of a well-accepted software package for longitudinal omics data makes it difficult to benchmark PALMO performance. We compared PALMO with variancePartition<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, tcR<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, and Seurat<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, which is summarized in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1c</xref>. VDA can handle missing data but variancePartition cannot, which is an advantage of VDA since missing values in longitudinal omics data are almost inevitable. The two tools generated almost identical results on two tested datasets after removing missing values. PALMO was not developed specifically for TCR data. When we applied VDA to the TCR data of SSc donors, we obtained results that are potentially interesting but not reported in the original study using tcR. We believe PALMO complements TCR specific tools (such as tcR) on TCR data. Seurat requires users to select two contrast groups in DEG analysis and thus is not appropriate for analyzing longitudinal data of more than two timepoints. Nevertheless, when we applied both TCA and Seurat to the longitudinal scRNA-seq data of activated CD4<sup>+</sup> T cells of a COVID-19 patient, the two methods generated rather different results on up- or down-regulated genes. Heatmaps of the corresponding top genes revealed that TCA results showed better dynamic changes over time than Seurat results.</p>
    <p id="Par36">PALMO has been published as an R package in CRAN with a detailed reference manual and vignettes to demonstrate its usage. It can be easily installed and executed in R or RStudio. As we demonstrated, it can be used to analyze longitudinal bulk and single-cell omics data generated on diverse technical platforms and/or of diverse sample types, including but not limited to: clinical lab test results, cell type composition, gene expression, protein abundance, bulk or single-cell omics data, TCR sequencing data, etc. We believe it can facilitate the analysis of some longitudinal omics data. In addition, our longitudinal multi-omics dataset of five data modalities on the same samples can also be a valuable resource for immune health study and software development.</p>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>Healthy donors</title>
      <p id="Par37">Blood samples were obtained from Bloodworks Northwest (Seattle, WA) through protocols approved by the Bloodworks Northwest institutional review board and complying with all relevant ethical regulations. We enrolled <italic>n</italic> = 6 clinically healthy participants (no diagnosis of active or chronic disease) with age between 25 to 38 years with equal self-report sex ratio. Viable peripheral blood mononuclear cells (PBMCs) and plasma samples were collected from each participant over <italic>t</italic> = 10 weeks. Complete blood count (CBC) was measured to evaluate overall health of all donors over all timepoints (<italic>n</italic> = 6, t = 10). Minimal biometric data were collected on these participants which were handled following the Health Insurance Portability and Accountability Act (HIPAA) guidelines. Informed consent to participate in the study and to publish data from the research was obtained from all participants.</p>
    </sec>
    <sec id="Sec14">
      <title>Sample handling</title>
      <p id="Par38">A volume of 30 mL of blood was drawn into BD NaHeparin vacutainer tubes (for PBMC; BD #367874) or K2-EDTA vacutainer tubes (for plasma; BD #367863). Upon arrival at the processing lab all NaHeparin tubes for each donor were pooled into a sterile plastic receptacle to establish one common pool and stored at room temperature until processing (4 h or less from draw). For PBMC isolation, at each time point the pool of blood was gently swirled until fully mixed, about 30 times, and a volume of blood was removed and combined with an equivalent volume of room temperature PBS (ThermoFisher #14190235). PBMC were isolated using one or more Leucosep tubes (Greiner Bio-One #227290) loaded with 15 mL of Ficoll Premium (GE Healthcare #17-5442-03) to which a 3 mL cushion of PBS had been slowly added on top of the Leucosep barrier. The 24–30 mL diluted whole blood was slowly added to the tube and spun at 1000xg for 10 min at 20 °C with no brake. PBMC were recovered from the Leucosep tube by quickly pouring all volume above the barrier into a sterile 50 mL conical tube; 15 mL cold PBS + 0.2% BSA (Sigma #A9576; “PBS + BSA”) was added, and the cells were pelleted at 400xg for 5–10 min at 4–10 °C. The supernatant was quickly decanted, the pellet dispersed by flicking the tube, and the cells washed with 25–50 mL cold PBS + BSA. Cell pellets were combined, if applicable, the cells were pelleted as before, supernatant quickly decanted, and residual volume was carefully aspirated. The PBMC were resuspended in 1 mL cold PBS + BSA per 15 mL whole blood processed and counted with a Cellometer Spectrum (Nexcelom) using Acridine Orange/Propidium Iodide solution. PBMC were cryopreserved 90% FBS (ThermoFisher #10438026)/10% DMSO (Fisher Scientific #<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/D12345">D12345</ext-link>) at 1–5 × 106 cells/mL by slow freezing in a Coolcell LX (VWR #75779-720) overnight in a −80 °C freezer followed by transfer to liquid nitrogen.</p>
      <p id="Par39">For plasma isolation, the K2-EDTA source tube was gently inverted 10 times, and the appropriate volume of whole blood was extracted using an 18-gauge needle and syringe and transferred to a similar plastic tube with no additives (Greiner Bio-One #456085). The blood was centrifuged at 2000xg for 15 min at 20 °C with a brake of 1, and 80%–90% of the plasma supernatant were removed by careful pipetting for immediate freezing at −80 °C. Plasma was assayed after the first freeze/thaw. Thawed PBMC of four donors over six timepoints (<italic>n</italic> = 4, <italic>t</italic> = 6) were assayed by flow cytometry, scRNA-seq and scATAC-seq in two batches (donors PTID5 and PTID6, donors PTID2 and PTID4) by a team of operators. Plasma of all donors over all timepoints (<italic>n</italic> = 6, <italic>t</italic> = 10) was isolated and cryopreserved by a team of operators<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.</p>
    </sec>
    <sec id="Sec15">
      <title>Flow cytometry</title>
      <p id="Par40">PBMC were removed from liquid nitrogen storage and immediately thawed in a 37 °C water bath. Cells were diluted dropwise into 37 °C AIM V media (Thermo Fisher Scientific #12055091) up to a final volume of 10 mL. A single wash was performed in 10 mL of PBS + BSA, pelleting cells at 400xg for 5–10 min at 4–10 °C. PBMC were resuspended 2 mL in PBS + BSA and counted using a Cellometer Spectrum. 1–2 × 10<sup>6</sup> cells were incubated with Human TruStain FcX (BioLegend #422302) and Fixable Viability Stain 510 (BD #564406) prior to staining with a 25-color cell surface panel on ice for 25 min. Cells were washed and fixed with 4% paraformaldehyde (Electron Microscopy Sciences #15713) prior to acquisition on a BD Symphony cytometer. Raw data were compensated and curated to remove unrepresentative events due to instrument fluidics variability (time gating), doublets (by FSC-H and FSC-W), and cells exhibiting membrane permeability (live/dead gating) prior to quantification using BD FlowJo software v10.6.1.</p>
    </sec>
    <sec id="Sec16">
      <title>Proteomics</title>
      <p id="Par41">Plasma samples were submitted to Olink (Uppsala, Sweden) for assay using the Olink Proximity Extension assay, run on the Fluidigm Biomark system. Patient samples were distributed evenly across two plates, and all time points per patient were run on the same plate, with randomized well locations. Samples were assayed using the Olink Discovery Assay which encompasses a total of 1156 proteins across 13 panels (Cardiometabolic [V.3603], Cardiovascular II [V.5006], Cardiovascular III [V.6113], Cell Regulation [V.3701], Development [V.3512], Immune Response [V.3202], Inflammation [V.3021], Metabolism [V.3402], Neuro Exploratory [V.3901], Neurology [V.8012], Oncology II [V.7004], Oncology III [V.4001], Organ Damage [V.3311]). Quality assessment, limit of detection, and normalization were performed by Olink using the plate bridging control, two positive controls, and three background controls.</p>
    </sec>
    <sec id="Sec17">
      <title>Single-cell RNA-seq</title>
      <sec id="Sec18">
        <title>Sample preparation, hashing, and pooling</title>
        <p id="Par42">Single-cell RNA-seq libraries were generated on PBMC prepared as above using the 10x Genomics Chromium 3’ Single Cell Gene Expression assay (#1000121) and Chromium Controller Instrument according to the manufacturer’s published protocol with modifications for cell hashing<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. To block off-target antibody binding, Blocking Solution (5 µL of Human Trustain FcX (BioLegend #422302), and 13.7 µL of a 10% Bovine Serum Albumin (BSA)) was added to 500,000 cells suspended in 50 µL Dulbecco’s Phosphate Buffered Saline (DPBS; Corning Life Sciences #21-031-CM) and incubated for 10 min on ice. To stain samples, 0.5 µg (1 µL) of a TotalSeq™-A anti-human Hashtag Antibody was suspended in 31.3 µL DPBS/2% BSA, then added to each sample. For each batch of samples, 100,000 cells from 12 hashed samples with a distinct Hashtag Antibody were pooled into the hashed pool. Roughly 20,000 cells from a Leukopak healthy control were also labeled with a distinct TotalSeq™-A Hashtag Antibody and were spiked into each pool to serve as a batch control.</p>
      </sec>
      <sec id="Sec19">
        <title>Droplet encapsulation and reverse transcription</title>
        <p id="Par43">From each pool, 64,000 cells were loaded into each well of a Chromium Single Cell Chip G (10x Genomics #1000073) (8 wells per chip), targeting a recovery of 20,000 singlets from each well. Gel Beads-in-emulsion (GEMs) were then generated using the 10x Chromium Controller. The resulting GEM generation products were then transferred to semi-skirted 96-well plates and reverse transcribed on a C1000 Touch Thermal Cycler (Bio-Rad) programmed at 53 °C for 45 min, 85 °C for 5 min, and a hold at 4 °C. Following reverse transcription, GEMs were broken, and the pooled single-stranded cDNA and Hashtag Oligo fractions were recovered using Silane magnetic beads (Dynabeads MyOne SILANE #37002D).</p>
      </sec>
      <sec id="Sec20">
        <title>Library generation and separation</title>
        <p id="Par44">Barcoded, full-length cDNA including the Hashtag Oligos (HTOs) from the TotalSeq™-A Hashtag Antibodies were then amplified with a C1000 Touch Thermal Cycler programmed at 98 °C for 3 min, 11 cycles of (98 °C for 15 s, 63 °C for 20 s, 72 °C for 1 min), 72 °C for 1 min, and a hold at 4 °C. Amplified cDNA was purified and separated from amplified HTOs using a 0.6x size selection via SPRIselect magnetic bead (Beckman Coulter #22667) and a 1:10 dilution of the resulting cDNA was run on a Fragment Analyzer (Agilent Technologies #5067-4626) to assess cDNA quality and yield. HTO libraries were purified further with SPRIselect magnetic bead (Beckman Coulter #22667) and amplified and indexed with a custom HTO i7 index on a C1000 Touch Thermal Cycler programmed at 95 °C for 3 min, 10 cycles of (95 °C for 20 s, 64 °C for 30 s, 72 °C for 20 s), 72 °C for 1 min, and a hold at 4 °C. The resulting HTO libraries were purified with SPRIselect magnetic bead (Beckman Coulter #22667) post-amplification and a 1:10 dilution of the resulting HTO libraries were run on a Fragment Analyzer (Agilent Technologies #5067-4626) to assess HTO quality and yield. A quarter of the cDNA sample (10 ul) was used as input for library preparation. Amplified cDNA was fragmented, end-repaired, and A-tailed is a single incubation protocol on a C1000 Touch Thermal Cycler programmed at 4 °C start, 32 °C for min, 65 °C for 30 min, and a 4 °C hold. Fragmented and A-tailed cDNA was purified by performing a dual-sided size-selection using SPRIselect magnetic beads (Beckman Coulter #22667). A partial TruSeq Read 2 primer sequence was ligated to the fragmented and A-tailed end of cDNA molecules via an incubation of 20 °C for 15 min on a C1000 Touch Thermal Cycler. The ligation reaction was then cleaned using SPRIselect magnetic beads (Beckman Coulter #22667). PCR was then performed to amplify the library and add the P5 and indexed P7 ends (10x Genomics #1000084) on a C1000 Touch Thermal Cycler programmed at 98 °C for 45 sec, 13 cycles of (98 °C for 20 sec, 54 °C for 30 sec, 72 °C for 20 sec), 72 °C for 1 min, and a hold at 4 °C. PCR products were purified by performing a dual-sided size-selection using SPRIselect magnetic beads (Beckman Coulter #22667) to produce final, sequencing-ready libraries.</p>
      </sec>
      <sec id="Sec21">
        <title>Quantification and sequencing</title>
        <p id="Par45">Final libraries were quantified using Picogreen and their quality was assessed via capillary electrophoresis using the Agilent Fragment Analyzer HS DNA fragment kit and/or Agilent Bioanalyzer High Sensitivity chips. Libraries were sequenced on the Illumina NovaSeq platform using S4 flow cells. Read lengths were 28 bp read1, 8 bp i7 index read, 91 bp read2.</p>
      </sec>
      <sec id="Sec22">
        <title>scRNA-seq data pre-processing</title>
        <p id="Par46">scRNA-seq data of four donors were generated in two batches, each containing data of two donors. Each batch of data was pre-processed separately<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. Briefly, binary base call (BCL) files were demultiplexed using the mkfastq function in the 10x Cell Ranger software (version 3.1.0), producing fastq files. Fastq files were then checked for quality (FastQC version 0.11.3) and run through the 10x Cell Ranger alignment function (cell ranger count) against the human reference annotation (Ensembl GRCh38). Mapping was performed using default parameters. Upon completion, Cell Ranger produced an output directory per file that contains the following: bam file (binary alignment file), HDF5 file (Hierarchical Data Format) with all reads, HDF file containing just the filtered reads, summary report (html and csv), and cloupe.cloupe (a file for the 10x Loupe visual browser).</p>
      </sec>
      <sec id="Sec23">
        <title>scRNA-seq data analysis</title>
        <p id="Par47">Individual HDF5 files (filtered) were loaded into the R statistical programming language (version 3.6.0) using Bioconductor (version 3.1.0) and the Seurat package (version 3.1.5)<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. For simplicity, sample names were captured as a list in R and iteratively processed within a loop (refer to <ext-link ext-link-type="uri" xlink:href="https://satijalab.org/seurat/">https://satijalab.org/seurat/</ext-link> for more information). Within the loop, samples were normalized with the NormalizeData function followed by the FindVariableFeatures function with parameters: vst selection method and 2000 features. Label transfer was performed using previously published procedures<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> and with the Seurat reference dataset. Labeling included the FindTransferAnchors and TransferData functions performed in the Seurat package.</p>
        <p id="Par48">We merged the two batches of data using the Seurat <italic>merge</italic> function. We calculated read depth, mitochondrial percentage, and number of UMIs per sample. Cells were filtered with nFeature_RNA &gt; 200 and percent.mt &lt;10. The merged data structure was normalized (using NormalizeData and FindVariableFeatures functions) and then saved as an RDS for further analysis. The top 3000 variable genes were used for PCA and UMAP based dimension-reduction maps using 30 principal components (PCs). We checked for possible batch effects using the bridging controls but did not observe any obvious batch effects.</p>
        <p id="Par49">Cell labels obtained from the original batches were kept. Doublets were removed from further analysis. In total we retrieved high quality data of 472,464 cells from 4 donors and labeled them to 31 cell types from Seurat level 2 labelling. The cell type frequencies in each sample were calculated and compared with flow-based cell frequencies. Nineteen cell types (CD4_Naive, CD4_TEM, CD4_TCM, CD4_CTL, CD8_Naive, CD8_TEM, CD8_TCM, Treg, MAIT, gdT, NK, NK_CD56bright, B_naive, B_memory, B_intermediate, CD14_Mono, CD16_Mono, cDC2, pDC) were selected for further analysis after filtering out cell types with a low frequency (&lt;0.5%).</p>
      </sec>
    </sec>
    <sec id="Sec24">
      <title>Single-cell ATAC-seq</title>
      <sec id="Sec25">
        <title>Sample preparation</title>
        <p id="Par50">Permeabilized-cell scATAC-seq was performed. A 5% w/v digitonin stock was prepared by diluting powdered digitonin (MP Biomedicals, 0215948082) in DMSO (Fisher Scientific, D12345), which was stored in 20 µL aliquots at −20 °C until use. To permeabilize, 1 × 106 cells were added to a 1.5 mL low binding tube (Eppendorf, 022431021) and centrifuged (400×g for 5 min at 4 °C) using a swinging bucket rotor (Beckman Coulter Avanti J-15RIVD with JS4.750 swinging bucket, B99516). Cells were resuspended in 100 µL cold isotonic Permeabilization Buffer (20 mM Tris-HCl pH 7.4, 150 mM NaCl, 3 mM MgCl2, 0.01% digitonin) by pipette-mixing 10 times, then incubated on ice for 5 min, after which they were diluted with 1 mL of isotonic Wash Buffer (20 mM Tris-HCl pH 7.4, 150 mM NaCl, 3 mM MgCl2) by pipette-mixing five times. Cells were centrifuged (400 × g for 5 min at 4 °C) using a swinging bucket rotor, and the supernatant was slowly removed using a vacuum aspirator pipette. Cells were resuspended in a chilled TD1 buffer (Illumina, 15027866) by pipette-mixing to a target concentration of 2300–10,000 cells per µL. Cells were filtered through 35 µm Falcon Cell Strainers (Corning, 352235) before counting on a Cellometer Spectrum Cell Counter (Nexcelom) using ViaStain acridine orange/propidium iodide solution (Nexcelom, C52-0106-5).</p>
      </sec>
      <sec id="Sec26">
        <title>Tagmentation and fragment capture</title>
        <p id="Par51">scATAC-seq libraries were prepared according to the Chromium Single Cell ATAC v1.1 Reagent Kits User Guide (CG000209 Rev B) with several modifications. 19,000 cells were loaded into each tagmentation reaction. Permeabilized cells were brought up to a volume of 12 µl in TD1 buffer (Illumina, 15027866) and mixed with 3 µl of Illumina TDE1 Tn5 transposase (Illumina, 15027916). Transposition was performed by incubating the prepared reactions on a C1000 Touch thermal cycler with 96–Deep Well Reaction Module (Bio-Rad, 1851197) at 37 °C for 60 min, followed by a brief hold at 4 °C. A Chromium NextGEM Chip H (10x Genomics, 2000180) was placed in a Chromium Next GEM Secondary Holder (10x Genomics, 3000332) and 50% Glycerol (Teknova, G1798) was dispensed into all unused wells. A master mix composed of Barcoding Reagent B (10x Genomics, 2000194), Reducing Agent B (10x Genomics, 2000087), and Barcoding Enzyme (10x Genomics, 2000125) was then added to each sample well, pipette-mixed, and loaded into row 1 of the chip. Chromium Single Cell ATAC Gel Beads v1.1 (10x Genomics, 2000210) were vortexed for 30 s and loaded into row 2 of the chip, along with Partitioning Oil (10x Genomics, 2000190) in row 3. A 10x Gasket (10x Genomics, 370017) was placed over the chip and attached to the Secondary Holder. The chip was loaded into a Chromium Single Cell Controller instrument (10x Genomics, 120270) for GEM generation. At the completion of the run, GEMs were collected, and linear amplification was performed on a C1000 Touch thermal cycler with 96–Deep Well Reaction Module: 72 °C for 5 min, 98 °C for 30 sec, 12 cycles of: 98 °C for 10 sec, 59 °C for 30 sec and 72 °C for 1 min.</p>
      </sec>
      <sec id="Sec27">
        <title>Sequencing library preparation</title>
        <p id="Par52">GEMs were separated into a biphasic mixture through addition of Recovery Agent (10x Genomics, 220016), the aqueous phase was retained and removed of barcoding reagents using Dynabead MyOne SILANE (10x Genomics, 2000048) and SPRIselect reagent (Beckman Coulter, B23318) bead clean-ups. Sequencing libraries were constructed by amplifying the barcoded ATAC fragments in a sample indexing PCR consisting of SI-PCR Primer B (10x Genomics, 2000128), Amp Mix (10x Genomics, 2000047) and Chromium i7 Sample Index Plate N, Set A (10x Genomics, 3000262) as described in the 10x scATAC User Guide. Amplification was performed in a C1000 Touch thermal cycler with 96–Deep Well Reaction Module: 98 °C for 45 sec, for 11 cycles of: 98 °C for 20 sec, 67 °C for 30 sec, 72 °C for 20 sec, with a final extension of 72 °C for 1 min. Final libraries were prepared using a dual-sided SPRIselect size-selection cleanup. SPRIselect beads were mixed with completed PCR reactions at a ratio of 0.4x bead:sample and incubated at room temperature to bind large DNA fragments. Reactions were incubated on a magnet, the supernatant was transferred and mixed with additional SPRIselect reagent to a final ratio of 1.2x bead:sample (ratio includes first SPRI addition) and incubated at room temperature to bind ATAC fragments. Reactions were incubated on a magnet, the supernatant containing unbound PCR primers and reagents was discarded, and DNA bound SPRI beads were washed twice with 80% v/v ethanol. SPRI beads were resuspended in Buffer EB (Qiagen, 1014609), incubated on a magnet, and the supernatant was transferred resulting in final, sequencing-ready libraries.</p>
      </sec>
      <sec id="Sec28">
        <title>Quantification and sequencing</title>
        <p id="Par53">Final libraries were quantified using a Quant-iT PicoGreen dsDNA Assay Kit (Thermo Fisher Scientific, P7589) on a SpectraMax iD3 (Molecular Devices). Library quality and average fragment size was assessed using a Bioanalyzer (Agilent, G2939A) High Sensitivity DNA chip (Agilent, 5067-4626). Libraries were sequenced on the Illumina NovaSeq platform with the following read lengths: 51nt read 1, 8nt i7 index, 16nt i5 index, 51nt read 2.</p>
      </sec>
      <sec id="Sec29">
        <title>scATAC data pre-processing</title>
        <p id="Par54">scATAC-seq data were available for donor PTID2 and PTID4 at week 2–7 (6 timepoints) and for PTID5 and PTID6 at week 2, 4, and 7. scATAC-seq libraries were processed. In brief, cellranger-atac mkfastq (10x Genomics v1.1.0) was used to demultiplex BCL files to FASTQ. FASTQ files were aligned to the human genome (10x Genomics refdata-cellranger-atac-GRCh38-1.1.0) using cellranger-atac count (10x Genomics v1.1.0) with default settings. scATAC fragments were submitted to the ArchR package to create the ArchR object<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. Per-cell quality control (QC) was performed using methods as mentioned in ArchR. The QC analysis showed FRiP score (the fraction of reads that fall into a peak) &gt;0.25. The TSS enrichment and log10(nFrags) data showed comparable range across all samples. Doublets were removed using filterDoublets() function. In total we observed 294,623 peaks in 135,566 cells.</p>
      </sec>
      <sec id="Sec30">
        <title>scATAC-seq data analysis</title>
        <p id="Par55">Using plotEmbedding function in ArchR, embedded IterativeLSI was used to perform UMAP based dimension reduction. Unconstrained integration was used to align scATAC-seq gene score matrix in ArchR object with the corresponding scRNA-seq gene expression matrix, from which cells were labeled to 28 cell types along with labeling scores to measure the quality of the cell-label transfer. We filtered out low quality cells (labeling score &lt;0.5), removed cell types having less than 50 remaining cells, and kept 14 (B_intermediate, B_naive, CD14_Mono, CD16_Mono, CD4_Naive, CD4_TCM, CD8_Naive, CD8_TEM, cDC2, gdT, MAIT, NK, NK_CD56bright, and pDC) out of the 28 cell types for downstream analysis. The gene score matrix was retrieved using the getGroupSE() function in ArchR<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and used for downstream analysis by PALMO.</p>
      </sec>
    </sec>
    <sec id="Sec31">
      <title>Reagents and resources</title>
      <p id="Par56">Critical reagents and resources used in our experiments are listed in Supplementary Data <xref rid="MOESM12" ref-type="media">8</xref>.</p>
    </sec>
    <sec id="Sec32">
      <title>PALMO</title>
      <sec id="Sec33">
        <title>Overview</title>
        <p id="Par57">The current version of PALMO contains five analytical modules to analyze longitudinal omics data from multiple perspectives. It treats longitudinal omics data as continuous variables. PALMO has been published as an R package in CRAN with a detailed reference manual and vignettes to demonstrate its usage (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/PALMO/index.html">https://cran.r-project.org/web/packages/PALMO/index.html</ext-link>). It can be easily installed and executed in R or RStudio.</p>
      </sec>
      <sec id="Sec34">
        <title>PALMO S4 object</title>
        <p id="Par58">PALMO is a R based package that uses the setClass function to create an S4 object oriented system. The S4 object consists of a list of data structures with different types of elements such as strings, numbers, vectors, embedded lists, etc. It stores input expression data, input metadata, and output results into separate data structures for easy retrieval and interpretation. More details can be found in Section 3.9 of PALMO vignettes (<ext-link ext-link-type="uri" xlink:href="https://raw.githubusercontent.com/aifimmunology/PALMO/main/Vignette-PALMO.pdf">https://raw.githubusercontent.com/aifimmunology/PALMO/main/Vignette-PALMO.pdf</ext-link>).</p>
        <p id="Par59">Function <italic>createPALMOobject()</italic> takes two inputs (<italic>anndata</italic> and <italic>data</italic>) to create an PALMO S4 object: <italic>anndata</italic> is a data frame containing sample annotations. For longitudinal bulk data, <italic>data</italic> is a data frame with features (such as genes or proteins) as rows, samples as columns, and expression values as elements. For longitudinal single-cell omics data, <italic>data</italic> is a Seurat object. For single-cell omics data without a Seurat object, function <italic>createPALMOfromsinglecellmatrix()</italic> first creates a Seurat object from an expression matrix or data frame and then creates a PALMO S4 object. Function <italic>annotateMetadata()</italic> assigns columns in the original sample annotation data to designated variables (<italic>sample_column</italic>, <italic>donor_column</italic>, and <italic>time_column</italic>) of the PALMO object for longitudinal analysis. Function <italic>mergePALMOdata()</italic> cleans up the PLAMO object by filtering out data missing essential information on <italic>sample_column</italic>, <italic>donor_column</italic>, or <italic>time_column</italic>. Function <italic>checkReplicates()</italic> first checks whether there are replicated samples at the same time points and of the same participants and, if yes, takes the median values among replicated samples. Function <italic>avgExpCalc()</italic> carries out pseudo-bulking on single-cell omics data. Function <italic>naFilter()</italic> filters out data whose fraction of NAs is above <italic>na_cutoff</italic> (default: 0.4).</p>
      </sec>
      <sec id="Sec35">
        <title>Variance decomposition analysis (VDA)</title>
        <p id="Par60">For variance decomposition, we want to evaluate contributions from factors of interest <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ {F}_{i}\}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq14.gif"/></alternatives></inline-formula> to the total variance of analyte Y with or without the influence of fixed effects <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{X}_{j}\}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq15.gif"/></alternatives></inline-formula>. Some <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ {F}_{i}\}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{X}_{j}\}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq17.gif"/></alternatives></inline-formula> may be the same variables. We treat <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{F}_{i}\}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq18.gif"/></alternatives></inline-formula> as random effects in a linear mixed model, that is, with fixed effects,<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y\, \sim \,{X}_{1}+{X}_{2}+\ldots+{X}_{m}+\,\left(1{{{{{\rm{|}}}}}}{F}_{1}\right)+\left({1{{{{{\rm{|}}}}}}F}_{2}\right)+\ldots+(1{{{{{\rm{|}}}}}}{F}_{n}).$$\end{document}</tex-math><mml:math id="M38"><mml:mi>Y</mml:mi><mml:mspace width="0.25em"/><mml:mo>~</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">∣</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">∣</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">∣</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2023_37432_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par61">Or, without fixed effects,<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y\, \sim \,\left(1{{{{{\rm{|}}}}}}{F}_{1}\right)+\left({1{{{{{\rm{|}}}}}}F}_{2}\right)+\ldots+(1{{{{{\rm{|}}}}}}{F}_{n}).$$\end{document}</tex-math><mml:math id="M40"><mml:mi>Y</mml:mi><mml:mspace width="0.25em"/><mml:mo>~</mml:mo><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">∣</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">∣</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">∣</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2023_37432_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par62">Using lme4<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>, one can obtain the corresponding variance <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{i}^{2}$$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq19.gif"/></alternatives></inline-formula>, including the residual variance <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{R}^{2}$$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq20.gif"/></alternatives></inline-formula>. Then the total variance of Y is given by<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma}_{total}^{2}={\sigma}_{1}^{2}+{\sigma}_{2}^{2}+\ldots+{\sigma}_{n}^{2}+{\sigma}_{R}^{2}.$$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2023_37432_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par63">The proportion of variance explained by factor <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${F}_{i}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq21.gif"/></alternatives></inline-formula> is then <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{i}^{2}/{\sigma }_{{total}}^{2}$$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq22.gif"/></alternatives></inline-formula>. Similar approach was used in variancePartition<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> where the percentage of variance explained was interpreted as the intra-class correlation (ICC). VDA can be performed with the function <italic>lmeVariance()</italic>. VDA results can be displayed with functions <italic>variancefeaturePlot()</italic> and <italic>gene_featureplot()</italic>.</p>
      </sec>
      <sec id="Sec36">
        <title>Coefficient of variation (CV) profiling (CVP)</title>
        <p id="Par64">CVP is designed for bulk longitudinal data and contains two functions: (1) Function <italic>cvCalcBulkProfile()</italic> calculates CV of all features and generates the corresponding CV profile. (2) Function <italic>cvCalcBulk()</italic> identifies consistently stable and variable features, which has two important parameters: Parameter <italic>cvThreshold</italic> (default: 5%) specifies the CV cutoff for distinguishing stable (CV &lt; <italic>cvThreshold</italic>) or variable (CV &gt; <italic>cvThreshold</italic>) features. Parameter <italic>donorThreshold</italic> (default: the total number of donors) defines the minimum number of donors on which a feature needs to be stable or variable to be considered as consistently stable or variable. One may choose <italic>cvThreshold</italic> as the mode of the corresponding CV distribution.</p>
      </sec>
      <sec id="Sec37">
        <title>Stability pattern evaluation across cell types (SPECT)</title>
        <p id="Par65">SPECT is the CVP counterpart for single-cell data and contains the following functions: (1) Function <italic>cvCalcSCProfile()</italic> calculates the CVs of all features in individual cell types and of individual donors and generates the corresponding CV profile. (2) Function <italic>cvSCsampleprofile()</italic> calculates the CVs of all features of individual donors regardless of difference in cell types and generates the corresponding CV profile. (3) Function <italic>cvCalcSC()</italic> determines whether individual features are stable (CV &lt; <italic>cvThreshold</italic>) or variable (CV &gt; <italic>cvThreshold</italic>) in individual cell types and of individual donors. One may choose <italic>cvThreshold</italic> as the mode of the corresponding CV distribution or a convenient value based on the CVs of housekeeping genes. (4) Function <italic>VarFeatures()</italic> first counts how many times individual features are variable in cell type-donor combinations and then classifies variable features as follows: Features whose counts are above parameter <italic>groupThreshold</italic> are classified as super variable (SUV). Features whose counts are below <italic>groupThreshold</italic> but which are consistently variable across all donors in at least one cell type are classified as variable across time in cell-types (VATIC). The default <italic>groupThreshold</italic> value is set to <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{{donor}}*{N}_{{celltype}}/2$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq23.gif"/></alternatives></inline-formula> where <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{{donor}}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq24.gif"/></alternatives></inline-formula> is the number of donors and <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{{celltype}}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq25.gif"/></alternatives></inline-formula> is the number of cell types. (5) Function <italic>StableFeatures()</italic> is similar to <italic>VarFeatures()</italic> but classifies stable features as super stable (SUS) or stable across time in cell-types (STATIC). (6) Function <italic>dimUMAPPlot()</italic> generates a UMAP plot using a set of selected genes as input.</p>
      </sec>
      <sec id="Sec38">
        <title>Outlier detection analysis (ODA)</title>
        <p id="Par66">ODA applies both graphic and statistical methods to examine the temporal behavior of longitudinal data. Function <italic>sample_correlation()</italic> calculates intra- and inter-donor correlations (across analytes) and displays the results in a heatmap. Timepoints showing obvious weaker correlations with other timepoints are potential outliers. To detect abnormal timepoints, function <italic>outlierDetect()</italic> first calculates the mean and the standard deviation (SD) of each analyte from samples of the same donor across all timepoints, calculates <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z=\frac{{value}-{mean}}{{SD}}$$\end{document}</tex-math><mml:math id="M58"><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq26.gif"/></alternatives></inline-formula> for the analyte at individual timepoints, and then counts at individual timepoints how many analytes are outliers with <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|z\right| &gt; {z}_{0}$$\end{document}</tex-math><mml:math id="M60"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq27.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{0}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq28.gif"/></alternatives></inline-formula> is a user selected cutoff value. Assuming <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z$$\end{document}</tex-math><mml:math id="M64"><mml:mi>z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq29.gif"/></alternatives></inline-formula> follows a normal distribution, it is straightforward to calculate the expected rate <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M66"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq30.gif"/></alternatives></inline-formula> of analytes having <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|z\right| &gt; {z}_{0}$$\end{document}</tex-math><mml:math id="M68"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq31.gif"/></alternatives></inline-formula> (two-sided) or having <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z &gt; {z}_{0}$$\end{document}</tex-math><mml:math id="M70"><mml:mi>z</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq32.gif"/></alternatives></inline-formula> or <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z &lt; -{z}_{0}$$\end{document}</tex-math><mml:math id="M72"><mml:mi>z</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq33.gif"/></alternatives></inline-formula> (one-sided). Afterwards function <italic>outlierDetectP()</italic> uses binomial tests to evaluate the p values for the counts of outliers at individual timepoints and applies Benjamini and Hochberg procedure to adjust the <italic>p</italic> values since multiple timepoints are tested. A donor-specific abnormal timepoint is identified if the corresponding adjusted <italic>p</italic> value is less than 0.05. In this study we chose <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{0}=2.5$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq34.gif"/></alternatives></inline-formula> and thus <inline-formula id="IEq35"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=1.24\%$$\end{document}</tex-math><mml:math id="M76"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1.24</mml:mn><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq35.gif"/></alternatives></inline-formula> for <inline-formula id="IEq36"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|z\right| &gt; 2.5$$\end{document}</tex-math><mml:math id="M78"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mn>2.5</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq36.gif"/></alternatives></inline-formula> or <inline-formula id="IEq37"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=0.62\%$$\end{document}</tex-math><mml:math id="M80"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.62</mml:mn><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq37.gif"/></alternatives></inline-formula> for <inline-formula id="IEq38"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z &gt; 2.5$$\end{document}</tex-math><mml:math id="M82"><mml:mi>z</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2.5</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq38.gif"/></alternatives></inline-formula> or <inline-formula id="IEq39"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z &lt; -2.5$$\end{document}</tex-math><mml:math id="M84"><mml:mi>z</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:mn>2.5</mml:mn></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq39.gif"/></alternatives></inline-formula>. While the <inline-formula id="IEq40"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z$$\end{document}</tex-math><mml:math id="M86"><mml:mi>z</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_37432_Article_IEq40.gif"/></alternatives></inline-formula>-score method described here can handle data with only three timepoints, Dixon’s test may be a better alternative for such a small dataset.</p>
      </sec>
      <sec id="Sec39">
        <title>Time course analysis (TCA)</title>
        <p id="Par67">Function <italic>sclongitudinalDEG()</italic> uses the hurdle model implemented in the MAST package (<ext-link ext-link-type="uri" xlink:href="https://github.com/RGLab/MAST/">https://github.com/RGLab/MAST/</ext-link>) to study temporal changes in longitudinal scRNA-seq data. The data is first split into subsets of individual cell types and individual participants and then analyzed independently. If the data has at least three timepoints, the function models normalized expression of each gene as a linear function of time and evaluates the slope of time and the corresponding <italic>p</italic> value (likelihood ratio test). If the data has only two timepoints, the function performs DEG analysis between the two timepoints as implemented in MAST and obtains fold change and the corresponding <italic>p</italic> value. Potential confounding factors (such as experimental batch, sex, age, etc.) can be specified by parameter <italic>adjfac</italic> which are adjusted in the analysis. Genes that are expressed in less than a certain fraction of cells (specified by parameter <italic>mincellsexpressed</italic>, default 0.1) are filtered out from the analysis. Obtained <italic>p</italic>-values are adjusted for multiple comparisons using the Benjamini and Hochberg procedure. Adjusted <italic>p</italic>-value &lt;0.05 were considered significant in this study.</p>
      </sec>
      <sec id="Sec40">
        <title>Circos plots for displaying stability patterns</title>
        <p id="Par68">PALMO has two functions to show the stability patterns of single-cell omics data. Function <italic>genecircosPlot()</italic> displays the CV values of features of interest in individual cell types and across individual donors based on a single data modality. Function <italic>multimodalView()</italic> displays the CV values of features of interest in individual cell types and across individual donors based on two independent data modalities.</p>
      </sec>
    </sec>
    <sec id="Sec41">
      <title>Random correlation between gene expression and gene score</title>
      <p id="Par69">To generate the distribution of random correlation between gene expression in scRNA-seq data and gene score in scATAC-seq data, we randomly shuffled the order of reliable genes, calculated the correlations between expression of pre-shuffle genes and gene score of post-shuffle genes at the same positions, and repeated the process 1000 times. The obtained distribution of correlations provided a good estimate on the correlation between random, unrelated gene pairs, which had a 95% upper confidence bound at R<sub>0</sub> = 0.399. Any correlations below R<sub>0</sub> were no better than that between random, unrelated gene pairs and thus not statistically meaningful.</p>
    </sec>
    <sec id="Sec42">
      <title>Published single cell datasets</title>
      <p id="Par70">We retrieved scRNA-seq data from published PBMC datasets CNP0001102<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, GSE149689<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, and GSE164378<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Datasets CNP0001102 and GSE164378 were from longitudinal studies. Single-cell data objects were created in Seurat v4.0.0 and cells were labeled as in the original studies. Dataset CNP0001102 consists of three healthy controls (normal), two participants infected with influenza (Flu) and five participants infected with SARS-CoV-2 (COVID-19). Dataset GSE149689 consists of four normal, five Flu, and eleven COVID-19 participants. Dataset GSE164378 dataset consists of eight participants with PBMC samples collected at three timepoints.</p>
      <p id="Par71">Mouse brain scRNA-seq data was obtained from published dataset GSE129788<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. The dataset contains single cell RNA data from brain tissues of eight young (2–3 months) and eight old (21–23 months) mice. The dataset consists of a total 37,069 cells labeled to 25 cell types.</p>
    </sec>
    <sec id="Sec43">
      <title>TCRß repertoire dataset</title>
      <p id="Par72">We downloaded the TCRβ sequencing data of 4 systemic sclerosis patients from GSE156980<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. First, we merged the TCR repertoire data from the 4 patients with 3 timepoints into a single file. Second, we calculated the frequency of each unique CDR3 peptide in each patient sample as the ratio between the observed reads of the peptide to the total peptide reads in the sample. Third, we termed unique CDR3 peptides as clonotypes and labeled them from 1 to the total number of clonotypes. In total, we collected 288,597 (out of 355,024) unique clonotypes from CD4<sup>+</sup> T cells and 11,739 (out of 14,883) from CD8<sup>+</sup> T cells, respectively. The frequency data matrix from CD4<sup>+</sup> or CD8<sup>+</sup> T cells was then submitted to PALMO as input data frame.</p>
    </sec>
    <sec id="Sec44">
      <title>Differential expression gene (DEG) analysis on scRNA-seq data</title>
      <p id="Par73">DEG analysis on datasets (CNP0001102 and GSE149689) was performed using the FindMarkers function from the Seurat package (version 4.0.0). The groups were specified using “ident.1” and “ident.2” in the function. The Benjamini and Hochberg (BH) procedure as implemented in the Seurat package was applied to adjust p-values, controlling the false discovery rate (FDR) in multiple testing. DEGs were identified if the corresponding average log2-Fold change was greater than 0.1 and the corresponding adjusted <italic>p</italic> value was less than 0.05.</p>
    </sec>
    <sec id="Sec45">
      <title>Seurat differential analysis on longitudinal scRNA-seq data of a COVID19 patient</title>
      <p id="Par74">Seurat based differential analysis was performed on the longitudinal scRNA-seq data of activated CD4<sup>+</sup> T cells of patient COV-5 in dataset CNP0001102<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, using the function <italic>FindMarkers()</italic> with parameters test.use = “MAST” and logfc.threshold = 0. The groups were defined by parameters ident.1 and ident.2. For example, to capture differential genes between day 1 (D1) versus day 7 (D7) and day 13 (D13), we selected ident.1 = D1 and ident.2 = (D7 and D13). Similar approach was carried out for comparing D13 versus D1 and D7 (ident.1 = (D1 and D7) and ident.2 = D13). The significant genes were identified by adjusted <italic>p</italic> value &lt;0.05.</p>
    </sec>
    <sec id="Sec46">
      <title>Pathway enrichment analysis</title>
      <p id="Par75">Fast Gene Set Enrichment Analysis (fgsea) was performed to identify enriched pathways among targeted genes<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. A custom collection of gene sets that included the GO v7.2, KEGG v7.2 and Hallmark v7.2 from the Molecular Signatures Database (MSigDB, v7.2) were used as the pathway database. Genes were pre-ranked by the decreasing order of their correlation coefficients. The running sum statistics and Normalized Enrichment Scores (NES) were calculated for each comparison. The pathway enrichment p-values were adjusted using the Benjamini and Hochberg procedure and pathways with adjusted <italic>p</italic>-values &lt;0.05 were considered significantly enriched. Over representation analysis was performed using the Fisher test. For a single sample GSEA (ssGSEA), we used the GSVA v1.40 R package<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>.</p>
    </sec>
    <sec id="Sec47">
      <title>Data analysis and visualization</title>
      <p id="Par76">Data analysis was performed in R, a statistical computing language (<ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link>). Basic data visualization was performed using ggplot2 v3.3, ggpubr 0.4, and circular plots by circlize v0.4. The UMAP visualization was performed using Seurat v4.0.0. Statistical tests were performed as mentioned in each section. Multi-test correction was applied to the <italic>p</italic>-values to control the FDR using the Benjamini and Hochberg procedure and adjusted <italic>p</italic> &lt; 0.05 were considered significant.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec48">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_37432_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_37432_MOESM2_ESM.pdf">
            <caption>
              <p>Transparent Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_37432_MOESM3_ESM.pdf">
            <caption>
              <p>Editorial Assessment Report</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2023_37432_MOESM4_ESM.docx">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2023_37432_MOESM5_ESM.xlsx">
            <caption>
              <p>Supplementary Data 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="41467_2023_37432_MOESM6_ESM.xlsx">
            <caption>
              <p>Supplementary Data 2</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="41467_2023_37432_MOESM7_ESM.xlsx">
            <caption>
              <p>Supplementary Data 3</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="41467_2023_37432_MOESM8_ESM.xlsx">
            <caption>
              <p>Supplementary Data 4</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="41467_2023_37432_MOESM9_ESM.xlsx">
            <caption>
              <p>Supplementary Data 5</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="41467_2023_37432_MOESM10_ESM.xlsx">
            <caption>
              <p>Supplementary Data 6</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="41467_2023_37432_MOESM11_ESM.xlsx">
            <caption>
              <p>Supplementary Data 7</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM12">
          <media xlink:href="41467_2023_37432_MOESM12_ESM.xlsx">
            <caption>
              <p>Supplementary Data 8</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec49">
        <title>Source data</title>
        <p id="Par80">
          <media position="anchor" xlink:href="41467_2023_37432_MOESM13_ESM.xlsx" id="MOESM13">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-37432-w.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We are grateful to the individuals who provided biological material for this study. We are especially thankful to all the members of the Allen Institute for Immunology and the facilities and operations teams at the Allen Institute who helped establish the productive environment in which this work was performed. We thank the study participants for their dedication to this project. We thank Drs. Gregory Lee Szeto, Emma Kuan, Claire Gustafson, Samir Rachid Zaim, and Ziyuan He for many fruitful discussions and Ms. Nina Kondza, Kathy Henderson, Muriel Ross, Kelli Burley, and Tanja Smith for blood processing. We are grateful for the leadership and support of Allan Jones, President and CEO of the Allen Institute, Allen Institute founder, Paul G. Allen, for his vision, encouragement, and support; the Human Immune System Explorer (HISE) software development team at the Allen Institute for Immunology for their support and dedication. This paper and the research behind it would not have been possible without the collaborative computational data analysis environment provided by HISE.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>S.V.V., A.K.S., P.J.S., T.F.B., and X.L. conceived the study. A.K.S., P.J.S. and T.F.B. designed the experiments. S.V.V., A.T. and X.L. designed and developed the software package. A.K.S., A.T.H. and J.R. prepared the P.B.M.C. and plasma from whole blood. A.K.S., A.T.H. and J.R. performed the flow cytometry. A.K.S. and S.V.V. analyzed the flow cytometry data. E.S., C.L. and L.T.G. performed the scRNA-seq and the scATAC-seq experiments and pre-processing. S.V.V., A.T., Q.G. and X.L. analyzed the scRNA-seq and the scATAC-seq data. S.V.V. and X.L. analyzed the proteomics data. P.M., T.R.T., P.J.S., T.F.B., and X.L. provided direction and oversight. S.V.V. and X.L. wrote the manuscript, and all authors provided edits and comments to the manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par77"><italic>Nature Communications</italic> thanks the anonymous reviewers for their contribution to the peer review of this work. This article has been peer reviewed as part of Springer Nature’s <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/nature-portfolio/open-access/guided-open-access">Guided Open Access</ext-link> initiative.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The processed scRNA-seq and scATAC-seq data of human PBMC samples generated in this study can be downloaded from the GEO database under accession number <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE190992">GSE190992</ext-link>. The corresponding raw sequencing data can be downloaded via authorized access from the dbGaP database under accession number <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id=phs003203.v1.p1">phs003203.v1.p1</ext-link>. Complete blood count (CBC) data is provided in Supplementary Data <xref rid="MOESM5" ref-type="media">1a</xref>. The matching flow cytometry data of human PBMC samples is provided in Supplementary Data <xref rid="MOESM5" ref-type="media">1b</xref>. The matching Olink data of human plasma samples is provided in Supplementary Data <xref rid="MOESM5" ref-type="media">1c</xref>. Source data are provided with this paper. Independent datasets used for evaluation are publicly available and summarized in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1b</xref>. The corresponding accession numbers are <ext-link ext-link-type="uri" xlink:href="https://db.cngb.org/search/project/CNP0001102/">CNP0001102</ext-link> (scRNA-seq data of human PBMC samples), <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE149689">GSE149689</ext-link> (scRNA-seq data of human PBMC samples), <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE164378">GSE164378</ext-link> (CITE-seq data of human PBMC samples), <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE129788">GSE129788</ext-link> (scRNA-seq data of mouse brain tissues), and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE156980">GSE156980</ext-link> (TCRβ sequencing data of CD4<sup>+</sup> and CD8<sup>+</sup> non-naïve T cells of systemic sclerosis patients). <xref rid="Sec49" ref-type="sec">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>An open-source R implementation of PALMO and R codes used in this study are available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/aifimmunology/PALMO">https://github.com/aifimmunology/PALMO</ext-link>). The release includes tutorials and example vignettes. PALMO can also be installed in R or RStudio as an R package in CRAN. Source code can also be found at Zenodo<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> [10.5281/zenodo.7549226].</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par78">S.V.V., A.S., T.T., P.S., T.F.B., and X.L. are listed as inventors in a US patent application “Molecular Signatures For Cell Typing And Monitoring Immune Health” (application No. 63/291,234) based on this work. C.L. is currently an employee of GlaxoSmithKline. The remaining authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernardes</surname>
            <given-names>JP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Longitudinal multi-omics analyses identify responses of megakaryocytes, erythroid cells, and plasmablasts as hallmarks of severe COVID-19</article-title>
        <source>Immunity</source>
        <year>2020</year>
        <volume>53</volume>
        <fpage>1296</fpage>
        <lpage>1314.e9</lpage>
        <pub-id pub-id-type="doi">10.1016/j.immuni.2020.11.017</pub-id>
        <?supplied-pmid 33296687?>
        <pub-id pub-id-type="pmid">33296687</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Lee, J. S. et al. Immunophenotyping of COVID-19 and influenza highlights the role of type I interferons in development of severe COVID-19. <italic>Sci. Immunol.</italic><bold>5</bold>, eabd1554 (2020).</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell sequencing of peripheral mononuclear cells reveals distinct immune response landscapes of COVID-19 and influenza patients</article-title>
        <source>Immunity</source>
        <year>2020</year>
        <volume>53</volume>
        <fpage>685</fpage>
        <lpage>696.e3</lpage>
        <pub-id pub-id-type="doi">10.1016/j.immuni.2020.07.009</pub-id>
        <?supplied-pmid 32783921?>
        <pub-id pub-id-type="pmid">32783921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Longitudinal multi-omics of host-microbe dynamics in prediabetes</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>569</volume>
        <fpage>663</fpage>
        <lpage>671</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1236-x</pub-id>
        <?supplied-pmid 31142858?>
        <pub-id pub-id-type="pmid">31142858</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Longitudinal single-cell profiling reveals molecular heterogeneity and tumor-immune evolution in refractory mantle cell lymphoma</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>2877</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-22872-z</pub-id>
        <?supplied-pmid 34001881?>
        <pub-id pub-id-type="pmid">34001881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell chromatin accessibility reveals principles of regulatory variation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>523</volume>
        <fpage>486</fpage>
        <lpage>490</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14590</pub-id>
        <?supplied-pmid 26083756?>
        <pub-id pub-id-type="pmid">26083756</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sharma</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Longitudinal single-cell RNA sequencing of patient-derived primary cells reveals drug-induced infidelity in stem cell hierarchy</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>4931</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07261-3</pub-id>
        <?supplied-pmid 30467425?>
        <pub-id pub-id-type="pmid">30467425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilk</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell atlas of the peripheral immune response in patients with severe COVID-19</article-title>
        <source>Nat. Med.</source>
        <year>2020</year>
        <volume>26</volume>
        <fpage>1070</fpage>
        <lpage>1076</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-020-0944-y</pub-id>
        <?supplied-pmid 32514174?>
        <pub-id pub-id-type="pmid">32514174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Diggle, P. J., Heagerty, P., Liang, K.-Y. &amp; Zeger, S. L. Analysis of Longitudinal Data. (Oxford Univ. Press, 2002).</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fitzmaurice</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Ravichandran</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A primer in longitudinal data analysis</article-title>
        <source>Circulation</source>
        <year>2008</year>
        <volume>118</volume>
        <fpage>2005</fpage>
        <lpage>2010</lpage>
        <pub-id pub-id-type="doi">10.1161/CIRCULATIONAHA.107.714618</pub-id>
        <?supplied-pmid 18981315?>
        <pub-id pub-id-type="pmid">18981315</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gustafsson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sources of variation in cell-type RNA-Seq profiles</article-title>
        <source>PLoS One</source>
        <year>2020</year>
        <volume>15</volume>
        <fpage>e0239495</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0239495</pub-id>
        <?supplied-pmid 32956417?>
        <pub-id pub-id-type="pmid">32956417</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>296</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1874-1</pub-id>
        <?supplied-pmid 31870423?>
        <pub-id pub-id-type="pmid">31870423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sperisen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cominetti</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>F-PJ</given-names>
          </name>
        </person-group>
        <article-title>Longitudinal omics modeling and integration in clinical metabonomics research: challenges in childhood metabolic health research</article-title>
        <source>Front. Mol. Biosci.</source>
        <year>2015</year>
        <volume>2</volume>
        <fpage>44</fpage>
        <pub-id pub-id-type="doi">10.3389/fmolb.2015.00044</pub-id>
        <?supplied-pmid 26301225?>
        <pub-id pub-id-type="pmid">26301225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dal Molin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Baruzzo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Di Camillo</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-Sequencing: assessment of differential expression analysis methods</article-title>
        <source>Front. Genet.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>62</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2017.00062</pub-id>
        <?supplied-pmid 28588607?>
        <pub-id pub-id-type="pmid">28588607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>278</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0844-5</pub-id>
        <?supplied-pmid 26653891?>
        <pub-id pub-id-type="pmid">26653891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell</source>
        <year>2021</year>
        <volume>184</volume>
        <fpage>3573</fpage>
        <lpage>3587.e29</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
        <?supplied-pmid 34062119?>
        <pub-id pub-id-type="pmid">34062119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Squair</surname>
            <given-names>JW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Confronting false discoveries in single-cell differential expression</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>5692</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25960-2</pub-id>
        <?supplied-pmid 34584091?>
        <pub-id pub-id-type="pmid">34584091</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zimmerman</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Espeland</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Langefeld</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A practical solution to pseudoreplication bias in single-cell studies</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>738</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-21038-1</pub-id>
        <?supplied-pmid 33531494?>
        <pub-id pub-id-type="pmid">33531494</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffman</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Schadt</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>E. variancePartition: interpreting drivers of variation in complex gene expression studies</article-title>
        <source>BMC Bioinforma.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>483</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1323-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nazarov</surname>
            <given-names>VI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>tcR: an R package for T cell receptor repertoire advanced data analysis</article-title>
        <source>BMC Bioinforma.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>175</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0613-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Granja</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis</article-title>
        <source>Nat. Genet.</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>403</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00790-6</pub-id>
        <?supplied-pmid 33633365?>
        <pub-id pub-id-type="pmid">33633365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Uhlen</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Towards a knowledge-based human protein atlas</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>1248</fpage>
        <lpage>1250</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1210-1248</pub-id>
        <?supplied-pmid 21139605?>
        <pub-id pub-id-type="pmid">21139605</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Regulation of TLR7/9 responses in plasmacytoid dendritic cells by BST2 and ILT7 receptor interaction</article-title>
        <source>J. Exp. Med.</source>
        <year>2009</year>
        <volume>206</volume>
        <fpage>1603</fpage>
        <lpage>1614</lpage>
        <pub-id pub-id-type="doi">10.1084/jem.20090547</pub-id>
        <?supplied-pmid 19564354?>
        <pub-id pub-id-type="pmid">19564354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schotte</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nagasawa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weijer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Spits</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Blom</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>The ETS transcription factor Spi-B is required for human plasmacytoid dendritic cell development</article-title>
        <source>J. Exp. Med.</source>
        <year>2004</year>
        <volume>200</volume>
        <fpage>1503</fpage>
        <lpage>1509</lpage>
        <pub-id pub-id-type="doi">10.1084/jem.20041231</pub-id>
        <?supplied-pmid 15583020?>
        <pub-id pub-id-type="pmid">15583020</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chbili</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Glutathione S-transferase M1 and T1 polymorphisms and the risk of mild hepatotoxicity induced by carbamazepine in a tunisian population study</article-title>
        <source>BMC Neurol.</source>
        <year>2018</year>
        <volume>18</volume>
        <fpage>24</fpage>
        <pub-id pub-id-type="doi">10.1186/s12883-018-1013-8</pub-id>
        <?supplied-pmid 29523098?>
        <pub-id pub-id-type="pmid">29523098</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Servaas</surname>
            <given-names>NH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Longitudinal analysis of T-cell receptor repertoires reveals persistence of antigen-driven CD4+ and CD8+ T-cell clusters in systemic sclerosis</article-title>
        <source>J. Autoimmun.</source>
        <year>2021</year>
        <volume>117</volume>
        <fpage>102574</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jaut.2020.102574</pub-id>
        <?supplied-pmid 33307312?>
        <pub-id pub-id-type="pmid">33307312</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hänzelmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Castelo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Guinney</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>GSVA: gene set variation analysis for microarray and RNA-seq data</article-title>
        <source>BMC Bioinforma.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Gnanaprakasam, J. N. R. &amp; Wang, R. MYC in Regulating Immunity: Metabolism and Beyond. <italic>Genes</italic><bold>8</bold>, 88 (2017).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ivashkiv</surname>
            <given-names>LB</given-names>
          </name>
        </person-group>
        <article-title>Cross-regulation of signaling pathways by interferon-gamma: implications for immune responses and autoimmune diseases</article-title>
        <source>Immunity</source>
        <year>2009</year>
        <volume>31</volume>
        <fpage>539</fpage>
        <lpage>550</lpage>
        <pub-id pub-id-type="doi">10.1016/j.immuni.2009.09.002</pub-id>
        <?supplied-pmid 19833085?>
        <pub-id pub-id-type="pmid">19833085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trigunaite</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dimo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jørgensen</surname>
            <given-names>TN</given-names>
          </name>
        </person-group>
        <article-title>Suppressive effects of androgens on the immune system</article-title>
        <source>Cell. Immunol.</source>
        <year>2015</year>
        <volume>294</volume>
        <fpage>87</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cellimm.2015.02.004</pub-id>
        <?supplied-pmid 25708485?>
        <pub-id pub-id-type="pmid">25708485</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burrack</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Martinov</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fife</surname>
            <given-names>BT</given-names>
          </name>
        </person-group>
        <article-title>T cell-mediated beta cell destruction: autoimmunity and alloimmunity in the context of type 1 diabetes</article-title>
        <source>Front. Endocrinol.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>343</fpage>
        <pub-id pub-id-type="doi">10.3389/fendo.2017.00343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Di Cara, F. et al. Peroxisomes in immune response and inflammation. <italic>Int. J. Mol. Sci</italic>. <bold>20</bold>, 3877 (2019).</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sofer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lei</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Johannessen</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Ellisen</surname>
            <given-names>LW</given-names>
          </name>
        </person-group>
        <article-title>Regulation of mTOR and cell growth in response to energy stress by REDD1</article-title>
        <source>Mol. Cell. Biol.</source>
        <year>2005</year>
        <volume>25</volume>
        <fpage>5834</fpage>
        <lpage>5845</lpage>
        <pub-id pub-id-type="doi">10.1128/MCB.25.14.5834-5845.2005</pub-id>
        <?supplied-pmid 15988001?>
        <pub-id pub-id-type="pmid">15988001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verstrepen</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expression, biological activities and mechanisms of action of A20 (TNFAIP3)</article-title>
        <source>Biochem. Pharmacol.</source>
        <year>2010</year>
        <volume>80</volume>
        <fpage>2009</fpage>
        <lpage>2020</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bcp.2010.06.044</pub-id>
        <?supplied-pmid 20599425?>
        <pub-id pub-id-type="pmid">20599425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>scMerge leverages factor analysis, stable expression, and pseudoreplication to merge multiple single-cell RNA-seq datasets</article-title>
        <source>Proc. Natl. Acad. Sci. U. S. A.</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>9775</fpage>
        <lpage>9784</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1820006116</pub-id>
        <?supplied-pmid 31028141?>
        <pub-id pub-id-type="pmid">31028141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ximerakis</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic profiling of the aging mouse brain</article-title>
        <source>Nat. Neurosci.</source>
        <year>2019</year>
        <volume>22</volume>
        <fpage>1696</fpage>
        <lpage>1708</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-019-0491-3</pub-id>
        <?supplied-pmid 31551601?>
        <pub-id pub-id-type="pmid">31551601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Savage</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multimodal analysis for human ex vivo studies shows extensive molecular changes from delays in blood processing</article-title>
        <source>iScience</source>
        <year>2021</year>
        <volume>24</volume>
        <fpage>102404</fpage>
        <pub-id pub-id-type="doi">10.1016/j.isci.2021.102404</pub-id>
        <?supplied-pmid 34113805?>
        <pub-id pub-id-type="pmid">34113805</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell Hashing with barcoded antibodies enables multiplexing and doublet detection for single cell genomics</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>224</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1603-1</pub-id>
        <?supplied-pmid 30567574?>
        <pub-id pub-id-type="pmid">30567574</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive integration of single-</article-title>
        <source>Cell Data Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <?supplied-pmid 31178118?>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bates</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mächler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bolker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fitting linear mixed-effects models using lme4</article-title>
        <source>J. Stat. Softw.</source>
        <year>2015</year>
        <volume>67</volume>
        <fpage>1</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v067.i01</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Korotkevich, G. et al. Fast gene set enrichment analysis. <italic>bioRxiv</italic> 060012 10.1101/060012 (2021).</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Vasaikar, S. V. et al. A comprehensive platform for analyzing longitudinal multi-omics data (v1.2). Zenodo, 10.5281/zenodo.7549226 (2023).</mixed-citation>
    </ref>
  </ref-list>
</back>
