<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5495381</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0180198</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-16-47329</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Comparative Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Comparative Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Chromosome Biology</subject>
            <subj-group>
              <subject>Chromosomes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Evolution</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Evolution</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Molecular Evolution</subject>
            <subj-group>
              <subject>Genome Evolution</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Phylogenetic Analysis</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Chromosome Biology</subject>
            <subj-group>
              <subject>Chromosomes</subject>
              <subj-group>
                <subject>Homologous Chromosomes</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>High precision detection of conserved segments from synteny blocks</article-title>
      <alt-title alt-title-type="running-head">High precision detection of conserved segments from synteny blocks</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9682-6362</contrib-id>
        <name>
          <surname>Lucas</surname>
          <given-names>Joseph MEX</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Roest Crollius</surname>
          <given-names>Hugues</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>IBENS, Département de Biologie, Ecole Normale Supérieure, CNRS, Inserm, PSL Research, University, Paris, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gadagkar</surname>
          <given-names>Sudhindra R.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Midwestern University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>jlucas@ens.fr</email> (JMEXL); <email>hrc@ens.fr</email> (HRC)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>12</volume>
    <issue>7</issue>
    <elocation-id>e0180198</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>11</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>6</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2017 Lucas, Roest Crollius</copyright-statement>
      <copyright-year>2017</copyright-year>
      <copyright-holder>Lucas, Roest Crollius</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0180198.pdf"/>
    <abstract>
      <p>A conserved segment, i.e. a segment of chromosome unbroken during evolution, is an important operational concept in comparative genomics. Until now, algorithms that are designed to identify conserved segments often return synteny blocks that overlap, synteny blocks that include micro-rearrangements or synteny blocks erroneously short. Here we present definitions of conserved segments and synteny blocks independent of any heuristic method and we describe four new post-processing strategies to refine synteny blocks into accurate conserved segments. The first strategy identifies micro-rearrangements, the second strategy identifies mono-genic conserved segments, the third returns non-overlapping segments and the fourth repairs incorrect ruptures of synteny. All these refinements are implemented in a new version of PhylDiag that has been benchmarked against i-ADHoRe 3.0 and Cyntenator, based on a realistic simulated evolution and true simulated conserved segments.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004617</institution-id>
            <institution>Institut National des Sciences de l'Univers, Centre National de la Recherche Scientifique</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Roest Crollius</surname>
            <given-names>Hugues</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001665</institution-id>
            <institution>Agence Nationale de la Recherche</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Ancestrome Project ANR-10-BINF-01-03</award-id>
        <principal-award-recipient>
          <name>
            <surname>Roest Crollius</surname>
            <given-names>Hugues</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001665</institution-id>
            <institution>Agence Nationale de la Recherche</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ANR-10-LABX‐54 MEMOLIFE</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9682-6362</contrib-id>
          <name>
            <surname>Lucas</surname>
            <given-names>Joseph MEX</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001665</institution-id>
            <institution>Agence Nationale de la Recherche</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ANR-11‐IDEX‐0001‐02 PSL* Research University</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9682-6362</contrib-id>
          <name>
            <surname>Lucas</surname>
            <given-names>Joseph MEX</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>The work of JMEXL and HRC has been funded by Centre National de la Recherche Scientifique (CNRS), the program "Investissements d’Avenir" launched by the French Government, the Agence Nationale de la Recherche (ANR) [Grant: Ancestrome Project ANR-10-BINF-01-03] and received support from the MemoLife project [ANR-10-LABX‐54 MEMO LIFE]. The work of HRC has also been funded by Paris Sciences et Lettres (PSL) Research University [ANR-11‐IDEX‐0001‐02 PSL* Research University]. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="10"/>
      <table-count count="0"/>
      <page-count count="22"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The pre- and post-processing steps have been implemented in the python library LibsDyogen. These steps are now used as a routine in PhylDiag. They are both freely available at the GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/DyogenIBENS/">https://github.com/DyogenIBENS/</ext-link> in the folders LibsDyogen and PhylDiag respectively.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The pre- and post-processing steps have been implemented in the python library LibsDyogen. These steps are now used as a routine in PhylDiag. They are both freely available at the GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/DyogenIBENS/">https://github.com/DyogenIBENS/</ext-link> in the folders LibsDyogen and PhylDiag respectively.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Genomes are evolving molecules that are continuously mutating and rearranging. Despite these alterations, some segments of chromosomes remain exempt from disruption and still reflect the ancestral genome organisation; in 1984 they were first called “conserved segments” by Nadeau and Taylor [<xref rid="pone.0180198.ref001" ref-type="bibr">1</xref>]. Identifying those conserved segments is a prerequisite in rearrangement studies. However studies usually only focus on macro-rearrangements, to abstract themselves from spurious micro-rearrangements pervasive in draft genome assemblies, and thus rather use synteny blocks instead of conserved segments. In 2003, Pevzner and Tesler [<xref rid="pone.0180198.ref002" ref-type="bibr">2</xref>] introduced the term “synteny block” to refer to “segments that can be converted into conserved segments by micro-rearrangements. […] they usually consist of short regions of similarity that may be interrupted by dissimilar regions and gaps.” Studying synteny blocks and more generally identifying the conservation of synteny is the first step toward the identification of conserved segments from extant genomes. However considering that synteny blocks are a proxy for conserved segments is most of the time a mistake since numerous real micro-rearrangements, unrelated to genome assembly errors, are scattered in extant genomes [<xref rid="pone.0180198.ref003" ref-type="bibr">3</xref>,<xref rid="pone.0180198.ref004" ref-type="bibr">4</xref>]. Furthermore, because the identification of synteny blocks relies by definition on the conservation of synteny relationships between at least two markers, synteny blocks systematically miss conserved segments containing only one marker, and thus they cannot account for breakpoints corresponding to single-marker inversions. In this article we provide strategies to fine-tune the retrieval of conserved segments through the processing of synteny blocks.</p>
    <p>More formally, we study genomes made of linear chromosomes with each chromosome being an ordered list of oriented genes (gene orientations are determined by their orientations of transcription into RNA). Only identifiable rearrangements are considered, i.e. breakpoints of rearrangements that change the position or orientation of at least one gene. In line with [<xref rid="pone.0180198.ref001" ref-type="bibr">1</xref>], we define a <italic>conserved segment</italic> from an initial ancestral genome to a set of descendant genomes as a maximum unbroken segment of ancestral genes. In other words it is a segment of ancestral genes that underwent no internal breakpoint, no internal disruption of ancestral gene order and no disruption of ancestral gene orientations, in all lineages from the initial genome to the set of descendant genomes of interest. An <italic>ancestral gene</italic> is a gene present in the ancestral genome and it may have been conserved in one or several extant genomes. After the ancestor, a gene that originated due to a <italic>de novo</italic> gene birth or to a duplication, is not an ancestral gene and a rearrangement that disrupted only non-ancestral genes does not change conserved segments. The exhaustive set of conserved segments is thus the set of fragments of the ancestral genome after (i) splitting at all rearrangement breakpoints involving ancestral genes that occurred between the ancestral genome and the descendant genomes and after (ii) removing all ancestral genes that have been deleted during evolution in at least one of the considered lineages. As for a conserved segment, a <italic>synteny block</italic> with gaps ≤ <italic>g</italic> is a maximum cluster of syntenic and neighbouring ancestral genes (at least two) whose gene order and gene orientations have been conserved during evolution. <italic>g</italic> is equal to the upper limit of ancestral genes within the gaps of synteny blocks, and neighbouring ancestral genes of a synteny block are spaced by a gap of at most <italic>g</italic> ancestral genes that do not belong to the synteny block. Contrary to a conserved segment, micro-rearrangements (rearrangements of segments of at most <italic>g</italic> ancestral genes) may have occurred between the neighbouring ancestral genes of a synteny block. It follows from these definitions that (i) there is no difference between a synteny block with no gap (<italic>g</italic> = 0) and a conserved segment (ii) a synteny block with <italic>n</italic> non-null gaps is made of <italic>n+1</italic> conserved segments spaced by these <italic>n</italic> non-null gaps. Except for the variation of ancestral gene content, a synteny block can be converted into a segment of the ancestral genome if, within its gaps, all the small conserved segments are re-ordered and reoriented by reversing the micro-rearrangements that generated them (natural micro-rearrangements, mainly small inversions, during evolution plus artificial micro-rearrangements due to annotation errors or assembly errors). All the micro-rearrangements here are identical to the “micro-rearrangements” in the intuitive definition of Pevzner and Tesler cited above. <xref ref-type="fig" rid="pone.0180198.g001">Fig 1</xref> illustrates these definitions by considering the evolution of a chromosome rearranged by inversions along with all its corresponding conserved segments and synteny blocks. Another evolution could involve several lineages where genomes are made of several chromosomes rearranged by other types of rearrangements (reciprocal translocations, fissions, fusions transpositions,…) and edited by genic events (gene duplications, gene deletions and <italic>de novo</italic> gene births), the deduction of the corresponding conserved segments and synteny blocks would follow as well from the definitions. <xref ref-type="supplementary-material" rid="pone.0180198.s001">S1</xref>, <xref ref-type="supplementary-material" rid="pone.0180198.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pone.0180198.s003">S3</xref> Figs depict more detailed evolutions of conserved segments corresponding to the evolution of an ancestral genome to one (<xref ref-type="supplementary-material" rid="pone.0180198.s002">S2 Fig</xref>) or two descendants (<xref ref-type="supplementary-material" rid="pone.0180198.s003">S3 Fig</xref>) with genic events and several types of rearrangements.</p>
    <fig id="pone.0180198.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0180198.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>A scenario of rearrangements from one ancestral chromosome to one extant chromosome and corresponding conserved segments and synteny blocks.</title>
        <p>Along chromosomes, arrows represent uninterrupted segments of several genes and triangles represent segments of chromosomes composed of one gene. The three first lines describe the scenario of inversions, from the ancestral chromosome (first line) to the extant chromosome (3<sup>rd</sup> line) in two steps: 2 macro-inversions and then 5 micro-inversions. Macro-inversions (reversing at least 4 genes) are in red whereas micro-inversions (reversing at most 3 genes) are in blue and grey: blue inversions reverse 3 genes and grey inversions reverse 1 gene. The two lines below show the corresponding conserved segments and “synteny blocks” (as intuitively defined first by Pevzner and Tesler [<xref rid="pone.0180198.ref002" ref-type="bibr">2</xref>]) while the last two lines show all synteny blocks corresponding to our formal definition. The set of optimal non-overlapping synteny blocks corresponds well to the original definition, except that the conserved segments nested in the gaps of our synteny blocks are not considered as part of the synteny blocks. In this example, the length of the maximum allowed gap in synteny blocks is the maximum length of micro-rearranged segments; <italic>g</italic> is equal to 3 genes.</p>
      </caption>
      <graphic xlink:href="pone.0180198.g001"/>
    </fig>
    <p>In this work we present five general issues that affect the identification of conserved segments: duplications of ancestral genes, micro-rearrangements, mono-genic conserved segments, overlaps of portions of diagonals and ambiguous conservation of gene order. We also introduce five strategies to solve them.</p>
    <p>All strategies are implemented in a new version of PhylDiag [<xref rid="pone.0180198.ref005" ref-type="bibr">5</xref>], which we benchmarked against simulated conserved segments. To our knowledge there is no program that specifically identifies conserved segments as opposed to synteny blocks. We thus compared PhylDiag with i-ADHoRe 3.0 [<xref rid="pone.0180198.ref006" ref-type="bibr">6</xref>] and Cyntenator [<xref rid="pone.0180198.ref007" ref-type="bibr">7</xref>], two well-known alternative approaches to identify synteny blocks [<xref rid="pone.0180198.ref008" ref-type="bibr">8</xref>], and, during the comparison, we used their synteny blocks (more precisely base_clusters and <italic>Representative Synteny Blocks</italic>, RSBs) as if they were conserved segments. Finally, we explain false positive and false negative extremities that remain after our post-processing steps.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Definitions and model</title>
      <p>Inputs of all algorithms are genomes and gene families. A genome is usually a set of linear chromosomes and a chromosome is an ordered list of oriented genes. The orientation of each chromosome is arbitrarily chosen and either ranks genes in one order or the reverse; once the order is fixed, a chromosome has a first gene and a last gene. Each gene of a chromosome has an <italic>orientation</italic>: if the transcriptional orientation of the gene (5’ to 3’) points toward the last gene of the chromosome, its orientation is positive (+1); otherwise its orientation is negative (-1).</p>
      <p>Genomes are altered by events during evolution and, in the field of vertebrate genome evolution, the most cited events altering genomes are of two types: genic events (gene duplications, either tandem or dispersed, gene deletions and <italic>de novo</italic> gene births) and chromosomal rearrangements (inversions, reciprocal translocations, fissions and fusions) (<xref ref-type="supplementary-material" rid="pone.0180198.s014">S14 Fig</xref>).</p>
      <p>A gene evolves through duplication and speciation events and all its descendants form a family. A gene family is thus a set of genes that derive from one common ancestral gene. Pairs of genes of the same family are called homologs and they correspond to a homology relationship. The <italic>matrix of homologies</italic> of the comparison of two genomes is a sparse matrix where each row corresponds to a gene of the first genome and each column corresponds to a gene of the second genome; genes are ordered along chromosomes and chromosomes are sorted by decreasing chromosome lengths. This matrix can be represented as an array of <italic>signs</italic> equal to +, − or 0. Non-0 signs correspond to <italic>homology signs</italic>: a + sign means that the two corresponding homologs (genes of the same family corresponding to the row and the column of the homology) have the same orientation (+1 and +1; or -1 and -1) and a—sign means that they have reversed orientations (+1 and -1; or -1 and +1); <xref ref-type="supplementary-material" rid="pone.0180198.s004">S4 Fig</xref> gives a graphical example of a matrix of homologies of two genomes. If the first genome has n1 chromosomes and if the second genome has n2 chromosomes, this matrix is composed of n1 x n2 sub-matrices of homologies of the comparison of pairs of chromosomes.</p>
      <p>In this work we study the conservation of synteny blocks and conserved segments from one ancestor to a pair of descendant species. We explained in [<xref rid="pone.0180198.ref005" ref-type="bibr">5</xref>] and in more details in [<xref rid="pone.0180198.ref009" ref-type="bibr">9</xref>] that a synteny block conserved along both lineages, with gaps ≤ <italic>g</italic> takes the shape of a consistent diagonal with gaps ≤ <italic>g</italic> in the homology matrix of compared extant genomes, as long as they are both <italic>perfectly filtered</italic> in such way that they contain only ancestral genes, conserved from the ancestor to both extant genomes.</p>
      <p>A <italic>consistent diagonal</italic> (subsequently referred to as diagonal) is either a bottom-left to top-right diagonal with + signs (homologous genes that have the same respective orientations), or a top-left to bottom-right diagonal with–signs (genes in opposite orientations). In a diagonal, the gap between two successive homologies is computed using the Chebyshev distance metric and is thus equal to the maximum of the gaps between corresponding homologs in compared genomes. A conserved segment (which is a synteny block with <italic>g</italic> = 0) takes the shape of a consistent diagonal with no gaps when both compared genomes are perfectly filtered (<xref ref-type="supplementary-material" rid="pone.0180198.s005">S5 Fig</xref>). We will compare pairs of sequenced genomes to identify synteny blocks and conserved segments through the detection of these diagonals. A comparison only gives information on what happened after the most recent common ancestral genome (MRCA) of compared genomes, thus we will focus on the evolution from the MRCA to both compared genomes.</p>
      <p>If gene trees of compared genomes are available, we define families from pruned phylogenetic gene trees [<xref rid="pone.0180198.ref005" ref-type="bibr">5</xref>]. A phylogenetic gene tree is a binary gene tree that represents the evolution of one initial gene and its later copies. The initial gene is at the root of the gene tree, nodes of the tree correspond to duplication events or speciation events and leaves correspond to genes, in extant genomes, deriving from the initial gene.</p>
      <p>Given a pair of compared genomes, and corresponding gene trees, we prune gene trees at the level of the MRCA. After pruning, each root of a gene tree is an ancestral gene of the MRCA (we discard gene trees deriving from <italic>de novo</italic> gene births posterior to the MRCA). Each family is then defined as a set of genes in the same pruned gene tree. As a consequence, two genes are homologs (are in the same family) if and only if they derive from the same ancestral gene of the MRCA. With error-free gene trees, the pruning process differentiates gene lineages arising from paralogs in the MRCA, especially lineages of paralogs in the same cluster of tandem duplicates (<xref ref-type="supplementary-material" rid="pone.0180198.s008">S8 Fig</xref>).</p>
      <p>See [<xref rid="pone.0180198.ref005" ref-type="bibr">5</xref>] and [<xref rid="pone.0180198.ref009" ref-type="bibr">9</xref>] for more formal definitions of genomes, gene orientations, homology relationships, matrices of homologies, signs of homologies, diagonals, distance metrics, gaps, gene trees, pruning of gene trees and families used in this article.</p>
      <p>Using gene families as defined above, we pre-process compared extant genomes to get them as close as possible to the perfectly filtered genomes, that would only contain ancestral genes conserved in both species (<xref ref-type="supplementary-material" rid="pone.0180198.s004">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0180198.s005">S5</xref> and <xref ref-type="supplementary-material" rid="pone.0180198.s006">S6</xref> Figs). As in other methods, we remove genes with no homolog in the other genome although this keeps unwanted copies of ancestral genes in genomes (<xref ref-type="supplementary-material" rid="pone.0180198.s006">S6 Fig</xref>). Contrary to diagonals when genomes are perfectly filtered (<xref ref-type="supplementary-material" rid="pone.0180198.s005">S5 Fig</xref>), these non-ancestral genes create <italic>artificial gaps</italic> in diagonals of conserved segments (if they come from dispersed duplications) or packs of homologies (if they come from tandem duplications) that disrupt the linearity of diagonals (<xref ref-type="supplementary-material" rid="pone.0180198.s006">S6 Fig</xref>). Errors in sequences and errors in annotations of compared genomes will cause additional artificial gaps.</p>
      <p>Experience shows that artificial gaps are frequent in data. As a consequence, conserved segments take the shape of diagonals with some non-null gaps (<xref ref-type="supplementary-material" rid="pone.0180198.s009">S9</xref> and <xref ref-type="supplementary-material" rid="pone.0180198.s010">S10</xref> Figs). In addition, because of these artefacts, the maximum gap, g, of the definition of synteny blocks may thus differ from the maximum gap of corresponding diagonals, gapMax. In other words, synteny blocks with gaps ≤ g may take the shape of diagonals with some gaps &gt; g; i.e. diagonals with gaps ≤ gapMax where gapMax is an integer strictly higher than g.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec004">
    <title>Results</title>
    <sec id="sec005">
      <title>Five issues and corresponding strategies for the detection of synteny blocks and conserved segments</title>
      <p>The first issue for the detection of synteny blocks and conserved segments is caused by numerous tandem duplications [<xref rid="pone.0180198.ref010" ref-type="bibr">10</xref>] (<xref ref-type="supplementary-material" rid="pone.0180198.s006">S6 Fig</xref>) in genomes of vertebrates (<xref ref-type="fig" rid="pone.0180198.g002">Fig 2</xref>).</p>
      <fig id="pone.0180198.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0180198.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Proportion of the number of tandem duplications among all gene duplications that occurred between the Amniota ancestor and five extant vertebrates.</title>
          <p>Panel <bold>A</bold> contains the species tree linking extant human, mouse, dog, opossum and chicken species to Amniota, their most recent common ancestor. The topology of the tree and the dates of speciation come from the Ensembl database [<xref rid="pone.0180198.ref011" ref-type="bibr">11</xref>]. The graph in Panel <bold>B</bold> shows the proportion of tandem duplications among all duplications. Genes are considered duplicated in tandem if they fulfil two criteria: (i) they must belong to the same gene family, and therefore share the same ancestral Amniota gene (ii) they are separated, in the extant genome, by at most <italic>tandemGapMax</italic> genes (on the x-axis). Tandemly duplicated genes form clusters of two or more tandem duplicates of the same gene family. The number of tandem duplication events within a cluster is estimated as the number of tandem duplicates minus 1 (the original ancestral gene). Computations are performed using genomes from Ensembl v81 and the corresponding gene trees of Ensembl Compara. The proportion of tandem duplications among all duplications is substantial and varies from approximately 40% to 70% depending on the lineage.</p>
        </caption>
        <graphic xlink:href="pone.0180198.g002"/>
      </fig>
      <p>A tandem duplication in one lineage adds a new non-ancestral gene that should be filtered out. Unfortunately removing non-ancestral genes from extant genomes is often impossible, especially within clusters of tandem duplicates where the ancestral gene and its surrounding tandem duplicates cannot be distinguished. To bypass this difficulty, it has previously been suggested to collapse each cluster of tandem duplicates to a unique gene [<xref rid="pone.0180198.ref012" ref-type="bibr">12</xref>,<xref rid="pone.0180198.ref013" ref-type="bibr">13</xref>] that is then considered as representing the ancestral gene (<xref ref-type="supplementary-material" rid="pone.0180198.s008">S8 Fig</xref>). Here we explain a generalisation of this pre-processing method and show some of its limits based on real data. We also explain why dispersed duplications remain an issue that forces us to allow gaps within diagonals corresponding to conserved segments.</p>
      <p>The second issue concerns the identification of “micro-rearrangements”. It was a key element in the debate between the fragile breakage model and the random breakage model; and the associated debate about the real rate of breakpoints reuse [<xref rid="pone.0180198.ref014" ref-type="bibr">14</xref>,<xref rid="pone.0180198.ref015" ref-type="bibr">15</xref>]. For example, Pevzner and Tesler discarded “micro-rearrangements” smaller than 1Mb with GRIMM to circumvent errors in genomic sequence assemblies but at the cost of rejecting genuine micro-conserved segments and simultaneously suppressing internal breakpoints within their blocks [<xref rid="pone.0180198.ref002" ref-type="bibr">2</xref>].</p>
      <p>The third issue involves conserved segments of one gene. According to our definition such a segment corresponds to one ancestral gene flanked by breakpoints on both sides. In previous studies, either synteny blocks of at least two genes are studied or mono-genic inversions are studied [<xref rid="pone.0180198.ref003" ref-type="bibr">3</xref>], but we do not know any case where both are studied together whereas all conserved segments, whatever their lengths, are interesting for rearrangement studies.</p>
      <p>The fourth issue concerns solving “conflicts” between diagonals of putative synteny blocks [<xref rid="pone.0180198.ref016" ref-type="bibr">16</xref>]. Overlaps of diagonals, often referred as overlaps of synteny blocks [<xref rid="pone.0180198.ref016" ref-type="bibr">16</xref>], must be removed for genome rearrangement studies [<xref rid="pone.0180198.ref017" ref-type="bibr">17</xref>,<xref rid="pone.0180198.ref018" ref-type="bibr">18</xref>] that mainly use non-overlapping synteny blocks as a basis to define the rearrangement scenario that transforms one genome into another. Except in a few cases [<xref rid="pone.0180198.ref019" ref-type="bibr">19</xref>,<xref rid="pone.0180198.ref020" ref-type="bibr">20</xref>], algorithms do not eliminate overlaps [<xref rid="pone.0180198.ref016" ref-type="bibr">16</xref>].</p>
      <p>Finally, the fifth issue concerns synteny blocks erroneously shortened while solving conflicts between diagonals, due to local ambiguities in the conservation of the ancestral gene order.</p>
      <p>While the first issue is tackled by collapsing tandem duplicate clusters, here we also describe refinement steps to resolve the four remaining issues. The first step identifies mono-genic conserved segments. The second step identifies micro-rearrangements and corresponding breakpoints. The third refinement step solves overlaps and yields an optimised set of non-overlapping conserved segments. Finally, the last step truncates diagonals and merges previously overlapping diagonals to recover complete synteny blocks from erroneously shortened blocks.</p>
    </sec>
    <sec id="sec006">
      <title>Pre-processing</title>
      <sec id="sec007">
        <title>Collapsing clusters of tandem duplicates</title>
        <p>This pre-processing step rewrites chromosomes and returns a unique representative location and a unique representative orientation per cluster of tandem duplicates. Two genes are clustered if they are separated by at most <italic>tandemGapMax</italic> genes, which is a user-defined parameter. Then a unique location is chosen for the representative locus; usually the index of the first gene of the cluster, and the chromosome is rewritten (<xref ref-type="fig" rid="pone.0180198.g003">Fig 3B</xref>). This method circumvents interruptions of collinearity caused by segmental tandem duplications of lengths ≤ <italic>tandemGapMax</italic>.</p>
        <fig id="pone.0180198.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0180198.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Collapsing a cluster of tandem duplicates can circumvent ruptures of collinearity caused by tandem segmental duplications.</title>
            <p>Panel <bold>A</bold> contains the matrix of homologies of the comparison of a segment of the human chromosome X and a segment of the mouse chromosome X from Ensembl v69. Two segmental tandem duplications of human genes C and D blur the conservation of the ancestral gene order. Panel <bold>B</bold> details the process of collapsing the clusters of tandem duplicates on the human segment. If <italic>tandemGapMax</italic> ≥1 there are two clusters, a cluster of 3 genes of family C and a cluster of 3 genes of family D. The three C genes form a cluster because less than <italic>tandemGapMax</italic> other genes separate any pair of C genes. All genes in a cluster are collapsed at the location of the first gene, as indicated by the yellow arrow. The same applies with the cluster of the D family. When tandem duplicates are collapsed, the conserved order of ancestral genes now forms an uninterrupted linear diagonal in the matrix of homology packs [<xref rid="pone.0180198.ref005" ref-type="bibr">5</xref>] in Panel <bold>C</bold>. Bounding boxes are drawn as black rectangles around diagonals in panel A and around the diagonal of the identified conserved segment in panel C.</p>
          </caption>
          <graphic xlink:href="pone.0180198.g003"/>
        </fig>
        <p>Because the representative locations of clusters are arbitrarily assigned to the index of their first tandem duplicate, the result of the rewriting may vary depending on the orientation of the chromosome, that either ranks genes in one order or the reverse (<xref ref-type="fig" rid="pone.0180198.g004">Fig 4</xref>).</p>
        <fig id="pone.0180198.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0180198.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Chromosomes orientations may influence conserved segments identification when tandem duplicates are collapsed.</title>
            <p>Panel <bold>A</bold> shows the matrix of homologies of the comparison of a segment of human chromosome 17 and a segment of mouse chromosome 11 from Ensembl v81. For a <italic>tandemGapMax</italic> ≥ 1, the human segment contains two clusters of tandem duplicates, one with two genes E and one with two genes G, while the mouse segment also contains two clusters of tandem duplicates for E and G but with three copies of each. The matrix of homology packs [<xref rid="pone.0180198.ref005" ref-type="bibr">5</xref>] after collapsing all clusters is shown in panel <bold>B</bold>. Panel <bold>C</bold> shows the same data as in panel A, but this time the mouse segment is inverted on the y-axis, so that now mouse genes are ranked in the opposite order. With the new orientation of the mouse segment, the gene content of the resulting conserved segment (ABCDEFGHIJK in Panel A and ABCDFHIJK in Panel D) changes but in both cases the two extremities are the same, the 5’ extremity of the gene A and the 5’ extremity of gene K.</p>
          </caption>
          <graphic xlink:href="pone.0180198.g004"/>
        </fig>
        <p>If clustered paralogs have the same orientation, the representative orientation of the cluster is equal to the consensus orientation (either +1 or -1). For instance, in <xref ref-type="fig" rid="pone.0180198.g003">Fig 3</xref>, the representative orientation of the three C genes is +1 and the representative orientation of the three D genes is -1. In contrast, if at least two genes of a cluster of tandem duplicates have different orientations, the representative orientation is considered “unknown” and the orientation is equal to a special value, ∅. We explained in [<xref rid="pone.0180198.ref005" ref-type="bibr">5</xref>] how extended definitions of homology matrices and diagonals encompass “unknown” orientations. For simplicity we will consider here that all clusters of tandem duplicates have a known representative orientation, either +1 or -1.</p>
        <p>When comparing two extant genomes, collapsing clusters of tandem duplicates (in addition to removing genes with no homolog in the other genome) brings the matrix of homologies (<xref ref-type="supplementary-material" rid="pone.0180198.s007">S7 Fig</xref>) closer to the matrix with only conserved ancestral genes (<xref ref-type="supplementary-material" rid="pone.0180198.s005">S5 Fig</xref>). The remaining difference is at least due to dispersed copies of ancestral genes.</p>
      </sec>
    </sec>
    <sec id="sec008">
      <title>Post-processing</title>
      <p>From now on, we consider that we have identified a set of synteny blocks, in the form of diagonals with gaps ≤ <italic>gapMax</italic>.</p>
      <sec id="sec009">
        <title>Identifying micro-rearrangements of at least two genes within gaps of synteny blocks</title>
        <p>To identify micro-rearrangements of at least two ancestral genes, we search for completely or partially nested synteny blocks within gaps of other synteny blocks. We consider that a synteny block A is <italic>completely nested</italic> in a synteny block B if the genes of A are nested in B in both extant genomes (<xref ref-type="fig" rid="pone.0180198.g005">Fig 5A</xref>) and <italic>partially nested</italic> if the genes of A are nested in B in only one extant genome (<xref ref-type="fig" rid="pone.0180198.g005">Fig 5C</xref>). The host block is thus split at the insertion location of the nested block (<xref ref-type="fig" rid="pone.0180198.g005">Fig 5C and 5D</xref>). A consequence of identifying these micro-rearrangements is to increase the overall number of blocks, to decrease the lengths of blocks and also to identify new rearrangement breakpoints. In the next section we will see how to identify the specific case of micro-rearrangements of one unique ancestral gene.</p>
        <fig id="pone.0180198.g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0180198.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <title>Identifying micro-rearrangements and mono-genic conserved segments.</title>
            <p>In panel A, the homology matrix corresponds to two synteny blocks, one (corresponding to the purple diagonal) completely nested in the other (green diagonal). In addition, the large diagonal contains a nested single-gene homology (- sign in the middle) and is adjacent to another single-gene homology (the bottom-right—sign). In panel B, after post-processing, the two synteny blocks are now broken down into four conserved segments of which one is mono-genic (corresponding to the red homology) and the two single gene homologies are identified as mono-genic conserved segments (blue and orange homologies). In Panel C, there is a synteny block (purple diagonal) partially nested in another block (blue diagonal). In Panel D, the identification of the corresponding micro-rearrangement leads to three separate diagonals of conserved segments.</p>
          </caption>
          <graphic xlink:href="pone.0180198.g005"/>
        </fig>
      </sec>
      <sec id="sec010">
        <title>Identifying mono-genic conserved segments</title>
        <p>To identify mono-genic conserved segments we search for single-gene homologies that are completely nested within the gaps of diagonals with a opposite sign compared to the surrounding signs of the host diagonal (<xref ref-type="fig" rid="pone.0180198.g005">Fig 5A and 5B</xref>). Additional mono-genic conserved segments are identified in the neighbourhood around edges of bounding boxes of diagonals and around edges of the homology matrix. For instance, a single-gene homology immediately adjacent to an extremity of a diagonal with opposite signs is identified as a mono-genic conserved segment (orange homology in <xref ref-type="fig" rid="pone.0180198.g005">Fig 5A and 5B</xref>).</p>
      </sec>
      <sec id="sec011">
        <title>Solving overlaps</title>
        <p>We now describe a two-stage refinement to solve the problem of overlaps between putative synteny blocks, i.e. overlaps of their diagonals and more precisely the overlap of the orthogonal projections of the bounding boxes of the diagonals. First, for overlaps between two diagonals that are smaller than a user-defined parameter <italic>truncationMax</italic>, the overlapping region containing the fewest homologies is truncated (<xref ref-type="fig" rid="pone.0180198.g006">Fig 6A and 6B</xref>). Second, for diagonals that still overlap after the truncation, a subset of non-overlapping diagonals is selected while minimising the number of dismissed homologies in discarded diagonals. To do this we start by creating a conflict graph [<xref rid="pone.0180198.ref021" ref-type="bibr">21</xref>] where vertices are diagonals that have overlaps and where edges are overlaps (conflicts) between pairs of diagonals. Afterwards, the diagonal with the highest number of homologies is selected and the corresponding vertex is removed from the graph. Due to overlaps with the selected diagonal, all the vertices previously connected to the removed vertex are also removed and corresponding diagonals are discarded. Edges are updated and those without two vertices at their extremities are removed. Newly isolated vertices (diagonals with no more overlap) are automatically selected and corresponding vertices are removed from the graph. Then another diagonal with the highest number of homologies is selected. As previously, overlapping diagonals are then discarded and the graph is edited. This recursive procedure is performed until all overlapping diagonals have been selected or discarded, i.e. until the conflict graph is empty. The recursive procedure to solve a conflict graph has been previously explained [<xref rid="pone.0180198.ref021" ref-type="bibr">21</xref>]. The “weighted rectangles” of [<xref rid="pone.0180198.ref021" ref-type="bibr">21</xref>] correspond in our case to bounding boxes of diagonals weighted with the number of homologies in each diagonal.</p>
        <fig id="pone.0180198.g006" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0180198.g006</object-id>
          <label>Fig 6</label>
          <caption>
            <title>Resolution of overlaps and resolution of what seems to be an incorrect rupture of synteny.</title>
            <p>The homology matrix in Panel <bold>A</bold> corresponds to the comparison of a segment of the opossum chromosome and a segment of the chicken chromosome with a <italic>tandemGapMax</italic> = 2 in Ensembl version 81. The scenario that leads to the compared extant genomes is debatable. Except for the insertion of the gene X (grey gene on the y-axis) that is probably due to a dispersed duplication, the scenario may involve: inversions, transpositions of genes over a small distance or tandem duplications (with the insertion of copies a few genes away from copied ancestral genes) followed by deletions of the copied ancestral genes. Since tandem duplications and gene deletions seem to outnumber chromosomal rearrangements, we made the choice of considering that the true scenario involves only two tandem duplications followed by deletions of the copied ancestral genes thus both limiting uncertain breakpoints and uncertain extremities of conserved segments. The homology matrix in Panel <bold>B</bold> represents the result of the truncation used to solve small overlaps of diagonals. Panel <bold>C</bold> shows the result of the merge of the extremity of the truncated diagonals that solves the initial incorrect rupture of synteny, delimited by the red rectangle in Panel A.</p>
          </caption>
          <graphic xlink:href="pone.0180198.g006"/>
        </fig>
      </sec>
      <sec id="sec012">
        <title>Repairing incorrect ruptures of collinearity by truncating one extremity followed by fusion of the truncated extremity</title>
        <p>A local ambiguity on the conservation of the ancestral gene order often yields two incomplete putative synteny blocks, one on each side of the ambiguous region, see <xref ref-type="fig" rid="pone.0180198.g006">Fig 6A</xref>. After the truncation explained above, the last refinement step simply merges the extremities of truncated diagonals of synteny blocks, and false conserved segment extremities are then eliminated (<xref ref-type="fig" rid="pone.0180198.g006">Fig 6B and 6C</xref>).</p>
        <p>The four post-processing steps are integrated into a workflow (<xref ref-type="supplementary-material" rid="pone.0180198.s011">S11 Fig</xref>) which improved the quality of our results on real data compared to more simple workflows.</p>
      </sec>
    </sec>
    <sec id="sec013">
      <title>Recall and precision analysis of the detection of conserved segments</title>
      <p>The pre-processing step that collapses clusters of tandem duplicates and the four refinement steps have been implemented in a new version of PhylDiag [<xref rid="pone.0180198.ref005" ref-type="bibr">5</xref>] benchmarked by simulations, showing substantial improvements. Using a realistic simulation of the evolution of gene order [<xref rid="pone.0180198.ref009" ref-type="bibr">9</xref>](<xref ref-type="supplementary-material" rid="pone.0180198.s017">S1 Text</xref>) and the corresponding simulated conserved segments, we computed the recall and precision of this new version of PhylDiag in recovering the true conserved segments. Although they are not <italic>strictly</italic> conserved segments, the synteny blocks of i-ADHore 3.0 and Cyntenator (more precisely the base_clusters of i-ADHoRe 3.0 and the RSBs of Cyntenator) are also included in the benchmark as if they were conserved segments, since, to our knowledge, they are the most relevant entities to approach our definition of conserved segments. For this reason we will compare the synteny blocks of i-ADHoRe 3.0 and Cyntenator in the same conditions as the conserved segments of PhylDiag. Furthermore, identifying accurate synteny blocks (resp. conserved segments) from a comparison of two genomes is a prerequisite for the identification of accurate synteny blocks (resp. conserved segments) from a multi-genomes comparison, thus we only compare pairs of genomes in the benchmark, although, contrary to PhylDiag, i-ADHoRe 3.0 and Cyntenator allow multi-genome comparisons. We used base_clusters of i-ADHoRe 3.0 instead of multiplicons because base_clusters seemed closer to our definition of conserved segments. Similarly, we wanted to use Conserved Syntenies over Multiple species (CSMs) from Cyntenator, [<xref rid="pone.0180198.ref007" ref-type="bibr">7</xref>], that are probably closer to our definition of conserved segments. However, the output only returned RSBs, a RSB being the largest genomic region of all overlapping CSMs.</p>
      <p>More precisely, we set some parameters of i-ADHoRe 3.0 to their default value: <italic>anchor_points</italic> = 3, <italic>prob_cutoff</italic> = 0.001 and <italic>tandem_gap</italic> = 5 (equal to the value of the parameter <italic>tandemGapMax</italic> we used for PhylDiag). In <xref ref-type="fig" rid="pone.0180198.g007">Fig 7</xref>, the remaining parameters <italic>gap_size</italic> and <italic>cluster_gap</italic> are equal and vary as the values of the corresponding parameter <italic>gapMax</italic> in PhylDiag. Different values of the probability threshold (<italic>proba_cutoff</italic>) have been tested and we kept the value that maximised the results of i-ADHoRe 3.0, corresponding to the default value. We used the default values for the parameters of Cyntenator: <italic>mismatch</italic> = -3, <italic>coverage</italic> = 2 and <italic>filter</italic> = 100 except for the parameters, <italic>threshold</italic> and <italic>gap</italic> that varies (<xref ref-type="fig" rid="pone.0180198.g008">Fig 8</xref>). We also tried several <italic>mismatch</italic> values but they did not change substantially the results and corresponding graphs almost completely overlapped graphs with the same <italic>gap</italic> value in <xref ref-type="fig" rid="pone.0180198.g008">Fig 8</xref> so we omitted them. Pre-processing genomes and collapsing clusters of tandem duplicates (still with <italic>tandemGapMax</italic> = 5), did not change significantly the results of Cyntenator. Figs <xref ref-type="fig" rid="pone.0180198.g007">7</xref> and <xref ref-type="fig" rid="pone.0180198.g008">8</xref> can be reproduced following the protocol <monospace><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.17504/protocols.io.idnca5e">dx.doi.org/10.17504/protocols.io.idnca5e</ext-link></monospace>.</p>
      <fig id="pone.0180198.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0180198.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Recall and precision analysis of PhylDiag and i-ADHoRe 3.0 based on simulated conserved segments of two distant species, mouse and chicken that diverged 325 Million years ago.</title>
          <p>The analysis is performed based on a realistic simulation [<xref rid="pone.0180198.ref009" ref-type="bibr">9</xref>](<xref ref-type="supplementary-material" rid="pone.0180198.s017">S1 Text</xref>) of the evolution of gene order that replicates features of extant genomes of Ensembl 81. The first column (left) corresponds to the detection of extremities of conserved segments. The second column (middle) corresponds to the detection of adjacencies of genes in conserved segments. And the third column (right) corresponds to the detection of gene names in conserved segments. For each item and each parameterisation of algorithms, recall (top), precision (middle) and F1-score (bottom) are shown as a function of <italic>gapMax</italic>. The refinement methods described in this manuscript are <italic>imr</italic> (Identify Micro-Rearrangements), <italic>imcs</italic> (Identify Mono-genic Conserved Segments) and <italic>t</italic> (Truncation). A “-”sign means that the option is inactive and an integer, even 0, means that the option is active. For the option <italic>imr</italic>, the integer value specifies the maximum gap allowed between: the extremity of an identifiable micro-segment and the nearest homology of the diagonal in which it is included (<xref ref-type="supplementary-material" rid="pone.0180198.s012">S12 Fig</xref>). For the option <italic>imcs</italic>, the integer value sets the width of the neighbourhood around edges of bounding boxes of diagonals of synteny blocks where mono-genic conserved segments are identified (<xref ref-type="supplementary-material" rid="pone.0180198.s013">S13 Fig</xref>). For the option <italic>t</italic>, the integer value specifies the <italic>truncationMax</italic> parameter value. Truncating and solving remaining overlaps with <italic>truncationMax</italic> = 4 does not decrease substantially recall and precision while ensuring that conserved segments are not overlapping. The black curves represent the results of i-ADHoRe 3.0 for varying values of the parameters <italic>gap_size</italic> and <italic>cluster_gap</italic>, both equal to <italic>gapMax</italic> along the axis. <italic>gap_size</italic> and <italic>cluster_gap</italic> parameters of i-ADHoRe 3.0 does not allow 0 values thus graphs of i-ADHoRe 3.0 begin at gapMax = 1.</p>
        </caption>
        <graphic xlink:href="pone.0180198.g007"/>
      </fig>
      <fig id="pone.0180198.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0180198.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Recall and precision analysis of Cyntenator based on the same simulation as in <xref ref-type="fig" rid="pone.0180198.g007">Fig 7</xref>.</title>
          <p>The parameter varying is <italic>threshold</italic>, the cut-off value of Cyntenator that discards all alignments of genes with lower scores.</p>
        </caption>
        <graphic xlink:href="pone.0180198.g008"/>
      </fig>
      <p>The quality of the detection of conserved segments is estimated for each algorithm using three types of items: extremities of conserved segments, adjacencies of genes in conserved segments and gene names in conserved segments. For one simulation, the set of detected items (<italic>D</italic>) derived from conserved segments inferred from extant simulated genomes is compared to the set of true items (<italic>T</italic>) derived from conserved segments recorded during the simulation. The set of true positive items (<italic>Tp</italic>) contains the intersection of both sets, <italic>Tp</italic> = <italic>D</italic> ∩ <italic>T</italic>. The set of false positive items (<italic>Fp</italic>) contains the set of detected items that are not true, <italic>Fp</italic> = <italic>D</italic> \ <italic>T</italic>. The set of false negative items (<italic>Fn</italic>) is the set of true items that are not detected <italic>Fn</italic> = <italic>T</italic> \ <italic>D</italic>. The recall (<italic>r</italic>), also called sensitivity, and the precision (<italic>p</italic>) are defined by the equations
<disp-formula id="pone.0180198.e001"><alternatives><graphic xlink:href="pone.0180198.e001.jpg" id="pone.0180198.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mi>p</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mi>p</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mi>p</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mi>F</mml:mi><mml:mi>n</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="1em"/><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mi>p</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mi>p</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mi>p</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mi>F</mml:mi><mml:mi>p</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
with |<italic>x</italic>| the number of items in the set <italic>x</italic>. We also calculated the F1-score (<italic>F</italic>1), also called F-score or F-measure. It is a common tradeoff between recall and precision, giving equal importance to both and it may thus be considered as a general score for quantifying the quality of detection. The F1-score is the harmonic average of recall and precision,
<disp-formula id="pone.0180198.e002"><alternatives><graphic xlink:href="pone.0180198.e002.jpg" id="pone.0180198.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:mi>F</mml:mi><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mi>r</mml:mi><mml:mo>⋅</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula></p>
      <p>Examples of true positives sets of detected items, false positives sets, false negatives sets and sets of true items are given at the end of the captions of Figs <xref ref-type="fig" rid="pone.0180198.g009">9</xref> and <xref ref-type="fig" rid="pone.0180198.g010">10</xref>; followed by the corresponding recalls and precisions.</p>
      <fig id="pone.0180198.g009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0180198.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <title>Two scenarios, one with breakpoints, the other without breakpoint that cannot be distinguished with our data.</title>
          <p>In Panel <bold>A</bold>, an initial chromosome of an ancestral species S<sub><bold>a</bold></sub> evolves up to two extant species, S<sub><bold>1</bold></sub> and S<sub><bold>2</bold></sub>. No events take place from S<sub><bold>a</bold></sub> to S<sub><bold>2</bold></sub> but gene B is inverted between S<sub><bold>a</bold></sub> and S<sub><bold>1</bold></sub>, creating two breakpoints and resulting in three conserved segments which are easily identified in the homology matrix at the bottom. In Panel <bold>B</bold>, gene B is tandemly duplicated with a reverse orientation from S<sub><bold>a</bold></sub> to S<sub><bold>1</bold></sub>, and the ancestral copy is deleted. From the comparison of extant genomes of S<sub><bold>1</bold></sub> and S<sub><bold>2,</bold></sub> since the non-ancestral gene B (with no black outer line) is incorrectly considered as an ancestral gene, the homology matrix appears identical to the mono-genic inversion scenario in panel A. Therefore 3 conserved segments are returned and 6 extremities of conserved segments are detected whereas only one conserved segment should be returned, with two extremities, as explained in Panel <bold>C</bold>. In Panel B, the sets of extremities of conserved segments used for the calculation of the recall and the precision are T = {sA,eC}, D = {sA,eA,sB,eB,sC,eC}, Tp = {sA,eC}, Fp = {eA,sB,eB,sC} and Fn = ∅; with sX the 5’ extremity (start) of the gene X and eX the 3’ extremity (end). Thus the recall is 100% and the precision is 33%. Similarly, if gene orientations are not considered, T = {A,C}, D = {A,B,C}, Tp = {A,C}, Fp = {B} and Fn = ∅, thus the recall is 100%, the precision is 66%. Concerning gene adjacencies with gene orientations, T = {eA-sC}, D = ∅, Tp = ∅, Fp = ∅ and Fn = {eA-sC}; with X-Y the adjacency of the gene extremity X and gene extremity Y. Thus recall and precision are both null here. Finally, if we are interested in gene names in conserved segments, T = {A,C}, D = {A,B,C}, Tp = {A,C}, Fp = {B} and Fn = ∅ thus the recall is 100% and the precision is 66%.</p>
        </caption>
        <graphic xlink:href="pone.0180198.g009"/>
      </fig>
      <fig id="pone.0180198.g010" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0180198.g010</object-id>
        <label>Fig 10</label>
        <caption>
          <title>Breakpoints between tandem duplicates yield unsolvable false positive and false negative extremities of conserved segments.</title>
          <p>In Panel <bold>A</bold>, an initial chromosome of an ancestral species S<sub><bold>a</bold></sub> evolves until two extant species, S<sub><bold>1</bold></sub> and S<sub><bold>2</bold></sub>. Along the lineage from S<sub><bold>a</bold></sub> to S<sub><bold>2</bold></sub> the chromosome is perfectly conserved, and along the lineage from S<sub><bold>a</bold></sub> to S<sub><bold>1</bold></sub> gene C is duplicated in tandem. The non-ancestral copy of gene C has no black outer line. Then an inversion occurs with the right breakpoint falling between the two tandem duplicates. From extant genomes of S<sub><bold>1</bold></sub> and S<sub><bold>2</bold></sub> it is impossible to know which paralog of gene C in S<sub><bold>1</bold></sub> is non-ancestral, thus both copies are considered as a probable ancestral gene C. Although the analysis of the homology matrix yields 3 conserved segments, if the non-ancestral gene C is falsely considered as the ancestral gene, there are two false positive extremities and two false negative extremities. Panel <bold>B</bold> describes the desired homology matrix obtained when the ancestral gene C is correctly identified. In Panel A, the sets of extremities of conserved segments used for the calculation of the recall and the precision are T = {sA,eA,sB,eB,sC,eD}, D = {sA,eA,sB,eC,sD,eD}, Tp = {sA,eA,sB,eD}, Fp = {eC,sD} and Fn = {eB,sC} with sX the 5’ extremity (start) of the gene X and eX the 3’ extremity (end). Thus the recall and the precision are both equal to <bold>66%</bold>. If we focus on the detection of gene adjacencies without considering gene orientations, T = {C-D}, I = {B-C}, Tp = ∅, Fp = {B-C} and Fn = {C-D} with X-Y the adjacency of genes X and Y. The associated recall and precision are thus null here.</p>
        </caption>
        <graphic xlink:href="pone.0180198.g010"/>
      </fig>
      <p>To make the comparisons possible with i-ADHoRe 3.0 and Cyntenator, we did not account for gene orientations in conserved segments in our calculations, i.e. extremities of conserved segments are the gene names only and adjacencies are pairs of gene names.</p>
      <p>First, we focus on the detection of extremities of conserved segments with the following options activated in PhylDiag: detection of mono-genic conserved segments, detection of micro-rearrangements and resolution of small gene order disruption (yellow curve). Results show a 20% increase in recall at <italic>gapMax</italic> = 1 from 57% up to 77% without any substantial decrease in precision (<xref ref-type="fig" rid="pone.0180198.g007">Fig 7</xref>). As explained later in Figs <xref ref-type="fig" rid="pone.0180198.g009">9</xref> and <xref ref-type="fig" rid="pone.0180198.g010">10</xref>, precision is high but never reaches 100%, which is most likely due to the numerous gene duplications and deletions that occurred in the mouse and chicken lineages that raise the number of false positives. For all <italic>gapMax</italic> values the recall and precision of i-ADHoRe 3.0 are lower or close to the recall and precision of PhylDiag, even without any post-treatment (blue curve) (<xref ref-type="fig" rid="pone.0180198.g007">Fig 7</xref>). The results of Cyntenator are displayed in <xref ref-type="fig" rid="pone.0180198.g008">Fig 8</xref>, since it has no parameter equivalent to the <italic>gapMax</italic> parameter the varying parameter is <italic>threshold</italic>, i.e. the main parameter of Cyntenator representing a cut-off value that discards all segments with lower scores. For all values of the parameter <italic>threshold</italic> tested, either the precision is less than 60% or the recall is less than 60%: the increase in precision gained by increasing <italic>threshold</italic> is compromised by a drastic loss of recall.</p>
      <p>Second, if we consider gene adjacencies rather than extremities, the recall and precision of PhylDiag is still above the recall and precision of i-ADHoRe 3.0 whatever the <italic>gapMax</italic>. The analog recall and precision of Cyntenator both stay under 87%, below the recall and precision of PhylDiag reached with most of the <italic>gapMax</italic> values.</p>
      <p>Finally, if we study the detection of gene names, the precision of PhylDiag is higher or close to the precision of i-ADHoRe 3.0 as soon as at least one of the options is activated, while the recall of PhylDiag stays substantially 3–4% above. The recall of Cyntenator is very high (99.66%) with a <italic>threshold</italic> equal to 1 and a <italic>gap</italic> equal to -1000000000 although the corresponding precision (95.84%) is below the precision of PhylDiag (above 97% whatever the activated options).</p>
      <p>F1-scores show that PhylDiag is always ahead whatever the type of items considered and whatever the options activated, except in a marginal case: when comparing ancestral families, Cyntenator, with a deterrent gaps cost (<italic>gap</italic> = -1000000000) and a <italic>threshold</italic> equal to 1 reaches a higher F1-score than PhylDiag.</p>
      <p>Poor F1-scores of Cyntenator when considering extremities of conserved segments or adjacencies of genes might be explained by considering RSBs’ components: CSMs, that are probably closer to our definition of conserved segments. The integration of overlapping CSMs within long RBSs probably leads to numerous false negative extremities and false positive adjacencies. Extremities of a CSM corresponding to a true conserved segment will be overlooked, if it is embedded within a RSB. In addition, the junction of neighbouring CSMs embedded in the same RSB will be detected as an adjacency of the RSB, leading to false positive adjacencies as soon as both embedded CSMs are genuine conserved segments.</p>
      <p><xref ref-type="fig" rid="pone.0180198.g007">Fig 7</xref> also shows that, with PhylDiag, a <italic>gapMax</italic> equal to 0 returns low F1-scores because of artificial gaps due to dispersed duplications creating scattered artificial gaps equal to 1 gene. On the contrary a <italic>gapMax</italic> of 1 is enough to reach optimal F1-scores since only dispersed duplications and no other source of artificial gaps are simulated. Despite this, experience shows that a higher <italic>gapMax</italic> is required for returning accurate conserved segments when comparing real genomes, since assembly and annotation errors generate additional artificial gaps in conserved segments. Fortunately, when studying extremities and gene adjacencies of conserved segment, activating the detection of micro-rearrangements strikingly stabilises the recall of the detection of extremities and the precision of adjacencies. Thus even high <italic>gapMax</italic> values can be used with lasting high recall and lasting high precision; contrary to corresponding recalls and precisions of i-ADHoRe 3.0 that both decrease when the <italic>gapMax</italic> increases, due to the presence of micro-rearrangements within base_clusters.</p>
    </sec>
    <sec id="sec014">
      <title>Justification of remaining false negatives and false positives</title>
      <p>Using simulated conserved segments makes it possible to investigate the source of remaining mistakes during the detection of extremities of conserved segments: false positive and false negative extremities of conserved segments, which prevent the recall and precision of PhylDiag to reach 100% (<xref ref-type="fig" rid="pone.0180198.g007">Fig 7</xref>). Based on our simulations, it appears that mistakes come mainly from scenarios involving ancestral genes, first duplicated in tandem and then deleted, and also from breakpoints within clusters of tandem duplicates. We estimate these two scenarios to be very common in our simulation (<xref ref-type="supplementary-material" rid="pone.0180198.s015">S15 Fig</xref>). Two examples of these types of scenarios are depicted in Figs <xref ref-type="fig" rid="pone.0180198.g009">9</xref> and <xref ref-type="fig" rid="pone.0180198.g010">10</xref>. The first corresponds to extremities of mono-genic segments, which appear as mono-genic inversions but which in fact result from a reverse tandem duplication [<xref rid="pone.0180198.ref018" ref-type="bibr">18</xref>] followed by a mono-genic deletion (<xref ref-type="fig" rid="pone.0180198.g009">Fig 9</xref>). Both situations lead to indistinguishable gene arrangements in extant genomes. Our process of identifying mono-genic conserved segments always favours the detection of mono-genic inversions (<xref ref-type="fig" rid="pone.0180198.g009">Fig 9A</xref>) instead of the less parsimonious but rearrangement-free duplication-deletion scenario (<xref ref-type="fig" rid="pone.0180198.g009">Fig 9B</xref>). Hence our observation that recall increases when the mono-genic inversion occurred and that precision decreases when the rearrangement-free scenario occurred.</p>
      <p>A second source of false positive and false negative extremities of conserved segments are breakpoints that fall between tandemly duplicated genes (<xref ref-type="fig" rid="pone.0180198.g010">Fig 10</xref>).</p>
      <p>Knowing which tandem duplicate is the ancestral gene would solve wrong identifications explained in Figs <xref ref-type="fig" rid="pone.0180198.g009">9</xref> and <xref ref-type="fig" rid="pone.0180198.g010">10</xref> but since the two tandem duplicates play a symmetrical role after the duplication, it is impossible to distinguish the ancestral gene. Thus evolutionary scenarios similar to those of Figs <xref ref-type="fig" rid="pone.0180198.g009">9</xref> and <xref ref-type="fig" rid="pone.0180198.g010">10</xref> yield indiscernible extremities of conserved segments that prevent recall and precision to be 100%. In both scenarios depicted here, the ancestral genome is altered within one unique lineage. Similar scenarios where the ancestral genome is altered in both lineages, leading to unavoidable wrong identifications probably occur, but seem less frequent from our non-exhaustive analysis. In addition, since our simulator may not realistically simulate breakpoints reuse [<xref rid="pone.0180198.ref022" ref-type="bibr">22</xref>], we were not able to estimate how “done and undone rearrangements” (for example two successive inversions that reverse the same segment twice) are substantial sources of false negatives.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec015">
    <title>Conclusion</title>
    <p>In the field of comparative genomics performed at the scale of whole genomes, small rearrangements are generally dismissed from consideration because they are difficult or impossible to distinguish from assembly and annotation errors [<xref rid="pone.0180198.ref002" ref-type="bibr">2</xref>]. Yet the corresponding breakpoints of true small inversions may completely reshape a set of conserved segments that was detected without considering them. As a consequence, what may be thought to be a long conserved segment may prove to be several conserved segments of modest sizes when micro-inversions are considered. With improvements in the accuracy of genome assemblies and annotations, we believe that it might be time to start studying small rearrangements simultaneously to macro-rearrangements. In this context our method is the first to identify conserved segments up to mono-genic segments. It finds conserved segments with a level of accuracy that takes the full advantage of knowing the transcription orientations of genes (<xref ref-type="fig" rid="pone.0180198.g005">Fig 5</xref>). Furthermore it solves complex cases of synteny involving remnants of tandem duplications (Figs <xref ref-type="fig" rid="pone.0180198.g003">3</xref> and <xref ref-type="fig" rid="pone.0180198.g004">4</xref>) as well as incorrect ruptures of syntenies (<xref ref-type="fig" rid="pone.0180198.g006">Fig 6</xref>). Yet we show that the quality of conserved segment detection cannot reach 100% since some scenarios of evolution without breakpoint yield similar extant genomes to scenarios of evolution with breakpoints (Figs <xref ref-type="fig" rid="pone.0180198.g009">9</xref> and <xref ref-type="fig" rid="pone.0180198.g010">10</xref>).</p>
    <p>We also show that modular pre-processing of genomes and post-processing refinements of synteny blocks, with few parameters, mainly <italic>tandemGapMax</italic> and <italic>truncationMax</italic>, represent an intuitive yet rigorous alternative to all-in-one greedy graph-based heuristics [<xref rid="pone.0180198.ref019" ref-type="bibr">19</xref>,<xref rid="pone.0180198.ref020" ref-type="bibr">20</xref>,<xref rid="pone.0180198.ref023" ref-type="bibr">23</xref>] that may be more difficult to configure [<xref rid="pone.0180198.ref024" ref-type="bibr">24</xref>]. In addition, it has been demonstrated [<xref rid="pone.0180198.ref024" ref-type="bibr">24</xref>] that structures of such graphs “do not show crucial pieces of alignment information”. For instance, except for Enredo[<xref rid="pone.0180198.ref019" ref-type="bibr">19</xref>], they do not display mono-genic inversions.</p>
    <p>Here, we considered chromosomes as linear arrays of ordered and oriented genes, but considering nucleotide sequences could help resolve some remaining issues. For example, it may help distinguish the ancestral gene among clusters of tandem duplicates. This would provide a more accurate localisation of the ancestral gene copy within a cluster of tandem duplicates and would help identify the correct scenario in Figs <xref ref-type="fig" rid="pone.0180198.g009">9</xref> and <xref ref-type="fig" rid="pone.0180198.g010">10</xref>. Nucleotide sequences could also be used to extend conserved segment extremities in order to further investigate precisely delimited breakpoint regions as in [<xref rid="pone.0180198.ref016" ref-type="bibr">16</xref>]. Also, when solving the conflict graph, the method currently implemented in PhylDiag may return a suboptimal set of non-overlapping diagonals and another set of non-overlapping diagonals may exist with more homologies [<xref rid="pone.0180198.ref021" ref-type="bibr">21</xref>].</p>
    <p>In line with a previous comparison [<xref rid="pone.0180198.ref008" ref-type="bibr">8</xref>], ours revealed substantial differences between algorithms aiming at identifying “synteny blocks”, even while comparing two genomes instead of many genomes. We confirm that the community would benefit from a clear definition of a “synteny block”, and we provide and exploit here an evolutionarily consistent definition that follows from the intuitive definition of Pevzner and Tesler [<xref rid="pone.0180198.ref002" ref-type="bibr">2</xref>]. It would be interesting to investigate if the pre- and post-processes ideas presented in this article could improve multi-genome comparisons. Improved accuracy of multi-genome conserved segments would be greatly beneficial for the inference of rearrangements scenarios from one ancestral genome to more than two genomes.</p>
    <p>Finally, it would be of great interest to simulate errors (assembly errors, annotation errors or even errors in gene trees) in addition to the main known events that alter genomes during evolution (<xref ref-type="supplementary-material" rid="pone.0180198.s014">S14 Fig</xref>). This could help us understand how these errors affect algorithms–given that some algorithms might be more robust to errors than others. However, relevant statistics on errors in genomic data (e.g. vertebrate genomes of the Ensembl database) are difficult to obtain. We hope that an increased consideration of micro-rearrangements will help detect such remaining errors.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec016">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0180198.s001">
      <label>S1 Fig</label>
      <caption>
        <title>Evolution from of an ancestral genome made of 2 chromosomes (top) along two lineages, to two extant species S<sub>1</sub> and S<sub>2</sub>.</title>
        <p>The arrow in the center, pointing towards the bottom, is the time arrow. The genome before and after each event is drawn to show how each event altered it. Colours and capital characters correspond to gene families. Genes outlined in black are ancestral genes except genes filled in white that are genes from families originating after the speciation (genes specific to one lineage). Genes not outlined in black are non-ancestral genes inserted due to duplication. Small characters after dots help here to differentiate copies and copied genes: A.a is not the same gene as gene A even if they are both in the family of gene A. Furthermore if gene A was once more duplicated there would be an instantiated copy named A.b newly inserted in the genome and if the gene A.a was duplicated there would be an instantiated copy named A.a.a. The dates of the events, that either include chromosomal rearrangements with breakpoints or ancestral gene deletions, are specified along the time arrow because they alter conserved segments. Chromosomal fusions, gene duplications and <italic>de novo</italic> gene births do not alter conserved segments. Corresponding evolutions of conserved segments along different lineages are drawn afterwards in <xref ref-type="supplementary-material" rid="pone.0180198.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pone.0180198.s003">S3</xref> Figs.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s002">
      <label>S2 Fig</label>
      <caption>
        <title>Evolution of the conserved segments from the ancestral genome <italic>to S</italic><sub><italic>1</italic></sub> corresponding to the evolution depicted in <xref ref-type="supplementary-material" rid="pone.0180198.s001">S1 Fig</xref>.</title>
        <p>Between t = 0 and t = t<sub>1</sub>, before any alteration of the ancestral gene order or ancestral gene content, the conserved segments are exact copies of the ancestral chromosomes in the ancestral genome. The two breakpoints of the translocation 1 (in the first lineage) start breaking the conserved segments at the two corresponding spaces between ancestral genes. Afterwards, the gene deletion 1 removes the ancestral gene G from the conserved segments. Next, breakpoints associated with extremities of rearranged segments keep fragmenting conserved segments until the 7 final conserved segments from the ancestral genome to S<sub>1</sub>.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s003">
      <label>S3 Fig</label>
      <caption>
        <title>Evolution of the conserved segments from the ancestral genome <italic>to S</italic><sub><italic>1</italic></sub>
<italic>and S</italic><sub><italic>2</italic></sub> corresponding to the evolution depicted in <xref ref-type="supplementary-material" rid="pone.0180198.s001">S1 Fig</xref>.</title>
        <p>Here again, before the translocation 1 the conserved segments are exact copies of the ancestral chromosomes, and the translocation 1 (in the first lineage) starts breaking the conserved segments at two breakpoints. The next event altering conserved segments along both lineages is, in this case, an event in the second lineage: fission 2. Considering events in both lineages returns more and smaller conserved segments than in <xref ref-type="supplementary-material" rid="pone.0180198.s002">S2 Fig</xref>: here, when the evolution is finished, 10 segments of the ancestral genome have been conserved. In addition, more deletions of ancestral genes in conserved segments are expected when studying the conservation of ancestral segments in multiple lineages instead of in a unique lineage. For instance, the deletion of the ancestral gene G causes the loss of the ancestral gene G, in conserved segments from the ancestor to S<sub>1</sub> and S<sub>2</sub>, even if the deletion only occurred in one lineage; same for the deletion of the ancestral gene F.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s004">
      <label>S4 Fig</label>
      <caption>
        <title>Matrix of homologies of the comparison of the genome of S<sub>1</sub> (on the x-axis) and the genome of S<sub>2</sub> (on the y-axis).</title>
        <p>Each chromosome on the x-axis is ordered from left to right: it starts at left and ends at right. On the y-axis chromosomes are ordered from bottom to top. A gene has a positive orientation if its 3’-5’ orientation (its arrow here) points to the end of its host chromosome. In the contrary, it has a negative orientation if it points to the beginning of the chromosome. For instance, gene P of S<sub>1</sub>, gene P of S<sub>2</sub> and gene E of S<sub>2</sub> have positive orientations (they point either to the right or to the top) whereas gene E of S<sub>1</sub> has a negative orientation, it points to the left. The matrix is an array of <italic>signs</italic> equal to +, − or 0. Non-0 signs correspond to <italic>homology signs</italic>. For instance, the homology sign corresponding to gene P in S<sub>1</sub> and gene P in S<sub>2</sub> is “+” because both genes have a positive orientation. In contrast, Gene E in S<sub>1</sub> has a negative orientation and Gene E in S<sub>2</sub> has a positive orientation thus the corresponding homology has a “-” sign. In the matrix, diagonals of conserved segments from the ancestor to S<sub>1</sub> and S<sub>2</sub> are outlined with black rectangles, and homologies within the same diagonal have the same colour. Both compared genomes have 2 chromosomes and the matrix is thus composed of 4 sub-matrices of homologies of the comparison of pairs of chromosomes. Remark: When the evolution from the ancestor to compared extant genomes is unknown, genes of extant genomes cannot be labelled with ancestral gene names and names of copies. Homology relationships between genes are usually estimated from comparisons of nucleotide sequences and, in practice, genes are labelled with family names. Consequently, ancestral gene localisations are often unknown and a localisation of an ancestral gene is often mixed among the locations of its copies. For instance, if we did not known the evolution depicted in <xref ref-type="supplementary-material" rid="pone.0180198.s001">S1 Fig</xref>, genes B and B.a would both be labelled with the name of their common family, B. Similarly, in <xref ref-type="fig" rid="pone.0180198.g004">Fig 4A</xref> of the main manuscript, two genes are labelled E because both genes are in the same family and, before any analysis of the collinearity, may both be the ancestral gene at the root of their family.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s005">
      <label>S5 Fig</label>
      <caption>
        <title>Matrix of homologies of two extant genomes that have been perfectly filtered, such that only ancestral genes conserved in both lineages are kept.</title>
        <p>In this matrix, conserved segments from the ancestor to the two compared extant genomes can be identified as perfect diagonals with no gaps in the matrix of homologies. Remark: When compared genomes are not filtered (<xref ref-type="supplementary-material" rid="pone.0180198.s004">S4 Fig</xref>), diagonals of conserved segments are blurred with artificial gaps. Dispersed duplications (A.a and A.b), <italic>de novo</italic> gene births (X and Y) and ancestral gene deletions (G and K) create artificial gaps within diagonals (or around diagonals) of conserved segments that would not exist if genomes were perfectly filtered (<xref ref-type="supplementary-material" rid="pone.0180198.s005">S5 Fig</xref>). Furthermore if compared genomes are not filtered, diagonals of conserved segments are also blurred with artificial packs of homologies, vertical or horizontal (<xref ref-type="supplementary-material" rid="pone.0180198.s005">S5 Fig</xref>) or even rectangular (see later in <xref ref-type="supplementary-material" rid="pone.0180198.s008">S8 Fig</xref>) caused by clusters of tandem duplicates. <xref ref-type="supplementary-material" rid="pone.0180198.s006">S6</xref> and <xref ref-type="supplementary-material" rid="pone.0180198.s007">S7</xref> Figs will give examples of matrices of homologies that are obtained with two pre-processings of compared genomes that gradually approach the perfect filtering.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s006">
      <label>S6 Fig</label>
      <caption>
        <title>Matrix of homologies of both extant genomes filtered in such a way that genes without homologs in the other genome are removed.</title>
        <p>Keeping only genes with homologs in the compared genome removes artificial gaps due to <italic>de novo</italic> gene births and gene deletions but can neither solve artificial gaps due to dispersed duplications (A.a and A.b) nor packs of homologies caused by clusters of tandem duplicates (T and T.a or B and B.a).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s007">
      <label>S7 Fig</label>
      <caption>
        <title>Matrix of homologies of both extant genomes filtered in such a way that genes with no homolog in the other genome are removed and with collapsed clusters of tandem duplicates.</title>
        <p>Collapsing clusters of tandem duplicates in addition to removing genes with no homolog in the other genome bring the matrix of homologies closer to the ideal matrix of homologies with perfectly filtered genomes (<xref ref-type="supplementary-material" rid="pone.0180198.s005">S5 Fig</xref>). Yet diagonals still contain artificial gaps caused by dispersed duplications, even with this intense filtering. Hence, in the absence of a better way to pre-process compared genomes, algorithms aiming at identifying synteny blocks or conserved segments, have to deal with artificial gaps; at least unitarian gaps scattered in genomes because of dispersed duplications. A <italic>gapMax</italic> = 0 won’t be sufficient to overcome these artificial gaps and values of <italic>gapMax</italic> at least equal to 1 are necessary.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s008">
      <label>S8 Fig</label>
      <caption>
        <title>Pruning phylogenetic gene trees help distinguishing lineages of tandem duplicated genes.</title>
        <p>An ancestral chromosome of three genes ABC evolves with 2 different scenarios until 2 extant species S<sub>1</sub> and S<sub>2</sub>. In the first scenario, <bold>left column</bold>, the gene B is duplicated in tandem, before the speciation, i.e. the duplication happens between the initial genome and the most recent common ancestor of S<sub>1</sub> and S<sub>2</sub>, MRCA(S<sub>1</sub>, S<sub>2</sub>). The conserved segment from the MRCA to S<sub>1</sub> and S<sub>2</sub> is thus made of 4 ancestral genes. Pruning the gene tree of gene B at the level of the MRCA divides the family of gene B into two families: a smaller family of gene B and a new family corresponding to the legacy of gene B.a. The differentiation of families of genes B and B.a makes it possible to identify the true 4 ancestral genes in the segment conserved from the MRCA to S<sub>1</sub> and S<sub>2</sub>. The second scenario, <bold>right column</bold>, has two duplications after the speciation that give rise to a similar configuration of tandem duplications in extant species. Contrary to the previous scenario, here, both duplications in tandem happen after the MRCA and insert non-ancestral copies of the gene B: B.a and B.b. There are thus only three genes, ABC, in the conserved segment from the MRCA to S<sub>1</sub> and S<sub>2</sub>. Pruning the gene tree of gene B does not change the family of gene B in this case since at the level of the MRCA only gene B exists. Thus tandem duplicates are visible in the matrix of homologies and collapsing clusters of tandem duplicates leads once more to the true number of 3 ancestral genes in the detected segment conserved from the MRCA to S<sub>1</sub> and S<sub>2</sub>. If the scenario of the right column happened, and if the phylogenetic algorithm used for inferring gene trees made a mistake, and found the gene tree of the left column, our detection of conserved segments, as diagonals in the matrix of homologies would make an error. It would detect 4 ancestral genes in the segment conserved from the MRCA to S<sub>1</sub> and S<sub>2</sub> instead of the 3 true ancestral genes. Such interdependences between gene trees and collinearity have been used to improve gene trees using PhylDiag [<xref rid="pone.0180198.ref025" ref-type="bibr">25</xref>].</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s009">
      <label>S9 Fig</label>
      <caption>
        <title>A matrix of homologies corresponding to pre-processed chromosomes of mouse and chicken (chromosomes have been truncated).</title>
        <p>Both chromosomes contain only genes that have homologs in the other genome and clusters of genes duplicated in tandem have been collapsed. Blue arrows point towards examples of artificial gaps within diagonals of conserved segments. These artificial gaps seem to be due to dispersed duplications or errors (assembly errors, annotation errors or errors in gene families). A zoom of the region circled in red is also shown.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s010">
      <label>S10 Fig</label>
      <caption>
        <title>Matrix of homologies calculated with i-ADHoRe 3.0 where a segment of pre-processed human chromosome X is compared to a segment of pre-processed mouse chromosome X.</title>
        <p>Yellow dots represent homologies in a base_cluster and blue dots represent the “confidence intervals” around the base_cluster, see the documentation of i-ADHoRe 3.0 [<xref rid="pone.0180198.ref006" ref-type="bibr">6</xref>]. Here also, after the pre-processing of i-ADHoRe 3.0 (filter + collapse of clusters of tandem duplicates), artificial gaps remain within a diagonal of a conserved segment.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s011">
      <label>S11 Fig</label>
      <caption>
        <title>Workflow for the detection of conserved segments.</title>
        <p>The <monospace>scripts/</monospace> folder, in the LibsDyogen deposit, provides tools to prune.nhx gene trees and extract gene families from pruned gene trees. The new version of PhylDiag (from v2.0.0-alpha) includes the pre-processing and post-processing steps (<ext-link ext-link-type="uri" xlink:href="https://github.com/DyogenIBENS/PhylDiag"><monospace>https://github.com/DyogenIBENS/PhylDiag</monospace></ext-link>).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s012">
      <label>S12 Fig</label>
      <caption>
        <title>Maximum gap allowed between: the extremity of an identified micro-segment and the nearest homology of the diagonal in which it is included.</title>
        <p>An isolated homology is distant with a maximum gap of 1 (length of the black double arrow with the Chebyshev Distance Metric) with the nearest homology of its surrounding diagonal. If the maximum gap allowed for the identification of micro-rearrangements is at least 1, the isolated homology is identified as a mono-genic conserved segment. Black genes are probable ancestral genes inserted because of dispersed duplications or they might be due to errors in data (annotation errors or errors in families).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s013">
      <label>S13 Fig</label>
      <caption>
        <title>Maximum width of the neighbourhood around edges of bounding boxes of synteny blocks where mono-genic conserved segments are identified.</title>
        <p>An isolated homology is distant with a maximum gap of 1 (length of the black double arrow with the Chebyshev distance metric) with the nearest homology of neighbouring diagonals. If the maximum gap allowed for the identification of micro-rearrangements is at least 1, the isolated homology is identified as a mono-genic conserved segment.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s013.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s014">
      <label>S14 Fig</label>
      <caption>
        <title>Events simulated in MagSimus.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s014.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s015">
      <label>S15 Fig</label>
      <caption>
        <title>Species tree with the numbers of events on each branch.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s015.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s016">
      <label>S16 Fig</label>
      <caption>
        <title>Distribution of the length of inversions.</title>
        <p>The curve with the grey surface under the blue curve is the probability mass function (pmf) of the distribution of the lengths of reversed segments. The black line is the corresponding cumulated density function (cdf). The chosen function for the pmf is a discretisation of the gamma function with a shape parameter 0.1 and a scale parameter equal to 800 genes, truncated after 1330 genes. With this distribution, 53.9% of reversed segments are mono-genic, 57.7% of reversed segments contain one or two genes and 63.2% of the reversed segments have at most 5 genes.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0180198.s016.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0180198.s017">
      <label>S1 Text</label>
      <caption>
        <title>Description of the simulation with MagSimus.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0180198.s017.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are grateful to Lucas Tittmann for improving the software implementation of the collapsing of tandem duplicates and for contributing to the parameterisation of the simulator. We would also like to thank Matthieu Muffato for useful python functions, Alexandra Louis and Pierre Vincens for their help with computer facilities, as well reviewers for insightful comments.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0180198.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Nadeau</surname><given-names>JH</given-names></name>, <name><surname>Taylor</surname><given-names>BA</given-names></name>. <article-title>Lengths of chromosomal segments conserved since divergence of man and mouse</article-title>. <source>Proc Natl Acad Sci</source>. <year>1984</year>;<volume>81</volume>: <fpage>814</fpage>–<lpage>818</lpage>. <?supplied-pmid 6583681?><pub-id pub-id-type="pmid">6583681</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Pevzner</surname><given-names>P</given-names></name>, <name><surname>Tesler</surname><given-names>G</given-names></name>. <article-title>Genome rearrangements in mammalian evolution: lessons from human and mouse genomes</article-title>. <source>Genome Res</source>. <year>2003</year>;<volume>13</volume>: <fpage>37</fpage>–<lpage>45</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.757503">10.1101/gr.757503</ext-link></comment><?supplied-pmid 12529304?><pub-id pub-id-type="pmid">12529304</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Lefebvre</surname><given-names>JF</given-names></name>, <name><surname>El-Mabrouk</surname><given-names>N</given-names></name>, <name><surname>Tillier</surname><given-names>E</given-names></name>, <name><surname>Sankoff</surname><given-names>D</given-names></name>. <article-title>Detection and validation of single gene inversions</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>: <fpage>190</fpage>–<lpage>196</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btg1025">10.1093/bioinformatics/btg1025</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Chaisson</surname><given-names>MJ</given-names></name>, <name><surname>Raphael</surname><given-names>BJ</given-names></name>, <name><surname>Pevzner</surname><given-names>P a</given-names></name>. <article-title>Microinversions in mammalian evolution</article-title>. <source>Proc Natl Acad Sci</source>. <year>2006</year>;<volume>103</volume>: <fpage>19824</fpage>–<lpage>19829</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0603984103">10.1073/pnas.0603984103</ext-link></comment><?supplied-pmid 17189424?><pub-id pub-id-type="pmid">17189424</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Lucas</surname><given-names>JM</given-names></name>, <name><surname>Muffato</surname><given-names>M</given-names></name>, <name><surname>Crollius</surname><given-names>HR</given-names></name>. <article-title>PhylDiag: identifying complex synteny blocks that include tandem duplications using phylogenetic gene trees</article-title>. <source>BMC Bioinformatics</source>. <year>2014</year>;<volume>15</volume>: <fpage>1</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-15-1">10.1186/1471-2105-15-1</ext-link></comment><pub-id pub-id-type="pmid">24383880</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Proost</surname><given-names>S</given-names></name>, <name><surname>Fostier</surname><given-names>J</given-names></name>, <name><surname>Witte</surname><given-names>D De</given-names></name>, <name><surname>Dhoedt</surname><given-names>B</given-names></name>, <name><surname>Demeester</surname><given-names>P</given-names></name>, <name><surname>Peer</surname><given-names>Y Van de</given-names></name>, <etal>et al</etal><article-title>i-ADHoRe 3.0—fast and sensitive detection of genomic homology in extremely large data sets</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>40</volume>: <fpage>e11</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkr955">10.1093/nar/gkr955</ext-link></comment><?supplied-pmid 22102584?><pub-id pub-id-type="pmid">22102584</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Dieterich</surname><given-names>C</given-names></name>, <name><surname>Ro</surname><given-names>C</given-names></name>, <name><surname>Rödelsperger</surname><given-names>C</given-names></name>, <name><surname>Dieterich</surname><given-names>C</given-names></name>. <article-title>CYNTENATOR: progressive gene order alignment of 17 vertebrate genomes</article-title>. <source>PLoS One</source>. <year>2010</year>;<volume>5</volume>: <fpage>e8861</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0008861">10.1371/journal.pone.0008861</ext-link></comment><?supplied-pmid 20126624?><pub-id pub-id-type="pmid">20126624</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Ghiurcuta</surname><given-names>CG</given-names></name>, <name><surname>Moret</surname><given-names>BME</given-names></name>. <article-title>Evaluating synteny for improved comparative studies</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>: <fpage>i9</fpage>–<lpage>i18</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btu259">10.1093/bioinformatics/btu259</ext-link></comment><?supplied-pmid 24932010?><pub-id pub-id-type="pmid">24932010</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref009">
      <label>9</label>
      <mixed-citation publication-type="other">Lucas JM. Etude de l’évolution de l’ordre des gènes de vertébrés par simulation [Internet]. 2016. Available: tel.archives-ouvertes.fr/tel-01398369/document</mixed-citation>
    </ref>
    <ref id="pone.0180198.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Pan</surname><given-names>D</given-names></name>, <name><surname>Zhang</surname><given-names>L</given-names></name>. <article-title>Tandemly arrayed genes in vertebrate genomes</article-title>. <source>Comp Funct Genomics</source>. <year>2008</year>;<volume>2008</volume>: <fpage>545269</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1155/2008/545269">10.1155/2008/545269</ext-link></comment><?supplied-pmid 18815629?><pub-id pub-id-type="pmid">18815629</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Cunningham</surname><given-names>F</given-names></name>, <name><surname>Amode</surname><given-names>MR</given-names></name>, <name><surname>Barrell</surname><given-names>D</given-names></name>, <name><surname>Beal</surname><given-names>K</given-names></name>, <name><surname>Billis</surname><given-names>K</given-names></name>, <name><surname>Brent</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Ensembl 2015</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year>;<volume>43</volume>: <fpage>662</fpage>–<lpage>669</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gku1010">10.1093/nar/gku1010</ext-link></comment><?supplied-pmid 25352552?><pub-id pub-id-type="pmid">25352552</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Vandepoele</surname><given-names>K</given-names></name>, <name><surname>Saeys</surname><given-names>Y</given-names></name>, <name><surname>Simillion</surname><given-names>C</given-names></name>, <name><surname>Raes</surname><given-names>J</given-names></name>, <name><surname>Van De Peer</surname><given-names>Y</given-names></name>. <article-title>The automatic detection of homologous regions (ADHoRe) and its application to microcolinearity between Arabidopsis and rice</article-title>. <source>Genome Res</source>. <year>2002</year>;<volume>12</volume>: <fpage>1792</fpage>–<lpage>1801</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.400202">10.1101/gr.400202</ext-link></comment><?supplied-pmid 12421767?><pub-id pub-id-type="pmid">12421767</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>H</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Bowers</surname><given-names>JE</given-names></name>, <name><surname>Ming</surname><given-names>R</given-names></name>, <name><surname>Alam</surname><given-names>M</given-names></name>, <name><surname>Paterson</surname><given-names>AH</given-names></name>. <article-title>Unraveling ancient hexaploidy through multiply-aligned angiosperm gene maps</article-title>. <source>Genome Res</source>. <year>2008</year>;<volume>18</volume>: <fpage>1944</fpage>–<lpage>1954</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.080978.108">10.1101/gr.080978.108</ext-link></comment><?supplied-pmid 18832442?><pub-id pub-id-type="pmid">18832442</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Peng</surname><given-names>Q</given-names></name>, <name><surname>Pevzner</surname><given-names>P a</given-names></name>, <name><surname>Tesler</surname><given-names>G</given-names></name>. <article-title>The fragile breakage versus random breakage models of chromosome evolution</article-title>. <source>PLoS Comput Biol</source>. <year>2006</year>;<volume>2</volume>: <fpage>e14</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.0020014">10.1371/journal.pcbi.0020014</ext-link></comment><?supplied-pmid 16501665?><pub-id pub-id-type="pmid">16501665</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Sankoff</surname><given-names>D</given-names></name>. <article-title>The signal in the genomes</article-title>. <source>PLoS Computational Biology</source>. <year>2006</year> pp. <fpage>320</fpage>–<lpage>321</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.0020035">10.1371/journal.pcbi.0020035</ext-link></comment>
<?supplied-pmid 16683016?><pub-id pub-id-type="pmid">16683016</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Lemaitre</surname><given-names>C</given-names></name>, <name><surname>Tannier</surname><given-names>E</given-names></name>, <name><surname>Gautier</surname><given-names>C</given-names></name>, <name><surname>Sagot</surname><given-names>M-F</given-names></name>. <article-title>Precise detection of rearrangement breakpoints in mammalian chromosomes</article-title>. <source>BMC Bioinformatics</source>. <year>2008</year>;<volume>9</volume>: <fpage>286</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-9-286">10.1186/1471-2105-9-286</ext-link></comment><?supplied-pmid 18564416?><pub-id pub-id-type="pmid">18564416</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Tesler</surname><given-names>G</given-names></name>. <article-title>GRIMM: genome rearrangements web server</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>: <fpage>492</fpage>–<lpage>493</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/18.3.492">10.1093/bioinformatics/18.3.492</ext-link></comment><?supplied-pmid 11934753?><pub-id pub-id-type="pmid">11934753</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>J</given-names></name>, <name><surname>Ratan</surname><given-names>A</given-names></name>, <name><surname>Raney</surname><given-names>BJ</given-names></name>, <name><surname>Suh</surname><given-names>BB</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <name><surname>Haussler</surname><given-names>D</given-names></name>. <article-title>The infinite sites model of genome evolution</article-title>. <source>Proc Natl Acad Sci</source>. <year>2008</year>;<volume>105</volume>: <fpage>14254</fpage>–<lpage>14261</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0805217105">10.1073/pnas.0805217105</ext-link></comment><?supplied-pmid 18787111?><pub-id pub-id-type="pmid">18787111</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Paten</surname><given-names>B</given-names></name>, <name><surname>Herrero</surname><given-names>J</given-names></name>, <name><surname>Beal</surname><given-names>K</given-names></name>, <name><surname>Fitzgerald</surname><given-names>S</given-names></name>, <name><surname>Birney</surname><given-names>E</given-names></name>. <article-title>Enredo and Pecan: Genome-wide mammalian consistency-based multiple alignment with paralogs</article-title>. <source>Genome Res</source>. <year>2008</year>;<volume>18</volume>: <fpage>1814</fpage>–<lpage>1828</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.076554.108">10.1101/gr.076554.108</ext-link></comment><?supplied-pmid 18849524?><pub-id pub-id-type="pmid">18849524</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Pham</surname><given-names>SK</given-names></name>, <name><surname>Pevzner</surname><given-names>PA</given-names></name>. <article-title>DRIMM-Synteny: decomposing genomes into evolutionary conserved segments</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>: <fpage>2509</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btq465">10.1093/bioinformatics/btq465</ext-link></comment><?supplied-pmid 20736338?><pub-id pub-id-type="pmid">20736338</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Bafna</surname><given-names>V</given-names></name>, <name><surname>Narayanan</surname><given-names>B</given-names></name>, <name><surname>Ravi</surname><given-names>R</given-names></name>. <article-title>Nonoverlapping local alignments (weighted independent sets of axis-parallel rectangles)</article-title>. <source>Discret Appl Math</source>. <year>1996</year>;<volume>71</volume>: <fpage>41</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0166-218X(96)00063-7">10.1016/S0166-218X(96)00063-7</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Pevzner</surname><given-names>P</given-names></name>, <name><surname>Tesler</surname><given-names>G</given-names></name>. <article-title>Human and mouse genomic sequences reveal extensive breakpoint reuse in mammalian evolution</article-title>. <source>Proc Natl Acad Sci</source>. <year>2003</year>;<volume>100</volume>: <fpage>7672</fpage>–<lpage>7677</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1330369100">10.1073/pnas.1330369100</ext-link></comment><?supplied-pmid 12810957?><pub-id pub-id-type="pmid">12810957</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Paten</surname><given-names>B</given-names></name>, <name><surname>Diekhans</surname><given-names>M</given-names></name>, <name><surname>Earl</surname><given-names>D</given-names></name>, <name><surname>John</surname><given-names>JS</given-names></name>, <name><surname>Ma</surname><given-names>J</given-names></name>, <name><surname>Suh</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>Cactus graphs for genome comparisons</article-title>. <source>J Comput Biol</source>. <year>2011</year>;<volume>18</volume>: <fpage>469</fpage>–<lpage>81</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1089/cmb.2010.0252">10.1089/cmb.2010.0252</ext-link></comment><?supplied-pmid 21385048?><pub-id pub-id-type="pmid">21385048</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0180198.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Kehr</surname><given-names>B</given-names></name>, <name><surname>Trappe</surname><given-names>K</given-names></name>, <name><surname>Holtgrewe</surname><given-names>M</given-names></name>, <name><surname>Reinert</surname><given-names>K</given-names></name>. <article-title>Genome alignment with graph data structures: a comparison</article-title>. <source>BMC Bioinformatics</source>. <year>2014</year>;</mixed-citation>
    </ref>
    <ref id="pone.0180198.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">Noutahi E, Semeria M, Lafond M, Seguin J, Boussau B, Guéguen L, et al. Efficient gene tree correction guided by species and synteny evolution. 2015.</mixed-citation>
    </ref>
  </ref-list>
</back>
