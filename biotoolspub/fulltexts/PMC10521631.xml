<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10521631</article-id>
    <article-id pub-id-type="pmid">37540201</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad486</article-id>
    <article-id pub-id-type="publisher-id">btad486</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Ionmob: a Python package for prediction of peptide collisional cross-section values</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1755-5382</contrib-id>
        <name>
          <surname>Teschner</surname>
          <given-names>David</given-names>
        </name>
        <aff><institution>Institute of Computer Science, Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
        <xref rid="btad486-cor1" ref-type="corresp"/>
        <!--dateschn@uni-mainz.de-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Gomez-Zepeda</surname>
          <given-names>David</given-names>
        </name>
        <aff><institution>Institute for Immunology, University Medical Center of the Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
        <aff><institution>Immunoproteomics Unit, Helmholtz-Institute for Translational Oncology (HI-TRON)</institution>, 55131 Mainz, <country country="DE">Germany</country></aff>
        <xref rid="btad486-cor1" ref-type="corresp"/>
        <!--dgomezze@uni-mainz.de-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9376-1399</contrib-id>
        <name>
          <surname>Declercq</surname>
          <given-names>Arthur</given-names>
        </name>
        <aff><institution>VIB-UGent Center for Medical Biotechnology, VIB</institution>, 9052 Gent, <country country="BE">Belgium</country></aff>
        <aff><institution>Department of Biomolecular Medicine, Ghent University</institution>, 9000 Ghent, <country country="BE">Belgium</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Łącki</surname>
          <given-names>Mateusz K</given-names>
        </name>
        <aff><institution>Institute for Immunology, University Medical Center of the Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Avci</surname>
          <given-names>Seymen</given-names>
        </name>
        <aff><institution>Institute of Computer Science, Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bob</surname>
          <given-names>Konstantin</given-names>
        </name>
        <aff><institution>Institute of Computer Science, Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Distler</surname>
          <given-names>Ute</given-names>
        </name>
        <aff><institution>Institute for Immunology, University Medical Center of the Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Michna</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>Institute for Immunology, University Medical Center of the Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
        <aff><institution>Immunoproteomics Unit, Helmholtz-Institute for Translational Oncology (HI-TRON)</institution>, 55131 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Martens</surname>
          <given-names>Lennart</given-names>
        </name>
        <aff><institution>VIB-UGent Center for Medical Biotechnology, VIB</institution>, 9052 Gent, <country country="BE">Belgium</country></aff>
        <aff><institution>Department of Biomolecular Medicine, Ghent University</institution>, 9000 Ghent, <country country="BE">Belgium</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tenzer</surname>
          <given-names>Stefan</given-names>
        </name>
        <aff><institution>Institute for Immunology, University Medical Center of the Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
        <aff><institution>Immunoproteomics Unit, Helmholtz-Institute for Translational Oncology (HI-TRON)</institution>, 55131 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hildebrandt</surname>
          <given-names>Andreas</given-names>
        </name>
        <aff><institution>Institute of Computer Science, Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad486-cor1">Corresponding authors: Institute of Computer Science, Johannes Gutenberg University, 55128 Mainz, Germany. E-mail: <email>dateschn@uni-mainz.de</email> (D.T.); Institute for Immunology, University Medical Center of the Johannes Gutenberg University, 55128 Mainz, Germany. E-mail: <email>dgomezze@uni-mainz.de</email> (D.G.-Z.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-04">
      <day>04</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>9</issue>
    <elocation-id>btad486</elocation-id>
    <history>
      <date date-type="received">
        <day>07</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>25</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad486.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Including ion mobility separation (IMS) into mass spectrometry proteomics experiments is useful to improve coverage and throughput. Many IMS devices enable linking experimentally derived mobility of an ion to its collisional cross-section (CCS), a highly reproducible physicochemical property dependent on the ion’s mass, charge and conformation in the gas phase. Thus, known peptide ion mobilities can be used to tailor acquisition methods or to refine database search results. The large space of potential peptide sequences, driven also by posttranslational modifications of amino acids, motivates an <italic toggle="yes">in silico</italic> predictor for peptide CCS. Recent studies explored the general performance of varying machine-learning techniques, however, the workflow engineering part was of secondary importance. For the sake of applicability, such a tool should be generic, data driven, and offer the possibility to be easily adapted to individual workflows for experimental design and data processing.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We created <monospace>ionmob</monospace>, a Python-based framework for data preparation, training, and prediction of collisional cross-section values of peptides. It is easily customizable and includes a set of pretrained, ready-to-use models and preprocessing routines for training and inference. Using a set of ≈21 000 unique phosphorylated peptides and ≈17 000 MHC ligand sequences and charge state pairs, we expand upon the space of peptides that can be integrated into CCS prediction. Lastly, we investigate the applicability of <italic toggle="yes">in silico</italic> predicted CCS to increase confidence in identified peptides by applying methods of re-scoring and demonstrate that predicted CCS values complement existing predictors for that task.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The Python package is available at github: <ext-link xlink:href="https://github.com/theGreatHerrLebert/ionmob" ext-link-type="uri">https://github.com/theGreatHerrLebert/ionmob</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Bundesministerium für Bildung und Forschung</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002347</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Research Foundation Flanders</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003130</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Ion mobility enhanced mass spectrometry coupled with liquid chromatography (LC-IMS-MS) improves throughput and coverage of proteomics experiments (<xref rid="btad486-B21" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2015</xref>). Traditionally, proteomics analyses have been performed by separation of peptides using reversed phase liquid chromatography (LC), interfaced by electrospray ionization to mass spectrometry (MS) to analyze the mass to charge ratio (<italic toggle="yes">m</italic>/<italic toggle="yes">z</italic>) of the analyte ions. Ion mobility separation (IMS) adds an additional dimension of separation. Its functionality is based on the fact that in the presence of an electric field, small, compact ions will behave differently when flying through a cloud of charge-neutral gas than larger ones (<xref rid="btad486-B35" ref-type="bibr">Valentine <italic toggle="yes">et al.</italic> 2005</xref>). This enables to distinguish molecules, such as isobaric ions with the same <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> but differing sequences or modifications, that can’t be separated by LC-MS (<xref rid="btad486-B24" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021b</xref>, <xref rid="btad486-B25" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic> 2021</xref>). Additionally, IMS allows for filtering or untargeted annotation (<xref rid="btad486-B11" ref-type="bibr">Dodds and Baker 2019</xref>).</p>
    <p>Depending on the hardware setup, the IMS can be used to calculate the collisional cross-section (CCS) value of the ions by applying kinetic theory that links experimentally determined reduced ion-mobilities to their momentum transfer collision integral through the Mason–Schamp equation (<xref rid="btad486-B30" ref-type="bibr">Revercomb and Mason 1975</xref>, <xref rid="btad486-B14" ref-type="bibr">Gabelica <italic toggle="yes">et al.</italic> 2019</xref>). The translation of the reduced mobility, <italic toggle="yes">K</italic>0, to CCS depends on several factors including ion mass and charge, as well as the mass and temperature of the drift gas. However, the application of this theory makes some simplifying assumptions including that the electric field applied is low enough to be negligible. As a result, the translation of experimentally determined drift times to CCS can only be performed for low field devices such as drift tube, travelling wave, or trapped ion mobility (DTIMS, TWIMS, and TIMS), but not for devices involving high fields such as field asymmetric ion mobility spectrometry (<xref rid="btad486-B11" ref-type="bibr">Dodds and Baker 2019</xref>). For an in-depth description of differences in the determination of <italic toggle="yes">K</italic>0 from experimental setups see e.g. <xref rid="btad486-B13" ref-type="bibr">Gabelica and Marklund (2018)</xref>, <xref rid="btad486-B11" ref-type="bibr">Dodds and Baker (2019)</xref>, and <xref rid="btad486-B14" ref-type="bibr">Gabelica <italic toggle="yes">et al.</italic> (2019)</xref>. As the ion CCS is an inherent physicochemical property, CCS calculations from IMS data are highly reproducible (<xref rid="btad486-B3" ref-type="bibr">Bush <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021a</xref>). Thus, LC-IMS-MS offers both increased capability of ion separation and identification crucial for the ultimate task of elucidating the chemical composition of samples.</p>
    <p>There are two principal reasons for establishing a CCS predictor. First, it offers potential insight into how specific features can influence the ion conformation in the gas phase (<xref rid="btad486-B25" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021a</xref>). These could be used to drive particular experimental setups tailored to certain types of peptides (<xref rid="btad486-B16" ref-type="bibr">Gomez‐Zepeda <italic toggle="yes">et al.</italic> 2023</xref>). Second, given their high reproducibility, CCS of ions hold valuable information ready to be integrated into candidate scoring. Thus, it can help to increase the confidence and overall number of identifications of peptides. Especially the second point is of particular importance, as in bottom-up proteomics one has to also perform the peptide to protein inference. Both factors can improve the coverage of peptides and thus of proteins identified.</p>
    <p>Recently, there has been steadily increasing interest in the prediction of peptide CCS values (<xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021a</xref>, <xref rid="btad486-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad486-B31" ref-type="bibr">Samukhina <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad486-B41" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> 2022</xref>). This task boils down to designing a function defined over some space of arguments resulting in a (real-valued) CCS prediction, which can be easily recognized as a regression task. In contrast to a simple database look-up, the key advantage of this approach comes from the possibility to obtain predictions for previously unobserved data. For example, a given sample might result in ions with sequences that were previously not observed. A prominent example is posttranslational modifications (PTMs) derived from biological conditions (e.g., phosphorylation) or experimental setups (e.g., carbamidomethylation). IMS can help to differentiate peptides with identical sequences but different PTM positions, which may have different biological results. Another relevant example is MHC ligands sensed by the immune system to trigger the defense against possible threats, such as cancerogenic cells or virus infections. Detecting MHC peptide ligands, also called immunopeptides, is essential for developing vaccines and immunotherapies. MHC ligands result from the cleavage of proteins mediated by diverse enzymes in the cell, exponentially expanding the search space and thus complicating their identification. In addition, immunopeptidomics samples are more likely to contain isobaric peptides than proteomics samples due to conserved patterns in their sequences. Since LC-MS alone cannot separate such peptides, IMS becomes essential to improve the identification of MHC ligands. Overall, the space of observable ions is huge, but there exists complex yet stable principles that govern the observed CCS values.</p>
    <p>To establish such a predictor, several modeling strategies are available. Historically, due to small number of available reference data-points, mostly low-parametric approaches were used. One of the first was based on intrinsic size parameters (ISPs; <xref rid="btad486-B17" ref-type="bibr">Henderson <italic toggle="yes">et al.</italic> 1999</xref>), where every amino acid is assigned some fixed value <italic toggle="yes">a priori</italic>. ISPs were derived from a set of 660 peptide sequences. A prediction of CCS for a specific sequence is then carried out by simply summing over all contributions. Applicability for enhanced peptide identification based on ISPs has also been discussed (<xref rid="btad486-B34" ref-type="bibr">Valentine <italic toggle="yes">et al.</italic> 2011</xref>). This idea was later extended to also account for e.g. PTMs by adding up contributions of individual atoms instead of amino acids (<xref rid="btad486-B18" ref-type="bibr">Kaszycki and Shvartsburg 2017</xref>). Other approaches included a multi-layer perceptron architecture and support vector machines (<xref rid="btad486-B39" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2009</xref>, <xref rid="btad486-B40" ref-type="bibr">2013</xref>) that relied on engineered features derived from 595 peptide sequences. While those models are quick to run and already do offer a lot of insight into the problem, they simply cannot fully account for the richness of the configuration space of ions.</p>
    <p>With the increased use of LC-IMS-MS methods into mainstream proteomics and the resulting increase in the availability of measured CCS values (<xref rid="btad486-B24" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021b</xref>), more complex data-driven approaches were proposed. Using positional encoded ISPs with a linear regression model was implemented by a very recent study by <xref rid="btad486-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> (2021)</xref>. This way, increased expressiveness of the predictor was achieved with features that could be extracted from a training dataset of 135 000 peptide sequences. A very different approach was taken by <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref>, where the authors trained a deep recurrent neural network end-to-end. This was possible due to the generation of a training set with <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula>550 000 examples. Their model achieves state-of-the art prediction accuracy on a test set of <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula>150 000 unique test sequences. <xref rid="btad486-B31" ref-type="bibr">Samukhina <italic toggle="yes">et al.</italic> (2021)</xref> also built upon this dataset using deep learning. They applied a mixed architecture of 1-D convolutions and handcrafted features for sequences in combination with model-averaging, which resulted in increased prediction accuracy. To give a complete picture of potential approaches, reasoning based on physics were also performed, where one used Monte Carlo molecular dynamics to simulate the CCS values (<xref rid="btad486-B9" ref-type="bibr">de Carvalho <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad486-B19" ref-type="bibr">Kondalaji <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad486-B36" ref-type="bibr">Villatoro <italic toggle="yes">et al.</italic> 2019</xref>). However, these simulations are prohibitively demanding in terms of computational time and therefore impractical to use in high-throughput scenarios.</p>
    <p>Overall, there are many similarities in the techniques used currently to model ion mobilities to those used for retention times (<xref rid="btad486-B20" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad486-B15" ref-type="bibr">Gessulat <italic toggle="yes">et al.</italic> 2019</xref>), i.e. the LC-derived measurements. Given the much higher stability of the ion mobility measurements, it is interesting to ask what these models can bring to the table.</p>
    <p>Apart from the proper choice of the architecture of the predictor, additional steps have to be typically performed to preprocess the data. From the practical standpoint, these steps take most of the actual work of the data-scientist. These steps include solving issues such as outlier detection, deduplication, feature generation and alignment of new data. We present here <monospace>ionmob—</monospace>a Python package for preprocessing datasets and fitting predictors of the CCS values of peptides identified by LC-IMS-MS using data acquired in timsTOF instruments. It offers routines necessary to solve all of the practicalities mentioned above and results in a prediction accuracy matching the state-of-the-art models. In addition, we included a selection of pretrained models and architecture primitives, which are easy to integrate into existing workflows. Importantly, <monospace>ionmob</monospace> integrates trypsin-cleaved peptides, phosphorylated tryptic peptides and also MHC ligands into deep learning driven CCS prediction, making our models more expressive. The package is well documented and available free of charge under the MIT license from github. Finally, we investigated how <italic toggle="yes">in silico</italic> prediction of CCS could be utilized to improve identification of peptides, allowing to integrate additional information from LC-IMS-MS proteomics experiments. <monospace>ionmob</monospace> will facilitate the training and incorporation of CCS-prediction in diverse workflows for LC-IMS-MS proteomics and peptidomics experiments.</p>
  </sec>
  <sec>
    <title>2 Approach</title>
    <sec>
      <title>2.1 General ionmob workflow</title>
      <p>An <monospace>ionmob</monospace> workflow can be composed of one or more building blocks, depending on the task at hand. An overview is given in <xref rid="btad486-F1" ref-type="fig">Fig. 1A</xref>.</p>
      <fig position="float" id="btad486-F1">
        <label>Figure 1.</label>
        <caption>
          <p>(A) General workflow of <monospace>ionmob</monospace>. (a) Data are generated from different samples, devices and laboratories. A sample of interest (<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) is analyzed through multiple replicates (<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) and combined into an identification table during raw data analysis (<inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>). (b) For a representative set of training values, peptide charge state pairs are pre-processed e.g. deduplicated. Raw data are then translated into sets of features for machine learning. This results in data ready for training. (c) Training then is an iterative process where the internal state of a predictor is changed so that its output better resembles the desired output based on some objective measure. This results in a trained model that can be used for prediction. (d) Before trained model outputs can be compared with data derived from a new source, a dataset specific shift needs to be calculated. After that, predictions of a model are ready, e.g. for rescoring. (B) Proposed model architecture. (a) Simple initial projection fitting a square-root function and a bias with mass and charge of a peptide as inputs. (b) Recurrent neural network using GRUs to predict higher-order interactions that contribute to observed CCS based on peptide sequences. Deeper dense layers are also provided with the charge state of the ion as additional input. AAs stands for amino acids. (c) Final CCS values are then calculated as sum of initial projection and deep residues</p>
        </caption>
        <graphic xlink:href="btad486f1" position="float"/>
      </fig>
      <p>The regular occurring tasks roughly fall into three categories: data preprocessing, model training, and CCS inference. We provide explicit functionality for:</p>
      <list list-type="bullet">
        <list-item>
          <p>detection of peptides with multiple conformations,</p>
        </list-item>
        <list-item>
          <p>deduplication of data points followed by an aggregation strategy,</p>
        </list-item>
        <list-item>
          <p>feature generation, e.g. tokenization, based on data from multiple software sources,</p>
        </list-item>
        <list-item>
          <p>alignment of new datasets for optimal prediction performance, and</p>
        </list-item>
        <list-item>
          <p>pre-trained models for CCS inference out-of-the-box.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>2.2 Modeling strategy and predictor architecture</title>
      <p>Previous models used machine-learning algorithms to predict CCS directly from peptide sequence and charge. However, the CCS of an ion is highly correlated with its mass and charge (<xref rid="btad486-B24" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021b</xref>) (see <xref rid="btad486-F2" ref-type="fig">Fig. 2</xref>). This fact can be exploited to reformulate the prediction task to only predict the residues with respect to an initial projection of mass and charge.</p>
      <fig position="float" id="btad486-F2">
        <label>Figure 2.</label>
        <caption>
          <p><italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> versus CCS for observed (blue) and predicted (orange) CCS values of MHC peptides, model performance. (A) Ground truth versus predicted CCS after initial projection with a simple square-root function, see <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> and <xref rid="btad486-F1" ref-type="fig">Fig. 1B</xref>a. (B) Final CCS prediction as sum of initial projection and deep residues, see <xref rid="E2" ref-type="disp-formula">Equation (2)</xref> and <xref rid="btad486-F1" ref-type="fig">Fig. 1B</xref>c. (C) Boxplots showing charge state wise relative errors comparing both prediction accuracies. (D) Total relative error distributions for both models after training</p>
        </caption>
        <graphic xlink:href="btad486f2" position="float"/>
      </fig>
      <p>The reformulation yields multiple advantages: first, it reduces the convergence time of training considerably since the starting initial CCS is already much closer to the real value. Second, fitting a regression model with gradient-based optimization was numerically unstable for models with few parameters. This could be because the output domain of a model needs to span a wide range of values and higher charge states are underrepresented compared with lower ones. Third, having this simple component of the predictor separated from more complex ones makes it convenient to look at the contributions of higher-order interactions of features. Fourth, it also establishes a baseline accuracy (see <xref rid="btad486-F2" ref-type="fig">Fig. 2</xref>).</p>
      <p>We therefore decided to rephrase our approach. First, an initial CCS value is calculated solely based on an ions mass and charge, see <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>, where a coefficient <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and an intercept <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are fit separately for each modeled charge state <italic toggle="yes">c a priori</italic>.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>init</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>mz</mml:mtext><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:msqrt><mml:mrow><mml:mtext>mz</mml:mtext></mml:mrow></mml:msqrt><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>Afterward, a regressor <italic toggle="yes">M</italic> with parameter set <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mo>θ</mml:mo></mml:math></inline-formula> is fit to further lower the mean absolute error (MAE) of predicted CCS values compared with the experimentally observed ones, see <xref rid="E2" ref-type="disp-formula">Equation (2)</xref>.
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>final</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>mz</mml:mtext><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>init</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>mz</mml:mtext><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Input features may vary for different implementations of <italic toggle="yes">M</italic> but are all based on information derived from peptide sequence <italic toggle="yes">s</italic> and charge state <italic toggle="yes">c</italic>. A concrete implementation is shown schematically in <xref rid="btad486-F1" ref-type="fig">Fig. 1B</xref>, representing our proposed predictor architecture. It has ≈550 000 trainable weights.</p>
      <p>Here, the residues with respect to the initial square-root fit are modeled by a deep recurrent neural network, using token embeddings for amino acids and bidirectional gated recurrent units (GRUs; <xref rid="btad486-B6" ref-type="bibr">Chung <italic toggle="yes">et al.</italic> 2014</xref>) to provide a sequence specific contribution (see <xref rid="btad486-F2" ref-type="fig">Fig. 2</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Materials and methods</title>
    <sec>
      <title>3.1 Sample preparation and LC-IMS-MS data acquisition</title>
      <p>The detailed methodology for sample preparation and LC-IMS-MS analysis is included in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> and Methods. LC-IMS-MS was performed in nanoAcquity (Waters) or nanoElute (Bruker) chromatography systems connected to either timsTOF Pro-2 or timsTOF SCP (<xref rid="btad486-B2" ref-type="bibr">Brunner <italic toggle="yes">et al.</italic> 2022</xref>) (Bruker) MS, using DDA-PASEF (<xref rid="btad486-B22" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2018</xref>) for MS acquisition.</p>
    </sec>
    <sec>
      <title>3.2 Hardware, raw data analysis, and regression modeling</title>
      <p>MaxQuant version 2.0.3.0 (<xref rid="btad486-B8" ref-type="bibr">Cox and Mann 2008</xref>, <xref rid="btad486-B32" ref-type="bibr">Sinitcyn <italic toggle="yes">et al.</italic> 2021</xref>) and PEAKS XPro version 10.6 (BSI, Canada) were used to process generated .d raw files. Results used for training were filtered at 1% FDR at the peptide-spectrum match (PSM) and peptide level. For phosphopeptides, only identifications with a PTM AScore &gt; 20 were used (99% confidence). Data preprocessing, model training and package development were performed on a workstation running Ubuntu 20.04 with 32 GB of RAM, an AMD Ryzen 7 3700X 8-Core Processor and a NVIDIA RTX 2070 SUPER GPU with CUDA version 11.2 and cuDNN 8.1.1. Peptide identification was performed with the andromeda search engine and reference X-FASTA sequences. All regression models were implemented with <monospace>scikit-learn</monospace> (<xref rid="btad486-B27" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>) version 1.1.0, <monospace>scipy</monospace> (<xref rid="btad486-B37" ref-type="bibr">Virtanen <italic toggle="yes">et al.</italic> 2020</xref>), version 1.8.0 or <monospace>TensorFlow</monospace> (<xref rid="btad486-B1" ref-type="bibr">Abadi <italic toggle="yes">et al.</italic> 2016</xref>), and version 2.9.0 using Python 3.9.</p>
    </sec>
    <sec>
      <title>3.3 Data aggregation</title>
      <p>The peptide identification text files created by MaxQuant and PEAKS were used to generate our in-house datasets. Feature duplicates consisting of (sequence, charge, and CCS) instances were aggregated and their occurrences tracked. In order to distinguish between differently folded populations of peptides with the same charge state and sequence but notably different CCS values, modality classes were assigned. Features with identical charge and sequence that diverge the boundary of 2-times the standard deviation to the main feature are considered to be secondary features. Thereby, a distinction between unimodal and bimodal distributions of CCS values for a feature is established. Within the bimodal fraction of features, a main feature is determined based on the peptide mode with highest occurrence. Features that displayed CCS values within the boundary of 2-times the standard deviation to the main feature are considered as part of the main feature and therefore aggregated/fused. The difference in CCS values for the latter features are attributed to measurement inaccuracies. The resulting CCS value is the occurrence-weighted average of all (sequence, charge)-duplicates within the same modality class. In case of multi-modality of a feature, only the main feature was kept.</p>
    </sec>
    <sec>
      <title>3.4 External datasets</title>
      <p>We downloaded the peptide identification tables from the following publicly available datasets acquired in timsTOF instruments.</p>
      <list list-type="order">
        <list-item>
          <p>The tryptic peptide training and test sets published by <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref> (data preparation described therein) available at github from their repository (<ext-link xlink:href="https://github.com/theislab/DeepCollisionalCrossSection" ext-link-type="uri">https://github.com/theislab/DeepCollisionalCrossSection</ext-link>, accessed 10.07.22). The combined dataset contained 718 917 unique pairs of charge state and sequence.</p>
        </list-item>
        <list-item>
          <p>The tryptic peptide results published by <xref rid="btad486-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> (2021)</xref> that were made accessible through jPOST, dataset id JPST 000959, JPST 001017, and JPST 001176. The dataset was deduplicated by the same strategy described for our own dataset, see previous section. Sequence charge state pairs that were already present in one of the other datasets were removed, which left a total of 5064 examples.</p>
        </list-item>
        <list-item>
          <p>The results published by <xref rid="btad486-B12" ref-type="bibr">Feola <italic toggle="yes">et al.</italic> (2022)</xref> (MHC ligands) and <xref rid="btad486-B25" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic> (2021)</xref> (phosphopeptides) that were made accessible through PRIDE, dataset id PXD 026463 and jPOST, dataset id PXD 019746. The datasets were deduplicated by the same strategy described for our own dataset, see previous section. Sequence charge state pairs that were already present in one of the other datasets were removed, which left a total of 7366 examples and 7742 examples, respectively.</p>
        </list-item>
      </list>
      <p>We extracted 42 sequence, charge state pairs acquired using <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> as drift gas and measured twice, once with TWIMS and once with DTIMS from <xref rid="btad486-B3" ref-type="bibr">Bush <italic toggle="yes">et al.</italic> (2012)</xref> for evaluation of CCS prediction performance on non-timsTOF data.</p>
    </sec>
    <sec>
      <title>3.5 Alignment of collisional cross-section values</title>
      <p>A dataset specific, linear shift in CCS was calculated by matching sequence and charge state pairs identified in both the dataset obtained from Meier <italic toggle="yes">et al.</italic> and each of the other datasets (in-house and external). Using this dataset as reference is practical, as it holds by far the most sequences. This aligns the means of all observed CCS values in different datasets and is necessary to avoid systematic error.</p>
    </sec>
    <sec>
      <title>3.6 Training, validation, and test set generation</title>
      <p>A concatenation of training and test sets published by <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref> together with our in-house generated phosphorylation and MHC ligand datasets were used as training set, the in-house generated tryptic dataset was used as validation set. The three remaining external datasets were later used as test sets.</p>
    </sec>
    <sec>
      <title>3.7 Model training</title>
      <p>Initial square-root fit was performed separately for each charge state using SciPy, see <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>. Resulting parameter values were then used to parameterize a custom tensorflow layer with nontrainable weights. Model optimization was performed with gradient descent using MAE as objective function. The Adam optimizer was used with an initial learning rate of <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Dropout regularization with a dropout rate of 0.2 was applied between the last two deep dense layers. After each epoch, MAE was calculated on the validation set. If there was no decreased MAE for at least three epochs, the learning rate was lowered by an order of magnitude. If there was still no improvement on the validation set for another three epochs, training was stopped.</p>
    </sec>
    <sec>
      <title>3.8 External collisional cross-section predictors</title>
      <p>We downloaded the CCS predictor tools described by <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref>, <xref rid="btad486-B41" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> (2022)</xref>, and <xref rid="btad486-B31" ref-type="bibr">Samukhina <italic toggle="yes">et al.</italic> (2021)</xref>. We ran those models on our three test datasets according to the provided instructions. In the latter case, we therefore calculated the resulting CCS value for a given sequence and charge state pair as the average of all five created predictions.</p>
    </sec>
    <sec>
      <title>3.9 Calculation of additive scalar amino-acid properties</title>
      <p>The <monospace>pepdata</monospace> Python package (v1.0.7; <ext-link xlink:href="https://github.com/openvax/pepdata" ext-link-type="uri">https://github.com/openvax/pepdata</ext-link>) was used to calculate scalar features for peptide sequences. The package provides scalar descriptors of different amino-acid properties like hydropathy or polarity as mappings from a given amino acid to the respective value. For the scalar descriptors volume, polarity, hydropathy, hydrophilicity, solvent-exposed area, accessible surface area, accessible surface area folded, local flexibility, and pK side-chain, we calculated their normalized value by summing over the individual contributions of amino acids per sequence and divided by the sequence length.</p>
    </sec>
    <sec>
      <title>3.10 Rescoring with collisional cross-section features</title>
      <p>We tested the impact of using CCS predictions by adding CCS features as feature set to the current implementation of MS²Rescore (v2.1.2; <xref rid="btad486-B10" ref-type="bibr">Declercq <italic toggle="yes">et al.</italic> 2022</xref>) in addition to the existing peak intensity and retention time prediction features. For this, the mzid PEAKS search engine output files from the tryptic, phosphorylated and MHC ligand peptide data were used as is. Furthermore the MHC peptide dataset was acquired using a method optimized to include singly charged peptides (<xref rid="btad486-B16" ref-type="bibr">Gomez‐Zepeda <italic toggle="yes">et al.</italic> 2023</xref>). All three were parsed with the PEAKS pipeline of MS²Rescore; however, the pin files were modified with additional CCS features before running percolator. These features include the observed and predicted CCS value, the error, the absolute error and the percentual CCS error between observed value and predicted value. Peptides that carried &gt;4 charges were left out since the CCS predictor was not trained for these charges. Subsequently, these modified pin files were rescored with percolator (<xref rid="btad486-B33" ref-type="bibr">The <italic toggle="yes">et al.</italic> 2016</xref>) (v3.05.0) as well as a pin files without these features to be able to compare the effects of CCS features when rescoring. The additional rescoring analyses were done in jupyter notebooks and plots were generated using matplotlib(v5.3.2) and seaborn(v0.11.2).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <sec>
      <title>4.1 Model accuracy and comparison</title>
      <p>To evaluate the performance of our model based on bidirectional gated recurrent units (gru), we compared it with three previously published deep predictors: <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref> (lstm) using long-short term memory cells, <xref rid="btad486-B31" ref-type="bibr">Samukhina <italic toggle="yes">et al.</italic> (2021)</xref> (conv) using a mix of handcrafted features, convolutions, and model averaging, <xref rid="btad486-B41" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> (2022)</xref> (apd) using transformer-style attention. The results are shown in <xref rid="btad486-F3" ref-type="fig">Fig. 3</xref>. Median absolute percent error (MAPE) was used as comparison metric, since the spread of CCS values for a given charge state increases with the mass of the ion (see <xref rid="btad486-F2" ref-type="fig">Fig. 2</xref>).</p>
      <fig position="float" id="btad486-F3">
        <label>Figure 3.</label>
        <caption>
          <p>A performance comparison between <monospace>ionmob</monospace> GRU predictor and freely available deep predictors. (A–C) Performance per charge state for different test datasets. The gru model has a slight performance boost over the others for the <xref rid="btad486-B12" ref-type="bibr">Feola <italic toggle="yes">et al.</italic> (2022)</xref> dataset, likely since in contrast to the others it was explicitly trained on MHC peptides. Surprisingly, for charge state 4, prediction error for the <xref rid="btad486-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> (2021)</xref> dataset is relatively high for all models. (D) Boxplots of relative error distributions for all models. Overall performance of conv <xref rid="btad486-B31" ref-type="bibr">Samukhina <italic toggle="yes">et al.</italic> (2021)</xref>, lstm <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref>, and gru model are relatively on par with each other, while the apd <xref rid="btad486-B41" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> (2022)</xref> model seems to perform a little worse. The ensemble prediction is calculated as the average predicted CCS value over all four models</p>
        </caption>
        <graphic xlink:href="btad486f3" position="float"/>
      </fig>
      <p>Other studies predicting CCS made use of the Pearson correlation coefficient as an additional metric. However, we observed that the square-root baseline already had a correlation value of <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.97</mml:mn></mml:mrow></mml:math></inline-formula> and therefore think that it adds no significant insight into model performance. Interestingly, it can be observed that both the long-short term memory (lstm) and convolutional model (conv) show performances comparable to our predictor (gru) on the dataset from <xref rid="btad486-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> (2021)</xref> and our in-house tryptic dataset. However, they show a lower performance on the dataset from <xref rid="btad486-B12" ref-type="bibr">Feola <italic toggle="yes">et al.</italic> (2022)</xref>. This could stem from the fact that the latter dataset contains MHC ligands, a type of peptide not present in the dataset those models were trained on but part of our in-house generated dataset. The CCS and IMS patterns of MHC ligands may be different since their C-ter amino acid is not necessarily Arg or Lys, as it is usually the case for tryptic peptides analyzed in proteomics experiments (<xref rid="btad486-B29" ref-type="bibr">Purcell <italic toggle="yes">et al.</italic> 2019</xref>). It hints that even if the authors of <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref> could not observe significant improvements in prediction accuracy for their model beyond a training set size of ≈300 000 examples, the richness of naturally occurring peptides and experimental conditions might not be fully explored yet. Achieved accuracy on phosphorylated peptides could only be evaluated for our predictor and the model from <xref rid="btad486-B41" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> (2022)</xref> and is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>.</p>
    </sec>
    <sec>
      <title>4.2 Prediction of collisional cross-section for singly charged peptide ions</title>
      <p>In most proteomics workflows, the MS is configured to skip the fragmentation of singly charged ions or they are simply not considered for peptide identification during data processing (<xref rid="btad486-B28" ref-type="bibr">Prianichnikov <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad486-B16" ref-type="bibr">Gomez‐Zepeda <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btad486-B29" ref-type="bibr">Purcell <italic toggle="yes">et al.</italic> 2019</xref>). This is because, first, singly charged peptides are more difficult to identify since only one of the two fragments is charged and can be detected after collision-induced dissociation. Second, most contaminants are singly charged as well and can be ignored thereby (<xref rid="btad486-B10" ref-type="bibr">Declercq <italic toggle="yes">et al.</italic> 2022</xref>). This also means that the range of inverse ion-mobility, where experimental measurements can be reliably transferred from reduced mobilities to CCS, will rarely cover those ions, since the instrument resolution is finite and tuned to the regions of highest interest (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). This changes for MHC ligand peptides, as those can be singly charged due to their nontryptic origin, hence missing the C-terminal arginine or lysine as well as being relatively short (<xref rid="btad486-B10" ref-type="bibr">Declercq <italic toggle="yes">et al.</italic> 2022</xref>). We acquired an additional dataset of MHC peptides using Thunder-DDA-PASEF, which is explicitly set-up to cover those ions (<xref rid="btad486-B16" ref-type="bibr">Gomez‐Zepeda <italic toggle="yes">et al.</italic> 2023</xref>).</p>
    </sec>
    <sec>
      <title>4.3 Comparing predicted collisional cross-section to experimentally acquired values from different ion mobility separation devices</title>
      <p>As mentioned above, CCS values are never directly measured but derived from experimentally determined ion-mobilities by e.g. the Mason–Schamp equation or using a calibration curve (<xref rid="btad486-B11" ref-type="bibr">Dodds and Baker 2019</xref>). However, it is still a matter of ongoing debate under which experimental conditions this holds true (<xref rid="btad486-B13" ref-type="bibr">Gabelica and Marklund 2018</xref>). To gain insight whether or not our predictor might be applicable for IMS acquisitions that do not use TIMS separation, we compared predicted CCS values with results published by <xref rid="btad486-B3" ref-type="bibr">Bush <italic toggle="yes">et al.</italic> (2012)</xref>. Here, a custom Synapt MS (Waters Corp.) with both a traveling-wave IMS (TWIMS) and a drift tube IMS (DTIMS) devices was used to derive CCS values for a total of 42 peptide sequence, charge state pairs that had 27, 11, and 4 sequences of charge state 2, 3, and 4, respectively. Results are graphically shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>. The prediction accuracy was highest in the TWIMS analyses for ions with charge two and three (MAPE of 0.81 and 1.78, respectively) and for doubly charged ions in the DTIMS analyses (1.06). The error increased for ions with charge four in TWIMS (1.85) and ions with charge three or four in DTIMS (2.48 and 3.3, respectively). While these results offer preliminary insights, it is important to note that they were based on a very small sample. Therefore, gathering more data for evaluation would be necessary to confirm these findings. However, at the time of publication, we did not find available published data including the CCS for a larger number of peptides from any of these devices. In summary, although larger datasets are required to validate these results, ionmob has the potential to be applied to predict IMS in other instruments.</p>
    </sec>
    <sec>
      <title>4.4 Driving factors of collisional cross-section prediction</title>
      <sec>
        <title>4.4.1 Embeddings of amino acids</title>
        <p>The learned residues of peptide CCS values with respect to the initial fit use an embedding (here, 128 dimensional) to represent amino acids as dense vectors before being fed to the GRU units. This gives the opportunity to inspect how unmodified and modified amino acids are grouped relatively to each other in the embedding vector space by the network. To explore it, we evaluated the agglomerative clustering of amino acid features as shown in <xref rid="btad486-F4" ref-type="fig">Fig. 4</xref>. Outgroups are formed by the phosphorylated amino acids Y, S, and T, acetylated N-termini and lastly the three positively charged amino acids H, K, R, and cysteinylated C. The inner clusters roughly fall into aliphatic or aromatic as well as hydrophilic or hydrophobic groups. Even though the network was not presented with any chemical or physical descriptors of the individual amino acids, information about them is learned from the relationship between sequences, charges, and the resulting CCS values.</p>
        <fig position="float" id="btad486-F4">
          <label>Figure 4.</label>
          <caption>
            <p>Agglomerative clustering of amino acid and modification embedding vectors. Outgroups are formed by phosphorylated, acetylated and positively charged amino acids. Inner groups are roughly divided between aliphatic and aromatic as well as hydrophilic and hydrophobic amino acids</p>
          </caption>
          <graphic xlink:href="btad486f4" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>4.4.2 Correlation of deep residues with additive scalar descriptors of peptide sequences</title>
        <p>Besides evaluating the individual relationships between amino acids in the embedding space, we also explored the linear relationships between sequence-wise predicted deep residues and additive scalar properties that can be directly calculated from amino acid sequences. A recent study, <xref rid="btad486-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> (2021)</xref> identified that increased hydropathy contributed to a higher CCS values, which we could observe as well. Additionally, we observed that local flexibility increases the overall relative CCS value of a given sequence as well. Those correlations are only moderate (0.55 and 0.53, respectively) but are in congruence with the relative grouping of individual amino acids in the embedding space of the predictor (see <xref rid="btad486-F4" ref-type="fig">Fig. 4</xref>). All calculated Pearson correlations are visualized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>.</p>
      </sec>
      <sec>
        <title>4.4.3 Impact of phosphorylation on collisional cross-section predictions</title>
        <p>In a recent study, <xref rid="btad486-B25" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic> (2021)</xref> confirmed on a large scale that phosphorylation of peptides often leads to a more compact configuration of the ion in the gas phase, thereby lowering observed CCS values for modified peptide sequences compared with the unmodified version of these sequences. This effect outweighs the increase in peptide mass induced by such a modification (<xref rid="btad486-B25" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic> 2021</xref>). Our analyses reproduced this finding for our in-house generated datasets and, consequently, this effect can also be observed when looking at synthetic predictions. We evaluated this by analyzing predicted CCS values for synthetically phosphorylated sequences with one phosphorylation site added at random compared with the unmodified sequence. We calculated the pairwise median relative percent decrease in predicted CCS of synthetically modified peptides compared with unmodified peptides per charge, which were 2.08, 2.85, and 3.86 for the charge states 2, 3, and 4, respectively (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). The integration of <italic toggle="yes">in-silico</italic> predicted CCS for phosphorylated peptides into identification workflows might therefore be an excellent opportunity to be specifically integrated, which is already under commercial development (<ext-link xlink:href="http://www.bruker.com/ru/news-and-events/news/2022/bruker-releases-ccs-enabled-timscore.html" ext-link-type="uri">www.bruker.com/ru/news-and-events/news/2022/bruker-releases-ccs-enabled-timscore.html</ext-link>, accessed: 12.07.2022).</p>
        <p>In summary, the GRU model implemented in ionmob not only enables the prediction of peptide CCS values from tryptic, nontryptic and modified peptides but also allows the evaluation of feature-specific contributions at the amino acid, sequence, and PTM levels.</p>
      </sec>
    </sec>
    <sec>
      <title>4.5 Raw-data mobility distributions</title>
      <p>To establish prediction tools, one highly relevant question is whether or not the ion-mobility signal distribution should be taken into account when predicting CCS values. So far, all approaches including our own were implemented as maximum likelihood estimators. The simplification allows for a more straightforward formulation of the mobility modeling task. However, following this approach might be disadvantageous if the underlying assumption that signal distribution displays a single maximum does not hold. Notably, we and others observed that single peptide sequences can sometimes have multiple conformations in the gas-phase (<xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021a</xref>). This in turn then results in a multi-modal distribution of ion mobility and an observable split of the ion clouds for charge state 3 and 4 (see <xref rid="btad486-F5" ref-type="fig">Fig. 5</xref>).</p>
      <fig position="float" id="btad486-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Marginal distributions of intensity along the ion-mobility dimension of peptide features, recorded with a timsTOF instrument. Left: Intensity distribution along the scan dimension (blue) for a uni-modal peptide feature, reported CCS is calculated from apex value (black). Right: intensity distribution for a multi-modal peptide. MaxQuant reported this peptide twice at the same retention time with differing scan indices (orange, red). Raw data extracted using <monospace>opentims</monospace><xref rid="btad486-B7" ref-type="bibr">Łącki <italic toggle="yes">et al.</italic> (2021)</xref>. <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> was converted to CCS using the Mason–Schamp equation</p>
        </caption>
        <graphic xlink:href="btad486f5" position="float"/>
      </fig>
      <p>Similar to the approach described by <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref>, we dealt with multi-modality of peptide collisional cross sections by first identifying and then removing all occurrences except the one with highest abundance. For a maximum likelihood estimation strategy, which will otherwise converge to their mean value, this is a necessary step. This strategy can be justified by the overall low number of multi-modal peptides, here ≈3%–5%. However, it obviously removes potentially valuable information and one should therefore try to derive driving factors of multi-modality. If identified, they could in turn be used to decide for a given prediction instance <italic toggle="yes">a priori</italic> if it might be necessary to predict more than one CCS value. Due to the relatively low number of candidates and potential stochastic processes driving multi-modality, we consider this to be an open challenge for future investigations (<xref rid="btad486-T1" ref-type="table">Table 1</xref>).</p>
      <table-wrap position="float" id="btad486-T1">
        <label>Table 1.</label>
        <caption>
          <p>Number of PSMs and unique identified peptides in terms of sequence for 1% for rescoring with or without CCS features.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th rowspan="1" colspan="1">PSMs</th>
              <th rowspan="1" colspan="1">unique peptides</th>
              <th rowspan="1" colspan="1">CCS features</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="2" colspan="1">Tryptic</td>
              <td rowspan="1" colspan="1">60 850</td>
              <td rowspan="1" colspan="1">2901</td>
              <td rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">60 850</td>
              <td rowspan="1" colspan="1">2882</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">Phospho</td>
              <td rowspan="1" colspan="1">224 109</td>
              <td rowspan="1" colspan="1">29 046</td>
              <td rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">223 595</td>
              <td rowspan="1" colspan="1">28 928</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">MHC ligands</td>
              <td rowspan="1" colspan="1">392 092</td>
              <td rowspan="1" colspan="1">20 232</td>
              <td rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">389 113</td>
              <td rowspan="1" colspan="1">20 130</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>4.6 Impact of collisional cross-section features in peptide-spectrum match rescoring</title>
      <p>Using CCS predictions as an additional feature set in rescoring of database search results can provide increased performance to further separate true from false targets and gain confidence in the identified PSMs. To evaluate the value of CCS prediction for identification rescoring, we incorporated the ionmob models to the features used by MS<sup>2</sup>Rescore (<xref rid="btad486-B10" ref-type="bibr">Declercq <italic toggle="yes">et al.</italic> 2022</xref>) for the evaluation of true positive identifications. Rescoring including CCS features shows similar results for all three datasets, tryptic, phosphorylated, and MHC ligands (including singly charged), with a small increase in total number of identified PSMs and peptides, with the biggest increases seen for the MHC ligand dataset (<xref rid="btad486-T1" ref-type="table">Table 1</xref>). When investigating this dataset more closely, we found that 38.4% of the PSMs identified with CCS features that were not identified without these features are singly charged. Furthermore, all of these had a very low percentual CCS error, in contrast to singly charged PSMs that previously were identified and now not anymore due to the CCS features, where a lot of outliers are seen (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Moreover, this trend was also seen in the other datasets where peptidoforms that were removed in comparison with rescoring without CCS features had higher errors. Even though the total number of identifications does not increase spectacularly, the feature weights show that they are indeed used by percolator when rescoring PSMs (<xref rid="btad486-B5" ref-type="bibr">Chang and Lin 2008</xref>). It demonstrates the value of using these features when rescoring PSMs, especially for the immunopeptidomics dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). CCS features offer valuable information alongside peak intensity and retention time features allowing the rescore algorithm to select the best features for separating true from false targets for each database specifically. This filtering capability can be highly valuable for immunopeptidomics, where a high certainty level of identification is required to select the best targets for vaccines and immunotherapies.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>We implemented ionmob, a framework for preprocessing, training and inferring peptide CCS values. ionmob includes a novel network architecture that combines a simple function fit with gated recurrent units, helping to stabilize and speed up training and make model outputs easier to interpret. By including phosphorylated peptides and MHC ligands also covering singly charged ions into the training set, we extend the applicability of our model, enabling the accurate prediction of a wider variety of PTMs than recently published models. Furthermore, our results suggest that local flexibility of peptides is an additional driving factor of increased CCS and confirm recently published findings that phosphorylation lowers CCS, which could be indicative of charge interaction-based compaction in the gas phase. Lastly, we demonstrate that <italic toggle="yes">in silico</italic> predicted CCS values can be used to increase confidence in peptide identifications by applying methods of rescoring. In summary, <monospace>ionmob</monospace> is an easily deployable package for the training and incorporation of peptide CCS prediction.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad486_Supplementary_Data</label>
      <media xlink:href="btad486_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors would like to thank Robbin Bouwmeester and Ralf Gabriels for fruitful discussions regarding applications of predicted CCS values to peptide re-scoring. The authors acknowledge Christina Jung, Claudia Darmstadt, and Lucas Kleinort for their technical assistance on sample and instrument preparation for LC-IMS-MS analyses.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Bundesministerium für Bildung und Forschung (BMBF) as part of the National Research Node “Mass spectrometry in Systems Medicine” (MSCoreSys) [031L0217A/B to A.H., S.T., D.T., and D.G.-Z.]; the Research Foundation Flanders (FWO) [1SE3722 to A.D., G028821N to L.M.]; the European Union’s Horizon 2020 Programme (H2020-INFRAIA-2018-1) [823839 to L.M.]; Ghent University Concerted Research Action [BOF21/GOA/033 to L.M.].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All generated training, validation, and test datasets as well as all notebooks created during the experiments presented in this study have been deposited and made publicly available via Zenodo: <ext-link xlink:href="https://zenodo.org/record/7516255" ext-link-type="uri">https://zenodo.org/record/7516255</ext-link>. The mass spectrometry immunopeptidomics data have been deposited to the ProteomeXchange Consortium (<xref rid="btad486-B38" ref-type="bibr">Vizcaíno <italic toggle="yes">et al.</italic> 2014</xref>) via the jPOSTrepo partner repository (<xref rid="btad486-B26" ref-type="bibr">Okuda <italic toggle="yes">et al.</italic> 2017</xref>) with the dataset identifiers PXD043026 for ProteomeXchange and JPST002158 for jPOSTrepo.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad486-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Abadi</surname><given-names>M</given-names></string-name>, <string-name><surname>Agarwal</surname><given-names>A</given-names></string-name>, <string-name><surname>Barham</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal> Tensorflow: large-scale machine learning on heterogeneous distributed systems. <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="btad486-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brunner</surname><given-names>A</given-names></string-name>, <string-name><surname>Thielert</surname><given-names>M</given-names></string-name>, <string-name><surname>Vasilopoulou</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Ultra‐high sensitivity mass spectrometry quantifies single‐cell proteome changes upon perturbation</article-title>. <source>Mol Syst Biol</source><year>2022</year>;<volume>18</volume>:<fpage>e10798</fpage>.<pub-id pub-id-type="pmid">35226415</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bush</surname><given-names>MF</given-names></string-name>, <string-name><surname>Campuzano</surname><given-names>IDG</given-names></string-name>, <string-name><surname>Robinson</surname><given-names>CV.</given-names></string-name></person-group><article-title>Ion mobility mass spectrometry of peptide ions: effects of drift gas and calibration strategies</article-title>. <source>Anal Chem</source><year>2012</year>;<volume>84</volume>:<fpage>7124</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">22845859</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>CH</given-names></string-name>, <string-name><surname>Yeung</surname><given-names>D</given-names></string-name>, <string-name><surname>Spicer</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Sequence-specific model for predicting peptide collision cross section values in proteomic ion mobility spectrometry</article-title>. <source>J Proteome Re</source><year>2021</year>;<volume>20</volume>:<fpage>3600</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>Y-W</given-names></string-name>, <string-name><surname>Lin</surname><given-names>C-J.</given-names></string-name></person-group> Feature ranking using linear svm. In: Guyon I, Aliferis C, Cooper G, Elisseeff A, Pellet J-P, Spirtes P, and Statnikov A (eds.), <italic toggle="yes">Proceedings of the Workshop on the Causation and Prediction Challenge at WCCI 2008</italic>, volume 3 of <italic toggle="yes">Proceedings of Machine Learning Research</italic>, <fpage>53</fpage>–<lpage>64</lpage>. Hong Kong: PMLR, <year>2008</year>.</mixed-citation>
    </ref>
    <ref id="btad486-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chung</surname><given-names>J</given-names></string-name>, <string-name><surname>Gulcehre</surname><given-names>C</given-names></string-name>, <string-name><surname>Cho</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal> Empirical evaluation of gated recurrent neural networks on sequence modeling. arXiv, arXiv:1412.3555 [cs], <year>2014</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad486-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Łącki</surname><given-names>MK</given-names></string-name>, <string-name><surname>Startek</surname><given-names>MP</given-names></string-name>, <string-name><surname>Brehmer</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>OpenTIMS, TimsPY, and TimsR: open and easy access to timsTOF raw data</article-title>. <source>J Proteome Res</source><year>2021</year>;<volume>20</volume>:<fpage>2122</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">33724840</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cox</surname><given-names>J</given-names></string-name>, <string-name><surname>Mann</surname><given-names>M.</given-names></string-name></person-group><article-title>MaxQuant enables high peptide identification rates, individualized p.p.b.-range mass accuracies and proteome-wide protein quantification</article-title>. <source>Nat Biotechnol</source><year>2008</year>;<volume>26</volume>:<fpage>1367</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">19029910</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Carvalho</surname><given-names>RV</given-names></string-name>, <string-name><surname>Lopez-Ferrer</surname><given-names>D</given-names></string-name>, <string-name><surname>Guimarães</surname><given-names>KS</given-names></string-name></person-group><etal>et al</etal><article-title>Imspeptider: a computational peptide collision cross-section area calculator based on a novel molecular dynamics simulation protocol</article-title>. <source>J Comput Chem</source><year>2013</year>;<volume>34</volume>:<fpage>1707</fpage>–<lpage>18</lpage>.<pub-id pub-id-type="pmid">23609240</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Declercq</surname><given-names>A</given-names></string-name>, <string-name><surname>Bouwmeester</surname><given-names>R</given-names></string-name>, <string-name><surname>Hirschler</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>MS2Rescore: data-driven rescoring dramatically boosts immunopeptide identification rates</article-title>. <source>Mol Cell Proteomics</source><year>2022</year>;<volume>21</volume>:<fpage>100266</fpage>.<pub-id pub-id-type="pmid">35803561</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dodds</surname><given-names>JN</given-names></string-name>, <string-name><surname>Baker</surname><given-names>ES.</given-names></string-name></person-group><article-title>Ion mobility spectrometry: fundamental concepts, instrumentation, applications, and the road ahead</article-title>. <source>J Am Soc Mass Spectrom</source><year>2019</year>;<volume>30</volume>:<fpage>2185</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">31493234</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Feola</surname><given-names>S</given-names></string-name>, <string-name><surname>Chiaro</surname><given-names>J</given-names></string-name>, <string-name><surname>Martins</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>A novel immunopeptidomic-based pipeline for the generation of personalized oncolytic cancer vaccines</article-title>. <source>eLife</source><year>2022</year>;<volume>11</volume>:<fpage>e71156</fpage>.<pub-id pub-id-type="pmid">35314027</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gabelica</surname><given-names>V</given-names></string-name>, <string-name><surname>Marklund</surname><given-names>E.</given-names></string-name></person-group><article-title>Fundamentals of ion mobility spectrometry</article-title>. <source>Curr Opin Chem Biol</source><year>2018</year>;<volume>42</volume>:<fpage>51</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29154177</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gabelica</surname><given-names>V</given-names></string-name>, <string-name><surname>Shvartsburg</surname><given-names>AA</given-names></string-name>, <string-name><surname>Afonso</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Recommendations for reporting ion mobility mass spectrometry measurements</article-title>. <source>Mass Spectrom Rev</source><year>2019</year>;<volume>38</volume>:<fpage>291</fpage>–<lpage>320</lpage>.<pub-id pub-id-type="pmid">30707468</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gessulat</surname><given-names>S</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>T</given-names></string-name>, <string-name><surname>Zolg</surname><given-names>DP</given-names></string-name></person-group><etal>et al</etal><article-title>Prosit: proteome-wide prediction of peptide tandem mass spectra by deep learning</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>509</fpage>–<lpage>18</lpage>.<pub-id pub-id-type="pmid">31133760</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gomez-Zepeda</surname><given-names>D</given-names></string-name>, <string-name><surname>Arnold-Schild</surname><given-names>D</given-names></string-name>, <string-name><surname>Beyrle</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal> Thunder-DDA-PASEF enables high-coverage immunopeptidomics and identifies HLA class-I presented SarsCov-2 spike protein epitopes. <year>2023</year>.</mixed-citation>
    </ref>
    <ref id="btad486-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henderson</surname><given-names>SC</given-names></string-name>, <string-name><surname>Li</surname><given-names>J</given-names></string-name>, <string-name><surname>Counterman</surname><given-names>AE</given-names></string-name></person-group><etal>et al</etal><article-title>Intrinsic size parameters for val, ile, leu, gln, thr, phe, and trp residues from ion mobility measurements of polyamino acid ions</article-title>. <source>J Phys Chem B</source><year>1999</year>;<volume>103</volume>:<fpage>8780</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kaszycki</surname><given-names>JL</given-names></string-name>, <string-name><surname>Shvartsburg</surname><given-names>AA.</given-names></string-name></person-group><article-title>A priori intrinsic ptm size parameters for predicting the ion mobilities of modified peptides</article-title>. <source>J Am Soc Mass Spectrom</source><year>2017</year>;<volume>28</volume>:<fpage>294</fpage>–<lpage>302</lpage>.<pub-id pub-id-type="pmid">27975328</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kondalaji</surname><given-names>SG</given-names></string-name>, <string-name><surname>Khakinejad</surname><given-names>M</given-names></string-name>, <string-name><surname>Tafreshian</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Comprehensive peptide ion structure studies using ion mobility techniques: part 1. An advanced protocol for molecular dynamics simulations and collision cross section calculation</article-title>. <source>J Am Soc Mass Spectrom</source><year>2017</year>;<volume>28</volume>:<fpage>947</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">28211014</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>C</given-names></string-name>, <string-name><surname>Ren</surname><given-names>Y</given-names></string-name>, <string-name><surname>Yang</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Improved peptide retention time prediction in liquid chromatography through deep learning</article-title>. <source>Anal Chem</source><year>2018</year>;<volume>90</volume>:<fpage>10881</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30114359</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meier</surname><given-names>F</given-names></string-name>, <string-name><surname>Beck</surname><given-names>S</given-names></string-name>, <string-name><surname>Grassl</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Parallel accumulation–serial fragmentation (PASEF): multiplying sequencing speed and sensitivity by synchronized scans in a trapped ion mobility device</article-title>. <source>J Proteome Res</source><year>2015</year>;<volume>14</volume>:<fpage>5378</fpage>–<lpage>87</lpage>.<pub-id pub-id-type="pmid">26538118</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meier</surname><given-names>F</given-names></string-name>, <string-name><surname>Brunner</surname><given-names>A-D</given-names></string-name>, <string-name><surname>Koch</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Online parallel accumulation–serial fragmentation (PASEF) with a novel trapped ion mobility mass spectrometer</article-title>. <source>Mol Cell Proteomics</source><year>2018</year>;<volume>17</volume>:<fpage>2534</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">30385480</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meier</surname><given-names>F</given-names></string-name>, <string-name><surname>Köhler</surname><given-names>ND</given-names></string-name>, <string-name><surname>Brunner</surname><given-names>AD</given-names></string-name></person-group><etal>et al</etal><article-title>Deep learning the collisional cross sections of the peptide universe from a million experimental values</article-title>. <source>Nat Commun</source><year>2021a</year>;<volume>12</volume>:<fpage>1185</fpage>.<pub-id pub-id-type="pmid">33608539</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meier</surname><given-names>F</given-names></string-name>, <string-name><surname>Park</surname><given-names>MA</given-names></string-name>, <string-name><surname>Mann</surname><given-names>M.</given-names></string-name></person-group><article-title>Trapped ion mobility spectrometry and parallel accumulation–serial fragmentation in proteomics</article-title>. <source>Mol Cell Proteomics</source><year>2021b</year>;<volume>20</volume>:<fpage>100138</fpage>.<pub-id pub-id-type="pmid">34416385</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ogata</surname><given-names>K</given-names></string-name>, <string-name><surname>Chang</surname><given-names>C-H</given-names></string-name>, <string-name><surname>Ishihama</surname><given-names>Y.</given-names></string-name></person-group><article-title>Effect of phosphorylation on the collision cross sections of peptide ions in ion mobility spectrometry</article-title>. <source>Mass Spectrom</source><year>2021</year>;<volume>10</volume>:<fpage>A0093</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Okuda</surname><given-names>S</given-names></string-name>, <string-name><surname>Watanabe</surname><given-names>Y</given-names></string-name>, <string-name><surname>Moriya</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>jPOSTrepo: an international standard data repository for proteomes</article-title>. <source>Nucleic Acids Res</source><year>2017</year>;<volume>45</volume>:<fpage>D1107</fpage>–<lpage>D1111</lpage>.<pub-id pub-id-type="pmid">27899654</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Scikit-learn: machine learning in Python</article-title>. <source>Journal of Machine Learning Research</source><year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Prianichnikov</surname><given-names>N</given-names></string-name>, <string-name><surname>Koch</surname><given-names>H</given-names></string-name>, <string-name><surname>Koch</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>MaxQuant software for ion mobility enhanced shotgun proteomics</article-title>. <source>Mol Cell Proteomics</source><year>2020</year>;<volume>19</volume>:<fpage>1058</fpage>–<lpage>69</lpage>.<pub-id pub-id-type="pmid">32156793</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Purcell</surname><given-names>AW</given-names></string-name>, <string-name><surname>Ramarathinam</surname><given-names>SH</given-names></string-name>, <string-name><surname>Ternette</surname><given-names>N.</given-names></string-name></person-group><article-title>Mass spectrometry–based identification of MHC-bound peptides for immunopeptidomics</article-title>. <source>Nat Protoc</source><year>2019</year>;<volume>14</volume>:<fpage>1687</fpage>–<lpage>707</lpage>.<pub-id pub-id-type="pmid">31092913</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Revercomb</surname><given-names>HE</given-names></string-name>, <string-name><surname>Mason</surname><given-names>EA.</given-names></string-name></person-group><article-title>Theory of plasma chromatography/gaseous electrophoresis. review</article-title>. <source>Anal Chem</source><year>1975</year>;<volume>47</volume>:<fpage>970</fpage>–<lpage>83</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Samukhina</surname><given-names>YV</given-names></string-name>, <string-name><surname>Matyushin</surname><given-names>DD</given-names></string-name>, <string-name><surname>Grinevich</surname><given-names>OI</given-names></string-name></person-group><etal>et al</etal><article-title>A deep convolutional neural network for prediction of peptide collision cross sections in ion mobility spectrometry</article-title>. <source>Biomolecules</source><year>2021</year>;<volume>11</volume>:<fpage>1904</fpage>.<pub-id pub-id-type="pmid">34944547</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sinitcyn</surname><given-names>P</given-names></string-name>, <string-name><surname>Hamzeiy</surname><given-names>H</given-names></string-name>, <string-name><surname>Salinas Soto</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>MaxDIA enables library-based and library-free data-independent acquisition proteomics</article-title>. <source>Nat Biotechnol</source><year>2021</year>;<volume>39</volume>:<fpage>1563</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">34239088</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>The</surname><given-names>M</given-names></string-name>, <string-name><surname>MacCoss</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Noble</surname><given-names>WS</given-names></string-name></person-group><etal>et al</etal><article-title>Fast and accurate protein false discovery rates on large-scale proteomics data sets with percolator 3.0</article-title>. <source>J Am Soc Mass Spectrom</source><year>2016</year>;<volume>27</volume>:<fpage>1719</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">27572102</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Valentine</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Ewing</surname><given-names>MA</given-names></string-name>, <string-name><surname>Dilger</surname><given-names>JM</given-names></string-name></person-group><etal>et al</etal><article-title>Using ion mobility data to improve peptide identification: intrinsic amino acid size parameters</article-title>. <source>J Proteome Res</source><year>2011</year>;<volume>10</volume>:<fpage>2318</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">21417239</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Valentine</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Plasencia</surname><given-names>MD</given-names></string-name></person-group><etal>et al</etal><article-title>Developing liquid chromatography ion mobility mass spectometry techniques</article-title>. <source>Expert Rev Proteomics</source><year>2005</year>;<volume>2</volume>:<fpage>553</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">16097888</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Villatoro</surname><given-names>J</given-names></string-name>, <string-name><surname>Weber</surname><given-names>M</given-names></string-name>, <string-name><surname>Zühlke</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Structural characterization of synthetic peptides using electronspray ion mobility spectrometry and molecular dynamics simulations</article-title>. <source>Int J Mass Spectrom</source><year>2019</year>;<volume>436</volume>:<fpage>108</fpage>–<lpage>17</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Virtanen</surname><given-names>P</given-names></string-name>, <string-name><surname>Gommers</surname><given-names>R</given-names></string-name>, <string-name><surname>Oliphant</surname><given-names>TE</given-names></string-name></person-group><etal>et al</etal>; <collab>SciPy 1.0 Contributors</collab>. <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source>Nat Methods</source><year>2020</year>;<volume>17</volume>:<fpage>261</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">32015543</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vizcaíno</surname><given-names>JA</given-names></string-name>, <string-name><surname>Deutsch</surname><given-names>EW</given-names></string-name>, <string-name><surname>Wang</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>ProteomeXchange provides globally coordinated proteomics data submission and dissemination</article-title>. <source>Nat Biotechnol</source><year>2014</year>;<volume>32</volume>:<fpage>223</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">24727771</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>B</given-names></string-name>, <string-name><surname>Valentine</surname><given-names>S</given-names></string-name>, <string-name><surname>Raghuraman</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Prediction of peptide drift time in ion mobility-mass spectrometry</article-title>. <source>BMC Bioinform</source><year>2009</year>;<volume>10</volume>(Suppl. 7):<fpage>A1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>B</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Chen</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Prediction of peptide drift time in ion mobility mass spectrometry from sequence-based features</article-title>. <source>BMC Bioinform</source><year>2013</year>;<volume>14</volume>(Suppl. 4):<fpage>S1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>W-F</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>X-X</given-names></string-name>, <string-name><surname>Willems</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>AlphaPeptDeep: a modular deep learning framework to predict peptide properties for proteomics</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>7238</fpage>.<pub-id pub-id-type="pmid">36433986</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10521631</article-id>
    <article-id pub-id-type="pmid">37540201</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad486</article-id>
    <article-id pub-id-type="publisher-id">btad486</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Ionmob: a Python package for prediction of peptide collisional cross-section values</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1755-5382</contrib-id>
        <name>
          <surname>Teschner</surname>
          <given-names>David</given-names>
        </name>
        <aff><institution>Institute of Computer Science, Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
        <xref rid="btad486-cor1" ref-type="corresp"/>
        <!--dateschn@uni-mainz.de-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Gomez-Zepeda</surname>
          <given-names>David</given-names>
        </name>
        <aff><institution>Institute for Immunology, University Medical Center of the Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
        <aff><institution>Immunoproteomics Unit, Helmholtz-Institute for Translational Oncology (HI-TRON)</institution>, 55131 Mainz, <country country="DE">Germany</country></aff>
        <xref rid="btad486-cor1" ref-type="corresp"/>
        <!--dgomezze@uni-mainz.de-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9376-1399</contrib-id>
        <name>
          <surname>Declercq</surname>
          <given-names>Arthur</given-names>
        </name>
        <aff><institution>VIB-UGent Center for Medical Biotechnology, VIB</institution>, 9052 Gent, <country country="BE">Belgium</country></aff>
        <aff><institution>Department of Biomolecular Medicine, Ghent University</institution>, 9000 Ghent, <country country="BE">Belgium</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Łącki</surname>
          <given-names>Mateusz K</given-names>
        </name>
        <aff><institution>Institute for Immunology, University Medical Center of the Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Avci</surname>
          <given-names>Seymen</given-names>
        </name>
        <aff><institution>Institute of Computer Science, Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bob</surname>
          <given-names>Konstantin</given-names>
        </name>
        <aff><institution>Institute of Computer Science, Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Distler</surname>
          <given-names>Ute</given-names>
        </name>
        <aff><institution>Institute for Immunology, University Medical Center of the Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Michna</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>Institute for Immunology, University Medical Center of the Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
        <aff><institution>Immunoproteomics Unit, Helmholtz-Institute for Translational Oncology (HI-TRON)</institution>, 55131 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Martens</surname>
          <given-names>Lennart</given-names>
        </name>
        <aff><institution>VIB-UGent Center for Medical Biotechnology, VIB</institution>, 9052 Gent, <country country="BE">Belgium</country></aff>
        <aff><institution>Department of Biomolecular Medicine, Ghent University</institution>, 9000 Ghent, <country country="BE">Belgium</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tenzer</surname>
          <given-names>Stefan</given-names>
        </name>
        <aff><institution>Institute for Immunology, University Medical Center of the Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
        <aff><institution>Immunoproteomics Unit, Helmholtz-Institute for Translational Oncology (HI-TRON)</institution>, 55131 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hildebrandt</surname>
          <given-names>Andreas</given-names>
        </name>
        <aff><institution>Institute of Computer Science, Johannes Gutenberg University</institution>, 55128 Mainz, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad486-cor1">Corresponding authors: Institute of Computer Science, Johannes Gutenberg University, 55128 Mainz, Germany. E-mail: <email>dateschn@uni-mainz.de</email> (D.T.); Institute for Immunology, University Medical Center of the Johannes Gutenberg University, 55128 Mainz, Germany. E-mail: <email>dgomezze@uni-mainz.de</email> (D.G.-Z.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-04">
      <day>04</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>9</issue>
    <elocation-id>btad486</elocation-id>
    <history>
      <date date-type="received">
        <day>07</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>31</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>25</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad486.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Including ion mobility separation (IMS) into mass spectrometry proteomics experiments is useful to improve coverage and throughput. Many IMS devices enable linking experimentally derived mobility of an ion to its collisional cross-section (CCS), a highly reproducible physicochemical property dependent on the ion’s mass, charge and conformation in the gas phase. Thus, known peptide ion mobilities can be used to tailor acquisition methods or to refine database search results. The large space of potential peptide sequences, driven also by posttranslational modifications of amino acids, motivates an <italic toggle="yes">in silico</italic> predictor for peptide CCS. Recent studies explored the general performance of varying machine-learning techniques, however, the workflow engineering part was of secondary importance. For the sake of applicability, such a tool should be generic, data driven, and offer the possibility to be easily adapted to individual workflows for experimental design and data processing.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We created <monospace>ionmob</monospace>, a Python-based framework for data preparation, training, and prediction of collisional cross-section values of peptides. It is easily customizable and includes a set of pretrained, ready-to-use models and preprocessing routines for training and inference. Using a set of ≈21 000 unique phosphorylated peptides and ≈17 000 MHC ligand sequences and charge state pairs, we expand upon the space of peptides that can be integrated into CCS prediction. Lastly, we investigate the applicability of <italic toggle="yes">in silico</italic> predicted CCS to increase confidence in identified peptides by applying methods of re-scoring and demonstrate that predicted CCS values complement existing predictors for that task.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The Python package is available at github: <ext-link xlink:href="https://github.com/theGreatHerrLebert/ionmob" ext-link-type="uri">https://github.com/theGreatHerrLebert/ionmob</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Bundesministerium für Bildung und Forschung</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002347</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Research Foundation Flanders</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003130</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Ion mobility enhanced mass spectrometry coupled with liquid chromatography (LC-IMS-MS) improves throughput and coverage of proteomics experiments (<xref rid="btad486-B21" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2015</xref>). Traditionally, proteomics analyses have been performed by separation of peptides using reversed phase liquid chromatography (LC), interfaced by electrospray ionization to mass spectrometry (MS) to analyze the mass to charge ratio (<italic toggle="yes">m</italic>/<italic toggle="yes">z</italic>) of the analyte ions. Ion mobility separation (IMS) adds an additional dimension of separation. Its functionality is based on the fact that in the presence of an electric field, small, compact ions will behave differently when flying through a cloud of charge-neutral gas than larger ones (<xref rid="btad486-B35" ref-type="bibr">Valentine <italic toggle="yes">et al.</italic> 2005</xref>). This enables to distinguish molecules, such as isobaric ions with the same <italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> but differing sequences or modifications, that can’t be separated by LC-MS (<xref rid="btad486-B24" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021b</xref>, <xref rid="btad486-B25" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic> 2021</xref>). Additionally, IMS allows for filtering or untargeted annotation (<xref rid="btad486-B11" ref-type="bibr">Dodds and Baker 2019</xref>).</p>
    <p>Depending on the hardware setup, the IMS can be used to calculate the collisional cross-section (CCS) value of the ions by applying kinetic theory that links experimentally determined reduced ion-mobilities to their momentum transfer collision integral through the Mason–Schamp equation (<xref rid="btad486-B30" ref-type="bibr">Revercomb and Mason 1975</xref>, <xref rid="btad486-B14" ref-type="bibr">Gabelica <italic toggle="yes">et al.</italic> 2019</xref>). The translation of the reduced mobility, <italic toggle="yes">K</italic>0, to CCS depends on several factors including ion mass and charge, as well as the mass and temperature of the drift gas. However, the application of this theory makes some simplifying assumptions including that the electric field applied is low enough to be negligible. As a result, the translation of experimentally determined drift times to CCS can only be performed for low field devices such as drift tube, travelling wave, or trapped ion mobility (DTIMS, TWIMS, and TIMS), but not for devices involving high fields such as field asymmetric ion mobility spectrometry (<xref rid="btad486-B11" ref-type="bibr">Dodds and Baker 2019</xref>). For an in-depth description of differences in the determination of <italic toggle="yes">K</italic>0 from experimental setups see e.g. <xref rid="btad486-B13" ref-type="bibr">Gabelica and Marklund (2018)</xref>, <xref rid="btad486-B11" ref-type="bibr">Dodds and Baker (2019)</xref>, and <xref rid="btad486-B14" ref-type="bibr">Gabelica <italic toggle="yes">et al.</italic> (2019)</xref>. As the ion CCS is an inherent physicochemical property, CCS calculations from IMS data are highly reproducible (<xref rid="btad486-B3" ref-type="bibr">Bush <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021a</xref>). Thus, LC-IMS-MS offers both increased capability of ion separation and identification crucial for the ultimate task of elucidating the chemical composition of samples.</p>
    <p>There are two principal reasons for establishing a CCS predictor. First, it offers potential insight into how specific features can influence the ion conformation in the gas phase (<xref rid="btad486-B25" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021a</xref>). These could be used to drive particular experimental setups tailored to certain types of peptides (<xref rid="btad486-B16" ref-type="bibr">Gomez‐Zepeda <italic toggle="yes">et al.</italic> 2023</xref>). Second, given their high reproducibility, CCS of ions hold valuable information ready to be integrated into candidate scoring. Thus, it can help to increase the confidence and overall number of identifications of peptides. Especially the second point is of particular importance, as in bottom-up proteomics one has to also perform the peptide to protein inference. Both factors can improve the coverage of peptides and thus of proteins identified.</p>
    <p>Recently, there has been steadily increasing interest in the prediction of peptide CCS values (<xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021a</xref>, <xref rid="btad486-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad486-B31" ref-type="bibr">Samukhina <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad486-B41" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> 2022</xref>). This task boils down to designing a function defined over some space of arguments resulting in a (real-valued) CCS prediction, which can be easily recognized as a regression task. In contrast to a simple database look-up, the key advantage of this approach comes from the possibility to obtain predictions for previously unobserved data. For example, a given sample might result in ions with sequences that were previously not observed. A prominent example is posttranslational modifications (PTMs) derived from biological conditions (e.g., phosphorylation) or experimental setups (e.g., carbamidomethylation). IMS can help to differentiate peptides with identical sequences but different PTM positions, which may have different biological results. Another relevant example is MHC ligands sensed by the immune system to trigger the defense against possible threats, such as cancerogenic cells or virus infections. Detecting MHC peptide ligands, also called immunopeptides, is essential for developing vaccines and immunotherapies. MHC ligands result from the cleavage of proteins mediated by diverse enzymes in the cell, exponentially expanding the search space and thus complicating their identification. In addition, immunopeptidomics samples are more likely to contain isobaric peptides than proteomics samples due to conserved patterns in their sequences. Since LC-MS alone cannot separate such peptides, IMS becomes essential to improve the identification of MHC ligands. Overall, the space of observable ions is huge, but there exists complex yet stable principles that govern the observed CCS values.</p>
    <p>To establish such a predictor, several modeling strategies are available. Historically, due to small number of available reference data-points, mostly low-parametric approaches were used. One of the first was based on intrinsic size parameters (ISPs; <xref rid="btad486-B17" ref-type="bibr">Henderson <italic toggle="yes">et al.</italic> 1999</xref>), where every amino acid is assigned some fixed value <italic toggle="yes">a priori</italic>. ISPs were derived from a set of 660 peptide sequences. A prediction of CCS for a specific sequence is then carried out by simply summing over all contributions. Applicability for enhanced peptide identification based on ISPs has also been discussed (<xref rid="btad486-B34" ref-type="bibr">Valentine <italic toggle="yes">et al.</italic> 2011</xref>). This idea was later extended to also account for e.g. PTMs by adding up contributions of individual atoms instead of amino acids (<xref rid="btad486-B18" ref-type="bibr">Kaszycki and Shvartsburg 2017</xref>). Other approaches included a multi-layer perceptron architecture and support vector machines (<xref rid="btad486-B39" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2009</xref>, <xref rid="btad486-B40" ref-type="bibr">2013</xref>) that relied on engineered features derived from 595 peptide sequences. While those models are quick to run and already do offer a lot of insight into the problem, they simply cannot fully account for the richness of the configuration space of ions.</p>
    <p>With the increased use of LC-IMS-MS methods into mainstream proteomics and the resulting increase in the availability of measured CCS values (<xref rid="btad486-B24" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021b</xref>), more complex data-driven approaches were proposed. Using positional encoded ISPs with a linear regression model was implemented by a very recent study by <xref rid="btad486-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> (2021)</xref>. This way, increased expressiveness of the predictor was achieved with features that could be extracted from a training dataset of 135 000 peptide sequences. A very different approach was taken by <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref>, where the authors trained a deep recurrent neural network end-to-end. This was possible due to the generation of a training set with <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula>550 000 examples. Their model achieves state-of-the art prediction accuracy on a test set of <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula>150 000 unique test sequences. <xref rid="btad486-B31" ref-type="bibr">Samukhina <italic toggle="yes">et al.</italic> (2021)</xref> also built upon this dataset using deep learning. They applied a mixed architecture of 1-D convolutions and handcrafted features for sequences in combination with model-averaging, which resulted in increased prediction accuracy. To give a complete picture of potential approaches, reasoning based on physics were also performed, where one used Monte Carlo molecular dynamics to simulate the CCS values (<xref rid="btad486-B9" ref-type="bibr">de Carvalho <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad486-B19" ref-type="bibr">Kondalaji <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad486-B36" ref-type="bibr">Villatoro <italic toggle="yes">et al.</italic> 2019</xref>). However, these simulations are prohibitively demanding in terms of computational time and therefore impractical to use in high-throughput scenarios.</p>
    <p>Overall, there are many similarities in the techniques used currently to model ion mobilities to those used for retention times (<xref rid="btad486-B20" ref-type="bibr">Ma <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad486-B15" ref-type="bibr">Gessulat <italic toggle="yes">et al.</italic> 2019</xref>), i.e. the LC-derived measurements. Given the much higher stability of the ion mobility measurements, it is interesting to ask what these models can bring to the table.</p>
    <p>Apart from the proper choice of the architecture of the predictor, additional steps have to be typically performed to preprocess the data. From the practical standpoint, these steps take most of the actual work of the data-scientist. These steps include solving issues such as outlier detection, deduplication, feature generation and alignment of new data. We present here <monospace>ionmob—</monospace>a Python package for preprocessing datasets and fitting predictors of the CCS values of peptides identified by LC-IMS-MS using data acquired in timsTOF instruments. It offers routines necessary to solve all of the practicalities mentioned above and results in a prediction accuracy matching the state-of-the-art models. In addition, we included a selection of pretrained models and architecture primitives, which are easy to integrate into existing workflows. Importantly, <monospace>ionmob</monospace> integrates trypsin-cleaved peptides, phosphorylated tryptic peptides and also MHC ligands into deep learning driven CCS prediction, making our models more expressive. The package is well documented and available free of charge under the MIT license from github. Finally, we investigated how <italic toggle="yes">in silico</italic> prediction of CCS could be utilized to improve identification of peptides, allowing to integrate additional information from LC-IMS-MS proteomics experiments. <monospace>ionmob</monospace> will facilitate the training and incorporation of CCS-prediction in diverse workflows for LC-IMS-MS proteomics and peptidomics experiments.</p>
  </sec>
  <sec>
    <title>2 Approach</title>
    <sec>
      <title>2.1 General ionmob workflow</title>
      <p>An <monospace>ionmob</monospace> workflow can be composed of one or more building blocks, depending on the task at hand. An overview is given in <xref rid="btad486-F1" ref-type="fig">Fig. 1A</xref>.</p>
      <fig position="float" id="btad486-F1">
        <label>Figure 1.</label>
        <caption>
          <p>(A) General workflow of <monospace>ionmob</monospace>. (a) Data are generated from different samples, devices and laboratories. A sample of interest (<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) is analyzed through multiple replicates (<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>) and combined into an identification table during raw data analysis (<inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>). (b) For a representative set of training values, peptide charge state pairs are pre-processed e.g. deduplicated. Raw data are then translated into sets of features for machine learning. This results in data ready for training. (c) Training then is an iterative process where the internal state of a predictor is changed so that its output better resembles the desired output based on some objective measure. This results in a trained model that can be used for prediction. (d) Before trained model outputs can be compared with data derived from a new source, a dataset specific shift needs to be calculated. After that, predictions of a model are ready, e.g. for rescoring. (B) Proposed model architecture. (a) Simple initial projection fitting a square-root function and a bias with mass and charge of a peptide as inputs. (b) Recurrent neural network using GRUs to predict higher-order interactions that contribute to observed CCS based on peptide sequences. Deeper dense layers are also provided with the charge state of the ion as additional input. AAs stands for amino acids. (c) Final CCS values are then calculated as sum of initial projection and deep residues</p>
        </caption>
        <graphic xlink:href="btad486f1" position="float"/>
      </fig>
      <p>The regular occurring tasks roughly fall into three categories: data preprocessing, model training, and CCS inference. We provide explicit functionality for:</p>
      <list list-type="bullet">
        <list-item>
          <p>detection of peptides with multiple conformations,</p>
        </list-item>
        <list-item>
          <p>deduplication of data points followed by an aggregation strategy,</p>
        </list-item>
        <list-item>
          <p>feature generation, e.g. tokenization, based on data from multiple software sources,</p>
        </list-item>
        <list-item>
          <p>alignment of new datasets for optimal prediction performance, and</p>
        </list-item>
        <list-item>
          <p>pre-trained models for CCS inference out-of-the-box.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>2.2 Modeling strategy and predictor architecture</title>
      <p>Previous models used machine-learning algorithms to predict CCS directly from peptide sequence and charge. However, the CCS of an ion is highly correlated with its mass and charge (<xref rid="btad486-B24" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021b</xref>) (see <xref rid="btad486-F2" ref-type="fig">Fig. 2</xref>). This fact can be exploited to reformulate the prediction task to only predict the residues with respect to an initial projection of mass and charge.</p>
      <fig position="float" id="btad486-F2">
        <label>Figure 2.</label>
        <caption>
          <p><italic toggle="yes">m</italic>/<italic toggle="yes">z</italic> versus CCS for observed (blue) and predicted (orange) CCS values of MHC peptides, model performance. (A) Ground truth versus predicted CCS after initial projection with a simple square-root function, see <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> and <xref rid="btad486-F1" ref-type="fig">Fig. 1B</xref>a. (B) Final CCS prediction as sum of initial projection and deep residues, see <xref rid="E2" ref-type="disp-formula">Equation (2)</xref> and <xref rid="btad486-F1" ref-type="fig">Fig. 1B</xref>c. (C) Boxplots showing charge state wise relative errors comparing both prediction accuracies. (D) Total relative error distributions for both models after training</p>
        </caption>
        <graphic xlink:href="btad486f2" position="float"/>
      </fig>
      <p>The reformulation yields multiple advantages: first, it reduces the convergence time of training considerably since the starting initial CCS is already much closer to the real value. Second, fitting a regression model with gradient-based optimization was numerically unstable for models with few parameters. This could be because the output domain of a model needs to span a wide range of values and higher charge states are underrepresented compared with lower ones. Third, having this simple component of the predictor separated from more complex ones makes it convenient to look at the contributions of higher-order interactions of features. Fourth, it also establishes a baseline accuracy (see <xref rid="btad486-F2" ref-type="fig">Fig. 2</xref>).</p>
      <p>We therefore decided to rephrase our approach. First, an initial CCS value is calculated solely based on an ions mass and charge, see <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>, where a coefficient <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and an intercept <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are fit separately for each modeled charge state <italic toggle="yes">c a priori</italic>.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>init</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>mz</mml:mtext><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:msqrt><mml:mrow><mml:mtext>mz</mml:mtext></mml:mrow></mml:msqrt><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>Afterward, a regressor <italic toggle="yes">M</italic> with parameter set <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mo>θ</mml:mo></mml:math></inline-formula> is fit to further lower the mean absolute error (MAE) of predicted CCS values compared with the experimentally observed ones, see <xref rid="E2" ref-type="disp-formula">Equation (2)</xref>.
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>final</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>mz</mml:mtext><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>CCS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>init</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>mz</mml:mtext><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Input features may vary for different implementations of <italic toggle="yes">M</italic> but are all based on information derived from peptide sequence <italic toggle="yes">s</italic> and charge state <italic toggle="yes">c</italic>. A concrete implementation is shown schematically in <xref rid="btad486-F1" ref-type="fig">Fig. 1B</xref>, representing our proposed predictor architecture. It has ≈550 000 trainable weights.</p>
      <p>Here, the residues with respect to the initial square-root fit are modeled by a deep recurrent neural network, using token embeddings for amino acids and bidirectional gated recurrent units (GRUs; <xref rid="btad486-B6" ref-type="bibr">Chung <italic toggle="yes">et al.</italic> 2014</xref>) to provide a sequence specific contribution (see <xref rid="btad486-F2" ref-type="fig">Fig. 2</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Materials and methods</title>
    <sec>
      <title>3.1 Sample preparation and LC-IMS-MS data acquisition</title>
      <p>The detailed methodology for sample preparation and LC-IMS-MS analysis is included in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> and Methods. LC-IMS-MS was performed in nanoAcquity (Waters) or nanoElute (Bruker) chromatography systems connected to either timsTOF Pro-2 or timsTOF SCP (<xref rid="btad486-B2" ref-type="bibr">Brunner <italic toggle="yes">et al.</italic> 2022</xref>) (Bruker) MS, using DDA-PASEF (<xref rid="btad486-B22" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2018</xref>) for MS acquisition.</p>
    </sec>
    <sec>
      <title>3.2 Hardware, raw data analysis, and regression modeling</title>
      <p>MaxQuant version 2.0.3.0 (<xref rid="btad486-B8" ref-type="bibr">Cox and Mann 2008</xref>, <xref rid="btad486-B32" ref-type="bibr">Sinitcyn <italic toggle="yes">et al.</italic> 2021</xref>) and PEAKS XPro version 10.6 (BSI, Canada) were used to process generated .d raw files. Results used for training were filtered at 1% FDR at the peptide-spectrum match (PSM) and peptide level. For phosphopeptides, only identifications with a PTM AScore &gt; 20 were used (99% confidence). Data preprocessing, model training and package development were performed on a workstation running Ubuntu 20.04 with 32 GB of RAM, an AMD Ryzen 7 3700X 8-Core Processor and a NVIDIA RTX 2070 SUPER GPU with CUDA version 11.2 and cuDNN 8.1.1. Peptide identification was performed with the andromeda search engine and reference X-FASTA sequences. All regression models were implemented with <monospace>scikit-learn</monospace> (<xref rid="btad486-B27" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>) version 1.1.0, <monospace>scipy</monospace> (<xref rid="btad486-B37" ref-type="bibr">Virtanen <italic toggle="yes">et al.</italic> 2020</xref>), version 1.8.0 or <monospace>TensorFlow</monospace> (<xref rid="btad486-B1" ref-type="bibr">Abadi <italic toggle="yes">et al.</italic> 2016</xref>), and version 2.9.0 using Python 3.9.</p>
    </sec>
    <sec>
      <title>3.3 Data aggregation</title>
      <p>The peptide identification text files created by MaxQuant and PEAKS were used to generate our in-house datasets. Feature duplicates consisting of (sequence, charge, and CCS) instances were aggregated and their occurrences tracked. In order to distinguish between differently folded populations of peptides with the same charge state and sequence but notably different CCS values, modality classes were assigned. Features with identical charge and sequence that diverge the boundary of 2-times the standard deviation to the main feature are considered to be secondary features. Thereby, a distinction between unimodal and bimodal distributions of CCS values for a feature is established. Within the bimodal fraction of features, a main feature is determined based on the peptide mode with highest occurrence. Features that displayed CCS values within the boundary of 2-times the standard deviation to the main feature are considered as part of the main feature and therefore aggregated/fused. The difference in CCS values for the latter features are attributed to measurement inaccuracies. The resulting CCS value is the occurrence-weighted average of all (sequence, charge)-duplicates within the same modality class. In case of multi-modality of a feature, only the main feature was kept.</p>
    </sec>
    <sec>
      <title>3.4 External datasets</title>
      <p>We downloaded the peptide identification tables from the following publicly available datasets acquired in timsTOF instruments.</p>
      <list list-type="order">
        <list-item>
          <p>The tryptic peptide training and test sets published by <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref> (data preparation described therein) available at github from their repository (<ext-link xlink:href="https://github.com/theislab/DeepCollisionalCrossSection" ext-link-type="uri">https://github.com/theislab/DeepCollisionalCrossSection</ext-link>, accessed 10.07.22). The combined dataset contained 718 917 unique pairs of charge state and sequence.</p>
        </list-item>
        <list-item>
          <p>The tryptic peptide results published by <xref rid="btad486-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> (2021)</xref> that were made accessible through jPOST, dataset id JPST 000959, JPST 001017, and JPST 001176. The dataset was deduplicated by the same strategy described for our own dataset, see previous section. Sequence charge state pairs that were already present in one of the other datasets were removed, which left a total of 5064 examples.</p>
        </list-item>
        <list-item>
          <p>The results published by <xref rid="btad486-B12" ref-type="bibr">Feola <italic toggle="yes">et al.</italic> (2022)</xref> (MHC ligands) and <xref rid="btad486-B25" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic> (2021)</xref> (phosphopeptides) that were made accessible through PRIDE, dataset id PXD 026463 and jPOST, dataset id PXD 019746. The datasets were deduplicated by the same strategy described for our own dataset, see previous section. Sequence charge state pairs that were already present in one of the other datasets were removed, which left a total of 7366 examples and 7742 examples, respectively.</p>
        </list-item>
      </list>
      <p>We extracted 42 sequence, charge state pairs acquired using <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> as drift gas and measured twice, once with TWIMS and once with DTIMS from <xref rid="btad486-B3" ref-type="bibr">Bush <italic toggle="yes">et al.</italic> (2012)</xref> for evaluation of CCS prediction performance on non-timsTOF data.</p>
    </sec>
    <sec>
      <title>3.5 Alignment of collisional cross-section values</title>
      <p>A dataset specific, linear shift in CCS was calculated by matching sequence and charge state pairs identified in both the dataset obtained from Meier <italic toggle="yes">et al.</italic> and each of the other datasets (in-house and external). Using this dataset as reference is practical, as it holds by far the most sequences. This aligns the means of all observed CCS values in different datasets and is necessary to avoid systematic error.</p>
    </sec>
    <sec>
      <title>3.6 Training, validation, and test set generation</title>
      <p>A concatenation of training and test sets published by <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref> together with our in-house generated phosphorylation and MHC ligand datasets were used as training set, the in-house generated tryptic dataset was used as validation set. The three remaining external datasets were later used as test sets.</p>
    </sec>
    <sec>
      <title>3.7 Model training</title>
      <p>Initial square-root fit was performed separately for each charge state using SciPy, see <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>. Resulting parameter values were then used to parameterize a custom tensorflow layer with nontrainable weights. Model optimization was performed with gradient descent using MAE as objective function. The Adam optimizer was used with an initial learning rate of <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Dropout regularization with a dropout rate of 0.2 was applied between the last two deep dense layers. After each epoch, MAE was calculated on the validation set. If there was no decreased MAE for at least three epochs, the learning rate was lowered by an order of magnitude. If there was still no improvement on the validation set for another three epochs, training was stopped.</p>
    </sec>
    <sec>
      <title>3.8 External collisional cross-section predictors</title>
      <p>We downloaded the CCS predictor tools described by <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref>, <xref rid="btad486-B41" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> (2022)</xref>, and <xref rid="btad486-B31" ref-type="bibr">Samukhina <italic toggle="yes">et al.</italic> (2021)</xref>. We ran those models on our three test datasets according to the provided instructions. In the latter case, we therefore calculated the resulting CCS value for a given sequence and charge state pair as the average of all five created predictions.</p>
    </sec>
    <sec>
      <title>3.9 Calculation of additive scalar amino-acid properties</title>
      <p>The <monospace>pepdata</monospace> Python package (v1.0.7; <ext-link xlink:href="https://github.com/openvax/pepdata" ext-link-type="uri">https://github.com/openvax/pepdata</ext-link>) was used to calculate scalar features for peptide sequences. The package provides scalar descriptors of different amino-acid properties like hydropathy or polarity as mappings from a given amino acid to the respective value. For the scalar descriptors volume, polarity, hydropathy, hydrophilicity, solvent-exposed area, accessible surface area, accessible surface area folded, local flexibility, and pK side-chain, we calculated their normalized value by summing over the individual contributions of amino acids per sequence and divided by the sequence length.</p>
    </sec>
    <sec>
      <title>3.10 Rescoring with collisional cross-section features</title>
      <p>We tested the impact of using CCS predictions by adding CCS features as feature set to the current implementation of MS²Rescore (v2.1.2; <xref rid="btad486-B10" ref-type="bibr">Declercq <italic toggle="yes">et al.</italic> 2022</xref>) in addition to the existing peak intensity and retention time prediction features. For this, the mzid PEAKS search engine output files from the tryptic, phosphorylated and MHC ligand peptide data were used as is. Furthermore the MHC peptide dataset was acquired using a method optimized to include singly charged peptides (<xref rid="btad486-B16" ref-type="bibr">Gomez‐Zepeda <italic toggle="yes">et al.</italic> 2023</xref>). All three were parsed with the PEAKS pipeline of MS²Rescore; however, the pin files were modified with additional CCS features before running percolator. These features include the observed and predicted CCS value, the error, the absolute error and the percentual CCS error between observed value and predicted value. Peptides that carried &gt;4 charges were left out since the CCS predictor was not trained for these charges. Subsequently, these modified pin files were rescored with percolator (<xref rid="btad486-B33" ref-type="bibr">The <italic toggle="yes">et al.</italic> 2016</xref>) (v3.05.0) as well as a pin files without these features to be able to compare the effects of CCS features when rescoring. The additional rescoring analyses were done in jupyter notebooks and plots were generated using matplotlib(v5.3.2) and seaborn(v0.11.2).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <sec>
      <title>4.1 Model accuracy and comparison</title>
      <p>To evaluate the performance of our model based on bidirectional gated recurrent units (gru), we compared it with three previously published deep predictors: <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref> (lstm) using long-short term memory cells, <xref rid="btad486-B31" ref-type="bibr">Samukhina <italic toggle="yes">et al.</italic> (2021)</xref> (conv) using a mix of handcrafted features, convolutions, and model averaging, <xref rid="btad486-B41" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> (2022)</xref> (apd) using transformer-style attention. The results are shown in <xref rid="btad486-F3" ref-type="fig">Fig. 3</xref>. Median absolute percent error (MAPE) was used as comparison metric, since the spread of CCS values for a given charge state increases with the mass of the ion (see <xref rid="btad486-F2" ref-type="fig">Fig. 2</xref>).</p>
      <fig position="float" id="btad486-F3">
        <label>Figure 3.</label>
        <caption>
          <p>A performance comparison between <monospace>ionmob</monospace> GRU predictor and freely available deep predictors. (A–C) Performance per charge state for different test datasets. The gru model has a slight performance boost over the others for the <xref rid="btad486-B12" ref-type="bibr">Feola <italic toggle="yes">et al.</italic> (2022)</xref> dataset, likely since in contrast to the others it was explicitly trained on MHC peptides. Surprisingly, for charge state 4, prediction error for the <xref rid="btad486-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> (2021)</xref> dataset is relatively high for all models. (D) Boxplots of relative error distributions for all models. Overall performance of conv <xref rid="btad486-B31" ref-type="bibr">Samukhina <italic toggle="yes">et al.</italic> (2021)</xref>, lstm <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref>, and gru model are relatively on par with each other, while the apd <xref rid="btad486-B41" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> (2022)</xref> model seems to perform a little worse. The ensemble prediction is calculated as the average predicted CCS value over all four models</p>
        </caption>
        <graphic xlink:href="btad486f3" position="float"/>
      </fig>
      <p>Other studies predicting CCS made use of the Pearson correlation coefficient as an additional metric. However, we observed that the square-root baseline already had a correlation value of <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.97</mml:mn></mml:mrow></mml:math></inline-formula> and therefore think that it adds no significant insight into model performance. Interestingly, it can be observed that both the long-short term memory (lstm) and convolutional model (conv) show performances comparable to our predictor (gru) on the dataset from <xref rid="btad486-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> (2021)</xref> and our in-house tryptic dataset. However, they show a lower performance on the dataset from <xref rid="btad486-B12" ref-type="bibr">Feola <italic toggle="yes">et al.</italic> (2022)</xref>. This could stem from the fact that the latter dataset contains MHC ligands, a type of peptide not present in the dataset those models were trained on but part of our in-house generated dataset. The CCS and IMS patterns of MHC ligands may be different since their C-ter amino acid is not necessarily Arg or Lys, as it is usually the case for tryptic peptides analyzed in proteomics experiments (<xref rid="btad486-B29" ref-type="bibr">Purcell <italic toggle="yes">et al.</italic> 2019</xref>). It hints that even if the authors of <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref> could not observe significant improvements in prediction accuracy for their model beyond a training set size of ≈300 000 examples, the richness of naturally occurring peptides and experimental conditions might not be fully explored yet. Achieved accuracy on phosphorylated peptides could only be evaluated for our predictor and the model from <xref rid="btad486-B41" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic> (2022)</xref> and is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>.</p>
    </sec>
    <sec>
      <title>4.2 Prediction of collisional cross-section for singly charged peptide ions</title>
      <p>In most proteomics workflows, the MS is configured to skip the fragmentation of singly charged ions or they are simply not considered for peptide identification during data processing (<xref rid="btad486-B28" ref-type="bibr">Prianichnikov <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad486-B16" ref-type="bibr">Gomez‐Zepeda <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btad486-B29" ref-type="bibr">Purcell <italic toggle="yes">et al.</italic> 2019</xref>). This is because, first, singly charged peptides are more difficult to identify since only one of the two fragments is charged and can be detected after collision-induced dissociation. Second, most contaminants are singly charged as well and can be ignored thereby (<xref rid="btad486-B10" ref-type="bibr">Declercq <italic toggle="yes">et al.</italic> 2022</xref>). This also means that the range of inverse ion-mobility, where experimental measurements can be reliably transferred from reduced mobilities to CCS, will rarely cover those ions, since the instrument resolution is finite and tuned to the regions of highest interest (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). This changes for MHC ligand peptides, as those can be singly charged due to their nontryptic origin, hence missing the C-terminal arginine or lysine as well as being relatively short (<xref rid="btad486-B10" ref-type="bibr">Declercq <italic toggle="yes">et al.</italic> 2022</xref>). We acquired an additional dataset of MHC peptides using Thunder-DDA-PASEF, which is explicitly set-up to cover those ions (<xref rid="btad486-B16" ref-type="bibr">Gomez‐Zepeda <italic toggle="yes">et al.</italic> 2023</xref>).</p>
    </sec>
    <sec>
      <title>4.3 Comparing predicted collisional cross-section to experimentally acquired values from different ion mobility separation devices</title>
      <p>As mentioned above, CCS values are never directly measured but derived from experimentally determined ion-mobilities by e.g. the Mason–Schamp equation or using a calibration curve (<xref rid="btad486-B11" ref-type="bibr">Dodds and Baker 2019</xref>). However, it is still a matter of ongoing debate under which experimental conditions this holds true (<xref rid="btad486-B13" ref-type="bibr">Gabelica and Marklund 2018</xref>). To gain insight whether or not our predictor might be applicable for IMS acquisitions that do not use TIMS separation, we compared predicted CCS values with results published by <xref rid="btad486-B3" ref-type="bibr">Bush <italic toggle="yes">et al.</italic> (2012)</xref>. Here, a custom Synapt MS (Waters Corp.) with both a traveling-wave IMS (TWIMS) and a drift tube IMS (DTIMS) devices was used to derive CCS values for a total of 42 peptide sequence, charge state pairs that had 27, 11, and 4 sequences of charge state 2, 3, and 4, respectively. Results are graphically shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>. The prediction accuracy was highest in the TWIMS analyses for ions with charge two and three (MAPE of 0.81 and 1.78, respectively) and for doubly charged ions in the DTIMS analyses (1.06). The error increased for ions with charge four in TWIMS (1.85) and ions with charge three or four in DTIMS (2.48 and 3.3, respectively). While these results offer preliminary insights, it is important to note that they were based on a very small sample. Therefore, gathering more data for evaluation would be necessary to confirm these findings. However, at the time of publication, we did not find available published data including the CCS for a larger number of peptides from any of these devices. In summary, although larger datasets are required to validate these results, ionmob has the potential to be applied to predict IMS in other instruments.</p>
    </sec>
    <sec>
      <title>4.4 Driving factors of collisional cross-section prediction</title>
      <sec>
        <title>4.4.1 Embeddings of amino acids</title>
        <p>The learned residues of peptide CCS values with respect to the initial fit use an embedding (here, 128 dimensional) to represent amino acids as dense vectors before being fed to the GRU units. This gives the opportunity to inspect how unmodified and modified amino acids are grouped relatively to each other in the embedding vector space by the network. To explore it, we evaluated the agglomerative clustering of amino acid features as shown in <xref rid="btad486-F4" ref-type="fig">Fig. 4</xref>. Outgroups are formed by the phosphorylated amino acids Y, S, and T, acetylated N-termini and lastly the three positively charged amino acids H, K, R, and cysteinylated C. The inner clusters roughly fall into aliphatic or aromatic as well as hydrophilic or hydrophobic groups. Even though the network was not presented with any chemical or physical descriptors of the individual amino acids, information about them is learned from the relationship between sequences, charges, and the resulting CCS values.</p>
        <fig position="float" id="btad486-F4">
          <label>Figure 4.</label>
          <caption>
            <p>Agglomerative clustering of amino acid and modification embedding vectors. Outgroups are formed by phosphorylated, acetylated and positively charged amino acids. Inner groups are roughly divided between aliphatic and aromatic as well as hydrophilic and hydrophobic amino acids</p>
          </caption>
          <graphic xlink:href="btad486f4" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>4.4.2 Correlation of deep residues with additive scalar descriptors of peptide sequences</title>
        <p>Besides evaluating the individual relationships between amino acids in the embedding space, we also explored the linear relationships between sequence-wise predicted deep residues and additive scalar properties that can be directly calculated from amino acid sequences. A recent study, <xref rid="btad486-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> (2021)</xref> identified that increased hydropathy contributed to a higher CCS values, which we could observe as well. Additionally, we observed that local flexibility increases the overall relative CCS value of a given sequence as well. Those correlations are only moderate (0.55 and 0.53, respectively) but are in congruence with the relative grouping of individual amino acids in the embedding space of the predictor (see <xref rid="btad486-F4" ref-type="fig">Fig. 4</xref>). All calculated Pearson correlations are visualized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>.</p>
      </sec>
      <sec>
        <title>4.4.3 Impact of phosphorylation on collisional cross-section predictions</title>
        <p>In a recent study, <xref rid="btad486-B25" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic> (2021)</xref> confirmed on a large scale that phosphorylation of peptides often leads to a more compact configuration of the ion in the gas phase, thereby lowering observed CCS values for modified peptide sequences compared with the unmodified version of these sequences. This effect outweighs the increase in peptide mass induced by such a modification (<xref rid="btad486-B25" ref-type="bibr">Ogata <italic toggle="yes">et al.</italic> 2021</xref>). Our analyses reproduced this finding for our in-house generated datasets and, consequently, this effect can also be observed when looking at synthetic predictions. We evaluated this by analyzing predicted CCS values for synthetically phosphorylated sequences with one phosphorylation site added at random compared with the unmodified sequence. We calculated the pairwise median relative percent decrease in predicted CCS of synthetically modified peptides compared with unmodified peptides per charge, which were 2.08, 2.85, and 3.86 for the charge states 2, 3, and 4, respectively (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). The integration of <italic toggle="yes">in-silico</italic> predicted CCS for phosphorylated peptides into identification workflows might therefore be an excellent opportunity to be specifically integrated, which is already under commercial development (<ext-link xlink:href="http://www.bruker.com/ru/news-and-events/news/2022/bruker-releases-ccs-enabled-timscore.html" ext-link-type="uri">www.bruker.com/ru/news-and-events/news/2022/bruker-releases-ccs-enabled-timscore.html</ext-link>, accessed: 12.07.2022).</p>
        <p>In summary, the GRU model implemented in ionmob not only enables the prediction of peptide CCS values from tryptic, nontryptic and modified peptides but also allows the evaluation of feature-specific contributions at the amino acid, sequence, and PTM levels.</p>
      </sec>
    </sec>
    <sec>
      <title>4.5 Raw-data mobility distributions</title>
      <p>To establish prediction tools, one highly relevant question is whether or not the ion-mobility signal distribution should be taken into account when predicting CCS values. So far, all approaches including our own were implemented as maximum likelihood estimators. The simplification allows for a more straightforward formulation of the mobility modeling task. However, following this approach might be disadvantageous if the underlying assumption that signal distribution displays a single maximum does not hold. Notably, we and others observed that single peptide sequences can sometimes have multiple conformations in the gas-phase (<xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> 2021a</xref>). This in turn then results in a multi-modal distribution of ion mobility and an observable split of the ion clouds for charge state 3 and 4 (see <xref rid="btad486-F5" ref-type="fig">Fig. 5</xref>).</p>
      <fig position="float" id="btad486-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Marginal distributions of intensity along the ion-mobility dimension of peptide features, recorded with a timsTOF instrument. Left: Intensity distribution along the scan dimension (blue) for a uni-modal peptide feature, reported CCS is calculated from apex value (black). Right: intensity distribution for a multi-modal peptide. MaxQuant reported this peptide twice at the same retention time with differing scan indices (orange, red). Raw data extracted using <monospace>opentims</monospace><xref rid="btad486-B7" ref-type="bibr">Łącki <italic toggle="yes">et al.</italic> (2021)</xref>. <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> was converted to CCS using the Mason–Schamp equation</p>
        </caption>
        <graphic xlink:href="btad486f5" position="float"/>
      </fig>
      <p>Similar to the approach described by <xref rid="btad486-B23" ref-type="bibr">Meier <italic toggle="yes">et al.</italic> (2021a)</xref>, we dealt with multi-modality of peptide collisional cross sections by first identifying and then removing all occurrences except the one with highest abundance. For a maximum likelihood estimation strategy, which will otherwise converge to their mean value, this is a necessary step. This strategy can be justified by the overall low number of multi-modal peptides, here ≈3%–5%. However, it obviously removes potentially valuable information and one should therefore try to derive driving factors of multi-modality. If identified, they could in turn be used to decide for a given prediction instance <italic toggle="yes">a priori</italic> if it might be necessary to predict more than one CCS value. Due to the relatively low number of candidates and potential stochastic processes driving multi-modality, we consider this to be an open challenge for future investigations (<xref rid="btad486-T1" ref-type="table">Table 1</xref>).</p>
      <table-wrap position="float" id="btad486-T1">
        <label>Table 1.</label>
        <caption>
          <p>Number of PSMs and unique identified peptides in terms of sequence for 1% for rescoring with or without CCS features.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th rowspan="1" colspan="1">PSMs</th>
              <th rowspan="1" colspan="1">unique peptides</th>
              <th rowspan="1" colspan="1">CCS features</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="2" colspan="1">Tryptic</td>
              <td rowspan="1" colspan="1">60 850</td>
              <td rowspan="1" colspan="1">2901</td>
              <td rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">60 850</td>
              <td rowspan="1" colspan="1">2882</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">Phospho</td>
              <td rowspan="1" colspan="1">224 109</td>
              <td rowspan="1" colspan="1">29 046</td>
              <td rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">223 595</td>
              <td rowspan="1" colspan="1">28 928</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">MHC ligands</td>
              <td rowspan="1" colspan="1">392 092</td>
              <td rowspan="1" colspan="1">20 232</td>
              <td rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">389 113</td>
              <td rowspan="1" colspan="1">20 130</td>
              <td rowspan="1" colspan="1">−</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>4.6 Impact of collisional cross-section features in peptide-spectrum match rescoring</title>
      <p>Using CCS predictions as an additional feature set in rescoring of database search results can provide increased performance to further separate true from false targets and gain confidence in the identified PSMs. To evaluate the value of CCS prediction for identification rescoring, we incorporated the ionmob models to the features used by MS<sup>2</sup>Rescore (<xref rid="btad486-B10" ref-type="bibr">Declercq <italic toggle="yes">et al.</italic> 2022</xref>) for the evaluation of true positive identifications. Rescoring including CCS features shows similar results for all three datasets, tryptic, phosphorylated, and MHC ligands (including singly charged), with a small increase in total number of identified PSMs and peptides, with the biggest increases seen for the MHC ligand dataset (<xref rid="btad486-T1" ref-type="table">Table 1</xref>). When investigating this dataset more closely, we found that 38.4% of the PSMs identified with CCS features that were not identified without these features are singly charged. Furthermore, all of these had a very low percentual CCS error, in contrast to singly charged PSMs that previously were identified and now not anymore due to the CCS features, where a lot of outliers are seen (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Moreover, this trend was also seen in the other datasets where peptidoforms that were removed in comparison with rescoring without CCS features had higher errors. Even though the total number of identifications does not increase spectacularly, the feature weights show that they are indeed used by percolator when rescoring PSMs (<xref rid="btad486-B5" ref-type="bibr">Chang and Lin 2008</xref>). It demonstrates the value of using these features when rescoring PSMs, especially for the immunopeptidomics dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). CCS features offer valuable information alongside peak intensity and retention time features allowing the rescore algorithm to select the best features for separating true from false targets for each database specifically. This filtering capability can be highly valuable for immunopeptidomics, where a high certainty level of identification is required to select the best targets for vaccines and immunotherapies.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>We implemented ionmob, a framework for preprocessing, training and inferring peptide CCS values. ionmob includes a novel network architecture that combines a simple function fit with gated recurrent units, helping to stabilize and speed up training and make model outputs easier to interpret. By including phosphorylated peptides and MHC ligands also covering singly charged ions into the training set, we extend the applicability of our model, enabling the accurate prediction of a wider variety of PTMs than recently published models. Furthermore, our results suggest that local flexibility of peptides is an additional driving factor of increased CCS and confirm recently published findings that phosphorylation lowers CCS, which could be indicative of charge interaction-based compaction in the gas phase. Lastly, we demonstrate that <italic toggle="yes">in silico</italic> predicted CCS values can be used to increase confidence in peptide identifications by applying methods of rescoring. In summary, <monospace>ionmob</monospace> is an easily deployable package for the training and incorporation of peptide CCS prediction.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad486_Supplementary_Data</label>
      <media xlink:href="btad486_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors would like to thank Robbin Bouwmeester and Ralf Gabriels for fruitful discussions regarding applications of predicted CCS values to peptide re-scoring. The authors acknowledge Christina Jung, Claudia Darmstadt, and Lucas Kleinort for their technical assistance on sample and instrument preparation for LC-IMS-MS analyses.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Bundesministerium für Bildung und Forschung (BMBF) as part of the National Research Node “Mass spectrometry in Systems Medicine” (MSCoreSys) [031L0217A/B to A.H., S.T., D.T., and D.G.-Z.]; the Research Foundation Flanders (FWO) [1SE3722 to A.D., G028821N to L.M.]; the European Union’s Horizon 2020 Programme (H2020-INFRAIA-2018-1) [823839 to L.M.]; Ghent University Concerted Research Action [BOF21/GOA/033 to L.M.].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All generated training, validation, and test datasets as well as all notebooks created during the experiments presented in this study have been deposited and made publicly available via Zenodo: <ext-link xlink:href="https://zenodo.org/record/7516255" ext-link-type="uri">https://zenodo.org/record/7516255</ext-link>. The mass spectrometry immunopeptidomics data have been deposited to the ProteomeXchange Consortium (<xref rid="btad486-B38" ref-type="bibr">Vizcaíno <italic toggle="yes">et al.</italic> 2014</xref>) via the jPOSTrepo partner repository (<xref rid="btad486-B26" ref-type="bibr">Okuda <italic toggle="yes">et al.</italic> 2017</xref>) with the dataset identifiers PXD043026 for ProteomeXchange and JPST002158 for jPOSTrepo.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad486-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Abadi</surname><given-names>M</given-names></string-name>, <string-name><surname>Agarwal</surname><given-names>A</given-names></string-name>, <string-name><surname>Barham</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal> Tensorflow: large-scale machine learning on heterogeneous distributed systems. <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="btad486-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brunner</surname><given-names>A</given-names></string-name>, <string-name><surname>Thielert</surname><given-names>M</given-names></string-name>, <string-name><surname>Vasilopoulou</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Ultra‐high sensitivity mass spectrometry quantifies single‐cell proteome changes upon perturbation</article-title>. <source>Mol Syst Biol</source><year>2022</year>;<volume>18</volume>:<fpage>e10798</fpage>.<pub-id pub-id-type="pmid">35226415</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bush</surname><given-names>MF</given-names></string-name>, <string-name><surname>Campuzano</surname><given-names>IDG</given-names></string-name>, <string-name><surname>Robinson</surname><given-names>CV.</given-names></string-name></person-group><article-title>Ion mobility mass spectrometry of peptide ions: effects of drift gas and calibration strategies</article-title>. <source>Anal Chem</source><year>2012</year>;<volume>84</volume>:<fpage>7124</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">22845859</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>CH</given-names></string-name>, <string-name><surname>Yeung</surname><given-names>D</given-names></string-name>, <string-name><surname>Spicer</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Sequence-specific model for predicting peptide collision cross section values in proteomic ion mobility spectrometry</article-title>. <source>J Proteome Re</source><year>2021</year>;<volume>20</volume>:<fpage>3600</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>Y-W</given-names></string-name>, <string-name><surname>Lin</surname><given-names>C-J.</given-names></string-name></person-group> Feature ranking using linear svm. In: Guyon I, Aliferis C, Cooper G, Elisseeff A, Pellet J-P, Spirtes P, and Statnikov A (eds.), <italic toggle="yes">Proceedings of the Workshop on the Causation and Prediction Challenge at WCCI 2008</italic>, volume 3 of <italic toggle="yes">Proceedings of Machine Learning Research</italic>, <fpage>53</fpage>–<lpage>64</lpage>. Hong Kong: PMLR, <year>2008</year>.</mixed-citation>
    </ref>
    <ref id="btad486-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chung</surname><given-names>J</given-names></string-name>, <string-name><surname>Gulcehre</surname><given-names>C</given-names></string-name>, <string-name><surname>Cho</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal> Empirical evaluation of gated recurrent neural networks on sequence modeling. arXiv, arXiv:1412.3555 [cs], <year>2014</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad486-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Łącki</surname><given-names>MK</given-names></string-name>, <string-name><surname>Startek</surname><given-names>MP</given-names></string-name>, <string-name><surname>Brehmer</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>OpenTIMS, TimsPY, and TimsR: open and easy access to timsTOF raw data</article-title>. <source>J Proteome Res</source><year>2021</year>;<volume>20</volume>:<fpage>2122</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">33724840</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cox</surname><given-names>J</given-names></string-name>, <string-name><surname>Mann</surname><given-names>M.</given-names></string-name></person-group><article-title>MaxQuant enables high peptide identification rates, individualized p.p.b.-range mass accuracies and proteome-wide protein quantification</article-title>. <source>Nat Biotechnol</source><year>2008</year>;<volume>26</volume>:<fpage>1367</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">19029910</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Carvalho</surname><given-names>RV</given-names></string-name>, <string-name><surname>Lopez-Ferrer</surname><given-names>D</given-names></string-name>, <string-name><surname>Guimarães</surname><given-names>KS</given-names></string-name></person-group><etal>et al</etal><article-title>Imspeptider: a computational peptide collision cross-section area calculator based on a novel molecular dynamics simulation protocol</article-title>. <source>J Comput Chem</source><year>2013</year>;<volume>34</volume>:<fpage>1707</fpage>–<lpage>18</lpage>.<pub-id pub-id-type="pmid">23609240</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Declercq</surname><given-names>A</given-names></string-name>, <string-name><surname>Bouwmeester</surname><given-names>R</given-names></string-name>, <string-name><surname>Hirschler</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>MS2Rescore: data-driven rescoring dramatically boosts immunopeptide identification rates</article-title>. <source>Mol Cell Proteomics</source><year>2022</year>;<volume>21</volume>:<fpage>100266</fpage>.<pub-id pub-id-type="pmid">35803561</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dodds</surname><given-names>JN</given-names></string-name>, <string-name><surname>Baker</surname><given-names>ES.</given-names></string-name></person-group><article-title>Ion mobility spectrometry: fundamental concepts, instrumentation, applications, and the road ahead</article-title>. <source>J Am Soc Mass Spectrom</source><year>2019</year>;<volume>30</volume>:<fpage>2185</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">31493234</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Feola</surname><given-names>S</given-names></string-name>, <string-name><surname>Chiaro</surname><given-names>J</given-names></string-name>, <string-name><surname>Martins</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>A novel immunopeptidomic-based pipeline for the generation of personalized oncolytic cancer vaccines</article-title>. <source>eLife</source><year>2022</year>;<volume>11</volume>:<fpage>e71156</fpage>.<pub-id pub-id-type="pmid">35314027</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gabelica</surname><given-names>V</given-names></string-name>, <string-name><surname>Marklund</surname><given-names>E.</given-names></string-name></person-group><article-title>Fundamentals of ion mobility spectrometry</article-title>. <source>Curr Opin Chem Biol</source><year>2018</year>;<volume>42</volume>:<fpage>51</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29154177</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gabelica</surname><given-names>V</given-names></string-name>, <string-name><surname>Shvartsburg</surname><given-names>AA</given-names></string-name>, <string-name><surname>Afonso</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Recommendations for reporting ion mobility mass spectrometry measurements</article-title>. <source>Mass Spectrom Rev</source><year>2019</year>;<volume>38</volume>:<fpage>291</fpage>–<lpage>320</lpage>.<pub-id pub-id-type="pmid">30707468</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gessulat</surname><given-names>S</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>T</given-names></string-name>, <string-name><surname>Zolg</surname><given-names>DP</given-names></string-name></person-group><etal>et al</etal><article-title>Prosit: proteome-wide prediction of peptide tandem mass spectra by deep learning</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>509</fpage>–<lpage>18</lpage>.<pub-id pub-id-type="pmid">31133760</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gomez-Zepeda</surname><given-names>D</given-names></string-name>, <string-name><surname>Arnold-Schild</surname><given-names>D</given-names></string-name>, <string-name><surname>Beyrle</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal> Thunder-DDA-PASEF enables high-coverage immunopeptidomics and identifies HLA class-I presented SarsCov-2 spike protein epitopes. <year>2023</year>.</mixed-citation>
    </ref>
    <ref id="btad486-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henderson</surname><given-names>SC</given-names></string-name>, <string-name><surname>Li</surname><given-names>J</given-names></string-name>, <string-name><surname>Counterman</surname><given-names>AE</given-names></string-name></person-group><etal>et al</etal><article-title>Intrinsic size parameters for val, ile, leu, gln, thr, phe, and trp residues from ion mobility measurements of polyamino acid ions</article-title>. <source>J Phys Chem B</source><year>1999</year>;<volume>103</volume>:<fpage>8780</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kaszycki</surname><given-names>JL</given-names></string-name>, <string-name><surname>Shvartsburg</surname><given-names>AA.</given-names></string-name></person-group><article-title>A priori intrinsic ptm size parameters for predicting the ion mobilities of modified peptides</article-title>. <source>J Am Soc Mass Spectrom</source><year>2017</year>;<volume>28</volume>:<fpage>294</fpage>–<lpage>302</lpage>.<pub-id pub-id-type="pmid">27975328</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kondalaji</surname><given-names>SG</given-names></string-name>, <string-name><surname>Khakinejad</surname><given-names>M</given-names></string-name>, <string-name><surname>Tafreshian</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Comprehensive peptide ion structure studies using ion mobility techniques: part 1. An advanced protocol for molecular dynamics simulations and collision cross section calculation</article-title>. <source>J Am Soc Mass Spectrom</source><year>2017</year>;<volume>28</volume>:<fpage>947</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">28211014</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>C</given-names></string-name>, <string-name><surname>Ren</surname><given-names>Y</given-names></string-name>, <string-name><surname>Yang</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Improved peptide retention time prediction in liquid chromatography through deep learning</article-title>. <source>Anal Chem</source><year>2018</year>;<volume>90</volume>:<fpage>10881</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30114359</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meier</surname><given-names>F</given-names></string-name>, <string-name><surname>Beck</surname><given-names>S</given-names></string-name>, <string-name><surname>Grassl</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Parallel accumulation–serial fragmentation (PASEF): multiplying sequencing speed and sensitivity by synchronized scans in a trapped ion mobility device</article-title>. <source>J Proteome Res</source><year>2015</year>;<volume>14</volume>:<fpage>5378</fpage>–<lpage>87</lpage>.<pub-id pub-id-type="pmid">26538118</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meier</surname><given-names>F</given-names></string-name>, <string-name><surname>Brunner</surname><given-names>A-D</given-names></string-name>, <string-name><surname>Koch</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Online parallel accumulation–serial fragmentation (PASEF) with a novel trapped ion mobility mass spectrometer</article-title>. <source>Mol Cell Proteomics</source><year>2018</year>;<volume>17</volume>:<fpage>2534</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">30385480</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meier</surname><given-names>F</given-names></string-name>, <string-name><surname>Köhler</surname><given-names>ND</given-names></string-name>, <string-name><surname>Brunner</surname><given-names>AD</given-names></string-name></person-group><etal>et al</etal><article-title>Deep learning the collisional cross sections of the peptide universe from a million experimental values</article-title>. <source>Nat Commun</source><year>2021a</year>;<volume>12</volume>:<fpage>1185</fpage>.<pub-id pub-id-type="pmid">33608539</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meier</surname><given-names>F</given-names></string-name>, <string-name><surname>Park</surname><given-names>MA</given-names></string-name>, <string-name><surname>Mann</surname><given-names>M.</given-names></string-name></person-group><article-title>Trapped ion mobility spectrometry and parallel accumulation–serial fragmentation in proteomics</article-title>. <source>Mol Cell Proteomics</source><year>2021b</year>;<volume>20</volume>:<fpage>100138</fpage>.<pub-id pub-id-type="pmid">34416385</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ogata</surname><given-names>K</given-names></string-name>, <string-name><surname>Chang</surname><given-names>C-H</given-names></string-name>, <string-name><surname>Ishihama</surname><given-names>Y.</given-names></string-name></person-group><article-title>Effect of phosphorylation on the collision cross sections of peptide ions in ion mobility spectrometry</article-title>. <source>Mass Spectrom</source><year>2021</year>;<volume>10</volume>:<fpage>A0093</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Okuda</surname><given-names>S</given-names></string-name>, <string-name><surname>Watanabe</surname><given-names>Y</given-names></string-name>, <string-name><surname>Moriya</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>jPOSTrepo: an international standard data repository for proteomes</article-title>. <source>Nucleic Acids Res</source><year>2017</year>;<volume>45</volume>:<fpage>D1107</fpage>–<lpage>D1111</lpage>.<pub-id pub-id-type="pmid">27899654</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Scikit-learn: machine learning in Python</article-title>. <source>Journal of Machine Learning Research</source><year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Prianichnikov</surname><given-names>N</given-names></string-name>, <string-name><surname>Koch</surname><given-names>H</given-names></string-name>, <string-name><surname>Koch</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>MaxQuant software for ion mobility enhanced shotgun proteomics</article-title>. <source>Mol Cell Proteomics</source><year>2020</year>;<volume>19</volume>:<fpage>1058</fpage>–<lpage>69</lpage>.<pub-id pub-id-type="pmid">32156793</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Purcell</surname><given-names>AW</given-names></string-name>, <string-name><surname>Ramarathinam</surname><given-names>SH</given-names></string-name>, <string-name><surname>Ternette</surname><given-names>N.</given-names></string-name></person-group><article-title>Mass spectrometry–based identification of MHC-bound peptides for immunopeptidomics</article-title>. <source>Nat Protoc</source><year>2019</year>;<volume>14</volume>:<fpage>1687</fpage>–<lpage>707</lpage>.<pub-id pub-id-type="pmid">31092913</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Revercomb</surname><given-names>HE</given-names></string-name>, <string-name><surname>Mason</surname><given-names>EA.</given-names></string-name></person-group><article-title>Theory of plasma chromatography/gaseous electrophoresis. review</article-title>. <source>Anal Chem</source><year>1975</year>;<volume>47</volume>:<fpage>970</fpage>–<lpage>83</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Samukhina</surname><given-names>YV</given-names></string-name>, <string-name><surname>Matyushin</surname><given-names>DD</given-names></string-name>, <string-name><surname>Grinevich</surname><given-names>OI</given-names></string-name></person-group><etal>et al</etal><article-title>A deep convolutional neural network for prediction of peptide collision cross sections in ion mobility spectrometry</article-title>. <source>Biomolecules</source><year>2021</year>;<volume>11</volume>:<fpage>1904</fpage>.<pub-id pub-id-type="pmid">34944547</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sinitcyn</surname><given-names>P</given-names></string-name>, <string-name><surname>Hamzeiy</surname><given-names>H</given-names></string-name>, <string-name><surname>Salinas Soto</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>MaxDIA enables library-based and library-free data-independent acquisition proteomics</article-title>. <source>Nat Biotechnol</source><year>2021</year>;<volume>39</volume>:<fpage>1563</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">34239088</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>The</surname><given-names>M</given-names></string-name>, <string-name><surname>MacCoss</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Noble</surname><given-names>WS</given-names></string-name></person-group><etal>et al</etal><article-title>Fast and accurate protein false discovery rates on large-scale proteomics data sets with percolator 3.0</article-title>. <source>J Am Soc Mass Spectrom</source><year>2016</year>;<volume>27</volume>:<fpage>1719</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">27572102</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Valentine</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Ewing</surname><given-names>MA</given-names></string-name>, <string-name><surname>Dilger</surname><given-names>JM</given-names></string-name></person-group><etal>et al</etal><article-title>Using ion mobility data to improve peptide identification: intrinsic amino acid size parameters</article-title>. <source>J Proteome Res</source><year>2011</year>;<volume>10</volume>:<fpage>2318</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">21417239</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Valentine</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Plasencia</surname><given-names>MD</given-names></string-name></person-group><etal>et al</etal><article-title>Developing liquid chromatography ion mobility mass spectometry techniques</article-title>. <source>Expert Rev Proteomics</source><year>2005</year>;<volume>2</volume>:<fpage>553</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">16097888</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Villatoro</surname><given-names>J</given-names></string-name>, <string-name><surname>Weber</surname><given-names>M</given-names></string-name>, <string-name><surname>Zühlke</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Structural characterization of synthetic peptides using electronspray ion mobility spectrometry and molecular dynamics simulations</article-title>. <source>Int J Mass Spectrom</source><year>2019</year>;<volume>436</volume>:<fpage>108</fpage>–<lpage>17</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Virtanen</surname><given-names>P</given-names></string-name>, <string-name><surname>Gommers</surname><given-names>R</given-names></string-name>, <string-name><surname>Oliphant</surname><given-names>TE</given-names></string-name></person-group><etal>et al</etal>; <collab>SciPy 1.0 Contributors</collab>. <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source>Nat Methods</source><year>2020</year>;<volume>17</volume>:<fpage>261</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">32015543</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vizcaíno</surname><given-names>JA</given-names></string-name>, <string-name><surname>Deutsch</surname><given-names>EW</given-names></string-name>, <string-name><surname>Wang</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>ProteomeXchange provides globally coordinated proteomics data submission and dissemination</article-title>. <source>Nat Biotechnol</source><year>2014</year>;<volume>32</volume>:<fpage>223</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">24727771</pub-id></mixed-citation>
    </ref>
    <ref id="btad486-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>B</given-names></string-name>, <string-name><surname>Valentine</surname><given-names>S</given-names></string-name>, <string-name><surname>Raghuraman</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Prediction of peptide drift time in ion mobility-mass spectrometry</article-title>. <source>BMC Bioinform</source><year>2009</year>;<volume>10</volume>(Suppl. 7):<fpage>A1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>B</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Chen</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Prediction of peptide drift time in ion mobility mass spectrometry from sequence-based features</article-title>. <source>BMC Bioinform</source><year>2013</year>;<volume>14</volume>(Suppl. 4):<fpage>S1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad486-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>W-F</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>X-X</given-names></string-name>, <string-name><surname>Willems</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>AlphaPeptDeep: a modular deep learning framework to predict peptide properties for proteomics</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>7238</fpage>.<pub-id pub-id-type="pmid">36433986</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
