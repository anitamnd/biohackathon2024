<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6853707</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz436</article-id>
    <article-id pub-id-type="publisher-id">btz436</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>snakePipes: facilitating flexible, scalable and integrative epigenomic analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bhardwaj</surname>
          <given-names>Vivek</given-names>
        </name>
        <xref ref-type="aff" rid="btz436-aff1">1</xref>
        <xref ref-type="aff" rid="btz436-aff2">2</xref>
        <xref ref-type="author-notes" rid="btz436-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Heyne</surname>
          <given-names>Steffen</given-names>
        </name>
        <xref ref-type="aff" rid="btz436-aff1">1</xref>
        <xref ref-type="author-notes" rid="btz436-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sikora</surname>
          <given-names>Katarzyna</given-names>
        </name>
        <xref ref-type="aff" rid="btz436-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rabbani</surname>
          <given-names>Leily</given-names>
        </name>
        <xref ref-type="aff" rid="btz436-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rauer</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="btz436-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kilpert</surname>
          <given-names>Fabian</given-names>
        </name>
        <xref ref-type="aff" rid="btz436-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Richter</surname>
          <given-names>Andreas S</given-names>
        </name>
        <xref ref-type="aff" rid="btz436-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ryan</surname>
          <given-names>Devon P</given-names>
        </name>
        <xref ref-type="aff" rid="btz436-aff1">1</xref>
        <xref ref-type="corresp" rid="btz436-cor1"/>
        <!--<email>ryan@ie-freiburg.mpg.de</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Manke</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="btz436-aff1">1</xref>
        <xref ref-type="corresp" rid="btz436-cor1"/>
        <!--<email>manke@ie-freiburg.mpg.de</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btz436-aff1"><label>1</label><institution>Max Planck Institute of Immunobiology and Epigenetics</institution>, 79108 Freiburg, Germany</aff>
    <aff id="btz436-aff2"><label>2</label><institution>Faculty of Biology, University of Freiburg</institution>, 79104 Freiburg, Germany</aff>
    <aff id="btz436-aff3"><label>3</label><institution>Institutes of Neurogenetics &amp; Cardiogenetics, University of Lübeck</institution>, 23562 Lübeck, Germany</aff>
    <aff id="btz436-aff4"><label>4</label><institution>Genedata AG</institution>, 4053 Basel, Switzerland</aff>
    <author-notes>
      <corresp id="btz436-cor1">To whom correspondence should be addressed. E-mail: <email>ryan@ie-freiburg.mpg.de</email> or <email>manke@ie-freiburg.mpg.de</email></corresp>
      <fn id="btz436-FM1">
        <p>The authors wish it to be known Vivek Bhardwaj and Steffen Heyne contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-05-27">
      <day>27</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>22</issue>
    <fpage>4757</fpage>
    <lpage>4759</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>5</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz436.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Due to the rapidly increasing scale and diversity of epigenomic data, modular and scalable analysis workflows are of wide interest. Here we present snakePipes, a workflow package for processing and downstream analysis of data from common epigenomic assays: ChIP-seq, RNA-seq, Bisulfite-seq, ATAC-seq, Hi-C and single-cell RNA-seq. snakePipes enables users to assemble variants of each workflow and to easily install and upgrade the underlying tools, via its simple command-line wrappers and yaml files.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>snakePipes can be installed via conda: `conda install -c mpi-ie -c bioconda -c conda-forge snakePipes’. Source code (<ext-link ext-link-type="uri" xlink:href="https://github.com/maxplanck-ie/snakepipes">https://github.com/maxplanck-ie/snakepipes</ext-link>) and documentation (<ext-link ext-link-type="uri" xlink:href="https://snakepipes.readthedocs.io/en/latest/">https://snakepipes.readthedocs.io/en/latest/</ext-link>) are available online.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">German Science Foundation</named-content>
        </funding-source>
        <award-id>CRC992</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The decreasing price of sequencing and increasing multiplexing ability has allowed researcher to easily produce large datasets. To understand genetic and epigenetic regulation, researchers routinely perform multiple assays, such as RNA-seq and Bisulfite-seq in the same project, necessitating scalable data processing workflows. Since exploratory studies demand more flexibility in data processing, and standards evolve rapidly, conventional rigid pipelines become quickly outdated. Computational frameworks, such as Galaxy (<xref rid="btz436-B8" ref-type="bibr">Goecks <italic>et al.</italic>, 2010</xref>), Nextflow (<xref rid="btz436-B4" ref-type="bibr">Di Tommaso <italic>et al.</italic>, 2017</xref>) and snakemake (<xref rid="btz436-B11" ref-type="bibr">Köster and Rahmann, 2012</xref>) address this issue to some extent by allowing users to create their own workflows, or adopt workflows from public repositories. However, these frameworks are still challenging for novice users, as they require training in their specific programing language or syntax and assembling workflows themselves. This leads to a conundrum, how can we offer the flexibility of assembling and upgrading analyses workflows to the novice users, while still keeping them scalable and reproducible?</p>
    <p>We developed snakePipes to address this issue. snakePipes provides a set of best-practices workflows for processing, quality control and downstream analysis of data from the most common assays used in epigenomic studies: ChIP-seq, RNA-seq, whole-genome bisulfite-seq (WGBS), ATAC-seq, Hi-C and single-cell RNA-seq (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1a</xref>; <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>). However, unlike conventional pipelines, workflows in snakePipes are based on a repository of modular rules, such that multiple variations of each workflow can be assembled on-the-fly by changing the parameters on their command-line wrappers. This novel approach allows novice users to perform exploratory analysis in a reproducible way without manually assembling workflows.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>snakePipes employs snakemake (<xref rid="btz436-B11" ref-type="bibr">Köster and Rahmann, 2012</xref>) as its core workflow language, which benefits from easy readability of the code, widespread adoption and scalability to most clusters and cloud platforms. snakePipes also makes use of conda environments and the bioconda platform (<xref rid="btz436-B9" ref-type="bibr">Grüning <italic>et al.</italic>, 2018</xref>), which allows hassle-free installation and upgrade of known-compatible and known-functional tools (<xref ref-type="fig" rid="btz436-F1">Fig. 1a;</xref><xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>). Conda environments alleviate the need to manually manage tools or have administrator permissions.
</p>
    <fig id="btz436-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Setup, execution and results from snakePipes. (<bold>a</bold>) All configurable parameters for snakepipes are defined as YAML files during setup. However, most parameters can be overwritten during execution by providing another YAML file, adding flexibility to the analysis. (<bold>b</bold>) Output of HiC (track 1), WGBS (track 2), ATAC-seq (track 3), allele-specific ChIP-seq (tracks 3–7) and RNA-seq (tracks 8–9) workflows, plotted using pyGenomeTracks (<xref rid="btz436-B14" ref-type="bibr">Ramírez <italic>et al.</italic>, 2018</xref>)</p>
      </caption>
      <graphic xlink:href="btz436f1"/>
    </fig>
    <p>snakePipes’ modular architecture allows various tools and resources to be shared between workflows, simplifying data integration since data from multiple assays are processed using identical tool versions. Genome annotations and indices are shared by all workflows, and can also be generated directly via snakePipes, facilitating easy setup as well as integrative analysis. Finally, all workflows in snakePipes calculate extensive quality control metrics and produce reports using multiQC (<xref rid="btz436-B5" ref-type="bibr">Ewels <italic>et al.</italic>, 2016</xref>) and R, that inform the user of processing and analysis results.</p>
    <p>Apart from conventional processing steps such as mapping and peak calling, workflows in snakePipes also include various downstream analyses. All workflows (except scRNA-seq workflow) optionally accept a sample information (tab-separated) file that can be used to define groups of sample. This allows comparative analysis, such as differential expression (RNA-seq), differential peak calling (ChIP-Seq), differential accessibility (ATAC-seq) and differential methylation (WGBS). Complex design formulas are supported using additional columns of the sample sheet. The HiC workflow uses sample information to merge groups and can perform TAD calling with parameters adapted to the resolution of the produced matrix [using HiCExplorer (<xref rid="btz436-B14" ref-type="bibr">Ramírez <italic>et al.</italic>, 2018</xref>)]. Most workflows also allow allele-specific processing of data via SNPSplit (<xref rid="btz436-B12" ref-type="bibr">Krueger and Andrews, 2016</xref>) where a single or dual-hybrid genome can be created on-the-fly using the ‘allelic-mapping’ mode and a Variant Call Format file (<xref rid="btz436-B3" ref-type="bibr">Danecek <italic>et al.</italic>, 2011</xref>). Further downstream analysis, such as allele-specific differential expression can be performed automatically. This preliminary analysis, combined with visualization-ready BED and bigWig files, allows users to quickly interpret their data (<xref ref-type="fig" rid="btz436-F1">Fig. 1b</xref>). Our comparison with other recently released workflows and pipelines suggests that snakePipes offers the most extensive processing and analysis options under a single package. Further, it compares equally well to the other available alternatives in terms of installation, ease of use and scalability (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>).</p>
  </sec>
  <sec>
    <title>3 Application</title>
    <p>To demonstrate how snakePipes can simplify analysis of data from multiple epigenomic assays, we processed data from a study of the mammalian X-chromosome (<xref rid="btz436-B17" ref-type="bibr">Wang <italic>et al.</italic>, 2018</xref>). The knock-out of Smchd1 in mouse neural progenitor cells affects the X-chromosome organization and leads to a loss of H3K27me3 domains, gain of H3K4me3, along with de-repression of genes on the inactive X-chromosome. These changes are apparent directly from the snakePipes output (<xref ref-type="fig" rid="btz436-F1">Fig. 1b;</xref><xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1b</xref> and c). We further combined these results with those obtained from online ATAC-seq (<xref rid="btz436-B7" ref-type="bibr">Giorgetti <italic>et al.</italic>, 2016</xref>) and WGBS data (GSE101090) processed via snakePipes, and find that these de-repressed genes have a higher open chromatin signature compared to the downregulated or unchanged genes (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1d</xref>). These genes also show a methylation status similar to the downregulated but lower than unchanged genes (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1e</xref>), corroborating previous (<xref rid="btz436-B16" ref-type="bibr">Schübeler, 2015</xref>) and recent (<xref rid="btz436-B13" ref-type="bibr">Lea <italic>et al.</italic>, 2018</xref>) links between promoter CpG methylation and gene repression.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>In summary, snakePipes simplifies the analysis of large-scale epigenomic studies by allowing fast and reproducible processing of data from several assays. While further downstream analysis would still be required to integrate the results depending upon biological questions, snakePipes’ outputs allow biologists to quickly interpret and understand their results, facilitating integrative analysis.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz436_Supplementary_Data</label>
      <media xlink:href="btz436_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Gina Renschler and Jana Böhm for testing workflows and Chen-Yu Wang for useful comments on our preprint.</p>
    <sec>
      <title>Funding</title>
      <p>L.R. and T.M. acknowledge funding from the German Science Foundation [CRC992 ‘Medical Epigenetics’].</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz436-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Danecek</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>2156</fpage>–<lpage>2158</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="btz436-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Di Tommaso</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat. Biotechnol</source>., <volume>35</volume>, <fpage>316</fpage>–<lpage>319</lpage>.<pub-id pub-id-type="pmid">28398311</pub-id></mixed-citation>
    </ref>
    <ref id="btz436-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ewels</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>MultiQC: summarize analysis results for multiple tools and samples in a single report</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>3047</fpage>–<lpage>3048</lpage>.<pub-id pub-id-type="pmid">27312411</pub-id></mixed-citation>
    </ref>
    <ref id="btz436-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Giorgetti</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Structural organization of the inactive X chromosome in the mouse</article-title>. <source>Nature</source>, <volume>535</volume>, <fpage>575</fpage>–<lpage>579</lpage>.<pub-id pub-id-type="pmid">27437574</pub-id></mixed-citation>
    </ref>
    <ref id="btz436-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goecks</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences</article-title>. <source>Genome Biol</source>., <volume>11</volume>, <fpage>R86.</fpage><pub-id pub-id-type="pmid">20738864</pub-id></mixed-citation>
    </ref>
    <ref id="btz436-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grüning</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>475</fpage>–<lpage>476</lpage>.<pub-id pub-id-type="pmid">29967506</pub-id></mixed-citation>
    </ref>
    <ref id="btz436-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Köster</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Rahmann</surname><given-names>S.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Snakemake–a scalable bioinformatics workflow engine</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>2520</fpage>–<lpage>2522</lpage>.<pub-id pub-id-type="pmid">22908215</pub-id></mixed-citation>
    </ref>
    <ref id="btz436-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Krueger</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Andrews</surname><given-names>S.R.</given-names></name></person-group> (<year>2016</year>) 
<article-title>SNPsplit: allele-specific splitting of alignments between genomes with known SNP genotypes</article-title>. <source>F1000Res</source>., <volume>5</volume>, <fpage>1479.</fpage><pub-id pub-id-type="pmid">27429743</pub-id></mixed-citation>
    </ref>
    <ref id="btz436-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lea</surname><given-names>A.J.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Genome-wide quantification of the effects of DNA methylation on human gene regulation</article-title>. <source>Elife</source>, <volume>7</volume>, <fpage>e37513</fpage>.<pub-id pub-id-type="pmid">30575519</pub-id></mixed-citation>
    </ref>
    <ref id="btz436-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ramírez</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>High-resolution TADs reveal DNA sequences underlying genome organization in flies</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>189.</fpage><pub-id pub-id-type="pmid">29335486</pub-id></mixed-citation>
    </ref>
    <ref id="btz436-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schübeler</surname><given-names>D.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Function and information content of DNA methylation</article-title>. <source>Nature</source>, <volume>517</volume>, <fpage>321</fpage>–<lpage>326</lpage>.<pub-id pub-id-type="pmid">25592537</pub-id></mixed-citation>
    </ref>
    <ref id="btz436-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>C.-Y.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>SMCHD1 merges chromosome compartments and assists formation of super-structures on the inactive X</article-title>. <source>Cell</source>, <volume>174</volume>, <fpage>406</fpage>–<lpage>421.e25</lpage>.<pub-id pub-id-type="pmid">29887375</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
