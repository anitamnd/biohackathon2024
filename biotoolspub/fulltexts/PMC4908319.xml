<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4908319</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btw073</article-id>
    <article-id pub-id-type="publisher-id">btw073</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Privacy-preserving microbiome analysis using secure computation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wagner</surname>
          <given-names>Justin</given-names>
        </name>
        <xref ref-type="aff" rid="btw073-aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Paulson</surname>
          <given-names>Joseph N.</given-names>
        </name>
        <xref ref-type="aff" rid="btw073-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="btw073-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xiao</given-names>
        </name>
        <xref ref-type="aff" rid="btw073-aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bhattacharjee</surname>
          <given-names>Bobby</given-names>
        </name>
        <xref ref-type="aff" rid="btw073-aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Corrada Bravo</surname>
          <given-names>Héctor</given-names>
        </name>
        <xref ref-type="aff" rid="btw073-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btw073-cor1">*</xref>
      </contrib>
      <aff id="btw073-aff1"><sup>1</sup>Center for Bioinformatics and Computational Biologyand </aff>
      <aff id="btw073-aff2"><sup>2</sup>Maryland Cybersecurity Center, Department of Computer Science, University of Maryland, College Park, MD USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btw073-cor1">*To whom correspondence should be addressed.</corresp>
      <fn id="btw073-FN1">
        <p><sup>†</sup>Present address: Department of Biostatistics and Computational Biology, Dana-Farber Cancer Institute and Department of Biostatistics, Harvard T.H. Chan School of Public Health, Boston, MA, USA</p>
      </fn>
      <fn id="btw073-FN2">
        <p>Associate Editor: Jonathan Wren</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>12</issue>
    <fpage>1873</fpage>
    <lpage>1879</lpage>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>7</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>12</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>1</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2016. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Developing targeted therapeutics and identifying biomarkers relies on large amounts of research participant data. Beyond human DNA, scientists now investigate the DNA of micro-organisms inhabiting the human body. Recent work shows that an individual’s collection of microbial DNA consistently identifies that person and could be used to link a real-world identity to a sensitive attribute in a research dataset. Unfortunately, the current suite of DNA-specific privacy-preserving analysis tools does not meet the requirements for microbiome sequencing studies.</p>
      <p><bold>Results:</bold> To address privacy concerns around microbiome sequencing, we implement metagenomic analyses using secure computation. Our implementation allows comparative analysis over combined data without revealing the feature counts for any individual sample. We focus on three analyses and perform an evaluation on datasets currently used by the microbiome research community. We use our implementation to simulate sharing data between four policy-domains. Additionally, we describe an application of our implementation for patients to combine data that allows drug developers to query against and compensate patients for the analysis.</p>
      <p><bold>Availability and implementation:</bold> The software is freely available for download at: <ext-link ext-link-type="uri" xlink:href="http://cbcb.umd.edu/~hcorrada/projects/secureseq.html">http://cbcb.umd.edu/∼hcorrada/projects/secureseq.html</ext-link></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw073/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
      <p>
        <bold>Contact:</bold>
        <email>hcorrada@umiacs.umd.edu</email>
      </p>
    </abstract>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Microbiome sequencing seeks to characterize and classify the composition and structure of microbial communities from metagenomic DNA samples. It is estimated that only 1 in 10 cells in and on a person’s body contain that individual’s DNA (<xref rid="btw073-B24" ref-type="bibr">Turnbaugh <italic>et al.</italic>, 2009</xref>), the remainder corresponding to microbial DNA, most from organisms that cannot be cultured and studied in the laboratory.</p>
    <p>The Human Microbiome Project (HMP) (<xref rid="btw073-B23" ref-type="bibr">Turnbaugh <italic>et al.</italic>, 2007</xref>), the Global Enterics Multi-Center Study (MSD)(<xref rid="btw073-B21" ref-type="bibr">Pop <italic>et al.</italic>, 2014</xref>), the Personal Genome Project (<xref rid="btw073-B4" ref-type="bibr">Church, 2005</xref>) and the American Gut Project (<xref rid="btw073-B3" ref-type="bibr">Blaser <italic>et al.</italic>, 2013</xref>) aim to characterize the ecology of human microbiota and its impact on human health. Potentially pathogenic or probiotic bacteria can be identified by detecting significant differences in their distribution across healthy and disease populations. While the biology has led to promising results, privacy concerns of microbiome research are now being identified with no secure analysis tools available.</p>
    <p>Recent work by Franzosa <italic>et al.</italic> (2015) shows that microbiome data are an unique identifier across time points in a dataset and could be used to link a sensitive attribute to an individual. Earlier work by <xref rid="btw073-B6" ref-type="bibr">Fierer <italic>et al.</italic> (2010)</xref> showed that it is possible to identify an object that an individual touched by comparing microbiome samples from the object and the individual’s hand. We provide a thorough review of microbiome sequencing and a categorization of microbiome privacy considerations in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw073/-/DC1">Supplementary Materials</ext-link>. To counter these concerns, we present an implementation and evaluation of metagenomic association analyses in a secure multi-party computation (SMC) framework. For this work, we focus on garbled circuits, a cryptographic technique that evaluates a function over private inputs from two parties. In this article, we concentrate on the case where two parties, each holding organism abundances in a set of case and control samples, are interested in performing an association analysis (e.g. determining organisms that are differentially abundant in cases) over their combined data, without revealing organism abundances in any specific sample.</p>
    <p>We provide a detailed review of this approach in Section 3 and benchmark our secure implementation of commonly used microbiome analyses on three public datasets. We also quantify the statistical gain of analysis using combined datasets by simulation with a dataset that contains samples from four different countries.</p>
    <p>We believe that implementing metagenomic analyses in an SMC framework will prove beneficial to researchers focused on the human microbiome as well as the secure computation community. Computational biologists will benefit from a method that allows efficient and secure function evaluation over datasets which they may be obligated to keep confidential. Security researchers can draw on the findings from our work and construct protocols that enable sharing large, sparse datasets to perform analysis.</p>
  </sec>
  <sec>
    <title>2 System and methods</title>
    <p>Our secure metagenomic analysis system is built upon garbled circuits (<xref rid="btw073-B17" ref-type="bibr">Malkhi <italic>et al.</italic>, 2004</xref>), which we describe in this Section. We then detail our system including participants along with alternative approaches in the design space for privacy-preserving analysis.</p>
    <sec>
      <title>2.1 Garbled circuits</title>
      <p>Two parties, one holding input <italic>x</italic> and another holding input <italic>y</italic>, wish to compute a public function <italic>F</italic>(<italic>x</italic>, <italic>y</italic>) over their inputs without revealing anything besides the output. The parties could provide their inputs to a trusted third-party that computes the function and reveals the output to each party. However, modern cryptography offers a mechanism to run a protocol between only the two parties while achieving the desired functionality. The main idea behind garbled circuits is to represent the function to be computed as a Boolean circuit over the inputs from both parties and use encryption to hide the input of each party during evaluation by mapping each 0 and 1 bit of the inputs unto random strings that still compute the same result. At the end of circuit evaluation, the resulting random strings can be mapped back to appropriate 0 and 1 bit values that can then be released to each party. In this way, each party learns <italic>F</italic>(<italic>x</italic>, <italic>y</italic>) without learning anything else about the input of <italic>x</italic> and <italic>y</italic>. <xref ref-type="fig" rid="btw073-F1">Figure 1</xref> illustrates the garbled circuits protocol.
<fig id="btw073-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Schematic illustration of the garbled circuits protocol. For analyses discussed in this paper, parties P1 and P2 are researchers performing a statistical analysis over combined data. They provide metagenomic count matrices, or locally precomputed statistics computed from count matrices, along with case/control status as input. Function <italic>F</italic>(<italic>x</italic>, <italic>y</italic>) is determined by the analysis performed, e.g. test on difference in Alpha Diversity between case and control. The ‘garbling’ in step (B) also includes randomly permuting the rows of the truth table so that the inputs are not revealed by the ordering - we omit this from the figure for clarity. A review of the Oblivious Transfer protocol used in step (D) is provided in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw073/-/DC1">Supplementary Materials Section S3</ext-link></p></caption><graphic xlink:href="btw073f1p"/></fig>
</p>
    </sec>
    <sec>
      <title>2.2 System participants</title>
      <p>We consider the case in which parties located in two policy-domains want to perform metagenomic analyses over shared data. Examples of policy-domains include countries with differing privacy laws or institutions (universities, companies) that stipulate different data disclosure procedures.</p>
      <p>For <inline-formula id="IE1"><mml:math id="IEQ1"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, denoting <italic>PD<sub>i</sub></italic> as a policy domain, <italic>R<sub>i</sub></italic> as a researcher in policy domain <italic>i</italic>, <italic>D<sub>i</sub></italic> as the data from <italic>R<sub>i</sub></italic>, <italic>F</italic> as the set of functions that a set of <italic>R<sub>i</sub></italic>s would like to compute we consider the following setting:<disp-quote content-type="extract"><p><italic>R</italic><sub>1</sub> and <italic>R</italic><sub>2</sub> would like to compute <italic>F</italic> over combined <italic>D</italic><sub>1</sub> and <italic>D</italic><sub>2</sub> but cannot do so by broadcasting the data as either <italic>PD</italic><sub>1</sub> or <italic>PD</italic><sub>2</sub> does not allow for public release or reception of individual-level microbiome data. We set <inline-formula id="IE2"><mml:math id="IEQ2"><mml:mrow><mml:mo>|</mml:mo><mml:mi>i</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> but this setting could be generalized to any <italic>i</italic>.</p></disp-quote></p>
      <p>Policy domains naturally arise due to differences in privacy laws. For example, studies currently funded by the NIH are required to release non-human genomic sequences including human microbiome data (<ext-link ext-link-type="uri" xlink:href="http://gds.nih.gov/PDF/NIH_GDS_Policy.pdf">http://gds.nih.gov/PDF/NIH_GDS_Policy.pdf</ext-link>). In contrast, the European General Data Protection Regulation, which is currently in draft form, lists biometric data and ‘any “data concerning health” means any personal data which relates to the physical or mental health of an individual, or to the provision of health services to the individual’ as protected information that is not to be released publicly (<ext-link ext-link-type="uri" xlink:href="http://www.europarl.europa.eu/sides/getDoc.do?pubRef=-//EP//TEXT+TA+P7-TA-2014-0212+0+DOC+XML+V0//EN">http://www.europarl.europa.eu/sides/getDoc.do?pubRef=-//EP//TEXT+TA+P7-TA-2014-0212+0+DOC+XML+V0//EN</ext-link>). Therefore, researchers in the USA and EU may encounter different policies for data release but still have an interest in computing metagenomic analyses over shared data. Also, given the results published by Franzosa <italic>et al</italic>., some institutions may re-evaluate microbiome data release policies.</p>
      <sec>
        <title>2.2.1 Threat model</title>
        <p>We consider researcher <italic>R</italic><sub>1</sub>, who has a microbiome sample from a victim mixed with other samples, to be a semi-honest adversary, or one that follows the protocol but examines the transcript to learn more information than it should. Researcher <italic>R</italic><sub>2</sub> is examining an association for a specific trait and would like to expand her study to use samples held by <italic>R</italic><sub>1</sub>. <italic>R</italic><sub>1</sub> wants to determine if the victim is in <italic>R</italic><sub>2</sub>’s dataset and thus learn a sensitive attribute of the victim such as disease status.</p>
        <p>The attacks of Fierer <italic>et al</italic>. and Franzosa <italic>et al</italic>. operate over the vector of feature counts for a given sample. For the analyses studied in this article, an adversary will have no better chance of reconstructing the count vector for a specific sample than guessing the majority, or mode, of the count of any specific feature in this system. Through using a garbled circuit implementation of metagenomic analyses, <italic>R</italic><sub>2</sub> will be able to keep the vector of microbiome features for any sample private, learn the outputs of functions that she would like to learn over the shared data, and prevent <italic>R</italic><sub>1</sub> from completing the attack.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Solution design approaches</title>
      <p>We consider different approaches to allow two parties to compute analyses over data which each must keep confidential.</p>
      <sec>
        <title>2.3.1 Access control plus trusted third party</title>
        <p>In the USA, the NIH has recognized re-identification through publicly posted genomic data as a realistic threat. Therefore, policy allows for publication of summary statistics and transfer of individual level sequencing data through access control using the Database for Genotypes and Phenotypes (<xref rid="btw073-B16" ref-type="bibr">Mailman <italic>et al.</italic>, 2007</xref>). Once a researcher receives permission to access data, she is provided the data and is required to maintain the access control list for her research group. We look to remove the need for access control by implementing the queries that a researcher would like to run without revealing the data directly.</p>
      </sec>
      <sec>
        <title>2.3.2 Differential privacy</title>
        <p>Statistical perturbation of analysis results, most widely implemented as differential privacy, is a second approach for researchers to provide privacy guarantees to participants. In this setting, a researcher maintains a data set and allows other researchers to perform queries over the data. Informally, the results of these queries are perturbed in such a manner that an adversary, with access to query results over a data set in which one specific participant has a set of values and results from another data set with that specific participant having a different set of values, will not be able to infer any information about that individual by examining the results (<xref rid="btw073-B10" ref-type="bibr">Groce, 2014</xref>). Although this approach provides provable privacy guarantees, the introduction of statistical noise has not gained traction in the computational biology research community. Also, recent work showed that learning warfarin dosage models on differentially private data sets introduces enough noise that the dosage recommendation could be fatal to patients (<xref rid="btw073-B8" ref-type="bibr">Fredrikson <italic>et al.</italic>, 2014</xref>).</p>
      </sec>
      <sec>
        <title>2.3.3 Secure multiparty computation</title>
        <p>An alternative solution which we undertake is using secure computation to perform metagenomic analyses. Other researchers have presented SMC for computing secure genome-wide association studies using secret-sharing, but that particular approach requires the use of three parties for computing tasks (<xref rid="btw073-B12" ref-type="bibr">Kamm <italic>et al.</italic>, 2013</xref>). We address the feasibility of using garbled circuits to implement metagenomic analyses in terms of running time, network traffic, and accuracy. We believe that garbled circuits is the best approach for this scenario as it allows for direct communication between two parties and models research settings well. Further, garbled circuits can handle a variety of adversaries beyond the semi-honest one that we consider in this work.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Implementation</title>
    <p>In this section, we describe how we implemented metagenomic analyses in garbled circuits and detail an evaluation of our system.</p>
    <sec>
      <title>3.1 Metagenomics using garbled circuits</title>
      <sec>
        <title>3.1.1 FlexSC</title>
        <p>FlexSC, the back end of ObliVM, is a framework for secure computation including garbled circuits with a semi-honest adversary (<xref rid="btw073-B15" ref-type="bibr">Liu <italic>et al.</italic>, 2015</xref>). FlexSC allows users to write a function in Java for two parties to compute then compiles and evaluates the garbled circuit representation of that function. We implemented all metagenomic tests as Java packages then compiled and ran each with FlexSC. Our initial work on χ<sup>2</sup>-test was based on a χ<sup>2</sup>-test implementation using SNP data (<ext-link ext-link-type="uri" xlink:href="https://github.com/wangxiao1254/idash_competition">https://github.com/wangxiao1254/idash_competition</ext-link>).</p>
      </sec>
      <sec>
        <title>3.1.2 Metagenomic analysis assumptions</title>
        <p>For this article, we perform all analyses at the species taxonomic level. As detailed in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw073/-/DC1">Supplementary Materials Section S1</ext-link>, OTUs are generated from direct pairwise comparison of sequencing reads. This is a compute-intensive process when performed on clear text (<xref rid="btw073-B9" ref-type="bibr">Ghodsi <italic>et al.</italic>, 2011</xref>). We do not attempt it in SMC for this work and assume each party performs this operation locally. We assume that each party will annotate each resulting OTU by matching to a common reference database, previously agreed upon by both parties (note that this reference database is orthogonal to sample-specific sequencing results obtained by each party). For illustration we assume that the agreed upon reference database yields annotation at the microbial species level. We also assume that parties can split data into case and control groups based on an agreed upon phenotype. Finally, we do not consider features that have all zeros in the case or control group for either party.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Design approaches</title>
      <p>We took several approaches to implement each statistic. Since the metagenomic datasets we examined are at least 80% sparse and this trend is expected with OTU data (<xref rid="btw073-B20" ref-type="bibr">Paulson <italic>et al.</italic>, 2013</xref>), we make design choices to make computation with garbled circuits feasible. We now detail each implementation of the χ<sup>2</sup> -test, odds ratio, Differential Abundance and Alpha Diversity. To measure the impact of our design choices we implemented a naive algorithm for each statistic and compared results.</p>
      <sec>
        <title>3.2.1 Precomputation</title>
        <p>We first developed a method that finds an aggregate statistic at each party so that only those values are circuit inputs. This method is a straightforward approach to reduce the amount of operations and data in the secure computation protocol. As expected, for each statistic this approach had the best performance on all the datasets we evaluated. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw073/-/DC1">Supplementary Figure S2</ext-link> shows the process for calculating a χ<sup>2</sup>-test and odds ratio on precomputed contingency table counts. An issue with this approach is not all analyses that researchers are interested in computing may be able to be performed over locally generated aggregates.</p>
      </sec>
      <sec>
        <title>3.2.2 Sparse matrix</title>
        <p>We devised two methods to account for the sparsity of the feature count matrices we used for evaluation. We first followed an approach introduced by <xref rid="btw073-B19" ref-type="bibr">Nikolaenko <italic>et al.</italic> (2013)</xref> to perform sparse matrix factorization in garbled circuits. We detail our work with this technique in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw073/-/DC1">Supplementary Materials Section S4</ext-link>. As our contribution, we took a conceptually simpler approach that input the non-zero elements for each feature to the circuit and operated over those elements directly. As shown in Figures 4 and 5, this method significantly reduces the number of operations that need to be performed in the secure protocol and offers reasonable running times compared to the precomputation approach.</p>
      </sec>
      <sec>
        <title>3.2.3 Presence/absence</title>
        <p>We implemented the χ<sup>2</sup>-test and odds ratio to perform presence/absence association testing. We provide a review of χ<sup>2</sup>-test and odds ratio in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw073/-/DC1">Supplementary Materials Section S1</ext-link>.</p>
        <p>For the precomputation technique, each party splits its data into case and control groups on a characteristic determined outside of this protocol. Each party then locally computes the contingency table counts on the split data. These contingency table counts are each party’s input into the circuit. Within the circuit, the counts are summed for both case and control groups then the χ<sup>2</sup>-statistic along with the odds ratio are computed for each feature.</p>
        <p>In the sparse matrix approach, the total number of samples and all non-zero elements for each feature are input to a garbled circuit. The circuit first adds the number of non-zero elements to compute the present contingency table counts then uses the total number of samples to find the absent counts.</p>
      </sec>
      <sec>
        <title>3.2.4 Differential abundance</title>
        <p>For calculating differential abundance, we implemented a two-sample <italic>t</italic>-test for testing the mean abundance between case and control groups. We assume normalization of sequencing counts can be accomplished in a preprocessing step between both parties. We make this assumption because we use normalized datasets in our evaluation. We leave implementation of normalization techniques in garbled circuits to future work.</p>
        <p>For review of two-sample <italic>t</italic>-test we refer the reader to the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw073/-/DC1">Supplementary Materials Section S1</ext-link>. We examined the process for calculating mean, variance and the t-statistic to determine what optimizations can be made for computing in a circuit. In order to avoid processing all samples within the computation framework, we observe transformations that reduce the total number of operations. In the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw073/-/DC1">Supplementary Materials</ext-link>, we show how mean abundance and variance can be computed using the sum, sum of squares and total number of elements from each party. For precomputation, as each institution only needs to provide three values per feature we calculate them locally. In the circuit, a two-sample <italic>t</italic>-statistic to test difference between case and control groups is computed.</p>
        <p>For the sparse matrix approach, the total sum and sum of squares are calculated in the circuit using the non-zero elements for each feature. Mean abundance along with variance can then be calculated and used compute the two-sample <italic>t</italic>-test. We refer the reader to <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw073/-/DC1">Supplementary Materials Section S4</ext-link> for more detail.</p>
      </sec>
      <sec>
        <title>3.2.5 Alpha diversity</title>
        <p>We use a two-sample <italic>t</italic>-test to determine the significance of mean Alpha Diversity difference between case and control groups. Given that FlexSC does not currently compute logarithm, we measure Alpha Diversity as Simpson’s index: <inline-formula id="IE3"><mml:math id="IEQ3"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo><mml:mi>n</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> where <italic>n</italic> is the number of OTU counts for OTU<italic><sub>i</sub></italic> and <italic>N</italic> is the total number of counts observed in a sample.</p>
        <p>For precomputation, we locally compute Simpson’s index for each sample. These values are input into the circuit where they are summed, mean and variance is taken, and the <italic>t</italic>-statistic is calculated. In Alpha Diversity, all samples in case and control must be processed together as opposed to Presence/Absence and Differential Abundance which can be computed per feature.</p>
        <p>For our sparse computation design, the two values for Simpson’s index, <inline-formula id="IE4"><mml:math id="IEQ4"><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo><mml:mi>n</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE5"><mml:math id="IEQ5"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are generated over each sample in the circuit during one pass through the matrix. Then a pass over an array of these values using division yields Simpson’s index from which the total sum and sum of squares can be used to compute the two-sample <italic>t</italic>-test between case and control groups.</p>
      </sec>
    </sec>
    <sec>
      <title>3.3 Evaluation</title>
      <p>We evaluated our implementation using two Amazon EC2 r3.2xLarge instances with 2.5 GHz processors and 61 GB RAM running Amazon Linux AMI 2015.3. We measured the size of the circuit generated, running time and network traffic between both parties for each metagenomic statistic and dataset. Circuit size serves as a useful comparison metric since it depends on the function and input sizes but is independent of hardware. Running time and network traffic are helpful in system-design decisions and benchmarking of deployments.</p>
    </sec>
    <sec>
      <title>3.4 Datasets</title>
      <p>We used OTU count data from the Personal Genome Project (PGP) (<xref rid="btw073-B4" ref-type="bibr">Church, 2005</xref>), the HMP (<xref rid="btw073-B23" ref-type="bibr">Turnbaugh <italic>et al.</italic>, 2007</xref>), and the Global Enterics MSD (<xref rid="btw073-B21" ref-type="bibr">Pop <italic>et al.</italic>, 2014</xref>). We retrieved the MSD data from the project website (<ext-link ext-link-type="uri" xlink:href="http://ftp://ftp.cbcb.umd.edu/pub/data/GEMS/MSD1000.biom">ftp://ftp.cbcb.umd.edu/pub/data/GEMS/MSD1000.biom</ext-link>) as well as the PGP and HMP datasets are from the American-Gut project site (<ext-link ext-link-type="uri" xlink:href="https://github.com/biocore/American-Gut/tree/master/data">https://github.com/biocore/American-Gut/tree/master/data</ext-link>) (<xref rid="btw073-B3" ref-type="bibr">Blaser <italic>et al.</italic>, 2013</xref>). We used the tongue as the case and gingiva as control for the HMP data. For PGP, we set forehead as case and left palm as control. Case and control criteria for the MSD dataset were already set by the researchers that publish the data depending on disease phenotype. After aggregating to species and removing features which hold all zeros for either the case or the control group, the PGP contains 168 samples and 277 microbiome features, the HMP has 694 samples and 97 features, and the MSD dataset consists of 992 samples and 754 features. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw073/-/DC1">Supplementary Table S2</ext-link> summarizes the size and sparsity of each dataset.</p>
    </sec>
    <sec>
      <title>3.5 Efficiency of secure computation</title>
      <sec>
        <title>3.5.1 Circuit size</title>
        <p><xref ref-type="fig" rid="btw073-F2">Figure 2</xref> shows the circuit size per feature for each experiment. As a result of the work by Kolesnikov and Schnieder (2008), XOR gates in each circuit do not require costly network traffic and computation, therefore the total number of non-XOR gates is reported for each statistic and dataset. Using precomputation, the complexity of the equation in terms of arithmetic operations to calculate each statistic determines the circuit size. This explains the circuit sizes for odds ratio and χ<sup>2</sup> test as compared with Differential Abundance. For Alpha Diversity, all rows and columns are preprocessed with only the two sample <italic>t</italic>-test computed in the circuit. With the sparse implementation, the complexity of the test along with the number of non-zero elements in the dataset directly affects circuit size.
<fig id="btw073-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>Circuit size per feature for each implementation and dataset. The feature count for Alpha Diversity is the number of samples. The differences in Alpha Diversity between datasets is explained by the number of samples for PGP (168) being much lower than that of HMP (694) and MSD (992). PC, Pre-compute</p></caption><graphic xlink:href="btw073f2p"/></fig>
</p>
      </sec>
      <sec>
        <title>3.5.2 Running time</title>
        <p>For the sparse implementation, the running time was proportional to the size and number of non-zero elements in each dataset. For precomputation, Alpha Diversity was affected by the number of samples in each dataset. The running time for the χ<sup>2</sup> test, odds ratio, and Differential Abundance were proportional to the number of features (rows) processed. <xref ref-type="fig" rid="btw073-F3">Figure 3</xref> summarizes the effects of input size and algorithm complexity on running time.
<fig id="btw073-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>Running time for each statistic and each dataset in minutes. In each statistic, the number of arithmetic operations determined the running time. The size of the dataset along with sparsity contributed to running time for the sparse implementations. Alpha Diversity MSD Naive did not run to completion on the EC2 instance size due to insufficient memory. Based on the circuit size and the number of gates processed per second for other statistics, we estimate the running time to be 378 min. PC, Pre-compute</p></caption><graphic xlink:href="btw073f3p"/></fig>
</p>
      </sec>
      <sec>
        <title>3.5.3 Network traffic</title>
        <p><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw073/-/DC1">Supplementary Table S5</ext-link> shows the network traffic for each experiment. The increase in network traffic between the precomputation and sparse implementations is more significant than the differences in running times of those approaches. We believe that the network traffic for the precompute implementation is quite good for the security guarantees provided with using garbled circuits while the sparse approach presents an acceptable tradeoff depending on the network resources available.</p>
      </sec>
    </sec>
    <sec>
      <title>3.6 Accuracy</title>
      <p>We compared the accuracy of our implementation results to computing the statistic using standard R libraries. <xref ref-type="table" rid="btw073-T1">Table 1</xref> lists the accuracy of results for the χ<sup>2</sup> statistic, odds ratio, as well as the <italic>t</italic>-test results for Differential Abundance and Alpha Diversity. The differences in our garbled circuits results compared to the <italic>R</italic> values appear to be the result of circuit complexity. The floating-point arithmetic operations in FlexSC are software implementations. Therefore the operations are subject to rounding errors that are rarely observed on modern processors which have hardware level support for floating-point arithmetic.
<table-wrap id="btw073-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p> Computation accuracy</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"><bold>PGP</bold></th><th rowspan="1" colspan="1"><bold>HMP</bold></th><th rowspan="1" colspan="1"><bold>MSD</bold></th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Chi-square statistic</td><td align="char" char="." rowspan="1" colspan="1">7.84e-07</td><td align="char" char="." rowspan="1" colspan="1">7.48e-06</td><td align="char" char="." rowspan="1" colspan="1">7.02e-08</td></tr><tr><td rowspan="1" colspan="1">Chi-square <italic>P</italic>-value</td><td align="char" char="." rowspan="1" colspan="1">2.00e-07</td><td align="char" char="." rowspan="1" colspan="1">2.14e-06</td><td align="char" char="." rowspan="1" colspan="1">9.72e-08</td></tr><tr><td rowspan="1" colspan="1">odds ratio</td><td align="char" char="." rowspan="1" colspan="1">1.60e-13</td><td align="char" char="." rowspan="1" colspan="1">5.42e-13</td><td align="char" char="." rowspan="1" colspan="1">2.44e-13</td></tr><tr><td rowspan="1" colspan="1">Differential abundance</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"><italic>t</italic>-statistic</td><td align="char" char="." rowspan="1" colspan="1">0.023</td><td align="char" char="." rowspan="1" colspan="1">0.0017</td><td align="char" char="." rowspan="1" colspan="1">0.0012</td></tr><tr><td rowspan="1" colspan="1">Differential abundance</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">degrees of freedom</td><td align="char" char="." rowspan="1" colspan="1">2.7e-4</td><td align="char" char="." rowspan="1" colspan="1">2.5e-4</td><td align="char" char="." rowspan="1" colspan="1">0.0028</td></tr><tr><td rowspan="1" colspan="1">Differential abundance</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"><italic>P</italic>-value</td><td align="char" char="." rowspan="1" colspan="1">0.0024</td><td align="char" char="." rowspan="1" colspan="1">0.0026</td><td align="char" char="." rowspan="1" colspan="1">0.0011</td></tr><tr><td rowspan="1" colspan="1">Alpha Diversity</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"><italic>t</italic>-statistic</td><td align="char" char="." rowspan="1" colspan="1">0.0038</td><td align="char" char="." rowspan="1" colspan="1">0.017</td><td align="char" char="." rowspan="1" colspan="1">0.0049</td></tr><tr><td rowspan="1" colspan="1">Alpha Diversity</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">degrees of freedom</td><td align="char" char="." rowspan="1" colspan="1">1.48e-05</td><td align="char" char="." rowspan="1" colspan="1">9.7e-4</td><td align="char" char="." rowspan="1" colspan="1">2.2e-4</td></tr><tr><td rowspan="1" colspan="1">Alpha Diversity</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1"><italic>P</italic>-value</td><td align="char" char="." rowspan="1" colspan="1">0.0088</td><td align="char" char="." rowspan="1" colspan="1">0.044</td><td align="char" char="." rowspan="1" colspan="1">0.014</td></tr></tbody></table><table-wrap-foot><fn id="btw073-TF1"><p>Results were generated using the R chisq.test{stats}, odds.ratio{abd}, t.test{stats}, and diversity{vegan} against our implementation in ObliVM for the χ<sup>2</sup>-test, odds ratio, differential abundance and Alpha Diversity. We use Normalized Mean Squared Error: <inline-formula id="IE15"><mml:math id="IEQ15"><mml:mrow><mml:msup><mml:mrow><mml:mo>‖</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mo>‖</mml:mo><mml:mi>x</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> with <italic>x</italic> as the value output by <italic>R</italic> and <italic>y</italic> the value from our implementation. For comparing <italic>P</italic>-values, we use the log<sub>10</sub>
<italic>P</italic>-value and exclude any exact matches [since log<sub>10</sub>(0) = −Inf in R] while computing the mean. </p></fn></table-wrap-foot></table-wrap></p>
      <p>We investigated if our implementation yielded any false positives and false negatives with the results from R acting as ground truth. For the <italic>P</italic>-values of Differential Abundance in PGP, HMP, and MSD datasets we found no false positives or false negatives for a significance level of 0.05.</p>
    </sec>
    <sec>
      <title>3.7 Significant features discovered through data-sharing</title>
      <p>Researchers in different policy domains may be forced to compute analyses on partial data. We measured the effect of using our implementation for data-sharing between policy domains. The MSD dataset provides a means to simulate secure computation of microbiome analyses between different countries. The data were gathered from Kenya, The Gambia, Bangladesh and Mali. We simulate each country performing secure Differential Abundance pair-wise with the other countries. We observed that sharing data resulted in a substantial increase (at minimum a 98% increase) in the number of species found to be differentially abundant between case and control groups. <xref ref-type="table" rid="btw073-T2">Table 2</xref> summarizes the results.
<table-wrap id="btw073-T2" orientation="portrait" position="float"><label>Table 2.</label><caption><p> Significant features found from sharing data between each country</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"><bold>Features found</bold></th><th rowspan="1" colspan="1"><bold>Total increase</bold></th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Kenya only</td><td rowspan="1" colspan="1">47</td><td rowspan="1" colspan="1">N/A</td></tr><tr><td rowspan="1" colspan="1">Gambia only</td><td rowspan="1" colspan="1">84</td><td rowspan="1" colspan="1">N/A</td></tr><tr><td rowspan="1" colspan="1">Mali only</td><td rowspan="1" colspan="1">58</td><td rowspan="1" colspan="1">N/A</td></tr><tr><td rowspan="1" colspan="1">Bangladesh only</td><td rowspan="1" colspan="1">75</td><td rowspan="1" colspan="1">N/A</td></tr><tr><td rowspan="1" colspan="1">Kenya + The Gambia</td><td rowspan="1" colspan="1">133</td><td rowspan="1" colspan="1">86</td></tr><tr><td rowspan="1" colspan="1">Kenya + Mali</td><td rowspan="1" colspan="1">112</td><td rowspan="1" colspan="1">65</td></tr><tr><td rowspan="1" colspan="1">Kenya + Bangladesh</td><td rowspan="1" colspan="1">138</td><td rowspan="1" colspan="1">91</td></tr><tr><td rowspan="1" colspan="1">Gambia + Bangladesh</td><td rowspan="1" colspan="1">166</td><td rowspan="1" colspan="1">82</td></tr><tr><td rowspan="1" colspan="1">Mali + Gambia</td><td rowspan="1" colspan="1">167</td><td rowspan="1" colspan="1">109</td></tr><tr><td rowspan="1" colspan="1">Mali + Bangladesh</td><td rowspan="1" colspan="1">169</td><td rowspan="1" colspan="1">111</td></tr></tbody></table><table-wrap-foot><fn id="btw073-TF2"><p>When computing data with another policy domain, each country saw an increase in the number of features detected to be significantly different between case and control groups.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec>
      <title>3.8 Metagenomic codes</title>
      <p>We also evaluated our implementation on the genetic marker data that showed the greatest identification power in the metagenomic codes analysis (<xref rid="btw073-B7" ref-type="bibr">Franzosa <italic>et al.</italic>, 2015</xref>). The data are also from the HMP and consists of a total of 85 samples and 221 111 features. Due to the large number of features and sparsity of the data, we implemented a filtering garbled circuit in which we first return a vector to each party denoting if a given feature meets a presence cutoff and then have each party input those features into our existing implementations to compute the statistical test. For χ<sup>2</sup>, the 1 729 851 751 gate circuit (circuit size of 7823 Non-Free gates per feature) is evaluated in 67.4 min, with 51 926.35 MB sent to the evaluator, and 1 642.53 MB sent to generator. For odds ratio, the 632 918 505 gate circuit is evaluated in 33.18 min, with 20,542.84 MB sent to the evaluator, and 1,642.29 MB sent to generator. This result shows that the secure comparative analyses we would like to perform are possible given the legitimate concerns raised by Franzosa <italic>et al</italic>.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this section, we describe related work and provide a context for our contribution. We also discuss a use case for our solution in building datasets and finally present conclusions we formed during the course of our work.</p>
    <sec>
      <title>4.1 Related work</title>
      <p>As we are the first, to our knowledge, to approach secure microbiome analysis, we review related work on privacy-preserving operations over human DNA.</p>
      <sec>
        <title>4.1.1 Secure DNA sequence matching and searching</title>
        <p>Comparing two DNA segments is essential to genome alignment and identifying the presence of a disease causing mutation. One approach is to use an oblivious finite state machine for privacy-preserving approximate string matching (<xref rid="btw073-B22" ref-type="bibr">Troncoso-Pastoriza <italic>et al.</italic>, 2007</xref>). FastGC, the predecessor of the FlexSC library, was benchmarked by computing Levenstein distance and the Smith-Waterman algorithm between private strings held by two parties (<xref rid="btw073-B11" ref-type="bibr">Huang <italic>et al.</italic>, 2011</xref>). More recently, <xref rid="btw073-B25" ref-type="bibr">Wang <italic>et al.</italic> (2015)</xref> compute approximate edit-distance using whole genome sequences.</p>
      </sec>
      <sec>
        <title>4.1.2 Privacy-preserving Genome-wide association studies</title>
        <p>Prior work has shown that secure computation between two institutions on biomedical data is possible by using a three-party secret-sharing scheme (<xref rid="btw073-B12" ref-type="bibr">Kamm <italic>et al.</italic>, 2013</xref>). The authors present an implementation of a χ<sup>2</sup>-test over SNP data using the Sharemind framework. Other researchers have presented a modification of functional encryption that enables a person to provide her genome and phenotype to a study but only for a restricted set of functions based on a policy parameter (<xref rid="btw073-B18" ref-type="bibr">Naveed <italic>et al.</italic>, 2014</xref>).</p>
        <p>Prior works have built systems for genomic studies using different cryptographic protocols, including systems using additive homomorphic encryption (<xref rid="btw073-B5" ref-type="bibr">Dachman-Soled <italic>et al.</italic>, 2011</xref>) and systems using fully homomorphic encryption (<xref rid="btw073-B14" ref-type="bibr">Lauter <italic>et al.</italic>, 2014</xref>). When compared with these works, we use a garbled circuit protocol with circuits for floating-point operations. Our system has two unique advantages compared to these prior works: (i) We can benefit from a long line of work on improving the practicality of garbled circuits (<xref rid="btw073-B11" ref-type="bibr">Huang <italic>et al.</italic>, 2011</xref>; <xref rid="btw073-B13" ref-type="bibr">Kolesnikov and Schneider, 2008</xref>; <xref rid="btw073-B26" ref-type="bibr">Zahur <italic>et al.</italic>, 2015</xref>) (ii) Floating-point operations ensure us a small and bounded error even after multiple operations.</p>
      </sec>
      <sec>
        <title>4.1.3 Secure genetic testing</title>
        <p>For using sequencing results in the clinical realm, paternity determination and patient-matching is possible using private set intersection (<xref rid="btw073-B2" ref-type="bibr">Baldi <italic>et al.</italic>, 2011</xref>). Also, it is feasible to utilize homomorphic encryption for implementing disease-risk calculation without revealing the value of any genomic variant (<xref rid="btw073-B1" ref-type="bibr">Ayday <italic>et al.</italic>, 2013</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>4.2 Patient pool</title>
      <p>A novel application of multi-party secure computation approaches to genomic analysis are patient pool designs that can benefit patient groups, specifically those suffering from rare diseases or those with insufficient data in existing repositories for association studies. The recent announcement by 23andMe to begin drug development on its genome variant datasets highlights the value of biomarker data. We imagine a scenario where individuals can use our solution to create and manage datasets in order to charge drug developers to run analysis functions over the data. The companies will have to be non-colluding as otherwise all function results could be shared among companies. The current regulatory process for drug development allows a mechanism to enforce this constraint.</p>
      <p>The patient pool can be paid to compute a function to over its data and sign the output. Upon requesting drug trial permission in the USA, a company is required to hand over all data from research, which in this case would include the output of the patient pool analysis and signatures over those results. The FDA could verify the signatures to enforce non-collusion between companies. This provides a mechanism to create high-quality datasets that are accessible to a variety of companies and ensure patients are compensated for their efforts.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Conclusions</title>
    <p>In this article, we show that it is possible to perform metagenomic analyses in a secure computation framework. Our implementation made use of precomputation steps to minimize the number of operations performed in secure computation making the use of garbled circuits feasible. We also implemented sparse-matrix methods for each statistic. We took this step in order to prove the applicability of this solution for other analyses when the data itself acts as sufficient statistics, such as for the Wilcoxon rank-sum test. We also explored potential applications of our implementation in patient pool designs.</p>
    <p>Although the storage and sharing of medical data is ultimately a policy matter, providing a technical solution is useful to forming good policy. We believe that given the time costs associated with re-consenting patients to release data to another researcher or creating a legal contract stipulating a data receiver’s responsibility, that the running times we presented for metagenomic analyses are a reasonable tradeoff.</p>
    <p>DNA-sequencing technologies are entering a period of unprecedented applicability in clinical and medical settings with a concomitant need for regulatory oversight over each individual’s sequencing data. We believe that addressing privacy concerns through computational frameworks similar to those used in this article is paramount for patients while allowing researchers to have access to the largest and most descriptive datasets possible. We expect that secure computation and storage of DNA sequencing data, both the individual’s DNA and their metagenomic DNA, will play an increasingly important role in the biomedical research and clinical practice landscape.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_32_12_1873__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btw073_SupplementaryNote.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was partially supported by the <funding-source>National Institutes of Health</funding-source> [<award-id>R01HG005220</award-id> and <award-id>R01GM114267</award-id> to H.C.B. and J.W.]; the <funding-source>US National Science Foundation Graduate Research Fellowship</funding-source> [<award-id>DGE0750616</award-id> to J.N.P.]; and the <funding-source>US National Science Foundation</funding-source> [<award-id>1111599</award-id> to X.W., <award-id>1314857</award-id> to X.W., <award-id>0964541</award-id> to B.B.].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btw073-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Ayday</surname><given-names>E.</given-names></name></person-group><etal/> (<year>2013</year>). Privacy-preserving computation of disease risk by using genomic, clinical, and environmental data. In: <italic>Proceedings of the 2013 USENIX Conference on Safety, Security, Privacy and Interoperability of Health Information Technologies, HealthTech ’13</italic>, Berkeley, CA, USA. USENIX Association, p. 1. </mixed-citation>
    </ref>
    <ref id="btw073-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Baldi</surname><given-names>P.</given-names></name></person-group><etal/> (<year>2011</year>). Countering gattaca: efficient and secure testing of fully-sequenced human genomes. In: <italic>Proceedings of the 18th ACM Conference on Computer and Communications Security, CCS ’11</italic>, New York, NY, USA. ACM, pp. 691–702.</mixed-citation>
    </ref>
    <ref id="btw073-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blaser</surname><given-names>M.</given-names></name></person-group><etal/> (<year>2013</year>) <article-title>The microbiome explored: recent insights and future challenges</article-title>. <source>Nat. Rev. Microbiol</source>, <volume>11</volume>, <fpage>213</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">23377500</pub-id></mixed-citation>
    </ref>
    <ref id="btw073-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Church</surname><given-names>G.M.</given-names></name></person-group> (<year>2005</year>) <article-title>The personal genome project</article-title>. <source>Mol. Syst. Biol</source>., <volume>1</volume>, <fpage>2005.0030</fpage></mixed-citation>
    </ref>
    <ref id="btw073-B5">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dachman-Soled</surname><given-names>D.</given-names></name></person-group><etal/> (<year>2011</year>). <chapter-title>Secure efficient multiparty computing of multivariate polynomials and applications</chapter-title> In: <source>Applied Cryptography and Network Security</source>, pp. <fpage>130</fpage>–<lpage>46</lpage>. <publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btw073-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fierer</surname><given-names>N.</given-names></name></person-group><etal/> (<year>2010</year>) <article-title>Forensic identification using skin bacterial communities</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>107</volume>, <fpage>6477</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">20231444</pub-id></mixed-citation>
    </ref>
    <ref id="btw073-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franzosa</surname><given-names>E.</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>Identifying personal microbiomes using metagenomic codes</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>112</volume>, <fpage>E2930</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">25964341</pub-id></mixed-citation>
    </ref>
    <ref id="btw073-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Fredrikson</surname><given-names>M.</given-names></name></person-group><etal/> (<year>2014</year>). Privacy in pharmacogenetics: an end-to-end case study of personalized warfarin dosing. In: <italic>23rd USENIX Security Symposium (USENIX Security 14)</italic>, USENIX Association, pp. 17–32.</mixed-citation>
    </ref>
    <ref id="btw073-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghodsi</surname><given-names>M.</given-names></name></person-group><etal/> (<year>2011</year>) <article-title>Dnaclust: accurate and efficient clustering of phylogenetic marker genes</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>, <fpage>271</fpage>.<pub-id pub-id-type="pmid">21718538</pub-id></mixed-citation>
    </ref>
    <ref id="btw073-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Groce</surname><given-names>A.D.</given-names></name></person-group> (<year>2014</year>). <italic>New notions and mechanisms for statistical privacy</italic>. Ph.D. Thesis, University of Maryland. ProQuest. 3644113.</mixed-citation>
    </ref>
    <ref id="btw073-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Y.</given-names></name></person-group><etal/> (<year>2011</year>). Faster secure two-party computation using garbled circuits. In: <italic>Proceedings of the 20th USENIX Conference on Security, SEC'11</italic>, Berkeley, CA, USA. USENIX Association, pp. 35–35.</mixed-citation>
    </ref>
    <ref id="btw073-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kamm</surname><given-names>L.</given-names></name></person-group><etal/> (<year>2013</year>) <article-title>A new way to protect privacy in large-scale genome-wide association studies</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>886</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">23413435</pub-id></mixed-citation>
    </ref>
    <ref id="btw073-B13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kolesnikov</surname><given-names>V</given-names></name><name><surname>Schneider</surname><given-names>T.</given-names></name></person-group> (<year>2008</year>) <chapter-title>Improved garbled circuit: free XOR gates and applications</chapter-title> In: <source>Automata, Languages and Programming</source>, pp. <fpage>486</fpage>–<lpage>98</lpage>. <publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btw073-B14">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lauter</surname><given-names>K.</given-names></name></person-group><etal/> (<year>2014</year><chapter-title>) Private computation on encrypted genomic data</chapter-title> In: <source>Progress in Cryptology-LATINCRYPT 2014</source>, pp. <fpage>3</fpage>–<lpage>27</lpage>. <publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btw073-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>C.</given-names></name></person-group><etal/> (<year>2015</year>) Oblivm: A programming framework for secure computation. In: <italic>2015 IEEE Symposium on Security and Privacy (SP)</italic>, IEEE, pp. 359–376.</mixed-citation>
    </ref>
    <ref id="btw073-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mailman</surname><given-names>M.D.</given-names></name></person-group><etal/> (<year>2007</year>) <article-title>The NCBI dbgap database of genotypes and phenotypes</article-title>. <source>Nat. Genet</source>., <volume>30</volume>, <fpage>1181</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">17898773</pub-id></mixed-citation>
    </ref>
    <ref id="btw073-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Malkhi</surname><given-names>D.</given-names></name></person-group><etal/> (<year>2004</year>) Fairplay-secure two-party computation system. In: <italic>Proceedings of the 13th Conference on USENIX Security Symposium, SSYM’04, Berkeley</italic>, CA, USA. USENIX Association, p. 20.</mixed-citation>
    </ref>
    <ref id="btw073-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Naveed</surname><given-names>M.</given-names></name></person-group><etal/> (<year>2014</year>). Controlled functional encryption. In: <italic>Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications Security, CCS ’14</italic>, New York, NY, USA. ACM, pp. 1280–1291.</mixed-citation>
    </ref>
    <ref id="btw073-B19">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Nikolaenko</surname><given-names>V.</given-names></name></person-group><etal/> (<year>2013</year>). Privacy-preserving matrix factorization. In: <italic>Proceedings of the 2013 ACM SIGSAC Conference on Computer and Communications Security, CCS ’13</italic>, New York, NY, USA. ACM, pp. 801–812.</mixed-citation>
    </ref>
    <ref id="btw073-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paulson</surname><given-names>J.N.</given-names></name></person-group><etal/> (<year>2013</year>) <article-title>Differential abundance analysis for microbial marker-gene surveys</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>1200</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">24076764</pub-id></mixed-citation>
    </ref>
    <ref id="btw073-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pop</surname><given-names>M.</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>Diarrhea in young children from low-income countries leads to large-scale alterations in intestinal microbiota composition</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R76</fpage>.<pub-id pub-id-type="pmid">24995464</pub-id></mixed-citation>
    </ref>
    <ref id="btw073-B22">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Troncoso-Pastoriza</surname><given-names>J.R.</given-names></name></person-group><etal/> (<year>2007</year>). Privacy preserving error resilient DNA searching through oblivious automata. In: <italic>Proceedings of the 14th ACM Conference on Computer and Communications Security, CCS ’07</italic>, New York, NY, USA. ACM, pp. 519–528.</mixed-citation>
    </ref>
    <ref id="btw073-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turnbaugh</surname><given-names>P.J.</given-names></name></person-group><etal/> (<year>2007</year>). <article-title>The human microbiome project: exploring the microbial part of ourselves in a changing world</article-title>. <source>Nature</source>, <volume>449</volume>, <fpage>801</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btw073-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turnbaugh</surname><given-names>P.J.</given-names></name></person-group><etal/> (<year>2009</year>) <article-title>A core gut microbiome in obese and lean twins</article-title>. <source>Nature</source>, <volume>457</volume>, <fpage>480</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">19043404</pub-id></mixed-citation>
    </ref>
    <ref id="btw073-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X.S.</given-names></name></person-group><etal/> (<year>2015</year>). Efficient genome-wide, privacy-preserving similar patient query based on private edit distance. In: <italic>Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security</italic>, CCS ’15, pp. 492–503.</mixed-citation>
    </ref>
    <ref id="btw073-B26">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zahur</surname><given-names>S.</given-names></name></person-group><etal/> (<year>2015</year><chapter-title>). Two halves make a whole</chapter-title> In: <source>Advances in Cryptology-EUROCRYPT 2015</source>, pp. <fpage>220</fpage>–<lpage>50</lpage>. <publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
  </ref-list>
</back>
