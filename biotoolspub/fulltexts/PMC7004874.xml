<?all-math-mml yes?>
<?use-mml?>
<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Methods?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7004874</article-id>
    <article-id pub-id-type="pmid">31819265</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-019-0669-3</article-id>
    <article-id pub-id-type="manuscript">nihpa1541890</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fast and accurate long-read assembly with wtdbg2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ruan</surname>
          <given-names>Jue</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref rid="CR1" ref-type="corresp">†</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref ref-type="aff" rid="A4">4</xref>
        <xref ref-type="aff" rid="A5">5</xref>
        <xref rid="CR1" ref-type="corresp">†</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Agricultural Genomics Institute, Chinese Academy of Agriculture Sciences, Shenzhen, China</aff>
    <aff id="A2"><label>2</label>Peng Cheng Laboratory, Shenzhen, China</aff>
    <aff id="A3"><label>3</label>Department of data sciences, Dana-Farber Cancer Institute, Boston, MA 02215, USA</aff>
    <aff id="A4"><label>4</label>Department of biomedical informatics, Harvard Medical School, Boston, MA 02115, USA</aff>
    <aff id="A5"><label>5</label>Broad Institute, Cambridge, MA 02142, USA</aff>
    <author-notes>
      <fn fn-type="con" id="FN1">
        <p id="P1"><bold>Author contribution.</bold> J.R. conceived the project, designed the algorithm and implemented wtdbg2. H.L. contributed to the development and drafted the manuscript. Both authors evaluated the results and revised the manuscript.</p>
      </fn>
      <corresp id="CR1"><label>†</label>To whom correspondence should be addressed. <email>ruanjue@caas.cn</email> and <email>hli@jimmy.harvard.edu</email>.</corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>6</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>09</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>09</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <volume>17</volume>
    <issue>2</issue>
    <fpage>155</fpage>
    <lpage>158</lpage>
    <!--elocation-id from pubmed: 10.1038/s41592-019-0669-3-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract id="ABS1">
      <p id="P2">Existing long-read assemblers require thousands of CPU hours to assemble a human genome and are being outpaced by sequencing technologies in terms of both throughput and cost. We developed a long-read assembler wtdbg2 (<ext-link ext-link-type="uri" xlink:href="https://github.com/ruanjue/wtdbg2">https://github.com/ruanjue/wtdbg2</ext-link>) that is 2–17 times as fast as published tools while achieving comparable contiguity and accuracy. It paves the way for population-scale long-read assembly in future.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p id="P3"><italic>De novo</italic> sequence assembly reconstructs a sample genome from relatively short sequence reads. It is essential to the study of new species and structural genomic changes that often fail mapping-based analysis as the reference genome may lack the regions of interest. With the rapid advances in single-molecule sequencing technologies by Pacific Biosciences (PacBio) and Oxford Nanopore Technologies (ONT), we are able to sequence reads of 10–100 kilobases (kb) at low cost. Such long reads resolve major repeat classes in primates and help to improve the contiguity of assemblies. Long-read assembly has become a routine for bacteria and small genomes, thanks to the development of several high-quality assemblers<sup><xref rid="R1" ref-type="bibr">1</xref>–<xref rid="R5" ref-type="bibr">5</xref></sup>. For mammalian genomes, however, existing assemblers may require significant computing resources. The computing cost with commercial cloud services is comparable to the sequencing cost with one ONT’s PromethION machine, which is capable of sequencing a human genome at 30-fold coverage in two days<sup><xref rid="R6" ref-type="bibr">6</xref></sup>. To address this issue, we developed wtdbg2, a new long-read assembler that is times faster for large genomes with little compromise on the assembly quality.</p>
  <p id="P4">Wtdbg2 broadly follows the overlap-layout-consensus paradigm. It advances the existing assemblers with a fast all-vs-all read alignment implementation and a novel layout algorithm based on fuzzy-Bruijn graph (FBG), a new data structure for sequence assembly that is related to sparse de Bruijn graphs and A-Bruijn graphs.</p>
  <p id="P5">For mammalian genomes, current read overlappers<sup><xref rid="R7" ref-type="bibr">7</xref>–<xref rid="R9" ref-type="bibr">9</xref></sup> split input reads into many smaller batches and perform all-vs-all alignment between batches. This strategy wastes compute time on repeated file I/O and on indexing and querying non-informative <italic>k</italic>-mers. These overlappers do not build a single hash table as they worry the hash table may take too much memory. Interestingly, this should not be a major concern. Wtdbg2 first loads all reads into memory and counts <italic>k</italic>-mer occurrences. It then takes each tiling 256bp subsequence on reads as one unit, defined as a <italic>bin</italic> (each small box in <xref rid="F1" ref-type="fig">Figure 1</xref>), and builds a hash table with keys being <italic>k</italic>-mers occurring ≥2 times in reads, and values being locations of associated bins on reads. For example, among PacBio reads sequenced from the CHM1 human genome to 60-fold coverage<sup><xref rid="R10" ref-type="bibr">10</xref></sup>, there are only 1.5 billion non-unique homopolymer-compressed 21-mers<sup><xref rid="R9" ref-type="bibr">9</xref></sup>. Staging raw read sequences in memory and constructing the hash table takes 250GB at the peak, which is comparable to the memory usage of short-read assemblers.</p>
  <p id="P6">Sequence binning described above aims to speed up pairwise alignment with dynamic programming (DP) between binned sequences. With 256bp binning, the DP matrix is 65536 (=256×256) times smaller than a per-base DP matrix as is used by the Smith-Waterman algorithm<sup><xref rid="R11" ref-type="bibr">11</xref></sup>. This reduces DP to a much smaller scale in comparison to <italic>k</italic>-mer based<sup><xref rid="R8" ref-type="bibr">8</xref>, <xref rid="R9" ref-type="bibr">9</xref></sup> or base-level DP<sup><xref rid="R7" ref-type="bibr">7</xref></sup>.</p>
  <p id="P7">FBG extends the basic ideas behind de Bruijn graph (DBG) to work with long noisy reads. In analogy to DBG, a “base” in FBG is a 256bp bin and a “<italic>K</italic>-mer” or <italic>K</italic>-bin in FBG consists of <italic>K</italic> consecutive bins on reads. A vertex in FBG is a <italic>K</italic>-bin and an edge between two vertices indicates their adjacency on a read. Unlike DBG, different <italic>K</italic>-bins may be represented by a single vertex if they are aligned together based on all-vs-all read alignment. This treatment tolerates errors in noisy long reads. FBG is closer to sparse DBG<sup><xref rid="R12" ref-type="bibr">12</xref></sup> than standard DBG in that it does not inspect every <italic>K</italic>-bin on reads. The sparsity reduces the memory to construct FBG. Furthermore, FBG explicitly keeps the read names and the offsets of bins going through each edge to retain long-range information without a separate “read threading” step as with standard DBG assembly. After graph simplification<sup><xref rid="R4" ref-type="bibr">4</xref>, <xref rid="R13" ref-type="bibr">13</xref></sup>, wtdbg2 writes the final FBG to disk with read sequences on edges contained in the file. Wtdbg2 constructs the final consensus with partial order alignment<sup><xref rid="R14" ref-type="bibr">14</xref></sup> over edge sequences.</p>
  <p id="P8">We evaluated wtdbg2 v2.5 on four datasets along with CANU-1.8<sup><xref rid="R3" ref-type="bibr">3</xref></sup>, FALCON-180831<sup><xref rid="R1" ref-type="bibr">1</xref></sup>, Flye-2.3.6<sup><xref rid="R2" ref-type="bibr">2</xref></sup>, MECAT-180314<sup><xref rid="R5" ref-type="bibr">5</xref></sup> and Ra-190327 (<xref rid="T1" ref-type="table">Table 1</xref>; see <xref rid="SD1" ref-type="supplementary-material">Supplementary Table 1</xref> for more datasets). We used minimap2 to align assembled contigs to the reference genome and to collect metrics. Depending on datasets, wtdbg2 is 2–17 times as fast as the closest competitors. Its contiguity and assembly accuracy are generally comparable to other assemblers. Wtdbg2 assemblies sometimes cover less reference genomes, which is a weakness of wtdbg2, but its contigs tend to have fewer duplicates (metric “% genome covered more than once” in the table). The low redundancy rate is particularly evident for the Col-0/Cvi-0 <italic>A. thaliana</italic> dataset that has a relatively high heterozygosity of ~1%. On a <italic>M. schizocarpa</italic> (banana) ONT dataset sequenced to 45-fold coverage<sup><xref rid="R15" ref-type="bibr">15</xref></sup>, wtdbg2 delivers a 507Mb assembly with 1.0Mb N50. While this is not as good as the published result, it is larger and more contiguous than the Flye and Ra assemblies (<xref rid="S1" ref-type="sec">Online Methods</xref>).</p>
  <p id="P9">For samples close to the reference genome, we also compared the consensus accuracy before and after signal-based polishing<sup><xref rid="R16" ref-type="bibr">16</xref></sup> when applicable. Without polishing, CANU, Flye and MECAT tend to produce better consensus sequences. This is probably because they perform at least two rounds of error correction or the consensus step, while wtdbg2 applies one round of consensus only. After Quiver polishing, the consensus accuracy of all assemblers is very close and significantly higher than the accuracy of consensus without polishing. This observation reconfirms that polishing consensus is still necessary<sup><xref rid="R17" ref-type="bibr">17</xref></sup> and suggests that the pre-polishing consensus accuracy is not obviously correlated with post-polishing accuracy. In the past, Quiver was taking a small fraction of total assembly time, but it is now several times slower than wtdbg2 (7 wall-clock hours for C. elegans and 37 wall-clock hours for CHM1) and becomes the new bottleneck. This calls for future improvement to the polishing step.</p>
  <p id="P10">We assembled four additional human datasets (<xref rid="T2" ref-type="table">Table 2</xref>). Wtdbg2 finishes each assembly in &lt;2 days on a single computer. This performance broadly matches the throughput of a PromethION machine. In comparison, Flye and CANU required ~5,000 and ~40,000 CPU hours, respectively, to assemble NA12878<sup><xref rid="R2" ref-type="bibr">2</xref>,<xref rid="R18" ref-type="bibr">18</xref></sup>. For this sample, wtdbg2 uses 235GB memory, less than half of memory used by Flye. Partly due to the relatively low memory footprint, wtdbg2 is scalable to huge non-human genomes. It can assemble axolotl, with a 32Gb genome, in two days using 1.2TB memory. The NG50 is 392kb, longer than the published assembly<sup><xref rid="R19" ref-type="bibr">19</xref></sup>.</p>
  <p id="P11">Ten years ago when the Illumina sequencing technology entered the market, the sheer volume of data effectively decommissioned all aligners and assemblers developed earlier. History repeats itself. Affordable population-scale long-read sequencing is on the horizon. Wtdbg2 is an assembler that is able to keep up with the throughput and the cost. With heterozygote-aware consensus algorithms and phased assembly planned for future, wtdbg2 and upcoming tools might fundamentally change the current practices on sequence data analysis.</p>
  <sec id="S1">
    <title>Online methods</title>
    <sec id="S2">
      <title>The wtdbg2 algorithm</title>
      <p id="P12">Wtdbg2 reads all input sequences into memory and encodes each base with 2 bits. By default, it selects a quarter of <italic>k</italic>-mers based on their hash code and counts their occurrences using a hash table with 46-bit key to store a <italic>k</italic>-mer and 17-bit value to store its count. Wtdbg2 filters out <italic>k</italic>-mer occurring once or over 1000 times in reads, and then scans reads again to build a hash table for the remaining <italic>k</italic>-mers and their positions in bins.</p>
      <p id="P13">For all-vs-all read alignment, wtdbg2 traverses each read, from the longest to the shortest, and uses the hash table to retrieve the reads that share <italic>k</italic>-mers with the read in query. It takes each bin as a basepair and applies Smith-Waterman-like DP between binned sequences, penalizing gaps and mismatching bins that do not share <italic>k</italic>-mers. Wtdbg2 retains alignments no shorter than 8×256bp. After finishing alignments for all reads, wtdbg2 frees the hash table but keeps the all-vs-all alignments in memory (alignments are also written to disk as intermediate results).</p>
      <p id="P14">At this step, wtdbg2 drops base sequences. It only sees binned sequences and the alignments between them. On an <italic>L</italic>-long binned sequence <italic>B</italic> = <italic>b</italic><sub>1</sub>
<italic>b</italic><sub>2</sub> … <italic>b</italic><sub><italic>L</italic></sub>, a <italic>K</italic>-bin <italic>B</italic><sub><italic>Ki</italic></sub> = <italic>b</italic><sub><italic>i</italic></sub>
<italic>b</italic><sub><italic>i</italic>+1</sub> … <italic>b</italic><sub><italic>i+K</italic>−1</sub> is a <italic>K</italic>-long subsequence starting at the <italic>i</italic>-th position on <italic>B</italic>. If binned sequences <italic>B</italic> and <italic>B</italic>’ can be aligned, we can infer the overlap length between <italic>K</italic>-bins <italic>B</italic><sub><italic>Ki</italic></sub> and <italic>B′</italic><sub><italic>Ki′</italic></sub> by lifting their coordinates between the two sequences based on the alignment. We say two <italic>K</italic>-bins <italic>B</italic><sub><italic>Ki</italic></sub> and <italic>b′</italic><sub><italic>Ki′</italic></sub> are <italic>equivalent</italic> if the overlap length between them is <italic>K</italic> (i.e. the two bins are completely aligned). Using the all-vs-all alignment, wtdbg2 collects a maximal non-redundant set Ω of <italic>K</italic>-bins such that no <italic>K</italic>-bin in Ω is equivalent to others. For each <italic>K</italic>-bin in Ω, its <italic>coverage</italic> is defined as the number of equivalent <italic>K</italic>-bins in all reads. Wtdbg2 records the locations and coverage of each <italic>K</italic>-bin.</p>
      <p id="P15">Two <italic>K</italic>-bins in Ω may have an overlap up to <italic>K</italic>-1 bins. The vertex set <italic>V</italic> of FBG is intended to be an Ω’s subset in which no <italic>K</italic>-bins overlap with each other. To construct <italic>V</italic>, wtdbg2 traverses each non-redundant <italic>K</italic>-bin in the descending order of their initial coverage. Given a <italic>K</italic>-bin <italic>B</italic><sub><italic>K</italic></sub>, wtdbg2 reduces its coverage by deducting the number of <italic>K</italic>-bins already in <italic>V</italic> that overlap with <italic>B</italic><sub><italic>K</italic></sub>. If the reduced coverage is ≥3 and higher than half of the initial coverage, <italic>B</italic><sub><italic>K</italic></sub> will be added to <italic>V</italic>; otherwise it will be ignored. After the construction of <italic>V</italic>, wtdbg2 adds an edge between two <italic>K</italic>-bins if they are located on the same read. There are often multiple edges between two <italic>K</italic>-bins. Wtdbg2 retains one edge and keeps the count. An edge covered by &lt;3 reads are discarded. This generates FBG. The coverage thresholds can be adjusted on the wtdbg2 command line.</p>
    </sec>
    <sec id="S3">
      <title>Assembling evaluation datasets</title>
      <p id="P16">With wtdbg2, we specified the genome size and sequence technology on the command line, which automatically applies multiple options. Specifically, we used “-xrs -g100m” for <italic>C. elegans</italic>, “-xsq -g125m” for <italic>A. thaliana</italic>, “-xrs -g144m” for <italic>D. melanogaster</italic> A4 strain, “-xont -g144m” for the ISO1 strain, “-xrs -g3g” for CHM1, “-xont -g3g” for human NA12878 and NA19240 ONT reads, “-xsq -g3g” for HG00733, “-xccs -g3g” for NA24385 and “-xrs -g3g” for the axolotl dataset. Here, option “-x” specifies the preset. “rs” uses homopolymer-compressed<sup><xref rid="R9" ref-type="bibr">9</xref></sup> (HPC) 21-mer. Both “sq” and “ont” apply 15-mer to genomes smaller than 1Gb but use HPC 19-mer for larger genomes. Note that 4<sup>15</sup>=1GB. We change the type of k-mers for larger genomes to avoid non-specific seed hits, which reduce the performance. We use shorter k-mers for Nanopore data due to their higher error rates and relatively low coverage in our evaluation. Increasing k-mer length for Nanopore helps to resolve paralogous regions but reduces alignment sensitivity and leads to more fragmented assemblies for data at ~30-fold coverage.</p>
      <p id="P17">For CANU, Flye and MECAT, we similarly specified the genome size and the sequencing technology only. The FALCON configure file for assembling <italic>C. elegans</italic> is provided as <xref rid="SD1" ref-type="supplementary-material">supplementary data</xref>. The FALCON <italic>A. thaliana</italic> assembly was downloaded at <ext-link ext-link-type="uri" xlink:href="http://bit.ly/pbpubdat">http://bit.ly/pbpubdat</ext-link>. We are using AC:GCA_000983455.1 for the CANU CHM1 assembly and AC:GCA_001297185.1 for the FALCON CHM1 assembly.</p>
    </sec>
    <sec id="S4">
      <title>Assembling the <italic>M. schizocarpa</italic> (banana) dataset</title>
      <p id="P18">The authors who produced the dataset failed to run CANU, so we skipped CANU and MECAT (which is based on CANU). This is a nanopore dataset to which FALCON is not applicable. We used wtdbg2’s nanopore preset for large genome for assembly (“-xont -g600m -k0 -p19”) and got an 507Mb assembly with N50=1.0Mb for contigs longer than 10kb. Flye assembled a 505Mb genome with N50=300kb. The authors of the dataset managed to get N50=2.1Mb with Ra on all raw reads. However, with Ra, we could only produce a small assembly of 490Mb at 643kb N50. Instead, we get the best contiguity with miniasm, which generated a 520Mb assembly with N50=1.9Mb. Wtdbg2 is ~10 times as fast as Flye and Ra.</p>
    </sec>
    <sec id="S5">
      <title>Evaluating assemblies</title>
      <p id="P19">To count alignment breakpoints, we mapped all assemblies to the corresponding reference genomes with minimap2 under the option “--paf-no-hit -cxasm20 -r2k -z1000,500”. We used the companion script paftools.js to collect various metrics (command line: “paftools.js asmstat -q50000 -d.1”, where “-q” sets the minimum contig length and “-d” sets the max sequence divergence). To count substitutions and gaps, we applied a different minimap2 setting “-cxasm5 --cs -r2k”. This setting introduces more alignment breakpoints but avoids poorly aligned regions harboring spuriously high number of differences that are likely caused by large-scale variations and skew the counts. We used “paftools.js call” to call variations.</p>
    </sec>
    <sec sec-type="data-availability" id="S6">
      <title>Data availability</title>
      <p id="P20"><italic>C. elegans</italic> and <italic>A. thaliana</italic> Ler-0 reads are available at the PacBio public datasets portal: <ext-link ext-link-type="uri" xlink:href="http://bit.ly/pbpubdat">http://bit.ly/pbpubdat</ext-link>. We downloaded SRR5439404 for the <italic>D. melanogaster</italic> A4 strain, SRR6702603 for the <italic>D. melanogaster</italic> reference ISO1 strain, ERR2571284 through ERR2571302 for <italic>M. schizocarpa</italic> (banana; MinION reads only), PRJNA378970 for axolotl, SRR7615963 for HG00733, and ERR2631600 and ERR2631601 for NA19240. CHM1 reads were acquired from SRP044331 (<ext-link ext-link-type="uri" xlink:href="http://bit.ly/chm1p6c4">http://bit.ly/chm1p6c4</ext-link> for raw signals), NA12878 reads from <ext-link ext-link-type="uri" xlink:href="http://bit.ly/na12878ont">http://bit.ly/na12878ont</ext-link> (release 5) and NA24385 from <ext-link ext-link-type="uri" xlink:href="http://bit.ly/NA24385ccs">http://bit.ly/NA24385ccs</ext-link>. For the <italic>A. thaliana</italic> Col-0/Cvi-0 dataset, the FASTQ files at SRA (AC: PRJNA314706) were not processed properly. Jason Chin, the first author of the paper<sup><xref rid="R1" ref-type="bibr">1</xref></sup> describing the dataset, provided us with reprocessed raw reads, which are now hosted at public ftp site: <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.dfci.harvard.edu/pub/hli/col0-cvi0/">ftp://ftp.dfci.harvard.edu/pub/hli/col0-cvi0/</ext-link>. The CHM1 CANU and FALCON assemblies and the axolotl assembly are available at NCBI (GCA_000983455.1, GCA_001297185.1 and GCA_002915635.1, respectively). All the evaluated assemblies generated by us can be obtained at <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.dfci.harvard.edu/pub/hli/wtdbg/">ftp://ftp.dfci.harvard.edu/pub/hli/wtdbg/</ext-link>. The FTP site also provides the detailed command lines and the FALCON configuration files.</p>
    </sec>
    <sec id="S7">
      <title>Reporting Summary</title>
      <p id="P21">Further information on research design is available in the Nature Research Reporting Summary linked to this article.</p>
    </sec>
    <sec id="S8">
      <title>Code availability</title>
      <p id="P22">The wtdbg2 source code is hosted by GitHub at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ruanjue/wtdbg2">https://github.com/ruanjue/wtdbg2</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM1">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS1541890-supplement-1.xlsx" orientation="portrait" xlink:type="simple" id="d36e638" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S9">
    <title>Acknowledgements</title>
    <p id="P23">We are grateful to Jason Chin for providing the properly processed raw reads for the <italic>A. thaliana</italic> Col-0/Cvi-0 dataset. We would like to thank Chengxi Ye from University of Maryland for frequent and fruitful discussion in the development of wtdbg and thank Alun Li and Shigang Wu from CAAS for the help in polishing assemblies. We also thank the reviewers whose comments have helped us to improve wtdbg2. This study was supported by Natural Science Foundation of China (NSFC; grant 31571353 and 31822029 to J.R.) and by US National Institutes Health (NIH; grant R01-HG010040 to H.L.).</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement" id="FN2">
      <p id="P24"><bold>Competing interests.</bold> The authors declare no competing interests.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>Reference</title>
    <ref id="R1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><name><surname>Chin</surname><given-names>CS</given-names></name><etal/><source>Nat Methods</source><volume>13</volume>, <fpage>1050</fpage>–<lpage>1054</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27749838</pub-id></mixed-citation>
    </ref>
    <ref id="R2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><name><surname>Kolmogorov</surname><given-names>M</given-names></name>, <name><surname>Yuan</surname><given-names>J</given-names></name>, <name><surname>Lin</surname><given-names>Y</given-names></name> &amp; <name><surname>Pevzner</surname><given-names>PA</given-names></name>
<source>Nat Biotechnol</source>
<volume>37</volume>, <fpage>540</fpage>–<lpage>546</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">30936562</pub-id></mixed-citation>
    </ref>
    <ref id="R3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><name><surname>Koren</surname><given-names>S</given-names></name><etal/><source>Genome Res</source><volume>27</volume>, <fpage>722</fpage>–<lpage>736</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28298431</pub-id></mixed-citation>
    </ref>
    <ref id="R4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name><source>Bioinformatics</source><volume>32</volume>, <fpage>2103</fpage>–<lpage>2110</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27153593</pub-id></mixed-citation>
    </ref>
    <ref id="R5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><name><surname>Xiao</surname><given-names>CL</given-names></name><etal/><source>Nat Methods</source><volume>14</volume>, <fpage>1072</fpage>–<lpage>1074</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28945707</pub-id></mixed-citation>
    </ref>
    <ref id="R6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><name><surname>De Coster</surname><given-names>W</given-names></name><etal/><source>Genome Res</source><volume>29</volume>, <fpage>1178</fpage>–<lpage>1187</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">31186302</pub-id></mixed-citation>
    </ref>
    <ref id="R7">
      <label>7.</label>
      <mixed-citation publication-type="book"><name><surname>Myers</surname><given-names>G</given-names></name> in <source>WABI</source>, Vol. <volume>8701</volume> (eds. <name><surname>Brown</surname><given-names>DG</given-names></name> &amp; <name><surname>Morgenstern</surname><given-names>B</given-names></name>) <fpage>52</fpage>–<lpage>67</lpage> (<publisher-name>Springer</publisher-name>, <publisher-loc>Wroclaw, Poland</publisher-loc>; <year>2014</year>).</mixed-citation>
    </ref>
    <ref id="R8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><name><surname>Berlin</surname><given-names>K</given-names></name><etal/><source>Nat Biotechnol</source><volume>33</volume>, <fpage>623</fpage>–<lpage>630</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26006009</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name><source>Bioinformatics</source><volume>34</volume>, <fpage>3094</fpage>–<lpage>3100</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29750242</pub-id></mixed-citation>
    </ref>
    <ref id="R10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><name><surname>Chaisson</surname><given-names>MJ</given-names></name>, <name><surname>Wilson</surname><given-names>RK</given-names></name> &amp; <name><surname>Eichler</surname><given-names>EE</given-names></name>
<source>Nat Rev Genet</source>
<volume>16</volume>, <fpage>627</fpage>–<lpage>640</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26442640</pub-id></mixed-citation>
    </ref>
    <ref id="R11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>TF</given-names></name> &amp; <name><surname>Waterman</surname><given-names>MS</given-names></name>
<source>J Mol Biol</source>
<volume>147</volume>, <fpage>195</fpage>–<lpage>197</lpage> (<year>1981</year>).<pub-id pub-id-type="pmid">7265238</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><name><surname>Ye</surname><given-names>C</given-names></name>, <name><surname>Ma</surname><given-names>ZS</given-names></name>, <name><surname>Cannon</surname><given-names>CH</given-names></name>, <name><surname>Pop</surname><given-names>M</given-names></name> &amp; <name><surname>Yu</surname><given-names>DW</given-names></name>
<source>BMC Bioinformatics</source>
<volume>13</volume>
<issue>Suppl 6</issue>, <fpage>S1</fpage> (<year>2012</year>).</mixed-citation>
    </ref>
    <ref id="R13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><name><surname>Zerbino</surname><given-names>DR</given-names></name> &amp; <name><surname>Birney</surname><given-names>E</given-names></name>
<source>Genome Res</source>
<volume>18</volume>, <fpage>821</fpage>–<lpage>829</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18349386</pub-id></mixed-citation>
    </ref>
    <ref id="R14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>C</given-names></name>, <name><surname>Grasso</surname><given-names>C</given-names></name> &amp; <name><surname>Sharlow</surname><given-names>MF</given-names></name>
<source>Bioinformatics</source>
<volume>18</volume>, <fpage>452</fpage>–<lpage>464</lpage> (<year>2002</year>).<pub-id pub-id-type="pmid">11934745</pub-id></mixed-citation>
    </ref>
    <ref id="R15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><name><surname>Belser</surname><given-names>C</given-names></name><etal/><source>Nat Plants</source><volume>4</volume>, <fpage>879</fpage>–<lpage>887</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30390080</pub-id></mixed-citation>
    </ref>
    <ref id="R16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><name><surname>Chin</surname><given-names>CS</given-names></name><etal/><source>Nat Methods</source><volume>10</volume>, <fpage>563</fpage>–<lpage>569</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23644548</pub-id></mixed-citation>
    </ref>
    <ref id="R17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><name><surname>Watson</surname><given-names>M</given-names></name> &amp; <name><surname>Warr</surname><given-names>A</given-names></name>
<source>Nat Biotech</source> (<year>2019</year>).</mixed-citation>
    </ref>
    <ref id="R18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><name><surname>Jain</surname><given-names>M</given-names></name><etal/><source>Nat Biotechnol</source><volume>36</volume>, <fpage>338</fpage>–<lpage>345</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29431738</pub-id></mixed-citation>
    </ref>
    <ref id="R19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><name><surname>Nowoshilow</surname><given-names>S</given-names></name><etal/><source>Nature</source><volume>554</volume>, <fpage>50</fpage>–<lpage>55</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29364872</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Fig. 1</label>
    <caption>
      <p id="P25">Outline of the wtdbg2 algorithm. Wtdbg2 groups 256 base pairs into a bin, a small box in the figure. Bins/boxes with the same color suggest they share <italic>k</italic>-mers, except that a gray bin doesn’t match other bins due to sequencing errors. Wtdbg2 performs all-vs-all alignment between binned reads and constructs the fuzzy-Bruijn assembly graph, where a vertex is a 4-bin segment and an edge connects two vertices if they are both present on a read. Wtdbg2 then trims tips and pops bubbles and produces the final contig sequences from the consensus of read subsequences attached to each edge.</p>
    </caption>
    <graphic xlink:href="nihms-1541890-f0001"/>
  </fig>
  <table-wrap id="T1" position="float" orientation="portrait">
    <label>Table 1.</label>
    <caption>
      <title>Evaluating long-read assemblies</title>
      <p id="P26">FALCON requires PacBio-style read names and does not work with ONT data or the A4 strain of <italic>D. melanogaster</italic> which was downloaded from SRA. The <italic>A. thaliana</italic> assembly by FALCON is acquired from PacBio website as our assembly is fragmented. MECAT produces fragmented assemblies for the ONT dataset. Human assemblies were performed by the developers of each assembler. Base-level evaluations and NGA50 are only reported when the sequenced strain or individual is close to the reference genome. BUSCO scores are computed for genomes sequenced to 50-fold coverage or higher.</p>
    </caption>
    <table frame="hsides" rules="none">
      <colgroup span="1">
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
      </colgroup>
      <thead>
        <tr>
          <th align="left" valign="top" rowspan="1" colspan="1">Dataset</th>
          <th align="left" valign="top" rowspan="1" colspan="1">Metric</th>
          <th align="center" valign="top" rowspan="1" colspan="1">CANU</th>
          <th align="center" valign="top" rowspan="1" colspan="1">FALCON</th>
          <th align="center" valign="top" rowspan="1" colspan="1">Flye</th>
          <th align="center" valign="top" rowspan="1" colspan="1">MECAT</th>
          <th align="center" valign="top" rowspan="1" colspan="1">Ra</th>
          <th align="center" valign="top" rowspan="1" colspan="1">Wtdbg2</th>
        </tr>
        <tr>
          <th colspan="8" align="left" valign="top" rowspan="1">
            <hr/>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td rowspan="12" align="left" valign="top" colspan="1"><italic>C. elegans</italic> Bristo ref. strain PacBio x80</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Total length (&gt;= 50kbp)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">106.5Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">100.8Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">102.0Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">102.1Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">108.1Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">104.8Mb</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% reference genome covered</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.58</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.16</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.29</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.51</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.55</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.37</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% genome covered more than once</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.33</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.25</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.15</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.35</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.69</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.13</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG75 (75% ref. in contigs longer than NG75)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,884,280</td>
          <td align="right" valign="top" rowspan="1" colspan="1">935,802</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,275,590</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,424,674</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,320,829</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,255,274</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG50 (50% ref. in contigs longer than NG50)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,677,990</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,629,544</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,926,198</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,113,456</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,047,105</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3,596,268</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NGA50 (50% ref in alignments longer than NGA50)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,283,814</td>
          <td align="right" valign="top" rowspan="1" colspan="1">980,062</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,087,075</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,119,713</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,019,386</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,365,602</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># alignment breakpoints</td>
          <td align="right" valign="top" rowspan="1" colspan="1">681</td>
          <td align="right" valign="top" rowspan="1" colspan="1">192</td>
          <td align="right" valign="top" rowspan="1" colspan="1">284</td>
          <td align="right" valign="top" rowspan="1" colspan="1">278</td>
          <td align="right" valign="top" rowspan="1" colspan="1">724</td>
          <td align="right" valign="top" rowspan="1" colspan="1">177</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">BUSCO (% complete single-copy genes)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">98.2%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">88.1%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">98.4%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">97.0%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">90.9%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">97.5%</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># substitutions/1Mb (pre-/post-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">64.1 / 62.2</td>
          <td align="right" valign="top" rowspan="1" colspan="1">233.2 / 50.1</td>
          <td align="right" valign="top" rowspan="1" colspan="1">61.6 / 57.6</td>
          <td align="right" valign="top" rowspan="1" colspan="1">65.9 / 62.8</td>
          <td align="right" valign="top" rowspan="1" colspan="1">309.9 / 66.8</td>
          <td align="right" valign="top" rowspan="1" colspan="1">83.8 / 60.3</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># insertions/1Mb (pre-/post-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">31.1 / 22.4</td>
          <td align="right" valign="top" rowspan="1" colspan="1">592.7 / 19.4</td>
          <td align="right" valign="top" rowspan="1" colspan="1">29.8 / 21.8</td>
          <td align="right" valign="top" rowspan="1" colspan="1">43.9 / 21.9</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3011.2 / 24.3</td>
          <td align="right" valign="top" rowspan="1" colspan="1">110.6 / 20.8</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># deletions/1Mb (pre-/post-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">152.8 / 55.1</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1822.7 / 56.7</td>
          <td align="right" valign="top" rowspan="1" colspan="1">381.4 / 56.9</td>
          <td align="right" valign="top" rowspan="1" colspan="1">366.0 / 57.9</td>
          <td align="right" valign="top" rowspan="1" colspan="1">144.1 / 53.1</td>
          <td align="right" valign="top" rowspan="1" colspan="1">343.0 / 57.7</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">Wall-clock time over 32 CPUs (pre-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">9h30m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2h06m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2h58m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3h08m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2h23m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">26m</td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" rowspan="1">
            <hr/>
          </td>
        </tr>
        <tr>
          <td rowspan="11" align="left" valign="top" colspan="1"><italic>D. melanogaster</italic> ISO1 ref. strain ONT x32</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Total length (&gt;= 50kbp)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">135.0Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">130.7Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">126.5Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">127.4Mb</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% reference genome covered</td>
          <td align="right" valign="top" rowspan="1" colspan="1">91.74</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">89.40</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">86.35</td>
          <td align="right" valign="top" rowspan="1" colspan="1">89.34</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% genome covered more than once</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1.19</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">0.14</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">0.68</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.22</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG75</td>
          <td align="right" valign="top" rowspan="1" colspan="1">714,013</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1,367,004</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">685,943</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,752,322</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG50</td>
          <td align="right" valign="top" rowspan="1" colspan="1">4,298,595</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">6,016,667</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1,898,336</td>
          <td align="right" valign="top" rowspan="1" colspan="1">10,631,323</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NGA50</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,837,928</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">2,210,468</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1,700,400</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,989,107</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># alignment breakpoints</td>
          <td align="right" valign="top" rowspan="1" colspan="1">823</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">248</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">225</td>
          <td align="right" valign="top" rowspan="1" colspan="1">276</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># substitutions per 1Mb (pre-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">847.6</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1318</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1976.2</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1109.2</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># insertions per 1Mb (pre-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">255.9</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">10669.9</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">4388.7</td>
          <td align="right" valign="top" rowspan="1" colspan="1">371.2</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># deletions per 1Mb (pre-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">7168.2</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1901.3</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">2324.6</td>
          <td align="right" valign="top" rowspan="1" colspan="1">9746.3</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">Wall-clock time over 32 CPUs (pre-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">22h23m</td>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1h41m</td>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">2h10m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">50m</td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" rowspan="1">
            <hr/>
          </td>
        </tr>
        <tr>
          <td rowspan="8" align="left" valign="top" colspan="1"><italic>A. thaliana</italic> F1 generation of Col-0 and Cvi-0 strains (~1% heterozygosity) PacBio x185</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Total length (&gt;= 50kbp)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">196.5Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">138.1Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">122.3Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">188.4Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">133.3Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">125.0Mb</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% reference genome covered</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.04</td>
          <td align="right" valign="top" rowspan="1" colspan="1">97.03</td>
          <td align="right" valign="top" rowspan="1" colspan="1">93.55</td>
          <td align="right" valign="top" rowspan="1" colspan="1">97.47</td>
          <td align="right" valign="top" rowspan="1" colspan="1">92.52</td>
          <td align="right" valign="top" rowspan="1" colspan="1">92.66</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% genome covered more than once</td>
          <td align="right" valign="top" rowspan="1" colspan="1">47.61</td>
          <td align="right" valign="top" rowspan="1" colspan="1">11.35</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3.72</td>
          <td align="right" valign="top" rowspan="1" colspan="1">51.46</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3.38</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1.08</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG75</td>
          <td align="right" valign="top" rowspan="1" colspan="1">460,325</td>
          <td align="right" valign="top" rowspan="1" colspan="1">4,810,976</td>
          <td align="right" valign="top" rowspan="1" colspan="1">180,227</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,096,121</td>
          <td align="right" valign="top" rowspan="1" colspan="1">404,218</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,182,254</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG50</td>
          <td align="right" valign="top" rowspan="1" colspan="1">873,036</td>
          <td align="right" valign="top" rowspan="1" colspan="1">7,979,657</td>
          <td align="right" valign="top" rowspan="1" colspan="1">370,306</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3,525,236</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,210,836</td>
          <td align="right" valign="top" rowspan="1" colspan="1">8,707,235</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># alignment breakpoints</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3,059</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,102</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,674</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,573</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,078</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,777</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">BUSCO (% complete single-copy genes)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">43.8%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">91.9%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">93.1%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">49.2%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">87.8%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">90.3%</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">Wall-clock time over 32 CPUs (pre-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">30h42m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">(by PacBio)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">20h3m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">11h33m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">18h33m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1h12m</td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" rowspan="1">
            <hr/>
          </td>
        </tr>
        <tr>
          <td rowspan="12" align="left" valign="top" colspan="1">Human CHM1 cell line PacBio x100</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Total length (&gt;= 50kbp)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,837Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,938Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">2,712Mb</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% reference genome covered</td>
          <td align="right" valign="top" rowspan="1" colspan="1">89.33</td>
          <td align="right" valign="top" rowspan="1" colspan="1">90.13</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">86.03</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% genome covered more than once</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.53</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.72</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">0.02</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG75</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3,793,440</td>
          <td align="right" valign="top" rowspan="1" colspan="1">7,726,658</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">4,387,668</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG50</td>
          <td align="right" valign="top" rowspan="1" colspan="1">17,570,750</td>
          <td align="right" valign="top" rowspan="1" colspan="1">26,132,317</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">18,220,221</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NGA50</td>
          <td align="right" valign="top" rowspan="1" colspan="1">7,128,216</td>
          <td align="right" valign="top" rowspan="1" colspan="1">9,262,902</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">8,017,241</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># alignment breakpoints</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,795</td>
          <td align="right" valign="top" rowspan="1" colspan="1">7,966</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1,619</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">BUSCO (% complete single-copy genes)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">91.3%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">91.5%</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">90.5%</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># substitutions per 1Mb (post-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">961.5</td>
          <td align="right" valign="top" rowspan="1" colspan="1">966.6</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">963.6</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># insertions per 1Mb (post-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">142.8</td>
          <td align="right" valign="top" rowspan="1" colspan="1">140.1</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">140.2</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># deletions per 1Mb (post-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">140.0</td>
          <td align="right" valign="top" rowspan="1" colspan="1">137.6</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">141.1</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">Total CPU hours (pre-polish CPU hours)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">22,750</td>
          <td align="right" valign="top" rowspan="1" colspan="1">68,789</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">2,506 (632)</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="T2" position="float" orientation="portrait">
    <label>Table 2.</label>
    <caption>
      <p id="P27">Wtdbg2 performance on other human genomes. Performance metrics were obtained on a machine with 96 CPU cores. G. size: size of the reference genome; Cov.: sequencing coverage; NG50: 50% of the reference genome are in contigs longer than this length.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <colgroup span="1">
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
      </colgroup>
      <thead>
        <tr>
          <th align="left" valign="top" rowspan="1" colspan="1">Data set</th>
          <th align="left" valign="top" rowspan="1" colspan="1">Technology</th>
          <th align="left" valign="top" rowspan="1" colspan="1">Cov.</th>
          <th align="left" valign="top" rowspan="1" colspan="1">CPU hour</th>
          <th align="left" valign="top" rowspan="1" colspan="1">Real hour</th>
          <th align="left" valign="top" rowspan="1" colspan="1">Peak RAM (GB)</th>
          <th align="left" valign="top" rowspan="1" colspan="1">NG50 (Mb)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NA12878</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Nanopore</td>
          <td align="right" valign="top" rowspan="1" colspan="1">36</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1513</td>
          <td align="right" valign="top" rowspan="1" colspan="1">26</td>
          <td align="right" valign="top" rowspan="1" colspan="1">235</td>
          <td align="right" valign="top" rowspan="1" colspan="1">10.3</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NA19240</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Nanopore</td>
          <td align="right" valign="top" rowspan="1" colspan="1">35</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1197</td>
          <td align="right" valign="top" rowspan="1" colspan="1">19</td>
          <td align="right" valign="top" rowspan="1" colspan="1">226</td>
          <td align="right" valign="top" rowspan="1" colspan="1">4.4</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NA24385</td>
          <td align="left" valign="top" rowspan="1" colspan="1">PacBio CCS</td>
          <td align="right" valign="top" rowspan="1" colspan="1">28</td>
          <td align="right" valign="top" rowspan="1" colspan="1">410</td>
          <td align="right" valign="top" rowspan="1" colspan="1">6</td>
          <td align="right" valign="top" rowspan="1" colspan="1">108</td>
          <td align="right" valign="top" rowspan="1" colspan="1">11.8</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">HG00733</td>
          <td align="left" valign="top" rowspan="1" colspan="1">PacBio Sequel</td>
          <td align="right" valign="top" rowspan="1" colspan="1">93</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1906</td>
          <td align="right" valign="top" rowspan="1" colspan="1">37</td>
          <td align="right" valign="top" rowspan="1" colspan="1">338</td>
          <td align="right" valign="top" rowspan="1" colspan="1">29.2</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
<?all-math-mml yes?>
<?use-mml?>
<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Methods?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7004874</article-id>
    <article-id pub-id-type="pmid">31819265</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-019-0669-3</article-id>
    <article-id pub-id-type="manuscript">nihpa1541890</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fast and accurate long-read assembly with wtdbg2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ruan</surname>
          <given-names>Jue</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref rid="CR1" ref-type="corresp">†</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref ref-type="aff" rid="A4">4</xref>
        <xref ref-type="aff" rid="A5">5</xref>
        <xref rid="CR1" ref-type="corresp">†</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Agricultural Genomics Institute, Chinese Academy of Agriculture Sciences, Shenzhen, China</aff>
    <aff id="A2"><label>2</label>Peng Cheng Laboratory, Shenzhen, China</aff>
    <aff id="A3"><label>3</label>Department of data sciences, Dana-Farber Cancer Institute, Boston, MA 02215, USA</aff>
    <aff id="A4"><label>4</label>Department of biomedical informatics, Harvard Medical School, Boston, MA 02115, USA</aff>
    <aff id="A5"><label>5</label>Broad Institute, Cambridge, MA 02142, USA</aff>
    <author-notes>
      <fn fn-type="con" id="FN1">
        <p id="P1"><bold>Author contribution.</bold> J.R. conceived the project, designed the algorithm and implemented wtdbg2. H.L. contributed to the development and drafted the manuscript. Both authors evaluated the results and revised the manuscript.</p>
      </fn>
      <corresp id="CR1"><label>†</label>To whom correspondence should be addressed. <email>ruanjue@caas.cn</email> and <email>hli@jimmy.harvard.edu</email>.</corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>6</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>09</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>09</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <volume>17</volume>
    <issue>2</issue>
    <fpage>155</fpage>
    <lpage>158</lpage>
    <!--elocation-id from pubmed: 10.1038/s41592-019-0669-3-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract id="ABS1">
      <p id="P2">Existing long-read assemblers require thousands of CPU hours to assemble a human genome and are being outpaced by sequencing technologies in terms of both throughput and cost. We developed a long-read assembler wtdbg2 (<ext-link ext-link-type="uri" xlink:href="https://github.com/ruanjue/wtdbg2">https://github.com/ruanjue/wtdbg2</ext-link>) that is 2–17 times as fast as published tools while achieving comparable contiguity and accuracy. It paves the way for population-scale long-read assembly in future.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p id="P3"><italic>De novo</italic> sequence assembly reconstructs a sample genome from relatively short sequence reads. It is essential to the study of new species and structural genomic changes that often fail mapping-based analysis as the reference genome may lack the regions of interest. With the rapid advances in single-molecule sequencing technologies by Pacific Biosciences (PacBio) and Oxford Nanopore Technologies (ONT), we are able to sequence reads of 10–100 kilobases (kb) at low cost. Such long reads resolve major repeat classes in primates and help to improve the contiguity of assemblies. Long-read assembly has become a routine for bacteria and small genomes, thanks to the development of several high-quality assemblers<sup><xref rid="R1" ref-type="bibr">1</xref>–<xref rid="R5" ref-type="bibr">5</xref></sup>. For mammalian genomes, however, existing assemblers may require significant computing resources. The computing cost with commercial cloud services is comparable to the sequencing cost with one ONT’s PromethION machine, which is capable of sequencing a human genome at 30-fold coverage in two days<sup><xref rid="R6" ref-type="bibr">6</xref></sup>. To address this issue, we developed wtdbg2, a new long-read assembler that is times faster for large genomes with little compromise on the assembly quality.</p>
  <p id="P4">Wtdbg2 broadly follows the overlap-layout-consensus paradigm. It advances the existing assemblers with a fast all-vs-all read alignment implementation and a novel layout algorithm based on fuzzy-Bruijn graph (FBG), a new data structure for sequence assembly that is related to sparse de Bruijn graphs and A-Bruijn graphs.</p>
  <p id="P5">For mammalian genomes, current read overlappers<sup><xref rid="R7" ref-type="bibr">7</xref>–<xref rid="R9" ref-type="bibr">9</xref></sup> split input reads into many smaller batches and perform all-vs-all alignment between batches. This strategy wastes compute time on repeated file I/O and on indexing and querying non-informative <italic>k</italic>-mers. These overlappers do not build a single hash table as they worry the hash table may take too much memory. Interestingly, this should not be a major concern. Wtdbg2 first loads all reads into memory and counts <italic>k</italic>-mer occurrences. It then takes each tiling 256bp subsequence on reads as one unit, defined as a <italic>bin</italic> (each small box in <xref rid="F1" ref-type="fig">Figure 1</xref>), and builds a hash table with keys being <italic>k</italic>-mers occurring ≥2 times in reads, and values being locations of associated bins on reads. For example, among PacBio reads sequenced from the CHM1 human genome to 60-fold coverage<sup><xref rid="R10" ref-type="bibr">10</xref></sup>, there are only 1.5 billion non-unique homopolymer-compressed 21-mers<sup><xref rid="R9" ref-type="bibr">9</xref></sup>. Staging raw read sequences in memory and constructing the hash table takes 250GB at the peak, which is comparable to the memory usage of short-read assemblers.</p>
  <p id="P6">Sequence binning described above aims to speed up pairwise alignment with dynamic programming (DP) between binned sequences. With 256bp binning, the DP matrix is 65536 (=256×256) times smaller than a per-base DP matrix as is used by the Smith-Waterman algorithm<sup><xref rid="R11" ref-type="bibr">11</xref></sup>. This reduces DP to a much smaller scale in comparison to <italic>k</italic>-mer based<sup><xref rid="R8" ref-type="bibr">8</xref>, <xref rid="R9" ref-type="bibr">9</xref></sup> or base-level DP<sup><xref rid="R7" ref-type="bibr">7</xref></sup>.</p>
  <p id="P7">FBG extends the basic ideas behind de Bruijn graph (DBG) to work with long noisy reads. In analogy to DBG, a “base” in FBG is a 256bp bin and a “<italic>K</italic>-mer” or <italic>K</italic>-bin in FBG consists of <italic>K</italic> consecutive bins on reads. A vertex in FBG is a <italic>K</italic>-bin and an edge between two vertices indicates their adjacency on a read. Unlike DBG, different <italic>K</italic>-bins may be represented by a single vertex if they are aligned together based on all-vs-all read alignment. This treatment tolerates errors in noisy long reads. FBG is closer to sparse DBG<sup><xref rid="R12" ref-type="bibr">12</xref></sup> than standard DBG in that it does not inspect every <italic>K</italic>-bin on reads. The sparsity reduces the memory to construct FBG. Furthermore, FBG explicitly keeps the read names and the offsets of bins going through each edge to retain long-range information without a separate “read threading” step as with standard DBG assembly. After graph simplification<sup><xref rid="R4" ref-type="bibr">4</xref>, <xref rid="R13" ref-type="bibr">13</xref></sup>, wtdbg2 writes the final FBG to disk with read sequences on edges contained in the file. Wtdbg2 constructs the final consensus with partial order alignment<sup><xref rid="R14" ref-type="bibr">14</xref></sup> over edge sequences.</p>
  <p id="P8">We evaluated wtdbg2 v2.5 on four datasets along with CANU-1.8<sup><xref rid="R3" ref-type="bibr">3</xref></sup>, FALCON-180831<sup><xref rid="R1" ref-type="bibr">1</xref></sup>, Flye-2.3.6<sup><xref rid="R2" ref-type="bibr">2</xref></sup>, MECAT-180314<sup><xref rid="R5" ref-type="bibr">5</xref></sup> and Ra-190327 (<xref rid="T1" ref-type="table">Table 1</xref>; see <xref rid="SD1" ref-type="supplementary-material">Supplementary Table 1</xref> for more datasets). We used minimap2 to align assembled contigs to the reference genome and to collect metrics. Depending on datasets, wtdbg2 is 2–17 times as fast as the closest competitors. Its contiguity and assembly accuracy are generally comparable to other assemblers. Wtdbg2 assemblies sometimes cover less reference genomes, which is a weakness of wtdbg2, but its contigs tend to have fewer duplicates (metric “% genome covered more than once” in the table). The low redundancy rate is particularly evident for the Col-0/Cvi-0 <italic>A. thaliana</italic> dataset that has a relatively high heterozygosity of ~1%. On a <italic>M. schizocarpa</italic> (banana) ONT dataset sequenced to 45-fold coverage<sup><xref rid="R15" ref-type="bibr">15</xref></sup>, wtdbg2 delivers a 507Mb assembly with 1.0Mb N50. While this is not as good as the published result, it is larger and more contiguous than the Flye and Ra assemblies (<xref rid="S1" ref-type="sec">Online Methods</xref>).</p>
  <p id="P9">For samples close to the reference genome, we also compared the consensus accuracy before and after signal-based polishing<sup><xref rid="R16" ref-type="bibr">16</xref></sup> when applicable. Without polishing, CANU, Flye and MECAT tend to produce better consensus sequences. This is probably because they perform at least two rounds of error correction or the consensus step, while wtdbg2 applies one round of consensus only. After Quiver polishing, the consensus accuracy of all assemblers is very close and significantly higher than the accuracy of consensus without polishing. This observation reconfirms that polishing consensus is still necessary<sup><xref rid="R17" ref-type="bibr">17</xref></sup> and suggests that the pre-polishing consensus accuracy is not obviously correlated with post-polishing accuracy. In the past, Quiver was taking a small fraction of total assembly time, but it is now several times slower than wtdbg2 (7 wall-clock hours for C. elegans and 37 wall-clock hours for CHM1) and becomes the new bottleneck. This calls for future improvement to the polishing step.</p>
  <p id="P10">We assembled four additional human datasets (<xref rid="T2" ref-type="table">Table 2</xref>). Wtdbg2 finishes each assembly in &lt;2 days on a single computer. This performance broadly matches the throughput of a PromethION machine. In comparison, Flye and CANU required ~5,000 and ~40,000 CPU hours, respectively, to assemble NA12878<sup><xref rid="R2" ref-type="bibr">2</xref>,<xref rid="R18" ref-type="bibr">18</xref></sup>. For this sample, wtdbg2 uses 235GB memory, less than half of memory used by Flye. Partly due to the relatively low memory footprint, wtdbg2 is scalable to huge non-human genomes. It can assemble axolotl, with a 32Gb genome, in two days using 1.2TB memory. The NG50 is 392kb, longer than the published assembly<sup><xref rid="R19" ref-type="bibr">19</xref></sup>.</p>
  <p id="P11">Ten years ago when the Illumina sequencing technology entered the market, the sheer volume of data effectively decommissioned all aligners and assemblers developed earlier. History repeats itself. Affordable population-scale long-read sequencing is on the horizon. Wtdbg2 is an assembler that is able to keep up with the throughput and the cost. With heterozygote-aware consensus algorithms and phased assembly planned for future, wtdbg2 and upcoming tools might fundamentally change the current practices on sequence data analysis.</p>
  <sec id="S1">
    <title>Online methods</title>
    <sec id="S2">
      <title>The wtdbg2 algorithm</title>
      <p id="P12">Wtdbg2 reads all input sequences into memory and encodes each base with 2 bits. By default, it selects a quarter of <italic>k</italic>-mers based on their hash code and counts their occurrences using a hash table with 46-bit key to store a <italic>k</italic>-mer and 17-bit value to store its count. Wtdbg2 filters out <italic>k</italic>-mer occurring once or over 1000 times in reads, and then scans reads again to build a hash table for the remaining <italic>k</italic>-mers and their positions in bins.</p>
      <p id="P13">For all-vs-all read alignment, wtdbg2 traverses each read, from the longest to the shortest, and uses the hash table to retrieve the reads that share <italic>k</italic>-mers with the read in query. It takes each bin as a basepair and applies Smith-Waterman-like DP between binned sequences, penalizing gaps and mismatching bins that do not share <italic>k</italic>-mers. Wtdbg2 retains alignments no shorter than 8×256bp. After finishing alignments for all reads, wtdbg2 frees the hash table but keeps the all-vs-all alignments in memory (alignments are also written to disk as intermediate results).</p>
      <p id="P14">At this step, wtdbg2 drops base sequences. It only sees binned sequences and the alignments between them. On an <italic>L</italic>-long binned sequence <italic>B</italic> = <italic>b</italic><sub>1</sub>
<italic>b</italic><sub>2</sub> … <italic>b</italic><sub><italic>L</italic></sub>, a <italic>K</italic>-bin <italic>B</italic><sub><italic>Ki</italic></sub> = <italic>b</italic><sub><italic>i</italic></sub>
<italic>b</italic><sub><italic>i</italic>+1</sub> … <italic>b</italic><sub><italic>i+K</italic>−1</sub> is a <italic>K</italic>-long subsequence starting at the <italic>i</italic>-th position on <italic>B</italic>. If binned sequences <italic>B</italic> and <italic>B</italic>’ can be aligned, we can infer the overlap length between <italic>K</italic>-bins <italic>B</italic><sub><italic>Ki</italic></sub> and <italic>B′</italic><sub><italic>Ki′</italic></sub> by lifting their coordinates between the two sequences based on the alignment. We say two <italic>K</italic>-bins <italic>B</italic><sub><italic>Ki</italic></sub> and <italic>b′</italic><sub><italic>Ki′</italic></sub> are <italic>equivalent</italic> if the overlap length between them is <italic>K</italic> (i.e. the two bins are completely aligned). Using the all-vs-all alignment, wtdbg2 collects a maximal non-redundant set Ω of <italic>K</italic>-bins such that no <italic>K</italic>-bin in Ω is equivalent to others. For each <italic>K</italic>-bin in Ω, its <italic>coverage</italic> is defined as the number of equivalent <italic>K</italic>-bins in all reads. Wtdbg2 records the locations and coverage of each <italic>K</italic>-bin.</p>
      <p id="P15">Two <italic>K</italic>-bins in Ω may have an overlap up to <italic>K</italic>-1 bins. The vertex set <italic>V</italic> of FBG is intended to be an Ω’s subset in which no <italic>K</italic>-bins overlap with each other. To construct <italic>V</italic>, wtdbg2 traverses each non-redundant <italic>K</italic>-bin in the descending order of their initial coverage. Given a <italic>K</italic>-bin <italic>B</italic><sub><italic>K</italic></sub>, wtdbg2 reduces its coverage by deducting the number of <italic>K</italic>-bins already in <italic>V</italic> that overlap with <italic>B</italic><sub><italic>K</italic></sub>. If the reduced coverage is ≥3 and higher than half of the initial coverage, <italic>B</italic><sub><italic>K</italic></sub> will be added to <italic>V</italic>; otherwise it will be ignored. After the construction of <italic>V</italic>, wtdbg2 adds an edge between two <italic>K</italic>-bins if they are located on the same read. There are often multiple edges between two <italic>K</italic>-bins. Wtdbg2 retains one edge and keeps the count. An edge covered by &lt;3 reads are discarded. This generates FBG. The coverage thresholds can be adjusted on the wtdbg2 command line.</p>
    </sec>
    <sec id="S3">
      <title>Assembling evaluation datasets</title>
      <p id="P16">With wtdbg2, we specified the genome size and sequence technology on the command line, which automatically applies multiple options. Specifically, we used “-xrs -g100m” for <italic>C. elegans</italic>, “-xsq -g125m” for <italic>A. thaliana</italic>, “-xrs -g144m” for <italic>D. melanogaster</italic> A4 strain, “-xont -g144m” for the ISO1 strain, “-xrs -g3g” for CHM1, “-xont -g3g” for human NA12878 and NA19240 ONT reads, “-xsq -g3g” for HG00733, “-xccs -g3g” for NA24385 and “-xrs -g3g” for the axolotl dataset. Here, option “-x” specifies the preset. “rs” uses homopolymer-compressed<sup><xref rid="R9" ref-type="bibr">9</xref></sup> (HPC) 21-mer. Both “sq” and “ont” apply 15-mer to genomes smaller than 1Gb but use HPC 19-mer for larger genomes. Note that 4<sup>15</sup>=1GB. We change the type of k-mers for larger genomes to avoid non-specific seed hits, which reduce the performance. We use shorter k-mers for Nanopore data due to their higher error rates and relatively low coverage in our evaluation. Increasing k-mer length for Nanopore helps to resolve paralogous regions but reduces alignment sensitivity and leads to more fragmented assemblies for data at ~30-fold coverage.</p>
      <p id="P17">For CANU, Flye and MECAT, we similarly specified the genome size and the sequencing technology only. The FALCON configure file for assembling <italic>C. elegans</italic> is provided as <xref rid="SD1" ref-type="supplementary-material">supplementary data</xref>. The FALCON <italic>A. thaliana</italic> assembly was downloaded at <ext-link ext-link-type="uri" xlink:href="http://bit.ly/pbpubdat">http://bit.ly/pbpubdat</ext-link>. We are using AC:GCA_000983455.1 for the CANU CHM1 assembly and AC:GCA_001297185.1 for the FALCON CHM1 assembly.</p>
    </sec>
    <sec id="S4">
      <title>Assembling the <italic>M. schizocarpa</italic> (banana) dataset</title>
      <p id="P18">The authors who produced the dataset failed to run CANU, so we skipped CANU and MECAT (which is based on CANU). This is a nanopore dataset to which FALCON is not applicable. We used wtdbg2’s nanopore preset for large genome for assembly (“-xont -g600m -k0 -p19”) and got an 507Mb assembly with N50=1.0Mb for contigs longer than 10kb. Flye assembled a 505Mb genome with N50=300kb. The authors of the dataset managed to get N50=2.1Mb with Ra on all raw reads. However, with Ra, we could only produce a small assembly of 490Mb at 643kb N50. Instead, we get the best contiguity with miniasm, which generated a 520Mb assembly with N50=1.9Mb. Wtdbg2 is ~10 times as fast as Flye and Ra.</p>
    </sec>
    <sec id="S5">
      <title>Evaluating assemblies</title>
      <p id="P19">To count alignment breakpoints, we mapped all assemblies to the corresponding reference genomes with minimap2 under the option “--paf-no-hit -cxasm20 -r2k -z1000,500”. We used the companion script paftools.js to collect various metrics (command line: “paftools.js asmstat -q50000 -d.1”, where “-q” sets the minimum contig length and “-d” sets the max sequence divergence). To count substitutions and gaps, we applied a different minimap2 setting “-cxasm5 --cs -r2k”. This setting introduces more alignment breakpoints but avoids poorly aligned regions harboring spuriously high number of differences that are likely caused by large-scale variations and skew the counts. We used “paftools.js call” to call variations.</p>
    </sec>
    <sec sec-type="data-availability" id="S6">
      <title>Data availability</title>
      <p id="P20"><italic>C. elegans</italic> and <italic>A. thaliana</italic> Ler-0 reads are available at the PacBio public datasets portal: <ext-link ext-link-type="uri" xlink:href="http://bit.ly/pbpubdat">http://bit.ly/pbpubdat</ext-link>. We downloaded SRR5439404 for the <italic>D. melanogaster</italic> A4 strain, SRR6702603 for the <italic>D. melanogaster</italic> reference ISO1 strain, ERR2571284 through ERR2571302 for <italic>M. schizocarpa</italic> (banana; MinION reads only), PRJNA378970 for axolotl, SRR7615963 for HG00733, and ERR2631600 and ERR2631601 for NA19240. CHM1 reads were acquired from SRP044331 (<ext-link ext-link-type="uri" xlink:href="http://bit.ly/chm1p6c4">http://bit.ly/chm1p6c4</ext-link> for raw signals), NA12878 reads from <ext-link ext-link-type="uri" xlink:href="http://bit.ly/na12878ont">http://bit.ly/na12878ont</ext-link> (release 5) and NA24385 from <ext-link ext-link-type="uri" xlink:href="http://bit.ly/NA24385ccs">http://bit.ly/NA24385ccs</ext-link>. For the <italic>A. thaliana</italic> Col-0/Cvi-0 dataset, the FASTQ files at SRA (AC: PRJNA314706) were not processed properly. Jason Chin, the first author of the paper<sup><xref rid="R1" ref-type="bibr">1</xref></sup> describing the dataset, provided us with reprocessed raw reads, which are now hosted at public ftp site: <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.dfci.harvard.edu/pub/hli/col0-cvi0/">ftp://ftp.dfci.harvard.edu/pub/hli/col0-cvi0/</ext-link>. The CHM1 CANU and FALCON assemblies and the axolotl assembly are available at NCBI (GCA_000983455.1, GCA_001297185.1 and GCA_002915635.1, respectively). All the evaluated assemblies generated by us can be obtained at <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.dfci.harvard.edu/pub/hli/wtdbg/">ftp://ftp.dfci.harvard.edu/pub/hli/wtdbg/</ext-link>. The FTP site also provides the detailed command lines and the FALCON configuration files.</p>
    </sec>
    <sec id="S7">
      <title>Reporting Summary</title>
      <p id="P21">Further information on research design is available in the Nature Research Reporting Summary linked to this article.</p>
    </sec>
    <sec id="S8">
      <title>Code availability</title>
      <p id="P22">The wtdbg2 source code is hosted by GitHub at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ruanjue/wtdbg2">https://github.com/ruanjue/wtdbg2</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM1">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS1541890-supplement-1.xlsx" orientation="portrait" xlink:type="simple" id="d36e638" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S9">
    <title>Acknowledgements</title>
    <p id="P23">We are grateful to Jason Chin for providing the properly processed raw reads for the <italic>A. thaliana</italic> Col-0/Cvi-0 dataset. We would like to thank Chengxi Ye from University of Maryland for frequent and fruitful discussion in the development of wtdbg and thank Alun Li and Shigang Wu from CAAS for the help in polishing assemblies. We also thank the reviewers whose comments have helped us to improve wtdbg2. This study was supported by Natural Science Foundation of China (NSFC; grant 31571353 and 31822029 to J.R.) and by US National Institutes Health (NIH; grant R01-HG010040 to H.L.).</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement" id="FN2">
      <p id="P24"><bold>Competing interests.</bold> The authors declare no competing interests.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>Reference</title>
    <ref id="R1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><name><surname>Chin</surname><given-names>CS</given-names></name><etal/><source>Nat Methods</source><volume>13</volume>, <fpage>1050</fpage>–<lpage>1054</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27749838</pub-id></mixed-citation>
    </ref>
    <ref id="R2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><name><surname>Kolmogorov</surname><given-names>M</given-names></name>, <name><surname>Yuan</surname><given-names>J</given-names></name>, <name><surname>Lin</surname><given-names>Y</given-names></name> &amp; <name><surname>Pevzner</surname><given-names>PA</given-names></name>
<source>Nat Biotechnol</source>
<volume>37</volume>, <fpage>540</fpage>–<lpage>546</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">30936562</pub-id></mixed-citation>
    </ref>
    <ref id="R3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><name><surname>Koren</surname><given-names>S</given-names></name><etal/><source>Genome Res</source><volume>27</volume>, <fpage>722</fpage>–<lpage>736</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28298431</pub-id></mixed-citation>
    </ref>
    <ref id="R4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name><source>Bioinformatics</source><volume>32</volume>, <fpage>2103</fpage>–<lpage>2110</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27153593</pub-id></mixed-citation>
    </ref>
    <ref id="R5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><name><surname>Xiao</surname><given-names>CL</given-names></name><etal/><source>Nat Methods</source><volume>14</volume>, <fpage>1072</fpage>–<lpage>1074</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28945707</pub-id></mixed-citation>
    </ref>
    <ref id="R6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><name><surname>De Coster</surname><given-names>W</given-names></name><etal/><source>Genome Res</source><volume>29</volume>, <fpage>1178</fpage>–<lpage>1187</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">31186302</pub-id></mixed-citation>
    </ref>
    <ref id="R7">
      <label>7.</label>
      <mixed-citation publication-type="book"><name><surname>Myers</surname><given-names>G</given-names></name> in <source>WABI</source>, Vol. <volume>8701</volume> (eds. <name><surname>Brown</surname><given-names>DG</given-names></name> &amp; <name><surname>Morgenstern</surname><given-names>B</given-names></name>) <fpage>52</fpage>–<lpage>67</lpage> (<publisher-name>Springer</publisher-name>, <publisher-loc>Wroclaw, Poland</publisher-loc>; <year>2014</year>).</mixed-citation>
    </ref>
    <ref id="R8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><name><surname>Berlin</surname><given-names>K</given-names></name><etal/><source>Nat Biotechnol</source><volume>33</volume>, <fpage>623</fpage>–<lpage>630</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26006009</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name><source>Bioinformatics</source><volume>34</volume>, <fpage>3094</fpage>–<lpage>3100</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29750242</pub-id></mixed-citation>
    </ref>
    <ref id="R10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><name><surname>Chaisson</surname><given-names>MJ</given-names></name>, <name><surname>Wilson</surname><given-names>RK</given-names></name> &amp; <name><surname>Eichler</surname><given-names>EE</given-names></name>
<source>Nat Rev Genet</source>
<volume>16</volume>, <fpage>627</fpage>–<lpage>640</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26442640</pub-id></mixed-citation>
    </ref>
    <ref id="R11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>TF</given-names></name> &amp; <name><surname>Waterman</surname><given-names>MS</given-names></name>
<source>J Mol Biol</source>
<volume>147</volume>, <fpage>195</fpage>–<lpage>197</lpage> (<year>1981</year>).<pub-id pub-id-type="pmid">7265238</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><name><surname>Ye</surname><given-names>C</given-names></name>, <name><surname>Ma</surname><given-names>ZS</given-names></name>, <name><surname>Cannon</surname><given-names>CH</given-names></name>, <name><surname>Pop</surname><given-names>M</given-names></name> &amp; <name><surname>Yu</surname><given-names>DW</given-names></name>
<source>BMC Bioinformatics</source>
<volume>13</volume>
<issue>Suppl 6</issue>, <fpage>S1</fpage> (<year>2012</year>).</mixed-citation>
    </ref>
    <ref id="R13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><name><surname>Zerbino</surname><given-names>DR</given-names></name> &amp; <name><surname>Birney</surname><given-names>E</given-names></name>
<source>Genome Res</source>
<volume>18</volume>, <fpage>821</fpage>–<lpage>829</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18349386</pub-id></mixed-citation>
    </ref>
    <ref id="R14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>C</given-names></name>, <name><surname>Grasso</surname><given-names>C</given-names></name> &amp; <name><surname>Sharlow</surname><given-names>MF</given-names></name>
<source>Bioinformatics</source>
<volume>18</volume>, <fpage>452</fpage>–<lpage>464</lpage> (<year>2002</year>).<pub-id pub-id-type="pmid">11934745</pub-id></mixed-citation>
    </ref>
    <ref id="R15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><name><surname>Belser</surname><given-names>C</given-names></name><etal/><source>Nat Plants</source><volume>4</volume>, <fpage>879</fpage>–<lpage>887</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30390080</pub-id></mixed-citation>
    </ref>
    <ref id="R16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><name><surname>Chin</surname><given-names>CS</given-names></name><etal/><source>Nat Methods</source><volume>10</volume>, <fpage>563</fpage>–<lpage>569</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23644548</pub-id></mixed-citation>
    </ref>
    <ref id="R17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><name><surname>Watson</surname><given-names>M</given-names></name> &amp; <name><surname>Warr</surname><given-names>A</given-names></name>
<source>Nat Biotech</source> (<year>2019</year>).</mixed-citation>
    </ref>
    <ref id="R18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><name><surname>Jain</surname><given-names>M</given-names></name><etal/><source>Nat Biotechnol</source><volume>36</volume>, <fpage>338</fpage>–<lpage>345</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29431738</pub-id></mixed-citation>
    </ref>
    <ref id="R19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><name><surname>Nowoshilow</surname><given-names>S</given-names></name><etal/><source>Nature</source><volume>554</volume>, <fpage>50</fpage>–<lpage>55</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29364872</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Fig. 1</label>
    <caption>
      <p id="P25">Outline of the wtdbg2 algorithm. Wtdbg2 groups 256 base pairs into a bin, a small box in the figure. Bins/boxes with the same color suggest they share <italic>k</italic>-mers, except that a gray bin doesn’t match other bins due to sequencing errors. Wtdbg2 performs all-vs-all alignment between binned reads and constructs the fuzzy-Bruijn assembly graph, where a vertex is a 4-bin segment and an edge connects two vertices if they are both present on a read. Wtdbg2 then trims tips and pops bubbles and produces the final contig sequences from the consensus of read subsequences attached to each edge.</p>
    </caption>
    <graphic xlink:href="nihms-1541890-f0001"/>
  </fig>
  <table-wrap id="T1" position="float" orientation="portrait">
    <label>Table 1.</label>
    <caption>
      <title>Evaluating long-read assemblies</title>
      <p id="P26">FALCON requires PacBio-style read names and does not work with ONT data or the A4 strain of <italic>D. melanogaster</italic> which was downloaded from SRA. The <italic>A. thaliana</italic> assembly by FALCON is acquired from PacBio website as our assembly is fragmented. MECAT produces fragmented assemblies for the ONT dataset. Human assemblies were performed by the developers of each assembler. Base-level evaluations and NGA50 are only reported when the sequenced strain or individual is close to the reference genome. BUSCO scores are computed for genomes sequenced to 50-fold coverage or higher.</p>
    </caption>
    <table frame="hsides" rules="none">
      <colgroup span="1">
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
      </colgroup>
      <thead>
        <tr>
          <th align="left" valign="top" rowspan="1" colspan="1">Dataset</th>
          <th align="left" valign="top" rowspan="1" colspan="1">Metric</th>
          <th align="center" valign="top" rowspan="1" colspan="1">CANU</th>
          <th align="center" valign="top" rowspan="1" colspan="1">FALCON</th>
          <th align="center" valign="top" rowspan="1" colspan="1">Flye</th>
          <th align="center" valign="top" rowspan="1" colspan="1">MECAT</th>
          <th align="center" valign="top" rowspan="1" colspan="1">Ra</th>
          <th align="center" valign="top" rowspan="1" colspan="1">Wtdbg2</th>
        </tr>
        <tr>
          <th colspan="8" align="left" valign="top" rowspan="1">
            <hr/>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td rowspan="12" align="left" valign="top" colspan="1"><italic>C. elegans</italic> Bristo ref. strain PacBio x80</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Total length (&gt;= 50kbp)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">106.5Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">100.8Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">102.0Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">102.1Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">108.1Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">104.8Mb</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% reference genome covered</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.58</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.16</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.29</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.51</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.55</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.37</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% genome covered more than once</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.33</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.25</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.15</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.35</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.69</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.13</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG75 (75% ref. in contigs longer than NG75)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,884,280</td>
          <td align="right" valign="top" rowspan="1" colspan="1">935,802</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,275,590</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,424,674</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,320,829</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,255,274</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG50 (50% ref. in contigs longer than NG50)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,677,990</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,629,544</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,926,198</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,113,456</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,047,105</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3,596,268</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NGA50 (50% ref in alignments longer than NGA50)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,283,814</td>
          <td align="right" valign="top" rowspan="1" colspan="1">980,062</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,087,075</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,119,713</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,019,386</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,365,602</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># alignment breakpoints</td>
          <td align="right" valign="top" rowspan="1" colspan="1">681</td>
          <td align="right" valign="top" rowspan="1" colspan="1">192</td>
          <td align="right" valign="top" rowspan="1" colspan="1">284</td>
          <td align="right" valign="top" rowspan="1" colspan="1">278</td>
          <td align="right" valign="top" rowspan="1" colspan="1">724</td>
          <td align="right" valign="top" rowspan="1" colspan="1">177</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">BUSCO (% complete single-copy genes)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">98.2%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">88.1%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">98.4%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">97.0%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">90.9%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">97.5%</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># substitutions/1Mb (pre-/post-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">64.1 / 62.2</td>
          <td align="right" valign="top" rowspan="1" colspan="1">233.2 / 50.1</td>
          <td align="right" valign="top" rowspan="1" colspan="1">61.6 / 57.6</td>
          <td align="right" valign="top" rowspan="1" colspan="1">65.9 / 62.8</td>
          <td align="right" valign="top" rowspan="1" colspan="1">309.9 / 66.8</td>
          <td align="right" valign="top" rowspan="1" colspan="1">83.8 / 60.3</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># insertions/1Mb (pre-/post-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">31.1 / 22.4</td>
          <td align="right" valign="top" rowspan="1" colspan="1">592.7 / 19.4</td>
          <td align="right" valign="top" rowspan="1" colspan="1">29.8 / 21.8</td>
          <td align="right" valign="top" rowspan="1" colspan="1">43.9 / 21.9</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3011.2 / 24.3</td>
          <td align="right" valign="top" rowspan="1" colspan="1">110.6 / 20.8</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># deletions/1Mb (pre-/post-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">152.8 / 55.1</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1822.7 / 56.7</td>
          <td align="right" valign="top" rowspan="1" colspan="1">381.4 / 56.9</td>
          <td align="right" valign="top" rowspan="1" colspan="1">366.0 / 57.9</td>
          <td align="right" valign="top" rowspan="1" colspan="1">144.1 / 53.1</td>
          <td align="right" valign="top" rowspan="1" colspan="1">343.0 / 57.7</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">Wall-clock time over 32 CPUs (pre-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">9h30m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2h06m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2h58m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3h08m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2h23m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">26m</td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" rowspan="1">
            <hr/>
          </td>
        </tr>
        <tr>
          <td rowspan="11" align="left" valign="top" colspan="1"><italic>D. melanogaster</italic> ISO1 ref. strain ONT x32</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Total length (&gt;= 50kbp)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">135.0Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">130.7Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">126.5Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">127.4Mb</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% reference genome covered</td>
          <td align="right" valign="top" rowspan="1" colspan="1">91.74</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">89.40</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">86.35</td>
          <td align="right" valign="top" rowspan="1" colspan="1">89.34</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% genome covered more than once</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1.19</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">0.14</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">0.68</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.22</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG75</td>
          <td align="right" valign="top" rowspan="1" colspan="1">714,013</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1,367,004</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">685,943</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,752,322</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG50</td>
          <td align="right" valign="top" rowspan="1" colspan="1">4,298,595</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">6,016,667</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1,898,336</td>
          <td align="right" valign="top" rowspan="1" colspan="1">10,631,323</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NGA50</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,837,928</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">2,210,468</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1,700,400</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,989,107</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># alignment breakpoints</td>
          <td align="right" valign="top" rowspan="1" colspan="1">823</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">248</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">225</td>
          <td align="right" valign="top" rowspan="1" colspan="1">276</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># substitutions per 1Mb (pre-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">847.6</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1318</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1976.2</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1109.2</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># insertions per 1Mb (pre-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">255.9</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">10669.9</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">4388.7</td>
          <td align="right" valign="top" rowspan="1" colspan="1">371.2</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># deletions per 1Mb (pre-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">7168.2</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1901.3</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">2324.6</td>
          <td align="right" valign="top" rowspan="1" colspan="1">9746.3</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">Wall-clock time over 32 CPUs (pre-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">22h23m</td>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1h41m</td>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">2h10m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">50m</td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" rowspan="1">
            <hr/>
          </td>
        </tr>
        <tr>
          <td rowspan="8" align="left" valign="top" colspan="1"><italic>A. thaliana</italic> F1 generation of Col-0 and Cvi-0 strains (~1% heterozygosity) PacBio x185</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Total length (&gt;= 50kbp)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">196.5Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">138.1Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">122.3Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">188.4Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">133.3Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">125.0Mb</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% reference genome covered</td>
          <td align="right" valign="top" rowspan="1" colspan="1">99.04</td>
          <td align="right" valign="top" rowspan="1" colspan="1">97.03</td>
          <td align="right" valign="top" rowspan="1" colspan="1">93.55</td>
          <td align="right" valign="top" rowspan="1" colspan="1">97.47</td>
          <td align="right" valign="top" rowspan="1" colspan="1">92.52</td>
          <td align="right" valign="top" rowspan="1" colspan="1">92.66</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% genome covered more than once</td>
          <td align="right" valign="top" rowspan="1" colspan="1">47.61</td>
          <td align="right" valign="top" rowspan="1" colspan="1">11.35</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3.72</td>
          <td align="right" valign="top" rowspan="1" colspan="1">51.46</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3.38</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1.08</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG75</td>
          <td align="right" valign="top" rowspan="1" colspan="1">460,325</td>
          <td align="right" valign="top" rowspan="1" colspan="1">4,810,976</td>
          <td align="right" valign="top" rowspan="1" colspan="1">180,227</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,096,121</td>
          <td align="right" valign="top" rowspan="1" colspan="1">404,218</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,182,254</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG50</td>
          <td align="right" valign="top" rowspan="1" colspan="1">873,036</td>
          <td align="right" valign="top" rowspan="1" colspan="1">7,979,657</td>
          <td align="right" valign="top" rowspan="1" colspan="1">370,306</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3,525,236</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,210,836</td>
          <td align="right" valign="top" rowspan="1" colspan="1">8,707,235</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># alignment breakpoints</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3,059</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,102</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,674</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,573</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,078</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,777</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">BUSCO (% complete single-copy genes)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">43.8%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">91.9%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">93.1%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">49.2%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">87.8%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">90.3%</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">Wall-clock time over 32 CPUs (pre-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">30h42m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">(by PacBio)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">20h3m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">11h33m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">18h33m</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1h12m</td>
        </tr>
        <tr>
          <td colspan="8" align="left" valign="top" rowspan="1">
            <hr/>
          </td>
        </tr>
        <tr>
          <td rowspan="12" align="left" valign="top" colspan="1">Human CHM1 cell line PacBio x100</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Total length (&gt;= 50kbp)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,837Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1">2,938Mb</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">2,712Mb</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% reference genome covered</td>
          <td align="right" valign="top" rowspan="1" colspan="1">89.33</td>
          <td align="right" valign="top" rowspan="1" colspan="1">90.13</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">86.03</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">% genome covered more than once</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.53</td>
          <td align="right" valign="top" rowspan="1" colspan="1">0.72</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">0.02</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG75</td>
          <td align="right" valign="top" rowspan="1" colspan="1">3,793,440</td>
          <td align="right" valign="top" rowspan="1" colspan="1">7,726,658</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">4,387,668</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NG50</td>
          <td align="right" valign="top" rowspan="1" colspan="1">17,570,750</td>
          <td align="right" valign="top" rowspan="1" colspan="1">26,132,317</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">18,220,221</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NGA50</td>
          <td align="right" valign="top" rowspan="1" colspan="1">7,128,216</td>
          <td align="right" valign="top" rowspan="1" colspan="1">9,262,902</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">8,017,241</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># alignment breakpoints</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1,795</td>
          <td align="right" valign="top" rowspan="1" colspan="1">7,966</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">1,619</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">BUSCO (% complete single-copy genes)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">91.3%</td>
          <td align="right" valign="top" rowspan="1" colspan="1">91.5%</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">90.5%</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># substitutions per 1Mb (post-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">961.5</td>
          <td align="right" valign="top" rowspan="1" colspan="1">966.6</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">963.6</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># insertions per 1Mb (post-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">142.8</td>
          <td align="right" valign="top" rowspan="1" colspan="1">140.1</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">140.2</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"># deletions per 1Mb (post-polish)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">140.0</td>
          <td align="right" valign="top" rowspan="1" colspan="1">137.6</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="left" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">141.1</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">Total CPU hours (pre-polish CPU hours)</td>
          <td align="right" valign="top" rowspan="1" colspan="1">22,750</td>
          <td align="right" valign="top" rowspan="1" colspan="1">68,789</td>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1"/>
          <td align="right" valign="top" rowspan="1" colspan="1">2,506 (632)</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="T2" position="float" orientation="portrait">
    <label>Table 2.</label>
    <caption>
      <p id="P27">Wtdbg2 performance on other human genomes. Performance metrics were obtained on a machine with 96 CPU cores. G. size: size of the reference genome; Cov.: sequencing coverage; NG50: 50% of the reference genome are in contigs longer than this length.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <colgroup span="1">
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
      </colgroup>
      <thead>
        <tr>
          <th align="left" valign="top" rowspan="1" colspan="1">Data set</th>
          <th align="left" valign="top" rowspan="1" colspan="1">Technology</th>
          <th align="left" valign="top" rowspan="1" colspan="1">Cov.</th>
          <th align="left" valign="top" rowspan="1" colspan="1">CPU hour</th>
          <th align="left" valign="top" rowspan="1" colspan="1">Real hour</th>
          <th align="left" valign="top" rowspan="1" colspan="1">Peak RAM (GB)</th>
          <th align="left" valign="top" rowspan="1" colspan="1">NG50 (Mb)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NA12878</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Nanopore</td>
          <td align="right" valign="top" rowspan="1" colspan="1">36</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1513</td>
          <td align="right" valign="top" rowspan="1" colspan="1">26</td>
          <td align="right" valign="top" rowspan="1" colspan="1">235</td>
          <td align="right" valign="top" rowspan="1" colspan="1">10.3</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NA19240</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Nanopore</td>
          <td align="right" valign="top" rowspan="1" colspan="1">35</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1197</td>
          <td align="right" valign="top" rowspan="1" colspan="1">19</td>
          <td align="right" valign="top" rowspan="1" colspan="1">226</td>
          <td align="right" valign="top" rowspan="1" colspan="1">4.4</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">NA24385</td>
          <td align="left" valign="top" rowspan="1" colspan="1">PacBio CCS</td>
          <td align="right" valign="top" rowspan="1" colspan="1">28</td>
          <td align="right" valign="top" rowspan="1" colspan="1">410</td>
          <td align="right" valign="top" rowspan="1" colspan="1">6</td>
          <td align="right" valign="top" rowspan="1" colspan="1">108</td>
          <td align="right" valign="top" rowspan="1" colspan="1">11.8</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">HG00733</td>
          <td align="left" valign="top" rowspan="1" colspan="1">PacBio Sequel</td>
          <td align="right" valign="top" rowspan="1" colspan="1">93</td>
          <td align="right" valign="top" rowspan="1" colspan="1">1906</td>
          <td align="right" valign="top" rowspan="1" colspan="1">37</td>
          <td align="right" valign="top" rowspan="1" colspan="1">338</td>
          <td align="right" valign="top" rowspan="1" colspan="1">29.2</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
