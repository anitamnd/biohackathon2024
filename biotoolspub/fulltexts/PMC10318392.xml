<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10318392</article-id>
    <article-id pub-id-type="pmid">37338536</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad393</article-id>
    <article-id pub-id-type="publisher-id">btad393</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BBmix: a Bayesian beta-binomial mixture model for accurate genotyping from RNA-sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6230-3849</contrib-id>
        <name>
          <surname>Vigorito</surname>
          <given-names>Elena</given-names>
        </name>
        <aff><institution>MRC Biostatistics Unit, University of Cambridge</institution>, Cambridge CB2 0SR, <country country="GB">United Kingdom</country></aff>
        <xref rid="btad393-cor1" ref-type="corresp"/>
        <!--elena.vigorito@mrc-bsu.cam.ac.uk-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3316-2527</contrib-id>
        <name>
          <surname>Barton</surname>
          <given-names>Anne</given-names>
        </name>
        <aff><institution>Division of Musculoskeletal and Dermatological Sciences, University of Manchester</institution>, Manchester M13 9PL, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pitzalis</surname>
          <given-names>Costantino</given-names>
        </name>
        <aff><institution>Centre for Experimental Medicine and Rheumatology, William Harvey Research Institute, Barts and The London School of Medicine and Dentistry, Queen Mary University of London</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9365-5345</contrib-id>
        <name>
          <surname>Lewis</surname>
          <given-names>Myles J</given-names>
        </name>
        <aff><institution>Centre for Experimental Medicine and Rheumatology, William Harvey Research Institute, Barts and The London School of Medicine and Dentistry, Queen Mary University of London</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9755-1703</contrib-id>
        <name>
          <surname>Wallace</surname>
          <given-names>Chris</given-names>
        </name>
        <aff><institution>MRC Biostatistics Unit, University of Cambridge</institution>, Cambridge CB2 0SR, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Cambridge Institute of Therapeutic Immunology &amp; Infectious Disease (CITIID), Jeffrey Cheah Biomedical Centre, Cambridge Biomedical Campus, University of Cambridge</institution>, Cambridge CB2 0AW, <country country="GB">United Kingdom</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad393-cor1">Corresponding author. MRC Biostatistics Unit, University of Cambridge, Forvie Site, Robinson Way, Cambridge CB2 0SR, United Kingdom. E-mail: <email>elena.vigorito@mrc-bsu.cam.ac.uk</email> (E.V.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-06-20">
      <day>20</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>7</issue>
    <elocation-id>btad393</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>13</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>03</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad393.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>While many pipelines have been developed for calling genotypes using RNA-sequencing (RNA-Seq) data, they all have adapted DNA genotype callers that do not model biases specific to RNA-Seq such as allele-specific expression (ASE).</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present Bayesian beta-binomial mixture model (BBmix), a Bayesian beta-binomial mixture model that first learns the expected distribution of read counts for each genotype, and then deploys those learned parameters to call genotypes probabilistically. We benchmarked our model on a wide variety of datasets and showed that our method generally performed better than competitors, mainly due to an increase of up to 1.4% in the accuracy of heterozygous calls, which may have a big impact in reducing false positive rate in applications sensitive to genotyping error such as ASE. Moreover, BBmix can be easily incorporated into standard pipelines for calling genotypes. We further show that parameters are generally transferable within datasets, such that a single learning run of less than 1 h is sufficient to call genotypes in a large number of samples.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>We implemented BBmix as an R package that is available for free under a GPL-2 licence at <ext-link xlink:href="https://gitlab.com/evigorito/bbmix" ext-link-type="uri">https://gitlab.com/evigorito/bbmix</ext-link> and <ext-link xlink:href="https://cran.r-project.org/package=bbmix" ext-link-type="uri">https://cran.r-project.org/package=bbmix</ext-link> with accompanying pipeline at <ext-link xlink:href="https://gitlab.com/evigorito/bbmix_pipeline" ext-link-type="uri">https://gitlab.com/evigorito/bbmix_pipeline</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>WT220788</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>RNA-sequencing (RNA-Seq) is an established and popular technique with applications in transcript quantification and detection of alternative splicing, among others. More recently, a growing number of studies have developed and tested pipelines to use RNA-seq for variant and genotype calling (<xref rid="btad393-B10" ref-type="bibr">Quinn <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad393-B11" ref-type="bibr">Rogier <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad393-B1" ref-type="bibr">Adetunji <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad393-B3" ref-type="bibr">Brouard <italic toggle="yes">et al.</italic> 2019</xref>), including somatic variant detection and identification of cancer drivers (<xref rid="btad393-B2" ref-type="bibr">Akutagawa <italic toggle="yes">et al.</italic> 2022</xref>). Applications include calling variants when DNA genotypes are unavailable (<xref rid="btad393-B13" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2021</xref>), studying cis-regulated genes by analysing allele-specific expression (ASE) or conducting genome-wide association studies (GWAS) in non-model species, since whole-genome sequencing is expensive and exome sequencing tools may be unavailable (<xref rid="btad393-B6" ref-type="bibr">Jehl <italic toggle="yes">et al.</italic> 2021</xref>). Genotype calling using RNA-seq is often more challenging than DNA sequencing: coverage can be highly variable between genes, many reads map across splice junctions making correct alignment more difficult, and cis-acting eQTLs may create unequal expression between chromosomes. Despite this, for many applications, accuracy is paramount, e.g. in ASE, miscalling a homozygous genotype as heterozygous will create a false signal of allelic imbalance.</p>
    <p>RNA-seq genotyping pipelines employ RNA-seq-based aligners and quality control steps for filtering out potentially erroneous calls, but use the same statistical models as for DNA sequencing. While adopting these methods provides a convenient way to call variants from RNA-seq, there are sources of variation in RNA-seq data that are not accounted for. In DNA sequencing, in an ideal world reads would follow a binomial model, then, out of <italic toggle="yes">n</italic> reads covering a single nucleotide polymorhism (SNP), we would expect 0, <italic toggle="yes">n</italic>/2, and <italic toggle="yes">n</italic> to contain the alternative allele for genotypes 0, 1, and 2, respectively. Sampling variation and reference mapping bias may mean the observed heterozygote genotype count deviates from <italic toggle="yes">n</italic>/2 particularly when <italic toggle="yes">n</italic> is small, and the homozygote observations may deviate minorly from 0 and <italic toggle="yes">n</italic> due to sequencing or mapping errors. However, when <italic toggle="yes">n</italic> is large, the genotypes are expected to be clearly distinguishable. In RNA-seq, the heterozygote observation may show much greater variance, because heterozygosity at local regulatory sequences may cause overamplification of the allele on one chromosome over the allele on its homologue, with this effect varying between samples as genotypes at the regulatory sequences vary. This may push the observed heterozygote count nearer to 0 or <italic toggle="yes">n</italic>, making a miscall as a homozygote more likely, particularly when <italic toggle="yes">n</italic> is small.</p>
    <p>In this work, we wanted to test whether directly modelling this additional variation in RNA-seq data could improve the quality of the genotype calls. To this end, we developed Bayesian beta-binomial mixture model (BBmix), a two-step method based on first modelling the genotype-specific read counts using beta-binomial distributions and then using these to infer genotype posterior probabilities. We benchmarked our method using high confidence calls from the Genome in a Bottle consortium (<ext-link xlink:href="https://www.nist.gov/programs-projects/genome-bottle" ext-link-type="uri">https://www.nist.gov/programs-projects/genome-bottle</ext-link>), the subset of GBR samples from the Genetic European Variation in Disease (GEUVADIS) project (McVean <italic toggle="yes">et al.</italic> 2012), for which RNA-seq data and high-quality genotype calls are publicly available and samples from the Pathobiology of Early Arthritis Cohort (PEAC) cohort (<xref rid="btad393-B7" ref-type="bibr">Lewis <italic toggle="yes">et al.</italic> 2019</xref>) for a ‘real data’ case study. This is a cohort of 82 adult treatment-naive rheumatoid arthritis patients for whom RNA-seq from synovial tissue samples and DNA-microarray-based genotypes are available. We found that our method generally performed better than competitors and can be easily incorporated into standard pipelines for calling variants.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 The BBmix statistical model</title>
      <p>We model the number of reads of the alternative allele at each SNP as a mixture of three beta-binomial distributions corresponding to the three possible genotypes, conditional on the total number of reads overlapping the SNP. To allow for sequencing or alignment errors as well as reference mapping bias, the mean and variance parameters of each distribution are learned from the data. As the parameters of these distributions are shared between SNPs, we learn them from many SNPs in a Bayesian model. To maximize computational efficiency, we train the model on a random subset of SNPs and use the learnt parameters to call genotype probabilities across all SNPs.</p>
      <sec>
        <title>2.1.1 Fitting a beta-binomial mixture model to RNA-seq data</title>
        <p>We selected RNA-seq reads overlapping a predefined set of feature SNPs (fSNPs) that we aim to genotype. We treat genotype as a latent variable, <italic toggle="yes">G</italic>, which corresponds to the number of alternative alleles at a given fSNP, <italic toggle="yes">g</italic> = (0, 1, 2), and we assume that the distribution of reads differs according to its value. Given fSNPs indexed by <italic toggle="yes">l</italic>, we denote <italic toggle="yes">R<sub>al</sub></italic> as the number of reads overlapping its alternative allele and <italic toggle="yes">R<sub>tl</sub></italic> the total number of reads mapping <italic toggle="yes">s<sub>l</sub></italic>. We then fit a mixture of three beta-binomial distributions to the allelic counts of a random sample of <italic toggle="yes">L</italic> fSNPs to estimate the parameters (<italic toggle="yes">μ</italic>, vector of the mean of each component, and μ, vector of the overdispersion of each component) for the underlying distribution of genotypes. With λ a vector of the proportion of each component, we express the likelihood as
where BB() is the beta-binomial distribution:
which we reparameterize to:
</p>
        <disp-formula id="E1">
          <mml:math id="M1" display="block" overflow="scroll">
            <mml:mi>L</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="normal">Π</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mi>L</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mo stretchy="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>g</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>g</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mrow/>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>θ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mi mathvariant="normal">B</mml:mi>
            <mml:mi mathvariant="normal">B</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>R</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>R</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>μ</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>λ</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E2">
          <mml:math id="M2" display="block" overflow="scroll">
            <mml:mi>f</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mi>R</mml:mi>
                <mml:mrow>
                  <mml:mi>a</mml:mi>
                  <mml:mi>l</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>|</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mi>R</mml:mi>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                  <mml:mi>l</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo>α</mml:mo>
                <mml:mi>g</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:msub>
                    <mml:mo>β</mml:mo>
                    <mml:mi>g</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow/>
              </mml:msub>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mfenced separators="|">
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow/>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>R</mml:mi>
                            <mml:mrow>
                              <mml:mi>a</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>R</mml:mi>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mi mathvariant="normal">B</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>R</mml:mi>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mo>α</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mo> </mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>R</mml:mi>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>-</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>R</mml:mi>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mo>β</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">B</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mo>α</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mo>β</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <disp-formula id="E3">
          <mml:math id="M3" display="block" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>μ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>α</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>α</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>β</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mo> </mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>λ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>α</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>β</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:math>
        </disp-formula>
        <p>We put the following priors:
</p>
        <disp-formula id="E4">
          <mml:math id="M4" display="block" overflow="scroll">
            <mml:mo>θ</mml:mo>
            <mml:mo>∼</mml:mo>
            <mml:mi mathvariant="normal">Dirichlet</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mn>1,1</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>)</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E5">
          <mml:math id="M5" display="block" overflow="scroll">
            <mml:mo>α</mml:mo>
            <mml:mo>∼</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:mn>1,10,499</mml:mn>
            <mml:mo>)</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E6">
          <mml:math id="M6" display="block" overflow="scroll">
            <mml:mi>β</mml:mi>
            <mml:mo>∼</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:mn>499,10,1</mml:mn>
            <mml:mo>)</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E7">
          <mml:math id="M7" display="block" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>μ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>∼</mml:mo>
            <mml:mi mathvariant="normal">Beta</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>α</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>β</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>)</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E8">
          <mml:math id="M8" display="block" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>λ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>∼</mml:mo>
            <mml:mi mathvariant="normal">Γ</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>α</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>β</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>.</mml:mo>
          </mml:math>
        </disp-formula>
        <p>We selected the Dirichlet prior as the natural choice for a set of probabilities that sum to 1, and the informative priors for α and β were selected by visual inspection of the fit of beta distributions to the empirical distribution of reads for a collection of fSNPs with effect allele frequency (EAF) higher than 0.01 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
        <fig position="float" id="btad393-F1">
          <label>Figure 1.</label>
          <caption>
            <p>Training the beta-binomial mixture (BBmix) model with different numbers of SNPs. A random sample of RNA-seq reads for the indicated number of SNPs with at least 10 supportive reads was used to train the BBmix model. The procedure was repeated three times. (a) Mean and 95% credible interval for the posterior distribution for each of the three components of the mean parameter (mu[1–3]). (b) Concordance of calls (<italic toggle="yes">y</italic>-axis) based on the expected genotypes (dosages) called with the parameters learnt from the BBmix model trained with the indicated number of SNPs (<italic toggle="yes">x</italic>-axis). The black points correspond to each replicate and the red triangle corresponds to the mean. (c) Running time (h) for fitting the BBmix model for the indicated number of SNPs. The average time when training with 500 SNPs was 25 min; for 1000 SNPs was 46 min; for 2000 83 min; for 3000 128 min; for 4000 2.9 h; for 5000 SNPs 4 h, and for 10 000 SNPs 10 h. The dashed line corresponds to the linear regression line.</p>
          </caption>
          <graphic xlink:href="btad393f1" position="float"/>
        </fig>
        <p>We estimated μ and λ by Markov chain Monte Carlo implemented in Stan (<xref rid="btad393-B12" ref-type="bibr">Stan Development Team, 2018</xref>). We checked convergence using Stan built-in <italic toggle="yes">n_eff</italic> and <italic toggle="yes">Rhat</italic> statistics as well as visual examination. We obtained 4000 posterior observations sampled from four chains for each parameter. For each chain, we discarded the first 1000 observations.</p>
      </sec>
      <sec>
        <title>2.1.2 Calling genotypes</title>
        <p>We called genotypes on a per-individual basis. Details can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S1</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Datasets</title>
      <p>We used RNA-seq data from lymphoblastic cells lines derived from NA12878 and 13 additional samples (study E-MTAB-1883) with the high confidence genotype calls from the Genome in a Bottle consortium for sample NA12878 used as a gold standard. Note that only non-reference homozygote genotypes are available in the vcf files for this data source. The Genome in a Bottle consortium also provides BED files with high confidence sequencing data for defined regions across the genome for sample NA12978. Although it would be safe to assume that any site included within these high-confidence regions for which variants have not been called are homozygous reference i we did not include those positions in our analysis. We also selected a subsample of 86 individuals of European ancestry coded as GBR from the GEUVADIS for which genotypes and RNA-seq data are publicly available and genotypes and RNA-seq data from the PEAC study. Details for data sources both for genotypes and RNA-seq can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S2</xref>.</p>
    </sec>
    <sec>
      <title>2.3 RNA-seq data processing</title>
      <p>We applied the GATK pipeline for RNA-seq short variant discovery (SNPs + Indels, <ext-link xlink:href="https://gatk.broadinstitute.org/hc/en-us/articles/360035531192-RNAseq-short-variant-discovery-SNPs-Indels-" ext-link-type="uri">https://gatk.broadinstitute.org/hc/en-us/articles/360035531192-RNAseq-short-variant-discovery-SNPs-Indels-</ext-link>) for read alignment and data cleanup (removal of duplicates and base quality recalibration<bold>)</bold> before calling variants. Details on the implementation are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S3</xref>.</p>
    </sec>
    <sec>
      <title>2.4 Comparison to alternative methods</title>
      <p>We validated BBmix against three other popular methods: HaplotypeCaller (<xref rid="btad393-B3" ref-type="bibr">Brouard <italic toggle="yes">et al.</italic> 2019</xref>), Mpileup from Bcftools (<xref rid="btad393-B8" ref-type="bibr">Li 2011</xref>), and FreeBayes (<xref rid="btad393-B5" ref-type="bibr">Garrison and Marth 2012</xref>) which have been applied for RNA-seq genotyping (<xref rid="btad393-B10" ref-type="bibr">Quinn <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad393-B11" ref-type="bibr">Rogier <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad393-B1" ref-type="bibr">Adetunji <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad393-B13" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2021</xref>). We also compared BBmix with a naive method based on applying thresholds on the proportion of reads mapping the alternative allele; we referred to this method as ‘Count threshold’. This comparison allowed us to directly assess the benefit of implementing a statistical model for modelling read counts. The alignment output from the GATK pipeline was used as input for calling genotypes with BBmix, Count threshold, Haplotypecaller, and Mpileup/bcftools. For FreeBayes, the base quality recalibration step was excluded as it is not recommended (<ext-link xlink:href="https://github.com/freebayes/freebayes" ext-link-type="uri">https://github.com/freebayes/freebayes</ext-link>). Each method was run with default parameters. Details of the implementation are in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S4</xref>. We compared hard calls for exonic variants annotated in the 1000 Genome project with allele frequency higher than 0.01 and excluded regions of the genome with known mapping bias against the corresponding gold standard (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S4</xref>). Thus, for each method we have quantified the number of concordant, discordant, or missing calls, and reported the accuracy and total number of calls. For the PEAC gold standard for which probabilistic genotype calls were available, we selected the subset for which genotypes were called with probability 1.</p>
    </sec>
    <sec>
      <title>2.5 Code availability</title>
      <p>The R package with the code for genotyping using bbmix can be found at <ext-link xlink:href="https://gitlab.com/evigorito/bbmix" ext-link-type="uri">https://gitlab.com/evigorito/bbmix and https://cran.r-project.org/package=bbmix</ext-link>. The pipeline for preparing the inputs for running bbmix can be found at <ext-link xlink:href="https://gitlab.com/evigorito/bbmix_pipeline" ext-link-type="uri">https://gitlab.com/evigorito/bbmix_pipeline</ext-link>. The pipeline and code used for preparing the manuscript is at <ext-link xlink:href="https://gitlab.com/evigorito/bbmixpaper_pipeline" ext-link-type="uri">https://gitlab.com/evigorito/bbmixpaper_pipeline</ext-link>. The versions of all the software tools used for producing the bbmix R-package, pipeline, and manuscript are listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S5</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Determining the number of SNPs for training the beta-binomial mixture model</title>
      <p>We first evaluated the effect of the number of SNPs used to train the beta-binomial mixture (BBmix) model on the accuracy of genotype calls. To this end, three sets of 500, 1000, 2000, 3000, 4000, 5000, or 10 000 SNPs with at least 10 mapping reads (<italic toggle="yes">21 sets</italic> in total) were randomly selected from the Genome in a bottle sample NA12878. We fit the BBmix model independently on each subset. As expected, increasing the number of SNPs resulted in a narrower posterior distribution of the mean parameter of each component (<xref rid="btad393-F1" ref-type="fig">Fig. 1a</xref>), while the posterior mean for heterozygous calls departed from 0.5, suggestive of over-representation of the reference allele consistent with reference mapping bias (<xref rid="btad393-F1" ref-type="fig">Fig. 1a</xref>, medium panel). Note that each component of the model corresponds to each possible genotype. Increasing the number of training SNPs also resulted in overall small gains in concordance between genotype dosages estimated by BBmix and the high-confidence calls available from the Genome in a bottle consortium until a plateau was reached at about 4000 SNPs (<xref rid="btad393-F1" ref-type="fig">Fig. 1b</xref>). For subsequent analysis, we trained our model with 1000 SNPs, which we considered a good trade-off between concordance and computational time (mean time = 46 min, <xref rid="btad393-F1" ref-type="fig">Fig. 1c</xref>).</p>
      <p>Some analyses require hard calls instead of genotype dosages. To define hard calls, we assigned the most likely genotype when its probability is above a predefined threshold. We tested thresholds of 0.90, 0.95, and 0.99 for sample NA12878 and chose to favour accuracy over number of calls. We selected 0.99 as at depth 10 the concordance was 99.82% (0.1% increase relative to 0.9) while the loss in the number of calls was 0.15% (9303 total calls, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). In subsequent analyses, when applying the BBmix model on hard calls we selected 0.99 as the probability threshold.</p>
      <fig position="float" id="btad393-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Concordance of calls by genotype. For each method, the number of concordant calls relative to the gold standard for those SNPs with at least 10 supporting reads was calculated. The analysis was done for (a) Genome in a Bottle sample NA12878, (b) GEUVADIS samples, and (c) PEAC samples. Note that for sample NA12878, the gold standard has only calls for heterozygous (1) and homozygous alternative (2) calls.</p>
        </caption>
        <graphic xlink:href="btad393f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Benchmarking the BBmix model</title>
      <p>We applied HaplotypeCaller, Mpileup from Bcftools, FreeBayes, Count threshold, and BBmix to three datasets: the highly curated genome in a bottle sample, a subset of the GEUVADIS samples with high-quality genotypes and samples from the PEAC study which were genotyped by DNA-microarrays.</p>
      <p>We first assessed the accuracy of the calls stratified by genotype across the different datasets. For this analysis, we hard called genotypes for SNPs with at least 10 supporting reads, which we considered as a good trade-off between coverage and accuracy (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3–S5</xref>). Homozygous reference calls tend to be the most accurate (&gt;99.6%) with the lowest variance across methods (<xref rid="btad393-F2" ref-type="fig">Fig. 2</xref>), while heterozygous calls are generally more prone to error (accuracy &lt; 99.0% in GEUVADIS and PEAC) and showed the highest variability across methods (<xref rid="btad393-F2" ref-type="fig">Fig. 2</xref>). Overall, BBmix was generally superior to competitor methods, with the main gains in the accuracy of heterozygous calls (<xref rid="btad393-F2" ref-type="fig">Fig. 2</xref>). Next, we assessed the prevalence of homozygous calls in the gold standard called heterozygous by methods (homozygous to heterozygous errors) and vice versa (heterozygous to homozygous errors). Overall, we observed a better performance of BBmix in both types of errors with the exception of GEUVADIS on homozygous to heterozygous errors with HaplotypeCaller performing better (<xref rid="btad393-F3" ref-type="fig">Fig. 3</xref>). FreeBayes was consistently worst for homozygous to heterozygous errors while HaplotypeCaller had the worst heterozygous to homozygous error rate for both NA12878 and PEAC (<xref rid="btad393-F3" ref-type="fig">Fig. 3</xref>). Last, we compared methods performance across a wide range of read depth threshold on aggregated genotype calls. The accuracy of BBmix genotype calls was generally superior to competitor methods though the effect appeared modest especially for GEUVADIS and PEAC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3–S5</xref>). This is because roughly 60% of the calls were homozygous reference (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1–S3</xref>) which showed the most accuracy and least variability across methods, while for NA12878 only heterozygous or homozygous-alternative calls were compared. As expected, increasing the depth threshold decreased the gap in accuracy between BBmix and Count threshold. We also compared BBmix to the Count threshold method using additional thresholds (0.2, 0.15, 0.05, and 0.001) in addition to our default of 0.1. The highest accuracy was observed with thresholds 0.1 and 0.05 across all datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S6–S8</xref>). Last, for sensitivity analysis for BBmix hard calls, we compared the accuracy of BBmix using thresholds of 0.9 and 0.95, in addition to our default of 0.99 (selected based on sample NA12878 in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). As with sample NA12878, changing the threshold even to 0.9 produced a small drop in accuracy, which was more noticeable at lower depth (from 99.7% to 99.6% in GEUVADIS and from 99.30% to 99.28% in PEAC, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S9 and S10</xref>, respectively).</p>
      <fig position="float" id="btad393-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Genotype error type by method. For each method, it is shown the percentage or erroneous calls for the indicated type (heterozygous in gold standard but homozygous by method [het -&gt; hom] or vice versa). Only SNPs with at least 10 supporting reads were considered. (a) Genome in a Bottle sample NA12878, (b) GEUVADIS samples, and (c) PEAC samples. Note that for sample NA12878 the gold standard has only calls for heterozygous (1) and homozygous alternative (2) calls.</p>
        </caption>
        <graphic xlink:href="btad393f3" position="float"/>
      </fig>
      <p>With regards to the number of calls made by each method, HaplotypeCaller had the highest number of calls, about 20%–30% higher than BBmix, with the main gain being on homozygous reference calls (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1–S3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3b–S5b</xref>). For the subset of calls that were validated in the gold standard, Mpileup had the highest number, between 10% and 25% higher than BBmix (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3b–S5b</xref>). Overall, BBmix accuracy was generally superior at the cost of lower number of calls.</p>
    </sec>
    <sec>
      <title>3.3 Exchangeability of model parameters between samples</title>
      <p>Thus far we trained the BBmix model repeatedly for each sample under consideration. To save computational time, we could train the model with a sample of reads from the pooled samples to learn the model parameters μ and λ and then call genotypes in each sample. Even better would be to have default parameters from an external sample and completely avoid model training. We assessed those options as follows: for sample NA12878, we trained the model with each of the 13 samples that were RNA-sequenced together with NA12878, with a pool of reads from all of the samples or using a randomly selected GEUVADIS external sample. We then called genotypes in NA12878 using the aforementioned scheme for model training and assessed genotype accuracy against the gold standard. The accuracy on genotypes was very robust to the source of reads for parameter training, ranging from 99.25% to 99.60% for heterozygous calls and 99.40% to 99.60% for homozygous alternative calls, and very close to the model trained with NA12878 reads, 99.38% for heterozygous and 99.44% for homozygous alternative calls (<xref rid="btad393-F4" ref-type="fig">Fig. 4a</xref>). Next, we extended the analysis to the GEUVADIS subcohort by training the model with a pool of reads. We then called genotypes for each sample using the model trained either with the pool of reads, the external sample NA12878 or with the same sample used to fit the model. Again, the concordance of calls across all genotypes was very similar regardless of the source of reads used for training (<xref rid="btad393-F4" ref-type="fig">Fig. 4b</xref>). Last, the same analysis performed in PEAC produced the same pattern, with very high concordance on genotype calls even when training with external samples (<xref rid="btad393-F4" ref-type="fig">Fig. 4c</xref>).</p>
      <fig position="float" id="btad393-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Exchangeability of model parameters. (a) The BBmix model was trained with each of the E-MTAB-1883 samples, a pool of those samples or a randomly selected external GEUVADIS sample (indicated in the <italic toggle="yes">x</italic>-axis). Genotypes were called in sample NA12878 and the concordance against the gold standard stratified by genotype is shown in the <italic toggle="yes">y</italic>-axis. (b) The BBmix model was trained with each of the GEUVADIS samples, a pool of them or the external sample NA12878. For each sample (<italic toggle="yes">x</italic>-axis), the plot shows the concordance on genotypes (<italic toggle="yes">y</italic>-axis) called with the same sample used for training the pool or NA12878. The arrow indicates sample HG00243 to ease comparison with <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>. (c) Same as in (b) except that genotypes for the PEAC samples were additionally called using HG00243 as an external sample. The arrows indicate sample QMUL2009047 to ease comparison with <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>.</p>
        </caption>
        <graphic xlink:href="btad393f4" position="float"/>
      </fig>
      <p>Prompted by the high level of genotype concordance regardless of training sample, we compared the distribution of the posterior samples for the model parameters trained with either a pool of the respective study samples with NA12878, a representative sample for GEUVADIS or PEAC. In all examples, we observed a mixed pattern with some parameters showing similar distributions but clear departures from the identity line as well (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>).</p>
      <p>Overall, genotype calls appeared to be robust with regards to the source of reads used for model training.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Current pipelines for calling variants from RNA-seq rely on data cleaning and algorithms designed for DNA sequencing, ignoring ASE and reference mapping bias. In this study, we provide proof of concept that calling genotypes from RNA-seq can be improved by modelling intrinsic sources of variation in RNA-seq read counts.</p>
    <p>Our motivation to call variants from RNA-seq was to detect expression quantitative trait loci (eQTLs) using ASE, which requires genotyping of exonic SNPs (<xref rid="btad393-B4" ref-type="bibr">Castel <italic toggle="yes">et al.</italic> 2015</xref>). This is because calling variants from RNA-seq has the potential to increase coverage for variants overlapping expressed genes. Moreover, genotyping errors arising from DNA-based genotyping may introduce bias. For example, if homozygous exonic SNPs are mistyped as heterozygous, the RNA-seq reads will appear to show a strong allelic imbalance. We showed here that our method generally reduced this type of error compared with the other methods and performed particularly well on heterozygous calls, which is likely due to our modelling strategy accounting for noise in RNA-seq reads.</p>
    <p>Our contribution shows that accounting for bias in RNA-seq can improve genotyping accuracy and we provide a statistical framework for modelling such data, in the case of the most carefully curated gold standard, the Genome in a Bottle sample, we reduced the proportion of erroneous calls over 4-fold compared with the next best method. Even if BBmix tends to increase accuracy, this occurs at the cost of reduced genotype calls made. Thus, the method is designed to prioritize accuracy over volume. While our method was not designed as a standalone pipeline for discovery, our modelling approach has potential to be integrated within current algorithms such as HaplotypeCaller, Mpileup, or FreeBayes to tailor those methods for RNA-seq. Although Bayesian approaches tend to be computationally expensive, we showed that a modest number of training SNPs (1000) tends to be sufficient to learn the model parameters in less than an hour, and that genotyping was very consistent even when using an external sample, which completely eliminates the need for model training. Thus, our work presents a method tailored for genotyping using RNA-seq and also highlights that the current methods for variant-calling using DNA could be adapted for RNA-seq by modelling RNA-seq count biases.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad393_Supplementary_Data</label>
      <media xlink:href="btad393_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the reviewers for their intellectual input which certainly improved the manuscript.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>C.W. holds research funding from GSK and MSD for an unrelated project and is a part-time employee of GSK. These companies had no involvement in or influence on this manuscript.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was cofunded by the Wellcome Trust [WT220788], the MRC [MC_UU_ 00002/4] and supported by the NIHR Cambridge Biomedical Research Centre [BRC-1215-20014]. M.J.L., A.B., and C.P were supported by the MRC/Arthritis Research UK award: Maximising Therapeutic Utility in RA (MATURA) [Grant MR-K015346]. The PEAC was supported by funding from the MRC [grant number G0800648].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The “Genome in a bottle” consortium has developed a pipeline integrating sequencing data generated by multiple technologies to produce a list of high confident heterozygous and homozygous alternative variant calls widely used for benchmarking and validation of variant calling pipelines <ext-link xlink:href="https://www.nist.gov/programs-projects/genome-bottle" ext-link-type="uri">https://www.nist.gov/programs-projects/genome-bottle</ext-link>. The sample employed is NA12878/HG001 from the HapMap project <ext-link xlink:href="https://www.genome.gov/10001688/international-hapmap-project" ext-link-type="uri">https://www.genome.gov/10001688/international-hapmap-project</ext-link>. Genotype calls were downloaded from <ext-link xlink:href="https://ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/release//NA12878_HG001/latest/GRCh37/HG001_GRCh37_GIAB_highconf_CG-IllFB-IllGATKHC-Ion-10X-SOLID_CHROM1-X_v.3.3.2_highconf_PGandRTGphasetransfer.vcf.gz" ext-link-type="uri">ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/release//NA12878_HG001/latest/GRCh37/HG001_GRCh37_GIAB_highconf_CG-IllFB-IllGATKHC-Ion-10X-SOLID_CHROM1-X_v.3.3.2_highconf_PGandRTGphasetransfer.vcf.gz</ext-link>. This corresponds to version v3.3.2. In addition, RNA-seq data produced from a lymphoblastic cell line derived from sample NA12878 in addition to 13 other samples from the 1000 Genome project were available in the study E-MTAB-1883 at array express <ext-link xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-1883/" ext-link-type="uri">https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-1883/</ext-link>. We downloaded RNA-seq data from 86 GEUVADIS lymphoblastic cell line samples with EUR ancestry (GBR code) from ArrayExpress (E-GEUV-1). Genotypes by DNA sequencing are publicly available from the 1000 Genome consortium <ext-link xlink:href="https://www.internationalgenome.org/data-portal/data-collection" ext-link-type="uri">https://www.internationalgenome.org/data-portal/data-collection</ext-link> at <ext-link xlink:href="https://www.internationalgenome.org/data-portal/data-collection/phase-3" ext-link-type="uri">https://www.internationalgenome.org/data-portal/data-collection/phase-3</ext-link>. For our “real data” example we used RNA-seq samples from synovial tissue for 82 samples of the Pathobiology of Early Arthritis Cohort (PEAC) study <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6718830/#mmc1" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6718830/#mmc1</ext-link> available at array express (E-MTAB-6141) <ext-link xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6141/samples/DNA-microarray" ext-link-type="uri">https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6141/samples/ DNA-microarray</ext-link>. Genotypes by DNA-microarray are available upon reasonable request.The file used to exclude difficult to map regions in the chromosome was downloaded from phASER <ext-link xlink:href="https://github.com/secastel/phaser/tree/master/phaser" ext-link-type="uri">https://github.com/secastel/phaser/tree/master/phaser</ext-link> at <ext-link xlink:href="https://www.dropbox.com/s/fbfntaa4oc75x6m/hg19_hla.bed.gz?dl=0" ext-link-type="uri">https://www.dropbox.com/s/fbfntaa4oc75x6m/hg19_hla.bed.gz?dl=0</ext-link>.</p>
  </sec>
  <sec>
    <title>Web resources</title>
    <p>R <ext-link xlink:href="https://cran.r-project.org/" ext-link-type="uri">https://cran.r-project.org/</ext-link>.</p>
    <p>BBmix <ext-link xlink:href="https://gitlab.com/evigorito/bbmix" ext-link-type="uri">https://gitlab.com/evigorito/bbmix</ext-link>.</p>
    <p>bcftools <ext-link xlink:href="https://samtools.github.io/bcftools/bcftools.html" ext-link-type="uri">https://samtools.github.io/bcftools/bcftools.html</ext-link>.</p>
    <p>GATK <ext-link xlink:href="https://gatk.broadinstitute.org/hc/en-us" ext-link-type="uri">https://gatk.broadinstitute.org/hc/en-us</ext-link>.</p>
    <p>FreeBayes <ext-link xlink:href="https://github.com/freebayes/freebayes" ext-link-type="uri">https://github.com/freebayes/freebayes</ext-link>.</p>
    <p>BBmix pipeline for input preparation <ext-link xlink:href="https://gitlab.com/evigorito/bbmix_pipelineCode" ext-link-type="uri">https://gitlab.com/evigorito/bbmix_pipelineCode</ext-link> used for the analysis <ext-link xlink:href="https://gitlab.com/evigorito/bbmixpaper_pipeline" ext-link-type="uri">https://gitlab.com/evigorito/bbmixpaper_pipeline</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad393-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adetunji</surname><given-names>MO</given-names></string-name>, <string-name><surname>Lamont</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Abasht</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Variant analysis pipeline for accurate detection of genomic variants from transcriptome sequencing data</article-title>. <source>PLoS ONE</source><year>2019</year>;<volume>14</volume>:<fpage>e0216838</fpage>.<pub-id pub-id-type="pmid">31545812</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Akutagawa</surname><given-names>J</given-names></string-name>, <string-name><surname>Mak</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Aspden</surname><given-names>JL</given-names></string-name></person-group><etal>et al</etal> Identification of cancer drivers from tumor-only RNA-seq with RNA-VACAY. 2022.05.10.491431; <year>2022</year>.</mixed-citation>
    </ref>
    <ref id="btad393-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brouard</surname><given-names>J-S</given-names></string-name>, <string-name><surname>Schenkel</surname><given-names>F</given-names></string-name>, <string-name><surname>Marete</surname><given-names>A</given-names></string-name></person-group> et al. <article-title>The GATK joint genotyping workflow is appropriate for calling variants in RNA-seq experiments</article-title>. <source>J Anim Sci Biotechnol</source><year>2019</year>;<volume>10</volume>:<fpage>44</fpage>.<pub-id pub-id-type="pmid">31249686</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Castel</surname><given-names>SE</given-names></string-name>, <string-name><surname>Levy-Moonshine</surname><given-names>A</given-names></string-name>, <string-name><surname>Mohammadi</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Tools and best practices for data processing in allelic expression analysis</article-title>. <source>Genome Biol</source><year>2015</year>;<volume>16</volume>:<fpage>195</fpage>.<pub-id pub-id-type="pmid">26381377</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Garrison</surname><given-names>E</given-names></string-name>, <string-name><surname>Marth</surname><given-names>G.</given-names></string-name></person-group> Haplotype-based variant detection from short-read sequencing. <italic toggle="yes">arXiv Preprint arXiv</italic>:1207.3907.</mixed-citation>
    </ref>
    <ref id="btad393-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jehl</surname><given-names>F</given-names></string-name>, <string-name><surname>Degalez</surname><given-names>F</given-names></string-name>, <string-name><surname>Bernard</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>RNA-Seq data for reliable SNP detection and genotype calling: interest for coding variant characterization and cis-regulation analysis by allele-specific expression in livestock species</article-title>. <source>Front Genet</source><year>2021</year>;<volume>12</volume>(1):17.</mixed-citation>
    </ref>
    <ref id="btad393-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lewis</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Barnes</surname><given-names>MR</given-names></string-name>, <string-name><surname>Blighe</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular portraits of early rheumatoid arthritis identify clinical and treatment response phenotypes</article-title>. <source>Cell Rep</source><year>2019</year>;<volume>28</volume>:<fpage>2455</fpage>–<lpage>70.e5</lpage>.<pub-id pub-id-type="pmid">31461658</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>2987</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abecasis</surname><given-names>GR</given-names></string-name>, <string-name><surname>Auton</surname><given-names>A</given-names></string-name>, <string-name><surname>Brooks</surname><given-names>LD</given-names></string-name></person-group><etal>et al</etal>; <collab>1000 Genomes Project Consortium</collab>. <article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>. <source>Nature</source><year>2012</year>;<volume>491</volume>:<fpage>56</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">23128226</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quinn</surname><given-names>EM</given-names></string-name>, <string-name><surname>Cormican</surname><given-names>P</given-names></string-name>, <string-name><surname>Kenny</surname><given-names>EM</given-names></string-name></person-group><etal>et al</etal><article-title>Development of strategies for SNP detection in RNA-Seq data: application to lymphoblastoid cell lines and evaluation using 1000 genomes data</article-title>. <source>PLoS ONE</source><year>2013</year>;<volume>8</volume>:<fpage>e58815</fpage>.<pub-id pub-id-type="pmid">23555596</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rogier</surname><given-names>O</given-names></string-name>, <string-name><surname>Chateigner</surname><given-names>A</given-names></string-name>, <string-name><surname>Amanzougarene</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Accuracy of RNAseq based SNP discovery and genotyping in <italic toggle="yes">Populus nigra</italic></article-title>. <source>BMC Genomics</source><year>2018</year>;<volume>19</volume>:<fpage>909</fpage>.<pub-id pub-id-type="pmid">30541448</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B12">
      <mixed-citation publication-type="other"><collab>Stan Development Team</collab>. <year>2018</year>. <italic toggle="yes">RStan: the R interface to Stan. R package version 2.18.2</italic>. <ext-link xlink:href="https://mc-stan.org" ext-link-type="uri">https://mc-stan.org</ext-link></mixed-citation>
    </ref>
    <ref id="btad393-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>T</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Ruan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>A pipeline for RNA-seq based eQTL analysis with automated quality control procedures</article-title>. <source>BMC Bioinformatics</source><year>2021</year>;<volume>22</volume>:<fpage>403</fpage>.<pub-id pub-id-type="pmid">34433407</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10318392</article-id>
    <article-id pub-id-type="pmid">37338536</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad393</article-id>
    <article-id pub-id-type="publisher-id">btad393</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BBmix: a Bayesian beta-binomial mixture model for accurate genotyping from RNA-sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6230-3849</contrib-id>
        <name>
          <surname>Vigorito</surname>
          <given-names>Elena</given-names>
        </name>
        <aff><institution>MRC Biostatistics Unit, University of Cambridge</institution>, Cambridge CB2 0SR, <country country="GB">United Kingdom</country></aff>
        <xref rid="btad393-cor1" ref-type="corresp"/>
        <!--elena.vigorito@mrc-bsu.cam.ac.uk-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3316-2527</contrib-id>
        <name>
          <surname>Barton</surname>
          <given-names>Anne</given-names>
        </name>
        <aff><institution>Division of Musculoskeletal and Dermatological Sciences, University of Manchester</institution>, Manchester M13 9PL, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pitzalis</surname>
          <given-names>Costantino</given-names>
        </name>
        <aff><institution>Centre for Experimental Medicine and Rheumatology, William Harvey Research Institute, Barts and The London School of Medicine and Dentistry, Queen Mary University of London</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9365-5345</contrib-id>
        <name>
          <surname>Lewis</surname>
          <given-names>Myles J</given-names>
        </name>
        <aff><institution>Centre for Experimental Medicine and Rheumatology, William Harvey Research Institute, Barts and The London School of Medicine and Dentistry, Queen Mary University of London</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9755-1703</contrib-id>
        <name>
          <surname>Wallace</surname>
          <given-names>Chris</given-names>
        </name>
        <aff><institution>MRC Biostatistics Unit, University of Cambridge</institution>, Cambridge CB2 0SR, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Cambridge Institute of Therapeutic Immunology &amp; Infectious Disease (CITIID), Jeffrey Cheah Biomedical Centre, Cambridge Biomedical Campus, University of Cambridge</institution>, Cambridge CB2 0AW, <country country="GB">United Kingdom</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad393-cor1">Corresponding author. MRC Biostatistics Unit, University of Cambridge, Forvie Site, Robinson Way, Cambridge CB2 0SR, United Kingdom. E-mail: <email>elena.vigorito@mrc-bsu.cam.ac.uk</email> (E.V.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-06-20">
      <day>20</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>7</issue>
    <elocation-id>btad393</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>13</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>03</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad393.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>While many pipelines have been developed for calling genotypes using RNA-sequencing (RNA-Seq) data, they all have adapted DNA genotype callers that do not model biases specific to RNA-Seq such as allele-specific expression (ASE).</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present Bayesian beta-binomial mixture model (BBmix), a Bayesian beta-binomial mixture model that first learns the expected distribution of read counts for each genotype, and then deploys those learned parameters to call genotypes probabilistically. We benchmarked our model on a wide variety of datasets and showed that our method generally performed better than competitors, mainly due to an increase of up to 1.4% in the accuracy of heterozygous calls, which may have a big impact in reducing false positive rate in applications sensitive to genotyping error such as ASE. Moreover, BBmix can be easily incorporated into standard pipelines for calling genotypes. We further show that parameters are generally transferable within datasets, such that a single learning run of less than 1 h is sufficient to call genotypes in a large number of samples.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>We implemented BBmix as an R package that is available for free under a GPL-2 licence at <ext-link xlink:href="https://gitlab.com/evigorito/bbmix" ext-link-type="uri">https://gitlab.com/evigorito/bbmix</ext-link> and <ext-link xlink:href="https://cran.r-project.org/package=bbmix" ext-link-type="uri">https://cran.r-project.org/package=bbmix</ext-link> with accompanying pipeline at <ext-link xlink:href="https://gitlab.com/evigorito/bbmix_pipeline" ext-link-type="uri">https://gitlab.com/evigorito/bbmix_pipeline</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>WT220788</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>RNA-sequencing (RNA-Seq) is an established and popular technique with applications in transcript quantification and detection of alternative splicing, among others. More recently, a growing number of studies have developed and tested pipelines to use RNA-seq for variant and genotype calling (<xref rid="btad393-B10" ref-type="bibr">Quinn <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad393-B11" ref-type="bibr">Rogier <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad393-B1" ref-type="bibr">Adetunji <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad393-B3" ref-type="bibr">Brouard <italic toggle="yes">et al.</italic> 2019</xref>), including somatic variant detection and identification of cancer drivers (<xref rid="btad393-B2" ref-type="bibr">Akutagawa <italic toggle="yes">et al.</italic> 2022</xref>). Applications include calling variants when DNA genotypes are unavailable (<xref rid="btad393-B13" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2021</xref>), studying cis-regulated genes by analysing allele-specific expression (ASE) or conducting genome-wide association studies (GWAS) in non-model species, since whole-genome sequencing is expensive and exome sequencing tools may be unavailable (<xref rid="btad393-B6" ref-type="bibr">Jehl <italic toggle="yes">et al.</italic> 2021</xref>). Genotype calling using RNA-seq is often more challenging than DNA sequencing: coverage can be highly variable between genes, many reads map across splice junctions making correct alignment more difficult, and cis-acting eQTLs may create unequal expression between chromosomes. Despite this, for many applications, accuracy is paramount, e.g. in ASE, miscalling a homozygous genotype as heterozygous will create a false signal of allelic imbalance.</p>
    <p>RNA-seq genotyping pipelines employ RNA-seq-based aligners and quality control steps for filtering out potentially erroneous calls, but use the same statistical models as for DNA sequencing. While adopting these methods provides a convenient way to call variants from RNA-seq, there are sources of variation in RNA-seq data that are not accounted for. In DNA sequencing, in an ideal world reads would follow a binomial model, then, out of <italic toggle="yes">n</italic> reads covering a single nucleotide polymorhism (SNP), we would expect 0, <italic toggle="yes">n</italic>/2, and <italic toggle="yes">n</italic> to contain the alternative allele for genotypes 0, 1, and 2, respectively. Sampling variation and reference mapping bias may mean the observed heterozygote genotype count deviates from <italic toggle="yes">n</italic>/2 particularly when <italic toggle="yes">n</italic> is small, and the homozygote observations may deviate minorly from 0 and <italic toggle="yes">n</italic> due to sequencing or mapping errors. However, when <italic toggle="yes">n</italic> is large, the genotypes are expected to be clearly distinguishable. In RNA-seq, the heterozygote observation may show much greater variance, because heterozygosity at local regulatory sequences may cause overamplification of the allele on one chromosome over the allele on its homologue, with this effect varying between samples as genotypes at the regulatory sequences vary. This may push the observed heterozygote count nearer to 0 or <italic toggle="yes">n</italic>, making a miscall as a homozygote more likely, particularly when <italic toggle="yes">n</italic> is small.</p>
    <p>In this work, we wanted to test whether directly modelling this additional variation in RNA-seq data could improve the quality of the genotype calls. To this end, we developed Bayesian beta-binomial mixture model (BBmix), a two-step method based on first modelling the genotype-specific read counts using beta-binomial distributions and then using these to infer genotype posterior probabilities. We benchmarked our method using high confidence calls from the Genome in a Bottle consortium (<ext-link xlink:href="https://www.nist.gov/programs-projects/genome-bottle" ext-link-type="uri">https://www.nist.gov/programs-projects/genome-bottle</ext-link>), the subset of GBR samples from the Genetic European Variation in Disease (GEUVADIS) project (McVean <italic toggle="yes">et al.</italic> 2012), for which RNA-seq data and high-quality genotype calls are publicly available and samples from the Pathobiology of Early Arthritis Cohort (PEAC) cohort (<xref rid="btad393-B7" ref-type="bibr">Lewis <italic toggle="yes">et al.</italic> 2019</xref>) for a ‘real data’ case study. This is a cohort of 82 adult treatment-naive rheumatoid arthritis patients for whom RNA-seq from synovial tissue samples and DNA-microarray-based genotypes are available. We found that our method generally performed better than competitors and can be easily incorporated into standard pipelines for calling variants.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 The BBmix statistical model</title>
      <p>We model the number of reads of the alternative allele at each SNP as a mixture of three beta-binomial distributions corresponding to the three possible genotypes, conditional on the total number of reads overlapping the SNP. To allow for sequencing or alignment errors as well as reference mapping bias, the mean and variance parameters of each distribution are learned from the data. As the parameters of these distributions are shared between SNPs, we learn them from many SNPs in a Bayesian model. To maximize computational efficiency, we train the model on a random subset of SNPs and use the learnt parameters to call genotype probabilities across all SNPs.</p>
      <sec>
        <title>2.1.1 Fitting a beta-binomial mixture model to RNA-seq data</title>
        <p>We selected RNA-seq reads overlapping a predefined set of feature SNPs (fSNPs) that we aim to genotype. We treat genotype as a latent variable, <italic toggle="yes">G</italic>, which corresponds to the number of alternative alleles at a given fSNP, <italic toggle="yes">g</italic> = (0, 1, 2), and we assume that the distribution of reads differs according to its value. Given fSNPs indexed by <italic toggle="yes">l</italic>, we denote <italic toggle="yes">R<sub>al</sub></italic> as the number of reads overlapping its alternative allele and <italic toggle="yes">R<sub>tl</sub></italic> the total number of reads mapping <italic toggle="yes">s<sub>l</sub></italic>. We then fit a mixture of three beta-binomial distributions to the allelic counts of a random sample of <italic toggle="yes">L</italic> fSNPs to estimate the parameters (<italic toggle="yes">μ</italic>, vector of the mean of each component, and μ, vector of the overdispersion of each component) for the underlying distribution of genotypes. With λ a vector of the proportion of each component, we express the likelihood as
where BB() is the beta-binomial distribution:
which we reparameterize to:
</p>
        <disp-formula id="E1">
          <mml:math id="M1" display="block" overflow="scroll">
            <mml:mi>L</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="normal">Π</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mi>L</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mo stretchy="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>g</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>g</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mrow/>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>θ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mi mathvariant="normal">B</mml:mi>
            <mml:mi mathvariant="normal">B</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>R</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>R</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>μ</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>λ</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E2">
          <mml:math id="M2" display="block" overflow="scroll">
            <mml:mi>f</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mi>R</mml:mi>
                <mml:mrow>
                  <mml:mi>a</mml:mi>
                  <mml:mi>l</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>|</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mi>R</mml:mi>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                  <mml:mi>l</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo>α</mml:mo>
                <mml:mi>g</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:msub>
                    <mml:mo>β</mml:mo>
                    <mml:mi>g</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow/>
              </mml:msub>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mfenced separators="|">
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow/>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>R</mml:mi>
                            <mml:mrow>
                              <mml:mi>a</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>R</mml:mi>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mi mathvariant="normal">B</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>R</mml:mi>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mo>α</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mo> </mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>R</mml:mi>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>-</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>R</mml:mi>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mo>β</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">B</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mo>α</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mo>β</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <disp-formula id="E3">
          <mml:math id="M3" display="block" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>μ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>α</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>α</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>β</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mo> </mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>λ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>α</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>β</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:math>
        </disp-formula>
        <p>We put the following priors:
</p>
        <disp-formula id="E4">
          <mml:math id="M4" display="block" overflow="scroll">
            <mml:mo>θ</mml:mo>
            <mml:mo>∼</mml:mo>
            <mml:mi mathvariant="normal">Dirichlet</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mn>1,1</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>)</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E5">
          <mml:math id="M5" display="block" overflow="scroll">
            <mml:mo>α</mml:mo>
            <mml:mo>∼</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:mn>1,10,499</mml:mn>
            <mml:mo>)</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E6">
          <mml:math id="M6" display="block" overflow="scroll">
            <mml:mi>β</mml:mi>
            <mml:mo>∼</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:mn>499,10,1</mml:mn>
            <mml:mo>)</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E7">
          <mml:math id="M7" display="block" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>μ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>∼</mml:mo>
            <mml:mi mathvariant="normal">Beta</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>α</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>β</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>)</mml:mo>
          </mml:math>
        </disp-formula>
        <disp-formula id="E8">
          <mml:math id="M8" display="block" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>λ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>∼</mml:mo>
            <mml:mi mathvariant="normal">Γ</mml:mi>
            <mml:mfenced open="(" close=")" separators="|">
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>α</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>β</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>.</mml:mo>
          </mml:math>
        </disp-formula>
        <p>We selected the Dirichlet prior as the natural choice for a set of probabilities that sum to 1, and the informative priors for α and β were selected by visual inspection of the fit of beta distributions to the empirical distribution of reads for a collection of fSNPs with effect allele frequency (EAF) higher than 0.01 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
        <fig position="float" id="btad393-F1">
          <label>Figure 1.</label>
          <caption>
            <p>Training the beta-binomial mixture (BBmix) model with different numbers of SNPs. A random sample of RNA-seq reads for the indicated number of SNPs with at least 10 supportive reads was used to train the BBmix model. The procedure was repeated three times. (a) Mean and 95% credible interval for the posterior distribution for each of the three components of the mean parameter (mu[1–3]). (b) Concordance of calls (<italic toggle="yes">y</italic>-axis) based on the expected genotypes (dosages) called with the parameters learnt from the BBmix model trained with the indicated number of SNPs (<italic toggle="yes">x</italic>-axis). The black points correspond to each replicate and the red triangle corresponds to the mean. (c) Running time (h) for fitting the BBmix model for the indicated number of SNPs. The average time when training with 500 SNPs was 25 min; for 1000 SNPs was 46 min; for 2000 83 min; for 3000 128 min; for 4000 2.9 h; for 5000 SNPs 4 h, and for 10 000 SNPs 10 h. The dashed line corresponds to the linear regression line.</p>
          </caption>
          <graphic xlink:href="btad393f1" position="float"/>
        </fig>
        <p>We estimated μ and λ by Markov chain Monte Carlo implemented in Stan (<xref rid="btad393-B12" ref-type="bibr">Stan Development Team, 2018</xref>). We checked convergence using Stan built-in <italic toggle="yes">n_eff</italic> and <italic toggle="yes">Rhat</italic> statistics as well as visual examination. We obtained 4000 posterior observations sampled from four chains for each parameter. For each chain, we discarded the first 1000 observations.</p>
      </sec>
      <sec>
        <title>2.1.2 Calling genotypes</title>
        <p>We called genotypes on a per-individual basis. Details can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S1</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Datasets</title>
      <p>We used RNA-seq data from lymphoblastic cells lines derived from NA12878 and 13 additional samples (study E-MTAB-1883) with the high confidence genotype calls from the Genome in a Bottle consortium for sample NA12878 used as a gold standard. Note that only non-reference homozygote genotypes are available in the vcf files for this data source. The Genome in a Bottle consortium also provides BED files with high confidence sequencing data for defined regions across the genome for sample NA12978. Although it would be safe to assume that any site included within these high-confidence regions for which variants have not been called are homozygous reference i we did not include those positions in our analysis. We also selected a subsample of 86 individuals of European ancestry coded as GBR from the GEUVADIS for which genotypes and RNA-seq data are publicly available and genotypes and RNA-seq data from the PEAC study. Details for data sources both for genotypes and RNA-seq can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S2</xref>.</p>
    </sec>
    <sec>
      <title>2.3 RNA-seq data processing</title>
      <p>We applied the GATK pipeline for RNA-seq short variant discovery (SNPs + Indels, <ext-link xlink:href="https://gatk.broadinstitute.org/hc/en-us/articles/360035531192-RNAseq-short-variant-discovery-SNPs-Indels-" ext-link-type="uri">https://gatk.broadinstitute.org/hc/en-us/articles/360035531192-RNAseq-short-variant-discovery-SNPs-Indels-</ext-link>) for read alignment and data cleanup (removal of duplicates and base quality recalibration<bold>)</bold> before calling variants. Details on the implementation are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S3</xref>.</p>
    </sec>
    <sec>
      <title>2.4 Comparison to alternative methods</title>
      <p>We validated BBmix against three other popular methods: HaplotypeCaller (<xref rid="btad393-B3" ref-type="bibr">Brouard <italic toggle="yes">et al.</italic> 2019</xref>), Mpileup from Bcftools (<xref rid="btad393-B8" ref-type="bibr">Li 2011</xref>), and FreeBayes (<xref rid="btad393-B5" ref-type="bibr">Garrison and Marth 2012</xref>) which have been applied for RNA-seq genotyping (<xref rid="btad393-B10" ref-type="bibr">Quinn <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad393-B11" ref-type="bibr">Rogier <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad393-B1" ref-type="bibr">Adetunji <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad393-B13" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2021</xref>). We also compared BBmix with a naive method based on applying thresholds on the proportion of reads mapping the alternative allele; we referred to this method as ‘Count threshold’. This comparison allowed us to directly assess the benefit of implementing a statistical model for modelling read counts. The alignment output from the GATK pipeline was used as input for calling genotypes with BBmix, Count threshold, Haplotypecaller, and Mpileup/bcftools. For FreeBayes, the base quality recalibration step was excluded as it is not recommended (<ext-link xlink:href="https://github.com/freebayes/freebayes" ext-link-type="uri">https://github.com/freebayes/freebayes</ext-link>). Each method was run with default parameters. Details of the implementation are in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S4</xref>. We compared hard calls for exonic variants annotated in the 1000 Genome project with allele frequency higher than 0.01 and excluded regions of the genome with known mapping bias against the corresponding gold standard (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S4</xref>). Thus, for each method we have quantified the number of concordant, discordant, or missing calls, and reported the accuracy and total number of calls. For the PEAC gold standard for which probabilistic genotype calls were available, we selected the subset for which genotypes were called with probability 1.</p>
    </sec>
    <sec>
      <title>2.5 Code availability</title>
      <p>The R package with the code for genotyping using bbmix can be found at <ext-link xlink:href="https://gitlab.com/evigorito/bbmix" ext-link-type="uri">https://gitlab.com/evigorito/bbmix and https://cran.r-project.org/package=bbmix</ext-link>. The pipeline for preparing the inputs for running bbmix can be found at <ext-link xlink:href="https://gitlab.com/evigorito/bbmix_pipeline" ext-link-type="uri">https://gitlab.com/evigorito/bbmix_pipeline</ext-link>. The pipeline and code used for preparing the manuscript is at <ext-link xlink:href="https://gitlab.com/evigorito/bbmixpaper_pipeline" ext-link-type="uri">https://gitlab.com/evigorito/bbmixpaper_pipeline</ext-link>. The versions of all the software tools used for producing the bbmix R-package, pipeline, and manuscript are listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S5</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Determining the number of SNPs for training the beta-binomial mixture model</title>
      <p>We first evaluated the effect of the number of SNPs used to train the beta-binomial mixture (BBmix) model on the accuracy of genotype calls. To this end, three sets of 500, 1000, 2000, 3000, 4000, 5000, or 10 000 SNPs with at least 10 mapping reads (<italic toggle="yes">21 sets</italic> in total) were randomly selected from the Genome in a bottle sample NA12878. We fit the BBmix model independently on each subset. As expected, increasing the number of SNPs resulted in a narrower posterior distribution of the mean parameter of each component (<xref rid="btad393-F1" ref-type="fig">Fig. 1a</xref>), while the posterior mean for heterozygous calls departed from 0.5, suggestive of over-representation of the reference allele consistent with reference mapping bias (<xref rid="btad393-F1" ref-type="fig">Fig. 1a</xref>, medium panel). Note that each component of the model corresponds to each possible genotype. Increasing the number of training SNPs also resulted in overall small gains in concordance between genotype dosages estimated by BBmix and the high-confidence calls available from the Genome in a bottle consortium until a plateau was reached at about 4000 SNPs (<xref rid="btad393-F1" ref-type="fig">Fig. 1b</xref>). For subsequent analysis, we trained our model with 1000 SNPs, which we considered a good trade-off between concordance and computational time (mean time = 46 min, <xref rid="btad393-F1" ref-type="fig">Fig. 1c</xref>).</p>
      <p>Some analyses require hard calls instead of genotype dosages. To define hard calls, we assigned the most likely genotype when its probability is above a predefined threshold. We tested thresholds of 0.90, 0.95, and 0.99 for sample NA12878 and chose to favour accuracy over number of calls. We selected 0.99 as at depth 10 the concordance was 99.82% (0.1% increase relative to 0.9) while the loss in the number of calls was 0.15% (9303 total calls, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). In subsequent analyses, when applying the BBmix model on hard calls we selected 0.99 as the probability threshold.</p>
      <fig position="float" id="btad393-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Concordance of calls by genotype. For each method, the number of concordant calls relative to the gold standard for those SNPs with at least 10 supporting reads was calculated. The analysis was done for (a) Genome in a Bottle sample NA12878, (b) GEUVADIS samples, and (c) PEAC samples. Note that for sample NA12878, the gold standard has only calls for heterozygous (1) and homozygous alternative (2) calls.</p>
        </caption>
        <graphic xlink:href="btad393f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Benchmarking the BBmix model</title>
      <p>We applied HaplotypeCaller, Mpileup from Bcftools, FreeBayes, Count threshold, and BBmix to three datasets: the highly curated genome in a bottle sample, a subset of the GEUVADIS samples with high-quality genotypes and samples from the PEAC study which were genotyped by DNA-microarrays.</p>
      <p>We first assessed the accuracy of the calls stratified by genotype across the different datasets. For this analysis, we hard called genotypes for SNPs with at least 10 supporting reads, which we considered as a good trade-off between coverage and accuracy (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3–S5</xref>). Homozygous reference calls tend to be the most accurate (&gt;99.6%) with the lowest variance across methods (<xref rid="btad393-F2" ref-type="fig">Fig. 2</xref>), while heterozygous calls are generally more prone to error (accuracy &lt; 99.0% in GEUVADIS and PEAC) and showed the highest variability across methods (<xref rid="btad393-F2" ref-type="fig">Fig. 2</xref>). Overall, BBmix was generally superior to competitor methods, with the main gains in the accuracy of heterozygous calls (<xref rid="btad393-F2" ref-type="fig">Fig. 2</xref>). Next, we assessed the prevalence of homozygous calls in the gold standard called heterozygous by methods (homozygous to heterozygous errors) and vice versa (heterozygous to homozygous errors). Overall, we observed a better performance of BBmix in both types of errors with the exception of GEUVADIS on homozygous to heterozygous errors with HaplotypeCaller performing better (<xref rid="btad393-F3" ref-type="fig">Fig. 3</xref>). FreeBayes was consistently worst for homozygous to heterozygous errors while HaplotypeCaller had the worst heterozygous to homozygous error rate for both NA12878 and PEAC (<xref rid="btad393-F3" ref-type="fig">Fig. 3</xref>). Last, we compared methods performance across a wide range of read depth threshold on aggregated genotype calls. The accuracy of BBmix genotype calls was generally superior to competitor methods though the effect appeared modest especially for GEUVADIS and PEAC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3–S5</xref>). This is because roughly 60% of the calls were homozygous reference (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1–S3</xref>) which showed the most accuracy and least variability across methods, while for NA12878 only heterozygous or homozygous-alternative calls were compared. As expected, increasing the depth threshold decreased the gap in accuracy between BBmix and Count threshold. We also compared BBmix to the Count threshold method using additional thresholds (0.2, 0.15, 0.05, and 0.001) in addition to our default of 0.1. The highest accuracy was observed with thresholds 0.1 and 0.05 across all datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S6–S8</xref>). Last, for sensitivity analysis for BBmix hard calls, we compared the accuracy of BBmix using thresholds of 0.9 and 0.95, in addition to our default of 0.99 (selected based on sample NA12878 in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). As with sample NA12878, changing the threshold even to 0.9 produced a small drop in accuracy, which was more noticeable at lower depth (from 99.7% to 99.6% in GEUVADIS and from 99.30% to 99.28% in PEAC, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S9 and S10</xref>, respectively).</p>
      <fig position="float" id="btad393-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Genotype error type by method. For each method, it is shown the percentage or erroneous calls for the indicated type (heterozygous in gold standard but homozygous by method [het -&gt; hom] or vice versa). Only SNPs with at least 10 supporting reads were considered. (a) Genome in a Bottle sample NA12878, (b) GEUVADIS samples, and (c) PEAC samples. Note that for sample NA12878 the gold standard has only calls for heterozygous (1) and homozygous alternative (2) calls.</p>
        </caption>
        <graphic xlink:href="btad393f3" position="float"/>
      </fig>
      <p>With regards to the number of calls made by each method, HaplotypeCaller had the highest number of calls, about 20%–30% higher than BBmix, with the main gain being on homozygous reference calls (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1–S3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3b–S5b</xref>). For the subset of calls that were validated in the gold standard, Mpileup had the highest number, between 10% and 25% higher than BBmix (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3b–S5b</xref>). Overall, BBmix accuracy was generally superior at the cost of lower number of calls.</p>
    </sec>
    <sec>
      <title>3.3 Exchangeability of model parameters between samples</title>
      <p>Thus far we trained the BBmix model repeatedly for each sample under consideration. To save computational time, we could train the model with a sample of reads from the pooled samples to learn the model parameters μ and λ and then call genotypes in each sample. Even better would be to have default parameters from an external sample and completely avoid model training. We assessed those options as follows: for sample NA12878, we trained the model with each of the 13 samples that were RNA-sequenced together with NA12878, with a pool of reads from all of the samples or using a randomly selected GEUVADIS external sample. We then called genotypes in NA12878 using the aforementioned scheme for model training and assessed genotype accuracy against the gold standard. The accuracy on genotypes was very robust to the source of reads for parameter training, ranging from 99.25% to 99.60% for heterozygous calls and 99.40% to 99.60% for homozygous alternative calls, and very close to the model trained with NA12878 reads, 99.38% for heterozygous and 99.44% for homozygous alternative calls (<xref rid="btad393-F4" ref-type="fig">Fig. 4a</xref>). Next, we extended the analysis to the GEUVADIS subcohort by training the model with a pool of reads. We then called genotypes for each sample using the model trained either with the pool of reads, the external sample NA12878 or with the same sample used to fit the model. Again, the concordance of calls across all genotypes was very similar regardless of the source of reads used for training (<xref rid="btad393-F4" ref-type="fig">Fig. 4b</xref>). Last, the same analysis performed in PEAC produced the same pattern, with very high concordance on genotype calls even when training with external samples (<xref rid="btad393-F4" ref-type="fig">Fig. 4c</xref>).</p>
      <fig position="float" id="btad393-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Exchangeability of model parameters. (a) The BBmix model was trained with each of the E-MTAB-1883 samples, a pool of those samples or a randomly selected external GEUVADIS sample (indicated in the <italic toggle="yes">x</italic>-axis). Genotypes were called in sample NA12878 and the concordance against the gold standard stratified by genotype is shown in the <italic toggle="yes">y</italic>-axis. (b) The BBmix model was trained with each of the GEUVADIS samples, a pool of them or the external sample NA12878. For each sample (<italic toggle="yes">x</italic>-axis), the plot shows the concordance on genotypes (<italic toggle="yes">y</italic>-axis) called with the same sample used for training the pool or NA12878. The arrow indicates sample HG00243 to ease comparison with <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>. (c) Same as in (b) except that genotypes for the PEAC samples were additionally called using HG00243 as an external sample. The arrows indicate sample QMUL2009047 to ease comparison with <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>.</p>
        </caption>
        <graphic xlink:href="btad393f4" position="float"/>
      </fig>
      <p>Prompted by the high level of genotype concordance regardless of training sample, we compared the distribution of the posterior samples for the model parameters trained with either a pool of the respective study samples with NA12878, a representative sample for GEUVADIS or PEAC. In all examples, we observed a mixed pattern with some parameters showing similar distributions but clear departures from the identity line as well (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>).</p>
      <p>Overall, genotype calls appeared to be robust with regards to the source of reads used for model training.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Current pipelines for calling variants from RNA-seq rely on data cleaning and algorithms designed for DNA sequencing, ignoring ASE and reference mapping bias. In this study, we provide proof of concept that calling genotypes from RNA-seq can be improved by modelling intrinsic sources of variation in RNA-seq read counts.</p>
    <p>Our motivation to call variants from RNA-seq was to detect expression quantitative trait loci (eQTLs) using ASE, which requires genotyping of exonic SNPs (<xref rid="btad393-B4" ref-type="bibr">Castel <italic toggle="yes">et al.</italic> 2015</xref>). This is because calling variants from RNA-seq has the potential to increase coverage for variants overlapping expressed genes. Moreover, genotyping errors arising from DNA-based genotyping may introduce bias. For example, if homozygous exonic SNPs are mistyped as heterozygous, the RNA-seq reads will appear to show a strong allelic imbalance. We showed here that our method generally reduced this type of error compared with the other methods and performed particularly well on heterozygous calls, which is likely due to our modelling strategy accounting for noise in RNA-seq reads.</p>
    <p>Our contribution shows that accounting for bias in RNA-seq can improve genotyping accuracy and we provide a statistical framework for modelling such data, in the case of the most carefully curated gold standard, the Genome in a Bottle sample, we reduced the proportion of erroneous calls over 4-fold compared with the next best method. Even if BBmix tends to increase accuracy, this occurs at the cost of reduced genotype calls made. Thus, the method is designed to prioritize accuracy over volume. While our method was not designed as a standalone pipeline for discovery, our modelling approach has potential to be integrated within current algorithms such as HaplotypeCaller, Mpileup, or FreeBayes to tailor those methods for RNA-seq. Although Bayesian approaches tend to be computationally expensive, we showed that a modest number of training SNPs (1000) tends to be sufficient to learn the model parameters in less than an hour, and that genotyping was very consistent even when using an external sample, which completely eliminates the need for model training. Thus, our work presents a method tailored for genotyping using RNA-seq and also highlights that the current methods for variant-calling using DNA could be adapted for RNA-seq by modelling RNA-seq count biases.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad393_Supplementary_Data</label>
      <media xlink:href="btad393_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the reviewers for their intellectual input which certainly improved the manuscript.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>C.W. holds research funding from GSK and MSD for an unrelated project and is a part-time employee of GSK. These companies had no involvement in or influence on this manuscript.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was cofunded by the Wellcome Trust [WT220788], the MRC [MC_UU_ 00002/4] and supported by the NIHR Cambridge Biomedical Research Centre [BRC-1215-20014]. M.J.L., A.B., and C.P were supported by the MRC/Arthritis Research UK award: Maximising Therapeutic Utility in RA (MATURA) [Grant MR-K015346]. The PEAC was supported by funding from the MRC [grant number G0800648].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The “Genome in a bottle” consortium has developed a pipeline integrating sequencing data generated by multiple technologies to produce a list of high confident heterozygous and homozygous alternative variant calls widely used for benchmarking and validation of variant calling pipelines <ext-link xlink:href="https://www.nist.gov/programs-projects/genome-bottle" ext-link-type="uri">https://www.nist.gov/programs-projects/genome-bottle</ext-link>. The sample employed is NA12878/HG001 from the HapMap project <ext-link xlink:href="https://www.genome.gov/10001688/international-hapmap-project" ext-link-type="uri">https://www.genome.gov/10001688/international-hapmap-project</ext-link>. Genotype calls were downloaded from <ext-link xlink:href="https://ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/release//NA12878_HG001/latest/GRCh37/HG001_GRCh37_GIAB_highconf_CG-IllFB-IllGATKHC-Ion-10X-SOLID_CHROM1-X_v.3.3.2_highconf_PGandRTGphasetransfer.vcf.gz" ext-link-type="uri">ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/release//NA12878_HG001/latest/GRCh37/HG001_GRCh37_GIAB_highconf_CG-IllFB-IllGATKHC-Ion-10X-SOLID_CHROM1-X_v.3.3.2_highconf_PGandRTGphasetransfer.vcf.gz</ext-link>. This corresponds to version v3.3.2. In addition, RNA-seq data produced from a lymphoblastic cell line derived from sample NA12878 in addition to 13 other samples from the 1000 Genome project were available in the study E-MTAB-1883 at array express <ext-link xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-1883/" ext-link-type="uri">https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-1883/</ext-link>. We downloaded RNA-seq data from 86 GEUVADIS lymphoblastic cell line samples with EUR ancestry (GBR code) from ArrayExpress (E-GEUV-1). Genotypes by DNA sequencing are publicly available from the 1000 Genome consortium <ext-link xlink:href="https://www.internationalgenome.org/data-portal/data-collection" ext-link-type="uri">https://www.internationalgenome.org/data-portal/data-collection</ext-link> at <ext-link xlink:href="https://www.internationalgenome.org/data-portal/data-collection/phase-3" ext-link-type="uri">https://www.internationalgenome.org/data-portal/data-collection/phase-3</ext-link>. For our “real data” example we used RNA-seq samples from synovial tissue for 82 samples of the Pathobiology of Early Arthritis Cohort (PEAC) study <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6718830/#mmc1" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6718830/#mmc1</ext-link> available at array express (E-MTAB-6141) <ext-link xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6141/samples/DNA-microarray" ext-link-type="uri">https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6141/samples/ DNA-microarray</ext-link>. Genotypes by DNA-microarray are available upon reasonable request.The file used to exclude difficult to map regions in the chromosome was downloaded from phASER <ext-link xlink:href="https://github.com/secastel/phaser/tree/master/phaser" ext-link-type="uri">https://github.com/secastel/phaser/tree/master/phaser</ext-link> at <ext-link xlink:href="https://www.dropbox.com/s/fbfntaa4oc75x6m/hg19_hla.bed.gz?dl=0" ext-link-type="uri">https://www.dropbox.com/s/fbfntaa4oc75x6m/hg19_hla.bed.gz?dl=0</ext-link>.</p>
  </sec>
  <sec>
    <title>Web resources</title>
    <p>R <ext-link xlink:href="https://cran.r-project.org/" ext-link-type="uri">https://cran.r-project.org/</ext-link>.</p>
    <p>BBmix <ext-link xlink:href="https://gitlab.com/evigorito/bbmix" ext-link-type="uri">https://gitlab.com/evigorito/bbmix</ext-link>.</p>
    <p>bcftools <ext-link xlink:href="https://samtools.github.io/bcftools/bcftools.html" ext-link-type="uri">https://samtools.github.io/bcftools/bcftools.html</ext-link>.</p>
    <p>GATK <ext-link xlink:href="https://gatk.broadinstitute.org/hc/en-us" ext-link-type="uri">https://gatk.broadinstitute.org/hc/en-us</ext-link>.</p>
    <p>FreeBayes <ext-link xlink:href="https://github.com/freebayes/freebayes" ext-link-type="uri">https://github.com/freebayes/freebayes</ext-link>.</p>
    <p>BBmix pipeline for input preparation <ext-link xlink:href="https://gitlab.com/evigorito/bbmix_pipelineCode" ext-link-type="uri">https://gitlab.com/evigorito/bbmix_pipelineCode</ext-link> used for the analysis <ext-link xlink:href="https://gitlab.com/evigorito/bbmixpaper_pipeline" ext-link-type="uri">https://gitlab.com/evigorito/bbmixpaper_pipeline</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad393-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adetunji</surname><given-names>MO</given-names></string-name>, <string-name><surname>Lamont</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Abasht</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Variant analysis pipeline for accurate detection of genomic variants from transcriptome sequencing data</article-title>. <source>PLoS ONE</source><year>2019</year>;<volume>14</volume>:<fpage>e0216838</fpage>.<pub-id pub-id-type="pmid">31545812</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Akutagawa</surname><given-names>J</given-names></string-name>, <string-name><surname>Mak</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Aspden</surname><given-names>JL</given-names></string-name></person-group><etal>et al</etal> Identification of cancer drivers from tumor-only RNA-seq with RNA-VACAY. 2022.05.10.491431; <year>2022</year>.</mixed-citation>
    </ref>
    <ref id="btad393-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brouard</surname><given-names>J-S</given-names></string-name>, <string-name><surname>Schenkel</surname><given-names>F</given-names></string-name>, <string-name><surname>Marete</surname><given-names>A</given-names></string-name></person-group> et al. <article-title>The GATK joint genotyping workflow is appropriate for calling variants in RNA-seq experiments</article-title>. <source>J Anim Sci Biotechnol</source><year>2019</year>;<volume>10</volume>:<fpage>44</fpage>.<pub-id pub-id-type="pmid">31249686</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Castel</surname><given-names>SE</given-names></string-name>, <string-name><surname>Levy-Moonshine</surname><given-names>A</given-names></string-name>, <string-name><surname>Mohammadi</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Tools and best practices for data processing in allelic expression analysis</article-title>. <source>Genome Biol</source><year>2015</year>;<volume>16</volume>:<fpage>195</fpage>.<pub-id pub-id-type="pmid">26381377</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Garrison</surname><given-names>E</given-names></string-name>, <string-name><surname>Marth</surname><given-names>G.</given-names></string-name></person-group> Haplotype-based variant detection from short-read sequencing. <italic toggle="yes">arXiv Preprint arXiv</italic>:1207.3907.</mixed-citation>
    </ref>
    <ref id="btad393-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jehl</surname><given-names>F</given-names></string-name>, <string-name><surname>Degalez</surname><given-names>F</given-names></string-name>, <string-name><surname>Bernard</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>RNA-Seq data for reliable SNP detection and genotype calling: interest for coding variant characterization and cis-regulation analysis by allele-specific expression in livestock species</article-title>. <source>Front Genet</source><year>2021</year>;<volume>12</volume>(1):17.</mixed-citation>
    </ref>
    <ref id="btad393-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lewis</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Barnes</surname><given-names>MR</given-names></string-name>, <string-name><surname>Blighe</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular portraits of early rheumatoid arthritis identify clinical and treatment response phenotypes</article-title>. <source>Cell Rep</source><year>2019</year>;<volume>28</volume>:<fpage>2455</fpage>–<lpage>70.e5</lpage>.<pub-id pub-id-type="pmid">31461658</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>2987</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abecasis</surname><given-names>GR</given-names></string-name>, <string-name><surname>Auton</surname><given-names>A</given-names></string-name>, <string-name><surname>Brooks</surname><given-names>LD</given-names></string-name></person-group><etal>et al</etal>; <collab>1000 Genomes Project Consortium</collab>. <article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>. <source>Nature</source><year>2012</year>;<volume>491</volume>:<fpage>56</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">23128226</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quinn</surname><given-names>EM</given-names></string-name>, <string-name><surname>Cormican</surname><given-names>P</given-names></string-name>, <string-name><surname>Kenny</surname><given-names>EM</given-names></string-name></person-group><etal>et al</etal><article-title>Development of strategies for SNP detection in RNA-Seq data: application to lymphoblastoid cell lines and evaluation using 1000 genomes data</article-title>. <source>PLoS ONE</source><year>2013</year>;<volume>8</volume>:<fpage>e58815</fpage>.<pub-id pub-id-type="pmid">23555596</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rogier</surname><given-names>O</given-names></string-name>, <string-name><surname>Chateigner</surname><given-names>A</given-names></string-name>, <string-name><surname>Amanzougarene</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Accuracy of RNAseq based SNP discovery and genotyping in <italic toggle="yes">Populus nigra</italic></article-title>. <source>BMC Genomics</source><year>2018</year>;<volume>19</volume>:<fpage>909</fpage>.<pub-id pub-id-type="pmid">30541448</pub-id></mixed-citation>
    </ref>
    <ref id="btad393-B12">
      <mixed-citation publication-type="other"><collab>Stan Development Team</collab>. <year>2018</year>. <italic toggle="yes">RStan: the R interface to Stan. R package version 2.18.2</italic>. <ext-link xlink:href="https://mc-stan.org" ext-link-type="uri">https://mc-stan.org</ext-link></mixed-citation>
    </ref>
    <ref id="btad393-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>T</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Ruan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>A pipeline for RNA-seq based eQTL analysis with automated quality control procedures</article-title>. <source>BMC Bioinformatics</source><year>2021</year>;<volume>22</volume>:<fpage>403</fpage>.<pub-id pub-id-type="pmid">34433407</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
