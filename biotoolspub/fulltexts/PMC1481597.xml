<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Algorithms Mol Biol</journal-id>
    <journal-title>Algorithms for Molecular Biology</journal-title>
    <issn pub-type="epub">1748-7188</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1481597</article-id>
    <article-id pub-id-type="publisher-id">1748-7188-1-6</article-id>
    <article-id pub-id-type="pmid">16722533</article-id>
    <article-id pub-id-type="doi">10.1186/1748-7188-1-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Multiple sequence alignment with user-defined anchor points</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Morgenstern</surname>
          <given-names>Burkhard</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>burkhard@gobics.de</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Prohaska</surname>
          <given-names>Sonja J</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>sonja@bioinf.uni-leipzig.de</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Pöhler</surname>
          <given-names>Dirk</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>dpoehler@math.uni-goettingen.de</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Stadler</surname>
          <given-names>Peter F</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>Peter.Stadler@bioinf.uni-leipzig.de</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Universität Göttingen, Institut für Mikrobiologie und Genetik, Abteilung für Bioinformatik, Goldschmidtstrasse. 1, D-37077 Göttingen, Germany</aff>
    <aff id="I2"><label>2</label>Universität Leipzig, Institut für Informatik und Interdisziplinäres Zentrum für Bioinformatik, Kreuzstrasse 7b, D-04103 Leipzig, Germany</aff>
    <pub-date pub-type="collection">
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>4</month>
      <year>2006</year>
    </pub-date>
    <volume>1</volume>
    <fpage>6</fpage>
    <lpage>6</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.almob.org/content/1/1/6"/>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>2</month>
        <year>2006</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>4</month>
        <year>2006</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2006 Morgenstern et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2006</copyright-year>
      <copyright-holder>Morgenstern et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Morgenstern
               Burkhard
               
               burkhard@gobics.de
            </dc:author><dc:title>
            Multiple sequence alignment with user-defined anchor points
         </dc:title><dc:date>2006</dc:date><dcterms:bibliographicCitation>Algorithms for Molecular Biology 1(1): 6-. (2006)</dcterms:bibliographicCitation><dc:identifier type="sici">1748-7188(2006)1:1&#x0003c;6&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1748-7188</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Automated software tools for multiple alignment often fail to produce biologically meaningful results. In such situations, expert knowledge can help to improve the quality of alignments.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Herein, we describe a <italic>semi-automatic </italic>version of the alignment program <italic>DIALIGN </italic>that can take pre-defined constraints into account. It is possible for the user to specify parts of the sequences that are assumed to be homologous and should therefore be aligned to each other. Our software program can use these sites as <italic>anchor points </italic>by creating a multiple alignment respecting these constraints. This way, our alignment method can produce alignments that are biologically more meaningful than alignments produced by fully automated procedures. As a demonstration of how our method works, we apply our approach to genomic sequences around the <italic>Hox </italic>gene cluster and to a set of DNA-binding proteins. As a by-product, we obtain insights about the performance of the <italic>greedy </italic>algorithm that our program uses for multiple alignment and about the underlying objective function. This information will be useful for the further development of DIALIGN. The described alignment approach has been integrated into the TRACKER software system.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Multiple sequence alignment is a crucial prerequisite for biological sequence data analysis, and a large number of multi-alignment programs have been developed during the last twenty years. Standard methods for multiple DNA or protein alignment are, for example, <italic>CLUSTAL W </italic>[<xref ref-type="bibr" rid="B1">1</xref>], <italic>DIALIGN </italic>[<xref ref-type="bibr" rid="B2">2</xref>] and <italic>T-COFFEE </italic>[<xref ref-type="bibr" rid="B3">3</xref>]; an overview about these tools and other established methods is given in [<xref ref-type="bibr" rid="B4">4</xref>]. Recently, some new alignment approaches have been developed such as <italic>POA </italic>[<xref ref-type="bibr" rid="B5">5</xref>], <italic>MUSCLE </italic>[<xref ref-type="bibr" rid="B6">6</xref>] or <italic>PROBCONS </italic>[<xref ref-type="bibr" rid="B7">7</xref>]. These programs are often superior to previously developed methods in terms of alignment quality and computational costs. The performance of multi-alignment tools has been studied extensively using various sets of real and simulated benchmark data [<xref ref-type="bibr" rid="B8">8</xref>-<xref ref-type="bibr" rid="B10">10</xref>].</p>
    <p>All of the above mentioned alignment methods are fully <italic>automated</italic>, i.e., they construct alignments following a fixed set of algorithmical rules. Most methods use a well-defined <italic>objective function </italic>assigning numerical quality score to every possible output alignment of an input sequence set and try to find an optimal or near-optimal alignment according to this objective function. In this process, a number of program parameters such as gap penalties can be adjusted. While the overall influence of these parameters is quite obvious, there is usually no <italic>direct </italic>way of influencing the outcome of an alignment program.</p>
    <p>Automated alignment methods are clearly necessary and useful where large amounts of data are to be processed or in situations where no additional expert information is available. However, if a researcher is familiar with a specific sequence family under study, he or she may already know certain parts of the sequences that are functionally, structurally or phylogenetically related and should therefore be aligned to each other. In situations where automated programs <italic>fail </italic>to align these regions correctly, it is desirable to have an alignment method that would accept such user-defined homology information and would then align the remainder of the sequences automatically, respecting these user-specified <italic>constraints</italic>.</p>
    <p>The interactive program <italic>MACAW </italic>[<xref ref-type="bibr" rid="B11">11</xref>] can be used for semi-automatic alignment with user-defined constraints; similarly the program <italic>OWEN </italic>[<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>] accepts anchor points for pairwise alignment. Multiple-alignment methods accepting pre-defined constraints have also been proposed by Myers <italic>et al</italic>. [<xref ref-type="bibr" rid="B14">14</xref>] and Sammeth <italic>et al</italic>. [<xref ref-type="bibr" rid="B15">15</xref>]. The multi-alignment program DIALIGN [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>] has an option that can be used to calculate alignments under user-specified constraints. Originally, this program feature has been introduced to reduce the alignment search space and program running time for large genomic sequences [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B19">19</xref>]; see also [<xref ref-type="bibr" rid="B20">20</xref>]. At <italic>Göttingen Bioinformatics Compute Server (GOBICS)</italic>, we provide a user-friendly web interface where anchor points can be used to guide the multiple alignment procedure [<xref ref-type="bibr" rid="B21">21</xref>]. Herein, we describe our anchored-alignment approach in detail using a previously introduced set-theoretical alignment concept. We apply our method to genomic sequences of the <italic>Hox </italic>gene clusters. For these sequences, the default version of DIALIGN produces serious mis-alignments where entire genes are incorrectly aligned, but meaningful alignments can be obtained if the known gene boundaries are used as anchor points.</p>
    <p>In addition, our anchoring procedure can be used to obtain information for the further development of alignment algorithms. To improve the performance of automatic alignment methods, it is important to know what exactly goes wrong in those situations where these methods fail to produce biologically reasonable alignments. In principle, there are two possible reasons for failures of alignment programs. It is possible that the underlying <italic>objective function </italic>is 'wrong' by assigning high numerical scores to biologically meaningless alignments. But it is also possible that the objective function is 'correct' – i.e. biologically correct alignments have numerically optimal scores -and the employed heuristic <italic>optimisation algorithm </italic>fails to return mathematically optimal or near-optimal alignments. The anchoring approach that we implemented can help to find out which component of our alignment program is to blame if automatically produced alignments are biologically incorrect.</p>
    <p>One result of our study is that anchor points can not only improve the <italic>biological </italic>quality of the output alignments but can in certain situations lead to alignments with significantly higher <italic>numerical </italic>scores. This demonstrates that the heuristic optimisation procedure used in DIALIGN may produce output alignments with scores far below the optimum for the respective data set. The latter result has important consequences for the further development of our alignment approach: it seems worthwile to develop more efficient algorithms for the optimisation problem that arises in the context of the DIALIGN algorithm. In other situations, the numerical scores of biologically correct alignments turned out to be below the scores of biololgically wrong alignments returned by the non-anchored version of our program. Here, improved optimisation functions will not lead to biologically more meaningful alignments. It is therefore also promising to develop improved objective function for our alignment approach.</p>
  </sec>
  <sec>
    <title>Alignment of tandem duplications</title>
    <p>There are many situations where automated alignment procedures can produce biologically incorrect aligments. An obvious challenge are <italic>distantly </italic>related input sequences where homologies at the primary sequence level may be obscured by spurious random similarities. Another notorious challenge for alignment programs are <italic>duplications </italic>within the input sequences. Here, <italic>tandem duplications </italic>are particularly hard to align, see e.g. [<xref ref-type="bibr" rid="B22">22</xref>]. Specialised software tools have been developed to cope with the problems caused by sequence duplications [<xref ref-type="bibr" rid="B23">23</xref>]. For the segment-based alignment program DIALIGN, the situation is as follows. As described in previous publications, the program constructs pairwise and multiple alignments from pairwise local sequence similarities, so-called <italic>fragment alignments or fragments </italic>[<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B16">16</xref>]. A fragment is defined as an un-gapped pair of equal-length segments from two of the input sequences. Based on statistical considerations, the program assigns a <italic>weight score </italic>to each possible fragment and tries to find a consistent collection of fragments with maximum total score. For pairwise alignment, a <italic>chain </italic>of fragments with maximum score can be identified [<xref ref-type="bibr" rid="B24">24</xref>]. For multiple sequence sets, all possible pairwise alignments are performed and fragments contained in these pairwise alignments are integrated <italic>greedily </italic>into a resulting multiple alignment.</p>
    <p>As indicated in Figure <xref ref-type="fig" rid="F1">1</xref>, tandem duplications can create various problems for the above outlined alignment approach. In the following, we discuss two simple examples where duplications can confuse the segment-based alignment algorithm. Let us consider a motif that is duplicated in one or several of the input sequences <italic>S</italic><sub>1</sub>,..., <italic>S</italic><sub><italic>k</italic></sub>. For simplicity, let us assume that our sequences do not share any significant similarity outside the motif. Moreover, we assume that the degree of similarity among all instances of the motif is roughly comparable. There are no difficulties if two sequences are to be aligned and the motif is duplicated in <italic>both </italic>sequences, i.e if one has instances <inline-graphic xlink:href="1748-7188-1-6-i1.gif"/> and <inline-graphic xlink:href="1748-7188-1-6-i2.gif"/> of the motif in sequence <italic>S</italic><sub>1 </sub>and instances <inline-graphic xlink:href="1748-7188-1-6-i3.gif"/> and <inline-graphic xlink:href="1748-7188-1-6-i4.gif"/> of the same motif in sequence <italic>S</italic><sub>2</sub> as in Figure <xref ref-type="fig" rid="F1">1 (A)</xref>. In such a situation, our alignment approach will correctly align <inline-graphic xlink:href="1748-7188-1-6-i1.gif"/> to <inline-graphic xlink:href="1748-7188-1-6-i3.gif"/> and <inline-graphic xlink:href="1748-7188-1-6-i2.gif"/> to <inline-graphic xlink:href="1748-7188-1-6-i4.gif"/> since, for pairwise alignment, our algorithm returns a <italic>chain </italic>of fragments with maximum <italic>total </italic>score.</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p>Possible mis-alignments caused by tandem duplications in the segment-based alignment approach (DIALIGN). We assume that various instances of a motif are contained in the input sequence set and that the degree of similarity among the different instances is approximately equal. For simplicity, we also assume that the sequences do not share any similarity outside the conserved motif. Lines connecting the sequences denote fragments identified by DIALIGN in the respective pairwise alignment procedures. (<italic>A</italic>) If a tandem duplication occurs in two sequences, the correct alignment will be found since the algorithm identifies a <italic>chain </italic>of local alignments with maximum <italic>total </italic>score. (<italic>B</italic>) If a motif is duplicated in one sequence but only one instance <italic>M</italic><sub>2 </sub>is contained in the second sequence, it may happen that <italic>M</italic><sub>2 </sub>is split up and aligned to different instances of the motif in the first sequence. (<italic>C</italic>) If the motif is duplicated in the first sequence but only one instance of it is contained in sequences two and three, respectively, <italic>consistency </italic>conflicts can occur. In this case, local similarities identified in the respective pairwise alignments cannot be integrated into one single output alignment. To select a consistent subset of these pairwise similarities, DIALIGN uses a <italic>greedy </italic>heuristic. Depending on the degree of similarity among the instances of the motif, the greedy approach may lead to serious mis-alignments (<italic>D</italic>).</p>
      </caption>
      <graphic xlink:href="1748-7188-1-6-1"/>
    </fig>
    <p>Note that a strictly greedy algorithm could be confused by this situation and could align, for example, <inline-graphic xlink:href="1748-7188-1-6-i1.gif"/> to <inline-graphic xlink:href="1748-7188-1-6-i4.gif"/> in Figure <xref ref-type="fig" rid="F1">1</xref> if the similarity among these two instances of the motif happens to be slightly stronger than the similarity among <inline-graphic xlink:href="1748-7188-1-6-i1.gif"/> and <inline-graphic xlink:href="1748-7188-1-6-i3.gif"/>, and among <inline-graphic xlink:href="1748-7188-1-6-i2.gif"/> and <inline-graphic xlink:href="1748-7188-1-6-i4.gif"/>, respectively. However, DIALIGN uses a greedy approach only for <italic>multiple </italic>alignment where an exact solution is not feasible, but for pairwise alignment, the program returns an <italic>optimal </italic>alignment with respect to the underlying objective function. Thus, under the above assumtion, a meaningful alignment will be produced even if <inline-graphic xlink:href="1748-7188-1-6-i1.gif"/> exhibits stronger similarity to <inline-graphic xlink:href="1748-7188-1-6-i4.gif"/> than to <inline-graphic xlink:href="1748-7188-1-6-i3.gif"/>.</p>
    <p>The trouble starts if a tandem duplication <inline-graphic xlink:href="1748-7188-1-6-i1.gif"/>, <inline-graphic xlink:href="1748-7188-1-6-i2.gif"/> occurs in <italic>S</italic><sub>1 </sub>but only one instance of the motif, <italic>M</italic><sub>2</sub>, is present in <italic>S</italic><sub>2</sub>. Here, it can happen that the beginning of <italic>M</italic><sub>2 </sub>is aligned to the beginning of <inline-graphic xlink:href="1748-7188-1-6-i1.gif"/> and the end of <italic>M</italic><sub>2 </sub>is aligned to the end of <inline-graphic xlink:href="1748-7188-1-6-i2.gif"/> as in Figure <xref ref-type="fig" rid="F1">1 (B)</xref>. DIALIGN is particularly susceptible to this type of errors since it does not use gap penalties. The situation is even more problematic for multiple alignment. Consider, for example, the three sequences <italic>S</italic><sub>1</sub>, <italic>S</italic><sub>1</sub>, <italic>S</italic><sub>3 </sub>in Figure <xref ref-type="fig" rid="F1">1 (C)</xref>, where two instances <inline-graphic xlink:href="1748-7188-1-6-i1.gif"/>, <inline-graphic xlink:href="1748-7188-1-6-i2.gif"/> of a motif occur in <italic>S</italic><sub>1 </sub>while <italic>S</italic><sub>2 </sub>and <italic>S</italic><sub>3 </sub>each contain only one instance of the motif <italic>M</italic><sub>2 </sub>and <italic>M</italic><sub>3</sub>, respectively. Under the above assumptions, a <italic>biologically </italic>meaningful alignment of these sequences would certainly align <italic>S</italic><sub>2 </sub>to <italic>S</italic><sub>3</sub>, and both motifs would be aligned either to <inline-graphic xlink:href="1748-7188-1-6-i1.gif"/> or to <inline-graphic xlink:href="1748-7188-1-6-i2.gif"/> – depending on the degree of similarity of <italic>S</italic><sub>2 </sub>and <italic>S</italic><sub>3 </sub>to <inline-graphic xlink:href="1748-7188-1-6-i1.gif"/> and <inline-graphic xlink:href="1748-7188-1-6-i2.gif"/>, respectively. Note that such an alignment would also receive a high <italic>numerical </italic>score since it would involve <italic>three </italic>pairwise alignments of the conserved motif. However, since the pairwise alignments are carried out independently for each sequence pair, it may happen that the first instance of the motif in sequence <italic>S</italic><sub>1</sub>, <inline-graphic xlink:href="1748-7188-1-6-i1.gif"/> is aligned to <italic>M</italic><sub>2 </sub>but the second instance, <inline-graphic xlink:href="1748-7188-1-6-i2.gif"/>, is aligned to <italic>M</italic><sub>3 </sub>in the respective pairwise alignments as in Figure <xref ref-type="fig" rid="F1">1 (C)</xref>. Thus, the correct alignment of <italic>M</italic><sub>2 </sub>and <italic>M</italic><sub>3 </sub>will be <italic>inconsistent </italic>with the first two pairwise alignments. Depending on the degree of similarity among the motifs, alignment of <inline-graphic xlink:href="1748-7188-1-6-i2.gif"/> and <italic>M</italic><sub>3 </sub>may be rejected in the greedy algorithm, so these motifs may not be aligned in the resulting multiple alignment. It is easy to see that the resulting multiple alignment would not only be biologically questionable, but it would also obtain a numerically lower score as it would involve only <italic>two </italic>pairwise alignments of the motif.</p>
  </sec>
  <sec>
    <title>Multiple alignment with user-defined anchor points</title>
    <p>To overcome the above mentioned difficulties, and to deal with other situations that cause problems for alignment programs, we implemented a semi-automatic <italic>anchored </italic>alignment approach. Here, the user can specify an arbitrary number of <italic>anchoring points </italic>in order to guide the alignment procedure. Each anchor point consists of a pair of equal-length segments of two of the input sequences. An anchor point is therefore characterised by five coordinates: the two <italic>sequences </italic>involved, the <italic>starting positions </italic>in these sequences and the <italic>length </italic>of the anchored segments. As a sixth parameter, our method requires a <italic>score </italic>that determines the <italic>priority </italic>of an anchor point. The latter parameter is necessary, since it is in general not meaningful to use <italic>all </italic>anchors proposed by the user. It is possible that the selected anchor points are <italic>inconsistent </italic>with each other in the sense that they cannot be included in one single multiple output alignment, see [<xref ref-type="bibr" rid="B16">16</xref>] for our concept of consistency. Thus, it may be necessary for the algorithm to select a suitable <italic>subset </italic>of the proposed anchor points.</p>
    <p>Our software provides two slightly different options for using anchor points. There is a <italic>strong </italic>anchoring option, where the specified anchor positions are necessarily aligned to each other, consistency provided. The remainder of the sequences is then aligned based on the consistency constraints given by these pre-aligned positions. This option can be used to enforce correct alignment of those parts of the sequences for which additional expert information is available. For example, we are planning to align RNA sequences by using both primary and secondary structure information. Here, locally conserved secondary structures could be used as 'strong' anchor points to make sure that these structures are properly aligned, even if they share no similarity at the primary-structure level.</p>
    <p>In addition, we have a <italic>weak </italic>anchoring option, where consistent anchor points are only used to constraint the output alignment, but are not necessarily aligned to each other. More precisely, if a position <italic>x </italic>in sequence <italic>S</italic><sub><italic>i </italic></sub>is <italic>anchored </italic>with a position <italic>y </italic>in sequence <italic>S</italic><sub><italic>j </italic></sub>through one of the anchor points, this means that <italic>y </italic>is the <italic>only </italic>position from <italic>S</italic><sub><italic>j </italic></sub>that can be aligned to <italic>x</italic>. Whether or not <italic>x </italic>and <italic>y </italic>will actually appear in the same column of the output alignment depends on the degree of local similarity among the sequences around positions <italic>x </italic>and <italic>y</italic>. If no statistically significant similarity can be detected, <italic>x </italic>and <italic>y </italic>may remain un-aligned. Moreover, anchoring <italic>x </italic>and <italic>y </italic>means that positions strictly to the left (or strictly to the right) of <italic>x </italic>in <italic>S</italic><sub><italic>i </italic></sub>can be aligned only to positions strictly to the left (or strictly to the right) of <italic>y </italic>in <italic>S</italic><sub><italic>j </italic></sub>– and vice versa. Obviously, these relations are <italic>transitive</italic>, so if position <italic>x </italic>is anchored with position <italic>y</italic><sub>1</sub>, <italic>y</italic><sub>1 </sub>is to the left of another position <italic>y</italic><sub>2 </sub>in the same sequence, and <italic>y</italic><sub>2 </sub>in turn, is aligned to a position <italic>z</italic>, then positions to the left of <italic>x </italic>can be aligned only to positions to the left of <italic>z </italic>etc. The 'weak' option may be useful if anchor points are used to reduce the program running time.</p>
    <p>Algorithmically, strong or weak anchor points are treated by DIALIGN in the same way as <italic>fragments </italic>( = segment pairs) in the greedy procedure for multi-alignment. By transitivity, a set <italic>Anc</italic> of anchor points defines a <italic>quasi partial order relation </italic>≤<sub><italic>Anc </italic></sub>on the set <italic>X </italic>of all positions of the input sequences – in exactly the same way as an alignment <italic>Ali</italic> induces a quasi partial order relation ≤<sub><italic>Ali </italic></sub>on <italic>X </italic>as described in [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B25">25</xref>]. Formally, we consider an alignment <italic>Ali</italic> as well as a set of anchor points <italic>Anc</italic> as an <italic>equivalence relation </italic>defined on the set <italic>X </italic>of all positions of the input sequences. Next, we consider the partial order relation ≤ on <italic>X </italic>that is given by the 'natural' ordering of positions within the sequences. In order-theoretical terms, ≤ is the <italic>direct sum </italic>of the <italic>linear </italic>order relations defined on the individual sequences. The partial order relation ≤<sub><italic>Anc </italic></sub>is then defined as the <italic>transitive closure </italic>of the union ≤ ∪ <italic>Anc</italic>. In other words, we have <italic>x </italic>≤<sub><italic>Anc </italic></sub><italic>y </italic>if and only if there is a chain x<sub>0</sub>, ..., <italic>x</italic><sub><italic>k </italic></sub>of positions with <italic>x</italic><sub>0 </sub>= <italic>x </italic>and <italic>x</italic><sub><italic>k </italic></sub>= <italic>y </italic>such that for every <italic>i </italic>∈ {1,..., <italic>k</italic>}, position <italic>x</italic><sub><italic>i</italic>-1 </sub>is either anchored with <italic>x</italic><sub><italic>i </italic></sub>or <italic>x</italic><sub><italic>i</italic>-1 </sub>and <italic>x</italic><sub><italic>i </italic></sub>belong to the same sequence, and <italic>x</italic><sub><italic>i</italic>-1 </sub>is on the left-hand side of <italic>x</italic><sub><italic>i </italic></sub>in that sequence.</p>
    <p>In our set-theoretical setting, a relation <italic>R </italic>on <italic>X </italic>is called consistent if all restrictions of the tansitive closure of the union ≤ ∪ <italic>R </italic>to the idividual sequences <italic>coincides </italic>with their respective 'natural' linear orderings. With the <italic>weak </italic>version of our anchored-alignment approach, we are looking for an alignment <italic>Ali</italic> wich maximum score such that the union <italic>Ali</italic> ∪ <italic>Anc</italic> is consistent. With the <italic>strong </italic>option, we are looking for a maximum-scoring alignment <italic>Ali</italic> that is a superset of <italic>Anc</italic>. With both program options, our optimisation problem is to find an alignment <italic>Ali</italic> with maximum score – under the additional constraint that the set-theoretical union <italic>Ali</italic> ∪ <italic>Anc</italic> is consistent. In the weak anchoring approach, the output alignment is <italic>Ali</italic> while with the strong option, the program returns the transitive closure of the union <italic>Ali</italic> ∪ <italic>Anc</italic>.</p>
    <p>The above optimisation problem makes sense only if the set <italic>Anc</italic> of anchor points is itself consistent. Since a user-defined set of anchor points cannot be expectd to be consistent, the first step in our anchoring procedure is to select a consistent <italic>subset </italic>of the anchor points proposed by the user. To this end, the program uses the same greedy approach that it applies in the optimisation procedure for multiple alignment. That is, each anchor point is associated with some user-defined score, and the program accepts input anchor points in order of decreasing scores – provided they are consistent with the previously accepted anchors.</p>
    <p>The greedy selection of anchor points makes it possible for the user to <italic>prioritise </italic>potential anchor points according to arbitrary user-defined criteria. For example, one may use known gene boundaries in genomic sequences to define anchor points as we did in the <italic>Hox </italic>gene example described below. In addition, one may want to use <italic>automatically </italic>produced local alignments as anchor points to speed up the alignment procedure as outlined in [<xref ref-type="bibr" rid="B18">18</xref>]. Note that the set of gene boundaries will be necessarily consistent as long as the relative ordering among the genes is conserved. However, the automatically created anchor points may well be <italic>inconsistent </italic>with those 'biologically defined' anchors or inconsistent with each other. Since anchor points derived from expert knowledge should be more reliable than anchor points identified by some software program, it would make sense to first accept the known gene boundaries as anchors and then to use the automatically created local alignments, under the condition that they are consistent with the known gene boundaries. So in this case, one could use local alignment scores as scores for the <italic>automatically </italic>created anchor points, while one would assign arbitrarily defined higher scores to the <italic>biologically </italic>verified gene boundaries.</p>
  </sec>
  <sec>
    <title>Applications to <italic>Hox </italic>gene clusters</title>
    <p>As explained above, tandem duplications pose a hard problem for automatic alignment algorithms. Clusters of such paralogous genes are therefore particularly hard to align. As a real-life example we consider here the <italic>Hox </italic>gene clusters of vertebrates. <italic>Hox </italic>genes code for homeodomain transcription factors that regulate the anterior/posterior patterning in most bilaterian animals [<xref ref-type="bibr" rid="B26">26</xref>,<xref ref-type="bibr" rid="B27">27</xref>]. This group of genes, together with the so-called <italic>ParaHox </italic>genes, arose early in metazoan history from a single ancestral <italic>"UrHox </italic>gene" [<xref ref-type="bibr" rid="B28">28</xref>]. Their early evolution was dominated by a series of tandem duplications. As a consequence, most bilaterians share at least eight distinct types (in arthropods, and 13 or 14 in chordates), usually referred to as paralogy classes. These <italic>Hox </italic>genes are usually organised in tightly linked clusters such that the genes at the 5'end (paralogy groups 9–13) determine features at the posterior part of the animal while the genes at the 3'end (paralogy groups 1–3) determine the anterior patterns.</p>
    <p>In contrast to all known invertebrates, all vertebrate lineages investigated so far exhibit multiple copies of <italic>Hox </italic>clusters that presumably arose through genome duplications in early vertebrate evolution and later in the actinopterygian (ray finned fish) lineage [<xref ref-type="bibr" rid="B29">29</xref>-<xref ref-type="bibr" rid="B33">33</xref>]. These duplication events were followed by massive loss of the duplicated genes in different lineages, see e.g. [<xref ref-type="bibr" rid="B34">34</xref>] for a recent review on the situation in teleost fishes. The individual <italic>Hox </italic>clusters of gnathostomes have a length of some 100,000nt and share besides a set of homologous genes also a substantial amount of conserved non-coding DNA [<xref ref-type="bibr" rid="B35">35</xref>] that predominantly consists of transcription factor binding sites. Most recently, however, some of these "phylogenetic footprints" were identified as microRNAs [<xref ref-type="bibr" rid="B36">36</xref>].</p>
    <p>Figure <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref> show four of the seven <italic>Hox </italic>clusters of the pufferfish <italic>Takifugu rubripes</italic>. Despite the fact that the <italic>Hox </italic>genes within a paralogy group are significantly more similar to each other than to members of other paralogy groups, there are several features that make this dataset particularly difficult and tend to mislead automatic alignment procedures: (1) Neither one of the 13 <italic>Hox </italic>paralogy groups nor the <italic>Evx </italic>gene is present in all four sequences. (2) Two genes, <italic>HoxC8a </italic>and <italic>HoxA2a </italic>are present in only a single sequence. (3) The clusters have different sizes and numbers of genes (33481 nt to 125385 nt, 4 to 10 genes).</p>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p>The pufferfish <italic>Takifugu rubripes </italic>has seven <italic>Hox </italic>clusters of which we use four in our computational example. The <italic>Evx </italic>gene, another homedomain transcription factor is usually liked with the <italic>Hox </italic>genes and can be considered as part of the <italic>Hox </italic>cluster. The paralogy groups are indicated. Filled boxes indicates intact <italic>Hox </italic>genes, the open box indicates a <italic>HoxA7a </italic>pseudogene [45].</p>
      </caption>
      <graphic xlink:href="1748-7188-1-6-2"/>
    </fig>
    <fig position="float" id="F3">
      <label>Figure 3</label>
      <caption>
        <p>Result of a DIALIGN run on the <italic>Hox </italic>sequences from Figure 2 without anchoring. The diagram represents sequences and gene positions to scale. All incorrectly aligned segments (defined as parts of a gene that are aligned with parts of gene from a different paralogy group) are indicated by lines between the sequences.</p>
      </caption>
      <graphic xlink:href="1748-7188-1-6-3"/>
    </fig>
    <p>We observe that without anchoring DIALIGN mis-aligns many of of the <italic>Hox </italic>genes in this example by matching blocks from one <italic>Hox </italic>gene with parts of a <italic>Hox </italic>gene from a different paralogy group. As a consequence, genes that should be aligned, such as <italic>HoxA1Oa </italic>and <italic>HoxDIOa</italic>, are not aligned with each other.</p>
    <p>Anchoring the alignment, maybe surprisingly, increases the number of columns that contain aligned sequence positions from 3870 to 4960, i.e., by about 28%, see Table <xref ref-type="table" rid="T2">2</xref>. At the same time, the CPU time is reduced by almost a factor of 3.</p>
    <p>We investigated not only the <italic>biological </italic>quality of the anchored and non-anchored alignments but also looked at their <italic>numerical </italic>scores. Note that in DIALIGN, the score of an alignment is defined as the sum of weight scores of the fragments it is composed of [<xref ref-type="bibr" rid="B17">17</xref>]. For some sequence sets we found that the score of the anchored alignment was above the non-anchored alignment while for other sequences, the non-anchored score exceeded the anchored one. For example, with the sequence set shown in Figure <xref ref-type="fig" rid="F2">2</xref>, the alignment score of the – biologically more meaningful – anchored alignment was &gt; 13% <italic>below </italic>the non-anchored alignment (see Table <xref ref-type="table" rid="T1">1</xref>). In contrast, another sequence set with five <italic>HoxA </italic>cluster sequences (TrAa, TnAa, DrAb, TrAb, TnAb) from three teleost fishes <italic>(Takifugu rubripes</italic>, Tr; <italic>Tetraodon nigroviridis</italic>, Tn; <italic>Danio rerio</italic>, Dr) yields an anchored alignment score that is some 15% <italic>above </italic>the non-anchored score.</p>
    <table-wrap position="float" id="T1">
      <label>Table 1</label>
      <caption>
        <p>Effect of different anchors in the Fugu example of Figure 2. We consider aligned sequence positions in intergenic regions (i.e., <italic>outside </italic>the coding regions and introns) only. Column 2 gives the number of sequence positions for which DIALIGN added at least one additional sequence that was not represented in original TRACKER footprint. Column 3 lists the total number of nucleotides in footprints that were not detected by tracker but were aligned by anchored DIALIGN.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">anchor</td>
            <td align="center" colspan="3">nt positions in footprints</td>
          </tr>
          <tr>
            <td/>
            <td align="right">total</td>
            <td align="right">expanding</td>
            <td align="right">new</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">none</td>
            <td align="right">1546</td>
            <td align="right">0</td>
            <td align="right">618</td>
          </tr>
          <tr>
            <td align="left">genes</td>
            <td align="right">1686</td>
            <td align="right">39</td>
            <td align="right">694</td>
          </tr>
          <tr>
            <td align="left">genes and BLASTZ hits</td>
            <td align="right">2433</td>
            <td align="right">39</td>
            <td align="right">841</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap position="float" id="T2">
      <label>Table 2</label>
      <caption>
        <p>Aligned sequence positions that result from fragment aligments in the Fugu <italic>Hox </italic>cluster example. To compare these alignments, we counted the number of columns where two, three or four residues are aligned, respectively. Here, we counted only upper-case residues in the DIALIGN output since lower-case residues are not considered to be aligned by DIALIGN. The number of columns in which two or three residues are aligned increases when more anchors are used, while the number of columns in which all sequences are aligned decreases. This is because in our example no single <italic>Hox </italic>gene is contained in all four input sequences, see Figure 2. Therefore a biologically correct alignment of these sequences should not contain columns with four residues. CPU times are measured on a PC with two Intel Xeon 2.4GHz processors and 1 Gbyte of RAM.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">anchor</td>
            <td align="right">alignment length</td>
            <td align="center" colspan="3">aligned sequences</td>
            <td align="right">CPU time</td>
            <td align="right">score</td>
          </tr>
          <tr>
            <td/>
            <td/>
            <td align="right">2</td>
            <td align="right">3</td>
            <td align="right">4</td>
            <td/>
            <td/>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">none</td>
            <td align="right">281759</td>
            <td align="right">2958</td>
            <td align="right">668</td>
            <td align="right">244</td>
            <td align="right">4:22:07</td>
            <td align="right">1166</td>
          </tr>
          <tr>
            <td align="left">genes</td>
            <td align="right">252346</td>
            <td align="right">3674</td>
            <td align="right">1091</td>
            <td align="right">195</td>
            <td align="right">1:18:12</td>
            <td align="right">1007</td>
          </tr>
          <tr>
            <td align="left">BLASTZ hits</td>
            <td align="right">239326</td>
            <td align="right">4036</td>
            <td align="right">1139</td>
            <td align="right">33</td>
            <td align="right">0:19:32</td>
            <td align="right">742</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
  <sec>
    <title>Anchored protein alignments</title>
    <p>BAliBASE is a benchmark database to evaluate the performance of software programs for multiple protein alignment [<xref ref-type="bibr" rid="B37">37</xref>]. The database consists of a large number of protein families with known 3D structure. These structures are used to define so-called <italic>core blocks </italic>for which 'biologically correct' alignments are known. There are two scoring systems to evaluate the accuracy of multiple alignments on BAliBASE protein families. The BAliBASE <italic>sum-of-pairs </italic>score measures the percentage of correctly aligned pairs of amino acid residues within the core blocks. By contrast, the <italic>column score </italic>measures the percentage of correctly aligned columns in the core blocks, see [<xref ref-type="bibr" rid="B38">38</xref>,<xref ref-type="bibr" rid="B10">10</xref>] for more details. These BAliBASE scoring functions are not to be confused with the objective functions used by different alignment algorithms.</p>
    <p>Thus, alignment programs can be evaluated by their ability to correctly align these core blocks. BAliBASE covers various alignment situations, e.g. protein families with global similarity or protein families with large internal or terminal insertions or deletions. However, it is important to mention that most sequences in the standard version of BAliBASE are <italic>not </italic>real-world sequences, but have been artificially truncated by the database authors who simply removed non-homologous C-terminal or N-terminal parts of the sequences. Only the most recent version of BAliBASE provides the original full-length sequence sets together with the previous truncated data. Therefore, most studies based on BAliBASE have a strong bias in favour of <italic>global </italic>alignment programs such as CLUSTAL W [<xref ref-type="bibr" rid="B1">1</xref>]; these programs perform much better on the BAliBASE data than they would perform on on realistic full-length protein sequences. The performance of programs that are based on <italic>local </italic>sequence similarities, on the other hand, is systematically <italic>underestimated </italic>by BAliBASE. Despite this systematic error, test runs on BAliBASE can give a rough impression about the performance of multiple-alignment programs in different situations.</p>
    <p>DIALIGN has been shown to perform well on those data sets in BAliBASE that contain large insertions and deletions. On the other hand, it is often outperformed by global alignment methods on those data sets where homology extends over the entire sequence length but similarity is low at the primary-sequence level. For the further development and improvement of the program, it is crucial to find out which components of DIALIGN are to blame for the inferiority of the program on this type if sequence families. One possibility is that biologically meaningful alignments on BAliBASE would have high numerical scores, but the greedy heuristic used by DIALIGN is inefficient and returns low-scoring alignments that do not align the core blocs correctly. In this case, one would use more efficient optimisation strategies to improve the performance of DIALIGN on BAliBASE. On the other hand, it is possible that the scoring function used in DIALIGN assigns highest scores to biologically wrong alignments. In this case, an improved optimisation algorithm would not lead to any improvement in the biological quality of the output alignments and it would be necessary to improve the objective function used by the program.</p>
    <p>To find out which component of DIALIGN is to blame for its unsatisfactory performance on some of the BAliBASE data, we applied our program to BAliBASE (<italic>a</italic>) using the non-anchored default version of the program and (<italic>b</italic>) using the <italic>core blocks </italic>as anchor points in order to <italic>enforce </italic>biologically correct alignments of the sequences. We then compared the numerical DIALIGN scores of the anchored alignments to the non-anchored default alignments. The results of these program runs are summarised in Table <xref ref-type="table" rid="T3">3</xref>. The numerical alignment scores of the (biologically correct) anchored alignments turned out to be slightly <italic>below </italic>the scores of the non-anchored default alignments.</p>
    <table-wrap position="float" id="T3">
      <label>Table 3</label>
      <caption>
        <p>DIALIGN alignment scores for anchored and non-anchored alignment of five reference test sets from BAliBASE. As anchor points, we used the so-called <italic>core-blocks </italic>in BAliBASE, thereby enforcing biologically correct alignments of the input sequences. The figures in the first and second line refer to the sum of DIALIGN alignment scores of all protein families in the respective reference set. Line four contains the number of sequence sets where the anchoring <italic>improved </italic>the alignment score together with the total number of sequence sets in this reference set. Our test runs show that on these test data, biologically meaningful alignments do not have higher DIALIGN scores than alignments produced by the default version of our program.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td/>
            <td align="center" colspan="6">Alignment scores</td>
          </tr>
          <tr>
            <td/>
            <td align="right">Ref1</td>
            <td align="right">Ref2</td>
            <td align="right">Ref3</td>
            <td align="right">Ref4</td>
            <td align="right">Ref5</td>
            <td align="right">Total</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">non-anchored</td>
            <td align="right">53,613</td>
            <td align="right">269,009</td>
            <td align="right">283,273</td>
            <td align="right">36,515</td>
            <td align="right">29,214</td>
            <td align="right">671,624</td>
          </tr>
          <tr>
            <td align="left">anchored</td>
            <td align="right">53,417</td>
            <td align="right">265,966</td>
            <td align="right">283,136</td>
            <td align="right">36,611</td>
            <td align="right">29,257</td>
            <td align="right">668,387</td>
          </tr>
          <tr>
            <td align="left">ratio</td>
            <td align="right">0.996</td>
            <td align="right">0.988</td>
            <td align="right">0.999</td>
            <td align="right">1.002</td>
            <td align="right">1.001</td>
            <td align="right">0.995</td>
          </tr>
          <tr>
            <td align="left">score improved</td>
            <td align="right">23/82</td>
            <td align="right">13/23</td>
            <td align="right">4/23</td>
            <td align="right">6/16</td>
            <td align="right">4/12</td>
            <td align="right">50/156</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>As an example, Figure <xref ref-type="fig" rid="F4">4</xref> shows an alignment calculated by the non-anchored default version of DIALIGN for BAliBASE reference set <italic>lr69</italic>. This sequence set consists of four DNA-binding proteins and is a challenging alignment example as there is only weak similarity at the primary sequence level. These proteins contain three <italic>core blocks </italic>for which a reliable multi-alignment is known based on 3D-structure information. As shown in Figure <xref ref-type="fig" rid="F4">4</xref>, most of the core blocks are misaligned by DIALIGN because of the low level of sequence similarity. With the BAliBASE scoring system for multiple alignments, the default alignment produced by DIALIGN has a <italic>sum-of-pairs score </italic>of only 33%, i.e. 33% of the amino-acid pairs in the core blocks are correctly aligned. The <italic>column score </italic>of this alignment 0%, i.e. there is not a single column of the core blocks correctly aligned.</p>
    <fig position="float" id="F4">
      <label>Figure 4</label>
      <caption>
        <p>Anchored and non-anchored alignment of a set of protein sequences with known 3D structure (data set lr69 from BAliBASE [38]). Three <italic>core blocks </italic>for which the 'correct' alignment is known are shown in red, blue and green. <bold>(A) </bold>Alignment calculated by DIALIGN with default options. Most of the core blocks are mis-aligned. <bold>(B) </bold>Alignment calculated by DIALIGN with <italic>anchoring </italic>option. The first position of the third block has been used as anchor point, i.e. the program has <italic>been forced </italic>to align this column correctly. The rest of the sequences is automatically aligned by DIALIGN given the constraints defined by this anchor point. Although only one single column has been used for anchoring, the tree blocks are almost perfectly aligned.</p>
      </caption>
      <graphic xlink:href="1748-7188-1-6-4"/>
    </fig>
    <p>We investigated how many anchor points were necessary to enforce a correct alignment of the three core blocks in this test example. As it turned out, it was sufficient to use one single column of the core blocks as anchor points, namely the first column of the third motif. Technically, this can be done by using three anchor points of length one each: anchor point connecting the first position of this core block in sequence 1 with the corresponding position in sequence 2, another anchor connecting sequence 1 with sequence 3 and a third anchor connecting sequence 1 with sequence 4. Although our anchor points enforced the correct alignment only for a single column, most parts of the core blocks were correctly aligned as shown in Figure <xref ref-type="fig" rid="F4">4</xref>. The BAliBASE sum-of-pairs score of the resulting alignment was 91% while the column score was 90% as 18 out of 20 columns of the core blocks were correctly aligned. As was generally the case for BAliBASE, the <italic>DIALIGN score </italic>of the (biologically meaningful) anchored alignment was lower than the score of the (biologically wrong) default alignment. The DIALIGN score of the anchored alignment was 9.82 compared with 11.99 for the non-anchored alignment, so here the score of the anchored alignment was around 18 percent below the score of the non-anchored alignment.</p>
  </sec>
  <sec>
    <title>Anchored alignments for phylogenetic footprinting</title>
    <p>Evolutionarily conserved regions in non-coding sequences represent a potentially rich source for the discovery of gene regulatory regions. While functional elements are subject to stabilizing selection, the adjacent non-functional DNA evolves much faster. Therefore, blocks of conservation, so-called phylogenetic footprints, can be detected in orthologous non-coding sequences with low overall similarity by comparative genomics [<xref ref-type="bibr" rid="B39">39</xref>]. Alignment algorithms, including DIALIGN, were advocated for this task. As the example in the previous section shows, however, anchoring the alignments becomes a necessity in applications to large genomic regions and clusters of paralogous genes. While interspersed repeats are normally removed ("masked") using e.g. <italic>RepeatMasker</italic>, they need to be taken into account in the context of phylogenetic footprinting: if a sequence motif is conserved hundreds of millions of years it may well have become a regulatory region even if it is (similar to) a repetitive sequence in some of the organisms under consideration [<xref ref-type="bibr" rid="B40">40</xref>].</p>
    <p>The phylogenetic footprinting program <italic>TRACKER </italic>[<xref ref-type="bibr" rid="B41">41</xref>] was designed specifically to search for conserved non-coding sequences in large gene clusters. It is based on a similar philosophy as segment based alignment algorithms. The TRACKER program computes pairwise local alignments of all input sequences using BLASTZ [<xref ref-type="bibr" rid="B42">42</xref>] with non-stringent settings. BLASTZ permits alignment of long genomic sequences with large proportions of neutrally evolving regions. A post-processing step aims to remove simple repeats recognized at their low sequence complexity and regions of low conservation. The resulting list of pairwise alignments is then assembled into clusters of partially overlapping regions. Here the approach suffers from the same problem as DIALIGN, which is, however, resolved in a different way: instead of producing a single locally optimal alignment, TRACKER lists all maximal compatible sets of pairwise alignments. For the case of Figure <xref ref-type="fig" rid="F1">1(C)</xref>, for instance, we obtain both <inline-graphic xlink:href="1748-7188-1-6-i1.gif"/><italic>M</italic><sub>2</sub><italic>M</italic><sub>3 </sub>and <inline-graphic xlink:href="1748-7188-1-6-i2.gif"/><italic>M</italic><sub>2</sub><italic>M</italic><sub>3</sub>. Since this step is performed based on the overlap of sequence intervals without explicitly considering the sequence information at all, TRACKER is very fast as long as the number of conflicting pairwise alignments remains small. In the final step DIALIGN is used to explicitly calculate the multiple sequence alignments from the subsequences that belong to individual clusters.</p>
    <p>For the initial pairwise local alignment step the search space is restricted to orthologous intergenic regions, parallel strands and chaining hits. Effectively, TRACKER thus computes alignments anchored at the genes from BLASTZ fragments.</p>
    <p>We have noticed [<xref ref-type="bibr" rid="B43">43</xref>] that DIALIGN is more sensitive than TRACKER in general. This is due to detection of smaller and less significant fragments with DIALIGN compared to the larger, contiguous fragments returned by BLASTZ. The combination of BLASTZ and an anchored version of DIALIGN appears to be a very promising approach for phylogenetic footprinting. It makes use of the alignment specificity of BLASTZ and the sensitivity of DIALIGN. A combination of anchoring at appropriate genes (with maximal weight) and BLASTZ hits (with smaller weights proportional e.g. to – log <italic>E </italic>values) reduces the CPU requirements for the DIALIGN alignment by more than an order of magnitude. While this is still much slower than TRACKER (20 min vs. 40 s) it increases the sensitivity of the approach by about 30 – 40% in the Fugu example, Table <xref ref-type="table" rid="T1">1</xref>. Work in progress aims at improving the significance measures for local multiple alignments. A more thorough discussion of anchored segment-based alignments to phylogenetic footprinting will be published elsewhere.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>Automated alignment procedures are based on simple algorithmical rules. For a given set of input sequences, they try to find an alignment with maximum score in the sense of some underlying objective function. The two basic questions in sequence alignment are therefore (<italic>a</italic>) to define an meaningful objective function and (<italic>b</italic>) to design an efficient optimisation algorithm that finds optimal or at least near-optimal alignments with respect to the chosen objective function. Most multi-alignment programs are using <italic>heuristic </italic>optimisation algorithms, i.e. they are, in general, not able to find the mathematically optimal alignment with respect to the objective function. An objective function for sequence alignment should assign <italic>numerically </italic>high scores to <italic>biologically </italic>meaningful alignments. However, it is clearly not possible to find a <italic>universally </italic>applicable objective function that would give highest numerical scores to the biologically correct alignments in all possible situations. This is the main reason why alignment programs may fail to produce biologically reasonable output alignments. In fact, the impossibility to define a universal objective function constitutes a fundamental limitation for <italic>all </italic>automated alignment algorithms.</p>
    <p>Often a user is already familiar with a sequence family that he or she wants to align, so some knowledge about existing sequence homologies may be available. Such expert knowledge can be used to direct an otherwise automated alignment procedure. To facilitate the use of expert knowledge for sequence alignment, we proposed an <italic>anchored alignment </italic>approach where known homologies can be used to restrict the alignment search space. This can clearly improve the quality of the produced output alignments in situations where automatic procedures are not able to produce meaningful alignments. In addition, alignment anchors can be used to reduce the program running time. For the <italic>Hox </italic>gene clusters that we analyzed, the non-anchored version of DIALIGN produced serious misalignments. We used the known gene boundaries as anchor points to guarantee a correct alignment of these genes to each other.</p>
    <p>There are two possible reasons why automated alignment procedures may fail to produce biologically correct alignments, (<italic>a</italic>) The chosen objective function may not be in accordance with biology, i.e., it may assign mathematically high scores to biologically wrong alignments. In this case, even efficient optimisation algorithms would lead to meaningless alignments. (<italic>b</italic>) The mathematically optimal alignment is biologically meaningful, but the employed heuristic optimisation procedure is not able to find the alignment with highest score. For the further development of alignment algorithms, it is crucial to find out which one of these reasons is to blame for mis-alignments produced by existing software programs. If (<italic>a</italic>) is often observed for an alignment program, efforts should be made to improve its underlying objective function. If (<italic>b</italic>) is the case, the biological quality of the output alignments can be improved by using a more efficient optimisation algorithm. For DIALIGN, it is unknown how close the produced alignments come to the numerically optimal alignment – in fact, it is possible to construct example sequences where DIALIGN's greedy heuristic produces alignments with arbitrarily low scores compared with the possible optimal alignment.</p>
    <p>In the Fugu example, Figure <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref>, the <italic>numerical </italic>alignment score of the (anchored) correct alignment was 13% below the score of the non-anchored alignment. All sequences in Figure <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref> contain only subsets of the 13 <italic>Hox </italic>paralogy groups, and different sequences contain different genes. For such an extreme data set, it is unlikely that any reasonable objective function would assign an optimal score to the biologically correct alignment. Here, the problem is that sequence similarity no longer coincides with biological homology. The only way of producing good alignments in such situations is <italic>to force </italic>a program to align certain known homologies to each other. With our anchoring approach we can do this, for example by using known gene boundaries as <italic>anchor points</italic>.</p>
    <p>For the BAliBASE benchmark data base, the total score of the (biologically meaningful) anchored alignments was also below the score of the (biologically wrong) non-anchored default alignments.</p>
    <p>This implies, that improved optimisation algorithms will not lead to biologically improved alignments for these sequences. In this case, however, there is some correspondence between sequence similarity and homology, so one should hope that the performance of DIALIGN on these data can be improved by to designing better objective functions. An interesting example from BAliBASE is shown in Figure <xref ref-type="fig" rid="F4">4</xref>. Here, the non-anchored default version of our program produced a complete mis-alignment. However, it was sufficient to enforce the correct alignment of one <italic>single </italic>column using corresponding anchor points to obtain a meaningful alignment of the entire sequences where not only the one anchored column but most of the three core blocks are correctly aligned. This indicates that the correct alignment of the core blocks corresponds to a <italic>local maximum </italic>in the alignment landscape.</p>
    <p>In contrast, in the teleost <italic>HoxA </italic>cluster example the numerical score of the anchored alignment was around 15% <italic>above </italic>the score of the non-anchored alignment. This demonstrates that the greedy optimisation algorithm used by DIALIGN can lead to results with scores far below the optimal alignment. In such situations, improved optimisation algorithms may lead not only to mathematically higher-scoring alignments but also to alignments that are closer to the biologically correct alignment. We will use our anchored-alignment approach systematically to study the efficiency of objective functions and optimisation algorithms for our segment-based approach to multiple sequence alignment.</p>
  </sec>
  <sec>
    <title>Program availability</title>
    <p>The program is available online and as downloadable source code at Göttingen Bioinformatics Compute Server (GOBICS) [<xref ref-type="bibr" rid="B44">44</xref>].</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The author(s) declare that they have no competing interests.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>We would like to thank Jan Weyer-Menkhoff, Isabelle Schneider, Rasmus Steinkamp and Amarendran Subramanian for their support in the software development and evaluation and Peter Meinicke for critically reading the manuscript. The work was supported by DFG grant MO 1048/1-1 to BM, by BMBF grant 01AK803G (Medigrid) to BM and by DFG Bioinformatics Initiative BIZ-6/1-2 to SJP and PFS.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>
        <source>Nucleic Acids Research</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="pmid">7984417</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>DIALIGN: Multiple DNA and Protein Sequence Alignment at BiBiServ</article-title>
        <source>Nucleic Acids Research</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>W33</fpage>
        <lpage>W36</lpage>
        <pub-id pub-id-type="pmid">15215344</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gnh029</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Heringa</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>T-Coffee: a novel algorithm for multiple sequence alignment</article-title>
        <source>J Mol Biol</source>
        <year>2000</year>
        <volume>302</volume>
        <fpage>205</fpage>
        <lpage>217</lpage>
        <pub-id pub-id-type="pmid">10964570</pub-id>
        <pub-id pub-id-type="doi">10.1006/jmbi.2000.4042</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Recent progress in multiple sequence alignment: a survey</article-title>
        <source>Pharmacogenomics</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>131</fpage>
        <lpage>144</lpage>
        <pub-id pub-id-type="pmid">11966409</pub-id>
        <pub-id pub-id-type="doi">10.1517/14622416.3.1.131</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Grasso</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sharlow</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>Multiple sequence alignment using partial order graphs</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>452</fpage>
        <lpage>464</lpage>
        <pub-id pub-id-type="pmid">11934745</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.452</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: Multiple sequence alignment with high score accuracy and high throughput</article-title>
        <source>Nuc Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>1792</fpage>
        <lpage>1797</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Do</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Mahabhashyam</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Brudno</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>ProbCons: Probabilistic consistency-based multiple sequence alignment</article-title>
        <source>Genome Research</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>330</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="pmid">15687296</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.2821705</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lassmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>Quality assessment of multiple alignment programs</article-title>
        <source>FEBS Letters</source>
        <year>2002</year>
        <volume>529</volume>
        <fpage>126</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="pmid">12354624</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0014-5793(02)03189-7</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pollard</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Celniker</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking tools for the alignment of functional noncoding DNA</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>6</fpage>
        <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/5/6"/>
        <pub-id pub-id-type="pmid">14736341</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-5-6</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Plewniak</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Poch</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive comparison of protein sequence alignment programs</article-title>
        <source>Nucleic Acids Research</source>
        <year>1999</year>
        <volume>27</volume>
        <fpage>2682</fpage>
        <lpage>2690</lpage>
        <pub-id pub-id-type="pmid">10373585</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/27.13.2682</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuler</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>A Workbench for Multiple Alignment Construction and Analysis</article-title>
        <source>PROTEINS: Structure, Function and Genetics</source>
        <year>1991</year>
        <volume>9</volume>
        <fpage>180</fpage>
        <lpage>190</lpage>
        <pub-id pub-id-type="doi">10.1002/prot.340090304</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roytberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ogurtsov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shabalina</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kondrashov</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A hierarchical approach to aligning collinear regions of genomes</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>1673</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="pmid">12490453</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.12.1673</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ogurtsov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roytberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shabalina</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kondrashov</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>OWEN: aligning long collinear regions of genomes</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>1703</fpage>
        <lpage>1704</lpage>
        <pub-id pub-id-type="pmid">12490463</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.12.1703</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Selznick</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Progressive Multiple Alignment with Constraints</article-title>
        <source>J Computational Biology</source>
        <year>1996</year>
        <volume>3</volume>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sammeth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Divide-and-Conquer Alignment with segment-based constraints</article-title>
        <source>Bioinformatics, ECCB special issue</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>iil89</fpage>
        <lpage>iil95</lpage>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dress</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Werner</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Multiple DNA and protein sequence alignment based on segment-to-segment comparison</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1996</year>
        <volume>93</volume>
        <fpage>12098</fpage>
        <lpage>12103</lpage>
        <pub-id pub-id-type="pmid">8901539</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.93.22.12098</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>DIALIGN 2: improvement of the segment-to-segment approach to multiple sequence alignment</article-title>
        <source>Bioinformatics</source>
        <year>1999</year>
        <volume>15</volume>
        <fpage>211</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="pmid">10222408</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/15.3.211</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brudno</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Göttgens</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Fast and sensitive multiple alignment of large genomic sequences</article-title>
        <source>BMC Bioinformatics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>66</fpage>
        <pub-id pub-id-type="pmid">14693042</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-4-66</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rinner</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Abdeddaim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haase</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mayer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dress</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mewes</surname>
            <given-names>HW</given-names>
          </name>
        </person-group>
        <article-title>Exon Discovery by Genomic Sequence Alignment</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>777</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="pmid">12075013</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.6.777</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Umbach</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Accurate anchoring alignment of divergent sequences</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>29</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="pmid">16301203</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti772</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Werner</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Prohaska</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>RSI</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Weyer-Menkhoff</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Multiple sequence alignment with user-defined constraints at GOBICS</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>1271</fpage>
        <lpage>1273</lpage>
        <pub-id pub-id-type="pmid">15546937</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti142</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Sequence alignment with tandem duplication</article-title>
        <source>J Comp Biol</source>
        <year>1997</year>
        <volume>4</volume>
        <fpage>351</fpage>
        <lpage>367</lpage>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heringa</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Detection of internal repeats: how common are they?</article-title>
        <source>Curr Opin Struc Biol</source>
        <year>1998</year>
        <volume>8</volume>
        <fpage>338</fpage>
        <lpage>345</lpage>
        <pub-id pub-id-type="doi">10.1016/S0959-440X(98)80068-7</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A simple and space-efficient fragment-chaining algorithm for alignment of DNA and protein sequences</article-title>
        <source>Applied Mathematics Letters</source>
        <year>2002</year>
        <volume>15</volume>
        <fpage>11</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1016/S0893-9659(01)00085-4</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdeddaïm</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Speeding up the DIALIGN multiple alignment program by using the 'Greedy Alignment of Biological Sequences LIBrary' (GABIOS-LIB)</article-title>
        <source>Lecture Notes in Computer Science</source>
        <year>2001</year>
        <volume>2066</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Duboule</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dollé</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The structural and functional organization of the murine HOX gene family resembles that <italic>of Drosophila </italic>homeotic genes</article-title>
        <source>EMBO J</source>
        <volume>8</volume>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McGinnis</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Krumlauf</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Homeobox genes and axial patterning</article-title>
        <source>Cell</source>
        <year>1992</year>
        <volume>68</volume>
        <fpage>283</fpage>
        <lpage>302</lpage>
        <pub-id pub-id-type="pmid">1346368</pub-id>
        <pub-id pub-id-type="doi">10.1016/0092-8674(92)90471-N</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferrier</surname>
            <given-names>DEK</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>PWH</given-names>
          </name>
        </person-group>
        <article-title>Ancient Origin of the <italic>Hox </italic>gene cluster</article-title>
        <source>Nat Rev Genet</source>
        <year>2001</year>
        <volume>2</volume>
        <fpage>33</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="pmid">11253066</pub-id>
        <pub-id pub-id-type="doi">10.1038/35047605</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Holland</surname>
            <given-names>PWH</given-names>
          </name>
          <name>
            <surname>Garcia-Fernández</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Gene duplication and the origins of vertebrate development</article-title>
        <source>Development</source>
        <year>1994</year>
        <fpage>125</fpage>
        <lpage>133</lpage>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garcia-Fernández</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>PW</given-names>
          </name>
        </person-group>
        <article-title>Archetypal organization of the amphioxus Hox gene cluster</article-title>
        <source>Nature</source>
        <year>1994</year>
        <volume>370</volume>
        <fpage>563</fpage>
        <lpage>566</lpage>
        <pub-id pub-id-type="pmid">7914353</pub-id>
        <pub-id pub-id-type="doi">10.1038/370563a0</pub-id>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amores</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Force</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>YL</given-names>
          </name>
          <name>
            <surname>Joly</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Amemiya</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fritz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Langeland</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Prince</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>YL</given-names>
          </name>
          <name>
            <surname>Westerfield</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ekker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Postlethwait</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Zebrafish <italic>Hox </italic>clusters and vertebrate genome evolution</article-title>
        <source>Science</source>
        <year>1998</year>
        <volume>282</volume>
        <fpage>1711</fpage>
        <lpage>1714</lpage>
        <pub-id pub-id-type="pmid">9831563</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.282.5394.1711</pub-id>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoegg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Hox clusters as models for vertebrate genome evolution</article-title>
        <source>Trends Genet</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>421</fpage>
        <lpage>424</lpage>
        <ext-link ext-link-type="uri" xlink:href="http://www.hubmed.org/display.cgi?uids=15967537"/>
        <pub-id pub-id-type="pmid">15967537</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.tig.2005.06.004</pub-id>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crow</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Amemiya</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>The fish specific Hox cluster duplication is coincident with the origin of teleosts</article-title>
        <source>Mol Biol Evol</source>
        <year>2006</year>
        <volume>23</volume>
        <fpage>121</fpage>
        <lpage>136</lpage>
        <pub-id pub-id-type="pmid">16162861</pub-id>
        <pub-id pub-id-type="doi">10.1093/molbev/msj020</pub-id>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prohaska</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>The Duplication of the <italic>Hox </italic>Gene Clusters in Teleost Fishes</article-title>
        <source>Theor Biosci</source>
        <year>2004</year>
        <volume>123</volume>
        <fpage>89</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.1016/j.thbio.2004.03.004</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiu</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Amemiya</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dewar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Ruddle</surname>
            <given-names>FH</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Molecular evolution of the HoxA cluster in the three major gnathostome lineages</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2002</year>
        <volume>99</volume>
        <fpage>5492</fpage>
        <lpage>5497</lpage>
        <pub-id pub-id-type="pmid">11943847</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.052709899</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yekta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shih</surname>
            <given-names>Ih</given-names>
          </name>
          <name>
            <surname>Bartel</surname>
            <given-names>DP</given-names>
          </name>
        </person-group>
        <article-title>MircoRNA-directed cleavage <italic>of HoxB8 </italic>mRNA</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>304</volume>
        <fpage>594</fpage>
        <lpage>596</lpage>
        <pub-id pub-id-type="pmid">15105502</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.1097434</pub-id>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Koehl</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ripp</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Poch</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>BAliBASE 3.0: latest developments of the multiple sequence alignment benchmark</article-title>
        <source>Proteins: Structure, Function, andBioinformatics</source>
        <year>2005</year>
        <volume>61</volume>
        <fpage>127</fpage>
        <lpage>136</lpage>
        <pub-id pub-id-type="doi">10.1002/prot.20527</pub-id>
      </citation>
    </ref>
    <ref id="B38">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Plewniak</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Poch</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>BAliBASE: A benchmark alignment database for the evaluation of multiple sequence alignment programs</article-title>
        <source>Bioinformatics</source>
        <year>1999</year>
        <volume>15</volume>
        <fpage>87</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="pmid">10068696</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/15.1.87</pub-id>
      </citation>
    </ref>
    <ref id="B39">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tagle</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Koop</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Goodman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Slightom</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hess</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Embryonic epsilon and gamma globin genes of a prosimian primate (Galago crassicaudatus): nucleotide and amino acid sequences, developmental regulation and phylogenetic footprints</article-title>
        <source>Journal of Molecular Biology</source>
        <year>1888</year>
        <volume>203</volume>
        <fpage>439</fpage>
        <lpage>455</lpage>
        <pub-id pub-id-type="pmid">3199442</pub-id>
        <pub-id pub-id-type="doi">10.1016/0022-2836(88)90011-3</pub-id>
      </citation>
    </ref>
    <ref id="B40">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vansant</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Reynolds</surname>
            <given-names>WF</given-names>
          </name>
        </person-group>
        <article-title>The consensus sequence of a major Alu subfamily contains a functional retinoic acid response element</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1995</year>
        <volume>92</volume>
        <fpage>8229</fpage>
        <lpage>8233</lpage>
        <ext-link ext-link-type="uri" xlink:href="http://www.hubmed.org/display.cgi?uids=7667273"/>
        <pub-id pub-id-type="pmid">7667273</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.92.18.8229</pub-id>
      </citation>
    </ref>
    <ref id="B41">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prohaska</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fried</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Flamm</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>Surveying Phylogenetic Footprints in Large Gene Clusters: Applications to Hox Cluster Duplications</article-title>
        <source>Mol Evol Phylog</source>
        <year>2004</year>
        <volume>31</volume>
        <fpage>581</fpage>
        <lpage>604</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ympev.2003.08.009</pub-id>
      </citation>
    </ref>
    <ref id="B42">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Smit</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>R Baertsch</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Human-Mouse Alignments with BLASTZ</article-title>
        <source>Genome Research</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>103</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="pmid">12529312</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.809403</pub-id>
      </citation>
    </ref>
    <ref id="B43">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Prohaska</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Fried</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Flamm</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Mewes H-W, Heun V, Frishman D, Kramer S</surname>
          </name>
        </person-group>
        <article-title>Phylogenetic Footprint Patterns in Large Gene Clusters</article-title>
        <source>Tech rep, University of Leipzig, Bioinformatics Group 2003 Extended Abstract: Proceedings of the German Conference on Bioinformatics</source>
        <year>2003</year>
        <volume>II</volume>
        <fpage>145</fpage>
        <lpage>147</lpage>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni- leipzig.de/Publications/POSTERS/P-005abs.pdf"/>
        <comment>belleville Verlag Michael Farin, München</comment>
      </citation>
    </ref>
    <ref id="B44">
      <citation citation-type="other">
        <article-title>Göttingen Bioinformatics Compute Server</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://gobics.de/"/>
      </citation>
    </ref>
    <ref id="B45">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiu</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Dewar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ruddle</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ledje</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bartsch</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Scemama</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Stellwag</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fried</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Prohaska</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Amemiya</surname>
            <given-names>CT</given-names>
          </name>
        </person-group>
        <article-title>Bichir <italic>HoxA </italic>cluster sequence reveals surprising trends in rayfinned fish genomic evolution</article-title>
        <source>Genome Res</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>11</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="pmid">14707166</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.1712904</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
