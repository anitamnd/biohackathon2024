<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8275329</article-id>
    <article-id pub-id-type="pmid">34252930</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab274</article-id>
    <article-id pub-id-type="publisher-id">btab274</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Regulatory and Functional Genomics</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Resolving diverse protein–DNA footprints from exonuclease-based ChIP experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Biswas</surname>
          <given-names>Anushua</given-names>
        </name>
        <aff><institution>Department of Chemical Engineering, CSIR-National Chemical Laboratory</institution>, Pune 411008, <country country="IN">India</country></aff>
        <aff><institution>Academy of Scientific and Innovative Research</institution>, Ghaziabad 201002, <country country="IN">India</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Narlikar</surname>
          <given-names>Leelavati</given-names>
        </name>
        <aff><institution>Department of Chemical Engineering, CSIR-National Chemical Laboratory</institution>, Pune 411008, <country country="IN">India</country></aff>
        <aff><institution>Academy of Scientific and Innovative Research</institution>, Ghaziabad 201002, <country country="IN">India</country></aff>
        <xref rid="btab274-cor1" ref-type="corresp"/>
        <!--l.narlikar@ncl.res.in-->
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab274-cor1">To whom correspondence should be addressed. <email>l.narlikar@ncl.res.in</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-12">
      <day>12</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISMB/ECCB 2021 Proceedings</issue-title>
    <fpage>i367</fpage>
    <lpage>i375</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab274.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>High-throughput chromatin immunoprecipitation (ChIP) sequencing-based assays capture genomic regions associated with the profiled transcription factor (TF). ChIP-exo is a modified protocol, which uses lambda exonuclease to digest DNA close to the TF-DNA complex, in order to improve on the positional resolution of the TF-DNA contact. Because the digestion occurs in the 5<inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mo>′</mml:mo></mml:math></inline-formula>–3<inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mo>′</mml:mo></mml:math></inline-formula> orientation, the protocol produces directional footprints close to the complex, on both sides of the double stranded DNA. Like all ChIP-based methods, ChIP-exo reports a mixture of different regions associated with the TF: those bound directly to the TF as well as via intermediaries. However, the distribution of footprints are likely to be indicative of the complex forming at the DNA.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present ExoDiversity, which uses a model-based framework to learn a joint distribution over footprints and motifs, thus resolving the mixture of ChIP-exo footprints into diverse binding modes. It uses no prior motif or TF information and automatically learns the number of different modes from the data. We show its application on a wide range of TFs and organisms/cell-types. Because its goal is to explain the complete set of reported regions, it is able to identify co-factor TF motifs that appear in a small fraction of the dataset. Further, ExoDiversity discovers small nucleotide variations within and outside canonical motifs, which co-occur with variations in footprints, suggesting that the TF-DNA structural configuration at those regions is likely to be different. Finally, we show that detected modes have specific DNA shape features and conservation signals, giving insights into the structure and function of the putative TF-DNA complexes.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The code for ExoDiversity is available on <ext-link xlink:href="https://github.com/NarlikarLab/exoDIVERSITY" ext-link-type="uri">https://github.com/NarlikarLab/exoDIVERSITY</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Department of Biotechnology, Government of India</institution>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
        <award-id>BT/IN/BMBF-BioHr/32/LN/2018-19</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Transcriptional regulation is governed by interactions between proteins called transcription factors (TFs) and their corresponding DNA binding sites. TFs may bind DNA directly or through complexes with other proteins, which make contact with DNA. Identifying these genomic binding sites is critical to understand their role in gene-regulation. High-throughput chromatin immunoprecipitation (ChIP) is the method of choice for locating DNA regions associated with a TF or protein of interest (POI) (<xref rid="btab274-B8" ref-type="bibr">Furey, 2012</xref>). Here, after protein-protein and protein-DNA interactions are cross-linked in vivo, fragmented chromatin associated with the POI is immunoprecipitated. The identity of the fragments is usually discerned using sequencing (ChIP-seq). After mapping the reads back to the genome, one typically gets genomic regions of length between 100 and 1000 bp: the short 5–20 bp TF-DNA binding site (direct or otherwise) could be anywhere within that region.</p>
    <p>To improve the positional resolution of these binding sites, a variation of the method was developed, which uses the lambda exonuclease after the immunoprecipitation step (<xref rid="btab274-B20" ref-type="bibr">Rhee and Pugh, 2011</xref>). The enzyme digests chromatin to the point where the cross-linked protein-DNA complex hinders its activity. Specifically, it degrades single strand of unbounded DNA in the 5<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mo>′</mml:mo></mml:math></inline-formula>–3<inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mo>′</mml:mo></mml:math></inline-formula> direction, leaving the DNA sequences 3<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mo>′</mml:mo></mml:math></inline-formula> of the cross-link intact. After sequencing and mapping the reads, one therefore gets directional footprints close to the complex, on both sides. Alignment of these footprints is expected to reveal the DNA contacts made by the POI. However, the footprints are not the same at all locations and depend on multiple factors: (i) the actual protein occupying the DNA, which may be either the POI or a protein with which it complexes/co-occurs, (ii) the nucleotide sequence, since a TF typically can bind a set of distinct nucleotide sequences, at times with varying affinities and (iii) the precise location of the cross-link within the protein-DNA complex, which obstructs the exonuclease activity resulting in the eventual distribution of reads (<xref rid="btab274-B20" ref-type="bibr">Rhee and Pugh, 2011</xref>).</p>
    <p>One therefore needs to categorize these footprints in order to understand the various protein-DNA complexes that may be forming at the reported regions. Two approaches have been pursued for this. The first scans the reported regions with pre-established DNA motifs of interest and extracts putative TF binding sites. The footprints are analyzed separately at these regions to gain insights into potential complexes forming there (<xref rid="btab274-B23" ref-type="bibr">Starick <italic toggle="yes">et al.</italic>, 2015</xref>). The second approach, developed by <xref rid="btab274-B24" ref-type="bibr">Yamada <italic toggle="yes">et al.</italic> (2019)</xref>, aims to learn footprints jointly from the DNA sequence and reads. Their method ChExMix first initializes potential binding events into subtypes, based either on de novo motifs or on diverse read distributions detected from the top (500–1000) most enriched regions, and then refines them using expectation maximization in subsequent iterations over the complete set. We propose a new approach ExoDiversity that does not rely on motifs to be identified a priori and similar to ChExMix divides the ChIP-exo binding events into different binding modes based on both the read distributions and the sequence motifs. However, unlike ChExMix, ExoDiversity is built on a model-based Bayesian framework that uses both sources of information simultaneously on the complete set of regions. We show that ExoDiversity resolves read footprints to a single nucleotide level, which correlate with single nucleotide differences in the sequence motif. The discovered modes provide insights into how the DNA shape might be influencing protein-DNA binding as well as exonuclease digestion activity at those complexes.</p>
  </sec>
  <sec>
    <title>2 Approach</title>
    <p>The input to ExoDiversity are the bound regions and the corresponding mapped reads in both directions, control subtracted if the control experiment is available. ExoDiversity partitions the regions into diverse binding modes, each categorized by a DNA motif and a corresponding read footprint, all of which are learned simultaneously. Multiple models with different numbers of modes are learned and the best model is selected using the Bayesian information criterion (BIC).</p>
  </sec>
  <sec>
    <title>3 Materials and methods</title>
    <sec>
      <title>3.1 Model description</title>
      <p>From the experiment, we have the following:
</p>
      <list list-type="bullet">
        <list-item>
          <p><italic toggle="yes">n</italic> reported DNA sequences <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">1</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">2</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Here <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is one of {A, C, G, T, N}; <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> where <italic toggle="yes">L<sub>i</sub></italic> is the length of <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">n</italic> vectors <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">1</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">2</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, which store read counts corresponding to <bold><italic toggle="yes">X</italic></bold> on the positive strand. <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> denotes the number of reads whose <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mn>5</mml:mn><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> end maps to the genomic location corresponding to <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> on the positive strand. These counts are discretized to binary values based on the median read count or a user-defined threshold.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">n</italic> vectors <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> similar to above but for the negative strand.</p>
        </list-item>
      </list>
      <p>A binding mode is characterized with a joint probability distribution over the DNA motif and the read footprint. The motif is modelled as a product of categorical distributions over the four nucleotides [the standard position weight matrix, or PWM (<xref rid="btab274-B22" ref-type="bibr">Staden, 1984</xref>)] and the footprint is modeled as a product of Bernoulli distributions over the positive and negative reads at two small ‘read windows’, respectively, near the motif (<xref rid="btab274-F1" ref-type="fig">Fig. 1</xref>). Since the lambda exonuclease digested reads are concentrated at a few bases near the binding region, we consider a read window size of five, but this can be changed by the user (Discussion). The position of these two read windows with respect to the motif, the motif locations within <bold><italic toggle="yes">X</italic></bold>, the motif probabilities, as well as the Bernoulli probabilities are all unknown a priori. The goal is to partition the dataset into <italic toggle="yes">m</italic> binding modes i.e. learn parameters <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of a model <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which has six components <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo>,</mml:mo><mml:mo>ϕ</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">τ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>:</p>
      <fig position="float" id="btab274-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>The <italic toggle="yes">i</italic>th datapoint {DNA sequence <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, positive reads <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, negative reads <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>}, belonging to mode <italic toggle="yes">k</italic> is shown. The red (blue) box of width <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the positive (negative) read window, which is modeled using Bernoulli probabilities <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The 1 and 0 indicate the presence and absence of reads at those positions. The pink box is the DNA site at position <italic toggle="yes">Z<sub>i</sub></italic>, modeled using PWM parameters <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The positive (negative) read window is at a fixed distance <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from <italic toggle="yes">Z<sub>i</sub></italic>. Only <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> are known; the rest are unknown and learned from the data</p>
        </caption>
        <graphic xlink:href="btab274f1" position="float"/>
      </fig>
      <list list-type="bullet">
        <list-item>
          <p>Z<sub>i</sub>: position of the motif in <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub></mml:math></inline-formula></p>
        </list-item>
        <list-item>
          <p>I<sub>i</sub>: binding mode of <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>; <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula></p>
        </list-item>
        <list-item>
          <p>w<sub>k</sub>: width of the PWM motif in mode k; <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula></p>
        </list-item>
        <list-item>
          <p><inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>: width of the read window defining the positive strand footprint in mode k; here it is set to 5, but can be changed by the user</p>
        </list-item>
        <list-item>
          <p><inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>: as above, but for the negative strand</p>
        </list-item>
        <list-item>
          <p><inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: PWM values for motif of mode k. <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the probability of finding nucleotide b at position a in PWM of mode k; <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>a</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></p>
        </list-item>
        <list-item>
          <p><inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>: Bernoulli probabilities of finding a read on the positive strand for mode k. <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the probability of having a positive strand read at position a within the read window of mode k, while <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the probability of finding no read there; <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>a</mml:mi><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula></p>
        </list-item>
        <list-item>
          <p><inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>: Bernoulli probabilities for negative strand reads in mode k similar to above</p>
        </list-item>
        <list-item>
          <p><inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">0</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>: parameters of the background distribution over the DNA sequences (2nd order Markov model learned directly from X)</p>
        </list-item>
        <list-item>
          <p><inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">0</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">0</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>: parameters of the background strand read distribution (0<inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> order Markov model learned directly from <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, respectively)</p>
        </list-item>
        <list-item>
          <p><inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>: distance of the start of positive strand read window from the start of motif in mode k (positive read window offset)</p>
        </list-item>
        <list-item>
          <p><inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>: distance of the start of the motif from the start of the negative strand read window in mode k (negative read window offset)</p>
        </list-item>
        <list-item>
          <p><inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:math></inline-formula>: Categorical distribution over m modes. γ<sub>k</sub> is the probability of a sequence containing the binding mode k.</p>
        </list-item>
      </list>
      <p>Assuming that the DNA and the read data are independent conditional on the mode information, the likelihood of datapoint <italic toggle="yes">i</italic> becomes:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      <p>The first term in <xref rid="E1" ref-type="disp-formula">Eq. (1)</xref> is the likelihood of <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> modelled with a motif of mode <italic toggle="yes">I<sub>i</sub></italic> at position <italic toggle="yes">Z<sub>i</sub></italic> and background nucleotide distribution elsewhere:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mi mathvariant="bold-italic">0</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>×</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:munderover><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:munderover><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>which we get by normalizing by the background probability. Similarly the second (third) term of <xref rid="E1" ref-type="disp-formula">Eq. (1)</xref> refers to the positive (negative) strand reads, modelled with the window probabilities near the motif and background at other places.
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">0</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>s</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>×</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">0</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>s</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">0</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>s</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and the position of the read window <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
      <p>The full likelihood of the dataset is:
<disp-formula id="E4"><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>We note that the motifs can be on either strand and the footprints need not be symmetric. To handle this, the original data is appended with its reverse complement, taking care to reverse the read counts appropriately.</p>
    </sec>
    <sec>
      <title>3.2 Model learning</title>
      <p>The goal is to learn the parameters of the model <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to maximize the posterior distribution:
<disp-formula id="E5"><label>(4)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a high dimensional vector. We therefore use collapsed Gibbs sampling targeting a marginalized posterior, as has been done previously with motif discovery (<xref rid="btab274-B13" ref-type="bibr">Liu, 1994</xref>; <xref rid="btab274-B15" ref-type="bibr">Mitra <italic toggle="yes">et al.</italic>, 2018</xref>). Here, we integrate out (i.e. marginalize over) <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:math></inline-formula>, while iteratively sampling the other parameters: locations of motifs (<italic toggle="yes">Z<sub>i</sub></italic>) &amp; mode of binding (<italic toggle="yes">I<sub>i</sub></italic>) for each datapoint <italic toggle="yes">i</italic> and read window offsets (<inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>) and width of motifs (<italic toggle="yes">w<sub>k</sub></italic>), for each binding mode <italic toggle="yes">k</italic>. We assume conjugate Dirichlet/Beta priors for this purpose. The derivation of all the sampling expressions is detailed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
    </sec>
    <sec>
      <title>3.3 Model selection</title>
      <p>We score each sample from the Gibbs sampler using the posterior distribution of <xref rid="E5" ref-type="disp-formula">eq. (4)</xref> and stop sampling when the value does not increase for <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> iterations. We further do a hill climbing routine starting from highest scoring instance (<xref rid="btab274-B15" ref-type="bibr">Mitra <italic toggle="yes">et al.</italic>, 2018</xref>) and report the final instance of the read distributions and the motifs as the MAP estimate of <xref rid="E5" ref-type="disp-formula">Eq. (4)</xref>. As we do not know the value of <italic toggle="yes">m</italic> before hand, we learn models with different values of <italic toggle="yes">m</italic>. We calculate the Bayesian Information Criterion (BIC) score for each model, which is a function of the posterior score and the number of free parameters (<xref rid="btab274-B16" ref-type="bibr">Murphy, 2021</xref>). The model with the minimum BIC score is reported as the best model.
<disp-formula id="E6"><label>(5)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>BIC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mi>ln</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>ln</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p><italic toggle="yes">K</italic> is the number of free parameters, which for model <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> include the three parameters for every column of each PWM, one parameter for every position of each read window, and two parameters for the read position offsets per mode, while <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the posterior score of the model at the MAP estimate.
<disp-formula id="E7"><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>3.4 Using models to predict</title>
      <p>Given a new datapoint <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, where DNA sequence <bold><italic toggle="yes">X</italic></bold> is of length <italic toggle="yes">L</italic> with associated read counts <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, we can calculate the probability of it belonging to mode <italic toggle="yes">k</italic> of model <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, by marginalizing over all possible motif positions <italic toggle="yes">Z</italic>:
<disp-formula id="E8"><label>(6)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>where
<disp-formula id="E9"><label>(7)</label><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mo>×</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      <p>The three individual probability terms are computed using <xref rid="E2" ref-type="disp-formula">Equations 2</xref> and <xref rid="E3" ref-type="disp-formula">3</xref>. In <xref rid="btab274-F3" ref-type="fig">Figure 3B</xref>, after the model is learned, the confusion matrix entry (<italic toggle="yes">u</italic>, <italic toggle="yes">v</italic>) is computed as the average probability of assigning a datapoint of mode <italic toggle="yes">u</italic> to mode <italic toggle="yes">v</italic>:
<disp-formula id="E10"><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mtext>number</mml:mtext><mml:mo> </mml:mo><mml:mtext>of</mml:mtext><mml:mo> </mml:mo><mml:mtext>regions</mml:mtext><mml:mo> </mml:mo><mml:mtext>in</mml:mtext><mml:mo> </mml:mo><mml:mtext>mode</mml:mtext><mml:mo> </mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>In cases where only motif or only reads are used, the corresponding terms are dropped from <xref rid="E9" ref-type="disp-formula">eq. (7)</xref>.</p>
      <p>We can similarly compute the probability of the datapoint given model <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by marginalizing over <italic toggle="yes">I</italic> and <italic toggle="yes">Z</italic>:
<disp-formula id="E11"><label>(8)</label><mml:math id="M11" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>assuming the position <italic toggle="yes">Z</italic> of the motif to be equally likely to appear anywhere within <bold><italic toggle="yes">X</italic></bold>.</p>
      <p>Given two models <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we can compute the log odds score for the datapoint:
<disp-formula id="E12"><label>(9)</label><mml:math id="M12" display="block" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which is used for classifying <bold><italic toggle="yes">D</italic></bold>. <xref rid="E8" ref-type="disp-formula">Eq. (6)</xref> is used in Supplementary Figure S2, while <xref rid="E12" ref-type="disp-formula">eq. (9)</xref> is used in <xref rid="btab274-F4" ref-type="fig">Figure 4</xref>.</p>
    </sec>
    <sec>
      <title>3.5 Datasets</title>
      <sec>
        <title>3.5.1 In silico mixed data</title>
        <p>MultiGPS 0.74 (<xref rid="btab274-B14" ref-type="bibr">Mahony <italic toggle="yes">et al.</italic>, 2014</xref>) was run on BAM files from CTCF and FoxA1 experiments in the MCF7 cell-line (GSE110502) separately with the corresponding control file to obtain the summits for each TF. Regions of length 240 bp around the summits were extracted and 5000 regions were randomly chosen from each dataset, ensuring that they did not contain repetitive DNA or overlapped with each other. The 10 000 regions were mixed, and the BAM files from both experiments were merged. The regions file and the mixed &amp; control BAM files were all given to ChExMix to run with its default parameters. The mixed reads were control subtracted after scaling and along with the peak regions given to ExoDiversity to run with its default parameters. ExoDiversity was run with default parameters on all datasets mentioned in the subsequent sections as well, except in the case of CTCF, where the initial motif width was set to 40.</p>
      </sec>
      <sec>
        <title>3.5.2 Full datasets</title>
        <p>ChIP-nexus data for Sox2, Oct4, Klf4 and Nanog are in mouse ESCs (<xref rid="btab274-B1" ref-type="bibr">Avsec <italic toggle="yes">et al.</italic>, 2021</xref>). The bigWig files containing the read counts and the peak files were taken from the GEO database (GSE137193), which used the MACS2 peak finder (<xref rid="btab274-B7" ref-type="bibr">Feng <italic toggle="yes">et al.</italic>, 2012</xref>). ChIP-nexus reads data for Twist in Drosophila (<xref rid="btab274-B11" ref-type="bibr">He <italic toggle="yes">et al.</italic>, 2015</xref>) was taken from GSE55306. MultiGPS peaks for the individual sets of FoxA1 and CTCF were used as input without mixing when the full individual sets were analysed by ExoDiversity. MultiGPS peaks for ER<italic toggle="yes">α</italic> (<xref rid="btab274-B24" ref-type="bibr">Yamada <italic toggle="yes">et al.</italic>, 2019</xref>) along with its read counts were taken from GSE110502. Reads for Glucocorticoid Receptor(GR) (<xref rid="btab274-B23" ref-type="bibr">Starick <italic toggle="yes">et al.</italic>, 2015</xref>) in U2OS cell lines was taken from EBI ArrayExpress (E-MTAB-2955). ChIP-seq peak file (E-MTAB-2956) was used as the input peak regions for ExoDiversity. For all datasets, 240 bp around the summits were extracted, repeats were masked, and only regions with at least 100 bp of non-repetitive DNA were used as input.</p>
      </sec>
      <sec>
        <title>3.5.3 Other data</title>
        <p>DNA shape data is from GBShape website (<xref rid="btab274-B5" ref-type="bibr">Chiu <italic toggle="yes">et al.</italic>, 2015</xref>). Placental phastCons scores and gene annotations from refGene file were obtained from the UCSC Genome Browser (<xref rid="btab274-B12" ref-type="bibr">Karolchik <italic toggle="yes">et al.</italic>, 2004</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <sec>
      <title>4.1 In silico mixed data</title>
      <p>ExoDiversity should ideally be evaluated on a ChIP-exo dataset where the true footprints are well-established or on a simulated dataset where they could be artificially planted. However, the former does not currently exist and the latter will be constrained by assumptions of the planter, which may never match reality. We therefore followed the methodology of <xref rid="btab274-B24" ref-type="bibr">Yamada <italic toggle="yes">et al.</italic> (2019)</xref> where they mix two ChIP-exo datasets for TFs with well-established direct binding motifs: CTCF and FoxA1. Here, the peak regions were individually processed and 5000 such regions of each experiment were mixed. The goal is to see if CTCF and FoxA1 footprints can be resolved from the mixture of 10000 regions and the combined reads. ExoDiversity finds a total of six modes: the first two resemble the motif of CTCF (over 85% of the sites are in CTCF peaks), the next two are variants of the FoxA1 motif (almost 90% of the sites are in FoxA1 peaks), while the last two do not resemble any known motif, but explain the remaining 24% of the 10000 sequences (<xref rid="btab274-F2" ref-type="fig">Fig. 2A</xref>). Of these, mode 5 is accompanied by a strong positive read signal five bases upstream, in contrast to mode 6, which has no enrichment of reads.</p>
      <fig position="float" id="btab274-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Motifs found in a dataset with 5000 FoxA1 and 5000 CTCF regions in the MCF7 cell-line. Note that unlike in ExoDiversity, the numbers in the pie charts for ChExMix do not add up to 10000, because it finds multiple subtypes in some regions and none in others</p>
        </caption>
        <graphic xlink:href="btab274f2" position="float"/>
      </fig>
      <p>We note that modes 1 and 2 differ in the 3<inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mo>′</mml:mo></mml:math></inline-formula> region of the motif: the existence of these nucleotide dependencies have been shown before (<xref rid="btab274-B6" ref-type="bibr">Eggeling <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab274-B18" ref-type="bibr">Narlikar, 2013</xref>). Interestingly, the read footprints are different in intensity within both, the CTCF and the FoxA1 variants: modes 2 and 3 have stronger read signals than their variants, modes 1 and 4, respectively. The only other approach that detects subtypes of binding in ChIP-exo experiments without use of a motif-database, i.e. ChExMix, finds four subtypes: the largest is a clear match to CTCF, and like the first two modes of ExoDiversity has over 85% of the sites in CTCF peaks. The next two are weak motifs, which bear some resemblance to CTCF, but are less specific to CTCF peaks. The fourth subtype matches the FoxA1 motif and is enriched in the FoxA1 peaks, but explains only 42.5% of the total FoxA1 peaks, in contrast to over 70% of FoxA1 peaks getting explained by one of modes 3 or 4 of ExoDiversity. Overall, the motifs learned by ChExMix are weaker in terms of information content than those learned by ExoDiversity. We suspect this may be because ChExMix uses the motif discovery method MEME in each subtype to find motifs in the top 500 regions, but when extended to the full set of regions the motif becomes weaker. That said, the total number of peaks not explained by a CTCF or FoxA1 motif are only a little different between the two methods (2407 for ExoDiversity and 2651 for ChExMix).</p>
    </sec>
    <sec>
      <title>4.2 ExoDiversity discovers 12 modes in Sox2 data</title>
      <p>We next applied ExoDiversity to 7465 ChIP-nexus regions targeting Sox2 in murine embryonic stem-cells (ESCs) (<xref rid="btab274-B1" ref-type="bibr">Avsec <italic toggle="yes">et al.</italic>, 2021</xref>). Sox2 is essential for maintaining pluripotency in ESCs and recognizes two types of motifs shown in the box in <xref rid="btab274-F3" ref-type="fig">Figure 3</xref>. ExoDiversity splits the data into a total of 12 modes, the first seven of which match the Sox2 motif. They differ in their 5<inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mo>′</mml:mo></mml:math></inline-formula> flanking DNA as well as the read signal, which shifts by one or two positions on either strand. This suggests that the Sox2-DNA binding at the motif variants is different structurally. Further, the ChIP enrichment scores as reported by MACS at these modes are different (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S1</xref>), with the first mode having a significantly higher Sox2 occupancy (Wilcoxon <italic toggle="yes">P</italic>-value <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). Modes 8–10 match the Oct4::Sox2 dimer motif; these modes are also significantly more occupied by Oct4 (grey plot in <xref rid="btab274-F3" ref-type="fig">Fig. 3</xref>). They have differing Sox2 occupancies, with mode 8, like mode 1, having a significantly higher Sox2 occupancy (Wilcoxon <italic toggle="yes">P</italic>-value <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S1</xref>). Curiously, although these motifs when compared to modes 1–7 have an additional Oct4 motif on the 5<inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mo>′</mml:mo></mml:math></inline-formula> region, the positive reads do not appear to be shifted. This suggests that although Oct4 presumably does not bind to the modes 1–7, the exonuclease activity is nevertheless hindered similar to the locations where Oct4 does bind. Perhaps the position of the Sox2 protein is enough to obstruct the exonuclease from digesting that part of the DNA. Modes 11 and 12 are not obvious matches to any database motifs, however, the accompanying strong positive read signal for mode 12 suggests a potential experimental bias or artefact.</p>
      <fig position="float" id="btab274-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>ExoDiversity finds 12 modes in the Sox2 dataset. (<bold>A</bold>) The DNA sequence and the two sets of reads in the 50 bp neighborhood are shown, with the central two lines in each plot marking the site corresponding to the Sox2 motif. The last column indicates which of the regions overlap with the peaks reported in the Oct4 ChIP-nexus experiment. (<bold>B</bold>) The three matrices show the probability distribution of a sequence over the 12 possible modes, averaged over sequences in each mode. The first matrix considers the full model, while other two use only one of the components: sequence or reads (Methods)</p>
        </caption>
        <graphic xlink:href="btab274f3" position="float"/>
      </fig>
      <p>Visually, many modes appear similar. To quantify this similarity, we estimated posterior probabilities in three different ways. First, we calculated the probability of every datapoint belonging to each mode based on its corresponding reads and sequence (<xref rid="E8" ref-type="disp-formula">Equation 6</xref>, Supplementary Fig. S2). Unsurprisingly, the ‘true’ mode is always the most probable. We did a similar exercise using only the sequence information (<bold><italic toggle="yes">X</italic></bold> and <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mo>ϕ</mml:mo></mml:math></inline-formula>) and then using only the read information (<inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>). The mean probability of sequences of a particular mode predicted to belong to other modes, using each of these scoring techniques, is represented as three separate confusion matrices (<xref rid="btab274-F3" ref-type="fig">Fig. 3B</xref>). Modes 1–7 and 8–10, which are variations of Sox2 and Oct4::Sox2 motifs, respectively, show only minor similarities when the full model is used. However, the similarity is more pronounced when only the motif information is used, as one would expect. The reads contribute little by themselves, but together with the motif information, the bold diagonal of the first matrix suggests that the modes are distinctly defined.</p>
      <p>We also ran ExoDiversity on 19 051 ChIP-nexus regions targeting Oct4. It again finds several variants of Oct4, Oct4::Sox2 and Sox2 motifs, with different read footprints. Modes with the Oct4::Sox2 motif are most highly enriched with Oct4 occupancy. In addition, ExoDiversity finds motifs of Esrrb, Klf4 and CTCF, all of which are active in the ESCs (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S3</xref>). All these modes have relatively weak read signals, suggesting indirect binding.</p>
    </sec>
    <sec>
      <title>4.3 ExoDiversity models can distinguish between sets bound by TFs with similar database motifs</title>
      <p>We were struck by the large number of diverse modes captured by ExoDiversity in the Sox2 and Oct4 datasets. Although the two datasets overlap to a great extent, with the Oct4::Sox2 motif variant being enriched in the overlaps (<xref rid="btab274-F3" ref-type="fig">Fig. 3</xref>), the individual modes are different in number and composition between the sets. While the modes are indeed distinct in probability space, we wanted to ensure they were not a result of over-fitting. One way to assess this is to see how general the model is in predicting unseen bound regions. The formulation of ExoDiversity enables us to find log likelihood ratios for a datapoint with respect to two models (<xref rid="E12" ref-type="disp-formula">Eq. 9</xref>).</p>
      <p>We set up binary classification using Sox2 and Oct4 as our two classes of data. Standard five-fold cross-validation was applied, where ExoDiversity was trained on each fold of each TF separately using their respective summit regions and reads. The held out sets for both the TFs were scored using the best models learned by ExoDiversity for Sox2 and Oct4. We used two scoring systems: one which used the reads (<inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>) in addition to the DNA <bold><italic toggle="yes">X</italic></bold>, and the other used only <bold><italic toggle="yes">X</italic></bold>. Considering Sox2 as the positive and Oct4 as the negative class, we plot the receiver operating characteristic (ROC) curve and the precision-recall curve for one representative fold (<xref rid="btab274-F4" ref-type="fig">Fig. 4</xref>). When the reads of the test set are used to score, as expected, the performance in distinguishing the sets is higher. But one may attribute that to the difference in the read counts, which would naturally be high for Sox2 at the Sox2 bound regions and vice versa. Indeed, when only the sequence component is used for scoring, the performance goes down. But it is still higher than the state-of-the-art SVM based classifier gkm-SVM, which goes beyond single PWMs, and using gapped k-mers distinguishes between functional regulatory elements to a remarkable degree (<xref rid="btab274-B9" ref-type="bibr">Ghandi <italic toggle="yes">et al.</italic>, 2014</xref>). This shows that although we are finally using only the sequence features for classification, the reads data used to train by ExoDiversity is critical in identifying those features. To test whether the BIC-selected model was not overfitting by identifying excessive modes, we also scored with the models learned with fewer modes. Those models also do better than gkm-SVM, but worse than the BIC-selected model (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S4</xref>). We also note that the performance of gkm-SVM on the training data is significantly higher than that on the test set; the difference is lower in the models learned by ExoDiversity (dotted curves in <xref rid="btab274-F4" ref-type="fig">Fig. 4</xref>). This further confirms that the model is not over-fitting the training data.</p>
      <fig position="float" id="btab274-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Performance of ExoDiversity-based classifier and gkm-SVM on distinguishing between Sox2-bound and Oct4-bound regions. The programs were trained on 80% of the dataset, with ExoDiversity being supplied the reads at those regions as well. The average area under the curves across all five folds for the different programs is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref></p>
        </caption>
        <graphic xlink:href="btab274f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>4.4 ExoDiversity finds diverse binding modes in FoxA1 and CTCF datasets</title>
      <p>We applied ExoDiversity to the complete FoxA1 data (40 013 sequences) in MCF7 cells, where it finds 13 modes (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S5</xref>), 11 of which are variants of the FoxA1 motif. The first two modes have an additional C three (mode 1) or two (mode 2) bases upstream of the canonical motif. Of these, the second mode has been shown to be enriched in regions bound by both FoxA1 and its paralog FoxA2 (<xref rid="btab274-B3" ref-type="bibr">Bochkis <italic toggle="yes">et al.</italic>, 2012</xref>). The position of the reads on the positive strand also moves correspondingly upstream when compared to mode 5, which is the best match to the canonical motif (box in <xref rid="btab274-F2" ref-type="fig">Fig. 2</xref>). Similarly, modes 7 and 9 lack a strong A at the start and the corresponding cut goes a base deeper towards the motif. Strikingly, having <italic toggle="yes">more</italic> informative positions in the motif, although does result in small shifts in the read patterns, does not necessarily correlate with more reads. This is counter-intuitive since one expects to see higher occupancy of the TF at motifs with more information content. We surmise that these regions may also be bound by other proteins (e.g. FoxA2 in mode 2), and due to the resulting competition between FoxA1 and other TFs for the site, fewer instances of the POI-DNA complex are pulled down, causing fewer reads.</p>
      <fig position="float" id="btab274-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>ExoDiversity finds 13 modes in the FoxA1 dataset. The DNA sequence and the two sets of reads in the 50 bp neighborhood are shown, with the central two lines in each plot marking the site corresponding to the FoxA1 motif</p>
        </caption>
        <graphic xlink:href="btab274f5" position="float"/>
      </fig>
      <p>The last two modes are a low complexity region (mode 13) and the CTCF motif (mode 12), both of which are associated with very few reads. CTCF is known to be interact with FoxA1 and indirect binding between them has been suggested before (<xref rid="btab274-B24" ref-type="bibr">Yamada <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
      <p>CTCF is a protein with 11 zinc fingers and while it binds to a core motif shown in <xref rid="btab274-F2" ref-type="fig">Figure 2</xref>, it employs its zinc fingers to bind DNA in multiple ways. Two specific motifs on each side of the core have been shown to provide additional stability to the CTCF-DNA complex (<xref rid="btab274-B17" ref-type="bibr">Nakahashi <italic toggle="yes">et al.</italic>, 2013</xref>). In order to capture these, we applied ExoDiversity to the CTCF set (55 885 regions) in the same cells with an initial width of 40. It finds eight modes that resemble the CTCF core motif, with differing strengths of the additional flanking motifs (<xref rid="btab274-F6" ref-type="fig">Fig. 6</xref>). Indeed, modes that contain at least one of the additional motifs, are marked by high intensity positive/negative reads at <italic toggle="yes">both</italic> ends, although the position of the reads changes depending on the strength of the additional motifs. For example, modes 1 and 2 both have the upstream motif, but mode 2 has a much weaker downstream motif: the negative strand reads are correspondingly shifted towards the core in this mode. Similarly, the core motif misses a few downstream bases in mode 7, but is associated with a band of reads on both strands (albeit weak); in contrast, although the core motif is fairly well conserved in mode 3, the bands of reads are missing. The only other difference between the two modes is the presence of the upstream motif in mode 7. Furthermore, sequence conservation varies across the modes (modes 1, 2, 4, 5 are significantly more conserved, while modes 3, 6–8 are less; Wilcoxon <italic toggle="yes">P</italic>-value <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), which generally correlates with the number of reads associated with the modes. It does not necessarily correlate with the information content of the core motif.</p>
      <fig position="float" id="btab274-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>ExoDiversity finds 10 modes in the CTCF dataset. The read profiles from both the positive strand (red) and negative strand (blue) over a 100 bp window about the motifs along with motifs learned by ExoDiversity on the eight modes that resemble the canonical CTCF motif are shown in the left. The DNA sequence, the two sets of reads and the corresponding sequence conservation in terms of phastCons scores in the 100 bp neighborhood are shown. The X-axes of the read profiles are aligned corresponding to the 19 bp JASPAR CTCF motif (<xref rid="btab274-F2" ref-type="fig">Fig. 2</xref>), which is also shown with a box in the middle of the four heat-map images and two ticks in the read profile. Note that the read profile is over a 100 bp region and the motif shown below is over a 40 bp region</p>
        </caption>
        <graphic xlink:href="btab274f6" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>4.5 Twist</title>
      <p>We next applied ExoDiversity to 29 353 ChIP-nexus regions from the E-box binding TF Twist in early Drosophila embryos (<xref rid="btab274-B11" ref-type="bibr">He <italic toggle="yes">et al.</italic>, 2015</xref>). It finds a total of 25 modes, of which nine match the E-box (<xref rid="btab274-F7" ref-type="fig">Fig. 7</xref>). The authors had shown that while overall, three peaks of reads are visible around the bound E-box, the individual peaks are specific to certain E-box core motifs: the first peak is enriched about 11 bp upstream of CA<bold>YA</bold>TG and the second is enriched 2 bp inside CA<bold>KC</bold>TG. That analysis was done using the top 200 most enriched regions for each E-box variant. ExoDiversity also identifies similar correlations from the complete dataset, without any prior information about the E-box. It finds additional variations of small shifts in the first peak which co-occur with small differences within and around the E-box.</p>
      <fig position="float" id="btab274-F7">
        <label>Fig. 7.</label>
        <caption>
          <p>ExoDiversity finds 25 modes in the Twist dataset. Modes 1–9 correspond to Twist motifs; Mode 10 matches a <italic toggle="yes">Drosophila</italic> core promoter motif and Modes 17–20 are di/tri-nucleotide repeat patterns. The DNA sequence, the two sets of reads and the DNA shape for propeller twist in the 50 bp neighborhood are shown, with the central two lines in each plot marking the site corresponding to the Twist motif. Two representative modes for the two Twist variants are shown on the right. The mean positive and negative reads are shown in red and blue plots, respectively (left <italic toggle="yes">Y</italic>-axis). The mean propeller twist values are shown in grey (right <italic toggle="yes">Y</italic>-axis)</p>
        </caption>
        <graphic xlink:href="btab274f7" position="float"/>
      </fig>
      <p>Genomic regions flanking E-box binding sites have been shown to possess specific local DNA shapes that correlate with binding (<xref rid="btab274-B10" ref-type="bibr">Gordan <italic toggle="yes">et al.</italic>, 2013</xref>). The propeller twist of the DNA, which denotes the rotation of one base with respect to its base-pair has been shown to be important for other proteins recognizing E-boxes (<xref rid="btab274-B11" ref-type="bibr">He <italic toggle="yes">et al.</italic>, 2015</xref>). We therefore plotted computationally predicted propeller twist (proT) (<xref rid="btab274-B5" ref-type="bibr">Chiu <italic toggle="yes">et al.</italic>, 2015</xref>) at the DNA for each mode. Motifs at modes 1, 2, 4, 6–8, which correspond to the CA<bold>YA</bold>TG E-box have a lower propeller twist than the motifs at modes 3, 5 and 9, which correspond to the CA<bold>KC</bold>TG E-box. Since these DNA shape measures are based on the sequence, it is not surprising that the two variants have strikingly different shape profiles. However, the upstream flanks, which do not have a strong motif signal, possess a higher propeller twist at the CA<bold>YA</bold>TG modes than the CA<bold>KC</bold>TG modes. Curiously, the signal of reads on the positive strand aligns 7–10 bp upstream of the positions with high propeller twist across the E-box modes. Similarly the signal on the negative strand aligns 7–10 bp downstream of the high propeller twist regions (<xref rid="btab274-F7" ref-type="fig">Fig. 7</xref>). A high propeller twist indicates more DNA rigidity, which might explain the differing positions of the read signal and their intensities at the nine modes.</p>
      <p>The Twist modes explain less than half of the total reported regions. ExoDiversity finds 16 modes that do not have E-box motifs, but many of which are well-studied fly motifs. For instance, mode 10 matches the Drosophila core promoter motif 1 (<xref rid="btab274-B19" ref-type="bibr">Ohler <italic toggle="yes">et al.</italic>, 2002</xref>). Indeed, the median distance of the sequences in that mode from the closest transcription start site is 25 bp (Wilcoxon <italic toggle="yes">P</italic>-value <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> when compared to the rest of the set). On the other hand, modes 17–20 contain specific di- and tri-nucleotide repeat patterns, which are characteristic of fly enhancers (<xref rid="btab274-B4" ref-type="bibr">Brittain <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab274-B25" ref-type="bibr">Yanez-Cuna <italic toggle="yes">et al.</italic>, 2014</xref>). Considering that these non-Twist motifs have far fewer reads overall, they are likely indirect binding events involving Twist.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>ExoDiversity resolves protein-DNA binding footprints by learning a joint distribution over DNA regions and corresponding read counts arising from exonuclease-based ChIP experiments. On a range of ChIP-nexus and ChIP-exo datasets, we showed that it detects variations within the DNA motif, which correlate with read signals in the immediate neighborhood. We further showed that some of the detected modes have distinct characteristics such has higher/lower sequence conservation, specific DNA shapes and proximity to transcription start sites. We note that while we cannot definitively establish whether the variations in all the detected modes are biologically relevant, these modes together are needed to describe the whole dataset. The ROC curves demonstrate that the models are not a result of overfitting. Indeed, ExoDiversity is unique in its goal of finding an explanation for each reported region. It therefore identifies potential cofactors like CTCF and Esrrb in Oct4, which have relatively poor read signals and make up a small fraction of the total data.</p>
    <p>Currently we use non-informative priors for all parameters in the model. However, the Bayesian formulation allows one to incorporate prior knowledge, if available. For example, if the structural family of the profiled TF is known, one could use motif priors corresponding to its family-motifs. This might shed more light on potential indirect binding modes. We also note that motifs that are not obvious TF binding sites should be explored for possible experiment biases, especially when they are accompanied by strong read signals.</p>
    <p>ChExMix is another method that attempts to find subtypes based on motifs and reads. However, it is different from ExoDiversity in its problem formulation. First, it is also a peak or event finder, and therefore at times detects binding events well over 500 bp away from the input peak region. Second, it treats each subtype independently, in a way, so allows for multiple subtypes to occur in a region as well as some regions to not have any binding event. Finally, motif discovery is conducted only in the top few regions of each sub-type. Indeed, most downstream motif-based analyses focus on the top <italic toggle="yes">x</italic> regions, either because of the time taken to analyze the full set, or because those regions have a higher likelihood of containing the expected motif. ChExMix uses these strong motifs for subsequent scanning or as priors, but this causes the final motifs, those made by all the final predicted binding events to be weaker (Supplementary Figs S1, S3, S5 and S6), giving an average description of the dataset. In contrast, because ExoDiversity maximizes a joint distribution, its modes are not necessarily guided only by strong reads or enriched regions. This, we believe is critical, since regions with lower read counts are not necessarily uninformative. At times the motif slightly differs from the canonical one, but affects exonuclease activity, or it may be a motif of a different protein, but captured due to its association with the POI. We also note that unlike ChExMix, we focus on a narrow window of reads (5 bp here) in the immediate neighborhood of the motif. As a result, ExoDiversity’s modes are not only characterized by exonuclease cuts differing at the level of a few nucleotides, but also have stronger corresponding motifs, when compared to ChExMix. Indeed, when we run ExoDiversity with larger width values (10, 50, 100), we notice that while the results for 10 are not too different from five, the motifs get progressively weaker for larger read widths (Supplementary Figs S7, S8). This is because the read distribution starts dominating over the motif information, effectively making a larger contribution to the joint distribution of <xref rid="E1" ref-type="disp-formula">eq. (1)</xref>. ExoDiversity gives the user the option of supplying a read width of their choice; however, learning the read width in a manner similar to the motif width is a promising extension.</p>
    <p><xref rid="btab274-B1" ref-type="bibr">Avsec <italic toggle="yes">et al.</italic> (2021)</xref> use BPNet, a deep learning based approach, which trains on ChIP-nexus profiles and predicts profiles for unseen DNA regions to a remarkable degree. Their primary goal is to decipher the syntax or the architecture of TF binding sites within regulatory regions, and not specifically to resolve footprints. We note that ExoDiversity is currently limited to identifying one mode in each region. Changing the model to a module finder, based on combinations of binding modes (<xref rid="btab274-B2" ref-type="bibr">Biswas and Narlikar, 2020</xref>), will be useful. Further, ExoDiversity approximates the read distributions as a product of independent Bernoulli distributions, conditional on the mode. The assumption here is that the cleaving activity, i.e. location where the cut happens, depends only on the type of complex forming at the DNA. This effectively results in an extension of the PWM model, which also assumes independence between positions of the binding site. However, other approximations as well as different distributions which overcome this assumption are worth exploring.</p>
    <p>We note that because ExoDiversity relies heavily on read information at the nucleotide level, it is not applicable to the more popular ChIP-seq protocol which reports wider read distributions. However, several modifications have been suggested recently to the original ChIP-exo protocol, which may result in a broader adoption of the technique, substituting ChIP-seq (<xref rid="btab274-B21" ref-type="bibr">Rossi <italic toggle="yes">et al.</italic>, 2018</xref>). We therefore envision ExoDiversity being used more widely (Supplementary Figs S9–S12 show results on four other TFs–Nanog, Klf4, GR and ER<italic toggle="yes">α</italic>–not discussed here). That said, the formulation behind ExoDiversity can be extended to other sources of information, which are of high resolution and are indicative of DNA motifs in the neighborhood, such as transcription start site data or sequence conservation information.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab274_Supplementary_Data</label>
      <media xlink:href="btab274_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors acknowledge discussions with Shaun Mahony, Julia Zeitlinger, Melanie Weilert and Rahul Siddharthan. They also thank Naomi Yamada for help with ChExMix and related datasets.</p>
    <sec>
      <title>Funding</title>
      <p>This study was supported by a grant from Department of Biotechnology, Government of India BT/IN/BMBF-BioHr/32/LN/2018-19.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab274-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Avsec</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Base-resolution models of transcription-factor binding reveal soft motif syntax</article-title>. <source>Nat. Genet</source>., <volume>53</volume>, <fpage>354</fpage>–<lpage>366</lpage>.<pub-id pub-id-type="pmid">33603233</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Biswas</surname><given-names>A.</given-names></string-name>, <string-name><surname>Narlikar</surname><given-names>L.</given-names></string-name></person-group> (<year>2020</year>) <article-title>A universal framework for detecting cis-regulatory diversity in DNA regulatory regions</article-title>. <source>bioRxiv</source>.</mixed-citation>
    </ref>
    <ref id="btab274-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bochkis</surname><given-names>I.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Genome-wide location analysis reveals distinct transcriptional circuitry by paralogous regulators Foxa1 and Foxa2</article-title>. <source>PLoS Genet</source>., <volume>8</volume>, <fpage>e1002770</fpage>.<pub-id pub-id-type="pmid">22737085</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brittain</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Microsatellite repeat instability fuels evolution of embryonic enhancers in Hawaiian Drosophila</article-title>. <source>PLoS One</source>, <volume>9</volume>, <fpage>e101177</fpage>.<pub-id pub-id-type="pmid">24978198</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chiu</surname><given-names>T.P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>GBshape: a genome browser database for DNA shape annotations</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>D103</fpage>–<lpage>109</lpage>.<pub-id pub-id-type="pmid">25326329</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eggeling</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>On the value of intra-motif dependencies of human insulator protein CTCF</article-title>. <source>PLoS One</source>, <volume>9</volume>, <fpage>e85629</fpage>.<pub-id pub-id-type="pmid">24465627</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Feng</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Identifying ChIP-seq enrichment using MACS</article-title>. <source>Nat. Protoc</source>., <volume>7</volume>, <fpage>1728</fpage>–<lpage>1740</lpage>.<pub-id pub-id-type="pmid">22936215</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Furey</surname><given-names>T.S.</given-names></string-name></person-group> (<year>2012</year>) <article-title>ChIP-seq and beyond: new and improved methodologies to detect and characterize protein-DNA interactions</article-title>. <source>Nat. Rev. Genet</source>., <volume>13</volume>, <fpage>840</fpage>–<lpage>852</lpage>.<pub-id pub-id-type="pmid">23090257</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ghandi</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Enhanced regulatory sequence prediction using gapped k-mer features</article-title>. <source>PLoS Comput. Biol</source>., <volume>10</volume>, <fpage>e1003711</fpage>.<pub-id pub-id-type="pmid">25033408</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gordan</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Genomic regions flanking E-box binding sites influence DNA binding specificity of bHLH transcription factors through DNA shape</article-title>. <source>Cell Rep</source>., <volume>3</volume>, <fpage>1093</fpage>–<lpage>1104</lpage>.<pub-id pub-id-type="pmid">23562153</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>He</surname><given-names>Q.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>ChIP-nexus enables improved detection of in vivo transcription factor binding footprints</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>395</fpage>–<lpage>401</lpage>.<pub-id pub-id-type="pmid">25751057</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karolchik</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2004</year>) <article-title>The UCSC Table Browser data retrieval tool</article-title>. <source>Nucleic Acids Res</source>., <volume>32</volume>, <fpage>D493</fpage>–<lpage>D496</lpage>.<pub-id pub-id-type="pmid">14681465</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J.</given-names></string-name></person-group> (<year>1994</year>) <article-title>The collapsed Gibbs sampler with applications to a gene regulation problem</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>89</volume>, <fpage>958</fpage>–<lpage>966</lpage>.</mixed-citation>
    </ref>
    <ref id="btab274-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mahony</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>An integrated model of multiple-condition ChIP-Seq data reveals predeterminants of Cdx2 binding</article-title>. <source>PLoS Comput. Biol</source>., <volume>10</volume>, <fpage>e1003501</fpage>.<pub-id pub-id-type="pmid">24675637</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mitra</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Diversity in binding, regulation, and evolution revealed from high-throughput chip</article-title>. <source>PLoS Comput. Biol</source>., <volume>14</volume>, <fpage>e1006090</fpage>.<pub-id pub-id-type="pmid">29684008</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B16">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Murphy</surname><given-names>K.P.</given-names></string-name></person-group> (<year>2021</year>) <source>Probabilistic Machine Learning: An Introduction</source>. <publisher-name>MIT Press</publisher-name>. <ext-link xlink:href="https://www.probml.ai" ext-link-type="uri">https://www.probml.ai</ext-link>.</mixed-citation>
    </ref>
    <ref id="btab274-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nakahashi</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>A genome-wide map of CTCF multivalency redefines the CTCF code</article-title>. <source>Cell Rep</source>., <volume>3</volume>, <fpage>1678</fpage>–<lpage>1689</lpage>.<pub-id pub-id-type="pmid">23707059</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Narlikar</surname><given-names>L.</given-names></string-name></person-group> (<year>2013</year>) <article-title>MuMoD: a Bayesian approach to detect multiple modes of protein-DNA binding from genome-wide ChIP data</article-title>. <source>Nucleic Acids Res</source>., <volume>41</volume>, <fpage>21</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">23093591</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ohler</surname><given-names>U.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2002</year>) <article-title>Computational analysis of core promoters in the Drosophila genome</article-title>. <source>Genome Biol</source>., <volume>3</volume>, <fpage>research0087</fpage>.<pub-id pub-id-type="pmid">12537576</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rhee</surname><given-names>H.S.</given-names></string-name>, <string-name><surname>Pugh</surname><given-names>B.F.</given-names></string-name></person-group> (<year>2011</year>) <article-title>Comprehensive genome-wide protein–DNA interactions detected at single-nucleotide resolution</article-title>. <source>Cell</source>, <volume>147</volume>, <fpage>1408</fpage>–<lpage>1419</lpage>.<pub-id pub-id-type="pmid">22153082</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rossi</surname><given-names>M.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Simplified ChIP-exo assays</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>2842</fpage>.<pub-id pub-id-type="pmid">30030442</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Staden</surname><given-names>R.</given-names></string-name></person-group> (<year>1984</year>) <article-title>Computer methods to locate signals in nucleic acid sequences</article-title>. <source>Nucleic Acids Res</source>., <volume>12</volume>, <fpage>505</fpage>–<lpage>519</lpage>.<pub-id pub-id-type="pmid">6364039</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Starick</surname><given-names>S.R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Chip-exo signal associated with DNA-binding motifs provides insight into the genomic binding of the glucocorticoid receptor and cooperating transcription factors</article-title>. <source>Genome Res</source>., <volume>25</volume>, <fpage>825</fpage>–<lpage>835</lpage>.<pub-id pub-id-type="pmid">25720775</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yamada</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Characterizing protein–DNA binding event subtypes in chip-exo data</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>903</fpage>–<lpage>913</lpage>.<pub-id pub-id-type="pmid">30165373</pub-id></mixed-citation>
    </ref>
    <ref id="btab274-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yanez-Cuna</surname><given-names>J.O.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Dissection of thousands of cell type-specific enhancers identifies dinucleotide repeat motifs as general enhancer features</article-title>. <source>Genome Res</source>., <volume>24</volume>, <fpage>1147</fpage>–<lpage>1156</lpage>.<pub-id pub-id-type="pmid">24714811</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
