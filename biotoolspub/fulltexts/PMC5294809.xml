<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Evol Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Evol. Biol</journal-id>
    <journal-title-group>
      <journal-title>BMC Evolutionary Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2148</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5294809</article-id>
    <article-id pub-id-type="publisher-id">890</article-id>
    <article-id pub-id-type="doi">10.1186/s12862-017-0890-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>bModelTest: Bayesian phylogenetic site model averaging and model comparison</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6765-3813</contrib-id>
        <name>
          <surname>Bouckaert</surname>
          <given-names>Remco R.</given-names>
        </name>
        <address>
          <email>remco@cs.auckland.ac.nz</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Drummond</surname>
          <given-names>Alexei J.</given-names>
        </name>
        <address>
          <email>alexei@cs.auckland.ac.nz</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0372 3343</institution-id><institution-id institution-id-type="GRID">grid.9654.e</institution-id><institution>Centre for Computational Evolution, </institution><institution>University of Auckland, </institution></institution-wrap>Auckland, New Zealand </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0372 3343</institution-id><institution-id institution-id-type="GRID">grid.9654.e</institution-id><institution>Department of Computer Science, </institution><institution>University of Auckland, </institution></institution-wrap>Auckland, New Zealand </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 4914 1197</institution-id><institution-id institution-id-type="GRID">grid.469873.7</institution-id><institution/><institution>Max Planck Institute for the Science of Human History, </institution></institution-wrap>Jena, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>42</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>6</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>1</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Reconstructing phylogenies through Bayesian methods has many benefits, which include providing a mathematically sound framework, providing realistic estimates of uncertainty and being able to incorporate different sources of information based on formal principles. Bayesian phylogenetic analyses are popular for interpreting nucleotide sequence data, however for such studies one needs to specify a site model and associated substitution model. Often, the parameters of the site model is of no interest and an ad-hoc or additional likelihood based analysis is used to select a single site model.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>bModelTest allows for a Bayesian approach to inferring and marginalizing site models in a phylogenetic analysis. It is based on trans-dimensional Markov chain Monte Carlo (MCMC) proposals that allow switching between substitution models as well as estimating the posterior probability for gamma-distributed rate heterogeneity, a proportion of invariable sites and unequal base frequencies. The model can be used with the full set of time-reversible models on nucleotides, but we also introduce and demonstrate the use of two subsets of time-reversible substitution models.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>With the new method the site model can be inferred (and marginalized) during the MCMC analysis and does not need to be pre-determined, as is now often the case in practice, by likelihood-based methods. The method is implemented in the bModelTest package of the popular BEAST 2 software, which is open source, licensed under the GNU Lesser General Public License and allows joint site model and tree inference under a wide range of models.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12862-017-0890-6) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Model averaging</kwd>
      <kwd>Model selection</kwd>
      <kwd>Model comparison</kwd>
      <kwd>Statistical phylogenetics</kwd>
      <kwd>ModelTest</kwd>
      <kwd>Phylogenetic model averaging</kwd>
      <kwd>Phylogenetic model comparison</kwd>
      <kwd>Substitution model</kwd>
      <kwd>Site model</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001509</institution-id>
            <institution>Royal Society of New Zealand</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Rutherford fellowship</award-id>
        <principal-award-recipient>
          <name>
            <surname>Drummond</surname>
            <given-names>Alexei J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>One of the choices that needs to be made when performing a Bayesian phylogenetic analysis is which site model to use. A common approach is to use a likelihood-based method like ModelTest [<xref ref-type="bibr" rid="CR1">1</xref>], jModelTest [<xref ref-type="bibr" rid="CR2">2</xref>], or jModelTest2 [<xref ref-type="bibr" rid="CR3">3</xref>] to determine the <italic>site model</italic>. The site model is comprised of (i) a substitution model defining the relative rates of different classes of substitutions and (ii) a model of rate heterogeneity across sites which may include a gamma distribution [<xref ref-type="bibr" rid="CR4">4</xref>] and/or a proportion of invariable sites [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. The site model recommended by such likelihood-based method is then often used in a subsequent Bayesian phylogenetic analysis. This analysis framework introduces a certain circularity, as the original model selection step requires a phylogeny, which is usually estimated by a simplistic approach. Also, by forcing the subsequent Bayesian phylogenetic analysis to condition on the selected site model, the uncertainty in the site model can’t be incorporated into the uncertainty in the phylogenetic posterior distribution. A more statistically rigorous and elegant method is to co-estimate the site model and the phylogeny in a single Bayesian analysis, thus alleviating these issues.</p>
    <p>Co-estimation of the substitution model for a nucleotide alignment can be achieved by sampling all possible reversible models [<xref ref-type="bibr" rid="CR7">7</xref>], or just a nested set of models [<xref ref-type="bibr" rid="CR8">8</xref>], using either reversible jump MCMC or stochastic Bayesian variable selection [<xref ref-type="bibr" rid="CR9">9</xref>]. The CAT-GTR model [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>] solves a related problem by providing a mixture model over sites that often fits better than using any single model for all sites. Wu et al. [<xref ref-type="bibr" rid="CR12">12</xref>] use reversible jump for both substitution models and partitions and furthermore sample the use of gamma rate heterogeneity for each site category. However, since the method divides sites among a set of substitution models, it does not address invariable sites, and only considers a limited set of five (K80, F81, HKY85, TN93, and GTR) substitution models.</p>
    <p>Here we introduce a method which combines model averaging over substitution models with model averaging of the parameters governing rate heterogeneity across sites using reversible jump. Whether one considers the method to be selecting the site model, or averaging over (marginalizing over) site models depends on which random variables are viewed as parameters of interest and which are viewed as nuisance parameters. If the phylogeny is viewed as the parameter of interest, then bModelTest provides estimates of the phylogeny averaged over site models. Alternatively if the site model is of interest, then bModelTest can be used to select the site model averaged over phylogenies. These are matters of post-processing of the MCMC output, and it is also possible to consider the interaction of phylogeny and site models. For example one could construct phylogeny estimates conditional on different features of the site model from the results of a single MCMC analysis.</p>
    <p>The method is implemented in the bModelTest package of BEAST 2 [<xref ref-type="bibr" rid="CR13">13</xref>] with GUI support for BEAUti making it easy to use. It is open source and available under LGPL licence. Source code, installation instructions and documentation can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/BEAST2-Dev/bModelTest">https://github.com/BEAST2-Dev/bModelTest</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>All time-reversible nucleotide models can be represented by a 4×4 instantaneous rate matrix: 
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$Q=\left(\begin{array}{cccc} - &amp; \pi_{C}r_{ac} &amp; \pi_{G}r_{ag} &amp; \pi_{T}r_{at}\\ \pi_{A}r_{ac} &amp; - &amp; \pi_{G}r_{cg} &amp; \pi_{T}r_{ct}\\ \pi_{A}r_{ag} &amp; \pi_{C}r_{cg} &amp; - &amp; \pi_{T}r_{gt}\\ \pi_{A}r_{at} &amp; \pi_{C}r_{ct} &amp; \pi_{G}r_{gt} &amp; -\\ \end{array}\right), $$ \end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ac</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ag</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">at</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ac</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">cg</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ct</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ag</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">cg</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gt</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">at</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ct</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gt</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12862_2017_890_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> with six rate parameters <italic>r</italic>
<sub><italic>ac</italic></sub>,<italic>r</italic>
<sub><italic>ag</italic></sub>,<italic>r</italic>
<sub><italic>at</italic></sub>,<italic>r</italic>
<sub><italic>cg</italic></sub>,<italic>r</italic>
<sub><italic>ct</italic></sub> and <italic>r</italic>
<sub><italic>gt</italic></sub> and four parameters describing the equilibrium base frequencies <italic>Π</italic>=(<italic>π</italic>
<sub><italic>A</italic></sub>,<italic>π</italic>
<sub><italic>C</italic></sub>,<italic>π</italic>
<sub><italic>G</italic></sub>,<italic>π</italic>
<sub><italic>T</italic></sub>). A particular restriction on the rate parameters can conveniently be represented by a six figure model number where each of the six numbers corresponds to one of the six rates in the alphabetic order listed above. Rates that are constrained to be the same, have the same integer at their positions in the model number. For example, model 123,456 corresponds to a model where all rates are independent, named the general time reversible (GTR) model [<xref ref-type="bibr" rid="CR14">14</xref>]. Model 121121 corresponds to the HKY model [<xref ref-type="bibr" rid="CR15">15</xref>] in which rates form two groups labelled transversions (1:<italic>r</italic>
<sub><italic>ac</italic></sub>=<italic>r</italic>
<sub><italic>at</italic></sub>=<italic>r</italic>
<sub><italic>cg</italic></sub>=<italic>r</italic>
<sub><italic>gt</italic></sub>) and transitions (2:<italic>r</italic>
<sub><italic>ag</italic></sub>=<italic>r</italic>
<sub><italic>ct</italic></sub>). By convention, the lowest possible number representing a model is used, so even though 646,646 and 212,212 represent HKY, we only use 121,121.</p>
    <p>There are 203 reversible models in total [<xref ref-type="bibr" rid="CR7">7</xref>]. However, it is well known that transitions (A ⇔C, and G ⇔T substitutions) are more likely than transversions (the other substitutions) [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. Hence grouping transition rates with transversion rates is often not appropriate and these rates should be treated differently. We can restrict the set of substitution models that allow grouping only within transitions and within transversions, with the exception of model 111,111, where all rates are grouped. This reduces the 203 models to 31 models (see Fig. <xref rid="Fig1" ref-type="fig">1</xref> and details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix). Alternatively, if one is interested in using named models, we can restrict further to include only Jukes Cantor [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>] (111,111), HKY [<xref ref-type="bibr" rid="CR15">15</xref>] (121,121), TN93 [<xref ref-type="bibr" rid="CR20">20</xref>] (121,131), K81 [<xref ref-type="bibr" rid="CR21">21</xref>] (123,321), TIM [<xref ref-type="bibr" rid="CR22">22</xref>] (123,341), TVM [<xref ref-type="bibr" rid="CR22">22</xref>] (123,425),and GTR [<xref ref-type="bibr" rid="CR14">14</xref>] (123,456). However, to facilitate stepping between TIM and GTR during the MCMC (see proposals below) we like to use nested models, and models 123,345 and 123,324 provide intermediates between TIM and GTR, as well as K81 and TVM, leaving us with a set of 9 models (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Model spaces. The model spaces supported by bModelTest. <bold>a</bold> All reversible models, <bold>b</bold> transition/transversion split models, and <bold>c</bold> named models. <italic>Arrows</italic> indicate which models can be reached by splitting a model. Note all models with the same number of groupings are at the same height</p></caption><graphic xlink:href="12862_2017_890_Fig1_HTML" id="MO1"/></fig>
</p>
    <p>The state space consists of the following parameters: 
<list list-type="bullet"><list-item><p>The model number <italic>M</italic>,</p></list-item><list-item><p>A variable size rate parameter (depending on model number) <italic>R</italic>,</p></list-item><list-item><p>A binary variable to indicate whether 1 or <italic>k</italic>&gt;1 non-zero rate categories should be used,</p></list-item><list-item><p>A shape parameter <italic>α</italic>, used for gamma rate heterogeneity when there are <italic>k</italic>&gt;1 rate categories,</p></list-item><list-item><p>A binary variable to indicate whether or not a category for invariable sites should be used,</p></list-item><list-item><p>The proportion of invariable sites <italic>p</italic>
<sub><italic>inv</italic></sub>,</p></list-item></list>
</p>
    <p>Rates <italic>r</italic>
<sub><italic>ac</italic></sub>, <italic>r</italic>
<sub><italic>ag</italic></sub>, <italic>r</italic>
<sub><italic>at</italic></sub>, <italic>r</italic>
<sub><italic>cg</italic></sub>, <italic>r</italic>
<sub><italic>ct</italic></sub> and <italic>r</italic>
<sub><italic>gt</italic></sub> are determined from the model number <italic>M</italic> and rate parameter <italic>R</italic>. Further, we restrict <italic>R</italic> such that the sum of the six rates <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum r_{..}$\end{document}</tex-math><mml:math id="M4"><mml:mo>∑</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>..</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12862_2017_890_Article_IEq1.gif"/></alternatives></inline-formula> equals 6 in order to ensure identifiability. This is implemented by starting each rate with value 1, and ensuring proposals keep the sum of rates in (see details on proposals below).</p>
    <sec id="Sec3">
      <title>Prior</title>
      <p>By default, bModelTest uses the flat Dirichlet prior on rates from [<xref ref-type="bibr" rid="CR7">7</xref>]. From empirical studies [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>], we know that transition rates tend to be higher than transversion rates. It makes sense to encode this information in our prior and bModelTest allows for rates to get a different prior on transition rates (default log normal with mean 1 and standard deviation of 1.25 for the log rates) and transversion rates (default exponential with mean 1 for the rates).</p>
      <p>An obvious choice for the prior on models is to use a uniform prior over all valid models. As Fig. <xref rid="Fig1" ref-type="fig">1</xref> shows, there are many more models with 3 parameters than with 1. An alternative allowed in bModelTest is to use a uniform prior on the number of parameters in the model. In that case, Jukes Cantor and GTR get a prior probability of 1/6, since these are the only models with 0 and 5 degrees of freedom respectively. Depending on the model set, a much lower probability is assigned to each of the individual models such that the total prior probability summed over models with <italic>K</italic> parameters, <italic>p</italic>(<italic>K</italic>)=1/6 for <italic>K</italic>∈{0,1,2,3,4,5}.</p>
      <p>For frequencies a Dirichlet(4,4,4,4) prior is used, reflecting our believe that frequencies over nucleotides tend to be fairly evenly distributed, but allowing a 2.2% chance for a frequency to be under 0.05. For <italic>p</italic>
<sub><italic>inv</italic></sub> a Beta(4,1) prior on the interval (0,1) is used giving a mean of 0.2 and for <italic>α</italic> an exponential with a mean 1. These priors only affect the posterior when the respective binary indicator is 1.</p>
    </sec>
    <sec id="Sec4">
      <title>MCMC proposals</title>
      <p>The probability of acceptance of a (possibly trans-dimensional) proposal [<xref ref-type="bibr" rid="CR23">23</xref>] is 
<disp-formula id="Equb"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\min\{1, \text{posterior ratio}\times\text{proposal ratio}\times\text{Jacobian}\} $$ \end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mo>min</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>posterior ratio</mml:mtext><mml:mo>×</mml:mo><mml:mtext>proposal ratio</mml:mtext><mml:mo>×</mml:mo><mml:mtext>Jacobian</mml:mtext><mml:mo>}</mml:mo></mml:mrow></mml:math><graphic xlink:href="12862_2017_890_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where the posterior ratio is the posterior of the proposed state <italic>S</italic>
<sup>′</sup> divided by that of the current state <italic>S</italic>, the proposal ratio the probability of moving from <italic>S</italic> to <italic>S</italic>
<sup>′</sup> divided by the probability of moving back from <italic>S</italic>
<sup>′</sup> to <italic>S</italic>, and the Jacobian is the determinant of the matrix of partial derivatives of the parameters in the proposed state with respect to that of the current state [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
      <sec id="Sec5">
        <title>Model merge/split proposal</title>
        <p>For splitting (or merging) substitution models, suppose we start with a model <italic>M</italic>. To determine the proposed model <italic>M</italic>
<sup>′</sup>, we randomly select one of the child (or parent) nodes in the graph (as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>). This is in contrast to the approach of Huelsenbeck et al. [<xref ref-type="bibr" rid="CR7">7</xref>], in which first a group is randomly selected, then a subgrouping is randomly created. For any set of substitution models organised in an adjacency graph our merge/split operator applies, making our graph-based method easier to generalise to other model sets (e.g. the one used in [<xref ref-type="bibr" rid="CR24">24</xref>]). If there are no candidates to split (that is, model <italic>M</italic>=123,456 is GTR) the proposal returns the current state (this proposal is important to guarantee uniform sampling of models). Likewise, when attempting to merge model <italic>M</italic>=111,111, the current state is proposed (<italic>M</italic>
<sup>′</sup>=111,111). Let <italic>r</italic> be the rate of the group to be split. We have to generate two rates <italic>r</italic>
<sub><italic>i</italic></sub> and <italic>r</italic>
<sub><italic>j</italic></sub> for the split into groups of size <italic>n</italic>
<sub><italic>i</italic></sub> and <italic>n</italic>
<sub><italic>j</italic></sub>. To ensure rates sum to 6, we select <italic>u</italic> uniformly from the interval (−<italic>n</italic>
<sub><italic>i</italic></sub>
<italic>r</italic>,<italic>n</italic>
<sub><italic>j</italic></sub>
<italic>r</italic>) and set <italic>r</italic>
<sub><italic>i</italic></sub>=<italic>r</italic>+<italic>u</italic>/<italic>n</italic>
<sub><italic>i</italic></sub> and <italic>r</italic>
<sub><italic>j</italic></sub>=<italic>r</italic>−<italic>u</italic>/<italic>n</italic>
<sub><italic>j</italic></sub>.</p>
        <p>For a merge proposal, the rate of the merged group <italic>r</italic> from two split groups <italic>i</italic> and <italic>j</italic> with sizes <italic>n</italic>
<sub><italic>i</italic></sub> and <italic>n</italic>
<sub><italic>j</italic></sub>, as well as rates <italic>r</italic>
<sub><italic>i</italic></sub> and <italic>r</italic>
<sub><italic>j</italic></sub> is calculated as <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r=\frac {n_{i}r_{i}+n_{j}r_{j}}{n_{i}+n_{j}}$\end{document}</tex-math><mml:math id="M8"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12862_2017_890_Article_IEq2.gif"/></alternatives></inline-formula>.</p>
        <p>When we select merge and split moves with equal probability, the proposal ratio for splitting becomes 
<disp-formula id="Equc"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\frac{\frac{1}{|M'_{merge}|}}{\frac{1}{|M_{split}|}}\frac{1}{r\left(n_{i}+n_{j}\right)} $$ \end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">merge</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">split</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12862_2017_890_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> where |<italic>M</italic>
<sub><italic>split</italic></sub>| (and |<italic>M</italic>
<italic>merge</italic>′|) is the number of possible candidates to split (and merge) into from model <italic>M</italic> (and <italic>M</italic>
<sup>′</sup> respectively). The proposal ratio for merging is 
<disp-formula id="Equd"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\frac{\frac{1}{|M'_{split}|}}{\frac{1}{|M_{merge}|}}{r\left(n_{i}+n_{j}\right)}. $$ \end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">split</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">merge</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac><mml:mi>r</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12862_2017_890_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>The Jacobian for splitting is <inline-formula id="IEq3"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {n_{i}+n_{j}}{n_{i}n_{j}}$\end{document}</tex-math><mml:math id="M14"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12862_2017_890_Article_IEq3.gif"/></alternatives></inline-formula> and for merging it is <inline-formula id="IEq4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {n_{i}n_{j}}{n_{i}+n_{j}}$\end{document}</tex-math><mml:math id="M16"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12862_2017_890_Article_IEq4.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec6">
        <title>Rate exchange proposal</title>
        <p>The rate exchange proposal randomly selects two groups, and exchanges a random amount such that the condition that all six rates sum to 6 is met. A random number is selected from the interval [ 0,<italic>δ</italic>] where <italic>δ</italic> is a tuning parameter of the proposal (<italic>δ</italic> is automatically optimized to achieve the desired acceptance probability for the data during the MCMC chain). Let <italic>n</italic>
<sub><italic>i</italic></sub>, <italic>r</italic>
<sub><italic>i</italic></sub>, <italic>n</italic>
<sub><italic>j</italic></sub> and <italic>r</italic>
<sub><italic>j</italic></sub> as before, then the new rates are <italic>r</italic>
<italic>i</italic>′=<italic>r</italic>
<sub><italic>i</italic></sub>−<italic>u</italic> and <inline-formula id="IEq5"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$r_{j}'= r_{j} + u\frac {n_{i}}{n_{j}}$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12862_2017_890_Article_IEq5.gif"/></alternatives></inline-formula>. The proposal fails when <italic>r</italic>
<italic>i</italic>′&lt;0.</p>
        <p>The proposal ratio as well as the Jacobian are 1.</p>
      </sec>
      <sec id="Sec7">
        <title>Birth/death proposal</title>
        <p>Birth and death proposals set or unset the category count flag and sample a new value for <italic>α</italic> from the prior when the flag is set. The proposal ratio is <italic>d</italic>(<italic>α</italic>
<sup>′</sup>) for birth and 1/<italic>d</italic>(<italic>α</italic>) for death where <italic>d</italic>(.) is the density used to sample from (by default an exponential density with a mean of 1).</p>
        <p>Likewise for setting the indicator flag to include a proportion of invariable sites and sampling <italic>p</italic>
<sub><italic>inv</italic></sub> from the prior. The Jacobian is 1 for all these proposals.</p>
      </sec>
      <sec id="Sec8">
        <title>Scale proposal</title>
        <p>For the <italic>α</italic>, we use the standard scale operator in BEAST 2 [<xref ref-type="bibr" rid="CR13">13</xref>], adapted so it only samples if the category count flag is set for <italic>α</italic>. Likewise, for <italic>pInv</italic> this scale operator is used, but only if the indicator flag to include a proportion of invariable sites is set.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results and discussion</title>
    <p>Since implementation of the split/merge and rate exchange proposals is not straightforward, nor is derivation of the proposal ratio and Jacobian, unit tests were written to guarantee their correctness and lack of bias in proposals (available on <ext-link ext-link-type="uri" xlink:href="https://github.com/BEAST2-Dev/bModelTest">https://github.com/BEAST2-Dev/bModelTest</ext-link>).</p>
    <p>To validate the method we performed a simulation study by drawing site models from the prior, then used these models to generate sequence data of 10K sites length on a tree (in Newick (A:0.2,(B:0.15,C:0.15):0.05)) with three taxa under a strict clock. The data was analysed using a Yule tree prior, a strict clock and bModelTest as site model with uniform prior over models and exponential with mean one for transversions and log-normal with mean one and variance 1.25 for transition rates. A hundred alignments were generated with gamma rate heterogeneity and a hundred without rate heterogeneity using a (Bouckaert, RR: BEASTShell – scripting for bayesian hierarchical clustering, submitted) script. Invariant sites can be generated in the process and are left in the alignment.</p>
    <p>Comparing the model used to generate the alignments with inferred models is best done by comparing the individual rates of these models. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the rate estimates for the six rates against the rates used to generate the data. Clearly, there is a high correlation between the estimated rates and the ones used to generate (<italic>R</italic>
<sup>2</sup>&gt;0.99 for all rates). Results were similar with and without rate heterogeneity. Note values for rates AG and CT (middle panels) tend to be higher than the transversion rates due to the prior they are drawn from.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Accuracy of estimated substitution rates. True rates (<italic>horizontal</italic>) against estimated rates (<italic>vertical</italic>) in simulated data for 3 taxa. In reading order, rate AC, AG, AT, CG, CT and GT. <italic>Diamonds</italic> are for estimates when no rate heterogeneity was used to simulate the data, <italic>circles</italic> are for estimates with rate heterogeneity. <italic>Error bars</italic> represent 95% HPD intervals for each estimate</p></caption><graphic xlink:href="12862_2017_890_Fig2_HTML" id="MO2"/></fig>
</p>
    <p>Table <xref rid="Tab1" ref-type="table">1</xref> summarises coverage of the various parameters in the model, which is defined as the number of experiments where the 95% HPD of the parameter estimate contains the value of the parameter used to generate the data. The rows in the table show the four different models of rate heterogeneity among sites; plain means a single category without gamma or invariable sites, +G for discrete gamma rate categories, +I for two categories, one being invariable, and +G+I for discrete gamma rate categories and one invariable category. Furthermore, the experiment was run estimating whether base frequencies were equal or not. The first four rows are for data simulated with equal frequencies, the latter four with unequal frequencies. The last row shows results averaged over all 800 experiments. On average, one would expect the coverage to be 95% if simulations are drawn from the prior [<xref ref-type="bibr" rid="CR25">25</xref>], so each entry in Table <xref rid="Tab1" ref-type="table">1</xref> has an expected value of 95, but can deviate due to small sample size. According to the binomial probability distribution there is a ∼1.1<italic>%</italic> chance of seeing 89 or less successes when sampling 100 times with a success rate of 0.95. The sample size for the mean rows is 800, so is expected to be much closer to 95%.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Coverage summary for simulation study</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left"/><td align="left">Site</td><td align="left" colspan="6">Rate coverage</td><td align="left">Mean</td><td align="left">Subst. Model</td></tr><tr><td align="left">Freqs</td><td align="left">model</td><td align="left">AC</td><td align="left">AG</td><td align="left">AT</td><td align="left">CG</td><td align="left">CT</td><td align="left">GT</td><td align="left">rate</td><td align="left">coverage</td></tr><tr><td align="left">Equal</td><td align="left">plain</td><td align="left">93</td><td align="left">97</td><td align="left">94</td><td align="left">96</td><td align="left">95</td><td align="left">95</td><td align="left">95</td><td align="left">98</td></tr><tr><td align="left">Equal</td><td align="left">+G</td><td align="left">91</td><td align="left">95</td><td align="left">93</td><td align="left">93</td><td align="left">95</td><td align="left">93</td><td align="left">93.3</td><td align="left">97</td></tr><tr><td align="left">Equal</td><td align="left">+I</td><td align="left">92</td><td align="left">94</td><td align="left">94</td><td align="left">95</td><td align="left">93</td><td align="left">94</td><td align="left">93.6</td><td align="left">96</td></tr><tr><td align="left">Equal</td><td align="left">+G+I</td><td align="left">89</td><td align="left">96</td><td align="left">95</td><td align="left">94</td><td align="left">95</td><td align="left">95</td><td align="left">94</td><td align="left">98</td></tr><tr><td align="left">Unequal</td><td align="left">plain</td><td align="left">96</td><td align="left">95</td><td align="left">96</td><td align="left">97</td><td align="left">93</td><td align="left">96</td><td align="left">95.5</td><td align="left">96</td></tr><tr><td align="left">Unequal</td><td align="left">+G</td><td align="left">95</td><td align="left">94</td><td align="left">94</td><td align="left">94</td><td align="left">96</td><td align="left">96</td><td align="left">94.8</td><td align="left">98</td></tr><tr><td align="left">Unequal</td><td align="left">+I</td><td align="left">89</td><td align="left">94</td><td align="left">95</td><td align="left">95</td><td align="left">93</td><td align="left">95</td><td align="left">93.5</td><td align="left">93</td></tr><tr><td align="left">Unequal</td><td align="left">+G+I</td><td align="left">97</td><td align="left">94</td><td align="left">94</td><td align="left">93</td><td align="left">93</td><td align="left">96</td><td align="left">94.5</td><td align="left">97</td></tr><tr><td align="left">Mean</td><td align="left"/><td align="left">94.25</td><td align="left">94.25</td><td align="left">94.75</td><td align="left">94.75</td><td align="left">93.75</td><td align="left">95.75</td><td align="left">94.6</td><td align="left">96</td></tr><tr><td align="left"/><td align="left">Site</td><td align="left">Site model</td><td align="left"/><td align="left"/><td align="left">Frequency</td><td align="left" colspan="4">Frequency coverage</td></tr><tr><td align="left">Freqs</td><td align="left">model</td><td align="left">coverage</td><td align="left"><italic>α</italic></td><td align="left"><italic>p</italic><sub><italic>inv</italic></sub></td><td align="left">coverage</td><td align="left">A</td><td align="left">C</td><td align="left">G</td><td align="left">T</td></tr><tr><td align="left">Equal</td><td align="left">plain</td><td align="left">100</td><td align="left"/><td align="left"/><td align="left">100</td><td align="left">100</td><td align="left">100</td><td align="left">100</td><td align="left">100</td></tr><tr><td align="left">Equal</td><td align="left">+G</td><td align="left">96</td><td align="left">94</td><td align="left"/><td align="left">100</td><td align="left">100</td><td align="left">100</td><td align="left">100</td><td align="left">100</td></tr><tr><td align="left">Equal</td><td align="left">+I</td><td align="left">98</td><td align="left"/><td align="left">95</td><td align="left">100</td><td align="left">100</td><td align="left">100</td><td align="left">100</td><td align="left">100</td></tr><tr><td align="left">Equal</td><td align="left">+G+I</td><td align="left">99</td><td align="left">89</td><td align="left">88</td><td align="left">100</td><td align="left">100</td><td align="left">100</td><td align="left">100</td><td align="left">100</td></tr><tr><td align="left">Unequal</td><td align="left">plain</td><td align="left">100</td><td align="left"/><td align="left"/><td align="left">100</td><td align="left">92</td><td align="left">95</td><td align="left">97</td><td align="left">96</td></tr><tr><td align="left">Unequal</td><td align="left">+G</td><td align="left">97</td><td align="left">94</td><td align="left"/><td align="left">100</td><td align="left">97</td><td align="left">92</td><td align="left">92</td><td align="left">98</td></tr><tr><td align="left">Unequal</td><td align="left">+I</td><td align="left">98</td><td align="left"/><td align="left">92</td><td align="left">100</td><td align="left">95</td><td align="left">94</td><td align="left">94</td><td align="left">89</td></tr><tr><td align="left">Unequal</td><td align="left">+G+I</td><td align="left">100</td><td align="left">93</td><td align="left">91</td><td align="left">100</td><td align="left">99</td><td align="left">96</td><td align="left">96</td><td align="left">98</td></tr><tr><td align="left">Mean</td><td align="left"/><td align="left">98.75</td><td align="left">93.50</td><td align="left">91.50</td><td align="left">100.00</td><td align="left">97.38</td><td align="left">97.88</td><td align="left">97.13</td><td align="left">97.38</td></tr></tbody></table><table-wrap-foot><p>The first column lists the frequency and site models used to generate the data, and the last row is the mean coverage over all 800 runs. Coverage for rate parameters and frequencies is defined as the number of replicate simulations in which the true parameter value was contained in the estimated 95% HPD interval. The mean rate column contains the coverage averaged over all six rate coverage columns (i.e. the proportion of the 600 parameter estimates whose values were contained in their respective 95% HPD intervals. For details of substitution model coverage see text. The site model coverage is the number of replicate simulations that contained the correct model specification for rate heterogeneity across sites in the 95% credible set of models. Columns <italic>α</italic> and <italic>p</italic>
<sub><italic>inv</italic></sub> are coverages of the shape and proportion invariable parameter <italic>conditioned on sampling from the true site model</italic>
</p></table-wrap-foot></table-wrap>
</p>
    <p>Coverage of rate estimates and frequencies are as expected, as shown in the table. Substitution model coverage is measured by first creating the 95% credible set of models for each simulation and then counting how often the model used to generate the data was part of the 95% credible set. The 95% credible set is the smallest set of models having total posterior probability ≥0.95. As Table <xref rid="Tab1" ref-type="table">1</xref> shows, model coverage is as expected (Subst. Model coverage column). The situation with gamma shape parameter estimates and proportion of invariable sites is not as straightforward as for the relative rates of the substitution process. The site model coverage can be measured in a similar fashion: the site model coverage column shows how often the 95% credible sets for the four different site models (plain, +G. +I and +G+I) contains the true model used to generate the data. The coverage is as expected. When looking at how well the shape parameter (<italic>α</italic> column in Table <xref rid="Tab1" ref-type="table">1</xref>) and the proportion invariable sites (<italic>p</italic>
<sub><italic>inv</italic></sub> column in the table) is estimated, we calculated the 95% HPD intervals for that part of the trace where the true site model was sampled. Coverage is as expected when only gamma rate heterogeneity is used, or when only a proportion of invariable sites is used, but when both are used an interaction between the two site model categories appears to slightly reduce the coverage of both parameters. In these experiments the coverage for the frequency estimates for the individual nucleotides was as expected. In summary, the statistical performance of the model is as expected for almost all parameters except for the case where gamma and a proportion of invariable sites are used due to their interaction as discussed further below.</p>
    <p>To investigate robustness of the approach, we repeated the study with a log normal uncorrelated relaxed clock [<xref ref-type="bibr" rid="CR26">26</xref>] with a gamma (<italic>α</italic>=30,<italic>β</italic>=0.005) prior over the standard deviation for the log normal distribution. Trees with 5 taxa were randomly sampled from a Yule prior with log normal distribution (the birth rate was drawn from a distribution with a mean of the rate of 5.5, and a standard-deviation of the log-rate of 0.048) giving trees with mean height ≈0.25 and 95% HPD interval of 0.015 to 0.7. The study as outlined above was repeated, and results are summarised in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1, which looks very similar to that of Table <xref rid="Tab1" ref-type="table">1</xref>. So, we conclude that the model is not sensitive to small variation in molecular clock rates among branches.</p>
    <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> shows histograms of estimated posterior probability of gamma-distributed rate heterogeneity across sites for the data sets simulated over 5 taxa. When data was generated without gamma-distributed rate heterogeneity across sites, the posterior probability was often estimated to be close to zero (left of Fig. <xref rid="Fig3" ref-type="fig">3</xref>), while the posterior probability was estimated to be close to one for most of the analyses on data in which gamma rate heterogeneity was present (middle of Fig. <xref rid="Fig3" ref-type="fig">3</xref>).<sup>1</sup> When rate heterogeneity was present, shape estimates were fairly close to the ones used to generate the data (right of Fig. <xref rid="Fig3" ref-type="fig">3</xref>). However, there were quite a few outliers, especially when the shape parameter was high (although this is harder to see on a log-log plot which was used here because of the uneven distribution of true values). This can happen due to the fact that when the gamma shape is small, a large proportion of sites gets a very low rate, and may be invariant, so that the invariable category can model those instances. The mean number of invariant sites was 6083 when no rate heterogeneity was used, while it was 6907 when rate heterogeneity was used, a difference of about 8% of the sites.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Accuracy of inference of rate heterogeneity across sites. Posterior probability for inclusion of gamma rate heterogeneity when the data is generated without (<italic>left</italic>) and with (<italic>middle</italic>) rate heterogeneity for 5 taxa. Right, True gamma shape parameter (<italic>horizontal</italic>) against estimated shape parameter (<italic>vertical</italic>) when rate heterogeneity is used to generate the data</p></caption><graphic xlink:href="12862_2017_890_Fig3_HTML" id="MO3"/></fig>
</p>
    <p>Figure <xref rid="Fig4" ref-type="fig">4</xref> shows similar plots as Fig. <xref rid="Fig3" ref-type="fig">3</xref> but for the proportion of invariable sites for 5 taxa. <sup>2</sup> Empirically for the parameters that we used for our simulations, it appears that if there are less than 60% invariant sites, adding a category to model them does not give a much better fit. When a proportion of invariable sites was included in the simulation, there was a high correlation between the true proportion and the estimated proportion of invariable sites.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Accuracy of inference of proportion of invariant sites. Posterior probability for inclusion of a proportion of invariant sites when the data is generated without (<italic>left</italic>) and with (<italic>middle</italic>) invariant sites for 5 taxa. Right, empirical proportion invariant in alignment (<italic>horizontal</italic>) against estimated proportion of invariant sites (<italic>vertical</italic>) when a proportion invariable category is used to generate the data</p></caption><graphic xlink:href="12862_2017_890_Fig4_HTML" id="MO4"/></fig>
</p>
    <p>The same study with 5 taxa was repeated with the substitution model fixed to HKY and GTR, but estimating the other parts of the model. Results are summarised in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S2 and S3 respectively. Fixing the model to HKY results in severe degradation of accuracy in all parameter and model estimates. The lack of coverage of frequency estimates when the true model has equal frequencies suggests that lack of degrees of freedom in substitution model parameters is compensated by estimating frequencies instead of keeping them equal. So substitution model misspecification can result in considerable misspecification of the remainder of the model. Results when fixing the substitution model to GTR shows a table with results very similar to that of bModelTest, however the substitution model parameters have on average a 95% HPD interval of size 0.17 while that of bModelTest is only 0.13. The extra parameters that need to be estimated for GTR compared to bModelTest result in more uncertain estimates, and thus more uncertainty in the analysis.</p>
    <p>To see the impact of the model set, the experiment was repeated with sampling from all 203 reversible models instead of using only the 30 transition/transversion split models. Results are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4, which do not differ substantially from Table <xref rid="Tab1" ref-type="table">1</xref>. Further, to investigate the effect of the number of taxa and sequence length, the study was repeated with 16 taxa and sequence lengths 1K and 0.5K base pairs long under a relaxed clock as before. Results are summarised in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S5 and S6 respectively. The tables do not show significant differences to Table <xref rid="Tab1" ref-type="table">1</xref> or degradation with decreasing sequence length, so the ability of our Bayesian method to correctly estimate the posterior distribution of substitution models and their parameters does not appear to depend substantially on sequence length or number of taxa.</p>
    <sec id="Sec10">
      <title>Comparison with jModelTest</title>
      <p>We ran jModelTest version 2.1.10 [<xref ref-type="bibr" rid="CR3">3</xref>] on the sequence data used for the last simulation study with 5 taxa (using all reversible models, since only that set is the same for both jModelTest and bModelTest) and the two simulation studies using 16 taxa and compared the substitution model coverage (with settings -BIC -AIC -f -g 4 -i -s 203). For each dataset, we collected the top models according to the AIC and BIC criteria such that the cumulative weight exceeded 95% of the models as shown in the jModelTest output and registered whether the true model was contained in the resulting set. Results are summarised in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7, which shows that both AIC and BIC do not cover the true model 95% of the time as would be desirable. For some combinations the coverage is close to the desirable value (89.4% for AIC with 5 taxa) and for some it is much lower (61.1% for BIC with 0.5K length sequences and 16 taxa). Coverage of both AIC and BIC appears to decrease with increasing number of taxa and decreasing sequence length, although we have not attempted a systematic study. In contrast bModelTest has a coverage of ∼95<italic>%</italic> for all scenarios. jModelTest uses a single maximum likelihood tree and it seems that increasing uncertainty in the true tree (by increasing the number of taxa or decreasing sequence length) results in an increasing chance of incorrect model weights from jModelTest. For BIC, we find substantially less coverage of jModelTest than the around 90% model coverage reported in a previous study [<xref ref-type="bibr" rid="CR3">3</xref>]. This is probably because our data contains a larger amount of uncertainty due to shorter sequences and tree lengths. Another factor is that we use different priors. For example, we use a Beta(1,4) for the proportion of invariable sites, while the previous study [<xref ref-type="bibr" rid="CR3">3</xref>] used a Beta(1,3) that was then truncated to the interval [0.2,0.8], thereby avoiding extreme values which might cause difficulties. To confirm this we produced simulated data more closely matched to previously published experiments (with 40 taxa, sequences of 2500 base pairs, models selected uniformly from the 11 named models, tree length with mean of 6.5, truncated prior for invariable sites, BIC criterion) and obtained a coverage of 93.8% for the 95% credible set and 89.5% coverage by the best fitting model, similar to the results in [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
      <p>In practice, users of Bayesian phylogenetic packages only use the most highly weighted model returned by jModelTest. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7 shows how often the best fitting model according to AIC and BIC matches the true model, which ranges from 73.9% for BIC on 5 taxa to 30.8% for AIC on 0.5K length sequences and 16 taxa, suggesting that the probability of model misspecification using this approach increases with phylogenetic uncertainty.</p>
      <p>To compare the application of bModelTest to jModelTest (with settings -f -i -g 4 -s 11 -AIC -a) we applied both to two real datasets. The first data set used was an alignment from 12 primate species [<xref ref-type="bibr" rid="CR27">27</xref>] (available from BEAST 2 as file examples/nexus/Primates.nex) containing 898 sites. In this case the model recommended by jModelTest was TPM2uf+G and the substitution model TPM2 (=121,323) has the highest posterior probability using bModelTest (21.12% see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix for full list of supported models) when empirical frequencies are used. However, when frequencies are allowed to be estimated, HKY has highest posterior probability (16.19%), while TPM2 (10.25%) has less posterior probability then model 121,123 (14.09%). So, using a heuristic maximum likelihood approach (jModelTest and/or empirical frequencies) makes a difference in the substitution model being preferred. Figure <xref rid="Fig5" ref-type="fig">5</xref> left shows the posterior probabilities for all models, and it shows that the 95% credible set is quite large for the primate data. Figure <xref rid="Fig5" ref-type="fig">5</xref> middle and <xref rid="Fig5" ref-type="fig">5</xref> right show correlation between substitution model rates. The former shows correlation between transversion rate AC (horizontally) and transition rate AG (vertically). One would not expect much correlation between these rates since the model coverage image shows there is little support for these rates to be shared. However, since HKY is supported to a large extent and the rates are constrained to sum to 6, any proposed change in a transition rate requires an opposite change in transversion rates in order for the sum to remain 6. So, when sampling HKY, there is a linear relation between transition and transversion rates, which faintly shows up in the Fig. <xref rid="Fig5" ref-type="fig">5</xref> (middle). Figure <xref rid="Fig5" ref-type="fig">5</xref> (right) shows the correlation between transversion rates AC and AT. Since they are close to each other, a large proportion of the time rate AC and AT are linked, which shows up as a dense set of points on the AC=AT line.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Posterior inference on primate data. Model distribution for primate data using the transition/transversion split models (<italic>left</italic>). Numbers on x-axis correspond to models in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Appendix. The <italic>middle panel</italic> plots rates <italic>A</italic>⇔<italic>C</italic> versus <italic>A</italic>⇔<italic>G</italic> (<italic>middle</italic>) and the <italic>right panel</italic> plots <italic>A</italic>⇔<italic>C</italic> versus <italic>A</italic>⇔<italic>T</italic>
</p></caption><graphic xlink:href="12862_2017_890_Fig5_HTML" id="MO5"/></fig>
</p>
      <p>The second data set used was an alignment of 31 sequences of 9030 sites of coding hepatitis C virus (HCV) from [<xref ref-type="bibr" rid="CR28">28</xref>]. It was split into two partitions, the first containing codon 1 and 2 positions (6020 sites) and the second all codon 3 positions (3010 sites). Figure <xref rid="Fig6" ref-type="fig">6</xref> left show the model distributions for the first partition at the top and second at the bottom. The 95% credible sets contain just 7 and 6 models respectively, much smaller than those for the primate data as one would expect from using longer, more informative sequences. Note that the models preferred for the first partition have transition parameters split while for the second partition models where partitions are shared have higher posterior probability, resulting in quite distinct model coverage images. For the first partition, jModelTest recommends TIM2+I+G. TIM2 is model 121,343, the model with highest posterior probability according to bModelTest, as shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. For the second partition, jModelTest recommends TVM+G, and though TVM is in the 95% credible set, it has a lower posterior probability than model 123421, which gets the highest posterior probability according to bModelTest. Running jModelTest on all 203 models, model 123,451 is preferred by both AIC and BIC, even though 123421 was considered by jModelTest. Again, we see a difference in heuristic likelihood and full Bayesian approaches. The correlation between transition rates <italic>A</italic>⇔<italic>G</italic> and <italic>C</italic>⇔<italic>T</italic> as well as between two transversion rates <italic>A</italic>⇔<italic>C</italic> and <italic>A</italic>⇔<italic>T</italic> are shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref> top middle and right for the first partition and Fig. <xref rid="Fig6" ref-type="fig">6</xref> bottom middle and right for the second. The transition rates <italic>A</italic>⇔<italic>G</italic> and <italic>C</italic>⇔<italic>T</italic> have a posterior probability of being the same of 0.024 in the first partition, whereas the posterior probability is 0.66 in the second partition containing only 3rd positions of the codons. This leads to most models for the first partition distinguishing between <italic>A</italic>⇔<italic>G</italic> and <italic>C</italic>⇔<italic>T</italic>, while for the second partition most models share these rates. For the two transversion rates <italic>A</italic>⇔<italic>C</italic> and <italic>A</italic>⇔<italic>T</italic> the partitions display the opposite relationship, with the second partition preferring to distinguish them. As a result, overall the two partitions only have one model in common in their respective 95% credible sets, but that model (GTR) has quite low posterior probability for both partitions.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Posterior inference on HCV data. Like Fig. <xref rid="Fig5" ref-type="fig">5</xref>, but the data is split into two partitions, the first containing codon positions 1+2 (panel <bold>a</bold>, <bold>b</bold> and <bold>c</bold>) and second containing codon position 3 (panel <bold>d</bold>, <bold>e</bold> and <bold>f</bold>). The partitions support distinctly different site models. The <italic>left panels</italic> show the posterior distribution over models, the <italic>middle panel</italic> plots transition rates <italic>A</italic>⇔<italic>G</italic> versus <italic>C</italic>⇔<italic>T</italic>, and the <italic>right panel</italic> plots transversion rates <italic>A</italic>⇔<italic>C</italic> versus <italic>A</italic>⇔<italic>T</italic>
</p></caption><graphic xlink:href="12862_2017_890_Fig6_HTML" id="MO6"/></fig>
</p>
    </sec>
    <sec id="Sec11">
      <title>Implementation details</title>
      <p>The calculation of the tree likelihood typically consumes the bulk (≫90<italic>%</italic>) of computational time. Note that for a category with invariable sites, the rate is zero, hence only sites that are invariant (allowing for missing data) contribute to the tree likelihood. The contribution is 1 for those sites for any tree and for any parameter setting, so by counting the number of invariant sites, the tree likelihood can be calculated in constant time. Switching between with and without gamma rate heterogeneity means switching between one and <italic>k</italic> rate categories, which requires <italic>k</italic> time as much calculation. Having two tree likelihood objects, one for each of these two scenarios, and a switch object that selects the one required allows use of the BEAST 2 updating mechanism [<xref ref-type="bibr" rid="CR9">9</xref>] so that only the tree likelihood that needs updating is performing calculations. So, jModelTest and bModelTest can, but do not necessarily agree on the most appropriate model to use.</p>
    </sec>
  </sec>
  <sec id="Sec12" sec-type="conclusion">
    <title>Conclusions</title>
    <p>bModelTest is a BEAST 2 package which can be used in any analysis where trees are estimated based on nucleotide sequences, such as multi-species coalescent analysis [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>], various forms of phylogeographical analyses, sampled ancestor analysis [<xref ref-type="bibr" rid="CR31">31</xref>], demographic reconstruction using coalescent [<xref ref-type="bibr" rid="CR32">32</xref>], birth death skyline analysis [<xref ref-type="bibr" rid="CR33">33</xref>], <italic>et cetera</italic>. The GUI support provided through BEAUti makes it easy to set up an analysis with the bModelTest site model: just select bModelTest instead of the default gamma site model from the combo box in the site model panel.</p>
    <p>A promising direction for further research would be to incorporate efficient averaging over partitioning of the alignment [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>] to the site model averaging approach described here.</p>
    <p>bModelTest allows estimation of the site model using a full Bayesian approach, without the need to rely on non-Bayesian tools for selecting the site model.</p>
  </sec>
  <sec id="Sec13">
    <title>Availability and requirements</title>
    <p>Project name: bModelTestProject home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/BEAST2-Dev/bModelTest/">https://github.com/BEAST2-Dev/bModelTest/</ext-link>Operating systems: Windos, OSX, Linux and any other OSProgramming language: JavaOther requirements: requires BEAST 2 (from http://beast2) Licence: LGPL.</p>
  </sec>
  <sec id="Sec14">
    <title>Endnotes</title>
    <p><sup>1</sup> Estimated shape parameters only take values of the shape parameter in account in the portion of the posterior sample where gamma rate heterogeneity indicator is 1.</p>
    <p><sup>2</sup> The estimated proportion of invariable sites only take values of the parameter in account in the posterior sample where the invariant category was present.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec15">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="12862_2017_890_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p>Appendix. (PDF 459 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BEAST</term>
        <def>
          <p>Bayesian evolutionary analysis by sampling trees</p>
        </def>
      </def-item>
      <def-item>
        <term>GTR</term>
        <def>
          <p>general time reversible</p>
        </def>
      </def-item>
      <def-item>
        <term>GUI</term>
        <def>
          <p>graphical user interface</p>
        </def>
      </def-item>
      <def-item>
        <term>HCV</term>
        <def>
          <p>hepatitis C virus</p>
        </def>
      </def-item>
      <def-item>
        <term>HPD</term>
        <def>
          <p>highest probability density</p>
        </def>
      </def-item>
      <def-item>
        <term>LGPL</term>
        <def>
          <p>Lesser general public license</p>
        </def>
      </def-item>
      <def-item>
        <term>MCMC</term>
        <def>
          <p>Markov chain Monte Carlo</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
    <sec id="d29e2868">
      <title>Funding</title>
      <p>This work was funded by a Rutherford fellowship (<ext-link ext-link-type="uri" xlink:href="http://www.royalsociety.org.nz/programmes/funds/rutherford-discovery/">http://www.royalsociety.org.nz/programmes/funds/rutherford-discovery/</ext-link>) from the Royal Society of New Zealand awarded to Prof. Alexei Drummond.</p>
    </sec>
    <sec id="d29e2878">
      <title>Availability of data and material</title>
      <p>See supplementary information for material for the simulation study as well as the primates and HCV analyses. The method is implemented in the bModelTest package of BEAST 2 available from <ext-link ext-link-type="uri" xlink:href="http://beast2.org">http://beast2.org</ext-link>under LGPL license. Source code, installation instructions and documentation can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/BEAST2-Dev/bModelTest">https://github.com/BEAST2-Dev/bModelTest</ext-link>.</p>
    </sec>
    <sec id="d29e2893">
      <title>Authors’ contributions</title>
      <p>RRB designed and developed software. AJD and RRB designed experiments. RRB executed experiments. AJD and RRB analyzed the data. AJD and RRB prepared the figures. AJD and RRB wrote the manuscript. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="d29e2898">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e2903">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e2908">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Crandall</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Modeltest: testing the model of dna substitution</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>817</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/14.9.817</pub-id>
        <?supplied-pmid 9918953?>
        <pub-id pub-id-type="pmid">9918953</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>jModelTest: phylogenetic model averaging</article-title>
        <source>Mol Biol Evol</source>
        <year>2008</year>
        <volume>25</volume>
        <issue>7</issue>
        <fpage>1253</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msn083</pub-id>
        <?supplied-pmid 18397919?>
        <pub-id pub-id-type="pmid">18397919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darriba</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Taboada</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Doallo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>jModelTest 2: more models, new heuristics and parallel computing</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>8</issue>
        <fpage>772</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2109</pub-id>
        <?supplied-pmid 22847109?>
        <pub-id pub-id-type="pmid">22847109</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood phylogenetic estimation from DNA sequences with variable rates over sites: approximate methods</article-title>
        <source>J Mol Evol</source>
        <year>1994</year>
        <volume>39</volume>
        <issue>3</issue>
        <fpage>306</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1007/BF00160154</pub-id>
        <?supplied-pmid 7932792?>
        <pub-id pub-id-type="pmid">7932792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>YX</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood estimation of the heterogeneity of substitution rate among nucleotide sites</article-title>
        <source>Mol Biol Evol</source>
        <year>1995</year>
        <volume>12</volume>
        <issue>4</issue>
        <fpage>546</fpage>
        <lpage>7</lpage>
        <?supplied-pmid 7659011?>
        <pub-id pub-id-type="pmid">7659011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Waddell</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Penny</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Lock</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary trees of apes and humans from DNA sequences</article-title>
        <source>Handbook of Symbolic Evolution</source>
        <year>1996</year>
        <publisher-loc>Oxford</publisher-loc>
        <publisher-name>Clarendon Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Larget</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Alfaro</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Bayesian phylogenetic model selection using reversible jump markov chain monte carlo</article-title>
        <source>Mol Biol Evol</source>
        <year>2004</year>
        <volume>21</volume>
        <issue>6</issue>
        <fpage>1123</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msh123</pub-id>
        <?supplied-pmid 15034130?>
        <pub-id pub-id-type="pmid">15034130</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bouckaert</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Alvarado-Mora</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rebello Pinho</surname>
            <given-names>Ja</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary rates and hbv: issues of rate estimation with bayesian molecular methods</article-title>
        <source>Antivir Ther</source>
        <year>2013</year>
        <volume>18</volume>
        <issue>3 Pt B</issue>
        <fpage>497</fpage>
        <lpage>503</lpage>
        <pub-id pub-id-type="doi">10.3851/IMP2656</pub-id>
        <?supplied-pmid 23792904?>
        <pub-id pub-id-type="pmid">23792904</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Bouckaert</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <source>Bayesian evolutionary analysis with BEAST</source>
        <year>2015</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lartillot</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lepage</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Blanquart</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Phylobayes 3: a bayesian software package for phylogenetic reconstruction and molecular dating</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>17</issue>
        <fpage>2286</fpage>
        <lpage>288</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp368</pub-id>
        <?supplied-pmid 19535536?>
        <pub-id pub-id-type="pmid">19535536</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lartillot</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Philippe</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A bayesian mixture model for across-site heterogeneities in the amino-acid replacement process</article-title>
        <source>Mol Biol Evol</source>
        <year>2004</year>
        <volume>21</volume>
        <issue>6</issue>
        <fpage>1095</fpage>
        <lpage>109</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msh112</pub-id>
        <?supplied-pmid 15014145?>
        <pub-id pub-id-type="pmid">15014145</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Suchard</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Bayesian selection of nucleotide substitution models and their site assignments</article-title>
        <source>Mol Biol Evol</source>
        <year>2013</year>
        <volume>30</volume>
        <issue>3</issue>
        <fpage>669</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mss258</pub-id>
        <?supplied-pmid 23233462?>
        <pub-id pub-id-type="pmid">23233462</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bouckaert</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Heled</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kühnert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vaughan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Suchard</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>BEAST 2: a software platform for bayesian evolutionary analysis</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>4</issue>
        <fpage>1003537</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tavaré</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Some probabilistic and statistical problems in the analysis of dna sequences</article-title>
        <source>Lect Math Life Sci</source>
        <year>1986</year>
        <volume>17</volume>
        <fpage>57</fpage>
        <lpage>86</lpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hasegawa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kishino</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yano</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Dating the human-ape splitting by a molecular clock of mitochondrial dna</article-title>
        <source>J Mol Evol</source>
        <year>1985</year>
        <volume>22</volume>
        <fpage>160</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02101694</pub-id>
        <?supplied-pmid 3934395?>
        <pub-id pub-id-type="pmid">3934395</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pereira</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Freitas</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Fernandes</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pereira</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Costa</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Costa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Máximo</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Macaulay</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Rocha</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Samuels</surname>
            <given-names>DC</given-names>
          </name>
        </person-group>
        <article-title>The diversity present in 5140 human mitochondrial genomes</article-title>
        <source>Am J Hum Genet</source>
        <year>2009</year>
        <volume>84</volume>
        <issue>5</issue>
        <fpage>628</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2009.04.013</pub-id>
        <?supplied-pmid 19426953?>
        <pub-id pub-id-type="pmid">19426953</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>The shapes of neutral gene genealogies in two species: probabilities of monophyly, paraphyly and polyphyly in a coalescent model</article-title>
        <source>Evolution</source>
        <year>2003</year>
        <volume>57</volume>
        <issue>7</issue>
        <fpage>1465</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1111/j.0014-3820.2003.tb00355.x</pub-id>
        <?supplied-pmid 12940352?>
        <pub-id pub-id-type="pmid">12940352</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jukes</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cantor</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Munro</surname>
            <given-names>HN</given-names>
          </name>
        </person-group>
        <article-title>Evolution of protein molecules</article-title>
        <source>Mammaliam Protein Metabolism</source>
        <year>1969</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>
        <source>J Mol Evol</source>
        <year>1981</year>
        <volume>17</volume>
        <fpage>368</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01734359</pub-id>
        <?supplied-pmid 7288891?>
        <pub-id pub-id-type="pmid">7288891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tamura</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Estimation of the number of nucleotide substitutions in the control region of mitochondrial DNA in humans and chimpanzees</article-title>
        <source>Mol Biol Evol</source>
        <year>1993</year>
        <volume>10</volume>
        <fpage>512</fpage>
        <lpage>26</lpage>
        <?supplied-pmid 8336541?>
        <pub-id pub-id-type="pmid">8336541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimura</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Estimation of evolutionary distances between homologous nucleotide sequences</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>1981</year>
        <volume>78</volume>
        <issue>1</issue>
        <fpage>454</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.78.1.454</pub-id>
        <?supplied-pmid 6165991?>
        <pub-id pub-id-type="pmid">6165991</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <mixed-citation publication-type="other">Posada D. Using MODELTEST and PAUP* to select a model of nucleotide substitution. Curr Protoc Bioinforma. 2003;6–5.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Green</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Reversible jump markov chain monte carlo computation and bayesian model determination</article-title>
        <source>Biometrika</source>
        <year>1995</year>
        <volume>82</volume>
        <fpage>711</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/82.4.711</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pagel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meade</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Bayesian analysis of correlated evolution of discrete characters by reversible-jump markov chain monte carlo</article-title>
        <source>Am Nat</source>
        <year>2006</year>
        <volume>167</volume>
        <issue>6</issue>
        <fpage>808</fpage>
        <lpage>25</lpage>
        <?supplied-pmid 16685633?>
        <pub-id pub-id-type="pmid">16685633</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dawid</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>The well-calibrated bayesian</article-title>
        <source>J Am Stat Assoc</source>
        <year>1982</year>
        <volume>77</volume>
        <issue>379</issue>
        <fpage>605</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1982.10477856</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>SYW</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Relaxed phylogenetics and dating with confidence</article-title>
        <source>PLoS Biol</source>
        <year>2006</year>
        <volume>4</volume>
        <issue>5</issue>
        <fpage>88</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0040088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hayasaka</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gojobori</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Horai</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Molecular phylogeny and evolution of primate mitochondrial dna</article-title>
        <source>Mol Biol Evol</source>
        <year>1988</year>
        <volume>5</volume>
        <issue>6</issue>
        <fpage>626</fpage>
        <lpage>44</lpage>
        <?supplied-pmid 3146681?>
        <pub-id pub-id-type="pmid">3146681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gray</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lemey</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Salemi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Katzourakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pybus</surname>
            <given-names>OG</given-names>
          </name>
        </person-group>
        <article-title>The mode and tempo of hepatitis c virus evolution within and among hosts</article-title>
        <source>BMC Evol Biol</source>
        <year>2011</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>131</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-11-131</pub-id>
        <?supplied-pmid 21595904?>
        <pub-id pub-id-type="pmid">21595904</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heled</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Bayesian inference of species trees from multilocus data</article-title>
        <source>Mol Biol Evol</source>
        <year>2010</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>570</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp274</pub-id>
        <?supplied-pmid 19906793?>
        <pub-id pub-id-type="pmid">19906793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ogilvie</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Heled</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Computational performance and statistical accuracy of *beast and comparisons with other methods</article-title>
        <source>Syst Biol</source>
        <year>2016</year>
        <volume>65</volume>
        <issue>3</issue>
        <fpage>381</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/syv118</pub-id>
        <?supplied-pmid 26821913?>
        <pub-id pub-id-type="pmid">26821913</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gavryushkina</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Bayesian inference of sampled ancestor trees for epidemiology and fossil calibration</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>12</issue>
        <fpage>1003919</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heled</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Bayesian inference of population size history from multiple loci</article-title>
        <source>BMC Evol Biol</source>
        <year>2008</year>
        <volume>8</volume>
        <fpage>289</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-8-289</pub-id>
        <?supplied-pmid 18947398?>
        <pub-id pub-id-type="pmid">18947398</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stadler</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kühnert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bonhoeffer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Birth-death skyline plot reveals temporal changes of epidemic spread in hiv and hepatitis c virus (hcv)</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2013</year>
        <volume>110</volume>
        <issue>1</issue>
        <fpage>228</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1207965110</pub-id>
        <?supplied-pmid 23248286?>
        <pub-id pub-id-type="pmid">23248286</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
