<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4547613</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv275</article-id>
    <article-id pub-id-type="publisher-id">btv275</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RVD2: an ultra-sensitive variant detection model for low-depth heterogeneous next-generation sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>He</surname>
          <given-names>Yuting</given-names>
        </name>
        <xref ref-type="aff" rid="btv275-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Fan</given-names>
        </name>
        <xref ref-type="aff" rid="btv275-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Flaherty</surname>
          <given-names>Patrick</given-names>
        </name>
        <xref ref-type="aff" rid="btv275-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv275-AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btv275-COR1">*</xref>
      </contrib>
      <aff id="btv275-AFF1"><sup>1</sup>Department of Biomedical Engineering, Worcester Polytechnic Institute, Worcester and</aff>
      <aff id="btv275-AFF2"><sup>2</sup>Department of Mathematics and Statistics, University of Massachusetts, Amherst, MA, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv275-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="btv275-FN1">
        <p>Associate Editor: Inanc Birol</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>9</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>4</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>4</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>17</issue>
    <fpage>2785</fpage>
    <lpage>2793</lpage>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>6</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>3</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>4</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Next-generation sequencing technology is increasingly being used for clinical diagnostic tests. Clinical samples are often genomically heterogeneous due to low sample purity or the presence of genetic subpopulations. Therefore, a variant calling algorithm for calling low-frequency polymorphisms in heterogeneous samples is needed.</p>
      <p><bold>Results:</bold> We present a novel variant calling algorithm that uses a hierarchical Bayesian model to estimate allele frequency and call variants in heterogeneous samples. We show that our algorithm improves upon current classifiers and has higher sensitivity and specificity over a wide range of median read depth and minor allele fraction. We apply our model and identify 15 mutated loci in the PAXP1 gene in a matched clinical breast ductal carcinoma tumor sample; two of which are likely loss-of-heterozygosity events.</p>
      <p><bold>Availability and implementation:</bold><ext-link ext-link-type="uri" xlink:href="http://genomics.wpi.edu/rvd2/">http://genomics.wpi.edu/rvd2/</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>pjflaherty@wpi.edu</email>
      </p>
      <p><bold>Supplementary information</bold>: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv275/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Next-generation sequencing (NGS) technology has enabled the systematic interrogation of the genome for a fraction of the cost of traditional assays (<xref rid="btv275-B20" ref-type="bibr">Koboldt <italic>et</italic>
<italic>al.</italic>, 2013</xref>). Protocol and platform engineering improvements have enabled the generation of <inline-formula><mml:math id="MM1"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> bases of sequence data in 27 h for ∼$1000 (<xref rid="btv275-B27" ref-type="bibr">Quail <italic>et</italic>
<italic>al.</italic>, 2012</xref>). As a result, NGS is increasingly being used as a general platform for research assays for methylation state (<xref rid="btv275-B21" ref-type="bibr">Laird, 2010</xref>), DNA mutations (<xref rid="btv275-B1" ref-type="bibr">1000 Genomes Project Consortium <italic>et</italic>
<italic>al.</italic>, 2012</xref>), copy number variation (<xref rid="btv275-B2" ref-type="bibr">Alkan <italic>et</italic>
<italic>al.</italic>, 2009</xref>), promoter occupancy (<xref rid="btv275-B26" ref-type="bibr">Ouyang <italic>et</italic>
<italic>al.</italic>, 2009</xref>) and others (<xref rid="btv275-B29" ref-type="bibr">Rivera and Ren, 2013</xref>). NGS diagnostics are being translated to clinical applications including non-invasive fetal diagnostics (<xref rid="btv275-B18" ref-type="bibr">Kitzman <italic>et</italic>
<italic>al.</italic>, 2012</xref>), infectious disease diagnostics (<xref rid="btv275-B5" ref-type="bibr">Capobianchi <italic>et</italic>
<italic>al.</italic>, 2012</xref>), cancer diagnostics (<xref rid="btv275-B24" ref-type="bibr">Navin <italic>et</italic>
<italic>al.</italic>, 2010</xref>), and human microbiome analysis (<xref rid="btv275-B34" ref-type="bibr">The Human Microbiome Project Consortium, 2013</xref>).</p>
    <p>Increasingly, NGS is being used to interrogate mutations in heterogeneous clinical samples. For example, NGS-based non-invasive fetal DNA testing uses maternal blood sample to sequence the minority fraction of cell-free fetal DNA (<xref rid="btv275-B11" ref-type="bibr">Fan <italic>et</italic>
<italic>al.</italic>, 2008</xref>). Infectious diseases such as HIV and influenza may contain many genetically heterogeneous sub-populations (<xref rid="btv275-B13" ref-type="bibr">Flaherty <italic>et</italic>
<italic>al.</italic>, 2011</xref>; <xref rid="btv275-B14" ref-type="bibr">Ghedin <italic>et</italic>
<italic>al.</italic>, 2010</xref>). DNA sequencing of individual regions of a solid tumor has revealed genetic heterogeneous within an individual sample (<xref rid="btv275-B24" ref-type="bibr">Navin <italic>et</italic>
<italic>al.</italic>, 2010</xref>). Importantly, accounting for technical errors can drastically improve performance (<xref rid="btv275-B36" ref-type="bibr">Zagordi <italic>et</italic>
<italic>al.</italic>, 2010</xref>).</p>
    <p>However, the primary statistical tools for calling variants from NGS data are optimized for homogeneous samples. Samtools and GATK use a naive Bayesian decision rule to call variants (<xref rid="btv275-B9" ref-type="bibr">DePristo <italic>et</italic>
<italic>al.</italic>, 2011</xref>; <xref rid="btv275-B22" ref-type="bibr">Li, 2011</xref>). GATK involves more sophisticate pre- and post-processing steps wherein the genotype prior is fixed and constant across all loci and the likelihood of an allele at a locus is a function of the Phred score (<xref rid="btv275-B23" ref-type="bibr">McKenna <italic>et</italic>
<italic>al.</italic>, 2010</xref>).</p>
    <p>Recently, some have developed algorithms to call low-frequency or rare variants in heterogeneous samples. <xref rid="btv275-B35" ref-type="bibr">Yau <italic>et</italic>
<italic>al.</italic> (2010)</xref> developed a Bayesian framework which can model the normal DNA contamination and intra-tumor heterogeneity by parameterizing the normal genotype cell proportion at each SNP. VarScan2 combines algorithmic heuristics to call genotypes in the tumor and normal sample pileup data and then applies a Fisher’s exact test on the read count data to detect a significant difference in the genotype calls (<xref rid="btv275-B19" ref-type="bibr">Koboldt <italic>et</italic>
<italic>al.</italic>, 2012</xref>). Strelka uses a hierarchical Bayesian approach to model the joint distribution of the allele frequency in the tumor and normal samples at each locus (<xref rid="btv275-B31" ref-type="bibr">Saunders <italic>et</italic>
<italic>al.</italic>, 2012</xref>). With the joint distribution available, one is able to identify locations with dissimilar allele frequencies. muTect uses a Bayesian posterior probability in its decision rule to evaluate the likelihood of a mutation (<xref rid="btv275-B6" ref-type="bibr">Cibulskis <italic>et</italic>
<italic>al.</italic>, 2013</xref>). RVD uses a hierarchical Bayesian model to capture the error structure of the data and call variants (<xref rid="btv275-B8" ref-type="bibr">Cushing <italic>et al.</italic>, 2013</xref>; <xref rid="btv275-B13" ref-type="bibr">Flaherty <italic>et</italic>
<italic>al.</italic>, 2011</xref>). That algorithm requires a very high read depth to estimate the sequencing error rate and call variants.</p>
    <p>Several studies have compared the relative performance of these algorithms. <xref rid="btv275-B32" ref-type="bibr">Spencer <italic>et</italic>
<italic>al.</italic> (2013)</xref> demonstrated that VarScan-somatic performed the best when comparing SAMtools, GATK and SPLINTER for detecting minor allele fractions (MAFs) of 1–8%, with &gt;500 coverage required for optimal performance. However, <xref rid="btv275-B32" ref-type="bibr">Spencer <italic>et</italic>
<italic>al.</italic> (2013)</xref> also highlighted the fact that VarScan2 yielded more false positives at high read depth. <xref rid="btv275-B33" ref-type="bibr">Stead <italic>et</italic>
<italic>al.</italic> (2013)</xref> showed that VarScan-somatic outperformed Strelka and had performance on-par with muTect in detecting a 5% MAF for read depths between 100 and 1000.</p>
    <p>The remainder of this article is organized as follows. In the next section we describe the statistical model structure of our new algorithm, RVD2. Then, we derive a sampling algorithm for computing the posterior distribution over latent variables in the model and use those samples in a Bayesian posterior distribution hypothesis test to call variants. We compare the performance of RVD2 to several other variant calling algorithms for a range of read depths and minor allele fractions. Finally, we show that RVD2 is able to call variants on a heterogeneous clinical sample and identify two novel loss-of-heterozygosity events.</p>
  </sec>
  <sec>
    <title>2 Model Structure</title>
    <p>RVD2 uses a two-stage approach for detecting rare variants. First, it estimates the parameters of a hierarchical Bayesian model under two sequencing datasets: one from the sample of interest (case) and one from a known reference sample (control). Then, it tests for a significant difference between key model parameters in the case and control samples and returns called variant positions.</p>
    <p><xref ref-type="fig" rid="btv275-F1">Figure 1</xref> shows a graphical representation of the RVD2 statistical model. In this graphical model framework, a shaded node represents an observed random variable, an unshaded node represents an unobserved or latent random variable and a directed edge represents a functional dependency between the two connected nodes (<xref rid="btv275-B17" ref-type="bibr">Jordan, 2004</xref>). A rounded box or ‘plate’ represents replication of the nodes within the plate. The graphical model framework connects graph theory and probability theory in a way that facilitates algorithmic methods for statistical inference.
<fig id="btv275-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>RVD2 graphical model</p></caption><graphic xlink:href="btv275f1p"/></fig>
</p>
    <p>For a given sample, the observed data consist of two matrices <inline-formula><mml:math id="MM2"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM3"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <italic>r<sub>ji</sub></italic> is the number of reads with a non-reference base at location <italic>j</italic> in experimental replicate <italic>i</italic> and <italic>n<sub>ji</sub></italic> is the total number of reads at location <italic>j</italic> in replicate <italic>i.</italic>
<italic>J</italic> is the region of interest length and <italic>N</italic> is the number of technical replicates in the sample. Technical replicates are used to establish experimental variability in NGS procedure (<xref rid="btv275-B30" ref-type="bibr">Robasky <italic>et</italic>
<italic>al.</italic>, 2013</xref>), though multiple replicates are not necessary for RVD2.</p>
    <p>The model generative process given hyperparameters <inline-formula><mml:math id="MM4"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <italic>M</italic> is as follows:
<list list-type="order"><list-item><p>For each location <italic>j</italic>:
<list list-type="alpha-lower"><list-item><p>Draw an error rate <inline-formula><mml:math id="MM6"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p>For each replicate <italic>i</italic>:
<list list-type="order"><list-item><p>Draw <inline-formula><mml:math id="MM5"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p></list-item><list-item><p>Draw <inline-formula><mml:math id="MM7"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p></list-item></list></p></list-item></list></p></list-item></list></p>
    <p>The generative process involves several hyperparameters: <italic>μ</italic><sub>0</sub>, a global error rate; <italic>M</italic><sub>0</sub>, a global precision; <italic>μ<sub>j</sub></italic>, a local error rate; and <italic>M<sub>j</sub></italic>, a local precision. The global error rate, <italic>μ</italic><sub>0</sub>, estimates the expected error rate across all locations. The global precision, <italic>M</italic><sub>0</sub>, estimates the variation in the error rate across locations. The local error rate, <italic>μ<sub>j</sub></italic>, estimates the expected error rate across replicates at location <italic>j.</italic> The local precision, <italic>M<sub>j</sub></italic>, estimates the variation in the error rate across replicates at location <italic>j.</italic></p>
    <p>RVD2 has three levels of sampling. First, a global error rate and global precision are chosen once for the entire dataset. Then, at each location, a local precision is chosen and a local error rate is sampled from a Beta distribution. Finally, the error rate for replicate <italic>i</italic> at location <italic>j</italic> is drawn from a Beta distribution and the number of non-reference reads is drawn from a binomial.</p>
    <p>RVD2 hierarchically partitions sources of variation in the data. The distribution <inline-formula><mml:math id="MM8"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> models the variation due to sampling the pool of DNA molecules on the sequencer. The distribution <inline-formula><mml:math id="MM10"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> models the variation due to experimental reproducibility. The variation in error rate due to sequence context is modeled by <inline-formula><mml:math id="MM9"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Importantly, increasing the read depth <italic>n<sub>ji</sub></italic> only reduces the sampling error, but does nothing to reduce experimental variation or variation due to sequence context.</p>
    <p>The joint distribution over the latent and observed variables for data at location <italic>j</italic> in replicate <italic>i</italic> given the parameters can be factorized as
<disp-formula id="btv275-M1"><label>(1)</label><mml:math id="MM11"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:malignmark/><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:malignmark/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:malignmark/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:malignmark/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where <bold>B</bold><inline-formula><mml:math id="MM12"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the beta function.</p>
    <p>The log-likelihood of the dataset is
<disp-formula id="btv275-M2"><label>(2)</label><mml:math id="MM13"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
RVD2 improves on RVD in three ways. First, RVD2 has a <inline-formula><mml:math id="MM14"><mml:mrow><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> prior on local error rate <italic>μ<sub>j</sub></italic>, which captures the global across-position error rate. The prior distribution allows <italic>μ<sub>j</sub></italic> to share information across adjacent positions and allows RVD2 to handle low read depths. Second, RVD2 handles multiple replicates in case samples. Third, RVD2 has a more accurate Bayesian hypothesis testing method compared with the normal <italic>z</italic>-test in RVD. We show a performance comparison between RVD and RVD2 in Section 5.2.</p>
  </sec>
  <sec>
    <title>3 Inference and Hypothesis Testing</title>
    <p>The primary object of inference in this model is the joint posterior distribution function over the latent variables,
<disp-formula id="btv275-M3"><label>(3)</label><mml:math id="MM15"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where the parameters are <inline-formula><mml:math id="MM16"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mstyle displaystyle="true"><mml:mover><mml:mo>=</mml:mo><mml:mo>Δ</mml:mo></mml:mover></mml:mstyle><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
    <p>The Beta distribution over <italic>μ<sub>j</sub></italic> is conjugate to the Binomial distribution over <italic>θ<sub>ji</sub></italic>, so we can write the posterior distribution as a Beta distribution. However, there is not a closed form for the product of a Beta distribution with another Beta distribution, so exact inference is intractable.</p>
    <p>Instead, we have developed a Metropolis-within-Gibbs (MwG) approximate inference algorithm shown in Algorithm 1. First, the hyperparameters are initialized using method-of-moments (MoM). Given those hyperparameter estimates, we sample from the marginal posterior distribution for <italic>μ<sub>j</sub></italic> given its Markov blanket using a Metropolis–Hasting (M–H) rejection sampling rule. Finally, we sample from the marginal posterior distribution for <italic>θ<sub>ji</sub></italic> given its Markov blanket. Samples from <italic>θ<sub>ji</sub></italic> can be drawn from the posterior distribution directly because the prior and likelihood form a conjugate pair. This sampling procedure is repeated until the chain converges to a stationary distribution and then we draw samples from the posterior distribution over latent variables.<statement><title><bold>Algorithm 1</bold> Metropolis-within-Gibbs Algorithm</title><p>1: Initialize <italic>θ</italic>, <italic>μ</italic>, <italic>M</italic>, <italic>μ</italic><sub>0</sub>, <italic>M</italic><sub>0</sub></p><p>2: <bold>repeat</bold></p><p>3: <bold>for</bold> each location j <bold>do</bold></p><p>4: Draw T samples from <inline-formula><mml:math id="MM17"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using M–H</p><p>5: Set <italic>μ<sub>j</sub></italic> to the sample median for the T samples</p><p>6:  <bold>for</bold> each replicate i <bold>do</bold></p><p>7:   Sample from <inline-formula><mml:math id="MM18"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></p><p>8:  <bold>end</bold>
<bold>for</bold></p><p>9: <bold>end</bold>
<bold>for</bold></p><p>10: <bold>until</bold> sample size sufficient</p></statement></p>
    <sec>
      <title>3.1 Initialization</title>
      <p>The initial values for the model parameters and latent variables are obtained by a MoM procedure. MoM works by setting the population moment equal to the sample moment. A system of equations is formed such that the number of moment equations is equal to the number of unknown parameters and the equations are solved simultaneously to give the parameter estimates. We simply start with the data matrices <italic>r</italic> and <italic>n</italic> and work up the hierarchy of the graphical model solving for the parameters of each conditional distribution in turn.</p>
      <p>We present the initial parameter estimates here and provide the derivations in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv275/-/DC1">Supplementary Information</ext-link>. The MoM estimate for replicate-level parameters are <inline-formula><mml:math id="MM19"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. The estimates for the local parameters are <inline-formula><mml:math id="MM20"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM21"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The estimates for the global parameters are <inline-formula><mml:math id="MM22"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:mfrac><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM23"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:mfrac><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>3.2 Sampling from <inline-formula><mml:math id="MM24"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></title>
      <p>Samples from the posterior distribution <inline-formula><mml:math id="MM25"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are drawn analytically because of the Bayesian conjugacy between the prior <inline-formula><mml:math id="MM26"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the likelihood <inline-formula><mml:math id="MM27"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The posterior distribution is
<disp-formula id="btv275-M4"><label>(4)</label><mml:math id="MM28"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
    </sec>
    <sec>
      <title>3.3 Sampling from <inline-formula><mml:math id="MM29"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></title>
      <p>The posterior distribution over <italic>μ<sub>j</sub></italic> given its Markov blanket is
<disp-formula id="btv275-M5"><label>(5)</label><mml:math id="MM30"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
Since the prior, <inline-formula><mml:math id="MM31"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, is not conjugate to the likelihood, <inline-formula><mml:math id="MM32"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we cannot write an analytical form for the posterior distribution. Instead, we sample from the posterior distribution using the M–H algorithm.</p>
      <p>A candidate sample is generated from the symmetric proposal distribution <inline-formula><mml:math id="MM33"><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script" class="calligraphy">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="MM34"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the <italic>p</italic>th from the posterior distribution. The acceptance probability is then
<disp-formula id="btv275-M6"><label>(6)</label><mml:math id="MM35"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow/><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow/><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
We fixed the proposal distribution variance for all the M–H steps within a Gibbs iteration to <inline-formula><mml:math id="MM36"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="MM37"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM38"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> otherwise, where <inline-formula><mml:math id="MM39"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the MoM estimator of <italic>μ<sub>j</sub>.</italic> Though it is not theoretically necessary, we have found that the algorithm performance improves when we take the median of five or more M–H samples in single Gibbs step for each position.</p>
      <p>We resample from the proposal if the sample is outside of the support of the posterior distribution. We typically discard 20% of the sample for burn-in and thin the chain by a factor of 2 to reduce autocorrelation among samples. Since, each position <italic>j</italic> is exchangeable given the global hyperparameters, <italic>μ</italic><sub>0</sub> and <italic>M</italic><sub>0</sub>, this sampling step can be distributed across up to <italic>J</italic> processors.</p>
    </sec>
    <sec>
      <title>3.4 Posterior distribution test</title>
      <sec>
        <title>3.4.1 Posterior difference test</title>
        <p>MwG provides samples from the posterior distribution of <italic>μ<sub>j</sub></italic> given the case or control data. For notational simplicity, we define the random variables associated with these two distributions <inline-formula><mml:math id="MM40"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>case</mml:mtext></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM41"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and the associated samples as <inline-formula><mml:math id="MM42"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>case</mml:mtext></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM43"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
        <p>A variant is called if <inline-formula><mml:math id="MM44"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>case</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> with high confidence,
<disp-formula id="btv275-M7"><label>(7)</label><mml:math id="MM45"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>case</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>MwG</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>MwG</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mo> </mml:mo></mml:mstyle><mml:msub><mml:mn mathvariant="double-struck">1</mml:mn><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mtext>case</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>τ</italic> is a detection threshold and <inline-formula><mml:math id="MM46"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula> is a confidence level. We draw a sample from the posterior distribution <inline-formula><mml:math id="MM47"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow></mml:msubsup><mml:mstyle displaystyle="true"><mml:mover><mml:mo>=</mml:mo><mml:mo>Δ</mml:mo></mml:mover></mml:mstyle><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>case</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> by simple random sampling with replacement from <inline-formula><mml:math id="MM48"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>case</mml:mtext></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM49"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
        <p>The threshold, <italic>τ</italic>, may be set to 0 or optimized for a given median depth and desired MAF detection limit. The optimal <italic>τ</italic> maximizes the Matthews Correlation Coefficient (MCC),
<disp-formula id="btv275-M8"><label>(8)</label><mml:math id="MM50"><mml:mrow><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>arg</mml:mi><mml:mo>⁡</mml:mo><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mi>τ</mml:mi></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtext>MCC</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
While we are able to compute the optimal <italic>τ</italic> threshold for a test dataset, in general we would not have access to <inline-formula><mml:math id="MM51"><mml:mrow><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. With sufficient training data, one would be able to develop a lookup table or calibration curve to set <italic>τ</italic> based on read depth and MAF level of interest. Absent this information we set <italic>τ</italic> = 0.</p>
      </sec>
      <sec>
        <title>3.4.2 Posterior somatic test</title>
        <p>We use a two-sided posterior difference test with control and case paired samples to identify somatic mutations. We consider scenarios when the case(tumor) error rate is lower than the control(germline) error rate (e.g. loss-of-heterozygosity) as well as scenarios when the case(tumor) error rate is higher than the control(germline) error rate (e.g. homozygous somatic mutation). The two hypothesis tests are then <inline-formula><mml:math id="MM52"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>case</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM53"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>case</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula>. We typically set the threshold <italic>τ</italic> to 0.</p>
      </sec>
      <sec>
        <title>3.4.3 Posterior germline test</title>
        <p>We use a one-sided posterior distribution test with a single control sample to identify germline mutations. We call a germline mutation if <inline-formula><mml:math id="MM54"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:math></inline-formula> with high confidence,
<disp-formula id="btv275-M9"><label>(9)</label><mml:math id="MM55"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>MwG</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>MwG</mml:mtext></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mo> </mml:mo></mml:mstyle><mml:msub><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      </sec>
    </sec>
    <sec>
      <title>3.5 <inline-formula><mml:math id="MM56"><mml:mrow><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> test for non-uniform base distribution</title>
      <p>An abundance of non-reference bases at a position called by the posterior density test may be due to a true mutation or due to a random sequencing error; we would like to differentiate these two scenarios. We assume non-reference read counts caused by a non-biological mechanism results in a uniform distribution over three non-reference bases. In contrast, the distribution of counts among three non-reference bases caused by biological mutation would not be uniform.</p>
      <p>We use a <inline-formula><mml:math id="MM57"><mml:mrow><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> goodness-of-fit test on a multinomial distribution over the non-reference bases to distinguish these two possible scenarios. The null hypothesis is <inline-formula><mml:math id="MM58"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="MM59"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>. <xref rid="btv275-B7" ref-type="bibr">Cressie and Read (1984)</xref> identified a power-divergence family of statistics, indexed by <italic>λ</italic>, that includes as special cases Pearson’s <inline-formula><mml:math id="MM60"><mml:mrow><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> statistic, the log likelihood ratio statistic <inline-formula><mml:math id="MM61"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, the Freeman–Tukey statistic <inline-formula><mml:math id="MM62"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and the Neyman modified statistic <inline-formula><mml:math id="MM63"><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The test statistic is
<disp-formula id="btv275-M10"><label>(10)</label><mml:math id="MM64"><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mi>λ</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM65"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the observed frequency for non-reference base <italic>k</italic> at position <italic>j</italic> in replicate <italic>i</italic> and <inline-formula><mml:math id="MM66"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the corresponding expected frequency under the null hypothesis. <xref rid="btv275-B7" ref-type="bibr">Cressie and Read (1984)</xref> recommended <inline-formula><mml:math id="MM67"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> when no knowledge of the alternative distribution is available and we choose that value.</p>
      <p>We control for multiple hypothesis testing in two ways. We use Fisher’s combined probability test (<xref rid="btv275-B12" ref-type="bibr">Fisher <italic>et</italic>
<italic>al.</italic>, 1970</xref>) to combine the <italic>P</italic>-values for <italic>N</italic> replicates into a single <italic>P</italic>-value at position <italic>j</italic>,
<disp-formula id="btv275-M11"><label>(11)</label><mml:math id="MM68"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
<xref ref-type="disp-formula" rid="btv275-M11">Equation (11)</xref> gives a test statistic that follows a <inline-formula><mml:math id="MM69"><mml:mrow><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> distribution with 2<italic>N</italic> degrees of freedom when the null hypothesis is true. If the sample average depth is higher than 500, we use the Benjamini–Hochberg method to control the family-wise error rate over positions that have been called by the posterior distribution test (<xref rid="btv275-B4" ref-type="bibr">Benjamini and Hochberg, 1995</xref>; <xref rid="btv275-B10" ref-type="bibr">Efron, 2010</xref>). The average depth threshold is set because Benjamini–Hochberg method is a highly conservative method and will reject many true calls when the read depth is not high enough.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Datasets</title>
    <p>We used two independent datasets to evaluate the performance of RVD2 and compare it with other variant calling algorithms. The synthetic DNA sequence data provide true positive and true negative positions as well as define minor allele fractions. The HCC1187 data is used to test the performance on a sequenced cancer genome with less than 100% tumor purity.</p>
    <sec>
      <title>4.1 Synthetic DNA sequence data</title>
      <sec>
        <title>4.1.1 Experimental methods</title>
        <p>Two 400 bp DNA sequences (including linkers) that are identical except at 14 loci with variant bases were synthesized and clonally isolated. The samples with the mutations are taken as the case sample and the sample without the mutations is taken as the control. Aliquots of the case and control DNA were mixed at defined fractions to yield defined minor allele fractions (MAFs) of 0.1, 0.3, 1, 10 and 100%. Paired-end sequencing was performed on an Illumina GAIIx sequencer (Illumina SCS 2.8) with real-time image analysis and base calling (Illumina RTA 2.8). Eland II (from Illumina pipeline version 1.6) was used with the default parameters to perform sequence alignment to the 300-bp synthetic DNA construct. More details of the experimental protocol are available from the original publication (<xref rid="btv275-B13" ref-type="bibr">Flaherty <italic>et</italic>
<italic>al.</italic>, 2011</xref>). As shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv275/-/DC1">Supplementary Table S1</ext-link>, each sample has ∼1 000 000 35 bp paired end reads.</p>
      </sec>
      <sec>
        <title>4.1.2 Pre-processing methods</title>
        <p>The reads were aligned with Eland as described previously. We then ran samtools mpileup with the -C50 option to filter for high mapping quality reads. To simulate lower coverage data while retaining the error structure of real NGS data, BAM files for the synthetic DNA data were downsampled <inline-formula><mml:math id="MM70"><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1000</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM71"><mml:mrow><mml:mn>10</mml:mn><mml:mo> </mml:mo><mml:mn>000</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> using Picard v1.96. The final dataset contains read pairs for three replicates of each case and pairs of reads three replicates for the control sample giving <italic>N</italic> = 6 replicates for the control and each MAF level.</p>
      </sec>
    </sec>
    <sec>
      <title>4.2 HCC1187 sequence data</title>
      <sec>
        <title>4.2.1 Experimental methods</title>
        <p>The HCC1187 dataset is a well-recognized baseline dataset from Illumina for evaluating sequence analysis algorithms (<xref rid="btv275-B16" ref-type="bibr">Howarth <italic>et</italic>
<italic>al.</italic>, 2011</xref>, <xref rid="btv275-B15" ref-type="bibr">2007</xref>; <xref rid="btv275-B25" ref-type="bibr">Newman <italic>et al.</italic>, 2013</xref>). The HCC1187 cell line was derived from epithelial cells from primary breast tissue from a 41–year-old adult with TNM stage IIA primary ductal carcinoma. The estimated tumor purity was reported to be 0.8. Matched normal cells were derived from lymphoblastoid cells from peripheral blood. Sequencing libraries were prepared according to the protocol described in the original technical report (<xref rid="btv275-B3" ref-type="bibr">Allen, 2013</xref>).</p>
      </sec>
      <sec>
        <title>4.2.2 Pre-processing methods</title>
        <p>The raw FASTQ read files were aligned to hg19 using the Isaac aligner to generate BAM files (<xref rid="btv275-B28" ref-type="bibr">Raczy <italic>et</italic>
<italic>al.</italic>, 2013</xref>). The aligned data had an average read depth of 40× for the normal sample and 90× for the tumor sample with about 96% coverage with 10 or more reads. We used samtools mpileup to generate pileup files using hg19 as reference sequence (<xref rid="btv275-B24" ref-type="bibr">Navin <italic>et</italic>
<italic>al.</italic>, 2010</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>5 Results</title>
    <p>We tested RVD2 using synthetic DNA and data from the HCC1187 primary ductal carcinoma sample. The inference algorithm parameters were set to yield 4000 Gibbs samples with a 20% burn-in and <inline-formula><mml:math id="MM72"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> thinning rate for a final total of 1600 samples. We drew 1000 samples from <inline-formula><mml:math id="MM73"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>case</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> to estimate the posterior probability of a variant.</p>
    <p>We performed the posterior difference test to identify mutations in the haploid synthetic data. We set the threshold <italic>τ</italic> = 0 and the size of the test <inline-formula><mml:math id="MM74"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
    <p>For the HCC1187 dataset, we identified both somatic and germline mutations. In the posterior somatic test, we set the threshold <italic>τ</italic> = 0 and the size of the test <inline-formula><mml:math id="MM75"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>. In the posterior germline test, we set the threshold <inline-formula><mml:math id="MM76"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> considering the low average coverage (40×). The size of the test is set at <inline-formula><mml:math id="MM77"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:math></inline-formula>. We performed the <inline-formula><mml:math id="MM78"><mml:mrow><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> non-uniformity test after the posterior density tests.</p>
    <sec>
      <title>5.1 Performance by read depth</title>
      <p>We generated receiver-operating characteristic curves (ROCs) for a range of median read depth and a range of MAFs. For these ROCs, we used the posterior density test without the <inline-formula><mml:math id="MM79"><mml:mrow><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> test to evaluate the performance of posterior density test individually. <xref ref-type="fig" rid="btv275-F2">Figure 2</xref> shows ROCs generated by varying the threshold <italic>τ</italic> with a fixed <inline-formula><mml:math id="MM80"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="btv275-F2">Figure 2</xref>a shows ROC curves for a true 0.1% MAF for a range of median coverage depths. At the lowest depth the sensitivity and specificity is no better than random. However, we would not expect to be able to call a 1 in 1000 variant base with a coverage of only 43. The performance improves monotonically with read depth. <xref ref-type="fig" rid="btv275-F2">Figure 2</xref>b and c shows a similar relationship between coverage depth and accuracy for higher MAFs.
<fig id="btv275-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>ROCs varying read depth showing detection performance</p></caption><graphic xlink:href="btv275f2p"/></fig>
</p>
      <p>We measured the computational time for RVD2 varying the number of Gibbs sampling steps and the median read depth for the 400 bp synthetic dataset. In brief, on a 2.4-GHz processor it took ∼13 min per 1000 Gibbs samples to fit the model. The computational time is independent of the median read depth due to the model structure; the same performance was observed for a median read depth of 130 and 40 000. As stated previously, due to the independence structure of the model, we are able to perform the sampling step for each location in parallel greatly decreasing the computational time. The memory requirement is roughly the size of the gene sequence times the number of Gibbs samples. Complete timing results without parallelization are shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv275/-/DC1">Supplementary Section 8</ext-link>.</p>
    </sec>
    <sec>
      <title>5.2 Empirical performance compared with other algorithms</title>
      <p>We compare the empirical performance of RVD2 to other variant calling algorithms using the synthetic DNA dataset by the false discovery rate (FDR) and sensitivity/specificity. Among these algorithms, Samtools and GATK are optimized for homogeneous samples, while RVD, VarScan2-somatic, Strelka and muTect have good performance to call variants in heterogeneous samples. In research applications, the FDR is a more relevant performance metric because the aim is generally to identify interesting variants for follow-up. The sensitivity/specificity metric is more relevant in clinical applications where one is more interested in correctly calling all of the positive variants and none of the negatives. GATK, Varscan2, Strelka and muTect are only able to make use of one case and one control sample, so we provide results of RVD2 with the same data set (<italic>N</italic> = 1) for comparison.</p>
      <p>We compare the empirical performance across a wide range of median read depth (∼40× to ∼40 000×). In typical whole genome applications, the read depth is between 10× and 100×. For targeted cancer sequencing, the median read depth is higher at 100× to 1000×. For microbial or viral sequencing for rare variants, the median read depth is even higher at 1000× to 100  000×.</p>
      <sec>
        <title>5.2.1 Sensitivity/specificity comparison</title>
        <p><xref ref-type="fig" rid="btv275-F3">Figure 3</xref> shows that samtools, GATK and VarScan2-mpileup all have similar performance. They call the 100% MAF experiment well even at low depth, but are unable to identify true variants in mixed samples. VarScan2-somatic is able to call more mixed samples. However, as the read depth increases the specificity degrades. Strelka is able to call 10% MAF variants with good performance, but is limited at 1% MAF and below. muTect has good performance across a wide range of MAF levels. But even at the highest depth only has around 0.5 sensitivity for low MAF levels.
<fig id="btv275-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>Sensitivity/specificity comparison of RVD2 with other variant calling algorithms using synthetic DNA data</p></caption><graphic xlink:href="btv275f3p"/></fig>
</p>
        <p>The performance statistics for RVD are an average of three sets of pair-end case replicates. RVD performed the best among all algorithms when the read depth is near 40 000. RVD called all the mutated positions across all MAF levels with no false positives when MAF level is 0.3% or lower. However, RVD cannot call any mutations when the depth is too low to measure the baseline error rate and therefore is not useful for low-depth data.</p>
        <p>RVD2 has a high sensitivity and specificity for a broad range of read depths and MAFs. The sensitivity increases considerably with read depth at a slight expense to specificity. For the most difficult test with a low read depth and low MAF, RVD2 performs on-par with muTect. With <inline-formula><mml:math id="MM81"><mml:mrow><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> the performance is much better with high sensitivity and specificity across a wide range of read depths and MAFs. However, in practice one may not know the optimal <inline-formula><mml:math id="MM82"><mml:mrow><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>
<italic>a</italic>
<italic>priori.</italic> With <italic>N</italic> = 6 replicates, the sensitivity increases considerably for low MAF variants with a slight degradation in specificity due to false positives. When the median read depth is at least <inline-formula><mml:math id="MM83"><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> the MAF, RVD2 has higher specificity than all of the other algorithms tested and has a lower sensitivity in only three cases.</p>
      </sec>
      <sec>
        <title>5.2.2 FDR comparison</title>
        <p><xref ref-type="fig" rid="btv275-F4">Figure 4</xref> shows the FDR for RVD2 compared with samtools, GATK, varscan, Strelka and muTect. Blank cells indicate no positive calls were made.
<fig id="btv275-F4" orientation="portrait" position="float"><label>Fig. 4.</label><caption><p>FDR comparison of RVD2 with other variant calling algorithms using synthetic DNA data. Blank cells indicate no locations were called variant</p></caption><graphic xlink:href="btv275f4p"/></fig>
</p>
        <p>Samtools performs well on 100% MAF sample and performance improves for read depths 3089 and 30 590. GATK performs well on both the 10 and 100% variants, but makes a false positive call at the 100% MAF level for all read depth levels. VarScan2-pileup performs perfectly for all but the lowest depth for the 100% MAF.</p>
        <p>VarScan2-somatic is able to make calls for all but the lowest MAF and coverage level. However, the FDR is high due to many false positives. Interestingly, at a MAF of 100% the FDR is zero for lowest read depth and over 0.9 for the highest read depth. Strelka has a better FDR than the samtools, GATK or Varscan2-somatic algorithms for almost all read depths at the 10 and 100% MAF. However, it does not call any variants at or below 1% MAF. muTect has the best FDR performance of the other algorithms we tested over a wide range of MAF and depths. But the FDR level is relatively high at around 0.7 for 0.1–1% MAF and 0.3 for 10–100% MAF. RVD has best FDR performance in the high read depth for 0.1–1% MAF levels. The FDR increases to around 0.3 for 10–100% MAF in the high read depth.</p>
        <p>RVD2 has a lower FDR than other algorithms when the read depth is greater than <inline-formula><mml:math id="MM84"><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> the inverse MAF with <italic>N</italic> = 1 and <italic>τ</italic> set to the default value of zero or to the optimal value. The FDR is higher when <italic>N</italic> = 6 because the variance of the control error rate distribution <inline-formula><mml:math id="MM85"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is smaller. The smaller variance yields improvements in sensitivity at the expense of more false positives. Since the FDR only considers positive calls, the performance by that measure degrades.</p>
      </sec>
    </sec>
    <sec>
      <title>5.3 HCC1187 primary ductal carcinoma sample</title>
      <p>RVD2 identified 15 variant locations in the 59 kbp PAXIP1 gene from chr7:154735400 to chr7:154794682. There were 11 germline variants and 10 somatic mutations. <xref ref-type="fig" rid="btv275-F5">Figure 5</xref> shows the estimated MAFs for the normal and tumor samples at the called locations. Interestingly, positions chr7:154754371 and chr7:154758813 appear to be loss-of-heterozygosity events. Some of these mutations are also found to be common population SNPs according to dbSNPv138. The corresponding identities are shown in <xref ref-type="fig" rid="btv275-F5">Figure 5</xref>. The read depth distribution for positions called by RVD2 is provided in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv275/-/DC1">Supplementary Table S1</ext-link>. Karyotyping indicates that chromosome 7 in HCC1187 is tetraploid <ext-link ext-link-type="uri" xlink:href="http://www.path.cam.ac.uk/pawefish/BreastCellLineDescriptions/HCC1187.html">http://www.path.cam.ac.uk/pawefish/BreastCellLineDescriptions/HCC1187.html</ext-link>.
<fig id="btv275-F5" orientation="portrait" position="float"><label>Fig. 5.</label><caption><p>Estimated minor allele fraction for germline and somatic mutations called by RVD2 in the 59kbp PAXIP1 gene. Blue diamonds indicate germline mutations, where <inline-formula><mml:math id="MM86"><mml:mrow><mml:msup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is significantly different from the reference sequence. Red stars indicate somatic mutations, where <inline-formula><mml:math id="MM87"><mml:mrow><mml:msup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>case</mml:mtext></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is significantly different from <inline-formula><mml:math id="MM88"><mml:mrow><mml:msup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mtext>control</mml:mtext></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The vertical lines represent 95% credible interval around posterior mean MAF. Ten positions are common population SNPs according to dbSNPv138, and the identities are shown below the positions</p></caption><graphic xlink:href="btv275f5p"/></fig>
</p>
      <sec>
        <title>5.3.1 Performance comparison with other algorithms</title>
        <p>We ran muTect and VarScan2-somatic to call mutations in the PAXIP1 gene in HCC1187 sample. We also compared with the result shown in original research report where Strelka was used to identify mutations in the same sample (<xref rid="btv275-B3" ref-type="bibr">Allen, 2013</xref>). <xref ref-type="fig" rid="btv275-F6">Figure 6</xref>a shows mutation detection result from Strelka, RVD2, muTect and VarScan2-somatic. For notation simplicity, we use position index to present actual positions in <xref ref-type="fig" rid="btv275-F6">Figure 6</xref> (the corresponding genomic positions are provided in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv275/-/DC1">Supplementary Table S1</ext-link>).
<fig id="btv275-F6" orientation="portrait" position="float"><label>Fig. 6.</label><caption><p>(<bold>a</bold>) Positions called by VarScan2-somatic, muTect, RVD2 and Strelka in the 59kbp PAXIP1 gene from chr7:154735400 to chr7:154794682. The positions are sorted by index (correspondence to genomic positions shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv275/-/DC1">Supplementary Table S1</ext-link>). (<bold>b</bold>) Read counts for each base for positions called by RVD2 and muTect from raw pileup data</p></caption><graphic xlink:href="btv275f6p"/></fig>
</p>
        <p>The mutations called by RVD2 and muTect are the most consistent among all the techniques. RVD2 detected 15 germline mutations and 10 somatic mutations, while muTect reported 16 mutations; 11 were called by both. In the disagreements, RVD2 did not call positions 1, 39, 54 and 84 while muTect did not call positions 41 75 and 77. Referring to the depth distribution shown in <xref ref-type="fig" rid="btv275-F6">Figure 6</xref>b, it can be seen that positions 41, 75 and 77 are more likely mutated while positions 1, 39, 54 and 84 are less likely mutated.</p>
        <p>Strelka was the least sensitive algorithm among all the algorithms. According to the technical report, Strelka identified position 26 (chr7:154760439) as variant, but did not call any other variants. In particular Strelka missed the two LOH events called by RVD2. VarScan2-somatic called most positions among all algorithms, 84 positions as shown in <xref ref-type="fig" rid="btv275-F6">Figure 6</xref>a. VarScan2-somatic detected all the positions called by RVD2 except position 39, which turns out to be a very likely mutation given the depth distribution in <xref ref-type="fig" rid="btv275-F6">Figure 6</xref>b. VarScan2-somatic reported 65 positions which were not called by any other three algorithms. The read depth in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv275/-/DC1">Supplementary Table S1</ext-link> suggests that these positions are very likely to be false positives. As shown in <xref ref-type="fig" rid="btv275-F4">Figure 4</xref>, the FDR for VarScan2-somatic at read depth 53 MAF level 1.0% is as high as 1.00. <xref rid="btv275-B32" ref-type="bibr">Spencer <italic>et</italic>
<italic>al.</italic> (2013)</xref> also mentioned that VarScan2 has tendency to call many false positives at high read depth.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>6 Discussion</title>
    <p>We describe here a novel algorithm for model estimation and hypothesis testing for identifying single-nucleotide variants in heterogeneous samples using NGS data. Our algorithm has a higher sensitivity and specificity than many other approaches for a range of read depths and MAFs.</p>
    <p>Our inference algorithm uses Gibbs sampling to do inference in the RVD2 hierarchical empirical Bayes model. This sampling procedure provides a guarantee to identify the global optimal parameter settings asymptotically. However, it may require many samples to achieve that guarantee causing the algorithm to be slower than other deterministic approaches. We opted for this balance of speed and accuracy because computational time is often not limiting and the cost of a false positive or false negative greatly outweighs the cost of more computation. Another factor that can affect the speed of RVD2 is the number of M–H sample within one Gibbs sampling run. RVD2 is able to use multiple cores in parallel, which can significantly improve time efficiency. In future studies, we plan to reduce the computational cost by using more sophisticated MCMC sampling methods or deterministic approximation methods such as variational EM or stochastic variational EM.</p>
    <p>We have focused on the statistical model and hypothesis test in this study and our results do not include any pre-filtration of erroneous reads or post-filtration of mutation calls beyond a simple quality score threshold. Incorporation of such data-cleaning steps will likely improve the accuracy of the algorithm.</p>
    <p>Our approach does not address identification of indels, structural variants or copy number variants. Those mutations typically require specific data analysis models and tests that are different than those for single-nucleotide variants. Furthermore, analysis of RNA-seq data or other data generated on the NGS platform may require different models that are more appropriately tuned to the particular noise feature of that data.</p>
    <p>The availability of clinical sequence data is increasing as the technical capability to sequence clinical samples at low-cost improves. Consequently, we require statistically accurate algorithms that are able to call germline and somatic point mutations in heterogeneous samples with low purity. Such accurate algorithms are a step toward greater access to genomics for clinical diagnostics.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_17_2785__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btv275_supplementary_info.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>P.F. was supported by seed funding from Worcester Polytechnic Institute. Y.H. and F.Z. were supported by <funding-source>PhRMA Foundation Informatics</funding-source> Grant <award-id>2013080079</award-id>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btv275-B1">
      <mixed-citation publication-type="journal"><collab>1000 Genomes Project Consortium et al.</collab> (<year>2012</year>) <article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>. <source>Nature</source>, <volume>491</volume>, <fpage>56</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">23128226</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alkan</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2009</year>) <article-title>Personalized copy number and segmental duplication maps using next-generation sequencing</article-title>. <source>Nat. Genet.</source>, <volume>41</volume>, <fpage>1061</fpage>–<lpage>1067</lpage>.<pub-id pub-id-type="pmid">19718026</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname><given-names>E.</given-names></name></person-group> (<year>2013</year>) <article-title>Molecular characterization of tumors using next-generation sequencing</article-title>. <comment>Technical Report 770‐2013‐011, 2013 Illumina, Inc</comment>.</mixed-citation>
    </ref>
    <ref id="btv275-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y.</given-names></name><name><surname>Hochberg</surname><given-names>Y.</given-names></name></person-group> (<year>1995</year>) <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. B</source>
<volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btv275-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Capobianchi</surname><given-names>M.R.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Next-generation sequencing technology in clinical virology</article-title>. <source>Clin. Microbiol. Infect.</source>, <volume>19</volume>, <fpage>15</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">23279287</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cibulskis</surname><given-names>K.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Sensitive detection of somatic point mutations in impure and heterogeneous cancer samples</article-title>. <source>Nature</source>, <volume>31</volume>, <fpage>213</fpage>–<lpage>219</lpage>.</mixed-citation>
    </ref>
    <ref id="btv275-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cressie</surname><given-names>N.</given-names></name><name><surname>Read</surname><given-names>T.R.</given-names></name></person-group> (<year>1984</year>) <article-title>Multinomial goodness-of-fit tests</article-title>. <source>J. R. Stat. Soc. B</source>, <volume>46</volume>, <fpage>440</fpage>–<lpage>464</lpage>.</mixed-citation>
    </ref>
    <ref id="btv275-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cushing</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Rvd: a command-line program for ultrasensitive rare single nucleotide variant detection using targeted next-generation DNA resequencing</article-title>. <source>BMC Res. Notes</source>, <volume>6</volume>, <fpage>206</fpage>.<pub-id pub-id-type="pmid">23701658</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DePristo</surname><given-names>M.A.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat. Genet.</source>, <volume>43</volume>, <fpage>491</fpage>–<lpage>498</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B.</given-names></name></person-group> (<year>2010</year>) <source>Large-Scale Inference: Empirical Bayes Methods for Estimation, Testing, and Prediction</source>, <volume>vol. 1</volume>
<publisher-name>Cambridge University Press</publisher-name>, <publisher-loc>Cambridge, MA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btv275-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fan</surname><given-names>H.C.</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>Noninvasive diagnosis of fetal aneuploidy by shotgun sequencing DNA from maternal blood</article-title>. <source>PNAS</source>, <volume>105</volume>, <fpage>16266</fpage>–<lpage>16271</lpage>.<pub-id pub-id-type="pmid">18838674</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>S.R.A.</given-names></name><etal/></person-group> (<year>1970</year>) <source>Statistical Methods for Research Workers</source>, <volume>vol. 14</volume>
<comment>Oliver and Boyd Edinburgh, Provo, UT</comment>.</mixed-citation>
    </ref>
    <ref id="btv275-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flaherty</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Ultrasensitive detection of rare mutations using next-generation targeted resequencing</article-title>. <source>Nucleic Acids Res.</source>, <volume>40</volume>, <fpage>e2</fpage>.<pub-id pub-id-type="pmid">22013163</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghedin</surname><given-names>E.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Deep sequencing reveals mixed infection with 2009 pandemic influenza A (H1N1) virus strains and the emergence of oseltamivir resistance</article-title>. <source>J. Infect. Dis.</source>, <volume>203</volume>, <fpage>168</fpage>–<lpage>174</lpage>.<pub-id pub-id-type="pmid">21288815</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Howarth</surname><given-names>K.</given-names></name><etal/></person-group> (<year>2007</year>) <article-title>Array painting reveals a high frequency of balanced translocations in breast cancer cell lines that break in cancer-relevant genes</article-title>. <source>Oncogene</source>, <volume>27</volume>, <fpage>3345</fpage>–<lpage>3359</lpage>.<pub-id pub-id-type="pmid">18084325</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Howarth</surname><given-names>K.D.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Large duplications at reciprocal translocation breakpoints that might be the counterpart of large deletions and could arise from stalled replication bubbles</article-title>. <source>Genome Res.</source>, <volume>21</volume>, <fpage>525</fpage>–<lpage>534</lpage>.<pub-id pub-id-type="pmid">21252201</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jordan</surname><given-names>M.I.</given-names></name></person-group> (<year>2004</year>). <article-title>Graphical models</article-title>. <source>Stat. Sci.</source>, <volume>19</volume>, <fpage>140</fpage>–<lpage>155</lpage>.</mixed-citation>
    </ref>
    <ref id="btv275-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kitzman</surname><given-names>J.O.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Noninvasive whole-genome sequencing of a human fetus</article-title>. <source>Sci. Transl. Med.</source>, <volume>4</volume>, <fpage>137ra76</fpage>–<lpage>137ra76</lpage>.</mixed-citation>
    </ref>
    <ref id="btv275-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koboldt</surname><given-names>D.C.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>VarScan 2: somatic mutation and copy number alteration discovery in cancer by exome sequencing</article-title>. <source>Genome Res.</source>, <volume>22</volume>, <fpage>568</fpage>–<lpage>576</lpage>.<pub-id pub-id-type="pmid">22300766</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koboldt</surname><given-names>D.C.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>The next-generation sequencing revolution and its impact on genomics</article-title>. <source>Cell</source>, <volume>155</volume>, <fpage>27</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">24074859</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laird</surname><given-names>P.W.</given-names></name></person-group> (<year>2010</year>) <article-title>Principles and challenges of genomewide DNA methylation analysis</article-title>. <source>Nat. Rev. Genet.</source>, <volume>11</volume>, <fpage>191</fpage>–<lpage>203</lpage>.<pub-id pub-id-type="pmid">20125086</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2011</year>) <article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>2987</fpage>–<lpage>2993</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res.</source>, <volume>20</volume>, <fpage>1297</fpage>–<lpage>1303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Navin</surname><given-names>N.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Inferring tumor progression from genomic heterogeneity</article-title>. <source>Genome Res.</source>, <volume>20</volume>, <fpage>68</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">19903760</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newman</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>The relative timing of mutations in a breast cancer genome</article-title>. <source>PLoS One</source>, <volume>8</volume>, <fpage>e64991</fpage>.<pub-id pub-id-type="pmid">23762276</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ouyang</surname><given-names>Z.</given-names></name><etal/></person-group> (<year>2009</year>) <article-title>ChIP-Seq of transcription factors predicts absolute and differential gene expression in embryonic stem cells</article-title>. <source>PNAS</source>, <volume>106</volume>, <fpage>21521</fpage>–<lpage>21526</lpage>.<pub-id pub-id-type="pmid">19995984</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quail</surname><given-names>M.A.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>A tale of three next generation sequencingplatforms: comparison of Ion Torrent, PacificBiosciences and Illumina MiSeq sequencers</article-title>. <source>BMC Genomics</source>, <volume>13</volume>, <fpage>1</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">22214261</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raczy</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Isaac: ultra-fast whole genome secondary analysis on illumina sequencing platforms</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2041</fpage>–<lpage>2043</lpage>.<pub-id pub-id-type="pmid">23736529</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rivera</surname><given-names>C.M.</given-names></name><name><surname>Ren</surname><given-names>B.</given-names></name></person-group> (<year>2013</year>) <article-title>Mapping human epigenomes</article-title>. <source>Cell</source>, <volume>155</volume>, <fpage>39</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">24074860</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robasky</surname><given-names>K.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>The role of replicates for error mitigation in next-generation sequencing</article-title>. <source>Nat. Rev. Genet.</source>, <volume>15</volume>, <fpage>56</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">24322726</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saunders</surname><given-names>C.T.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Strelka: accurate somatic small-variant calling from sequenced tumor-normal sample pairs</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1811</fpage>–<lpage>1817</lpage>.<pub-id pub-id-type="pmid">22581179</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spencer</surname><given-names>D.H.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Performance of common analysis methods for detecting low-frequency single nucleotide variants in targeted next-generation sequence data</article-title>. <source>J. Mol. Diagn.</source>, <volume>16</volume>, <fpage>75</fpage>–<lpage>88</lpage>.<pub-id pub-id-type="pmid">24211364</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stead</surname><given-names>L.F.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Accurately identifying low-allelic fraction variants in single samples with next-generation sequencing: applications in tumor subclone resolution</article-title>. <source>Hum. Mutat.</source>, <volume>34</volume>, <fpage>1432</fpage>–<lpage>1438</lpage>.<pub-id pub-id-type="pmid">23766071</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B34">
      <mixed-citation publication-type="journal"><collab>The Human Microbiome Project Consortium</collab> (<year>2013</year>) <article-title>A framework for human microbiome research</article-title>. <source>Nature</source>, <volume>486</volume>, <fpage>215</fpage>–<lpage>221</lpage>.</mixed-citation>
    </ref>
    <ref id="btv275-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yau</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>A statistical approach for detecting genomic aberrations in heterogeneous tumor samples from single nucleotide polymorphism genotyping data</article-title>. <source>Genome Biol.</source>, <volume>11</volume>, <fpage>R92</fpage>–<lpage>R92</lpage>.<pub-id pub-id-type="pmid">20858232</pub-id></mixed-citation>
    </ref>
    <ref id="btv275-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zagordi</surname><given-names>O.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Error correction of next-generation sequencing data and reliable estimation of HIV quasispecies</article-title>. <source>Nucleic Acids Res.</source>, <volume>38</volume>, <fpage>7400</fpage>–<lpage>7409</lpage>.<pub-id pub-id-type="pmid">20671025</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
