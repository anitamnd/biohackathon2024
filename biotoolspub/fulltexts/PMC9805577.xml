<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9805577</article-id>
    <article-id pub-id-type="pmid">36394254</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac735</article-id>
    <article-id pub-id-type="publisher-id">btac735</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Gene set proximity analysis: expanding gene set enrichment analysis through learned geometric embeddings, with drug-repurposing applications in COVID-19</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8694-0604</contrib-id>
        <name>
          <surname>Cousins</surname>
          <given-names>Henry</given-names>
        </name>
        <aff><institution>Department of Biomedical Data Science, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <xref rid="btac735-cor1" ref-type="corresp"/>
        <!--cousinsh@stanford.edu-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hall</surname>
          <given-names>Taryn</given-names>
        </name>
        <aff><institution>Optum Labs at UnitedHealth Group</institution>, Minneapolis, MN 55343, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Yinglong</given-names>
        </name>
        <aff><institution>Optum Labs at UnitedHealth Group</institution>, Minneapolis, MN 55343, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tso</surname>
          <given-names>Luke</given-names>
        </name>
        <aff><institution>Optum Labs at UnitedHealth Group</institution>, Minneapolis, MN 55343, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tzeng</surname>
          <given-names>Kathy T H</given-names>
        </name>
        <aff><institution>Optum Labs at UnitedHealth Group</institution>, Minneapolis, MN 55343, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4725-8714</contrib-id>
        <name>
          <surname>Cong</surname>
          <given-names>Le</given-names>
        </name>
        <aff><institution>Department of Genetics, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <aff><institution>Department of Pathology, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3859-2905</contrib-id>
        <name>
          <surname>Altman</surname>
          <given-names>Russ B</given-names>
        </name>
        <aff><institution>Department of Biomedical Data Science, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <aff><institution>Department of Genetics, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <aff><institution>Department of Medicine, Stanford University School of Medicine</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <aff><institution>Department of Bioengineering, Stanford University</institution>, Stanford, CA 94305, <country country="US">USA</country></aff>
        <xref rid="btac735-cor1" ref-type="corresp"/>
        <!--russ.altman@stanford.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac735-cor1">To whom correspondence should be addressed. Email: <email>cousinsh@stanford.edu</email> or <email>russ.altman@stanford.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-11-17">
      <day>17</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac735</elocation-id>
    <history>
      <date date-type="received">
        <day>04</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>05</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>30</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac735.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Gene set analysis methods rely on knowledge-based representations of genetic interactions in the form of both gene set collections and protein–protein interaction (PPI) networks. However, explicit representations of genetic interactions often fail to capture complex interdependencies among genes, limiting the analytic power of such methods.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We propose an extension of gene set enrichment analysis to a latent embedding space reflecting PPI network topology, called gene set proximity analysis (GSPA). Compared with existing methods, GSPA provides improved ability to identify disease-associated pathways in disease-matched gene expression datasets, while improving reproducibility of enrichment statistics for similar gene sets. GSPA is statistically straightforward, reducing to a version of traditional gene set enrichment analysis through a single user-defined parameter. We apply our method to identify novel drug associations with SARS-CoV-2 viral entry. Finally, we validate our drug association predictions through retrospective clinical analysis of claims data from 8 million patients, supporting a role for gabapentin as a risk factor and metformin as a protective factor for severe COVID-19.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>GSPA is available for download as a command-line Python package at <ext-link xlink:href="https://github.com/henrycousins/gspa" ext-link-type="uri">https://github.com/henrycousins/gspa</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>GM007365</award-id>
        <award-id>GM102365</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Knight-Hennessy Scholarships</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>UnitedHealth Group Research and Development</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>High-throughput sequencing and genetic perturbation methods produce vast functional genetic datasets representing both clinical and molecular phenotypes, with applications from drug discovery to clinical diagnostics (<xref rid="btac735-B6" ref-type="bibr">Cieślik and Chinnaiyan, 2017</xref>). While gene-level expression data are useful for identifying differentially expressed genes or training predictive models, assigning biological relevance to observed expression patterns generally requires inference of perturbation in higher-order functional pathways (<xref rid="btac735-B22" ref-type="bibr">De Leeuw <italic toggle="yes">et al.</italic>, 2016</xref>). This requires both defining the composition of such pathways and recognizing subtle expression signatures in noisy data.</p>
    <p>Methods for analyzing expression changes in predefined gene sets generally fall into one of two algorithmic classes. These include overrepresentation approaches, which detect pathway enrichment within a set of differentially expressed genes, and aggregate-score approaches, which associate input genes with a continuous phenotypic score. Overrepresentation approaches, such as Database for Annotation, Visualization, and Integrated Discovery (DAVID) and Enrichr, benefit from simpler input requirements and faster runtimes due to compatibility with deterministic significance tests (<xref rid="btac735-B2" ref-type="bibr">Boyle <italic toggle="yes">et al.</italic>, 2004</xref>; <xref rid="btac735-B4" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btac735-B16" ref-type="bibr">Huang <italic toggle="yes">et al.</italic>, 2009</xref>). However, the requirement for a binary threshold for differential expression limits their ability to detect pathway changes resulting from weaker differential expression among many genes, as well as the relative ordering of genes.</p>
    <p>Aggregate-score approaches, in contrast, weight gene sets according to a cumulative statistic based on continuous phenotypic scores for genes. The most popular aggregate-score approach is gene set enrichment analysis (GSEA), which computes a weighted Kolmogorov–Smirnov statistic representing enrichment of a gene set in an ordered gene list (<xref rid="btac735-B32" ref-type="bibr">Subramanian <italic toggle="yes">et al.</italic>, 2005</xref>). This enrichment statistic is then compared with a null distribution generated from random permutations of the genes or phenotypes to assign a significance level. Aggregate-score approaches such as GSEA, Correlation Adjusted Mean Rank (CAMERA) and Pathway Analysis with Down-weighting of Overlapping Genes (PADOG) are more sensitive to large ensembles of genes acting in concert but only consider overlap between explicitly defined genes in a set and input list (<xref rid="btac735-B36" ref-type="bibr">Tarca <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btac735-B40" ref-type="bibr">Wu and Smyth, 2012</xref>). As a result, such methods cannot detect pathway perturbations implied from expression changes in neighboring genes, which is particularly important in the case of noisy datasets or incomplete gene sets (<xref rid="btac735-B12" ref-type="bibr">Goeman and Bühlmann, 2007</xref>).</p>
    <p>To overcome these limitations, some gene set analysis methods incorporate a priori assumptions about genetic relationships, typically in the form of protein–protein interaction (PPI) networks (<xref rid="btac735-B15" ref-type="bibr">Hillenmeyer <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btac735-B33" ref-type="bibr">Szklarczyk <italic toggle="yes">et al.</italic>, 2017</xref>). This enables gene-level enrichment statistics to be augmented by expression measures of a local genetic neighborhood and can also improve visualization of enrichment results (<xref rid="btac735-B27" ref-type="bibr">Merico <italic toggle="yes">et al.</italic>, 2010</xref>). Due to the computational expense of repeatedly traversing large graphs such as PPI networks, nearly all network-based methods use the overrepresentation approach (<xref rid="btac735-B28" ref-type="bibr">Miryala <italic toggle="yes">et al.</italic>, 2018</xref>). Furthermore, such methods generally utilize explicit representations of network topology, such as one-hop neighbors of differentially expressed genes, which are limited in their ability to capture latent local and global network features. As a result, gene set analysis methods remain sensitive both to experimental noise and to the specific composition of gene sets under consideration, even among gene sets denoting the same pathway.</p>
    <p>We hypothesize that capturing the full extent of functional pathway enrichment in an expression dataset requires consideration of complex pathway structures that are not efficiently represented in explicit form. Unsupervised representation learning provides a means of capturing such features objectively and has enabled improved definition and prognostic application of gene sets (<xref rid="btac735-B5" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac735-B38" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2020</xref>). However, incorporating latent embeddings into enrichment testing algorithms remains an open question, as the inter-gene dependencies implicit in such embeddings can confound relative significance estimates for the resulting gene sets under traditional methods (<xref rid="btac735-B12" ref-type="bibr">Goeman and Bühlmann, 2007</xref>; <xref rid="btac735-B38" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2020</xref>). Therefore, we propose a generalization of the classical GSEA algorithm to a latent feature space derived from unsupervised embeddings of a PPI network. Our method, called gene set proximity analysis (GSPA), implicitly considers the full network context of individual genes, allowing detection of implied perturbations in bona fide functional pathways. Notably, GSPA is statistically straightforward, reducing precisely to the GSEA algorithm for ranked gene lists through a single parameter. We find that GSPA outperforms both GSEA and two widely used network-augmented gene set analysis methods in identifying disease-associated pathways from gold-standard expression datasets, while also improving reproducibility for semantically similar gene sets.</p>
    <p>Finally, we apply GSPA to a collection of datasets measuring gene involvement in SARS-CoV-2 viral entry using gene sets representing known targets of Food and Drug Administration (FDA)-approved drugs, identifying four common drugs (gabapentin, metformin, lorazepam and clonazepam) as possible modulators of SARS-CoV-2 viral entry. We subsequently investigate our predictions through propensity-score matched, retrospective analysis of health insurance claims from 8 million patients. Consistent with the results from GSPA, our clinical investigation supports a role for gabapentin and metformin as risk and protective factors for severe SARS-CoV-2 infection, respectively, providing insight into both molecular pathogenesis and potential treatment strategies for COVID-19.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Generating gene embeddings</title>
      <p>To generate representative embeddings for protein-coding genes, we obtained high-confidence PPIs from the STRING repository (version 11; <xref rid="btac735-B33" ref-type="bibr">Szklarczyk <italic toggle="yes">et al.</italic>, 2017</xref>). We included only interactions with a confidence score of at least 900 in humans, resulting in a network of 12 396 proteins and 324 152 interactions. This was represented as an undirected graph, <italic toggle="yes">G</italic> = (<italic toggle="yes">V</italic>, <italic toggle="yes">E</italic>), with <italic toggle="yes">V</italic>, the set of vertices, representing unique proteins and <italic toggle="yes">E</italic>, the set of edges, representing pairwise PPIs. Low-dimensional feature learning was performed on <italic toggle="yes">G</italic> using the node2vec algorithm, which learns node embeddings by simulating biased random walks in <italic toggle="yes">G</italic> to preserve local neighborhood architecture (<xref rid="btac735-B13" ref-type="bibr">Grover and Leskovec, 2016</xref>).</p>
      <p>We assessed the functional relevance of the embeddings first by retrieving gene ontology (GO) cellular component (CC) labels for each gene (release 2022-07-01), identifying all genes uniquely defined by location in one of cytosol (GO: 0005829), plasma membrane (GO: 0005886), extracellular region (GO: 0005576) or nucleus (GO: 0005634) (<xref rid="btac735-B1" ref-type="bibr">Ashburner <italic toggle="yes">et al.</italic>, 2000</xref>; <xref rid="btac735-B3" ref-type="bibr">Carbon <italic toggle="yes">et al.</italic>, 2021</xref>). To visualize embeddings qualitatively, we performed <italic toggle="yes">t</italic>-distributed stochastic neighbor embedding (tSNE) with perplexity 80, overlaying embeddings with their corresponding GO-CC terms. Next, we retrieved GO biological process (BP) terms for all genes and defined inter-gene similarity as the Jaccard index of the GO-BP term sets for a given pair of genes. Using a random sample of 100 000 gene pairs and their corresponding GO-BP similarity, we labeled gene pairs as sharing low (≤5th percentile), medium (25th–75th percentile) or high (≥95th percentile) functional similarity and compared the distribution of cosine distances between their embeddings. Similarly, we compared the distribution of cosine distances between embeddings for gene pairs based on the length of their shortest path (1, 2 or ≥3). In both cases, Mann–Whitney <italic toggle="yes">U</italic> tests were used for comparing distributions. While we developed and tested GSPA using the embeddings described above, we also note that the algorithm is interoperable with gene embeddings derived by other methods, enabling users to fine-tune embeddings for their desired tasks.</p>
    </sec>
    <sec>
      <title>2.2 Calculation of enrichment score</title>
      <p>For a given gene set and ranked gene list, the enrichment score (ES) in GSPA is computed in a similar manner as in GSEA, with an important modification (<xref rid="btac735-F1" ref-type="fig">Fig. 1A</xref>). In GSEA, a weighted running sum statistic is computed by walking down the ranked list, incrementing the statistic in proportion to its phenotypic score when encountering a gene in the gene set and decrementing it otherwise. The ES is then the signed maximum value of the statistic. Equivalently,
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>E</mml:mi><mml:msubsup><mml:mi mathvariant="normal">S</mml:mi><mml:mi>k</mml:mi><mml:mi>GSEA</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mi>maxdev</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mn mathvariant="double-struck">1</mml:mn><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mn mathvariant="double-struck">1</mml:mn><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:munderover><mml:msub><mml:mn mathvariant="double-struck">1</mml:mn><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∉</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mfenced open="|" close="|" separators="|"><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mtext mathvariant="italic">ES</mml:mtext></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>GSEA</mml:mtext></mml:mrow></mml:msubsup></mml:math></inline-formula> is the ES for gene set <italic toggle="yes">G<sub>k</sub></italic>, maxdev is the maximum deviation from zero, <italic toggle="yes">|G<sub>k</sub>|</italic> is the number of list genes in the gene set, <italic toggle="yes">i</italic> represents a position in the ranked gene list, <italic toggle="yes">n</italic> is the number of genes in the gene list, <italic toggle="yes">s<sub>t</sub></italic> is the value of the phenotypic score for a given gene <italic toggle="yes">g<sub>t</sub></italic> and <inline-formula id="IE111"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow></mml:math></inline-formula> is the indicator function for membership of <italic toggle="yes">g<sub>t</sub></italic> with respect to <italic toggle="yes">G<sub>k</sub></italic>.</p>
      <fig position="float" id="btac735-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Overview of GSPA algorithm. (<bold>A</bold>) Beginning with a gene set and a list of genes ranked by a continuous score, GSPA maps gene IDs to precomputed embeddings representing the genes’ positions within a human PPI network. A set of genes (outlined in cyan) proximal to the original gene set (outlined in green) is determined by adding genes that are within a specified distance, in latent space, from any gene in the original set. An enrichment statistic is computed as the weighted K–S statistic of the augmented gene set. (<bold>B</bold>) For every gene set, a null distribution is determined by performing a fixed number of random permutations of the original gene set, then performing the latent expansion step to incorporate proximal genes</p>
        </caption>
        <graphic xlink:href="btac735f1" position="float"/>
      </fig>
      <p>In GSPA, while calculating the running sum statistic, the gene set <italic toggle="yes">G<sub>k</sub></italic> is temporarily augmented to create the set of gene-set-proximal genes <italic toggle="yes">P<sub>k</sub></italic> such that
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi><mml:mo>:</mml:mo><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="italic">dist</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <italic toggle="yes">g</italic> represents any gene in the ranked list <italic toggle="yes">L</italic>, <italic toggle="yes">v<sub>g</sub></italic> represents the embedding for <italic toggle="yes">g</italic>, <italic toggle="yes">V<sub>Gk</sub></italic> represents a list of embeddings for each gene in <italic toggle="yes">G<sub>k</sub></italic>, dist outputs a list of cosine distances from <italic toggle="yes">v<sub>g</sub></italic> to each embedding in <italic toggle="yes">V<sub>Gk</sub></italic>, assuming that unique embeddings are available for all genes, and <italic toggle="yes">r</italic> is a user-defined parameter representing the radius by which to expand each member of the original gene set. The default radius is 0.1, corresponding to the distance at which approximately 50% of 1-hop neighbors are included. The raw ES is then computed as in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>, substituting <italic toggle="yes">P<sub>k</sub></italic> for <italic toggle="yes">G<sub>k</sub></italic>.
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>E</mml:mi><mml:msubsup><mml:mi mathvariant="normal">S</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="italic">GSPA</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mi>maxdev</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mn mathvariant="double-struck">1</mml:mn><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mn mathvariant="double-struck">1</mml:mn><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:munderover><mml:msub><mml:mn mathvariant="double-struck">1</mml:mn><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∉</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mfenced open="|" close="|" separators="|"><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>Of note, this reduces to <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>, the definition of ES in GSEA, as <italic toggle="yes">r</italic> decreases to zero.</p>
    </sec>
    <sec>
      <title>2.3 Generating null distributions</title>
      <p>The generation of a null distribution of ESs for a given gene set is important both for assigning relative rankings to gene sets of different sizes and for assigning significance levels. In the GSEA algorithm for pre-ranked gene lists, null distributions are generated by sampling a random gene set <italic toggle="yes">G<sub>k</sub>′</italic> containing the same number of members in the ranked list as the original set <italic toggle="yes">G<sub>k</sub></italic> and recalculating ES. This implicitly defines a null hypothesis of no association between genes, which, for large gene sets, can result in highly sensitive estimates of significance at the expense of specificity. Therefore, by default, GSPA generates null distributions by first resampling the original gene set to create <italic toggle="yes">G<sub>k</sub>′</italic>, then creating a null set of proximal genes <italic toggle="yes">P<sub>k</sub>′</italic> as in the original ES calculation for GSPA (<xref rid="btac735-F1" ref-type="fig">Fig. 1B</xref>). A null ES is defined from <italic toggle="yes">P<sub>k</sub>′,</italic> and this procedure is repeated a fixed number of times (100 by default). Alternatively, users can test a less stringent null hypothesis by directly resampling <italic toggle="yes">P<sub>k</sub></italic> itself. Both methods constitute hybrid null hypotheses (i.e. that relative gene expression patterns do not differ between the gene set and background genes) that reduce precisely to the original GSEA prerank algorithm as <italic toggle="yes">r</italic> decreases to zero, but the former method directly accounts for known correlations between genes (<xref rid="btac735-B26" ref-type="bibr">Maleki <italic toggle="yes">et al.</italic>, 2020</xref>). Once the ES and null ES distribution have been calculated, normalized ES (NES; a normalized transformation of ES accounting for gene set size), <italic toggle="yes">P</italic>-value and false discovery rate (FDR) are calculated as in GSEA (<xref rid="btac735-B32" ref-type="bibr">Subramanian <italic toggle="yes">et al.</italic>, 2005</xref>).</p>
    </sec>
    <sec>
      <title>2.4 Datasets</title>
      <p>To evaluate the performance of GSPA, we used the gold-standard GEO2KEGG compendium, composed of 42 disease-matched, human gene expression profiles obtained from the Bioconductor package (version 3.13; <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>; <xref rid="btac735-B36" ref-type="bibr">Tarca <italic toggle="yes">et al.</italic>, 2012</xref>, <xref rid="btac735-B34" ref-type="bibr">2013</xref>). Each dataset contains microarray results from an Affymetrix platform and is mapped to 1 of 19 different diseases. Furthermore, each disease is accompanied by a predefined set of disease-associated Kyoto Encyclopedia of Genes and Genomes (KEGG) pathways obtained from the MalaCards database of disease–gene associations (<xref rid="btac735-B10" ref-type="bibr">Geistlinger <italic toggle="yes">et al.</italic>, 2021</xref>). These datasets have been used in previous comparisons of gene set analysis methods (<xref rid="btac735-B10" ref-type="bibr">Geistlinger <italic toggle="yes">et al.</italic>, 2021</xref>, <xref rid="btac735-B9" ref-type="bibr">2016</xref>; <xref rid="btac735-B34" ref-type="bibr">Tarca <italic toggle="yes">et al.</italic>, 2013</xref>).</p>
      <p>For running GSPA, KEGG human pathway gene sets were obtained through the Bioconductor EnrichmentBrowser package (version 2.22.2; <xref rid="btac735-B9" ref-type="bibr">Geistlinger <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btac735-B19" ref-type="bibr">Kanehisa <italic toggle="yes">et al.</italic>, 2017</xref>). Gene sets containing fewer than 2 or greater than 300 protein-coding genes were excluded from all analyses, resulting in a total of 333 KEGG gene sets considered.</p>
    </sec>
    <sec>
      <title>2.5 Running alternative enrichment testing methods</title>
      <p>We compared our approach to three alternative enrichment analysis methods. In addition to GSEA itself, we also tested network-based GSEA (NGSEA), a network-augmented method accepting continuous gene scores as inputs, and EnrichNet, a network-based method accepting gene sets as inputs (<xref rid="btac735-B11" ref-type="bibr">Glaab <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btac735-B14" ref-type="bibr">Han <italic toggle="yes">et al.</italic>, 2019</xref>). NGSEA operates by considering aggregate expression changes in 1-hop PPI network neighborhoods, rather than individual genes, while EnrichNet calculates a network distance metric between specific sets of genes. We ran the GSEA prerank method with the default parameters using the Java implementation (version 3.0). We ran NGSEA with the default parameters using the NGSEA web server (<ext-link xlink:href="https://www.inetbio.org/ngsea/index.php" ext-link-type="uri">https://www.inetbio.org/ngsea/index.php</ext-link>; accessed June 2021). We ran EnrichNet with the default parameters using the EnrichNet web server (<ext-link xlink:href="http://www.enrichnet.org/" ext-link-type="uri">http://www.enrichnet.org/</ext-link>, accessed July 2022), defining the top 5% of genes as differentially expressed.</p>
    </sec>
    <sec>
      <title>2.6 Benchmarking prediction of disease-associated gene sets</title>
      <p>To measure the ability of GSPA to identify disease-associated pathways, we used a version of the procedure proposed by <xref rid="btac735-B10" ref-type="bibr">Geistlinger <italic toggle="yes">et al.</italic> (2021)</xref> for evaluating the biological relevance of gene set analysis methods. For each disease represented in our collection of evaluation datasets, we established a set of ‘ground-truth’ KEGG pathways known to exhibit a strong association with the disease (specifically, a positive relevance score in the GSEABenchmarkeR package). We subsequently ran GSPA, GSEA, NGSEA and EnrichNet on each expression dataset in the GEO2KEGG compendium using KEGG pathway gene sets. For each method, KEGG pathways were percentile-ranked by the method’s primary enrichment statistic (NES for GSPA, GSEA and NGSEA and XD-score for EnrichNet), with higher rankings connoting greater significance (<xref rid="btac735-B9" ref-type="bibr">Geistlinger <italic toggle="yes">et al.</italic>, 2016</xref>). We then measured the ability of each method’s ranking to retrieve ‘ground-truth’ gene sets using area under the precision–recall curve (AUPRC). Significance levels for each method were calculated using Wilcoxon signed-rank tests.</p>
    </sec>
    <sec>
      <title>2.7 Benchmarking reproducibility of gene set rankings</title>
      <p>To measure the extent to which similar rankings are preserved for gene sets representing the same pathway, we first defined a set of 16 unique, semantically similar KEGG gene set pairs. Specifically, we defined semantically similar gene sets as unique pairs where at least one of the descriptions, as word sets, completely included the other. For instance, hsa00100 (‘steroid_biosynthesis’) was matched with hsa00140 (‘steroid_hormone_biosynthesis’) and hsa04136 (‘autophagy’) was matched with hsa04140 (‘autophagy’). The complete list of gene set pairs is included in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>. For each of the GEO2KEGG datasets, we then computed gene set rankings based on NES for GSPA, GSEA, NGSEA and EnrichNet and compared the similarity between predictions for matched gene sets by Spearman rank correlation coefficient, comparing methods’ performance by Wilcoxon signed-rank tests.</p>
    </sec>
    <sec>
      <title>2.8 Prioritizing pharmacologic modulators of SARS-CoV-2 entry</title>
      <p>To identify FDA-approved compounds with potential relevance in COVID-19 drug repurposing efforts, we obtained drug-target gene sets from the DSigDB D1 database (version 1.0), representing sets of known targets for FDA-approved drugs (<xref rid="btac735-B42" ref-type="bibr">Yoo <italic toggle="yes">et al.</italic>, 2015</xref>). We obtained ranked gene lists from three genome-wide CRISPR knock-out screens of host gene importance for SARS-CoV-2 viral entry, for which additional details regarding experimental design and data processing are available at the respective citations (<xref rid="btac735-B8" ref-type="bibr">Daniloski <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac735-B31" ref-type="bibr">Schneider <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac735-B39" ref-type="bibr">Wei <italic toggle="yes">et al.</italic>, 2021</xref>). We performed GSPA separately on each dataset using DSigDB D1 gene sets and default GSPA parameters. For subsequent clinical validation, we restricted analysis to commonly prescribed drugs, defined as within the top 100 most commonly prescribed medications in 2020 in the USA (ClinCalc DrugStats Database, <ext-link xlink:href="https://clincalc.com/DrugStats" ext-link-type="uri">https://clincalc.com/DrugStats</ext-link>, version 21.1).</p>
    </sec>
    <sec>
      <title>2.9 Claims database and cohort construction</title>
      <p>The study sample for clinical analysis was obtained from de-identified administrative claims for Medicare Advantage Part D (MAPD) enrollees in a research database (<xref rid="btac735-B20" ref-type="bibr">Kelly <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac735-B37" ref-type="bibr">Wallace <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btac735-B41" ref-type="bibr">Yao <italic toggle="yes">et al.</italic>, 2016</xref>). The database contains medical (emergency, inpatient and outpatient diagnoses and treatments) and pharmacy claims for services submitted for third-party reimbursement, available as International Classification of Diseases, Tenth Revision, Clinical Modification (ICD-10-CM) and National Drug Codes claims, respectively. These claims were aggregated after completion of care encounters and submission of claims for reimbursement.</p>
      <p>For each drug of interest, we constructed a cohort of individuals with at least 11 months of enrollment in MAPD insurance from January to December 2019 and at least 1 month of enrollment in MAPD in 2020. These individuals had at least one pharmacy prescription claim during their enrollment and lived in counties in New York, New Jersey and Connecticut. In our database, COVID-19 hospitalization was more prevalent among individuals insured through MAPD and among residents of the New York, New Jersey and Connecticut tri-state area. We restricted our analyses to these populations to select for uniform exposure to COVID-19 and a higher prevalence of the COVID-19 hospitalization outcome in our cohort. We defined our outcome as a claim for a hospitalization with a positive COVID-19 test between January 1, 2020 and June 26, 2020 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>).</p>
      <p>Prescription drug users were identified by string matching from pharmacy claims for any of the generic names associated with the drug candidate. We considered individuals to be drug-exposed when their total supply days covered ≥80% of days between their first drug use date after July 1, 2019 to January 31, 2020. We considered individuals non-drug-exposed if the individual was never prescribed the drug candidates or drugs in the same therapeutic class, between July 1, 2019 and January 31, 2020. For each drug of interest, we extracted covariates for both drug-exposed individuals and non-drug-exposed individuals, a full description of which is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>.</p>
    </sec>
    <sec>
      <title>2.10 Controlled study without propensity score matching</title>
      <p>We first selected a list of features using a least absolute shrinkage and selection operator (LASSO) model with tuned penalty coefficient based on Bayesian information criteria. The complete list of features includes normalized age, sex, primary treatment-related diagnosis, comorbidity index flags, occurrence flags to first three digits of diagnosis codes, adherence flags to co-used drug therapeutic classes, race, state of residence and normalized socioeconomic status (SES) index. After feature selection, we added normalized age, normalized SES index and primary treatment-related diagnosis into the feature list to control for these factors. To ensure model convergence, we excluded features with a prevalence of less than 1% of the cohort. We then fit a Cox proportional hazard model to determine the adjusted hazard ratio of the treatment group, considering time to COVID-19 hospitalization, controlling for the list of features selected.</p>
    </sec>
    <sec>
      <title>2.11 Controlled study with propensity score matching</title>
      <p>For the group of drug-exposed individuals, we applied 1:1 propensity score matching (PSM) to construct a matched group of non-drug-exposed individuals. The propensity score was built using logistic regression based on age, sex, primary treatment-related diagnosis, comorbidity index flags, occurrence flags to first three digits of diagnosis codes, adherence flags to co-used drug therapeutic classes, race, state of residence and SES index. We ran 1:1 PSM with a caliper of 0.25 multiplied by the standard deviation (SD) of propensity scores. We assessed PSM performance by calculating the standardized mean difference between drug-exposed and non-exposed groups across the primary treatment-related diagnosis. PSM was considered adequate when the standardized mean difference between groups was ≤0.10 (<xref rid="btac735-B3562599" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2019</xref>). We applied the same procedure of feature selection and similarly fit a Cox proportional hazards model for each drug of interest, between baseline (the state-specific time of first COVID-19 hospitalization) to hospitalization or end of follow-up, to investigate the adjusted hazard ratio of the drug-exposed group. We applied a Benjamini–Hochberg correction with FDR 0.1 to control for multiple hypothesis testing.</p>
    </sec>
    <sec>
      <title>2.12 Code and data availability</title>
      <p>A complete implementation of GSPA, including precomputed embeddings, is available as a command-line Python program at <ext-link xlink:href="https://github.com/henrycousins/gspa" ext-link-type="uri">https://github.com/henrycousins/gspa</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Overview of GSPA</title>
      <p>Network topology-based gene set analysis methods rely on the principle that aggregate expression changes in gene sets are better resolved by considering expression changes in local gene subnetworks (<xref rid="btac735-F1" ref-type="fig">Fig. 1</xref>). GSPA extends this principle to a learned latent space that reflects genes’ functional similarity through a low-dimensional representation of their contexts in a complete PPI network. GSPA calculates the enrichment of a gene set in a ranked list in an analogous manner to GSEA, leveraging the principle that genes with highly similar embeddings are likely to share functional overlap. Specifically, GSPA computes an ES through the same weighted Kolmogorov–Smirnov statistic used in GSEA, but considering the union of the original gene set and the set of proximal genes meeting a predefined level of embedding similarity to any member of the original gene set.</p>
      <p>To confirm that the PPI embeddings (<xref rid="btac735-F2" ref-type="fig">Fig. 2A</xref>) captured biologically meaningful signals, we measured the relationship between inter-gene embedding distances and both PPI network neighborhood (<xref rid="btac735-F2" ref-type="fig">Fig. 2B</xref>) and GO-BP functional similarity (<xref rid="btac735-F2" ref-type="fig">Fig. 2C</xref>), finding that lower cosine distances between embeddings were associated with both lower shortest paths in the PPI network and higher similarity of GO-BP terms (<italic toggle="yes">P</italic> &lt; 0.001 for all comparisons).</p>
      <fig position="float" id="btac735-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Visualization of unsupervised gene embeddings. (<bold>A</bold>) tSNE projections of gene embeddings, colored by GO-CC term association. (<bold>B</bold>) Distribution of embedding distances for pairs of n-hop neighbors in the PPI network. Gene pairs with lower shortest paths have more similar embeddings. (<bold>C</bold>) Distribution of embedding distances for pairs of genes sharing high (≥95th percentile), medium (25th–75th percentile) or low (≤5th percentile) similarity of GO-BP terms, measured by Jaccard similarity. Genes with greater GO-BP similarity have more similar embeddings</p>
        </caption>
        <graphic xlink:href="btac735f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 GSPA outperforms existing methods in predicting disease-associated gene sets from expression data</title>
      <p>We evaluated the ability of GSPA, in addition to GSEA, NGSEA and EnrichNet, to identify known disease-associated gene sets from gene expression datasets for the corresponding diseases (<xref rid="btac735-F3" ref-type="fig">Fig. 3</xref>). For this analysis, we used the gold-standard GEO2KEGG compendium, containing 42 gene expression datasets matched to 19 different diseases. Each disease was matched with a set of known disease-associated KEGG pathways previously defined by <xref rid="btac735-B10" ref-type="bibr">Geistlinger <italic toggle="yes">et al.</italic> (2021)</xref> for use in evaluating gene set analysis methods. For each expression dataset, we ranked human KEGG pathways using GSPA, GSEA, NGSEA and EnrichNet and measured each method’s ability to identify known disease-associated pathways.</p>
      <fig position="float" id="btac735-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Ability to retrieve known disease-associated gene sets. (<bold>A</bold>) Differences in AUPRC on each dataset between GSPA and GSEA, NGSEA and EnrichNet for identification of literature-derived, disease-associated gene sets in disease-specific expression datasets. Histogram density to the right of the red line indicates better performance from GSPA. (<bold>B</bold>) Performance of GSPA (blue), GSEA (black), NGSEA (gray) and EnrichNet (brown) on all individual datasets. Blue text indicates where GSPA was among the top two best-performing methods</p>
        </caption>
        <graphic xlink:href="btac735f3" position="float"/>
      </fig>
      <p>We observed significantly higher predictive ability with GSPA compared with GSEA, NGSEA and EnrichNet (<italic toggle="yes">P</italic> = 0.00588, <italic toggle="yes">P</italic> = 0.0475 and <italic toggle="yes">P</italic> = 0.00609, respectively; <xref rid="btac735-F3" ref-type="fig">Fig. 3A</xref>). The mean AUPRC was 0.285 (SD 0.186) using GSPA, 0.250 (SD 0.161) using GSEA, 0.269 (SD 0.191) using NGSEA and 0.250 (SD 0.167) using EnrichNet. GSPA outperformed GSEA on 27 of the 42 tested datasets (64.3%), NGSEA on 28 datasets (66.7%) and EnrichNet on 28 datasets (66.7%; <xref rid="btac735-F3" ref-type="fig">Fig. 3B</xref>). It scored highly on datasets for a variety of diseases, including both solid and liquid cancers and chronic pulmonary disease, although performance was relatively reduced in Parkinson’s and cardiomyopathy datasets.</p>
    </sec>
    <sec>
      <title>3.3 GSPA outperforms existing methods in reproducing rankings for semantically similar gene sets</title>
      <p>We next assessed the ability of GSPA to return semantically consistent results (<xref rid="btac735-F4" ref-type="fig">Fig. 4</xref>), as traditional gene set analysis methods are sensitive to the specific member-wise composition of a gene set, which is often arbitrary with respect to the gene set’s intended meaning. We used an automated procedure to define semantically similar gene-set pairs, such as ‘hsa00100_Steroid_biosynthesis’ and ‘hsa00140_Steroid_hormone_ biosynthesis’, and measured the pairwise correlation between enrichment rankings for each method (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). We observed significantly stronger correlations with GSPA than with GSEA, NGSEA or EnrichNet (<italic toggle="yes">P</italic> = 4.43<italic toggle="yes">e</italic>−5, <italic toggle="yes">P</italic> = 0.00112 and <italic toggle="yes">P</italic> = 2.91<italic toggle="yes">e</italic>−6, respectively; <xref rid="btac735-F4" ref-type="fig">Fig. 4A</xref>). The mean correlation was 0.485 (SD 0.245) using GSPA, 0.156 (SD 0.425) using GSEA, 0.268 (SD 0.333) using NGSEA and −0.0153 (SD 0.335) using EnrichNet. GSPA outperformed GSEA on 31 of the 42 tested datasets (73.8%), NGSEA on 27 datasets (64.3%) and EnrichNet on 35 datasets (83.3%; <xref rid="btac735-F4" ref-type="fig">Fig. 4B</xref>).</p>
      <fig position="float" id="btac735-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Reproducibility among semantically similar gene sets. (<bold>A</bold>) Differences in correlation on each dataset among GSPA and GSEA, NGSEA and EnrichNet between rankings of matched gene sets representing the same pathway. Histogram density to the right of the red line indicates better performance from GSPA. (<bold>B</bold>) Performance of GSPA (blue), GSEA (black), NGSEA (gray) and EnrichNet (brown) on all individual datasets. Blue text indicates where GSPA performed either best or second-best</p>
        </caption>
        <graphic xlink:href="btac735f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 GSPA enables prediction of pharmacologic modulators of SARS-CoV-2 viral entry</title>
      <p>Gene set analysis methods are valuable tools for drug discovery and repurposing, as they provide a means of associating specific pharmacologic agents with disease phenotypes by means of aggregate expression changes in gene ensembles targeted by the same compound. Therefore, as a demonstration of our model’s utility, we next investigated whether GSPA could identify novel drug repurposing opportunities in COVID-19. Given the growing literature supporting a multifactorial viral entry mechanism influenced by many host genes, we focused on identifying approved drugs able to modulate viral entry into host cells (<xref rid="btac735-B8" ref-type="bibr">Daniloski <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac735-B31" ref-type="bibr">Schneider <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac735-B39" ref-type="bibr">Wei <italic toggle="yes">et al.</italic>, 2021</xref>). We obtained three datasets representing genome-wide CRISPR knock-out screens ranking host genes by their associated effect on SARS-CoV-2 viral entry. We ran GSPA separately on each dataset with drug-target gene sets from the DSigDB D1 library, generating rankings of FDA-approved drugs by screen-specific enrichment. Notably, the three datasets revealed an enrichment of drug classes with documented COVID-19 associations, including anticonvulsants and biguanides (<xref rid="btac735-B23" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac735-B24" ref-type="bibr">Luo <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac735-B43" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2021</xref>). For follow-up analysis, we restricted our search to highly prescribed drugs (within the top 100 in 2020 in the USA), of which only four drugs had a FDR below 0.5 in any dataset: the benzodiazepines clonazepam and lorazepam, gabapentin and metformin (<xref rid="btac735-F5" ref-type="fig">Fig. 5A</xref>). Furthermore, we noted that gabapentin, clonazepam and lorazepam were associated with positive NES values, while NES values for metformin were consistently negative (<xref rid="btac735-F5" ref-type="fig">Fig. 5B</xref>). This implies that metformin could exert an opposite effect on viral entry in comparison to gabapentin, clonazepam and lorazepam.</p>
      <fig position="float" id="btac735-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Analysis of SARS-CoV-2 entry datasets using DSigDB gene sets. (<bold>A</bold>) GSPA FDR scores for commonly prescribed, FDA-approved drugs on three datasets of gene essentiality for SARS-CoV-2 viral entry. Dashed line indicates an FDR threshold of 0.5. (<bold>B</bold>) Same as (A) but showing NES. Positive and negative NES indicate opposite predicted effects</p>
        </caption>
        <graphic xlink:href="btac735f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 Retrospective analysis of health insurance claims supports a role for metformin and gabapentin in modulating SARS-CoV-2 viral entry</title>
      <p>To investigate whether prediction of a modulatory effect on SARS-CoV-2 viral entry correlates with a drug’s clinical effect, we performed a retrospective analysis of claims data from a large US health insurance provider, examining associations between common prescriptions and COVID-19 hospitalization rates (<xref rid="btac735-F6" ref-type="fig">Fig. 6A</xref>). We reviewed claims from 7.7 million MAPD members for compatibility with regional and temporal inclusion criteria. The final dataset comprised claims for 234 524 MAPD-insured residents of New York, New Jersey and Connecticut with at least 11 months of enrollment between January and December 2019 and at least 1 month of enrollment during 2020, with at least one pharmacy prescription claim. Among these individuals, 2828 (1.21%) had claims indicating COVID-19 hospitalization during the observation window.</p>
      <fig position="float" id="btac735-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Retrospective clinical analysis of drug effect on COVID-19 hospitalization. (<bold>A</bold>) Overview of analysis procedure. From 7.7 million database patients, 234 524 met criteria for inclusion. Two comparisons were performed, comparing COVID-19 hospitalization rates among drug-exposed versus non-drug-exposed patients, controlling for covariates, with and without PSM. (<bold>B</bold>) Results for drug hits identified by GSPA. Metformin shows a significant negative association with hospitalization, while gabapentin shows a significant positive association with hospitalization</p>
        </caption>
        <graphic xlink:href="btac735f6" position="float"/>
      </fig>
      <p>For each of the four candidate drugs, we measured the association between drug use and hospitalization due to COVID-19 both with and without 1:1 PSM (<xref rid="btac735-F6" ref-type="fig">Fig. 6B</xref>). After controlling for multiple hypothesis testing, neither clonazepam nor lorazepam was associated with a significant hazard ratio for COVID-19 hospitalization. However, gabapentin use was associated with a significantly elevated risk of COVID-19 hospitalization, with an adjusted hazard ratio of 1.211 (<italic toggle="yes">P</italic> = 0.0020) before and 1.189 (<italic toggle="yes">P</italic> = 0.034) after applying PSM. Furthermore, after applying PSM, metformin use was associated with a reduction in COVID-19 hospitalization risk, with an adjusted hazard ratio of 0.834 (<italic toggle="yes">P</italic> = 0.013).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this work, we present a novel algorithm, GSPA, based on unsupervised graph learning that extends traditional gene set enrichment analysis to a latent feature space reflecting complex interactions among protein-coding genes. While some existing methods for gene set analysis use a priori knowledge of pathway structures in the form of PPI networks, most such methods work by measuring distance between two distinct sets of genes, requiring thresholding of experimental measurements to establish a set of differentially expressed genes, as in the case of EnrichNet (<xref rid="btac735-B11" ref-type="bibr">Glaab <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btac735-B35" ref-type="bibr">Tarca <italic toggle="yes">et al.</italic>, 2009</xref>). Of the few network-augmented methods that consider continuous experimental scores, all use explicit representations of network structure, requiring either consideration of only the immediate neighborhood of a gene of interest, as in the case of NGSEA (<xref rid="btac735-B14" ref-type="bibr">Han <italic toggle="yes">et al.</italic>, 2019</xref>), or long runtimes (<xref rid="btac735-B30" ref-type="bibr">Nadeau <italic toggle="yes">et al.</italic>, 2021</xref>). GSPA derives from the theory that unsupervised graph embeddings, popular in social network analysis, provide lightweight and expressive representations of PPI network topology. This notion provides a demonstrated basis for identifying disease biomarkers and functional gene set members (<xref rid="btac735-B25" ref-type="bibr">Maddouri <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btac735-B38" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2020</xref>). However, simply applying GSEA methods to the enhanced gene sets resulting from network-based expansion methods results in non-specific significance estimates, as randomly derived null distributions fail to account for presumptive associations between expression changes for PPI network neighbors (<xref rid="btac735-B12" ref-type="bibr">Goeman and Bühlmann, 2007</xref>). The null distribution calculated by GSPA implicitly accounts for known associations, improving the biological relevance of the resulting pathway rankings.</p>
    <p>To our knowledge, GSPA is the first aggregate-score gene set analysis method to incorporate implicit representations of pathway features, which provides several advantages in comparison to other network-augmented gene set analysis methods. First, learned embeddings capture both local and global genetic features that would not be apparent using simpler gene-level metrics such as shortest path length to a gene set. They are also modular, allowing any user-defined vector representation of gene similarity to be substituted, and require significantly less computational expense than do operations on unreduced networks. Furthermore, the use of embedding similarity to determine proximal genes enables a more conservative and biologically reasonable null hypothesis that accounts for known gene–gene associations, which is not possible in most gene set analysis methods for ranked lists. Finally, the GSPA algorithm accommodates arbitrary user-defined gene similarity thresholds, reducing to the traditional GSEA prerank algorithm as this parameter becomes highly stringent.</p>
    <p>We apply GSPA to a variety of gene set analysis tasks, showing that it provides improved performance with respect to detection of disease-associated pathways in gene expression datasets, compared with GSEA and two widely used network-augmented approaches. GSPA achieved high performance across a variety of disease types, including solid cancers, leukemias and chronic pulmonary diseases. We observe that GSPA tends to perform worse on neurodegenerative diseases, which was also observed for NGSEA. We hypothesize that this phenomenon may derive from relative underrepresentation of these conditions in literature-based PPI networks, in comparison to cancers (<xref rid="btac735-B33" ref-type="bibr">Szklarczyk <italic toggle="yes">et al.</italic>, 2017</xref>). For specialized applications in specific diseases, fine-tuning gene embeddings based on cell-type-specific expression or disease-specific literature may improve performance in the future (<xref rid="btac735-B17" ref-type="bibr">Ietswaart <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac735-B44" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
    <p>We also demonstrate that GSPA improves reproducibility of enrichment statistics for gene sets with a shared semantic meaning. A common problem in traditional gene set analysis methods is their sensitivity to small changes in the definition of knowledge-based gene sets. For instance, for the diabetes mellitus dataset assessed in the original GSEA report, the MSigDB C2 gene set ‘p38mapkPathway’ was ranked 20th in enrichment, while ‘ST_p38_MAPK_Pathway’ was ranked 117th out of 318 (<xref rid="btac735-B29" ref-type="bibr">Mootha <italic toggle="yes">et al.</italic>, 2003</xref>). Such variance reflects discrepancies between the specific definition of a gene set and the underlying pathway that it represents semantically, impairing both interpretability and reproducibility of enrichment analyses. By representing gene sets implicitly in a latent feature space, GSPA reduces the sensitivity of the enrichment test to these discrepancies.</p>
    <p>Finally, we use GSPA to make novel predictions of drug associations with SARS-CoV-2 infection. We apply the algorithm on three datasets measuring genome-wide gene essentiality for viral entry in lung and epithelial host cells using gene sets representing known targets of FDA-approved drugs. This yielded four commonly prescribed drugs with a predicted modulatory effect on SARS-CoV-2 entry: metformin, gabapentin, clonazepam and lorazepam. While gabapentin, clonazepam and lorazepam targets were significantly enriched toward the top of the datasets, metformin targets were significantly enriched toward the bottom, suggesting an opposing effect of metformin in comparison to the other drugs.</p>
    <p>We validated the drug predictions through retrospective analysis of COVID-19 hospitalization rates in propensity-score-matched subjects with or without exposure to each drug, observing statistically significant hazard ratios associated with both gabapentin and metformin. Specifically, we observed that gabapentin was associated with increased risk of COVID-19 hospitalization, while metformin was associated with decreased risk, consistent with the opposing effects predicted by GSPA. Several retrospective studies have demonstrated an association between metformin use and COVID-19 hospitalization and mortality, supporting the generalizability of our clinical findings (<xref rid="btac735-B7" ref-type="bibr">Crouse <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac735-B21" ref-type="bibr">Lalau <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac735-B24" ref-type="bibr">Luo <italic toggle="yes">et al.</italic>, 2020</xref>). However, the potential role of gabapentin as a risk factor for viral entry has not been investigated outside of our study. Further experimental and clinical investigations are necessary to clarify the potential effect size and mechanism of action of gabapentin in COVID-19 patients.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac735_Supplementary_Data</label>
      <media xlink:href="btac735_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institutes of Health [GM007365 to H.C., GM102365 to R.B.A.], the Knight-Hennessy Scholarships [to H.C.], and UnitedHealth Group Research and Development [to T.H., Y.G., L.T., K.T.H.T.].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The claims data are proprietary but, under certain conditions, may be made available through Optum Labs under a data use agreement. All other data are publicly available at their respective citations.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac735-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashburner</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2000</year>) <article-title>Gene ontology: tool for the unification of biology. The gene ontology consortium</article-title>. <source>Nat. Genet</source>., <volume>25</volume>, <fpage>25</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boyle</surname><given-names>E.I.</given-names></string-name></person-group><etal>et al</etal> (<year>2004</year>) <article-title>GO::TermFinder—open source software for accessing gene ontology information and finding significantly enriched gene ontology terms associated with a list of genes</article-title>. <source>Bioinformatics</source>, <volume>20</volume>, <fpage>3710</fpage>–<lpage>3715</lpage>.<pub-id pub-id-type="pmid">15297299</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carbon</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>The gene ontology resource: enriching a GOld mine</article-title>. <source>Nucleic Acids Res</source>., <volume>49</volume>, <fpage>D325</fpage>–<lpage>D334</lpage>.<pub-id pub-id-type="pmid">33290552</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>E.Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>Enrichr: interactive and collaborative HTML5 gene list enrichment analysis tool</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">23323762</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>H.I.H.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>GSAE: an autoencoder with embedded gene-set nodes for genomics functional characterization</article-title>. <source>BMC Syst. Biol</source>., <volume>12</volume>, <fpage>45</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">29745842</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cieślik</surname><given-names>M.</given-names></string-name>, <string-name><surname>Chinnaiyan</surname><given-names>A.M.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Cancer transcriptome profiling at the juncture of clinical translation</article-title>. <source>Nat. Rev. Genet</source>., <volume>19</volume>, <fpage>93</fpage>–<lpage>109</lpage>.<pub-id pub-id-type="pmid">29279605</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Crouse</surname><given-names>A.B.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Metformin use is associated with reduced mortality in a diverse population with COVID-19 and diabetes</article-title>. <source>Front. Endocrinol</source>., <volume>11</volume>, <fpage>1081</fpage>.</mixed-citation>
    </ref>
    <ref id="btac735-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Daniloski</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Identification of required host factors for SARS-CoV-2 infection in human cells</article-title>. <source>Cell</source>, <volume>184</volume>, <fpage>92</fpage>–<lpage>105.e16</lpage>.<pub-id pub-id-type="pmid">33147445</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Geistlinger</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Bioconductor’s EnrichmentBrowser: seamless navigation through combined results of set- and network-based enrichment analysis</article-title>. <source>BMC Bioinform</source>., <volume>17</volume>, <fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation>
    </ref>
    <ref id="btac735-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Geistlinger</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Toward a gold standard for benchmarking gene set enrichment analysis</article-title>. <source>Brief. Bioinform</source>., <volume>22</volume>, <fpage>545</fpage>–<lpage>556</lpage>.<pub-id pub-id-type="pmid">32026945</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Glaab</surname><given-names>E.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>EnrichNet: network-based gene set enrichment analysis</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>i451</fpage>–<lpage>i457</lpage>.<pub-id pub-id-type="pmid">22962466</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goeman</surname><given-names>J.J.</given-names></string-name>, <string-name><surname>Bühlmann</surname><given-names>P.</given-names></string-name></person-group> (<year>2007</year>) <article-title>Analyzing gene expression data in terms of gene sets: methodological issues</article-title>. <source>Bioinformatics</source>, <volume>23</volume>, <fpage>980</fpage>–<lpage>987</lpage>.<pub-id pub-id-type="pmid">17303618</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grover</surname><given-names>A.</given-names></string-name>, <string-name><surname>Leskovec</surname><given-names>J.</given-names></string-name></person-group> (<year>2016</year>) <article-title>node2vec: scalable feature learning for networks</article-title>. In: <source>KDD Proceedings of the</source><italic toggle="yes">International Conference on Knowledge Discovery and Data Mining, 2016</italic>, p. <fpage>855</fpage>. Association for Computing Machinery, New York, NY, United States.</mixed-citation>
    </ref>
    <ref id="btac735-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>NGSEA: network-based gene set enrichment analysis for interpreting gene expression phenotypes with functional gene sets</article-title>. <source>Mol. Cells</source>, <volume>42</volume>, <fpage>579</fpage>–<lpage>588</lpage>.<pub-id pub-id-type="pmid">31307154</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hillenmeyer</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>STAMS: STRING-assisted module search for genome wide association studies and application to autism</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>3815</fpage>–<lpage>3822</lpage>.<pub-id pub-id-type="pmid">27542772</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>D.W.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Systematic and integrative analysis of large gene lists using DAVID bioinformatics resources</article-title>. <source>Nat. Protoc</source>., <volume>4</volume>, <fpage>44</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">19131956</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ietswaart</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>GeneWalk identifies relevant gene functions for a biological context using network representation learning</article-title>. <source>Genome Biol</source>., <volume>22</volume>, <fpage>1</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">33397451</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>KEGG: new perspectives on genomes, pathways, diseases and drugs</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>D353</fpage>–<lpage>D361</lpage>.<pub-id pub-id-type="pmid">27899662</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelly</surname><given-names>B.T.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Outcomes for hospitalized patients with idiopathic pulmonary fibrosis treated with antifibrotic medications</article-title>. <source>BMC Pulm. Med</source>., <volume>21</volume>.</mixed-citation>
    </ref>
    <ref id="btac735-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lalau</surname><given-names>J.D.</given-names></string-name></person-group><etal>et al</etal>; <collab>CORONADO Investigators</collab>. (<year>2021</year>) <article-title>Metformin use is associated with a reduced risk of mortality in patients with diabetes hospitalised for COVID-19</article-title>. <source>Diabetes Metab</source>., <volume>47</volume>, <fpage>101216</fpage>.<pub-id pub-id-type="pmid">33309936</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Leeuw</surname><given-names>C.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>The statistical properties of gene-set analysis</article-title>. <source>Nat. Rev. Genet</source>., <volume>17</volume>, <fpage>353</fpage>–<lpage>364</lpage>.<pub-id pub-id-type="pmid">27070863</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Metformin in patients with COVID-19: a systematic review and meta-analysis</article-title>. <source>Front Med</source>., <volume>8</volume>, <fpage>704666</fpage>.</mixed-citation>
    </ref>
    <ref id="btac735-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luo</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Metformin treatment was associated with decreased mortality in COVID-19 patients with diabetes in a retrospective analysis</article-title>. <source>Am. J. Trop. Med. Hyg</source>., <volume>103</volume>, <fpage>69</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">32446312</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maddouri</surname><given-names>O.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Deep graph representations embed network information for robust disease marker identification</article-title>. <source>Bioinformatics</source>, <volume>38</volume>, <fpage>1075</fpage>–<lpage>1086</lpage>.<pub-id pub-id-type="pmid">34788368</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maleki</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Gene set analysis: challenges, opportunities, and future research</article-title>. <source>Front. Genet</source>., <volume>11</volume>, <fpage>654</fpage>.<pub-id pub-id-type="pmid">32695141</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merico</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Enrichment map: a network-based method for gene-set enrichment visualization and interpretation</article-title>. <source>PLoS ONE</source>, <volume>5</volume>, <fpage>e13984</fpage>.<pub-id pub-id-type="pmid">21085593</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miryala</surname><given-names>S.K.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Discerning molecular interactions: a comprehensive review on biomolecular interaction databases and network analysis tools</article-title>. <source>Gene</source>, <volume>642</volume>, <fpage>84</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">29129810</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mootha</surname><given-names>V.K.</given-names></string-name></person-group><etal>et al</etal> (<year>2003</year>) <article-title>PGC-1alpha-responsive genes involved in oxidative phosphorylation are coordinately downregulated in human diabetes</article-title>. <source>Nat. Genet</source>., <volume>34</volume>, <fpage>267</fpage>–<lpage>273</lpage>.<pub-id pub-id-type="pmid">12808457</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nadeau</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>PIGNON: a protein–protein interaction-guided functional enrichment analysis for quantitative proteomics</article-title>. <source>BMC Bioinformatics</source>, <volume>22</volume>.</mixed-citation>
    </ref>
    <ref id="btac735-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schneider</surname><given-names>W.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Genome-scale identification of SARS-CoV-2 and pan-coronavirus host factor networks</article-title>. <source>Cell</source>, <volume>184</volume>, <fpage>120</fpage>–<lpage>132.e14</lpage>.<pub-id pub-id-type="pmid">33382968</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2005</year>) <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>102</volume>, <fpage>15545</fpage>–<lpage>15550</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szklarczyk</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>The STRING database in 2017: quality-controlled protein–protein association networks, made broadly accessible</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>D362</fpage>–<lpage>D368</lpage>.<pub-id pub-id-type="pmid">27924014</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarca</surname><given-names>A.L.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>A comparison of gene set analysis methods in terms of sensitivity, prioritization and specificity</article-title>. <source>PLoS ONE</source>, <volume>8</volume>, <fpage>e79217</fpage>.<pub-id pub-id-type="pmid">24260172</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarca</surname><given-names>A.L.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>A novel signaling pathway impact analysis</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>75</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">18990722</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarca</surname><given-names>A.L.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Down-weighting overlapping genes improves gene set analysis</article-title>. <source>BMC Bioinformatics</source>, <volume>13</volume>, <fpage>136</fpage>.<pub-id pub-id-type="pmid">22713124</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wallace</surname><given-names>P.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Optum labs: building a novel node in the learning health care system</article-title>. <source>Health Aff. (Millwood)</source>, <volume>33</volume>, <fpage>1187</fpage>–<lpage>1194</lpage>. <pub-id pub-id-type="doi">10.1377/hlthaff.2014.0038</pub-id><pub-id pub-id-type="pmid">25006145</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Gaussian embedding for large-scale gene set analysis</article-title>. <source>Nat. Mach. Intell</source>., <volume>2</volume>, <fpage>387</fpage>–<lpage>395</lpage>.<pub-id pub-id-type="pmid">32968711</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Genome-wide CRISPR screens reveal host factors critical for SARS-CoV-2 infection</article-title>. <source>Cell</source>, <volume>184</volume>, <fpage>76</fpage>–<lpage>91.e13</lpage>.<pub-id pub-id-type="pmid">33147444</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>D.</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>G.K.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Camera: a competitive gene set test accounting for inter-gene correlation</article-title>. <source>Nucleic Acids Res</source>., <volume>40</volume>, <fpage>e133–e133</fpage>.<pub-id pub-id-type="pmid">22638577</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yao</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Effectiveness and safety of dabigatran, rivaroxaban, and apixaban versus warfarin in nonvalvular atrial fibrillation</article-title>. <source>J. Am. Heart Assoc</source>., <volume>5</volume>.</mixed-citation>
    </ref>
    <ref id="btac735-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yoo</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>DSigDB: drug signatures database for gene set analysis</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>3069</fpage>–<lpage>3071</lpage>.<pub-id pub-id-type="pmid">25990557</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B3562599">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>,<given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Balance diagnostics after propensity score matching</article-title>. <source><italic toggle="yes">Ann. Transl. Med.</italic></source>, <volume>7</volume>, <fpage>16</fpage>.<pub-id pub-id-type="pmid">30788363</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C.H.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Potent noncovalent inhibitors of the main protease of SARS-CoV-2 from molecular sculpting of the drug perampanel guided by free energy perturbation calculations</article-title>. <source>ACS Cent. Sci</source>., <volume>7</volume>, <fpage>467</fpage>–<lpage>475</lpage>.<pub-id pub-id-type="pmid">33786375</pub-id></mixed-citation>
    </ref>
    <ref id="btac735-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Learning interpretable cellular and gene signature embeddings from single-cell transcriptomic data</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>1</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">33397941</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
