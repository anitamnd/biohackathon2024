<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4253827</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu545</article-id>
    <article-id pub-id-type="publisher-id">btu545</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Hitseq Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MindTheGap: integrated detection and assembly of short and long insertions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rizk</surname>
          <given-names>Guillaume</given-names>
        </name>
        <xref ref-type="aff" rid="btu545-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu545-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gouin</surname>
          <given-names>Anaïs</given-names>
        </name>
        <xref ref-type="aff" rid="btu545-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chikhi</surname>
          <given-names>Rayan</given-names>
        </name>
        <xref ref-type="aff" rid="btu545-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lemaitre</surname>
          <given-names>Claire</given-names>
        </name>
        <xref ref-type="aff" rid="btu545-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu545-COR1">*</xref>
      </contrib>
      <aff id="btu545-AFF1"><sup>1</sup>Inria/IRISA GenScale, Campus de Beaulieu, 35042 Rennes cedex, France, <sup>2</sup>INRA, UMR 1349 Institut de Génétique, Environnement et Protection des Plantes, Domaine de la Motte - 35653 Le Rheu Cedex, France and <sup>3</sup>Department of Computer Science and Engineering, Pennsylvania State University, PA, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu545-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: Michael Brudno</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>24</issue>
    <fpage>3451</fpage>
    <lpage>3457</lpage>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>4</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>6</day>
        <month>4</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>8</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Insertions play an important role in genome evolution. However, such variants are difficult to detect from short-read sequencing data, especially when they exceed the paired-end insert size. Many approaches have been proposed to call short insertion variants based on paired-end mapping. However, there remains a lack of practical methods to detect and assemble long variants.</p>
      <p><bold>Results:</bold> We propose here an original method, called M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc>, for the integrated detection and assembly of insertion variants from re-sequencing data. Importantly, it is designed to call insertions of any size, whether they are novel or duplicated, homozygous or heterozygous in the donor genome. M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> uses an efficient <italic>k</italic>-mer-based method to detect insertion sites in a reference genome, and subsequently assemble them from the donor reads. M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> showed high recall and precision on simulated datasets of various genome complexities. When applied to real <italic>Caenorhabditis elegans</italic> and human NA12878 datasets, M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> detected and correctly assembled insertions &gt;1 kb, using at most 14 GB of memory.</p>
      <p>
        <bold>Availability and implementation:</bold>
        <ext-link ext-link-type="uri" xlink:href="http://mindthegap.genouest.org">http://mindthegap.genouest.org</ext-link>
      </p>
      <p><bold>Contact:</bold><email>guillaume.rizk@inria.fr</email> or <email>claire.lemaitre@inria.fr</email></p>
    </abstract>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Structural variants (SVs) are large-scale structural changes in the genome. They have been typically defined in opposition to point mutations, which are single nucleotide polymorphisms (SNPs) and short insertions or deletions (indels). SVs therefore include insertions, deletions and inversions of genomic sequences. Recent research has shown that they play an important role in evolution and diseases (<xref rid="btu545-B1" ref-type="bibr">1000 Genomes Project Consortium <italic>et al.</italic>, 2010</xref>; <xref rid="btu545-B22" ref-type="bibr">Stewart <italic>et al.</italic>, 2011</xref>). However, SVs are challenging to discover using present-day sequencing approaches, as they generally span genomic regions that are longer than the reads. Computational methods have been designed to extract evidence of SVs from sequencing data using two types of analyses: paired-end mapping of reads to a reference genome and copy number estimation using read depth (<xref rid="btu545-B3" ref-type="bibr">Alkan <italic>et al.</italic>, 2011</xref>; <xref rid="btu545-B16" ref-type="bibr">Medvedev <italic>et al.</italic>, 2009</xref>).</p>
    <sec id="SEC1.1">
      <title>1.1 Definition of insertion variants</title>
      <p>In this work, we will focus on <italic>insertion</italic> variants: sequences that are present at one site (position) in the donor genome but are absent from the reference genome at this site. We divide insertions into three mutually exclusive types: (i) <italic>novel insertions</italic> in the donor genome that have no match in the reference, (ii) <italic>duplicated insertions</italic>, which are found at two or more sites in the donor and a strict subset of those in the reference and (iii) <italic>transpositions</italic>, which are sequences in the reference that moved to a different site in the donor. Duplicated insertions include mobile element insertions (MEI), for which databases of known sequences have been created to facilitate discovery (<xref rid="btu545-B22" ref-type="bibr">Stewart <italic>et al.</italic>, 2011</xref>).</p>
      <p>All three types of insertions are difficult to detect using short reads. Different techniques are used to detect insertions that are <italic>short</italic> (shorter than the reads), <italic>medium</italic> (of size between read length and insert size) or <italic>long</italic> (of size exceeding insert size). In the next two sections, we review techniques used to identify insertion sites, and techniques used to reconstruct insertion sequences.</p>
    </sec>
    <sec id="SEC1.2">
      <title>1.2 Identification of insertion sites</title>
      <p>As short insertions are likely to be fully contained in several reads, mapping donor reads to a reference genome enables simultaneous discovery of the sites and contents of insertions (<xref rid="btu545-B2" ref-type="bibr">Albers <italic>et al.</italic>, 2011</xref>; <xref rid="btu545-B7" ref-type="bibr">DePristo <italic>et al.</italic>, 2011</xref>; <xref rid="btu545-B14" ref-type="bibr">Li <italic>et al.</italic>, 2009</xref>; <xref rid="btu545-B23" ref-type="bibr">Ye <italic>et al.</italic>, 2009</xref>). In this context, results are sensitive to mapping parameters and may be degraded in low-coverage or low-complexity regions of the reference. Although the discovery of short indels has been an extensively studied problem, a recent article has observed considerable differences between the results of popular tools (<xref rid="btu545-B18" ref-type="bibr">Pabinger <italic>et al.</italic>, 2013</xref>).</p>
      <p>Sites of medium-sized insertions can be detected by analyzing mapping positions of paired reads. General SV calling tools call insertions sites by clustering neighboring read pairs that have a shorter insert size than expected, e.g. BreakDancer and GASV (<xref rid="btu545-B4" ref-type="bibr">Chen <italic>et al.</italic>, 2009</xref>; <xref rid="btu545-B21" ref-type="bibr">Sindi <italic>et al.</italic>, 2009</xref>). NovelSeq (<xref rid="btu545-B9" ref-type="bibr">Hajirasouliha <italic>et al.</italic>, 2010</xref>) and SOAPindel (<xref rid="btu545-B15" ref-type="bibr">Li <italic>et al.</italic>, 2013</xref>) detect sites of long, novel insertions by clustering paired reads for which one mate is unmapped.</p>
      <p>Alternatively, tools based on read coverage can detect duplicated insertions of any length by finding reference segments that have higher read depth than expected. While insertion sites cannot be determined by this method alone, the Reprever (<xref rid="btu545-B13" ref-type="bibr">Kim <italic>et al.</italic>, 2013</xref>) software identifies low-copy duplicated insertions by combining paired-end mapping with read depth analysis. Finally, several methods detect sites of mobile element insertions using collections of known transposable element sequences, by searching for read pairs where one mate is mapped to a known element and the other to a unique part of the reference genome (<xref rid="btu545-B8" ref-type="bibr">Ewing and Kazazian, 2011</xref>; <xref rid="btu545-B10" ref-type="bibr">Hormozdiari <italic>et al.</italic>, 2010</xref>; <xref rid="btu545-B22" ref-type="bibr">Stewart <italic>et al.</italic>, 2011</xref>).</p>
    </sec>
    <sec id="SEC1.3">
      <title>1.3 Reconstruction of inserted sequences</title>
      <p>While short insertions are easy to reconstruct (as seen in Section 1.2), to the best of our knowledge, only a few methods are capable of handling medium or long insertions. They are based on global or local <italic>de novo</italic> assembly of reads that are potentially involved in an insertion.</p>
      <p>SOAPindel (<xref rid="btu545-B15" ref-type="bibr">Li <italic>et al.</italic>, 2013</xref>), Scalpel (<xref rid="btu545-B17" ref-type="bibr">Narzisi <italic>et al.</italic>, 2013</xref>) and TIGRA (<xref rid="btu545-B5" ref-type="bibr">Chen <italic>et al.</italic>, 2014</xref>) select paired reads for which one of the mates maps nearby an insertion site. The other mates are used to assemble separately each inserted sequence. This approach can only reconstruct insertions that are shorter than twice the insert size. NovelSeq (<xref rid="btu545-B9" ref-type="bibr">Hajirasouliha <italic>et al.</italic>, 2010</xref>) reconstructs novel insertions (of any size) by assembling all unmapped reads, and then aligning the extremities of assembled sequences to all predicted insertion sites. <xref rid="btu545-B19" ref-type="bibr">Parrish <italic>et al.</italic> (2011)</xref> proposed to extend this approach to duplicated insertions by performing a global assembly of all reads that are either unmapped, discordantly paired or mapped to high-coverage regions.</p>
      <p>Cortex_var (<xref rid="btu545-B11" ref-type="bibr">Iqbal <italic>et al.</italic>, 2012</xref>) builds a colored de Bruijn graph from the reference genome and all donor reads. Insertions appear in the graph as <italic>bubbles</italic> (sets of paths between two nodes), where one short path corresponds to the reference genome, and longer paths correspond to inserted sequences. Theoretically, this approach enables the discovery of insertions regardless of their size and type. However, because of practical limitations, Cortex_var only finds a restricted class of bubbles: those that (i) contain exactly two paths and (ii) all intermediate nodes having exactly one in-neighbor and one out-neighbor.</p>
      <p>To summarize, available tools are highly specialized and lack the versatility to detect and assemble insertions of any size and any type. SOAPindel, Scalpel and Cortex_var are practically limited to short insertions, Reprever is limited to low-copy duplicated sequences and Novelseq is limited to novel insertions.</p>
    </sec>
    <sec id="SEC1.4">
      <title>1.4 Our contribution</title>
      <p>We propose a new tool, M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc>, for detecting and assembling insertions. M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> has several novel features that are not found in other tools. First, a mapping-free site detection algorithm has been designed to detect insertions of any size. Second, an improved method for insertion assembly enables the reconstruction of long insertions of all three types. Third, a memory-efficient data structure enables high scalability.</p>
      <p>We evaluated M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> on simulated and real Illumina sequencing data. Among 1 kbp simulated homozygous insertions, a large fraction were found and correctly assembled (recall values between 65–98.4%, precision &gt;97%). Simulated heterozygous 1 kbp insertions proved to be more challenging to assemble (60% recall for <italic>C</italic><italic>aenorhabditis elegans</italic>, 35% for human chromosome 22); however, precision remained high (93% and 89%, respectively). We assembled long insertions using M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> on an actual whole-genome human dataset, which required only 14 GB of memory.</p>
    </sec>
  </sec>
  <sec>
    <title>2 METHODS</title>
    <p>The input of M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> is a set of reads and a reference genome. The software performs three steps: (i) construction of the de Bruijn graph of the reads, (ii) detection of insertion breakpoints on the reference genome (<italic>find</italic> module) and (iii) local assembly of inserted sequences (<italic>fill</italic> module). Both the detection step and the assembly step rely solely on the constructed graph.</p>
    <p>The output of the second step is a set of putative insertion positions on the reference genome, whereas the output of the last step is, for each insertion site, one or several assembled sequences.</p>
    <sec id="SEC2.1">
      <title>2.1 de Bruijn graph construction</title>
      <p>The de Bruijn graph is a directed graph over all distinct <italic>k</italic>-mers in the reads. An edge is present when two <italic>k</italic>-mers share an exact <inline-formula><mml:math id="MM1"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>-overlap. The graph is constructed using the algorithms implemented in the Minia assembler (<xref rid="btu545-B6" ref-type="bibr">Chikhi and Rizk, 2013</xref>; <xref rid="btu545-B20" ref-type="bibr">Salikhov <italic>et al.</italic>, 2013</xref>). Minia encodes the graph using a Bloom filter and an additional hash table to suppress false-positive results. The data structure supports two operations: (i) membership queries for <italic>k</italic>-mers that are neighbors of existing <italic>k</italic>-mers in the graph, and (ii) traversal of the graph from an existing <italic>k</italic>-mer. These operations are respectively used in Section 2.2 (insertion site detection) and Section 2.3 (local assembly).</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Find module: detection of insertion sites</title>
      <p>M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> detects insertion sites by scanning the reference genome and testing membership of reference <italic>k</italic>-mers in the de Bruijn graph. Homozygous and heterozygous insertions are handled using two different methods.</p>
      <sec id="SEC2.2.1">
        <title>2.2.1 Homozygous insertions</title>
        <p>The general case for detecting homozygous insertions can be modeled as follows. Let Sr be a sequence (the reference). For a position <italic>j</italic> in the reference, the <italic>k</italic>-mer at position <inline-formula><mml:math id="MM2"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (resp. <italic>j</italic> + 1) is called the left (resp. right) flanking <italic>k</italic>-mer. Let Sd (the donor) be a copy of Sr where a sequence <italic>I</italic> has been inserted between the nucleotides at position <italic>i</italic> and <italic>i</italic> + 1 (the insertion site, see <xref ref-type="fig" rid="btu545-F1">Fig. 1</xref>). For each position in the reference genome, a binary character records whether the <italic>k</italic>-mer starting at this position is present (‘1’) or absent (‘0’) in the donor reads. Depending on the context, the reference genome will correspond to the string of nucleotides or to the string of binary characters. Let a gap be a substring in the reference genome equal to <inline-formula><mml:math id="MM3"><mml:mrow><mml:msup><mml:mn>0</mml:mn><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> (formed by repeating ‘0’ <italic>n</italic> times), for <italic>n</italic> &gt; 0, that is immediately flanked by ‘1’ characters. In most cases, a homozygous insertion site at position <italic>i</italic> has a gap of size <italic>k</italic> − 1 starting at position <inline-formula><mml:math id="MM4"><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (all <italic>k</italic> − 1 <italic>k</italic>-mers overlapping the insertion site are absent in <italic>S</italic><sub>d</sub>). We refer to this situation as a canonical insertion site (see <xref ref-type="fig" rid="btu545-F1">Fig. 1</xref>A).
<fig id="btu545-F1" position="float"><label>Fig. 1.</label><caption><p>(<bold>A</bold>) Canonical insertion site. The site is detected by its specific signature: the (<italic>k</italic> − 1) <italic>k</italic>-mers spanning the insertion site are missing in the sequence with the insertion (here <italic>k</italic> = 6), these <italic>k</italic>-mers are represented as red segments. (<bold>B</bold>) Fuzzy insertion site. Insertion ends with the same nucleotides (TG) present on the left of the site. In dashed lines, an alternative insertion site. (<bold>C</bold>) Heterozygous insertion site. Flanking <italic>k</italic>-mers (in black) surrounding a heterozygous site respectively have two right branching <italic>k</italic>-mers (for the <italic>k</italic>-mer on the left of the site) and two left-branching <italic>k</italic>-mers (for the right <italic>k</italic>-mer)</p></caption><graphic xlink:href="btu545f1p"/></fig></p>
        <p>A gap may be shorter than <italic>k</italic> − 1, for instance, when the prefix of the inserted sequence <italic>I</italic> exactly matches the prefix of the sequence to the right of the insertion site (see <xref ref-type="fig" rid="btu545-F1">Fig. 1</xref>B). More generally, if the longest common prefix of <italic>I</italic> and <inline-formula><mml:math id="MM5"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is of size <italic>r</italic><sub>1</sub> and the longest common suffix of <italic>I</italic> and <inline-formula><mml:math id="MM6"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mo>…</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is of size <italic>r</italic><sub>2</sub>, then the size of the gap is <inline-formula><mml:math id="MM7"><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. It is important to note that when <italic>r</italic><sub>1</sub> or <italic>r</italic><sub>2</sub> is greater than 0, with only sequences <italic>S<sub>d</sub></italic> and <italic>S<sub>r</sub></italic> at hand, it is not possible to localize precisely the insertion site, as it can be at any location in <inline-formula><mml:math id="MM8"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. We refer to such sites as <italic>fuzzy sites</italic>. Homozygous insertion sites are called when gaps of size in the range <inline-formula><mml:math id="MM9"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> are detected, with <italic>r</italic> being a user-defined parameter indicating the largest allowed repeat at the insertion.</p>
        <p>The size of the gap is an important criterion to detect homozygous insertion sites, as other types of variants also yield gaps. SNPs create gaps of size exactly <italic>k</italic> and deletions of length <italic>d</italic> yield gaps of size <inline-formula><mml:math id="MM10"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Variants that are separated by less than <italic>k</italic> nucleotides yield longer gaps. In fact, only new junctions between existing sequences can yield gaps of size <inline-formula><mml:math id="MM11"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>, which is the case for insertion events, but also for inversion or translocation sites. Finally, gaps of various sizes may also appear due to insufficient read coverage or non-uniqueness of <italic>k</italic>-mers inside the reference genome. These effects are controlled by the value of <italic>k</italic>, which is a parameter of our method.</p>
      </sec>
      <sec id="SEC2.2.2">
        <title>2.2.2 Heterozygous insertions</title>
        <p>While heterozygous insertions sites do not yield gaps, flanking <italic>k</italic>-mers at these sites still exhibit features that can be detected. The left flanking <italic>k</italic>-mer of a heterozygous insertion site has at least two out-neighbors in the de Bruijn graph: one neighbor in the reference sequence and at least one other neighbor that is a prefix of the inserted sequence. Similarly, the right flanking <italic>k</italic>-mer has at least two in-neighbors with similar properties (see <xref ref-type="fig" rid="btu545-F1">Fig. 1</xref>C). As in the homozygous case, small repetitions at the extremities of inserted sequences slightly alter the pattern. The left flanking <italic>k</italic>-mer may overlap the right flanking <italic>k</italic>-mer in the reference genome. MindTheGap detects heterozygous insertion sites by scanning the reference genome and testing neighborhoods of putative left and right flanking <italic>k</italic>-mers whose distance from one another is comprised between <italic>k</italic> – <italic>r</italic> and <italic>k</italic>, <italic>r</italic> being the same user-defined parameter as for homozygous insertions, indicating the largest allowed repeat at the insertion.</p>
        <p>Heterozygous SNPs and deletions yield similar patterns, but the left and right flanking <italic>k</italic>-mers are further separated from each other (<italic>k</italic> + 1 nucleotides apart for SNPs and 1-bp deletions, <inline-formula><mml:math id="MM12"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> nucleotides apart for deletions of size <italic>d</italic>). However, heterozygous inversions and translocations do exhibit identical patterns. Also, inexact repetitions in the reference genome create branching <italic>k</italic>-mers, which may yield by chance the same pattern as a heterozygous insertion. To reduce this effect, we apply an additional filter: the <italic>k</italic> − 1 suffix (resp. prefix) of the right (resp. left) flanking <italic>k</italic>-mer must have less than <italic>h</italic> occurrences in the reference genome. When <italic>h</italic> is set to 1, this prevents the detection of patterns that may be generated by repetitions in the reference genome alone, in absence of any sequence variants.</p>
      </sec>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Fill module: assembly of inserted sequences</title>
      <p>The third step of M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> is called the <italic>fill</italic> module. Starting from a known insertion site represented by flanking <italic>k</italic>-mers (<italic>L</italic>, <italic>R</italic>), the module performs <italic>de novo</italic> assembly to attempt to reconstruct the inserted sequence between <italic>L</italic> and <italic>R</italic>. In a nutshell, a graph of contigs is constructed by performing breadth-first traversal of <italic>k</italic>-mers, starting from <italic>L</italic>. The traversal is halted when graph becomes too complex. Then, all the contigs in the graph are searched for the presence of <italic>R</italic>. All paths between <italic>L</italic> and the contigs containing <italic>R</italic> are enumerated, and one or more putative insertion sequences are returned (see <xref ref-type="fig" rid="btu545-F2">Fig. 2</xref>).</p>
      <p>More specifically, insertions are assembled using the algorithm of Minia (<xref rid="btu545-B6" ref-type="bibr">Chikhi and Rizk, 2013</xref>; <xref rid="btu545-B20" ref-type="bibr">Salikhov <italic>et al.</italic>, 2013</xref>). Assembly is performed by traversing the graph from a given starting <italic>k</italic>-mer in a breadth-first fashion. A consensus sequence (contig) is generated by skipping over certain motifs, such as bubbles (putative short variants) and tips (putative errors). This Minia assembly procedure stops whenever a contig cannot be unambiguously extended.</p>
      <p>A graph of contigs is constructed for each insertion site (<italic>L</italic>, <italic>R</italic>) as follows. First, an initial contig <italic>c<sub>L</sub></italic> is constructed by calling the Minia assembly procedure from the <italic>L k</italic>-mer. Given a contig <italic>c</italic> (initially <italic>c</italic> = <italic>c<sub>L</sub></italic>), the four putative neighbors of the last <italic>k</italic>-mer of <italic>c</italic> are examined. If no neighbor is present, indicating that <italic>c</italic> could not be extended, then no further action is performed for this contig. Otherwise, if two or more neighbors are present in the data structure, new contigs will be constructed starting from each of these neighbors. Directed edges will be inserted from <italic>c</italic> to these new contigs. This process goes on to construct the contig graph in breadth-first order until a maximum number of contigs (parameter <italic>n</italic>, usually set to 100) is reached, or a maximal depth (parameter <italic>i</italic>, usually set to 10 kb and computed by counting nucleotides in contigs) is reached.</p>
      <p>An exhaustive search is performed to find occurrences of <italic>R</italic> within all contigs in graph, as an exact match (default behavior) or up to a constant number of mismatches. All possible paths between <italic>L</italic> and <italic>R</italic> are exhaustively enumerated (i.e. putative insertions). If all paths spell pair-wise identical sequences (minimum identity of 80%), then one of them is returned. Otherwise, the insertion site is considered to be unsuccessfully assembled and all paths are returned. The <italic>fill</italic> module is performed bi-directionally, i.e. should the (<italic>L</italic>, <italic>R</italic>) insertion site yield no path, then the module attemps to assemble the <inline-formula><mml:math id="MM13"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>rc</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mtext>rc</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> insertion, where <inline-formula><mml:math id="MM14"><mml:mrow><mml:mtext>rc</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the reverse-complement operation.
<fig id="btu545-F2" position="float"><label>Fig. 2.</label><caption><p>Fill module. A graph of contig is constructed from the left flanking kmer <italic>L</italic>, in a breadth-first search order. Construction stops when a maximum number of nodes is reached, or when a branch becomes too deep. The right flanking kmer <italic>R</italic> is searched within all nodes, finally all paths (in blue) between <italic>L</italic> and <italic>R</italic> are outputted as putative insertions</p></caption><graphic xlink:href="btu545f2p"/></fig></p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Evaluation protocol</title>
      <sec id="SEC2.4.1">
        <title>2.4.1 Simulated datasets</title>
        <p>To evaluate MindTheGap, we generated artificial read datasets and reference genomes based on real genomes. First, we simulated sequencing reads for a real genome (the donor). Then, another genome (the reference) was obtained by simulating non-overlapping deletions from a copy of the donor genome. Deletion locations were sampled uniformly along the sequence. These deletions correspond to homozygous insertions in the donor. To simulate heterozygous insertions, reads were sampled in equal numbers from the donor and the reference genomes. Sequencing was simulated with Wgsim from the Samtools package (<xref rid="btu545-B14" ref-type="bibr">Li <italic>et al.</italic>, 2009</xref>) using the following parameters: paired-end mode with 2 × 100 bp reads, an insert size of 300 bp (std = 50) and a base error rate of 0.01. Coverage was set to 40× for homozygous datasets and 60× for heterozygous datasets.</p>
        <p>Three different genomes were used: <italic>Escherichia coli K12</italic> (4.6 Mb), <italic>C</italic><italic>.</italic><italic>elegans</italic> (100.3 Mb) and the human chromosome 22 (35 Mb without N bases). For each of them, simulated datasets were generated with homozygous or heterozygous deletions of varying sizes.</p>
      </sec>
      <sec id="SEC2.4.2">
        <title>2.4.2 Assessment of results</title>
        <p>Positions of found breakpoints are compared with positions of introduced deletions in the genome. A breakpoint is considered as true positive (TP) if its location is at most 10 bp from a generated deletion position. This margin is meant to take into account <italic>fuzzy sites</italic>, for which breakpoints are not necessarily found at the exact position of the corresponding deletions (see Section 2). For each TP breakpoint, a global alignment between the assembled inserted sequence and the real sequence of the deletion is then performed with <italic>needle</italic> from the EMBOSS tool suite. We consider the filled sequence as TP if the alignment shows &gt;90% of identity. Finally, the recall is the number of TP filled sequences over the number of simulated insertions, and the precision is the number of TP filled sequences over the number of filled insertions.</p>
      </sec>
      <sec id="SEC2.4.3">
        <title>2.4.3 Real sequencing data</title>
        <p>Paired-end sequencing data from <italic>C.</italic><italic>elegans</italic> strain N2 were downloaded from SRA (accession SRX026594). This dataset is composed of 33.8 M Illumina 2 × 100 bp read pairs (insert size of 350 bp), representing roughly 70× of coverage on the 100.3 Mb reference sequence of <italic>C.</italic><italic>elegans</italic> (downloaded from NCBI version WBcel235). As we did not find any validated dataset of known large insertions for this genome, we simulated insertion variants following the protocol of simulated data: 1000 regions of a given size (here 1–100 bp or 1 kb) were deleted in the reference genome, corresponding to homozygous insertion variants in the N2 donor genome.</p>
        <p>Sequencing data of human individual NA12878 from <xref rid="btu545-B7" ref-type="bibr">DePristo <italic>et al.</italic>, 2011</xref>, consisting of 2.8 G Illumina 2 × 101 bp read pairs, was downloaded from EBI (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/technical/working/20101201_cg_NA12878/NA12878.hiseq.wgs.bwa.raw.bam">ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/technical/working/20101201_cg_NA12878/NA12878.hiseq.wgs.bwa.raw.bam</ext-link>). The human genome reference assembly (NCBI36 hg18) was downloaded from UCSC Genome Browser. A set of predicted or validated large insertions were obtained from Supplementary Material of <xref rid="btu545-B13" ref-type="bibr">Kim <italic>et al.</italic>, 2013</xref>. This set contained 30 validated insertions from the study of <xref rid="btu545-B12" ref-type="bibr">Kidd <italic>et al.</italic> (2010)</xref> and 44 which were predicted by <xref rid="btu545-B13" ref-type="bibr">Kim <italic>et al.</italic> (2013)</xref> based on the alignments of 40 kb sequenced fosmids from this individual to the hg18 reference genome. These are long insertions (median size of 5 kb); 68 are &gt;1 kb and 4 are &gt;10 kb. Among these, 61 are predicted as novel insertions, 7 as duplicated and the remaining ones have an unknown status.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 RESULTS</title>
    <sec sec-type="results">
      <title>3.1 Results on simulated datasets</title>
      <p>M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> was applied on several simulated datasets to precisely estimate its recall and precision. This enabled to quantify the impact of different levels of genome complexity, to independently evaluate each module and modes (detection versus assembly, homozygous versus heterozygous) and to analyze the range of insertion sizes M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> is able to detect and assemble.</p>
      <sec id="SEC3.1.1">
        <title>3.1.1 High recall and precision in homozygous mode</title>
        <p>For insertions of 1 kb, M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> recovered between 65 and 98.4% of the simulated insertions, depending mainly on the complexity of the studied genome (<xref ref-type="table" rid="btu545-T1">Table 1</xref>). Almost all predicted homozygous insertions are true-positive results, resulting in high precision (consistently above 97%). <xref ref-type="table" rid="btu545-T1">Table 1</xref> shows that almost all insertion sites were detected by the find module in homozygous mode. However, 19–35% of detected insertions could not be assembled by the fill module.
<table-wrap id="btu545-T1" position="float"><label>Table 1.</label><caption><p>Precision and recall results for M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> in homozygous mode on simulated and real datasets</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="2" colspan="1">Dataset</th><th rowspan="2" colspan="1">Recall (%)</th><th rowspan="2" colspan="1">Precision (%)</th><th rowspan="2" colspan="1">N sim.</th><th align="center" colspan="2" rowspan="1">Find module<hr/></th><th align="center" colspan="2" rowspan="1">Fill module<hr/></th></tr><tr><th rowspan="1" colspan="1">TP</th><th rowspan="1" colspan="1">FP</th><th rowspan="1" colspan="1">TP</th><th rowspan="1" colspan="1">FP</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1"><italic>E.coli</italic> simulated dataset</td><td rowspan="1" colspan="1">98.4</td><td rowspan="1" colspan="1">99.8</td><td rowspan="1" colspan="1">500</td><td rowspan="1" colspan="1">499</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">492</td><td rowspan="1" colspan="1">1</td></tr><tr><td rowspan="1" colspan="1"><italic>C.elegans</italic> simulated dataset</td><td rowspan="1" colspan="1">79.5</td><td rowspan="1" colspan="1">97.3</td><td rowspan="1" colspan="1">1000</td><td rowspan="1" colspan="1">992</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">795</td><td rowspan="1" colspan="1">22</td></tr><tr><td rowspan="1" colspan="1"><italic>C.elegans</italic> real reads, simulated insertions</td><td rowspan="1" colspan="1">81.1</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">1000</td><td rowspan="1" colspan="1">980</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">811</td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">Human chromosme 22 simulated dataset</td><td rowspan="1" colspan="1">64.6</td><td rowspan="1" colspan="1">99.4</td><td rowspan="1" colspan="1">1000</td><td rowspan="1" colspan="1">1000</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">646</td><td rowspan="1" colspan="1">4</td></tr></tbody></table><table-wrap-foot><fn id="btu545-TF1"><p><italic>Note</italic>. Simulated insertions of size 1000 (homozygous). The number of deletions simulated in the reference genome appears in the column ‘N sim.’</p></fn></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="SEC3.1.2">
        <title>3.1.2 Varying insertion lengths</title>
        <p><xref ref-type="fig" rid="btu545-F3">Figure 3</xref> shows that M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> can detect and assemble insertions of any size. We observed that the performance of the <italic>find</italic> module is independent of the size of the insertions: recall of the <italic>find</italic> module never fell below 98.5% (data not shown), without any false positive, even for the human chromosome 22 dataset. However, lower recalls are due to the <italic>fill</italic> module failing to assemble longer insertions. For small insertions (&lt;100 bp), M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> obtained high recall and precision for all simulated datasets.
<fig id="btu545-F3" position="float"><label>Fig. 3.</label><caption><p>Results of M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> and SOAPindel for several insertion sizes and several genome complexities. SOAPindel results are shown only for insertions of 1–100 bp (first two shaded bars in of each genome section), as it could detect only insertions &lt;189 bp. Best results of SOAPindel were obtained with <italic>k</italic> parameter set to 31 (shown here) rather than 51. M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> best results were obtained with <italic>k</italic> set to 31 for <italic>E.coli</italic> datasets and 51 for <italic>C.elegans</italic> and human chromosome 22</p></caption><graphic xlink:href="btu545f3p"/></fig></p>
        <p>Only 650 over 1000 insertions of 1 kb could be assembled in the chromosome 22, and among these, 646 showed &gt;90% identity with the original deleted sequences. This was likely because of the high repeat content of this chromosome. We observed that the insertions M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> fails to assemble generally correspond to complex graph of contigs, containing many exact repeats longer than <inline-formula><mml:math id="MM15"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec id="SEC3.1.3">
        <title>3.1.3 Heterozygous mode</title>
        <p>To evaluate the heterozygous mode of MindTheGap, we simulated datasets with only heterozygous insertions (see Section 2.4). Our analysis in Methods showed that heterozygous insertion sites were likely to be more difficult to detect and distinguish from genomic repetitions than heterozygous insertions sites. <xref ref-type="table" rid="btu545-T2">Table 2</xref> shows that for the human and <italic>C.</italic><italic>elegans</italic> simulated datasets, both recall and precision are significantly below those in homozygous mode. Further investigation showed that the low recall is owing to poor performance of the find module. We found that the results in this module were sensitive to the values of parameters <italic>k</italic>, <italic>r</italic> (maximal repeat size at fuzzy sites) and <italic>h</italic> (maximal number of occurrences of flanking kmers in the reference genome). Setting <italic>k</italic> to a higher value and <italic>r</italic> and <italic>h</italic> to smaller values (here: <italic>k</italic> = 51, <italic>r</italic> = 2, <italic>h</italic> = 1) enabled to reach a precision ∼97%, at the cost of a noticeably lower recall. However, using a high <italic>k</italic> is detrimental to the fill module, due to read coverage being halved in heterozygous insertions. <xref ref-type="table" rid="btu545-T2">Table 2</xref> shows that on these datasets, the fill module assembles significantly more insertions with <italic>k</italic> = 31.
<table-wrap id="btu545-T2" position="float"><label>Table 2.</label><caption><p>Precision and recall results for M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> in heterozygous mode on simulated datasets, containing each 1000 simulated heterozygous insertions of size 1000 bp</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="2" colspan="1">Dataset</th><th rowspan="2" colspan="1">Recall (%)</th><th rowspan="2" colspan="1">Precision (%)</th><th rowspan="2" colspan="1">N sim.</th><th align="center" colspan="2" rowspan="1">Find module<hr/></th><th align="center" colspan="2" rowspan="1">Fill module <italic>k</italic> = 51<hr/></th><th align="center" colspan="2" rowspan="1">Fill module <italic>k</italic> = 31<hr/></th></tr><tr><th rowspan="1" colspan="1">TP</th><th rowspan="1" colspan="1">FP</th><th rowspan="1" colspan="1">TP</th><th rowspan="1" colspan="1">FP</th><th rowspan="1" colspan="1">TP</th><th rowspan="1" colspan="1">FP</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1"><italic>C.elegans</italic> dataset</td><td rowspan="1" colspan="1">59.9</td><td rowspan="1" colspan="1">93.4</td><td rowspan="1" colspan="1">1000</td><td rowspan="1" colspan="1">807</td><td rowspan="1" colspan="1">11</td><td rowspan="1" colspan="1">310</td><td rowspan="1" colspan="1">80</td><td rowspan="1" colspan="1">599</td><td rowspan="1" colspan="1">42</td></tr><tr><td rowspan="1" colspan="1">Human chromosome 22 dataset</td><td rowspan="1" colspan="1">35.5</td><td rowspan="1" colspan="1">89.0</td><td rowspan="1" colspan="1">1000</td><td rowspan="1" colspan="1">816</td><td rowspan="1" colspan="1">28</td><td rowspan="1" colspan="1">226</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">355</td><td rowspan="1" colspan="1">44</td></tr></tbody></table><table-wrap-foot><fn id="btu545-TF2"><p><italic>Note</italic>. Parameter <italic>r</italic> was set to 2, and assembled insertions smaller than 5 bp were filtered out.</p></fn></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="SEC3.1.4">
        <title>3.1.4 Comparison with SOAPindel</title>
        <p>On insertions of size 1–100 bp, SOAPindel shows similar recall and precision to M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> (<xref ref-type="fig" rid="btu545-F3">Fig. 3</xref>). However, SOAPindel is limited in the size of detectable insertions, depending on the insert size of the reads: given our simulation parameters, we observed that SOAPindel recall decreased for insertions larger than 175 bp, and the largest insertion detected was of length 189 bp. Noticeably, the performance of SOAPindel was independent of the genotype of insertions.</p>
      </sec>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Evaluation on a real sequencing dataset of <italic>C.</italic><italic>elegans</italic></title>
      <p>To evaluate the impact of real reads and a real donor genome with some degree of polymorphism in the reference genome, M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> was run on a <italic>C.</italic><italic>elegans</italic> strain N2 read dataset against the reference genome containing simulated deletions. This is to simulate homozygous insertion variants in the donor genome. Additional insertions variants are likely to exist <italic>C.</italic><italic>elegans</italic> strain. Thus, the number of FP could not be evaluated, as the true set of insertions present in these reads is unknown.</p>
      <p>For 1 kb insertion variants, 81.1% were correctly predicted and assembled by M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> (<xref ref-type="table" rid="btu545-T1">Table 1</xref>). Compared with the fully simulated dataset on the same simulated insertions, the <italic>find</italic> module missed more insertion sites, whereas the <italic>fill</italic> module had a better recall of inserted sequences. The first observation could be explained by small polymorphism near the insertion breakpoints that generated longer gaps (see Section 2), whereas the second by a higher read coverage in this dataset.</p>
      <p>Additionally, we compared M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> and SOAPindel on this dataset with 1–100 bp simulated insertions. Recall values were similar for both tools: 89% and 91%, respectively.</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Application on real insertions of human individual NA12878</title>
      <p>To evaluate the ability of M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> to recover real insertions in real data, we executed it on a human individual NA12878 dataset containing 2.8 G 100 bp reads. As the coverage was high, parameter <italic>k</italic> was empirically set to 63 and <italic>t</italic> to 5 (<italic>k</italic>-mers with less than five occurrences were discarded). Predictions were then compared with a set of 74 large insertions predicted by alignment of fosmid sequences to the reference hg18 genome (see Section 2.4).</p>
      <p>20 insertion sites were recovered by the <italic>find</italic> module. No heterozygous insertions were predicted. We set <italic>r</italic> = 15, which enabled to find twice more sites than with <italic>r</italic> = 5. This suggests that real insertions contain longer repeated sequences at their breakpoints than expected in a random simulation. By analyzing paired-end reads that mapped near each fosmid-predicted breakpoint, we could infer the genotypes: only 23 breakpoints could be confidently assigned to a homozygous genotype (i.e. with less than five read pairs spanning the breakpoint). The <italic>find</italic> module recovered 11 of them. Of the remaining 12 likely homozygous sites, the breakpoints of 8 of them were included in a large gap (<inline-formula><mml:math id="MM16"><mml:mrow><mml:mo>≥</mml:mo><mml:mspace width="-.2em"/><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>) in the reference binary string. This suggests that these sites were close to other form of polymorphism, which would explain why M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> did not detect them.</p>
      <p>Among the 20 detected insertions by the <italic>find</italic> module, the <italic>fill</italic> module succeeded in reconstructing correctly two inserted sequences of sizes 4137 bp and 6729 bp, with respectively 99.9 and 99.8% identity to the fosmid sequences. This corresponds to a recall of 18%, when comparing with the 11 true homozygous insertions that were detected by the <italic>find</italic> module. This recall value is similar to one obtained on simulated insertions of 5 kb with the same read dataset (22%, data not shown).</p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 Time and memory performance</title>
      <p><xref ref-type="fig" rid="btu545-F4">Figure 4</xref> shows the total runtime and maximal memory used by M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> and SOAPindel on the real <italic>C.</italic><italic>elegans</italic> dataset. The machine used for all tests is a 12-core Intel E5-2640 @ 2.50 GHz with 192 GB of memory. For M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc>, the breakdown of the three steps <italic>index</italic>, <italic>find</italic> and <italic>fill</italic> shows that the major part of running time is spent on the <italic>index</italic> step. For SOAPindel, the time required to map the reads to the reference with <monospace>bwa</monospace> is included in the total time; however, SOAPindel alone remains slower than M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> as a whole. SOAPindel used eight threads and M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> only one.
<fig id="btu545-F4" position="float"><label>Fig. 4.</label><caption><p>Time (real time in minutes reported by the unix command <monospace>time</monospace>) and peak of memory used by M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> (with <italic>k</italic> = 51) and SOAPindel (parameter <italic>k</italic> = 51) on the <italic>C.elegans</italic> real sequencing dataset (SRX026594). Peak of memory of SOAPindel approach was reached by the SOAPindel software itself (not <monospace>bwa</monospace>)</p></caption><graphic xlink:href="btu545f4p"/></fig></p>
      <p>Importantly, even though M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> stores in memory the whole de Bruijn graph of the <italic>C.</italic><italic>elegans</italic> read dataset, its memory peak (0.7 GB) is six times lower than SOAPindel. On the NA12878 dataset with 2.8 billion reads, M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> also proved to scale efficiently: the <italic>index</italic>/<italic>find</italic>/<italic>fill</italic> steps respectively took 32/6/7 h, with peak memory usage of 6/14/6 GB.</p>
    </sec>
  </sec>
  <sec>
    <title>4 DISCUSSION</title>
    <p>M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> is the first integrated method to detect and assemble insertion variants of any size and any type, using modest computing resources. The <italic>find</italic> module of M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> differs from most other existing methods by not relying on read mapping. Instead, the de Bruijn graph of reads is compared against the reference sequence, which enables fast and low-memory analysis. However, one current limitation of the <italic>find module</italic> is that it fails to detect insertions when other polymorphism occurs near the insertion site. Improvements to waive this limitation are under development, based on a more detailed analysis of gaps longer than <italic>k</italic>. Furthermore, the method could also be used to output SNPs and other types of structural variants.</p>
    <p>Long insertion variants are challenging to detect and assemble; thus, there is a shortage of tools to compare M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> with. We compared our results with SOAPindel, which is a popular indel detection software limited to short insertions. The NovelSeq software (<xref rid="btu545-B9" ref-type="bibr">Hajirasouliha <italic>et al.</italic>, 2010</xref>) is designed to find and assemble large insertions, and therefore would have been another candidate for comparison. However, despite several attempts and reaching out to the author, we were unable to run the software successfully on any of our datasets (the <monospace>novelseq_cluster</monospace> step ran indefinitely). NovelSeq relies on a complex pipeline, and we conjecture that it may be tailored to specific data types. While most other insertion detection methods require to run external software, M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> is stand-alone and is therefore easy to use. If needed, the modular organization of M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc> allows users to replace the <italic>find</italic> module with the results of a classical insertion detection based on paired-end mapping. The <italic>fill</italic> module could also be used as a <italic>de novo</italic> assembly finishing step, i.e. gap-filling between adjacent contigs in scaffolds, although we did not evaluate its performance for this task.</p>
    <p>One important design choice for the <italic>fill</italic> module is to perform assembly with all the <italic>k</italic>-mers in the read dataset. This enables to assemble not only novel insertions, but also duplicated insertions and transposition events. Classification of assembled insertions into the different event types is not done by M<sc>ind</sc>T<sc>he</sc>G<sc>ap</sc>, but can be done by re-mapping insertions to the reference genome. One drawback of considering all reads during insertion assembly is that the de Bruijn graph becomes more complex to analyze. An important future work will be to improve the recall of the <italic>fill</italic> module by using paired-end reads information to guide traversal of contig graphs. As repeated regions are notoriously difficult to assemble, we anticipate that our approach might not be effective for mobile element insertions. However, there exist methods tailored to the assembly of MEI, based on local assembly with recruitment of mate reads.</p>
    <p>Our tests on the NA12878 dataset showed there is room for improvement: only two long homozygous insertions were successfully assembled out of 23 predicted ones. We postulate that (i) polymorphism or repetitions near the insertion sites hinder detection by the <italic>find</italic> module, and (ii) the complexity of the human genome makes <italic>de novo</italic> assembly of large contigs difficult. As no other tool was able to assemble long insertions, we could not assess whether our results were owing to weaknesses in our method, or to specificities of this particular dataset (complex insertion sequences or mispredicted insertions).</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors are grateful to Raluca Uricaru for her help and advice.</p>
    <p><italic>Funding</italic>: This work was supported by the <funding-source>ANR (French National Research Agency)</funding-source>, <award-id>ANR-12-BS02-0008</award-id><italic>Colib’read</italic> project, <award-id>ANR-12-EMMA-0019-01</award-id>
<italic>GATB</italic> project and <award-id>ANR-11-BSV7-005-01</award-id>
<italic>SPECIAPHID</italic>.</p>
    <p><italic>Conflict of interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu545-B1">
      <element-citation publication-type="journal">
        <collab>1000 Genomes Project Consortium, <italic>et al.</italic></collab>
        <article-title>A map of human genome variation from population-scale sequencing</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>467</volume>
        <fpage>1061</fpage>
        <lpage>1073</lpage>
        <pub-id pub-id-type="pmid">20981092</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albers</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dindel: Accurate indel calls from short-read data</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>961</fpage>
        <lpage>973</lpage>
        <pub-id pub-id-type="pmid">20980555</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alkan</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome structural variation discovery and genotyping</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>363</fpage>
        <lpage>376</lpage>
        <pub-id pub-id-type="pmid">21358748</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Breakdancer: an algorithm for high-resolution mapping of genomic structural variation</article-title>
        <source>Nat. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>677</fpage>
        <lpage>681</lpage>
        <pub-id pub-id-type="pmid">19668202</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tigra: a targeted iterative graph routing assembler for breakpoint assembly</article-title>
        <source>Genome Res.</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>310</fpage>
        <lpage>317</lpage>
        <pub-id pub-id-type="pmid">24307552</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chikhi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rizk</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Space-efficient and exact de bruijn graph representation based on a bloom filter</article-title>
        <source>Algorithms Mol. Biol.</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>22</fpage>
        <pub-id pub-id-type="pmid">24040893</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation dna sequencing data</article-title>
        <source>Nat. Genet.</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Kazazian</surname>
            <given-names>HH</given-names>
            <suffix>Jr.</suffix>
          </name>
        </person-group>
        <article-title>Whole-genome resequencing allows detection of many rare line-1 insertion alleles in humans</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>985</fpage>
        <lpage>990</lpage>
        <pub-id pub-id-type="pmid">20980553</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hajirasouliha</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection and characterization of novel sequence insertions using paired-end next-generation sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1277</fpage>
        <lpage>1283</lpage>
        <pub-id pub-id-type="pmid">20385726</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hormozdiari</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation variationhunter: combinatorial algorithms for transposon insertion discovery</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>i350</fpage>
        <lpage>i357</lpage>
        <pub-id pub-id-type="pmid">20529927</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iqbal</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly and genotyping of variants using colored de bruijn graphs</article-title>
        <source>Nat. Genet.</source>
        <year>2012</year>
        <volume>44</volume>
        <fpage>226</fpage>
        <lpage>232</lpage>
        <pub-id pub-id-type="pmid">22231483</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kidd</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A human genome structural variation sequencing resource reveals insights into mutational mechanisms</article-title>
        <source>Cell</source>
        <year>2010</year>
        <volume>143</volume>
        <fpage>837</fpage>
        <lpage>847</lpage>
        <pub-id pub-id-type="pmid">21111241</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reprever: resolving low-copy duplicated sequences using template driven assembly</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>e128</fpage>
        <pub-id pub-id-type="pmid">23658221</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and samtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Soapindel: efficient identification of indels from short paired reads</article-title>
        <source>Genome Res.</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>195</fpage>
        <lpage>200</lpage>
        <pub-id pub-id-type="pmid">22972939</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medvedev</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational methods for discovering structural variation with next-generation sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <issue>11 Suppl.</issue>
        <fpage>S13</fpage>
        <lpage>S20</lpage>
        <pub-id pub-id-type="pmid">19844226</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Narzisi</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate de novo and transmitted indel detection in exome-capture data using microassembly</article-title>
        <source>Nat. Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>1033</fpage>
        <lpage>1036</lpage>
        <pub-id pub-id-type="pmid">25128977</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pabinger</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey of tools for variant analysis of next-generation genome sequencing data</article-title>
        <source>Brief. Bioinform.</source>
        <year>2013</year>
        <volume>15</volume>
        <fpage>256</fpage>
        <lpage>278</lpage>
        <pub-id pub-id-type="pmid">23341494</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parrish</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly of non-unique insertion content using next-generation sequencing</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>Suppl. 6</issue>
        <fpage>S3</fpage>
        <pub-id pub-id-type="pmid">21989261</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salikhov</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Using cascading bloom filters to improve the memory usage for de brujin graphs</article-title>
        <source>Algorithms Bioinformatics</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>364</fpage>
        <lpage>376</lpage>
      </element-citation>
    </ref>
    <ref id="btu545-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sindi</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A geometric approach for classification and comparison of structural variants</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>i222</fpage>
        <lpage>i230</lpage>
        <pub-id pub-id-type="pmid">19477992</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stewart</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comprehensive map of mobile element insertion polymorphisms in humans</article-title>
        <source>PLoS Genet.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1002236</fpage>
        <pub-id pub-id-type="pmid">21876680</pub-id>
      </element-citation>
    </ref>
    <ref id="btu545-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pindel: a pattern growth approach to detect break points of large deletions and medium sized insertions from paired-end short reads</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2865</fpage>
        <lpage>2871</lpage>
        <pub-id pub-id-type="pmid">19561018</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
