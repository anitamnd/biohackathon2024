<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7738244</article-id>
    <article-id pub-id-type="publisher-id">3883</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03883-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NDRindex: a method for the quality assessment of single-cell RNA-Seq preprocessing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Xiao</surname>
          <given-names>Ruiyu</given-names>
        </name>
        <address>
          <email>zero_maker@163.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Guoshan</given-names>
        </name>
        <address>
          <email>1098934672@qq.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Wanqian</given-names>
        </name>
        <address>
          <email>guowanqian@hit.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2318-432X</contrib-id>
        <name>
          <surname>Jin</surname>
          <given-names>Shuilin</given-names>
        </name>
        <address>
          <email>jinsl@hit.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.19373.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 0193 3564</institution-id><institution>School of Computer Science and Technology, </institution><institution>Harbin Institute of Technology, </institution></institution-wrap>Zhejiang, China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.19373.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 0193 3564</institution-id><institution>State Key Laboratory of Urban Water Resource and Environment, </institution><institution>Harbin Institute of Technology, </institution></institution-wrap>Harbin, China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.19373.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 0193 3564</institution-id><institution>School of Mathematics, </institution><institution>Harbin Institute of Technology, </institution></institution-wrap>Harbin, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <issue>Suppl 16</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. JP was not involved in the peer review of any articles they had co-published. No other competing interests were declared.</issue-sponsor>
    <elocation-id>540</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>11</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Single-cell RNA sequencing can be used to fairly determine cell types, which is beneficial to the medical field, especially the many recent studies on COVID-19. Generally, single-cell RNA data analysis pipelines include data normalization, size reduction, and unsupervised clustering. However, different normalization and size reduction methods will significantly affect the results of clustering and cell type enrichment analysis. Choices of preprocessing paths is crucial in scRNA-Seq data mining, because a proper preprocessing path can extract more important information from complex raw data and lead to more accurate clustering results.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We proposed a method called NDRindex (Normalization and Dimensionality Reduction index) to evaluate data quality of outcomes of normalization and dimensionality reduction methods. The method includes a function to calculate the degree of data aggregation, which is the key to measuring data quality before clustering. For the five single-cell RNA sequence datasets we tested, the results proved the efficacy and accuracy of our index.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">This method we introduce focuses on filling the blanks in the selection of preprocessing paths, and the result proves its effectiveness and accuracy. Our research provides useful indicators for the evaluation of RNA-Seq data.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell</kwd>
      <kwd>RNA-seq</kwd>
      <kwd>Normalization</kwd>
      <kwd>Dimension reduction</kwd>
      <kwd>Preprocess path</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>11971130</award-id>
        <principal-award-recipient>
          <name>
            <surname>Jin</surname>
            <given-names>Shuilin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Open Project of State Key Laboratory of Urban Water Resource and Environment of Harbin Institute of Technology</institution>
        </funding-source>
        <award-id>ES201602</award-id>
        <principal-award-recipient>
          <name>
            <surname>Jin</surname>
            <given-names>Shuilin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <conference xlink:href="http://phenomics.uky.edu/bibm_biok2019/">
      <conf-name>Biological Ontologies and Knowledge bases workshop 2019</conf-name>
      <conf-loc>San Diego, CA, USA</conf-loc>
      <conf-date>18-21 November 2019</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec2">
    <title>Background</title>
    <p id="Par8">Nowadays, single-cell RNA sequencing is being generally used in biology and iatrology related areas. The efficient methods used in COVID-19 researches these days would be a good example. Many researchers used single cell RNA sequencing data to determine the sensitivity of organs other than the lungs, and found that the heart, esophagus, kidney, and ileum are also munitive organs [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. One of the main advantages of single-cell RNA sequencing (scRNA-Seq) is that it can be clustered unsupervised to determine cell types [<xref ref-type="bibr" rid="CR5">5</xref>]. Normalization and dimension reduction methods are typically used for data preprocessing before clustering procedure. The normalization methods are designed to eliminate technical noise in scRNA-Seq data. Previously, many advanced normalization methods were proposed to preprocess scRNA-Seq data, such as TMM [<xref ref-type="bibr" rid="CR6">6</xref>], SAMstrt [<xref ref-type="bibr" rid="CR7">7</xref>], Scran [<xref ref-type="bibr" rid="CR8">8</xref>], BASiCS [<xref ref-type="bibr" rid="CR9">9</xref>], SCnorm [<xref ref-type="bibr" rid="CR10">10</xref>] Linnorm [<xref ref-type="bibr" rid="CR11">11</xref>], ORNA [<xref ref-type="bibr" rid="CR12">12</xref>] and FSQN [<xref ref-type="bibr" rid="CR13">13</xref>]. SAMstrt, Scran, SCnorm, Linnorm and TMM preprocesses data by calculating the scaling factor of the gene expression of each cell.</p>
    <p id="Par9">Most single-cell RNA-seq data is sparse, and almost 90% data is zero measurements. so we use dimension reduction methods to convert the high-dimensional data into low-dimensional data. Sammon [<xref ref-type="bibr" rid="CR14">14</xref>] mapping and T-SNE [<xref ref-type="bibr" rid="CR15">15</xref>] are dimension reduction methods that keeps the data manifold unchanged, while principal component analysis (PCA) are designed to extract the important information. Methods like LSPCA [<xref ref-type="bibr" rid="CR16">16</xref>] and ESPCA [<xref ref-type="bibr" rid="CR17">17</xref>] combines traditional PCA with other algorithms to overcome the shortcomings of PCA. In addition, some clustering methods also provide normalization and dimensionality reduction methods, such as Seurat [<xref ref-type="bibr" rid="CR18">18</xref>] and SC3 [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par10">Various normalization and dimension reduction methods use different data processing algorithms and obtain different clustering results. Ideally, normalization and dimension reduction methods should produce high-quality data, and the aggregation results should be meaningful. Due to poor clustering trends, completely random data is not conducive to clustering [<xref ref-type="bibr" rid="CR19">19</xref>]. In order to solve this problem, we propose NDRindex (Normalization and Dimensionality Reduction index) to evaluate the degree of data aggregation. By comparing all combinations of normalization and dimension reduction methods, the data with highest NDRindex will be the selected for further clustering.</p>
  </sec>
  <sec id="Sec3">
    <title>Implementation</title>
    <p id="Par11">As input, NDRindex requires a gene expression matrix, normalization methods and dimension reduction methods. To make this step easier, f NDRindex includes five normalization methods TMM, Linnorm, Scale, Scarn, Seurat and three-dimensional reduction methods PCA, tSNE and Sammon.</p>
    <p id="Par12">Then NDRindex evaluates the data qualities. The prepossessed data with the highest NDRindex score are chose and saved, then outputted.</p>
    <p id="Par13">Finally, clustering techniques (k-menas, hclust, etc.), are applied to the selected data. After that, the clustering result is output. The entire workflow can be described as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow of NDRindex. First, gene expression matrix, normalization methods</p></caption><graphic xlink:href="12859_2020_3883_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par14">The key to the NDRindex method is an algorithm for evaluating data quality. Not all data is suitable for clustering. If the data set does not contain natural clusters, the clustering results will be meaningless, so it is very important to analyze the tendency of data clustering and evaluate its quality [<xref ref-type="bibr" rid="CR19">19</xref>]. If the data set does not contain natural clusters, the clustering results will be meaningless, so it is very important to analyze the tendency of data clustering and evaluate its quality [<xref ref-type="bibr" rid="CR19">19</xref>]. NDRindex algorithm evaluates the cluster tendency by calculating the aggregation degree of data. The higher the degree of clustering, the more points are distributed in a relatively small area, indicating the existence of natural clusters. However, assessing the degree of aggregation is a difficult problem. For example, given two points with the distance 50 cm. If we consider points less than 5 cm apart aggregative, the two points will be considered as two clusters. If we consider points less than 500 cm apart, the two points will probably be considered as one cluster. Thus the degree of aggregation is closely related to the distances of the points and the definition of aggregation. Based on the above assumptions, the NDR index is designed as follows:</p>
    <p id="Par15">Step 1. Calculate the distance matrix and ‘average scale’ of data.</p>
    <p id="Par16">According to experience, if the data spread over a larger area, the definition of ‘aggregative’ should be loosened; if there are more data points, the definition of ‘aggregative’ should be enforced, so it is assumed that the range of data distribution is proportional to the definition of ‘close’, and the number of data points is Inversely proportional to the definition ‘close’. The ‘average scale’ of data is defined as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{M}{{\log_{10} n}}$$\end{document}</tex-math><mml:math id="M2"><mml:mfrac><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2020_3883_Article_IEq1.gif"/></alternatives></inline-formula>, where M is the lower quartile distance of all point pairs and represents the range of data distribution, n is the sample number of the database. When the distance of two points is smaller than the ‘average scale’, they would be considered ‘close’.</p>
    <p id="Par17">Step 2. Clustering and find the point gathering areas.</p>
    <p id="Par18">NDRindex find the point gathering areas by the following step:<list list-type="alpha-lower"><list-item><p id="Par19">Select a point A randomly. Let A as an individual cluster and let cluster number <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K = 1$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3883_Article_IEq2.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par20">Find the point B closest to geometric center of the cluster that A belongs to, if the distance between geometric center and B is smaller than average scale (defined in step1), than add B to the cluster of A and update the geometric center. Otherwise, let B as a new individual cluster, and increase the cluster number K. Repeat step b until all point belongs to a cluster.</p></list-item></list></p>
    <p id="Par21">After that, NDRindex will find some clusters, each represents a point gathering area.</p>
    <p id="Par22">Step 3. Calculating the final index.</p>
    <p id="Par23">For each cluster, the average of the distances from all points to the geometric center is defined as the cluster radius. A smaller cluster radius indicates a smaller and dense point collection area and a larger degree of clustering. Therefore, we define the final index as:<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$NDRindex = 1.0 - \frac{R}{{\frac{M}{{\log_{10} n}}}}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mi>N</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>R</mml:mi><mml:mfrac><mml:mi>M</mml:mi><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2020_3883_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where<disp-formula id="Equb"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R = \frac{{\mathop \sum \nolimits_{i \in set\,of\,all\,clusters} \frac{{\mathop \sum \nolimits_{p \in i} distance\left( {p,geometric\,center\,of\,i} \right)}}{size\,of\,i}}}{K}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.166667em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.166667em"/><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mspace width="0.166667em"/><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.166667em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.166667em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mi>K</mml:mi></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2020_3883_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par24">To reduce randomness, NDRindex runs this algorithm 100 times and takes the average value as the final result.</p>
    <p id="Par25">The procedure below can be described as pseudo-code as Fig. <xref rid="Fig2" ref-type="fig">2</xref> described.<fig id="Fig2"><label>Fig. 2</label><caption><p>Pseudo-code of NDRindex</p></caption><graphic xlink:href="12859_2020_3883_Fig2_HTML" id="MO2"/></fig></p>
  </sec>
  <sec id="Sec4">
    <title>Results</title>
    <p id="Par26">To compare the performance of NDRindex, we applied the method to simulated and real data sets. The simulation dataset contains data of different quality. Some of them have obvious patterns and are suitable for grouping, while others are not. As shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, the results show that our method can clearly distinguish them. For real datasets, we select five widely used single-cell RNA-Seq datasets, five normalization methods (TMM [<xref ref-type="bibr" rid="CR6">6</xref>], Linnorm [<xref ref-type="bibr" rid="CR11">11</xref>], scran [<xref ref-type="bibr" rid="CR8">8</xref>], Seurat [<xref ref-type="bibr" rid="CR18">18</xref>], scale)) and three dimension reduction methods (tSNE [<xref ref-type="bibr" rid="CR15">15</xref>], PCA, sammon [<xref ref-type="bibr" rid="CR14">14</xref>]). We collect the output of each combination of methods and subject them all to four typical clustering algorithms and compare the clustering results with ARI. As shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, the result shows that the NDRindex algorithm chooses the data with the highest ARI, which shows that the NDRindex algorithm chooses a good combination of methods. We submit the data that NDRindex chosen to hierarchical clustering algorithm, and compare the result with other four methods (SC3 [<xref ref-type="bibr" rid="CR5">5</xref>], pcaReduce [<xref ref-type="bibr" rid="CR20">20</xref>], SNN-Cliq [<xref ref-type="bibr" rid="CR21">21</xref>], SINCERA [<xref ref-type="bibr" rid="CR22">22</xref>], SRURAT [<xref ref-type="bibr" rid="CR18">18</xref>]) by ARI. As showed in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the performance of NDRindex shows its relatively high accuracy and stability.<fig id="Fig3"><label>Fig. 3</label><caption><p>Results of NDRindex on simulative data. Every line shows one type of simulative data we test, line 1 to line 4 are two-dimensional normal distribution, square, hexagram, random shape, respectively. For each line, column a to column c are four data whose scale are decreased by order, column d is a line graph shows how NDRIndex changes with the decrease of data scale. When data become more aggregate, NDRindex always become higher</p></caption><graphic xlink:href="12859_2020_3883_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Data quality assessment of NDRindex chosen and unchosen. For each database, we test five normalization methods (TMM, Linnorm, scran, Seurat, scale) and three dimensionality reduction methods (tSNE, PCA, sammon). We select the result of each combination and submit all twelve of them to four typical clustering methods and benchmark the clustering results with ARI. Figure 3.a to 3.d shows the results of clustering methods kmeans, hclust, adpclust, ap_clust, respectively. Comparing the data NDRindex chosen (red rectangular) and the data NDRindex unchosen, we find that most of the chosen combination get the highest ARI (orange rectangular) during clustering, nearly all chosen combination get the ARI above upper quantile (blue rectangular). That means NDRindex do select high quality data that is suitable for clustering</p></caption><graphic xlink:href="12859_2020_3883_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison between NDRindex and other RNA-Seq processing methods. We submit the data that NDRindex choosen to hclust algorithm, and compare the result with other four methods (SC3, pcaReduce, SNN-Cliq, SINCERA, SRURAT) by comparing ARI. We run each method one hundred times, the dots represent the ARI between the inferred clusterings and reference labels of each running. and the height of rectangular represents the average ARI</p></caption><graphic xlink:href="12859_2020_3883_Fig5_HTML" id="MO5"/></fig></p>
  </sec>
  <sec id="Sec5">
    <title>Discussion</title>
    <p id="Par27">For any REA-seq data, if there were at least one combination of normalization method and dimensionality reduction method, and the user believed that the optimal combination exists, NDRindex would be able to process as it is an evaluation to the best combinations of existing normalization methods and dimensionality reduction methods. If there is neither a defined normalization method nor dimensionality reduction, or the user cannot be sure whether at least one of the best combinations processes the data correctly, NDRindex would not be applicable. For instance, consider a data set consists of a homogeneous population of cells. If the user have multiple normalization methods and dimensionality reduction methods, NDRindex would be applicable. Since NDRindex is a method for evaluating combinations based on clustering trends and their results, it has no effect on the original data, so no new deviations will be introduced. The experiments shown by Figs. <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref> have shown its accuracy, effectiveness, and bias are negligible.</p>
  </sec>
  <sec id="Sec6">
    <title>Conclusions</title>
    <p id="Par28">The computational analysis of single cell RNA-seq data is based on clustering models. The pre-processed data for normalization and dimensionality reduction have a significant impact on the results of the clustering.</p>
    <p id="Par29">In order to select a better combination of standardization and dimensionality reduction methods for preprocessing single-cell RNA-Seq data, we designed NDRindex to evaluate the data quality of preprocessing results by evaluating the clustering trend and degree of data aggregation. The result of both simulative data and the real data shows the effectiveness of NDRindex.</p>
  </sec>
  <sec id="Sec7">
    <title>Availability and requirements</title>
    <p id="Par30">
      <list list-type="bullet">
        <list-item>
          <p id="Par31">Project name: NDRindex.</p>
        </list-item>
        <list-item>
          <p id="Par32">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/zeromakerlovesmiku/NDRindex">https://github.com/zeromakerlovesmiku/NDRindex</ext-link>.</p>
        </list-item>
        <list-item>
          <p id="Par33">Operating system(s): Platform independent.</p>
        </list-item>
        <list-item>
          <p id="Par34">Programming language: R.</p>
        </list-item>
        <list-item>
          <p id="Par35">Other requirements: R 3.4.4 or higher.</p>
        </list-item>
        <list-item>
          <p id="Par36">License: GPL.</p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>RNAseq</term>
        <def>
          <p id="Par4">RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>scRNAseq</term>
        <def>
          <p id="Par5">Single cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>TMM</term>
        <def>
          <p id="Par6">Trimmed mean of M-values</p>
        </def>
      </def-item>
      <def-item>
        <term>t-SNE</term>
        <def>
          <p id="Par7">t-distributed stochastic neighbor embedding</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable</p>
    <sec id="d30e843">
      <title>About this supplement</title>
      <p id="Par37">This article has been published as part of BMC Bioinformatics Volume 21 Supplement 16, 2020: Selected articles from the Biological Ontologies and Knowledge bases workshop 2019. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume21-supplement-16">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume21-supplement-16</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>RX wrote the code of R package and wrote the manuscript. RX and GL designed the NDRindex algorithm and tested it on datasets. WG and SJ designed experiments. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This study was supported by the China Natural Science Foundation (Grant No. 11971130), Open Project of State Key Laboratory of Urban Water Resource and Environment of Harbin Institute of Technology (Grant No. ES201602). The funding bodies played no role in the design of the study, the collection and analysis of the data or in the writing of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>NDRindex is available and open source at github (<ext-link ext-link-type="uri" xlink:href="https://github.com/zeromakerlovesmiku/NDRindex">https://github.com/zeromakerlovesmiku/NDRindex</ext-link>), the datasets we used are listed in the references and are available.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par38">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par39">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par40">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The single-cell RNA-seq data analysis on the receptor ACE2 expression reveals the potential risk of different human organs vulnerable to Wuhan 2019-nCoV infection</article-title>
        <source>Front Med</source>
        <year>2020</year>
        <volume>14</volume>
        <fpage>185</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="doi">10.1007/s11684-020-0754-0</pub-id>
        <pub-id pub-id-type="pmid">32170560</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>XW</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of a potential mechanism of acute kidney injury during the COVID-19 outbreak: a study based on single-cell transcriptome analysis</article-title>
        <source>Intensive Care Med</source>
        <year>2020</year>
        <volume>46</volume>
        <fpage>1114</fpage>
        <lpage>1116</lpage>
        <pub-id pub-id-type="doi">10.1007/s00134-020-06026-1</pub-id>
        <pub-id pub-id-type="pmid">32236644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Lin W, Hu L, et al. Single-cell analysis of ACE2 expression in human kidneys and bladders reveals a potential route of 2019-nCoV infection. bioRxiv. 2020;02(08):939892.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Zhang H, Kang Z, et al. The digestive system is a potential route of 2019-nCov infection: a bioinformatics analysis based on single-cell transcriptomes. bioRxiv. 2020;11(05):369413.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>483</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id>
        <pub-id pub-id-type="pmid">28346451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>3</issue>
        <fpage>R25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-3-r25</pub-id>
        <pub-id pub-id-type="pmid">20196867</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katayama</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SAMstrt: statistical test for differential expression in single-cell transcriptome with spike-in normalization</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>22</issue>
        <fpage>2943</fpage>
        <lpage>2945</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt511</pub-id>
        <pub-id pub-id-type="pmid">23995393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Bach</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>75</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0947-7</pub-id>
        <pub-id pub-id-type="pmid">27122128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallejos</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Beyond comparisons of means: understanding changes in gene expression at the single-cell level</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>70</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0930-3</pub-id>
        <pub-id pub-id-type="pmid">27083558</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bacher</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SCnorm: robust normalization of single-cell RNA-seq data</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>584</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4263</pub-id>
        <pub-id pub-id-type="pmid">28418000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yip</surname>
            <given-names>SH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Linnorm: improved statistical analysis for single cell RNA-seq expression data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>22</issue>
        <fpage>e179</fpage>
        <lpage>e179</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx828</pub-id>
        <pub-id pub-id-type="pmid">28981748</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durai</surname>
            <given-names>DA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>In silico read normalization using set multi-cover optimization</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>19</issue>
        <fpage>3273</fpage>
        <lpage>3280</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty307</pub-id>
        <pub-id pub-id-type="pmid">29912280</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Franks</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Feature specific quantile normalization enables cross-platform classification of molecular subtypes using gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>11</issue>
        <fpage>1868</fpage>
        <lpage>2187</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty026</pub-id>
        <pub-id pub-id-type="pmid">29360996</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sammon</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <article-title>A nonlinear mapping for data structure analysis</article-title>
        <source>IEEE Trans Comput</source>
        <year>1969</year>
        <volume>100</volume>
        <issue>5</issue>
        <fpage>401</fpage>
        <lpage>409</lpage>
        <pub-id pub-id-type="doi">10.1109/T-C.1969.222678</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maaten</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visualizing data using t-SNE</article-title>
        <source>J Mach Learn Res</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>2579</fpage>
        <lpage>2605</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lall</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure-aware principal component analysis for single-cell RNA-seq data</article-title>
        <source>J Comput Biol</source>
        <year>2018</year>
        <volume>25</volume>
        <issue>12</issue>
        <fpage>1365</fpage>
        <lpage>1373</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2018.0027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Min</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Edge-group sparse PCA for network-guided high dimensional data analysis</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>20</issue>
        <fpage>3479</fpage>
        <lpage>3487</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty362</pub-id>
        <pub-id pub-id-type="pmid">29726900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>495</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id>
        <pub-id pub-id-type="pmid">25867923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Dubes</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <source>Algorithms for clustering data</source>
        <year>1988</year>
        <publisher-loc>Englewood Cliffs</publisher-loc>
        <publisher-name>Prentice Hall</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zurauskiene</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>pcaReduce: hierarchical clustering of single cell transcriptional profiles</article-title>
        <source>BMC Bioinformatics</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>140</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-0984-y</pub-id>
        <pub-id pub-id-type="pmid">27005807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Identification of cell types from single-cell transcriptomes using a novel clustering method</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>12</issue>
        <fpage>1974</fpage>
        <lpage>1980</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv088</pub-id>
        <pub-id pub-id-type="pmid">25805722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SINCERA: a pipeline for single-cell RNA-Seq profiling analysis</article-title>
        <source>PLoS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>11</issue>
        <fpage>e1004575</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004575</pub-id>
        <pub-id pub-id-type="pmid">26600239</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
