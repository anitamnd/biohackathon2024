<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9235486</article-id>
    <article-id pub-id-type="pmid">35758820</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac248</article-id>
    <article-id pub-id-type="publisher-id">btac248</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>ISCB/Ismb 2022</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Regulatory and Functional Genomics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MeConcord: a new metric to quantitatively characterize DNA methylation heterogeneity across reads and CpG sites</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Xianglin</given-names>
        </name>
        <aff>
          <institution>Ministry of Education Key Laboratory of Bioinformatics, Center for Synthetic and Systems Biology, Bioinformatics Division, Beijing National Research Center for Information Science and Technology, Department of Automation, Tsinghua University, Beijing 100084, China</institution>
        </aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2965-8036</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Xiaowo</given-names>
        </name>
        <aff>
          <institution>Ministry of Education Key Laboratory of Bioinformatics, Center for Synthetic and Systems Biology, Bioinformatics Division, Beijing National Research Center for Information Science and Technology, Department of Automation, Tsinghua University, Beijing 100084, China</institution>
        </aff>
        <xref rid="btac248-cor1" ref-type="corresp"/>
        <!--xwwang@tsinghua.edu.cn-->
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac248-cor1">To whom correspondence should be addressed. E-mail: <email>xwwang@tsinghua.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-06-27">
      <day>27</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISCB ISMB 2022 Proceedings</issue-title>
    <fpage>i307</fpage>
    <lpage>i315</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac248.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Intermediately methylated regions occupy a significant fraction of the human genome and are closely associated with epigenetic regulations or cell-type deconvolution of bulk data. However, these regions show distinct methylation patterns, corresponding to different biological mechanisms. Although there have been some metrics developed for investigating these regions, the high noise sensitivity limits the utility for distinguishing distinct methylation patterns.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We proposed a method named MeConcord to measure local methylation concordance across reads and CpG sites, respectively. MeConcord showed the most stable performance in distinguishing distinct methylation patterns (‘identical’, ‘uniform’ and ‘disordered’) compared with other metrics. Applying MeConcord to the whole genome data across 25 cell lines or primary cells or tissues, we found that distinct methylation patterns were associated with different genomic characteristics, such as CTCF binding or imprinted genes. Further, we showed the differences of CpG island hypermethylation patterns between senescence and tumorigenesis by using MeConcord. MeConcord is a powerful method to study local read-level methylation patterns for both the whole genome and specific regions of interest.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>MeConcord is available at <ext-link xlink:href="https://github.com/WangLabTHU/MeConcord" ext-link-type="uri">https://github.com/WangLabTHU/MeConcord</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>State Key Research Development Program of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2020YFA0906900</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>62050152</award-id>
        <award-id>61773230</award-id>
        <award-id>61721003</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Project of Tsinghua Fuzhou Institute for Data Technology</institution>
          </institution-wrap>
        </funding-source>
        <award-id>TFIDT2021006</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>DNA methylation is one of the most pervasive and well-studied epigenetic modifications in mammalian genomes. In human genome, intermediately methylated regions (0.05 &lt; DNA methylation &lt; 0.95) occupied 33–76% for 150-bp bins harboring more than 5 CpG sites (<xref rid="btac248-F1" ref-type="fig">Fig. 1A;</xref>  <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref> for more stringent cutoffs). There mainly are three methylation patterns (‘identical’, ‘disordered’, ‘uniform’, <xref rid="btac248-F1" ref-type="fig">Fig. 1B and C</xref>) in these regions (<xref rid="btac248-B5" ref-type="bibr">Derrien <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac248-B11" ref-type="bibr">Landan <italic toggle="yes">et al.</italic>, 2012</xref>). These patterns usually imply different biological mechanisms and can arise from a mix of different cell types or cell states, genomic imprinting, DNA methylation erosion and dynamic competition between DNMT and TET. Intermediately methylated regions are informative regions, as they either act as potential features used for cell-type deconvolution in bulk data (<xref rid="btac248-B13" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac248-B26" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2014</xref>) or underlie the diversity and heterogeneity of cell states which contribute to gene expression regulation (<xref rid="btac248-B5" ref-type="bibr">Derrien <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac248-B12" ref-type="bibr">Landau <italic toggle="yes">et al.</italic>, 2014</xref>). Quantitatively characterizing and distinguishing different DNA methylation patterns of these regions are markedly valuable for studying the underlying regulation mechanisms and developing new biomarkers.</p>
    <fig position="float" id="btac248-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>The motivation of this study and the workflow of MeConcord. (<bold>A</bold>) The fractions of 150-bp bins (&gt;5 CpG sites) with different DNA methylation levels. Intermediately methylated bins are defined as bins with methylation levels &gt;0.05 and &lt;0.95 and occupy a large fraction (0.33–0.76, median = 0.57) across the whole genome. (<bold>B</bold>) A cartoon represents three different methylation patterns for intermediately methylated regions. Each cell represents a haploid genome. (<bold>C</bold>) Five different methylation patterns for intermediately methylated regions (methylation levels were around 0.25 for each pattern) with 8 CpG sites and 12 reads. Top: methylation patterns without methylation mutations. Bottom: methylation patterns with 5% random methylation mutations to mimic real experiment data. Patterns 1, 3 and 5 correspond to the cartoon shown in panel B. (<bold>D</bold>) The workflow of Meconcord. Methylation concordance was calculated across reads (reads concordance) and CpG sites (CpGs concordance) by applying Hamming distance to pairwise comparisons. Reads concordance and CpGs concordance are biased by mean methylation levels, so expected reads concordance and expected CpGs concordance were calculated based on the number of methylated and unmethylated CpGs across all pairwise comparisons. Normalized reads concordance and normalized CpGs concordance were defined by the differences between raw and expected scores. <italic toggle="yes">P</italic>-values were calculated by using Binomial tests. (<bold>E–H</bold>) The scatter plots of metrics measuring regional methylation heterogeneity for 10 methylation patterns including both the base and mutated patterns. E and F show four metrics used in previous studies, exhibiting poor performance in distinguishing different methylation patterns. However, G and H show metrics used in this study, exhibiting good performance in distinguishing different methylation patterns, especially for P1, P3 and P5, and in coping with noise</p>
      </caption>
      <graphic xlink:href="btac248f1" position="float"/>
    </fig>
    <p>Because single bisulfite sequencing reads often cover multiple CpG sites at one time, read-level methylation analysis could uncover the methylation patterns in these intermediately methylated regions. However, it requires a suitable metric to efficiently describe and distinguish different methylation patterns. At present, methylation entropy (<xref rid="btac248-B8" ref-type="bibr">Jenkinson <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btac248-B24" ref-type="bibr">Xie <italic toggle="yes">et al.</italic>, 2011</xref>), epi-polymorphism (<xref rid="btac248-B11" ref-type="bibr">Landan <italic toggle="yes">et al.</italic>, 2012</xref>), proportion of discordant reads (PDR) (<xref rid="btac248-B12" ref-type="bibr">Landau <italic toggle="yes">et al.</italic>, 2014</xref>) and fraction of discordant reads pairs (FDRP) (<xref rid="btac248-B21" ref-type="bibr">Scherer <italic toggle="yes">et al.</italic>, 2020</xref>) were proposed to describe within-sample methylation heterogeneity of reads. Although these metrics have been successfully used in some specific conditions, they always harbor two disadvantages. One is the neglect of the concordance between adjacent CpG sites. Methylation entropy, epi-polymorphism and FDRP focused on the methylation differences between reads but did not consider the association between local CpG sites. The other is high sensitivity to methylation noise. DNA methylation is highly dynamic and a snapshot of DNA methylation for a sample is noisy. The noise could come from both technical noise and biological noise. For example, the former could be caused by incomplete bisulfite conversion (<xref rid="btac248-B19" ref-type="bibr">Olova <italic toggle="yes">et al.</italic>, 2018</xref>); the latter could result from a competition between DNMT and TET during DNA replication and transcription (<xref rid="btac248-B1" ref-type="bibr">Charlton <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac248-B6" ref-type="bibr">Ginno <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac248-B9" ref-type="bibr">Kangaspeska <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btac248-B17" ref-type="bibr">Métivier <italic toggle="yes">et al.</italic>, 2008</xref>). Methylation entropy, epi-polymorphism and PDR showed poor performance in coping with the simulated noisy data (<xref rid="btac248-F1" ref-type="fig">Fig. 1C, E and F</xref>). Besides, methylation haplotype load (MHL) is a metric used to amplify the differences between fully consecutively methylated and interspersedly methylated patterns (<xref rid="btac248-B7" ref-type="bibr">Guo <italic toggle="yes">et al.</italic>, 2017</xref>) and has limited application scenarios. All these drawbacks limit the investigation of intermediately methylated regions.</p>
    <p>In this study, we leveraged Hamming distance to define two metrics to characterize DNA methylation concordance at read and CpG levels, respectively. Two metrics and their corresponding <italic toggle="yes">P</italic>-values calculated by Binomial tests clearly distinguished three methylation patterns in intermediately methylated regions and showed good performance in coping with noisy data. Using MeConcord, we found distinct methylation patterns were associated with different genomic characteristics, such as CTCF binding and genomic imprinting. Further, we identified the differences of CpG island’s hypermethylation patterns between senescence and tumorigenesis by using MeConcord. MeConcord is a powerful method to study local methylation patterns for both the whole genome and specific regions of interest.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Overview</title>
      <p>To quantitatively measure DNA methylation heterogeneity in intermediately methylated regions, we introduced concordance scores at two dimensions—concordance between reads and concordance between CpG sites. For example, <xref rid="btac248-F1" ref-type="fig">Figure 1D</xref> showed the fractions of concordant CpG pairs for Reads 3 and 7 (5/8), Reads 7 and 10 (8/8), where numerator values were concordant CpG pairs (with the same methylation states at the same CpG sites for two reads), while denominator values were the number of all valid pairs (with coverages at the same CpG sites for two reads). Similarly, for the other dimension, the fractions of concordant CpG pairs for CpG sites 2 and 4 (4/12), CpG sites 7 and 8 (12/12) were shown in <xref rid="btac248-F1" ref-type="fig">Figure 1D</xref>.</p>
      <p>Iteratively counting concordant CpG pairs and all valid CpG pairs across possible pairwise comparisons of reads, we could obtain reads concordance (RC) scores by dividing all concordant CpG pairs by all valid CpG pairs. Similarly, we could also get CpGs concordance (CC, short for CpG sites concordance) scores (The middle of <xref rid="btac248-F1" ref-type="fig">Fig. 1D</xref>). Matrix multiplication was used to speed up the calculation (see following methods and more details with an example shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>).</p>
      <p>Reads concordance and CpGs concordance are not comparable, because they are biased by mean methylation levels (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). So, we calculated expected concordance scores under random conditions for the given methylation data to normalize reads concordance and CpGs concordance, and calculated corresponding <italic toggle="yes">P</italic>-values by Binomial tests (the right of <xref rid="btac248-F1" ref-type="fig">Fig. 1D;</xref> more calculation details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>) to show the significance of concordance.</p>
    </sec>
    <sec>
      <title>2.2 Calculating reads concordance and CpGs concordance</title>
      <p>This section is the implementation of reads concordance and CpGs concordance with matrix multiplication. First, to be compatible with missing data in methylation matrix (reads × CpG sites), we defined methylated matrix <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi mathvariant="bold">M</mml:mi></mml:math></inline-formula>, with element scores 1 indicating methylated CpGs and 0 indicating missing data or unmethylated CpGs; unmethylated matrix <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi mathvariant="bold">N</mml:mi></mml:math></inline-formula>, with element scores 1 indicating unmethylated CpGs and 0 indicating missing data or methylated CpGs. The coverage matrix <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi mathvariant="bold">T</mml:mi></mml:math></inline-formula> is the summarization of <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi mathvariant="bold">M</mml:mi></mml:math></inline-formula> and <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi mathvariant="bold">N</mml:mi></mml:math></inline-formula>, with element score 1 indicating coverages and 0 indicating missing data. Matrix <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi mathvariant="bold">M</mml:mi></mml:math></inline-formula>, <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi mathvariant="bold">N</mml:mi></mml:math></inline-formula> and <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi mathvariant="bold">T</mml:mi></mml:math></inline-formula> have the same sizes, with the number of rows <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>r</mml:mi></mml:math></inline-formula> representing the number of reads and the number of columns <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi>c</mml:mi></mml:math></inline-formula> representing the number of CpG sites on the specific region, which was 150-bp bins in this study. 150 bp was chosen due to its compatibility with the length of next-generation sequencing reads.</p>
      <p>Then, reads concordance (<italic toggle="yes">RC</italic>) was calculated as
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mtext>elements</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">M</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mtext>elements</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">N</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mtext>elements</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mi>R</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> represent the numbers of concordantly methylated CpG pairs, concordantly unmethylated CpG pairs, all valid CpG pairs across all possible pairwise comparisons of reads, respectively. Besides, <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> represents an all-ones matrix with size <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mi>r</mml:mi></mml:math></inline-formula> is the number of reads, which is equal to the row numbers of matrix <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mi mathvariant="bold">M</mml:mi></mml:math></inline-formula>, <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mi mathvariant="bold">N</mml:mi></mml:math></inline-formula> and <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mi mathvariant="bold">T</mml:mi></mml:math></inline-formula>. <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represents an identity matrix with all-ones in the main diagonal and all-zeros for other elements. <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mo>⊙</mml:mo></mml:math></inline-formula> represents dot product.</p>
      <p>Similarly, CpGs concordance (<inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula>) was calculated by counting all concordant CpG pairs across all pairwise comparisons of CpG sites (<xref rid="btac248-F1" ref-type="fig">Fig. 1D</xref>). <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> was implemented as
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mtext>elements</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">M</mml:mi><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mtext>elements</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">N</mml:mi><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mtext>elements</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">T</mml:mi><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E8"><label>(8)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula> represents the numbers of concordantly methylated CpG pairs, concordantly unmethylated CpG pairs, all valid CpG pairs across all possible pairwise comparisons of CpG sites, respectively. Besides, <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> represents an all-ones matrix with size <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>c</mml:mi></mml:math></inline-formula> is the number of CpGs, which is equal to the column numbers of matrix <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mi mathvariant="bold">M</mml:mi></mml:math></inline-formula>, <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi mathvariant="bold">N</mml:mi></mml:math></inline-formula> and <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mi mathvariant="bold">T</mml:mi></mml:math></inline-formula>. <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represents an identity matrix with size <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.3 Calculating normalized concordance metrics and <italic toggle="yes">P</italic>-values</title>
      <p>We noticed that reads concordance and CpGs concordance were biased by DNA methylation levels. More close to 0.5 the methylation level is, lower values two metrics are (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). So we computed expected reads concordance and expected CpGs concordance with the methylation matrix and further normalized two metrics by subtracting the raw concordance by the expected concordance.</p>
      <p>Normalized reads concordance (<inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">NRC</mml:mi></mml:mrow></mml:math></inline-formula>) was calculated as
<disp-formula id="E9"><label>(9)</label><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mtext>elements</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E10"><label>(10)</label><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mtext>elements</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">T</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E11"><label>(11)</label><mml:math id="M11" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E12"><label>(12)</label><mml:math id="M12" display="block" overflow="scroll"><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E13"><label>(13)</label><mml:math id="M13" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">NRC</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represent the numbers of methylated CpGs, unmethylated CpGs in all possible CpG pairs across all pairwise comparisons of reads, respectively. <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> represents the expected methylation level according to the composition of CpG pairs, <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> represents the expected reads concordance given the expected methylation level <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p>To represent the significance of concordance over expectations under random conditions, we leveraged Binomial tests to calculate <italic toggle="yes">P</italic>-values to represent the significance of concordance for the methylation matrix. <italic toggle="yes">P</italic>-values of reads concordance (<inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) was calculated as
<disp-formula id="E14"><label>(14)</label><mml:math id="M14" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mi>m</mml:mi><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>r</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mo>×</mml:mo><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mi>m</mml:mi><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>r</mml:mi><mml:mo>≥</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mo>×</mml:mo><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> is the observed counts; <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> is all possible counts; <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> is the expected reads concordance.</p>
      <p>Similarly, normalized CpGs concordance (<italic toggle="yes">NCC</italic>) was calculated as
<disp-formula id="E15"><label>(15)</label><mml:math id="M15" display="block" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mtext>elements</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">M</mml:mi><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E16"><label>(16)</label><mml:math id="M16" display="block" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mtext>elements</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">T</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">N</mml:mi><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E17"><label>(17)</label><mml:math id="M17" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E18"><label>(18)</label><mml:math id="M18" display="block" overflow="scroll"><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E19"><label>(19)</label><mml:math id="M19" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">NCC</mml:mi><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represents the numbers of methylated CpGs, unmethylated CpGs shown in all possible CpG pairs across all pairwise comparisons of CpG sites, respectively. <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula> represents the expected methylation level according to the composition of CpG pairs, <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula> represents the expected reads concordance given the expected methylation level <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p><italic toggle="yes">P</italic>-values of CpGs concordance (<inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) was calculated as
<disp-formula id="E20"><label>(20)</label><mml:math id="M20" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>m</mml:mi><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mo>≥</mml:mo><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.4 Data collection and processing</title>
      <p>We collected whole genome bisulfite sequencing data of human samples from both ENCODE (<xref rid="btac248-B4" ref-type="bibr">Davis <italic toggle="yes">et al.</italic>, 2018</xref>) and previously published datasets (<xref rid="btac248-B3" ref-type="bibr">Cruickshanks <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btac248-B8" ref-type="bibr">Jenkinson <italic toggle="yes">et al.</italic>, 2017</xref>) under GEO accession GSE48580 and GSE86340. Bam files mapped to GRCh38 under ENCODE3 version with Bismark were directly used. Raw sequencing data from GEO was used followed by quality control, adapter sequences removal and mapping. We employed Cutadapt (<xref rid="btac248-B15" ref-type="bibr">Martin, 2011</xref>) to remove adapter sequences. Then Bismark (<xref rid="btac248-B10" ref-type="bibr">Krueger and Andrews, 2011</xref>) was used to map sequencing reads against GRCh38.</p>
      <p>Bam files of transcription factors and histone modifications ChIP-seq, DNase-seq for H1 and K562 cell lines were downloaded from ENCODE and used for the enrichment. The feature enrichment was performed by deepTools (<xref rid="btac248-B20" ref-type="bibr">Ramírez <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
      <p>Human reference genome GRCh38 was used in this study. The genome was binned at 150-bp windows (bins) and bins with more than 5 CpG sites were used for MeConcord analyses.</p>
    </sec>
    <sec>
      <title>2.5 MeConcord implementation and functions</title>
      <p>MeConcord was implemented by Python and included three main functions.
</p>
      <list list-type="order">
        <list-item>
          <p>Converting bam files from Bismark to reads-level methylation recording files. Each single-end read or paired-end read was converted to one methylation recording considering the overlapping of two ends of paired-end reads. This part was compatible with both sam files (or sam.gz files) and bam files with even a mix of single-end and paired-end reads. This part required reads ID sorted files.</p>
        </list-item>
        <list-item>
          <p>Calculating reads concordance, CpGs concordance, normalized reads concordance, normalized CpGs concordance and corresponding <italic toggle="yes">P</italic>-values from methylation recording files for any given genomic regions. Because this part was implemented by matrix multiplication, the coverage of reads could be more than 1000×, much higher than FDRP, which is compatible with less than 40× (<xref rid="btac248-B21" ref-type="bibr">Scherer <italic toggle="yes">et al.</italic>, 2020</xref>). This enabled MeConcord coping with target sequencing data with extremely high sequencing depths, such as RRBS.</p>
        </list-item>
        <list-item>
          <p>Deriving methylation matrix (reads × CpG sites) from methylation recording files for any given genomic regions. The methylation matrices could be used for visualization by plotting lollipop plots (PDF format) with the script embedded in MeConcord.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>2.6 Identifying differentially methylated regions on CpG islands</title>
      <p>To well study the differences of CpG island hypermethylation patterns between cellular senescence, aging and tumorigenesis, at first we binned CpG islands into 150-bp bins and calculated mean methylation levels for each cell state or tissue. Next, we chose bins whose mean methylation levels in control samples (proliferating cells for cellular senescence, T cells from young individuals for aging, normal liver and lung tissues for tumorigenesis) &lt;0.20 and standard deviations of control samples &lt;0.05. Finally, differentially methylated regions for each case sample were independently identified with the threshold that methylation levels of the case sample minus mean methylation levels of controls &gt;0.1. Methylation patterns were analyzed for these differentially methylated bins of CpG islands.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 MeConcord showed good performance in distinguishing different methylation patterns</title>
      <p>First, we borrowed the naming of three canonical methylation patterns in intermediately methylated regions from a previous study (<xref rid="btac248-B5" ref-type="bibr">Derrien <italic toggle="yes">et al.</italic>, 2021</xref>), where the ‘identical’ methylation pattern represents a pattern with high consistency between reads but low concordance across adjacent CpG sites; the ‘disordered’ methylation pattern represents a pattern with low concordance both between reads and CpG sites; the ‘uniform’ methylation pattern represents a pattern with highly concordant CpG sites within single reads but large differences between some reads (<xref rid="btac248-F1" ref-type="fig">Fig. 1B and C</xref>).</p>
      <p>To examine the performance of MeConcord in distinguishing different methylation patterns, we simulated 5 methylation matrices with similar methylation levels, corresponding to different methylation patterns (<xref rid="btac248-F1" ref-type="fig">Fig. 1C</xref>). Bottom of <xref rid="btac248-F1" ref-type="fig">Figure 1C</xref> showed the simulated noisy methylation matrices to mimic real data. Both raw concordance scores (reads concordance and CpGs concordance) and normalized concordance scores [normalized reads concordance (NRC) and normalized CpGs concordance (NCC)] showed good performance in distinguishing five different methylation patterns (<xref rid="btac248-F1" ref-type="fig">Fig. 1G and H</xref>). In contrast, previously used metrics showed poor performance in distinguishing these patterns, especially for the noisy matrices. Besides, methylation entropy, epi-polymorphism, PDR and MHL showed large differences between the base methylation matrices and the noisy methylation matrices, whereas our metrics, NRC and NCC, showed more similar scores. This suggested the better performance of our metrics in coping with noise. Our metrics also showed more stable performance than other metrics when applying them to shorter stretches of four CpG sites (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). Notably, Patterns 2 and 4 are not canonical patterns, therefore was excluded in the following analyses.</p>
      <p>To examine MeConcord’s performance in real data, we performed the analysis on a thymus tissue sample from ENCODE (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>, <xref rid="btac248-F2" ref-type="fig">Fig. 2A</xref>). ‘Uniform’ regions exhibited a pattern that DNA methylation of CpGs on the same reads are highly consistent and there is a divergence among reads (left two examples of <xref rid="btac248-F2" ref-type="fig">Fig. 2B</xref>), and were defined as bins showing high NCC (&gt;0.1), low NRC (&lt;0.1) and low <italic toggle="yes">P</italic>-values (&lt;1 × 10<sup>−10</sup>) (Top square of <xref rid="btac248-F2" ref-type="fig">Fig. 2A</xref>). Similarly, ‘disordered’ and ‘identical’ regions are defined as low NCC (&lt;0.1), low NRC (&lt;0.1) and high <italic toggle="yes">P</italic>-values (&gt;1 × 10<sup>−5</sup>); low NCC (&lt;0.1), high NRC (&gt;0.1) and low <italic toggle="yes">P</italic>-values (&lt;1 × 10<sup>−10</sup>), respectively (<xref rid="btac248-F2" ref-type="fig">Fig. 2A and B</xref>). In contrast, other existing metrics could not efficiently distinguish different patterns in real data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>). Taken together, MeConcord was a reliable method for investigating methylation patterns in intermediately methylated regions.</p>
      <fig position="float" id="btac248-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Distinct methylation patterns identified by MeConcord. (<bold>A</bold>) The distribution of normalized concordance scores and the classification of methylation patterns. Colors indicated the significances of concordance (<italic toggle="yes">P</italic>-values) at two different dimensions for top and bottom scatterplots, respectively. Each point represented a 150-bp bin with more than 5 CpG sites and more than 5 mapped reads. Shown points were subsampled at 1% from the whole gnome. (<bold>B</bold>) Lollipop plots of five examples for distinct methylation patterns. (<bold>C</bold>) The compositions of three distinct methylation patterns for 25 samples from ENCODE. These analyses were performed for intermediately methylated regions (0.05 &lt; DNAme &lt; 0.95). (<bold>D</bold>) The distributions of normalized concordance scores for GM12878 cell line and placenta tissue, which represented two extremes of the compositions. Top and bottom plots are colored by two types of <italic toggle="yes">P</italic>-values. (<bold>E</bold>) Lollipop plots for six genomic regions corresponding to GM12878-specific ‘identical’ patterns, H1-specific ‘uniform’ patterns and placenta-specific ‘uniform’ patterns, respectively</p>
        </caption>
        <graphic xlink:href="btac248f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Different proportions of distinct methylation patterns across samples</title>
      <p>To investigate the different compositions of methylation patterns in different samples, we applied MeConcord to 25 samples from ENCODE, including 4 primary cells, 10 cell lines and 11 tissues. In general, ‘disordered’ bins occupied the highest fractions (43%–91%) (<xref rid="btac248-F2" ref-type="fig">Fig. 2C</xref>). The proportions of ‘identical’ and ‘uniform’ bins showed large differences across different cell types/tissues (the proportions of ‘identical’ bins from 2% in placenta to 50% in GM12878; the proportions of ‘uniform’ bins from 3% in mammary epithelial cells to 40% in testis) (<xref rid="btac248-F2" ref-type="fig">Fig. 2C and D</xref>). We found that tissues always showed higher proportions of ‘uniform’ bins than primary cells or cell lines, especially for placenta and testis. We speculated that multiple cell types within tissues contributed to a high fraction of ‘uniform’ bins. There were two exceptions; H1 and H9 cell lines showing high fraction of ‘uniform’ bins. However, This is in line with the previous finding that a high proportion of CpGs (14%) genome-wide showed allele-specific methylation in H1 and H9 (<xref rid="btac248-B2" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2011</xref>). More stringent cutoffs for intermediately methylated regions did not change these trends (Right part of <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). <xref rid="btac248-F2" ref-type="fig">Figure 2E</xref> showed some examples for GM12878-specific ‘identical’ bins, H1-specific ‘uniform’ bins and placenta-specific ‘uniform’ bins.</p>
      <p>To well understand the biological relevance of these different methylation patterns in GM12878, H1 and placenta, we performed gene function enrichments. GREAT genomic enrichments (<xref rid="btac248-B16" ref-type="bibr">McLean <italic toggle="yes">et al.</italic>, 2010</xref>) of GM12878 ‘disordered’, ‘identical’ and ‘uniform’ bins showed different functions and phenotypes, and ‘uniform’ bins were enriched for genomic imprinting (Binomial <italic toggle="yes">P</italic>-values &lt; 1 × 10<sup>−30</sup>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). Similarly, we found that H1 ‘uniform’ bins were enriched for embryonic morphogenesis (Binomial <italic toggle="yes">P</italic>-values &lt; 1 × 10<sup>−7</sup>) and imprinting (Binomial <italic toggle="yes">P</italic>-values &lt; 1 × 10<sup>−40</sup>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>); placenta ‘uniform’ bins were enriched for embryonic placenta development (Binomial <italic toggle="yes">P</italic>-values &lt; 1 × 10<sup>−10</sup>) and imprinting (Binomial <italic toggle="yes">P</italic>-values &lt; 1 × 10<sup>−30</sup>). Interestingly, placenta ‘disordered’ bins were enriched for trophoblast (will develop into a large part of the placenta) morphology (Binomial <italic toggle="yes">P</italic>-values &lt; 1 × 10<sup>−10</sup>) and abnormal placenta size (Binomial <italic toggle="yes">P</italic>-values &lt; 1 × 10<sup>−10</sup>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). Taken together, different local methylation patterns are related to genomic regions with different biological functions.</p>
    </sec>
    <sec>
      <title>3.3 Genomic features for three different methylation patterns</title>
      <p>To better understand the differences between three methylation patterns, we included H1 and K562 cell lines, which have comprehensive ChIP-seq data for various transcription factors and histone modifications in ENCODE, to investigate the relationship between these methylation patterns and these genetic and epigenetic characteristics. First, we examined the distributions of DNA methylation levels for three methylation patterns and found that ‘uniform’ and ‘identical’ bins showed similar methylation level distributions, whereas ‘disordered’ bins showed distinct methylation levels (<xref rid="btac248-F3" ref-type="fig">Fig. 3A and B</xref>). To avoid the effect of different methylation levels of three methylation patterns on the following genomic feature enrichment analyses, we randomly selected genomic regions of ‘uniform’ and ‘disordered’ patterns in each methylation level interval to make sure that they showed similar distributions of methylation levels as ‘identical’ pattern (Selected bins of <xref rid="btac248-F3" ref-type="fig">Fig. 3A and B</xref>).</p>
      <fig position="float" id="btac248-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Different genomic features for three methylation patterns. (<bold>A</bold>) The distributions of DNA methylation levels for different methylation patterns in H1 cell line (All bins). We randomly selected bins of ‘uniform’ and ‘disordered’ in each methylation level interval to make their distributions be consistent with the distribution of ‘identical’ bins (Selected bins for enrichments). These selected bins were used for genomic feature enrichment analyses. This could largely avoid the effects of different DNA methylation levels on feature enrichments. (<bold>B</bold>) The distributions of DNA methylation levels for different methylation patterns in K562 cell line. (<bold>C</bold>) The enrichment of DNase-seq and ChIP-seq signal (CTCF, RAD21, ZNF143, H3K4me3, H3K4me1) around different methylation patterns for H1. The signal was shown upstream 3000 bp and downstream 3000 bp of these bins. We chose the 150 bp bins, which were 100 kbp upstream and downstream from the foreground bins (‘uniform’, ‘identical’, ‘disordered’), as the background regions. (<bold>D</bold>) The enrichment of DNase-seq and ChIP-seq signal around different methylation patterns for K562</p>
        </caption>
        <graphic xlink:href="btac248f3" position="float"/>
      </fig>
      <p>The enrichments indicated that ‘identical’ bins were specifically associated with CTCF, RAD21 and ZNF143 bindings and placed around but not within these binding sites (<xref rid="btac248-F3" ref-type="fig">Fig. 3C and D</xref>). It suggested that ‘identical’ patterns might be mediated by genome insulators or 3D genome organizers. ‘Disordered’ bins were depleted for H3K4me3, a mark of promoter, but enriched for H3K4me1, a mark of active and poised enhancer. In contrast, ‘uniform’ bins were enriched for both H3K4me3 and H3K4me1. These findings indicated that three different methylation patterns harbored distinct genomic characteristics.</p>
    </sec>
    <sec>
      <title>3.4 Distinct CpG island hypermethylation patterns between senescence and tumorigenesis</title>
      <p>To further examine the power of MeConcord to investigate methylation patterns, we leveraged datasets of cellular senescence, aging and tumorigenesis to study the differences of CpG island hypermethylation between senescence and tumorigenesis. Previous studies have shown that tumors and senescent cells harbors similar methylation alterations (<xref rid="btac248-B3" ref-type="bibr">Cruickshanks <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btac248-B25" ref-type="bibr">Zane <italic toggle="yes">et al.</italic>, 2014</xref>), but this finding is upsetting as it will be more difficult to specifically detect tumors from aged individuals in clinical care with DNA methylation markers. However, the differences between local methylation patterns might give some insights into this problem.</p>
      <p>We collected four datasets including cellular senescence dataset (3 proliferating biological replicates, 3 replicative senescence biological replicates), aging dataset (T cells from 3 young individuals and 3 old individuals), liver cancer dataset (3 normal liver tissues, 3 liver tumor tissues), lung cancer dataset (3 normal lung tissues, 3 lung tumor tissues). We focused on CpG island bins which showed hypermethylation during senescence or tumorigenesis and found that tumors showed higher fractions of ‘uniform’ bins than senescent cells (tumors, 0.24–0.88, mean = 0.65; senescence or aging, 0.10–0.23, mean = 0.17). In contrast, the distributions of DNA methylation levels for these hypermethylated CpG island bins were similar between senescence and tumorigenesis (<xref rid="btac248-F4" ref-type="fig">Fig. 4A–D</xref>). It suggested that local methylation patterns identified by MeConcord were more suitable for distinguishing senescence and tumorigenesis than DNA methylation levels.</p>
      <fig position="float" id="btac248-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Distinct CpG island hypermethylation patterns in senescence and tumorigenesis. (<bold>A–D</bold>) The compositions of different methylation patterns and distributions of DNA methylation levels for hypermethylated CpG islands in cellular senescence (A), aging (B), liver cancer (C) and lung cancer (D). The scatterplots on the left showed the distributions of normalized concordance scores in one senescence sample, one aging sample or one tumor sample. Bar plots in the middle showed the compositions of three methylation patterns across all samples in each dataset. Tumor samples showed higher fraction of ‘uniform’ bins than cellular senescence samples or aging samples. Histograms on the right showed the distributions of DNA methylation of hypermethylated CpG islands for all case samples (senescence samples, aging samples, tumors). Except for liver tumor 2, all case samples showed similar distributions. (<bold>E</bold>) Lollipop plots of two examples for cellular senescence and tumorigenesis. The scores for MeConcord and existing metrics were shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref>. For all metrics, NCC and its <italic toggle="yes">P</italic>-values of MeConcord showed the clearest differences between the senescence sample S1 and the lung cancer 1. One of the examples (Chr12:128 853 775–128 853 924) is located at the promoter of <italic toggle="yes">GLT1D1</italic>, which is associated with the occurrence of chronic obstructive pulmonary disease (<xref rid="btac248-B18" ref-type="bibr">Morrow <italic toggle="yes">et al.</italic>, 2016</xref>) and immunosuppression in B-cell lymphoma (<xref rid="btac248-B14" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2020</xref>). However, the relationship between different methylation patterns and biological mechanisms remains unclear. (<bold>F</bold>) A cartoon showing the differences of CpG island hypermethylation patterns between cellular senescence and tumorigenesis</p>
        </caption>
        <graphic xlink:href="btac248f4" position="float"/>
      </fig>
      <p><xref rid="btac248-F4" ref-type="fig">Figure 4E</xref> showed two examples of hypermethylated regions in both senescent cells and lung tumors. CpG islands of senescent cells tended to be methylated by ‘disordered’ or ‘identical’ patterns, whereas tumor tissues tended to be methylated by a ‘uniform’ pattern. For single reads, senescent cells tended to be methylated at some discrete CpG sites, while tumors tended to be methylated at nearly all consecutive CpG sites (<xref rid="btac248-F4" ref-type="fig">Fig. 4E and F</xref>). Although ‘uniform’ patterns in tumor samples might be due to tumor purity, read-level methylation patterns revealed by MeConcord could help us to distinguish tumors and senescent cells.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this study, we introduced a new method, MeConcord, for analyzing local DNA methylation patterns at single-read level. This method leveraged Hamming distance, matrix multiplication and Binomial tests to overcome some limitations that present methods are facing. DNA methylation data was noisy due to the dynamics of DNA methylation mechanisms (<xref rid="btac248-B1" ref-type="bibr">Charlton <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac248-B17" ref-type="bibr">Métivier <italic toggle="yes">et al.</italic>, 2008</xref>) and technical noise, which required metrics to have a good ability to cope with noisy methylation data. However, methylation entropy, epi-polymorphism and PDR either required very high coverages or focused on very local regions (4 CpG sites) to reduce the effect of noise. In contrast, MeConcord and quantitative fraction of discordant reads pairs (qFDRP) (<xref rid="btac248-B21" ref-type="bibr">Scherer <italic toggle="yes">et al.</italic>, 2020</xref>) leveraged Hamming distance to improve the stability in real datasets. Although one of our metrics, reads concordance, is equal to 1-qFDRP, qFDRP alone is impossible to distinguish three different methylation patterns. To our knowledge, there was no such a method distinguishing three distinct methylation patterns in intermediately methylated regions before MeConcord.</p>
    <p>We leveraged matrix multiplication to calculate two concordance metrics, with an ability to include very-high-coverage datasets than qFDRP. This method can easily deal with &gt;1000 reads for a single bin, while qFDRP had to subsample reads when the number exceeds 40 reads (<xref rid="btac248-B21" ref-type="bibr">Scherer <italic toggle="yes">et al.</italic>, 2020</xref>), which hampers its utility in deep sequenced datasets.</p>
    <p>Present metrics including methylation entropy, epi-polymorphism and our raw metrics RC, CC were biased by DNA methylation levels (<xref rid="btac248-B11" ref-type="bibr">Landan <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btac248-B22" ref-type="bibr">Shao <italic toggle="yes">et al.</italic>, 2014</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). This hampers us to set thresholds to distinguish different methylation patterns. However, we computed the expected concordance scores under random conditions for a given methylation matrix to normalize RC and CC, which is more efficient than permutations (<xref rid="btac248-B23" ref-type="bibr">Tsai <italic toggle="yes">et al.</italic>, 2012</xref>), and leveraged Binomial tests to assign a <italic toggle="yes">P</italic>-value for each score. This enabled us to easily distinguish different methylation patterns by setting an unbiased threshold.</p>
    <p>By applying Meconcord to different samples and biological processes, we found that different methylation patterns identified by MeConcord harbored different genomic features and MeConcord could enable us to study the local read-level methylation patterns for both the whole genome and some specific regions. Currently, MeConcord can only process DNA methylation of CpG sites, and does not include non-CpG methylation frequently appeared in brains, stem cells and plant cells. However, MeConcord is a powerful method to study local read-level methylation patterns on CpG sites for intermediately methylated regions.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac248_Supplementary_Data</label>
      <media xlink:href="btac248_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>The authors thank the members in Wang lab for some valuable discussions and help.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the State Key Research Development Program of China [2020YFA0906900], the National Natural Science Foundation of China [62050152, 61773230 and 61721003] and Project of Tsinghua Fuzhou Institute for Data Technology [TFIDT2021006].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac248-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Charlton</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Global delay in nascent strand DNA methylation</article-title>. <source>Nat. Struct. Mol. Biol</source>., <volume>25</volume>, <fpage>327</fpage>–<lpage>332</lpage>.<pub-id pub-id-type="pmid">29531288</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>P.-Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>A comparative analysis of DNA methylation across human embryonic stem cell lines</article-title>. <source>Genome Biol</source>., <volume>12</volume>, <fpage>R62</fpage>.<pub-id pub-id-type="pmid">21733148</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cruickshanks</surname><given-names>H.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Senescent cells harbour features of the cancer epigenome</article-title>. <source>Nat. Cell Biol</source>., <volume>15</volume>, <fpage>1495</fpage>–<lpage>1506</lpage>.<pub-id pub-id-type="pmid">24270890</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davis</surname><given-names>C.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>The encyclopedia of DNA elements (ENCODE): data portal update</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>D794</fpage>–<lpage>D801</lpage>.<pub-id pub-id-type="pmid">29126249</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Derrien</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>The DNA methylation landscape of multiple myeloma shows extensive inter- and intrapatient heterogeneity that fuels transcriptomic variability</article-title>. <source>Genome Med</source>., <volume>13</volume>, <fpage>127</fpage>.<pub-id pub-id-type="pmid">34372935</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ginno</surname><given-names>P.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>A genome-scale map of DNA methylation turnover identifies site-specific dependencies of DNMT and TET activity</article-title>. <source>Nat. Commun</source>., <volume>11</volume>, <fpage>2680</fpage>.<pub-id pub-id-type="pmid">32471981</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Identification of methylation haplotype blocks aids in deconvolution of heterogeneous tissue samples and tumor tissue-of-origin mapping from plasma DNA</article-title>. <source>Nat. Genet</source>., <volume>49</volume>, <fpage>635</fpage>–<lpage>642</lpage>.<pub-id pub-id-type="pmid">28263317</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jenkinson</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Potential energy landscapes identify the information-theoretic nature of the epigenome</article-title>. <source>Nat. Genet</source>., <volume>49</volume>, <fpage>719</fpage>–<lpage>729</lpage>.<pub-id pub-id-type="pmid">28346445</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kangaspeska</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Transient cyclical methylation of promoter DNA</article-title>. <source>Nature</source>, <volume>452</volume>, <fpage>112</fpage>–<lpage>115</lpage>.<pub-id pub-id-type="pmid">18322535</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krueger</surname><given-names>F.</given-names></string-name>, <string-name><surname>Andrews</surname><given-names>S.R.</given-names></string-name></person-group> (<year>2011</year>) <article-title>Bismark: a flexible aligner and methylation caller for Bisulfite-Seq applications</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>1571</fpage>–<lpage>1572</lpage>.<pub-id pub-id-type="pmid">21493656</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Landan</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Epigenetic polymorphism and the stochastic formation of differentially methylated regions in normal and cancerous tissues</article-title>. <source>Nat. Genet</source>., <volume>44</volume>, <fpage>1207</fpage>–<lpage>1214</lpage>.<pub-id pub-id-type="pmid">23064413</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Landau</surname><given-names>D.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Locally disordered methylation forms the basis of intratumor methylome variation in chronic lymphocytic leukemia</article-title>. <source>Cancer Cell</source>, <volume>26</volume>, <fpage>813</fpage>–<lpage>825</lpage>.<pub-id pub-id-type="pmid">25490447</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>CancerDetector: ultrasensitive and non-invasive cancer detection at the resolution of individual reads using cell-free DNA methylation sequencing data</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>e89</fpage>.<pub-id pub-id-type="pmid">29897492</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Overexpression of GLT1D1 induces immunosuppression through glycosylation of PD-L1 and predicts poor prognosis in B-cell lymphoma</article-title>. <source>Mol. Oncol</source>., <volume>14</volume>, <fpage>1028</fpage>–<lpage>1044</lpage>.<pub-id pub-id-type="pmid">32157792</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martin</surname><given-names>M.</given-names></string-name></person-group> (<year>2011</year>) <article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title>. <source>EMBnet. J</source>., <volume>17</volume>, <fpage>10</fpage>–<lpage>12</lpage>.</mixed-citation>
    </ref>
    <ref id="btac248-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McLean</surname><given-names>C.Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title>. <source>Nat. Biotechnol</source>., <volume>28</volume>, <fpage>495</fpage>–<lpage>501</lpage>.<pub-id pub-id-type="pmid">20436461</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Métivier</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Cyclical DNA methylation of a transcriptionally active promoter</article-title>. <source>Nature</source>, <volume>452</volume>, <fpage>45</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">18322525</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morrow</surname><given-names>J.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>DNA methylation profiling in human lung tissue identifies genes associated with COPD</article-title>. <source>Epigenetics</source>, <volume>11</volume>, <fpage>730</fpage>–<lpage>739</lpage>.<pub-id pub-id-type="pmid">27564456</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olova</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Comparison of whole-genome bisulfite sequencing library preparation strategies identifies sources of biases affecting DNA methylation data</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>33</fpage>.<pub-id pub-id-type="pmid">29544553</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramírez</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>deepTools2: a next generation web server for deep-sequencing data analysis</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>W160</fpage>–<lpage>W165</lpage>.<pub-id pub-id-type="pmid">27079975</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scherer</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Quantitative comparison of within-sample heterogeneity scores for DNA methylation data</article-title>. <source>Nucleic Acids Res</source>., <volume>48</volume>, <fpage>e46</fpage>.<pub-id pub-id-type="pmid">32103242</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shao</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Deciphering the heterogeneity in DNA methylation patterns during stem cell differentiation and reprogramming</article-title>. <source>BMC Genomics</source>, <volume>15</volume>, <fpage>978</fpage>.<pub-id pub-id-type="pmid">25404570</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tsai</surname><given-names>A.G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Heterogeneity and randomness of DNA methylation patterns in human embryonic stem cells</article-title>. <source>DNA Cell Biol</source>., <volume>31</volume>, <fpage>893</fpage>–<lpage>907</lpage>.<pub-id pub-id-type="pmid">22277069</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Genome-wide quantitative assessment of variation in DNA methylation patterns</article-title>. <source>Nucleic Acids Res</source>., <volume>39</volume>, <fpage>4099</fpage>–<lpage>4108</lpage>.<pub-id pub-id-type="pmid">21278160</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zane</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Common features of chromatin in aging and cancer: cause or coincidence?</article-title>  <source>Trends Cell Biol</source>., <volume>24</volume>, <fpage>686</fpage>–<lpage>694</lpage>.<pub-id pub-id-type="pmid">25103681</pub-id></mixed-citation>
    </ref>
    <ref id="btac248-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>MethylPurify: tumor purity deconvolution and differential methylation detection from single tumor DNA methylomes</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>419</fpage>.<pub-id pub-id-type="pmid">25103624</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
