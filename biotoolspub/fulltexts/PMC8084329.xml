<?properties open_access?>
<?subarticle pcbi.1008887.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8084329</article-id>
    <article-id pub-id-type="pmid">33872301</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008887</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-20-01128</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Materials Science</subject>
          <subj-group>
            <subject>Materials</subject>
            <subj-group>
              <subject>Contaminants</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Signal Transduction</subject>
            <subj-group>
              <subject>Cell Signaling</subject>
              <subj-group>
                <subject>Cellular Crosstalk</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Histochemistry and Cytochemistry Techniques</subject>
          <subj-group>
            <subject>Immunohistochemistry Techniques</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Immunologic Techniques</subject>
          <subj-group>
            <subject>Immunohistochemistry Techniques</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Architecture</subject>
          <subj-group>
            <subject>User Interfaces</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Fluorescence Imaging</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Specimen Preparation and Treatment</subject>
          <subj-group>
            <subject>Staining</subject>
            <subj-group>
              <subject>Nuclear Staining</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MAUI (MBI Analysis User Interface)—An image processing pipeline for Multiplexed Mass Based Imaging</article-title>
      <alt-title alt-title-type="running-head">MAUI—An image processing pipeline for Multiplexed Imaging</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4069-4444</contrib-id>
        <name>
          <surname>Baranski</surname>
          <given-names>Alex</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2459-3061</contrib-id>
        <name>
          <surname>Milo</surname>
          <given-names>Idan</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0680-7652</contrib-id>
        <name>
          <surname>Greenbaum</surname>
          <given-names>Shirley</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7192-7634</contrib-id>
        <name>
          <surname>Oliveria</surname>
          <given-names>John-Paul</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9269-2806</contrib-id>
        <name>
          <surname>Mrdjen</surname>
          <given-names>Dunja</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1531-5067</contrib-id>
        <name>
          <surname>Angelo</surname>
          <given-names>Michael</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Keren</surname>
          <given-names>Leeat</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>School of Medicine, Department of Pathology, Stanford University, Stanford, California, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Molecular Cell Biology, Weizmann Institute of Science, Rehovot, Israel</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Medicine, Division of Respirology, McMaster University, Hamilton, Ontario, Canada</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Hebrew University of Jerusalem, ISRAEL</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>I have read the journal’s policy and the authors of this manuscript have the following competing interests: MA is a consultant and shareholder in IonPath.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>mangelo0@stanford.edu</email> (MA); <email>leeat.keren@weizmann.ac.il</email> (LK)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>4</issue>
    <elocation-id>e1008887</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Baranski et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Baranski et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1008887.pdf"/>
    <abstract>
      <p>Mass Based Imaging (MBI) technologies such as Multiplexed Ion Beam Imaging by time of flight (MIBI-TOF) and Imaging Mass Cytometry (IMC) allow for the simultaneous measurement of the expression levels of 40 or more proteins in biological tissue, providing insight into cellular phenotypes and organization <italic>in situ</italic>. Imaging artifacts, resulting from the sample, assay or instrumentation complicate downstream analyses and require correction by domain experts. Here, we present MBI Analysis User Interface (MAUI), a series of graphical user interfaces that facilitate this data pre-processing, including the removal of channel crosstalk, noise and antibody aggregates. Our software streamlines these steps and accelerates processing by enabling real-time and interactive parameter tuning across multiple images.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>High-dimensional Imaging technologies allow to simultaneously measure the expression levels of dozens of proteins in biological tissue, providing insight into single-cell phenotypes and organization <italic>in situ</italic>. Imaging artifacts, resulting from the sample, assay or instrumentation complicate downstream analyses and require correction by domain experts. Here, we present MAUI, a series of graphical user interfaces that facilitate this data pre-processing, including the removal of channel crosstalk, noise and antibody aggregates. MAUI accelerates and automates these steps, such that reproducible, high-quality data will be the input for subsequent stages of analysis.</p>
    </abstract>
    <funding-group>
      <funding-statement>IM is funded by the European Union’s Horizon 2020 research and innovation programme under the Marie Sk?odowska-Curie grant agreement No 890733. SG is supported by the Bill and Melinda Gates Foundation OPP1113682. JPO was supported by a Canadian Institutes of Health Research (CIHR) Postdoctoral Fellowship and a Banting Postdoctoral Fellowship. DM is supported by the Swiss National Science Foundation Early Postdoc Mobility Fellowship: P2ZHP3_181563 and Novartis Postdoctoral Fellowship: #18B067. LK is the Fred and Andrea Fallek President's Development Chair and is supported by the Azrieli Foundation, Enoch Foundation Research Fund, European Research Council Horizon 2020 starting grant 948811, Damon Runyon-Dale F. Frey Award 131248 and Israel Science Foundation personal grant 2481/20. This research was partially supported by the Israeli Council for Higher Education (CHE) via the Weizmann Data Science Research Center. MA was supported by the Department of Defence grant W81XWH2110143, the National Institute of Health grants 1-DP5-OD019822, 5R01CA22952903, 1U24CA22430901, 5U54CA20997105, 1R01AG056287, 1R01AG057915, 1U24CA224309, and the Bill and Melinda Gates Foundation. MA is a consultant and shareholder in IonPath Inc. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="0"/>
      <page-count count="16"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-04-29</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The data can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/angelolab/MAUI">https://github.com/angelolab/MAUI</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The data can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/angelolab/MAUI">https://github.com/angelolab/MAUI</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="materials|methods" id="sec001">
    <title>Design and implementation</title>
    <p>A major goal of biological research and medical diagnosis is to understand how cellular phenotypes at a single cell level relate to the multi-cellular structures in which they reside. This requires the ability to quantify the spatial distribution of multiple proteins or mRNA transcripts across large regions of intact tissue. Recently, several new approaches have been introduced to allow this quantification. These can be broadly grouped to those that target mRNA, by either <italic>in situ</italic> hybridization [<xref rid="pcbi.1008887.ref001" ref-type="bibr">1</xref>,<xref rid="pcbi.1008887.ref002" ref-type="bibr">2</xref>] or sequencing [<xref rid="pcbi.1008887.ref003" ref-type="bibr">3</xref>–<xref rid="pcbi.1008887.ref005" ref-type="bibr">5</xref>] and those that target proteins, primarily using chromogen-, fluorescent- or mass-tagged antibodies [<xref rid="pcbi.1008887.ref006" ref-type="bibr">6</xref>–<xref rid="pcbi.1008887.ref011" ref-type="bibr">11</xref>]. These technologies vary in the number of measured parameters, size of images, speed of acquisition, resolution and compatibility with clinical specimens [<xref rid="pcbi.1008887.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1008887.ref014" ref-type="bibr">14</xref>]. However, the data generated by these methods is ultimately similar, consisting of a set of registered images, one for each measured parameter. For all of these, imaging artifacts, resulting from the sample, assay or instrumentation complicate downstream analyses. While some properties of these artifacts are unique to a specific technology, others are common across several modalities. Here we present MAUI (MBI Analysis User Interface), a graphical user interface that wraps a series of image processing methods to eliminate imaging artifacts in Mass Based Imaging (MBI). Although MAUI was designed for MBI methods, such as Multiplexed Ion Beam Imaging by time of flight (MIBI-TOF) and Imaging Mass Cytometry (IMC), we also demonstrate its utility for fluorescent-based imaging.</p>
    <p>We have previously described Multiplexed Ion Beam Imaging by time of flight (MIBI-TOF), a type of MBI method that uses secondary ionization mass spectrometry to image tissues stained with dozens of antibodies conjugated to heavy metal tags [<xref rid="pcbi.1008887.ref015" ref-type="bibr">15</xref>–<xref rid="pcbi.1008887.ref017" ref-type="bibr">17</xref>]. With MBI, tissue sections are stained with a cocktail of antibodies specific for the proteins of interest, each tagged with an isotopically-enriched elemental reporter. In MIBI-TOF, a primary ion beam scans across the sample to liberate the elemental reporters as secondary ions that are subsequently detected via orthogonal time of flight mass spectrometry. Ultimately, the result is a set of images, one for each antibody in the cocktail, where the intensity of signal in each pixel represents the number of ions (proportional to the amount of antibody and therefore target protein) detected in that physical location of the tissue (<xref ref-type="fig" rid="pcbi.1008887.g001">Fig 1</xref>).</p>
    <fig id="pcbi.1008887.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1008887.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Workflow of Multiplexed Ion Beam Imaging User Analysis Interface (MAUI).</title>
        <p>Tissue specimens are stained using a mixture of antibodies labeled with elemental mass tags. The samples are rasterized by a primary ion beam that releases the metals of the bound antibodies as secondary ions, which are recorded by a Time of Flight Mass Spec. This results in an n-dimensional image depicting protein expression in the field. Image processing includes removal of cross-channel contamination, noise and aggregates.</p>
      </caption>
      <graphic xlink:href="pcbi.1008887.g001"/>
    </fig>
    <p>While different factors can contribute to imaging artifacts, they can be broadly grouped into three classes. The first is the presence of channel crosstalk, whereby signal from one channel is detected at variable amounts in another channel. This can result from reporter impurities (e.g. Erbium 152 containing one percent of Erbium 151), peak tailing of high intensity reporters, polyatomic reporter adducts, or the presence of exposed gold slide [<xref rid="pcbi.1008887.ref017" ref-type="bibr">17</xref>]. The second is the presence of non-specific signal superimposed on top of the biological structures targeted by the antibody. This can typically be attributed to off-target antibody binding, high abundance organic adducts or instrumental noise. Depending on the intensity and spatial distribution of these sources, it includes signals that appear random, as well as dim patterns that correlate with histological features. The third is the occasional presence of aggregates, which show up as small bright specks of signal and are presumed to result from antibody aggregation. Notably, many of these issues are not specific to MIBI-TOF, and are encountered when using other highly multiplexed imaging modalities, including imaging mass cytometry (IMC) [<xref rid="pcbi.1008887.ref006" ref-type="bibr">6</xref>] or fluorescent approaches such as co-detection by indexing (CODEX) [<xref rid="pcbi.1008887.ref009" ref-type="bibr">9</xref>].</p>
    <p>We have developed a series of algorithms that enables the removal of these imaging artifacts to facilitate downstream analysis [<xref rid="pcbi.1008887.ref016" ref-type="bibr">16</xref>]. The pre-processing proceeds in three stages, one for each of the types of artifacts described above: the removal of (<xref ref-type="disp-formula" rid="pcbi.1008887.e001">1</xref>) channel crosstalk, (<xref ref-type="disp-formula" rid="pcbi.1008887.e002">2</xref>) nonspecific staining, and (<xref ref-type="disp-formula" rid="pcbi.1008887.e003">3</xref>) aggregates. Since the conditions under which these artifacts occur can vary between experiments, many parameters of the algorithms used are currently tuned by hand and evaluated by eye, leveraging the expert knowledge of pathologists and biologists. To facilitate this we present here MAUI, a graphical user interface that allows for real-time feedback between parameter adjustment and pre-processing output, drastically improving the data quality and efficiently reducing the time for further downstream analyses (<xref ref-type="fig" rid="pcbi.1008887.g002">Fig 2</xref>).</p>
    <fig id="pcbi.1008887.g002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1008887.g002</object-id>
      <label>Fig 2</label>
      <caption>
        <title>Processing MIBI data using MAUI results in signal similar to Immunohistochemistry.</title>
        <p>Shown are serial sections from human colon stained for CD8 by IHC (top left) or MIBI (top right). White arrows indicate cytotoxic T cells in the lamina propria of the gut. Red arrows indicate imaging artifacts including background and cross-channel contamination (bottom left). After processing by MAUI (bottom right) the CD8 signal mirrors the expected histological staining pattern by IHC. Scalebar equals 40μm.</p>
      </caption>
      <graphic xlink:href="pcbi.1008887.g002"/>
    </fig>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <p>We will demonstrate and discuss the functionalities of MAUI for MIBI data. Examples for similar analysis of IMC and CODEX are shown in <xref ref-type="supplementary-material" rid="pcbi.1008887.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008887.s002">S2</xref> Figs respectively.</p>
    <sec id="sec003">
      <title>Data structure</title>
      <p>The input to the software is either a multipage TIFF or a folder of TIFF files. Each page in the multipage TIFF or each image in the folder, respectively, depicts the signal for a pre-specified mass range, which corresponds to a single conjugated antibody. Each processing step with MAUI will add an additional folder of TIFFs to the dataset, using as input the results of the previous processing step.</p>
    </sec>
    <sec id="sec004">
      <title>Channel crosstalk</title>
      <p>Channel crosstalk refers to scenarios where the signal of a source channel contaminates a target channel or is correlated with such contamination. Channel crosstalk in MBI can occur for a variety of reasons, some of which we will detail below. The first predominant cause for channel crosstalk is ionic contamination. In addition to the predominating monoatomic ion (X<sup>+</sup>, where X = m/z), metal reporters used for antibody labeling can also produce relatively small amounts of metal hydrides (XH<sup>+</sup>), oxides (XO<sup>+</sup>), and hydroxides (XOH<sup>+</sup>) [<xref rid="pcbi.1008887.ref017" ref-type="bibr">17</xref>] with masses of X+1, X+16, and X+17 respectively (<xref ref-type="fig" rid="pcbi.1008887.g003">Fig 3A</xref>). These polyatomic metal adducts can potentially contaminate heavier mass reporters. For example, 149Sm typically produces a metal oxide at 165 amu (149+16) with 4% the intensity of the monoatomic peak that can contaminate signal arising from an antibody tagged with 165Ho [<xref rid="pcbi.1008887.ref017" ref-type="bibr">17</xref>]. Alternatively, in early versions of the instrument we observed that bare regions of the slide often resulted in high-intensity signal across multiple mass channels. Since this signal is derived from the slide, it has a near-perfect overlap with components of the slide coating, e.g. gold (197Au), tantalum (181Ta) and silicon (28Si) channels (<xref ref-type="fig" rid="pcbi.1008887.g003">Fig 3B</xref>). The current generation of instruments does not suffer from this form of signal contamination (<xref ref-type="supplementary-material" rid="pcbi.1008887.s003">S3A Fig</xref>).</p>
      <fig id="pcbi.1008887.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008887.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Removal of cross-channel contamination.</title>
          <p><bold>(A-C)</bold> Shown are examples for different sources of cross-channel contamination. In all cases a target channel (top row) is contaminated by another channel (middle row) or is correlated with such contamination. MAUI allows to remove this contamination from the target image (bottom row). <bold>(D)</bold> The first step for removal of cross-channel contamination is to cap, blur and threshold the contaminating channel to generate a binary mask of the contamination. The second is to remove signal where the mask is positive. <bold>(E-H)</bold> Examples of the resulting image when varying the algorithm parameters, including the Contaminant Cap (E), Gaussian Radius (F), Threshold (G), and the Remove Value (H). <bold>(I)</bold> The GUI enables to rapidly evaluate these parameters across many points and channels.</p>
        </caption>
        <graphic xlink:href="pcbi.1008887.g003"/>
      </fig>
      <p>Channel crosstalk can also occur from isotopic impurities in the metal stocks used for conjugation. Many elements naturally exist as a mixture of isotopes, and while these have been enriched to high purity for conjugation, they still have varying amounts of contaminating isotopes of the same element. For example, the element samarium has 7 naturally occurring isotopes with an abundance ranging from 3.08% (<sup>144</sup>Sm) to 26.74% (<sup>152</sup>Sm). <sup>152</sup>Sm can be purified to &gt;98% by electromagnetic enrichment, but will still contain small amounts of the other samarium isotopes. Finally, channel crosstalk can result from systematic, off-target staining, resulting from the antibodies or metals used. This often presents as dim staining of biological structures that the antibody is not expected to bind to. For example, indium and aluminum preferentially localize to nuclei, and therefore these channels may present nonspecific nuclear staining (Figs <xref ref-type="fig" rid="pcbi.1008887.g003">3C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008887.s003">S3B</xref>). In all these instances the contaminating signal in one channel mirrors real signal in another channel. Thus, one can use the latter to clean the signal in a target channel.</p>
      <p>We designed MAUI to facilitate cleaning of a target channel using the signal of a contaminating source channel. The pipeline is divided into three parts, easily visualized in the user interface (UI). First, the contaminating channel is processed in several steps to generate a binary mask, whereby pixels that are positive for the signal will have a value of one, and pixels that are negative for the signal will have a value of zero. In this step, the user can tune several parameters to influence the resulting mask. Once users are satisfied with the mask, they can evaluate its performance in cleaning different target channels, a step that also involves user-defined parameters. These two steps can be iterated until the user is satisfied with the result. Finally, the user can apply the selected channels and parameters to remove the contamination in multiple images.</p>
      <p>A detailed mathematical description of the contamination-removal algorithm is presented in the Methods section. Briefly, the first step of the algorithm is to generate a binary mask of the contaminating channel. Due to the sparse nature of mass spectrometry data, it is necessary to preprocess the contaminating channel before using it to clean the target channel. This includes capping the signal, smoothing it and binarizing it to generate a mask (<xref ref-type="fig" rid="pcbi.1008887.g003">Fig 3D</xref>). Each of these steps requires the user to input parameters that can be easily tuned and evaluated for their effect on the resulting mask. In the capping step, the user inputs a cap parameter, which sets the maximum value of the contaminating channel. Counts greater than the cap value will be set to the cap. This parameter allows for the homogenization of the signal intensity of the contaminating channel, by controlling overly bright signal (<xref ref-type="fig" rid="pcbi.1008887.g003">Fig 3E</xref>). The cap should be proportional to the expected intensity of the contaminating channel. Reducing its value will increase the number of pixels that are classified as positive for contaminant signal in the final mask.</p>
      <p>Next, the capped contaminant signal is blurred using a radial Gaussian filter. The user inputs a <italic>Gaussian Radius</italic> parameter to set the standard deviation of the filter. This step allows for the homogenization and smoothing of the signal in neighboring pixels (<xref ref-type="fig" rid="pcbi.1008887.g003">Fig 3F</xref>). Increasing the radius increases the blurring and will most likely result in more positive pixels in the mask. We have found that a radius of one pixel was suitable in most cases.</p>
      <p>Then, the capped and blurred image is normalized between zero and one. The <italic>Threshold</italic> parameter, which also takes values between zero and one, is then applied to generate a binary mask of the contaminating signal. Any pixel in the normalized contaminant channel above the threshold is set to 1, and any value below the threshold is set to 0. A higher threshold will reduce the number of positive pixels in the mask (<xref ref-type="fig" rid="pcbi.1008887.g003">Fig 3G</xref>). MAUI allows the user to view the original contaminant signal, while easily changing the algorithm parameters and evaluating the resulting mask. It also plots a histogram depicting the frequency of intensity values in the normalized contaminant image to facilitate the user in picking a threshold that adequately captures the signal in the contaminating channel.</p>
      <p>Once a binary mask of the contaminating channel has been generated, the user can now evaluate how this mask performs in cleaning any other channel using the <italic>Evaluation Parameters</italic> UI box. Cleaning is performed by subtracting a fixed value from all pixels in the target channel that were positive in the contaminant channel mask (<xref ref-type="fig" rid="pcbi.1008887.g003">Fig 3H</xref>). The value to remove is indicated by the user-defined parameter <italic>Remove Value</italic>. After removal, any value in the target channel that is below zero is set to zero. The user is given the option to remove a specific value, rather than, for example, zeroing out these pixels, because sometimes these pixels also have real signal superimposed with the contaminant. It is possible to zero out these pixels by choosing an arbitrarily large <italic>Remove Val</italic>. MAUI gives the user the option to evaluate all the parameters in cleaning different target channels and in different images.</p>
      <p>Finally, once the users are satisfied with the chosen channels and parameters, they can use them to remove contamination in multiple images (<xref ref-type="fig" rid="pcbi.1008887.g003">Fig 3I</xref>). MAUI will create a new folder and populate it with the contamination-removed versions of the loaded data. These can be used as input for further preprocessing, including additional rounds of contamination removal. The software will also save a log file documenting the parameters used, to allow reproducibility of the analysis.</p>
    </sec>
    <sec id="sec005">
      <title>Noise removal</title>
      <p>Image noise is traditionally defined as unwanted variation in image information, which deteriorates image quality. In antibody-based visualization of tissues it can result from various factors, ranging from instrumentation to tissue quality to nonspecific binding of antibodies, which generate weak signal that may follow histological patterns. For our purposes, we define noise as any signal outside of the biological structures the stain is expected to mark, and that does not specifically overlap with any of the other channels in the panel. Therefore, it is not possible to remove it by the contamination-removal technique described above.</p>
      <p>Here, we apply a K-Nearest-Neighbor (KNN) approach to noise filtering [<xref rid="pcbi.1008887.ref018" ref-type="bibr">18</xref>]. The approach takes advantage of the relatively low density of noise counts as compared to signal counts (high signal to noise ratio). It is based on the assumption that the presence of the intended biological target at a location will increase the odds of the antibody binding at that location, and that higher ion counts in and near a pixel indicate a higher probability of the associated biological signal being present at that location. We find this approach particularly suitable for MIBI data due to the sparse nature of the data.</p>
      <p>The denoising algorithm consists of two stages: first, the count density near each pixel is estimated using an intensity-normalized version of KNN, and second, the signal from low-density pixels is filtered. KNN estimates density by calculating the distances from a specific pixel <italic>x</italic><sub><italic>(i</italic>,<italic>j)</italic></sub> in the image to the closest <italic>k</italic> non-zero pixels. The shorter these distances are, the higher the density in that location. The intensity-normalized version performs similarly, but takes into account the count value in each positive pixel. Thus, instead of measuring the distances to the <italic>k</italic> closest positive pixels, it will calculate the distance to the <italic>k</italic> closest individual ion counts, whereby several counts can be found in the same pixel.</p>
      <p>For example, in <xref ref-type="fig" rid="pcbi.1008887.g004">Fig 4A</xref> we demonstrate the calculation of the 5-nearest-neighbors of the central pixel of the image, with a value if <italic>x</italic><sub><italic>(i</italic>,<italic>j)</italic></sub>
<italic>= 2</italic>. We think about this value as constituting two separate events. Thus, the first neighbor is inside of the same pixel, with a distance of zero. The next nearest neighbor is one pixel to the right, with a distance of one. The next three nearest-neighbors are two pixels away above, each of these with a distance of two (<xref ref-type="fig" rid="pcbi.1008887.g004">Fig 4B</xref>).</p>
      <fig id="pcbi.1008887.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008887.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Removal of noise using a K-Nearest-Neighbor (KNN) algorithm.</title>
          <p><bold>(A-B)</bold> Signal density at each pixel is determined using its K nearest neighbor counts. Shown is an example of the 5 nearest counts (A) and their distances (B) to the central pixel. <bold>(C)</bold> An example of staining of Histone H3 with noise surrounding the nuclear signal. <bold>(D)</bold> Shown is the frequency of the average distance to the 25 nearest counts for all pixels in (C). Signal is characterized by short distances (high density), whereas noise is characterized by long distances (low density). The red line is the chosen threshold for denoising, and pixels with large distances to their neighbors will be set to zero. <bold>(E)</bold> Histone H3 signal after denoising. <bold>(F)</bold> The average KNN-distribution for Histone H3, same as in (D), after denoising. <bold>(G-H)</bold> Examples of the resulting image of Histone H3 when varying the algorithm parameters, including the K-value (G) and Threshold (H). <bold>(I-J)</bold> Examples of the resulting image of a membranous protein, CD8, when varying the algorithm parameters, including the K-value (I) and Threshold (J). <bold>(K)</bold> The GUI enables to rapidly evaluate these parameters across many points and channels.</p>
        </caption>
        <graphic xlink:href="pcbi.1008887.g004"/>
      </fig>
      <p>We define the ADK as the average distance to the k nearest neighbors. The average distance to the 5-nearest-neighbors in the example above is <bold><italic>(0+1+2+2+2)/5 = 1</italic>.<italic>4</italic></bold>. For a given value of k, we then calculate the ADK for every pixel <italic>x</italic><sub><italic>(i</italic>,<italic>j)</italic></sub> in the image. <xref ref-type="fig" rid="pcbi.1008887.g004">Fig 4C</xref> depicts an image of Histone H3 (HH3), while <xref ref-type="fig" rid="pcbi.1008887.g004">Fig 4D</xref> depicts the corresponding distribution of ADK values for all positive pixels in the image, using a <italic>k</italic> value of 25. This is a bimodal distribution in which low ADK values correspond to high density of counts and are therefore attributable to signal, whereas high ADK values correspond to low density of counts, and therefore are considered as noise. The actual denoising involves picking a threshold used to separate “noise” from “signal”. Pixels with higher count densities (and therefore lower ADK values) are considered to be true signal and are left unchanged, while pixels with lower count densities (and therefore higher ADK values) are considered to be noise and their count value is set to zero. For example, using a threshold of 1.5 on the HH3 image shown in <xref ref-type="fig" rid="pcbi.1008887.g004">Fig 4C</xref>, any pixel with an ADK above 1.5 is set to zero, resulting in the image and corresponding distribution of ADK values shown in <xref ref-type="fig" rid="pcbi.1008887.g004">Fig 4E and 4F</xref>, correspondingly. A full mathematical derivation of the process is detailed in the Methods section.</p>
      <p>MAUI is designed to facilitate, streamline and expedite the process of denoising using the intensity-normalized KNN approach for multiple images at a time (<xref ref-type="fig" rid="pcbi.1008887.g004">Fig 4G–4K</xref>). The <italic>k</italic>-value and threshold are user-defined parameters, which can be easily adjusted for each marker at the discretion of the domain-expert. MAUI generates real-time feedback as the <italic>k</italic>-value and threshold are adjusted, making it fast and easy to intuit which value ranges are most effective for denoising a particular dataset. When a given marker is selected on a given image, the ADK distribution for the <italic>k</italic>-value is plotted, along with an indication of the current threshold value. Easy scrolling between loaded images allows rapid evaluation of these properties on different images. The raw data is plotted, along with the denoised data and the difference between the two. Because the dynamic range of MIBI images can be quite skewed (significant biological information can be contained within ion-count differences of 1 or 2 counts, while outliers of 10 or 20 counts are possible), a display cap parameter is included for easy visual display of the data. We find that both the ADK histogram and the images are useful tools in guiding users’ choice of parameters.</p>
      <p>Notably, current experience with this approach has demonstrated that the algorithm is quite robust to the specific value of <italic>k</italic> and for the most part does not need to be changed given the same imaging conditions. On the other hand, the threshold is dependent on the distributions of signal and noise for each target and is usually defined for each channel separately. Once appropriate <italic>k</italic> and threshold values have been selected for each channel, the entire dataset can be easily denoised using these parameters. MAUI will create a new folder and populate it with the noise-removed versions of the loaded data. These can be used as input for further processing. The software will also save a log file documenting the parameters used, to increase reproducibility.</p>
    </sec>
    <sec id="sec006">
      <title>Aggregate removal</title>
      <p>Aggregates are concentrated areas of high counts that have been reported in both MIBI and IMC data [<xref rid="pcbi.1008887.ref016" ref-type="bibr">16</xref>,<xref rid="pcbi.1008887.ref019" ref-type="bibr">19</xref>]. These spots are uncorrelated with any biological structures and are thought to result from conglomerations of antibodies. Aggregates can interfere with downstream analysis, particularly of weak channels, where they may be falsely interpreted as positive staining (<xref ref-type="fig" rid="pcbi.1008887.g005">Fig 5A</xref>). A more detailed discussion of aggregate identification is presented in the Methods section.</p>
      <fig id="pcbi.1008887.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008887.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Removal of aggregates.</title>
          <p><bold>(A)</bold> An overview of the aggregate-removal process. Left: An image of denoised Tryptase signal. Aggregates are evident in the top right corner. The image is blurred with a Gaussian filter and then binarized. Objects are extracted from the binary image, and any object small enough is considered an aggregate and removed. (B-C) Examples of the resulting image of Tryptase when varying the algorithm parameters, including the Threshold (B,C) and Blur radius (D-E). <bold>(F)</bold> The GUI enables to rapidly evaluate these parameters across many points and channels.</p>
        </caption>
        <graphic xlink:href="pcbi.1008887.g005"/>
      </fig>
      <p>The procedure for removing aggregates takes advantage of their small size, much smaller than real signal of biological structures, and involves finding small continuous areas of positive counts. First, the image is blurred using a Gaussian filter, and then the blurred image is thresholded using a cutoff of zero to create a binary mask. The blurring has the effect of merging patches of signal that are near each other, usually indicative of them being part of a larger structure, such as a cell or vessel. Then, once a mask has been generated, all connected objects in the binary mask and their sizes are identified. Any object below a size threshold selected by the user is considered to be an aggregate, and the values of the counts in its constituent pixels are set to zero (<xref ref-type="fig" rid="pcbi.1008887.g005">Fig 5A</xref>).</p>
      <p>MAUI allows the user to pick for each channel in the data the radius of the Gaussian blur as well as the size threshold for objects to be considered aggregates, listing the chosen parameters for each channel in a list (<xref ref-type="fig" rid="pcbi.1008887.g005">Fig 5B and 5C</xref>). MAUI will graphically display in real time the raw data and the aggregate-removed data, resulting from the currently chosen parameters. Empirically, we find that mild blurring (e.g. radius = 1) and a single threshold are often adequate across channels and datasets. Once an appropriate set of parameters has been chosen, MAUI allows to easily apply these parameters to all images in the dataset. Just as with the contamination removal and noise removal steps, MAUI will create a new folder and populate it with the aggregate-removed versions of the loaded data, as well as a log file recording the parameters.</p>
    </sec>
    <sec id="sec007">
      <title>Availability and future directions</title>
      <p>High-dimensional imaging technologies are poised to revolutionize tissue histology. These new modalities need specialized computational pipelines to facilitate pre-processing such that clean, high-quality data will be the input for subsequent stages of analysis. Here, we surveyed some of the common issues associated with data collected with multiplexed immunohistochemistry imaging platforms. We have described the simple computational solutions developed in our lab to address these issues and make MBI data suitable for subsequent analysis. MAUI, the graphical user interface that wraps these solutions, has substantially improved the speed and ease in which biologists and clinicians in our lab interact with the data and perform these labor and computationally-intensive steps in a reproducible and efficient manner. MAUI can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/angelolab/MAUI">https://github.com/angelolab/MAUI</ext-link>. We expect future developments in assays, instrumentation and computation to further enhance the quality of multiplexed-imaging data, making it more accessible to the large scientific community.</p>
    </sec>
  </sec>
  <sec sec-type="materials|methods" id="sec008">
    <title>Methods</title>
    <sec id="sec009">
      <title>Contaminant removal</title>
      <p>For a given channel of MBI data <italic>f</italic>(<italic>x</italic>,<italic>y</italic>) (<xref ref-type="disp-formula" rid="pcbi.1008887.e001">1</xref>) the user finds an associated contaminating channel <italic>h</italic>(<italic>x</italic>,<italic>y</italic>) (<xref ref-type="disp-formula" rid="pcbi.1008887.e002">2</xref>). The user then picks a cap value <italic>c</italic> which is used to create a capped version of the contaminating channel <italic>h</italic><sub><italic>capped</italic></sub>(<italic>x</italic>,<italic>y</italic>) (<xref ref-type="disp-formula" rid="pcbi.1008887.e003">3</xref>). The user then picks a standard deviation <italic>σ</italic> for a Gaussian blur <italic>g</italic>(<italic>x</italic>,<italic>y</italic>) (<xref ref-type="disp-formula" rid="pcbi.1008887.e004">4</xref>), which is convolved with <italic>h</italic><sub><italic>capped</italic></sub> to create a blurred version <italic>h</italic><sub><italic>blurred</italic></sub> (<xref ref-type="disp-formula" rid="pcbi.1008887.e005">5</xref>). This image is then rescaled to have a maximum of 1, producing an image <italic>h</italic><sub><italic>rescaled</italic></sub> (<xref ref-type="disp-formula" rid="pcbi.1008887.e006">6</xref>). The user then picks a threshold value <italic>t</italic> which is used to binarize <italic>h</italic><sub><italic>rescaled</italic></sub>, producing a binary mask that can be used for contaminant removal, <italic>h</italic><sub><italic>mask</italic></sub> (<xref ref-type="disp-formula" rid="pcbi.1008887.e007">7</xref>). Finally, the user selects a removal value <italic>v</italic>. At any pixel location (<italic>x</italic>,<italic>y</italic>) where <italic>h</italic><sub><italic>mask</italic></sub>(<italic>x</italic>,<italic>y</italic>) is 1, we remove <italic>v</italic> from <italic>f</italic>(<italic>x</italic>,<italic>y</italic>), producing <italic>f</italic><sub><italic>removed</italic></sub> (<xref ref-type="disp-formula" rid="pcbi.1008887.e008">8</xref>). Anywhere <italic>f</italic><sub><italic>removed</italic></sub>&lt;0 is set to zero, since negative values of counts are nonsensical. This produced the final contaminant-removed MBI data, <italic>f</italic><sub><italic>clean</italic></sub> (<xref ref-type="disp-formula" rid="pcbi.1008887.e009">9</xref>).</p>
      <disp-formula id="pcbi.1008887.e001">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e001.jpg" id="pcbi.1008887.e001g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M1">
            <mml:mi>f</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi mathvariant="italic">Target</mml:mi>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="italic">MBI</mml:mi>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="italic">data</mml:mi>
          </mml:math>
        </alternatives>
        <label>1</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e002">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e002.jpg" id="pcbi.1008887.e002g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M2">
            <mml:mi>h</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi mathvariant="italic">Contaminating</mml:mi>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="italic">MBI</mml:mi>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="italic">data</mml:mi>
          </mml:math>
        </alternatives>
        <label>2</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e003">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e003.jpg" id="pcbi.1008887.e003g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M3">
            <mml:msub>
              <mml:mrow>
                <mml:mi>h</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>p</mml:mi>
                <mml:mi>p</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>d</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mi>h</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>h</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mspace width="2.25em"/>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>h</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>&gt;</mml:mo>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>3</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e004">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e004.jpg" id="pcbi.1008887.e004g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M4">
            <mml:mi>g</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
                <mml:mi>π</mml:mi>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:mfrac>
            <mml:msup>
              <mml:mrow>
                <mml:mi>e</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>+</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:msup>
          </mml:math>
        </alternatives>
        <label>4</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e005">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e005.jpg" id="pcbi.1008887.e005g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M5">
            <mml:msub>
              <mml:mrow>
                <mml:mi>h</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>b</mml:mi>
                <mml:mi>l</mml:mi>
                <mml:mi>u</mml:mi>
                <mml:mi>r</mml:mi>
                <mml:mi>r</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>d</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mi>g</mml:mi>
            <mml:mo>*</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>h</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>p</mml:mi>
                <mml:mi>p</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>d</mml:mi>
              </mml:mrow>
            </mml:msub>
          </mml:math>
        </alternatives>
        <label>5</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e006">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e006.jpg" id="pcbi.1008887.e006g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M6">
            <mml:msub>
              <mml:mrow>
                <mml:mi>h</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>r</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>s</mml:mi>
                <mml:mi>c</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>l</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>d</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>h</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>b</mml:mi>
                    <mml:mi>l</mml:mi>
                    <mml:mi>u</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>d</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">max</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>[</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>h</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                      <mml:mi>l</mml:mi>
                      <mml:mi>u</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mi>e</mml:mi>
                      <mml:mi>d</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>y</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>]</mml:mo>
              </mml:mrow>
            </mml:mfrac>
          </mml:math>
        </alternatives>
        <label>6</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e007">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e007.jpg" id="pcbi.1008887.e007g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M7">
            <mml:msub>
              <mml:mrow>
                <mml:mi>h</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>s</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>h</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mi>l</mml:mi>
                          <mml:mi>u</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>e</mml:mi>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                      <mml:mo>≥</mml:mo>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>h</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mi>l</mml:mi>
                          <mml:mi>u</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>e</mml:mi>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                      <mml:mo>&lt;</mml:mo>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>7</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e008">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e008.jpg" id="pcbi.1008887.e008g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M8">
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>r</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>m</mml:mi>
                <mml:mi>o</mml:mi>
                <mml:mi>v</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>d</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mspace width="1.75em"/>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>h</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>a</mml:mi>
                          <mml:mi>s</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mi>v</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>h</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>a</mml:mi>
                          <mml:mi>s</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>8</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e009">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e009.jpg" id="pcbi.1008887.e009g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M9">
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mi>l</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mi>e</mml:mi>
                          <mml:mi>m</mml:mi>
                          <mml:mi>o</mml:mi>
                          <mml:mi>v</mml:mi>
                          <mml:mi>e</mml:mi>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mi>e</mml:mi>
                          <mml:mi>m</mml:mi>
                          <mml:mi>o</mml:mi>
                          <mml:mi>v</mml:mi>
                          <mml:mi>e</mml:mi>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                      <mml:mo>≥</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mspace width="5.5em"/>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mi>e</mml:mi>
                          <mml:mi>m</mml:mi>
                          <mml:mi>o</mml:mi>
                          <mml:mi>v</mml:mi>
                          <mml:mi>e</mml:mi>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                      <mml:mo>&lt;</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>9</label>
      </disp-formula>
    </sec>
    <sec id="sec010">
      <title>Noise removal</title>
      <p>We let <italic>f</italic>(<italic>x</italic>,<italic>y</italic>) be the function that maps pixels in an image to ion counts on a particular channel of MBI data (<xref ref-type="disp-formula" rid="pcbi.1008887.e012">10</xref>). We define a function <italic>C</italic>(<italic>x</italic>,<italic>y</italic>) which takes in a single pixel (<italic>x</italic>,<italic>y</italic>) and outputs a list with <italic>f</italic>(<italic>x</italic>,<italic>y</italic>)copies of <italic>f</italic>(<italic>x</italic>,<italic>y</italic>) (<xref ref-type="disp-formula" rid="pcbi.1008887.e013">11</xref>). We let this function be defined on lists of pixels (<italic>a</italic>,<italic>b</italic>,<italic>c</italic>,…) such that the output is the concatenation of the outputs of the function on each of the individual pixels in the input list (<xref ref-type="disp-formula" rid="pcbi.1008887.e014">12</xref>). We then define another function <italic>N</italic>(<italic>x</italic>,<italic>y</italic>) which outputs a list of all pixels in the image ordered by their Euclidean distance (denoted by ‖∙‖) from (<italic>x</italic>,<italic>y</italic>) (<xref ref-type="disp-formula" rid="pcbi.1008887.e015">13</xref>). We then let <inline-formula id="pcbi.1008887.e010"><alternatives><graphic xlink:href="pcbi.1008887.e010.jpg" id="pcbi.1008887.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1008887.e017">14</xref>) and take only the first <italic>K</italic> entries, defining <inline-formula id="pcbi.1008887.e011"><alternatives><graphic xlink:href="pcbi.1008887.e011.jpg" id="pcbi.1008887.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:msub><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, which we call the <italic>K</italic>-nearest neighbors of (<italic>x</italic>,<italic>y</italic>) (<xref ref-type="disp-formula" rid="pcbi.1008887.e018">15</xref>). We then calculate the average distance to the <italic>K</italic>-nearest neighbors of each pixel (<italic>x</italic>,<italic>y</italic>) denoted by <italic>A</italic><sub><italic>K</italic></sub>(<italic>x</italic>,<italic>y</italic>) (<xref ref-type="disp-formula" rid="pcbi.1008887.e019">16</xref>). To clean the data, the user picks a threshold <italic>t</italic><sub><italic>n</italic></sub>, which is used to separate “noise” counts from “signal” counts. Any pixel with an average distance to its <italic>K</italic>-nearest neighbors more than the threshold is treated as noise and zeroed-out, otherwise its value is left unchanged (<xref ref-type="disp-formula" rid="pcbi.1008887.e020">17</xref>).</p>
      <disp-formula id="pcbi.1008887.e012">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e012.jpg" id="pcbi.1008887.e012g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M12">
            <mml:mi>f</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi mathvariant="italic">MBI</mml:mi>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="italic">data</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo>∈</mml:mo>
            <mml:mo>[</mml:mo>
            <mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mi>w</mml:mi>
            </mml:mrow>
            <mml:mo>]</mml:mo>
            <mml:mo>,</mml:mo>
            <mml:mi>y</mml:mi>
            <mml:mo>∈</mml:mo>
            <mml:mo>[</mml:mo>
            <mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mi>h</mml:mi>
            </mml:mrow>
            <mml:mo>]</mml:mo>
          </mml:math>
        </alternatives>
        <label>10</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e013">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e013.jpg" id="pcbi.1008887.e013g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M13">
            <mml:mi>C</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mi>x</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mi>x</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mo>)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mi>x</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mo>)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mo>…</mml:mo>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mi>x</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="normal">s.t.</mml:mi>
            <mml:mspace width="0.25em"/>
            <mml:mo>|</mml:mo>
            <mml:mrow>
              <mml:mi>C</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>y</mml:mi>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>|</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>f</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
          </mml:math>
        </alternatives>
        <label>11</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e014">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e014.jpg" id="pcbi.1008887.e014g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M14">
            <mml:mi>C</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mi>a</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>b</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>c</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mo>…</mml:mo>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>C</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>a</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>⊕</mml:mo>
            <mml:mi>C</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>b</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>⊕</mml:mo>
            <mml:mi>C</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>c</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>⊕</mml:mo>
            <mml:mo>…</mml:mo>
          </mml:math>
        </alternatives>
        <label>12</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e015">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e015.jpg" id="pcbi.1008887.e015g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M15">
            <mml:mi>N</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>y</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>y</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:mo>…</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>y</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>w</mml:mi>
                  <mml:mo>×</mml:mo>
                  <mml:mi>h</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="normal">s.t.</mml:mi>
            <mml:mspace width="0.25em"/>
            <mml:mo>∀</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>y</mml:mi>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>∈</mml:mo>
            <mml:mi>N</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:math>
        </alternatives>
        <label>13</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e016">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e016.jpg" id="pcbi.1008887.e016g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M16">
            <mml:mo>∥</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>y</mml:mi>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>−</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>∥</mml:mo>
            <mml:mo>&gt;</mml:mo>
            <mml:mo>∥</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>y</mml:mi>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>−</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>∥</mml:mo>
          </mml:math>
        </alternatives>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e017">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e017.jpg" id="pcbi.1008887.e017g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M17">
            <mml:mi mathvariant="script">N</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>C</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>N</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mi>x</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>)</mml:mo>
          </mml:math>
        </alternatives>
        <label>14</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e018">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e018.jpg" id="pcbi.1008887.e018g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M18">
            <mml:msub>
              <mml:mrow>
                <mml:mi mathvariant="script">N</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>K</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>y</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>|</mml:mo>
            <mml:mrow>
              <mml:mi>i</mml:mi>
              <mml:mo>∈</mml:mo>
              <mml:mo>[</mml:mo>
              <mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>K</mml:mi>
              </mml:mrow>
              <mml:mo>]</mml:mo>
            </mml:mrow>
            <mml:mo>)</mml:mo>
          </mml:math>
        </alternatives>
        <label>15</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e019">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e019.jpg" id="pcbi.1008887.e019g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M19">
            <mml:msub>
              <mml:mrow>
                <mml:mi>A</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>K</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>K</mml:mi>
              </mml:mrow>
            </mml:mfrac>
            <mml:mrow>
              <mml:msubsup>
                <mml:mo stretchy="false">∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>K</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo>∥</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>−</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>y</mml:mi>
                </mml:mrow>
                <mml:mo>)</mml:mo>
                <mml:mo>∥</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>16</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e020">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e020.jpg" id="pcbi.1008887.e020g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M20">
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mi>l</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mi>A</mml:mi>
                      <mml:mo>_</mml:mo>
                      <mml:mi>K</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>≤</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mspace width="2.25em"/>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mi>A</mml:mi>
                      <mml:mo>_</mml:mo>
                      <mml:mi>K</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>&gt;</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>17</label>
      </disp-formula>
    </sec>
    <sec id="sec011">
      <title>Aggregate removal</title>
      <p>We let <italic>f</italic>(<italic>x</italic>,<italic>y</italic>) be MBI data, as in (<xref ref-type="disp-formula" rid="pcbi.1008887.e012">10</xref>). The user picks a standard deviation <italic>σ</italic> for a Gaussian filter <italic>g</italic> (<xref ref-type="disp-formula" rid="pcbi.1008887.e021">18</xref>), which is convolved with our data to produce <italic>f</italic><sub><italic>blurred</italic></sub> (<xref ref-type="disp-formula" rid="pcbi.1008887.e022">19</xref>). We then binarize this image to create <italic>f</italic><sub><italic>mask</italic></sub> (<xref ref-type="disp-formula" rid="pcbi.1008887.e023">20</xref>).</p>
      <p>We use a built-in function in MATLAB called <italic>regionprops</italic>, here denoted as <italic>f</italic><sub><italic>object</italic></sub>, which takes in a binary mask and outputs all connected sets of pixels with a value of 1 (thus any set of pixels in the input with a value of 1 which are connected to each other will be considered a single object). All such objects are returned as outputs of the function (<xref ref-type="disp-formula" rid="pcbi.1008887.e024">21</xref>). The user defines a threshold <italic>t</italic><sub><italic>a</italic></sub> for the size of aggregate objects, where objects with fewer pixels than <italic>t</italic><sub><italic>a</italic></sub> are counted as aggregates (<xref ref-type="disp-formula" rid="pcbi.1008887.e025">22</xref>). Finally, all pixels in the data the user is cleaning that are part of an aggregate object are zeroed-out (<xref ref-type="disp-formula" rid="pcbi.1008887.e026">23</xref>).</p>
      <disp-formula id="pcbi.1008887.e021">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e021.jpg" id="pcbi.1008887.e021g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M21">
            <mml:mi>g</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
                <mml:mi>π</mml:mi>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:mfrac>
            <mml:msup>
              <mml:mrow>
                <mml:mi>e</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>+</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:msup>
          </mml:math>
        </alternatives>
        <label>18</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e022">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e022.jpg" id="pcbi.1008887.e022g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M22">
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>b</mml:mi>
                <mml:mi>l</mml:mi>
                <mml:mi>u</mml:mi>
                <mml:mi>r</mml:mi>
                <mml:mi>r</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>d</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mi>g</mml:mi>
            <mml:mo>*</mml:mo>
            <mml:mi>f</mml:mi>
          </mml:math>
        </alternatives>
        <label>19</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e023">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e023.jpg" id="pcbi.1008887.e023g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M23">
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>s</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mi>l</mml:mi>
                          <mml:mi>u</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>e</mml:mi>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                      <mml:mo>≤</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mi>l</mml:mi>
                          <mml:mi>u</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>e</mml:mi>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                      <mml:mo>&gt;</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>20</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e024">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e024.jpg" id="pcbi.1008887.e024g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M24">
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>o</mml:mi>
                <mml:mi>b</mml:mi>
                <mml:mi>j</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>c</mml:mi>
                <mml:mi>t</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>M</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mi>o</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>o</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:mo>…</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>o</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>}</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mi>s</mml:mi>
            <mml:mo>.</mml:mo>
            <mml:mi>t</mml:mi>
            <mml:mo>.</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:msub>
              <mml:mrow>
                <mml:mi>o</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="normal">i</mml:mi>
            <mml:mi mathvariant="normal">s</mml:mi>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="normal">a</mml:mi>
            <mml:mi mathvariant="normal">n</mml:mi>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="normal">o</mml:mi>
            <mml:mi mathvariant="normal">b</mml:mi>
            <mml:mi mathvariant="normal">j</mml:mi>
            <mml:mi mathvariant="normal">e</mml:mi>
            <mml:mi mathvariant="normal">c</mml:mi>
            <mml:mi mathvariant="normal">t</mml:mi>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="normal">i</mml:mi>
            <mml:mi mathvariant="normal">n</mml:mi>
            <mml:mspace width="0.25em"/>
            <mml:mi>M</mml:mi>
          </mml:math>
        </alternatives>
        <label>21</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e025">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e025.jpg" id="pcbi.1008887.e025g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M25">
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>a</mml:mi>
                <mml:mi>g</mml:mi>
                <mml:mi>g</mml:mi>
                <mml:mi>r</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>g</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>t</mml:mi>
                <mml:mi>e</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>M</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo>{</mml:mo>
            <mml:mi>o</mml:mi>
            <mml:mo>∈</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>o</mml:mi>
                <mml:mi>b</mml:mi>
                <mml:mi>j</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>c</mml:mi>
                <mml:mi>t</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>M</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>|</mml:mo>
            <mml:mo>|</mml:mo>
            <mml:mrow>
              <mml:mi>o</mml:mi>
            </mml:mrow>
            <mml:mo>|</mml:mo>
            <mml:mo>&lt;</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>t</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>}</mml:mo>
          </mml:math>
        </alternatives>
        <label>22</label>
      </disp-formula>
      <disp-formula id="pcbi.1008887.e026">
        <alternatives>
          <graphic xlink:href="pcbi.1008887.e026.jpg" id="pcbi.1008887.e026g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M26">
            <mml:msub>
              <mml:mrow>
                <mml:mi>f</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
                <mml:mi>l</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo>{</mml:mo>
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mo>∄</mml:mo>
                      <mml:mi>o</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mi>g</mml:mi>
                          <mml:mi>g</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>e</mml:mi>
                          <mml:mi>g</mml:mi>
                          <mml:mi>a</mml:mi>
                          <mml:mi>t</mml:mi>
                          <mml:mi>e</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mi>s</mml:mi>
                      <mml:mo>.</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>.</mml:mo>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>∈</mml:mo>
                      <mml:mi>o</mml:mi>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mspace width="2.5em"/>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>∃</mml:mo>
                      <mml:mi>o</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mi>g</mml:mi>
                          <mml:mi>g</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>e</mml:mi>
                          <mml:mi>g</mml:mi>
                          <mml:mi>a</mml:mi>
                          <mml:mi>t</mml:mi>
                          <mml:mi>e</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mi>s</mml:mi>
                      <mml:mo>.</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>.</mml:mo>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>y</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>∈</mml:mo>
                      <mml:mi>o</mml:mi>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>23</label>
      </disp-formula>
      <p>Judging whether large <italic>clumps of signal</italic> is true signal vs aggregation can range from easy to non-trivial depending on the antibody, tissue and aggregation state. Currently, this process depends to a large extent on experts with domain knowledge. We commonly employ the following guidelines to decide if a signal is real or an aggregate: (A) <italic>Familiarity with the expected staining pattern of the antibody</italic>. Whereas for some antibodies we expect small, punctate staining, which is difficult to differentiate from aggregates (e.g. Granzyme B), most of the antibodies that we use stain larger cellular structures. We use knowledge on the expected staining patterns, both intra-cellularly (e.g. nuclear vs. membrane), cellularly (e.g. expected coexpression of markers) and histologically (e.g. expected staining in some anatomical locations and not others) to decide whether a “clump of signal” is real or not. While there may be ambiguous cases, for the most part it is quite clear. (B) <italic>Comparison between different tissues</italic>. In our experience, once an antibody vial begins to aggregate, aggregates will be observed in all tissues stained with that vial. As such, if one suspects that signal is actually an aggregate, it is useful to see whether aggregates are present in this channel across additional images. (C) <italic>Design of specific experiments to check for aggregates</italic>. When one is uncertain whether an antibody is aggregated, it is possible to design specific staining experiments to address this. For example, staining a negative control tissue that is not expected to express the target protein. Alternatively, one can stain serial sections and see whether the signal repeats between sections.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec012">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1008887.s001">
      <label>S1 Fig</label>
      <caption>
        <title>Analysis of IMC data using MAUI.</title>
        <p>The top left panel shows an image of CD68 from an IMC dataset (Jackson et al., Nature 2020). Staining intensity is shown as a heatmap from blue (low) to high (yellow). White arrows denote real CD68 staining, as validated by coexpression of CD45. Colored arrows denote various imaging artifacts including cross-channel contamination (red), noise (green) and aggregates (orange). Each row in the image shows one stage of processing by MAUI, including removal of cross channel contamination (top), denoising (middle) and removal of aggregates (bottom) as detailed. The final image is shown in the bottom right. Scalebar equals 30μm.</p>
        <p>(JPEG)</p>
      </caption>
      <media xlink:href="pcbi.1008887.s001.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008887.s002">
      <label>S2 Fig</label>
      <caption>
        <title>Analysis of CODEX data using MAUI.</title>
        <p>The top left panel shows an image of CD8 from a CODEX dataset (Schurch et al., Cell 2020). Staining intensity is shown as a heatmap from blue (low) to high (yellow). White arrows denote real CD8 staining, as validated by coexpression of CD3 and CD45. Colored arrows denote various imaging artifacts including cross-channel contamination (red), noise (green) and aggregates (orange). Each row in the image shows one stage of processing by MAUI, including removal of cross channel contamination (top), denoising (middle) and removal of aggregates (bottom) as detailed. The final image is shown in the bottom right. Scalebar equals 50μm.</p>
        <p>(JPEG)</p>
      </caption>
      <media xlink:href="pcbi.1008887.s002.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008887.s003">
      <label>S3 Fig</label>
      <caption>
        <title>Underlying reasons for cross channel contamination.</title>
        <p><bold>(A)</bold> Shown is an image for the mass range of 128–132, which has no labeled signal in it (left column) for the first (top) and second (bottom) generations of the instrument. In the first-generation instruments this background signal (right column) mirrors the bare slide and therefore the gold channel (middle column). In the second-generation instruments (bottom), this slide-specific background is mitigated and the background only has salt-and-pepper noise. <bold>(B)</bold> MIBI-TOF staining of human FFPE tonsil with free <sup>115</sup>Indium and antibodies for Histone H3 and CD45 shows nuclear localization of <sup>115</sup>Indium. Scalebar equals 10μm.</p>
        <p>(JPEG)</p>
      </caption>
      <media xlink:href="pcbi.1008887.s003.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008887.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Moffitt</surname><given-names>J.R.</given-names></name>, <name><surname>Bambah-Mukku</surname><given-names>D.</given-names></name>, <name><surname>Eichhorn</surname><given-names>S.W.</given-names></name>, <name><surname>Vaughn</surname><given-names>E.</given-names></name>, <name><surname>Shekhar</surname><given-names>K.</given-names></name>, <name><surname>Perez</surname><given-names>J.D.</given-names></name>, <etal>et al</etal>. <article-title>Molecular, spatial, and functional single-cell profiling of the hypothalamic preoptic region</article-title>. <source>Science</source><year>2018</year>; <volume>362</volume>, <fpage>eaau5324</fpage>. <pub-id pub-id-type="doi">10.1126/science.aau5324</pub-id><?supplied-pmid 30385464?><pub-id pub-id-type="pmid">30385464</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Zhu</surname><given-names>Q.</given-names></name>, <name><surname>Shah</surname><given-names>S.</given-names></name>, <name><surname>Dries</surname><given-names>R.</given-names></name>, <name><surname>Cai</surname><given-names>L.</given-names></name>, and <name><surname>Yuan</surname><given-names>G.-C.</given-names></name><article-title>Identification of spatially associated subpopulations by combining scRNAseq and sequential fluorescence in situ hybridization data</article-title>. <source>Nat. Biotechnol</source>. <year>2018</year>; <volume>36</volume>, <fpage>1183</fpage>. <pub-id pub-id-type="doi">10.1038/nbt.4260</pub-id><?supplied-pmid 30371680?><pub-id pub-id-type="pmid">30371680</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Ke</surname><given-names>R</given-names></name>., <name><surname>Mignardi</surname><given-names>M</given-names></name>., <name><surname>Pacureanu</surname><given-names>A</given-names></name>., <name><surname>Svedlund</surname><given-names>J</given-names></name>., <name><surname>Botling</surname><given-names>J</given-names></name>., <name><surname>Wählby</surname><given-names>C</given-names></name>., <etal>et al</etal>. <article-title>In situ sequencing for RNA analysis in preserved tissue and cells</article-title>. <source>Nat. Methods</source><year>2013</year>; <volume>10</volume>, <fpage>857</fpage>–<lpage>860</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2563</pub-id><?supplied-pmid 23852452?><pub-id pub-id-type="pmid">23852452</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Ståhl</surname><given-names>P.L</given-names></name>., <name><surname>Salmén</surname><given-names>F</given-names></name>., <name><surname>Vickovic</surname><given-names>S</given-names></name>., <name><surname>Lundmark</surname><given-names>A</given-names></name>., <name><surname>Navarro</surname><given-names>J.F</given-names></name>., <name><surname>Magnusson</surname><given-names>J., S</given-names></name>. <etal>et al</etal>. <article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>. <source>Science</source><year>2016</year>; <volume>353</volume>, <fpage>78</fpage>–<lpage>82</lpage>, <pub-id pub-id-type="doi">10.1126/science.aaf2403</pub-id><?supplied-pmid 27365449?><pub-id pub-id-type="pmid">27365449</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>X.</given-names></name>, <name><surname>Allen</surname><given-names>W.E.</given-names></name>, <name><surname>Wright</surname><given-names>M.A.</given-names></name>, <name><surname>Sylwestrak</surname><given-names>E.L.</given-names></name>, <name><surname>Samusik</surname><given-names>N.</given-names></name>, <name><surname>Vesuna</surname><given-names>S.</given-names></name>, <etal>et al</etal>. <article-title>Three-dimensional intact-tissue sequencing of single-cell transcriptional states</article-title>. <source>Science</source><year>2018</year>; <volume>361</volume>, <fpage>eaat5691</fpage>. <pub-id pub-id-type="doi">10.1126/science.aat5691</pub-id><?supplied-pmid 29930089?><pub-id pub-id-type="pmid">29930089</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Chevrier</surname><given-names>S.</given-names></name>, <name><surname>Crowell</surname><given-names>H.L.</given-names></name>, <name><surname>Zanotelli</surname><given-names>V.R.T.</given-names></name>, <name><surname>Engler</surname><given-names>S.</given-names></name>, <name><surname>Robinson</surname><given-names>M.D.</given-names></name>, and <name><surname>Bodenmiller</surname><given-names>B.</given-names></name><article-title>Compensation of Signal Spillover in Suspension and Imaging Mass Cytometry</article-title>. <source>Cell Syst</source>. <year>2018</year>; <volume>6</volume>, <fpage>612</fpage>–<lpage>620.e5</lpage>. <pub-id pub-id-type="doi">10.1016/j.cels.2018.02.010</pub-id><?supplied-pmid 29605184?><pub-id pub-id-type="pmid">29605184</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Gerdes</surname><given-names>M.J.</given-names></name>, <name><surname>Sevinsky</surname><given-names>C.J.</given-names></name>, <name><surname>Sood</surname><given-names>A.</given-names></name>, <name><surname>Adak</surname><given-names>S.</given-names></name>, <name><surname>Bello</surname><given-names>M.O.</given-names></name>, <name><surname>Bordwell</surname><given-names>A.</given-names></name>, <etal>et al</etal>. <article-title>Highly multiplexed sin- gle-cell analysis of formalin-fixed, paraffin-embedded cancer tissue</article-title>. <source>Proc. Natl. Acad. Sci. USA</source><year>2013</year>; <volume>110</volume>, <fpage>11982</fpage>–<lpage>11987</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1300136110</pub-id><?supplied-pmid 23818604?><pub-id pub-id-type="pmid">23818604</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Gerner</surname><given-names>M.Y</given-names></name>., <name><surname>Kastenmuller</surname><given-names>W</given-names></name>., <name><surname>Ifrim</surname><given-names>I</given-names></name>., <name><surname>Kabat</surname><given-names>J</given-names></name>., <name><surname>Germain</surname><given-names>R.N</given-names></name>. <article-title>Histo-cytometry: a method for highly multiplex quantitative tissue imaging analysis applied to dendritic cell subset microanatomy in lymph nodes</article-title>. <source>Immunity</source><year>2012</year>; <volume>37</volume>(<issue>2</issue>):<fpage>364</fpage>–<lpage>76</lpage>. <pub-id pub-id-type="doi">10.1016/j.immuni.2012.07.011</pub-id><?supplied-pmid 22863836?><pub-id pub-id-type="pmid">22863836</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Goltsev</surname><given-names>Y.</given-names></name>, <name><surname>Samusik</surname><given-names>N.</given-names></name>, <name><surname>Kennedy-Darling</surname><given-names>J.</given-names></name>, <name><surname>Bhate</surname><given-names>S.</given-names></name>, <name><surname>Hale</surname><given-names>M.</given-names></name>, <name><surname>Vazquez</surname><given-names>G.</given-names></name>, <etal>et al</etal>. <article-title>Deep Profiling of Mouse Splenic Architecture with CODEX Multiplexed Imaging</article-title>. <source>Cell</source><year>2018</year>; <volume>174</volume>, <fpage>968</fpage>–<lpage>981.e15</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2018.07.010</pub-id><?supplied-pmid 30078711?><pub-id pub-id-type="pmid">30078711</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Gut</surname><given-names>G.</given-names></name>, <name><surname>Herrmann</surname><given-names>M.D.</given-names></name>, and <name><surname>Pelkmans</surname><given-names>L.</given-names></name><article-title>Multiplexed protein maps link subcellular organization to cellular states</article-title>. <source>Science</source><year>2018</year>; <volume>361</volume>, <fpage>eaar7042</fpage>. <pub-id pub-id-type="doi">10.1126/science.aar7042</pub-id><?supplied-pmid 30072512?><pub-id pub-id-type="pmid">30072512</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Saka</surname><given-names>S.K.</given-names></name>, <name><surname>Wang</surname><given-names>Y.</given-names></name>, <name><surname>Kishi</surname><given-names>J.Y.</given-names></name>, <name><surname>Zhu</surname><given-names>A.</given-names></name>, <name><surname>Zeng</surname><given-names>Y.</given-names></name>, <name><surname>Xie</surname><given-names>W.</given-names></name>, <etal>et al</etal>. <article-title>Immuno-SABER enables highly multi-plexed and amplified protein imaging in tissues</article-title>. <source>Nat. Biotechnol</source>. <year>2019</year>; <volume>37</volume>, <fpage>1080</fpage>–<lpage>1090</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-019-0207-y</pub-id><?supplied-pmid 31427819?><pub-id pub-id-type="pmid">31427819</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Hartmann</surname><given-names>F.J.</given-names></name>, <name><surname>Bendall</surname><given-names>S.C.</given-names></name><article-title>Immune monitoring using mass cytometry and related high-dimensional imaging approaches</article-title>. <source>Nat Rev Rheumatol</source><year>2020</year>; <volume>16</volume>, <fpage>87</fpage>–<lpage>99</lpage>. <pub-id pub-id-type="doi">10.1038/s41584-019-0338-z</pub-id><?supplied-pmid 31892734?><pub-id pub-id-type="pmid">31892734</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Taube</surname><given-names>J.M</given-names></name>., <name><surname>Akturk</surname><given-names>G</given-names></name>., <name><surname>Angelo</surname><given-names>M</given-names></name>. <etal>et al</etal>. <collab>on behalf of the Society for Immunotherapy of Cancer (SITC) Pathology Task Force</collab>. <article-title>The Society for Immunotherapy of Cancer statement on best practices for multiplex immunohistochemistry (IHC) and immunofluorescence (IF) staining and validation</article-title>. <source>Journal for ImmunoTherapy of Cancer</source><year>2020</year>;<volume>8</volume>:<fpage>e000155</fpage>. <pub-id pub-id-type="doi">10.1136/jitc-2019-000155</pub-id><?supplied-pmid 32414858?><pub-id pub-id-type="pmid">32414858</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Tan</surname><given-names>W.</given-names></name>, <name><surname>Nerurkar</surname><given-names>S. N.</given-names></name>, <name><surname>Cai</surname><given-names>H. Y.</given-names></name>, <name><surname>Ng</surname><given-names>H.</given-names></name>, <name><surname>Wu</surname><given-names>D.</given-names></name>, <name><surname>Wee</surname><given-names>Y.</given-names></name>, <name><surname>Lim</surname><given-names>J.</given-names></name>, <name><surname>Yeong</surname><given-names>J.</given-names></name>, &amp; <name><surname>Lim</surname><given-names>T.</given-names></name>
<article-title>Overview of multiplex immunohistochemistry/ immunofluorescence techniques in the era of cancer immunotherapy</article-title>. <source>Cancer communications (London, England)</source>
<year>2020</year>; <volume>40</volume>(<issue>4</issue>), <fpage>135</fpage>–<lpage>153</lpage>. <pub-id pub-id-type="doi">10.1002/cac2.12023</pub-id>
<?supplied-pmid 32301585?><pub-id pub-id-type="pmid">32301585</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Angelo</surname><given-names>M.</given-names></name>, <name><surname>Bendall</surname><given-names>S.C.</given-names></name>, <name><surname>Finck</surname><given-names>R.</given-names></name>, <name><surname>Hale</surname><given-names>M.B.</given-names></name>, <name><surname>Hitzman</surname><given-names>C.</given-names></name>, <name><surname>Borowsky</surname><given-names>A.D.</given-names></name>, <etal>et al</etal>. <article-title>Multiplexed ion beam imaging of human breast tumors</article-title>. <source>Nat. Med</source>. <year>2014</year>; <volume>20</volume>, <fpage>436</fpage>–<lpage>442</lpage>. <pub-id pub-id-type="doi">10.1038/nm.3488</pub-id><?supplied-pmid 24584119?><pub-id pub-id-type="pmid">24584119</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Keren</surname><given-names>L.</given-names></name>, <name><surname>Bosse</surname><given-names>M.</given-names></name>, <name><surname>Marquez</surname><given-names>D.</given-names></name>, <name><surname>Angoshtari</surname><given-names>R.</given-names></name>, <name><surname>Jain</surname><given-names>S.</given-names></name>, <name><surname>Varma</surname><given-names>S.</given-names></name>, <etal>et al</etal>. <article-title>A Structured Tumor-Immune Microenvironment in Triple Negative Breast Cancer Revealed by Multiplexed Ion Beam Imaging</article-title>. <source>Cell</source><year>2018</year>; <volume>174</volume>. <pub-id pub-id-type="doi">10.1016/j.cell.2018.08.039</pub-id><?supplied-pmid 30193111?><pub-id pub-id-type="pmid">30193111</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Keren</surname><given-names>L.</given-names></name>, <name><surname>Bosse</surname><given-names>M.</given-names></name>, <name><surname>Thompson</surname><given-names>S.</given-names></name>, <name><surname>Risom</surname><given-names>T.</given-names></name>, <name><surname>Vijayaragavan</surname><given-names>K.</given-names></name>, <name><surname>McCaffrey</surname><given-names>E.</given-names></name>, <etal>et al</etal>. <article-title>MIBI-TOF: A multiplexed imaging platform relates cellular phenotypes and tissue structure</article-title>. <source>Sci. Adv</source>. <year>2019</year>; <volume>5</volume>, <fpage>eaax5851</fpage>. <pub-id pub-id-type="doi">10.1126/sciadv.aax5851</pub-id><?supplied-pmid 31633026?><pub-id pub-id-type="pmid">31633026</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Mastin</surname><given-names>G.A.</given-names></name><article-title>Adaptive filters for digital image noise smoothing: An evaluation</article-title>. <source>Comput. Vision, Graph. Image Process</source>. <year>1985</year>; <volume>31</volume>, <fpage>103</fpage>–<lpage>121</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008887.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Jackson</surname><given-names>H.W.</given-names></name>, <name><surname>Fischer</surname><given-names>J.R.</given-names></name>, <name><surname>Zanotelli</surname><given-names>V.R.T.</given-names></name>, <name><surname>Ali</surname><given-names>H.R.</given-names></name>, <name><surname>Mechera</surname><given-names>R.</given-names></name>, <name><surname>Soysal</surname><given-names>S.D.</given-names></name>, <etal>et al</etal>. <article-title>The single-cell pathology landscape of breast cancer</article-title>. <source>Nature</source><year>2020</year>; <fpage>1</fpage>–<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-019-1876-x</pub-id><?supplied-pmid 31959985?><pub-id pub-id-type="pmid">31959985</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1008887.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008887.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008887" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">21 Dec 2020</named-content>
    </p>
    <p>Dear Dr. Keren,</p>
    <p>Thank you very much for submitting your manuscript "MAUI (MBI Analysis User Interface) - An image processing pipeline for Multiplexed Mass Based Imaging" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. </p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Dina Schneidman</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Baranski and co-workers here present an interactive graphical user interface adaptation of the image processing methods originally described in Keren et al, 2018 Cell. Specifically, the software, Mass Based Imaging Analysis User Interface (MAUI), streamlines image processing from Multiplexed Ion Beam Imaging (MIBI) developed by the Angelo lab.</p>
    <p>In addition to the MAUI software, the important work presented here also details and shows convincing examples of the results of each step performed in preliminary MIBI image processing. The authors indicate that the work can potentially extrapolate to other forms of mass spectrometry imaging, and is certainly appropriate for the scope of the journal, given the momentum in adopting various multiplexed imaging platforms in the scientific community (including the methods related to SIMS and the IMC) and the lack of alternative software that enables image cleanup without the use of scripting languages.</p>
    <p>I have a number of minor suggestions and comments that I hope the authors can address, in addition to showcasing broad utility of MAUI.</p>
    <p>1. In Results 2.2, the authors state tantalum as 182Ta. It would appear that 181Ta is the stable isotope of tantalum.</p>
    <p>2. Will the authors be able to clarify how channel 89Y would cause contaminating signals in channel 115In? It does not appear to fall into the typical +1, +16 and +17 contaminants.</p>
    <p>3. It is unclear whether MAUI would allow multiple rounds of sequential contamination removal (eg removing a -1 and then a -16 on the same channel). If so, would the authors be able to elaborate further in the text?</p>
    <p>4. In Results 2.3, the authors state that the KNN approach here “has been shown to have superior performance to other filters”. It would be more convincing to have some representative images for other methods of denoising, including DBSCAN, another commonly used density-based clustering method.</p>
    <p>5. It is unclear how aggregation removal would be judged by a user. IE how would one decide whether large “clumps” of signal is true signal vs aggregation? It would also be useful to elaborate how the signal density of aggregates will be taken into consideration for the clean up.</p>
    <p>Additionally (and optionally), it would certainly strengthen the manuscript to see examples of how MAUI processing of publicly available IMC images or other mass-spec imaging data (such as ToF-SIMS, nano-SIMS or OrbiSIMS).</p>
    <p>Thank you for your work in putting together a very nice piece of software for the community.</p>
    <p>Reviewer #2: The authors developed an MBI Analysis User Interface (MAUI) that facilitates the processing of image data, including the removal of channel crosstalk, noise, and antibody aggregates, and provides a software resource for efficient user data processing of data acquired by Multiplexed Ion Beam Imaging by time of flight (MIBI-TOF).</p>
    <p>Recent developments and advancements in MIBI-TOF and Imaging Mass Cytometry (IMC) have provided innovative multiplex molecular imaging methods in the life sciences and have attracted the interest of many scientists in this field. There is no doubt that authors' contributions are important, especially for advanced lifescience researchers who are trying to adopt them.</p>
    <p>However, after careful perusal of this manuscript, I believe that several issues need to be clarified. My main comments are as follows.</p>
    <p>1) There is no doubt that high-dimensional imaging techniques using mass spectrometry are becoming increasingly important for histopathology, with several different instruments and methods available, including MIBI and IMC. However, since there are many non-specialist readers (especially researchers in the life sciences) who are interested in this field, I would like to see more detailed description of the instruments and methods that are currently available for users to choose from. Moreover, the instruments and methods that can be covered by MAUI should be clearly described.</p>
    <p>2) The reviewer is interested in whether a comparison with fluorescence microscopy images using fluorescent secondary antibodies would be useful in validating images acquired with MIBI-TOF and processed with MAUI.</p>
    <p>In particular, it was felt that comparison with fluorescence images could clearly show whether the inherent problems in mass spectrometry caused by channel crosstalk are solved by this software. On the other hand, the problems of non-specific signals and antibody aggregation are considered to be common problems in fluorescent immunostaining methods, and it should be discussed whether it is reasonable to solve these problems with this software in MIBI-TOF images.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: <bold>Yes: </bold>Sizun Jiang</p>
    <p>Reviewer #2: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/" xlink:type="simple">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email xlink:type="simple">figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link ext-link-type="uri" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <underline><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" xlink:type="simple">http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
  </body>
</sub-article>
<sub-article id="pcbi.1008887.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008887.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008887" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">3 Feb 2021</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1008887.s004">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">MAUI_pbp.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008887.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008887.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008887.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008887" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">17 Mar 2021</named-content>
    </p>
    <p>Dear Dr. Keren,</p>
    <p>We are pleased to inform you that your manuscript 'MAUI (MBI Analysis User Interface) - An image processing pipeline for Multiplexed Mass Based Imaging' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Dina Schneidman</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Dear Authors,</p>
    <p>Thank you for the very nicely written revision comments and edits. These revisions full address my concerns and I recommend publication without reservations.</p>
    <p>I have a minor comment on a typo in Figure S2 (Vimenting -&gt; Vimentin) which may not be addressed in subsequent copy editing as it shows up as an image and not text.</p>
    <p>Congratulations on a very robust study!</p>
    <p>Reviewer #2: My comments have been addressed and the MS is improved. I have no additional comments.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: None</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: <bold>Yes: </bold>Sizun Jiang</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article id="pcbi.1008887.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008887.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schneidman-Duhovny</surname>
          <given-names>Dina</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Dina Schneidman-Duhovny</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Dina Schneidman-Duhovny</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008887" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">13 Apr 2021</named-content>
    </p>
    <p>PCOMPBIOL-D-20-01128R1 </p>
    <p>MAUI (MBI Analysis User Interface) - An image processing pipeline for Multiplexed Mass Based Imaging</p>
    <p>Dear Dr Keren,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Andrea Szabo</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
