<?properties open_access?>
<?properties manuscript?>
<?ManuscriptPrefix new?>
<?iso-abbr Nat. Methods?>
<?submitter-system ukmss?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 1005?>
<?submitter-authority publisher?>
<?submitter-login NPG?>
<?submitter-name Nature Publishing Group?>
<?domain wtpa?>
<?origin ukpmcpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5937676</article-id>
    <article-id pub-id-type="pmid">28991892</article-id>
    <article-id pub-id-type="doi">10.1038/nmeth.4463</article-id>
    <article-id pub-id-type="manuscript">ems74166</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SCENIC: Single-cell regulatory network inference and clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Aibar</surname>
          <given-names>Sara</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>González-Blas</surname>
          <given-names>Carmen Bravo</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moerman</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref ref-type="aff" rid="A4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huynh-Thu</surname>
          <given-names>Vân Anh</given-names>
        </name>
        <xref ref-type="aff" rid="A6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Imrichova</surname>
          <given-names>Hana</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hulselmans</surname>
          <given-names>Gert</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rambow</surname>
          <given-names>Florian</given-names>
        </name>
        <xref ref-type="aff" rid="A7">7</xref>
        <xref ref-type="aff" rid="A8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marine</surname>
          <given-names>Jean-Christophe</given-names>
        </name>
        <xref ref-type="aff" rid="A7">7</xref>
        <xref ref-type="aff" rid="A8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Geurts</surname>
          <given-names>Pierre</given-names>
        </name>
        <xref ref-type="aff" rid="A6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aerts</surname>
          <given-names>Jan</given-names>
        </name>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref ref-type="aff" rid="A4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van den Oord</surname>
          <given-names>Joost</given-names>
        </name>
        <xref ref-type="aff" rid="A5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Atak</surname>
          <given-names>Zeynep Kalender</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wouters</surname>
          <given-names>Jasper</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="aff" rid="A5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aerts</surname>
          <given-names>Stein</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="corresp" rid="CR1">#</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>VIB Center for Brain &amp; Disease Research, Laboratory of Computational Biology, Leuven, Belgium</aff>
    <aff id="A2"><label>2</label>KU Leuven, Department of Human Genetics, Leuven, Belgium</aff>
    <aff id="A3"><label>3</label>KU Leuven ESAT/STADIUS, VDA-lab. Leuven, Belgium</aff>
    <aff id="A4"><label>4</label>IMEC Smart Applications and Innovation Services. Leuven, Belgium</aff>
    <aff id="A5"><label>5</label>KU Leuven, Department of Imaging and Pathology, Translational Cell and Tissue Research, Leuven, Belgium</aff>
    <aff id="A6"><label>6</label>University of Liège, Department of Electrical Engineering and Computer Science, Liège, Belgium</aff>
    <aff id="A7"><label>7</label>VIB Center for Cancer Biology, Laboratory for Molecular Cancer Biology, Leuven, Belgium</aff>
    <aff id="A8"><label>8</label>KU Leuven, Department of Oncology, Leuven, Belgium</aff>
    <author-notes>
      <corresp id="CR1"><label>#</label>Correspondence to: <email>stein.aerts@kuleuven.vib.be</email></corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>23</day>
      <month>4</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>09</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <volume>14</volume>
    <issue>11</issue>
    <fpage>1083</fpage>
    <lpage>1086</lpage>
    <!--elocation-id from pubmed: 10.1038/nmeth.4463-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<ext-link ext-link-type="uri" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">Although single-cell RNA-seq is revolutionizing biology, data interpretation remains a challenge. We present SCENIC for the simultaneous reconstruction of gene regulatory networks and identification of cell states. We apply SCENIC to a compendium of single-cell data from tumors and brain, and demonstrate that the genomic regulatory code can be exploited to guide the identification of transcription factors and cell states. SCENIC provides critical biological insights into the mechanisms driving cellular heterogeneity.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p id="P2">The transcriptional state of a cell emerges from an underlying gene regulatory network (GRN) in which a limited number of transcription factors and co-factors regulate each other and their downstream target genes. Recent advances in single-cell transcriptome profiling have provided exciting opportunities for a high-resolution identification of transcriptional states, and to identify trajectories of transitions between states, for example during differentiation <xref rid="R1" ref-type="bibr">1</xref>,<xref rid="R2" ref-type="bibr">2</xref>. Statistical techniques and bioinformatics methods have been optimized for single-cell RNA-seq, including methods for expression normalization, differential expression analysis, clustering, dimensionality reduction, rare cell type identification, and trajectory inference <xref rid="R3" ref-type="bibr">3</xref>. Although these methods have led to significant new biological insights, it is still unclear whether specific and robust GRNs underlying stable cell states can be established. This may indeed be challenging given that at the single cell level, gene expression may be partially disconnected from the dynamics of transcription factor inputs due to stochastic variation of gene expression consecutive to, for example, transcriptional bursting <xref rid="R4" ref-type="bibr">4</xref>. A few methods have been developed that infer co-expression networks from single-cell RNA-seq data <xref rid="R5" ref-type="bibr">5</xref>–<xref rid="R7" ref-type="bibr">7</xref>, but they do not make use of regulatory sequence analysis to predict interactions between transcription factors and target genes.</p>
  <p id="P3">We reasoned that linking the genomic regulatory code to single-cell gene expression variation could overcome drop-outs and technical variation, and could optimize the discovery and characterization of cellular states. To this end, we developed a new method, called SCENIC (Single-Cell rEgulatory Network Inference and Clustering), to map GRNs, and then identify stable cellular states by evaluating the activity of the GRNs in each cell. The SCENIC workflow consists of three steps (<xref ref-type="fig" rid="F1">Fig. 1a</xref>, <xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 1</xref> and <xref ref-type="sec" rid="S2">Online Methods</xref>). In the first step, sets of genes that are co-expressed with transcription factors are identified using <italic>GENIE3</italic>
<xref rid="R8" ref-type="bibr">8</xref> (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 1a</xref>). Being based only on co-expression, these modules may include many false positives and indirect targets. To identify putative direct-binding targets, each co-expression module is analyzed using <italic>cis</italic>-regulatory motif analyses using <italic>RcisTarget</italic> (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 1b</xref> and <xref ref-type="sec" rid="S2">Online Methods</xref>). Only modules with significant motif enrichment of the correct upstream regulator are retained, and pruned to remove indirect target genes without motif support. Next, we score the activity of each of these <italic>regulons</italic> in each cell with <italic>AUCell</italic> (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 1c, Supplementary Fig. 2</xref>, and <xref ref-type="sec" rid="S2">Online Methods</xref>). The relative scores of each regulon across the cells allow identifying which cells have a significantly high sub-network activity. The resulting binary activity matrix can be used as a biological dimensionality reduction for downstream analyses. For example, performing a clustering on this matrix allows identifying cell types and states based on the shared activity of a regulatory subnetwork. In addition, since the regulon is scored as a whole, instead of only the TF or individual genes, this approach is robust against drop-outs (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 3</xref>).</p>
  <p id="P4">To evaluate the performance of SCENIC, we applied it to a scRNA-seq data set with well-known cell types from the adult mouse brain <xref rid="R9" ref-type="bibr">9</xref> (<xref ref-type="fig" rid="F1">Fig. 1b-e</xref>). This analysis provided 151 regulons –out of 1046 initial co-expression modules– that presented significant enrichment of the motif of the corresponding transcription factor (7% of the initial TFs). Using the activity of these regulons to score each single cell revealed the expected cell types (<xref ref-type="fig" rid="F1">Fig. 1d,e</xref>), alongside a list of potential master regulators per cell type (e.g., the microglia network in <xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 4</xref>). The clustering accuracy (cell-type overall sensitivity of 0.88, specificity of 0.99, and ARI &gt; 0.80) is better than many dedicated single-cell clustering methods <xref rid="R10" ref-type="bibr">10</xref>. To assess the robustness of SCENIC, we re-analyzed the mouse brain data, also including runs with only 100 randomly selected cells (to simulate small data sets), or 1/3 of the sequencing reads (to simulate low-coverage data sets). Interestingly, SCENIC identified cell types that are represented by only few cells (e.g. 2-6 cells from microglia, astrocytes or interneurons, <xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 5</xref>). In addition, the transcription factors predicted per cell type are consistent with previously established roles (<xref ref-type="fig" rid="F1">Fig. 1c</xref>), and this accuracy outperforms standard analysis pipelines (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 3e</xref>). To validate the Dlx1/2 network identified for mouse interneurons, we analyzed a single-nuclei RNA-seq data set of the human brain <xref rid="R11" ref-type="bibr">11</xref> (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 6</xref>). On the human data, SCENIC also identifies a cluster of interneurons strongly driven by DLX1/2, having the same recognition motif as in mouse, and a set of conserved targets including DLX1 itself (<xref ref-type="fig" rid="F2">Fig. 2a-b</xref>). Next, we expanded this cross-species analysis to other cell types. Interestingly, in contrast to standard clustering based on normalized expression, which yields a strong species-driven clustering (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 7</xref>), the SCENIC analysis effectively grouped cells by their cell type (<xref ref-type="fig" rid="F2">Fig. 2c</xref>). This suggests that the scoring of network activity is robust and can be exploited to overcome batch or technical effects (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 3d</xref>).</p>
  <p id="P5">To evaluate SCENIC for the analysis of complex cancer cell states, we applied it to cancer cells from two scRNA-seq data sets, the first from oligodendroglioma <xref rid="R12" ref-type="bibr">12</xref> (4043 cells from six tumors), and the second from melanoma <xref rid="R13" ref-type="bibr">13</xref> (1252 cells from fourteen lesions). Due to tumor-specific mutations and complex genomic aberrations, the identification of cancer cell states is more challenging than characterizing normal cell types <xref rid="R14" ref-type="bibr">14</xref>. Standard clustering of these data sets results in cells grouped by their tumor of origin (<xref ref-type="fig" rid="F3">Fig. 3a,b</xref>). However, SCENIC reveals a different picture. On oligodendroglioma, three cancer cell states are identified across tumors (<xref ref-type="fig" rid="F3">Fig. 3c-e</xref>), each state driven by expected/relevant TFs, including SOX10/4/8, OLIG1/2, and ASCL1 for the oligodendrocyte-like state; SOX9, NFIB, AP-1 for the astrocyte-like state; and E2F, FOXM1 for the cycling cells. Interestingly, when we used diffusion maps on the binary SCENIC matrix (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 8</xref>), the differentiation trajectory was reconstructed: from stem-like, undifferentiated, to the oligodendrocyte-like and astrocyte-like branches. Note that this path represents a different “trajectory” compared to normal oligodendrocyte differentiation (see <xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 9</xref> for the SCENIC analysis of 5069 oligodendrocytes). We observed a similar tumor-effect correction on the melanoma data, where SCENIC identifies groups of cells across tumors (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 10</xref>), including a cluster of cycling cells, driven by similar transcription factors as in oligodendroglioma (e.g., E2F1/2/8 and MYBL2, <xref ref-type="fig" rid="F3">Fig. 3f-h</xref> and <xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 10</xref>). In contrast to dedicated batch-effect removal methods such as Combat <xref rid="R15" ref-type="bibr">15</xref> and Limma <xref rid="R16" ref-type="bibr">16</xref>, which require specifying the source of batch-effect a priori (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 11</xref>), SCENIC removes the tumor-effect automatically, using biologically-driven features.</p>
  <p id="P6">Interestingly, the melanoma cells fall largely into two groups, one corresponding to a MITFhigh state –the archetypical proliferative state– with MITF and STAT/IRF as key regulators, and an MITFlow state with up-regulated WNT5A, LOXL2 and ZEB1 expression, known markers of invasive states (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 10e-f</xref>). SCENIC identifies two new transcription factors in this MITFlow state, namely NFATC2 (114 predicted target genes) and NFIB (15 predicted target genes). NFATC2, a transcriptional repressor operating in the JNK/MAPK pathway, is involved in melanoma dedifferentiation to a stem cell fate, and in immune escape <xref rid="R17" ref-type="bibr">17</xref>. NFIB on the other hand is linked to stem cell behavior of hair follicle and melanocyte stem cells <xref rid="R18" ref-type="bibr">18</xref>, and plays an important role in metastatic progression of small cell lung cancer <xref rid="R19" ref-type="bibr">19</xref>. To further explore the potential role of NFATC2 and NFIB this state, we performed immunohistochemistry on 25 melanoma specimens with varying tumor progression. Surprisingly, we found the highest NFIB and NFATC2 expression in the sentinel lymph nodes, co-localizing with ZEB1 expression, suggesting a relationship with the earliest metastatic events (<xref ref-type="fig" rid="F3">Fig. 3i</xref> and <xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 12</xref>). When we knocked-down NFATC2 using siRNA in A375, a melanoma cell line that shows high NFATC2 and NFIB expression (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 13</xref>), we found that the predicted NFATC2 target genes are significantly upregulated (see <xref ref-type="sec" rid="S2">Online Methods</xref> for details). This is consistent with previously established role as a repressor <xref rid="R20" ref-type="bibr">20</xref>. In addition, genes involved in regulation of cell adhesion and extracellular matrix and several previously-published gene signatures representing the melanoma invasive state are also up-regulated (<xref ref-type="supplementary-material" rid="SD4">Supplementary Table 1</xref>), suggesting that NFATC2 may indeed play important role in the progression of the disease. As a second validation of the melanoma regulons we tested the predicted targets of MITF and STAT using ChIP-seq data (<xref ref-type="fig" rid="F3">Fig. 3j</xref>).</p>
  <p id="P7">As datasets with increasingly large numbers of single cells are becoming available, we suggest two complementary approaches to scale the network inference. The first approach is to infer the GRN from a sub-sampled data set, and to include all cells in the scoring step with AUCell. We illustrate this approach on a dataset with more than 40000 single-cells from the mouse retina (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 14</xref>). The second approach strives for using more efficient machine learning and big data handling solutions. Particularly, we implemented <italic>GRNboost</italic>, a new variant of GENIE3, in Scala on Apache Spark, replacing the Random Forest regression with gradient boosting. This new implementation drastically reduces the time needed to infer a GRN (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 15</xref>) and will pave the way to network inference on very large data sets, such as the soon available Human Cell Atlas <xref rid="R21" ref-type="bibr">21</xref>.</p>
  <p id="P8">In conclusion, SCENIC is a generally applicable method for the analysis of single-cell RNA-seq data that exploits transcription factors and <italic>cis</italic>-regulatory sequences to guide the discovery of cellular states. Our results show that gene regulatory networks constitute robust guides to identify cellular states, and that single-cell RNA-seq data are well-suited to trace gene regulatory programs in which specific combinations of transcription factors drive cell type-specific transcriptomes.</p>
  <sec sec-type="methods" id="S2" specific-use="web-only">
    <title>Online Methods</title>
    <sec id="S3">
      <title>SCENIC workflow</title>
      <p id="P10">SCENIC is a workflow based on three new R/bioconductor packages: (1) <bold>GENIE3</bold>, to identify potential TF targets based on co-expression, (2) <bold>RcisTarget</bold>, to perform the TF-motif enrichment analysis and identify the direct targets (regulons), and (3) <bold>AUCell</bold>, to score the activity of regulons (or other gene sets) on single cells. We also provide <bold>GRNboost</bold>, implemented on Spark <xref rid="R22" ref-type="bibr">22</xref>, as scalable alternative to build the co-expression network on bigger datasets (step 1, replacing GENIE3).</p>
      <p id="P11">The three R/bioconductor packages, and GRNboost, include detailed tutorials to facilitate their use within an automated SCENIC pipeline, as well as independent tools. Links to the tools, SCENIC code and tutorials are available at <ext-link ext-link-type="uri" xlink:href="http://scenic.aertslab.org">http://scenic.aertslab.org</ext-link>.</p>
    </sec>
    <sec id="S4">
      <title>GENIE3</title>
      <p id="P12">GENIE3 <xref rid="R8" ref-type="bibr">8</xref> is a method for inferring gene regulatory networks from gene expression data. In brief, it trains random forest models predicting the expression of each gene in the dataset, using as input the expression of the transcription factors. The different models are then used to derive weights for the transcription factors, measuring their respective relevance for the prediction of the expression of each target gene. The highest weights can be translated into TF-target regulatory links <xref rid="R8" ref-type="bibr">8</xref>. Since GENIE3 uses Random Forest regression, it has the added value of allowing complex (e.g., non-linear) co-expression relationships between a TF and its candidate targets. GENIE3 is available in Python, Matlab and R. To allow for inclusion in SCENIC workflow, we optimized the previous R implementation of GENIE3. The core of this new implementation is now written in C –which makes it orders of magnitude faster–, it requires lower memory, and supports execution in parallel. GENIE3 was the top-performing method for network inference in the DREAM4 and DREAM5 challenges <xref rid="R23" ref-type="bibr">23</xref>. The new package provides similar results in the DREAM challenge to previously existing implementations, but with improved speed. The comparison is available at the following website: <ext-link ext-link-type="uri" xlink:href="http://www.montefiore.ulg.ac.be/~huynh-thu/GENIE3.html">http://www.montefiore.ulg.ac.be/~huynh-thu/GENIE3.html</ext-link>.</p>
      <p id="P13">The input to GENIE3 is an expression matrix. The preferred expression values are gene-summarized counts (which might or might not use unique molecular identifiers, UMI <xref rid="R24" ref-type="bibr">24</xref>). Other measurements, such as counts or transcripts per million (TPM) and FPKM/RPKM are also accepted as input. However, note that the first network-inference step is based on co-expression, and some authors recommend avoiding within sample normalizations (i.e. TPM) for this task because they may induce artificial co-variation <xref rid="R25" ref-type="bibr">25</xref>. To evaluate to what extent the normalization of the input matrix affects the output of SCENIC, we also ran SCENIC on Zeisel’s dataset after library-size normalization (using the standard pipeline from scran <xref rid="R26" ref-type="bibr">26</xref>, which performs within-cluster size-factor normalization). The results are highly comparable, both in regards to resulting clusters/cell types (ARI between the cell types obtained from raw UMI counts or normalized counts: 0.90, ARI from normalized counts compared to the author’s cell types: 0.87), and the TFs identifying the groups (26 out of the 30 regulons highlighted in <xref ref-type="fig" rid="F1">Fig. 1b</xref>). Furthermore, during the course of this project we have applied GENIE3 to multiple datasets using UMI counts (e.g. mouse brain and oligodendrocytes), and TPM (e.g. human brain and melanoma) and both units provided reliable results.</p>
      <p id="P14">The output of GENIE3 is a table with the genes, the potential regulators, and their “importance measure” (IM), which represents the weight that the transcription factor (input gene) has in the prediction of the target. We explored several ways to determine the threshold (e.g. looking at the rankings, distributions and outputs after pruning with RcisTarget), and finally opted for building multiple gene-sets of potential targets for each transcription factor: (a) setting several IM thresholds (IM &gt; 0.001 and IM&gt;0.005), (b) taking the 50 targets with highest IM for each TF, and (c) keeping only the top 5, 10 and 50 TFs for each target gene (then, split by TF). In all these cases, only the links with IM&gt;0.001 were taken into account. Furthermore, each gene-set was then split into positive- and negative- correlated targets (i.e. Spearman correlation between the TF and the potential target) to separate likely activated and repressed targets. Finally, only the gene-sets (TF co-expression modules) with at least 20 genes were kept for the following step.</p>
    </sec>
    <sec id="S5">
      <title>GRNboost</title>
      <p id="P15">GRNboost is based on the same concept as GENIE3: inferring regulators for each target gene purely from the gene expression matrix. However, it does so using the gradient boosting machines (GBM) <xref rid="R27" ref-type="bibr">27</xref> implementation from the XGBoost library <xref rid="R28" ref-type="bibr">28</xref>. A GBM is an ensemble learning algorithm that uses boosting <xref rid="R29" ref-type="bibr">29</xref> as a strategy to combine multiple weak learners, like shallow trees, into a strong one. This contrasts with random forest, the method used by GENIE3, which uses bagging (bootstrap aggregation) for model averaging to improve regression accuracy. GRNBoost uses gradient boosted stumps (regression trees of depth 1) <xref rid="R30" ref-type="bibr">30</xref> as the base learner. GRNBoost’s main contribution is casting this multiple regression approach into a Map/Reduce <xref rid="R31" ref-type="bibr">31</xref> framework based on Apache Spark <xref rid="R22" ref-type="bibr">22</xref>. In GRNBoost, the core data entry is a tuple of a gene and a vector of TF expression values. Using a Spark RDD, GRNBoost first partitions the gene expression vectors over the nodes available in the compute cluster. Subsequently, it constructs a predictor matrix that contains the expression values for all candidate regulator genes. Using a Spark broadcast variable, the predictor matrix is broadcasted to the different compute partitions. In the map phase of the framework, GRNBoost iterates over the gene tuples (expression vector) and uses the predictor matrix to train the XGBoost regression models with the expression vectors as respective training labels. From the trained models, the strengths of the regulator-target relationships are extracted and emitted as a set of network edges. In the reduce phase, all sets of edges are combined into the final regulatory network.</p>
      <p id="P16">The performance of GRNBoost and GENIE3 was compared on a workstation with 2 Intel Xeon E2696 V4 CPUs with in total 44 physical cores or 88 threads and 128 GB of 2133Ghz ECC memory. Large datasets and hence large predictor matrices cause the network inference to become memory-bound rather than CPU-bound. In order to comfortably fit the amount of memory required into the available 128 GB of memory, we decreased the number of partitions to 11, therefore having only a maximum of 11 predictor matrices in flight simultaneously. However, we increased the number of threads available to each individual XGBoost regression to 8, effectively using all available (88) threads in the workstation. GRNBoost is written in the Scala programming language and can be used as a software library or be submitted as a Spark job from the command line.</p>
    </sec>
    <sec id="S6">
      <title>RcisTarget</title>
      <p id="P17">RcisTarget is a new R/Bioconductor implementation of the motif enrichment framework of i-cisTarget and iRegulon. RcisTarget identifies enriched transcription factor binding motifs and candidate transcription factors for a gene list. In brief, RcisTarget is based on two steps. First, it selects DNA motifs that are significantly over-represented in the surroundings of the transcription start site (TSS) of the genes in the gene-set. This is achieved by applying a recovery-based method on a database that contains genome-wide cross-species rankings for each motif. The motifs that are annotated to the corresponding TF and obtain a Normalized Enrichment Score (NES) &gt; 3.0 are retained. Next, for each motif and gene-set, RcisTarget predicts candidate target genes (i.e. genes in the gene-set that are ranked above the leading edge). This method is based on the approach described by Aerts et al. <xref rid="R32" ref-type="bibr">32</xref> which is also implemented in i-cisTarget (web interface) <xref rid="R33" ref-type="bibr">33</xref> and iRegulon (Cytoscape plug-in) <xref rid="R34" ref-type="bibr">34</xref>. Therefore, when using the same parameters and databases, RcisTarget provides the same results as i-cisTarget or iRegulon, benchmarked against other TFBS-enrichment tools in Janky et al. <xref rid="R34" ref-type="bibr">34</xref>. More details about the method and its implementation in R are given in the package documentation.</p>
      <p id="P18">To build the final regulons, we merge the predicted target genes of each TF-module that show enrichment of any motif of the given TF. To detect repression, it is theoretically possible to follow the same approach with the negative-correlated TF modules. However, in the datasets we analyzed, these modules were less numerous and showed very low motif enrichment, suggesting that these are lower quality modules. For this reason, we finally decided to exclude the detection of direct repression from the workflow, and continue only with the positive-correlated targets. The databases used for the analyses presented in this paper are the "18k motif collection" from iRegulon (gene-based motif rankings) for human and mouse. For each species, we used two gene-motif rankings (10kb around the TSS or 500bp upstream the TSS), which determine the search space around the transcription start site.</p>
    </sec>
    <sec id="S7">
      <title>AUCell</title>
      <p id="P19">AUCell is a new method that allows identifying cells with active gene regulatory networks in single-cell RNA-seq data. The input to AUCell is a gene set, and the output the gene set “activity” (AUC) in each cell. In SCENIC, these gene sets are the regulons, consisting of the TF and their putative targets. <italic>AUCell</italic> calculates the enrichment of the regulon as an area under the recovery curve (AUC) across the ranking of all genes in a particular cell, whereby genes are ranked by their expression value. This method is therefore independent of the gene expression units and the normalization procedure. In addition, since the cells are evaluated individually, it can easily be applied to bigger datasets (e.g. subsetting the expression matrix if needed). In brief, the scoring method is based on a recovery analysis, where the x-axis (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 1c</xref>) is the ranking of all genes based on expression level (genes with the same expression value, e.g. '0', are randomly sorted); and the y-axis is the number of genes recovered from the input set. AUCell then uses the "Area Under the Curve" (AUC) to calculate whether a critical subset of the input gene set is enriched at the top of the ranking for each cell. In this way, the AUC represents the proportion of expressed genes in the signature and their relative expression value compared to the other genes within the cell. The output of this step is a matrix with the AUC score for each gene-set in each cell. We use either the AUC scores (across regulons) directly as continuous values to cluster single-cells, or we generate a binary matrix using a cutoff of the AUC score for each regulon. These cutoffs are determined either automatically, or manually adjusted by inspecting the distribution of the AUC scores. Some examples of AUC distributions are provided in <xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 2a</xref>. <xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 2b-c</xref> shows the validation of <bold>AUCell</bold> using previously published neuronal and glial gene signatures. The tutorial included in the package, also includes practical explanations and implications of each of the steps of the method.</p>
    </sec>
    <sec id="S8">
      <title>Cell clustering based on GRNs</title>
      <p id="P20">The cell-regulon activity is summarized in a matrix in which the columns represent the cells and the rows the regulons. In the <italic>binary</italic> regulon activity matrix, the coordinates of the matrix that correspond to active regulons in a given cell will contain a “1”, and “0” otherwise. The equivalent matrix, containing the continuous AUC values for each cell-regulon, is normally referred to as the AUC activity matrix. Clustering of either of the regulon activity matrices reveals groups of regulons (jointly a network) that are recurrently active across a subset of cells. The binary activity matrix tends to highlight higher-order similarities across cells (and therefore, highly reduces batch effects and technical biases), on the other hand, the AUC matrix allows to observe more subtle changes. For visualization, we have mostly used t-SNEs (Rtsne package<xref rid="R35" ref-type="bibr">35</xref>, always tested consistency across several perplexity values and distance metrics/number of PCs), and heatmaps with hierarchical clustering (although the heatmap figures feature selected regulons, the t-SNEs are always run on the whole matrices). In the tutorials, we have also included several options to explore the results. For example, to detect most likely stable states (higher-density areas in the t-SNE), and to help identify key regulators, known cell properties (based on the dataset annotation) and GO terms (GO enrichment analysis of the genes in the cluster of regulons) that might be associated to the detected states.</p>
    </sec>
    <sec id="S9">
      <title>SCENIC runs on the different datasets</title>
      <p id="P21">SCENIC was run on all the datasets using the expression matrices provided by the authors (downloaded from GEO or the authors website), including only the cells that passed their quality control, and the default gene filtering for GENIE3 (which resulted in 12-15k genes). The standard SCENIC workflow was run on all datasets (the version at the time of publication is available as supplementary file, updated versions can be found at <ext-link ext-link-type="uri" xlink:href="http://scenic.aertslab.org">http://scenic.aertslab.org</ext-link>). A more detailed description of the datasets and the any peculiarities for each analysis are available in <xref ref-type="supplementary-material" rid="SD3">Supplementary Note 1</xref>. Here we provide a brief description of the datasets:</p>
      <p id="P22"><bold>Mouse cortex and hippocampus</bold> (Zeisel et al.<xref rid="R9" ref-type="bibr">9</xref>, GSE60361): single-cell RNA-seq of 3005 brain cells of juvenile mice (21-31 days old). It contains the main cell types in hippocampus and somatosensory cortex, namely neurons (pyramidal excitatory neurons, and interneurons), glia (astrocytes, oligodendrocytes, microglia), and endothelial cells. Expression matrix units: UMI counts.</p>
      <p id="P23"><bold>Human neurons</bold> (Lake et al. <xref rid="R11" ref-type="bibr">11</xref>): single-nuclei RNA-seq of 3083 neuronal cells from a normal human brain (retrieved postmortem from a 51-year old female, from six different Brodmann areas). Expression matrix units: TPM.</p>
      <p id="P24"><bold>Human brain</bold> (Darmanis et al.<xref rid="R36" ref-type="bibr">36</xref>, GSE67835): scRNA-seq from 466 cells from adult and fetal human brains. The fetal samples were taken from four different individuals at 16 to 18 weeks post-gestation. The adult brain samples were taken from healthy temporal lobe tissue from 8 different patients (21 - 63 years old) during temporal lobectomy surgery for refractory epilepsy and hippocampal sclerosis. Expression matrix units: logged CPM.</p>
      <p id="P25"><bold>Mouse oligodendrocytes</bold> (Marques et al. <xref rid="R37" ref-type="bibr">37</xref>, GSE75330): scRNA-seq data of 5069 cells from the oligodendrocyte lineage. Cells were obtained from several different mouse strains and isolated from ten different regions of the anterior-posterior and dorsal-ventral axis of the mouse juvenile and adult CNS; including white and grey matter. Expression matrix units: UMI counts.</p>
      <p id="P26"><bold>Oligodendroglioma</bold> (Tirosh et al. <xref rid="R38" ref-type="bibr">38</xref>, GSE70630): scRNA-seq expression profiles for 4347 cells from 6 untreated grade II oligodendroglioma tumors with either IDH1 or IDH2 mutation, and 1p/19q co-deletion. Only the tumoral cells were used for the analysis (selected by the authors based on CNV profile). Expression matrix units: log<sub>2</sub>(TPM+1).</p>
      <p id="P27"><bold>Melanoma</bold> (Tirosh et al. <xref rid="R13" ref-type="bibr">13</xref>, GSE72056): scRNA-seq of 1252 melanoma cells from 14 different tumors. These include only the cells that are labeled as malignant by the authors, based on their CNV profiles. Expression matrix units: log<sub>2</sub>(TPM/10+1).</p>
      <p id="P28"><bold>Mouse retina</bold> (Macosko et al. <xref rid="R39" ref-type="bibr">39</xref>, GSE63472): scRNA-seq data of 44808 cells obtained through Drop-seq from mouse retina (14 days post-natal). Expression matrix units: <italic>log((UMI counts per gene in a cell/Total UMI counts in cell)*10000)+1)</italic>].</p>
      <p id="P29"><bold>Embryonic mouse brain</bold> (10X Genomics): Chronium Megacell demonstration dataset containing 1,306,127 cells from cortex, hippocampus and subventricular zone of two E18 mice (strain: C57BL/6).</p>
    </sec>
    <sec id="S10">
      <title>Gene filtering</title>
      <p id="P30">For gene filtering to run GENIE3, we applied a soft filter based on the total number of counts of the gene, and the number of cells in which it is detected. The first filter, the total number of reads per gene, is meant to remove genes that are most likely unreliable and provide only noise. The specific value depends on the dataset, for the ones used in this paper we set the thresholds at, for example, 3 UMI counts (slightly over the median of the non-zero values) multiplied by 1% of the number of cells in the dataset (e.g. in mouse brain: 3 UMI counts x 30 (1% of cells) = minimum 90 counts per gene). The second filter, the number of cells in which the gene is detected (e.g. &gt;0 UMI, or &gt;1 log2(TPM)), is to avoid that genes that are only expressed in one, or very few cells, gain a lot of weight if they happen to coincide in a given cell. In the workflow, we recommend to set a percentage lower than the smallest population of cells to be detected. For example, since microglia cells represent approximately 3% of the total cells in the dataset, we used a detection threshold of at least 1% of the cells.</p>
    </sec>
    <sec id="S11">
      <title>Cross-species network comparisons</title>
      <p id="P31">SCENIC was run independently for each of the three datasets used for the GRN comparison: Zeisel et al. (mouse brain cells), and Lake et al. (human neurons nuclei) and Darmanis et al. (human brain cells). To compare the networks across species, the genes in the human regulons were converted into the homologous mouse genes using Biomart (through biomaRt R package <xref rid="R40" ref-type="bibr">40</xref>), and vice versa (the mouse regulons into human genes). In <xref ref-type="fig" rid="F2">Fig. 2a</xref>, the genes highlighted in red also have associations with Dlx1/2 in GeneMANIA <xref rid="R41" ref-type="bibr">41</xref> (protein-protein interactions, genetic interactions, co-expression, or literature co-mentioning).</p>
      <p id="P32">For the cross-species cell clustering (<xref ref-type="fig" rid="F2">Fig. 2c</xref>), the genes in the mouse expression matrix were converted into the homologous human genes, and merged with Darmanis’ expression matrix by row (only genes available in both matrices are kept). The 259 human regulons from Darmanis’ dataset, and the human homologs of the mouse regulons were evaluated on this merged matrix to obtain the binary regulon activity containing 410 regulons. The cells were clustered based on the binary activity matrix using Ward’s hierarchical clustering with Spearman’s distance. Similar results were obtained for the reverse approach (converting the expression matrix into mouse genes, to evaluate the mouse regulons). In order to provide an alternative approach based only on expression (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 7</xref>), we also generated a merged expression matrix. Since the merged data sets use different measurement units (CPM in human and UMI in mouse), each matrix was Z-score normalized by gene before merging.</p>
    </sec>
    <sec id="S12">
      <title>Method comparisons</title>
      <p id="P33">We performed different evaluations and benchmark comparisons, each assessing a different aspect of SCENIC (e.g. cell type identification, TF identification, co-founding effect correction…). The detailed description of how these comparisons were performed is available in <xref ref-type="supplementary-material" rid="SD3">Supplementary Note 1</xref>. Here we provide a brief summary:</p>
      <p id="P34"><bold>Cell clustering</bold>: To determine whether the clustering based on gene regulatory network activity matches real cell types, we compared the clustering based on the regulon activity matrices to the cell labels provided in the corresponding publications. To compare SCENIC performance to other methods, we re-used the benchmark presented in the SC3 publication <xref rid="R10" ref-type="bibr">10</xref>, which provides the adjusted Rand index (ARI) for 6 clustering methods on the mouse brain dataset.</p>
      <p id="P35"><bold>TF-motif discovery</bold>: The validation of the TFs identified by SCENIC was mainly done by confirming their role in the given cell type in literature (e.g. <xref ref-type="fig" rid="F1">Fig. 1e</xref>). However, we also compared SCENIC to an alternative approach to identify TFs potentially regulating cell states: Applying transcription factor motif enrichment analysis on genes differentially expressed between clusters (i.e. gene signature, or markers for a cell type).</p>
      <p id="P36"><bold>Batch effect correction</bold>: The results of SCENIC on the oligodendroglioma dataset (clustering of the full binary regulon activity matrix) were compared to Combat <xref rid="R15" ref-type="bibr">15</xref>,<xref rid="R42" ref-type="bibr">42</xref> and Limma <xref rid="R16" ref-type="bibr">16</xref>,<xref rid="R43" ref-type="bibr">43</xref> correcting for “patient of origin” as source of batch effect.</p>
      <p id="P37"><bold>Cycling cells</bold>: The <bold>cycling cells</bold> were predicted based on consistent up-regulation of 46 sets related to the mitotic cell cycle from amiGO and cycleBase 1.0 and 2.0. We then compared the ability of different clustering methods to identify these cells (sensitivity and specificity). Since most of the methods provide multiple clusters as output, to compare their results, for each method we selected the cluster with the largest amount of CC cells.</p>
    </sec>
    <sec id="S13">
      <title>Immunohistochemistry of melanoma biopsies</title>
      <p id="P38">Immunohistochemistry with antibodies for melanA, EPHA2, ZEB1, NFATC2 and NFIB was performed on formalin-fixed, paraffin-embedded melanoma samples. The samples include biopsies of 9 primary melanomas (4 in radial growth phase and 5 in vertical growth phase), 8 melanoma-containing sentinel lymph nodes, and 8 melanoma metastases. A detailed description of how the immunohistochemistry was performed is available in <xref ref-type="supplementary-material" rid="SD3">Supplementary Note 1</xref>.</p>
    </sec>
    <sec id="S14">
      <title>Knock-down of NFATC2 in melanoma cell culture</title>
      <p id="P39">The A375 cell line was selected as representative of the MITF<sup>low</sup> state based on expression of NFATC2, NFIB (<xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 13</xref>) and SOX10, after comparing 59 melanoma cell lines from the COSMIC Cancer Cell lines Project <xref rid="R44" ref-type="bibr">44</xref>. Knockdown of NFATC2 was performed in A375 using NFATC2 siRNA, and total RNA was extracted 72 hours after the knockdown. The final libraries were pooled and sequenced on a combination of NextSeq 500 and HiSeq 4000 (Illumina). RNA-seq reads were mapped to the genome (hg19) for upstream analysis. A detailed description of the methods, including cell line source, knock-down of NFATC2, RNA-seq protocol and bioinformatics analysis, are available in <xref ref-type="supplementary-material" rid="SD3">Supplementary Note 1</xref>.</p>
    </sec>
    <sec id="S15">
      <title>Software packages, code and data availability</title>
      <p id="P40">Updated links to the packages and tutorials related to SCENIC are available at <ext-link ext-link-type="uri" xlink:href="http://scenic.aertslab.org">http://scenic.aertslab.org</ext-link>; the package versions at the time of publication are provided as <xref ref-type="supplementary-material" rid="SD1">Supplementary Software</xref>.</p>
      <p id="P41">The NFATC2 knock-down RNA-seq data have been deposited in NCBI's Gene Expression Omnibus <xref rid="R45" ref-type="bibr">45</xref> and are accessible through GEO Series accession number <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE99466">GSE99466</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>Reporting summary</label>
      <media xlink:href="NIHMS74166-supplement-Reporting_summary.pdf" mimetype="application" mime-subtype="pdf" orientation="portrait" xlink:type="simple" id="d36e808" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>Supplementary figures</label>
      <media xlink:href="NIHMS74166-supplement-Supplementary_figures.docx" mimetype="application" mime-subtype="octet-stream" orientation="portrait" xlink:type="simple" id="d36e812" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD3">
      <label>Supplementary note 1</label>
      <media xlink:href="NIHMS74166-supplement-Supplementary_note_1.pdf" mimetype="application" mime-subtype="pdf" orientation="portrait" xlink:type="simple" id="d36e816" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD4">
      <label>Supplementary table 1</label>
      <media xlink:href="NIHMS74166-supplement-Supplementary_table_1.xlsx" mimetype="application" mime-subtype="octet-stream" orientation="portrait" xlink:type="simple" id="d36e820" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S16">
    <title>Acknowledgements</title>
    <p>This work is funded by The Research Foundation - Flanders (FWO, <ext-link ext-link-type="uri" xlink:href="http://www.fwo.be">www.fwo.be</ext-link>; grants G.0640.13 and G.0791.14 to SAe; G092916N to JCM), Special Research Fund (BOF) KU Leuven (<ext-link ext-link-type="uri" xlink:href="http://www.kuleuven.be/research/funding/bof">http://www.kuleuven.be/research/funding/bof</ext-link>; grant PF/10/016 and OT/13/103 to SAe), Foundation Against Cancer (<ext-link ext-link-type="uri" xlink:href="https://www.cancer.be/">http://www.cancer.be</ext-link>; 2012-F2, 2016-070, and 2015-143 to SAe) and ERC Consolidator Grant (724226_cis-CONTROL to SAe). SAi is funded by a PDM Postdoctoral Fellowship from the KU Leuven. ZKA and JW are funded by postdoctoral research fellowships from Kom op Tegen Kanker, and VAH by the F.R.S.-FNRS Belgium. HI has a PhD Fellowships from the agency for Innovation by Science and Technology (IWT, <ext-link ext-link-type="uri" xlink:href="http://www.iwt.be">www.iwt.be</ext-link>). TM and JA funding is provided by Symbiosys and IMEC HI^2 Data Science. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. TM would like to thank Jaak Simm for helpful comments and suggestions regarding gradient boosting.</p>
  </ack>
  <fn-group>
    <fn fn-type="con" id="FN1">
      <p id="P42">
        <bold>Author contributions</bold>
      </p>
      <p id="P43">SAe and SAi conceived the study; SAi implemented SCENIC and related packages with help of VA and PG for GENIE3, and GH for RcisTarget; SAi and CBG analyzed the data, with help of ZKA and HI; TM and JA implemented GRNBoost; JW performed the IHC and knock-down experiments; FR, JCM, and JvdO contributed reagents and helped with the interpretation of the melanoma analyses; SAi, JW, and SAe and wrote the manuscript.</p>
    </fn>
    <fn fn-type="COI-statement" id="FN2">
      <p id="P44">
        <bold>Competing financial interests</bold>
      </p>
      <p id="P45">The authors declare no competing financial interests.</p>
    </fn>
  </fn-group>
  <ref-list>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Linnarsson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Single-cell genomics: coming of age</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>97</fpage>
        <pub-id pub-id-type="pmid">27160975</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Revealing the vectors of cellular identity with single-cell genomics</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>1145</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="pmid">27824854</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Computational and analytical challenges in single-cell transcriptomics</article-title>
        <source>Nat Rev Genet</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>133</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="pmid">25628217</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raj</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Nature, Nurture, or Chance: Stochastic Gene Expression and Its Consequences</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>135</volume>
        <fpage>216</fpage>
        <lpage>226</lpage>
        <pub-id pub-id-type="pmid">18957198</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moignard</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Decoding the regulatory network of early blood development from single-cell gene expression measurements</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>269</fpage>
        <lpage>276</lpage>
        <pub-id pub-id-type="pmid">25664528</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pina</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-Cell Network Analysis Identifies DDIT3 as a Nodal Lineage Regulator in Hematopoiesis</article-title>
        <source>Cell Rep</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>1503</fpage>
        <lpage>1510</lpage>
        <pub-id pub-id-type="pmid">26051941</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Whitsett</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>SINCERA: A Pipeline for Single-Cell RNA-Seq Profiling Analysis</article-title>
        <source>PLOS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>e1004575</fpage>
        <pub-id pub-id-type="pmid">26600239</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huynh-Thu</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Irrthum</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wehenkel</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Geurts</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Inferring regulatory networks from expression data using tree-based methods</article-title>
        <source>PloS One</source>
        <year>2010</year>
        <volume>5</volume>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <fpage>1138</fpage>
        <lpage>1142</lpage>
        <pub-id pub-id-type="pmid">25700174</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>483</fpage>
        <lpage>486</lpage>
        <pub-id pub-id-type="pmid">28346451</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lake</surname>
            <given-names>BB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neuronal subtypes and diversity revealed by single-nucleus RNA sequencing of the human brain</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>352</volume>
        <fpage>1586</fpage>
        <lpage>1590</lpage>
        <pub-id pub-id-type="pmid">27339989</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq supports a developmental hierarchy in human oligodendroglioma</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>539</volume>
        <fpage>309</fpage>
        <lpage>313</lpage>
        <pub-id pub-id-type="pmid">27806376</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>352</volume>
        <fpage>189</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="pmid">27124452</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alizadeh</surname>
            <given-names>AA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Toward understanding and exploiting tumor heterogeneity</article-title>
        <source>Nat Med</source>
        <year>2015</year>
        <volume>21</volume>
        <fpage>846</fpage>
        <lpage>853</lpage>
        <pub-id pub-id-type="pmid">26248267</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rabinovic</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>118</fpage>
        <lpage>127</lpage>
        <pub-id pub-id-type="pmid">16632515</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>e47</fpage>
        <lpage>e47</lpage>
        <pub-id pub-id-type="pmid">25605792</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perotti</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NFATc2 is an intrinsic regulator of melanoma dedifferentiation</article-title>
        <source>Oncogene</source>
        <year>2016</year>
        <volume>35</volume>
        <fpage>2862</fpage>
        <lpage>2872</lpage>
        <pub-id pub-id-type="pmid">26387540</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>C-Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NFIB is a governor of epithelial-melanocyte stem cell behaviour in a shared niche</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>495</volume>
        <fpage>98</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="pmid">23389444</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Denny</surname>
            <given-names>SK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nfib Promotes Metastasis through a Widespread Increase in Chromatin Accessibility</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>166</volume>
        <fpage>328</fpage>
        <lpage>342</lpage>
        <pub-id pub-id-type="pmid">27374332</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>NFAT, immunity and cancer: a transcription factor comes of age</article-title>
        <source>Nat Rev Immunol</source>
        <year>2010</year>
        <volume>10</volume>
        <fpage>645</fpage>
        <lpage>656</lpage>
        <pub-id pub-id-type="pmid">20725108</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Human Cell Atlas</article-title>
        <source>bioRxiv</source>
        <year>2017</year>
        <pub-id pub-id-type="doi">10.1101/121202</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Zaharia</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Resilient Distributed Datasets: A Fault-tolerant Abstraction for In-memory Cluster Computing</source>
        <conf-name>Proceedings of the 9th USENIX Conference on Networked Systems Design and Implementation 2–2</conf-name>
        <publisher-name>USENIX Association</publisher-name>
        <year>2012</year>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marbach</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Wisdom of crowds for robust gene network inference</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>796</fpage>
        <lpage>804</lpage>
        <pub-id pub-id-type="pmid">22796662</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Islam</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>163</fpage>
        <lpage>166</lpage>
        <pub-id pub-id-type="pmid">24363023</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crow</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ballouz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>ZJ</given-names>
          </name>
          <name>
            <surname>Gillis</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Exploiting single-cell expression to characterize co-expression replicability</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>101</fpage>
        <pub-id pub-id-type="pmid">27165153</pub-id>
      </element-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data with Bioconductor</article-title>
        <source>F1000Research</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>2122</fpage>
        <pub-id pub-id-type="pmid">27909575</pub-id>
      </element-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Greedy Function Approximation: A Gradient Boosting Machine</article-title>
        <source>Ann Stat</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>1189</fpage>
        <lpage>1232</lpage>
      </element-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Guestrin</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <source>XGBoost: A Scalable Tree Boosting System</source>
        <conf-name>Proceedings of the 22Nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining 785–794</conf-name>
        <publisher-name>ACM</publisher-name>
        <year>2016</year>
        <pub-id pub-id-type="doi">10.1145/2939672.2939785</pub-id>
      </element-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freund</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schapire</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A short introduction to boosting</article-title>
        <source>J-Jpn Soc Artif Intell</source>
        <year>1999</year>
        <volume>14</volume>
        <fpage>1612</fpage>
      </element-citation>
    </ref>
    <ref id="R30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sławek</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Arodź</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>ENNET: inferring large gene regulatory networks from expression data using gradient boosting</article-title>
        <source>BMC Syst Biol</source>
        <year>2013</year>
        <volume>7</volume>
        <fpage>106</fpage>
        <pub-id pub-id-type="pmid">24148309</pub-id>
      </element-citation>
    </ref>
    <ref id="R31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dean</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ghemawat</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>MapReduce: Simplified Data Processing on Large Clusters</article-title>
        <source>Commun ACM</source>
        <year>2008</year>
        <volume>51</volume>
        <fpage>107</fpage>
        <lpage>113</lpage>
      </element-citation>
    </ref>
    <ref id="R32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aerts</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust Target Gene Discovery through Transcriptome Perturbations and Genome-Wide Enhancer Predictions in Drosophila Uncovers a Regulatory Basis for Sensory Specification</article-title>
        <source>PLOS Biol</source>
        <year>2010</year>
        <volume>8</volume>
        <fpage>e1000435</fpage>
        <pub-id pub-id-type="pmid">20668662</pub-id>
      </element-citation>
    </ref>
    <ref id="R33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herrmann</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sande</surname>
            <given-names>BV</given-names>
          </name>
          <name>
            <surname>de Potier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Aerts</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>i-cisTarget: an integrative genomics method for the prediction of regulatory features and cis-regulatory modules</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>e114</fpage>
        <lpage>e114</lpage>
        <pub-id pub-id-type="pmid">22718975</pub-id>
      </element-citation>
    </ref>
    <ref id="R34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Janky</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>iRegulon: From a Gene List to a Gene Regulatory Network Using Large Motif and Track Collections</article-title>
        <source>PLOS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>e1003731</fpage>
        <pub-id pub-id-type="pmid">25058159</pub-id>
      </element-citation>
    </ref>
    <ref id="R35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krijthe</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Rtsne: T-Distributed Stochastic Neighbor Embedding using Barnes-Hut Implementation</source>
        <year>2015</year>
      </element-citation>
    </ref>
    <ref id="R36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darmanis</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>7285</fpage>
        <lpage>7290</lpage>
        <pub-id pub-id-type="pmid">26060301</pub-id>
      </element-citation>
    </ref>
    <ref id="R37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marques</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Oligodendrocyte heterogeneity in the mouse juvenile and adult central nervous system</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>352</volume>
        <fpage>1326</fpage>
        <lpage>1329</lpage>
        <pub-id pub-id-type="pmid">27284195</pub-id>
      </element-citation>
    </ref>
    <ref id="R38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq supports a developmental hierarchy in human oligodendroglioma</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>539</volume>
        <fpage>309</fpage>
        <lpage>313</lpage>
        <pub-id pub-id-type="pmid">27806376</pub-id>
      </element-citation>
    </ref>
    <ref id="R39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="R40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durinck</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BioMart and Bioconductor: a powerful link between biological databases and microarray data analysis</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3439</fpage>
        <lpage>3440</lpage>
        <pub-id pub-id-type="pmid">16082012</pub-id>
      </element-citation>
    </ref>
    <ref id="R41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warde-Farley</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The GeneMANIA prediction server: biological network integration for gene prioritization and predicting gene function</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>W214</fpage>
        <lpage>W220</lpage>
        <pub-id pub-id-type="pmid">20576703</pub-id>
      </element-citation>
    </ref>
    <ref id="R42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>sva: Surrogate Variable Analysis</source>
      </element-citation>
    </ref>
    <ref id="R43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>limma: Linear models for microarray data</source>
      </element-citation>
    </ref>
    <ref id="R44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forbes</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>COSMIC: somatic cancer genetics at high-resolution</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>D777</fpage>
        <lpage>D783</lpage>
        <pub-id pub-id-type="pmid">27899578</pub-id>
      </element-citation>
    </ref>
    <ref id="R45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Domrachev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lash</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Gene Expression Omnibus: NCBI gene expression and hybridization array data repository</article-title>
        <source>Nucleic Acids Res</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>207</fpage>
        <lpage>210</lpage>
        <pub-id pub-id-type="pmid">11752295</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <title>The SCENIC workflow and its application to the mouse brain.</title>
      <p>(<bold>a</bold>) Co-expression modules between transcription factors and candidate target genes are inferred using <italic>GENIE3</italic> or <italic>GRNBoost</italic>. RcisTarget identifies those modules where the regulator’s binding motif is significantly enriched across the target genes; and creates regulons with only direct targets. <italic>AUCell</italic> scores the activity of each regulon in each cell, yielding a binarized activity matrix. Cell states are based on the shared activity of regulatory subnetworks. (<bold>b</bold>) SCENIC results on the mouse brain <xref rid="R9" ref-type="bibr">9</xref>; cluster labels correspond to <xref rid="R9" ref-type="bibr">9</xref>; master regulators are color-matched with the cell types they control. (<bold>c</bold>) transcription factors confirmed by literature (A) or having brain phenotypes from MGI (B), and the enriched DNA motifs are shown. (<bold>d</bold>) t-SNE on the binary regulon activity matrix. Each cell is assigned the color of the most active GRN. (<bold>e</bold>) Accuracy of different clustering methods on this dataset.</p>
    </caption>
    <graphic xlink:href="emss-74166-f001"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <title>Cross-species comparison of neuronal networks and cell types.</title>
      <p>(<bold>a</bold>) DLX1/2 regulons inferred from mouse and human brain scRNA-seq data. The genes highlighted in red have associations with Dlx1/2 in GeneMANIA. (<bold>b</bold>) Reciprocal activity of human and mouse Dlx1/2 regulons on mouse and human single-cell data. (<bold>c</bold>) Joint clustering of human and mouse brain scRNA-seq data based on GRN activity. Colored TF names correspond to regulons identified both in the human and mouse SCENIC runs.</p>
    </caption>
    <graphic xlink:href="emss-74166-f002"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <title>SCENIC overcomes tumor effects and unravels relevant cell states and GRNs in cancer.</title>
      <p>(<bold>a-b</bold>) t-SNEs on the expression matrices, colored by tumor of origin. (<bold>c-d, f-g</bold>) t-SNEs on the binary activity matrix (e,h) after applying SCENIC. In d and g, cells are colored by GRN activity. (<bold>i</bold>) Immunohistochemistry (IHC) on 25 human melanomas using NFATC2, NFIB, ZEB1, and EPHA2 antibodies. The heatmap shows the percentage of cells that are positive for each marker in the given sample. On the right, a representative example of IHC for NFIB on a sentinel lymph node is shown (for additional images, see <xref ref-type="supplementary-material" rid="SD2">Supplementary Fig. 13</xref>). (<bold>j</bold>) Aggregation plots for MITF and STAT1 ChIP-seq signal on the predicted target regions, and as control randomly selected genomic regions with MITF/STAT motif occurrences.</p>
    </caption>
    <graphic xlink:href="emss-74166-f003"/>
  </fig>
</floats-group>
