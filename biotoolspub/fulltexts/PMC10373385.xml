<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10373385</article-id>
    <article-id pub-id-type="pmid">37496087</article-id>
    <article-id pub-id-type="publisher-id">3014</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-023-03014-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ISLET: individual-specific reference panel recovery improves cell-type-specific inference</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Feng</surname>
          <given-names>Hao</given-names>
        </name>
        <address>
          <email>hxf155@case.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meng</surname>
          <given-names>Guanqun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Tong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Parikh</surname>
          <given-names>Hemang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pan</surname>
          <given-names>Yue</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Ziyi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Krischer</surname>
          <given-names>Jeffrey</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9874-3555</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Qian</given-names>
        </name>
        <address>
          <email>qian.li@stjude.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.67105.35</institution-id><institution-id institution-id-type="ISNI">0000 0001 2164 3847</institution-id><institution>Department of Population and Quantitative Health Sciences, Case Western Reserve University, </institution></institution-wrap>Cleveland, OH USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.240871.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 0224 711X</institution-id><institution>Department of Biostatistics, St. Jude Children’s Research Hospital, </institution></institution-wrap>262 Danny Thomas Place, Memphis, TN 38105 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.170693.a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2353 285X</institution-id><institution>Health Informatics Institute, University of South Florida, </institution></institution-wrap>Tampa, FL 33620 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.240145.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2291 4776</institution-id><institution>Department of Biostatistics, The University of Texas MD Anderson Cancer Center, </institution></institution-wrap>Houston, TX 77030 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>174</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">We propose a statistical framework ISLET to infer individual-specific and cell-type-specific transcriptome reference panels. ISLET models the repeatedly measured bulk gene expression data, to optimize the usage of shared information within each subject. ISLET is the first available method to achieve individual-specific reference estimation in repeated samples. Using simulation studies, we show outstanding performance of ISLET in the reference estimation and downstream cell-type-specific differentially expressed genes testing. We apply ISLET to longitudinal transcriptomes profiled from blood samples in a large observational study of young children and confirm the cell-type-specific gene signatures for pancreatic islet autoantibody. ISLET is available at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/ISLET">https://bioconductor.org/packages/ISLET</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-023-03014-8.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Deconvolution</kwd>
      <kwd>Temporal measures</kwd>
      <kwd>Cell-type-specific differential expression</kwd>
      <kwd>Individual-specific reference panel</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000062</institution-id>
            <institution>National Institute of Diabetes and Digestive and Kidney Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U24DK097771</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Qian</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Cancer Institute</institution>
        </funding-source>
        <award-id>R03CA270725</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Ziyi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000048</institution-id>
            <institution>American Cancer Society</institution>
          </institution-wrap>
        </funding-source>
        <award-id>IRG-16-186-21</award-id>
        <principal-award-recipient>
          <name>
            <surname>Feng</surname>
            <given-names>Hao</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Clinical samples often contain a mixture of different cellular subpopulations. The real-world clinical RNA-seq signatures are, therefore, mosaics of signals from multiple pure cell types. As a result, the observed bulk RNA-seq data can be viewed as the weighted average of signals from multiple cell types, whereas the weights, naturally, are the proportions in the mixture. Over the last decade, researchers have gained substantial interests in computational methods to deconvolute cell population frequencies. For example, CIBERSORT [<xref ref-type="bibr" rid="CR1">1</xref>], CIBERSORTx [<xref ref-type="bibr" rid="CR2">2</xref>], TIMER [<xref ref-type="bibr" rid="CR3">3</xref>], MuSiC [<xref ref-type="bibr" rid="CR4">4</xref>], and DWLS [<xref ref-type="bibr" rid="CR5">5</xref>] were proposed to estimate cellular composition and infer cell-type-specific expression profiles. These new methods improved the resolution of traditional analytical approaches to identify bulk RNA-seq <underline>D</underline>ifferentially <underline>E</underline>xpressed <underline>G</underline>enes (DEG).</p>
    <p id="Par3">Recently, novel methods including CARSeq [<xref ref-type="bibr" rid="CR6">6</xref>], TOAST [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], and TCA [<xref ref-type="bibr" rid="CR9">9</xref>] were developed to incorporate pre-estimated cell mixture proportions in the modeling of observed bulk data and directly detect DEG at cell-type-specific resolution. This new type of DEG analysis at cell type level is generally referred to as cell-type-specific <underline>D</underline>ifferentially <underline>E</underline>xpressed <underline>G</underline>enes identification. The rapid methodological advancement in cell proportion deconvolution and csDEG calling during the recent years has offered refined tools for cell-type-aware knowledge mining. It is worth noting that although single-cell RNA-seq (scRNA-seq) or cell sorting from samples can directly measure signals from each cellular subpopulation, the costs and technical challenges in cell isolation is still a major hurdle to apply scRNA-seq in population-based study. For example, to investigate immunity-related signals in the blood samples in a multi-center cohort study, sorting peripheral blood mononuclear cells (PBMC) and profiling transcriptomes is cost prohibitive [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. Hence, bulk RNA-seq profiling is still favorable in medium- or large-scale studies.</p>
    <p id="Par4">The longitudinal or repeated sampling has become a popular strategy in clinical transcriptomic research, such as a longitudinal bulk RNA-seq study coupled with small-scale scRNA-seq profiling in high grade serous ovarian cancer [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. Another recent study [<xref ref-type="bibr" rid="CR14">14</xref>] using longitudinal whole blood bulk gene expression found that the gene markers contributing to the development of type 1 diabetes (T1D) were also related to blood immune cells. To discover the latent dynamics within each cellular subpopulation without gene network construction, one should develop a novel framework that directly identifies temporal cell-type-specific gene signatures associated with disease status.</p>
    <p id="Par5">Despite numerous methods developed for bulk data deconvolution and csDE analysis [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>], limitations exist due to the rare usage of participant indicator and lack of participant-level reference profile. Traditionally, these methods were developed under the assumption of one identical feature-by-cell type reference panel across all the samples, which were not capable of characterizing individual cell-type-specific gene expression reference. In contrast, the algorithms in recent tools TCA [<xref ref-type="bibr" rid="CR9">9</xref>] recovered the reference panel for each sample without specifying the between-subject heterogeneity [<xref ref-type="bibr" rid="CR19">19</xref>]. Another concern in these methods is the strong heterogeneity within each subject, as time-dependent variation in transcriptomes may not be profound in subgroups of participants [<xref ref-type="bibr" rid="CR20">20</xref>]. Hence, a subject-specific reference information shared by different time points is more reasonable than assuming independent reference panels across time points. To accurately detect cell-type-specific gene signatures, an individual-specific reference panel should be reconstructed for longitudinal bulk gene expression data.</p>
    <p id="Par6">Here, we present a novel computational method ISLET (Individual Specific celL typE referencing Tool), to estimate the cell-type-specific gene expression reference panel for each participant. The unobserved panel per subject are estimated by the expectation-maximization (EM) algorithm in a mixed-effect regression model. ISLET leverages multiple or temporal observations of each subject, to construct a likelihood-based statistics for csDEG inference. This is the first statistical framework to recover the subject-level reference panel by employing multiple samples per subject. Our model also provides the flexibility to incorporate group-wise change rate across time points in the reference gene expression and then identify differential dynamics in each cellular subpopulation.</p>
    <p id="Par7">We designed an extensive simulation study to compare our method ISLET with csSAM, TOAST, TCA, CARSeq, aDESeq2 [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR21">21</xref>], demonstrating ISLET being a powerful and robust tool that outperformed these competing methods. We applied ISLET to the longitudinal bulk RNA-seq data in The Environmental Determinants of Diabetes in the Young (TEDDY) cohort [<xref ref-type="bibr" rid="CR14">14</xref>] and the Parkinson’s Disease Biomarker Program (PDBP). Our method successfully identified potential gene signatures differentially expressed in B cells, natural killer (NK) cells prior to the onset of pancreatic <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M2"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq1.gif"/></alternatives></inline-formula>-cell autoantibodies, and those in CD8+ T cells, NK cells for Parkinson’s disease. ISLET is available on Bioconductor at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/ISLET">https://bioconductor.org/packages/ISLET</ext-link> [<xref ref-type="bibr" rid="CR22">22</xref>]. Overall, the improved resolution of subject-specific and cell-type-specific biomarkers, estimated by ISLET, helped to achieve more precise biomarker associations with clinical outcomes.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Deconvolution of individual reference profile and temporal csDE analysis</title>
      <p id="Par8">Our framework utilizes repeatedly measured bulk transcriptomes as input to retrieve a cell-type-specific gene expression profile for each participant (subject) and perform the csDE analysis, as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Besides the bulk transcriptomic data, it also takes cell type proportions, subject disease status, and optional covariates as the input. Note that the cell type proportions can be estimated by an existing tool (such as CIBERSORT, MuSiC, TOAST, or AutoGeneS [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]) in practice and thus is treated as a known input in our model. As an example, each subject or participant <italic>j</italic> has whole blood or PBMC samples collected at multiple time points <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=1,\dots , T_j$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq2.gif"/></alternatives></inline-formula>. The gene expression measured in participant <italic>j</italic>’s sample at time point <italic>t</italic> is <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{jt}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq3.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_j$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq4.gif"/></alternatives></inline-formula> is the indicator for each individual’s treatment group, phenotype, or case-control status. The gene expression value <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{jt}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq5.gif"/></alternatives></inline-formula> is either raw or normalized counts without batch effect and can be replaced by DNA methylation measurement if the feature is a CpG site. There are <italic>K</italic> cell types of interest in each sample, with estimated or known proportions <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{jtk}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jtk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq6.gif"/></alternatives></inline-formula>, and naturally <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{k=1}^K\theta _{jtk}=1$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jtk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq7.gif"/></alternatives></inline-formula>. Given the input cell proportions, the observed bulk gene expression <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{jt}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq8.gif"/></alternatives></inline-formula> can be described by a linear mixed effect model<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E(y_{jt}) = \sum\nolimits _{k=1}^K \left( m_{k}+ \beta _kz_j +u_{jk}\right) \theta _{jtk} \end{aligned}$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:msub><mml:mi>m</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jtk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{k}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>m</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq9.gif"/></alternatives></inline-formula> is the mean gene expression in cell type <italic>k</italic> for the baseline group (i.e., controls, <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_j=0$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq10.gif"/></alternatives></inline-formula>), and <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{k}+\beta _k$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq11.gif"/></alternatives></inline-formula> is the mean expression in cell type <italic>k</italic> for cases (<inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_j=1$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq12.gif"/></alternatives></inline-formula>). The random variable <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u_{jk}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq13.gif"/></alternatives></inline-formula>, shared by the repeated or longitudinal samples from the same subject, represents a subject-specific deviation in the group-wise mean expression in cell type <italic>k</italic>. This unobserved random term accounts for the within-subject measurements correlation. Hence, we can deconvolve the mixture-cell gene expression into <italic>K</italic> cell types for each subject, individually, by estimating the fixed and random effects (<inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{k},\beta _k,u_{jk}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq14.gif"/></alternatives></inline-formula>), as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. To detect csDEG between cases and controls, one can test the hypothesis <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0: \beta _k=0$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq15.gif"/></alternatives></inline-formula>.<fig id="Fig1"><label>Fig. 1</label><caption><p>An overview of our proposed method ISLET (Individual Specific celL typE referencing Tool). <bold>A</bold> ISLET takes repeatedly measured bulk RNA-seq data, cell type proportions (known or estimated), and disease status as the algorithm input. Additional covariates are optional. <bold>B</bold> By a hierarchical mixed-effect modeling, ISLET can iteratively retrieve individual-specific and cell-type-specific gene expression reference panels. The fixed effect is the group-level average and the random effect is the individual-level deviance from the group mean. <bold>C</bold> Given the individual-specific reference panel, ISLET can conduct test to identify cell-type-specific differentially expressed genes (csDEG)</p></caption><graphic xlink:href="13059_2023_3014_Fig1_HTML" id="MO2"/></fig></p>
      <p id="Par9">This framework can be extended by adding time-related change in the reference panels, with change rate fixed by group. For simplicity, we assume linear change rate (i.e., slope) in the present research. The model in (<xref rid="Equ1" ref-type="disp-formula">1</xref>) can be generalized as<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E(y_{jt})=\sum\nolimits_{k=1}^K \left( \tilde{m}_{k}+ \tilde{\alpha }_kc_{jt} +\tilde{\beta }_k z_j +\gamma _kc_{jt}z_j +u_{jk}\right) \theta _{jtk} \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jtk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>with <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{jt}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq16.gif"/></alternatives></inline-formula> denoting the time or sample age and <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\alpha }_k$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq17.gif"/></alternatives></inline-formula> denoting the slope in baseline group. The other potential covariates can be included in <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{jt}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq18.gif"/></alternatives></inline-formula> as a vector. The parameter <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\beta }_k$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq19.gif"/></alternatives></inline-formula> represents age-independent difference between groups in cell-type-specific gene expression. A differential slope <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _k\ne 0$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq20.gif"/></alternatives></inline-formula> implies that the cases’ gene expression change over time in cell type <italic>k</italic> is associated with the disease status <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_j$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq21.gif"/></alternatives></inline-formula>. There may be no significant group effect in the intercept (<inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\beta }_k=0$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq22.gif"/></alternatives></inline-formula>) or slope (<inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _k=0$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq23.gif"/></alternatives></inline-formula>), but the participants still have distinct underlying reference profiles (<inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u_{jk}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq24.gif"/></alternatives></inline-formula>). The csDEG in intercept or slope can be identified by testing <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0: \tilde{\beta }_k=0$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq25.gif"/></alternatives></inline-formula> or <inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0: \gamma _k=0$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq26.gif"/></alternatives></inline-formula>, respectively. Parameters estimation from the modeling above can be achieved by adopting expectation-maximization (EM) algorithm and is detailed in the “<xref rid="Sec14" ref-type="sec">Methods”</xref> section.</p>
    </sec>
    <sec id="Sec4">
      <title>Simulation study</title>
      <sec id="Sec5">
        <title>Temporal cell type proportions</title>
        <p id="Par10">The cell type proportions were generated based on real single-cell RNA-seq (scRNA-seq) datasets, from annotated and well-labeled cell types. Here, we compiled a pool of cell type labels by aggregating multiple scRNA-seq datasets cell labels and conducted bootstrap to generate cell type labels and calculate the cell type proportions, from each resampling. Those bootstrapped proportions were then fitted by the Dirichlet distribution to estimate the parameters <inline-formula id="IEq27"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M58"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq27.gif"/></alternatives></inline-formula>. Note that the number of cell types can be customized during this procedure. This enables us to simulate cell type compositions in different scenarios. For example, a study could have one dominant cell type and several minor cell types; or in contrast, a study could have relatively balanced cell type proportions with low composition variation. This procedure allows us to obtain cell type proportions that best mimic real data. Details of cell type proportion simulation are described in “<xref rid="Sec14" ref-type="sec">Methods” section</xref>.</p>
      </sec>
      <sec id="Sec6">
        <title>Individual reference panel and temporal gene expression</title>
        <p id="Par11">Cell type-specific underlying expression reference profile were also generated based on real cell line RNA-seq dataset. All parameters were derived from a real study (GSE60424) and solved by the Bioconductor package PROPER [<xref ref-type="bibr" rid="CR24">24</xref>]. This real dataset collected immune-associated diseases and pure immune cell line bulk RNA-seq data. The expression mean and biological dispersions per gene and cell type are estimated by <italic>estParam</italic> function in PROPER at log scale. This real data suggests strong associations across cell types in mean expression and biological dispersion. Thus, we adopted multivariate normal (MVN) distribution to compute the variance-covariance information, <inline-formula id="IEq28"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma _m}$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi mathvariant="bold-italic">m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma _{\phi }}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq29.gif"/></alternatives></inline-formula>, respectively, for mean and overdispersion parameters. For gene <italic>g</italic>, the mean expression and overdispersion per subject <italic>j</italic> are simulated by MVN with <inline-formula id="IEq30"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\bar{\mu }_m}$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi mathvariant="bold-italic">m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\bar{\mu }_{\phi }}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq31.gif"/></alternatives></inline-formula>, who are K-dimensional vectors representing the mean and overdispersion parameters estimated from PROPER.</p>
        <p id="Par12">To simulate the biological variation, we adopted a Gamma distribution to generate the true cell-type-specific gene expression matrix. We assume cases and controls have identical gene-wise overdispersion <inline-formula id="IEq32"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma _{\phi }}$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq32.gif"/></alternatives></inline-formula> but different mean expression specified by log fold change (LFC). The reference gene expression per control (baseline group) are simulated by the above process with mean <inline-formula id="IEq33"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\mu }^{ctr}_{m}$$\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ctr</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq33.gif"/></alternatives></inline-formula>, while the expression for cases are generated by the same process with mean <inline-formula id="IEq34"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\mu }^{case}_{m}=\bar{\mu }^{ctr}_{m}+\Delta$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">case</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ctr</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq34.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq35"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta$$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq35.gif"/></alternatives></inline-formula> is LFC. The true mixture-cell expression per gene per sample (<inline-formula id="IEq36"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\lambda }_{gjt}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq36.gif"/></alternatives></inline-formula>) is the weighted sum of the reference gene expression, with weights as cell proportions. We set 10% genes as DE in a cell type, although two of the six cell types do not contain any DE genes. The values of LFC are set at <inline-formula id="IEq37"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {LFC}=0, 0.5,0.75,1.0,1.25,1.5$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mtext>LFC</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>0.75</mml:mn><mml:mo>,</mml:mo><mml:mn>1.0</mml:mn><mml:mo>,</mml:mo><mml:mn>1.25</mml:mn><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq37.gif"/></alternatives></inline-formula>. The number of subjects is set at <inline-formula id="IEq38"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=50, 100, 150, 200$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>150</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq38.gif"/></alternatives></inline-formula>. Each subject has measurements at three time points, and the number of subjects are equal between two groups. The observed raw counts is generated by Poisson distribution with mean <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\lambda }_{gjt}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq39.gif"/></alternatives></inline-formula> to mimic the technical noise in sequencing experiments.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Reference panel deconvolution</title>
      <p id="Par13">We first evaluated the accuracy of ISLET on individual-specific reference panel recovery, using the synthetic data outlined above. Since ISLET is the only method that estimates subject-specific reference expression from longitudinal bulk samples, the comparison with existing methods in subject-specific reference panel is not directly viable. Nevertheless, we chose TOAST and TCA for a detailed comparison. TOAST can solve for one reference panel per group (case/control), and this group-wise reference matrix is then treated as the subject-specific reference panel in evaluation. TCA can solve for sample-specific reference panel; thus, we use the average of multiple estimated reference panels per subject to obtain the subject-specific profile. These two approaches reflect the two ends of the deconvolution spectrum: a fixed reference panel across subjects (or samples) per group vs. a sample-specific reference, while ISLET fills the methodology gap in between.</p>
      <p id="Par14">For the aforementioned three methods, cell type proportions were provided as input. We assessed the reference estimation accuracy in two scenarios, in which the true and pre-deconvoluted proportions served as the input, respectively. The pre-deconvoluted proportions were obtained by CIBERSORTx using noise-added reference panels, with 200 marker genes identified independently by TOAST package based on coefficient of variations. There are <inline-formula id="IEq40"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=50$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq40.gif"/></alternatives></inline-formula> subjects per group, each has three samples under the null hypothesis (0% DEG). The ISLET-estimated individual reference panel, based on the true or pre-deconvoluted cell type composition, are shown in scatterplots (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A, B). The true cellular proportions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A) yields more precision in reference panel estimation, compared with the computationally deconvoled proportions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). This difference is more profound in low-expression genes (log-expression &lt; 7).<fig id="Fig2"><label>Fig. 2</label><caption><p>ISLET accurately estimates individual-specific gene expression reference panels. <bold>A</bold> Scatterplot showing ISLET estimated reference panel versus the true reference panel, in log scale, when using the true cell type proportions as the input. <bold>B</bold> Scatterplot similar to panel <bold>A</bold> but using the estimated cell type proportions as the input. <bold>C</bold> Normalized mean squared error (NMSE) in reference panel estimation, from three methods: TOAST, TCA, and ISLET, at various effect sizes. Log fold change (LFC) used in simulation: 0, 0.5, 0.75, 1, 1.25, and 1.5. <bold>D</bold> NMSE at various samples sizes per group (25, 50, 75, and 100), comparing three methods. <bold>E</bold> NMSE stratified by gene expression level (low expression: <inline-formula id="IEq41"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M86"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq41.gif"/></alternatives></inline-formula>160 and high expression: &gt; 160). <italic>N </italic>= 20 simulations are conducted in each scenario</p></caption><graphic xlink:href="13059_2023_3014_Fig2_HTML" id="MO4"/></fig></p>
      <p id="Par15">We next assessed if the effect size of DEG could have an impact on reference estimation. The effect size is reflected through the log-fold change (LFC) value of the synthetic DEG. Figure <xref rid="Fig2" ref-type="fig">2</xref>C shows the estimation error, represented by normalized mean squared error (NMSE) for the three methods across various choices of LFC ranging from 0 (under the null) to 1.5 (large effect size). ISLET has the lowest median and lowest variation NMSE under all choices of effect sizes, showing the most accurate and stable estimation. In addition, ISLET is robust with the least NMSE increase at larger effect sizes. In contrast, TOAST have inflated error at large LFC and TCA has higher variability. The estimation accuracy at different sample sizes is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>D. As expected, all methods benefited from an increased sample size. ISLET achieved the lowest error consistently at sample sizes of 25 to 100 per group. It has the lowest median error as well as the lowest variation. Next, to investigate if the expression level would impact the estimation accuracy, we stratified the genes into two groups: low expression genes (expression count value <inline-formula id="IEq42"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M88"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq42.gif"/></alternatives></inline-formula>160) and high expression genes (expression count value &gt; 160). As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>E, the bias of ISLET is the lowest at both strata, showing the most robust performance among the three methods. Similar conclusions can be drawn in other combinations of LFC and sample size (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S1-S7 ). Side-by-side comparisons using ground true proportions versus estimated proportions (Fig. S<xref rid="MOESM1" ref-type="media">2</xref>) indicates that imprecise cell type proportions would impact reference panel estimation negatively. Our method ISLET still achieves the lowest NMSE on average and the smallest variation in each simulation scenario, compared with other methods. These results, overall, highlight both the unfavorable impact of imprecise proportions to reference panel estimation, and the merits of our modeling approach compared to others. Furthermore, our method still outperforms TOAST if the TOAST deconvolution is performed on each subject’s repeated samples, individually.</p>
    </sec>
    <sec id="Sec8">
      <title>Improved csDEG identification</title>
      <p id="Par16">With the improved reference estimation demonstrated above, we further investigated ISLET performance in cell-type-specific differentially expressed genes (csDEG) identification by using the model in Equation (<xref rid="Equ1" ref-type="disp-formula">1</xref>). We compared ISLET with five methods, i.e., CARseq, TOAST, TCA, DESeq2, and csSAM. All the competing methods used the true cell type proportions along with bulk gene expression values as input. The csDE analysis in DESeq2 can be performed by testing the coefficients for interaction terms of each cell type and group.</p>
      <p id="Par17">The result is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> and benchmarked by metrics of true discovery rate (TDR), receiver operating characteristic (ROC), and sensitivity and false discovery rate (FDR). Here, the TDR is defined as the proportion of true csDEG, among the top-ranking identified genes for each method. TDR is equivalent to precision and reflects a practical consideration: biologists may focus on the top-ranking significant csDEG output given a certain method; thus, the accuracy among them matters the most for biomarker discovery. Figure <xref rid="Fig3" ref-type="fig">3</xref>A shows the averaged results for 20 replicates, among all six methods, for the sample size of <inline-formula id="IEq43"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=25$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq43.gif"/></alternatives></inline-formula> subjects per group at one cell type. ISLET shows the highest precision among top-ranking genes in TDR and the largest AUC in ROC. We also examined the distributions of sensitivity and FDR, for each method, among all cell types. The third panel of Fig. <xref rid="Fig3" ref-type="fig">3</xref>A shows joint distribution of sensitivity and FDR, given the intended FDR level 0.1. Apparently, ISLET yields the highest sensitivity and reasonably controlled FDR. TCA can outperform ISLET in terms of sensitivity only in very few datasets, but its seriously inflated FDR is a concern. DESeq2 also resulted in poor FDR, due to its inflated type I error for empirical Bayes approach under large sample sizes [<xref ref-type="bibr" rid="CR25">25</xref>]. The sensitivity plot in the fourth column of Fig. <xref rid="Fig3" ref-type="fig">3</xref>A demonstrates that ISLET is the most powerful method for various LFC with <inline-formula id="IEq44"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=25$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq44.gif"/></alternatives></inline-formula> subjects per group. All the competing methods show increased sensitivity at larger LFC.<fig id="Fig3"><label>Fig. 3</label><caption><p>ISLET improves testing accuracy in cell-type-specific differentially expressed genes (csDEG) identification. <bold>A</bold> True discovery rate (TDR), receiver operating characteristic (ROC), sensitivity versus false discovery rate (FDR), and sensitivities at various effect sizes are shown from left to right. Results for one cell type, at sample size of <italic>N </italic>= 25 subjects per group with log fold change (LFC) = 0.5, are shown for the first three panels. Intended FDR level of 0.1 (vertical line) in the third panel. The fourth panel shows the averaged sensitivity across all cell types, at various LFCs. Benchmarked methods include CARseq, TOAST, TCA, DESeq2, and csSAM. <bold>B</bold> Displaying the same metrics as in <bold>A</bold> except sample size per group is <italic>N </italic>= 75. <bold>C</bold> Averaged AUC values across all cell types, at various combinations of sample sizes and LFCs. <inline-formula id="IEq45"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=20$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq45.gif"/></alternatives></inline-formula> simulations are conducted for each simulation scenario described above</p></caption><graphic xlink:href="13059_2023_3014_Fig3_HTML" id="MO5"/></fig></p>
      <p id="Par18">Simulations at a larger sample size of <inline-formula id="IEq46"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=75$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>75</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq46.gif"/></alternatives></inline-formula> per group show a similar conclusion as the above, in terms of the same metrics (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). In addition, similar conclusions can be drawn from an exhaustive combination of sample size and LFC, broken down by cell type (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figs. S8-S20). The simulation results implied that the performance of each method is affected by the cell type proportions, i.e., better performance in higher-abundance cell types. All methods are less powerful for the cell subpopulations at lower frequencies (<inline-formula id="IEq47"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;10\%$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq47.gif"/></alternatives></inline-formula>), and thus the performances are often similar.</p>
      <p id="Par19">Figure <xref rid="Fig3" ref-type="fig">3</xref>C shows the heatmap of average AUC, combining all cell types, at different sample size and LFC. This shows the aggregated performance across all cell types in a synthetic replicate, whereas two out of the six cell types do not have any csDEG. Here, ISLET still achieves the highest AUC, at all scenarios. TOAST and TCA’s rankings follow immediately after ISLET, in most cases. Overall, in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, ISLET demonstrates considerably improved and consistent csDEG detection performance, with the help of improved reference panel recovery.</p>
      <p id="Par20">We also performed simulations to compare the impact of modeling versus the impact of imprecise proportions on csDE testing power. Results are compiled in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figs. S21-S22, with sample size at <inline-formula id="IEq48"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=25, 50, 75, 100$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>75</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq48.gif"/></alternatives></inline-formula> participants per group. Using estimated proportions would negatively impact all methods, but the order of methods would retain. TDR and ROC curves show the advantage of using ISLET compared with other methods, within either the true or estimated proportions. It is worth noting that ISLET with deconvoluted proportions could outperform other methods with true proportions, at certain top-gene cutoff and towards the tail of ROC curves, despite ISLET maintains a comparable performance in FDR. The impact of imprecise cellular composition on FDR is profound for each compared method. Furthermore, we compare ISLET and DESeq2 at small sample size with <inline-formula id="IEq49"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=5$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq49.gif"/></alternatives></inline-formula> subjects per group. The results in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figs. S23-S24 show that in a longitudinal study with small sample size, our model still yields higher sensitivity in csDEG calling than the methods borrowing information across genes, such as DESeq2.</p>
      <p id="Par21">In the meantime, we illustrate the performance of slope test based on the framework in Equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) by generating synthetic gene expression with differential slope. The simulation design for this scenario is similar to the above, as described in the “<xref rid="Sec14" ref-type="sec">Methods”</xref>. In Additional file <xref rid="MOESM3" ref-type="media">3</xref>, Figs. S25-S28 show the false positive rate (FPR) and sensitivity of ISLET slope test at different LFC and sample size, while the FDR for all cell types is shown in Figs. S<xref rid="MOESM3" ref-type="media">29</xref>. Briefly, ISLET slope test is powerful in detecting cell-type-specific differential change-rate, with robust type I error in each synthetic data and controlled FDR at larger LFC, sample size. This csDEG slope test is not available in the other tools.</p>
    </sec>
    <sec id="Sec9">
      <title>Type I error under the null</title>
      <p id="Par22">We next evaluated these methods in terms of the validity of their <italic>p</italic>-values under the null distribution, where none of the genes are csDEG. Here, under the null hypothesis, the <italic>p</italic>-value distribution should be uniformly distributed between 0 and 1. Our results showed that, among the six methods, TOAST provided the best-calibrated <italic>p</italic>-values for type I error control, immediately followed by ISLET. TCA and csSAM suffered from conservative issues, evident by the inflated density near <italic>p</italic>-values close to 1 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). Conclusions were jointly supported by the histogram of <italic>p</italic>-value and by the Kolmogorov-Smirnov (KS) test, which evaluated goodness of fit for <italic>p</italic>-values distributed uniformly. Since the small <italic>p</italic>-values are essential in csDEG calling, we also show the quantile-quantile plot of the <italic>p</italic>-values on -log10 scale for a zoomed-in examination of the small <italic>p</italic>-values (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). CARseq and TOAST have the best-calibrated small <italic>p</italic>-values. ISLET and TCA have roughly calibrated distribution. In contrast, the <italic>p</italic>-values of csSAM and DESeq2 deviate from the expected distribution.<fig id="Fig4"><label>Fig. 4</label><caption><p>Simulation studies for type I error control under the null. <bold>A</bold> Histograms of the observed <italic>p</italic>-values under the null, when no gene is csDEG. The <italic>p</italic>-values shown above histograms are from the Kolmogorov-Smirnov (KS) test under the null hypothesis, for which the contrasted distribution is Uniform [0, 1]. The larger the <italic>p</italic>-value, the more uniform the distribution is. <bold>B</bold> Quantile-quantile plots of the same <italic>p</italic>-values as in <bold>A</bold> but on the <inline-formula id="IEq50"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\log _{10}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq50.gif"/></alternatives></inline-formula> scale. Methods return well-calibrated small <italic>p</italic>-values will stay close to the red diagonal line. <inline-formula id="IEq51"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=20$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq51.gif"/></alternatives></inline-formula> simulations are conducted each setting</p></caption><graphic xlink:href="13059_2023_3014_Fig4_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Application in TEDDY longitudinal bulk transcriptomes</title>
      <p id="Par23">An overview of TEDDY cohort and whole blood bulk RNA-seq data is available in Additional file <xref rid="MOESM4" ref-type="media">4</xref>. To apply the competing methods to TEDDY longitudinal bulk RNA-seq data, we selected the participants with IAbs onset between the age of 21 and 27 months and their matched controls. The whole blood samples used in this analysis were collected every 3 months from 9-month age until the first positively-confirmed IAbs onset in the cases (i.e., endpoint), exclusive of the endpoint. Hence, each matched case-control pair had bulk RNA-seq transcriptomes longitudinally profiled at the same age prior to IA seroconversion. Genes with TPM-normalized mean expression less than 1 were removed in downstream analysis. Next, we selected <inline-formula id="IEq52"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G=2000$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mn>2000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq52.gif"/></alternatives></inline-formula> genes with top coefficient variation and <inline-formula id="IEq53"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;20\%$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq53.gif"/></alternatives></inline-formula> zero counts to perform csDE analysis by each method as illustration. The tools csSAM, CARSeq, TOAST, and DESeq2 were only applicable in the (mean) test described by Eq. (<xref rid="Equ1" ref-type="disp-formula">1</xref>), while ISLET was capable of detecting csDEG in both mean and change-rate.</p>
      <p id="Par24">We used BH procedure to control FDR in multiple testing, and then reported csDEG at FDR<inline-formula id="IEq54"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.1$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq54.gif"/></alternatives></inline-formula> in each method. ISLET and TOAST detected DEGs in either B cell or NK cell by the mean test without age-dependent effect. This result was consistent with the findings in [<xref ref-type="bibr" rid="CR14">14</xref>], i.e., IA-signatures were strongly enriched in B cell and NK cell transcripts, kinases, and transcription factors. For each method, the csDEGs identified in multiple cell populations are shown in Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figs. S30-S34. TCA detected a large number of csDEGs overlapped between different cell types, which may be a result of the inflated false positive rate of TCA. On the other hand, the csDEG called by ISLET or TOAST were not severely overlapped between cell subpopulations, similar to our simulation design. TOAST and DESeq2 identified csDEG partially overlapping with the above ISLET-identified signatures (Figs. S<xref rid="MOESM4" ref-type="media">35</xref>-S<xref rid="MOESM4" ref-type="media">36</xref>). For each immune cell type, we performed Gene Sets Enrichment Analysis (GSEA) across 45 candidate REACTOME pathways with size of at least 20 genes, using the rank of test statistics in each method and Bioconductor package fgsea [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. The significantly enriched pathways were selected by <italic>q</italic>-value<inline-formula id="IEq55"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.1$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq55.gif"/></alternatives></inline-formula> or <italic>p</italic>-value<inline-formula id="IEq56"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.001$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq56.gif"/></alternatives></inline-formula> and shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>A. Specifically, ISLET mean test identified potential signature genes differentially expressed in IA cases within NK cells prior to the onset of IAbs. The slope test implemented in ISLET detected the latent differential dynamics in CD4<inline-formula id="IEq57"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^+$$\end{document}</tex-math><mml:math id="M118"><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq57.gif"/></alternatives></inline-formula> T cell (<italic>IGLV1-40</italic>) and NK-cell (<italic>RETN</italic>) preceding IAbs onset, although the relation of CD4<inline-formula id="IEq58"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^+$$\end{document}</tex-math><mml:math id="M120"><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq58.gif"/></alternatives></inline-formula> T cell with IA or T1D was not profound in TEDDY microarray data [<xref ref-type="bibr" rid="CR14">14</xref>]. These genes showed difference in the change-rate of mixture-cell gene expression (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B).<fig id="Fig5"><label>Fig. 5</label><caption><p>Application of ISLET in TEDDY bulk RNA-seq data. <bold>A</bold> Heatmap of <italic>p</italic>-values for pathway enrichment analysis on csDE results from ISLET, DESeq2, and TOAST. <bold>B</bold> Dynamics of csDEG identified by ISLET slope test</p></caption><graphic xlink:href="13059_2023_3014_Fig5_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>Application in PDBP longitudinal bulk transcriptomes</title>
      <p id="Par25">We obtained another longitudinal bulk transcriptome dataset from the Parkinson’s Disease Biomarker Program (PDBP, <ext-link ext-link-type="uri" xlink:href="https://amp-pd.org/">https://amp-pd.org/</ext-link>), which is a part of the Accelerating Medicines Partnership (AMP) Parkinson’s Disease program. This dataset include both Parkinson’s Disease (PD) cases and healthy controls, with repeated measures at baseline, 6, 12, 18, and 24 months. In our analysis, study participants with at least two follow-up visits, besides baseline, were selected. A total of 572 participants (399 PD cases and 173 controls) with 2599 longitudinal blood samples within the two years were included. RNA samples were extracted from whole blood and sequenced. Transcripts per million (TPM) was adopted to represent the gene expression level. We adopted CIBERSORT for deconvolution for cell type proportions. Longitudinal transcriptome data, retrieved cell type proportions, and PD status served as the inputs for ISLET, TOAST, and DESeq2. Same FDR control procedures were adopted as in the first real data analysis.</p>
      <p id="Par26">As shown in Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Section 2, ISLET detected 12 and 6 csDEGs in CD8+ T cells and NK cells, respectively, in the mean test comparing PD and controls. A PD-linked mutation marker <italic>DNAJC6</italic> [<xref ref-type="bibr" rid="CR27">27</xref>] was called by ISLET as DEG in CD8+ T cells, which was not detected by TOAST or DESeq2. This mutation was also found associated with neurodegeneration in human brain [<xref ref-type="bibr" rid="CR28">28</xref>]. In addition, the pathway analysis based on ISLET result indicates that the combined csDEGs is enriched in response of EIF2AK4 translation regulation, which is one of the main features of transcriptome profiles in PD [<xref ref-type="bibr" rid="CR29">29</xref>] and a known pathological alterations in PD and other non-communicable diseases [<xref ref-type="bibr" rid="CR30">30</xref>]. TOAST called <italic>HLA-DQB2</italic> as DEG in CD8+ T cells, which was found being associated with PD [<xref ref-type="bibr" rid="CR31">31</xref>]. DESeq2 also detected several genes such as <italic>CCNA2</italic> that had been reported to be associated with PD [<xref ref-type="bibr" rid="CR32">32</xref>], but these genes were called in multiple cell types by DESeq2 with potential concern of being false positive.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Discussion</title>
    <p id="Par27">We implemented our model and algorithm in Bioconductor package ISLET to recover reference panel and perform csDEG test. The algorithm implemented in ISLET has several advantages. First, the individual-specific random effect in the reference panel represents the shared information between repeated samples collected from the same participant. This framework also allows the heterogeneity between repeated samples by incorporating age-dependent effect. Second, ISLET does not require the input of single cell gene expression data from a pilot experiment, which is an essential component in some other csDE analysis tools such as PRISM [<xref ref-type="bibr" rid="CR13">13</xref>]. In addition, the statistical model used in ISLET can be applied to normalized or re-scaled gene expression and the other types of omics data (e.g., microarray gene expression and DNA methylation), because of the Gaussian density employed in EM algorithm. In contrast, the other csDE analysis tools such as CARSeq, PRISM, and DESeq2 are only applicable to RNA-seq counts data.</p>
    <p id="Par28">A limitation in the present research is the lack of longitudinal pure cell transcriptomes from PBMC samples. The temporal cell-type-specific marker genes for IA in the TEDDY cohort cannot be validated in the current bulk RNA-seq data. To benchmark the estimated individual-specific and cell-type-specific gene expression, it is necessary to design an experiment with sorted cells and then compare with the individual reference panel predicted by ISLET. Based on the individual reference profile deconvolved by ISLET, cell type composition can be re-estimated by applying CIBERSORT or the non-negative least square (NNLS) method to the observed longitudinal bulk gene expression and predicted reference panel per subject. This is similar to the option of recalculating cell type proportions in TCA, although TCA constructs the reference panel for each sample. Our future work should iteratively update the cell type proportion estimate and cell-type-specific reference panel.</p>
    <p id="Par29">The current version of ISLET did not incorporate any non-negative restriction in parameter estimation, although the output individual reference panel was truncated at zero and ISLET showed superior performance in reference panel estimation. The parameter estimate in ISLET should be improved by adopting either a restricted EM algorithm with non-negative restrictions [<xref ref-type="bibr" rid="CR33">33</xref>] or penalized least square regression [<xref ref-type="bibr" rid="CR34">34</xref>]. Another improvement in future research is to estimate the cell type proportions and individual-specific gene expression matrix simultaneously. The concurrent deconvolution of longitudinal cell type proportions and individual-specific reference panels may require a complex framework, but this will also reduce the bias in estimated cellular composition and improves the deconvolved individual reference profiles.</p>
  </sec>
  <sec id="Sec13">
    <title>Conclusion</title>
    <p id="Par30">ISLET is a robust and powerful tool for cell-type-specific gene expression recovery and longitudinal differential analysis in bulk RNA-seq data. This framework globally improved the detection of cell-type-specific latent gene signatures.</p>
  </sec>
  <sec id="Sec14">
    <title>Methods</title>
    <sec id="Sec15">
      <title>Overview</title>
      <p id="Par31">Our present work excluded the genes with low expression (mean TPM <inline-formula id="IEq59"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;1$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq59.gif"/></alternatives></inline-formula>) or excess zero counts (in <inline-formula id="IEq60"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;20\%$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq60.gif"/></alternatives></inline-formula> samples) in the real data. The gene-wise overdispersion is a key parameter in the statistical modeling for RNA-seq data, which may vary between solid tissues and whole blood samples. Hence, we used the raw and TPM-normalized counts, individually, to assess the overdispersion pattern in the whole blood bulk RNA-seq data in TEDDY. The scatter plot in Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Fig. S39 illustrated that the mean-variance relation in the filtered genes in TEDDY data is similar to that of Poisson or Log-Normal distribution, both can be approximated by Gaussian. In addition, a general Gaussian assumption is favorable in the analysis of other omics data such as DNA methylation and is computationally efficient because of the explicit form of EM estimator. Therefore, we adopted Gaussian density function and the EM algorithm to estimate the group effect and individual-specific random effect.</p>
    </sec>
    <sec id="Sec16">
      <title>Cell-type-specific and individual-specific random effects</title>
      <p id="Par32">To justify our assumption about individual-specific reference matrix and the random effect terms, we employed scRNA-seq and bulk RNA-seq data profiled from blood samples to illustrate the heterogeneity between subjects at cellular level. We first used scRNA-seq PBMC data in [<xref ref-type="bibr" rid="CR35">35</xref>] to evaluate the inter-subject heterogeneity of cell-type-specific gene expression. The scRNA-seq PBMC raw counts was converted to cell-type-specific counts and normalized by TPM. Genes with mean TPM <inline-formula id="IEq61"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;1$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq61.gif"/></alternatives></inline-formula> were removed. To reduce the potential covariate effect (e.g., disease status) on gene expression, we used control samples in the following analyses. We first employed a chi-squared statistic to confirm that a large proportion of genes in B cells (78%) and CD4+ T cells (62%) had standard deviation greater than half of the empirical mean. Statistical significance of this chi-squared test was determined by FDR <inline-formula id="IEq62"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.1$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq62.gif"/></alternatives></inline-formula>. In addition, to evaluate the improvement in goodness-of-fit brought by random effects, we compared the gene-wise Akaike information criterion (AIC) of the generalized linear mixed effect model (GLMM) and generalized linear model (GLM), using a paired <italic>t</italic> test and 1000 most variable genes in TEDDY and PDBP bulk transcriptomic data. We adopted the normal distribution in GLMM and GLM to reduce the impact of density function on AIC. The results showed that GLMM yielded lower AIC than GLM (p<inline-formula id="IEq63"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.0001$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq63.gif"/></alternatives></inline-formula>) in TEDDY and PDBP data, while the estimated random effect variance is non-zero for at least 60% and 50% genes per cell type in TEDDY and PDBP data, respectively.</p>
      <p id="Par33">We further applied the function <italic>estimateDisp</italic> in Bioconductor package edgeR to assess intra- and inter-subject heterogeneity in the same scRNA-seq data [<xref ref-type="bibr" rid="CR35">35</xref>]. The intra-subject overdispersion was estimated based on the longitudinal samples per subject, while the inter-subject overdispersion was evaluated based on the samples at a fixed time point for all subjects. Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figs. S43-S44 show the gene-wise overdispersion between and within subjects by cell type, whereas the inter-subject heterogeneity is significantly larger than intra-subject heterogeneity (Wilcoxon signed rank test <italic>p </italic><inline-formula id="IEq64"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.0001$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq64.gif"/></alternatives></inline-formula>). We also evaluated the common overdispersion shared by genes across all time points and at a single time point, individually. The common overdispersion between subjects at a fixed time point was 2.88 for B cells and 1.77 for CD4+ T cells, being close to that of all longitudinal samples, i.e., 3.32 for B cells and 1.92 for CD4+ T cells. Therefore, our current model focuses on the inter-subject variation.</p>
    </sec>
    <sec id="Sec17">
      <title>Mixed-effect regression framework</title>
      <p id="Par34">We use the same model for each gene and implement our algorithm by parallel computing; therefore, we drop the gene index in model description below. Suppose the subject is indexed by <italic>j</italic>, where <inline-formula id="IEq65"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j = 1,2,...,J$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq65.gif"/></alternatives></inline-formula>. For each subject <italic>j</italic>, there are <inline-formula id="IEq66"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_j$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq66.gif"/></alternatives></inline-formula> longitudinal observations. We use <inline-formula id="IEq67"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{jt}$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq67.gif"/></alternatives></inline-formula> to represent the observed gene expression for subject <italic>j</italic> at time-point <italic>t</italic>. The dependent variable vector is thus <inline-formula id="IEq68"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq68.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq69"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}= (y_{11}, y_{12}, \cdots , y_{1T_1}, \cdots , y_{J1}, y_{J2}, \cdots , y_{JT_J})^\prime$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq69.gif"/></alternatives></inline-formula>, with length <inline-formula id="IEq70"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=\sum _{j=1}^J T_j$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq70.gif"/></alternatives></inline-formula>. It contains the gene expression values across <italic>J</italic> subjects’ longitudinal observations.</p>
      <p id="Par35">Meanwhile, we also have other inputs that can be treated as known. These include the number of cell types <italic>K</italic>, and the cell type proportions <inline-formula id="IEq71"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{jT_j k}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq71.gif"/></alternatives></inline-formula> for each subject, each sample, and each cell type. Naturally, <inline-formula id="IEq72"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{jT_j k} \in (0,1)$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq72.gif"/></alternatives></inline-formula> and <inline-formula id="IEq73"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{k=1}^K \theta _{jT_j k} = 1$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq73.gif"/></alternatives></inline-formula>. Additionally, we use a binary scalar <inline-formula id="IEq74"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_j$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq74.gif"/></alternatives></inline-formula> to indicate the subject’s disease status: (e.g., disease = 1 vs. normal = 0). We then have this following mixed-effect regression model:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varvec{y} = \varvec{X\beta } + \varvec{Au}+\varvec{\varepsilon } \end{aligned}$$\end{document}</tex-math><mml:math id="M154" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Au</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq75"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\varepsilon } \sim N(\textbf{0},\sigma _0^2 \varvec{I})$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq75.gif"/></alternatives></inline-formula> are the residuals. Here, <inline-formula id="IEq76"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{X}$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{A}$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq77.gif"/></alternatives></inline-formula> are the design matrices for the fixed-effect <inline-formula id="IEq78"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq78.gif"/></alternatives></inline-formula> and random-effect <inline-formula id="IEq79"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq79.gif"/></alternatives></inline-formula>, respectively, where <inline-formula id="IEq80"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta } = (m_1, m_2, \cdots , m_K, \beta _1, \beta _2,$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq80.gif"/></alternatives></inline-formula>
<inline-formula id="IEq81"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdots , \beta _K)^\prime$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq81.gif"/></alternatives></inline-formula> has two components: <inline-formula id="IEq82"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(m_1, m_2, \cdots , m_K)$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq82.gif"/></alternatives></inline-formula> are the baseline average gene expression in the control group, and <inline-formula id="IEq83"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\beta _1, \beta _2, \cdots , \beta _K)$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq83.gif"/></alternatives></inline-formula> are the difference between the case group and the control group. The random effect <inline-formula id="IEq84"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}= (u_{11}, u_{21}, \cdots , u_{J1}, u_{12}, u_{22},$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>21</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>22</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq84.gif"/></alternatives></inline-formula>
<inline-formula id="IEq85"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdots ,u_{J2}, \cdots , u_{1K}, u_{2K}, \cdots , u_{JK})^\prime$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">JK</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq85.gif"/></alternatives></inline-formula> captures the individual-level gene expression deviance from the group-level mean, for each cell type. The design matrices <inline-formula id="IEq86"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{X}$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq86.gif"/></alternatives></inline-formula> and <inline-formula id="IEq87"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{A}$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq87.gif"/></alternatives></inline-formula> are in the form:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varvec{X} = \left( \begin{array}{cccccccc} \theta _{111} &amp;{} \theta _{112}&amp;{} ... &amp;{} \theta _{11K} &amp;{} z_1\theta _{111} &amp;{} z_1\theta _{112} &amp;{} ... &amp;{} z_1\theta _{11K} \\ \theta _{121} &amp;{} \theta _{122} &amp;{} ... &amp;{} \theta _{12K}&amp;{} z_1\theta _{121} &amp;{} z_1\theta _{122} &amp;{} ... &amp;{} z_1\theta _{12K}\\ ... &amp;{} ... &amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...\\ \theta _{1T_11} &amp;{} \theta _{1T_12} &amp;{} ... &amp;{} \theta _{1T_1K}&amp;{} z_1\theta _{1T_11} &amp;{} z_1\theta _{1T_12} &amp;{} ... &amp;{} z_1\theta _{1T_1K} \\ ... &amp;{} ... &amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...\\ \theta _{J11} &amp;{} \theta _{J12}&amp;{} ... &amp;{} \theta _{J1K} &amp;{} z_J\theta _{J11} &amp;{} z_J\theta _{J12} &amp;{} ... &amp;{} z_J\theta _{J1K} \\ \theta _{J21} &amp;{} \theta _{J22}&amp;{} ... &amp;{} \theta _{J2K} &amp;{} z_J\theta _{J21} &amp;{} z_J\theta _{J22} &amp;{} ... &amp;{} z_J\theta _{J2K} \\ ... &amp;{} ... &amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...\\ \theta _{JT_{J}1} &amp;{} \theta _{JT_{J}2}&amp;{} ... &amp;{} \theta _{JT_{J}K} &amp;{} z_J\theta _{JT_{J}1} &amp;{} z_J\theta _{JT_{J}2} &amp;{} ... &amp;{} z_J\theta _{JT_{J}K} \end{array}\right) _{N\times 2K} \end{aligned}$$\end{document}</tex-math><mml:math id="M182" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mn>112</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>11</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>112</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>11</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mn>121</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mn>122</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>121</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>122</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varvec{A} = \left( \begin{array}{ccccccccc} \textbf{a}_{11 }&amp;{}0 &amp;{}0 &amp;{} 0&amp;{} ... &amp;{} \textbf{a}_{1K} &amp;{}0 &amp;{} 0&amp;{}0\\ 0 &amp;{} \textbf{a}_{21} &amp;{} 0 &amp;{} 0 &amp;{}...&amp;{} 0 &amp;{} \textbf{a}_{2K} &amp;{} 0 &amp;{} 0 \\ 0 &amp;{} 0 &amp;{} \ddots &amp;{} 0&amp;{} ...&amp;{}0 &amp;{} 0 &amp;{}\ddots &amp;{} 0 \\ 0 &amp;{} 0 &amp;{} 0 &amp;{}\textbf{a}_{J1}&amp;{}...&amp;{} 0&amp;{} 0 &amp;{} 0 &amp;{} \textbf{a}_{JK} \end{array}\right) _{N\times Q} \end{aligned}$$\end{document}</tex-math><mml:math id="M184" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋱</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋱</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mrow><mml:mi mathvariant="italic">JK</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq88"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textbf{a}_{jk}{:=} ( \theta _{j_1k}, \theta _{j_2k}, \cdots , \theta _{jT_jk} )^\prime$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq88.gif"/></alternatives></inline-formula> is simply a reorganized vector of cell type proportions, to align with random effect <inline-formula id="IEq89"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq89.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec18">
      <title>Parameters estimation by expectation-maximization algorithm</title>
      <p id="Par36">The parameter estimation for the Equation (<xref rid="Equ3" ref-type="disp-formula">3</xref>) can be achieved by an expectation-maximization (EM) algorithm, although other viable approaches exist. Here, to facilitate the setup of the EM algorithm, we first define the “observed” and the “missing” data: <inline-formula id="IEq90"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}=(\varvec{y, u}):= (\varvec{w}_{obs},\varvec{w}_{mis})$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mis</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq90.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq91"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}_{obs}:=\varvec{y}$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq91.gif"/></alternatives></inline-formula> is the observed data of admixed gene expression, and <inline-formula id="IEq92"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}_{mis}:=\varvec{u}$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mis</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq92.gif"/></alternatives></inline-formula> is the missing data of individual-level deviance from the group mean. Then, we have the conditional distribution <inline-formula id="IEq93"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}_{obs}|\varvec{w}_{mis} = \varvec{y}|\varvec{u} \sim N( \varvec{X\beta } + \varvec{Au}, \sigma _0^2 \varvec{I})$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mis</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Au</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq93.gif"/></alternatives></inline-formula> and marginal distribution <inline-formula id="IEq94"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}_{mis}=\varvec{u} \sim N(\varvec{0},\varvec{\Sigma }_u)$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mis</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq94.gif"/></alternatives></inline-formula>. Here, <inline-formula id="IEq95"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma }_u$$\end{document}</tex-math><mml:math id="M200"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq95.gif"/></alternatives></inline-formula> is a block-diagonal matrix <inline-formula id="IEq96"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma }_u=diag(\sigma _{1}^2 \varvec{I}_J, \sigma _{2}^2\varvec{I}_J, \cdots , \sigma _{K}^2\varvec{I}_J)$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mi>J</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mi>J</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mi>J</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq96.gif"/></alternatives></inline-formula>. By calculating the variance-covariance matrix of <inline-formula id="IEq97"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}_{mis}$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mis</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq97.gif"/></alternatives></inline-formula> and <inline-formula id="IEq98"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}_{obs}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq98.gif"/></alternatives></inline-formula>, we have the following multivariate normal distribution:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left( \begin{array}{c} \varvec{w}_{obs} \\ \varvec{w}_{mis} \end{array}\right) = N\Biggr [\left( \begin{array}{c} \varvec{X\beta } \\ \varvec{0} \end{array}\right) ,\left( \begin{array}{cc} \varvec{A\Sigma }_u\varvec{A}^\prime +\sigma _0^2 \varvec{I} &amp;{} \varvec{A\Sigma }_u \\ \varvec{\Sigma }_{u}^\prime \varvec{A}^\prime &amp;{} \varvec{\Sigma }_u \end{array}\right) \Biggr ] \end{aligned}$$\end{document}</tex-math><mml:math id="M208" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mis</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par37">The EM algorithm calculation will then follow naturally.</p>
      <p id="Par38">E-step:<disp-formula id="Equ9"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E[\varvec{u}|\varvec{w}_{obs}=\varvec{y}]=\varvec{\Sigma }_{u}\varvec{A}^\prime \varvec{V}^{-1}(\varvec{y}-\varvec{X\beta }) \end{aligned}$$\end{document}</tex-math><mml:math id="M210" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ10"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E\bigr [\varvec{s}^\prime \varvec{s}|\varvec{w}_{obs}=\varvec{y}\bigr ]=tr(\varvec{A\Sigma }_p\varvec{A}^\prime ) + (\varvec{A\mu }_p+\varvec{X\beta }-\varvec{y})^\prime (\varvec{A\mu }_p+\varvec{X\beta }-\varvec{y}) \end{aligned}$$\end{document}</tex-math><mml:math id="M212" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">[</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ11"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E\bigr [\varvec{u}_k^\prime \varvec{u}_k|\varvec{w}_{obs}=\varvec{y}\bigr ]=tr(\varvec{\Sigma }_{p_k})+\varvec{\mu }_{p_k}^\prime \varvec{\mu }_{p_k} \end{aligned}$$\end{document}</tex-math><mml:math id="M214" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">[</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">Here, <inline-formula id="IEq99"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{s}=\varvec{Au}+\varvec{X\beta }-\varvec{y}$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Au</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq99.gif"/></alternatives></inline-formula>, <inline-formula id="IEq100"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{V} := \varvec{A\Sigma }_u\varvec{A}^\prime +\sigma _0^2 \varvec{I}$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq100.gif"/></alternatives></inline-formula>, <inline-formula id="IEq101"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma }_{p_k}$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq101.gif"/></alternatives></inline-formula> is the <italic>k</italic>th diagonal block of matrix <inline-formula id="IEq102"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma }_{p}$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq102.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq103"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\mu }_{p_k}$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq103.gif"/></alternatives></inline-formula> is the <italic>k</italic>th sub-vector in <inline-formula id="IEq104"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\mu }_{p}$$\end{document}</tex-math><mml:math id="M226"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq104.gif"/></alternatives></inline-formula>.</p>
      <p id="Par40">M-step:</p>
      <p id="Par41">For the <inline-formula id="IEq105"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(t+1)^{th}$$\end{document}</tex-math><mml:math id="M228"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq105.gif"/></alternatives></inline-formula> iteration given the <inline-formula id="IEq106"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t^{th}$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq106.gif"/></alternatives></inline-formula> iteration:<disp-formula id="Equ12"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hat{\varvec{\beta }}^{(t+1)}=(\varvec{X}^\prime \varvec{X})^{-1}\varvec{X}^\prime (\varvec{y}-\varvec{A}E_{\eta ^{(t)}}(\varvec{u}^{(t)})) \end{aligned}$$\end{document}</tex-math><mml:math id="M232" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hat{\sigma }_0^{2(t+1)}=\frac{E_{\eta ^{(t)}}\bigr [\varvec{s}^\prime \varvec{s}|\varvec{w}_{obs}=\varvec{y}\bigr ]}{N} \end{aligned}$$\end{document}</tex-math><mml:math id="M234" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">[</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hat{\sigma }_k^{2(t+1)}=\frac{E_{\eta ^{(t)}}\bigr [\varvec{u}_k^\prime \varvec{u}_k|\varvec{w}_{obs}=\varvec{y}\bigr ]}{J} \end{aligned}$$\end{document}</tex-math><mml:math id="M236" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">[</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mi>J</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par42">The E-step and M-step above are repeated until convergence. The details of modeling and algorithm is available in Additional file <xref rid="MOESM5" ref-type="media">5</xref>.</p>
    </sec>
    <sec id="Sec19">
      <title>Hypothesis testing</title>
      <p id="Par43">To detect csDEG, we can test each hypothesis <inline-formula id="IEq107"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0: \beta _k=0$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq107.gif"/></alternatives></inline-formula>, individually, or jointly <inline-formula id="IEq108"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0: \beta _1=...=\beta _K=0$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq108.gif"/></alternatives></inline-formula>, by using the (observed) marginal likelihood function <inline-formula id="IEq109"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(\varvec{\beta }, \varvec{\sigma })$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq109.gif"/></alternatives></inline-formula> and the likelihood ratio test (LRT) statistic <inline-formula id="IEq110"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M244"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq110.gif"/></alternatives></inline-formula>. That is,<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L(\varvec{\beta }, \varvec{\sigma })= &amp; {} \ln f(\varvec{y}; \varvec{X}, \varvec{A}, \varvec{\beta }, \varvec{\sigma })\nonumber \\= &amp; {} -\frac{1}{2} \{N\ln (2\pi )+\ln \left| \varvec{A\Sigma }_u \varvec{A}'+\sigma ^2_0 \varvec{I}_{N}\right| \nonumber \\{} &amp; {} +(\varvec{y}-\varvec{X\beta })'(\varvec{A\Sigma }_u \varvec{A}'+\sigma ^2_0 \varvec{I}_{N})^{-1}(\varvec{y}-\varvec{X\beta })\} \end{aligned}$$\end{document}</tex-math><mml:math id="M246" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>ln</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>N</mml:mi><mml:mo>ln</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>ln</mml:mo></mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>and the test statistics:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Lambda =2(L(\hat{\varvec{\beta }},\hat{\varvec{\sigma }})-L(\tilde{\varvec{\beta }},\tilde{\varvec{\sigma }})) \end{aligned}$$\end{document}</tex-math><mml:math id="M248" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq111"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\beta }}$$\end{document}</tex-math><mml:math id="M250"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq111.gif"/></alternatives></inline-formula>, <inline-formula id="IEq112"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\sigma }}$$\end{document}</tex-math><mml:math id="M252"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq112.gif"/></alternatives></inline-formula> are the EM estimate for the full model in (<xref rid="Equ3" ref-type="disp-formula">3</xref>) and <inline-formula id="IEq113"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\varvec{\beta }}$$\end{document}</tex-math><mml:math id="M254"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq113.gif"/></alternatives></inline-formula>, <inline-formula id="IEq114"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\varvec{\sigma }}$$\end{document}</tex-math><mml:math id="M256"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq114.gif"/></alternatives></inline-formula> are the estimate for the reduced model under null hypothesis <inline-formula id="IEq115"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq115.gif"/></alternatives></inline-formula>. The test statistic follows chi-square distribution <inline-formula id="IEq116"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda \sim \chi ^2_{d}$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>∼</mml:mo><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq116.gif"/></alternatives></inline-formula>, where <italic>d</italic> is the degree of freedom determined by the number of parameters in hypothesis <inline-formula id="IEq117"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq117.gif"/></alternatives></inline-formula>. An alternative approach to test csDEG is to apply existing DE analysis methods to the predicted individual-specific gene expression, although this strategy is not ideal due to the possible bias in reference prediction.</p>
    </sec>
    <sec id="Sec20">
      <title>Data generation process in simulation study</title>
      <p id="Par44">Using the procedure described above, we acquire the Dirichlet distribution parameters for cell population composition in controls (denoted as <inline-formula id="IEq118"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\alpha }_C$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>C</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq118.gif"/></alternatives></inline-formula>) and cases (denoted as <inline-formula id="IEq119"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\alpha }_D$$\end{document}</tex-math><mml:math id="M266"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq119.gif"/></alternatives></inline-formula>), respectively: <inline-formula id="IEq120"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\alpha }_C=(8.85,6.49,5.98,5.28,4.22,3.85)$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>8.85</mml:mn><mml:mo>,</mml:mo><mml:mn>6.49</mml:mn><mml:mo>,</mml:mo><mml:mn>5.98</mml:mn><mml:mo>,</mml:mo><mml:mn>5.28</mml:mn><mml:mo>,</mml:mo><mml:mn>4.22</mml:mn><mml:mo>,</mml:mo><mml:mn>3.85</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq120.gif"/></alternatives></inline-formula> and <inline-formula id="IEq121"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\alpha }_D=(1.90,2.25,2.10,5.72,7.33,15.37)$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>D</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1.90</mml:mn><mml:mo>,</mml:mo><mml:mn>2.25</mml:mn><mml:mo>,</mml:mo><mml:mn>2.10</mml:mn><mml:mo>,</mml:mo><mml:mn>5.72</mml:mn><mml:mo>,</mml:mo><mml:mn>7.33</mml:mn><mml:mo>,</mml:mo><mml:mn>15.37</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq121.gif"/></alternatives></inline-formula>. To simulate within-group and within-subject overdispersions, two additional parameters (<inline-formula id="IEq122"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi _Z$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>Z</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq122.gif"/></alternatives></inline-formula> and <inline-formula id="IEq123"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi _S$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq123.gif"/></alternatives></inline-formula>) are introduced in the Dirichlet sampling. We first simulate the mean frequencies of <italic>K</italic> cell types for each subject <italic>j</italic> in group <italic>Z</italic> (cases or controls) by Dirichlet distribution <inline-formula id="IEq124"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\varvec{\theta }}_j\sim Dir(\bar{\varvec{\theta }}^{(0)}_{Z}, \xi _{Z})$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>Z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>Z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq124.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq125"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\varvec{\theta }}_{j}$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq125.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq126"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\times 1$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq126.gif"/></alternatives></inline-formula> vector. The parameters <inline-formula id="IEq127"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\varvec{\theta }}^{(0)}_{Z}$$\end{document}</tex-math><mml:math id="M282"><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>Z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq127.gif"/></alternatives></inline-formula> and <inline-formula id="IEq128"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi _Z$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>Z</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq128.gif"/></alternatives></inline-formula> are the expected frequencies and overdispersion for group <italic>Z</italic>. The cell type composition for subject <italic>j</italic> at time point <italic>t</italic> is <inline-formula id="IEq129"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\varvec{\theta }}_{jt}\sim Dir(\bar{\varvec{\theta }}_{j}, \xi _{p})$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq129.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq130"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi _{p}$$\end{document}</tex-math><mml:math id="M288"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq130.gif"/></alternatives></inline-formula> is the mean overdispersion estimate for the longitudinal samples per subject and represents the heterogeneity between time points.</p>
      <p id="Par45">For gene <italic>g</italic>, the mean expression and overdispersion per subject <italic>j</italic> are simulated by <inline-formula id="IEq131"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{M}_{gj}\sim MVN(\bar{\varvec{\mu }}_m,\varvec{\Sigma }_m)$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>M</mml:mi><mml:mi>V</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq131.gif"/></alternatives></inline-formula>, <inline-formula id="IEq132"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Phi }_{gj}\sim MVN(\bar{\varvec{\mu }}_{\phi },\varvec{\Sigma }_{\phi })$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>M</mml:mi><mml:mi>V</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>ϕ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>ϕ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq132.gif"/></alternatives></inline-formula>. For each cell type <italic>k</italic>, the true reference expression in subject <italic>j</italic> is generated by Gamma distribution <inline-formula id="IEq133"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{gjk}\sim \Gamma (\exp (-\Phi _{gjk}),M_{gjk}\exp (\Phi _{gjk}))$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq133.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq134"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{gjk}, \Phi _{gjk}$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq134.gif"/></alternatives></inline-formula> are components in vectors <inline-formula id="IEq135"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{M}_{gj}, \varvec{\Phi }_{gj}$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq135.gif"/></alternatives></inline-formula>. The true mixture-cell gene expression level per sample is <inline-formula id="IEq136"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\lambda }_{gjt}=\varvec{\lambda }^\prime _{gj}\bar{\varvec{\theta }}_{jt}$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq136.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq137"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda ^\prime _{gj}=(\lambda _{gj1},..., \lambda _{gjK})$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjK</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq137.gif"/></alternatives></inline-formula> and <inline-formula id="IEq138"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\lambda }_{gjt}$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq138.gif"/></alternatives></inline-formula> still follows Gamma distribution [<xref ref-type="bibr" rid="CR36">36</xref>]. The observed bulk RNA-seq raw counts for gene g in subject <italic>j</italic> measured at time point <italic>t</italic> is generated from Poisson distribution <inline-formula id="IEq139"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{gjt}\sim Pois(\bar{\lambda }_{gjt})$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq139.gif"/></alternatives></inline-formula>. In the scenario of slope test, the reference panel per subject differs between time points, with age effect fixed by (case or control) group. That is shifting <inline-formula id="IEq140"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{gjk}$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq140.gif"/></alternatives></inline-formula> to <inline-formula id="IEq141"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{M}_{gjkt}=M_{gjk}+\Delta _t$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjkt</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq141.gif"/></alternatives></inline-formula> for <inline-formula id="IEq142"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t&gt;1$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq142.gif"/></alternatives></inline-formula>, where the value of <inline-formula id="IEq143"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta _t$$\end{document}</tex-math><mml:math id="M314"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq143.gif"/></alternatives></inline-formula> is group-wise. The cell-type-specific true expression per gene per sample at each time point can be updated to <inline-formula id="IEq144"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\lambda }_{gjkt}\sim \Gamma (\exp (-\Phi _{gjk}),M_{gjkt}\exp (\Phi _{gjk}))$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjkt</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjkt</mml:mi></mml:mrow></mml:msub><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq144.gif"/></alternatives></inline-formula>, and the mixture-cell expression is <inline-formula id="IEq145"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\lambda }_{gjt}=\tilde{\varvec{\lambda }}^\prime _{gjt}\bar{\varvec{\theta }}_{jt}$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq145.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq146"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\varvec{\lambda }}^\prime _{gjt}=(\lambda _{gj1t},..., \lambda _{gjKt})$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjKt</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq146.gif"/></alternatives></inline-formula>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2023_3014_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Simulation: reference panel estimation.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2023_3014_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Simulation: csDEG test in mean.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2023_3014_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3.</bold> Simulation: ISLET slope test.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2023_3014_MOESM4_ESM.pdf">
            <caption>
              <p><bold>Additional file 4.</bold> ISLET applications in real data.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2023_3014_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5.</bold> Appendix.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13059_2023_3014_MOESM6_ESM.pdf">
            <caption>
              <p><bold>Additional file 6.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The TEDDY study is funded by the National Institute of Diabetes and Digestive and Kidney Diseases, National Institute of Allergy and Infectious Diseases, National Institute of Child Health and Human Development, National Institute of Environmental Health Sciences, Centers for Disease Control and Prevention, and JDRF. We thank the TEDDY study data coordinating center at Health Informatics Institute, University of South Florida, for data processing and sharing. The PDBP consortium is supported by the National Institute of Neurological Disorders and Stroke (NINDS) at the National Institutes of Health. A full list of PDBP investigators can be found at <ext-link ext-link-type="uri" xlink:href="https://pdbp.ninds.nih.gov/policy">https://pdbp.ninds.nih.gov/policy</ext-link>. The PDBP investigators have not participated in reviewing the data analysis or content of the manuscript. Data used in the preparation of this article were obtained from the Accelerating Medicine Partnership (AMP) Parkinson’s Disease (AMP PD) Knowledge Platform. We thank Lijun Zhang for discussions on PD-related genes and thank Wen Tang for assistance in real data processing.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par46">The review history is available as Additional file <xref rid="MOESM6" ref-type="media">6</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par47">Anahita Bishop was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>H.F. and Q.L. developed and implemented the algorithm. Z.L. contributed to the methodology discussion. H.F. conceived the experiments. H.F., G.M., T.L., Y.P., and Q.L. conducted the simulations and/or real data analysis. H.F., G.M., and Q.L. wrote the manuscript. H.P. processed TEDDY RNA-seq data and interpreted real data analysis results. J.K. supervised the TEDDY consortium. All authors reviewed the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was partially supported by the National Institutes of Health [U24DK097771 via the NIDDK Information Network’s (dkNET) New Investigator Pilot Program in Bioinformatics (PI: Q.L.) and Cancer Center Support Grant P30CA21765 to Q.L.; R03CA270725 to Z.L.], the American Cancer Society Institutional Research Grant (ACS IRG) [IRG-16-186-21 to H.F.] through Case Comprehensive Cancer Center, and the Corinne L. Dodero Foundation for the Arts and Sciences and the Case Western Reserve University (CWRU) Program for Autism Education and Research to H.F. and the American Lebanese Syrian Associated Charities (ALSAC) to Q.L.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p><inline-formula id="IEq147"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M322"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq147.gif"/></alternatives></inline-formula> ISLET is a Bioconductor package with license GPL-2 available at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/ISLET">https://bioconductor.org/packages/ISLET</ext-link> [<xref ref-type="bibr" rid="CR22">22</xref>]</p>
    <p><inline-formula id="IEq148"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M324"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq148.gif"/></alternatives></inline-formula> The TEDDY RNAseq data have been deposited in NCBI’s database of Genotypes and Phenotypes (dbGaP) with the primary accession code phs001442.v3.p2</p>
    <p><inline-formula id="IEq149"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M326"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq149.gif"/></alternatives></inline-formula> The PDBP bulk transcriptome and related clinical data are publicly available on request to AMP-PD (<ext-link ext-link-type="uri" xlink:href="https://amp-pd.org/">https://amp-pd.org/</ext-link>)</p>
    <p><inline-formula id="IEq150"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M328"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq150.gif"/></alternatives></inline-formula> Simulation based on real data: RNA-seq of human immune pure cell lines (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE60424">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE60424</ext-link>)</p>
    <p><inline-formula id="IEq151"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M330"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq151.gif"/></alternatives></inline-formula> Parameter estimation: PROPER package (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/PROPER">https://bioconductor.org/packages/PROPER</ext-link>)</p>
    <p><inline-formula id="IEq152"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M332"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq152.gif"/></alternatives></inline-formula> TOAST (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/TOAST">https://bioconductor.org/packages/TOAST</ext-link>)</p>
    <p><inline-formula id="IEq153"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M334"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq153.gif"/></alternatives></inline-formula> TCA (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/TCA">https://cran.r-project.org/web/packages/TCA</ext-link>)</p>
    <p><inline-formula id="IEq154"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M336"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq154.gif"/></alternatives></inline-formula> CARseq (<ext-link ext-link-type="uri" xlink:href="https://github.com/Sun-lab/CARseq">https://github.com/Sun-lab/CARseq</ext-link>)</p>
    <p><inline-formula id="IEq155"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M338"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq155.gif"/></alternatives></inline-formula> DESeq2 (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/DESeq2">https://bioconductor.org/packages/DESeq2</ext-link>)</p>
    <p><inline-formula id="IEq156"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M340"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq156.gif"/></alternatives></inline-formula> csSAM (<ext-link ext-link-type="uri" xlink:href="https://github.com/shenorrLab/csSAM">https://github.com/shenorrLab/csSAM</ext-link>)</p>
    <p><inline-formula id="IEq157"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M342"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq157.gif"/></alternatives></inline-formula> CIBERSORTx (<ext-link ext-link-type="uri" xlink:href="https://github.com/IOBR/IOBR">https://github.com/IOBR/IOBR</ext-link>)</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par48">Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par49">All authors have read and approved the submission of this manuscript.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par50">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Methods.</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>453</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id>
        <?supplied-pmid 25822800?>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Steen</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Chaudhuri</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Determining cell type abundance and expression from bulk tissues with digital cytometry</article-title>
        <source>Nat Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>7</issue>
        <fpage>773</fpage>
        <lpage>782</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0114-2</pub-id>
        <?supplied-pmid 31061481?>
        <pub-id pub-id-type="pmid">31061481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Severson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pignon</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Novak</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive analyses of tumor immunity: implications for cancer immunotherapy</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1028-7</pub-id>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Susztak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bulk tissue cell type deconvolution with multi-subject single-cell expression reference</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsoucas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <article-title>Accurate estimation of cell-type composition from gene expression data</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-10802-z</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Cell-type-aware analysis of RNA-seq data</article-title>
        <source>Nat Comput Sci.</source>
        <year>2021</year>
        <volume>1</volume>
        <issue>4</issue>
        <fpage>253</fpage>
        <lpage>261</lpage>
        <pub-id pub-id-type="doi">10.1038/s43588-021-00055-6</pub-id>
        <?supplied-pmid 34957416?>
        <pub-id pub-id-type="pmid">34957416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>TOAST: improving reference-free cell composition estimation by cross-cell type differential analysis</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1778-0</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Robust partial reference-free cell composition estimation from tissue expression</article-title>
        <source>Bioinformatics.</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>11</issue>
        <fpage>3431</fpage>
        <lpage>3438</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa184</pub-id>
        <?supplied-pmid 32167531?>
        <pub-id pub-id-type="pmid">32167531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rahmani</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schweiger</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rhead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Criswell</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Barcellos</surname>
            <given-names>LF</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell-type-specific resolution epigenetics without the need for cell sorting or single-cell biology</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-11052-9</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Dufort MJ, Greenbaum CJ, Speake C, Linsley PS. Cell type–specific immune phenotypes predict loss of insulin secretion in new-onset type 1 diabetes. JCI insight. 2019;4(4):e125556.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrington</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Fei</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Minnier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Carbone</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Searles</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>BA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Seq of human whole blood: Evaluation of globin RNA depletion on Ribo-Zero library method</article-title>
        <source>Sci Rep.</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-62801-6</pub-id>
        <pub-id pub-id-type="pmid">31913322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Zhang K, Erkan EP, Jamalzadeh S, Dai J, Andersson N, Kaipio K, et al. Longitudinal single-cell RNA-seq analysis reveals stress-promoted chemoresistance in metastatic ovarian cancer. Sci Adv. 2022;8(8):eabm1831.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Häkkinen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Alkodsi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Erkan</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PRISM: recovering cell-type-specific expression profiles from individual composite RNA-seq samples</article-title>
        <source>Bioinformatics.</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>18</issue>
        <fpage>2882</fpage>
        <lpage>2888</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab178</pub-id>
        <?supplied-pmid 33720334?>
        <pub-id pub-id-type="pmid">33720334</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Xhonneux LP, Knight O, Lernmark Å, Bonifacio E, Hagopian WA, Rewers MJ, et al. Transcriptional networks in at-risk individuals identify signatures of type 1 diabetes progression. Sci Transl Med. 2021;13(587):eabd5666.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bodian</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Staedtler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>NM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell type-specific gene expression differences in complex tissues</article-title>
        <source>Nat Methods.</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>4</issue>
        <fpage>287</fpage>
        <lpage>289</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1439</pub-id>
        <?supplied-pmid 20208531?>
        <pub-id pub-id-type="pmid">20208531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Dissecting differential signals in high-throughput data from complex tissues</article-title>
        <source>Bioinformatics.</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>20</issue>
        <fpage>3898</fpage>
        <lpage>3905</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz196</pub-id>
        <?supplied-pmid 30903684?>
        <pub-id pub-id-type="pmid">30903684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Pe’er</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Danko</surname>
            <given-names>CG</given-names>
          </name>
        </person-group>
        <article-title>Cell type and gene expression deconvolution with BayesPrism enables Bayesian integrative analysis across bulk and single-cell RNA sequencing in oncology</article-title>
        <source>Nat Cancer.</source>
        <year>2022</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>505</fpage>
        <lpage>517</lpage>
        <pub-id pub-id-type="doi">10.1038/s43018-022-00356-3</pub-id>
        <?supplied-pmid 35469013?>
        <pub-id pub-id-type="pmid">35469013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Ma Y, Zhou X. Spatially informed cell-type deconvolution for spatial transcriptomics. Nat Biotechnol. 2022;1–11.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rondina</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Voora</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Schwertz</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Harper</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Longitudinal RNA-Seq analysis of the repeatability of gene expression and splicing in human platelets identifies a platelet SELP splice QTL</article-title>
        <source>Circ Res.</source>
        <year>2020</year>
        <volume>126</volume>
        <issue>4</issue>
        <fpage>501</fpage>
        <lpage>516</lpage>
        <pub-id pub-id-type="doi">10.1161/CIRCRESAHA.119.315215</pub-id>
        <?supplied-pmid 31852401?>
        <pub-id pub-id-type="pmid">31852401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Foo</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Trautmann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sticht</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Treutlein</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Frank</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Streit</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Longitudinal transcriptome-wide gene expression analysis of sleep deprivation treatment shows involvement of circadian genes and immune pathways</article-title>
        <source>Transl Psychiatry.</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/s41398-019-0671-7</pub-id>
        <pub-id pub-id-type="pmid">30664621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol.</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>1</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Feng H, Li Q. ISLET: Individual-Specific ceLl typE referencing Tool. 2023. R package version 1.2.0. 10.18129/B9.bioc.ISLET.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aliee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>AutoGeneS: Automatic gene selection using multi-objective optimization for RNA-seq deconvolution</article-title>
        <source>Cell Syst.</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>7</issue>
        <fpage>706</fpage>
        <lpage>715</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2021.05.006</pub-id>
        <?supplied-pmid 34293324?>
        <pub-id pub-id-type="pmid">34293324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>PROPER: comprehensive power evaluation for differential expression using RNA-seq</article-title>
        <source>Bioinformatics.</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>2</issue>
        <fpage>233</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu640</pub-id>
        <?supplied-pmid 25273110?>
        <pub-id pub-id-type="pmid">25273110</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Exaggerated false positives by popular differential expression methods when analyzing human population samples</article-title>
        <source>Genome Biol.</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02648-4</pub-id>
        <pub-id pub-id-type="pmid">34980209</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Korotkevich G, Sukhov V, Budin N, Shpak B, Artyomov MN, Sergushichev A. Fast gene set enrichment analysis bioRxiv. 2021. 10.1101/060012.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olgiati</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Quadri</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rood</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Saute</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Chien</surname>
            <given-names>HF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNAJC6 mutations associated with early-onset Parkinson’s disease</article-title>
        <source>Ann Neurol.</source>
        <year>2016</year>
        <volume>79</volume>
        <issue>2</issue>
        <fpage>244</fpage>
        <lpage>256</lpage>
        <pub-id pub-id-type="doi">10.1002/ana.24553</pub-id>
        <?supplied-pmid 26528954?>
        <pub-id pub-id-type="pmid">26528954</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Wulansari N, Darsono WHW, Woo HJ, Chang MY, Kim J, Bae EJ, et al. Neurodevelopmental defects and neurodegenerative phenotypes in human brain organoids carrying Parkinson’s disease-linked DNAJC6 mutations. Sci Adv. 2021;7(8):eabb1540.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mutez</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nkiliza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Belarbi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>de Broucker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vanbesien-Mailliot</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bleuse</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Involvement of the immune system, endocytosis and EIF2 signaling in both genetically determined and sporadic forms of Parkinson’s disease</article-title>
        <source>Neurobiol Dis.</source>
        <year>2014</year>
        <volume>63</volume>
        <fpage>165</fpage>
        <lpage>170</lpage>
        <pub-id pub-id-type="doi">10.1016/j.nbd.2013.11.007</pub-id>
        <?supplied-pmid 24269915?>
        <pub-id pub-id-type="pmid">24269915</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Rios-Fuller TJ, Mahe M, Walters B, Abbadi D, Pérez-Baos S, Gadi A, et al. Translation regulation by eIF2<inline-formula id="IEq159"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M344"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq159.gif"/></alternatives></inline-formula> phosphorylation and mTORC1 signaling pathways in non-communicable diseases (NCDs). Int J Mol Sci. 2020;21(15):5301.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Chao</surname>
            <given-names>YX</given-names>
          </name>
          <name>
            <surname>West</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Poewe</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Jankovic</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Parkinson disease and the immune system–associations, mechanisms and therapeutics</article-title>
        <source>Nat Rev Neurol.</source>
        <year>2020</year>
        <volume>16</volume>
        <issue>6</issue>
        <fpage>303</fpage>
        <lpage>318</lpage>
        <pub-id pub-id-type="doi">10.1038/s41582-020-0344-4</pub-id>
        <?supplied-pmid 32332985?>
        <pub-id pub-id-type="pmid">32332985</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chatterjee</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bhattacharyya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bandyopadhyay</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Biological networks in Parkinson’s disease: an insight into the epigenetic mechanisms associated with this disease</article-title>
        <source>BMC Genomics.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1186/s12864-017-4098-3</pub-id>
        <pub-id pub-id-type="pmid">28049423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>The restricted EM algorithm for maximum likelihood estimation under linear restrictions on the parameters</article-title>
        <source>J Am Stat Assoc.</source>
        <year>1995</year>
        <volume>90</volume>
        <issue>430</issue>
        <fpage>708</fpage>
        <lpage>716</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1995.10476564</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Bates D, Mächler M, Bolker B, Walker S. Fitting linear mixed-effects models using lme4. J Stat Softw. 2015;67(1):1–48. 10.18637/jss.v067.i01.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Ramírez-Sánchez AD, Chu X, Modderman R, Kooy-Winkelaar Y, Koletzko S, Korponay-Szabó IR, et al. Single-cell RNA sequencing of peripheral blood mononuclear cells from pediatric coeliac disease patients suggests potential pre-seroconversion markers. Front Immunol. 2022;1038.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moschopoulos</surname>
            <given-names>PG</given-names>
          </name>
        </person-group>
        <article-title>The distribution of the sum of independent gamma random variables</article-title>
        <source>Ann Inst Stat Math.</source>
        <year>1985</year>
        <volume>37</volume>
        <issue>1</issue>
        <fpage>541</fpage>
        <lpage>544</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02481123</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10373385</article-id>
    <article-id pub-id-type="pmid">37496087</article-id>
    <article-id pub-id-type="publisher-id">3014</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-023-03014-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ISLET: individual-specific reference panel recovery improves cell-type-specific inference</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Feng</surname>
          <given-names>Hao</given-names>
        </name>
        <address>
          <email>hxf155@case.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meng</surname>
          <given-names>Guanqun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Tong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Parikh</surname>
          <given-names>Hemang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pan</surname>
          <given-names>Yue</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Ziyi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Krischer</surname>
          <given-names>Jeffrey</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9874-3555</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Qian</given-names>
        </name>
        <address>
          <email>qian.li@stjude.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.67105.35</institution-id><institution-id institution-id-type="ISNI">0000 0001 2164 3847</institution-id><institution>Department of Population and Quantitative Health Sciences, Case Western Reserve University, </institution></institution-wrap>Cleveland, OH USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.240871.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 0224 711X</institution-id><institution>Department of Biostatistics, St. Jude Children’s Research Hospital, </institution></institution-wrap>262 Danny Thomas Place, Memphis, TN 38105 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.170693.a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2353 285X</institution-id><institution>Health Informatics Institute, University of South Florida, </institution></institution-wrap>Tampa, FL 33620 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.240145.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2291 4776</institution-id><institution>Department of Biostatistics, The University of Texas MD Anderson Cancer Center, </institution></institution-wrap>Houston, TX 77030 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>174</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">We propose a statistical framework ISLET to infer individual-specific and cell-type-specific transcriptome reference panels. ISLET models the repeatedly measured bulk gene expression data, to optimize the usage of shared information within each subject. ISLET is the first available method to achieve individual-specific reference estimation in repeated samples. Using simulation studies, we show outstanding performance of ISLET in the reference estimation and downstream cell-type-specific differentially expressed genes testing. We apply ISLET to longitudinal transcriptomes profiled from blood samples in a large observational study of young children and confirm the cell-type-specific gene signatures for pancreatic islet autoantibody. ISLET is available at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/ISLET">https://bioconductor.org/packages/ISLET</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-023-03014-8.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Deconvolution</kwd>
      <kwd>Temporal measures</kwd>
      <kwd>Cell-type-specific differential expression</kwd>
      <kwd>Individual-specific reference panel</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000062</institution-id>
            <institution>National Institute of Diabetes and Digestive and Kidney Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U24DK097771</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Qian</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Cancer Institute</institution>
        </funding-source>
        <award-id>R03CA270725</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Ziyi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000048</institution-id>
            <institution>American Cancer Society</institution>
          </institution-wrap>
        </funding-source>
        <award-id>IRG-16-186-21</award-id>
        <principal-award-recipient>
          <name>
            <surname>Feng</surname>
            <given-names>Hao</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Clinical samples often contain a mixture of different cellular subpopulations. The real-world clinical RNA-seq signatures are, therefore, mosaics of signals from multiple pure cell types. As a result, the observed bulk RNA-seq data can be viewed as the weighted average of signals from multiple cell types, whereas the weights, naturally, are the proportions in the mixture. Over the last decade, researchers have gained substantial interests in computational methods to deconvolute cell population frequencies. For example, CIBERSORT [<xref ref-type="bibr" rid="CR1">1</xref>], CIBERSORTx [<xref ref-type="bibr" rid="CR2">2</xref>], TIMER [<xref ref-type="bibr" rid="CR3">3</xref>], MuSiC [<xref ref-type="bibr" rid="CR4">4</xref>], and DWLS [<xref ref-type="bibr" rid="CR5">5</xref>] were proposed to estimate cellular composition and infer cell-type-specific expression profiles. These new methods improved the resolution of traditional analytical approaches to identify bulk RNA-seq <underline>D</underline>ifferentially <underline>E</underline>xpressed <underline>G</underline>enes (DEG).</p>
    <p id="Par3">Recently, novel methods including CARSeq [<xref ref-type="bibr" rid="CR6">6</xref>], TOAST [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], and TCA [<xref ref-type="bibr" rid="CR9">9</xref>] were developed to incorporate pre-estimated cell mixture proportions in the modeling of observed bulk data and directly detect DEG at cell-type-specific resolution. This new type of DEG analysis at cell type level is generally referred to as cell-type-specific <underline>D</underline>ifferentially <underline>E</underline>xpressed <underline>G</underline>enes identification. The rapid methodological advancement in cell proportion deconvolution and csDEG calling during the recent years has offered refined tools for cell-type-aware knowledge mining. It is worth noting that although single-cell RNA-seq (scRNA-seq) or cell sorting from samples can directly measure signals from each cellular subpopulation, the costs and technical challenges in cell isolation is still a major hurdle to apply scRNA-seq in population-based study. For example, to investigate immunity-related signals in the blood samples in a multi-center cohort study, sorting peripheral blood mononuclear cells (PBMC) and profiling transcriptomes is cost prohibitive [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. Hence, bulk RNA-seq profiling is still favorable in medium- or large-scale studies.</p>
    <p id="Par4">The longitudinal or repeated sampling has become a popular strategy in clinical transcriptomic research, such as a longitudinal bulk RNA-seq study coupled with small-scale scRNA-seq profiling in high grade serous ovarian cancer [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. Another recent study [<xref ref-type="bibr" rid="CR14">14</xref>] using longitudinal whole blood bulk gene expression found that the gene markers contributing to the development of type 1 diabetes (T1D) were also related to blood immune cells. To discover the latent dynamics within each cellular subpopulation without gene network construction, one should develop a novel framework that directly identifies temporal cell-type-specific gene signatures associated with disease status.</p>
    <p id="Par5">Despite numerous methods developed for bulk data deconvolution and csDE analysis [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>], limitations exist due to the rare usage of participant indicator and lack of participant-level reference profile. Traditionally, these methods were developed under the assumption of one identical feature-by-cell type reference panel across all the samples, which were not capable of characterizing individual cell-type-specific gene expression reference. In contrast, the algorithms in recent tools TCA [<xref ref-type="bibr" rid="CR9">9</xref>] recovered the reference panel for each sample without specifying the between-subject heterogeneity [<xref ref-type="bibr" rid="CR19">19</xref>]. Another concern in these methods is the strong heterogeneity within each subject, as time-dependent variation in transcriptomes may not be profound in subgroups of participants [<xref ref-type="bibr" rid="CR20">20</xref>]. Hence, a subject-specific reference information shared by different time points is more reasonable than assuming independent reference panels across time points. To accurately detect cell-type-specific gene signatures, an individual-specific reference panel should be reconstructed for longitudinal bulk gene expression data.</p>
    <p id="Par6">Here, we present a novel computational method ISLET (Individual Specific celL typE referencing Tool), to estimate the cell-type-specific gene expression reference panel for each participant. The unobserved panel per subject are estimated by the expectation-maximization (EM) algorithm in a mixed-effect regression model. ISLET leverages multiple or temporal observations of each subject, to construct a likelihood-based statistics for csDEG inference. This is the first statistical framework to recover the subject-level reference panel by employing multiple samples per subject. Our model also provides the flexibility to incorporate group-wise change rate across time points in the reference gene expression and then identify differential dynamics in each cellular subpopulation.</p>
    <p id="Par7">We designed an extensive simulation study to compare our method ISLET with csSAM, TOAST, TCA, CARSeq, aDESeq2 [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR21">21</xref>], demonstrating ISLET being a powerful and robust tool that outperformed these competing methods. We applied ISLET to the longitudinal bulk RNA-seq data in The Environmental Determinants of Diabetes in the Young (TEDDY) cohort [<xref ref-type="bibr" rid="CR14">14</xref>] and the Parkinson’s Disease Biomarker Program (PDBP). Our method successfully identified potential gene signatures differentially expressed in B cells, natural killer (NK) cells prior to the onset of pancreatic <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M2"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq1.gif"/></alternatives></inline-formula>-cell autoantibodies, and those in CD8+ T cells, NK cells for Parkinson’s disease. ISLET is available on Bioconductor at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/ISLET">https://bioconductor.org/packages/ISLET</ext-link> [<xref ref-type="bibr" rid="CR22">22</xref>]. Overall, the improved resolution of subject-specific and cell-type-specific biomarkers, estimated by ISLET, helped to achieve more precise biomarker associations with clinical outcomes.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Deconvolution of individual reference profile and temporal csDE analysis</title>
      <p id="Par8">Our framework utilizes repeatedly measured bulk transcriptomes as input to retrieve a cell-type-specific gene expression profile for each participant (subject) and perform the csDE analysis, as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Besides the bulk transcriptomic data, it also takes cell type proportions, subject disease status, and optional covariates as the input. Note that the cell type proportions can be estimated by an existing tool (such as CIBERSORT, MuSiC, TOAST, or AutoGeneS [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]) in practice and thus is treated as a known input in our model. As an example, each subject or participant <italic>j</italic> has whole blood or PBMC samples collected at multiple time points <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=1,\dots , T_j$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq2.gif"/></alternatives></inline-formula>. The gene expression measured in participant <italic>j</italic>’s sample at time point <italic>t</italic> is <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{jt}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq3.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_j$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq4.gif"/></alternatives></inline-formula> is the indicator for each individual’s treatment group, phenotype, or case-control status. The gene expression value <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{jt}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq5.gif"/></alternatives></inline-formula> is either raw or normalized counts without batch effect and can be replaced by DNA methylation measurement if the feature is a CpG site. There are <italic>K</italic> cell types of interest in each sample, with estimated or known proportions <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{jtk}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jtk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq6.gif"/></alternatives></inline-formula>, and naturally <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{k=1}^K\theta _{jtk}=1$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jtk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq7.gif"/></alternatives></inline-formula>. Given the input cell proportions, the observed bulk gene expression <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{jt}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq8.gif"/></alternatives></inline-formula> can be described by a linear mixed effect model<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E(y_{jt}) = \sum\nolimits _{k=1}^K \left( m_{k}+ \beta _kz_j +u_{jk}\right) \theta _{jtk} \end{aligned}$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:msub><mml:mi>m</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jtk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{k}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>m</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq9.gif"/></alternatives></inline-formula> is the mean gene expression in cell type <italic>k</italic> for the baseline group (i.e., controls, <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_j=0$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq10.gif"/></alternatives></inline-formula>), and <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{k}+\beta _k$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq11.gif"/></alternatives></inline-formula> is the mean expression in cell type <italic>k</italic> for cases (<inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_j=1$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq12.gif"/></alternatives></inline-formula>). The random variable <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u_{jk}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq13.gif"/></alternatives></inline-formula>, shared by the repeated or longitudinal samples from the same subject, represents a subject-specific deviation in the group-wise mean expression in cell type <italic>k</italic>. This unobserved random term accounts for the within-subject measurements correlation. Hence, we can deconvolve the mixture-cell gene expression into <italic>K</italic> cell types for each subject, individually, by estimating the fixed and random effects (<inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{k},\beta _k,u_{jk}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq14.gif"/></alternatives></inline-formula>), as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. To detect csDEG between cases and controls, one can test the hypothesis <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0: \beta _k=0$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq15.gif"/></alternatives></inline-formula>.<fig id="Fig1"><label>Fig. 1</label><caption><p>An overview of our proposed method ISLET (Individual Specific celL typE referencing Tool). <bold>A</bold> ISLET takes repeatedly measured bulk RNA-seq data, cell type proportions (known or estimated), and disease status as the algorithm input. Additional covariates are optional. <bold>B</bold> By a hierarchical mixed-effect modeling, ISLET can iteratively retrieve individual-specific and cell-type-specific gene expression reference panels. The fixed effect is the group-level average and the random effect is the individual-level deviance from the group mean. <bold>C</bold> Given the individual-specific reference panel, ISLET can conduct test to identify cell-type-specific differentially expressed genes (csDEG)</p></caption><graphic xlink:href="13059_2023_3014_Fig1_HTML" id="MO2"/></fig></p>
      <p id="Par9">This framework can be extended by adding time-related change in the reference panels, with change rate fixed by group. For simplicity, we assume linear change rate (i.e., slope) in the present research. The model in (<xref rid="Equ1" ref-type="disp-formula">1</xref>) can be generalized as<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E(y_{jt})=\sum\nolimits_{k=1}^K \left( \tilde{m}_{k}+ \tilde{\alpha }_kc_{jt} +\tilde{\beta }_k z_j +\gamma _kc_{jt}z_j +u_{jk}\right) \theta _{jtk} \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jtk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>with <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{jt}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq16.gif"/></alternatives></inline-formula> denoting the time or sample age and <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\alpha }_k$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq17.gif"/></alternatives></inline-formula> denoting the slope in baseline group. The other potential covariates can be included in <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{jt}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq18.gif"/></alternatives></inline-formula> as a vector. The parameter <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\beta }_k$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq19.gif"/></alternatives></inline-formula> represents age-independent difference between groups in cell-type-specific gene expression. A differential slope <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _k\ne 0$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq20.gif"/></alternatives></inline-formula> implies that the cases’ gene expression change over time in cell type <italic>k</italic> is associated with the disease status <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_j$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq21.gif"/></alternatives></inline-formula>. There may be no significant group effect in the intercept (<inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\beta }_k=0$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq22.gif"/></alternatives></inline-formula>) or slope (<inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _k=0$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq23.gif"/></alternatives></inline-formula>), but the participants still have distinct underlying reference profiles (<inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u_{jk}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq24.gif"/></alternatives></inline-formula>). The csDEG in intercept or slope can be identified by testing <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0: \tilde{\beta }_k=0$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq25.gif"/></alternatives></inline-formula> or <inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0: \gamma _k=0$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq26.gif"/></alternatives></inline-formula>, respectively. Parameters estimation from the modeling above can be achieved by adopting expectation-maximization (EM) algorithm and is detailed in the “<xref rid="Sec14" ref-type="sec">Methods”</xref> section.</p>
    </sec>
    <sec id="Sec4">
      <title>Simulation study</title>
      <sec id="Sec5">
        <title>Temporal cell type proportions</title>
        <p id="Par10">The cell type proportions were generated based on real single-cell RNA-seq (scRNA-seq) datasets, from annotated and well-labeled cell types. Here, we compiled a pool of cell type labels by aggregating multiple scRNA-seq datasets cell labels and conducted bootstrap to generate cell type labels and calculate the cell type proportions, from each resampling. Those bootstrapped proportions were then fitted by the Dirichlet distribution to estimate the parameters <inline-formula id="IEq27"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M58"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq27.gif"/></alternatives></inline-formula>. Note that the number of cell types can be customized during this procedure. This enables us to simulate cell type compositions in different scenarios. For example, a study could have one dominant cell type and several minor cell types; or in contrast, a study could have relatively balanced cell type proportions with low composition variation. This procedure allows us to obtain cell type proportions that best mimic real data. Details of cell type proportion simulation are described in “<xref rid="Sec14" ref-type="sec">Methods” section</xref>.</p>
      </sec>
      <sec id="Sec6">
        <title>Individual reference panel and temporal gene expression</title>
        <p id="Par11">Cell type-specific underlying expression reference profile were also generated based on real cell line RNA-seq dataset. All parameters were derived from a real study (GSE60424) and solved by the Bioconductor package PROPER [<xref ref-type="bibr" rid="CR24">24</xref>]. This real dataset collected immune-associated diseases and pure immune cell line bulk RNA-seq data. The expression mean and biological dispersions per gene and cell type are estimated by <italic>estParam</italic> function in PROPER at log scale. This real data suggests strong associations across cell types in mean expression and biological dispersion. Thus, we adopted multivariate normal (MVN) distribution to compute the variance-covariance information, <inline-formula id="IEq28"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma _m}$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi mathvariant="bold-italic">m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma _{\phi }}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq29.gif"/></alternatives></inline-formula>, respectively, for mean and overdispersion parameters. For gene <italic>g</italic>, the mean expression and overdispersion per subject <italic>j</italic> are simulated by MVN with <inline-formula id="IEq30"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\bar{\mu }_m}$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi mathvariant="bold-italic">m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\bar{\mu }_{\phi }}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq31.gif"/></alternatives></inline-formula>, who are K-dimensional vectors representing the mean and overdispersion parameters estimated from PROPER.</p>
        <p id="Par12">To simulate the biological variation, we adopted a Gamma distribution to generate the true cell-type-specific gene expression matrix. We assume cases and controls have identical gene-wise overdispersion <inline-formula id="IEq32"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma _{\phi }}$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq32.gif"/></alternatives></inline-formula> but different mean expression specified by log fold change (LFC). The reference gene expression per control (baseline group) are simulated by the above process with mean <inline-formula id="IEq33"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\mu }^{ctr}_{m}$$\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ctr</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq33.gif"/></alternatives></inline-formula>, while the expression for cases are generated by the same process with mean <inline-formula id="IEq34"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\mu }^{case}_{m}=\bar{\mu }^{ctr}_{m}+\Delta$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">case</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ctr</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq34.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq35"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta$$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq35.gif"/></alternatives></inline-formula> is LFC. The true mixture-cell expression per gene per sample (<inline-formula id="IEq36"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\lambda }_{gjt}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq36.gif"/></alternatives></inline-formula>) is the weighted sum of the reference gene expression, with weights as cell proportions. We set 10% genes as DE in a cell type, although two of the six cell types do not contain any DE genes. The values of LFC are set at <inline-formula id="IEq37"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {LFC}=0, 0.5,0.75,1.0,1.25,1.5$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mtext>LFC</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>0.75</mml:mn><mml:mo>,</mml:mo><mml:mn>1.0</mml:mn><mml:mo>,</mml:mo><mml:mn>1.25</mml:mn><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq37.gif"/></alternatives></inline-formula>. The number of subjects is set at <inline-formula id="IEq38"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=50, 100, 150, 200$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>150</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq38.gif"/></alternatives></inline-formula>. Each subject has measurements at three time points, and the number of subjects are equal between two groups. The observed raw counts is generated by Poisson distribution with mean <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\lambda }_{gjt}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq39.gif"/></alternatives></inline-formula> to mimic the technical noise in sequencing experiments.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Reference panel deconvolution</title>
      <p id="Par13">We first evaluated the accuracy of ISLET on individual-specific reference panel recovery, using the synthetic data outlined above. Since ISLET is the only method that estimates subject-specific reference expression from longitudinal bulk samples, the comparison with existing methods in subject-specific reference panel is not directly viable. Nevertheless, we chose TOAST and TCA for a detailed comparison. TOAST can solve for one reference panel per group (case/control), and this group-wise reference matrix is then treated as the subject-specific reference panel in evaluation. TCA can solve for sample-specific reference panel; thus, we use the average of multiple estimated reference panels per subject to obtain the subject-specific profile. These two approaches reflect the two ends of the deconvolution spectrum: a fixed reference panel across subjects (or samples) per group vs. a sample-specific reference, while ISLET fills the methodology gap in between.</p>
      <p id="Par14">For the aforementioned three methods, cell type proportions were provided as input. We assessed the reference estimation accuracy in two scenarios, in which the true and pre-deconvoluted proportions served as the input, respectively. The pre-deconvoluted proportions were obtained by CIBERSORTx using noise-added reference panels, with 200 marker genes identified independently by TOAST package based on coefficient of variations. There are <inline-formula id="IEq40"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=50$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq40.gif"/></alternatives></inline-formula> subjects per group, each has three samples under the null hypothesis (0% DEG). The ISLET-estimated individual reference panel, based on the true or pre-deconvoluted cell type composition, are shown in scatterplots (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A, B). The true cellular proportions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A) yields more precision in reference panel estimation, compared with the computationally deconvoled proportions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). This difference is more profound in low-expression genes (log-expression &lt; 7).<fig id="Fig2"><label>Fig. 2</label><caption><p>ISLET accurately estimates individual-specific gene expression reference panels. <bold>A</bold> Scatterplot showing ISLET estimated reference panel versus the true reference panel, in log scale, when using the true cell type proportions as the input. <bold>B</bold> Scatterplot similar to panel <bold>A</bold> but using the estimated cell type proportions as the input. <bold>C</bold> Normalized mean squared error (NMSE) in reference panel estimation, from three methods: TOAST, TCA, and ISLET, at various effect sizes. Log fold change (LFC) used in simulation: 0, 0.5, 0.75, 1, 1.25, and 1.5. <bold>D</bold> NMSE at various samples sizes per group (25, 50, 75, and 100), comparing three methods. <bold>E</bold> NMSE stratified by gene expression level (low expression: <inline-formula id="IEq41"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M86"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq41.gif"/></alternatives></inline-formula>160 and high expression: &gt; 160). <italic>N </italic>= 20 simulations are conducted in each scenario</p></caption><graphic xlink:href="13059_2023_3014_Fig2_HTML" id="MO4"/></fig></p>
      <p id="Par15">We next assessed if the effect size of DEG could have an impact on reference estimation. The effect size is reflected through the log-fold change (LFC) value of the synthetic DEG. Figure <xref rid="Fig2" ref-type="fig">2</xref>C shows the estimation error, represented by normalized mean squared error (NMSE) for the three methods across various choices of LFC ranging from 0 (under the null) to 1.5 (large effect size). ISLET has the lowest median and lowest variation NMSE under all choices of effect sizes, showing the most accurate and stable estimation. In addition, ISLET is robust with the least NMSE increase at larger effect sizes. In contrast, TOAST have inflated error at large LFC and TCA has higher variability. The estimation accuracy at different sample sizes is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>D. As expected, all methods benefited from an increased sample size. ISLET achieved the lowest error consistently at sample sizes of 25 to 100 per group. It has the lowest median error as well as the lowest variation. Next, to investigate if the expression level would impact the estimation accuracy, we stratified the genes into two groups: low expression genes (expression count value <inline-formula id="IEq42"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M88"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq42.gif"/></alternatives></inline-formula>160) and high expression genes (expression count value &gt; 160). As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>E, the bias of ISLET is the lowest at both strata, showing the most robust performance among the three methods. Similar conclusions can be drawn in other combinations of LFC and sample size (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S1-S7 ). Side-by-side comparisons using ground true proportions versus estimated proportions (Fig. S<xref rid="MOESM1" ref-type="media">2</xref>) indicates that imprecise cell type proportions would impact reference panel estimation negatively. Our method ISLET still achieves the lowest NMSE on average and the smallest variation in each simulation scenario, compared with other methods. These results, overall, highlight both the unfavorable impact of imprecise proportions to reference panel estimation, and the merits of our modeling approach compared to others. Furthermore, our method still outperforms TOAST if the TOAST deconvolution is performed on each subject’s repeated samples, individually.</p>
    </sec>
    <sec id="Sec8">
      <title>Improved csDEG identification</title>
      <p id="Par16">With the improved reference estimation demonstrated above, we further investigated ISLET performance in cell-type-specific differentially expressed genes (csDEG) identification by using the model in Equation (<xref rid="Equ1" ref-type="disp-formula">1</xref>). We compared ISLET with five methods, i.e., CARseq, TOAST, TCA, DESeq2, and csSAM. All the competing methods used the true cell type proportions along with bulk gene expression values as input. The csDE analysis in DESeq2 can be performed by testing the coefficients for interaction terms of each cell type and group.</p>
      <p id="Par17">The result is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> and benchmarked by metrics of true discovery rate (TDR), receiver operating characteristic (ROC), and sensitivity and false discovery rate (FDR). Here, the TDR is defined as the proportion of true csDEG, among the top-ranking identified genes for each method. TDR is equivalent to precision and reflects a practical consideration: biologists may focus on the top-ranking significant csDEG output given a certain method; thus, the accuracy among them matters the most for biomarker discovery. Figure <xref rid="Fig3" ref-type="fig">3</xref>A shows the averaged results for 20 replicates, among all six methods, for the sample size of <inline-formula id="IEq43"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=25$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq43.gif"/></alternatives></inline-formula> subjects per group at one cell type. ISLET shows the highest precision among top-ranking genes in TDR and the largest AUC in ROC. We also examined the distributions of sensitivity and FDR, for each method, among all cell types. The third panel of Fig. <xref rid="Fig3" ref-type="fig">3</xref>A shows joint distribution of sensitivity and FDR, given the intended FDR level 0.1. Apparently, ISLET yields the highest sensitivity and reasonably controlled FDR. TCA can outperform ISLET in terms of sensitivity only in very few datasets, but its seriously inflated FDR is a concern. DESeq2 also resulted in poor FDR, due to its inflated type I error for empirical Bayes approach under large sample sizes [<xref ref-type="bibr" rid="CR25">25</xref>]. The sensitivity plot in the fourth column of Fig. <xref rid="Fig3" ref-type="fig">3</xref>A demonstrates that ISLET is the most powerful method for various LFC with <inline-formula id="IEq44"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=25$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq44.gif"/></alternatives></inline-formula> subjects per group. All the competing methods show increased sensitivity at larger LFC.<fig id="Fig3"><label>Fig. 3</label><caption><p>ISLET improves testing accuracy in cell-type-specific differentially expressed genes (csDEG) identification. <bold>A</bold> True discovery rate (TDR), receiver operating characteristic (ROC), sensitivity versus false discovery rate (FDR), and sensitivities at various effect sizes are shown from left to right. Results for one cell type, at sample size of <italic>N </italic>= 25 subjects per group with log fold change (LFC) = 0.5, are shown for the first three panels. Intended FDR level of 0.1 (vertical line) in the third panel. The fourth panel shows the averaged sensitivity across all cell types, at various LFCs. Benchmarked methods include CARseq, TOAST, TCA, DESeq2, and csSAM. <bold>B</bold> Displaying the same metrics as in <bold>A</bold> except sample size per group is <italic>N </italic>= 75. <bold>C</bold> Averaged AUC values across all cell types, at various combinations of sample sizes and LFCs. <inline-formula id="IEq45"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=20$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq45.gif"/></alternatives></inline-formula> simulations are conducted for each simulation scenario described above</p></caption><graphic xlink:href="13059_2023_3014_Fig3_HTML" id="MO5"/></fig></p>
      <p id="Par18">Simulations at a larger sample size of <inline-formula id="IEq46"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=75$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>75</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq46.gif"/></alternatives></inline-formula> per group show a similar conclusion as the above, in terms of the same metrics (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). In addition, similar conclusions can be drawn from an exhaustive combination of sample size and LFC, broken down by cell type (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figs. S8-S20). The simulation results implied that the performance of each method is affected by the cell type proportions, i.e., better performance in higher-abundance cell types. All methods are less powerful for the cell subpopulations at lower frequencies (<inline-formula id="IEq47"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;10\%$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq47.gif"/></alternatives></inline-formula>), and thus the performances are often similar.</p>
      <p id="Par19">Figure <xref rid="Fig3" ref-type="fig">3</xref>C shows the heatmap of average AUC, combining all cell types, at different sample size and LFC. This shows the aggregated performance across all cell types in a synthetic replicate, whereas two out of the six cell types do not have any csDEG. Here, ISLET still achieves the highest AUC, at all scenarios. TOAST and TCA’s rankings follow immediately after ISLET, in most cases. Overall, in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, ISLET demonstrates considerably improved and consistent csDEG detection performance, with the help of improved reference panel recovery.</p>
      <p id="Par20">We also performed simulations to compare the impact of modeling versus the impact of imprecise proportions on csDE testing power. Results are compiled in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figs. S21-S22, with sample size at <inline-formula id="IEq48"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=25, 50, 75, 100$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>75</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq48.gif"/></alternatives></inline-formula> participants per group. Using estimated proportions would negatively impact all methods, but the order of methods would retain. TDR and ROC curves show the advantage of using ISLET compared with other methods, within either the true or estimated proportions. It is worth noting that ISLET with deconvoluted proportions could outperform other methods with true proportions, at certain top-gene cutoff and towards the tail of ROC curves, despite ISLET maintains a comparable performance in FDR. The impact of imprecise cellular composition on FDR is profound for each compared method. Furthermore, we compare ISLET and DESeq2 at small sample size with <inline-formula id="IEq49"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=5$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq49.gif"/></alternatives></inline-formula> subjects per group. The results in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figs. S23-S24 show that in a longitudinal study with small sample size, our model still yields higher sensitivity in csDEG calling than the methods borrowing information across genes, such as DESeq2.</p>
      <p id="Par21">In the meantime, we illustrate the performance of slope test based on the framework in Equation (<xref rid="Equ2" ref-type="disp-formula">2</xref>) by generating synthetic gene expression with differential slope. The simulation design for this scenario is similar to the above, as described in the “<xref rid="Sec14" ref-type="sec">Methods”</xref>. In Additional file <xref rid="MOESM3" ref-type="media">3</xref>, Figs. S25-S28 show the false positive rate (FPR) and sensitivity of ISLET slope test at different LFC and sample size, while the FDR for all cell types is shown in Figs. S<xref rid="MOESM3" ref-type="media">29</xref>. Briefly, ISLET slope test is powerful in detecting cell-type-specific differential change-rate, with robust type I error in each synthetic data and controlled FDR at larger LFC, sample size. This csDEG slope test is not available in the other tools.</p>
    </sec>
    <sec id="Sec9">
      <title>Type I error under the null</title>
      <p id="Par22">We next evaluated these methods in terms of the validity of their <italic>p</italic>-values under the null distribution, where none of the genes are csDEG. Here, under the null hypothesis, the <italic>p</italic>-value distribution should be uniformly distributed between 0 and 1. Our results showed that, among the six methods, TOAST provided the best-calibrated <italic>p</italic>-values for type I error control, immediately followed by ISLET. TCA and csSAM suffered from conservative issues, evident by the inflated density near <italic>p</italic>-values close to 1 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). Conclusions were jointly supported by the histogram of <italic>p</italic>-value and by the Kolmogorov-Smirnov (KS) test, which evaluated goodness of fit for <italic>p</italic>-values distributed uniformly. Since the small <italic>p</italic>-values are essential in csDEG calling, we also show the quantile-quantile plot of the <italic>p</italic>-values on -log10 scale for a zoomed-in examination of the small <italic>p</italic>-values (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). CARseq and TOAST have the best-calibrated small <italic>p</italic>-values. ISLET and TCA have roughly calibrated distribution. In contrast, the <italic>p</italic>-values of csSAM and DESeq2 deviate from the expected distribution.<fig id="Fig4"><label>Fig. 4</label><caption><p>Simulation studies for type I error control under the null. <bold>A</bold> Histograms of the observed <italic>p</italic>-values under the null, when no gene is csDEG. The <italic>p</italic>-values shown above histograms are from the Kolmogorov-Smirnov (KS) test under the null hypothesis, for which the contrasted distribution is Uniform [0, 1]. The larger the <italic>p</italic>-value, the more uniform the distribution is. <bold>B</bold> Quantile-quantile plots of the same <italic>p</italic>-values as in <bold>A</bold> but on the <inline-formula id="IEq50"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\log _{10}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq50.gif"/></alternatives></inline-formula> scale. Methods return well-calibrated small <italic>p</italic>-values will stay close to the red diagonal line. <inline-formula id="IEq51"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=20$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq51.gif"/></alternatives></inline-formula> simulations are conducted each setting</p></caption><graphic xlink:href="13059_2023_3014_Fig4_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Application in TEDDY longitudinal bulk transcriptomes</title>
      <p id="Par23">An overview of TEDDY cohort and whole blood bulk RNA-seq data is available in Additional file <xref rid="MOESM4" ref-type="media">4</xref>. To apply the competing methods to TEDDY longitudinal bulk RNA-seq data, we selected the participants with IAbs onset between the age of 21 and 27 months and their matched controls. The whole blood samples used in this analysis were collected every 3 months from 9-month age until the first positively-confirmed IAbs onset in the cases (i.e., endpoint), exclusive of the endpoint. Hence, each matched case-control pair had bulk RNA-seq transcriptomes longitudinally profiled at the same age prior to IA seroconversion. Genes with TPM-normalized mean expression less than 1 were removed in downstream analysis. Next, we selected <inline-formula id="IEq52"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G=2000$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mn>2000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq52.gif"/></alternatives></inline-formula> genes with top coefficient variation and <inline-formula id="IEq53"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;20\%$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq53.gif"/></alternatives></inline-formula> zero counts to perform csDE analysis by each method as illustration. The tools csSAM, CARSeq, TOAST, and DESeq2 were only applicable in the (mean) test described by Eq. (<xref rid="Equ1" ref-type="disp-formula">1</xref>), while ISLET was capable of detecting csDEG in both mean and change-rate.</p>
      <p id="Par24">We used BH procedure to control FDR in multiple testing, and then reported csDEG at FDR<inline-formula id="IEq54"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.1$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq54.gif"/></alternatives></inline-formula> in each method. ISLET and TOAST detected DEGs in either B cell or NK cell by the mean test without age-dependent effect. This result was consistent with the findings in [<xref ref-type="bibr" rid="CR14">14</xref>], i.e., IA-signatures were strongly enriched in B cell and NK cell transcripts, kinases, and transcription factors. For each method, the csDEGs identified in multiple cell populations are shown in Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figs. S30-S34. TCA detected a large number of csDEGs overlapped between different cell types, which may be a result of the inflated false positive rate of TCA. On the other hand, the csDEG called by ISLET or TOAST were not severely overlapped between cell subpopulations, similar to our simulation design. TOAST and DESeq2 identified csDEG partially overlapping with the above ISLET-identified signatures (Figs. S<xref rid="MOESM4" ref-type="media">35</xref>-S<xref rid="MOESM4" ref-type="media">36</xref>). For each immune cell type, we performed Gene Sets Enrichment Analysis (GSEA) across 45 candidate REACTOME pathways with size of at least 20 genes, using the rank of test statistics in each method and Bioconductor package fgsea [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. The significantly enriched pathways were selected by <italic>q</italic>-value<inline-formula id="IEq55"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.1$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq55.gif"/></alternatives></inline-formula> or <italic>p</italic>-value<inline-formula id="IEq56"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.001$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq56.gif"/></alternatives></inline-formula> and shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>A. Specifically, ISLET mean test identified potential signature genes differentially expressed in IA cases within NK cells prior to the onset of IAbs. The slope test implemented in ISLET detected the latent differential dynamics in CD4<inline-formula id="IEq57"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^+$$\end{document}</tex-math><mml:math id="M118"><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq57.gif"/></alternatives></inline-formula> T cell (<italic>IGLV1-40</italic>) and NK-cell (<italic>RETN</italic>) preceding IAbs onset, although the relation of CD4<inline-formula id="IEq58"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^+$$\end{document}</tex-math><mml:math id="M120"><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq58.gif"/></alternatives></inline-formula> T cell with IA or T1D was not profound in TEDDY microarray data [<xref ref-type="bibr" rid="CR14">14</xref>]. These genes showed difference in the change-rate of mixture-cell gene expression (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B).<fig id="Fig5"><label>Fig. 5</label><caption><p>Application of ISLET in TEDDY bulk RNA-seq data. <bold>A</bold> Heatmap of <italic>p</italic>-values for pathway enrichment analysis on csDE results from ISLET, DESeq2, and TOAST. <bold>B</bold> Dynamics of csDEG identified by ISLET slope test</p></caption><graphic xlink:href="13059_2023_3014_Fig5_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>Application in PDBP longitudinal bulk transcriptomes</title>
      <p id="Par25">We obtained another longitudinal bulk transcriptome dataset from the Parkinson’s Disease Biomarker Program (PDBP, <ext-link ext-link-type="uri" xlink:href="https://amp-pd.org/">https://amp-pd.org/</ext-link>), which is a part of the Accelerating Medicines Partnership (AMP) Parkinson’s Disease program. This dataset include both Parkinson’s Disease (PD) cases and healthy controls, with repeated measures at baseline, 6, 12, 18, and 24 months. In our analysis, study participants with at least two follow-up visits, besides baseline, were selected. A total of 572 participants (399 PD cases and 173 controls) with 2599 longitudinal blood samples within the two years were included. RNA samples were extracted from whole blood and sequenced. Transcripts per million (TPM) was adopted to represent the gene expression level. We adopted CIBERSORT for deconvolution for cell type proportions. Longitudinal transcriptome data, retrieved cell type proportions, and PD status served as the inputs for ISLET, TOAST, and DESeq2. Same FDR control procedures were adopted as in the first real data analysis.</p>
      <p id="Par26">As shown in Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Section 2, ISLET detected 12 and 6 csDEGs in CD8+ T cells and NK cells, respectively, in the mean test comparing PD and controls. A PD-linked mutation marker <italic>DNAJC6</italic> [<xref ref-type="bibr" rid="CR27">27</xref>] was called by ISLET as DEG in CD8+ T cells, which was not detected by TOAST or DESeq2. This mutation was also found associated with neurodegeneration in human brain [<xref ref-type="bibr" rid="CR28">28</xref>]. In addition, the pathway analysis based on ISLET result indicates that the combined csDEGs is enriched in response of EIF2AK4 translation regulation, which is one of the main features of transcriptome profiles in PD [<xref ref-type="bibr" rid="CR29">29</xref>] and a known pathological alterations in PD and other non-communicable diseases [<xref ref-type="bibr" rid="CR30">30</xref>]. TOAST called <italic>HLA-DQB2</italic> as DEG in CD8+ T cells, which was found being associated with PD [<xref ref-type="bibr" rid="CR31">31</xref>]. DESeq2 also detected several genes such as <italic>CCNA2</italic> that had been reported to be associated with PD [<xref ref-type="bibr" rid="CR32">32</xref>], but these genes were called in multiple cell types by DESeq2 with potential concern of being false positive.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Discussion</title>
    <p id="Par27">We implemented our model and algorithm in Bioconductor package ISLET to recover reference panel and perform csDEG test. The algorithm implemented in ISLET has several advantages. First, the individual-specific random effect in the reference panel represents the shared information between repeated samples collected from the same participant. This framework also allows the heterogeneity between repeated samples by incorporating age-dependent effect. Second, ISLET does not require the input of single cell gene expression data from a pilot experiment, which is an essential component in some other csDE analysis tools such as PRISM [<xref ref-type="bibr" rid="CR13">13</xref>]. In addition, the statistical model used in ISLET can be applied to normalized or re-scaled gene expression and the other types of omics data (e.g., microarray gene expression and DNA methylation), because of the Gaussian density employed in EM algorithm. In contrast, the other csDE analysis tools such as CARSeq, PRISM, and DESeq2 are only applicable to RNA-seq counts data.</p>
    <p id="Par28">A limitation in the present research is the lack of longitudinal pure cell transcriptomes from PBMC samples. The temporal cell-type-specific marker genes for IA in the TEDDY cohort cannot be validated in the current bulk RNA-seq data. To benchmark the estimated individual-specific and cell-type-specific gene expression, it is necessary to design an experiment with sorted cells and then compare with the individual reference panel predicted by ISLET. Based on the individual reference profile deconvolved by ISLET, cell type composition can be re-estimated by applying CIBERSORT or the non-negative least square (NNLS) method to the observed longitudinal bulk gene expression and predicted reference panel per subject. This is similar to the option of recalculating cell type proportions in TCA, although TCA constructs the reference panel for each sample. Our future work should iteratively update the cell type proportion estimate and cell-type-specific reference panel.</p>
    <p id="Par29">The current version of ISLET did not incorporate any non-negative restriction in parameter estimation, although the output individual reference panel was truncated at zero and ISLET showed superior performance in reference panel estimation. The parameter estimate in ISLET should be improved by adopting either a restricted EM algorithm with non-negative restrictions [<xref ref-type="bibr" rid="CR33">33</xref>] or penalized least square regression [<xref ref-type="bibr" rid="CR34">34</xref>]. Another improvement in future research is to estimate the cell type proportions and individual-specific gene expression matrix simultaneously. The concurrent deconvolution of longitudinal cell type proportions and individual-specific reference panels may require a complex framework, but this will also reduce the bias in estimated cellular composition and improves the deconvolved individual reference profiles.</p>
  </sec>
  <sec id="Sec13">
    <title>Conclusion</title>
    <p id="Par30">ISLET is a robust and powerful tool for cell-type-specific gene expression recovery and longitudinal differential analysis in bulk RNA-seq data. This framework globally improved the detection of cell-type-specific latent gene signatures.</p>
  </sec>
  <sec id="Sec14">
    <title>Methods</title>
    <sec id="Sec15">
      <title>Overview</title>
      <p id="Par31">Our present work excluded the genes with low expression (mean TPM <inline-formula id="IEq59"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;1$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq59.gif"/></alternatives></inline-formula>) or excess zero counts (in <inline-formula id="IEq60"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;20\%$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq60.gif"/></alternatives></inline-formula> samples) in the real data. The gene-wise overdispersion is a key parameter in the statistical modeling for RNA-seq data, which may vary between solid tissues and whole blood samples. Hence, we used the raw and TPM-normalized counts, individually, to assess the overdispersion pattern in the whole blood bulk RNA-seq data in TEDDY. The scatter plot in Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Fig. S39 illustrated that the mean-variance relation in the filtered genes in TEDDY data is similar to that of Poisson or Log-Normal distribution, both can be approximated by Gaussian. In addition, a general Gaussian assumption is favorable in the analysis of other omics data such as DNA methylation and is computationally efficient because of the explicit form of EM estimator. Therefore, we adopted Gaussian density function and the EM algorithm to estimate the group effect and individual-specific random effect.</p>
    </sec>
    <sec id="Sec16">
      <title>Cell-type-specific and individual-specific random effects</title>
      <p id="Par32">To justify our assumption about individual-specific reference matrix and the random effect terms, we employed scRNA-seq and bulk RNA-seq data profiled from blood samples to illustrate the heterogeneity between subjects at cellular level. We first used scRNA-seq PBMC data in [<xref ref-type="bibr" rid="CR35">35</xref>] to evaluate the inter-subject heterogeneity of cell-type-specific gene expression. The scRNA-seq PBMC raw counts was converted to cell-type-specific counts and normalized by TPM. Genes with mean TPM <inline-formula id="IEq61"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;1$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq61.gif"/></alternatives></inline-formula> were removed. To reduce the potential covariate effect (e.g., disease status) on gene expression, we used control samples in the following analyses. We first employed a chi-squared statistic to confirm that a large proportion of genes in B cells (78%) and CD4+ T cells (62%) had standard deviation greater than half of the empirical mean. Statistical significance of this chi-squared test was determined by FDR <inline-formula id="IEq62"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.1$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq62.gif"/></alternatives></inline-formula>. In addition, to evaluate the improvement in goodness-of-fit brought by random effects, we compared the gene-wise Akaike information criterion (AIC) of the generalized linear mixed effect model (GLMM) and generalized linear model (GLM), using a paired <italic>t</italic> test and 1000 most variable genes in TEDDY and PDBP bulk transcriptomic data. We adopted the normal distribution in GLMM and GLM to reduce the impact of density function on AIC. The results showed that GLMM yielded lower AIC than GLM (p<inline-formula id="IEq63"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.0001$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq63.gif"/></alternatives></inline-formula>) in TEDDY and PDBP data, while the estimated random effect variance is non-zero for at least 60% and 50% genes per cell type in TEDDY and PDBP data, respectively.</p>
      <p id="Par33">We further applied the function <italic>estimateDisp</italic> in Bioconductor package edgeR to assess intra- and inter-subject heterogeneity in the same scRNA-seq data [<xref ref-type="bibr" rid="CR35">35</xref>]. The intra-subject overdispersion was estimated based on the longitudinal samples per subject, while the inter-subject overdispersion was evaluated based on the samples at a fixed time point for all subjects. Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figs. S43-S44 show the gene-wise overdispersion between and within subjects by cell type, whereas the inter-subject heterogeneity is significantly larger than intra-subject heterogeneity (Wilcoxon signed rank test <italic>p </italic><inline-formula id="IEq64"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.0001$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq64.gif"/></alternatives></inline-formula>). We also evaluated the common overdispersion shared by genes across all time points and at a single time point, individually. The common overdispersion between subjects at a fixed time point was 2.88 for B cells and 1.77 for CD4+ T cells, being close to that of all longitudinal samples, i.e., 3.32 for B cells and 1.92 for CD4+ T cells. Therefore, our current model focuses on the inter-subject variation.</p>
    </sec>
    <sec id="Sec17">
      <title>Mixed-effect regression framework</title>
      <p id="Par34">We use the same model for each gene and implement our algorithm by parallel computing; therefore, we drop the gene index in model description below. Suppose the subject is indexed by <italic>j</italic>, where <inline-formula id="IEq65"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j = 1,2,...,J$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq65.gif"/></alternatives></inline-formula>. For each subject <italic>j</italic>, there are <inline-formula id="IEq66"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_j$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq66.gif"/></alternatives></inline-formula> longitudinal observations. We use <inline-formula id="IEq67"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{jt}$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq67.gif"/></alternatives></inline-formula> to represent the observed gene expression for subject <italic>j</italic> at time-point <italic>t</italic>. The dependent variable vector is thus <inline-formula id="IEq68"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq68.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq69"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}= (y_{11}, y_{12}, \cdots , y_{1T_1}, \cdots , y_{J1}, y_{J2}, \cdots , y_{JT_J})^\prime$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq69.gif"/></alternatives></inline-formula>, with length <inline-formula id="IEq70"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=\sum _{j=1}^J T_j$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq70.gif"/></alternatives></inline-formula>. It contains the gene expression values across <italic>J</italic> subjects’ longitudinal observations.</p>
      <p id="Par35">Meanwhile, we also have other inputs that can be treated as known. These include the number of cell types <italic>K</italic>, and the cell type proportions <inline-formula id="IEq71"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{jT_j k}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq71.gif"/></alternatives></inline-formula> for each subject, each sample, and each cell type. Naturally, <inline-formula id="IEq72"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{jT_j k} \in (0,1)$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq72.gif"/></alternatives></inline-formula> and <inline-formula id="IEq73"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{k=1}^K \theta _{jT_j k} = 1$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq73.gif"/></alternatives></inline-formula>. Additionally, we use a binary scalar <inline-formula id="IEq74"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_j$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq74.gif"/></alternatives></inline-formula> to indicate the subject’s disease status: (e.g., disease = 1 vs. normal = 0). We then have this following mixed-effect regression model:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varvec{y} = \varvec{X\beta } + \varvec{Au}+\varvec{\varepsilon } \end{aligned}$$\end{document}</tex-math><mml:math id="M154" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Au</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq75"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\varepsilon } \sim N(\textbf{0},\sigma _0^2 \varvec{I})$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq75.gif"/></alternatives></inline-formula> are the residuals. Here, <inline-formula id="IEq76"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{X}$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{A}$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq77.gif"/></alternatives></inline-formula> are the design matrices for the fixed-effect <inline-formula id="IEq78"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq78.gif"/></alternatives></inline-formula> and random-effect <inline-formula id="IEq79"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq79.gif"/></alternatives></inline-formula>, respectively, where <inline-formula id="IEq80"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta } = (m_1, m_2, \cdots , m_K, \beta _1, \beta _2,$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq80.gif"/></alternatives></inline-formula>
<inline-formula id="IEq81"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdots , \beta _K)^\prime$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq81.gif"/></alternatives></inline-formula> has two components: <inline-formula id="IEq82"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(m_1, m_2, \cdots , m_K)$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq82.gif"/></alternatives></inline-formula> are the baseline average gene expression in the control group, and <inline-formula id="IEq83"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\beta _1, \beta _2, \cdots , \beta _K)$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq83.gif"/></alternatives></inline-formula> are the difference between the case group and the control group. The random effect <inline-formula id="IEq84"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}= (u_{11}, u_{21}, \cdots , u_{J1}, u_{12}, u_{22},$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>21</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>22</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq84.gif"/></alternatives></inline-formula>
<inline-formula id="IEq85"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdots ,u_{J2}, \cdots , u_{1K}, u_{2K}, \cdots , u_{JK})^\prime$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi mathvariant="italic">JK</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq85.gif"/></alternatives></inline-formula> captures the individual-level gene expression deviance from the group-level mean, for each cell type. The design matrices <inline-formula id="IEq86"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{X}$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq86.gif"/></alternatives></inline-formula> and <inline-formula id="IEq87"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{A}$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq87.gif"/></alternatives></inline-formula> are in the form:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varvec{X} = \left( \begin{array}{cccccccc} \theta _{111} &amp;{} \theta _{112}&amp;{} ... &amp;{} \theta _{11K} &amp;{} z_1\theta _{111} &amp;{} z_1\theta _{112} &amp;{} ... &amp;{} z_1\theta _{11K} \\ \theta _{121} &amp;{} \theta _{122} &amp;{} ... &amp;{} \theta _{12K}&amp;{} z_1\theta _{121} &amp;{} z_1\theta _{122} &amp;{} ... &amp;{} z_1\theta _{12K}\\ ... &amp;{} ... &amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...\\ \theta _{1T_11} &amp;{} \theta _{1T_12} &amp;{} ... &amp;{} \theta _{1T_1K}&amp;{} z_1\theta _{1T_11} &amp;{} z_1\theta _{1T_12} &amp;{} ... &amp;{} z_1\theta _{1T_1K} \\ ... &amp;{} ... &amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...\\ \theta _{J11} &amp;{} \theta _{J12}&amp;{} ... &amp;{} \theta _{J1K} &amp;{} z_J\theta _{J11} &amp;{} z_J\theta _{J12} &amp;{} ... &amp;{} z_J\theta _{J1K} \\ \theta _{J21} &amp;{} \theta _{J22}&amp;{} ... &amp;{} \theta _{J2K} &amp;{} z_J\theta _{J21} &amp;{} z_J\theta _{J22} &amp;{} ... &amp;{} z_J\theta _{J2K} \\ ... &amp;{} ... &amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...&amp;{} ...\\ \theta _{JT_{J}1} &amp;{} \theta _{JT_{J}2}&amp;{} ... &amp;{} \theta _{JT_{J}K} &amp;{} z_J\theta _{JT_{J}1} &amp;{} z_J\theta _{JT_{J}2} &amp;{} ... &amp;{} z_J\theta _{JT_{J}K} \end{array}\right) _{N\times 2K} \end{aligned}$$\end{document}</tex-math><mml:math id="M182" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mn>112</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>11</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>112</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>11</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mn>121</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mn>122</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>121</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mn>122</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>z</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varvec{A} = \left( \begin{array}{ccccccccc} \textbf{a}_{11 }&amp;{}0 &amp;{}0 &amp;{} 0&amp;{} ... &amp;{} \textbf{a}_{1K} &amp;{}0 &amp;{} 0&amp;{}0\\ 0 &amp;{} \textbf{a}_{21} &amp;{} 0 &amp;{} 0 &amp;{}...&amp;{} 0 &amp;{} \textbf{a}_{2K} &amp;{} 0 &amp;{} 0 \\ 0 &amp;{} 0 &amp;{} \ddots &amp;{} 0&amp;{} ...&amp;{}0 &amp;{} 0 &amp;{}\ddots &amp;{} 0 \\ 0 &amp;{} 0 &amp;{} 0 &amp;{}\textbf{a}_{J1}&amp;{}...&amp;{} 0&amp;{} 0 &amp;{} 0 &amp;{} \textbf{a}_{JK} \end{array}\right) _{N\times Q} \end{aligned}$$\end{document}</tex-math><mml:math id="M184" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋱</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋱</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mrow><mml:mi mathvariant="italic">JK</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq88"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textbf{a}_{jk}{:=} ( \theta _{j_1k}, \theta _{j_2k}, \cdots , \theta _{jT_jk} )^\prime$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq88.gif"/></alternatives></inline-formula> is simply a reorganized vector of cell type proportions, to align with random effect <inline-formula id="IEq89"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq89.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec18">
      <title>Parameters estimation by expectation-maximization algorithm</title>
      <p id="Par36">The parameter estimation for the Equation (<xref rid="Equ3" ref-type="disp-formula">3</xref>) can be achieved by an expectation-maximization (EM) algorithm, although other viable approaches exist. Here, to facilitate the setup of the EM algorithm, we first define the “observed” and the “missing” data: <inline-formula id="IEq90"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}=(\varvec{y, u}):= (\varvec{w}_{obs},\varvec{w}_{mis})$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mis</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq90.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq91"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}_{obs}:=\varvec{y}$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq91.gif"/></alternatives></inline-formula> is the observed data of admixed gene expression, and <inline-formula id="IEq92"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}_{mis}:=\varvec{u}$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mis</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq92.gif"/></alternatives></inline-formula> is the missing data of individual-level deviance from the group mean. Then, we have the conditional distribution <inline-formula id="IEq93"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}_{obs}|\varvec{w}_{mis} = \varvec{y}|\varvec{u} \sim N( \varvec{X\beta } + \varvec{Au}, \sigma _0^2 \varvec{I})$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mis</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Au</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq93.gif"/></alternatives></inline-formula> and marginal distribution <inline-formula id="IEq94"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}_{mis}=\varvec{u} \sim N(\varvec{0},\varvec{\Sigma }_u)$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mis</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq94.gif"/></alternatives></inline-formula>. Here, <inline-formula id="IEq95"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma }_u$$\end{document}</tex-math><mml:math id="M200"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq95.gif"/></alternatives></inline-formula> is a block-diagonal matrix <inline-formula id="IEq96"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma }_u=diag(\sigma _{1}^2 \varvec{I}_J, \sigma _{2}^2\varvec{I}_J, \cdots , \sigma _{K}^2\varvec{I}_J)$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mi>J</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mi>J</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mi>J</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq96.gif"/></alternatives></inline-formula>. By calculating the variance-covariance matrix of <inline-formula id="IEq97"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}_{mis}$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mis</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq97.gif"/></alternatives></inline-formula> and <inline-formula id="IEq98"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}_{obs}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq98.gif"/></alternatives></inline-formula>, we have the following multivariate normal distribution:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left( \begin{array}{c} \varvec{w}_{obs} \\ \varvec{w}_{mis} \end{array}\right) = N\Biggr [\left( \begin{array}{c} \varvec{X\beta } \\ \varvec{0} \end{array}\right) ,\left( \begin{array}{cc} \varvec{A\Sigma }_u\varvec{A}^\prime +\sigma _0^2 \varvec{I} &amp;{} \varvec{A\Sigma }_u \\ \varvec{\Sigma }_{u}^\prime \varvec{A}^\prime &amp;{} \varvec{\Sigma }_u \end{array}\right) \Biggr ] \end{aligned}$$\end{document}</tex-math><mml:math id="M208" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">mis</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par37">The EM algorithm calculation will then follow naturally.</p>
      <p id="Par38">E-step:<disp-formula id="Equ9"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E[\varvec{u}|\varvec{w}_{obs}=\varvec{y}]=\varvec{\Sigma }_{u}\varvec{A}^\prime \varvec{V}^{-1}(\varvec{y}-\varvec{X\beta }) \end{aligned}$$\end{document}</tex-math><mml:math id="M210" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ10"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E\bigr [\varvec{s}^\prime \varvec{s}|\varvec{w}_{obs}=\varvec{y}\bigr ]=tr(\varvec{A\Sigma }_p\varvec{A}^\prime ) + (\varvec{A\mu }_p+\varvec{X\beta }-\varvec{y})^\prime (\varvec{A\mu }_p+\varvec{X\beta }-\varvec{y}) \end{aligned}$$\end{document}</tex-math><mml:math id="M212" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">[</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ11"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E\bigr [\varvec{u}_k^\prime \varvec{u}_k|\varvec{w}_{obs}=\varvec{y}\bigr ]=tr(\varvec{\Sigma }_{p_k})+\varvec{\mu }_{p_k}^\prime \varvec{\mu }_{p_k} \end{aligned}$$\end{document}</tex-math><mml:math id="M214" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">[</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">Here, <inline-formula id="IEq99"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{s}=\varvec{Au}+\varvec{X\beta }-\varvec{y}$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Au</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq99.gif"/></alternatives></inline-formula>, <inline-formula id="IEq100"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{V} := \varvec{A\Sigma }_u\varvec{A}^\prime +\sigma _0^2 \varvec{I}$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq100.gif"/></alternatives></inline-formula>, <inline-formula id="IEq101"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma }_{p_k}$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq101.gif"/></alternatives></inline-formula> is the <italic>k</italic>th diagonal block of matrix <inline-formula id="IEq102"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Sigma }_{p}$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq102.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq103"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\mu }_{p_k}$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq103.gif"/></alternatives></inline-formula> is the <italic>k</italic>th sub-vector in <inline-formula id="IEq104"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\mu }_{p}$$\end{document}</tex-math><mml:math id="M226"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq104.gif"/></alternatives></inline-formula>.</p>
      <p id="Par40">M-step:</p>
      <p id="Par41">For the <inline-formula id="IEq105"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(t+1)^{th}$$\end{document}</tex-math><mml:math id="M228"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq105.gif"/></alternatives></inline-formula> iteration given the <inline-formula id="IEq106"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t^{th}$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq106.gif"/></alternatives></inline-formula> iteration:<disp-formula id="Equ12"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hat{\varvec{\beta }}^{(t+1)}=(\varvec{X}^\prime \varvec{X})^{-1}\varvec{X}^\prime (\varvec{y}-\varvec{A}E_{\eta ^{(t)}}(\varvec{u}^{(t)})) \end{aligned}$$\end{document}</tex-math><mml:math id="M232" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hat{\sigma }_0^{2(t+1)}=\frac{E_{\eta ^{(t)}}\bigr [\varvec{s}^\prime \varvec{s}|\varvec{w}_{obs}=\varvec{y}\bigr ]}{N} \end{aligned}$$\end{document}</tex-math><mml:math id="M234" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">[</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hat{\sigma }_k^{2(t+1)}=\frac{E_{\eta ^{(t)}}\bigr [\varvec{u}_k^\prime \varvec{u}_k|\varvec{w}_{obs}=\varvec{y}\bigr ]}{J} \end{aligned}$$\end{document}</tex-math><mml:math id="M236" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">[</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mi>J</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par42">The E-step and M-step above are repeated until convergence. The details of modeling and algorithm is available in Additional file <xref rid="MOESM5" ref-type="media">5</xref>.</p>
    </sec>
    <sec id="Sec19">
      <title>Hypothesis testing</title>
      <p id="Par43">To detect csDEG, we can test each hypothesis <inline-formula id="IEq107"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0: \beta _k=0$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq107.gif"/></alternatives></inline-formula>, individually, or jointly <inline-formula id="IEq108"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0: \beta _1=...=\beta _K=0$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq108.gif"/></alternatives></inline-formula>, by using the (observed) marginal likelihood function <inline-formula id="IEq109"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(\varvec{\beta }, \varvec{\sigma })$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq109.gif"/></alternatives></inline-formula> and the likelihood ratio test (LRT) statistic <inline-formula id="IEq110"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M244"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq110.gif"/></alternatives></inline-formula>. That is,<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L(\varvec{\beta }, \varvec{\sigma })= &amp; {} \ln f(\varvec{y}; \varvec{X}, \varvec{A}, \varvec{\beta }, \varvec{\sigma })\nonumber \\= &amp; {} -\frac{1}{2} \{N\ln (2\pi )+\ln \left| \varvec{A\Sigma }_u \varvec{A}'+\sigma ^2_0 \varvec{I}_{N}\right| \nonumber \\{} &amp; {} +(\varvec{y}-\varvec{X\beta })'(\varvec{A\Sigma }_u \varvec{A}'+\sigma ^2_0 \varvec{I}_{N})^{-1}(\varvec{y}-\varvec{X\beta })\} \end{aligned}$$\end{document}</tex-math><mml:math id="M246" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>ln</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>N</mml:mi><mml:mo>ln</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>ln</mml:mo></mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>and the test statistics:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Lambda =2(L(\hat{\varvec{\beta }},\hat{\varvec{\sigma }})-L(\tilde{\varvec{\beta }},\tilde{\varvec{\sigma }})) \end{aligned}$$\end{document}</tex-math><mml:math id="M248" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_3014_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq111"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\beta }}$$\end{document}</tex-math><mml:math id="M250"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq111.gif"/></alternatives></inline-formula>, <inline-formula id="IEq112"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\sigma }}$$\end{document}</tex-math><mml:math id="M252"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq112.gif"/></alternatives></inline-formula> are the EM estimate for the full model in (<xref rid="Equ3" ref-type="disp-formula">3</xref>) and <inline-formula id="IEq113"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\varvec{\beta }}$$\end{document}</tex-math><mml:math id="M254"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq113.gif"/></alternatives></inline-formula>, <inline-formula id="IEq114"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\varvec{\sigma }}$$\end{document}</tex-math><mml:math id="M256"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq114.gif"/></alternatives></inline-formula> are the estimate for the reduced model under null hypothesis <inline-formula id="IEq115"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq115.gif"/></alternatives></inline-formula>. The test statistic follows chi-square distribution <inline-formula id="IEq116"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda \sim \chi ^2_{d}$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>∼</mml:mo><mml:msubsup><mml:mi>χ</mml:mi><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq116.gif"/></alternatives></inline-formula>, where <italic>d</italic> is the degree of freedom determined by the number of parameters in hypothesis <inline-formula id="IEq117"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq117.gif"/></alternatives></inline-formula>. An alternative approach to test csDEG is to apply existing DE analysis methods to the predicted individual-specific gene expression, although this strategy is not ideal due to the possible bias in reference prediction.</p>
    </sec>
    <sec id="Sec20">
      <title>Data generation process in simulation study</title>
      <p id="Par44">Using the procedure described above, we acquire the Dirichlet distribution parameters for cell population composition in controls (denoted as <inline-formula id="IEq118"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\alpha }_C$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>C</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq118.gif"/></alternatives></inline-formula>) and cases (denoted as <inline-formula id="IEq119"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\alpha }_D$$\end{document}</tex-math><mml:math id="M266"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq119.gif"/></alternatives></inline-formula>), respectively: <inline-formula id="IEq120"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\alpha }_C=(8.85,6.49,5.98,5.28,4.22,3.85)$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>8.85</mml:mn><mml:mo>,</mml:mo><mml:mn>6.49</mml:mn><mml:mo>,</mml:mo><mml:mn>5.98</mml:mn><mml:mo>,</mml:mo><mml:mn>5.28</mml:mn><mml:mo>,</mml:mo><mml:mn>4.22</mml:mn><mml:mo>,</mml:mo><mml:mn>3.85</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq120.gif"/></alternatives></inline-formula> and <inline-formula id="IEq121"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\alpha }_D=(1.90,2.25,2.10,5.72,7.33,15.37)$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>D</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1.90</mml:mn><mml:mo>,</mml:mo><mml:mn>2.25</mml:mn><mml:mo>,</mml:mo><mml:mn>2.10</mml:mn><mml:mo>,</mml:mo><mml:mn>5.72</mml:mn><mml:mo>,</mml:mo><mml:mn>7.33</mml:mn><mml:mo>,</mml:mo><mml:mn>15.37</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq121.gif"/></alternatives></inline-formula>. To simulate within-group and within-subject overdispersions, two additional parameters (<inline-formula id="IEq122"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi _Z$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>Z</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq122.gif"/></alternatives></inline-formula> and <inline-formula id="IEq123"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi _S$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq123.gif"/></alternatives></inline-formula>) are introduced in the Dirichlet sampling. We first simulate the mean frequencies of <italic>K</italic> cell types for each subject <italic>j</italic> in group <italic>Z</italic> (cases or controls) by Dirichlet distribution <inline-formula id="IEq124"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\varvec{\theta }}_j\sim Dir(\bar{\varvec{\theta }}^{(0)}_{Z}, \xi _{Z})$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>Z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>Z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq124.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq125"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\varvec{\theta }}_{j}$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq125.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq126"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\times 1$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq126.gif"/></alternatives></inline-formula> vector. The parameters <inline-formula id="IEq127"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\varvec{\theta }}^{(0)}_{Z}$$\end{document}</tex-math><mml:math id="M282"><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>Z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq127.gif"/></alternatives></inline-formula> and <inline-formula id="IEq128"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi _Z$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>Z</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq128.gif"/></alternatives></inline-formula> are the expected frequencies and overdispersion for group <italic>Z</italic>. The cell type composition for subject <italic>j</italic> at time point <italic>t</italic> is <inline-formula id="IEq129"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\varvec{\theta }}_{jt}\sim Dir(\bar{\varvec{\theta }}_{j}, \xi _{p})$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq129.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq130"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\xi _{p}$$\end{document}</tex-math><mml:math id="M288"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq130.gif"/></alternatives></inline-formula> is the mean overdispersion estimate for the longitudinal samples per subject and represents the heterogeneity between time points.</p>
      <p id="Par45">For gene <italic>g</italic>, the mean expression and overdispersion per subject <italic>j</italic> are simulated by <inline-formula id="IEq131"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{M}_{gj}\sim MVN(\bar{\varvec{\mu }}_m,\varvec{\Sigma }_m)$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>M</mml:mi><mml:mi>V</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq131.gif"/></alternatives></inline-formula>, <inline-formula id="IEq132"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Phi }_{gj}\sim MVN(\bar{\varvec{\mu }}_{\phi },\varvec{\Sigma }_{\phi })$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>M</mml:mi><mml:mi>V</mml:mi><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>ϕ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>ϕ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq132.gif"/></alternatives></inline-formula>. For each cell type <italic>k</italic>, the true reference expression in subject <italic>j</italic> is generated by Gamma distribution <inline-formula id="IEq133"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{gjk}\sim \Gamma (\exp (-\Phi _{gjk}),M_{gjk}\exp (\Phi _{gjk}))$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq133.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq134"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{gjk}, \Phi _{gjk}$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq134.gif"/></alternatives></inline-formula> are components in vectors <inline-formula id="IEq135"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{M}_{gj}, \varvec{\Phi }_{gj}$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq135.gif"/></alternatives></inline-formula>. The true mixture-cell gene expression level per sample is <inline-formula id="IEq136"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\lambda }_{gjt}=\varvec{\lambda }^\prime _{gj}\bar{\varvec{\theta }}_{jt}$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq136.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq137"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda ^\prime _{gj}=(\lambda _{gj1},..., \lambda _{gjK})$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjK</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq137.gif"/></alternatives></inline-formula> and <inline-formula id="IEq138"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\lambda }_{gjt}$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq138.gif"/></alternatives></inline-formula> still follows Gamma distribution [<xref ref-type="bibr" rid="CR36">36</xref>]. The observed bulk RNA-seq raw counts for gene g in subject <italic>j</italic> measured at time point <italic>t</italic> is generated from Poisson distribution <inline-formula id="IEq139"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{gjt}\sim Pois(\bar{\lambda }_{gjt})$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq139.gif"/></alternatives></inline-formula>. In the scenario of slope test, the reference panel per subject differs between time points, with age effect fixed by (case or control) group. That is shifting <inline-formula id="IEq140"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{gjk}$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq140.gif"/></alternatives></inline-formula> to <inline-formula id="IEq141"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{M}_{gjkt}=M_{gjk}+\Delta _t$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjkt</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq141.gif"/></alternatives></inline-formula> for <inline-formula id="IEq142"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t&gt;1$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq142.gif"/></alternatives></inline-formula>, where the value of <inline-formula id="IEq143"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta _t$$\end{document}</tex-math><mml:math id="M314"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq143.gif"/></alternatives></inline-formula> is group-wise. The cell-type-specific true expression per gene per sample at each time point can be updated to <inline-formula id="IEq144"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\lambda }_{gjkt}\sim \Gamma (\exp (-\Phi _{gjk}),M_{gjkt}\exp (\Phi _{gjk}))$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjkt</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjkt</mml:mi></mml:mrow></mml:msub><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjk</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq144.gif"/></alternatives></inline-formula>, and the mixture-cell expression is <inline-formula id="IEq145"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{\lambda }_{gjt}=\tilde{\varvec{\lambda }}^\prime _{gjt}\bar{\varvec{\theta }}_{jt}$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">jt</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq145.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq146"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\varvec{\lambda }}^\prime _{gjt}=(\lambda _{gj1t},..., \lambda _{gjKt})$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">gjt</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">gjKt</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq146.gif"/></alternatives></inline-formula>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2023_3014_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Simulation: reference panel estimation.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2023_3014_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Simulation: csDEG test in mean.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2023_3014_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3.</bold> Simulation: ISLET slope test.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2023_3014_MOESM4_ESM.pdf">
            <caption>
              <p><bold>Additional file 4.</bold> ISLET applications in real data.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2023_3014_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5.</bold> Appendix.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13059_2023_3014_MOESM6_ESM.pdf">
            <caption>
              <p><bold>Additional file 6.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The TEDDY study is funded by the National Institute of Diabetes and Digestive and Kidney Diseases, National Institute of Allergy and Infectious Diseases, National Institute of Child Health and Human Development, National Institute of Environmental Health Sciences, Centers for Disease Control and Prevention, and JDRF. We thank the TEDDY study data coordinating center at Health Informatics Institute, University of South Florida, for data processing and sharing. The PDBP consortium is supported by the National Institute of Neurological Disorders and Stroke (NINDS) at the National Institutes of Health. A full list of PDBP investigators can be found at <ext-link ext-link-type="uri" xlink:href="https://pdbp.ninds.nih.gov/policy">https://pdbp.ninds.nih.gov/policy</ext-link>. The PDBP investigators have not participated in reviewing the data analysis or content of the manuscript. Data used in the preparation of this article were obtained from the Accelerating Medicine Partnership (AMP) Parkinson’s Disease (AMP PD) Knowledge Platform. We thank Lijun Zhang for discussions on PD-related genes and thank Wen Tang for assistance in real data processing.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par46">The review history is available as Additional file <xref rid="MOESM6" ref-type="media">6</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par47">Anahita Bishop was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>H.F. and Q.L. developed and implemented the algorithm. Z.L. contributed to the methodology discussion. H.F. conceived the experiments. H.F., G.M., T.L., Y.P., and Q.L. conducted the simulations and/or real data analysis. H.F., G.M., and Q.L. wrote the manuscript. H.P. processed TEDDY RNA-seq data and interpreted real data analysis results. J.K. supervised the TEDDY consortium. All authors reviewed the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was partially supported by the National Institutes of Health [U24DK097771 via the NIDDK Information Network’s (dkNET) New Investigator Pilot Program in Bioinformatics (PI: Q.L.) and Cancer Center Support Grant P30CA21765 to Q.L.; R03CA270725 to Z.L.], the American Cancer Society Institutional Research Grant (ACS IRG) [IRG-16-186-21 to H.F.] through Case Comprehensive Cancer Center, and the Corinne L. Dodero Foundation for the Arts and Sciences and the Case Western Reserve University (CWRU) Program for Autism Education and Research to H.F. and the American Lebanese Syrian Associated Charities (ALSAC) to Q.L.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p><inline-formula id="IEq147"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M322"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq147.gif"/></alternatives></inline-formula> ISLET is a Bioconductor package with license GPL-2 available at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/ISLET">https://bioconductor.org/packages/ISLET</ext-link> [<xref ref-type="bibr" rid="CR22">22</xref>]</p>
    <p><inline-formula id="IEq148"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M324"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq148.gif"/></alternatives></inline-formula> The TEDDY RNAseq data have been deposited in NCBI’s database of Genotypes and Phenotypes (dbGaP) with the primary accession code phs001442.v3.p2</p>
    <p><inline-formula id="IEq149"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M326"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq149.gif"/></alternatives></inline-formula> The PDBP bulk transcriptome and related clinical data are publicly available on request to AMP-PD (<ext-link ext-link-type="uri" xlink:href="https://amp-pd.org/">https://amp-pd.org/</ext-link>)</p>
    <p><inline-formula id="IEq150"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M328"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq150.gif"/></alternatives></inline-formula> Simulation based on real data: RNA-seq of human immune pure cell lines (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE60424">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE60424</ext-link>)</p>
    <p><inline-formula id="IEq151"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M330"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq151.gif"/></alternatives></inline-formula> Parameter estimation: PROPER package (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/PROPER">https://bioconductor.org/packages/PROPER</ext-link>)</p>
    <p><inline-formula id="IEq152"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M332"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq152.gif"/></alternatives></inline-formula> TOAST (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/TOAST">https://bioconductor.org/packages/TOAST</ext-link>)</p>
    <p><inline-formula id="IEq153"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M334"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq153.gif"/></alternatives></inline-formula> TCA (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/TCA">https://cran.r-project.org/web/packages/TCA</ext-link>)</p>
    <p><inline-formula id="IEq154"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M336"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq154.gif"/></alternatives></inline-formula> CARseq (<ext-link ext-link-type="uri" xlink:href="https://github.com/Sun-lab/CARseq">https://github.com/Sun-lab/CARseq</ext-link>)</p>
    <p><inline-formula id="IEq155"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M338"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq155.gif"/></alternatives></inline-formula> DESeq2 (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/DESeq2">https://bioconductor.org/packages/DESeq2</ext-link>)</p>
    <p><inline-formula id="IEq156"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M340"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq156.gif"/></alternatives></inline-formula> csSAM (<ext-link ext-link-type="uri" xlink:href="https://github.com/shenorrLab/csSAM">https://github.com/shenorrLab/csSAM</ext-link>)</p>
    <p><inline-formula id="IEq157"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M342"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq157.gif"/></alternatives></inline-formula> CIBERSORTx (<ext-link ext-link-type="uri" xlink:href="https://github.com/IOBR/IOBR">https://github.com/IOBR/IOBR</ext-link>)</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par48">Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par49">All authors have read and approved the submission of this manuscript.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par50">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Methods.</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>453</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id>
        <?supplied-pmid 25822800?>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Steen</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Chaudhuri</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Determining cell type abundance and expression from bulk tissues with digital cytometry</article-title>
        <source>Nat Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>7</issue>
        <fpage>773</fpage>
        <lpage>782</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0114-2</pub-id>
        <?supplied-pmid 31061481?>
        <pub-id pub-id-type="pmid">31061481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Severson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pignon</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Novak</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive analyses of tumor immunity: implications for cancer immunotherapy</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1028-7</pub-id>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Susztak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bulk tissue cell type deconvolution with multi-subject single-cell expression reference</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsoucas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <article-title>Accurate estimation of cell-type composition from gene expression data</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-10802-z</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Cell-type-aware analysis of RNA-seq data</article-title>
        <source>Nat Comput Sci.</source>
        <year>2021</year>
        <volume>1</volume>
        <issue>4</issue>
        <fpage>253</fpage>
        <lpage>261</lpage>
        <pub-id pub-id-type="doi">10.1038/s43588-021-00055-6</pub-id>
        <?supplied-pmid 34957416?>
        <pub-id pub-id-type="pmid">34957416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>TOAST: improving reference-free cell composition estimation by cross-cell type differential analysis</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1778-0</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Robust partial reference-free cell composition estimation from tissue expression</article-title>
        <source>Bioinformatics.</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>11</issue>
        <fpage>3431</fpage>
        <lpage>3438</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa184</pub-id>
        <?supplied-pmid 32167531?>
        <pub-id pub-id-type="pmid">32167531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rahmani</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schweiger</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rhead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Criswell</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Barcellos</surname>
            <given-names>LF</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell-type-specific resolution epigenetics without the need for cell sorting or single-cell biology</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-11052-9</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Dufort MJ, Greenbaum CJ, Speake C, Linsley PS. Cell type–specific immune phenotypes predict loss of insulin secretion in new-onset type 1 diabetes. JCI insight. 2019;4(4):e125556.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrington</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Fei</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Minnier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Carbone</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Searles</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>BA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Seq of human whole blood: Evaluation of globin RNA depletion on Ribo-Zero library method</article-title>
        <source>Sci Rep.</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-62801-6</pub-id>
        <pub-id pub-id-type="pmid">31913322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Zhang K, Erkan EP, Jamalzadeh S, Dai J, Andersson N, Kaipio K, et al. Longitudinal single-cell RNA-seq analysis reveals stress-promoted chemoresistance in metastatic ovarian cancer. Sci Adv. 2022;8(8):eabm1831.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Häkkinen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Alkodsi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Erkan</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PRISM: recovering cell-type-specific expression profiles from individual composite RNA-seq samples</article-title>
        <source>Bioinformatics.</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>18</issue>
        <fpage>2882</fpage>
        <lpage>2888</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab178</pub-id>
        <?supplied-pmid 33720334?>
        <pub-id pub-id-type="pmid">33720334</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Xhonneux LP, Knight O, Lernmark Å, Bonifacio E, Hagopian WA, Rewers MJ, et al. Transcriptional networks in at-risk individuals identify signatures of type 1 diabetes progression. Sci Transl Med. 2021;13(587):eabd5666.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen-Orr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bodian</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Staedtler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Perry</surname>
            <given-names>NM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell type-specific gene expression differences in complex tissues</article-title>
        <source>Nat Methods.</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>4</issue>
        <fpage>287</fpage>
        <lpage>289</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1439</pub-id>
        <?supplied-pmid 20208531?>
        <pub-id pub-id-type="pmid">20208531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Dissecting differential signals in high-throughput data from complex tissues</article-title>
        <source>Bioinformatics.</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>20</issue>
        <fpage>3898</fpage>
        <lpage>3905</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz196</pub-id>
        <?supplied-pmid 30903684?>
        <pub-id pub-id-type="pmid">30903684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Pe’er</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Danko</surname>
            <given-names>CG</given-names>
          </name>
        </person-group>
        <article-title>Cell type and gene expression deconvolution with BayesPrism enables Bayesian integrative analysis across bulk and single-cell RNA sequencing in oncology</article-title>
        <source>Nat Cancer.</source>
        <year>2022</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>505</fpage>
        <lpage>517</lpage>
        <pub-id pub-id-type="doi">10.1038/s43018-022-00356-3</pub-id>
        <?supplied-pmid 35469013?>
        <pub-id pub-id-type="pmid">35469013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Ma Y, Zhou X. Spatially informed cell-type deconvolution for spatial transcriptomics. Nat Biotechnol. 2022;1–11.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rondina</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Voora</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Schwertz</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Harper</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Longitudinal RNA-Seq analysis of the repeatability of gene expression and splicing in human platelets identifies a platelet SELP splice QTL</article-title>
        <source>Circ Res.</source>
        <year>2020</year>
        <volume>126</volume>
        <issue>4</issue>
        <fpage>501</fpage>
        <lpage>516</lpage>
        <pub-id pub-id-type="doi">10.1161/CIRCRESAHA.119.315215</pub-id>
        <?supplied-pmid 31852401?>
        <pub-id pub-id-type="pmid">31852401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Foo</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Trautmann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sticht</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Treutlein</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Frank</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Streit</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Longitudinal transcriptome-wide gene expression analysis of sleep deprivation treatment shows involvement of circadian genes and immune pathways</article-title>
        <source>Transl Psychiatry.</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/s41398-019-0671-7</pub-id>
        <pub-id pub-id-type="pmid">30664621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol.</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>1</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Feng H, Li Q. ISLET: Individual-Specific ceLl typE referencing Tool. 2023. R package version 1.2.0. 10.18129/B9.bioc.ISLET.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aliee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>AutoGeneS: Automatic gene selection using multi-objective optimization for RNA-seq deconvolution</article-title>
        <source>Cell Syst.</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>7</issue>
        <fpage>706</fpage>
        <lpage>715</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2021.05.006</pub-id>
        <?supplied-pmid 34293324?>
        <pub-id pub-id-type="pmid">34293324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>PROPER: comprehensive power evaluation for differential expression using RNA-seq</article-title>
        <source>Bioinformatics.</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>2</issue>
        <fpage>233</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu640</pub-id>
        <?supplied-pmid 25273110?>
        <pub-id pub-id-type="pmid">25273110</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Exaggerated false positives by popular differential expression methods when analyzing human population samples</article-title>
        <source>Genome Biol.</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02648-4</pub-id>
        <pub-id pub-id-type="pmid">34980209</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Korotkevich G, Sukhov V, Budin N, Shpak B, Artyomov MN, Sergushichev A. Fast gene set enrichment analysis bioRxiv. 2021. 10.1101/060012.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olgiati</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Quadri</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rood</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Saute</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Chien</surname>
            <given-names>HF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNAJC6 mutations associated with early-onset Parkinson’s disease</article-title>
        <source>Ann Neurol.</source>
        <year>2016</year>
        <volume>79</volume>
        <issue>2</issue>
        <fpage>244</fpage>
        <lpage>256</lpage>
        <pub-id pub-id-type="doi">10.1002/ana.24553</pub-id>
        <?supplied-pmid 26528954?>
        <pub-id pub-id-type="pmid">26528954</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Wulansari N, Darsono WHW, Woo HJ, Chang MY, Kim J, Bae EJ, et al. Neurodevelopmental defects and neurodegenerative phenotypes in human brain organoids carrying Parkinson’s disease-linked DNAJC6 mutations. Sci Adv. 2021;7(8):eabb1540.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mutez</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nkiliza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Belarbi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>de Broucker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vanbesien-Mailliot</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bleuse</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Involvement of the immune system, endocytosis and EIF2 signaling in both genetically determined and sporadic forms of Parkinson’s disease</article-title>
        <source>Neurobiol Dis.</source>
        <year>2014</year>
        <volume>63</volume>
        <fpage>165</fpage>
        <lpage>170</lpage>
        <pub-id pub-id-type="doi">10.1016/j.nbd.2013.11.007</pub-id>
        <?supplied-pmid 24269915?>
        <pub-id pub-id-type="pmid">24269915</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Rios-Fuller TJ, Mahe M, Walters B, Abbadi D, Pérez-Baos S, Gadi A, et al. Translation regulation by eIF2<inline-formula id="IEq159"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M344"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_3014_Article_IEq159.gif"/></alternatives></inline-formula> phosphorylation and mTORC1 signaling pathways in non-communicable diseases (NCDs). Int J Mol Sci. 2020;21(15):5301.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Chao</surname>
            <given-names>YX</given-names>
          </name>
          <name>
            <surname>West</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Poewe</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Jankovic</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Parkinson disease and the immune system–associations, mechanisms and therapeutics</article-title>
        <source>Nat Rev Neurol.</source>
        <year>2020</year>
        <volume>16</volume>
        <issue>6</issue>
        <fpage>303</fpage>
        <lpage>318</lpage>
        <pub-id pub-id-type="doi">10.1038/s41582-020-0344-4</pub-id>
        <?supplied-pmid 32332985?>
        <pub-id pub-id-type="pmid">32332985</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chatterjee</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bhattacharyya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bandyopadhyay</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Biological networks in Parkinson’s disease: an insight into the epigenetic mechanisms associated with this disease</article-title>
        <source>BMC Genomics.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1186/s12864-017-4098-3</pub-id>
        <pub-id pub-id-type="pmid">28049423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>The restricted EM algorithm for maximum likelihood estimation under linear restrictions on the parameters</article-title>
        <source>J Am Stat Assoc.</source>
        <year>1995</year>
        <volume>90</volume>
        <issue>430</issue>
        <fpage>708</fpage>
        <lpage>716</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1995.10476564</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Bates D, Mächler M, Bolker B, Walker S. Fitting linear mixed-effects models using lme4. J Stat Softw. 2015;67(1):1–48. 10.18637/jss.v067.i01.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Ramírez-Sánchez AD, Chu X, Modderman R, Kooy-Winkelaar Y, Koletzko S, Korponay-Szabó IR, et al. Single-cell RNA sequencing of peripheral blood mononuclear cells from pediatric coeliac disease patients suggests potential pre-seroconversion markers. Front Immunol. 2022;1038.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moschopoulos</surname>
            <given-names>PG</given-names>
          </name>
        </person-group>
        <article-title>The distribution of the sum of independent gamma random variables</article-title>
        <source>Ann Inst Stat Math.</source>
        <year>1985</year>
        <volume>37</volume>
        <issue>1</issue>
        <fpage>541</fpage>
        <lpage>544</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02481123</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
