<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7703783</article-id>
    <article-id pub-id-type="pmid">31580402</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz727</article-id>
    <article-id pub-id-type="publisher-id">btz727</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>T-lex3</italic>: an accurate tool to genotype and estimate population frequencies of transposable elements using the latest short-read whole genome sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bogaerts-Márquez</surname>
          <given-names>María</given-names>
        </name>
        <xref ref-type="aff" rid="btz727-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barrón</surname>
          <given-names>Maite G</given-names>
        </name>
        <xref ref-type="aff" rid="btz727-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-7306-6532</contrib-id>
        <name>
          <surname>Fiston-Lavier</surname>
          <given-names>Anna-Sophie</given-names>
        </name>
        <xref ref-type="aff" rid="btz727-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vendrell-Mir</surname>
          <given-names>Pol</given-names>
        </name>
        <xref ref-type="aff" rid="btz727-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Castanera</surname>
          <given-names>Raúl</given-names>
        </name>
        <xref ref-type="aff" rid="btz727-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Casacuberta</surname>
          <given-names>Josep M</given-names>
        </name>
        <xref ref-type="aff" rid="btz727-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>González</surname>
          <given-names>Josefa</given-names>
        </name>
        <xref ref-type="aff" rid="btz727-aff1">1</xref>
        <xref ref-type="corresp" rid="btz727-cor1"/>
        <!--<email>josefa.gonzalez@ibe.upf-csic.es</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btz727-aff1"><label>1</label><institution>Institute of Evolutionary Biology (CSIC-Universitat Pompeu Fabra), Paseo Maritimo Barceloneta 37–49</institution>, Barcelona, <country country="ES">Spain</country></aff>
    <aff id="btz727-aff2"><label>2</label><institution>Institut des Sciences de l'Evolution de Montpellier (UMR 5554, CNRS-UM-IRD-EPHE), 11 Université de Motpellier</institution>, Place Eugène Bataillon, Montpellier, <country country="FR">France</country></aff>
    <aff id="btz727-aff3"><label>3</label><institution>Center for Research in Agricultural Genomics, CRAG (CSIC-IRTA-UAB-UB), Campus UAB, Cerdanyola del Vallès</institution>, Barcelona, Spain</aff>
    <author-notes>
      <corresp id="btz727-cor1">To whom correspondence should be addressed. <email>josefa.gonzalez@ibe.upf-csic.es</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-10-03">
      <day>03</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>03</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>4</issue>
    <fpage>1191</fpage>
    <lpage>1197</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>3</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>16</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz727.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Transposable elements (TEs) constitute a significant proportion of the majority of genomes sequenced to date. TEs are responsible for a considerable fraction of the genetic variation within and among species. Accurate genotyping of TEs in genomes is therefore crucial for a complete identification of the genetic differences among individuals, populations and species.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>In this work, we present a new version of <italic>T-lex</italic>, a computational pipeline that accurately genotypes and estimates the population frequencies of reference TE insertions using short-read high-throughput sequencing data. In this new version, we have re-designed the <italic>T-lex</italic> algorithm to integrate the BWA-MEM short-read aligner, which is one of the most accurate short-read mappers and can be launched on longer short-reads (e.g. reads &gt;150 bp). We have added new filtering steps to increase the accuracy of the genotyping, and new parameters that allow the user to control both the minimum and maximum number of reads, and the minimum number of strains to genotype a TE insertion. We also showed for the first time that <italic>T-lex3</italic> provides accurate TE calls in a plant genome.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>To test the accuracy of <italic>T-lex3</italic>, we called 1630 individual TE insertions in <italic>Drosophila melanogaster</italic>, 1600 individual TE insertions in humans, and 3067 individual TE insertions in the rice genome. We showed that this new version of <italic>T-lex</italic> is a broadly applicable and accurate tool for genotyping and estimating TE frequencies in organisms with different genome sizes and different TE contents. <italic>T-lex3</italic> is available at Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/GonzalezLab/T-lex3">https://github.com/GonzalezLab/T-lex3</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">European Commission</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000780</named-content>
        </funding-source>
        <award-id>H2020-ERC-2014-CoG-647900</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Secretaria d’Universitats i Recerca del Departament d’Economia i Coneixement de la Generalitat de Catalunya</named-content>
        </funding-source>
        <award-id>GRC 2017 SGR 880</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Ministerio de Economia y Competitividad</named-content>
        </funding-source>
        <award-id>AGL2016-78992-R</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Structural variants, such as insertions, deletions and inversions, are often ignored when analyzing genomic variation due to the technical limitations associated with short-read high-throughput sequencing (<xref rid="btz727-B21" ref-type="bibr">Hoban <italic>et al.</italic>, 2016</xref>; <xref rid="btz727-B46" ref-type="bibr">Villanueva-Cañas <italic>et al.</italic>, 2017</xref>). However, it has become apparent that structural variants are a considerable source of genomic variation. For example, in the human genome structural variants outnumber single-base-pair differences (<xref rid="btz727-B1" ref-type="bibr">Alkan <italic>et al.</italic>, 2011</xref>). Transposable elements (TEs) are a type of structural variant that are present in virtually all genomes sequenced to date, where they represent a substantial proportion of the genome content—ranging from ∼3% in yeast to ∼80% in maize and wheat (<xref rid="btz727-B4" ref-type="bibr">Bleykasten-Grosshans and Neuvéglise, 2011</xref>; <xref rid="btz727-B31" ref-type="bibr">Mascher <italic>et al.</italic>, 2017</xref>; <xref rid="btz727-B41" ref-type="bibr">Schnable <italic>et al.</italic>, 2009</xref>). Species differ not only in the total TE genome content, but also in the diversity of TEs, and in the proportion of active and inactive TE copies (<xref rid="btz727-B17" ref-type="bibr">Guio and González, 2019</xref>). The transposition activity of TEs can generate a significant amount of genetic variation. TEs can alter fitness-related traits or cause diseases when they disrupt genes or affect their level of expression (<xref rid="btz727-B8" ref-type="bibr">Chuong <italic>et al.</italic>, 2017</xref>; <xref rid="btz727-B10" ref-type="bibr">Elbarbary <italic>et al.</italic>, 2016</xref>). TEs can also generate mutations after they have lost the capacity to transpose by acting as substrates for ectopic recombination or by facilitating template switching during repair of replication errors (<xref rid="btz727-B5" ref-type="bibr">Campbell <italic>et al.</italic>, 2014</xref>; <xref rid="btz727-B27" ref-type="bibr">Lee <italic>et al.</italic>, 2007</xref>; <xref rid="btz727-B43" ref-type="bibr">Startek <italic>et al.</italic>, 2015</xref>). All these TE-induced mutations contribute to the genetic variation within and among species. Thus, accurate genotyping of TEs in genomes is crucial for complete identification of the genetic differences among individuals, populations and species.</p>
    <p>There are many different computational tools that take advantage of the wealth of short-read high-throughput sequencing data available to discover and estimate population frequencies of TE insertions (<xref rid="btz727-B16" ref-type="bibr">Goerner-Potvin and Bourque, 2018</xref>; <xref rid="btz727-B36" ref-type="bibr">Rishishwar <italic>et al.</italic>, 2017</xref>). A non-exhaustive list of tools that identify non-reference and reference insertions shows that some characteristics are commonly shared among tools, such as the ability to detect polymorphic insertions (<xref rid="btz727-T1" ref-type="table">Table 1</xref>). However, other characteristics are more specific, such as the detection of the target site duplications (TSD), which helps to reconstruct the pre-integration site and thus identify mis-annotated TE insertions (<xref rid="btz727-T1" ref-type="table">Table 1</xref>).
</p>
    <table-wrap id="btz727-T1" orientation="portrait" position="float">
      <label>Table 1.</label>
      <caption>
        <p>Characteristics of computational tools used to annotate and detect transposable element insertions</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Software</th>
            <th align="left" rowspan="1" colspan="1">Reference/ Non-reference</th>
            <th align="left" rowspan="1" colspan="1">Polymorphic TE detection</th>
            <th align="left" rowspan="1" colspan="1">TE classes tested</th>
            <th align="left" rowspan="1" colspan="1">Runs with pooled data</th>
            <th align="left" rowspan="1" colspan="1">TSD detection</th>
            <th align="left" rowspan="1" colspan="1">Species tested</th>
            <th align="left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">RelocaTE and CharacTErizer</td>
            <td rowspan="1" colspan="1">Non-reference and reference</td>
            <td rowspan="1" colspan="1">Yes, but only for non-reference</td>
            <td rowspan="1" colspan="1">
              <italic>mPing</italic>
            </td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">
              <italic>Oryza sativa</italic>
            </td>
            <td rowspan="1" colspan="1">
              <xref rid="btz727-B37" ref-type="bibr">Robb <italic>et al.</italic> (2013)</xref>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">STEAK</td>
            <td rowspan="1" colspan="1">Non-reference and reference</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">
              <italic>HK2</italic>
            </td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Human</td>
            <td rowspan="1" colspan="1">
              <xref rid="btz727-B39" ref-type="bibr">Santander <italic>et al.</italic> (2017)</xref>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MELT</td>
            <td rowspan="1" colspan="1">Non-reference and reference</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Alu, L1 and SVA</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Human, <italic>D.melanogaster</italic></td>
            <td rowspan="1" colspan="1">
              <xref rid="btz727-B15" ref-type="bibr">Gardner <italic>et al.</italic> (2017)</xref>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">TEMP</td>
            <td rowspan="1" colspan="1">Non-reference and reference</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">All</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">
              <italic>D.melanogaster</italic>
            </td>
            <td rowspan="1" colspan="1">
              <xref rid="btz727-B48" ref-type="bibr">Zhuang <italic>et al.</italic> (2014)</xref>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">PoPoolationTE2</td>
            <td rowspan="1" colspan="1">Non-reference and reference</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">All</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">
              <italic>D.melanogaster</italic>
            </td>
            <td rowspan="1" colspan="1">
              <xref rid="btz727-B25" ref-type="bibr">Kofler <italic>et al.</italic> (2016)</xref>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">TIDAL</td>
            <td rowspan="1" colspan="1">Non-reference and reference</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">All</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">
              <italic>D.melanogaster</italic>
            </td>
            <td rowspan="1" colspan="1">
              <xref rid="btz727-B34" ref-type="bibr">Rahman <italic>et al.</italic> (2015)</xref>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">T-lex3</td>
            <td rowspan="1" colspan="1">Reference</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">All</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1"><italic>D.melanogaster</italic>, human<italic>, Oryza sativa</italic></td>
            <td rowspan="1" colspan="1">This study</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>In 2011, we developed a tool for fast and accurate frequency estimation of reference TE insertions called <italic>T-lex</italic> (<xref rid="btz727-B13" ref-type="bibr">Fiston-Lavier <italic>et al.</italic>, 2011</xref>). The first update of this software, <italic>T-lex2</italic> (<xref rid="btz727-B12" ref-type="bibr">Fiston-Lavier <italic>et al.</italic>, 2015</xref>), allowed the user to work with individual strain and pooled whole genome sequencing data. In addition, we added a <italic>TE-TSD detection</italic> module that allowed us to correct the genome annotations for 65 <italic>Drosophila melanogaster</italic> reference TE insertions. We also showed that <italic>T-lex2</italic> provides accurate TE calls in <italic>D.melanogaster</italic>, with 99.14% specificity and 89.58% sensitivity, and in the human genome, with 97.65% specificity and 93.26% sensitivity.</p>
    <p>In this work, we implemented a new version of this broadly applicable and flexible tool, which can now be used with the latest short-read high-throughput sequencing technologies. We have re-designed the <italic>T-lex</italic> algorithm to integrate the <italic>BWA-MEM</italic> short-read aligner: one of the most accurate short-read mappers available (<xref rid="btz727-B28" ref-type="bibr">Li and Durbin, 2009</xref>). This aligner has no read length limitation, is currently being maintained by its developers, and it is easy to install as the package is available for most <italic>Linux</italic> distributions and OSX. In addition, we have added extra filtering steps and parameters, and fixed some bugs present in <italic>T-lex2</italic>. We demonstrate that <italic>T-lex3</italic>, now available at <italic>Github</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/GonzalezLab/T-lex3">https://github.com/GonzalezLab/T-lex3</ext-link>), can provide accurate TE genotyping and frequency estimation using <italic>D.</italic><italic>melanogaster</italic>, human and <italic>Oryza sativa</italic> datasets.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p><italic>T-lex3</italic>, as its previous version, is composed of five modules. Briefly, the <italic>TE-analysis</italic> module analyses whether the sequences flanking each reference TE insertion are part of a segmental duplication, or whether they contain repetitive regions, as both features are known to affect the accuracy of TE calls. The <italic>TE-presence detection</italic> module and the <italic>TE-absence detection</italic> module are two independent modules that detect both the presence and the absence of the reference TE based on the analysis of the junction sequences of the TE insertion. When the requirements to call a TE as <italic>present</italic> or <italic>absent</italic> are not met, these modules return a <italic>no data</italic> call. The <italic>TE-combine</italic> module combines the results of the two detection modules to determine whether the TE insertion is <italic>present</italic>, <italic>absent</italic>, <italic>polymorphic</italic> or <italic>no data</italic>. Finally, the <italic>TE-TSD detection</italic> module analyzes the read alignments of the <italic>TE-absence detection</italic> module to identify the Target Site Duplication (TSD) of the TE insertion. In the new version of <italic>T-lex</italic> described here, <italic>T-lex3</italic>, we have updated and improved three of these modules (<xref ref-type="fig" rid="btz727-F1">Fig. 1</xref>), and we have also implemented other more general changes as described below. All these changes have been summarized in <xref rid="btz727-T2" ref-type="table">Table 2</xref>.
</p>
    <fig id="btz727-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p><italic>T-lex3</italic> pipeline. <italic>T-lex3</italic> modules re-designed or improved are highlighted in darker colour. The vertical box indicates the modules that are run by default when <italic>T-lex3</italic> is launched. To run the <italic>TE-TSD detection</italic> module the <italic>TE-absence detection</italic> module results are required. For individually sequenced strains, the individual <italic>Tresults</italic> files for each strain are needed before running the combination of the TE calls from different high-throughput sequencing samples. The discontinuous lines in grey indicate the recommended path when the program is run for the first time with a given reference genome. For subsequent runs, we recommend running the pipeline with the filtered list of selected TEs</p>
      </caption>
      <graphic xlink:href="btz727f1"/>
    </fig>
    <table-wrap id="btz727-T2" orientation="portrait" position="float">
      <label>Table 2.</label>
      <caption>
        <p>Summary of changes introduced in the new <italic>T-lex</italic> version</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Module</th>
            <th align="left" rowspan="1" colspan="1">Steps</th>
            <th align="left" rowspan="1" colspan="1">Features/parameters</th>
            <th align="left" rowspan="1" colspan="1">
              <italic>T-lex2</italic>
            </th>
            <th align="left" rowspan="1" colspan="1">
              <italic>T-lex3</italic>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="6" colspan="1"><italic>TE-presence</italic> detection</td>
            <td rowspan="1" colspan="1">Mapping</td>
            <td rowspan="1" colspan="1">Mapper (read length limit)</td>
            <td rowspan="1" colspan="1">MAQ (127bp)</td>
            <td rowspan="1" colspan="1">BWA-MEM (70bp to 1Mb)</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">Filtering of mapping output</td>
            <td rowspan="1" colspan="1">Read identity</td>
            <td rowspan="1" colspan="1">No filter</td>
            <td rowspan="1" colspan="1">Filters reads with &lt; 95 % alignment match</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Read length</td>
            <td rowspan="1" colspan="1">No filter</td>
            <td rowspan="1" colspan="1">Filters reads shorter than read length specified by the user</td>
          </tr>
          <tr>
            <td rowspan="3" colspan="1">TE call</td>
            <td rowspan="1" colspan="1"><italic>Present</italic> call</td>
            <td rowspan="1" colspan="1">At least one condition must be fulfilled in one flanking region</td>
            <td rowspan="1" colspan="1">All conditions must be fulfilled for the same flanking region</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"><italic>Absent</italic> call</td>
            <td rowspan="1" colspan="1">&lt;65 <italic>Ns</italic> (missing data) in the junction region</td>
            <td rowspan="1" colspan="1">&lt;70 <italic>Ns</italic> (missing data) in the junction region, and ≥ 95% identity in at least 20 bp of the flanking region</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"><italic>Absent</italic> call</td>
            <td rowspan="1" colspan="1">No filter</td>
            <td rowspan="1" colspan="1">&lt;10 <italic>Ns</italic> (missing data) in the junction region</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1"><italic>TE-absence</italic> detection</td>
            <td rowspan="2" colspan="1">TE call</td>
            <td rowspan="1" colspan="1">–<italic>lima</italic> parameter</td>
            <td rowspan="1" colspan="1">5</td>
            <td rowspan="1" colspan="1">10</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"><italic>-v</italic> parameter</td>
            <td rowspan="1" colspan="1">15</td>
            <td rowspan="1" colspan="1">20</td>
          </tr>
          <tr>
            <td rowspan="8" colspan="1">
              <italic>TE-combine</italic>
            </td>
            <td rowspan="2" colspan="1">TE call</td>
            <td rowspan="2" colspan="1">Combination of the TE calls from the absence and presence modules</td>
            <td rowspan="1" colspan="1">Absent/polymorphic</td>
            <td rowspan="2" colspan="1">No data</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Present/polymorphic</td>
          </tr>
          <tr>
            <td rowspan="4" colspan="1">Pool Frequency Estimation</td>
            <td rowspan="1" colspan="1"><italic>–minR</italic> parameter</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"><italic>-maxR</italic> parameter</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> Frequency estimate takes into account whether information is available for one or for the two junction regions</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Considers reads before the calling steps</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">Individual strains TE frequency estimates</td>
            <td rowspan="1" colspan="1"><italic>–minP</italic> parameter</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">File name for the combination of different individual strains</td>
            <td rowspan="1" colspan="1">
              <italic>Tlex_output</italic>
            </td>
            <td rowspan="1" colspan="1">
              <italic>Tfreqs_output</italic>
            </td>
          </tr>
          <tr>
            <td rowspan="3" colspan="1">General</td>
            <td colspan="2" rowspan="1">Warnings about running process</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td colspan="2" rowspan="1">Available test dataset</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td colspan="2" rowspan="1">Available in Github</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <sec>
      <title>2.1 TE-presence detection module</title>
      <p>We have changed the mapper used in the <italic>TE-presence detection</italic> module: while <italic>T-lex2</italic> used <italic>MAQ</italic> (<xref rid="btz727-B30" ref-type="bibr">Li <italic>et al.</italic>, 2008</xref>), <italic>T-lex3</italic> uses <italic>BWA-MEM</italic> (<xref rid="btz727-B28" ref-type="bibr">Li and Durbin, 2009</xref>) (<xref rid="btz727-T2" ref-type="table">Table 2</xref>). <italic>MAQ</italic> has two main limitations: (i) it cannot process reads &gt; 127 bp, while the newest <italic>Illumina</italic> technology produces longer reads (150 and 300 bp) and (ii) it is no longer updated by the developers. We chose <italic>BWA-MEM</italic> as the new mapper because it accepts reads &gt; 127 bp and it performs mapping with high accuracy (<xref rid="btz727-B20" ref-type="bibr">Hatem <italic>et al.</italic>, 2013</xref>). In addition, the <italic>bam</italic> files generated by <italic>BWA-MEM</italic> can be visualized using tools such as <italic>IGV</italic> that are extensively used in the community (<xref rid="btz727-B38" ref-type="bibr">Robinson <italic>et al.</italic>, 2017</xref>). Because <italic>T-lex2</italic> used many of the output files of <italic>MAQ</italic> to call a TE as <italic>present</italic> or <italic>absent</italic>, we have implemented in <italic>T-lex3</italic> pipeline several <italic>Perl</italic> and <italic>AWK</italic> scripts, and included other tools such as <italic>SAMtools</italic> (<xref rid="btz727-B29" ref-type="bibr">Li <italic>et al.</italic>, 2009</xref>) to generate these files. Furthermore, we have added an extra filtering step: <italic>T-lex3</italic> now filters using the CIGAR string information all the reads with an alignment match &lt; 95% compared with the reference genome. Because this percentage is calculated based on the read length specified by the user, this filter also allows to remove shorter reads in those cases in which reads of different lengths are available for a given strain or pool. This allows fixing a bug in <italic>T-lex2</italic> code, which previously considered all reads to be of the size specified by the user leading to incorrect TE calls.</p>
      <p>After the mapping is completed, the <italic>TE-presence detection</italic> module analyzes the junction regions to call the TE as <italic>present</italic> or <italic>absent</italic>. The size of the junction region is based on the <italic>–limp</italic> and <italic>–buffer</italic> parameters (by default 15 and 60, respectively). To consider a TE as <italic>present</italic>, three conditions had to be met in at least one of the two junction regions: (i) at least one read mapped in the junction, (ii) &gt; 15 bp mapped inside the TE (-<italic>limp</italic> parameter) and (iii) 95% identity of the sequence inside the TE. There was a bug in <italic>T-lex2</italic>: if two conditions were fulfilled in one of the junction regions and the other condition was fulfilled in the other junction region, the TE was considered as <italic>present</italic>. <italic>T-lex3</italic> now requires that all three conditions are met in at least one of the junction regions (<xref ref-type="fig" rid="btz727-F2">Fig. 2A</xref>, <xref rid="btz727-T2" ref-type="table">Table 2</xref>).
</p>
      <fig id="btz727-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p><italic>TE calling steps of the T-lex3 TE-presence detection module.</italic> Example of the three steps of <italic>T-lex3</italic> TE-presence detection module to call a TE present, absent or no data for 100 bp reads with default parameters</p>
        </caption>
        <graphic xlink:href="btz727f2"/>
      </fig>
      <p>For the <italic>TE-presence detection</italic> module to call a TE insertion as <italic>absent</italic>, <italic>T-lex2</italic> required &lt; 65 Ns (missing data) in the sequence mapped to the junction, otherwise the TE call was <italic>no data</italic>. In <italic>T-lex3</italic>, we have modified this step and introduced a new one before calling a TE insertion as either <italic>absent</italic> or <italic>no data</italic> (<xref ref-type="fig" rid="btz727-F2">Fig. 2B</xref>). To call a TE insertion as <italic>absent</italic>, <italic>T-lex3</italic> now requires &lt; 70 Ns (missing data) in the sequence mapping to the junction, and 20 of the other nucleotides in that sequence must map to the flanking region with ≥ 95% identity. If this step is not fulfilled, an additional step requires that 10 nucleotides in the junction region (five nucleotides inside and five outside the TE sequence) are not <italic>Ns</italic> (missing data) to consider the TE insertion as <italic>absent</italic>. If this condition is not met, the TE call is <italic>no data</italic> (<xref ref-type="fig" rid="btz727-F2">Fig. 2C</xref>). This extra step is necessary because we detected some cases in which there was a read mapping to the junction that only had sequence identity within the TE leading to incorrect <italic>absent</italic> calls.</p>
    </sec>
    <sec>
      <title>2.2 TE-absence detection module</title>
      <p>Minor changes affecting the default parameters were made within this module to adapt it to longer size reads. The parameter –<italic>lima</italic>, defines the minimum number of non-repeated nucleotides in each side of the insertion site in the junction region. In <italic>T-lex3</italic>, this parameter is 10 by default instead of five. The parameter <italic>-v</italic> defines the minimum read length mapping in each side of the insertion site in the junction regions. In <italic>T-lex3</italic> this parameter is 20 instead of 15 (<xref rid="btz727-T2" ref-type="table">Table 2</xref>).</p>
    </sec>
    <sec>
      <title>2.3 TE-combine module</title>
      <p>We have implemented several changes in the <italic>TE-combine</italic> module. The first step of this module is the combination of the results from the <italic>TE-presence</italic> and <italic>TE-absence detection</italic> modules to generate a <italic>Tresults</italic> file that is used to estimate the TE frequencies (<xref ref-type="fig" rid="btz727-F1">Fig. 1</xref>). <italic>T-lex2</italic> considered a TE insertion to be <italic>absent/polymorphic</italic> when the <italic>TE-presence detection</italic> module gave a <italic>no data</italic> call and the <italic>TE-absence detection</italic> module gave an <italic>absent</italic> call. Similarly, <italic>T-lex2</italic> considered a TE to be <italic>present/polymorphic</italic> when the <italic>TE-presence detection</italic> module gave a <italic>present</italic> call and the <italic>TE-absence detection</italic> module gave a <italic>no data</italic> call. Manual curation of several of these calls revealed that most of these cases should be considered as <italic>no data</italic>. Thus, in <italic>T-lex3</italic> we considered that when we have a call from only one of the two modules, the combination of the results from the two approaches is <italic>no data</italic> (<xref rid="btz727-T3" ref-type="table">Table 3</xref>).
</p>
      <table-wrap id="btz727-T3" orientation="portrait" position="float">
        <label>Table 3.</label>
        <caption>
          <p>Changes in final TE calls between <italic>T-lex2</italic> and <italic>T-lex3</italic> according to the individual <italic>TE-presence</italic> and <italic>TE-absence detection</italic> modules</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">
                <italic>TE-presence module</italic>
              </th>
              <th align="left" rowspan="1" colspan="1">
                <italic>TE-absence module</italic>
              </th>
              <th align="left" rowspan="1" colspan="1">
                <italic>T-lex2</italic>
              </th>
              <th align="left" rowspan="1" colspan="1">
                <italic>T-lex3</italic>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Present</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>present</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>present</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>present</italic>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Present</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>absent</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>polymorphic</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>polymorphic</italic>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Present</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>present/poly</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Absent</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>present</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Absent</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>absent</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>absent</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>absent</italic>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Absent</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>present</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>absent</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>absent/poly</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>no data</italic>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The <italic>TE-combine</italic> module takes into account whether the data comes from pooled or from individual strains to estimate the TE frequencies. When the TE frequency is estimated from pool-seq data, we have added two new parameters and we have fixed two bugs (<xref rid="btz727-T2" ref-type="table">Table 2</xref>). The new parameters <italic>–minR</italic> and <italic>-</italic><italic>maxR</italic> allow the user to define the minimum and the maximum number of reads needed to estimate the TE frequency. Requiring a minimum and maximum number of reads allows false positives to be discarded (very low number of reads to make an accurate TE call), and to discard regions with an excess of coverage due to non-unique mapping or spurious reads (very high number of reads to make an accurate TE call).</p>
      <p>There was a bug in the formula for the TE frequency estimation in <italic>T-lex2</italic>: TE frequency = (NP)/(NP+NA), where NP is the total number of reads supporting the presence and NA is the total number of reads supporting the absence. This formula did not take into account whether there were reads providing evidence for the presence for only one or for the two flanking regions. In <italic>T-lex3</italic> this formula is only used if there is information for only one of the flanking regions. If there are reads mapping on each of the two flanking regions, the formula is: TE frequency = [(NPR+NPL)/2]/(NPR+NPL+NA), where NPR and NPL are the total number of reads supporting the presence at the right and left flanking regions, respectively.</p>
      <p>The other bug was in the estimation of the frequency of pooled samples: <italic>T-lex2</italic> considered the reads that the presence module maps in the flanking region before the calling steps. As such, there could be reads that mapped to the flanking regions even if the TE was finally called as absent. In <italic>T-lex3</italic>, these reads are not considered to estimate the frequency.</p>
      <p>For the TE frequency estimation from individual strains data, we have added one new parameter and we have fixed one bug. The new parameter <italic>–minP</italic> allows the user to define a minimum number of strains with a <italic>present</italic>, <italic>absent</italic> or <italic>polymorphic</italic> result required to estimate the frequency of a given TE. Thus, it allows the user to discard TE frequencies estimates based on a low number of strains, as this result might not be representative of the frequency of that TE in the population. Finally, we have changed the name of the folder where the combination of the individual strains results (<italic>Tresults</italic>) and the file with the frequencies (<italic>Tfreqs</italic>) are saved. <italic>T-lex2</italic> named this folder <italic>Tlex_output</italic>, which was problematic due to the similarity with the individual strains folder name. In <italic>T-lex3</italic>, this file is now called <italic>Tfreqs_output</italic>.</p>
      <p>Besides the changes in the three modules described above, <italic>T-lex3</italic> now provides more detailed standard output that informs the user about the running process. For example, in the <italic>TE-presence detection</italic> module the program now informs the user when each step of the mapping process starts, and whether any of the mapping steps has failed. If a mapping step fails, the program stops. We have uploaded the pipeline to <italic>Github</italic> along with a test dataset that allows the user to check whether the program is properly installed. An updated user manual that provides all the information required to run and interpret <italic>T-lex3</italic> results can also be found at <italic>Github</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/GonzalezLab/T-lex3">https://github.com/GonzalezLab/T-lex3</ext-link>).</p>
    </sec>
    <sec>
      <title>2.4 Datasets</title>
      <p>To compare the performance between <italic>T-lex2</italic> and <italic>T-lex3</italic> we ran several datasets with both versions. For <italic>D.</italic><italic>melanogaster</italic>, we selected 10 pool-seq datasets from the DrosEU consortium (<xref rid="btz727-B23" ref-type="bibr">Kapun <italic>et al.</italic>, 2018</xref>), and 30 individual strains: 19 from the DGRP dataset (<xref rid="btz727-B22" ref-type="bibr">Huang <italic>et al.</italic>, 2014</xref>) and 11 from the DPGP2 dataset (<xref rid="btz727-B33" ref-type="bibr">Pool <italic>et al.</italic>, 2012</xref>; <xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S1</xref>). We also ran <italic>T-lex3</italic> for several datasets that failed to give results with <italic>T-lex2</italic>: three pooled datasets from Italy, Austria (<xref rid="btz727-B3" ref-type="bibr">Bastide <italic>et al.</italic>, 2013</xref>), and Portugal (<xref rid="btz727-B24" ref-type="bibr">Kofler <italic>et al.</italic>, 2012</xref>), 86 individual strains from Lyon, France (<xref rid="btz727-B26" ref-type="bibr">Lack <italic>et al.</italic>, 2016</xref>), and 32 strains from Winters, CA (<xref rid="btz727-B6" ref-type="bibr">Campo <italic>et al.</italic>, 2013</xref>; <xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S4</xref>). For all runs, we used a dataset of 1630 reference TE insertions as described in <xref rid="btz727-B35" ref-type="bibr">Rech <italic>et al.</italic> (2019)</xref>.</p>
      <p>For humans, we used the same dataset as in <italic>T-lex2</italic>: the child genome of the trio human dataset NA12878 (SRR622457) with the reference genome NCBI36/hg18 (<ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenPath/hg18/bigZips/chromFa.zip">http://hgdownload.cse.ucsc.edu/goldenPath/hg18/bigZips/chromFa.zip</ext-link>) (<xref rid="btz727-B44" ref-type="bibr">Stewart <italic>et al.</italic>, 2011</xref>). We analyzed 1600 insertions out of the 2010 that (i) have genomic coordinates with confidence intervals smaller or equal to 1, and (ii) have been analyzed in the CEU trio dataset.</p>
      <p>In this work, we also run for the first time <italic>T-lex3</italic> with a rice genome (MH63) (<xref rid="btz727-B47" ref-type="bibr">Zhang <italic>et al.</italic>, 2016</xref>). We first annotated in the <italic>Oryza sativa</italic> Nipponbare assembly (<xref rid="btz727-B40" ref-type="bibr">Sasaki and International Rice Genome Sequencing, 2005</xref>) 1600 MITE and 1553 LTR insertions. To detect MITE families, we run <italic>MITE-hunter</italic> (<xref rid="btz727-B19" ref-type="bibr">Han and Wessler, 2010</xref>) and combined the results with the high-quality predictions available in the <italic>PMITE</italic> database (<xref rid="btz727-B7" ref-type="bibr">Chen <italic>et al.</italic>, 2014</xref>). Only families with TSDs were considered. Clustering at 90% was performed to remove redundancy using <italic>cd-hit</italic> (<xref rid="btz727-B14" ref-type="bibr">Fu <italic>et al.</italic>, 2012</xref>) to produce a final library. <italic>RepeatMasker</italic> (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org/">http://www.repeatmasker.org/</ext-link>) was run to annotate all regions having significant homology with any of the MITE families. Only the annotations corresponding to full-length elements (length equal to consensus length ± 20%) were considered.</p>
      <p>LTR insertions were identified with <italic>LTRharvest</italic> (<xref rid="btz727-B11" ref-type="bibr">Ellinghaus <italic>et al.</italic>, 2008</xref>) on the Nipponbare assembly (<xref rid="btz727-B40" ref-type="bibr">Sasaki and International Rice Genome Sequencing, 2005</xref>) using default parameters. The potential to encode for proteins was investigated using <italic>hmmscan</italic> (<xref rid="btz727-B9" ref-type="bibr">Eddy, 2011</xref>), and only elements potentially coding for proteins containing typical retrotransposon conserved domains (e.g. reverse transcriptase and integrase) were retained for further analyses.</p>
    </sec>
    <sec>
      <title>2.5 Sensitivity, specificity and accuracy estimations</title>
      <p><italic>T-lex3</italic> sensitivity, specificity and accuracy in the three datasets analyzed were estimated as: (i) sensitivity = number of correct presence calls/total number of presence calls in the validation dataset; (ii) specificity = number of correct absence calls/total number of absence calls in the validation dataset; and (iii) accuracy = (number of correct presence calls + number of correct absence calls)/(total number of presence calls + total number of absence calls in the validation dataset). These calculations were performed using a <italic>Python</italic> script.</p>
      <p>For <italic>D.</italic><italic>melanogaster</italic>, we used the same individual PCR frequencies used in <italic>T-lex2</italic> (<xref rid="btz727-B12" ref-type="bibr">Fiston-Lavier <italic>et al.</italic>, 2015</xref>), except those for one strain (<italic>RAL-730</italic>) for which the raw reads were no longer available.</p>
      <p>For humans, we used the information based on PCRs and/or mapping algorithms for 1600 insertions available in <xref rid="btz727-B44" ref-type="bibr">Stewart <italic>et al.</italic> (2011)</xref>.</p>
      <p>For rice, validation was done as follows: we annotated LTRs and MITE insertions in the MH63 genome (<xref rid="btz727-B47" ref-type="bibr">Zhang <italic>et al.</italic>, 2016</xref>) following the strategy described above for the Nipponbare genome. We compared the orthologous loci containing LTR and MITEs to determine if they were present in both genomes (orthologous insertions), or only in Nipponbare (Nipponbare-specific). To this end, the 500 bp flanking regions of every LTR and MITE insertions in Nipponbare were mapped onto the rice MH63 assembly using BBmap (<ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/bbmap/">https://sourceforge.net/projects/bbmap/</ext-link>). The distribution of the distances between the MH63 regions aligning to the two Nipponbare flanks (D) followed closely that of the length of the MITEs and LTR insertions in Nipponbare (L) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S2</xref>), which is to be expected if the insertions are present in both genomes (orthologous), except for an additional peak centered at distance 0, which should correspond to Nipponbare specific insertions. The manual inspection of some of these loci confirmed this assumption. The insertions were then classified based on the comparison of the distance between the two aligned flanks (D) and the length of the original Nipponbare element (L), as follows: when 1.33xL &gt; D &lt; 0.66xL the insertion was considered as being present in both genomes (orthologous insertion); when D &lt; 50 bp (LTRs) or D &lt; 15 bp (MITEs), the insertion was considered as Nipponbare specific.</p>
    </sec>
    <sec>
      <title>2.6 <italic>T-lex3</italic> processing times</title>
      <p>For an individual <italic>D.</italic><italic>melanogaster</italic> genome of 134 Mb, using a 18.6x sequencing dataset of 73 bp reads, <italic>T-lex3</italic> processing time was ∼ 10.5 hours, while for <italic>T-lex2</italic> processing time was 14 hours. Both runs were performed on a standard computer with a 2.8 GHz Intel Core i5 with 16 GB RAM memory, and both versions were executed with a single thread.</p>
      <p>In humans (genome size 3 Gb), <italic>T-lex3</italic> processing time was 72.5 hours for a 3.1× sequencing dataset of 101 bp reads, for a dataset of 1600 TEs. In rice (genome size 362 Mb), <italic>T-lex3</italic> processing time was 38 hours for a 23.7× sequencing dataset of 100 bp read length, for a dataset of 1584 TEs. Both runs with human and rice genomes were performed with a single thread on a <italic>Linux</italic> Cluster using two different nodes: one with 16 cores (126 Gb of RAM) Intel<sup>®</sup> Xeon<sup>®</sup> CPU ES-2630 v3 with 2.40 GHz and one node with 48 cores (512 GB of RAM) Intel<sup>®</sup> Xeon<sup>®</sup> CPU E5-4640(4660) v4 with 2.10 Ghz.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We have improved and updated <italic>T-lex</italic>, a pipeline that genotypes and estimates reference TE insertion frequencies using individually or pooled short-read high-throughput sequencing data. Briefly, <italic>T-lex3</italic> now uses <italic>BWA-MEM</italic> instead of <italic>MAQ</italic> as the mapping algorithm to detect the presence of insertions. We have added several extra filtering steps and parameters, we have fixed bugs in the pipeline, and we have also introduced some more general changes that overall improves the user experience (<xref rid="btz727-T2" ref-type="table">Table 2</xref>).</p>
    <sec>
      <title>3.1 <italic>T-lex3</italic> genotypes and estimates TE population frequencies in datasets that could not be analyzed with <italic>T-lex2</italic> in <italic>D.</italic><italic>melanogaster</italic></title>
      <p>We have run <italic>T-lex3</italic> in three datasets that gave good results with <italic>T-lex2</italic> (&gt;60% of <italic>present</italic>, <italic>polymorphic</italic> or <italic>absent</italic> calls): 19 individual strains from the DGRP dataset (<xref rid="btz727-B22" ref-type="bibr">Huang <italic>et al.</italic>, 2014</xref>), 11 individual strains from the DPGP dataset (<xref rid="btz727-B33" ref-type="bibr">Pool <italic>et al.</italic>, 2012</xref>), and 10 pooled datasets (<xref rid="btz727-B23" ref-type="bibr">Kapun <italic>et al.</italic>, 2018</xref>) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S1</xref>). The 19 individual strains from the DGRP dataset had a variable number of <italic>no data</italic> calls: from 146 in RAL-757 to 585 in RAL-399 (<xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S1A and B</xref>). <italic>T-lex3</italic> substantially reduced the number of <italic>no data</italic> calls. The maximum number of <italic>no data</italic> calls is now 374 in RAL-399 with some strains having as few as 83 (RAL-738, <xref ref-type="fig" rid="btz727-F3">Fig. 3A</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S1A and B</xref>). The number of <italic>no data</italic> calls according to <italic>T-lex2</italic> in Zambia strains was smaller, ranging from 156 to 344, and this number was also substantially reduced in <italic>T-lex3</italic>: 128 to 181 (<xref ref-type="fig" rid="btz727-F3">Fig. 3B</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S1C and D</xref>). For pool-seq datasets, we found that the correlation between the frequency estimates obtained using the two versions of <italic>T-lex</italic> was very high (Pearson correlation <italic>r<sup>2</sup> =</italic> 0.92–0.97, <xref ref-type="fig" rid="btz727-F3">Fig. 3C</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S1E and F</xref>), as expected since the number of <italic>no data</italic> calls was similar between the two versions.
</p>
      <fig id="btz727-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Comparison between <italic>T-lex2</italic> and <italic>T-lex3</italic> results. Each column represents results for one strain. (<bold>A</bold>) Three different DGRP individually sequenced strains: RAL-757, RAL-399 and RAL-738; (<bold>B</bold>) one Zambian individually sequenced strain: ZI10 and (<bold>C</bold>) one pool-seq European sample: GS_Des_15_1</p>
        </caption>
        <graphic xlink:href="btz727f3"/>
      </fig>
      <p>To estimate the sensitivity, specificity and accuracy of <italic>T-lex3</italic>, we used the same DGRP strains previously used to estimate these parameters for <italic>T-lex2</italic> (see Section 2). We found that both sensitivity, specificity and accuracy are high: 100, 93.33 and 97.14%, respectively (<xref rid="btz727-T4" ref-type="table">Table 4</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S3A</xref>), with similar results among different TE classes (<xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S3B</xref>). Thus, <italic>T-lex3</italic> increases the number of <italic>present</italic>, <italic>polymorphic</italic> and <italic>absent</italic> calls with a very similar sensitivity and slightly higher specificity compared with <italic>T-lex2</italic>. As this DGRP dataset contains strains with different read lengths, we also estimated sensitivity and specificity using different <italic>T-lex3</italic> parameters. We found that specificity decreased and the number of <italic>no data</italic> calls increased when sub-optimal parameters are used (<xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S3C</xref>).
We then estimated the specificity for this same dataset using TIDAL, a method that identifies the absence of reference TE insertions and also discovers non-reference TE insertions (<xref rid="btz727-B34" ref-type="bibr">Rahman <italic>et al.</italic>, 2015</xref>). The specificity of TIDAL was 64.36%.</p>
      <table-wrap id="btz727-T4" orientation="portrait" position="float">
        <label>Table 4</label>
        <caption>
          <p><italic>T-lex3</italic> sensitivity, specificity and accuracy in <italic>D.melanogaster</italic>, humans and rice genomes</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">
                <italic>D.melanogaster</italic>
              </th>
              <th rowspan="1" colspan="1">Humans</th>
              <th rowspan="1" colspan="1">Rice</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="2" colspan="1">Sensitivity</td>
              <td rowspan="1" colspan="1">100%</td>
              <td rowspan="2" colspan="1">99.35% (458/461)</td>
              <td rowspan="2" colspan="1">99.96% (2649/2650)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">(120/120)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">Specificity</td>
              <td rowspan="1" colspan="1">93.33%</td>
              <td rowspan="2" colspan="1">87.78% (754/859)</td>
              <td rowspan="2" colspan="1">92.11% (257/279)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">(84/90)</td>
            </tr>
            <tr>
              <td rowspan="2" colspan="1">Accuracy</td>
              <td rowspan="1" colspan="1">97.14%</td>
              <td rowspan="2" colspan="1">91.81% (1, 212/1, 320)</td>
              <td rowspan="2" colspan="1">99.2% (2, 855/2, 878)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">(204/210)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic>Notes</italic>: In parenthesis, number of calls used to estimate the three parameters.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Finally, we ran <italic>T-lex3</italic> with five datasets that previously failed to give results: two individual strains datasets and three pooled datasets. For all five datasets, <italic>T-lex3</italic> is able to estimate population frequencies for the majority of TE insertions tested (<xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S4</xref>). As an example, for 78 of the 86 strains collected in Lyon, the number of <italic>no data</italic> calls with <italic>T-lex2</italic> was &gt;40%. For this same dataset, <italic>T-lex3</italic> only returns &gt;40% of <italic>no data</italic> calls for 1 of the 86 strains (<xref ref-type="fig" rid="btz727-F4">Fig. 4</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S4A</xref>).
</p>
      <fig id="btz727-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p><italic>T-lex2</italic> (<bold>A</bold>) and <italic>T-lex3</italic> (<bold>B</bold>) results comparison for 86 individual strains from Lyon (France). Each column represents results of one strain. Strains are placed in the same order as in Supplementary Additional File S4A</p>
        </caption>
        <graphic xlink:href="btz727f4"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 <italic>T-lex3</italic> provides accurate TE genotyping and frequency estimations in humans</title>
      <p>We also tested the performance of <italic>T-lex3</italic> in a human dataset: the child genome of the trio human dataset in <xref rid="btz727-B44" ref-type="bibr">Stewart <italic>et al.</italic> (2011)</xref> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S5A</xref>). Out of the 1600 insertions tested, <italic>T-lex3</italic> returns <italic>present</italic>, <italic>absent</italic> or <italic>polymorphic</italic> calls for the majority of them (82.5%: 1320/1600). Sensitivity and specificity were high: 99.35% and 87.78%, respectively, and accuracy was 91.81% (<xref rid="btz727-T4" ref-type="table">Table 4</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S5B</xref>), with similar results for the different families tested (<xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S5C</xref>). We estimated the specificity in this same dataset using the two algorithms described in <xref rid="btz727-B44" ref-type="bibr">Stewart <italic>et al.</italic> (2011)</xref>: the read-pair (RP) algorithm and the split-read (SR) algorithm. The specificity using RP was 99.27% and using SR was 88.89%.</p>
    </sec>
    <sec>
      <title>3.3 <italic>T-lex3</italic> accurately genotypes and estimates TE population frequencies in the rice genome</title>
      <p>We tested <italic>T-lex3</italic> in a rice genome using our own annotated insertions (see Materials and Methods). Out of the 3067 insertions in our dataset, <italic>T-lex3</italic> returns <italic>present</italic>, <italic>absent</italic> or <italic>polymorphic</italic> calls for 2878 (93.84%) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S6A</xref>). According to our validation dataset, sensitivity and specificity were 99.96% and 92.09% respectively while accuracy was 99.2% (<xref rid="btz727-T4" ref-type="table">Table 4</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S6B</xref>), with similar results for the different TE classes tested (<xref ref-type="supplementary-material" rid="sup1">Supplementary Additional File S6C</xref>). These results demonstrated that the <italic>T-lex3</italic> pipeline performance is also robust with rice genomes.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Genome-wide genotyping of TE insertions is crucial in developing a complete catalog of genetic variants that can then be investigated for their potential role in adaptive evolution and/or disease. The repetitive nature of TEs complicates the correct genotyping of these variants and several computational pipelines have been designed to tackle this problem (<xref rid="btz727-T1" ref-type="table">Table 1</xref>). Ideally, these computational pipelines should be able to handle (i) different types of datasets, such as individual and pooled whole genome sequencing datasets; (ii) different lengths of short-reads; and (iii) a variety of TE insertions in diverse genomes (<xref rid="btz727-T1" ref-type="table">Table 1</xref>). In this work, we have improved and updated <italic>T-lex</italic>, a flexible and broadly applicable tool that provides accurate TE genotyping and frequency estimations for the different TE families present in a reference genome using both individual and pooled datasets. Compared to the previous <italic>T-lex</italic> version available, <italic>T-lex3</italic> is a more robust and stable tool, easier to install, and that runs with all the short-reads available, independent of their length. We showed that this new version of <italic>T-lex</italic> provides TE genotyping with higher sensitivity, specificity and accuracy than its previous versions, and similar or higher compared with other tools, while substantially increasing the number of TE reference insertions that can be analyzed. We also showed that <italic>T-lex3</italic> provides accurate calls not only in the <italic>D</italic><italic>.</italic><italic>melanogaster</italic> and human genomes as previous versions, but also in a plant genome: <italic>Oryza sativa</italic>. As such, <italic>T-lex3</italic> is one of the tools that is most broadly applicable to genomes differing not only in size but also in TE content (<xref rid="btz727-T1" ref-type="table">Table 1</xref>).</p>
    <p>Being able to genotype and estimate population frequencies for the majority of TE insertions present in a genome is necessary to generate a more complete picture of the existing genomic variation within and among individuals, populations and species. Although there are several available tools that identify non-reference TE insertions, they have a high rate of false positives (<xref rid="btz727-B34" ref-type="bibr">Rahman <italic>et al.</italic>, 2015</xref>; <xref rid="btz727-B36" ref-type="bibr">Rishishwar <italic>et al.</italic>, 2017</xref>). Thus, we are still limited to analyzing the TE insertions that have been annotated in the available reference genomes. Long-read sequencing technologies should allow the generation of new reference genomes and better <italic>de novo</italic> annotations of TE insertions (<xref rid="btz727-B45" ref-type="bibr">van Dijk <italic>et al.</italic>, 2018</xref>). These new long-read sequencing technologies are already being applied to model and non-model species (<xref rid="btz727-B32" ref-type="bibr">Miller <italic>et al.</italic>, 2018</xref>; <xref rid="btz727-B42" ref-type="bibr">Solares <italic>et al.</italic>, 2018</xref>). However, the number of new genome assemblies is still small as the cost of these technologies remains higher compared with short-read ones. Thus, once the coordinates of new TE insertions are defined based on the new genome-assemblies, <italic>T-lex3</italic> would be useful to estimate the frequencies of these new insertions in all the short-read datasets already available (<xref rid="btz727-B2" ref-type="bibr">Auton <italic>et al.</italic>, 2015</xref>; <xref rid="btz727-B18" ref-type="bibr">Guirao-Rico and González, 2019</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz727_Supplementary_Data</label>
      <media xlink:href="btz727_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank members of the González Lab and Quentin Testard for comments on the manuscript, and Óscar de Arriba for helping improve the code.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the European Commission (H2020-ERC-2014-CoG-647900) and by the Secretaria d’Universitats i Recerca del Departament d’Economia i Coneixement de la Generalitat de Catalunya (GRC 2017 SGR 880). Work done at CRAG was partially funded by a grant from the Ministerio de Economia y Competitividad (AGL2016-78992-R).</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz727-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alkan</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Genome structural variation discovery and genotyping</article-title>. <source>Nat. Rev. Genet</source>., <volume>12</volume>, <fpage>363</fpage>–<lpage>376</lpage>.<pub-id pub-id-type="pmid">21358748</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Auton</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>, <volume>526</volume>, <fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bastide</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>A genome-wide, fine-scale map of natural pigmentation variation in <italic>Drosophila melanogaster</italic></article-title>. <source>PLoS Genet</source>., <volume>9</volume>, <fpage>e1003534</fpage>.<pub-id pub-id-type="pmid">23754958</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bleykasten-Grosshans</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Neuvéglise</surname><given-names>C.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Transposable elements in yeasts</article-title>. <source>CR Biol</source>., <volume>334</volume>, <fpage>679</fpage>–<lpage>686</lpage>.</mixed-citation>
    </ref>
    <ref id="btz727-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Campbell</surname><given-names>I.M.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Human endogenous retroviral elements promote genome instability via non-allelic homologous recombination</article-title>. <source>BMC Biol</source>., <volume>12</volume>, <fpage>74</fpage>.<pub-id pub-id-type="pmid">25246103</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Campo</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Whole-genome sequencing of two North American <italic>Drosophila melanogaster</italic> populations reveals genetic differentiation and positive selection</article-title>. <source>Mol. Ecol</source>., <volume>22</volume>, <fpage>5084</fpage>–<lpage>5097</lpage>.<pub-id pub-id-type="pmid">24102956</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>P-MITE: a database for plant miniature inverted-repeat transposable elements</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>D1176</fpage>–<lpage>1181</lpage>.<pub-id pub-id-type="pmid">24174541</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chuong</surname><given-names>E.B.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Regulatory activities of transposable elements: from conflicts to benefits</article-title>. <source>Nat. Rev. Genet</source>., <volume>18</volume>, <fpage>71</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">27867194</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>S.R.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Accelerated profile HMM searches</article-title>. <source>PLoS Comput. Biol</source>., <volume>7</volume>, <fpage>e1002195.</fpage><pub-id pub-id-type="pmid">22039361</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Elbarbary</surname><given-names>R.A.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Retrotransposons as regulators of gene expression</article-title>. <source>Science</source>, <volume>351</volume>, <fpage>aac7247.</fpage><pub-id pub-id-type="pmid">26912865</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ellinghaus</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>LTRharvest, an efficient and flexible software for de novo detection of LTR retrotransposons</article-title>. <source>BMC Bioinformatics</source>, <volume>9</volume>, <fpage>18.</fpage><pub-id pub-id-type="pmid">18194517</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fiston-Lavier</surname><given-names>A.S.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>T-lex2: genotyping, frequency estimation and re-annotation of transposable elements using single or pooled next-generation sequencing data</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>e22</fpage>.<pub-id pub-id-type="pmid">25510498</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fiston-Lavier</surname><given-names>A.S.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>T-lex: a program for fast and accurate assessment of transposable element presence using next-generation sequencing data</article-title>. <source>Nucleic Acids Res</source>., <volume>39</volume>, <fpage>e36</fpage>.<pub-id pub-id-type="pmid">21177644</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fu</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>3150</fpage>–<lpage>3152</lpage>.<pub-id pub-id-type="pmid">23060610</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gardner</surname><given-names>E.J.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>The Mobile Element Locator Tool (MELT): population-scale mobile element discovery and biology</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>1916</fpage>–<lpage>1929</lpage>.<pub-id pub-id-type="pmid">28855259</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goerner-Potvin</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Bourque</surname><given-names>G.</given-names></name></person-group> (<year>2018</year>) 
<article-title>Computational tools to unmask transposable elements</article-title>. <source>Nat. Rev. Genet</source>., <volume>19</volume>, <fpage>688</fpage>–<lpage>704</lpage>.<pub-id pub-id-type="pmid">30232369</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guio</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>González</surname><given-names>J.</given-names></name></person-group> (<year>2019</year>) 
<article-title>New insights on the evolution of genome content: population dynamics of transposable elements in flies and humans</article-title>. <source>Methods Mol. Biol</source>., <volume>1910</volume>, <fpage>505</fpage>–<lpage>530</lpage>.<pub-id pub-id-type="pmid">31278675</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guirao-Rico</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>González</surname><given-names>J.</given-names></name></person-group> (<year>2019</year>) 
<article-title>Evolutionary insights from large scale resequencing datasets in <italic>Drosophila melanogaster</italic></article-title>. <source>Curr. Opin. Insect Sci</source>., <volume>31</volume>, <fpage>70</fpage>–<lpage>76</lpage>.<pub-id pub-id-type="pmid">31109676</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Han</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Wessler</surname><given-names>S.R.</given-names></name></person-group> (<year>2010</year>) 
<article-title>MITE-Hunter: a program for discovering miniature inverted-repeat transposable elements from genomic sequences</article-title>. <source>Nucleic Acids Res</source>., <volume>38</volume>, <fpage>e199.</fpage><pub-id pub-id-type="pmid">20880995</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hatem</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Benchmarking short sequence mapping tools</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>184</fpage>.<pub-id pub-id-type="pmid">23758764</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hoban</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Finding the genomic basis of local adaptation: pitfalls, practical solutions, and future directions</article-title>. <source>Am. Nat</source>., <volume>188</volume>, <fpage>379</fpage>–<lpage>397</lpage>.<pub-id pub-id-type="pmid">27622873</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huang</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Natural variation in genome architecture among 205 <italic>Drosophila melanogaster</italic> Genetic Reference Panel lines</article-title>. <source>Genome Res</source>., <volume>24</volume>, <fpage>1193</fpage>–<lpage>1208</lpage>.<pub-id pub-id-type="pmid">24714809</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kapun</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Genomic analysis of European Drosophila populations reveals longitudinal structure and continent-wide selection</article-title>. <source>bioRxiv</source>, <fpage>313759</fpage>.</mixed-citation>
    </ref>
    <ref id="btz727-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kofler</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Sequencing of pooled DNA samples (Pool-Seq) uncovers complex dynamics of transposable element insertions in <italic>Drosophila melanogaster</italic></article-title>. <source>PLoS Genet</source>., <volume>8</volume>, <fpage>e1002487.</fpage><pub-id pub-id-type="pmid">22291611</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kofler</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>PoPoolationTE2: comparative population genomics of transposable elements using Pool-Seq</article-title>. <source>Mol. Biol. Evol</source>., <volume>33</volume>, <fpage>2759</fpage>–<lpage>2764</lpage>.<pub-id pub-id-type="pmid">27486221</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lack</surname><given-names>J.B.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A thousand fly genomes: an expanded drosophila genome nexus</article-title>. <source>Mol. Biol. Evol</source>., <volume>33</volume>, <fpage>3308</fpage>–<lpage>3313</lpage>.<pub-id pub-id-type="pmid">27687565</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>J.A.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>A DNA replication mechanism for generating nonrecurrent rearrangements associated with genomic disorders</article-title>. <source>Cell</source>, <volume>131</volume>, <fpage>1235</fpage>–<lpage>1247</lpage>.<pub-id pub-id-type="pmid">18160035</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R.</given-names></name></person-group> (<year>2009</year>) 
<article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1754</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>. <source>Genome Res</source>., <volume>18</volume>, <fpage>1851</fpage>–<lpage>1858</lpage>.<pub-id pub-id-type="pmid">18714091</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mascher</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>A chromosome conformation capture ordered sequence of the barley genome</article-title>. <source>Nature</source>, <volume>544</volume>, <fpage>427</fpage>–<lpage>433</lpage>.<pub-id pub-id-type="pmid">28447635</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Miller</surname><given-names>D.E.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Highly contiguous genome assemblies of 15</article-title>. <source>G3 (Bethesda)</source>, <volume>8</volume>, <fpage>3131</fpage>–<lpage>3141</lpage>.<pub-id pub-id-type="pmid">30087105</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pool</surname><given-names>J.E.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Population genomics of Sub-Saharan <italic>Drosophila melanogaster</italic>: African Diversity and Non-African Admixture</article-title>. <source>PLoS Genet</source>., <volume>8</volume>, <fpage>e1003080</fpage>.<pub-id pub-id-type="pmid">23284287</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rahman</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Unique transposon landscapes are pervasive across <italic>Drosophila melanogaster</italic> genomes</article-title>. <source>Nucleic Acids Res</source>, <volume>43</volume>, <fpage>10655</fpage>–<lpage>10672</lpage>.<pub-id pub-id-type="pmid">26578579</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rech</surname><given-names>G.E.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Stress response, behavior, and development are shaped by transposable element-induced mutations in Drosophila</article-title>. <source>PLoS Genet</source>., <volume>15</volume>, <fpage>e1007900</fpage>.<pub-id pub-id-type="pmid">30753202</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rishishwar</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Benchmarking computational tools for polymorphic transposable element detection</article-title>. <source>Brief. Bioinform</source>., <volume>18</volume>, <fpage>908</fpage>–<lpage>918</lpage>.<pub-id pub-id-type="pmid">27524380</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robb</surname><given-names>S.M.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>The use of RelocaTE and unassembled short reads to produce high-resolution snapshots of transposable element generated diversity in rice</article-title>. <source>G3 (Bethesda)</source>, <volume>3</volume>, <fpage>949</fpage>–<lpage>957</lpage>.<pub-id pub-id-type="pmid">23576519</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>J.T.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Variant review with the integrative genomics viewer</article-title>. <source>Cancer Res</source>., <volume>77</volume>, <fpage>e31</fpage>–<lpage>e34</lpage>.<pub-id pub-id-type="pmid">29092934</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Santander</surname><given-names>C.G.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>STEAK: a specific tool for transposable elements and retrovirus detection in high-throughput sequencing data</article-title>. <source>Virus Evol</source>., <volume>3</volume>, <fpage>23</fpage>.</mixed-citation>
    </ref>
    <ref id="btz727-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sasaki</surname><given-names>T.</given-names></name>International Rice Genome Sequencing,P.</person-group> (<year>2005</year>) 
<article-title>The map-based sequence of the rice genome</article-title>. <source>Nature</source>, <volume>436</volume>, <fpage>793</fpage>–<lpage>800</lpage>.<pub-id pub-id-type="pmid">16100779</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schnable</surname><given-names>P.S.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>The B73 maize genome: complexity, diversity, and dynamics</article-title>. <source>Science</source>, <volume>326</volume>, <fpage>1112</fpage>–<lpage>1115</lpage>.<pub-id pub-id-type="pmid">19965430</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Solares</surname><given-names>E.A.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Rapid low-cost assembly of the <italic>Drosophila melanogaster</italic> reference genome using low-coverage, long-read sequencing</article-title>. <source>G3 (Bethesda)</source>, <volume>8</volume>, <fpage>3143</fpage>–<lpage>3154</lpage>.<pub-id pub-id-type="pmid">30018084</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Startek</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Genome-wide analyses of LINE-LINE-mediated nonallelic homologous recombination</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>2188</fpage>–<lpage>2198</lpage>.<pub-id pub-id-type="pmid">25613453</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stewart</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>A comprehensive map of mobile element insertion polymorphisms in humans</article-title>. <source>PLoS Genet</source>., <volume>7</volume>, <fpage>e1002236</fpage>.<pub-id pub-id-type="pmid">21876680</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>van Dijk</surname><given-names>E.L.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>The third revolution in sequencing technology</article-title>. <source>Trends Genet</source>., <volume>34</volume>, <fpage>666</fpage>–<lpage>681</lpage>.<pub-id pub-id-type="pmid">29941292</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Villanueva-Cañas</surname><given-names>J.L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Beyond SNPs: how to detect selection on transposable element insertions</article-title>. <source>Methods Ecol. Evol</source>., <volume>8</volume>, <fpage>728</fpage>–<lpage>737</lpage>.</mixed-citation>
    </ref>
    <ref id="btz727-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Extensive sequence divergence between the reference genomes of two elite indica rice varieties Zhenshan 97 and Minghui 63</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>113</volume>, <fpage>E5163</fpage>–<lpage>5171</lpage>.<pub-id pub-id-type="pmid">27535938</pub-id></mixed-citation>
    </ref>
    <ref id="btz727-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhuang</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>TEMP: a computational method for analyzing transposable element polymorphism in populations</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>6826</fpage>–<lpage>6838</lpage>.<pub-id pub-id-type="pmid">24753423</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
