<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">gbe</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1759-6653</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7259675</article-id>
    <article-id pub-id-type="doi">10.1093/gbe/evaa087</article-id>
    <article-id pub-id-type="publisher-id">evaa087</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Letter</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>mstree: A Multispecies Coalescent Approach for Estimating Ancestral Population Size and Divergence Time during Speciation with Gene Flow</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-2651-4654</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Junfeng</given-names>
        </name>
        <xref ref-type="corresp" rid="evaa087-cor1"/>
        <xref ref-type="aff" rid="evaa087-aff1">e1</xref>
        <!--<email>liujunfeng@big.ac.cn</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Qiao</given-names>
        </name>
        <xref ref-type="aff" rid="evaa087-aff2">e2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Qingzhu</given-names>
        </name>
        <xref ref-type="corresp" rid="evaa087-cor1"/>
        <xref ref-type="aff" rid="evaa087-aff1">e1</xref>
        <xref ref-type="aff" rid="evaa087-aff2">e2</xref>
        <!--<email>liujunfeng@big.ac.cn</email>-->
      </contrib>
    </contrib-group>
    <aff id="evaa087-aff1"><label>e1</label><institution>Beijing Institute of Genomics, Chinese Academy of Sciences</institution>, Beijing, China</aff>
    <aff id="evaa087-aff2"><label>e2</label><institution>Department of Automation, Tsinghua University</institution>, Beijing, China</aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Bryant</surname>
          <given-names>David T E</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="evaa087-cor1">Corresponding authors: E-mails: <email>liujunfeng@big.ac.cn</email>; <email>yangqz@mail.tsinghua.edu.cn</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-05-04">
      <day>04</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>12</volume>
    <issue>5</issue>
    <fpage>715</fpage>
    <lpage>719</lpage>
    <history>
      <date date-type="accepted">
        <day>27</day>
        <month>4</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press on behalf of the Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="evaa087.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Gene flow between species may cause variations in branch length and topology of gene tree, which are beyond the expected variations from ancestral processes. These additional variations make it difficult to estimate parameters during speciation with gene flow, as the pattern of these additional variations differs with the relationship between isolation and migration. As far as we know, most methods rely on the assumption about the relationship between isolation and migration by a given model, such as the isolation-with-migration model, when estimating parameters during speciation with gene flow. In this article, we develop a multispecies coalescent approach which does not rely on any assumption about the relationship between isolation and migration when estimating parameters and is called mstree. mstree is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/liujunfengtop/MStree/">https://github.com/liujunfengtop/MStree/</ext-link> and uses some mathematical inequalities among several factors, which include the species divergence time, the ancestral population size, and the number of gene trees, to estimate parameters during speciation with gene flow. Using simulations, we show that the estimated values of ancestral population sizes and species divergence times are close to the true values when analyzing the simulation data sets, which are generated based on the isolation-with-initial-migration model, secondary contact model, and isolation-with-migration model. Therefore, our method is able to estimate ancestral population sizes and speciation times in the presence of different modes of gene flow and may be helpful to test different theories of speciation.</p>
    </abstract>
    <kwd-group>
      <kwd>coalescent</kwd>
      <kwd>gene tree</kwd>
      <kwd>mathematical inequalities</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>31501081</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The role of gene flow in speciation is a fundamental issue in evolutionary biology. Allopatric speciation considers complete lack of gene flow as prerequisite to the formation of new species. However, parapatric and sympatric speciation allow gene flow during speciation. Although allopatric speciation has been historically taken as the paramount mode of speciation (<xref rid="evaa087-B5" ref-type="bibr">Futuyma and Mayer 1980</xref>), theoretical modeling and empirical evidence increasingly support that speciation can occur with gene flow (<xref rid="evaa087-B6" ref-type="bibr">Gourbiere and Mallet 2010</xref>; <xref rid="evaa087-B11" ref-type="bibr">Smadja and Butlin 2011</xref>; <xref rid="evaa087-B4" ref-type="bibr">Feder et al. 2012</xref>).</p>
    <p>There are usually two kinds of models to make inferences about gene flow during speciation. Some methods are based on an isolation-with-migration (IM) model (<xref rid="evaa087-B13" ref-type="bibr">Wang and Hey 2010</xref>; <xref rid="evaa087-B12" ref-type="bibr">Tian and Kubatko 2016</xref>; <xref rid="evaa087-B3" ref-type="bibr">Dalquen et al. 2017</xref>) and others on an isolation-with-initial-migration (IIM) model (<xref rid="evaa087-B9" ref-type="bibr">Mailund et al. 2012</xref>; <xref rid="evaa087-B2" ref-type="bibr">Costa and Wilkinson-Herbots 2017</xref>). However, the above two models include an assumption about the relationship between isolation and migration. Here, we use the properties of coalescent-based model in gene tree data for estimating the important parameters such as ancestral population sizes and divergence times without any assumption of the relationship between isolation and migration. Furthermore, we conduct simulations to examine the accuracy of the estimates of parameters. The simulation results show that our method can accurately estimate the parameters. At last, we compared mstree with the program 3s (<xref rid="evaa087-B3" ref-type="bibr">Dalquen et al. 2017</xref>) and IMa3 (<xref rid="evaa087-B7" ref-type="bibr">Hey et al. 2018</xref>) with simulation data; the simulation results show that mstree is faster than 3s and IMa3.</p>
  </sec>
  <sec>
    <title>Materials and Methods</title>
    <sec>
      <title>The Theoretical Model</title>
      <p>Consider two closely related species (1 and 2) with an outgroup species 3. We assume that there is only gene flow between two closely related species (<xref ref-type="fig" rid="evaa087-F1">fig. 1</xref>). We use <inline-formula id="IE1"><mml:math id="IM1"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE2"><mml:math id="IM2"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> to denote the two species divergence times, scaled by mutation rate. Let <inline-formula id="IE3"><mml:math id="IM3"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>μ</mml:mo></mml:math></inline-formula> and <inline-formula id="IE4"><mml:math id="IM4"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>μ</mml:mo></mml:math></inline-formula> measure the two ancestral species population sizes. Here, <inline-formula id="IE5"><mml:math id="IM5"><mml:mo>μ</mml:mo></mml:math></inline-formula> is the mutation rate per site and generation, and the <inline-formula id="IE6"><mml:math id="IM6"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE7"><mml:math id="IM7"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> denote the effective population sizes. There are five possible gene trees for a locus with three sequences (<italic>k</italic>, <italic>l</italic>, and <italic>m</italic>), which are from species 1, species 2, and species 3, respectively (<xref ref-type="fig" rid="evaa087-F2">fig. 2</xref>). For any locus, <inline-formula id="IE8"><mml:math id="IM8"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the coalescent time among three sequences and <inline-formula id="IE9"><mml:math id="IM9"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the coalescent time between two sequences. In the presence of gene flow between species 1 and species 2, the gene tree <italic>G</italic><sub>1</sub> may be possible at a locus. Otherwise, only gene trees <italic>G</italic><sub>2</sub>–<italic>G</italic><sub>5</sub> are possible. In this study, the term “loci” refers to independent or loosely linked short segments of the genome, and we assume that there is no recombination within a locus while different loci are free recombining. For tens of thousands of loci, there are some mathematical inequalities among the species divergence time, the ancestral species population size, and the number of gene trees, of which <inline-formula id="IE10"><mml:math id="IM10"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is larger than <inline-formula id="IE11"><mml:math id="IM11"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. Based on the coalescent theory with no gene flow under given species, the probability of gene tree, of which <inline-formula id="IE12"><mml:math id="IM12"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> belongs to <inline-formula id="IE13"><mml:math id="IM13"><mml:mfenced open="[" close="" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced open="" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>, is <inline-formula id="IE14"><mml:math id="IM14"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>; and the probability of gene tree, of which <inline-formula id="IE15"><mml:math id="IM15"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> belongs to <inline-formula id="IE16"><mml:math id="IM16"><mml:mfenced open="[" close="" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced open="" separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>,</mml:mo><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula id="IE17"><mml:math id="IM17"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is less than <inline-formula id="IE18"><mml:math id="IM18"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, is <inline-formula id="IE19"><mml:math id="IM19"><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>. We use <italic>g<sub>i</sub></italic>([<italic>a</italic>, <italic>b</italic>],[<italic>c</italic>, <italic>d</italic>]) as the number of gene trees with category <italic>G<sub>i</sub></italic> (<xref ref-type="fig" rid="evaa087-F2">fig. 2</xref>) and with <inline-formula id="IE20"><mml:math id="IM20"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is in [<italic>a</italic>, <italic>b</italic>] and <inline-formula id="IE21"><mml:math id="IM21"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> in [<italic>c</italic>, <italic>d</italic>] for <italic>i</italic> = 1, 2, …, 5. Moreover, to simplify notation, let <italic>g<sub>i</sub></italic> denote the number of gene trees with category <italic>G<sub>i</sub></italic> (<xref ref-type="fig" rid="evaa087-F2">fig. 2</xref>) for <italic>i</italic> = 1, …, 5. Then, the formulas of cases A and C are as follows: </p>
      <p>
        <disp-quote content-type="extract">
          <p>Case A: If <inline-formula id="IE26"><mml:math id="IM22"><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, then <inline-formula id="IE27"><mml:math id="IM23"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>[</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> for the category <italic>G</italic><sub>2</sub>–<italic>G</italic><sub>5</sub> (<xref ref-type="fig" rid="evaa087-F2">fig. 2</xref>).
</p>
          <p>Case B: If <inline-formula id="IE28"><mml:math id="IM28"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, then <inline-formula id="IE29"><mml:math id="IM29"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> for the category <italic>G</italic><sub>1</sub>–<italic>G</italic><sub>2</sub> (<xref ref-type="fig" rid="evaa087-F2">fig. 2</xref>).</p>
          <p>Case C: <inline-formula id="IE30"><mml:math id="IM30"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> for the category <italic>G</italic><sub>2</sub>–<italic>G</italic><sub>5</sub> (<xref ref-type="fig" rid="evaa087-F2">fig. 2</xref>).</p>
        </disp-quote>
      </p>
      <fig id="evaa087-F1" orientation="portrait" position="float">
        <label><sc>Fig</sc>. 1.</label>
        <caption>
          <p>—Species tree ((1, 2), 3) for three species. The species divergence times are denoted as <inline-formula id="IE22"><mml:math id="IM24"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE23"><mml:math id="IM25"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. The ancestral species population sizes are denoted as <inline-formula id="IE24"><mml:math id="IM26"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE25"><mml:math id="IM27"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
        </caption>
        <graphic xlink:href="evaa087f1"/>
      </fig>
      <fig id="evaa087-F2" orientation="portrait" position="float">
        <label><sc>Fig</sc>. 2.</label>
        <caption>
          <p>—For three species (1–3) with gene flow between species 1 and 2, there are five categories of gene trees for any locus with three sequences (<italic>k</italic>, <italic>l</italic>, and <italic>m</italic>), which are from species 1, species 2, and species 3, respectively.</p>
        </caption>
        <graphic xlink:href="evaa087f2"/>
      </fig>
      <p>The above gene tree distributions allow us to compute the parameters <inline-formula id="IE31"><mml:math id="IM31"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE32"><mml:math id="IM32"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE33"><mml:math id="IM33"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula id="IE34"><mml:math id="IM34"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. The approach of estimating the parameters is called mstree and the strategies are as follows. First, we can estimate the value of <inline-formula id="IE35"><mml:math id="IM35"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> based on the fact that the shape of gene tree may be ((<italic>k</italic>, <italic>l</italic>),<italic>m</italic>), ((<italic>k</italic>, <italic>m</italic>),<italic>l</italic>) or ((<italic>l</italic>, <italic>m</italic>),<italic>k</italic>) with equal probability when <inline-formula id="IE36"><mml:math id="IM36"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is larger than <inline-formula id="IE37"><mml:math id="IM37"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. If there exists <inline-formula id="IE38"><mml:math id="IM38"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> that satisfies <inline-formula id="IE39"><mml:math id="IM39"><mml:mn>2</mml:mn><mml:mi>a</mml:mi><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, where <inline-formula id="IE40"><mml:math id="IM40"><mml:mi>a</mml:mi></mml:math></inline-formula> is the number of gene trees, of which <inline-formula id="IE41"><mml:math id="IM41"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is larger than <inline-formula id="IE42"><mml:math id="IM42"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and the shape is ((<italic>k</italic>, <italic>l</italic>),<italic>m</italic>) (<xref ref-type="fig" rid="evaa087-F2">fig. 2</xref>: <italic>G</italic><sub>3</sub>); <inline-formula id="IE43"><mml:math id="IM43"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the number of gene trees, of which the shape is ((<italic>k</italic>, <italic>m</italic>),<italic>l</italic>) (<xref ref-type="fig" rid="evaa087-F2">fig. 2</xref>: <italic>G</italic><sub>4</sub>); and <inline-formula id="IE44"><mml:math id="IM44"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the number of gene trees, of which the shape is ((<italic>l</italic>, <italic>m</italic>),<italic>k</italic>) (<xref ref-type="fig" rid="evaa087-F2">fig. 2</xref>: <italic>G</italic><sub>5</sub>), <inline-formula id="IE45"><mml:math id="IM45"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> can be considered as the estimated value of <inline-formula id="IE46"><mml:math id="IM46"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. Second, we can estimate the value of <inline-formula id="IE47"><mml:math id="IM47"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> based on the estimated value of <inline-formula id="IE48"><mml:math id="IM48"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> by using the formula <inline-formula id="IE49"><mml:math id="IM49"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula> in case B. When we choose <inline-formula id="IE50"><mml:math id="IM50"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula id="IE51"><mml:math id="IM51"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> that satisfy <inline-formula id="IE52"><mml:math id="IM52"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, the estimated value of <inline-formula id="IE53"><mml:math id="IM53"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> approximates <inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi mathvariant="italic">log</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE55"><mml:math id="IM55"><mml:mi>a</mml:mi></mml:math></inline-formula> is the number of gene trees, of which <inline-formula id="IE56"><mml:math id="IM56"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is larger than <inline-formula id="IE57"><mml:math id="IM57"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula id="IE58"><mml:math id="IM58"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is less than <inline-formula id="IE59"><mml:math id="IM59"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>; <inline-formula id="IE60"><mml:math id="IM60"><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the number of gene trees, of which <inline-formula id="IE61"><mml:math id="IM61"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> belong to <inline-formula id="IE62"><mml:math id="IM62"><mml:mfenced open="[" close="" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mfenced><mml:mfenced open="" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula id="IE63"><mml:math id="IM63"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is less than <inline-formula id="IE64"><mml:math id="IM64"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. Similarly, we can also estimate the value of <inline-formula id="IE65"><mml:math id="IM65"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> based on the estimated value of <inline-formula id="IE66"><mml:math id="IM66"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> by using the formula <inline-formula id="IE67"><mml:math id="IM67"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula> in case A. If we choose <inline-formula id="IE68"><mml:math id="IM68"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> that is less than <inline-formula id="IE69"><mml:math id="IM69"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and assume that <inline-formula id="IE70"><mml:math id="IM70"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is larger than <inline-formula id="IE71"><mml:math id="IM71"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> when <inline-formula id="IE72"><mml:math id="IM72"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is closed to <inline-formula id="IE73"><mml:math id="IM73"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, the estimated value of <inline-formula id="IE74"><mml:math id="IM74"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> approximates <inline-formula id="IE75"><mml:math id="IM75"><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi mathvariant="italic">log</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE76"><mml:math id="IM76"><mml:mi>a</mml:mi></mml:math></inline-formula> is the number of gene trees, of which <inline-formula id="IE77"><mml:math id="IM77"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is larger than <inline-formula id="IE78"><mml:math id="IM78"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE79"><mml:math id="IM79"><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the number of gene trees, of which <inline-formula id="IE80"><mml:math id="IM80"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> belongs to <inline-formula id="IE81"><mml:math id="IM81"><mml:mfenced open="[" close="" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mfenced><mml:mfenced open="" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>. Lastly, we estimate the value of <inline-formula id="IE82"><mml:math id="IM82"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> based on the values of <inline-formula id="IE83"><mml:math id="IM83"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE84"><mml:math id="IM84"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> by using the formula <inline-formula id="IE85"><mml:math id="IM85"><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> in case C. If there exists <inline-formula id="IE86"><mml:math id="IM86"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> that is less than <inline-formula id="IE87"><mml:math id="IM87"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and satisfies <inline-formula id="IE88"><mml:math id="IM88"><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>, where <inline-formula id="IE89"><mml:math id="IM89"><mml:mi>a</mml:mi></mml:math></inline-formula> is the number of gene trees, of which <inline-formula id="IE90"><mml:math id="IM90"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is larger than <inline-formula id="IE91"><mml:math id="IM91"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and the shape is ((<italic>k</italic>, <italic>l</italic>),<italic>m</italic>) (<xref ref-type="fig" rid="evaa087-F2">fig. 2</xref>: <italic>G</italic><sub>2</sub>–<italic>G</italic><sub>3</sub>); <inline-formula id="IE92"><mml:math id="IM92"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the number of gene trees, of which the shape is ((<italic>k</italic>, <italic>m</italic>),<italic>l</italic>) (<xref ref-type="fig" rid="evaa087-F2">fig. 2</xref>: <italic>G</italic><sub>4</sub>); and <inline-formula id="IE93"><mml:math id="IM93"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the number of gene trees, of which the shape is ((<italic>l</italic>, <italic>m</italic>),<italic>k</italic>) (<xref ref-type="fig" rid="evaa087-F2">fig. 2</xref>: <italic>G</italic><sub>5</sub>), <inline-formula id="IE94"><mml:math id="IM94"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> can be considered as the estimated value of <inline-formula id="IE95"><mml:math id="IM95"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>The Simulation</title>
      <p>We simulated gene trees by using the program ms (<xref rid="evaa087-B8" ref-type="bibr">Hudson 2002</xref>) and converted gene trees to sequence data under JC69 model by using seq-gen (<xref rid="evaa087-B10" ref-type="bibr">Rambaut and Grassly 1997</xref>). The example of command is as follows:</p>
      <p>
        <disp-quote content-type="extract">
          <p>./ms id="465" 3 50000 -T -I 3 1 1 1 -m 1 2 0 -m 2 1 0 -em 0.667 1 2 4 -em 0.667 2 1 4 -em 1 1 2 0 -em 1 2 1 0 -ej 1 2 1 -ej 2 3 1 | tail -n + 4 | grep -v//&gt; tree</p>
          <p>./seq-gen -m HKY -l 500 -s 0.01 -t 2.0 &lt; tree &gt; infile</p>
        </disp-quote>
      </p>
    </sec>
    <sec>
      <title>Compared with IMa3 and Analyzed Real Data</title>
      <p>The model estimated by IMa3 is IM model, and we used a fixed true species topology for IMa3. The real data are the genomic sequences of the human (H), chimpanzee (C), and gorilla (G) from <xref rid="evaa087-B1" ref-type="bibr">Burgess and Yang (2008)</xref>. The data set comprises 14,663 autosomal loci, and the mean locus length is 508 bp.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>The Accuracy of mstree</title>
      <p>We used the program ms (<xref rid="evaa087-B8" ref-type="bibr">Hudson 2002</xref>) to simulate gene trees at multi loci under the IIM, secondary contact (SC), and IM model. For the IIM model, the gene flow stopped at <inline-formula id="IE96"><mml:math id="IM96"><mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> in the past; For the SC model, the time of SC began at <inline-formula id="IE97"><mml:math id="IM97"><mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> in the past. Two sets of parameter values were used, roughly based on estimates from the hominoids (<xref rid="evaa087-B1" ref-type="bibr">Burgess and Yang 2008</xref>) and the mangroves (<xref rid="evaa087-B14" ref-type="bibr">Zhou et al. 2007</xref>). They are as follows: <inline-formula id="IE98"><mml:math id="IM98"><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.005</mml:mn></mml:math></inline-formula>, <inline-formula id="IE99"><mml:math id="IM99"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.006</mml:mn></mml:math></inline-formula>, and <inline-formula id="IE100"><mml:math id="IM100"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.004</mml:mn></mml:math></inline-formula> (hominoids); <inline-formula id="IE101"><mml:math id="IM101"><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:math></inline-formula>, <inline-formula id="IE102"><mml:math id="IM102"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn></mml:math></inline-formula>, and <inline-formula id="IE103"><mml:math id="IM103"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:math></inline-formula> (mangroves). For the three models, gene flow is symmetrical and the migration rate (the expected number of migrants per generation) is 1. The number of loci is 10,000 and the number of replicates is 1,000. Analyzing the simulation data by using mstree, the results show that the parameter estimates are very close to the true values and are not sensitive to the model’s assumption about the relationship between isolation and migration (<xref rid="evaa087-T1" ref-type="table">table 1</xref>). <inline-formula id="IE104"><mml:math id="IM104"><mml:mo>ε</mml:mo></mml:math></inline-formula> in <xref rid="evaa087-T1" ref-type="table">table 1</xref> is the threshold value in mstree and describes the degree of approximation between two sides of the formulas in cases A, B, and C. For example, in case A, <inline-formula id="IE105"><mml:math id="IM105"><mml:mo>ε</mml:mo><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:math></inline-formula> means the value of <inline-formula id="IE106"><mml:math id="IM106"><mml:mrow><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> should be &lt;0.03 when <inline-formula id="IE107"><mml:math id="IM107"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula>. In mstree, the value of <inline-formula id="IE108"><mml:math id="IM108"><mml:mo>ε</mml:mo></mml:math></inline-formula> must be &lt;0.05. The results in <xref rid="evaa087-T1" ref-type="table">table 1</xref> show that the smaller <inline-formula id="IE109"><mml:math id="IM109"><mml:mo>ε</mml:mo></mml:math></inline-formula> increased the standard deviations of the parameter estimates and the estimate of <inline-formula id="IE110"><mml:math id="IM110"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. Therefore, we suggest that the value of <inline-formula id="IE111"><mml:math id="IM111"><mml:mo>ε</mml:mo></mml:math></inline-formula> should be 0.03 when using mstree. Furthermore, we applied mstree to additional two parameter sets (<xref rid="evaa087-B3" ref-type="bibr">Dalquen et al. 2017</xref>), which have larger parameter values and different values for two <inline-formula id="IE112"><mml:math id="IM112"><mml:mo>θ</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:math></inline-formula> (<xref rid="evaa087-T2" ref-type="table">table 2</xref>). The results show that mstree still performs well.
</p>
      <table-wrap id="evaa087-T1" orientation="portrait" position="float">
        <label>Table 1</label>
        <caption>
          <p>The Estimated Species Divergence Time and Population Size with Different Threshold Value</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1"/>
              <th rowspan="2" colspan="1">Threshold</th>
              <th colspan="4" rowspan="1">Hominoid<hr/></th>
              <th colspan="4" rowspan="1">Mangrove<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE113">
                  <mml:math id="IM113">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>θ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE114">
                  <mml:math id="IM114">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>θ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE115">
                  <mml:math id="IM115">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE116">
                  <mml:math id="IM116">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE117">
                  <mml:math id="IM117">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>θ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE118">
                  <mml:math id="IM118">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>θ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE119">
                  <mml:math id="IM119">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE120">
                  <mml:math id="IM120">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="3" colspan="1">IIM model</td>
              <td rowspan="1" colspan="1"><italic>ε</italic> = 0.007</td>
              <td rowspan="1" colspan="1">0.50 <inline-formula id="IE121"><mml:math id="IM121"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.02</td>
              <td rowspan="1" colspan="1">0.49 <inline-formula id="IE122"><mml:math id="IM122"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.04</td>
              <td rowspan="1" colspan="1">0.60 <inline-formula id="IE123"><mml:math id="IM123"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.00</td>
              <td rowspan="1" colspan="1">0.42 <inline-formula id="IE124"><mml:math id="IM124"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.04</td>
              <td rowspan="1" colspan="1">1.00 <inline-formula id="IE125"><mml:math id="IM125"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.06</td>
              <td rowspan="1" colspan="1">0.97 <inline-formula id="IE126"><mml:math id="IM126"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.11</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE127"><mml:math id="IM127"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.01</td>
              <td rowspan="1" colspan="1">1.25 <inline-formula id="IE128"><mml:math id="IM128"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.29</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>ε</italic> = 0.01</td>
              <td rowspan="1" colspan="1">0.50 <inline-formula id="IE129"><mml:math id="IM129"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.02</td>
              <td rowspan="1" colspan="1">0.49 <inline-formula id="IE130"><mml:math id="IM130"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.03</td>
              <td rowspan="1" colspan="1">0.60 <inline-formula id="IE131"><mml:math id="IM131"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.00</td>
              <td rowspan="1" colspan="1">0.41 <inline-formula id="IE132"><mml:math id="IM132"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.03</td>
              <td rowspan="1" colspan="1">1.00 <inline-formula id="IE133"><mml:math id="IM133"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.05</td>
              <td rowspan="1" colspan="1">0.98 <inline-formula id="IE134"><mml:math id="IM134"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.07</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE135"><mml:math id="IM135"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.01</td>
              <td rowspan="1" colspan="1">1.14 <inline-formula id="IE136"><mml:math id="IM136"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.22</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>ε</italic> = 0.03</td>
              <td rowspan="1" colspan="1">
                <bold>0.50</bold>
                <inline-formula id="IE137">
                  <mml:math id="IM137">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.02</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.50</bold>
                <inline-formula id="IE138">
                  <mml:math id="IM138">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.01</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.60</bold>
                <inline-formula id="IE139">
                  <mml:math id="IM139">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.00</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.39</bold>
                <inline-formula id="IE140">
                  <mml:math id="IM140">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.01</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>1.00</bold>
                <inline-formula id="IE141">
                  <mml:math id="IM141">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.02</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.99</bold>
                <inline-formula id="IE142">
                  <mml:math id="IM142">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.02</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>2.00</bold>
                <inline-formula id="IE143">
                  <mml:math id="IM143">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.01</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.99</bold>
                <inline-formula id="IE144">
                  <mml:math id="IM144">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.05</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="3" colspan="1">SC model</td>
              <td rowspan="1" colspan="1"><italic>ε</italic> = 0.007</td>
              <td rowspan="1" colspan="1">0.50 <inline-formula id="IE145"><mml:math id="IM145"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.02</td>
              <td rowspan="1" colspan="1">0.48 <inline-formula id="IE146"><mml:math id="IM146"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.05</td>
              <td rowspan="1" colspan="1">0.60 <inline-formula id="IE147"><mml:math id="IM147"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.00</td>
              <td rowspan="1" colspan="1">0.43 <inline-formula id="IE148"><mml:math id="IM148"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.05</td>
              <td rowspan="1" colspan="1">1.00 <inline-formula id="IE149"><mml:math id="IM149"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.06</td>
              <td rowspan="1" colspan="1">0.95 <inline-formula id="IE150"><mml:math id="IM150"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.14</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE151"><mml:math id="IM151"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.01</td>
              <td rowspan="1" colspan="1">1.31 <inline-formula id="IE152"><mml:math id="IM152"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.33</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>ε</italic> = 0.01</td>
              <td rowspan="1" colspan="1">0.50 <inline-formula id="IE153"><mml:math id="IM153"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.01</td>
              <td rowspan="1" colspan="1">0.49 <inline-formula id="IE154"><mml:math id="IM154"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.04</td>
              <td rowspan="1" colspan="1">0.60 <inline-formula id="IE155"><mml:math id="IM155"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.00</td>
              <td rowspan="1" colspan="1">0.42 <inline-formula id="IE156"><mml:math id="IM156"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.03</td>
              <td rowspan="1" colspan="1">1.00 <inline-formula id="IE157"><mml:math id="IM157"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.04</td>
              <td rowspan="1" colspan="1">0.97 <inline-formula id="IE158"><mml:math id="IM158"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.09</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE159"><mml:math id="IM159"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.01</td>
              <td rowspan="1" colspan="1">1.21 <inline-formula id="IE160"><mml:math id="IM160"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.27</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>ε</italic> = 0.03</td>
              <td rowspan="1" colspan="1">
                <bold>0.50</bold>
                <inline-formula id="IE161">
                  <mml:math id="IM161">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.01</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.50</bold>
                <inline-formula id="IE162">
                  <mml:math id="IM162">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.02</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.60</bold>
                <inline-formula id="IE163">
                  <mml:math id="IM163">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.00</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.39</bold>
                <inline-formula id="IE164">
                  <mml:math id="IM164">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.01</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>1.00</bold>
                <inline-formula id="IE165">
                  <mml:math id="IM165">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.02</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.99</bold>
                <inline-formula id="IE166">
                  <mml:math id="IM166">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.03</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>2.00</bold>
                <inline-formula id="IE167">
                  <mml:math id="IM167">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.01</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>1.01</bold>
                <inline-formula id="IE168">
                  <mml:math id="IM168">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.07</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="3" colspan="1">IM model</td>
              <td rowspan="1" colspan="1"><italic>ε</italic> = 0.007</td>
              <td rowspan="1" colspan="1">0.50 <inline-formula id="IE169"><mml:math id="IM169"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.02</td>
              <td rowspan="1" colspan="1">0.48 <inline-formula id="IE170"><mml:math id="IM170"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.06</td>
              <td rowspan="1" colspan="1">0.60 <inline-formula id="IE171"><mml:math id="IM171"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.00</td>
              <td rowspan="1" colspan="1">0.43 <inline-formula id="IE172"><mml:math id="IM172"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.05</td>
              <td rowspan="1" colspan="1">1.00 <inline-formula id="IE173"><mml:math id="IM173"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.06</td>
              <td rowspan="1" colspan="1">0.95 <inline-formula id="IE174"><mml:math id="IM174"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.15</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE175"><mml:math id="IM175"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.01</td>
              <td rowspan="1" colspan="1">1.34 <inline-formula id="IE176"><mml:math id="IM176"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.34</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>ε</italic> = 0.01</td>
              <td rowspan="1" colspan="1">0.50 <inline-formula id="IE177"><mml:math id="IM177"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.01</td>
              <td rowspan="1" colspan="1">0.49 <inline-formula id="IE178"><mml:math id="IM178"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.04</td>
              <td rowspan="1" colspan="1">0.60 <inline-formula id="IE179"><mml:math id="IM179"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.00</td>
              <td rowspan="1" colspan="1">0.41 <inline-formula id="IE180"><mml:math id="IM180"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.04</td>
              <td rowspan="1" colspan="1">1.00 <inline-formula id="IE181"><mml:math id="IM181"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.04</td>
              <td rowspan="1" colspan="1">0.96 <inline-formula id="IE182"><mml:math id="IM182"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.11</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE183"><mml:math id="IM183"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.01</td>
              <td rowspan="1" colspan="1">1.22 <inline-formula id="IE184"><mml:math id="IM184"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.28</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic>ε</italic> = 0.03</td>
              <td rowspan="1" colspan="1">
                <bold>0.50</bold>
                <inline-formula id="IE185">
                  <mml:math id="IM185">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.01</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.50</bold>
                <inline-formula id="IE186">
                  <mml:math id="IM186">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.02</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.60</bold>
                <inline-formula id="IE187">
                  <mml:math id="IM187">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.00</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.39</bold>
                <inline-formula id="IE188">
                  <mml:math id="IM188">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.01</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>1.00</bold>
                <inline-formula id="IE189">
                  <mml:math id="IM189">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.02</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.99</bold>
                <inline-formula id="IE190">
                  <mml:math id="IM190">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.03</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>2.00</bold>
                <inline-formula id="IE191">
                  <mml:math id="IM191">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.01</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>1.00</bold>
                <inline-formula id="IE192">
                  <mml:math id="IM192">
                    <mml:mo>±</mml:mo>
                  </mml:math>
                </inline-formula>
                <bold>0.07</bold>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><sc>Note</sc>.—The hominoid set is <italic>θ</italic><sub>0</sub> = <italic>θ</italic><sub>1</sub> = 0.005, <italic>τ</italic><sub>0</sub> = 0.006, and <italic>τ</italic><sub>1</sub> = 0.004. The mangrove set is <italic>θ</italic><sub>0</sub> = <italic>θ</italic><sub>1</sub> = 0.01, <italic>τ</italic><sub>0</sub> = 0.02, and <italic>τ</italic><sub>1</sub> = 0.01. <italic>θ</italic> and <italic>τ</italic> estimates are scaled by 10<sup>2</sup>. Gene flow is symmetrical and the migration rate is 1. <italic>ε</italic> is the threshold value in mstree. The number of loci is 10,000. The number of replicates is 1,000. IIM, isolation-with-initial-migration; SC, secondary contact; IM, isolation-with-migration. The best estimates are marked in bold.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap id="evaa087-T2" orientation="portrait" position="float">
        <label>Table 2</label>
        <caption>
          <p>The Estimated Species Divergence Time and Population Size with Larger and Different Parameter Values</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1"/>
              <th rowspan="2" colspan="1">Threshold</th>
              <th colspan="4" rowspan="1"><italic>θ</italic><sub>0</sub> = 0.02, <italic>θ</italic><sub>1</sub> = 0.03, <italic>τ</italic><sub>0</sub> = 0.06, <italic>τ</italic><sub>1</sub> = 0.04<hr/></th>
              <th colspan="4" rowspan="1"><italic>θ</italic><sub>0</sub> = 0.02, <italic>θ</italic><sub>1</sub> = 0.01, <italic>τ</italic><sub>0</sub> = 0.02, <italic>τ</italic><sub>1</sub> = 0.01<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE193">
                  <mml:math id="IM193">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>θ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE194">
                  <mml:math id="IM194">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>θ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE195">
                  <mml:math id="IM195">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE196">
                  <mml:math id="IM196">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE197">
                  <mml:math id="IM197">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>θ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE198">
                  <mml:math id="IM198">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>θ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE199">
                  <mml:math id="IM199">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE200">
                  <mml:math id="IM200">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">IIM model</td>
              <td rowspan="1" colspan="1"><italic>ε</italic> = 0.03</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE201"><mml:math id="IM201"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.08</td>
              <td rowspan="1" colspan="1">2.97 <inline-formula id="IE202"><mml:math id="IM202"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.10</td>
              <td rowspan="1" colspan="1">5.99 <inline-formula id="IE203"><mml:math id="IM203"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.03</td>
              <td rowspan="1" colspan="1">3.90 <inline-formula id="IE204"><mml:math id="IM204"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.17</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE205"><mml:math id="IM205"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.06</td>
              <td rowspan="1" colspan="1">1.00 <inline-formula id="IE206"><mml:math id="IM206"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.02</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE207"><mml:math id="IM207"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.01</td>
              <td rowspan="1" colspan="1">1.00 <inline-formula id="IE208"><mml:math id="IM208"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.03</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SC model</td>
              <td rowspan="1" colspan="1"><italic>ε</italic> = 0.03</td>
              <td rowspan="1" colspan="1">2.01 <inline-formula id="IE209"><mml:math id="IM209"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.06</td>
              <td rowspan="1" colspan="1">2.95 <inline-formula id="IE210"><mml:math id="IM210"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.17</td>
              <td rowspan="1" colspan="1">5.99 <inline-formula id="IE211"><mml:math id="IM211"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.03</td>
              <td rowspan="1" colspan="1">4.03 <inline-formula id="IE212"><mml:math id="IM212"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.19</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE213"><mml:math id="IM213"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.06</td>
              <td rowspan="1" colspan="1">1.00 <inline-formula id="IE214"><mml:math id="IM214"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.02</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE215"><mml:math id="IM215"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.02</td>
              <td rowspan="1" colspan="1">1.00 <inline-formula id="IE216"><mml:math id="IM216"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.04</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">IM model</td>
              <td rowspan="1" colspan="1"><italic>ε</italic> = 0.03</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE217"><mml:math id="IM217"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.05</td>
              <td rowspan="1" colspan="1">2.94 <inline-formula id="IE218"><mml:math id="IM218"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.29</td>
              <td rowspan="1" colspan="1">5.98 <inline-formula id="IE219"><mml:math id="IM219"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.05</td>
              <td rowspan="1" colspan="1">3.89 <inline-formula id="IE220"><mml:math id="IM220"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.46</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE221"><mml:math id="IM221"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.05</td>
              <td rowspan="1" colspan="1">1.00 <inline-formula id="IE222"><mml:math id="IM222"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.02</td>
              <td rowspan="1" colspan="1">2.00 <inline-formula id="IE223"><mml:math id="IM223"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.02</td>
              <td rowspan="1" colspan="1">1.00 <inline-formula id="IE224"><mml:math id="IM224"><mml:mo>±</mml:mo></mml:math></inline-formula> 0.04</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <p><sc>Note</sc>.—<italic>θ</italic> and <italic>τ</italic> estimates are scaled by 10<sup>2</sup>. Gene flow is symmetrical and the migration rate is 1. <italic>ε</italic> is the threshold value in mstree. The number of loci is 10,000. The number of replicates is 1,000. IIM, isolation-with-initial-migration; SC, secondary contact; IM, isolation-with-migration.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>The Factors That Influence Parameter Estimates</title>
      <p>In addition, we performed more simulations to test how different factors influence parameter estimates, such as the number of loci, migration rate, and the direction of migration. The numbers of loci are 5,000, 10,000, and 50,000; the migration rates are 0.1, 1, and 10; and the directions of migration are symmetrical and asymmetrical. The results are shown in <xref ref-type="supplementary-material" rid="sup1">supplementary tables S1–S6</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. For the parameters <inline-formula id="IE225"><mml:math id="IM225"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE226"><mml:math id="IM226"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula id="IE227"><mml:math id="IM227"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, the results show that larger number of loci makes the estimates more accurate and the estimates are not sensitive to the model’s assumption, migration rate, and the direction of migration. For the parameter <inline-formula id="IE228"><mml:math id="IM228"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, we have the same conclusion except for the case that migration rate is 10. When migration rate is 10, asymmetrical gene flow decreases the accuracy of <inline-formula id="IE229"><mml:math id="IM229"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> estimate. This indicates that the estimate of <inline-formula id="IE230"><mml:math id="IM230"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is sensitive to the direction of migration with large migration rate (<xref ref-type="supplementary-material" rid="sup1">supplementary fig. S1</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). The examples of above simulation commands are in the <xref ref-type="supplementary-material" rid="sup1">supplementary file S2</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online.</p>
    </sec>
    <sec>
      <title>Compared with 3s and IMa3</title>
      <p>The input file of mstree is gene tree, which is in Newick format, and the gene tree can be estimated from the observed sequence alignments where there must be three sequences, with one sequence from each species, at each locus. Therefore, we need a program, such as PHYLIP, to infer gene trees when applying mstree to experimental data. Because inference of gene trees is associated with error and uncertainty, we did some simulations to investigate the effect of the gene tree uncertainty (<xref ref-type="supplementary-material" rid="sup1">supplementary table S7</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). We used program ms and seq-gen (<xref rid="evaa087-B10" ref-type="bibr">Rambaut and Grassly 1997</xref>) to generate sequence data under JC69 model and used program dnamlk in PHYLIP package to infer gene trees. Although there has been some decline in the accuracy of parameter estimates because of the inferred error of gene trees, the estimates of mstree are still near to the true values and not sensitive to the model’s assumption. Comparing mstree with the program 3s (<xref rid="evaa087-B3" ref-type="bibr">Dalquen et al. 2017</xref>) and IMa3 (<xref rid="evaa087-B7" ref-type="bibr">Hey et al. 2018</xref>), mstree is faster than 3s and IMa3 (<xref ref-type="supplementary-material" rid="sup1">supplementary table S7</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). Although 3s and IMa3 performed very well on some parameter estimates, the <italic>τ</italic><sub>1</sub> estimates of 3s and <italic>τ</italic><sub>0</sub> estimates of IMa3 were very poor.</p>
    </sec>
    <sec>
      <title>Robustness of mstree and Analyzing Real Data</title>
      <p>Though our method is not affected by gene flow between the sister species, our method assumes that there is no gene flow between the ingroup and the outgroup. Therefore, we examined the robustness of our method in the presence of gene flow between the ingroup and the outgroup. The results are shown in <xref ref-type="supplementary-material" rid="sup1">supplementary table S8</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. Our method is robust to the simulations based on IIM model between the ingroup and the outgroup. For the simulations based on SC and IM model between the ingroup and the outgroup, the accuracy of parameter estimates is on the decline. At last, we apply mstree to the genomic sequences of the human (H), chimpanzee (C), and gorilla (G) (<xref rid="evaa087-B1" ref-type="bibr">Burgess and Yang 2008</xref>). The estimates of parameters are similar to those of <xref rid="evaa087-B1" ref-type="bibr">Burgess and Yang (2008)</xref>, but the estimate of <italic>τ</italic><sub>HC</sub> is slightly higher (<xref ref-type="supplementary-material" rid="sup1">supplementary table S9</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). In order to quantify uncertainty in the estimates obtained, we resort to bootstrapping with 100 replicates. The averages and the standard errors of estimates are as follows: <inline-formula id="IE231"><mml:math id="IM231"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">HCG</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0032</mml:mn><mml:mo> </mml:mo><mml:mo>±</mml:mo><mml:mo> </mml:mo><mml:mn>0.0000</mml:mn></mml:math></inline-formula>, <inline-formula id="IE232"><mml:math id="IM232"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">HC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0068</mml:mn><mml:mo> </mml:mo><mml:mo>±</mml:mo><mml:mo> </mml:mo><mml:mn>0.0005</mml:mn></mml:math></inline-formula>, <inline-formula id="IE233"><mml:math id="IM233"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">HCG</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0059</mml:mn><mml:mo> </mml:mo><mml:mo>±</mml:mo><mml:mo> </mml:mo><mml:mn>0.0000</mml:mn></mml:math></inline-formula>, and <inline-formula id="IE234"><mml:math id="IM234"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">HC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0038</mml:mn><mml:mo> </mml:mo><mml:mo>±</mml:mo><mml:mo> </mml:mo><mml:mn>0.0005</mml:mn></mml:math></inline-formula>.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p><xref ref-type="supplementary-material" rid="sup1">Supplementary table S8</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online, shows the performance of mstree in the presence of gene flow with species 3. Under the influence of gene flow between the ingroup and the outgroup, <italic>τ</italic><sub>0</sub> was underestimated and was closed to the time that gene flow stopped except for IIM model. When <italic>τ</italic><sub>0</sub> was underestimated, the estimates of other parameters were far away from the true value. <xref rid="evaa087-B1" ref-type="bibr">Burgess and Yang (2008)</xref> estimated divergence times under the assumption of no gene flow. However, <xref rid="evaa087-B26599282" ref-type="bibr">Zhu and Yang (2012</xref>) applied the test based on SIM3s model to a human–chimpanzee–gorilla genomic data and the test results suggested gene flow around the time of speciation of human and chimpanzee. Compared with the estimated divergence times from <xref rid="evaa087-B1" ref-type="bibr">Burgess and Yang (2008)</xref>, the analysis from mstree suggested migrations between sister species. In addition, there are two significant differences between mstree and COALGF (<xref rid="evaa087-B12" ref-type="bibr">Tian and Kubatko 2016</xref>), which describes the distribution of coalescent histories under the coalescent model with gene flow: 1) mstree uses the coalescent history distribution under coalescent model without gene flow to infer model parameters based on summary statistics; however, COALGF computes probabilities of gene tree histories given species trees under the coalescent process with gene flow and the results obtained from COALGF may be used to infer model parameters based on a maximum likelihood framework. 2) mstree does not make any assumption about the mode of gene flow between sister taxa; however, COALGF assumes that the mode of gene flow between sister taxa is IM.</p>
    <p>To summarize, we propose a multispecies coalescent approach, mstree, for estimating the parameters during speciation with gene flow. Theoretically, our method does not rely on any assumption about the relationship between isolation and migration. Furthermore, the simulation results demonstrate that mstree can accurately estimate species divergence time and ancestral population size regardless of IIM model, SC model, or IM model.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>evaa087_Supplementary_Data</label>
      <media xlink:href="evaa087_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>We thank David Bryant and three anonymous reviewers for many critical and constructive comments, which have led to improvement of our article. This work was supported by the National Natural Science Foundation of China (No. 31501081 to Q.Y.).</p>
  </ack>
  <ref-list id="ref1">
    <title>Literature Cited</title>
    <ref id="evaa087-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Burgess</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>2008</year><article-title>Estimation of hominoid ancestral population sizes under Bayesian coalescent models incorporating mutation rate variation and sequencing errors</article-title>. <source>Mol Biol Evol</source>. <volume>25</volume>(<issue>9</issue>):<fpage>1979</fpage>–<lpage>1994</lpage>.<pub-id pub-id-type="pmid">18603620</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Costa</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Wilkinson-Herbots</surname><given-names>H.</given-names></name></person-group><year>2017</year><article-title>Inference of gene flow in the process of speciation: an efficient maximum-likelihood method for the isolation-with-initial-migration model</article-title>. <source>Genetics</source><volume>205</volume>(<issue>4</issue>):<fpage>1597</fpage>–<lpage>1618</lpage>.<pub-id pub-id-type="pmid">28193727</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dalquen</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>TQ</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>ZH.</given-names></name></person-group><year>2017</year><article-title>Maximum likelihood implementation of an isolation-with-migration model for three species</article-title>. <source>Syst Biol</source>. <volume>66</volume>(<issue>3</issue>):<fpage>379</fpage>–<lpage>398</lpage>.<pub-id pub-id-type="pmid">27486180</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Feder</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Egan</surname><given-names>SP</given-names></name>, <name name-style="western"><surname>Nosil</surname><given-names>P.</given-names></name></person-group><year>2012</year><article-title>The genomics of speciation-with-gene-flow</article-title>. <source>Trends Genet</source>. <volume>28</volume>(<issue>7</issue>):<fpage>342</fpage>–<lpage>350</lpage>.<pub-id pub-id-type="pmid">22520730</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Futuyma</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Mayer</surname><given-names>GC.</given-names></name></person-group><year>1980</year><article-title>Non-allopatric speciation in animals</article-title>. <source>Syst Zool</source>. <volume>29</volume>(<issue>3</issue>):<fpage>254</fpage>–<lpage>271</lpage>.</mixed-citation>
    </ref>
    <ref id="evaa087-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gourbiere</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Mallet</surname><given-names>J.</given-names></name></person-group><year>2010</year><article-title>Are species real? The shape of the species boundary with exponential failure, reinforcement, and the “missing snowball”</article-title>. <source>Evolution</source><volume>64</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>24</lpage>.<pub-id pub-id-type="pmid">19780810</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hey</surname><given-names>J</given-names></name></person-group>, 
<etal>et al</etal><year>2018</year><article-title>Phylogeny estimation by integration over isolation with migration models</article-title>. <source>Mol Biol Evol</source>. <volume>35</volume>(<issue>11</issue>):<fpage>2805</fpage>–<lpage>2818</lpage>.<pub-id pub-id-type="pmid">30137463</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hudson</surname><given-names>RR.</given-names></name></person-group><year>2002</year><article-title>Generating samples under a Wright–Fisher neutral model of genetic variation</article-title>. <source>Bioinformatics</source><volume>18</volume>(<issue>2</issue>):<fpage>337</fpage>–<lpage>338</lpage>.<pub-id pub-id-type="pmid">11847089</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mailund</surname><given-names>T</given-names></name></person-group>, 
<etal>et al</etal><year>2012</year><article-title>A new isolation with migration model along complete genomes infers very different divergence processes among closely related great ape species</article-title>. <source>PLoS Genet</source>. <volume>8</volume>(<issue>12</issue>):<fpage>e1003125</fpage>.<pub-id pub-id-type="pmid">23284294</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Grassly</surname><given-names>NC.</given-names></name></person-group><year>1997</year><article-title>Seq-Gen: an application for the Monte Carlo simulation of DNA sequence evolution along phylogenetic frees</article-title>. <source>Comput Appl Biosci</source>. <volume>13</volume>(<issue>3</issue>):<fpage>235</fpage>–<lpage>238</lpage>.<pub-id pub-id-type="pmid">9183526</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smadja</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Butlin</surname><given-names>RK.</given-names></name></person-group><year>2011</year><article-title>A framework for comparing processes of speciation in the presence of gene flow</article-title>. <source>Mol Ecol</source>. <volume>20</volume>(<issue>24</issue>):<fpage>5123</fpage>–<lpage>5140</lpage>.<pub-id pub-id-type="pmid">22066935</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tian</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Kubatko</surname><given-names>LS.</given-names></name></person-group><year>2016</year><article-title>Distribution of coalescent histories under the coalescent model with gene flow</article-title>. <source>Mol Phylogenet Evol</source>. <volume>105</volume>:<fpage>177</fpage>–<lpage>192</lpage>.<pub-id pub-id-type="pmid">27614251</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Hey</surname><given-names>J.</given-names></name></person-group><year>2010</year><article-title>Estimating divergence parameters with small samples from a large number of loci</article-title>. <source>Genetics</source><volume>184</volume>(<issue>2</issue>):<fpage>363</fpage>–<lpage>379</lpage>.<pub-id pub-id-type="pmid">19917765</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>R</given-names></name></person-group>, 
<etal>et al</etal><year>2007</year><article-title>Population genetics of speciation in nonmodel organisms: I. Ancestral polymorphism in mangroves</article-title>. <source>Mol Biol Evol</source>. <volume>24</volume>(<issue>12</issue>):<fpage>2746</fpage>–<lpage>2754</lpage>.<pub-id pub-id-type="pmid">17906000</pub-id></mixed-citation>
    </ref>
    <ref id="evaa087-B26599282">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>2012</year><article-title>Maximum Likelihood Implementation of an Isolation-with-Migration Model with Three Species for Testing Speciation with Gene Flow</article-title>. <source>Mol Biol Evol. </source><volume>29</volume>(<issue>10</issue>):<fpage>3131</fpage>–<lpage>3142</lpage>.<pub-id pub-id-type="pmid">22504520</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
