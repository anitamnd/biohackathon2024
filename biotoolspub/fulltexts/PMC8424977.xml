<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8424977</article-id>
    <article-id pub-id-type="publisher-id">4336</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04336-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Reproducibility of mass spectrometry based metabolomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ghosh</surname>
          <given-names>Tusharkanti</given-names>
        </name>
        <address>
          <email>tusharkanti.ghosh@cuanschutz.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Philtron</surname>
          <given-names>Daisy</given-names>
        </name>
        <address>
          <email>dlp245@psu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Weiming</given-names>
        </name>
        <address>
          <email>weiming.zhang2018@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kechris</surname>
          <given-names>Katerina</given-names>
        </name>
        <address>
          <email>katerina.kechris@cuanschutz.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ghosh</surname>
          <given-names>Debashis</given-names>
        </name>
        <address>
          <email>debashis.ghosh@cuanschutz.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.430503.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 0703 675X</institution-id><institution>Colorado School of Public Health, </institution><institution>University of Colorado, Anschutz Medical Campus, </institution></institution-wrap>Aurora, USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.29857.31</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 4281</institution-id><institution>Eberly College of Science, </institution><institution>Penn State University, </institution></institution-wrap>State College, USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.492959.a</institution-id><institution>Syneos Health, </institution></institution-wrap>Morrisville, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>423</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Assessing the reproducibility of measurements is an important first step for improving the reliability of downstream analyses of high-throughput metabolomics experiments. We define a metabolite to be reproducible when it demonstrates consistency across replicate experiments. Similarly, metabolites which are not consistent across replicates can be labeled as irreproducible. In this work, we introduce and evaluate the use (Ma)ximum (R)ank (R)eproducibility (MaRR) to examine reproducibility in mass spectrometry-based metabolomics experiments. We examine reproducibility across technical or biological samples in three different mass spectrometry metabolomics (MS-Metabolomics) data sets.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We apply MaRR, a nonparametric approach that detects the change from reproducible to irreproducible signals using a maximal rank statistic. The advantage of using MaRR over model-based methods that it does not make parametric assumptions on the underlying distributions or dependence structures of reproducible metabolites. Using three MS Metabolomics data sets generated in the multi-center Genetic Epidemiology of Chronic Obstructive Pulmonary Disease (COPD) study, we applied the MaRR procedure after data processing to explore reproducibility across technical or biological samples. Under realistic settings of MS-Metabolomics data, the MaRR procedure effectively controls the False Discovery Rate (FDR) when there was a gradual reduction in correlation between replicate pairs for less highly ranked signals. Simulation studies also show that the MaRR procedure tends to have high power for detecting reproducible metabolites in most situations except for smaller values of proportion of reproducible metabolites. Bias (i.e., the difference between the estimated and the true value of reproducible signal proportions) values for simulations are also close to zero. The results reported from the real data show a higher level of reproducibility for technical replicates compared to biological replicates across all the three different datasets. In summary, we demonstrate that the MaRR procedure application can be adapted to various experimental designs, and that the nonparametric approach performs consistently well.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">This research was motivated by reproducibility, which has proven to be a major obstacle in the use of genomic findings to advance clinical practice. In this paper, we developed a data-driven approach to assess the reproducibility of MS-Metabolomics data sets. The methods described in this paper are implemented in the open-source R package <italic>marr</italic>, which is freely available from Bioconductor at <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/marr">http://bioconductor.org/packages/marr</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Reproducibility</kwd>
      <kwd>Mass spectrometry</kwd>
      <kwd>Metabolomics</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Metabolites are small molecules that represent a type of molecular phenotype that is intermediate between genetic and regulatory processes, such as methylation and transcription, and the physiological and disease state of an organism. Comprehensive profiling of the small molecule repertoire in a sample is referred to as metabolomics and has been applied extensively in detecting clinical biomarkers, studying physiological and disease processes, and predicting phenotypic changes [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par5">One of the most appealing features of metabolomics is the ability to characterize the full spectrum of metabolites by measuring them objectively and quantitatively. Metabolomics experiments can be classified into two categories: targeted and untargeted. Targeted metabolomics studies measure ions from biochemically known annotated metabolites. In contrast, untargeted metabolomics experiments measure the totality of ions in a set of predefined mass range [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. Among the platforms employed for measuring metabolites, Gas Chromatography Mass Spectrometry (GC–MS) and Liquid Chromatography Mass Spectrometry (LC–MS) are popular due to their sensitivity and coverage of all possible ions [<xref ref-type="bibr" rid="CR5">5</xref>]. These GC–MS and LC–MS techniques prepare a sample at a high resolution, fragment it into ions and isolate the ions to generate spectra for the sample [<xref ref-type="bibr" rid="CR6">6</xref>]. The fragmented ion spectra are subsequently reported on the basis of their physical properties (e.g., mass-charge ratio and retention time) [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. In many instances, some of the mass spectral signals measured by metabolomics experiments may not be biologically relevant due to background signals from the input sample preparation, or signals arising from the same analyte, such as isotopes and adducts [<xref ref-type="bibr" rid="CR9">9</xref>]. Therefore, metabolite feature identification can sometimes be imperfect since noisy signals could be identified as a peak group [<xref ref-type="bibr" rid="CR10">10</xref>]. Thus, many metabolomics data sets can have a large number of falsely identified metabolites or metabolite features with incorrect integration regions and missing values, which affect the reproducibility of the study [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. We use the term metabolites to refer to small compound features resulting from a metabolomics experiment in the rest of this article.</p>
    <p id="Par6">Reproducibility is an on-going challenge for high-throughput technologies developed in the last two decades for quantifying a wide range of biological processes. A persistent difficulty faced by researchers is the variability of output across replicate experiments [<xref ref-type="bibr" rid="CR13">13</xref>]. Several authors have addressed the issue of reproducibility among high-throughput experiments [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. In each high-throughput experiment (e.g., arrays, sequencing, mass spectrometry), a large number of features are measured simultaneously, and candidates are often subjected to follow-up statistical analysis. When measurements show consistency across replicate experiments, we define the signals that generate the measurements to be reproducible. Similarly, measurements that are not consistent across replicates may be problematic and those signals should be identified as irreproducible. In this work, metabolites that show consistency across MS-Metabolomics replicate experiments are termed reproducible and the ones that are not consistent are termed irreproducible. The reproducibility of a high-throughput experiment primarily depends on technical variables, such as run time, technical replicates (chemical factors and spike-in controls), laboratory operators, and biological variables, such as healthy and diseased subjects. A critical step toward making optimal design choices is to assess how these biological and technical variables affect reproducibility across replicate experiments [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par7">The simplest technique used to examine reproducibility is Spearman’s rank correlation across pairs of experiments, i.e., consistency of how metabolites are ranked in each experiment. However, the degree of reproducibility may depend on the magnitude of the signals, i.e., highly ranked signals are consistently more reproducible than low ranked signals. For this reason, Spearman’s rank correlation is not ideal for assessing the reproducibility of high-throughput experiments, since it does not account for the magnitude of signals.</p>
    <p id="Par8">The most detailed framework to assess reproducibility in high-throughput experiments was developed by [<xref ref-type="bibr" rid="CR13">13</xref>]. Using Chromatin ImmunoPrecipitation sequencing (ChIP-seq) data as motivation, this procedure uses a copula mixture model in order to estimate the proportion of reproducible signals, and the Irreproducible Discovery Rates (IDR) for ChIP-seq peaks can be computed at each set of paired replicate ranks for assessing reproducibility and combining replicates. Several other methods have been proposed for characterizing and examining the reproducibility of high-throughput experiments, including the Correspondence at the Top (CAT) plot [<xref ref-type="bibr" rid="CR19">19</xref>], which is a graphical tool to visualize and assess the reproducibility between a pair of replicate microarray experiments. However, CAT is only limited to visualization where the two ranked lists can be compared by looking at curves for the “proportion in common” based on fold change, between each experiment and a reference experiment. The choice of reference is important to calculate proportion in common. When the number of experiments is large, visualizing many curves with different reference experiments can be overwhelming. A more quantitative approach was a regression model developed to examine the effect of technical replicates for ChIP-seq and microarray data termed the correspondence curve regression [<xref ref-type="bibr" rid="CR20">20</xref>]. The correspondence curve regression employs a cumulative regression model to quantify the simultaneous and independent effects of technical replicates on reproducibility without a specific significance threshold [<xref ref-type="bibr" rid="CR21">21</xref>]. This regression model framework is a parametric alternative to existing graphical tools for comparing and benchmarking the reproducibility of different study designs in high-throughput sequencing experiments. Both IDR and correspondence curve regression are parametric approaches, and may be problematic if distributional assumptions are violated.</p>
    <p id="Par9">Like other high-throughput sequencing experiments (e.g., RNA-seq, ChIP-seq), reproducibility is also a major concern for effective downstream analysis of MS-Metabolomics data. There are few approaches that specifically examine reproducibility for MS-based metabolomics experiments. The most common approach is calculating the coefficient of variation (CV) across replicates. CV is computed by dividing the standard deviation of the replicates by the average, producing a measure for magnitude of the variation between replicates. An alternative measure RSD (Relative Standard Deviation) is often used instead of CV, where <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {RSD}=100\times \frac{\hbox {Standard Deviation}}{\hbox {Absolute Mean}}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mtext>RSD</mml:mtext><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Standard Deviation</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Absolute Mean</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq1.gif"/></alternatives></inline-formula>. It is often used to examine variation across biological and technical replicates samples and to filter metabolites [<xref ref-type="bibr" rid="CR22">22</xref>]. The RSD (or CV) is often a poor predictor of feature quality because it only assesses variability across technical replicates, without considering biologically meaningful variability across subjects [<xref ref-type="bibr" rid="CR23">23</xref>]. Typically, the RSD (or CV) is calculated across pooled QC samples for each feature and those with an RSD above a predetermined cutoff (e.g., 20–30%) are removed [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. That is, its properties are dependent on arbitrary cut-offs chosen by the user. In addition, RSD does not perform a statistical test for error control.</p>
    <p id="Par10">Limited research has been conducted comparing the reproducibility between biological or technical replicates. Even though previous research [<xref ref-type="bibr" rid="CR15">15</xref>] has shown that the experiments were sufficiently reproducible between technical replicates, we strongly emphasize the need of further assessment of reproducibility of abundances of metabolites across both biological and technical replicates.</p>
    <p id="Par11">In this work, we present a method to identify reproducible metabolites for use with MS-Metabolomics data. We demonstrate that the (Ma)ximum (R)ank (R)eproducibility (MaRR) procedure can be adapted to high-throughput MS-Metabolomics experiments across (biological or technical) replicate samples. The MaRR procedure was originally developed by [<xref ref-type="bibr" rid="CR26">26</xref>] to assess the reproducibility of RNA-seq data. It is a nonparametric approach that detects the change from reproducible to irreproducible signals. The advantage of using the MaRR procedure over model-based methods is that it does not make parametric assumptions on the underlying distributions or dependence structures of reproducible metabolites. Assessing reproducibility by the MaRR procedure will provide a new and robust way of studying reproducibility in the field of MS-Metabolomics experiments.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Maximum rank reproducibility (MaRR)</title>
      <p id="Par12">Maximum Rank Reproducibility (MaRR) was proposed to assess reproducibility of gene ranks in replicate experiments by [<xref ref-type="bibr" rid="CR26">26</xref>]. Since, MaRR is a non-parametric procedure, it does not assume any distributional parameters on the underlying structure of reproducible features. The core idea behind developing MaRR is based on a maximum rank statistic, such that, the procedure has the ability to detect the transition from reproducible to irreproducible signals by minimizing the mean squared error between the observed and theoretical survival function. The survival function <italic>S</italic>(<italic>t</italic>), is the probability that a subject survives longer than time <italic>t</italic>. For this reason, the Survival function is often regarded as complementary cumulative distribution function.</p>
      <p id="Par13">Using the MaRR procedure, we propose to examine the reproducibility of ranked lists from replicate experiments and assess how concordant the metabolites are ranked in replicate experiments. Any numeric value for a metabolite feature, such as abundance, test statistic, <italic>p</italic>-value, <italic>q</italic>-value or fold change score can be used to rank the features. Then the method utilizes the ranks and not the original measurements. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1 illustrates an example dataset of rank statistics for <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=10,000$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq2.gif"/></alternatives></inline-formula> metabolites under the ideal setting of a perfect split (when the correlation between highly ranks signals is 1 and correlation between low ranked signals is 0).</p>
      <p id="Par14">Metabolites with reproducible measurements should be consistently highly ranked for both replicate experiments (blue, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1), and are expected to have positive correlation in their ranks, whereas, metabolites with independent measures are assumed to have independent ranks and considered irreproducible (red, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1).</p>
    </sec>
    <sec id="Sec4">
      <title>MS-metabolomics data design</title>
      <p id="Par15">We introduce notation to describe MS-Metabolomics data resulting from a study design with <italic>D</italic> layers <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(D \ge 1)$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq3.gif"/></alternatives></inline-formula>. The layers in a study design may be technical (e.g., batches, technical replicates) or biological (e.g., disease status of subjects), and all layers measure abundances of metabolites. Under each layer in a MS-Metabolomics study design, multiple replicate experiments are obtained. Under each layer <italic>d</italic>, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d=1,2,\ldots ,D$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq4.gif"/></alternatives></inline-formula>, the reproducibility of these experiments are generally assessed across pairwise combinations of replicate experiments, i.e., <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n_d \atopwithdelims ()2}$$\end{document}</tex-math><mml:math id="M10"><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq5.gif"/></alternatives></inline-formula> pairwise combinations, where <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_d$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq6.gif"/></alternatives></inline-formula> is the number of replicate experiments at layer <italic>d</italic>, where <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d=1$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq7.gif"/></alternatives></inline-formula> indicates the top layer, <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d=2,\ldots ,{D-1}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq8.gif"/></alternatives></inline-formula> indicate the intermediate layers and <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d=D$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq9.gif"/></alternatives></inline-formula> is the bottom layer in a study design.</p>
      <p id="Par16">In each replicate MS-Metabolomics experiment, a large number of unique metabolites with respect to mass-charge ratio and retention time are obtained. Each metabolite <italic>m</italic> examined is assumed to be associated with a continuous measurement from each of <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_D$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>n</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq10.gif"/></alternatives></inline-formula> replicate experiments by the layer <italic>D</italic> (bottom layer), where <italic>M</italic> is the total number of metabolites. Let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x^{d}_{m,i}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq11.gif"/></alternatives></inline-formula> be the abundance measure of <italic>m</italic>th metabolite and the <italic>i</italic>th replicate experiment at layer <italic>d</italic>, such that, <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m=1,2,\ldots ,M$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=1,2,\ldots ,n_d$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq13.gif"/></alternatives></inline-formula>. We describe the structure and notation of these layers in the following sections. For notational simplicity, we will now use <italic>I</italic> as the total number of replicate experiments at the bottom layer.</p>
      <sec id="Sec5">
        <title>Single layer</title>
        <p id="Par17">Let <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x^{1}_{m,i}$$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq14.gif"/></alternatives></inline-formula> be the measure of <italic>m</italic>th metabolite and the <italic>i</italic>th replicate experiment under a single layered study design. An example of this study design is a data set that has the abundance measurements of <italic>M</italic> metabolites and <italic>I</italic> biological subjects (the replicate experiments in this case). See Fig. <xref rid="Fig2" ref-type="fig">2</xref>c for an example of a single-layered study design.</p>
      </sec>
      <sec id="Sec6">
        <title>Double layer</title>
        <p id="Par18">Let <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x^{\omega _1}_{m,i}$$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq15.gif"/></alternatives></inline-formula> be the measure of <italic>m</italic>th metabolite and the <italic>i</italic>th replicate experiment under a two-layered study design, i.e., <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _1$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq16.gif"/></alternatives></inline-formula> (top layer) and <italic>i</italic> (bottom layer- replicate experiment level), where <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _1=1,\ldots ,n_{\omega _1}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=1,\ldots ,I$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq18.gif"/></alternatives></inline-formula>, such that, <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _1}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq19.gif"/></alternatives></inline-formula> and <italic>I</italic> denote the total number of replicate experiments at the first (top) and bottom (second in this case) layers, respectively respectively respectively. An example of this study design is a data set that has abundance measurements of <italic>M</italic> metabolites and <italic>I</italic> replicate experiments under each of the <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _1}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq20.gif"/></alternatives></inline-formula> biological subjects, i.e., in total there are <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I \times n_{\omega _1}$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>I</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq21.gif"/></alternatives></inline-formula> samples. See Fig. <xref rid="Fig2" ref-type="fig">2</xref>b for an example of a double-layered study design.</p>
      </sec>
      <sec id="Sec7">
        <title>Triple layer</title>
        <p id="Par19">Let <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x^{\omega _1,\omega _2}_{m,i}$$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq22.gif"/></alternatives></inline-formula> be the measure of <italic>m</italic>th metabolite and the <italic>i</italic>th replicate experiment under a three-layered study design, i.e., <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _1$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq23.gif"/></alternatives></inline-formula> (top layer), <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _2$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq24.gif"/></alternatives></inline-formula> (middle layer) and <italic>i</italic> (bottom layer- replicate experiment level), where <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _1=1,\ldots ,n_{\omega _1}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq25.gif"/></alternatives></inline-formula>, <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _2=1,\ldots ,n_{\omega _2}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq26.gif"/></alternatives></inline-formula> and <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=1,\ldots ,I$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq27.gif"/></alternatives></inline-formula>, such that, <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _1}, n_{\omega _2} \ge 2$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq28.gif"/></alternatives></inline-formula>. <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _1}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq29.gif"/></alternatives></inline-formula>, <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _2}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq30.gif"/></alternatives></inline-formula>, and <italic>I</italic> denote the total number of replicate experiments at the first (top), second and bottom (third in this case) layers, respectively respectively. An example of this study design is a data set that has abundance measurements of <italic>M</italic> metabolites and <italic>I</italic> replicate experiments under two layered study design where the middle layer is the technical layer (e.g., different operators or runs) with <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _2}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq31.gif"/></alternatives></inline-formula> technical replicates and the top layer is subject layer with <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _1}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq32.gif"/></alternatives></inline-formula> biological subjects, i.e., in total there are <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I \times n_{\omega _1} \times n_{\omega _2}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>I</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq33.gif"/></alternatives></inline-formula> samples. See Fig. <xref rid="Fig2" ref-type="fig">2</xref>a for an example of a triple-layered study design.</p>
      </sec>
      <sec id="Sec8">
        <title><italic>N</italic> layer</title>
        <p id="Par20">Let <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x^{\omega _1,\omega _2,\ldots ,\omega _{N-1}}_{m,i}$$\end{document}</tex-math><mml:math id="M68"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq34.gif"/></alternatives></inline-formula> be the measure of <italic>m</italic>th metabolite and the <italic>i</italic>th replicate experiment under an N-layered study design, i.e., <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _1$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq35.gif"/></alternatives></inline-formula> (top layer), <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _2$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq36.gif"/></alternatives></inline-formula> (second layer), <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ldots$$\end{document}</tex-math><mml:math id="M74"><mml:mo>…</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq37.gif"/></alternatives></inline-formula>, <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _{N-1}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq38.gif"/></alternatives></inline-formula> (<inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(N-1)$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq39.gif"/></alternatives></inline-formula> layer) and <italic>i</italic> (bottom layer- replicate experiment level), where <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _1=1,\ldots ,n_{\omega _1}$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq40.gif"/></alternatives></inline-formula>, <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _2=1,\ldots ,n_{\omega _2}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq41.gif"/></alternatives></inline-formula>, <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ldots$$\end{document}</tex-math><mml:math id="M84"><mml:mo>…</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq42.gif"/></alternatives></inline-formula>, <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega _{N-1}=1,\ldots ,n_{\omega _{N-1}}$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq43.gif"/></alternatives></inline-formula> and <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=1,\ldots ,I$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq44.gif"/></alternatives></inline-formula>, such that, <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _1}, n_{\omega _2},\ldots ,n_{\omega _{N-1}} \ge 2$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq45.gif"/></alternatives></inline-formula>. <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _1}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq46.gif"/></alternatives></inline-formula>, <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _2}$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq47.gif"/></alternatives></inline-formula>, <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ldots$$\end{document}</tex-math><mml:math id="M96"><mml:mo>…</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq48.gif"/></alternatives></inline-formula>, <inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _{N-1}}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq49.gif"/></alternatives></inline-formula> and <italic>I</italic> denote the total number of replicate experiments at the first (top), second, <inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ldots$$\end{document}</tex-math><mml:math id="M100"><mml:mo>…</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq50.gif"/></alternatives></inline-formula>, <inline-formula id="IEq51"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(N-1)$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq51.gif"/></alternatives></inline-formula> and bottom (last) layers, respectively.</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>MaRR procedure for MS-metabolomics</title>
      <p id="Par21">For notational simplicity, we assume only the single layered study design to describe the MS-Metabolomics data sets in the context of the MaRR procedure as discussed in “<xref rid="Sec5" ref-type="sec">Single layer</xref> section”. MaRR assumes no missing values (see below for data pre-processing steps regarding missing values). Even though, we have data for more than two replicate experiments, the MaRR application to MS-based metabolomics data focuses on pairwise replicate experiments. Thus, under the single layered study design, we implement MaRR on pairwise combinations of <italic>I</italic> replicate experiments, i.e., <inline-formula id="IEq52"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I \atopwithdelims ()2}$$\end{document}</tex-math><mml:math id="M104"><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq52.gif"/></alternatives></inline-formula> combinations of pairwise replicate experiments, where <inline-formula id="IEq53"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {x}}_{i}$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq53.gif"/></alternatives></inline-formula> and <inline-formula id="IEq54"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {x}}_{i'}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq54.gif"/></alternatives></inline-formula> are the replicate data sets, such that, <inline-formula id="IEq55"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\ne i^{'}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq55.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq56"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {x}}_{i}=(x_{1,i},\ldots ,x_{M,i})^{'}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq56.gif"/></alternatives></inline-formula>. Moreover, <inline-formula id="IEq57"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {X}}$$\end{document}</tex-math><mml:math id="M114"><mml:mi mathvariant="bold">X</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq57.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq58"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M \times I$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq58.gif"/></alternatives></inline-formula> matrix, such that, <inline-formula id="IEq59"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {X}}=({\mathbf {x}}_{1},\ldots ,{\mathbf {x}}_{I})$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq59.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq60"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {x}}_{i'}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq60.gif"/></alternatives></inline-formula> be the vector of abundances of <italic>M</italic> metabolites on the <italic>i</italic>th replicate experiment. These abundances are converted into rank statistics. Each metabolite is assigned a rank in each of the two replicate: <inline-formula id="IEq61"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(R_{m,i},\,R_{m,i^{'}})$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq61.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq62"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{m,i}$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq62.gif"/></alternatives></inline-formula> is the rank among <inline-formula id="IEq63"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{1,i},\ldots ,x_{M,i}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq63.gif"/></alternatives></inline-formula> and likewise for <inline-formula id="IEq64"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{m,i^{'}}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq64.gif"/></alternatives></inline-formula>. Now, the maximum rank statistic for the metabolite <italic>m</italic> can be defined as,<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hbox {Max}_{m}=\hbox {max}(R_{m,i},\,R_{m,i^{'}}), \end{aligned}$$\end{document}</tex-math><mml:math id="M130" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>for <inline-formula id="IEq65"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m=1,\ldots ,M$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq65.gif"/></alternatives></inline-formula>.</p>
      <p id="Par22">Consider Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 detailing a subset of a real data of <inline-formula id="IEq66"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=6$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq66.gif"/></alternatives></inline-formula> metabolites to describe the calculation of maximum rank statistics from a pair of replicate experiments. It is to be noted that metabolites that are highly ranked will have a relatively low value for their maximum rank statistic. On the other hand, low ranked metabolites will have higher values. Thus, choosing a threshold value based on the maximum rank can have the potential to separate reproducible from irreproducible signals.</p>
      <sec id="Sec10">
        <title>Estimator of the proportion of reproducible metabolites</title>
        <p id="Par23">We define the proportion of reproducible metabolites between sample pairs as <inline-formula id="IEq67"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq67.gif"/></alternatives></inline-formula>. Due to the first assumption of the MaRR procedure under ideal settings [<xref ref-type="bibr" rid="CR26">26</xref>], <inline-formula id="IEq68"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Max}_{y}&lt;\hbox {Max}_{z}$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>y</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq68.gif"/></alternatives></inline-formula> for all reproducible metabolites <italic>y</italic> and irreproducible metabolites <italic>z</italic>. This implies that all metabolites <italic>y</italic> such that <inline-formula id="IEq69"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Max}_{y}/M \le \pi _1$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq69.gif"/></alternatives></inline-formula> are reproducible, and all metabolites <italic>z</italic> such that <inline-formula id="IEq70"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Max}_{z}/M &gt;\pi _1$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq70.gif"/></alternatives></inline-formula> are irreproducible. Rank pairs and maximum rank statistics for a sample data set generated under the ideal assumptions with <inline-formula id="IEq71"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1 = 0.35$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.35</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq71.gif"/></alternatives></inline-formula> are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1. MaRR uses the survival function in its estimator derivation of <inline-formula id="IEq72"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq72.gif"/></alternatives></inline-formula>. Thus, the empirical survival function is given by,<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{S}}_{M}(x)= \frac{1}{M}\sum _{y=1}^{M}{I(\hbox {Max}_{y}/M\ge x)}, \quad x \in (0,1). \end{aligned}$$\end{document}</tex-math><mml:math id="M148" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi><mml:mo>≥</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>Let <inline-formula id="IEq73"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1 \in (0,1)$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq73.gif"/></alternatives></inline-formula> be fixed, then according to the properties of MaRR under the ideal setting, the marginal limiting distribution of the random variable <inline-formula id="IEq74"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Max}_{z}/M$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq74.gif"/></alternatives></inline-formula> as <inline-formula id="IEq75"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M \rightarrow \infty$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq75.gif"/></alternatives></inline-formula>,<disp-formula id="Equ14"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} S_{\pi _1}(x)= {\left\{ \begin{array}{ll} 1 &amp;{} x&lt;\pi _1\\ 1-\frac{(x-\pi _1)^2}{(1-\pi _1)^2}, &amp;{} \pi _1\le x \le 1. \\ 0 &amp;{} 1&lt;x \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M156" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>A weighted mean squared error between two functions for <inline-formula id="IEq76"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda \in (0,1)$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq76.gif"/></alternatives></inline-formula> is defined as:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} MSE_{M}(\lambda )=(M-l_{\lambda })^{-1}\sum _{x=l_{\lambda }}^{M}{[{\hat{S}}_{M}(x/M) - (1-\lambda )S_{\lambda }(x/M)]^2}, \end{aligned}$$\end{document}</tex-math><mml:math id="M160" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>λ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>λ</mml:mi></mml:msub></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>λ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq77"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_{\lambda }=\max _{l=1,\ldots ,M} (l: l/M \le \lambda )$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>λ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo movablelimits="true">max</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>:</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi><mml:mo>≤</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq77.gif"/></alternatives></inline-formula>. The minimizer of <inline-formula id="IEq78"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$MSE_{M}(\lambda )$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq78.gif"/></alternatives></inline-formula> is used to estimate <inline-formula id="IEq79"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq79.gif"/></alternatives></inline-formula>. [<xref ref-type="bibr" rid="CR26">26</xref>] showed the desirable performance of this estimator across a variety of scenarios.</p>
        <p id="Par24">We assume the following under the realistic setting:<list list-type="bullet"><list-item><p id="Par25">Reproducible signals tend to be ranked higher than irreproducible signals, that is, <inline-formula id="IEq80"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(R_{y,i} &lt; R_{y,i^{'}})&gt;1/2$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq80.gif"/></alternatives></inline-formula> and <inline-formula id="IEq81"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(R_{z,i} &lt; R_{z,i^{'}})&gt;1/2$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq81.gif"/></alternatives></inline-formula> if metabolite <italic>y</italic> is reproducible and metabolite <italic>z</italic> is irreproducible for any replicate sample pair <inline-formula id="IEq82"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(i,i^{'})$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq82.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par26">The correlation between the ranks of reproducible signals is nonnegative.</p></list-item><list-item><p id="Par27">The two ranks per irreproducible metabolite are independent.</p></list-item></list>The important difference between assumptions that separates the first assumption of realistic and ideal settings is the lack of clear split between reproducible and irreproducible signals with respect to <inline-formula id="IEq83"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Max}_{y}$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>y</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq83.gif"/></alternatives></inline-formula>. As a result, the estimator <inline-formula id="IEq84"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\pi _1}$$\end{document}</tex-math><mml:math id="M176"><mml:mover accent="true"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq84.gif"/></alternatives></inline-formula> derived in [<xref ref-type="bibr" rid="CR26">26</xref>] is consistent in the ideal case whereas conservatively biased in the realistic case. In realistic settings, reproducible signals <inline-formula id="IEq85"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Max}_{y}/M$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq85.gif"/></alternatives></inline-formula> have a positive probability of falling in the region <inline-formula id="IEq86"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\pi _1,1)$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq86.gif"/></alternatives></inline-formula>.</p>
        <p id="Par28">For computational convenience, the discrete and rescaled version of <inline-formula id="IEq87"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M182"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq87.gif"/></alternatives></inline-formula> was used, i.e., <inline-formula id="IEq88"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{k}}$$\end{document}</tex-math><mml:math id="M184"><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq88.gif"/></alternatives></inline-formula>.<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{k}}= \underset{{l=l_{\lambda }}}{\text {arg min}}[MSE_{M}(l/M)], \end{aligned}$$\end{document}</tex-math><mml:math id="M186" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg min</mml:mtext></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>λ</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq89"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_{\lambda }=\displaystyle \max _{\{l=1,\ldots ,M \}} (l: l/M \le \lambda )$$\end{document}</tex-math><mml:math id="M188"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>λ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="true">max</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>:</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi><mml:mo>≤</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq89.gif"/></alternatives></inline-formula>.</p>
        <p id="Par29">In practice, <inline-formula id="IEq90"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{k}}$$\end{document}</tex-math><mml:math id="M190"><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq90.gif"/></alternatives></inline-formula> is a good estimate when reproducible signals begin transition to irreproducible signals. We chose the value of <inline-formula id="IEq91"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M192"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq91.gif"/></alternatives></inline-formula> to be 0.9 on the basis of a large number of simulated datasets with varying degrees of effect size and proportion of reproducible signals. However, this assertion cannot yet be proven theoretically. Although, for certain datasets with small effect size (e.g., mean parameter), we might need to reduce the <inline-formula id="IEq92"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M194"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq92.gif"/></alternatives></inline-formula> value [<xref ref-type="bibr" rid="CR26">26</xref>]. In our MS-Metabolomics datasets, it was not required as the effect sizes were relatively large compared to the real RNA-seq datasets in [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
      </sec>
      <sec id="Sec11">
        <title>Estimation of reproducible signal for metabolite <italic>m</italic> and replicate sample pair <inline-formula id="IEq93"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(i,\,i')$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq93.gif"/></alternatives></inline-formula></title>
        <p id="Par30">To determine the set of reproducible metabolites, a critical value <inline-formula id="IEq94"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{N}}$$\end{document}</tex-math><mml:math id="M198"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq94.gif"/></alternatives></inline-formula> was chosen, according to an error rate. All metabolites from a replicate sample pair experiment <inline-formula id="IEq95"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(i,i^{'})$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq95.gif"/></alternatives></inline-formula> will be assigned reproducible if <inline-formula id="IEq96"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Max}_{y} \le {\hat{N}}$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>y</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq96.gif"/></alternatives></inline-formula>. This approach of declaring metabolites is defining a rejection as <inline-formula id="IEq97"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(0,{\hat{N}})$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq97.gif"/></alternatives></inline-formula>, and rejecting the null hypothesis [irreproducibility for all signals with <inline-formula id="IEq98"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Max}_{y}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>y</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq98.gif"/></alternatives></inline-formula> in the region <inline-formula id="IEq99"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(0,{\hat{N}})$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq99.gif"/></alternatives></inline-formula>] [<xref ref-type="bibr" rid="CR27">27</xref>]. When an irreproducible metabolite was declared reproducible, Type I error (false discovery) was committed. Marginal false discovery rate (mFDR) is estimated based on a rejection region [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
        <p id="Par31">We assume <italic>z</italic> be the possible outcomes from simultaneous hypotheses [<xref ref-type="bibr" rid="CR29">29</xref>], where <italic>U</italic> is the number of true null hypothesis that were correctly not rejected (true negatives), <italic>V</italic> is the number of false rejections (false positives), <italic>T</italic> is the number of hypotheses that were not rejected when they should have been (false negatives), and <italic>S</italic> is the number of correctly rejected hypotheses (true positives). <italic>Q</italic> is the total number of rejections made (rejected null hypotheses). The mFDR [<xref ref-type="bibr" rid="CR28">28</xref>] is given by,<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} mFDR=\frac{E[V]}{E[Q]}. \end{aligned}$$\end{document}</tex-math><mml:math id="M210" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>m</mml:mi><mml:mi>F</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>The above quantity is similar to the classical FDR as defined by [<xref ref-type="bibr" rid="CR30">30</xref>]. To define mFDR estimate based on the MaRR procedure, the following notations are introduced:<disp-formula id="Equ15"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;Q(l)=\sum _{y=1}^{M}I(\hbox {Max}_{y} \le l)= \text {Number of metabolites declared reproducible for critical region}\,(0,\,l).\\&amp;V_k(l)=\text {Irreproducible metabolites declared reproducible with}\,k&lt; \hbox {Max}_{y} \le l. \end{aligned}$$\end{document}</tex-math><mml:math id="M212" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>y</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>Number of metabolites declared reproducible for critical region</mml:mtext><mml:mspace width="0.166667em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>Irreproducible metabolites declared reproducible with</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>y</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>l</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>By using the above notations, the mFDR estimate for using <italic>l</italic> as the threshold value for declaring reproducibility is given by,<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} m{\widehat{FDR}}(l)=\frac{E[V_{{\hat{k}}}(l)]}{Q(l)}. \end{aligned}$$\end{document}</tex-math><mml:math id="M214" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>m</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="italic">FDR</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>The denominator of the above expression can be directly computed from the data whereas the numerator needs to be calculated using the distribution of <inline-formula id="IEq100"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Max}_{z}$$\end{document}</tex-math><mml:math id="M216"><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>z</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq100.gif"/></alternatives></inline-formula> and is also dependent on <inline-formula id="IEq101"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{k}}$$\end{document}</tex-math><mml:math id="M218"><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq101.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR26">26</xref>]. The final expression of the numerator is given by,<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} E[V_{{\hat{k}}}(l)]= \frac{(l-{\hat{k}})^2}{M-{\hat{k}}},\quad l={\hat{k}}+1,\ldots ,M. \end{aligned}$$\end{document}</tex-math><mml:math id="M220" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>The mFDR estimate associated with any rejection region <inline-formula id="IEq102"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(0,\,l)$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq102.gif"/></alternatives></inline-formula> can then be defined as,<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} m{\widehat{FDR}}(l)=\frac{E[V_{{\hat{k}}}(l)]}{Q(l)}=\frac{(l-{\hat{k}})^2}{Q(l)(M-{\hat{k}})},\quad l={\hat{k}}+1,\ldots ,M. \end{aligned}$$\end{document}</tex-math><mml:math id="M224" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>m</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="italic">FDR</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>We summarize the MaRR procedure for set of <italic>m</italic> metabolites each with two metrics generated from sample pair experiments as below:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{k}}= \underset{{l=l_{\lambda }}}{\text {arg min}}[MSE_{M}(l/M)], \end{aligned}$$\end{document}</tex-math><mml:math id="M226" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg min</mml:mtext></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>λ</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>The FDR is controlled at a nominal level <inline-formula id="IEq103"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M228"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq103.gif"/></alternatives></inline-formula> if the threshold value <inline-formula id="IEq104"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{N}}$$\end{document}</tex-math><mml:math id="M230"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq104.gif"/></alternatives></inline-formula> is chosen to be<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{N}}=\displaystyle \max _{{\hat{k}} &lt;l \le M} \{l:m{\widehat{FDR}}(l) \le \alpha \}, \end{aligned}$$\end{document}</tex-math><mml:math id="M232" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="true">max</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>&lt;</mml:mo><mml:mi>l</mml:mi><mml:mo>≤</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>l</mml:mi><mml:mo>:</mml:mo><mml:mi>m</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="italic">FDR</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>and the set of metabolites generated from replicate pair of experiments with maximum rank statistics less than or equal to <inline-formula id="IEq105"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{N}}$$\end{document}</tex-math><mml:math id="M234"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq105.gif"/></alternatives></inline-formula> are declared reproducible. We detect the indices of the metabolites from replicate sample pair experiments which are declared reproducible. We define an indicator variable <inline-formula id="IEq106"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{{m,(i,i')}}=1(0)$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq106.gif"/></alternatives></inline-formula> to be a reproducible (irreproducible) signal for metabolite <italic>m</italic> and replicate sample pair <inline-formula id="IEq107"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(i,i')$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq107.gif"/></alternatives></inline-formula> as below:<disp-formula id="Equ16"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} r_{{m,(i,i')}}= {\left\{ \begin{array}{ll} 1, &amp;{} I(\hbox {Max}_{m} \le {\hat{N}})\\ 0 &amp;{} {\textit{otherwise}}. \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M240" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mtext>Max</mml:mtext><mml:mi>m</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="italic">otherwise</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Evaluating reproducibility</title>
      <p id="Par32">We create a matrix of reproducible signals with <italic>M</italic> rows (total number of metabolites) and <italic>J</italic> columns (<inline-formula id="IEq108"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J={I \atopwithdelims ()2}$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq108.gif"/></alternatives></inline-formula>) (replicate sample pairs <inline-formula id="IEq109"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I \atopwithdelims ()2}$$\end{document}</tex-math><mml:math id="M244"><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq109.gif"/></alternatives></inline-formula>), where <italic>J</italic> is the total possible number of sample pairs of replicate experiments. We assign metabolite <italic>m</italic> to be reproducible if a certain percentage signals (<inline-formula id="IEq110"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$100c_s\%$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mn>100</mml:mn><mml:msub><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq110.gif"/></alternatives></inline-formula>) are reproducible for pairwise combinations of replicate experiments across all study designs, i.e., if<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{{\sum _{i&lt;i'}{{{r_{m,{(i,i')}}}}}}}{J} &gt;c_s, \end{aligned}$$\end{document}</tex-math><mml:math id="M248" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mi>J</mml:mi></mml:mfrac><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>such that, <inline-formula id="IEq111"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_s \in (0,1)$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq111.gif"/></alternatives></inline-formula>.</p>
      <p id="Par33">Similarly, we assign a sample pair <inline-formula id="IEq112"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(i,i')$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq112.gif"/></alternatives></inline-formula> for each study design <inline-formula id="IEq113"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\omega _1}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq113.gif"/></alternatives></inline-formula> to be reproducible if a certain percentage signals (<inline-formula id="IEq114"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$100c_m\%$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:mn>100</mml:mn><mml:msub><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq114.gif"/></alternatives></inline-formula>) are reproducible across all metabolites, i.e., if<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\sum _{m}{{r{_{m,(i,i')}}}}}{M}&gt;c_m, \end{aligned}$$\end{document}</tex-math><mml:math id="M258" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mi>r</mml:mi><mml:msub><mml:mrow/><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mi>M</mml:mi></mml:mfrac><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>such that, <inline-formula id="IEq115"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_m \in (0,1)$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq115.gif"/></alternatives></inline-formula>. Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates the schematic filtering approach of reproducible signal matrix by rows (metabolites) and columns (sample pairs).<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic filtering approach of reproducible signal matrix. Schematic diagram showing the evaluation of MS-Metabolomics data. The schematic filtering approach can is data-adaptive because the filtering cut-offs (<inline-formula id="IEq116"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_s$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq116.gif"/></alternatives></inline-formula> and <inline-formula id="IEq117"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_m$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq117.gif"/></alternatives></inline-formula>) can be specified to the filtering requirements of the data by the user</p></caption><graphic xlink:href="12859_2021_4336_Fig1_HTML" id="MO16"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Illustrative data sets</title>
      <p id="Par34">Chronic Obstructive Pulmonary Disease (COPD) is a major cause of morbidity and mortality in the United States. The multi-center Genetic Epidemiology of COPD (COPDGene) study was designed to study the underlying genetic factors of COPD, [<xref ref-type="bibr" rid="CR31">31</xref>]. This study enrolled 10,263 individuals from 2008 to 2011 (Visit 1) who were aged 45–80 with <inline-formula id="IEq118"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 10$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq118.gif"/></alternatives></inline-formula> pack-year smoking history and no exacerbations for <inline-formula id="IEq119"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;30$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq119.gif"/></alternatives></inline-formula> days. From 2013 to 2017, 6758 subjects returned for an in-person 5-year visit (Visit 2). Each in-person visit included spirometry before and after albuterol, quantitative CT imaging of the chest, and blood sampling.</p>
      <sec id="Sec14">
        <title>Technical (Tech) data set</title>
        <p id="Par35">Three technicians performed all steps of sample prep for profiling of a single base human plasma sample collected from COPDGene visit 1 containing six spiked in control compounds at concentrations of 1X, 2X and 4X and two negative controls at 1X in all samples. Processing of the raw data was performed in Agilent’s Mass Hunter software.</p>
        <p id="Par36">The Tech data set is a triple-layered MS-Metabolomics experiment. Figure <xref rid="Fig2" ref-type="fig">2</xref>a shows the hierarchical structure of the Tech data set, (i) the top layer being the batch operators, (ii) the middle layer is the spike-ins under each batch operator, and (iii) the bottom layer is the technical replicates under each spike-in. Based on our generic notations in “<xref rid="Sec7" ref-type="sec">Triple layer</xref> section”, we can write, <inline-formula id="IEq120"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _1}$$\end{document}</tex-math><mml:math id="M270"><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq120.gif"/></alternatives></inline-formula>, <inline-formula id="IEq121"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _2}$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq121.gif"/></alternatives></inline-formula> and <italic>I</italic> be the total number of replicate experiments at the top (batch operator), middle (spike-in control) and bottom (technical replicate) layers, respectively. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2(a) illustrates the design of the MS-Metabolomics experiment for a single operator of the Tech data set.<fig id="Fig2"><label>Fig. 2</label><caption><p>Flow charts of the 3 data sets. Flow charts show the hierarchical structure of the Tech, BioTech and Bio data sets. <bold>a</bold> The Tech data set is a triple-layered MS-Metabolomics experiment. <bold>b</bold> The BioTech data set is a double-layered MS-Metabolomics experiment. <bold>c</bold> The Bio data set is a single-layered MS-Metabolomics experiment</p></caption><graphic xlink:href="12859_2021_4336_Fig2_HTML" id="MO17"/></fig></p>
      </sec>
      <sec id="Sec15">
        <title>Biological–Technical (BioTech) data set</title>
        <p id="Par37">Fresh frozen plasma was collected at COPDGene Visit 1 from 131 subjects. These samples were analyzed using untargeted LC–MS (C18+ and HILIC+) metabolomics. The lipid fraction of the human plasma collected from current and former smokers was analyzed using Time of Flight (ToF) liquid chromatograph (LC) (Agilent 6210 Series) and a Quadrupole ToF mass spectrometer (Agilent 6520) which yielded combined data on 2999 metabolite features before data-preprocessing. Data are available at the Metabolomics Workbench with Study ID ST000601, and data processing is described in [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
        <p id="Par38">The BioTech data set (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) can be treated as a double-layered MS-Metabolomics experiment as described in “<xref rid="Sec6" ref-type="sec">Double layer</xref> section”. We can write, <inline-formula id="IEq122"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\omega _1}=131$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mn>131</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq122.gif"/></alternatives></inline-formula> and <inline-formula id="IEq123"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I=3$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq123.gif"/></alternatives></inline-formula> be the total number of replicate experiments at the top (biological subjects) and bottom (technical replicates), respectively. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2(b) illustrates the design of the MS-Metabolomics experiment for the BioTech data set.</p>
      </sec>
      <sec id="Sec16">
        <title>Biological (Bio) data set</title>
        <p id="Par39">Within COPDGene 1136 subjects participated in an ancillary study in which they provided fresh frozen plasma at Visit 2. The plasma was profiled using the Metabolon Global Metabolomics platform using an untargeted gas chromatography–mass spectrometry and liquid chromatography–mass spectrometry (GC–MS and LC–MS) based metabolomic quantification protocol as described previously [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR33">33</xref>]. The platform reported 1392 features including 1064 annotated features. A data normalization step was performed to correct variation resulting from instrument inter-day tuning differences: metabolite intensities were divided by the metabolite run day median then multiplied by the overall metabolite median. Subjects with aggregate metabolite median z-scores greater than 3.5 standard deviation from the mean <inline-formula id="IEq124"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\hbox {N}=6)$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>N</mml:mtext><mml:mo>=</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq124.gif"/></alternatives></inline-formula> of the cohort were removed.</p>
        <p id="Par40">The Bio data set (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c) is a single-layered MS-Metabolomics experiment (“<xref rid="Sec5" ref-type="sec">Single layer</xref> section”). Note that, there are no technical replicates in this data set. We can write, <inline-formula id="IEq125"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x^{1}_{m,i}$$\end{document}</tex-math><mml:math id="M280"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq125.gif"/></alternatives></inline-formula> be the abundance measures of <italic>m</italic>th metabolite and the <italic>i</italic>th replicate experiment where <inline-formula id="IEq126"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=1,\ldots ,I(=1130)$$\end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>=</mml:mo><mml:mn>1130</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq126.gif"/></alternatives></inline-formula>. <inline-formula id="IEq127"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I=1130$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mn>1130</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq127.gif"/></alternatives></inline-formula> denotes the total number of replicate experiments. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2(c) illustrates the design of the MS-Metabolomics experiment for the Bio data set.</p>
      </sec>
    </sec>
    <sec id="Sec17">
      <title>Data pre-processing</title>
      <p id="Par41">We processed the three data sets described in “<xref rid="Sec13" ref-type="sec">Illustrative data sets</xref> section” using the MSPrep software [<xref ref-type="bibr" rid="CR34">34</xref>]. The data sets used in this paper are all log transformed. The data pre-processing include three steps and they are as follows:</p>
      <sec id="Sec18">
        <title>Filtering</title>
        <p id="Par42">For each of the data sets, metabolites with more than 20% missing values were removed [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. (a) Tech data set-Post filtering, <inline-formula id="IEq128"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=860$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>860</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq128.gif"/></alternatives></inline-formula> metabolites remain. (b) BioTech data set-Post filtering, <inline-formula id="IEq129"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=2860$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>2860</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq129.gif"/></alternatives></inline-formula> metabolites remain. (c) Bio data set-Post filtering, <inline-formula id="IEq130"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=995$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>995</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq130.gif"/></alternatives></inline-formula> metabolites remain.</p>
      </sec>
      <sec id="Sec19">
        <title>Missing value imputation techniques</title>
        <p id="Par43">For all data sets, we used BPCA to impute missing values, which implements a Bayesian version of the PCA (Principal Component Analysis) [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. It combines an Expectation Maximization (EM) approach for PCA with a Bayesian model and imputes the missing values. This R function is available in R/Bioconductor package pcaMethods. As a secondary analysis to compare imputation methods, we also used <italic>k</italic>NN and Random Forest (RF) imputations for the BioTech dataset. <italic>k</italic>NN imputation was originally developed for high-dimensional microarray gene expression data [<xref ref-type="bibr" rid="CR38">38</xref>]. For each metabolite with missing values, this method finds the <italic>k</italic> (<inline-formula id="IEq131"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$=5$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq131.gif"/></alternatives></inline-formula>) nearest metabolites using Euclidean metric and missing values are imputed by averaging the nearest neighboring non-missing values. We applied the R package VIM for this imputation approach. Further, we used RF to impute the missing values. In many literatures, it has been observed that RF-based imputation outperformed other imputation methods for imputing metabolomics data [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR41">41</xref>]. We applied the R package missForest for RF-based imputation.</p>
      </sec>
      <sec id="Sec20">
        <title>Normalization</title>
        <p id="Par44">Unwanted variation appears from various sources in metabolomics studies. Normalization is an important step for the downstream statistical analysis of metabolomics data. For all three data sets, we employ the msnormalize function with the quantile normalization options in MSPrep [<xref ref-type="bibr" rid="CR34">34</xref>] to normalize the data while maintaining biological variation in the replicates. As a secondary analysis to compare normalization methods, we also used the median normalization option in MSPrep [<xref ref-type="bibr" rid="CR34">34</xref>] for the BioTech data set.</p>
      </sec>
    </sec>
    <sec id="Sec21">
      <title>Pooling the abundance measurements</title>
      <p id="Par45">To evaluate the top layer of the hierarchy in the MS-metabolomics data design, we need to sum the abundances in the lower layer levels. We illustrate the sum of abundance measurements approach to measure reproducibility at each layer of the hierarchical MS-Metabolomics data sets using the Tech data set. For within spike-ins, i.e., between technical replicates, we rank and compare metabolites from each replicate pair. To make comparisons between spike-ins using the same operator, we sum abundance measurements over three replicates per spike-in. Subsequently, we rank the total abundance measurements for each spike-in and apply MaRR to measure the reproducibility metrics (<inline-formula id="IEq132"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M294"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq132.gif"/></alternatives></inline-formula>s) pairs of spike-ins under each batch operator, i.e., nine pairs of spike-in across three batch operators. Further, to make comparisons between batch operators for the same biological subject, we sum abundance measurements over all replicates under three spike-in per batch operator. MaRR is then applied to these pooled data set. We also repeat the sum of abundance measurements approach in the BioTech data set. However, this approach is not required to perform in the Bio data set (single-layered MS-Metabolomics data set).</p>
    </sec>
    <sec id="Sec22">
      <title>Dealing with ties</title>
      <p id="Par46">In the rare occurrence of ties, ties in the ranking method were treated by random assignment. For example, if there are 10 metabolites and 2 are tied for smallest values, then one of the tied metabolites will be randomly assigned to the 9th position and the other one to the 10th position.</p>
    </sec>
    <sec id="Sec23">
      <title>Simulations</title>
      <p id="Par47">The main goal of the simulation settings is to generate data with known reproducible/irreproducible signals that mimics the characteristics of one of our example data sets (BioTech described in “<xref rid="Sec13" ref-type="sec">Illustrative data sets</xref> section”) to examine the performance of MaRR procedure. For this purpose, we describe two sets of simulation studies under extensive simulation settings. Since the MaRR procedure is applied to pair of replicate experiments, and to simplify notation, we assume one layer. In these simulations, we evaluate the accuracy of estimates of the reproducible signals <inline-formula id="IEq133"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq133.gif"/></alternatives></inline-formula>, FDR control and the power for detecting the true reproducible signals. In the simulations, we assume that the data are log transformed.</p>
    </sec>
    <sec id="Sec24">
      <title>Settings for simulation I</title>
      <p id="Par48">In simulation I, we generate data from a Bivariate Normal distribution using the means, standard deviations and Pearson’s correlation coefficient between replicate pair experiments of the processed BioTech data set.</p>
      <p id="Par49">We first ran the MaRR procedure to identify which metabolites were reproducible or irreproducible (see Methods), then calculated summary statistics of the reproducible/irreproducible metabolites and used those to generate simulation data sets In summary, (i) the quartiles of the proportion of reproducible signals (<inline-formula id="IEq134"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq134.gif"/></alternatives></inline-formula>) ranged between 0.90 and 0.95 for 393 sample pairs and 2860 metabolites. (ii) The quartiles of the means of the reproducible abundance measures (<inline-formula id="IEq135"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _R$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mi>μ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq135.gif"/></alternatives></inline-formula>), for replicate experiments ranged between 3.89 and 4.13. (iii) The quartiles of the means of the irreproducible abundance measures (<inline-formula id="IEq136"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{IR}$$\end{document}</tex-math><mml:math id="M302"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IR</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq136.gif"/></alternatives></inline-formula>), for replicate experiments ranged between 3.19 and 3.21. (iv) The quartiles of the standard deviations of the reproducible abundance measures (<inline-formula id="IEq137"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _R$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mi>σ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq137.gif"/></alternatives></inline-formula>) for replicate experiments ranged between 0.16 and 0.17. (v) The quartiles of the standard deviations of the irreproducible abundance measures (<inline-formula id="IEq138"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{IR}$$\end{document}</tex-math><mml:math id="M306"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IR</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq138.gif"/></alternatives></inline-formula>) for replicate experiments ranged between 0.04 and 0.05. (vi) The quartiles of the Pearson’s correlation coefficient of the reproducible abundance measures (<inline-formula id="IEq139"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _R$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq139.gif"/></alternatives></inline-formula>) between replicate experiments ranged between 0.992 and 0.994. We summarized the quartile measurements of these parameters in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3. In addition, we presented the boxplots showing the spread of these parameters in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2.</p>
      <p id="Par50">We fix the true values of the following parameters because their quartile ranges were extremely narrow: mean of the irreproducible abundance measures for replicate experiments (<inline-formula id="IEq140"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{IR}=3.2$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IR</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq140.gif"/></alternatives></inline-formula>), standard deviation of the reproducible abundance measures for replicate experiments (<inline-formula id="IEq141"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _R=0.17$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.17</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq141.gif"/></alternatives></inline-formula>) and standard deviation of the irreproducible abundance measures for replicate experiments (<inline-formula id="IEq142"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{IR}=0.05$$\end{document}</tex-math><mml:math id="M314"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IR</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq142.gif"/></alternatives></inline-formula>). For the other parameters, we chose values from the quartile ranges: the mean of the reproducible abundance measures (<inline-formula id="IEq143"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _R$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mi>μ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq143.gif"/></alternatives></inline-formula>), the proportion of reproducible signals (<inline-formula id="IEq144"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M318"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq144.gif"/></alternatives></inline-formula>), and the correlation between reproducible pairs of abundance measures(<inline-formula id="IEq145"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _R$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq145.gif"/></alternatives></inline-formula>).</p>
      <p id="Par51">Under realistic settings of the MaRR procedure, (i) we assume that test statistics with large values will be highly ranked and (ii) the correlation between irreproducible abundance measure is zero. The test statistics for reproducible signals are generated from the Bivariate Normal distribution as follows:<disp-formula id="Equ17"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left( \begin{array}{c} t_{m,1}\\ t_{m,2} \end{array}\right)\sim &amp; {} {\mathcal {N}} \left[ \left( \begin{array}{c} \mu _R\\ \mu _R \end{array}\right) ,\left( \begin{array}{cc} \sigma _R^2 &amp;{} \sigma _R^2 \rho _R\\ \sigma _R^2 \rho _R &amp;{} \sigma _R^2 \end{array}\right) \right] . \end{aligned}$$\end{document}</tex-math><mml:math id="M322" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close="]" open="["><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>μ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>μ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>ρ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>ρ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>The test statistics for irreproducible signals are generated from the standard bivariate Normal distribution assuming that the two test statistics are independent:<disp-formula id="Equ18"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left( \begin{array}{c} t_{m,1}\\ t_{m,2} \end{array}\right)\sim &amp; {} {\mathcal {N}} \left[ \left( \begin{array}{c} \mu _{IR}\\ \mu _{IR} \end{array}\right) ,\left( \begin{array}{cc} \sigma _{IR}^2 &amp;{} 0\\ 0 &amp;{} \sigma _{IR}^2 \end{array}\right) \right] . \end{aligned}$$\end{document}</tex-math><mml:math id="M324" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close="]" open="["><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IR</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IR</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IR</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IR</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>To make the situations more challenging and exhaustive, we include 24 settings by varying <inline-formula id="IEq146"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _R\in \{3.89,4.01,4.13\}$$\end{document}</tex-math><mml:math id="M326"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>3.89</mml:mn><mml:mo>,</mml:mo><mml:mn>4.01</mml:mn><mml:mo>,</mml:mo><mml:mn>4.13</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq146.gif"/></alternatives></inline-formula>, <inline-formula id="IEq147"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _R\in \{0.45,0.99\}$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0.45</mml:mn><mml:mo>,</mml:mo><mml:mn>0.99</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq147.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq148"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1\in \{0.2,0.4,0.75,0.9\}$$\end{document}</tex-math><mml:math id="M330"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo><mml:mn>0.75</mml:mn><mml:mo>,</mml:mo><mml:mn>0.9</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq148.gif"/></alternatives></inline-formula> based on the summary statistics described above For each setting, we simulate 1000 data sets of metabolite size <inline-formula id="IEq149"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=2860$$\end{document}</tex-math><mml:math id="M332"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>2860</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq149.gif"/></alternatives></inline-formula>, which is the number of metabolites in the BioTech data set, and apply the MaRR procedure.</p>
    </sec>
    <sec id="Sec25">
      <title>Settings for simulation II</title>
      <p id="Par52">The simulation design is kept similar to the original MaRR paper [<xref ref-type="bibr" rid="CR26">26</xref>]. Thus, to test the performance of the MaRR under extensive simulation settings, we implement the simulations with extreme choices of the parameters (<inline-formula id="IEq150"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq150.gif"/></alternatives></inline-formula> and <inline-formula id="IEq151"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_0$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq151.gif"/></alternatives></inline-formula>), and do not assume normality for all values.</p>
      <p id="Par53">Each simulated data will consist of proportion of reproducible signals and a minimum correlation for lowest ranked signals as parameters. The largest values of <inline-formula id="IEq152"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{m,1}$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq152.gif"/></alternatives></inline-formula> and <inline-formula id="IEq153"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{m,2}$$\end{document}</tex-math><mml:math id="M340"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq153.gif"/></alternatives></inline-formula> are assumed to be highly ranked metabolites. For each reproducible metabolite <italic>m</italic>, the first test statistic <inline-formula id="IEq154"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{m,1}$$\end{document}</tex-math><mml:math id="M342"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq154.gif"/></alternatives></inline-formula> is generated according to <inline-formula id="IEq155"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{m,1} \sim {\textit{Uniform}}(4,5)$$\end{document}</tex-math><mml:math id="M344"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="italic">Uniform</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq155.gif"/></alternatives></inline-formula>. The second test statistic <inline-formula id="IEq156"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{m,2}$$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq156.gif"/></alternatives></inline-formula> is dependent in such a way that, the correlation between <inline-formula id="IEq157"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{m,1}$$\end{document}</tex-math><mml:math id="M348"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq157.gif"/></alternatives></inline-formula> and <inline-formula id="IEq158"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{m,2}$$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq158.gif"/></alternatives></inline-formula> is linearly dependent according to a Normal distribution given <inline-formula id="IEq159"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{m,1}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq159.gif"/></alternatives></inline-formula>,<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} t_{m,2}| t_{m,1} \sim {\mathcal {N}}(t_{m,1},1-r_m^{2}), \end{aligned}$$\end{document}</tex-math><mml:math id="M354" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq160"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_m=\frac{1-r_0}{5-4}(t_{m,1}-4)+r_0$$\end{document}</tex-math><mml:math id="M356"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>5</mml:mn><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq160.gif"/></alternatives></inline-formula>.</p>
      <p id="Par54">For the correlation structure, we assume that when <inline-formula id="IEq161"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{m,1}=5$$\end{document}</tex-math><mml:math id="M358"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq161.gif"/></alternatives></inline-formula>, there is perfect correlation whereas, the minimum correlation for the lowest ranked reproducible signals (<inline-formula id="IEq162"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{m,1}=4$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq162.gif"/></alternatives></inline-formula>) is <inline-formula id="IEq163"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_0$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq163.gif"/></alternatives></inline-formula>.</p>
      <p id="Par55">As with Simulation I, the test statistics for irreproducible metabolites are generated from the bivariate Normal distribution assuming that the two test statistics are independent,<disp-formula id="Equ19"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left( \begin{array}{c} t_{m,1}\\ t_{m,2} \end{array}\right)\sim &amp; {} {\mathcal {N}} \left[ \left( \begin{array}{c} \mu _{IR}\\ \mu _{IR} \end{array}\right) ,\left( \begin{array}{cc} \sigma _{IR}^2 &amp;{} 0\\ 0 &amp;{} \sigma _{IR}^2 \end{array}\right) \right] . \end{aligned}$$\end{document}</tex-math><mml:math id="M364" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close="]" open="["><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IR</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IR</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IR</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IR</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4336_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>We consider 12 parameter settings for this simulation design by varying the proportion of reproducible signals, <inline-formula id="IEq164"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1\,\in \,\{0.2,\,0.4,\,0.75,\,0.9\}$$\end{document}</tex-math><mml:math id="M366"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mspace width="0.166667em"/><mml:mo>∈</mml:mo><mml:mspace width="0.166667em"/><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mn>0.75</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mn>0.9</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq164.gif"/></alternatives></inline-formula> and the minimum correlations <inline-formula id="IEq165"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_0\,\in \,\{0.4,\,0.6,\,0.99\}$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mspace width="0.166667em"/><mml:mo>∈</mml:mo><mml:mspace width="0.166667em"/><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mn>0.6</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mn>0.99</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq165.gif"/></alternatives></inline-formula> as selected above. For each setting, we simulate 1000 data sets and apply the MaRR procedure. To imitate the MS-Metabolomics data more closely for each data set, the size of metabolites is chosen to be <inline-formula id="IEq166"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=2860$$\end{document}</tex-math><mml:math id="M370"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>2860</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq166.gif"/></alternatives></inline-formula>, which is the number of metabolites for the BioTech data set.</p>
      <p id="Par56">For each simulated data set, we compute the empirical FDR based on MaRR independently by dividing the number of false positives by the total number of reproducible signals. Similarly, we also compute the empirical NDR by dividing the true negatives by the total number of true reproducible signals.</p>
    </sec>
    <sec id="Sec26">
      <title>Settings for simulation III</title>
      <p id="Par57">This simulation design is kept exactly similar to the settings for Simulation I except the test statistics for irreproducible signals are generated from the standard bivariate t distribution with degrees of freedom 3 assuming that the two test statistics are independent. The Standard t-distribution with degrees of freedom has heavier tails compared to Standard Normal distribution.</p>
    </sec>
  </sec>
  <sec id="Sec27">
    <title>Results</title>
    <sec id="Sec28">
      <title>Simulation results</title>
      <p id="Par58">We assess the performance of the MaRR procedure using simulated data sets designed to resemble the output from MS-Metabolomics experiments for the three sets of simulation studies.</p>
      <sec id="Sec29">
        <title>FDR control</title>
        <p id="Par59">Figure <xref rid="Fig3" ref-type="fig">3</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3 compare the FDR control for <inline-formula id="IEq167"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _R=0.45$$\end{document}</tex-math><mml:math id="M372"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.45</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq167.gif"/></alternatives></inline-formula> of Simulation I. The FDR results illustrate that the MaRR procedure effectively controls FDR across all settings of Simulation I at 5% level of significance. The FDR results across all choice of <inline-formula id="IEq168"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _R$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mi>μ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq168.gif"/></alternatives></inline-formula> show that the variability is increasing as <inline-formula id="IEq169"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M376"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq169.gif"/></alternatives></inline-formula> decreases. This was expected as the MaRR procedure performs best when the proportions of reproducible signals are high.</p>
        <p id="Par60">In Simulation II (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), the FDR results demonstrate that the MaRR procedure performs well in controlling the FDR in almost all situations. Here also, we observe that the MaRR procedure can be very conservative when the proportion of reproducible signals are high and <inline-formula id="IEq170"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_0$$\end{document}</tex-math><mml:math id="M378"><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq170.gif"/></alternatives></inline-formula> are low. A downward trend can be observed with increasing values of <inline-formula id="IEq171"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M380"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq171.gif"/></alternatives></inline-formula>.<fig id="Fig3"><label>Fig. 3</label><caption><p>FDRs for simulations I and II based on 1000 simulated datasets in each setting. The horizontal line indicates the target FDR level (<inline-formula id="IEq172"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.05$$\end{document}</tex-math><mml:math id="M382"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq172.gif"/></alternatives></inline-formula>) for all simulations. Labels along the x-axis describe values of <inline-formula id="IEq173"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M384"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq173.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2021_4336_Fig3_HTML" id="MO22"/></fig></p>
      </sec>
      <sec id="Sec30">
        <title>Discriminative power</title>
        <p id="Par61">We compare the discriminative power (1-NDR) for the same settings discussed above, where NDR is the Non-Discovery Rate (Type II error) [<xref ref-type="bibr" rid="CR26">26</xref>]. The discriminative power of simulations I (<inline-formula id="IEq174"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _R=0.45,\,0.99$$\end{document}</tex-math><mml:math id="M386"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.45</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mn>0.99</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq174.gif"/></alternatives></inline-formula>) are almost 100% (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S4 and S5). For simulations II (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), we also observe high discriminative power. The MaRR procedure has very high power for all simulation settings across I and II.<fig id="Fig4"><label>Fig. 4</label><caption><p><inline-formula id="IEq175"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-NDR$$\end{document}</tex-math><mml:math id="M388"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>N</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq175.gif"/></alternatives></inline-formula> for simulation II based on 1000 simulated datasets in each setting. Labels along the x-axis describe values of <inline-formula id="IEq176"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M390"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq176.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2021_4336_Fig4_HTML" id="MO23"/></fig></p>
      </sec>
      <sec id="Sec31">
        <title>Bias of <inline-formula id="IEq177"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M392"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq177.gif"/></alternatives></inline-formula></title>
        <p id="Par62">Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S6 and S7 show the bias of the proportions of reproducible signals, i.e., <inline-formula id="IEq178"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M394"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq178.gif"/></alternatives></inline-formula>. The bias values across all simulations lie within a narrow range <inline-formula id="IEq179"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(-0.05,\,0.05)$$\end{document}</tex-math><mml:math id="M396"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mn>0.05</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq179.gif"/></alternatives></inline-formula> indicating that the MaRR procedure performs sufficiently well in estimating <inline-formula id="IEq180"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M398"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq180.gif"/></alternatives></inline-formula>. In Simulation I, the bias is positive and monotonically increasing with the increment of <inline-formula id="IEq181"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M400"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq181.gif"/></alternatives></inline-formula> irrespective of the choices of <inline-formula id="IEq182"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _R$$\end{document}</tex-math><mml:math id="M402"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq182.gif"/></alternatives></inline-formula> and <inline-formula id="IEq183"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _R$$\end{document}</tex-math><mml:math id="M404"><mml:msub><mml:mi>μ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq183.gif"/></alternatives></inline-formula>. Additional figures when <inline-formula id="IEq184"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _R=0.99$$\end{document}</tex-math><mml:math id="M406"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq184.gif"/></alternatives></inline-formula> are presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6. In Simulation II, the bias is negative and monotonically decreasing with the decrease of <inline-formula id="IEq185"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M408"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq185.gif"/></alternatives></inline-formula> except when <inline-formula id="IEq186"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_0=0.99$$\end{document}</tex-math><mml:math id="M410"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq186.gif"/></alternatives></inline-formula>. For <inline-formula id="IEq187"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_0=0.99$$\end{document}</tex-math><mml:math id="M412"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq187.gif"/></alternatives></inline-formula>, the bias behaves similar to Simulation I.</p>
        <p id="Par63">Simulation III results were similar to Simulation I. We presented the results in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S8–S13. Further, we also compared the performance of the MaRR procedure and RSD. We find that the performance of the MaRR procedure is better compared to RSD. We provided the details about the simulation settings and results in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S14 and S15.</p>
      </sec>
    </sec>
    <sec id="Sec32">
      <title>COPDGene data analysis</title>
      <p id="Par64">We apply the MaRR procedure to study the reproducibility of biological and technical replicates between and within study designs (e.g., operators, biological subjects) on real data sets. As described in previous section (“<xref rid="Sec4" ref-type="sec">MS-metabolomics data design</xref> section”), MS-Metabolomics data can have multiple layers.</p>
      <p id="Par65">We applied the MaRR procedure to each of the three MS-Metabolomics data sets. The reproducible signals were identified for all three layers (batch, spike-in and replicates) in Tech data set; two layers (biological subjects and replicates) in BioTech data set and a single layer (biological replicates) in Bio data set. We declared a signal to be reproducible at an error controlling rate of <inline-formula id="IEq188"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.01$$\end{document}</tex-math><mml:math id="M414"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq188.gif"/></alternatives></inline-formula> using the MaRR procedure. We assign a metabolite for a replicate sample pair and a sample pair for a metabolite to be reproducible using a threshold value of <inline-formula id="IEq189"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_s$$\end{document}</tex-math><mml:math id="M416"><mml:msub><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq189.gif"/></alternatives></inline-formula> and <inline-formula id="IEq190"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_m$$\end{document}</tex-math><mml:math id="M418"><mml:msub><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq190.gif"/></alternatives></inline-formula>, respectively defined in “<xref rid="Sec12" ref-type="sec">Evaluating reproducibility</xref> section”, and vary these values.</p>
      <p id="Par66">The distribution of reproducible pairs and metabolites are illustrated in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S16 and <xref rid="Fig5" ref-type="fig">5</xref> for the Tech data set and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S17 and <xref rid="Fig6" ref-type="fig">6</xref> for the BioTech and Bio data sets, respectively.</p>
      <p id="Par67">We label a metabolite and a sample pair to be reproducible if at least <inline-formula id="IEq191"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$100\%c_s$$\end{document}</tex-math><mml:math id="M420"><mml:mrow><mml:mn>100</mml:mn><mml:mo>%</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq191.gif"/></alternatives></inline-formula> and <inline-formula id="IEq192"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$100\%c_m$$\end{document}</tex-math><mml:math id="M422"><mml:mrow><mml:mn>100</mml:mn><mml:mo>%</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq192.gif"/></alternatives></inline-formula> of signals are reproducible across sample pairs of experiments and metabolites, respectively. We provide the percentage of reproducible metabolites and sample pairs based on the threshold value of greater than the percent threshold values of reproducible signals for the three data sets. The results of all the three data sets are also summarized in Table <xref rid="Tab1" ref-type="table">1</xref>. For different values of <inline-formula id="IEq193"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_s$$\end{document}</tex-math><mml:math id="M424"><mml:msub><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq193.gif"/></alternatives></inline-formula> and <inline-formula id="IEq194"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_m$$\end{document}</tex-math><mml:math id="M426"><mml:msub><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq194.gif"/></alternatives></inline-formula>, the entries in the table represent the proportion of sample pairs of replicate experiments with reproducible signals per sample pair a and proportion of metabolites with reproducible signals per metabolite, respectively. It is a more conservative approach to have higher percentage of threshold as it would filter higher number of metabolites or sample pairs.</p>
      <sec id="Sec33">
        <title>Tech Data- Reproducibility of metabolites per sample pair</title>
        <p id="Par68">Figure <xref rid="Fig5" ref-type="fig">5</xref> illustrates percentage of reproducible metabolites per sample pair in the <italic>x</italic>-axis. In Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the higher percentage of reproducible metabolites per sample pair in the <italic>x</italic>-axis would indicate stronger reproducibility between the two samples (sample pairs), e.g., the percent metabolites in the last right bin indicates that all or almost all the metabolites are reproducible for the number of sample pair combinations in the <italic>y</italic>-axis. The percentage of reproducible metabolites per sample pair (close to 100%) are much higher for the Operator and technical layer compared to the spike-in layer data (Table <xref rid="Tab1" ref-type="table">1</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Histograms showing reproducible metabolites for three layers. These histograms are in percent scale where the <italic>x</italic>-axes denote the percent scale of reproducible metabolites for all possible sample pairs. <bold>a</bold> Top layer (batches): three pairs of batches. <bold>b</bold> Middle layer (spike-ins): nine pairs of spike-ins. <bold>c</bold> Bottom layer (technical replicates): 27 pairs of technical replicates</p></caption><graphic xlink:href="12859_2021_4336_Fig5_HTML" id="MO24"/></fig></p>
      </sec>
      <sec id="Sec34">
        <title>Tech data-reproducibility of sample pairs per metabolite</title>
        <p id="Par69">Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S16 illustrates percentage of reproducible sample pairs per metabolite in the <italic>x</italic>-axis. In all three layers (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S16a–c), the higher percentage would indicate strong reproducibility of a metabolite across all sample pairs for each of these layers. This indicates that there is high reproducibility of sample pairs per metabolite in all these three layers of technical replicates. Table <xref rid="Tab1" ref-type="table">1</xref> shows that the percentage of reproducible sample pairs per metabolite greater than different thresholds (70%, 80%, 90%) are more or less same, i.e., around 82%.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of reproducible metabolites per sample pair and reproducible sample pairs per metabolite for Tech, BioTech and Bio data sets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2" colspan="2">Data set</th><th align="left" colspan="3">Percentage of reproducible metabolites per sample pair</th><th align="left" colspan="3">Percentage of reproducible sample pairs per metabolite</th></tr><tr><th align="left">&gt; 70%</th><th align="left">&gt; 80%</th><th align="left">&gt; 90%</th><th align="left">&gt; 70%</th><th align="left">&gt; 80%</th><th align="left">&gt; 90%</th></tr></thead><tbody><tr><td align="left" rowspan="3">Tech</td><td align="left">Operator layer</td><td char="." align="char">100.00</td><td char="." align="char">100.00</td><td char="." align="char">0.00</td><td char="." align="char">82.09</td><td char="." align="char">82.09</td><td char="." align="char">82.09</td></tr><tr><td align="left">Spike-in layer</td><td char="." align="char">88.89</td><td char="." align="char">11.11</td><td char="." align="char">0.00</td><td char="." align="char">81.28</td><td char="." align="char">81.05</td><td char="." align="char">80.23</td></tr><tr><td align="left">Replicate layer</td><td char="." align="char">100.00</td><td char="." align="char">92.59</td><td char="." align="char">0.00</td><td char="." align="char">85.23</td><td char="." align="char">84.30</td><td char="." align="char">83.02</td></tr><tr><td align="left" rowspan="2">BioTech</td><td align="left">Biological layer</td><td char="." align="char">49.85</td><td char="." align="char">9.59</td><td char="." align="char">0.73</td><td char="." align="char">64.44</td><td char="." align="char">60.80</td><td char="." align="char">55.07</td></tr><tr><td align="left">Technical layer</td><td char="." align="char">90.08</td><td char="." align="char">0.76</td><td char="." align="char">0.25</td><td char="." align="char">68.29</td><td char="." align="char">63.78</td><td char="." align="char">59.09</td></tr><tr><td align="left">Bio</td><td align="left">Biological layer</td><td char="." align="char">98.52</td><td char="." align="char">92.40</td><td char="." align="char">76.95</td><td char="." align="char">88.84</td><td char="." align="char">84.32</td><td char="." align="char">76.78</td></tr></tbody></table><table-wrap-foot><p>The columns of proportion of reproducible metabolites per sample pair <inline-formula id="IEq195"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;70/80/90\%$$\end{document}</tex-math><mml:math id="M428"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>70</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>80</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq195.gif"/></alternatives></inline-formula> indicate that proportion of sample pairs of replicate experiments with reproducible metabolites per sample pair greater than <inline-formula id="IEq196"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$70/80/90\%$$\end{document}</tex-math><mml:math id="M430"><mml:mrow><mml:mn>70</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>80</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq196.gif"/></alternatives></inline-formula>. The columns of proportion of reproducible sample pairs per metabolite <inline-formula id="IEq197"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;70/80/90\%$$\end{document}</tex-math><mml:math id="M432"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>70</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>80</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq197.gif"/></alternatives></inline-formula> indicate that proportion of metabolites with reproducible sample pairs per metabolite greater than <inline-formula id="IEq198"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;70/80/90\%$$\end{document}</tex-math><mml:math id="M434"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>70</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>80</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq198.gif"/></alternatives></inline-formula></p></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="Sec35">
        <title>BioTech and Bio data-reproducibility of metabolites per sample pair</title>
        <p id="Par70">Figure <xref rid="Fig6" ref-type="fig">6</xref> illustrates that the reproducibility of metabolites per sample pair are higher for technical replicates of BioTech data set (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a) compared to biological replicates of the same data set (BioTech) (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b). Table <xref rid="Tab1" ref-type="table">1</xref> also confirms the reproducibility of metabolites per sample pair is higher for technical replicates compared to its biological data set (BioTech). In BioTech data set, the percentage of reproducible metabolites per sample pair greater than 70% for technical replicates is 90.08% compared to 49.85% of biological replicates. In Fig. <xref rid="Fig6" ref-type="fig">6</xref>b and c, we also report that the reproducibility of metabolites per sample pair is much higher for Bio data set compared the biological replicates of Biotech data set. However, there are differences between the two technologies for BioTech and Bio data sets since the samples were not collected on the same subjects at the same visit for a direct comparison.<fig id="Fig6"><label>Fig. 6</label><caption><p>Histograms showing reproducible metabolites per sample pair for BioTech and Bio data sets. These histograms are in percent scale where the <italic>x</italic>-axes denote the percent scale of reproducible metabolites. Reproducible metabolites <bold>a</bold> 393 technical replicate sample pairs (BioTech), <bold>b</bold> 8515 biological replicate sample pairs (BioTech), and <bold>c</bold> 637,885 biological replicate sample pairs (Bio)</p></caption><graphic xlink:href="12859_2021_4336_Fig6_HTML" id="MO25"/></fig></p>
      </sec>
      <sec id="Sec36">
        <title>BioTech and bio data-reproducibility of sample pairs per metabolite</title>
        <p id="Par71">Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S17 compares the percentage reproducible sample pairs per metabolite either across technical replicates (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9a) or biological replicates (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S17b, c). However, in this case, we observe that the percentage of reproducible sample pairs per metabolite <inline-formula id="IEq205"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;70\%$$\end{document}</tex-math><mml:math id="M436"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>70</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq205.gif"/></alternatives></inline-formula> threshold (<inline-formula id="IEq206"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$=68.29\%$$\end{document}</tex-math><mml:math id="M438"><mml:mrow><mml:mo>=</mml:mo><mml:mn>68.29</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq206.gif"/></alternatives></inline-formula>) for technical replicates of the BioTech data set (bottom layer) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S17a) is higher than their biological replicates (BioTech data set (top layer)) (<inline-formula id="IEq207"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$=64.44\%$$\end{document}</tex-math><mml:math id="M440"><mml:mrow><mml:mo>=</mml:mo><mml:mn>64.44</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq207.gif"/></alternatives></inline-formula>) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S17b) and lower than biological replicates (<inline-formula id="IEq208"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$=88.84\%$$\end{document}</tex-math><mml:math id="M442"><mml:mrow><mml:mo>=</mml:mo><mml:mn>88.84</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq208.gif"/></alternatives></inline-formula>) of Bio data set (Fig. S17c), (Table <xref rid="Tab1" ref-type="table">1</xref>). Also, note that, the samples were not collected on the same subjects at the same visit for a direct comparison.</p>
      </sec>
      <sec id="Sec37">
        <title>Using MaRR to compare data processing methods</title>
        <p id="Par72">In the previous sections, we only presented MaRR reproducibility results with BPCA imputed and quantile normalized data. Here, we also illustrate how MaRR can be used to compare different combinations of imputation and normalization steps based on the resulting reproducibility of metabolites and sample pairs: we compare four combinations of imputation and normalization methods: (i) BPCA and quantile (as above), (ii) BPCA and median, (iii) kNN and median, (iv) kNN and quantile, (v) RF and median, (vi) RF and quantile. The results of all the BioTech dataset are summarized in Table <xref rid="Tab2" ref-type="table">2</xref>. For the BioTech dataset, processing the data using RF-median or RF-quantile achieved the maximum reproducibility (Table <xref rid="Tab2" ref-type="table">2</xref>). The additional figures (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S18–S23) for the BioTech and Bio data sets are provided using the MaRR procedure to compare data processing methods in the Additional file.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Summary of reproducible metabolites per sample pair and reproducible sample pairs per metabolite for BioTech data set</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Imputation</th><th align="left" rowspan="2" colspan="2">Normalization</th><th align="left" colspan="3">Percentage of reproducible metabolites per sample pair</th><th align="left" colspan="3">Percentage of reproducible sample pairs per metabolite</th></tr><tr><th align="left">&gt; 70%</th><th align="left">&gt; 80%</th><th align="left">&gt; 90%</th><th align="left">&gt; 70%</th><th align="left">&gt; 80%</th><th align="left">&gt; 90%</th></tr></thead><tbody><tr><td align="left" rowspan="4">BPCA</td><td align="left" rowspan="2">Median</td><td align="left">Biological layer</td><td char="." align="char">52.27</td><td char="." align="char">10.68</td><td char="." align="char">0.75</td><td char="." align="char">64.69</td><td char="." align="char">61.22</td><td char="." align="char">55.56</td></tr><tr><td align="left">Technical layer</td><td char="." align="char">90.08</td><td char="." align="char">0.76</td><td char="." align="char">0.25</td><td char="." align="char">68.29</td><td char="." align="char">63.78</td><td char="." align="char">59.09</td></tr><tr><td align="left" rowspan="2">Quantile</td><td align="left">Biological layer</td><td char="." align="char">49.85</td><td char="." align="char">9.59</td><td char="." align="char">0.73</td><td char="." align="char">64.44</td><td char="." align="char">60.80</td><td char="." align="char">55.07</td></tr><tr><td align="left">Technical layer</td><td char="." align="char">90.08</td><td char="." align="char">0.76</td><td char="." align="char">0.25</td><td char="." align="char">68.29</td><td char="." align="char">63.78</td><td char="." align="char">59.09</td></tr><tr><td align="left" rowspan="4">KNN</td><td align="left" rowspan="2">Median</td><td align="left">Biological layer</td><td char="." align="char">14.14</td><td char="." align="char">0.47</td><td char="." align="char">0.00</td><td char="." align="char">56.01</td><td char="." align="char">52.41</td><td char="." align="char">47.06</td></tr><tr><td align="left">Technical layer</td><td char="." align="char">0.00</td><td char="." align="char">0.00</td><td char="." align="char">0.00</td><td char="." align="char">46.05</td><td char="." align="char">41.89</td><td char="." align="char">35.45</td></tr><tr><td align="left" rowspan="2">Quantile</td><td align="left">Biological layer</td><td char="." align="char">13.39</td><td char="." align="char">0.36</td><td char="." align="char">0.00</td><td char="." align="char">55.66</td><td char="." align="char">51.75</td><td char="." align="char">46.89</td></tr><tr><td align="left">Technical layer</td><td char="." align="char">0.00</td><td char="." align="char">0.00</td><td char="." align="char">0.00</td><td char="." align="char">46.05</td><td char="." align="char">41.89</td><td char="." align="char">35.45</td></tr><tr><td align="left" rowspan="4">RF</td><td align="left" rowspan="2">Median</td><td align="left">Biological layer</td><td char="." align="char">75.30</td><td char="." align="char">30.85</td><td char="." align="char">3.73</td><td char="." align="char">69.62</td><td char="." align="char">65.87</td><td char="." align="char">60.77</td></tr><tr><td align="left">Technical layer</td><td char="." align="char">98.73</td><td char="." align="char">7.63</td><td char="." align="char">0.51</td><td char="." align="char">71.05</td><td char="." align="char">66.89</td><td char="." align="char">62.03</td></tr><tr><td align="left" rowspan="2">Quantile</td><td align="left">Biological layer</td><td char="." align="char">74.15</td><td char="." align="char">29.07</td><td char="." align="char">3.58</td><td char="." align="char">69.41</td><td char="." align="char">65.52</td><td char="." align="char">60.38</td></tr><tr><td align="left">Technical layer</td><td char="." align="char">98.73</td><td char="." align="char">7.12</td><td char="." align="char">0.51</td><td char="." align="char">71.12</td><td char="." align="char">67.03</td><td char="." align="char">62.03</td></tr></tbody></table><table-wrap-foot><p>The columns of proportion of reproducible metabolites per sample pair <inline-formula id="IEq209"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;70/80/90\%$$\end{document}</tex-math><mml:math id="M444"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>70</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>80</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq209.gif"/></alternatives></inline-formula> indicate that proportion of sample pairs of replicate experiments with reproducible metabolites per sample pair greater than <inline-formula id="IEq210"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;70/80/90\%$$\end{document}</tex-math><mml:math id="M446"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>70</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>80</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq210.gif"/></alternatives></inline-formula>. The columns of proportion of reproducible sample pairs per metabolite <inline-formula id="IEq211"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;70/80/90\%$$\end{document}</tex-math><mml:math id="M448"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>70</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>80</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq211.gif"/></alternatives></inline-formula> indicate that proportion of metabolites with reproducible sample pairs per metabolite greater than <inline-formula id="IEq212"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;70/80/90\%$$\end{document}</tex-math><mml:math id="M450"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>70</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>80</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq212.gif"/></alternatives></inline-formula></p></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="Sec38">
        <title>Reproducibility comparisons using MaRR and RSD</title>
        <p id="Par73">We compared MaRR and RSD measurements in terms of reproducibility for the BioTech data set. The reason we chose BioTech data set since it is a combination of both biological and technical replicates. We examined reproducibility, in particular RSD measurements versus MaRR based reproducible (and irreproducible) metabolite index in a scatter plot (technical and biological replicates of BioTech data set using RF-quantile pre-processing). We assigned a metabolite to be reproducible if the percent of reproducible sample pairs per metabolite is greater than a particular threshold value (<inline-formula id="IEq219"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$75\%$$\end{document}</tex-math><mml:math id="M452"><mml:mrow><mml:mn>75</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq219.gif"/></alternatives></inline-formula>) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S24(a) and S24(b) for reproducible metabolites; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S24(c) and S24(d) for irreproducible metabolites). The RSD values in the y-axis are shifted slightly higher for irreproducible metabolites compared to reproducible metabolites. One would expect reproducible metabolites to have relatively high variability (RSD) across subjects (biological replicates) and low variability across replicate samples (technical replicates), which was clearly not the case. Generally, in analytical metabolomics research, the RSD is calculated across pooled Quality Control (QC) samples for each metabolite and those with an RSD above a pre-determined cutoff (e.g., 20–30%) are removed [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR42">42</xref>]. However, we find that the RSD is not an ideal predictor of identifying high quality (reproducible) metabolites (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S25 and Table S4-complementary to Fig. S24). We used a filtering cutoff of 25% (horizontal black line in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S25) but the cutoff does not remove any of the irreproducible metabolites. Even though it assesses variability across technical replicates relatively well, it fails to capture the true variability (separating the reproducible and irreproducible metabolites) across biological replicates. Our MaRR procedure can detect reproducible and irreproducible metabolites with greater accuracy as shown using simulations. Our findings about the predictive ability of RSD in identifying reproducible and irreproducible metabolites are also in concordance with the findings of low and high quality metabolites (features) shown in another approach of filtering procedures for MS-Metabolomics data [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
      </sec>
      <sec id="Sec39">
        <title>Data-driven Reproducibility pipeline using MaRR</title>
        <p id="Par74">We argue that reproducibility methods should be data-driven and should not depend on a particular cutoff (or a range of cutoff, e.g., 20–30%). A data-driven pipeline is one which curates reproducibility to the specific requirements of a particular data set, rather than using predefined cutoffs. Here, we present a sequence of steps (Fig. <xref rid="Fig7" ref-type="fig">7</xref>) representing a data-driven pipeline in assessing reproducibility of MS-Metabolomics data. Our data-driven filtering approach consists steps for data pre-processing, identifying reproducible metabolites and sample pairs using the MaRR procedure and subsetting the reproducible data.<fig id="Fig7"><label>Fig. 7</label><caption><p>Data-driven reproducibility flow chart using the MaRR procedure. Flow chart of a data-driven reproducibility pipeline for MS-Metabolomics data. The approach is data-driven because the filtering cutoffs and level of significance can be specified by the user to identify reproducible metabolites and sample pairs prior to further downstream analysis</p></caption><graphic xlink:href="12859_2021_4336_Fig7_HTML" id="MO26"/></fig></p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec40">
    <title>Discussion</title>
    <p id="Par75">The biggest strength of MaRR is that with very limited assumptions, it can detect the reproducible signals efficiently. In the simulation studies, there were situations where the MaRR procedure was not conservative enough even though it achieved the main purpose of controlling the FDR at <inline-formula id="IEq220"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.05$$\end{document}</tex-math><mml:math id="M454"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq220.gif"/></alternatives></inline-formula>. This is due to the lack of separation between the reproducible and irreproducible components. In these scenarios, the real signals might fall in the undetectable regions because of overlapping between the reproducible and irreproducible components [<xref ref-type="bibr" rid="CR43">43</xref>]. For smaller values of <inline-formula id="IEq221"><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M456"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq221.gif"/></alternatives></inline-formula>, the finite sample performance deteriorates, making the detection of true signals unreliable. The powers for most of the situations were nearly one, meaning that all the true reproducible signals were discovered using the MaRR procedure. This indicates that the true reproducible signals identified using the MaRR procedure was high but these situations do not have inflated discriminative powers. Another interesting finding from the bias results was the systematic underestimation of <inline-formula id="IEq222"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M458"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq222.gif"/></alternatives></inline-formula> using the MaRR procedure. This suggests that the MaRR assumption yield a conservative estimator of <inline-formula id="IEq223"><alternatives><tex-math id="M459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M460"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq223.gif"/></alternatives></inline-formula>. In summary, FDR controls error rates well, has high power. The simulations confirm that the MaRR procedure performs sufficiently well in most situations except for smaller values of <inline-formula id="IEq224"><alternatives><tex-math id="M461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _1$$\end{document}</tex-math><mml:math id="M462"><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq224.gif"/></alternatives></inline-formula> and/or when the reproducible and irreproducible components are overlapping.</p>
    <p id="Par76">We applied the MaRR procedure to measure reproducibility both within and across batches using technical replicates for the Tech and BioTech datasets and biological replicates for the BioTech and Bio dataset. The MaRR procedure was originally developed to assess reproducibility of a pair of technical replicates (within labs and across labs variation) [<xref ref-type="bibr" rid="CR26">26</xref>]. The MaRR procedure tends to favor highly expressed abundance measurements. We extended the idea to pairwise combinations of multiple replicate experiments for both technical and biological replicate experiments. Our method does not require to have prior knowledge of the proportion of reproducible signals. We have shown in our simulation studies that our method can work well with values of proportion of reproducible signals as low as 0.2 and as high as 0.99.</p>
    <p id="Par77">We compared the MaRR procedure to commonly used reproducibility method using the BioTech dat set. To compare the methods, we identified reproducible metabolites using the MaRR procedure and then computed RSD for both biological and technical replicates in the BioTech data set. Our results indicate that reproducibility score is not strongly associated with RSD. We also showed how our MaRR based data-driven filtering approach has the ability to remove irreproducible metabolites and sample pairs while retaining reproducible metabolites and sample pairs based on simulations.</p>
    <p id="Par78">For the real data sets, we estimated the reproducible sample pairs per metabolite as well as reproducible metabolites per sample pair. The estimated proportion of reproducible signals were considerably high. For MS-Metabolomics real data, we adopted a more conservative approach to identify reproducible signals, i.e., with an FDR control at <inline-formula id="IEq225"><alternatives><tex-math id="M463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.01$$\end{document}</tex-math><mml:math id="M464"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq225.gif"/></alternatives></inline-formula> instead of <inline-formula id="IEq226"><alternatives><tex-math id="M465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.05$$\end{document}</tex-math><mml:math id="M466"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq226.gif"/></alternatives></inline-formula>. In the Tech data set (Fig. <xref rid="Fig5" ref-type="fig">5</xref>), the reproducible metabolites across all sample pairs (for operator layer and technical layer) were greater than 70%, indicating very high reproducibility (Table <xref rid="Tab1" ref-type="table">1</xref>). For the BioTech data set (Fig. <xref rid="Fig6" ref-type="fig">6</xref>), the percentage of reproducible metabolites per sample pair greater than 70% for technical replicates is much higher compared to their biological replicates. This result has also confirmed that there is higher reproducibility for technical replicates compared to their biological replicates from the same data set (BioTech). Similarly, the reproducible metabolites almost across all biological sample pairs <inline-formula id="IEq227"><alternatives><tex-math id="M467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\sim 98.52\%)$$\end{document}</tex-math><mml:math id="M468"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∼</mml:mo><mml:mn>98.52</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq227.gif"/></alternatives></inline-formula> were greater than 70% threshold (Table <xref rid="Tab1" ref-type="table">1</xref>). This could be due to false identification of true reproducible signals as irreproducible when there is a strong biological difference for a metabolite across samples. In addition, to create data-dependent threshold values (<inline-formula id="IEq228"><alternatives><tex-math id="M469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_s$$\end{document}</tex-math><mml:math id="M470"><mml:msub><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq228.gif"/></alternatives></inline-formula> and <inline-formula id="IEq229"><alternatives><tex-math id="M471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_m$$\end{document}</tex-math><mml:math id="M472"><mml:msub><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq229.gif"/></alternatives></inline-formula>) in the MaRR steps of the pipeline (Fig. <xref rid="Fig7" ref-type="fig">7</xref>), we also allow the users to visualize the histograms (e.g., Figs. <xref rid="Fig5" ref-type="fig">5</xref> and <xref rid="Fig6" ref-type="fig">6</xref>) and subsequently choose the more appropriate threshold values.</p>
    <p id="Par79">In this paper, our goal was not to do a comprehensive evaluation of pre-processing steps, but instead to show how this measure can be used as a benchmark for comparison. We used the MaRR procedure to compare different pre-processing pipelines. Our results simultaneously provide a useful assessment of three different replicate data sets (Tech, BioTech and Bio) in terms of reproducibility. Furthermore, our MaRR-based approach also allows the users to select the filtering threshold values (<inline-formula id="IEq230"><alternatives><tex-math id="M473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_s,\,c_m$$\end{document}</tex-math><mml:math id="M474"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>c</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq230.gif"/></alternatives></inline-formula>) for the identification of reproducible metabolites and sample pairs based on thorough output visualization checks (histograms of percent reproducible metabolites per sample pair and percent reproducible sample pairs per metabolite).</p>
  </sec>
  <sec id="Sec41">
    <title>Conclusion</title>
    <p id="Par80">In this paper, we have developed a data-driven approach to select reproducible metabolites and sample pairs as a post-processing step to performing further downstream analysis. The MaRR procedure can be applied to metabolomics studies to primarily assess the reproducibility of MS-Metabolomics data sets. In addition, the other potential use of the MaRR procedure could be flagging metabolites and samples that are less reproducible. As illustrated in this paper, the MaRR procedure can also be employed to evaluate different pre-processing pipelines (e.g., missing value imputation, normalization).</p>
    <p id="Par81">This research was motivated by reproducibility, which has proven to be a major obstacle in the use of genomic findings to advance clinical practice [<xref ref-type="bibr" rid="CR44">44</xref>]. We are hoping that this research will stimulate other groups to develop and evaluate new statistical frameworks for reproducibility.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec42">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4336_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>. Supplementary materials. Reproducibility of mass spectrometry based metabolomics data.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s12859-021-04336-9.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank all researchers of the Grant NIH/NCI U01 CA235488 (Multi-PI: Katerina Kechris and Debashis Ghosh) at the Colorado School of Public Health for feedback on the methodology and benchmarking. The authors also thank Dr. Russell Bowler for data access, Charmion Cruickshank-Quinn for data generation, Lucas Gillenwater for data pre-processing, Max McGrath for Shiny app.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author's Contributions</title>
    <p>T.G., K.K. and D.G. developed methods, designed analyses, and wrote the manuscript. T.G. implemented methods and performed analyses. D.P. developed methods and assisted with interpretation. W.Z. assisted with designing analyses. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Research reported in this paper was supported by NCI and NHLBI of the NIH under award numbers U01 CA235488, P20 HL113445, U01 HL089897 and U01 HL089856. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Data files for all benchmark data sets are available from Metabolomics Workbench at <ext-link ext-link-type="uri" xlink:href="https://www.metabolomicsworkbench.org">https://www.metabolomicsworkbench.org</ext-link> with Project ID PR000438 (BioTech data set) and Project ID PR000907 (Bio data set). The Bio data set can be accessed directly via its Project DOI: 10.21228/M8FQ2X. The BioTech data set can be accessed directly via its Project DOI: 10.21228/M8FC7C. This work is supported by NIH grant, U2C DK119886. The methods described in this paper are implemented in the open-source R package <italic>marr</italic>, which is freely available from Bioconductor at <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/marr">http://bioconductor.org/packages/marr</ext-link> [<xref ref-type="bibr" rid="CR45">45</xref>]. The <italic>marr</italic> package includes comprehensive help files for each function, as well as a package vignette demonstrating a complete example study design. A flowchart of the <italic>marr</italic> Bioconductor package is presented in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S26. Code scripts to reproduce all data preparation, simulation steps, generate all figures and tables are available from GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/Ghoshlab/marr_paper_evaluations">https://github.com/Ghoshlab/marr_paper_evaluations</ext-link>. The development version of the <italic>marr</italic> R package is available from GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/Ghoshlab/marr">https://github.com/Ghoshlab/marr</ext-link>. In terms of computational time, on a desktop with a 3.2 GHz processor and 16 GB memory, marr takes approximately 12 min 47 s to analyze a MS-Metabolomics data with 662 metabolites (features) and <inline-formula id="IEq231"><alternatives><tex-math id="M475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${393\atopwithdelims ()2}$$\end{document}</tex-math><mml:math id="M476"><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:mn>393</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq231.gif"/></alternatives></inline-formula> (i.e., 77028) sample pairs. marr takes approximately 13 min 02 s to analyze a MS-Metabolomics data with 2860 metabolites (features) and <inline-formula id="IEq232"><alternatives><tex-math id="M477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${393\atopwithdelims ()2}$$\end{document}</tex-math><mml:math id="M478"><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:mn>393</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_4336_Article_IEq232.gif"/></alternatives></inline-formula> (i.e., 77028) sample pairs. The computational complexity mainly depends on the sample pairs not on the number of metabolites (features). We have developed a Shiny-based Web application, called marr Shiny, for dynamic interaction with MS-metabolomics data that can run on any Web browser and requires no prior programming knowledge [<ext-link ext-link-type="uri" xlink:href="https://maxmcgrath.shinyapps.io/marr/">https://maxmcgrath.shinyapps.io/marr/</ext-link>]. Illustrative screenshots of the marr Shiny app pipeline are in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S27 and S28.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par82">No ethics approval was required for the study.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par83">Not Applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par84">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Maniscalco M, Fuschillo S, Paris D, Cutignano A, Sanduzzi A, Motta A. Clinical metabolomics of exhaled breath condensate in chronic respiratory diseases. In: Advances in clinical chemistry, vol. <bold>88</bold>. Elsevier; 2019. p. 121–149.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sarode</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kieffer</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Shibata</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Litwin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Czlonkowska</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Medici</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics profiles of patients with Wilson disease reveal a distinct metabolic signature</article-title>
        <source>Metabolomics</source>
        <year>2019</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>43</fpage>
        <pub-id pub-id-type="doi">10.1007/s11306-019-1505-6</pub-id>
        <pub-id pub-id-type="pmid">30868361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L-L</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Tong</surname>
            <given-names>M-L</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>L-R</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Niu</surname>
            <given-names>J-J</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>T-C</given-names>
          </name>
        </person-group>
        <article-title>Metabolite profiles of the cerebrospinal fluid in neurosyphilis patients determined by untargeted metabolomics analysis</article-title>
        <source>Front Neurosci</source>
        <year>2019</year>
        <volume>13</volume>
        <fpage>150</fpage>
        <pub-id pub-id-type="doi">10.3389/fnins.2019.00150</pub-id>
        <pub-id pub-id-type="pmid">30863278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanchez Arcos</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Kai</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Svatoš</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gershenzon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kunert</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Metabolomic approaches reveal differences in pea aphid host plant chemistry before and after infestation with different pea aphid host races</article-title>
        <source>Front Plant Sci</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>188</fpage>
        <pub-id pub-id-type="doi">10.3389/fpls.2019.00188</pub-id>
        <pub-id pub-id-type="pmid">30873192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Want</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Masson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Michopoulos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Theodoridis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Plumb</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Shockcor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Loftus</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Global metabolic profiling of animal and human tissues via UPLC-MS</article-title>
        <source>Nat Protoc</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>17</fpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2012.135</pub-id>
        <pub-id pub-id-type="pmid">23222455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spicer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Salek</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Moreno</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cañueto</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Steinbeck</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Navigating freely-available software tools for metabolomics analysis</article-title>
        <source>Metabolomics</source>
        <year>2017</year>
        <volume>13</volume>
        <issue>9</issue>
        <fpage>106</fpage>
        <pub-id pub-id-type="doi">10.1007/s11306-017-1242-7</pub-id>
        <pub-id pub-id-type="pmid">28890673</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allwood</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Martinez-Martin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Palau</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cowan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goodacre</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Howarth</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Rapid UHPLC-MS metabolite profiling and phenotypic assays reveal genotypic impacts of nitrogen supplementation in oats</article-title>
        <source>Metabolomics</source>
        <year>2019</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>42</fpage>
        <pub-id pub-id-type="doi">10.1007/s11306-019-1501-x</pub-id>
        <pub-id pub-id-type="pmid">30868357</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lohr</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Camp</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Kuzhiumparambil</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Lutz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Leggat</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Suggett</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Resolving coral photoacclimation dynamics through coupled photophysiological and metabolomic profiling</article-title>
        <source>J Exp Biol</source>
        <year>2019</year>
        <volume>222</volume>
        <issue>8</issue>
        <fpage>195982</fpage>
        <pub-id pub-id-type="doi">10.1242/jeb.195982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mahieu</surname>
            <given-names>NG</given-names>
          </name>
          <name>
            <surname>Patti</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Systems-level annotation of a metabolomics data set reduces 25000 features to fewer than 1000 unique metabolites</article-title>
        <source>Anal Chem</source>
        <year>2017</year>
        <volume>89</volume>
        <issue>19</issue>
        <fpage>10397</fpage>
        <lpage>10406</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.7b02380</pub-id>
        <pub-id pub-id-type="pmid">28914531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sugimoto</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hirayama</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Abe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Soga</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tomita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Prediction of metabolite identity from accurate mass, migration time prediction and isotopic pattern information in CE-TOFMS data</article-title>
        <source>Electrophoresis</source>
        <year>2010</year>
        <volume>31</volume>
        <issue>14</issue>
        <fpage>2311</fpage>
        <lpage>2318</lpage>
        <pub-id pub-id-type="doi">10.1002/elps.200900584</pub-id>
        <pub-id pub-id-type="pmid">20568260</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Rabinowitz</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Analytical strategies for LC–MS-based targeted metabolomics</article-title>
        <source>J Chromatogr B</source>
        <year>2008</year>
        <volume>871</volume>
        <issue>2</issue>
        <fpage>236</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jchromb.2008.04.031</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeHaven</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lawton</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Organization of GC/MS and LC/MS metabolomics data into chemical libraries</article-title>
        <source>J Cheminform</source>
        <year>2010</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>9</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-2-9</pub-id>
        <pub-id pub-id-type="pmid">20955607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bickel</surname>
            <given-names>PJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Measuring reproducibility of high-throughput experiments</article-title>
        <source>Ann Appl Stat</source>
        <year>2011</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>1752</fpage>
        <lpage>1779</lpage>
        <pub-id pub-id-type="doi">10.1214/11-AOAS466</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Porazinska</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Sung</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Giblin-Davis</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>WK</given-names>
          </name>
        </person-group>
        <article-title>Reproducibility of read numbers in high-throughput sequencing analysis of nematode community composition and structure</article-title>
        <source>Mol Ecol Resour</source>
        <year>2010</year>
        <volume>10</volume>
        <issue>4</issue>
        <fpage>666</fpage>
        <lpage>676</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1755-0998.2009.02819.x</pub-id>
        <pub-id pub-id-type="pmid">21565071</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Mane</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <issue>9</issue>
        <fpage>1509</fpage>
        <lpage>1517</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.079558.108</pub-id>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">AC’t Hoen P, Friedländer MR, Almlöf J, Sammeth M, Pulyakhina I, Anvar SY, Laros JF, Buermans HP, Karlberg O, Brännvall M, et al. Reproducibility of high-throughput MRNA and small RNA sequencing across laboratories. Nat Biotechnol 2013;31(11):1015.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Talloen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hochreiter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bijnens</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kasim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shkedy</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Amaratunga</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Göhlmann</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Filtering data from high-throughput experiments based on measurement reliability</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2010</year>
        <volume>107</volume>
        <issue>46</issue>
        <fpage>173</fpage>
        <lpage>174</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1010604107</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arvidsson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kwasniewski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Riaño-Pachón</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Mueller-Roeber</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Quantprime-a flexible tool for reliable high-throughput primer design for quantitative PCR</article-title>
        <source>BMC Bioinform</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>465</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Spencer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>IF</given-names>
          </name>
          <name>
            <surname>Biswal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Frank</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Gabrielson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Garcia</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Geoghegan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Germino</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiple-laboratory comparison of microarray platforms</article-title>
        <source>Nat Methods</source>
        <year>2005</year>
        <volume>2</volume>
        <issue>5</issue>
        <fpage>345</fpage>
        <lpage>350</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth756</pub-id>
        <pub-id pub-id-type="pmid">15846361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A regression framework for assessing covariate effects on the reproducibility of high-throughput experiments</article-title>
        <source>Biometrics</source>
        <year>2018</year>
        <volume>74</volume>
        <issue>3</issue>
        <fpage>803</fpage>
        <lpage>813</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12832</pub-id>
        <pub-id pub-id-type="pmid">29192968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Zhang F, Shen F, Yang T, Li Q. Segmented correspondence curve regression model for quantifying reproducibility of high-throughput experiments. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1807.00943">arXiv:1807.00943</ext-link> 2018.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Soufan</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Caraus</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bourque</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Metaboanalyst 4.0: towards more transparent and integrative metabolomics analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>W1</issue>
        <fpage>486</fpage>
        <lpage>494</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky310</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schiffman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Petrick</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Perttula</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yano</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Carlsson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Whitehead</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Metayer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rappaport</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Filtering procedures for untargeted LC–MS metabolomics data</article-title>
        <source>BMC Bioinform</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-2871-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giacomoni</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Le Corguille</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Monsoor</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Landi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pericard</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pétéra</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Duperier</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tremblay-Franco</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>J-F</given-names>
          </name>
          <name>
            <surname>Jacob</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Workflow4metabolomics: a collaborative research infrastructure for computational metabolomics</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>9</issue>
        <fpage>1493</fpage>
        <lpage>1495</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu813</pub-id>
        <pub-id pub-id-type="pmid">25527831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kirpich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koelmel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kalavalapalli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Morse</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cusi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sunny</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>McIntyre</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Garrett</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yost</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Improved experimental data processing for UHPLC-HRMS/MS lipidomics applied to nonalcoholic fatty liver disease</article-title>
        <source>Metabolomics</source>
        <year>2017</year>
        <volume>13</volume>
        <issue>11</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1007/s11306-017-1280-1</pub-id>
        <pub-id pub-id-type="pmid">27980501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Philtron</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lyu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Maximum rank reproducibility: a nonparametric approach to assessing reproducibility in replicate experiments</article-title>
        <source>J Am Stat Assoc</source>
        <year>2018</year>
        <volume>113</volume>
        <issue>523</issue>
        <fpage>1028</fpage>
        <lpage>1039</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2017.1397521</pub-id>
        <pub-id pub-id-type="pmid">31249430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Siegmund</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Strong control, conservative point estimation and simultaneous conservative consistency of false discovery rates: a unified approach</article-title>
        <source>J R Stat Soc Ser B (Stat Methodol)</source>
        <year>2004</year>
        <volume>66</volume>
        <issue>1</issue>
        <fpage>187</fpage>
        <lpage>205</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2004.00439.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Genovese</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wasserman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Operating characteristics and extensions of the false discovery rate procedure</article-title>
        <source>J R Stat Soc Ser B (Stat Methodol)</source>
        <year>2002</year>
        <volume>64</volume>
        <issue>3</issue>
        <fpage>499</fpage>
        <lpage>517</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9868.00347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Heller R, Gur H. False discovery rate controlling procedures for discrete tests. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1112.4627">arXiv:1112.4627</ext-link> 2011.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Ser B (Methodol)</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Regan</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Hokanson</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Make</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Beaty</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Curran-Everett</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Silverman</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Crapo</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Genetic epidemiology of COPD (COPDGene) study design</article-title>
        <source>COPD: J Chron Obstruct Pulmon Dis</source>
        <year>2011</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>32</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.3109/15412550903499522</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cruickshank-Quinn</surname>
            <given-names>CI</given-names>
          </name>
          <name>
            <surname>Jacobson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Powell</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Petrache</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kechris</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bowler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Reisdorph</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics and transcriptomics pathway approach reveals outcome-specific perturbations in COPD</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>17132</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-35372-w</pub-id>
        <pub-id pub-id-type="pmid">30459441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evans</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>DeHaven</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mitchell</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Milgram</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Integrated, nontargeted ultrahigh performance liquid chromatography/electrospray ionization tandem mass spectrometry platform for the identification and relative quantification of the small-molecule complement of biological systems</article-title>
        <source>Anal Chem</source>
        <year>2009</year>
        <volume>81</volume>
        <issue>16</issue>
        <fpage>6656</fpage>
        <lpage>6667</lpage>
        <pub-id pub-id-type="doi">10.1021/ac901536h</pub-id>
        <pub-id pub-id-type="pmid">19624122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hughes</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cruickshank-Quinn</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Reisdorph</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lutz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Petrache</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Reisdorph</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bowler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kechris</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>MSPrep–summarization, normalization and diagnostics for processing of mass spectrometry-based metabolomic data</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>30</volume>
        <issue>1</issue>
        <fpage>133</fpage>
        <lpage>134</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt589</pub-id>
        <pub-id pub-id-type="pmid">24174567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bijlsma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bobeldijk</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Verheij</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Ramaker</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kochhar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Macdonald</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Van Ommen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Smilde</surname>
            <given-names>AK</given-names>
          </name>
        </person-group>
        <article-title>Large-scale human metabolomics studies: a strategy for data (pre-) processing and validation</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <issue>2</issue>
        <fpage>567</fpage>
        <lpage>574</lpage>
        <pub-id pub-id-type="doi">10.1021/ac051495j</pub-id>
        <pub-id pub-id-type="pmid">16408941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stacklies</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Redestig</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Scholz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Walther</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Selbig</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>pcaMethods—a bioconductor package providing PCA methods for incomplete data</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>9</issue>
        <fpage>1164</fpage>
        <lpage>1167</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm069</pub-id>
        <pub-id pub-id-type="pmid">17344241</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Armitage</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Godzien</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alonso-Herranz</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>López-Gonzálvez</surname>
            <given-names>Á</given-names>
          </name>
          <name>
            <surname>Barbas</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Missing value imputation strategies for metabolomics data</article-title>
        <source>Electrophoresis</source>
        <year>2015</year>
        <volume>36</volume>
        <issue>24</issue>
        <fpage>3050</fpage>
        <lpage>3060</lpage>
        <pub-id pub-id-type="doi">10.1002/elps.201500352</pub-id>
        <pub-id pub-id-type="pmid">26376450</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Hastie T, Tibshirani R, Sherlock G, Eisen M, Brown P, Botstein D. Imputing missing data for gene expression arrays;1999.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kokla</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Virtanen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kolehmainen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paananen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hanhineva</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Random forest-based imputation outperforms other methods for imputing LC-MS metabolomics data: a comparative study</article-title>
        <source>BMC Bioinform.</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-3110-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hrydziuszko</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Viant</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Missing values in mass spectrometry based metabolomics: an undervalued step in the data processing pipeline</article-title>
        <source>Metabolomics</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>161</fpage>
        <lpage>174</lpage>
        <pub-id pub-id-type="doi">10.1007/s11306-011-0366-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Webb-Robertson</surname>
            <given-names>B-JM</given-names>
          </name>
          <name>
            <surname>Wiberg</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Matzke</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McDermott</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Rodland</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Metz</surname>
            <given-names>TO</given-names>
          </name>
          <name>
            <surname>Pounds</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Review, evaluation, and discussion of the challenges of missing value imputation for mass spectrometry-based label-free global proteomics</article-title>
        <source>J Proteome Res</source>
        <year>2015</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>1993</fpage>
        <lpage>2001</lpage>
        <pub-id pub-id-type="doi">10.1021/pr501138h</pub-id>
        <pub-id pub-id-type="pmid">25855118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Reinke SN, Gallart-Ayala H, Gómez C, Checa A, Fauland A, Naz S, Kamleh MA, Djukanović R, Hinks TS, Wheelock CE. Metabolomics analysis identifies different metabotypes of asthma severity. Eur Respir J 2017;49(3).</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donoho</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Higher criticism for detecting sparse heterogeneous mixtures</article-title>
        <source>Ann Stat</source>
        <year>2004</year>
        <volume>32</volume>
        <issue>3</issue>
        <fpage>962</fpage>
        <lpage>994</lpage>
        <pub-id pub-id-type="doi">10.1214/009053604000000265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Lin X. Reproducibility and replicability in large scale genetic studies. In: Committee on reproducibility and replicability in science, National Academies of Sciences. Engineering, and Medicine;2018.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Ghosh T, McGrath M, Philtron D, Kechris K, Ghosh DM, Maximum rank reproducibility. In: R/Bioconductor package version 1.00.02; 2021.</mixed-citation>
    </ref>
  </ref-list>
</back>
