<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6819480</article-id>
    <article-id pub-id-type="publisher-id">3154</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3154-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Legofit: estimating population history from genetic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3987-3346</contrib-id>
        <name>
          <surname>Rogers</surname>
          <given-names>Alan R.</given-names>
        </name>
        <address>
          <email>rogers@anthro.utah.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2193 0096</institution-id><institution-id institution-id-type="GRID">grid.223827.e</institution-id><institution>Department of Anthropology, University of Utah, </institution></institution-wrap>Gardner Commons, Salt Lake City, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>526</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Our current understanding of archaic admixture in humans relies on statistical methods with large biases, whose magnitudes depend on the sizes and separation times of ancestral populations. To avoid these biases, it is necessary to estimate these parameters simultaneously with those describing admixture. Genetic estimates of population histories also confront problems of statistical identifiability: different models or different combinations of parameter values may fit the data equally well. To deal with this problem, we need methods of model selection and model averaging, which are lacking from most existing software.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">The Legofit software package allows simultaneous estimation of parameters describing admixture, and the sizes and separation times of ancestral populations. It includes facilities for data manipulation, estimation, analysis of residuals, model selection, and model averaging.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Legofit uses genetic data to study the history of a subdivided population. It is unaffected by recent history and can therefore focus on the deep history of population size, subdivision, and admixture. It outperforms several statistical methods that have been widely used to study population history and should be useful in any species for which DNA sequence data is available from several populations.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Population history</kwd>
      <kwd>Coalescent theory</kwd>
      <kwd>Genetics</kwd>
      <kwd>Evolution</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BCS 1638840</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Center for Scientific Computing, University of Utah</institution>
        </funding-source>
        <award-id>Not available</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Genetic data now play a prominent role in research on human prehistory. In less than a decade, we have learned that modern humans carry DNA from Neanderthal ancestors [<xref ref-type="bibr" rid="CR1">1</xref>] and also from a previously unknown “Denisovan” population [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]; we have learned that the European Neolithic was primarily a movement of peoples [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], but that farmers and foragers then lived side by side, exchanging genes for thousands of years [<xref ref-type="bibr" rid="CR6">6</xref>]; we have learned that Indo-Europeans arrived in Europe about 5000 years ago as invaders from the Pontic Steppes [<xref ref-type="bibr" rid="CR7">7</xref>]; and we have learned that some populations carry DNA from “superarchaics,” which separated from other humans perhaps a million years ago [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p>There are reasons, however, to be skeptical of these new findings. First, many of the statistics used to estimate archaic admixture have large biases. For example, Rogers and Bohlender ([<xref ref-type="bibr" rid="CR10">10</xref>], Fig. 4) document biases in one statistic that range from 50 to 600%, depending on the separation time of Neanderthals and Denisovans. Petr et al. [<xref ref-type="bibr" rid="CR11">11</xref>] show that similar bias in another statistic underlies an apparent (but artifactual) decline in the frequency of Neanderthal DNA in Europe during the past 45,000 years. To avoid these biases, one must simultaneously estimate the parameters that underlie them.</p>
    <p>In addition to bias, there are also problems of statistical identifiability, which arise when several models fit the data equally well. Identifiability problems can lead us to prefer incorrect models of history, and they can make confidence intervals unrealistically narrow. Consequently, it is likely that some of the recent findings summarized above are incorrect.</p>
    <p>The Legofit package [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>] introduces methods that address these problems. It reduces bias by allowing simultaneous estimation of the parameters that introduce bias into competing estimators. It uses model selection and model averaging to cope with identifiability problems, and it uses residual analysis to diagnose misspecified models. This article will not attempt a comprehensive review of genetic methods for estimation of population history. Instead, it will describe Legofit and compare it against several methods that are widely used in the study of archaic admixture.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Nucleotide site patterns</title>
      <p>Legofit works with the frequencies of <italic>nucleotide site patterns</italic> [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>], which are defined below. The first step in any analysis involves tabulating site pattern frequencies from data. Legofit provides tools that tabulate these frequencies from standard data formats and also from several forms of simulation output.</p>
      <p>Site patterns are illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. A nucleotide site exhibits the <italic>yn</italic> site pattern if random nucleotides drawn from populations <italic>Y</italic> and <italic>N</italic> carry the derived allele, but those drawn from other populations carry the ancestral allele. They represent the special case of the site frequency spectrum [<xref ref-type="bibr" rid="CR16">16</xref>] in which the sample consists of one haploid genome per population.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Population network with embedded gene tree. A mutation on the solid red branch would generate site pattern <italic>yn</italic> (shown in red at the base of the tree). One on the solid blue branch would generate <italic>ynd</italic>. “0” and “1” represent the ancestral and derived alleles. Key: <italic>X</italic>, Africa; <italic>Y</italic>, Eurasia; <italic>N</italic>, Neanderthal; <italic>D</italic>, Denisovan</p></caption><graphic xlink:href="12859_2019_3154_Fig1_HTML" id="MO1"/></fig>
</p>
      <p>Many different gene trees—even trees with different topologies—may contribute to any given site pattern. Nonetheless, let us begin with a particular gene tree, which is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. There we see a population network and, embedded within it, the gene tree (or gene genealogy) of one particular locus (nucleotide site). A mutation on the red branch would generate <italic>yn</italic>, whereas one on the blue branch would generate <italic>ynd</italic>. Mutations elsewhere would generate other site patterns. Let <italic>B</italic><sub><italic>i</italic></sub> represent the length in generations of the branch generating site pattern <italic>i</italic>. For example, <italic>B</italic><sub><italic>yn</italic></sub> is the length of the red branch in Fig. <xref rid="Fig1" ref-type="fig">1</xref> and <italic>B</italic><sub><italic>ynd</italic></sub> is the length of the blue branch. The gene tree will vary from locus to locus, and in any given gene tree many of these lengths will be zero. For example, <italic>B</italic><sub><italic>xy</italic></sub>=0 in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, because no single mutation on that gene tree could generate site pattern <italic>xy</italic>.</p>
      <p>At a particular locus, and conditional on <italic>B</italic><sub><italic>i</italic></sub>, the number of mutations on the branch generating pattern <italic>i</italic> is Poisson with mean <italic>u</italic><italic>B</italic><sub><italic>i</italic></sub>, where <italic>u</italic> is the mutation rate per nucleotide site per generation. We use the model of infinite sites [<xref ref-type="bibr" rid="CR17">17</xref>], which assumes that <italic>u</italic> is small enough that we can ignore the possibility of multiple mutations on a given branch. To this standard of approximation, the unconditional probability of site pattern <italic>i</italic> on a random gene tree is <italic>u</italic><italic>E</italic>[ <italic>B</italic><sub><italic>i</italic></sub>], where the expectation is with respect to the coalescent process constrained by the network of populations.</p>
      <p>Let <italic>I</italic><sub><italic>i</italic></sub> represent the count of site pattern <italic>i</italic> across all sequenced nucleotide positions. Its expected value is <italic>E</italic>[ <italic>I</italic><sub><italic>i</italic></sub>]=<italic>u</italic><italic>L</italic><italic>E</italic>[ <italic>B</italic><sub><italic>i</italic></sub>], where <italic>L</italic> is the number of nucleotide positions in the sequence. The probability that a particular polymorphic site exhibits pattern <italic>i</italic> is 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ P_{i} = \frac{E[\!B_{i}]}{\sum_{j\in \Omega} E[\!B_{j}]}   $$ \end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>Ω</mml:mi></mml:mrow></mml:munder><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2019_3154_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>Ω</italic> is the set of site patterns under study.</p>
      <p>In previous publications [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR18">18</xref>] we and others have derived analytical expressions for <italic>E</italic>[ <italic>B</italic><sub><italic>i</italic></sub>] under particular models of history. This analytical approach becomes difficult as models grow in complexity. Legofit relies instead on computer simulations, which make it feasible to deal with complex models of history. In each iteration of the simulation, the coalescent algorithm builds a gene genealogy analogous to the one in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. From this genealogy, legofit<xref ref-type="fn" rid="Fn1">1</xref> calculates branch lengths (<italic>B</italic><sub><italic>i</italic></sub>). It estimates <italic>E</italic>[ <italic>B</italic><sub><italic>i</italic></sub>] as the average of <italic>B</italic><sub><italic>i</italic></sub> across simulation replicates. Equation <xref rid="Equ1" ref-type="">1</xref> then estimates <italic>P</italic><sub><italic>i</italic></sub>.</p>
      <p>This approach simulates branch lengths but not mutations, and the simulations can be done in parallel. For a given level of accuracy, it is orders of magnitude faster than programs that simulate both mutation and recombination, as shown in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. This speed makes it possible to deal with the entire suite of site patterns and with complex models involving tens of populations. Nonetheless, this is still a computationally intensive approach. In a recent analysis [<xref ref-type="bibr" rid="CR19">19</xref>], we studied nine different models. This took 10 days to do but would have taken 12 years without parallel processing. This 440-fold speed-up was possible because the calculations were parallelized not only across cores on each compute node, but also across nodes on the cluster at our local Center for High-Performance Computing. The legofit program parallelizes automatically across cores. Section 4 of the Additional file <xref rid="MOESM1" ref-type="media">1</xref> describes methods for parallel processing on a cluster.</p>
      <p>To validate our numerical approach to estimating probabilities, we compared it with theoretical results in models for which analytical theory is feasible [<xref ref-type="bibr" rid="CR10">10</xref>]. We can also validate by comparing the expected values generated by our method to data simulated in other ways. This is done in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, which shows that all three simulators generate distributions of site pattern frequencies that are centered around the expected values estimated by legofit. This verifies the reliability of our approach.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Deviation from expected values in 50 data sets generated by each of three simulation programs: ms [<xref ref-type="bibr" rid="CR20">20</xref>], msprime [<xref ref-type="bibr" rid="CR21">21</xref>], and scrm [<xref ref-type="bibr" rid="CR22">22</xref>]. All simulations assume the same model of history, which is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref> and described fully in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. Expected values were calculated with legosim. Blue circles show 50 simulated data sets</p></caption><graphic xlink:href="12859_2019_3154_Fig2_HTML" id="MO2"/></fig>
</p>
    </sec>
    <sec id="Sec4">
      <title>Models of history</title>
      <p>A model of population history is specified in a file whose name ends with “.lgo.” This file specifies the population network and the location of genetic samples within it. It uses a flexible syntax to describe population histories of arbitrary complexity. Populations can separate, combine, exchange migrants, and change in size. Changes in population size occur in discrete steps, and episodes of gene flow are modeled as discrete events, but there is no limit on the number of steps or episodes of gene flow. A model with <italic>K</italic> samples generates 2<sup><italic>K</italic></sup>−2 site patterns. For example, 10 samples would generate 1022 site patterns, which would provide a rich basis for estimating parameters.</p>
      <p>Parameters fall into three categories: (1) <italic>free</italic> parameters are estimated by legofit; (2) <italic>fixed</italic> parameters have values that do not change; and (3) <italic>constrained</italic> parameters are specified as known functions of one or more other parameters. Constrained parameters model relationships among variables. We use them below to reexpress free variables in terms of principal components.</p>
    </sec>
    <sec id="Sec5">
      <title>Tabulating site patterns from data</title>
      <p>The first stage of analysis involves tabulating site patterns from DNA sequence data. These data need not be phased, but they should be free of ascertainment bias. In the discussion above, I assumed that one haploid genome is sampled from each population. Real samples are larger, and a given nucleotide site may contribute to several site patterns. The contribution to a given site pattern is the probability that a sub-sample, consisting of one haploid genome drawn at random from the larger sample of each population, would exhibit this site pattern. For example, consider a model with three populations, <italic>X</italic>, <italic>Y</italic>, and <italic>N</italic>, and let <italic>p</italic><sub><italic>iX</italic></sub>,<italic>p</italic><sub><italic>iY</italic></sub>, and <italic>p</italic><sub><italic>iN</italic></sub> represent derived allele frequencies at the <italic>i</italic>th polymorphic site in the samples from these populations. Then site pattern <italic>xy</italic> occurs at site <italic>i</italic> with probability <italic>z</italic><sub><italic>i</italic></sub>=<italic>p</italic><sub><italic>iX</italic></sub><italic>p</italic><sub><italic>iY</italic></sub>(1−<italic>p</italic><sub><italic>iN</italic></sub>) ([<xref ref-type="bibr" rid="CR1">1</xref>], p. S131). Aggregating over sites, <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$I_{xy} = \sum _{i} z_{i}$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">xy</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3154_Article_IEq1.gif"/></alternatives></inline-formula> summarizes the information in the data about this site pattern. In general, for the <italic>j</italic>th site pattern, the analogous summary is <italic>I</italic><sub><italic>j</italic></sub>. In this formulation <italic>I</italic><sub><italic>j</italic></sub> is no longer a count. It is the expected count in a random subsample of the full sample.</p>
      <p>The Legofit package includes programs for tabulating site patterns from data and from several publicly-available programs for coalescent simulation: ms [<xref ref-type="bibr" rid="CR20">20</xref>], msprime [<xref ref-type="bibr" rid="CR21">21</xref>], and scrm [<xref ref-type="bibr" rid="CR22">22</xref>].</p>
    </sec>
    <sec id="Sec6">
      <title>Estimation</title>
      <p>Legofit estimates parameters by maximizing the composite likelihood, 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ L(\theta) = \prod_{j \in \Omega} P_{j}^{I_{j}}(\theta)   $$ \end{document}</tex-math><mml:math id="M6"><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>Ω</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12859_2019_3154_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>P</italic><sub><italic>j</italic></sub> is as given in Eq. <xref rid="Equ1" ref-type="">1</xref>, <italic>Ω</italic> is the set of site patterns under study, and <italic>θ</italic> is a vector of free parameters. This is not the full likelihood, because it ignores linkage disequilibrium and treats nucleotide sites as though they were independent.</p>
      <p>Legofit uses a numerical algorithm—differential evolution (DE, [<xref ref-type="bibr" rid="CR23">23</xref>])—to maximize <italic>L</italic>. DE maintains a swarm of points, which are initially distributed widely across the parameter space. In each generation, these points mutate and recombine to form offspring, which then undergo selection to form the next generation. The objective functions of the points are evaluated in parallel, in separate threads of execution. This process involves several stages, beginning with an initial stage in which the objective function is evaluated with modest precision and progressing to a final stage, which typically uses two million simulation replicates per function evaluation. This provides much more precision than a sample of two million polymorphic nucleotide sites, because we are simulating branch lengths only—not mutation or recombination. (See the Additional file <xref rid="MOESM1" ref-type="media">1</xref> for details).</p>
    </sec>
    <sec id="Sec7">
      <title>Bootstrap confidence intervals</title>
      <p>The Legofit package uses a bootstrap [<xref ref-type="bibr" rid="CR24">24</xref>] to measure uncertainty. Because linked loci are not statistically independent, we cannot use an ordinary bootstrap. Instead, Legofit uses a moving-blocks bootstrap [<xref ref-type="bibr" rid="CR25">25</xref>], which resamples blocks of nucleotides. By default, each block consists of 500 polymorphic nucleotide sites.</p>
      <p>Bootstrap replicates approximate independent samples from the stochastic process that produced the original data. By applying legofit to many bootstrap replicates, we obtain an approximation of the sampling distribution of the estimates. This distribution is used to estimate confidence intervals.</p>
      <p>Each bootstrap replicate is analyzed by a separate instance of the legofit program. These instances can operate in parallel, on separate nodes of a compute cluster. Legofit is thus parallel in two senses: within each node, legofit uses multiple threads to parallelize across the points maintained by the DE algorithm. It also uses multiple nodes to parallelize across bootstrap replicates.</p>
    </sec>
    <sec id="Sec8">
      <title>Model selection</title>
      <p>The study of population history requires that we choose among complex, non-nested models. Better fits can usually be achieved with more complex models, but this improvement may be illusory—the consequence of fitting noise rather than signal. Overfitting, as this is called, can produce incorrect inferences about population history [<xref ref-type="bibr" rid="CR26">26</xref>]. We may report evidence of gene flow or of bottlenecks in population size where no such inference is warranted. Reliable inference requires that we protect against overfitting. This is not possible with the genetic methods currently used to study archaic admixture.</p>
      <p>In other statistical contexts, such problems might be addressed via tools such as Akaike’s information criterion (AIC, [<xref ref-type="bibr" rid="CR27">27</xref>]), or the Bayesian information criterion (BIC, [<xref ref-type="bibr" rid="CR28">28</xref>]), which penalize complex models in a principled way. These tools, however, require access to the full likelihood function, which is never available for genome-scale data sets. Because of the size and complexity of the nuclear genome, all statistical methods simplify the problem in some way. Legofit uses <italic>composite likelihood</italic>, which ignores genetic linkage and treats nucleotide sites as though they were statistically independent. This produces unbiased estimates but does not allow us to use AIC or BIC.</p>
      <p>Legofit provides two methods of model selection: the <italic>bootstrap estimate of predictive error</italic> (bepe, [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]), and a <italic>composite likelihood information criterion</italic> (clic, [<xref ref-type="bibr" rid="CR30">30</xref>]).</p>
      <sec id="Sec9">
        <title>Bootstrap estimate of predictive error (bepe)</title>
        <p>Bepe is analogous to cross-validation, but uses bootstrap replicates instead of partitions of the data. The first step in the process uses legofit to fit a given model to each bootstrap replicate. These runs report the predicted frequency of each nucleotide site pattern. Legofit’s “bepe” program then calculates the mean squared difference between these bootstrap-predicted frequencies and those in the real data and applies a small bias correction. The resulting estimate of predictive error compares favorably with cross-validation ([<xref ref-type="bibr" rid="CR24">24</xref>], sec. 17.6). It is convenient, because we need bootstraps anyway for confidence intervals.</p>
      </sec>
      <sec id="Sec10">
        <title>Composite likelihood information criterion (clic)</title>
        <p>Clic generalizes Akaike’s information criterion (AIC, [<xref ref-type="bibr" rid="CR27">27</xref>]) to the case of composite likelihood. Varin and Vidoni ([<xref ref-type="bibr" rid="CR30">30</xref>], p. 523) define an information criterion that is the negative of 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{clic} = -\ln L(\theta) - \text{tr}\{H C\},   $$ \end{document}</tex-math><mml:math id="M8"><mml:mtext>clic</mml:mtext><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo>ln</mml:mo><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mtext>tr</mml:mtext><mml:mo>{</mml:mo><mml:mtext mathvariant="italic">HC</mml:mtext><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_3154_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>I have reversed the sign so that we can select models by minimizing (rather than maximizing) clic. In this expression, <italic>L</italic> is composite likelihood (Eq. <xref rid="Equ2" ref-type="">2</xref>), <italic>θ</italic> is the vector of parameters, <italic>C</italic> is a matrix whose <italic>ij</italic>th entry is the sampling covariance between the <italic>i</italic>th and <italic>j</italic>th parameters, and <italic>H</italic> is the expectation of the negative of the Hessian matrix, and “tr” represents the matrix trace.</p>
        <p>I estimate <italic>C</italic> from covariances across bootstrap or simulation replicates. <italic>H</italic> is a matrix of expectations of second-order partial derivatives of ln<italic>L</italic> with respect to pairs of parameters. Rather than taking these expectations, I evaluate the derivatives at the maximum composite likelihood estimate, <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \theta $\end{document}</tex-math><mml:math id="M10"><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3154_Article_IEq2.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR31">31</xref>]. Within a small neighborhood near <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \theta $\end{document}</tex-math><mml:math id="M12"><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3154_Article_IEq3.gif"/></alternatives></inline-formula>, ln<italic>L</italic> can be approximated by a quadratic surface, 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \ln L(\theta) \approx \alpha + \sum_{i} \beta_{i} (\theta_{i} - \hat\theta_{i}) + \sum_{i\leq j} \gamma_{ij} (\theta_{i} - \hat\theta_{i})(\theta_{j} - \hat\theta_{j}),   $$ \end{document}</tex-math><mml:math id="M14"><mml:mo>ln</mml:mo><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_3154_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>α</italic> is the <italic>Y</italic> intercept, and <italic>β</italic><sub><italic>i</italic></sub> and <italic>γ</italic><sub><italic>ij</italic></sub> are regression coefficients.</p>
        <p>I estimate <italic>α</italic>,<italic>β</italic><sub><italic>i</italic></sub>, and <italic>γ</italic><sub><italic>ij</italic></sub> by ordinary least squares, using points in the neighborhood of the estimate, <inline-formula id="IEq4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \theta $\end{document}</tex-math><mml:math id="M16"><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3154_Article_IEq4.gif"/></alternatives></inline-formula>. Then <italic>H</italic> is assembled using the second-order derivatives of ln<italic>L</italic>, as implied by Eq. <xref rid="Equ4" ref-type="">4</xref>. Finally, <italic>C</italic> and <italic>H</italic> are used with Eq. <xref rid="Equ3" ref-type="">3</xref> to calculate clic.</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Bootstrap model averaging (booma)</title>
      <p>Below, we will consider three models whose bepe values are 2.17×10<sup>−7</sup>,5.54×10<sup>−7</sup>, and 6.17×10<sup>−5</sup>. The first model has the smallest value and is therefore preferred. But the other values are also small. Are we justified in ignoring them? To answer this question, let us consider the problem of model averaging.</p>
      <p>When no model is clearly superior, it is better to average across several than to choose just one [<xref ref-type="bibr" rid="CR32">32</xref>]. Otherwise, confidence intervals are misleadingly narrow because they ignore uncertainty about the model itself. In model averaging, individual models are assigned weights as discussed below. Parameters are estimated as the weighted average of estimates from individual models. Most authors rely on information criteria to provide the weights [<xref ref-type="bibr" rid="CR33">33</xref>]. One could use clic in this way, but I prefer <italic>bootstrap model averaging</italic> [<xref ref-type="bibr" rid="CR32">32</xref>], which works with either bepe or clic.</p>
      <p>This method is implemented by the Legofit program “booma.” Some model selection criterion (bepe or clic) is calculated separately for the real data and for each bootstrap replicate. (To calculate bepe for a bootstrap replicate, we pretend that the replicate is real data and the real data are a bootstrap replicate.) If there are 50 bootstrap replicates, this process gives us 51 values of the model selection criterion for each model. For each of these 51 cases, booma asks which model “wins,” i.e., which has the lowest value of the criterion. The weight of the <italic>i</italic>th model is the fraction of cases in which it is the winning model.</p>
      <p>Using these weights, booma averages across models to obtain a model-averaged estimate of each parameter. If a parameter is present in only a subset of the models, the weights are re-normalized so that they sum to unity across this subset. This averaging is applied not only to the real data but also to each bootstrap replicate. This allows us to estimate confidence intervals for model-averaged estimators.</p>
      <p>If one model is clearly superior, its weight will be unity and those of the other models will be zero. This provides a simple criterion for choosing one model over its alternatives. For the three models mentioned at the top of this section, the weights were 1, 0, and 0. This implies that the differences among the bepe values are large compared to those expected in repeated sampling from the stochastic process that generated the original data. We are therefore justified in rejecting all models but the first. This analysis is described in more detail below.</p>
    </sec>
    <sec id="Sec12">
      <title>Identifiability and principal components</title>
      <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> illustrates a problem of statistical identifiability, which arises frequently not only with Legofit, but with all methods that estimate complex population histories. Each panel in the figure is a bivariate scatterplot comparing two parameters. Each point indicates the estimated values of the two parameters in one simulation replicate. In several panels, the points fall along straight lines, indicating that the parameters are tightly correlated. These associations represent ridges in the composite likelihood surface and imply that our statistical problem has fewer dimensions than parameters. This does not lead to incorrect inferences, but it does broaden the confidence intervals of the parameters involved.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Associations between pairs of parameter estimates in 50 data sets simulated with msprime [<xref ref-type="bibr" rid="CR21">21</xref>] under the model in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Key: <italic>m</italic><sub><italic>N</italic></sub>, fraction of admixture from <italic>N</italic> into <italic>Y</italic>; <italic>m</italic><sub><italic>D</italic></sub>, fraction of admixture from <italic>D</italic> into <italic>Y</italic>; <italic>T</italic><sub><italic>XY</italic></sub>, separation time of <italic>X</italic> and <italic>Y</italic>; <italic>T</italic><sub><italic>ND</italic></sub> separation time of <italic>N</italic> and <italic>D</italic>, <italic>T</italic><sub><italic>A</italic></sub>, age of fossil genome from population <italic>N</italic>; <italic>T</italic><sub><italic>D</italic></sub>, age of fossil from <italic>D</italic>; <italic>N</italic><sub><italic>XYND</italic></sub>, size of ancestral population; <italic>N</italic><sub><italic>XY</italic></sub>, size of population ancestral to <italic>X</italic> and <italic>Y</italic>; <italic>N</italic><sub><italic>ND</italic></sub>, size of population ancestral to <italic>N</italic> and <italic>D</italic>; <italic>N</italic><sub><italic>N</italic></sub>, size of population <italic>N</italic>; <italic>N</italic><sub><italic>D</italic></sub>, size of population <italic>N</italic>. The separation time, <italic>T</italic><sub><italic>XYND</italic></sub>, of <italic>XY</italic> and <italic>ND</italic> was fixed exogeneously to calibrate the molecular clock</p></caption><graphic xlink:href="12859_2019_3154_Fig3_HTML" id="MO3"/></fig>
</p>
      <p>These problems can be ameliorated by reducing the dimension of the parameter space. The Legofit package includes pclgo, a program that calculates principal components from the bootstrap replicates and then uses these to re-express the free variables in terms of principal components. Predictive error (as measured by bepe) can be improved by excluding principal components with small eigenvalues. This usually tightens confidence intervals.</p>
      <p>By default, pclgo merely re-expresses the free variables in terms of the principal components, and there is no reduction in dimension. To reduce dimensionality, the user must specify a tolerance criterion. The command pclgo –tol 0.001 would include only those components that explain at least a fraction 0.001 of the variance. Different choices of this tolerance criterion constitute different models, and we can choose among them using bepe or clic, together with booma.</p>
    </sec>
  </sec>
  <sec id="Sec13" sec-type="results">
    <title>Results</title>
    <p>Rogers and Bohlender [<xref ref-type="bibr" rid="CR10">10</xref>] document pronounced biases in the statistics that underlie our current understanding of archaic admixture. These biases are profound if there are multiple sources of admixture. To check for such bias in legofit, I simulate data under the model in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, which allows gene flow into Eurasia (<italic>Y</italic>) not only from Neanderthals (<italic>N</italic>), but also from Denisovans (<italic>D</italic>). Details of this model and of all the analyses below can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. Here, I summarize results.</p>
    <p>Figure <xref rid="Fig4" ref-type="fig">4</xref> shows the true parameter values (red crosses) and sampling distributions (blue circles) estimated using legofit from 50 independent simulation replicates. I used pclgo to reduce dimensionality. This involves excluding dimensions that explain less than some arbitrarily-chosen fraction of the variance. I considered three models: one in terms of the original variables (without using pclgo), one using principal components with no reduction of dimension, and one excluding components that explain less than a fraction 0.001 of the variance. The weights of these three models are 0, 0.42, and 0.58 using bepe and 0, 0.12, and 0.88 using clic. Thus, pclgo seems to improve estimates, especially when some principal components are excluded. Figure <xref rid="Fig4" ref-type="fig">4</xref> shows the bepe version of the model-averaged estimates.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Sampling distributions of legofit estimates based on the 50 simulated data sets shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Red crosses represent true parameter values. Points have been vertically jittered to reduce overplotting in this figure and in those that follow</p></caption><graphic xlink:href="12859_2019_3154_Fig4_HTML" id="MO4"/></fig>
</p>
    <p>All of the sampling distributions enclose the true parameter values, and several are reassuringly narrow. Nonetheless, some bias is evident in the distributions of Neanderthal admixture (<italic>m</italic><sub><italic>N</italic></sub>) and Denisovan admixture (<italic>m</italic><sub><italic>D</italic></sub>). The mean estimates of these parameters are closer together than are the true parameter values. This is because Neanderthals and Denisovans are sister populations, and it is hard to tell them apart. We get a better estimate of total archaic admixture, <italic>m</italic><sub><italic>N</italic></sub>+<italic>m</italic><sub><italic>D</italic></sub>, than of the difference, <italic>m</italic><sub><italic>N</italic></sub>−<italic>m</italic><sub><italic>D</italic></sub>.</p>
    <p>For comparison with legofit’s estimates of the admixture fraction, Fig. <xref rid="Fig5" ref-type="fig">5</xref> shows the behavior of three previously-published estimators [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>] that have been used to study archaic admixture in humans. Nea and den work by comparing the frequencies with which derived alleles are shared by pairs of samples from different populations. Nea has also been called <italic>R</italic><sub>Neandertal</sub> [<xref ref-type="bibr" rid="CR2">2</xref>]. Rogers and Bohlender [<xref ref-type="bibr" rid="CR10">10</xref>] show that these estimators have large biases, especially when (as in the present model) a population receives gene flow from more than one source. Thus, it is no surprise that nea and den exhibit large biases in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Indeed, the black triangles show that the observed bias is in good agreement with theoretical expectations.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Bias in three previously-published estimators of archaic admixture. Nea and den ([<xref ref-type="bibr" rid="CR3">3</xref>], supp. note 11) estimate Neanderthal and Denisovan admixture. TreeMix [<xref ref-type="bibr" rid="CR34">34</xref>] estimates Neanderthal admixture. Key: blue circles, estimates from simulated data shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>; red crosses, true parameter values; black triangles, expected values of statistics</p></caption><graphic xlink:href="12859_2019_3154_Fig5_HTML" id="MO5"/></fig>
</p>
    <p>Many studies have cited an estimate that about 6% of Papuan DNA derives from Denisovans. This result is due to Meyer et al. [<xref ref-type="bibr" rid="CR3">3</xref>], who inferred it using TreeMix [<xref ref-type="bibr" rid="CR34">34</xref>]. However, these authors suspected that the result was biased, because their analysis excluded Neanderthals ([<xref ref-type="bibr" rid="CR3">3</xref>], supp. note 12). The TreeMix results in Fig. <xref rid="Fig5" ref-type="fig">5</xref> should avoid this problem, because Neanderthals are included along with Denisovans and moderns from Africa and Eurasia. TreeMix was able to detect a signal of gene flow from Neanderthals into Eurasians. As the figure shows, however, its estimate of the admixture fraction was profoundly biased. TreeMix was unable to detect gene flow from Denisovans into Eurasians. This episode of gene flow did not appear in the output from any of the simulation replicates. Instead, TreeMix reported evididence of gene flow in various parts of the tree. These episodes of gene flow were not consistent from replicate to replicate and did not exist in the simulation model.</p>
    <sec id="Sec14">
      <title>A worked example</title>
      <p>In Fig. <xref rid="Fig4" ref-type="fig">4</xref>, we had the advantage of working with the true model of history. This is never the case with real data. Let us therefore consider how the analysis might proceed if we did not know the true model in advance. We would start by examining site pattern frequencies, which are shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. The most common patterns (apart from singletons) are <italic>xy</italic> and <italic>nd</italic>, reflecting the shared ancestry of populations <italic>X</italic> and <italic>Y</italic> and of <italic>N</italic> and <italic>D</italic>. Let us therefore fit a model with a tree of form ((<italic>X</italic>,<italic>Y</italic>),(<italic>N</italic>,<italic>D</italic>)). This model is misspecified, because it omits gene flow. The residuals of this model are shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref> along with those of a correctly-specified model. The misspecified model generates many residuals that are far from zero, and these discrepancies provide clues about what is wrong with the model. For example, note that the misspecified model has positive residuals for <italic>yn</italic> and <italic>ynd</italic> but a negative residual for <italic>y</italic>. This suggests that we should add <italic>N</italic>→<italic>Y</italic> gene flow to the model, because such gene flow inflates the first two of these site patterns but deflates the third.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Site pattern frequences simulated using msprime [<xref ref-type="bibr" rid="CR21">21</xref>] under the model in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Data are as in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Blue circles show 50 replicate simulations, and red crosses show expected values</p></caption><graphic xlink:href="12859_2019_3154_Fig6_HTML" id="MO6"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><p>Residuals from misspecified and correctly-specified models. Each circle represents one of the simulated data sets in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The misspecified model ignores the two episodes of gene flow seen in Fig. <xref rid="Fig1" ref-type="fig">1</xref></p></caption><graphic xlink:href="12859_2019_3154_Fig7_HTML" id="MO7"/></fig>
</p>
      <p>Table <xref rid="Tab1" ref-type="table">1</xref> compares the two models and shows that the one with <italic>N</italic>→<italic>Y</italic> gene flow is unambiguously better than the one without gene flow. However, the residuals of this new model (not shown) still show discrepancies, which might lead us to consider adding <italic>D</italic>→<italic>Y</italic> gene flow to the model. Table <xref rid="Tab2" ref-type="table">2</xref> shows that this third model is unambiguously better than the one with only one episode of gene flow. The residuals (right panel of Fig. <xref rid="Fig7" ref-type="fig">7</xref>) show that this model provides a good description of the data. In this example, the correct model was identifiable because the alternate models could not fully account for the pattern in the data.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Booma weights for models with and without <italic>N</italic>→<italic>Y</italic> gene flow</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2">Weights</th><th align="left"/></tr><tr><th align="left">bepe</th><th align="left">clic</th><th align="left">Model</th></tr></thead><tbody><tr><td align="left">0</td><td align="left">0</td><td align="left">No gene flow; full dimension</td></tr><tr><td align="left">0</td><td align="left">0</td><td align="left">No gene flow; reduced dimension</td></tr><tr><td align="left">0.04</td><td align="left">0.5</td><td align="left"><italic>N</italic>→<italic>Y</italic> gene flow; full dimension</td></tr><tr><td align="left">0.96</td><td align="left">0.5</td><td align="left"><italic>N</italic>→<italic>Y</italic> gene flow; reduced dimension</td></tr></tbody></table><table-wrap-foot><p>All models re-express free variables in terms of principal components. Models with reduced dimension exclude principal components that explain less than a fraction 0.001 of the variance</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Booma weights for models with and without <italic>D</italic>→<italic>Y</italic> gene flow</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2">Weights</th><th align="left"/></tr><tr><th align="left">bepe</th><th align="left">clic</th><th align="left">Model</th></tr></thead><tbody><tr><td align="left">0</td><td align="left">0</td><td align="left">No <italic>D</italic>→<italic>Y</italic> gene flow; full dimension</td></tr><tr><td align="left">0</td><td align="left">0</td><td align="left">No <italic>D</italic>→<italic>Y</italic> gene flow; reduced dimension</td></tr><tr><td align="left">0.42</td><td align="left">0.12</td><td align="left"><italic>D</italic>→<italic>Y</italic> gene flow; full dimension</td></tr><tr><td align="left">0.58</td><td align="left">0.88</td><td align="left"><italic>D</italic>→<italic>Y</italic> gene flow; reduced dimension</td></tr></tbody></table><table-wrap-foot><p>All models include <italic>N</italic>→<italic>Y</italic> gene flow and re-express free variables in terms of principal components. Models with reduced dimension exclude principal components that explain less than a fraction 0.001 of the variance</p></table-wrap-foot></table-wrap>
</p>
      <p>There are also less tractable identifiability problems. Let us consider two. Figure <xref rid="Fig8" ref-type="fig">8</xref> shows a model that is like that in the simulations (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) but has an additional episode of gene flow from a “superarchaic” population (<italic>S</italic>) into Denisovans (<italic>D</italic>), as suggested by Prüfer et al [<xref ref-type="bibr" rid="CR8">8</xref>]. When the superarchaic admixture fraction is zero, this model reduces to that used in our simulations. As expected, legofit’s estimate of this parameter was very close to zero in all simulation replicates, and all other parameters were also well estimated. Consequently, this model provides an excellent fit to the data, comparable to that in the right panel of Fig. <xref rid="Fig7" ref-type="fig">7</xref>. Nonetheless, I expected bepe and clic to prefer the correct model because of its simplicity. Instead, bepe and clic gave appreciable weight to both models but preferred the more complex one, as shown in Table <xref rid="Tab3" ref-type="table">3</xref>. This did not lead to incorrect inferences, because all parameters were well estimated.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Admixture from a superarchaic population (<italic>S</italic>) into Denisovans (<italic>D</italic>)</p></caption><graphic xlink:href="12859_2019_3154_Fig8_HTML" id="MO8"/></fig><table-wrap id="Tab3"><label>Table 3</label><caption><p>Booma weights for models with and without superarchaic admixture</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2">Weights</th><th align="left"/></tr><tr><th align="left">bepe</th><th align="left">clic</th><th align="left">Model</th></tr></thead><tbody><tr><td align="left">0.24</td><td align="left">0.04</td><td align="left">No superarchaic admixture; full dimension</td></tr><tr><td align="left">0.02</td><td align="left">0.16</td><td align="left">No superarchaic admixture; reduced dimension</td></tr><tr><td align="left">0</td><td align="left">0</td><td align="left">Superarchaic admixture; full dimension</td></tr><tr><td align="left">0.74</td><td align="left">0.80</td><td align="left">Superarchaic admixture; reduced dimension</td></tr></tbody></table><table-wrap-foot><p>All models include <italic>N</italic>→<italic>Y</italic> and <italic>D</italic>→<italic>Y</italic> gene flow and re-express free variables in terms of principal components. Models with reduced dimension exclude principal components that explain less than a fraction 0.001 of the variance</p></table-wrap-foot></table-wrap>
</p>
      <p>Table <xref rid="Tab4" ref-type="table">4</xref> illustrates another identifiability problem. It compares the standard model (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) with one in which the order of the two admixture events is reversed: <italic>D</italic>→<italic>Y</italic> admixture precedes <italic>N</italic>→<italic>Y</italic> admixture. This change has little effect on site pattern frequencies, and all parameters are well estimated. I expected bepe and clic to weight these models roughly equally. The table shows that they do give appreciable weight to both models but prefer the (incorrect) reversed model. In another experiment (not shown), using ms instead of msprime, bepe gave 94% of the weight to the true model. Bepe and clic both behave sensibly when dealing with models that are indistinguishable or nearly so. In such cases, they tend to give appreciable weight to several models. We cannot assume, however, that they will always prefer the correct model.
<table-wrap id="Tab4"><label>Table 4</label><caption><p>Booma weights for models with and without reversing the order of the two admixture events in Fig. <xref rid="Fig1" ref-type="fig">1</xref></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2">Weights</th><th align="left"/></tr><tr><th align="left">bepe</th><th align="left">clic</th><th align="left">Model</th></tr></thead><tbody><tr><td align="left">0.18</td><td align="left">0.02</td><td align="left">True model; full dimension</td></tr><tr><td align="left">0</td><td align="left">0.22</td><td align="left">True model; reduced dimension</td></tr><tr><td align="left">0</td><td align="left">0.02</td><td align="left">Reversed model; full dimension</td></tr><tr><td align="left">0.82</td><td align="left">0.74</td><td align="left">Reversed model; reduced dimension</td></tr></tbody></table><table-wrap-foot><p>All models include <italic>N</italic>→<italic>Y</italic> and <italic>D</italic>→<italic>Y</italic> gene flow and re-express free variables in terms of principal components. Models with reduced dimension exclude principal components that explain less than a fraction 0.001 of the variance</p></table-wrap-foot></table-wrap>
</p>
    </sec>
  </sec>
  <sec id="Sec15" sec-type="discussion">
    <title>Discussion</title>
    <p>There are two reasons for studying site patterns rather than the full site frequency spectrum, the first of which involves statistical power at deep time scales. As we look backwards into the past, large samples coalesce rapidly to small collections of ancestors. For this reason, although large samples are essential for recent history, their value is limited in the distant past. Furthermore, the random-haploid samples used by legofit provide an advantage: they insulate the analysis from recent population history. If we had sampled several haploid genomes from population <italic>X</italic> in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, then our model would need parameters describing changes in the size of <italic>X</italic> since its separation from <italic>Y</italic>. With legofit, these parameters aren’t needed, because no coalescent events can occur until <italic>X</italic> and <italic>Y</italic> merge into their ancestral population. Thus, site pattern frequencies reduce the parameter count without losing much power at deep time scales. They allow us to study the deep history of multiple populations.</p>
  </sec>
  <sec id="Sec16" sec-type="conclusion">
    <title>Conclusions</title>
    <p>The Legofit package provides computer programs for estimating population histories. It uses the frequencies of nucleotide site patterns to summarize genetic data. The package includes programs that tabulate these frequencies, calculate their expected values, and use them to estimate parameters describing population history. It includes facilities for model selection and model averaging. It uses principal components to reduce the complexity of high-dimensional models of history. Legofit outperforms several methods that have been widely used to study archaic admixture in humans and should be useful in any species for which DNA sequence data is available from several populations.</p>
  </sec>
  <sec id="Sec17">
    <title>Availability and requirements</title>
    <p><italic>Project name</italic> Legofit<italic>Project home page</italic><ext-link ext-link-type="uri" xlink:href="https://github.com/alanrogers/legofit">https://github.com/alanrogers/legofit</ext-link><italic>Operating system</italic> Linux and macOS<italic>Programming language</italic> C and Python<italic>Requirements</italic> pthreads and the Gnu Scientific Library<italic>License</italic> Internet Systems Consortium License<italic>Any restrictions to use by non-academics</italic> none</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3154_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Supplementary methods and results</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AIC</term>
        <def>
          <p>Akieke’s information criterion</p>
        </def>
      </def-item>
      <def-item>
        <term>bepe</term>
        <def>
          <p>Bootstrap estimate of predictive error</p>
        </def>
      </def-item>
      <def-item>
        <term>BIC</term>
        <def>
          <p>Bayesian information criterion booma: Bootstrap model averaging</p>
        </def>
      </def-item>
      <def-item>
        <term>clic</term>
        <def>
          <p>Composite likelihood information criterion</p>
        </def>
      </def-item>
      <def-item>
        <term>DE</term>
        <def>
          <p>Differential evolution</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p>We use lower case “legofit” to refer to the estimation program within the (capitalized) “Legofit” package.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3154-1.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>I am grateful to Alan Achenbach, Kiela Gwin, Nathan Harris, Annie-Louise Holbrook, Mitchell Lokey, and Daniel Tabin, who have all used the software and provided feedback. Daniel Tabin helped write several programs within the package. Elizabeth Cashdan, Ilan Gronau, Timothy Webster provided useful comments on the text.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>Not applicable, because there is only one author. The author read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by NSF award BCS 1638840 and by the Center for High Performance Computing at the University of Utah.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The Legofit package is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/alanrogers/legofit">https://github.com/alanrogers/legofit</ext-link>. The pipelines and intermediate data files used in the analysis reported here are freely available at the Open Science Framework, <ext-link ext-link-type="uri" xlink:href="https://osf.io/j38eg">https://osf.io/j38eg</ext-link>.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable, because all the data studied here were generated by computer simulation.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable, because this article includes no details, images, or videos relating to an individual person.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The author declares that he has no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Green</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Krause</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Briggs</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Maricic</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stenzel</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Kircher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhai</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Fritz</surname>
            <given-names>M. H. -Y.</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>EY</given-names>
          </name>
          <name>
            <surname>Malaspinas</surname>
            <given-names>A. -S.</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Marques-Bonet</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Alkan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Prüfer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Burbano</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Good</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Aximu-Petri</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Butthof</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Höber</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Höffner</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Siegemund</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weihmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Russ</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Novod</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Affourtit</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Egholm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Verna</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rudan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brajkovic</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kucan</surname>
            <given-names>v.</given-names>
          </name>
          <name>
            <surname>Gušic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Doronichev</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>Golovanova</surname>
            <given-names>LV</given-names>
          </name>
          <name>
            <surname>Lalueza-Fox</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>de la Rasilla</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fortea</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rosas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schmitz</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>PLF</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Falush</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mullikin</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Slatkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kelso</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lachmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pääbo</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A draft sequence of the Neandertal genome</article-title>
        <source>Science</source>
        <year>2010</year>
        <volume>328</volume>
        <issue>5979</issue>
        <fpage>710</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1188021</pub-id>
        <?supplied-pmid 20448178?>
        <pub-id pub-id-type="pmid">20448178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Kircher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Krause</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>EY</given-names>
          </name>
          <name>
            <surname>Viola</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Briggs</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Stenzel</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>PLF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic history of an archaic hominin group from Denisova Cave in Siberia</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>468</volume>
        <issue>7327</issue>
        <fpage>1053</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09710</pub-id>
        <?supplied-pmid 21179161?>
        <pub-id pub-id-type="pmid">21179161</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kircher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gansauge</surname>
            <given-names>M. -T.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Racimo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schraiber</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Jay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Prüfer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>de Filippo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sudmant</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Alkan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Do</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rohland</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tandon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Siebauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Bryc</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Briggs</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Stenzel</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Dabney</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kitzman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hammer</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Shunkov</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Derevianko</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>AndrÃⒸs</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Slatkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kelso</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pääbo</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A high-coverage genome sequence from an archaic Denisovan individual</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>338</volume>
        <issue>6104</issue>
        <fpage>222</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1224344</pub-id>
        <?supplied-pmid 22936568?>
        <pub-id pub-id-type="pmid">22936568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bollongino</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nehlich</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Richards</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Orschiedt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Sell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fajkošová</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Powell</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Burger</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>2000 years of parallel societies in Stone Age central Europe</article-title>
        <source>Science</source>
        <year>2013</year>
        <volume>342</volume>
        <fpage>479</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1245049</pub-id>
        <?supplied-pmid 24114781?>
        <pub-id pub-id-type="pmid">24114781</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skoglund</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Malmström</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Raghavan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Storå</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Willerslev</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>MTP</given-names>
          </name>
          <name>
            <surname>Götherström</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jakobsson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Origins and genetic legacy of Neolithic farmers and hunter-gatherers in Europe</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>336</volume>
        <issue>6080</issue>
        <fpage>466</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1216304</pub-id>
        <?supplied-pmid 22539720?>
        <pub-id pub-id-type="pmid">22539720</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lipson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Szécsényi-Nagy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pósa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stégmár</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Keerl</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Rohland</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stewardson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ferry</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Oppenheimer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Broomandkhoshbacht</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Harney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nordenfelt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Llamas</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gusztáv Mende</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Köhler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Oross</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bondár</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marton</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Osztás</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jakucs</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Paluch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Horváth</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Csengeri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Koós</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sebők</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Raczky</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Regenye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barna</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Fábián</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Serlegi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Toldi</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gyöngyvér Nagy</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dani</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Molnár</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pálfi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Márk</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Melegh</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bánfai</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Domboróczki</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fernández-Eraso</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Antonio Mujika-Alustiza</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alonso Fernández</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jiménez Echevarría</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bollongino</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Orschiedt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schierhold</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Meller</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Burger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bánffy</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Alt</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Lalueza-Fox</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Haak</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Parallel palaeogenomic transects reveal complex genetic history of early European farmers</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>551</volume>
        <issue>7680</issue>
        <fpage>368</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1038/nature24476</pub-id>
        <?supplied-pmid 29144465?>
        <pub-id pub-id-type="pmid">29144465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haak</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lazaridis</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rohland</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Llamas</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Brandt</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Nordenfelt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Harney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stewardson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Mittnik</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bánffy</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Economou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Francken</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Friederich</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pena</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Hallgren</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Khartanovich</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Khokhlov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kunst</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kuznetsov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Meller</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mochalov</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Moiseyev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Nicklisch</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pichler</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Risch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rojo Guerra</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Szécsényi-Nagy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wahl</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Krause</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Anthony</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Alt</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Massive migration from the steppe is a source for Indo-European languages in Europe</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>522</volume>
        <issue>7555</issue>
        <fpage>207</fpage>
        <pub-id pub-id-type="doi">10.1038/nature14317</pub-id>
        <?supplied-pmid 25731166?>
        <pub-id pub-id-type="pmid">25731166</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prüfer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Racimo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jay</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sankararaman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sawyer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Heinze</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Renaud</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sudmant</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>de Filippo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dannemann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Kircher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kuhlwilm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lachmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ongyerth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Siebauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Theunert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tandon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Moorjani</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pickrell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mullikin</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Vohr</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Hellmann</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>PLF</given-names>
          </name>
          <name>
            <surname>Blanche</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kitzman</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Lein</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Bakken</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Golovanova</surname>
            <given-names>LV</given-names>
          </name>
          <name>
            <surname>Doronichev</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>Shunkov</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Derevianko</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Viola</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Slatkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kelso</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pääbo</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The complete genome sequence of a Neanderthal from the Altai Mountains</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>505</volume>
        <issue>7481</issue>
        <fpage>43</fpage>
        <lpage>49</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12886</pub-id>
        <?supplied-pmid 24352235?>
        <pub-id pub-id-type="pmid">24352235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mendez</surname>
            <given-names>FL</given-names>
          </name>
          <name>
            <surname>Watkins</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Hammer</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>Global genetic variation at OAS1 provides evidence of archaic admixture in Melanesian populations</article-title>
        <source>Mol Biol Evol</source>
        <year>2012</year>
        <volume>29</volume>
        <issue>6</issue>
        <fpage>1513</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msr301</pub-id>
        <?supplied-pmid 22319157?>
        <pub-id pub-id-type="pmid">22319157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rogers</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Bohlender</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>Bias in estimators of archaic admixture</article-title>
        <source>Theor Popul Biol</source>
        <year>2015</year>
        <volume>100</volume>
        <fpage>63</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tpb.2014.12.006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petr</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pääbo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kelso</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vernot</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Limits of long-term selection against Neandertal introgression</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2019</year>
        <volume>116</volume>
        <issue>5</issue>
        <fpage>1639</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1814338116</pub-id>
        <?supplied-pmid 30647110?>
        <pub-id pub-id-type="pmid">30647110</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rogers</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Bohlender</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Huff</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>Early history of Neanderthals and Denisovans</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2017</year>
        <volume>114</volume>
        <issue>37</issue>
        <fpage>9859</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1706426114</pub-id>
        <?supplied-pmid 28784789?>
        <pub-id pub-id-type="pmid">28784789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rogers</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Bohlender</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Huff</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>Reply to Mafessoni and Prüfer: Inferences with and without singleton site patterns</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2017</year>
        <volume>114</volume>
        <issue>48</issue>
        <fpage>10258</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1717085114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Molecular phylogenetics: Principles and practice</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>5</issue>
        <fpage>303</fpage>
        <pub-id pub-id-type="doi">10.1038/nrg3186</pub-id>
        <?supplied-pmid 22456349?>
        <pub-id pub-id-type="pmid">22456349</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eaton</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Hipp</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>González-Rodríguez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cavender-Bares</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Historical introgression among the American live oaks and the comparative nature of tests for introgression</article-title>
        <source>Evolution</source>
        <year>2015</year>
        <volume>69</volume>
        <issue>10</issue>
        <fpage>2587</fpage>
        <lpage>601</lpage>
        <pub-id pub-id-type="doi">10.1111/evo.12758</pub-id>
        <?supplied-pmid 26299374?>
        <pub-id pub-id-type="pmid">26299374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hudson</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>A new proof of the expected frequency spectrum under the standard neutral model</article-title>
        <source>PLO1</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>0118087</fpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimura</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The number of heterozygous nucleotide sites maintained in a finite population due to steady flux of mutation</article-title>
        <source>Genetics</source>
        <year>1969</year>
        <volume>61</volume>
        <fpage>893</fpage>
        <lpage>903</lpage>
        <?supplied-pmid 5364968?>
        <pub-id pub-id-type="pmid">5364968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>EY</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Slatkin</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Testing for ancient admixture between closely related populations</article-title>
        <source>Mol Biol Evol</source>
        <year>2011</year>
        <volume>28</volume>
        <issue>8</issue>
        <fpage>2239</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msr048</pub-id>
        <?supplied-pmid 21325092?>
        <pub-id pub-id-type="pmid">21325092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <mixed-citation publication-type="other">Rogers AR, Harris NS, Achenbach AA. Neanderthal-Denisovan ancestors interbred with a distantly-related hominin. bioRxiv. 2019; 657247. 10.1101/657247.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hudson</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Generating samples under a Wright-Fisher neutral model of genetic variation</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>337</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.2.337</pub-id>
        <?supplied-pmid 11847089?>
        <pub-id pub-id-type="pmid">11847089</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelleher</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Etheridge</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Efficient coalescent simulation and genealogical analysis for large sample sizes</article-title>
        <source>PLoS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Staab</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Metzler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lunter</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Scrm: Efficiently simulating long sequences using the approximated coalescent with recombination</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>10</issue>
        <fpage>1680</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu861</pub-id>
        <?supplied-pmid 25596205?>
        <pub-id pub-id-type="pmid">25596205</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Storn</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Lampinen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <source>Differential Evolution: A Practical Approach to Global Optimization</source>
        <year>2006</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <source>An Introduction to the Bootstrap</source>
        <year>1993</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Chapman and Hall</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>RY</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>LePage</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Billard</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Moving blocks jacknife and bootstrap capture weak dependence</article-title>
        <source>Exploring the “Limits” of the Bootstrap</source>
        <year>1992</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hawkins</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>The problem of overfitting</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2004</year>
        <volume>44</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1021/ci0342472</pub-id>
        <?supplied-pmid 14741005?>
        <pub-id pub-id-type="pmid">14741005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akaike</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A new look at the statistical model identification</article-title>
        <source>IEEE Trans Autom Control</source>
        <year>1974</year>
        <volume>19</volume>
        <issue>6</issue>
        <fpage>716</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1109/TAC.1974.1100705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>GE</given-names>
          </name>
        </person-group>
        <article-title>Estimating the dimension of a model</article-title>
        <source>Ann Stat</source>
        <year>1978</year>
        <volume>41</volume>
        <issue>2</issue>
        <fpage>461</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176344136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Estimating the error rate of a prediction rule: Improvement on cross-validation</article-title>
        <source>J Am Stat Assoc</source>
        <year>1983</year>
        <volume>78</volume>
        <issue>382</issue>
        <fpage>316</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1983.10477973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Varin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vidoni</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A note on composite likelihood inference and model selection</article-title>
        <source>Biometrika</source>
        <year>2005</year>
        <volume>92</volume>
        <issue>3</issue>
        <fpage>519</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/92.3.519</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hinkley</surname>
            <given-names>DV</given-names>
          </name>
        </person-group>
        <article-title>Assessing the accuracy of the maximum likelihood estimator: Observed versus expected Fisher information</article-title>
        <source>Biometrika</source>
        <year>1978</year>
        <volume>65</volume>
        <issue>3</issue>
        <fpage>457</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/65.3.457</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckland</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Burnham</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Augustin</surname>
            <given-names>NH</given-names>
          </name>
        </person-group>
        <article-title>Model selection: an integral part of inference</article-title>
        <source>Biometrics</source>
        <year>1997</year>
        <volume>53</volume>
        <issue>2</issue>
        <fpage>603</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.2307/2533961</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Claeskens</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hjort</surname>
            <given-names>NL</given-names>
          </name>
        </person-group>
        <source>Model Selection and Model Averaging</source>
        <year>2008</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pickrell</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Barbieri</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Berthold</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gerlach</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Güldemann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kure</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mpoloka</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Nakagawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Naumann</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lipson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Loh</surname>
            <given-names>P-R</given-names>
          </name>
          <name>
            <surname>Lachance</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mountain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bustamante</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tishkoff</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Henn</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Stoneking</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pakendorf</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>The genetic prehistory of southern Africa</article-title>
        <source>Nat Commun</source>
        <year>2012</year>
        <volume>3</volume>
        <fpage>1143</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms2140</pub-id>
        <?supplied-pmid 23072811?>
        <pub-id pub-id-type="pmid">23072811</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
