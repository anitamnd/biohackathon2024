<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4720362</article-id>
    <article-id pub-id-type="pmid">26789998</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0147097</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-15-29368</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Macromolecular structure analysis</subject>
            <subj-group>
              <subject>RNA structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>RNA structure</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Macromolecular structure analysis</subject>
            <subj-group>
              <subject>RNA structure</subject>
              <subj-group>
                <subject>RNA alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>RNA structure</subject>
                <subj-group>
                  <subject>RNA alignment</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Sequence Analysis</subject>
                <subj-group>
                  <subject>Sequence Alignment</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Macromolecular structure analysis</subject>
            <subj-group>
              <subject>RNA structure</subject>
              <subj-group>
                <subject>RNA folding</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>RNA structure</subject>
                <subj-group>
                  <subject>RNA folding</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Chemical Compounds</subject>
            <subj-group>
              <subject>Organic Compounds</subject>
              <subj-group>
                <subject>Purines</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Organic Chemistry</subject>
            <subj-group>
              <subject>Organic Compounds</subject>
              <subj-group>
                <subject>Purines</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Non-coding RNA</subject>
                <subj-group>
                  <subject>Transfer RNA</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Sequence Analysis</subject>
                <subj-group>
                  <subject>Sequence Motif Analysis</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Motif Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Comparison</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Comparison</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CHSalign: A Web Server That Builds upon Junction-Explorer and RNAJAG for Pairwise Alignment of RNA Secondary Structures with Coaxial Helical Stacking</article-title>
      <alt-title alt-title-type="running-head">CHSalign Web Server</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Hua</surname>
          <given-names>Lei</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Song</surname>
          <given-names>Yang</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Namhee</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Laing</surname>
          <given-names>Christian</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Jason T. L.</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schlick</surname>
          <given-names>Tamar</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Bioinformatics Laboratory, Department of Computer Science, New Jersey Institute of Technology, Newark, New Jersey, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Chemistry, New York University, New York, New York, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Courant Institute of Mathematical Sciences, New York University, New York, New York, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Paci</surname>
          <given-names>Emanuele</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Leeds, UNITED KINGDOM</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con" id="contrib001">
        <p>Conceived and designed the experiments: TS JW. Performed the experiments: LH YS NK. Analyzed the data: CL NK. Contributed reagents/materials/analysis tools: LH YS CL. Wrote the paper: LH YS NK CL JW TS.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>wangj@njit.edu</email> (JW); <email>schlick@nyu.edu</email> (TS)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>11</volume>
    <issue>1</issue>
    <elocation-id>e0147097</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>7</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>12</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2016 Hua et al</copyright-statement>
      <copyright-year>2016</copyright-year>
      <copyright-holder>Hua et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="pone.0147097.pdf"/>
    <abstract>
      <p>RNA junctions are important structural elements of RNA molecules. They are formed when three or more helices come together in three-dimensional space. Recent studies have focused on the annotation and prediction of coaxial helical stacking (CHS) motifs within junctions. Here we exploit such predictions to develop an efficient alignment tool to handle RNA secondary structures with CHS motifs. Specifically, we build upon our Junction-Explorer software for predicting coaxial stacking and RNAJAG for modelling junction topologies as tree graphs to incorporate constrained tree matching and dynamic programming algorithms into a new method, called CHSalign, for aligning the secondary structures of RNA molecules containing CHS motifs. Thus, CHSalign is intended to be an efficient alignment tool for RNAs containing similar junctions. Experimental results based on thousands of alignments demonstrate that CHSalign can align two RNA secondary structures containing CHS motifs more accurately than other RNA secondary structure alignment tools. CHSalign yields a high score when aligning two RNA secondary structures with similar CHS motifs or helical arrangement patterns, and a low score otherwise. This new method has been implemented in a web server, and the program is also made freely available, at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.njit.edu/CHSalign/">http://bioinformatics.njit.edu/CHSalign/</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by National Science Foundation [grant IIS-0707571 to J.W.], and National Institute of General Medical Sciences [grants GM100469 and GM081410 to T.S.]. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="3"/>
      <page-count count="22"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the paper and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>RNA secondary structures are composed of double-stranded segments such as helices connected to single-stranded regions such as junctions and hairpin loops. These structural elements serve as building blocks in the design of diverse RNA molecules with various functions in the cell [<xref rid="pone.0147097.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0147097.ref003" ref-type="bibr">3</xref>]. In particular, RNA junctions are important structural elements due to their ability to orient many parts of the RNA molecule [<xref rid="pone.0147097.ref004" ref-type="bibr">4</xref>].</p>
    <p>An RNA junction, also known as a multi-branch loop, forms when more than two helical segments are brought together [<xref rid="pone.0147097.ref005" ref-type="bibr">5</xref>–<xref rid="pone.0147097.ref010" ref-type="bibr">10</xref>]. RNA junctions exist in numerous RNA molecules; they play important roles in a wide variety of biochemical activities such as self-cleavage of the hammerhead ribozyme [<xref rid="pone.0147097.ref011" ref-type="bibr">11</xref>], the recognition of the binding pocket domain by purine riboswitches [<xref rid="pone.0147097.ref012" ref-type="bibr">12</xref>] and the translation initiation of the hepatitis C virus at the internal ribosome entry site [<xref rid="pone.0147097.ref013" ref-type="bibr">13</xref>]. Recent studies have classified RNA junctions with three and four branches into three and nine families, respectively [<xref rid="pone.0147097.ref014" ref-type="bibr">14</xref>,<xref rid="pone.0147097.ref015" ref-type="bibr">15</xref>]. Experiments have verified that a three-way junction in <italic>Arabidopsis</italic> has an important functional role [<xref rid="pone.0147097.ref016" ref-type="bibr">16</xref>]. A junction database, called RNAJunction, has been established, which contains junctions of all known degrees of branching [<xref rid="pone.0147097.ref005" ref-type="bibr">5</xref>].</p>
    <p>A common tertiary motif within junctions of an RNA molecule is the coaxial stacking of helices [<xref rid="pone.0147097.ref017" ref-type="bibr">17</xref>–<xref rid="pone.0147097.ref019" ref-type="bibr">19</xref>], which occurs when two separate helical segments are aligned on a common axis to form a pseudocontiguous helix [<xref rid="pone.0147097.ref020" ref-type="bibr">20</xref>]. Coaxial stacking configurations have been observed in all large RNAs for which crystal structures are available, including tRNA, group I and II introns, RNase P, riboswitches and large ribosomal subunits. Coaxial helical stacking (CHS) provides thermodynamic stability to the RNA molecule as a whole [<xref rid="pone.0147097.ref021" ref-type="bibr">21</xref>] and reduces the separation between loop regions within junctions [<xref rid="pone.0147097.ref022" ref-type="bibr">22</xref>]. Moreover, coaxial stacking configurations form cooperatively with long-range interactions in many RNAs [<xref rid="pone.0147097.ref014" ref-type="bibr">14</xref>,<xref rid="pone.0147097.ref017" ref-type="bibr">17</xref>,<xref rid="pone.0147097.ref023" ref-type="bibr">23</xref>], and are therefore crucial as for correct tertiary structure formation as well as the formation of different junction topologies [<xref rid="pone.0147097.ref015" ref-type="bibr">15</xref>,<xref rid="pone.0147097.ref017" ref-type="bibr">17</xref>,<xref rid="pone.0147097.ref024" ref-type="bibr">24</xref>]. Since junctions are major architectural components in RNA, it is important to understand their structural properties. For example, the function of RNA molecules may be inferred if their junction components are similar in structure to other well-studied junction domains.</p>
    <p>In this paper we build upon our previously developed Junction-Explorer tool [<xref rid="pone.0147097.ref025" ref-type="bibr">25</xref>] for predicting coaxial stacking and RNAJAG [<xref rid="pone.0147097.ref004" ref-type="bibr">4</xref>] for modelling junction topologies as tree graphs, and present a method, CHSalign, for aligning two RNA secondary (2D) structures that possess CHS motifs within the junctions of the two RNA structures. Coaxial stacking interactions in junctions are part of tertiary (3D) motifs [<xref rid="pone.0147097.ref024" ref-type="bibr">24</xref>]. Thus, CHSalign differs from both RNA 2D and 3D structure alignment tools. Existing secondary (2D) structure alignment tools focus on sequences and base pairs without considering tertiary motifs. Existing tertiary (3D) structure alignment tools accept as input two RNA 3D structures including all types of tertiary motifs in the Protein Data Bank (PDB) [<xref rid="pone.0147097.ref026" ref-type="bibr">26</xref>] and align the 3D structures by considering their geometric properties, torsion angles, and base pairs.</p>
    <p>For 3D structure alignment, Ferre <italic>et al</italic>. [<xref rid="pone.0147097.ref027" ref-type="bibr">27</xref>] developed a dynamic programming algorithm based on nucleotide, dihedral angle, and base pairing similarities. Capriotti and Marti-Renom [<xref rid="pone.0147097.ref028" ref-type="bibr">28</xref>] developed a program to align two RNA 3D structures based on a unit-vector root-mean-square approach. Chang <italic>et al</italic>. [<xref rid="pone.0147097.ref029" ref-type="bibr">29</xref>] and Wang <italic>et al</italic>. [<xref rid="pone.0147097.ref030" ref-type="bibr">30</xref>] employed a structural alphabet of different nucleotide conformations to align RNA 3D structures. Hoksza and Svozil [<xref rid="pone.0147097.ref031" ref-type="bibr">31</xref>] developed a pairwise comparison method based on 3D similarity of generalized secondary structure units. Sarver <italic>et al</italic>. [<xref rid="pone.0147097.ref032" ref-type="bibr">32</xref>] designed the FR3D tool for finding local and composite recurrent structural motifs in RNA 3D structures. Dror <italic>et al</italic>. [<xref rid="pone.0147097.ref033" ref-type="bibr">33</xref>] described the RNA 3D structure alignment program, ARTS, and its use in the analysis and classification of RNA 3D structures [<xref rid="pone.0147097.ref034" ref-type="bibr">34</xref>]. Rahrig <italic>et al</italic>. [<xref rid="pone.0147097.ref035" ref-type="bibr">35</xref>] presented the R3D Align tool for performing global pairwise alignment of RNA 3D structures using local superpositions. He <italic>et al</italic>. [<xref rid="pone.0147097.ref036" ref-type="bibr">36</xref>] developed the RASS web server for comparing RNA 3D structures using both sequence and 3D structure information.</p>
    <p>On the other hand, a well-adopted strategy for RNA 2D structure alignment is to use a tree transformation technique and perform RNA alignment through tree matching [<xref rid="pone.0147097.ref037" ref-type="bibr">37</xref>–<xref rid="pone.0147097.ref039" ref-type="bibr">39</xref>]. For instance, RNAforester [<xref rid="pone.0147097.ref039" ref-type="bibr">39</xref>] aligns two RNA 2D structures by calculating the edit-distance between tree structures symbolizing RNAs. By utilizing tree models to capture the structural particularities in RNA, RSmatch [<xref rid="pone.0147097.ref037" ref-type="bibr">37</xref>] aligns two RNA 2D structures effectively. Additional methods are described in [<xref rid="pone.0147097.ref038" ref-type="bibr">38</xref>,<xref rid="pone.0147097.ref040" ref-type="bibr">40</xref>].</p>
    <p>In contrast to these methods for aligning two RNAs when their 2D structures are available, another group of closely related methods achieved RNA folding and alignment simultaneously. For instance, FOLDALIGN [<xref rid="pone.0147097.ref041" ref-type="bibr">41</xref>] uses a lightweight energy model and sequence similarity to simultaneously fold and align RNA sequences. Dynalign [<xref rid="pone.0147097.ref042" ref-type="bibr">42</xref>] finds a secondary structure common to two sequences without requiring any sequence identity. DAFS [<xref rid="pone.0147097.ref043" ref-type="bibr">43</xref>] simultaneously aligns and folds RNA sequences based on maximizing the expected accuracy of a predicted common secondary structure of the sequences. Similar techniques are implemented in CentroidAlign [<xref rid="pone.0147097.ref044" ref-type="bibr">44</xref>] and SimulFold [<xref rid="pone.0147097.ref045" ref-type="bibr">45</xref>]. SCARNA [<xref rid="pone.0147097.ref046" ref-type="bibr">46</xref>] employs a method of comparing RNA sequences based on the structural alignment of the fixed-length fragments of the stem candidates in the RNAs.</p>
    <p>While many methods have been developed for RNA structure alignment, as surveyed above, few are tailored to junctions, especially junctions with coaxial stacking interactions. Junctions and coaxial stacking patterns are common in many RNA molecules and, as mentioned above, are involved in a wide range of functions. Furthermore, experimental probing techniques, such as RNA SHAPE chemistry, SAXS, NMR, and fluorescence resonance energy transfer (FRET), often provide sufficient information to determine coaxial stacking configurations [<xref rid="pone.0147097.ref002" ref-type="bibr">2</xref>,<xref rid="pone.0147097.ref047" ref-type="bibr">47</xref>–<xref rid="pone.0147097.ref049" ref-type="bibr">49</xref>]. Thus, a junction-tailored tool capable of comparing RNA structures on the basis of coaxial stacking patterns in their junctions could be particularly valuable. To this end, we present CHSalign, which performs RNA alignment by applying a constrained tree matching algorithm and dynamic programming techniques to ordered labeled trees symbolizing RNA structures with coaxial stacking patterns. Experimental results on different data sets demonstrate the effectiveness of this newly developed tool. The CHSalign web server is freely available at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.njit.edu/CHSalign/">http://bioinformatics.njit.edu/CHSalign/</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and Methods</title>
    <p>CHSalign accepts as input two RNA 2D structures which contain manually annotated coaxial stacking of helices, and produces as output an alignment between the two input structures. When manually annotated coaxial stacking patterns are not available, CHSalign invokes our previously developed Junction-Explorer tool [<xref rid="pone.0147097.ref025" ref-type="bibr">25</xref>] to predict the coaxial stacking configurations of the input structures.</p>
    <p>Our approach is to transform each input RNA 2D structure with coaxial stacking patterns into an ordered labeled tree. Tree graphs are popular models for representing RNA structures [<xref rid="pone.0147097.ref004" ref-type="bibr">4</xref>,<xref rid="pone.0147097.ref023" ref-type="bibr">23</xref>,<xref rid="pone.0147097.ref039" ref-type="bibr">39</xref>,<xref rid="pone.0147097.ref050" ref-type="bibr">50</xref>–<xref rid="pone.0147097.ref052" ref-type="bibr">52</xref>]. We extend RNAJAG [<xref rid="pone.0147097.ref004" ref-type="bibr">4</xref>] to obtain an ordered tree model, in which each tree node represents a secondary structure element such as a helix (stem), junction or hairpin loop. When comparing two tree nodes, we use a dynamic programming algorithm [<xref rid="pone.0147097.ref037" ref-type="bibr">37</xref>,<xref rid="pone.0147097.ref038" ref-type="bibr">38</xref>] to align the 2D structural elements in the tree nodes, obtaining a score between the two nodes. We then use a constrained tree matching algorithm to find an optimal alignment between the two input RNA 2D structures, taking into account their coaxial stacking configurations. Below, we detail our tree model and the constrained tree matching algorithm.</p>
    <sec id="sec003">
      <title>Tree model formalism</title>
      <p>Let <italic>R</italic><sub><italic>seq</italic></sub> be an RNA sequence containing nucleotides or bases A, C, G, U. <italic>R</italic><sub><italic>seq</italic></sub>[<italic>i</italic>] denotes the base at position <italic>i</italic> of <italic>R</italic><sub><italic>seq</italic></sub> ordered from the 5’ to 3’ ends. <italic>R</italic><sub><italic>seq</italic></sub>[<italic>i</italic>, <italic>j</italic>], <italic>i</italic> &lt; <italic>j</italic>, is the subsequence starting at position <italic>i</italic> and ending at position <italic>j</italic>. Let <italic>R</italic> be the 2D structure of <italic>R</italic><sub><italic>seq</italic></sub> with at least one base pair. A helix in <italic>R</italic> is a double-stranded segment composed of contiguous base pairs. A base pair connecting position <italic>i</italic> and position <italic>j</italic> is denoted by (<italic>i</italic>, <italic>j</italic>) and its enclosed subsequence is <italic>R</italic><sub><italic>seq</italic></sub>[<italic>i</italic>, <italic>j</italic>]. If all nucleotides in <italic>R</italic><sub><italic>seq</italic></sub>[<italic>i</italic>, <italic>j</italic>] except <italic>R</italic><sub><italic>seq</italic></sub>[<italic>i</italic>] and <italic>R</italic><sub><italic>seq</italic></sub>[<italic>j</italic>] are unpaired single bases, and (<italic>i</italic>, <italic>j</italic>) is a base pair in <italic>R</italic>, we call <italic>R</italic><sub><italic>seq</italic></sub>[<italic>i</italic>+1, <italic>j</italic>-1] a hairpin loop.</p>
      <p>A junction, or a multi-branch loop, is an enclosed area connecting different helices [<xref rid="pone.0147097.ref007" ref-type="bibr">7</xref>]. An <italic>n</italic>-way junction in <italic>R</italic> has <italic>n</italic> branches. This junction connects <italic>n</italic> helices where there are <italic>n</italic> base pairs (<italic>i</italic><sub>1</sub>, <italic>j</italic><sub>1</sub>)… (<italic>i</italic><sub>n</sub>, <italic>j</italic><sub>n</sub>) (one base pair for each helix), and <italic>n</italic> subsequences participating in the junction. The <italic>n</italic> subsequences are denoted by <italic>R</italic><sub><italic>seq</italic></sub>[<italic>i</italic><sub>1</sub>+1, <italic>i</italic><sub>2</sub>-1], <italic>R</italic><sub><italic>seq</italic></sub>[<italic>j</italic><sub>2</sub>+1, <italic>i</italic><sub>3</sub>-1], <italic>R</italic><sub><italic>seq</italic></sub>[<italic>j</italic><sub><italic>3</italic></sub>+1, <italic>i</italic><sub>4</sub>-1],…, <italic>R</italic><sub><italic>seq</italic></sub>[<italic>j</italic><sub>n-1</sub>+1, <italic>i</italic><sub>n</sub>-1], and <italic>R</italic><sub><italic>seq</italic></sub>[<italic>j</italic><sub>n</sub>+1,<italic>j</italic><sub>1</sub>-1]. All the unpaired bases on the <italic>n</italic> subsequences comprise the <italic>n</italic>-way junction, and the subsequences are called the loop regions of the junction. Internal loops or bulges can be considered as special cases of “two-way” junctions [<xref rid="pone.0147097.ref005" ref-type="bibr">5</xref>]. However, for the purpose of this work, <italic>n</italic> must be greater than 2. Thus, internal loops or bulges are not considered as junctions in our work; instead, they are considered as part of the helices in <italic>R</italic>.</p>
      <p>We transform the 2D structure <italic>R</italic> into an ordered labeled tree <italic>T</italic> in which each node has a label and the left-to-right order among sibling nodes is important. Each node of <italic>T</italic> represents a 2D structural element of <italic>R</italic>, belonging to one of three types: helix, junction, and hairpin loop. With this tree model, pseudoknots are excluded.</p>
      <p><xref ref-type="fig" rid="pone.0147097.g001">Fig 1</xref> illustrates the transformation process. <xref ref-type="fig" rid="pone.0147097.g001">Fig 1A</xref> shows the 3D crystal structure of the adenine riboswitch molecule (PDB code: 1Y26) obtained from the Protein Data Bank (PDB) [<xref rid="pone.0147097.ref026" ref-type="bibr">26</xref>] and drawn by PyMOL (<ext-link ext-link-type="uri" xlink:href="http://www.pymol.org/">http://www.pymol.org/</ext-link>). The first helix according to the 5′ to 3′ orientation is labeled by H<sub>1</sub> and highlighted in blue. The second helix is labeled by H<sub>2</sub> and highlighted in green. The third helix is labeled by H<sub>3</sub> and highlighted in red. The junction labeled by J<sub>1</sub> and hairpin loops labeled by P<sub>1</sub> and P<sub>2</sub> respectively are highlighted in light grey. J<sub>1</sub> is a multi-branch loop where the three helices H<sub>1</sub>, H<sub>2</sub> and H<sub>3</sub> connect. P<sub>1</sub> and P<sub>2</sub> are hairpin loops connected to helices H<sub>2</sub> and H<sub>3</sub>, respectively.</p>
      <fig id="pone.0147097.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0147097.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Transformation of an RNA 3D molecule into an ordered labeled tree.</title>
          <p>(A) The 3D crystal structure of the adenine riboswitch molecule (PDB code: 1Y26) obtained from the Protein Data Bank (PDB) and drawn by PyMOL. The first helix according to the 5′ to 3′ orientation is labeled by H<sub>1</sub> and highlighted in blue. The second helix is labeled by H<sub>2</sub> and highlighted in green. The third helix is labeled by H<sub>3</sub> and highlighted in red. The junction labeled by J<sub>1</sub> and hairpin loops labeled by P<sub>1</sub> and P<sub>2</sub> respectively are highlighted in light grey. J<sub>1</sub> is a multi-branch loop where the three helices H<sub>1</sub>, H<sub>2</sub> and H<sub>3</sub> connect. P<sub>1</sub> and P<sub>2</sub> are hairpin loops connected to helices H<sub>2</sub> and H<sub>3</sub>, respectively. (B) The corresponding secondary (2D) structure, obtained from RNAView. Each 2D structural element in (B) is highlighted as in (A). The yellow bar across H<sub>1</sub>, J<sub>1</sub> and H<sub>3</sub> denotes a coaxial helical stacking H<sub>1</sub>H<sub>3</sub> in the molecule 1Y26. (C) The ordered labeled tree, <italic>T</italic>, used to represent the 2D structure <italic>R</italic> in (B). Each node of <italic>T</italic> corresponds to a 2D structural element of <italic>R</italic> where the octagon (squares, triangles respectively) in <italic>T</italic> represents the junction (helices, hairpin loops respectively) in <italic>R</italic>.</p>
        </caption>
        <graphic xlink:href="pone.0147097.g001"/>
      </fig>
      <p><xref ref-type="fig" rid="pone.0147097.g001">Fig 1B</xref> shows the corresponding 2D structure, obtained from RNAView [<xref rid="pone.0147097.ref053" ref-type="bibr">53</xref>]. Each 2D structural element in <xref ref-type="fig" rid="pone.0147097.g001">Fig 1B</xref> is highlighted as in <xref ref-type="fig" rid="pone.0147097.g001">Fig 1A</xref>. Notice that there is a yellow bar across H<sub>1</sub>, J<sub>1</sub> and H<sub>3</sub>, symbolizing a coaxial helical stacking H<sub>1</sub>H<sub>3</sub> in the molecule 1Y26, as described in [<xref rid="pone.0147097.ref017" ref-type="bibr">17</xref>,<xref rid="pone.0147097.ref024" ref-type="bibr">24</xref>]. In general, the coaxial helical stacking status of a three-way junction such as J<sub>1</sub> in <xref ref-type="fig" rid="pone.0147097.g001">Fig 1B</xref> is described as one of four possibilities: H<sub>1</sub>H<sub>2,</sub> H<sub>2</sub>H<sub>3,</sub> H<sub>1</sub>H<sub>3,</sub> or none, where H<sub><italic>x</italic></sub>H<sub><italic>y</italic></sub> indicates that H<sub><italic>x</italic></sub> and H<sub><italic>y</italic></sub> are coaxially stacked, i.e., helix H<sub><italic>x</italic></sub> shares a common axis with helix H<sub><italic>y</italic>.</sub> The locations of the junctions and the coaxial helical stacking status of each junction in a given 2D structure can be determined using the methods described in [<xref rid="pone.0147097.ref025" ref-type="bibr">25</xref>].</p>
      <p><xref ref-type="fig" rid="pone.0147097.g001">Fig 1C</xref> shows the tree, <italic>T</italic>, used to represent the 2D structure <italic>R</italic> in <xref ref-type="fig" rid="pone.0147097.g001">Fig 1B</xref>. Each node of <italic>T</italic> corresponds to a 2D structural element of <italic>R</italic> where the octagon (squares, triangles respectively) in <italic>T</italic> represents the junction (helices, hairpin loops respectively) in <italic>R</italic>. Thus, like the 2D structural elements, each tree node belongs to one of three types, namely helix, junction, and hairpin loop. Tree nodes of different types are prohibited to be aligned with each other, and hence the term “constrained tree matching” is used in our work (reminiscent of structural constraints in RNA described in [<xref rid="pone.0147097.ref054" ref-type="bibr">54</xref>]).</p>
      <p>We use <italic>t</italic>[<italic>i</italic>] to represent the node of tree <italic>T</italic> whose position in the left-to-right post-order traversal of <italic>T</italic> is <italic>i</italic>. The post-order procedure works by first traversing the left subtree, then traversing the right subtree, and finally visiting the root. In <xref ref-type="fig" rid="pone.0147097.g001">Fig 1C</xref>, the post-order position number of each node is shown next to the node. By construction, the tree node corresponding to an <italic>n</italic>-way junction consists of <italic>n</italic>– 1 children. The first helix according to the 5′ to 3′ orientation is the parent node of the junction node. The other <italic>n</italic>– 1 helices are the children of that junction node. The number of children of node <italic>t</italic>[<italic>i</italic>] is the degree of <italic>t</italic>[<italic>i</italic>]. In <xref ref-type="fig" rid="pone.0147097.g001">Fig 1C</xref>, H<sub>1</sub> is the parent node of J<sub>1</sub>, which has two children, H<sub>2</sub> and H<sub>3</sub>. The degree of the junction node J<sub>1</sub> is 2. In general, the degree of an <italic>n</italic>-way junction node is <italic>n</italic>– 1.</p>
      <p>Consider two RNA 2D structures <italic>R</italic><sub>1</sub> and <italic>R</italic><sub>2</sub> and their tree representations <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> respectively. Let <italic>t</italic><sub>1</sub>[<italic>i</italic>] (<italic>t</italic><sub>2</sub>[<italic>j</italic>], respectively) be the node of <italic>T</italic><sub>1</sub> (<italic>T</italic><sub>2</sub>, respectively) whose position in the post-order traversal of <italic>T</italic><sub>1</sub> (<italic>T</italic><sub>2</sub>, respectively) is <italic>i</italic> (<italic>j</italic>, respectively). Let <italic>T</italic><sub>1</sub>[<italic>i</italic>] be the subtree rooted at <italic>t</italic><sub>1</sub>[<italic>i</italic>], and <italic>T</italic><sub>2</sub>[<italic>j</italic>] be the subtree rooted at <italic>t</italic><sub>2</sub>[<italic>j</italic>]. <italic>F</italic><sub>1</sub>[<italic>i</italic>] represents the forest obtained by removing the root <italic>t</italic><sub>1</sub>[<italic>i</italic>] from subtree <italic>T</italic><sub>1</sub>[<italic>i</italic>]. <italic>F</italic><sub>2</sub>[<italic>j</italic>] represents the forest obtained by removing the root <italic>t</italic><sub>2</sub>[<italic>j</italic>] from subtree <italic>T</italic><sub>2</sub>[<italic>j</italic>]. Suppose the degree of <italic>t</italic><sub>1</sub>[<italic>i</italic>] is <italic>m</italic><sub><italic>i</italic></sub> (i.e., <italic>t</italic><sub>1</sub>[<italic>i</italic>] has <italic>m</italic><sub><italic>i</italic></sub> children <inline-formula id="pone.0147097.e001"><alternatives><graphic xlink:href="pone.0147097.e001.jpg" id="pone.0147097.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>) and the degree of <italic>t</italic><sub>2</sub>[<italic>j</italic>] is <italic>n</italic><sub><italic>j</italic></sub> (i.e., <italic>t</italic><sub>2</sub>[<italic>j</italic>] has <italic>n</italic><sub><italic>j</italic></sub> children <inline-formula id="pone.0147097.e002"><alternatives><graphic xlink:href="pone.0147097.e002.jpg" id="pone.0147097.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>). We use <italic>S</italic>(<italic>T</italic><sub>1</sub>[<italic>i</italic>], <italic>T</italic><sub>2</sub>[<italic>j</italic>]) to represent the alignment score of subtree <italic>T</italic><sub>1</sub>[<italic>i</italic>] and subtree <italic>T</italic><sub>2</sub>[<italic>j</italic>], and use γ(<italic>t</italic><sub>1</sub>[<italic>i</italic>], <italic>t</italic><sub>2</sub>[<italic>j</italic>]) to represent the alignment score of node <italic>t</italic><sub>1</sub>[<italic>i</italic>] and node <italic>t</italic><sub>2</sub>[<italic>j</italic>]. We use ∅ to represent an empty node; matching a tree node with ∅ amounts to aligning all nucleotides in the tree node to gaps.</p>
    </sec>
    <sec id="sec004">
      <title>Alignment scheme</title>
      <p>We employ a dynamic programming algorithm to align two RNA 2D structures with coaxial stacking patterns. Our approach is to transform each RNA 2D structure into an ordered labeled tree as explained in the previous subsection. We then apply the dynamic programming algorithm to the ordered labeled trees representing the two RNA 2D structures. Based on the alignment of the trees, we obtain the alignment of the corresponding RNA 2D structures. As noted above, each tree node belongs to one of three types: helix, junction, and hairpin loop. Different types of tree nodes are prohibited to be aligned with each other. When aligning two subtrees <italic>T</italic><sub>1</sub>[<italic>i</italic>] and <italic>T</italic><sub>2</sub>[<italic>j</italic>] and calculating the score <italic>S</italic>(<italic>T</italic><sub>1</sub>[<italic>i</italic>], <italic>T</italic><sub>2</sub>[<italic>j</italic>]), there are nine cases to be considered.</p>
      <p><bold>Case 1.</bold> Both <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] are junctions.</p>
      <p>One constraint we impose on pairwise alignment is that when aligning a p-way junction node v1 with a q-way junction node v2, p must be equal to q. Furthermore, the coaxial helical stacking status of <italic>v</italic><sub>1</sub> must be the same as the coaxial stacking status of <italic>v</italic><sub>2</sub>. Thus, a three-way junction must be aligned with a three-way junction, which is not allowed to align with a four-way junction. Furthermore, a three-way junction whose coaxial helical stacking status is H<sub>1</sub>H<sub>2</sub> must be aligned with a three-way junction having the same H<sub>1</sub>H<sub>2</sub> status, which is not allowed to align with a three-way junction whose coaxial helical stacking status is H<sub>2</sub>H<sub>3.</sub> In general, junctions with different branches and different coaxial stacking configurations have different biological properties. This constraint is established to ensure a biologically meaningful alignment is obtained, and to avoid introducing too many gaps in the alignment.</p>
      <p>According to our tree model, if a tree node is a junction, it must have at least two children and the children must be helix nodes. A junction contains loop regions with single bases whereas helices are double-stranded regions with base pairs. A junction node is thus prohibited to be aligned with a helix node. Hence, <italic>t</italic><sub>1</sub>[<italic>i</italic>] must be aligned with <italic>t</italic><sub>2</sub>[<italic>j</italic>] provided they have the same number of branches and the same coaxial helical stacking status, denoted by Ψ(<italic>t</italic><sub>1</sub>[<italic>i</italic>]) = Ψ(<italic>t</italic><sub>2</sub>[<italic>j</italic>]). Their children are trees, which together form forests <italic>F</italic><sub>1</sub>[<italic>i</italic>] and <italic>F</italic><sub>2</sub>[<italic>j</italic>] respectively. <italic>F</italic><sub>1</sub>[<italic>i</italic>] must be aligned with <italic>F</italic><sub>2</sub>[<italic>j</italic>]. Thus the alignment score of <italic>T</italic><sub>1</sub>[<italic>i</italic>] and <italic>T</italic><sub>2</sub>[<italic>j</italic>] can be calculated as:
<disp-formula id="pone.0147097.e003"><alternatives><graphic xlink:href="pone.0147097.e003.jpg" id="pone.0147097.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>0</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>If Ψ(<italic>t</italic><sub>1</sub>[<italic>i</italic>]) = Ψ(<italic>t</italic><sub>2</sub>[<italic>j</italic>]), <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] must have the same number of children, and the order among the sibling nodes is important. If Ψ(<italic>t</italic><sub>1</sub>[<italic>i</italic>]) ≠ Ψ(<italic>t</italic><sub>2</sub>[<italic>j</italic>]), i.e., <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] have different numbers of children (branches) or they have different coaxial helical stacking statuses, they are prohibited to be aligned together. Thus, the score of matching <italic>F</italic><sub>1</sub>[<italic>i</italic>] with <italic>F</italic><sub>2</sub>[<italic>j</italic>] can be calculated as:
<disp-formula id="pone.0147097.e004"><alternatives><graphic xlink:href="pone.0147097.e004.jpg" id="pone.0147097.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> if </mml:mtext><mml:mo>Ψ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>Ψ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi><mml:mtext>                                                                           otherwise                  </mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic>m</italic> is the number of children of <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] respectively. We use Π(<italic>t</italic><sub>1</sub>[<italic>i</italic>]) to represent the coaxial helical stacking status of <italic>t</italic><sub>1</sub>[<italic>i</italic>]; Π(<italic>t</italic><sub>1</sub>[<italic>i</italic>]) = 1 (2, 3, 0, respectively) if the coaxial helical stacking status of <italic>t</italic><sub>1</sub>[<italic>i</italic>] is H<sub>1</sub>H<sub>2</sub> (H<sub>2</sub>H<sub>3,</sub> H<sub>1</sub>H<sub>3,</sub> none, respectively). The score of matching <italic>t</italic><sub>1</sub>[<italic>i</italic>] with <italic>t</italic><sub>2</sub>[<italic>j</italic>] is
<disp-formula id="pone.0147097.e005"><alternatives><graphic xlink:href="pone.0147097.e005.jpg" id="pone.0147097.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mo>Ψ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>Ψ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>, </mml:mtext><mml:mi>Π</mml:mi><mml:mtext>(</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mtext>)</mml:mtext><mml:mo>≠</mml:mo><mml:mtext>0, </mml:mtext><mml:mi>Π</mml:mi><mml:mtext>(</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mtext>)</mml:mtext><mml:mo>≠</mml:mo><mml:mtext>0</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mfrac bevelled="true"><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mo>Ψ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>Ψ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>, </mml:mtext><mml:mi>Π</mml:mi><mml:mtext>(</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mtext>) = </mml:mtext><mml:mi>Π</mml:mi><mml:mtext>(</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mtext>) = 0</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></alternatives><label>(3)</label></disp-formula>
Here, <italic>s</italic> is the score obtained by aligning the junction in <italic>t</italic><sub>1</sub>[<italic>i</italic>] with the junction in <italic>t</italic><sub>2</sub>[<italic>j</italic>]. We use a dynamic programming algorithm [<xref rid="pone.0147097.ref037" ref-type="bibr">37</xref>,<xref rid="pone.0147097.ref038" ref-type="bibr">38</xref>] to calculate the alignment score <italic>s</italic>, and adopt the RIBOSUM85-60 matrix [<xref rid="pone.0147097.ref055" ref-type="bibr">55</xref>] to calculate the score of aligning two bases or base pairs in RNA 2D structures. (The default gap penalty is –1.) With this scoring matrix, CHSalign can handle non-canonical base pairs. The addition of a parameter <italic>w</italic> to the alignment score is a computational device to enforce the right alignment of the RNAs when the junction patterns match. Thus, if <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] have the same number of branches, their CHS patterns are alike, and Π(<italic>t</italic><sub>1</sub>[<italic>i</italic>])≠0, Π(<italic>t</italic><sub>2</sub>[<italic>j</italic>])≠0, we use <italic>s</italic>+<italic>w</italic> as the modified alignment score. When <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] have the same number of branches and Π(<italic>t</italic><sub>1</sub>[<italic>i</italic>]) = Π(<italic>t</italic><sub>2</sub>[<italic>j</italic>]) = 0, we use <italic>s</italic>+(<italic>w</italic>/2) as the modified score. The value of <italic>w</italic> required experimentation, as we discuss later, but a value of 100 seems to work well in practice.</p>
      <p><bold>Case 2.</bold> Both <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] are helices.</p>
      <p>Due to the nature of RNA 2D structures and based on our tree model, a helix has only one child, which is either a junction or a hairpin loop. The subtree rooted at the child of <italic>t</italic><sub>1</sub>[<italic>i</italic>] is denoted by <italic>T</italic><sub>1</sub>[<italic>i</italic>—1] and the subtree rooted at the child of <italic>t</italic><sub>2</sub>[<italic>j</italic>] is denoted by <italic>T</italic><sub>2</sub>[<italic>j</italic>—1]. We have to match helix nodes <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] first, and then add the alignment score of their subtrees <italic>T</italic><sub>1</sub>[<italic>i</italic>—1] and <italic>T</italic><sub>2</sub>[<italic>j</italic>—1] if the alignment score of the subtrees is greater than or equal to zero, or simply match <italic>t</italic><sub>1</sub>[<italic>i</italic>] with <italic>t</italic><sub>2</sub>[<italic>j</italic>] if the alignment score of their subtrees is negative (i.e., the subtrees are not aligned). Therefore, the alignment score of <italic>T</italic><sub>1</sub>[<italic>i</italic>] and <italic>T</italic><sub>2</sub>[<italic>j</italic>] can be calculated as:
<disp-formula id="pone.0147097.e006"><alternatives><graphic xlink:href="pone.0147097.e006.jpg" id="pone.0147097.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula></p>
      <p>The score γ(<italic>t</italic><sub>1</sub>[<italic>i</italic>], <italic>t</italic><sub>2</sub>[<italic>j</italic>]) is obtained by aligning the helix in <italic>t</italic><sub>1</sub>[<italic>i</italic>] with the helix in <italic>t</italic><sub>2</sub>[<italic>j</italic>] using a dynamic programming algorithm [<xref rid="pone.0147097.ref037" ref-type="bibr">37</xref>,<xref rid="pone.0147097.ref038" ref-type="bibr">38</xref>]. The value 0 is used if the other entries in <xref ref-type="disp-formula" rid="pone.0147097.e006">Eq (4)</xref> yield negative scores.</p>
      <p><bold>Case 3.</bold> Both <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] are hairpin loops.</p>
      <p>Due to the nature of RNA 2D structures and based on our tree model, a hairpin does not have any child. Therefore hairpin nodes are always leaves in the tree representation of an RNA 2D structure. When both <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] are hairpin loops, matching <italic>T</italic><sub>1</sub>[<italic>i</italic>] with <italic>T</italic><sub>2</sub>[<italic>j</italic>] amounts to matching <italic>t</italic><sub>1</sub>[<italic>i</italic>] with <italic>t</italic><sub>2</sub>[<italic>j</italic>]. Thus, the alignment score becomes:
<disp-formula id="pone.0147097.e007"><alternatives><graphic xlink:href="pone.0147097.e007.jpg" id="pone.0147097.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mtext>                    </mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(5)</label></disp-formula></p>
      <p>The score γ(<italic>t</italic><sub>1</sub>[<italic>i</italic>], <italic>t</italic><sub>2</sub>[<italic>j</italic>]) is obtained by aligning the hairpin loop in <italic>t</italic><sub>1</sub>[<italic>i</italic>] with the hairpin loop in <italic>t</italic><sub>2</sub>[<italic>j</italic>] using a dynamic programming algorithm [<xref rid="pone.0147097.ref037" ref-type="bibr">37</xref>,<xref rid="pone.0147097.ref038" ref-type="bibr">38</xref>].</p>
      <p><bold>Case 4.</bold><italic>t</italic><sub>1</sub>[<italic>i</italic>] is a junction and <italic>t</italic><sub>2</sub>[<italic>j</italic>] is a helix.</p>
      <p>Since <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] have different types, they cannot be aligned with each other. There are two subcases.</p>
      <p>Subcase 1. <italic>t</italic><sub>2</sub>[<italic>j</italic>] is aligned to gaps. Then <italic>T</italic><sub>1</sub>[<italic>i</italic>] must be aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>—1], which is the subtree rooted at the child of <italic>t</italic><sub>2</sub>[<italic>j</italic>].</p>
      <p>Subcase 2. <italic>t</italic><sub>1</sub>[<italic>i</italic>] is aligned to gaps. Suppose <italic>t</italic><sub>1</sub>[<italic>i</italic>] has <italic>m</italic><sub><italic>i</italic></sub> children <inline-formula id="pone.0147097.e008"><alternatives><graphic xlink:href="pone.0147097.e008.jpg" id="pone.0147097.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The subtrees rooted at these children are denoted by <inline-formula id="pone.0147097.e009"><alternatives><graphic xlink:href="pone.0147097.e009.jpg" id="pone.0147097.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> respectively. Then, one of these subtrees must be aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>]; specifically the subtree yielding the maximum alignment score is aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>].</p>
      <p>We take the maximum of the above two subcases. Thus, the score of matching <italic>T</italic><sub>1</sub>[<italic>i</italic>] with <italic>T</italic><sub>2</sub>[<italic>j</italic>] can be calculated as:
<disp-formula id="pone.0147097.e010"><alternatives><graphic xlink:href="pone.0147097.e010.jpg" id="pone.0147097.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>∅</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>∅</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula></p>
      <p>The value 0 is used if both of the two subcases yield negative scores.</p>
      <p><xref ref-type="fig" rid="pone.0147097.g002">Fig 2</xref> illustrates this case where two PDB molecules, A-riboswitch (PDB code: 1Y26) and the Alu domain of the mammalian signal recognition particle (SRP) (PDB code: 1E8O), are considered. <xref ref-type="fig" rid="pone.0147097.g002">Fig 2A</xref> shows the 3D crystal structure of the adenine riboswitch molecule and its tree representation <italic>T</italic><sub>1</sub>. <xref ref-type="fig" rid="pone.0147097.g002">Fig 2B</xref> shows the 3D crystal structure of the Alu domain of the mammalian SRP molecule and its tree representation <italic>T</italic><sub>2</sub>. When matching <italic>T</italic><sub>1</sub>[<italic>i</italic>] with <italic>T</italic><sub>2</sub>[<italic>j</italic>], since <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] have different types where <italic>t</italic><sub>1</sub>[<italic>i</italic>] is a junction and <italic>t</italic><sub>2</sub>[<italic>j</italic>] is a helix, there are two subcases to be considered, as detailed above. <xref ref-type="fig" rid="pone.0147097.g002">Fig 2C-i</xref> illustrates subcase 1, in which <italic>t</italic><sub>2</sub>[<italic>j</italic>] is aligned to gaps and <italic>T</italic><sub>1</sub>[<italic>i</italic>] is aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>—1]. <xref ref-type="fig" rid="pone.0147097.g002">Fig 2C-ii</xref> illustrates subcase 2, in which <italic>t</italic><sub>1</sub>[<italic>i</italic>] is aligned to gaps, and the subtree rooted at one of the children of <italic>t</italic><sub>1</sub>[<italic>i</italic>] is aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>]. In our example here, <italic>t</italic><sub>1</sub>[<italic>i</italic>] has two children, <italic>t</italic><sub>1</sub>[<italic>i</italic><sub>1</sub>] and <italic>t</italic><sub>1</sub>[<italic>i</italic><sub>2</sub>]. Thus, either the subtree rooted at <italic>t</italic><sub>1</sub>[<italic>i</italic><sub>1</sub>], denoted by <italic>T</italic><sub>1</sub>[<italic>i</italic><sub>1</sub>], is aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>] as illustrated in <xref ref-type="fig" rid="pone.0147097.g002">Fig 2C-iia</xref>, or the subtree rooted at <italic>t</italic><sub>1</sub>[<italic>i</italic><sub>2</sub>], denoted by <italic>T</italic><sub>1</sub>[<italic>i</italic><sub>2</sub>], is aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>] as illustrated in <xref ref-type="fig" rid="pone.0147097.g002">Fig 2C-iib</xref>. The maximum alignment score obtained from <xref ref-type="fig" rid="pone.0147097.g002">Fig 2C-iia and 2C-iib</xref> is used. Then <italic>S</italic>(<italic>T</italic><sub>1</sub>[<italic>i</italic>], <italic>T</italic><sub>2</sub>[<italic>j</italic>]) is calculated by taking the maximum of the two subcases illustrated in <xref ref-type="fig" rid="pone.0147097.g002">Fig 2C-i and 2C-ii</xref> respectively.</p>
      <fig id="pone.0147097.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0147097.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Illustration of an alignment between two RNA molecules.</title>
          <p>(A) The 3D crystal structure of the adenine riboswitch (PDB code: 1Y26) and its tree representation <italic>T</italic><sub>1</sub>. (B) The 3D crystal structure of the Alu domain of the mammalian signal recognition particle (SRP) (PDB code: 1E8O) and its tree representation <italic>T</italic><sub>2</sub>. (C) When matching <italic>T</italic><sub>1</sub>[<italic>i</italic>] with <italic>T</italic><sub>2</sub>[<italic>j</italic>], since <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] have different types where <italic>t</italic><sub>1</sub>[<italic>i</italic>] is a junction and <italic>t</italic><sub>2</sub>[<italic>j</italic>] is a helix, there are two subcases to be considered. Subcase 1 is illustrated in (i) where <italic>t</italic><sub>2</sub>[<italic>j</italic>] is aligned to gaps and <italic>T</italic><sub>1</sub>[<italic>i</italic>] is aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>—1]. Subcase 2 is illustrated in (ii) where <italic>t</italic><sub>1</sub>[<italic>i</italic>] is aligned to gaps, and the subtree rooted at one of the children of <italic>t</italic><sub>1</sub>[<italic>i</italic>] is aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>]. In this example, <italic>t</italic><sub>1</sub>[<italic>i</italic>] has two children, <italic>t</italic><sub>1</sub>[<italic>i</italic><sub>1</sub>] and <italic>t</italic><sub>1</sub>[<italic>i</italic><sub>2</sub>]. Thus, either the subtree rooted at <italic>t</italic><sub>1</sub>[<italic>i</italic><sub>1</sub>], denoted by <sub>1</sub>[<italic>i</italic><sub>1</sub>], is aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>] as illustrated in (iia), or the subtree rooted at <italic>t</italic><sub>1</sub>[<italic>i</italic><sub>2</sub>], denoted by <italic>T</italic><sub>1</sub>[<italic>i</italic><sub>2</sub>], is aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>] as illustrated in (iib).</p>
        </caption>
        <graphic xlink:href="pone.0147097.g002"/>
      </fig>
      <p><bold>Case 5.</bold><italic>t</italic><sub>1</sub>[<italic>i</italic>] is a junction and <italic>t</italic><sub>2</sub>[<italic>j</italic>] is a hairpin loop.</p>
      <p>Since <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] have different types, the two nodes cannot be aligned together. Furthermore, <italic>t</italic><sub>2</sub>[<italic>j</italic>] is a hairpin loop, which does not have any child. Thus <italic>t</italic><sub>1</sub>[<italic>i</italic>] must be aligned to gaps, and the subtree rooted at one of the children of <italic>t</italic><sub>1</sub>[<italic>i</italic>] is aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>]; specifically the subtree yielding the maximum alignment score is aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>]. Therefore, the alignment score of <italic>T</italic><sub>1</sub>[<italic>i</italic>] and <italic>T</italic><sub>2</sub>[<italic>j</italic>] can be calculated as:
<disp-formula id="pone.0147097.e011"><alternatives><graphic xlink:href="pone.0147097.e011.jpg" id="pone.0147097.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>∅</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(7)</label></disp-formula></p>
      <p><bold>Case 6.</bold><italic>t</italic><sub>1</sub>[<italic>i</italic>] is a helix and <italic>t</italic><sub>2</sub>[<italic>j</italic>] is a junction.</p>
      <p>Similar to Case 4, there are two subcases.</p>
      <p>Subcase 1. <italic>t</italic><sub>i</sub>[<italic>i</italic>] is aligned to gaps. Thus, the subtree rooted at the child of <italic>t</italic><sub>1</sub>[<italic>i</italic>], denoted by <italic>T</italic><sub>1</sub>[<italic>i</italic>—1], must be aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>].</p>
      <p>Subcase 2. <italic>t</italic><sub>2</sub>[<italic>j</italic>] is aligned to gaps. Suppose <italic>t</italic><sub>2</sub>[<italic>j</italic>] has <italic>n</italic><sub><italic>j</italic></sub> children <inline-formula id="pone.0147097.e012"><alternatives><graphic xlink:href="pone.0147097.e012.jpg" id="pone.0147097.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The subtrees rooted at these children are <inline-formula id="pone.0147097.e013"><alternatives><graphic xlink:href="pone.0147097.e013.jpg" id="pone.0147097.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> respectively. Then <italic>T</italic><sub>1</sub>[<italic>i</italic>] must be aligned with one of these subtrees.</p>
      <p>Taking the maximum of these two subcases, we calculate the score of matching <italic>T</italic><sub>1</sub>[<italic>i</italic>] with <italic>T</italic><sub>2</sub>[<italic>j</italic>] as:
<disp-formula id="pone.0147097.e014"><alternatives><graphic xlink:href="pone.0147097.e014.jpg" id="pone.0147097.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>∅</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>∅</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(8)</label></disp-formula></p>
      <p><bold>Case 7.</bold><italic>t</italic><sub>1</sub>[<italic>i</italic>] is a helix and <italic>t</italic><sub>2</sub>[<italic>j</italic>] is a hairpin loop.</p>
      <p>Because <italic>t</italic><sub>1</sub>[<italic>i</italic>] and <italic>t</italic><sub>2</sub>[<italic>j</italic>] have different types, the two nodes cannot be aligned together. Furthermore, since <italic>t</italic><sub>1</sub>[<italic>i</italic>] is a helix, it has only one child; <italic>t</italic><sub>2</sub>[<italic>j</italic>] is a hairpin loop with no children. Therefore, <italic>t</italic><sub>1</sub>[<italic>i</italic>] must be aligned to gaps and the subtree rooted at the child of <italic>t</italic><sub>1</sub>[<italic>i</italic>], denoted by <italic>T</italic><sub>1</sub>[<italic>i</italic>—1], must be aligned with <italic>T</italic><sub>2</sub>[<italic>j</italic>], or if the alignment yields a negative score, we use the value 0. Thus, the alignment score is
<disp-formula id="pone.0147097.e015"><alternatives><graphic xlink:href="pone.0147097.e015.jpg" id="pone.0147097.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>∅</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(9)</label></disp-formula></p>
      <p><bold>Case 8.</bold><italic>t</italic><sub>1</sub>[<italic>i</italic>] is a hairpin loop and <italic>t</italic><sub>2</sub>[<italic>j</italic>] is a junction.</p>
      <p>This is similar to Case 5. Thus, we can calculate the score of matching <italic>T</italic><sub>1</sub>[<italic>i</italic>] with <italic>T</italic><sub>2</sub>[<italic>j</italic>] as:
<disp-formula id="pone.0147097.e016"><alternatives><graphic xlink:href="pone.0147097.e016.jpg" id="pone.0147097.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>∅</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(10)</label></disp-formula></p>
      <p><bold>Case 9.</bold><italic>t</italic><sub>1</sub>[<italic>i</italic>] is a hairpin loop and <italic>t</italic><sub>2</sub>[<italic>j</italic>] is a helix.</p>
      <p>This is similar to Case 7, with the alignment score:
<disp-formula id="pone.0147097.e017"><alternatives><graphic xlink:href="pone.0147097.e017.jpg" id="pone.0147097.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>∅</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(11)</label></disp-formula></p>
    </sec>
    <sec id="sec005">
      <title>Time and space complexity</title>
      <p>Let |<italic>T</italic><sub>1</sub>| (|<italic>T</italic><sub>2</sub>| respectively) denote the number of nodes in tree <italic>T</italic><sub>1</sub> (<italic>T</italic><sub>2</sub> respectively) that represents RNA structure <italic>R</italic><sub>1</sub> (<italic>R</italic><sub>2</sub> respectively). CHSalign maintains a two-dimensional table in which <italic>c</italic>(<italic>i</italic>, <italic>j</italic>) represents the cell located at the intersection of the <italic>i</italic>th row and the <italic>j</italic>th column of the table. The value stored in the cell <italic>c</italic>(<italic>i</italic>, <italic>j</italic>), 1 ≤ <italic>i</italic> ≤ |<italic>T</italic><sub>1</sub>|, 1 ≤ <italic>j</italic> ≤ |<italic>T</italic><sub>2</sub>|, is <italic>S</italic>(<italic>T</italic><sub>1</sub>[<italic>i</italic>], <italic>T</italic><sub>2</sub>[<italic>j</italic>]). The dynamic programming algorithm employed by CHSalign calculates the values in the table by traversing the trees <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> in a bottom-up manner. After all the values in the table are computed, the algorithm locates the cell <italic>c</italic> with the maximum value. A backtrack procedure starting with the cell <italic>c</italic> and terminating when encountering a zero identifies the alignment lines of an optimal alignment and calculates the alignment score between <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub>.</p>
      <p>Let |<italic>R</italic><sub>1</sub>| (|<italic>R</italic><sub>2</sub>| respectively) denote the number of nucleotides, i.e., the length, of RNA structure <italic>R</italic><sub>1</sub> (<italic>R</italic><sub>2</sub> respectively). Let |<italic>t</italic><sub>1</sub>[<italic>i</italic>]| (|<italic>t</italic><sub>2</sub>[<italic>j</italic>]| respectively) be the number of nucleotides in node <italic>t</italic><sub>1</sub>[<italic>i</italic>] (<italic>t</italic><sub>2</sub>[<italic>j</italic>] respectively). Let <italic>d</italic><sub>1</sub> (<italic>d</italic><sub>2</sub>, respectively) be the maximum degree of any node in tree <italic>T</italic><sub>1</sub> (<italic>T</italic><sub>2</sub> respectively). The time complexity of computing γ(<italic>t</italic><sub>1</sub>[<italic>i</italic>], <italic>t</italic><sub>2</sub>[<italic>j</italic>]) is <italic>O</italic>(|<italic>t</italic><sub>1</sub>[<italic>i</italic>]|×|<italic>t</italic><sub>2</sub>[<italic>j</italic>]|) [<xref rid="pone.0147097.ref037" ref-type="bibr">37</xref>]. Thus, the time complexity of computing <italic>S</italic>(<italic>T</italic><sub>1</sub>[<italic>i</italic>],<italic>T</italic><sub>2</sub>[<italic>j</italic>]) is <italic>O</italic>(max(<italic>d</italic><sub>1</sub>,<italic>d</italic><sub>2</sub>)+|<italic>t</italic><sub>1</sub>[<italic>i</italic>]|×|<italic>t</italic><sub>2</sub>[<italic>j</italic>]|). Here max(<italic>d</italic><sub>1</sub>, <italic>d</italic><sub>2</sub>) is a constant because a junction has at most twelve branches in solved RNA crystal structures [<xref rid="pone.0147097.ref004" ref-type="bibr">4</xref>,<xref rid="pone.0147097.ref025" ref-type="bibr">25</xref>,<xref rid="pone.0147097.ref052" ref-type="bibr">52</xref>]. Furthermore, <inline-formula id="pone.0147097.e018"><alternatives><graphic xlink:href="pone.0147097.e018.jpg" id="pone.0147097.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0147097.e019"><alternatives><graphic xlink:href="pone.0147097.e019.jpg" id="pone.0147097.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> Therefore the time complexity of calculating all the values in the two-dimensional table is
<disp-formula id="pone.0147097.e020"><alternatives><graphic xlink:href="pone.0147097.e020.jpg" id="pone.0147097.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtext>   </mml:mtext><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula></p>
      <p>Locating the cell <italic>c</italic> with the maximum value in the two-dimensional table and executing the backtrack procedure require <inline-formula id="pone.0147097.e021"><alternatives><graphic xlink:href="pone.0147097.e021.jpg" id="pone.0147097.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> computational time. Therefore the time complexity of CHSalign is <italic>O</italic>(|<italic>R</italic><sub>1</sub>|×|<italic>R</italic><sub>2</sub>|). Since only a two-dimensional table is used, the space complexity of CHSalign is <italic>O</italic>(|<italic>T</italic><sub>1</sub>|×|<italic>T</italic><sub>2</sub>|) = <italic>O</italic>(|<italic>R</italic><sub>1</sub>|×|<italic>R</italic><sub>2</sub>|).</p>
    </sec>
    <sec id="sec006">
      <title>Data sets</title>
      <p>Popular benchmark datasets such as BRAliBase [<xref rid="pone.0147097.ref056" ref-type="bibr">56</xref>] and Rfam [<xref rid="pone.0147097.ref057" ref-type="bibr">57</xref>] are not suitable for testing CHSalign, since they do not contain coaxial helical stacking information. As a consequence, we manually created two datasets for testing CHSalign and comparing it with related methods. The first dataset, Dataset1, contains 24 RNA 3D structures from the Protein Data Bank (PDB) [<xref rid="pone.0147097.ref026" ref-type="bibr">26</xref>] (see <xref rid="pone.0147097.t001" ref-type="table">Table 1</xref>). This dataset was studied and published in [<xref rid="pone.0147097.ref004" ref-type="bibr">4</xref>,<xref rid="pone.0147097.ref025" ref-type="bibr">25</xref>,<xref rid="pone.0147097.ref052" ref-type="bibr">52</xref>], in which all annotations for junctions and coaxial helical stacking were taken from crystallographic structures. Each 3D structure in Dataset1 contains at least one three-way junction, and the lengths of the 3D structures range from 40 nt to 2,958 nt. Some 3D structures contain higher-order junctions such as ten-way junctions with coaxial stacking patterns. The 2D structure of each 3D structure in Dataset1 is obtained with RNAView retrieved from RNA STRAND [<xref rid="pone.0147097.ref058" ref-type="bibr">58</xref>]. The pseudoknots in these structures are removed using the K2N tool [<xref rid="pone.0147097.ref059" ref-type="bibr">59</xref>].</p>
      <table-wrap id="pone.0147097.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0147097.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>The 24 RNA full structures in Dataset1 selected from the Protein Data Bank (PDB) to evaluate the performance of the alignment methods studied in this paper.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0147097.t001g" xlink:href="pone.0147097.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">PDB Code</th>
                <th align="center" rowspan="1" colspan="1">Molecule Name</th>
                <th align="center" rowspan="1" colspan="1">Length</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">1E8O</td>
                <td align="left" rowspan="1" colspan="1">Alu domain of the Signal recognition particle (7SL RNA)</td>
                <td align="center" rowspan="1" colspan="1">50</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">1L9A</td>
                <td align="left" rowspan="1" colspan="1">Signal recognition particle RNA S domain</td>
                <td align="center" rowspan="1" colspan="1">126</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="center" rowspan="1" colspan="1">1LNG</td>
                <td align="left" rowspan="1" colspan="1">Signal recognition particle (7S.S RNA)</td>
                <td align="center" rowspan="1" colspan="1">97</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="center" rowspan="1" colspan="1">1NBS</td>
                <td align="left" rowspan="1" colspan="1">Ribonuclease P RNA</td>
                <td align="center" rowspan="1" colspan="1">119</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="center" rowspan="1" colspan="1">1NKW</td>
                <td align="left" rowspan="1" colspan="1">23S ribosomal RNA</td>
                <td align="center" rowspan="1" colspan="1">2884</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">1NYI</td>
                <td align="left" rowspan="1" colspan="1">Hammerhead ribozyme</td>
                <td align="center" rowspan="1" colspan="1">40</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">7</td>
                <td align="center" rowspan="1" colspan="1">1S72</td>
                <td align="left" rowspan="1" colspan="1">23S ribosomal RNA</td>
                <td align="center" rowspan="1" colspan="1">2876</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="center" rowspan="1" colspan="1">1U6B</td>
                <td align="left" rowspan="1" colspan="1">Group I intron</td>
                <td align="center" rowspan="1" colspan="1">222</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">9</td>
                <td align="center" rowspan="1" colspan="1">1U8D</td>
                <td align="left" rowspan="1" colspan="1">xpt-pbuX guanine riboswitch aptamer domain</td>
                <td align="center" rowspan="1" colspan="1">67</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">1UN6</td>
                <td align="left" rowspan="1" colspan="1">5S ribosomal RNA</td>
                <td align="center" rowspan="1" colspan="1">122</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">11</td>
                <td align="center" rowspan="1" colspan="1">1X8W</td>
                <td align="left" rowspan="1" colspan="1">Tetrahymena ribozyme RNA (group I intron)</td>
                <td align="center" rowspan="1" colspan="1">968</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">1Y26</td>
                <td align="left" rowspan="1" colspan="1">Vibrio vulnificus A-riboswitch</td>
                <td align="center" rowspan="1" colspan="1">71</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">13</td>
                <td align="center" rowspan="1" colspan="1">2A64</td>
                <td align="left" rowspan="1" colspan="1">Ribonuclease P RNA</td>
                <td align="center" rowspan="1" colspan="1">298</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">2AVY</td>
                <td align="left" rowspan="1" colspan="1">16S ribosomal RNA</td>
                <td align="center" rowspan="1" colspan="1">1530</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">2AW4</td>
                <td align="left" rowspan="1" colspan="1">23S ribosomal RNA</td>
                <td align="center" rowspan="1" colspan="1">2958</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">16</td>
                <td align="center" rowspan="1" colspan="1">2B57</td>
                <td align="left" rowspan="1" colspan="1">Guanine riboswitch</td>
                <td align="center" rowspan="1" colspan="1">65</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">17</td>
                <td align="center" rowspan="1" colspan="1">2CKY</td>
                <td align="left" rowspan="1" colspan="1">Thiamine pyrophosphate riboswitch</td>
                <td align="center" rowspan="1" colspan="1">154</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">18</td>
                <td align="center" rowspan="1" colspan="1">2CZJ</td>
                <td align="left" rowspan="1" colspan="1">Transfer-messenger RNA (tmRNA)</td>
                <td align="center" rowspan="1" colspan="1">248</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">19</td>
                <td align="center" rowspan="1" colspan="1">2EES</td>
                <td align="left" rowspan="1" colspan="1">Guanine riboswitch</td>
                <td align="center" rowspan="1" colspan="1">68</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="center" rowspan="1" colspan="1">2GDI</td>
                <td align="left" rowspan="1" colspan="1">TPP riboswitch</td>
                <td align="center" rowspan="1" colspan="1">80</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">21</td>
                <td align="center" rowspan="1" colspan="1">2HOJ</td>
                <td align="left" rowspan="1" colspan="1">THI-box riboswitch</td>
                <td align="center" rowspan="1" colspan="1">75</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">22</td>
                <td align="center" rowspan="1" colspan="1">2J00</td>
                <td align="left" rowspan="1" colspan="1">16S ribosomal RNA</td>
                <td align="center" rowspan="1" colspan="1">1687</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">23</td>
                <td align="center" rowspan="1" colspan="1">2J01</td>
                <td align="left" rowspan="1" colspan="1">23S ribosomal RNA</td>
                <td align="center" rowspan="1" colspan="1">2891</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">24</td>
                <td align="center" rowspan="1" colspan="1">2QBZ</td>
                <td align="left" rowspan="1" colspan="1">M-Box RNA, ykoK riboswitch aptamer</td>
                <td align="center" rowspan="1" colspan="1">153</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The second dataset, Dataset2, contains 76 three-way junctions extracted from the 24 3D structures in Dataset1. (Some 3D structures in Dataset1 contain more than one three-way junction and all those three-way junctions in a 3D structure are extracted.) The lengths of the three-way junctions range from 28nt to 153nt. The coaxial helical stacking status of each three-way junction in Dataset2 is described as one of three possibilities: H<sub>1</sub>H<sub>2,</sub> H<sub>2</sub>H<sub>3,</sub> H<sub>1</sub>H<sub>3.</sub> Thus, every three-way junction in Dataset2 contains a coaxial stacking pattern. In the RNA literature, most research efforts have been focused on three-way and four-way junctions [<xref rid="pone.0147097.ref006" ref-type="bibr">6</xref>,<xref rid="pone.0147097.ref015" ref-type="bibr">15</xref>,<xref rid="pone.0147097.ref060" ref-type="bibr">60</xref>–<xref rid="pone.0147097.ref062" ref-type="bibr">62</xref>] partly due to the fact that higher-order junctions are rare. In particular, three-way junctions are the most abundant type of junctions, accounting for over 50% of the available crystal data. We also performed experiments on four-way junctions; results obtained from the four-way junctions were similar to those for the three-way junctions reported here, and hence omitted.</p>
    </sec>
  </sec>
  <sec id="sec007">
    <title>Results and Discussion</title>
    <sec id="sec008">
      <title>Two CHSalign web server versions</title>
      <p>We have implemented two programs in Java, a standalone version denoted by CHSalign_u, and the other a pipeline denoted by CHSalign_p. CHSalign_u requires the user to manually annotate the coaxial stacking patterns within junctions of the pair of RNA 2D structures in the input, and produces an optimal alignment between the two input structures.</p>
      <p>By contrast, CHSalign_p accepts as input two unannotated RNA 2D structures and produces as output an optimal alignment between the two input structures while taking into account their junctions and coaxial stacking configurations within the junctions. This pipeline invokes our previously developed Junction-Explorer tool [<xref rid="pone.0147097.ref025" ref-type="bibr">25</xref>] to automatically predict and identify the junctions and coaxial stacking patterns within the junctions in the input structures, and then aligns the input structures containing the predicted coaxial stacking patterns. Both CHSalign_u and CHSalign_p are available on the web.</p>
    </sec>
    <sec id="sec009">
      <title>Performance evaluation using RMSD</title>
      <p>We conducted a series of experiments to evaluate the performance of our algorithms. In the first experiment, we divided Dataset2 into three disjoint subsets Dataset2-1, Dataset2-2 and Dataset2-3, with 35, 18, and 23 junctions, respectively. These three subsets contain, respectively, three-way junctions whose coaxial helical stacking status is H<sub>1</sub>H<sub>2</sub>, H<sub>2</sub>H<sub>3</sub>, or H<sub>1</sub>H<sub>3</sub>. We performed pairwise alignment of junctions in each subset. There are (35×34/2+18×17/2+23×22/2 = 1,001) pairwise alignments produced by CHSalign. Commonly used ways for evaluating the accuracy of these structural alignments include the calculation of distance matrices or RMSD (root-mean-square deviation) [<xref rid="pone.0147097.ref004" ref-type="bibr">4</xref>,<xref rid="pone.0147097.ref029" ref-type="bibr">29</xref>,<xref rid="pone.0147097.ref032" ref-type="bibr">32</xref>,<xref rid="pone.0147097.ref063" ref-type="bibr">63</xref>–<xref rid="pone.0147097.ref066" ref-type="bibr">66</xref>]. We adopt the RMSD measure [<xref rid="pone.0147097.ref004" ref-type="bibr">4</xref>,<xref rid="pone.0147097.ref029" ref-type="bibr">29</xref>] to evaluate the performance of our algorithms; specifically we use the method for computing RMSDs of tree graphs [<xref rid="pone.0147097.ref004" ref-type="bibr">4</xref>]. It has been shown that RMSDs of tree graphs and RMSDs of atomic models are positively correlated and indicate similar trends [<xref rid="pone.0147097.ref004" ref-type="bibr">4</xref>]. The average of the RMSD values of the 1,001 pairwise alignments was calculated and plotted.</p>
      <p>One important parameter in our algorithms is the weight <italic>w</italic> used in <xref ref-type="disp-formula" rid="pone.0147097.e005">Eq (3)</xref> for calculating the alignment score of two junction nodes. This parameter is introduced to favor the alignment between two junctions with the same number of branches and the same coaxial helical stacking status. Experimental results show that when <italic>w</italic> is sufficiently large (e.g., <italic>w</italic> &gt; 50), our algorithms work well. In subsequent experiments, we fixed the weight <italic>w</italic> in <xref ref-type="disp-formula" rid="pone.0147097.e005">Eq (3)</xref> at 100.</p>
      <p><xref ref-type="fig" rid="pone.0147097.g003">Fig 3</xref> compares CHSalign_u and CHSalign_p with three other alignment programs: RNAforester [<xref rid="pone.0147097.ref039" ref-type="bibr">39</xref>], RSmatch [<xref rid="pone.0147097.ref037" ref-type="bibr">37</xref>] and FOLDALIGN [<xref rid="pone.0147097.ref041" ref-type="bibr">41</xref>]. Like CHSalign, both RNAforester and RSmatch produce an alignment between two input RNA 2D structures. FOLDALIGN differs from the other programs in <xref ref-type="fig" rid="pone.0147097.g003">Fig 3</xref> in that it performs 2D structure prediction and alignment simultaneously. When running the FOLDALIGN tool, the structure information in the datasets was ignored and only the sequence data was used as the input of the tool. In addition, when experimenting with CHSalign_u, the coaxial stacking patterns were provided along with the input RNA 2D structures. When running the other programs including CHSalign_p, RNAforester, RSmatch and FOLDALIGN, these coaxial stacking patterns were absent in the input. CHSalign_p automatically predicts the coaxial stacking patterns and then aligns the predicted structures.</p>
      <fig id="pone.0147097.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0147097.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Comparison of the RMSD values obtained by CHSalign_u, CHSalign_p, RSmatch, RNAforester and FOLDALIGN.</title>
          <p>The RMSD values of CHSalign_u, CHSalign_p, RSmatch, RNAforester and FOLDALIGN are 1.78 Å, 1.83 Å, 4.41 Å, 6.13 Å and 8.26 Å, respectively. The proposed CHSalign method performs better than the existing alignment tools in terms of RMSD values.</p>
        </caption>
        <graphic xlink:href="pone.0147097.g003"/>
      </fig>
      <p><xref ref-type="fig" rid="pone.0147097.g003">Fig 3</xref> shows that CHSalign_u performs the best, achieving an RMSD of 1.78 Å. The drawback of CHSalign_u, however, is that it requires the user to annotate the input RNA structures with coaxial stacking patterns manually. Manually annotating coaxial stacking patterns on RNA structures requires domain related expertise. On the other hand, CHSalign_p does not require any manual processing and achieves a reasonably good RMSD of 1.83 Å. Since the predicted coaxial stacking patterns may be imperfect, the RMSD of CHSalign_p is larger than that of CHSalign_u. RSmatch and RNAforester have even larger RMSDs of 4.41 Å and 6.13 Å, respectively. This happens because RSmatch and RNAforester ignore coaxial stacking configurations when aligning RNA 2D structures. FOLDALIGN has the largest RMSD of 8.26 Å, partly because it does not consider coaxial helical stacking either, and partly because there are errors in its predicted 2D structures.</p>
    </sec>
    <sec id="sec010">
      <title>Performance evaluation using precision</title>
      <p>In the next experiment, we adopt <italic>precision</italic> as the performance measure, defined below, to evaluate how junctions and coaxial stacking patterns are aligned by different programs using the 24 structures in Dataset1. We say a junction <italic>J</italic><sub>1</sub> in structure <italic>R</italic><sub>1</sub> is aligned with a junction <italic>J</italic><sub>2</sub> in structure <italic>R</italic><sub>2</sub>, or more precisely there is a junction alignment between <italic>J</italic><sub>1</sub> and <italic>J</italic><sub>2</sub>, if there exist a nucleotide <italic>n</italic><sub>1</sub> on a loop region of <italic>J</italic><sub>1</sub> and a nucleotide <italic>n</italic><sub>2</sub> on a loop region of <italic>J</italic><sub>2</sub> such that <italic>n</italic><sub>1</sub> is aligned with <italic>n</italic><sub>2</sub>. A junction alignment between <italic>J</italic><sub>1</sub> and <italic>J</italic><sub>2</sub> is a true positive if <italic>J</italic><sub>1</sub> and <italic>J</italic><sub>2</sub> have the same number of branches and the same coaxial helical stacking status. A junction alignment between <italic>J</italic><sub>1</sub> and <italic>J</italic><sub>2</sub> is a false positive if <italic>J</italic><sub>1</sub> and <italic>J</italic><sub>2</sub> have different numbers of branches or different coaxial helical stacking statuses. The precision (PR) of an alignment between <italic>R</italic><sub>1</sub> and <italic>R</italic><sub>2</sub> is defined as
<disp-formula id="pone.0147097.e022"><alternatives><graphic xlink:href="pone.0147097.e022.jpg" id="pone.0147097.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mrow><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(13)</label></disp-formula>
where <italic>TP</italic> equals the number of true positives and <italic>FP</italic> equals the number of false positives in the alignment. The higher PR value a program has, the more precise alignment that program produces. In the experiment, we also included a closely related RNA 3D alignment tool (SETTER) [<xref rid="pone.0147097.ref031" ref-type="bibr">31</xref>].</p>
      <p>We calculated the precision of each alignment produced by a program, took the average of the precision values of the pairwise alignments of the 24 structures in Dataset1, and plotted the average values. <xref ref-type="fig" rid="pone.0147097.g004">Fig 4</xref> shows the result. We see that CHSalign_u performs the best, achieving a PR value of 1. CHSalign_p achieves a PR value of 0.85, not 1, because some coaxial stacking patterns were not predicted correctly by Junction-Explorer [<xref rid="pone.0147097.ref025" ref-type="bibr">25</xref>] used in CHSalign_p. The other programs in <xref ref-type="fig" rid="pone.0147097.g004">Fig 4</xref> did not consider coaxial helical stacking while performing pairwise alignments, and hence achieved low PR values. Specifically, the PR values of RNAforester, SETTER, RSmatch, and FOLDALIGN were 0.54, 0.42, 0.33, and 0.31 respectively. Unlike the CHSalign method, these programs occasionally align two junctions with different numbers of branches or different coaxial helical stacking statuses, hence yielding false positives. However, SETTER is a general-purpose structure alignment tool capable of comparing two RNA 3D molecules with diverse tertiary motifs, while CHSalign can only deal with the 2D structures of the 3D molecules that contain coaxial helical stacking motifs.</p>
      <fig id="pone.0147097.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0147097.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Comparison of the PR values obtained by CHSalign_u, CHSalign_p, RNAforester, SETTER, RSmatch and FOLDALIGN.</title>
          <p>The PR values, as defined in <xref ref-type="disp-formula" rid="pone.0147097.e022">Eq (13)</xref>, of CHSalign_u, CHSalign_p, RNAforester, SETTER, RSmatch and FOLDALIGN are 1, 0.85, 0.54, 0.42, 0.33 and 0.31, respectively. The proposed CHSalign method performs better than the existing alignment tools in terms of PR values.</p>
        </caption>
        <graphic xlink:href="pone.0147097.g004"/>
      </fig>
    </sec>
    <sec id="sec011">
      <title>Potential application of CHSalign</title>
      <p>To demonstrate the utility of the CHSalign tool, we applied CHSalign to the analysis of riboswitches that regulate gene expression by selectively binding metabolites [<xref rid="pone.0147097.ref067" ref-type="bibr">67</xref>]. <xref rid="pone.0147097.t002" ref-type="table">Table 2</xref> lists six riboswitches that bind to different metabolites (purine, guanine, thiamine pyrophosphate [TPP], and S-Adenosyl methionine [SAM]) found in different organisms. Since such binding and gene regulation activities are correlated to junction structures, the results of junction alignments could help suggest structural similarity (and thus possibly function) of these riboswitches. For each riboswitch, <xref rid="pone.0147097.t002" ref-type="table">Table 2</xref> also lists the junction type and coaxial helical stacking status within the junction in that riboswitch. <xref ref-type="fig" rid="pone.0147097.g005">Fig 5</xref> illustrates the coaxial stacking patterns in the six riboswitches. We tested several combinations of junctions in these six riboswitches to determine whether the CHSalign results confirm known structural and functional similarity in existing RNAs. <xref rid="pone.0147097.t003" ref-type="table">Table 3</xref> summarizes the test results. Details of these results, including the input and output of each test, can be found in <xref ref-type="supplementary-material" rid="pone.0147097.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pone.0147097.s002">S2</xref> Files.</p>
      <table-wrap id="pone.0147097.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0147097.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>The six riboswitches selected from the Protein Data Bank (PDB) to demonstrate the utility of our web server.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0147097.t002g" xlink:href="pone.0147097.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">PDB Code</th>
                <th align="center" rowspan="1" colspan="1">Molecule Name</th>
                <th align="center" rowspan="1" colspan="1">Length</th>
                <th align="center" rowspan="1" colspan="1">Junction</th>
                <th align="center" rowspan="1" colspan="1">CHS</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">2G9C</td>
                <td align="left" rowspan="1" colspan="1">Artificial purine riboswitch</td>
                <td align="center" rowspan="1" colspan="1">68</td>
                <td align="center" rowspan="1" colspan="1">3-way</td>
                <td align="center" rowspan="1" colspan="1">H<sub>1</sub>H<sub>3</sub></td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">3RKF</td>
                <td align="left" rowspan="1" colspan="1">Artificial guanine riboswitch</td>
                <td align="center" rowspan="1" colspan="1">68</td>
                <td align="center" rowspan="1" colspan="1">3-way</td>
                <td align="center" rowspan="1" colspan="1">H<sub>1</sub>H<sub>3</sub></td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="center" rowspan="1" colspan="1">3D2G</td>
                <td align="left" rowspan="1" colspan="1"><italic>A</italic>. <italic>thaliana</italic> TPP riboswitch</td>
                <td align="center" rowspan="1" colspan="1">77</td>
                <td align="center" rowspan="1" colspan="1">3-way</td>
                <td align="center" rowspan="1" colspan="1">H<sub>1</sub>H<sub>2</sub></td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="center" rowspan="1" colspan="1">2GDI</td>
                <td align="left" rowspan="1" colspan="1"><italic>E</italic>. <italic>coli</italic> TPP riboswitch</td>
                <td align="center" rowspan="1" colspan="1">80</td>
                <td align="center" rowspan="1" colspan="1">3-way</td>
                <td align="center" rowspan="1" colspan="1">H<sub>1</sub>H<sub>2</sub></td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="center" rowspan="1" colspan="1">2GIS</td>
                <td align="left" rowspan="1" colspan="1"><italic>T</italic>. <italic>tengcongensis</italic> SAM-I riboswitch</td>
                <td align="center" rowspan="1" colspan="1">95</td>
                <td align="center" rowspan="1" colspan="1">4-way</td>
                <td align="center" rowspan="1" colspan="1">H<sub>1</sub>H<sub>4</sub> H<sub>2</sub>H<sub>3</sub></td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">4B5R</td>
                <td align="left" rowspan="1" colspan="1"><italic>H</italic>. <italic>marismortui</italic> SAM-I riboswitch</td>
                <td align="center" rowspan="1" colspan="1">95</td>
                <td align="center" rowspan="1" colspan="1">4-way</td>
                <td align="center" rowspan="1" colspan="1">H<sub>1</sub>H<sub>4</sub> H<sub>2</sub>H<sub>3</sub></td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <table-wrap id="pone.0147097.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0147097.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Results obtained by aligning seven pairs of riboswitches from <xref rid="pone.0147097.t002" ref-type="table">Table 2</xref>.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0147097.t003g" xlink:href="pone.0147097.t003"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Program</th>
                <th align="center" rowspan="1" colspan="1">Molecule 1</th>
                <th align="center" rowspan="1" colspan="1">Molecule 2</th>
                <th align="center" rowspan="1" colspan="1">Alignment Score</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">CHSalign_p</td>
                <td align="center" rowspan="1" colspan="1">2GIS <italic>T</italic>. <italic>tengcongensis</italic> SAM-I riboswitch (H<sub>1</sub>H<sub>4,</sub> H<sub>2</sub>H<sub>3</sub>)</td>
                <td align="center" rowspan="1" colspan="1">4B5R <italic>H</italic>. <italic>marismortui</italic> SAM-I riboswitch (H<sub>1</sub>H<sub>4,</sub> H<sub>2</sub>H<sub>3</sub>)</td>
                <td align="char" char="." rowspan="1" colspan="1">252.61</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">CHSalign_p</td>
                <td align="center" rowspan="1" colspan="1">2G9C Artificial purine riboswitch (H<sub>1</sub>H<sub>3</sub>)</td>
                <td align="center" rowspan="1" colspan="1">3RKF Artificial guanine riboswitch (H<sub>1</sub>H<sub>3</sub>)</td>
                <td align="char" char="." rowspan="1" colspan="1">179.68</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">CHSalign_p</td>
                <td align="center" rowspan="1" colspan="1">2GDI <italic>E</italic>. <italic>coli</italic> TPP riboswitch (H<sub>1</sub>H<sub>2</sub>)</td>
                <td align="center" rowspan="1" colspan="1">3D2G <italic>A</italic>. <italic>thaliana</italic> TPP riboswitch (H<sub>1</sub>H<sub>2</sub>)</td>
                <td align="char" char="." rowspan="1" colspan="1">191.06</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">CHSalign_p</td>
                <td align="center" rowspan="1" colspan="1">2GIS <italic>T</italic>. <italic>tengcongensis</italic> SAM-I riboswitch (H<sub>1</sub>H<sub>4,</sub> H<sub>2</sub>H<sub>3</sub>)</td>
                <td align="center" rowspan="1" colspan="1">2G9C Artificial purine riboswitch (H<sub>1</sub>H<sub>3</sub>)</td>
                <td align="char" char="." rowspan="1" colspan="1">20.40</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">CHSalign_p</td>
                <td align="center" rowspan="1" colspan="1">2G9C Artificial purine riboswitch (H<sub>1</sub>H<sub>3</sub>)</td>
                <td align="center" rowspan="1" colspan="1">2GDI <italic>E</italic>. <italic>coli</italic> TPP riboswitch (H<sub>1</sub>H<sub>2</sub>)</td>
                <td align="char" char="." rowspan="1" colspan="1">13.65</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">CHSalign_u</td>
                <td align="center" rowspan="1" colspan="1">2G9C Artificial purine riboswitch (H<sub>1</sub>H<sub>3</sub>)</td>
                <td align="center" rowspan="1" colspan="1">2G9C Artificial purine riboswitch (H<sub>1</sub>H<sub>2</sub>)</td>
                <td align="char" char="." rowspan="1" colspan="1">36.69</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">CHSalign_u</td>
                <td align="center" rowspan="1" colspan="1">2G9C Artificial purine riboswitch (H<sub>1</sub>H<sub>2</sub>)</td>
                <td align="center" rowspan="1" colspan="1">3RKF Artificial guanine riboswitch (H<sub>1</sub>H<sub>2</sub>)</td>
                <td align="char" char="." rowspan="1" colspan="1">179.68</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <fig id="pone.0147097.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0147097.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Illustration of the coaxial stacking patterns in the six riboswitches used to demonstrate the utility of our web server.</title>
          <p>(A) Artificial purine riboswitch (PDB code: 2G9C) with a three-way junction and a CHS motif of type H<sub>1</sub>H<sub>3</sub> in the junction. (B) Artificial guanine riboswitch (PDB code: 3RKF) with a three-way junction and a CHS motif of type H<sub>1</sub>H<sub>3</sub> in the junction. (C) <italic>A</italic>. <italic>thaliana</italic> TPP riboswitch (PDB code: 3D2G) with a three-way junction and a CHS motif of type H<sub>1</sub>H<sub>2</sub> in the junction. (D) <italic>E</italic>. <italic>coli</italic> TPP riboswitch (PDB code: 2GDI) with a three-way junction and a CHS motif of type H<sub>1</sub>H<sub>2</sub> in the junction. (E) <italic>T</italic>. <italic>tengcongensis</italic> SAM-I riboswitch (PDB code: 2GIS) with a four-way junction and a CHS motif of type H<sub>1</sub>H<sub>4</sub>, H<sub>2</sub>H<sub>3</sub> in the junction. (F) <italic>H</italic>. <italic>marismortui</italic> SAM-I riboswitch (PDB code: 4B5R) with a four-way junction and a CHS motif of type H<sub>1</sub>H<sub>4</sub>, H<sub>2</sub>H<sub>3</sub> in the junction.</p>
        </caption>
        <graphic xlink:href="pone.0147097.g005"/>
      </fig>
      <p>Without knowledge of junction helical arrangements, we first tested the following cases using CHSalign_p, where the two aligned junctions had the same coaxial stacking patterns. We used SAM riboswitches in different organisms (PDB codes 2GIS and 4B5R in <xref rid="pone.0147097.t002" ref-type="table">Table 2</xref>) as input. CHSalign_p predicted that the two riboswitches had helical arrangements of four-way junctions both with coaxial stacking helices 1 and 4 and helices 2 and 3, and produced a very high alignment score of 252.61, as calculated by the equations in the subsection ‘Alignment scheme” in the section ‘Materials and Methods’. This high score implies that the two riboswitches have highly similar helical arrangements. This corroborates our expectations, because the two tested riboswitches have similar structures and functionality, binding to SAM. Next, when we used purine and guanine riboswitches (PDB codes 2G9C and 3RKF), we obtained a high alignment score of 179.68 for three-way junction alignment of the two riboswitches with predicted coaxial stacking of helices 1 and 3 in both riboswitches, indicating high similarities of their three-way junction structures. We also tested two TPP riboswitches with three-way junctions in different organisms (PDB codes 2GDI and 3D2G), which produced a high alignment score of 191.06, again indicating that these two TPP riboswitches have similar three-way junction structures.</p>
      <p>We next compared very different junction structures using CHSalign_p. When we aligned two different riboswitches—SAM riboswitch with a four-way junction and purine riboswitch with a three-way junction (PDB codes 2GIS and 2G9C, respectively), we obtained a low alignment score of 20.40. We also tested a pair of purine and TPP riboswitches (PDB codes 2G9C and 2GDI), which are in different riboswitch classes and have different coaxial stacking patterns in their three-way junctions. We obtained a low alignment score of 13.65. These experiments suggest that CHSalign_p, based only on secondary structural information, is useful for inferring tertiary structural features regarding helical arrangements.</p>
      <p>Finally, we tested CHSalign_u, which requires prior information about junction arrangement and produces a structural similarity score for two given RNAs. Here, we tested two cases. First, we considered the same RNA structure (purine riboswitch with PDB code 2G9C) but annotated it with different helical arrangement patterns where one had coaxial stacking helices 1 and 3 (H<sub>1</sub>H<sub>3</sub>) and the other had coaxial stacking helices 1 and 2 (H<sub>1</sub>H<sub>2</sub>). Second, we considered two RNAs with different structures (purine riboswitch with PDB code 2G9C and guanine riboswitch with PDB code 3RKF respectively) but annotated them with the same helical arrangement pattern, namely coaxial stacking helices 1 and 2 (H<sub>1</sub>H<sub>2</sub>). Note that this manually annotated H<sub>1</sub>H<sub>2</sub> pattern is different from the H<sub>1</sub>H<sub>3</sub> pattern that naturally occurs, and is also predicted by CHSalign_p, in the purine and guanine riboswitches.</p>
      <p>In the first case, the score produced by CHSalign_u was very low (36.69), due to the different helical arrangements. This result shows the large conformational range of structural arrangements that the purine riboswitch can have, from naturally preferable arrangements (H<sub>1</sub>H<sub>3</sub>, as predicted by CHSalign_p) to unnatural arrangements (H<sub>1</sub>H<sub>2</sub>, as manually set by us). In the second case, CHSalign_u produced a high score of 179.68, which indicates the possibility that two different RNA structures can have very similar helical arrangements when we manually set these arrangements. Thus, CHSalign_u could help investigate the structural diversity of all possible helical arrangements, including natural or hypothetical conformations for two RNA 2D structures.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec012">
    <title>Conclusions</title>
    <p>We have presented a novel method (CHSalign) capable of producing an optimal alignment between two input RNA secondary (2D) structures with coaxial helical stacking (CHS), based on our previously developed Junction-Explorer [<xref rid="pone.0147097.ref025" ref-type="bibr">25</xref>] and RNAJAG [<xref rid="pone.0147097.ref004" ref-type="bibr">4</xref>]. The method is junction-aware, CHS-favored in the sense that it assigns a weight to the alignment of two RNA junctions with the same number of branches and the same coaxial helical stacking status while prohibiting the alignment of two junctions that do not have the same number of branches or the same coaxial helical stacking status. The method transforms each input RNA 2D structure to an ordered labeled tree, and employs dynamic programming techniques and a constrained tree matching algorithm to align the two input RNA 2D structures. CHSalign has two versions; CHSalign_u requires the user to manually annotate the coaxial stacking patterns in the input structures while CHSalign_p automatically predicts the coaxial stacking patterns in the input structures. Experimental results demonstrate that both versions outperform the existing alignment programs that do not take into account coaxial stacking configurations in the input RNA structures.</p>
    <p>It has been observed that several functional RNA families such as tRNA, RNase P, and large ribosomal subunits have conserved structural features while having very diverse sequence patterns. RNA structure alignment tools such as CHSalign can help measure the structural similarity between these RNAs, even without sequence relevance in the RNAs. Similar RNA structural motifs are encountered on a variety of RNAs. While these motifs exist in different contexts, their functions are related. For instance, sarcin-ricin motifs often bind to proteins, and GNRA tetraloops act as receptors for RNA-RNA long-range interactions. Furthermore, examples of larger structure-function similarity are observed in the tRNA-like structure found in the transfer-messenger RNA (tmRNA), whose structure similarity with tRNA helps identify the functional role of tmRNAs to aid in translation via stalled ribosome rescue. Other tRNA-like structures found in viruses such as HIV and internal ribosome entry sites (IRES) mimic the 3D “L-shape” of tRNAs to take control of the host ribosome.</p>
    <p>As our knowledge on RNA structure progresses, more sophisticated secondary structure alignment tools are required that allow for comparison of tertiary motifs such as coaxial stacking patterns. Indeed, experimental probing techniques such as RNA SHAPE chemistry, SAXS, NMR, and fluorescence resonance energy transfer (FRET), can often provide sufficient information to determine coaxial helical stacking [<xref rid="pone.0147097.ref047" ref-type="bibr">47</xref>,<xref rid="pone.0147097.ref068" ref-type="bibr">68</xref>,<xref rid="pone.0147097.ref069" ref-type="bibr">69</xref>]. Because the structure and function of RNA are highly interrelated, a tool that addresses coaxial stacking patterns can assist the comparison of structures with high functional relevance.</p>
    <p>CHSalign is the first tool that can compute an RNA secondary structure alignment in the presence of coaxial helical stacking. When coaxial stacking configurations are available from experimental data such as FRET, NMR or SAXS data, the user can input such information to aid in the alignment. However, if no knowledge of coaxial stacking configurations is available, CHSalign can infer this information by employing Junction-Explorer [<xref rid="pone.0147097.ref025" ref-type="bibr">25</xref>], which predicts coaxial helical stacking with 81% accuracy.</p>
    <p>Existing RNA secondary structure alignment tools [<xref rid="pone.0147097.ref037" ref-type="bibr">37</xref>,<xref rid="pone.0147097.ref039" ref-type="bibr">39</xref>] do not distinguish between structural elements such as helices, junctions and hairpin loops. However, each element type has its special property and function. In contrast, CHSalign only matches structural elements of the same type. Furthermore, the tool imposes a constraint that a junction of RNA1 can be aligned with a junction of RNA2 only if they have the same number of branches and the same coaxial helical stacking status. We also implemented an extension of CHSalign, which relaxes this constraint. This extension is able to align two junctions with different numbers of branches and simply requires that coaxially stacked helices be aligned with coaxially stacked helices when matching a p-way junction with a q-way junction for p different than q. The source code of both CHSalign and its extension can be downloaded from the web server site.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec013">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0147097.s001">
      <label>S1 File</label>
      <caption>
        <title>Results obtained by aligning five pairs of riboswitches from <xref rid="pone.0147097.t002" ref-type="table">Table 2</xref> using CHSalign_p.</title>
        <p>For each pair of riboswitches, the input and output of the CHSalign_p program are displayed. The input includes two riboswitches in bpseq format. CHSalign_p invokes Junction-Explorer to predict coaxial helical stacking (CHS) motifs in the input molecules, and aligns the predicted structures. The output includes the CPU time spent in performing the alignment, the alignment score and alignment details.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pone.0147097.s001.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0147097.s002">
      <label>S2 File</label>
      <caption>
        <title>Results obtained by aligning two pairs of riboswitches from <xref rid="pone.0147097.t002" ref-type="table">Table 2</xref> using CHSalign_u.</title>
        <p>For each pair of riboswitches, the input and output of the CHSalign_u program are displayed. The input includes two riboswitches in bpseq format along with CHS motifs annotated manually by the user. The output includes the CPU time spent in performing the alignment, the alignment score and alignment details.</p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pone.0147097.s002.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to acknowledge Drs. Bruce Shapiro and Kaizhong Zhang for helpful conversations. We also thank Dongrong Wen and Akhila Nagula for their contributions in the early stage of this work. J.W. acknowledges support of this work by the National Science Foundation Grant IIS-0707571. T.S. acknowledges support of this work by the National Institute of General Medical Sciences Grants GM100469 and GM081410. Computing resources, utilized by the NYU team, of the Computational Center for Nanotechnology Innovations and Empire State Development's Division of Science, Technology and Innovation [through National Science Foundation (NSF) Group Award TG-MCB080036N] and the New York Center for Computational Sciences at Stony Brook University/Brookhaven National Laboratory (supported by Department of Energy Grant DE-AC02-98CH10886 and the State of New York) are gratefully acknowledged.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0147097.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Brimacombe</surname><given-names>R</given-names></name>, <name><surname>Stiege</surname><given-names>W</given-names></name> (<year>1985</year>) <article-title>Structure and function of ribosomal RNA</article-title>. <source>Biochem J</source>
<volume>229</volume>: <fpage>1</fpage>–<lpage>17</lpage>. <?supplied-pmid 3899100?><pub-id pub-id-type="pmid">3899100</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Woychik</surname><given-names>NA</given-names></name>, <name><surname>Hampsey</surname><given-names>M</given-names></name> (<year>2002</year>) <article-title>The RNA polymerase II machinery: structure illuminates function</article-title>. <source>Cell</source>
<volume>108</volume>: <fpage>453</fpage>–<lpage>463</lpage>. <?supplied-pmid 11909517?><pub-id pub-id-type="pmid">11909517</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Zhong</surname><given-names>X</given-names></name>, <name><surname>Tao</surname><given-names>X</given-names></name>, <name><surname>Stombaugh</surname><given-names>J</given-names></name>, <name><surname>Leontis</surname><given-names>N</given-names></name>, <name><surname>Ding</surname><given-names>B</given-names></name> (<year>2007</year>) <article-title>Tertiary structure and function of an RNA motif required for plant vascular entry to initiate systemic trafficking</article-title>. <source>EMBO J</source>
<volume>26</volume>: <fpage>3836</fpage>–<lpage>3846</lpage>. <?supplied-pmid 17660743?><pub-id pub-id-type="pmid">17660743</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Laing</surname><given-names>C</given-names></name>, <name><surname>Jung</surname><given-names>S</given-names></name>, <name><surname>Kim</surname><given-names>N</given-names></name>, <name><surname>Elmetwaly</surname><given-names>S</given-names></name>, <name><surname>Zahran</surname><given-names>M</given-names></name>, <name><surname>Schlick</surname><given-names>T</given-names></name> (<year>2013</year>) <article-title>Predicting helical topologies in RNA junctions as tree graphs</article-title>. <source>PLoS One</source>
<volume>8</volume>: <fpage>e71947</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0071947</pub-id>
<?supplied-pmid 23991010?><pub-id pub-id-type="pmid">23991010</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Bindewald</surname><given-names>E</given-names></name>, <name><surname>Hayes</surname><given-names>R</given-names></name>, <name><surname>Yingling</surname><given-names>YG</given-names></name>, <name><surname>Kasprzak</surname><given-names>W</given-names></name>, <name><surname>Shapiro</surname><given-names>BA</given-names></name> (<year>2008</year>) <article-title>RNAJunction: a database of RNA junctions and kissing loops for three-dimensional structural analysis and nanodesign</article-title>. <source>Nucleic Acids Res</source>
<volume>36</volume>: <fpage>D392</fpage>–<lpage>397</lpage>. <?supplied-pmid 17947325?><pub-id pub-id-type="pmid">17947325</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Ouellet</surname><given-names>J</given-names></name>, <name><surname>Melcher</surname><given-names>S</given-names></name>, <name><surname>Iqbal</surname><given-names>A</given-names></name>, <name><surname>Ding</surname><given-names>Y</given-names></name>, <name><surname>Lilley</surname><given-names>DM</given-names></name> (<year>2010</year>) <article-title>Structure of the three-way helical junction of the hepatitis C virus IRES element</article-title>. <source>RNA</source>
<volume>16</volume>: <fpage>1597</fpage>–<lpage>1609</lpage>. <pub-id pub-id-type="doi">10.1261/rna.2158410</pub-id>
<?supplied-pmid 20581129?><pub-id pub-id-type="pmid">20581129</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Lilley</surname><given-names>DM</given-names></name>, <name><surname>Clegg</surname><given-names>RM</given-names></name>, <name><surname>Diekmann</surname><given-names>S</given-names></name>, <name><surname>Seeman</surname><given-names>NC</given-names></name>, <name><surname>Von Kitzing</surname><given-names>E</given-names></name>, <name><surname>Hagerman</surname><given-names>PJ</given-names></name> (<year>1995</year>) <article-title>A nomenclature of junctions and branchpoints in nucleic acids</article-title>. <source>Nucleic Acids Res</source>
<volume>23</volume>: <fpage>3363</fpage>–<lpage>3364</lpage>. <?supplied-pmid 16617514?><pub-id pub-id-type="pmid">16617514</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>L</given-names></name>, <name><surname>Chen</surname><given-names>SJ</given-names></name> (<year>2012</year>) <article-title>Coarse-grained prediction of RNA loop structures</article-title>. <source>PLoS One</source>
<volume>7</volume>: <fpage>e48460</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0048460</pub-id>
<?supplied-pmid 23144887?><pub-id pub-id-type="pmid">23144887</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Popovic</surname><given-names>M</given-names></name>, <name><surname>Nelson</surname><given-names>JD</given-names></name>, <name><surname>Schroeder</surname><given-names>KT</given-names></name>, <name><surname>Greenbaum</surname><given-names>NL</given-names></name> (<year>2012</year>) <article-title>Impact of base pair identity 5' to the spliceosomal branch site adenosine on branch site conformation</article-title>. <source>RNA</source>
<volume>18</volume>: <fpage>2093</fpage>–<lpage>2103</lpage>. <pub-id pub-id-type="doi">10.1261/rna.035782.112</pub-id>
<?supplied-pmid 23002123?><pub-id pub-id-type="pmid">23002123</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Yuan</surname><given-names>F</given-names></name>, <name><surname>Griffin</surname><given-names>L</given-names></name>, <name><surname>Phelps</surname><given-names>L</given-names></name>, <name><surname>Buschmann</surname><given-names>V</given-names></name>, <name><surname>Weston</surname><given-names>K</given-names></name>, <name><surname>Greenbaum</surname><given-names>NL</given-names></name> (<year>2007</year>) <article-title>Use of a novel Forster resonance energy transfer method to identify locations of site-bound metal ions in the U2-U6 snRNA complex</article-title>. <source>Nucleic Acids Res</source>
<volume>35</volume>: <fpage>2833</fpage>–<lpage>2845</lpage>. <?supplied-pmid 17430967?><pub-id pub-id-type="pmid">17430967</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Scott</surname><given-names>WG</given-names></name>, <name><surname>Murray</surname><given-names>JB</given-names></name>, <name><surname>Arnold</surname><given-names>JR</given-names></name>, <name><surname>Stoddard</surname><given-names>BL</given-names></name>, <name><surname>Klug</surname><given-names>A</given-names></name> (<year>1996</year>) <article-title>Capturing the structure of a catalytic RNA intermediate: the hammerhead ribozyme</article-title>. <source>Science</source>
<volume>274</volume>: <fpage>2065</fpage>–<lpage>2069</lpage>. <?supplied-pmid 8953035?><pub-id pub-id-type="pmid">8953035</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Batey</surname><given-names>RT</given-names></name>, <name><surname>Gilbert</surname><given-names>SD</given-names></name>, <name><surname>Montange</surname><given-names>RK</given-names></name> (<year>2004</year>) <article-title>Structure of a natural guanine-responsive riboswitch complexed with the metabolite hypoxanthine</article-title>. <source>Nature</source>
<volume>432</volume>: <fpage>411</fpage>–<lpage>415</lpage>. <?supplied-pmid 15549109?><pub-id pub-id-type="pmid">15549109</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Kieft</surname><given-names>JS</given-names></name>, <name><surname>Zhou</surname><given-names>K</given-names></name>, <name><surname>Grech</surname><given-names>A</given-names></name>, <name><surname>Jubin</surname><given-names>R</given-names></name>, <name><surname>Doudna</surname><given-names>JA</given-names></name> (<year>2002</year>) <article-title>Crystal structure of an RNA tertiary domain essential to HCV IRES-mediated translation initiation</article-title>. <source>Nat Struct Biol</source>
<volume>9</volume>: <fpage>370</fpage>–<lpage>374</lpage>. <?supplied-pmid 11927953?><pub-id pub-id-type="pmid">11927953</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Holbrook</surname><given-names>SR</given-names></name> (<year>2008</year>) <article-title>Structural principles from large RNAs</article-title>. <source>Annu Rev Biophys</source>
<volume>37</volume>: <fpage>445</fpage>–<lpage>464</lpage>. <pub-id pub-id-type="doi">10.1146/annurev.biophys.36.040306.132755</pub-id>
<?supplied-pmid 18573090?><pub-id pub-id-type="pmid">18573090</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Laing</surname><given-names>C</given-names></name>, <name><surname>Schlick</surname><given-names>T</given-names></name> (<year>2009</year>) <article-title>Analysis of four-way junctions in RNA structures</article-title>. <source>J Mol Biol</source>
<volume>390</volume>: <fpage>547</fpage>–<lpage>559</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmb.2009.04.084</pub-id>
<?supplied-pmid 19445952?><pub-id pub-id-type="pmid">19445952</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Cohen</surname><given-names>A</given-names></name>, <name><surname>Bocobza</surname><given-names>S</given-names></name>, <name><surname>Veksler</surname><given-names>I</given-names></name>, <name><surname>Gabdank</surname><given-names>I</given-names></name>, <name><surname>Barash</surname><given-names>D</given-names></name>, <name><surname>Aharoni</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Computational identification of three-way junctions in folded RNAs: a case study in Arabidopsis</article-title>. <source>In Silico Biol</source>
<volume>8</volume>: <fpage>105</fpage>–<lpage>120</lpage>. <?supplied-pmid 18928199?><pub-id pub-id-type="pmid">18928199</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Xin</surname><given-names>Y</given-names></name>, <name><surname>Laing</surname><given-names>C</given-names></name>, <name><surname>Leontis</surname><given-names>NB</given-names></name>, <name><surname>Schlick</surname><given-names>T</given-names></name> (<year>2008</year>) <article-title>Annotation of tertiary interactions in RNA structures reveals variations and correlations</article-title>. <source>RNA</source>
<volume>14</volume>: <fpage>2465</fpage>–<lpage>2477</lpage>. <pub-id pub-id-type="doi">10.1261/rna.1249208</pub-id>
<?supplied-pmid 18957492?><pub-id pub-id-type="pmid">18957492</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>SH</given-names></name>, <name><surname>Sussman</surname><given-names>JL</given-names></name>, <name><surname>Suddath</surname><given-names>FL</given-names></name>, <name><surname>Quigley</surname><given-names>GJ</given-names></name>, <name><surname>McPherson</surname><given-names>A</given-names></name>, <name><surname>Wang</surname><given-names>AH</given-names></name>, <etal>et al</etal> (<year>1974</year>) <article-title>The general structure of transfer RNA molecules</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>71</volume>: <fpage>4970</fpage>–<lpage>4974</lpage>. <?supplied-pmid 4612535?><pub-id pub-id-type="pmid">4612535</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Butcher</surname><given-names>SE</given-names></name>, <name><surname>Pyle</surname><given-names>AM</given-names></name> (<year>2011</year>) <article-title>The molecular interactions that stabilize RNA tertiary structure: RNA motifs, patterns, and networks</article-title>. <source>Acc Chem Res</source>
<volume>44</volume>: <fpage>1302</fpage>–<lpage>1311</lpage>. <pub-id pub-id-type="doi">10.1021/ar200098t</pub-id>
<?supplied-pmid 21899297?><pub-id pub-id-type="pmid">21899297</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Byron</surname><given-names>K</given-names></name>, <name><surname>Laing</surname><given-names>C</given-names></name>, <name><surname>Wen</surname><given-names>D</given-names></name>, <name><surname>Wang</surname><given-names>JTL</given-names></name> (<year>2013</year>) <article-title>A computational approach to finding RNA tertiary motifs in genomic sequences: a case study</article-title>. <source>Recent Pat DNA Gene Seq</source>
<volume>7</volume>: <fpage>115</fpage>–<lpage>122</lpage>. <?supplied-pmid 22974261?><pub-id pub-id-type="pmid">22974261</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>Walter</surname><given-names>AE</given-names></name>, <name><surname>Turner</surname><given-names>DH</given-names></name> (<year>1996</year>) <article-title>Thermodynamics of coaxially stacked helixes with GA and CC mismatches</article-title>. <source>Biochemistry</source>
<volume>35</volume>: <fpage>13753</fpage>–<lpage>13761</lpage>. <?supplied-pmid 8901517?><pub-id pub-id-type="pmid">8901517</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Aalberts</surname><given-names>DP</given-names></name>, <name><surname>Nandagopal</surname><given-names>N</given-names></name> (<year>2010</year>) <article-title>A two-length-scale polymer theory for RNA loop free energies and helix stacking</article-title>. <source>RNA</source>
<volume>16</volume>: <fpage>1350</fpage>–<lpage>1355</lpage>. <pub-id pub-id-type="doi">10.1261/rna.1831710</pub-id>
<?supplied-pmid 20504955?><pub-id pub-id-type="pmid">20504955</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Shapiro</surname><given-names>BA</given-names></name>, <name><surname>Zhang</surname><given-names>K</given-names></name> (<year>1990</year>) <article-title>Comparing multiple RNA secondary structures using tree comparisons</article-title>. <source>Comput Appl Biosci</source>
<volume>6</volume>: <fpage>309</fpage>–<lpage>318</lpage>. <?supplied-pmid 1701685?><pub-id pub-id-type="pmid">1701685</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Laing</surname><given-names>C</given-names></name>, <name><surname>Jung</surname><given-names>S</given-names></name>, <name><surname>Iqbal</surname><given-names>A</given-names></name>, <name><surname>Schlick</surname><given-names>T</given-names></name> (<year>2009</year>) <article-title>Tertiary motifs revealed in analyses of higher-order RNA junctions</article-title>. <source>J Mol Biol</source>
<volume>393</volume>: <fpage>67</fpage>–<lpage>82</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmb.2009.07.089</pub-id>
<?supplied-pmid 19660472?><pub-id pub-id-type="pmid">19660472</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Laing</surname><given-names>C</given-names></name>, <name><surname>Wen</surname><given-names>D</given-names></name>, <name><surname>Wang</surname><given-names>JTL</given-names></name>, <name><surname>Schlick</surname><given-names>T</given-names></name> (<year>2012</year>) <article-title>Predicting coaxial helical stacking in RNA junctions</article-title>. <source>Nucleic Acids Res</source>
<volume>40</volume>: <fpage>487</fpage>–<lpage>498</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkr629</pub-id>
<?supplied-pmid 21917853?><pub-id pub-id-type="pmid">21917853</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Berman</surname><given-names>HM</given-names></name>, <name><surname>Westbrook</surname><given-names>J</given-names></name>, <name><surname>Feng</surname><given-names>Z</given-names></name>, <name><surname>Gilliland</surname><given-names>G</given-names></name>, <name><surname>Bhat</surname><given-names>TN</given-names></name>, <name><surname>Weissig</surname><given-names>H</given-names></name>, <etal>et al</etal> (<year>2000</year>) <article-title>The Protein Data Bank</article-title>. <source>Nucleic Acids Res</source>
<volume>28</volume>: <fpage>235</fpage>–<lpage>242</lpage>. <?supplied-pmid 10592235?><pub-id pub-id-type="pmid">10592235</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Ferre</surname><given-names>F</given-names></name>, <name><surname>Ponty</surname><given-names>Y</given-names></name>, <name><surname>Lorenz</surname><given-names>WA</given-names></name>, <name><surname>Clote</surname><given-names>P</given-names></name> (<year>2007</year>) <article-title>DIAL: a web server for the pairwise alignment of two RNA three-dimensional structures using nucleotide, dihedral angle and base-pairing similarities</article-title>. <source>Nucleic Acids Res</source>
<volume>35</volume>: <fpage>W659</fpage>–<lpage>668</lpage>. <?supplied-pmid 17567620?><pub-id pub-id-type="pmid">17567620</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Capriotti</surname><given-names>E</given-names></name>, <name><surname>Marti-Renom</surname><given-names>MA</given-names></name> (<year>2009</year>) <article-title>SARA: a server for function annotation of RNA structures</article-title>. <source>Nucleic Acids Res</source>
<volume>37</volume>: <fpage>W260</fpage>–<lpage>265</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkp433</pub-id>
<?supplied-pmid 19483098?><pub-id pub-id-type="pmid">19483098</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Chang</surname><given-names>YF</given-names></name>, <name><surname>Huang</surname><given-names>YL</given-names></name>, <name><surname>Lu</surname><given-names>CL</given-names></name> (<year>2008</year>) <article-title>SARSA: a web tool for structural alignment of RNA using a structural alphabet</article-title>. <source>Nucleic Acids Res</source>
<volume>36</volume>: <fpage>W19</fpage>–<lpage>24</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkn327</pub-id>
<?supplied-pmid 18502774?><pub-id pub-id-type="pmid">18502774</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>CW</given-names></name>, <name><surname>Chen</surname><given-names>KT</given-names></name>, <name><surname>Lu</surname><given-names>CL</given-names></name> (<year>2010</year>) <article-title>iPARTS: an improved tool of pairwise alignment of RNA tertiary structures</article-title>. <source>Nucleic Acids Res</source>
<volume>38</volume>: <fpage>W340</fpage>–<lpage>347</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkq483</pub-id>
<?supplied-pmid 20507908?><pub-id pub-id-type="pmid">20507908</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Hoksza</surname><given-names>D</given-names></name>, <name><surname>Svozil</surname><given-names>D</given-names></name> (<year>2012</year>) <article-title>Efficient RNA pairwise structure comparison by SETTER method</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>1858</fpage>–<lpage>1864</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts301</pub-id>
<?supplied-pmid 22611129?><pub-id pub-id-type="pmid">22611129</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Sarver</surname><given-names>M</given-names></name>, <name><surname>Zirbel</surname><given-names>CL</given-names></name>, <name><surname>Stombaugh</surname><given-names>J</given-names></name>, <name><surname>Mokdad</surname><given-names>A</given-names></name>, <name><surname>Leontis</surname><given-names>NB</given-names></name> (<year>2008</year>) <article-title>FR3D: finding local and composite recurrent structural motifs in RNA 3D structures</article-title>. <source>J Math Biol</source>
<volume>56</volume>: <fpage>215</fpage>–<lpage>252</lpage>. <?supplied-pmid 17694311?><pub-id pub-id-type="pmid">17694311</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Dror</surname><given-names>O</given-names></name>, <name><surname>Nussinov</surname><given-names>R</given-names></name>, <name><surname>Wolfson</surname><given-names>H</given-names></name> (<year>2005</year>) <article-title>ARTS: alignment of RNA tertiary structures</article-title>. <source>Bioinformatics</source>
<volume>21</volume>
<issue>Suppl 2</issue>: <fpage>ii47</fpage>–<lpage>53</lpage>. <?supplied-pmid 16204124?><pub-id pub-id-type="pmid">16204124</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Abraham</surname><given-names>M</given-names></name>, <name><surname>Dror</surname><given-names>O</given-names></name>, <name><surname>Nussinov</surname><given-names>R</given-names></name>, <name><surname>Wolfson</surname><given-names>HJ</given-names></name> (<year>2008</year>) <article-title>Analysis and classification of RNA tertiary structures</article-title>. <source>RNA</source>
<volume>14</volume>: <fpage>2274</fpage>–<lpage>2289</lpage>. <pub-id pub-id-type="doi">10.1261/rna.853208</pub-id>
<?supplied-pmid 18824509?><pub-id pub-id-type="pmid">18824509</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Rahrig</surname><given-names>RR</given-names></name>, <name><surname>Leontis</surname><given-names>NB</given-names></name>, <name><surname>Zirbel</surname><given-names>CL</given-names></name> (<year>2010</year>) <article-title>R3D Align: global pairwise alignment of RNA 3D structures using local superpositions</article-title>. <source>Bioinformatics</source>
<volume>26</volume>: <fpage>2689</fpage>–<lpage>2697</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq506</pub-id>
<?supplied-pmid 20929913?><pub-id pub-id-type="pmid">20929913</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>G</given-names></name>, <name><surname>Steppi</surname><given-names>A</given-names></name>, <name><surname>Laborde</surname><given-names>J</given-names></name>, <name><surname>Srivastava</surname><given-names>A</given-names></name>, <name><surname>Zhao</surname><given-names>P</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name> (<year>2014</year>) <article-title>RASS: a web server for RNA alignment in the joint sequence-structure space</article-title>. <source>Nucleic Acids Res</source>
<volume>42</volume>: <fpage>W377</fpage>–<lpage>381</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gku429</pub-id>
<?supplied-pmid 24831547?><pub-id pub-id-type="pmid">24831547</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Wang</surname><given-names>JTL</given-names></name>, <name><surname>Hu</surname><given-names>J</given-names></name>, <name><surname>Tian</surname><given-names>B</given-names></name> (<year>2005</year>) <article-title>A method for aligning RNA secondary structures and its application to RNA motif detection</article-title>. <source>BMC Bioinformatics</source>
<volume>6</volume>: <fpage>89</fpage>
<?supplied-pmid 15817128?><pub-id pub-id-type="pmid">15817128</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Jiang</surname><given-names>T</given-names></name>, <name><surname>Lin</surname><given-names>G</given-names></name>, <name><surname>Ma</surname><given-names>B</given-names></name>, <name><surname>Zhang</surname><given-names>K</given-names></name> (<year>2002</year>) <article-title>A general edit distance between RNA structures</article-title>. <source>J Comput Biol</source>
<volume>9</volume>: <fpage>371</fpage>–<lpage>388</lpage>. <?supplied-pmid 12015887?><pub-id pub-id-type="pmid">12015887</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Hochsmann</surname><given-names>M</given-names></name>, <name><surname>Voss</surname><given-names>B</given-names></name>, <name><surname>Giegerich</surname><given-names>R</given-names></name> (<year>2004</year>) <article-title>Pure multiple RNA secondary structure alignments: a progressive profile approach</article-title>. <source>IEEE/ACM Trans Comput Biol Bioinform</source>
<volume>1</volume>: <fpage>53</fpage>–<lpage>62</lpage>. <?supplied-pmid 17048408?><pub-id pub-id-type="pmid">17048408</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>S</given-names></name>, <name><surname>Zhang</surname><given-names>K</given-names></name> (<year>2014</year>) <article-title>An improved algorithm for tree edit distance with applications for RNA secondary structure comparison</article-title>. <source>J Comb Optim</source>
<volume>27</volume>: <fpage>778</fpage>–<lpage>797</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0147097.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Havgaard</surname><given-names>JH</given-names></name>, <name><surname>Torarinsson</surname><given-names>E</given-names></name>, <name><surname>Gorodkin</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>Fast pairwise structural RNA alignments by pruning of the dynamical programming matrix</article-title>. <source>PLoS Comput Biol</source>
<volume>3</volume>: <fpage>1896</fpage>–<lpage>1908</lpage>. <?supplied-pmid 17937495?><pub-id pub-id-type="pmid">17937495</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Mathews</surname><given-names>DH</given-names></name>, <name><surname>Turner</surname><given-names>DH</given-names></name> (<year>2002</year>) <article-title>Dynalign: an algorithm for finding the secondary structure common to two RNA sequences</article-title>. <source>J Mol Biol</source>
<volume>317</volume>: <fpage>191</fpage>–<lpage>203</lpage>. <?supplied-pmid 11902836?><pub-id pub-id-type="pmid">11902836</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Sato</surname><given-names>K</given-names></name>, <name><surname>Kato</surname><given-names>Y</given-names></name>, <name><surname>Akutsu</surname><given-names>T</given-names></name>, <name><surname>Asai</surname><given-names>K</given-names></name>, <name><surname>Sakakibara</surname><given-names>Y</given-names></name> (<year>2012</year>) <article-title>DAFS: simultaneous aligning and folding of RNA sequences via dual decomposition</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>3218</fpage>–<lpage>3224</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts612</pub-id>
<?supplied-pmid 23060618?><pub-id pub-id-type="pmid">23060618</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Hamada</surname><given-names>M</given-names></name>, <name><surname>Sato</surname><given-names>K</given-names></name>, <name><surname>Kiryu</surname><given-names>H</given-names></name>, <name><surname>Mituyama</surname><given-names>T</given-names></name>, <name><surname>Asai</surname><given-names>K</given-names></name> (<year>2009</year>) <article-title>CentroidAlign: fast and accurate aligner for structured RNAs by maximizing expected sum-of-pairs score</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>3236</fpage>–<lpage>3243</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp580</pub-id>
<?supplied-pmid 19808876?><pub-id pub-id-type="pmid">19808876</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Meyer</surname><given-names>IM</given-names></name>, <name><surname>Miklos</surname><given-names>I</given-names></name> (<year>2007</year>) <article-title>SimulFold: simultaneously inferring RNA structures including pseudoknots, alignments, and trees using a Bayesian MCMC framework</article-title>. <source>PLoS Comput Biol</source>
<volume>3</volume>: <fpage>e149</fpage>
<?supplied-pmid 17696604?><pub-id pub-id-type="pmid">17696604</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Tabei</surname><given-names>Y</given-names></name>, <name><surname>Tsuda</surname><given-names>K</given-names></name>, <name><surname>Kin</surname><given-names>T</given-names></name>, <name><surname>Asai</surname><given-names>K</given-names></name> (<year>2006</year>) <article-title>SCARNA: fast and accurate structural alignment of RNA sequences by matching fixed-length stem fragments</article-title>. <source>Bioinformatics</source>
<volume>22</volume>: <fpage>1723</fpage>–<lpage>1729</lpage>. <?supplied-pmid 16690634?><pub-id pub-id-type="pmid">16690634</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Walter</surname><given-names>F</given-names></name>, <name><surname>Murchie</surname><given-names>AI</given-names></name>, <name><surname>Duckett</surname><given-names>DR</given-names></name>, <name><surname>Lilley</surname><given-names>DM</given-names></name> (<year>1998</year>) <article-title>Global structure of four-way RNA junctions studied using fluorescence resonance energy transfer</article-title>. <source>RNA</source>
<volume>4</volume>: <fpage>719</fpage>–<lpage>728</lpage>. <?supplied-pmid 9622130?><pub-id pub-id-type="pmid">9622130</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Hernandez-Verdun</surname><given-names>D</given-names></name>, <name><surname>Roussel</surname><given-names>P</given-names></name>, <name><surname>Thiry</surname><given-names>M</given-names></name>, <name><surname>Sirri</surname><given-names>V</given-names></name>, <name><surname>Lafontaine</surname><given-names>DL</given-names></name> (<year>2010</year>) <article-title>The nucleolus: structure/function relationship in RNA metabolism</article-title>. <source>Wiley Interdiscip Rev RNA</source>
<volume>1</volume>: <fpage>415</fpage>–<lpage>431</lpage>. <pub-id pub-id-type="doi">10.1002/wrna.39</pub-id>
<?supplied-pmid 21956940?><pub-id pub-id-type="pmid">21956940</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Bindewald</surname><given-names>E</given-names></name>, <name><surname>Wendeler</surname><given-names>M</given-names></name>, <name><surname>Legiewicz</surname><given-names>M</given-names></name>, <name><surname>Bona</surname><given-names>MK</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Pritt</surname><given-names>MJ</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Correlating SHAPE signatures with three-dimensional RNA structures</article-title>. <source>RNA</source>
<volume>17</volume>: <fpage>1688</fpage>–<lpage>1696</lpage>. <pub-id pub-id-type="doi">10.1261/rna.2640111</pub-id>
<?supplied-pmid 21752927?><pub-id pub-id-type="pmid">21752927</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Jiang</surname><given-names>T</given-names></name>, <name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Zhang</surname><given-names>K</given-names></name> (<year>1995</year>) <article-title>Alignment of trees—an alternative to tree edit</article-title>. <source>Theoretical Computer Science</source>
<volume>143</volume>: <fpage>137</fpage>–<lpage>148</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0147097.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Zhao</surname><given-names>J</given-names></name> (<year>2003</year>) <article-title>Parametric alignment of ordered trees</article-title>. <source>Bioinformatics</source>
<volume>19</volume>: <fpage>2237</fpage>–<lpage>2245</lpage>. <?supplied-pmid 14630652?><pub-id pub-id-type="pmid">14630652</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>N</given-names></name>, <name><surname>Laing</surname><given-names>C</given-names></name>, <name><surname>Elmetwaly</surname><given-names>S</given-names></name>, <name><surname>Jung</surname><given-names>S</given-names></name>, <name><surname>Curuksu</surname><given-names>J</given-names></name>, <name><surname>Schlick</surname><given-names>T</given-names></name> (<year>2014</year>) <article-title>Graph-based sampling for approximating global helical topologies of RNA</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>111</volume>: <fpage>4079</fpage>–<lpage>4084</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1318893111</pub-id>
<?supplied-pmid 24591615?><pub-id pub-id-type="pmid">24591615</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>H</given-names></name>, <name><surname>Jossinet</surname><given-names>F</given-names></name>, <name><surname>Leontis</surname><given-names>N</given-names></name>, <name><surname>Chen</surname><given-names>L</given-names></name>, <name><surname>Westbrook</surname><given-names>J</given-names></name>, <name><surname>Berman</surname><given-names>H</given-names></name>, <etal>et al</etal> (<year>2003</year>) <article-title>Tools for the automatic identification and classification of RNA base pairs</article-title>. <source>Nucleic Acids Research</source>
<volume>31</volume>: <fpage>3450</fpage>–<lpage>3460</lpage>. <?supplied-pmid 12824344?><pub-id pub-id-type="pmid">12824344</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Shang</surname><given-names>L</given-names></name>, <name><surname>Xu</surname><given-names>W</given-names></name>, <name><surname>Ozer</surname><given-names>S</given-names></name>, <name><surname>Gutell</surname><given-names>RR</given-names></name> (<year>2012</year>) <article-title>Structural constraints identified with covariation analysis in ribosomal RNA</article-title>. <source>PLoS One</source>
<volume>7</volume>: <fpage>e39383</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0039383</pub-id>
<?supplied-pmid 22724009?><pub-id pub-id-type="pmid">22724009</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Klein</surname><given-names>RJ</given-names></name>, <name><surname>Eddy</surname><given-names>SR</given-names></name> (<year>2003</year>) <article-title>RSEARCH: finding homologs of single structured RNA sequences</article-title>. <source>BMC Bioinformatics</source>
<volume>4</volume>: <fpage>44</fpage>
<?supplied-pmid 14499004?><pub-id pub-id-type="pmid">14499004</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Gardner</surname><given-names>PP</given-names></name>, <name><surname>Wilm</surname><given-names>A</given-names></name>, <name><surname>Washietl</surname><given-names>S</given-names></name> (<year>2005</year>) <article-title>A benchmark of multiple sequence alignment programs upon structural RNAs</article-title>. <source>Nucleic Acids Res</source>
<volume>33</volume>: <fpage>2433</fpage>–<lpage>2439</lpage>. <?supplied-pmid 15860779?><pub-id pub-id-type="pmid">15860779</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Burge</surname><given-names>SW</given-names></name>, <name><surname>Daub</surname><given-names>J</given-names></name>, <name><surname>Eberhardt</surname><given-names>R</given-names></name>, <name><surname>Tate</surname><given-names>J</given-names></name>, <name><surname>Barquist</surname><given-names>L</given-names></name>, <name><surname>Nawrocki</surname><given-names>EP</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Rfam 11.0: 10 years of RNA families</article-title>. <source>Nucleic Acids Res</source>
<volume>41</volume>: <fpage>D226</fpage>–<lpage>232</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1005</pub-id>
<?supplied-pmid 23125362?><pub-id pub-id-type="pmid">23125362</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Andronescu</surname><given-names>M</given-names></name>, <name><surname>Bereg</surname><given-names>V</given-names></name>, <name><surname>Hoos</surname><given-names>HH</given-names></name>, <name><surname>Condon</surname><given-names>A</given-names></name> (<year>2008</year>) <article-title>RNA STRAND: the RNA secondary structure and statistical analysis database</article-title>. <source>BMC Bioinformatics</source>
<volume>9</volume>: <fpage>340</fpage>
<pub-id pub-id-type="doi">10.1186/1471-2105-9-340</pub-id>
<?supplied-pmid 18700982?><pub-id pub-id-type="pmid">18700982</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Smit</surname><given-names>S</given-names></name>, <name><surname>Rother</surname><given-names>K</given-names></name>, <name><surname>Heringa</surname><given-names>J</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name> (<year>2008</year>) <article-title>From knotted to nested RNA structures: a variety of computational methods for pseudoknot removal</article-title>. <source>RNA</source>
<volume>14</volume>: <fpage>410</fpage>–<lpage>416</lpage>. <pub-id pub-id-type="doi">10.1261/rna.881308</pub-id>
<?supplied-pmid 18230758?><pub-id pub-id-type="pmid">18230758</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Goody</surname><given-names>TA</given-names></name>, <name><surname>Lilley</surname><given-names>DM</given-names></name>, <name><surname>Norman</surname><given-names>DG</given-names></name> (<year>2004</year>) <article-title>The chirality of a four-way helical junction in RNA</article-title>. <source>J Am Chem Soc</source>
<volume>126</volume>: <fpage>4126</fpage>–<lpage>4127</lpage>. <?supplied-pmid 15053600?><pub-id pub-id-type="pmid">15053600</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Lafontaine</surname><given-names>DA</given-names></name>, <name><surname>Norman</surname><given-names>DG</given-names></name>, <name><surname>Lilley</surname><given-names>DM</given-names></name> (<year>2001</year>) <article-title>Structure, folding and activity of the VS ribozyme: importance of the 2-3-6 helical junction</article-title>. <source>EMBO J</source>
<volume>20</volume>: <fpage>1415</fpage>–<lpage>1424</lpage>. <?supplied-pmid 11250907?><pub-id pub-id-type="pmid">11250907</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Lescoute</surname><given-names>A</given-names></name>, <name><surname>Westhof</surname><given-names>E</given-names></name> (<year>2006</year>) <article-title>Topology of three-way junctions in folded RNAs</article-title>. <source>RNA</source>
<volume>12</volume>: <fpage>83</fpage>–<lpage>93</lpage>. <?supplied-pmid 16373494?><pub-id pub-id-type="pmid">16373494</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Zirbel</surname><given-names>CL</given-names></name>, <name><surname>Roll</surname><given-names>J</given-names></name>, <name><surname>Sweeney</surname><given-names>BA</given-names></name>, <name><surname>Petrov</surname><given-names>AI</given-names></name>, <name><surname>Pirrung</surname><given-names>M</given-names></name>, <name><surname>Leontis</surname><given-names>NB</given-names></name> (<year>2015</year>) <article-title>Identifying novel sequence variants of RNA 3D motifs</article-title>. <source>Nucleic Acids Research</source>
<volume>43</volume>: <fpage>7504</fpage>–<lpage>7520</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkv651</pub-id>
<?supplied-pmid 26130723?><pub-id pub-id-type="pmid">26130723</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Petrov</surname><given-names>AI</given-names></name>, <name><surname>Zirbel</surname><given-names>CL</given-names></name>, <name><surname>Leontis</surname><given-names>NB</given-names></name> (<year>2013</year>) <article-title>Automated classification of RNA 3D motifs and the RNA 3D Motif Atlas</article-title>. <source>RNA</source>
<volume>19</volume>: <fpage>1327</fpage>–<lpage>1340</lpage>. <pub-id pub-id-type="doi">10.1261/rna.039438.113</pub-id>
<?supplied-pmid 23970545?><pub-id pub-id-type="pmid">23970545</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Petrov</surname><given-names>AI</given-names></name>, <name><surname>Zirbel</surname><given-names>CL</given-names></name>, <name><surname>Leontis</surname><given-names>NB</given-names></name> (<year>2011</year>) <article-title>WebFR3D—a server for finding, aligning and analyzing recurrent RNA 3D motifs</article-title>. <source>Nucleic Acids Res</source>
<volume>39</volume>: <fpage>W50</fpage>–<lpage>55</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkr249</pub-id>
<?supplied-pmid 21515634?><pub-id pub-id-type="pmid">21515634</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Zirbel</surname><given-names>CL</given-names></name>, <name><surname>Sponer</surname><given-names>JE</given-names></name>, <name><surname>Sponer</surname><given-names>J</given-names></name>, <name><surname>Stombaugh</surname><given-names>J</given-names></name>, <name><surname>Leontis</surname><given-names>NB</given-names></name> (<year>2009</year>) <article-title>Classification and energetics of the base-phosphate interactions in RNA</article-title>. <source>Nucleic Acids Res</source>
<volume>37</volume>: <fpage>4898</fpage>–<lpage>4918</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkp468</pub-id>
<?supplied-pmid 19528080?><pub-id pub-id-type="pmid">19528080</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>N</given-names></name>, <name><surname>Zahran</surname><given-names>M</given-names></name>, <name><surname>Schlick</surname><given-names>T</given-names></name> (<year>2015</year>) <article-title>Computational prediction of riboswitch tertiary structures including pseudoknots by RAGTOP: a hierarchical graph sampling approach</article-title>. <source>Methods Enzymol</source>
<volume>553</volume>: <fpage>115</fpage>–<lpage>135</lpage>. <pub-id pub-id-type="doi">10.1016/bs.mie.2014.10.054</pub-id>
<?supplied-pmid 25726463?><pub-id pub-id-type="pmid">25726463</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>McGinnis</surname><given-names>JL</given-names></name>, <name><surname>Dunkle</surname><given-names>JA</given-names></name>, <name><surname>Cate</surname><given-names>JH</given-names></name>, <name><surname>Weeks</surname><given-names>KM</given-names></name> (<year>2012</year>) <article-title>The mechanisms of RNA SHAPE chemistry</article-title>. <source>J Am Chem Soc</source>
<volume>134</volume>: <fpage>6617</fpage>–<lpage>6624</lpage>. <pub-id pub-id-type="doi">10.1021/ja2104075</pub-id>
<?supplied-pmid 22475022?><pub-id pub-id-type="pmid">22475022</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0147097.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>S</given-names></name>, <name><surname>Parisien</surname><given-names>M</given-names></name>, <name><surname>Major</surname><given-names>F</given-names></name>, <name><surname>Roux</surname><given-names>B</given-names></name> (<year>2010</year>) <article-title>RNA structure determination using SAXS data</article-title>. <source>J Phys Chem B</source>
<volume>114</volume>: <fpage>10039</fpage>–<lpage>10048</lpage>. <pub-id pub-id-type="doi">10.1021/jp1057308</pub-id>
<?supplied-pmid 20684627?><pub-id pub-id-type="pmid">20684627</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
