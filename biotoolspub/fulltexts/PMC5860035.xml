<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860035</article-id>
    <article-id pub-id-type="pmid">28637183</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx404</article-id>
    <article-id pub-id-type="publisher-id">btx404</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Bioimage Informatics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NucliTrack: an integrated nuclei tracking application</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cooper</surname>
          <given-names>Sam</given-names>
        </name>
        <xref ref-type="aff" rid="btx404-aff1">1</xref>
        <xref ref-type="aff" rid="btx404-aff2">2</xref>
        <xref ref-type="corresp" rid="btx404-cor1"/>
        <!--<email>sam@socooper.com</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barr</surname>
          <given-names>Alexis R</given-names>
        </name>
        <xref ref-type="aff" rid="btx404-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Glen</surname>
          <given-names>Robert</given-names>
        </name>
        <xref ref-type="aff" rid="btx404-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bakal</surname>
          <given-names>Chris</given-names>
        </name>
        <xref ref-type="aff" rid="btx404-aff1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="btx404-aff1"><label>1</label>Division of Cancer Biology, The Institute of Cancer Research, London, UK</aff>
    <aff id="btx404-aff2"><label>2</label>Department of Computational Systems Medicine, Imperial College, South Kensington Campus, London, UK</aff>
    <author-notes>
      <corresp id="btx404-cor1">To whom correspondence should be addressed. Email: <email>sam@socooper.com</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-06-20">
      <day>20</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>20</issue>
    <fpage>3320</fpage>
    <lpage>3322</lpage>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>2</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>5</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>6</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx404.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Summary</title>
        <p>Live imaging studies give unparalleled insight into dynamic single cell behaviours and fate decisions. However, the challenge of reliably tracking single cells over long periods of time limits both the throughput and ease with which such studies can be performed. Here, we present NucliTrack, a cross platform solution for automatically segmenting, tracking and extracting features from fluorescently labelled nuclei. NucliTrack performs similarly to other state-of-the-art cell tracking algorithms, but NucliTrack’s interactive, graphical interface makes it significantly more user friendly.</p>
      </sec>
      <sec id="SA2">
        <title>Availability and implementation</title>
        <p>NucliTrack is available as a free, cross platform application and open source Python package. Installation details and documentation are at: <ext-link ext-link-type="uri" xlink:href="http://nuclitrack.readthedocs.io/en/latest">http://nuclitrack.readthedocs.io/en/latest</ext-link><underline>/</underline> A video guide can be viewed online: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=J6e0D9F-qSU">https://www.youtube.com/watch?v=J6e0D9F-qSU</ext-link> Source code is available through Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/samocooper/nuclitrack">https://github.com/samocooper/nuclitrack</ext-link>. A Matlab toolbox is also available at: <ext-link ext-link-type="uri" xlink:href="https://uk.mathworks.com/matlabcentral/fileexchange/61479-samocooper-nuclitrack-matlab">https://uk.mathworks.com/matlabcentral/fileexchange/61479-samocooper-nuclitrack-matlab</ext-link>.</p>
      </sec>
      <sec id="SA3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">BBSRC</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000268</named-content>
        </funding-source>
        <award-id>BB/M00354X/1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Live imaging studies are now allowing us to explore the previously shrouded world of mammalian cell signalling dynamics. For example, imaging populations of live single cells over several days has revealed how signalling dynamics can control key cell fate decisions (<xref rid="btx404-B4" ref-type="bibr">Cooper and Bakal, 2017</xref>). However, hindering the ease, time-periods and throughput with which live single-cell studies can be performed, are challenges in automatically tracking fluorescently labelled objects (cells, nuclei or organelles) accurately over time periods often exceeding several days, sometimes in highly motile cells (<xref rid="btx404-B2" ref-type="bibr">Cabantous <italic>et al.</italic>, 2005</xref>).</p>
    <p>To date, the majority of cell tracking software relies on ‘frame-to-frame linking’ of segmented nuclei or cells (<xref rid="btx404-B8" ref-type="bibr">Meijering <italic>et al.</italic>, 2012</xref>). In such methods, errors in segmentation, where, for example, either multiple nuclei are labelled as a single segment, or a nucleus is missed over several timeframes resulting in a tracking gap, can severely compromise tracking results. To handle such difficulties, global optimization methods have now been developed (<xref rid="btx404-B9" ref-type="bibr">Milan <italic>et al.</italic>, 2016</xref>). Yet, implementations of global optimization approaches to tracking in cell biology research have generally been limited to standalone packages, meaning that segmentation, track inspection and track correction have to be performed in other software which is non-trivial for scientists with little programming expertise (<xref rid="btx404-B5" ref-type="bibr">Hilsenbeck <italic>et al.</italic>, 2016</xref>). Therefore, we have developed NucliTrack an integrated Python package that allows efficient segmentation, feature extraction and tracking of fluorescently labelled nuclei or cells through an intuitive graphical interface (<xref ref-type="fig" rid="btx404-F1">Fig. 1</xref>). Additionally, the interface also includes tools for inspecting, correcting and exporting data on tracked nuclei.
</p>
    <fig id="btx404-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>The Nuclitrack application workflow: This figure shows the four main user interface windows used to track nuclei in Nuclitrack: (1) <italic>File loading</italic>: In this interface the user can browse files and load the time series imaging data, as well as selecting file names for storing tracking data; (2) <italic>Segmentation</italic>: The sliders on this interface allow the user to interactively choose segmentation parameters for identifying cell nuclei; (3) <italic>Training data selection</italic>: As tracking uses a probabilistic algorithm, examples of single nuclei, nuclei about to enter and exit mitosis, as well as incorrectly segmented nuclei must be given; (4) <italic>Track visualization, correction and export</italic>: In this interface the user can explore the tracking results, and view tracking data in the graph window. Additionally functions exist to correct tracks. Finally, the user can export single cell data from either all tracks or a subset of selected tracks</p>
      </caption>
      <graphic xlink:href="btx404f1"/>
    </fig>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>The identification and segmentation of fluorescently labelled objects in NucliTrack is based on marker controlled watershed segmentation, built with the scikit image Python library (<xref rid="btx404-B12" ref-type="bibr">van der Walt <italic>et al.</italic>, 2014</xref>). We utilized a novel Python application development library ‘Kivy’ to create an interface that allows users to interactively vary segmentation parameters (<xref rid="btx404-B11" ref-type="bibr">Virbel <italic>et al.</italic>, 2011</xref>). Once effective parameters are chosen, segmentation is then performed on the entire imaging sequence.</p>
    <p>In many types of image analysis workflows aimed at quantifying cellular phenotypes, the segmentation step can result in errors, which must be handled by tracking algorithms. Moreover, cells undergoing cell division must also be detected. To address this, we use a probabilistic approach described by Magnusson <italic>et al.</italic> to perform tracking (<xref rid="btx404-B6" ref-type="bibr">Magnusson <italic>et al.</italic>, 2015</xref>). This requires training data to be selected that contains examples of any erroneous segmentation, as well as normal, mitotic and post-mitotic cells. Training is performed within the user interface prior to tracking. The tracking algorithm then seeks to globally optimize the set of all tracks, by iteratively adding the highest scoring track given the current set of tracks. Tracks are scored with a cost function which penalizes large movements, gaps between frames, and passage through segments which are unlikely to be nuclei, whilst highly scoring tracks that minimize movement between frames, include few gaps and pass through segments likely to be nuclei. A dynamic programming technique is then used to find the highest scoring track that is added to the set of all tracks. Importantly, in identifying the highest scoring track, swaps with neighbouring tracks may be performed, thus minimizing the likelihood that a local, rather than a global, optimum is found.</p>
    <p>After successful tracking of objects, tracks can be edited within the user interface. Here, three windows showing: (i) colour-coded tracked segments; (ii) the original video; and (iii) feature values over the full length of a selected track (in the form of a line plot over time), allow the user to easily analyze and inspect tracks for errors, or anomalous results. Moreover, using a set of tools with keyboard hotkeys the user can efficiently navigate the video, manually correct errors in tracking, and add flags to mark specific events, before exporting results. Throughout NucliTrack we have also incorporated data management steps, such that intermediate steps are saved in the HDF5 file format, through the Python h5py package (<xref rid="btx404-B3" ref-type="bibr">Collette, 2013</xref>). Parameters are stored in a separate HDF5 file meaning that the segmentation and training stages can be skipped when analyzing subsequent movies. A function also exists in the Python package that accommodates for batch processing of videos using the HDF5 parameter file.</p>
    <p>To characterize the performance of the global optimization approach to automated cell tracking we tested NucliTrack against a benchmark set of fluorescently labelled nuclei videos (<xref rid="btx404-B7" ref-type="bibr">Maška <italic>et al.</italic>, 2014</xref>; <xref rid="btx404-B10" ref-type="bibr">Svoboda <italic>et al.</italic>, 2009</xref>). Here NucliTrack performed similarly to other global optimization approaches (<xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>). The performance of NucliTrack was limited by the more basic segmentation procedures we adopt, however we believe having an intuitive and interactive workflow is significantly more important for users with less technical expertise. Labeled images, segmented in alternative programs may also be imported in the file loading step.</p>
    <p>NucliTrack is an easy to use package for tracking and extracting data from fluorescently labelled cells or nuclei, in significantly higher throughput than manual tracking can achieve. Importantly, by allowing users to quickly inspect and correct tracking data, near 100% accuracy can be achieved, which is critical in quantifying cell fate decisions. For example, NucliTrack allowed us to study how DNA damage influences the proliferation-quiescence decision in thousands of cells, tracked for hundreds of frames, over multiple days (<xref rid="btx404-B1" ref-type="bibr">Barr <italic>et al.</italic>, 2017</xref>). Finally, by coupling established packages for data processing in Python, with more recent solutions to data management (h5py), graphical user interface development (kivy) and image processing (skimage), this software also provides an example of how user friendly, scientific software may be efficiently developed in an open source environment.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>S.C. is supported by the NIHR Imperial BRC, and the STRATiGRAD graduate training program. C.B. and A.R.B. are funded by a BBSRC Strategic LoLa grant [BB/M00354X/1], C.B. is also funded by a Cancer Research UK Programme Foundation Award [C37275/1A20146]. </p>
    <p><italic>Conflict of Interest:</italic> none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx404_nuclitrack_supplemental.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx404-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Barr</surname><given-names>A.R.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>DNA damage during S-phase mediates the proliferation-quiescence decision in the subsequent G1 via p21 expression</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>14728</fpage>.<pub-id pub-id-type="pmid">28317845</pub-id></mixed-citation>
    </ref>
    <ref id="btx404-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cabantous</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>Protein tagging and detection with engineered self-assembling fragments of GFP</article-title>. <source>Nat. Biotechnol</source>., <volume>23</volume>, <fpage>102</fpage>–<lpage>107</lpage>.<pub-id pub-id-type="pmid">15580262</pub-id></mixed-citation>
    </ref>
    <ref id="btx404-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Collette</surname><given-names>A.</given-names></name></person-group> (<year>2013</year>) Python and HDF5: Unlocking Scientific Data ‘O’Reilly Media’.</mixed-citation>
    </ref>
    <ref id="btx404-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cooper</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Bakal</surname><given-names>C.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Accelerating live single-cell signalling studies</article-title>. <source>Trends Biotechnol</source>, <volume>35</volume>, <fpage>422</fpage>–<lpage>433</lpage>.<pub-id pub-id-type="pmid">28161141</pub-id></mixed-citation>
    </ref>
    <ref id="btx404-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hilsenbeck</surname><given-names>O.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Software tools for single-cell tracking and quantification of cellular and molecular properties</article-title>. <source>Nat. Biotechnol</source>., <volume>34</volume>, <fpage>703</fpage>–<lpage>706</lpage>.<pub-id pub-id-type="pmid">27404877</pub-id></mixed-citation>
    </ref>
    <ref id="btx404-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Magnusson</surname><given-names>K.E.G.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Global linking of cell tracks using the Viterbi algorithm</article-title>. <source>IEEE Trans. Med. Imaging</source>, <volume>34</volume>, <fpage>911</fpage>–<lpage>929</lpage>.<pub-id pub-id-type="pmid">25415983</pub-id></mixed-citation>
    </ref>
    <ref id="btx404-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maška</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A benchmark for comparison of cell tracking algorithms</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1609</fpage>–<lpage>1617</lpage>.<pub-id pub-id-type="pmid">24526711</pub-id></mixed-citation>
    </ref>
    <ref id="btx404-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Meijering</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Methods for cell and particle tracking</article-title>. <source>Methods Enzymol</source>., <volume>504</volume>, <fpage>183</fpage>–<lpage>200</lpage>.<pub-id pub-id-type="pmid">22264535</pub-id></mixed-citation>
    </ref>
    <ref id="btx404-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Milan</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) MOT16: A Benchmark for Multi-Object Tracking. arXiv.</mixed-citation>
    </ref>
    <ref id="btx404-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Svoboda</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Generation of digital phantoms of cell nuclei and simulation of image formation in 3D image cytometry</article-title>. <source>Cytometry Part A</source>, <volume>75</volume>, <fpage>494</fpage>–<lpage>509</lpage>.</mixed-citation>
    </ref>
    <ref id="btx404-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Virbel</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) Kivy-A Framework for Rapid Creation of Innovative User Interfaces.</mixed-citation>
    </ref>
    <ref id="btx404-B12">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Van der Walt</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) scikit-image: image processing in Python.</mixed-citation>
    </ref>
  </ref-list>
</back>
