<?properties open_access?>
<?subarticle report70931?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000 Research Limited</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7492780</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.18776.2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Data Note</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RVDB-prot, a reference viral protein database and its HMM profiles</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 2; peer review: 2 approved]</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bigot</surname>
          <given-names>Thomas</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Temmam</surname>
          <given-names>Sarah</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3655-9220</contrib-id>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pérot</surname>
          <given-names>Philippe</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Eloit</surname>
          <given-names>Marc</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <aff id="a1"><label>1</label>Hub de Bioinformatique et Biostatistique – Département Biologie Computationnelle, Institut Pasteur, USR 3756 CNRS, Paris, France</aff>
      <aff id="a2"><label>2</label>Pathogen Discovery Laboratory, Institut Pasteur, Paris, 75015, France</aff>
      <aff id="a3"><label>3</label>École Nationale Vétérinaire d’Alfort, Maisons-Alfort, 94700, France</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:thomas.bigot@pasteur.fr">thomas.bigot@pasteur.fr</email>
      </corresp>
      <fn fn-type="COI-statement">
        <p>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>530</elocation-id>
    <history>
      <date date-type="accepted">
        <day>28</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2020 Bigot T et al.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="f1000research-8-29158.pdf"/>
    <abstract>
      <p>We present RVDB-prot, a database corresponding to the protein equivalent of the nucleic acid reference virus database RVDB. Protein databases can be helpful to perform more sensitive protein sequence comparisons. Similarly to its homologous public repository, RVDB-prot aims to provide reliable and accurately annotated unique entries, while including also an Hidden Markov Model (HMM) protein profiles database for distant protein searching.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>virus</kwd>
      <kwd>genomes</kwd>
      <kwd>proteins</kwd>
      <kwd>hmm</kwd>
      <kwd>clusters</kwd>
      <kwd>annotations</kwd>
      <kwd>database</kwd>
    </kwd-group>
    <funding-group>
      <funding-statement>The author(s) declared that no grants were involved in supporting this work.</funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec sec-type="version-changes">
      <label>Revised</label>
      <title>Amendments from Version 1</title>
      <p>This second version takes into account the comments of the reviewers. We also updated the metrics and the files available to reflect the version 19.0 of RVDB. The code of the pipeline itself was updated. In the introduction, we exemplified usages of the database, introduced UniProtKB virus database, and explained why the curation of RVDB is so important. In the methods, we detailed where the protein sequences coded by nucleic sequences are found. We specified that we used the default parameters of two programs used by the pipeline (Silix and HMMER). Regarding the database annotation, we clarified how each cluster is described, and we added a new feature: annotation keywords are not only gathered from sequences descriptions, but now also from PFAM clusters matching to the cluster sequences.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Sequence assignation often uses similarity criteria to infer homology, and hence taxonomy and / or protein function. In order to search for this, similarity, reliable, accurate and comprehensive databases are required. When trying to characterize sequences present in a metagenomics sample, searching first for related sequences in a viral database can lead to identify rapidly a known virus (high identity between the query sequence and the one in the database), or identify potential new species (low identity with any known sequence). Such hits must be further characterized on more comprehensive databases to increase the robustness of taxonomic assignations.</p>
    <p>In the specific field of viruses, several solutions are available but their ability to provide valid results is highly dependent on the goal of the study and on the available computer resources. Using a database with a high number of sequences, such as NCBI nr/nt may seem appropriate, but it implies an increased computation time and annotation quality is not always optimal. Similarly, UniProtKB
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup> contains numerous viral sequences (4 497 049 in total, including 17 008 (0.38%) reviewed) that could, as for NCBI/nr, increase computation time when thousands of sequences have to be analyzed concomitantly, which is routinely practiced in metagenomics analyses. RefSeq, on the other hand, is generally better curated but contains only full-length genomes, which reduces the diversity of available sequences, and also rarely includes the latest discoveries. RefSeq contains 13 180 virus sequences. Other specialized databases provide only specific groups of taxa for specific purposes, for instance, virus families responsible for infectious diseases like HIV or influenza viruses.</p>
    <p>Thus, the need for better, well-annotated and comprehensive public viral database that can be used for the identification of viruses by high-throughput sequencing led Goodacre
<italic>et al.</italic> to propose their Reference Viral DataBase (RVDB)
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup>. This database consists of a collection of all currently known viral genomes and virus-related nucleic sequences retrieved from NCBI/nr or RefSeq and includes a specific, both manual and computational reviewing process, as well as four updates of the contents per year. The reviewing process eliminates a great quantity of unwanted non-viral sequences like: cloning vectors, endogenous sequences, sequences that were wrongly annotated as virus but were actually of cellular origin, etc. This high level of curation makes RVDB quite attractive for the virology research community and in fact, in June 2020, version 19.0 was released.</p>
    <p>Since viral genomes mainly consist of coding sequences, the need for an equivalent reference database that provides the protein version of these sequences may prove quite advantageous.</p>
    <p>Indeed, protein sequences are useful when searching for distant homologs: their substitution rates are much lower than nucleic sequences. Additionally, proteins can also be efficiently clustered according to their similarity, and the resulting clusters can then be used to build Hidden Markov Model (HMM) profiles in order to identify more evolutionary distant proteins. In fact, programs like
<ext-link ext-link-type="uri" xlink:href="http://hmmer.org/">HMMER</ext-link>
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup> allow the building of HMM profiles from a multiple sequence alignment of proteins. This profile can then help recognizing proteins based on complex position-specific models of sequence conservation and evolution, and it does so in a more accurate way than if a classic sequence alignment is used.</p>
    <p>Therefore, we propose a protein sequence version of RVDB whose update will be synchronized with the original nucleotide RVDB release. Here we describe the conversion from the nucleotide version of RVDB to the protein version RVDB-prot, as well as the clustering process leading to the HMM profiles.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Conversion from RVDB nucleic database to RVDB-prot</title>
      <p>The current version of RVDB, v19.0
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup> consists of a collection of 3 084 319 nucleic sequences
<sup><xref rid="ref-2" ref-type="bibr"/></sup>. The accession numbers were extracted in order to gather the corresponding database entries in Genbank format. From these entries, the corresponding coding domain protein sequences, description, and protein accession numbers were automatically recognized and copied into the protein collection. The process relies on the amino-acid sequences and information provided initially in the nucleic entry annotations. The resulting protein file contains the nucleic sequence reference, for traceability purposes. The sequence names are formatted in the following way:</p>
      <p><monospace>&gt;acc|&lt;p_bank&gt;|&lt;p_acc&gt;|&lt;n_bank&gt;|&lt;n_acc&gt;|&lt;descr[sp]&gt;,</monospace> where:</p>
      <p><monospace>p_bank</monospace> is the bank in which the protein can be found</p>
      <p><monospace>p_acc</monospace> is the accession number corresponding to the protein sequence</p>
      <p><monospace>n_bank</monospace> is the bank in which the original nucleotide sequence was found</p>
      <p><monospace>n_acc</monospace> is the original information found in the nucleic database</p>
      <p><monospace>descr</monospace> is the description of the protein sequence as found in the database entry</p>
      <p><monospace>sp</monospace> is the species name.</p>
      <p>This process produces a 4 705 359 protein sequence file.</p>
    </sec>
    <sec>
      <title>Generation of HMM profiles</title>
      <p>The HMM generation rationale was inspired from vFam (the database of HMM profiles built from all the viral proteins present in RefSeq, discontinued from 2014)
<sup><xref rid="ref-5" ref-type="bibr">5</xref></sup>, but was entirely re-coded as a Snakemake pipeline
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup>, using different tools for some key steps (clustering, alignment). The proteins sequences were clustered with a 100% identity criterion to remove duplicates using
<ext-link ext-link-type="uri" xlink:href="http://weizhongli-lab.org/cd-hit/">CD-Hit</ext-link> 4.7.0
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup>. Then, the sequences were processed using
<ext-link ext-link-type="uri" xlink:href="http://weizhongli-lab.org/cd-hit/">Blast</ext-link> 2.2.26
<sup><xref rid="ref-8" ref-type="bibr">8</xref></sup> performing an all-against-all comparison. These comparisons allowed
<ext-link ext-link-type="uri" xlink:href="https://lbbe.univ-lyon1.fr/SiLiX">Silix</ext-link> 1.2.6
<sup><xref rid="ref-9" ref-type="bibr">9</xref></sup> (using default parameters) to define clusters of sequences according to their similarity. This step produced a text file in which each sequence was associated to one cluster. The information of each cluster (containing at least four sequences) was transformed into a fasta file containing all the sequences within the cluster. Then, sequences were aligned using
<ext-link ext-link-type="uri" xlink:href="https://mafft.cbrc.jp/alignment/software/">Mafft</ext-link> 7.023
<sup><xref rid="ref-10" ref-type="bibr">10</xref></sup> in auto mode. The multiple sequence alignments were processed by
<ext-link ext-link-type="uri" xlink:href="http://hmmer.org/">HMMER</ext-link> 3.2.1
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup> (hmmbuild, using default parameters) in order to obtain the HMM profiles. The HMM profiles were finally grouped into a single file.</p>
    </sec>
    <sec>
      <title>Annotation of HMM profiles</title>
      <p>A cluster is defined as a set of sequences, among which each sequence is characterized by its taxonomy (
<italic>i.e.</italic> a virus species) and eis associated with a description of its putative function, when it is known. In order to describe the different clusters, these information and other indicators (such as the cluster length and number of sequences) are combined into an annotation database, in SQLite format. The schema of this database is shown in
<xref ref-type="fig" rid="f1">Figure 1</xref>.</p>
      <fig fig-type="figure" id="f1" orientation="portrait" position="anchor">
        <label>Figure 1. </label>
        <caption>
          <title>Schema of the annotation database.</title>
        </caption>
        <graphic xlink:href="f1000research-8-29158-g0000"/>
      </fig>
      <p>The first type of data associated to a cluster is a set of keywords describing the putative function of the proteins present in a given cluster. These keywords correspond to the union of all names of the significant sequences found in
<ext-link ext-link-type="uri" xlink:href="https://pfam.xfam.org/">PFAM</ext-link>
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup> (with --cut_ga parameter which tells HMMER to trust the cutoff defined by PFAM) using all the sequences of the cluster as queries, weighted according to their frequencies, and excluding trivial words. We also produce a complementary word frequency count using sequence descriptions. These keywords are stored separately from the PFAM ones. Despite the fact that sequence descriptions can be vague or inaccurate, they are a good fallback in case the cluster had no match with any PFAM one.</p>
      <p>Here is an example of different keywords, using annotations from the cluster number 1, containing 18 sequences; the keywords and their frequencies from PFAM, are: RNA(58), viral(18), dependent(18), polymerase(18), helicase(17), cysteine(11), picorna(11); the first ten keywords from the sequence descriptions are: virus(17), protein(13), hypothetical(10), like(9), picorna(9), polyprotein(5), RNA(4), Wenzhou(4), Beihai(4), non-structural(2). Altogether, these keywords allow to describe a cluster composed of RNA-dependent RNA polymerase of picorna-like viruses. The complementarity of these two annotations is well illustrated here since the simple list of keywords would not have allowed to identify the function of this cluster (here the viral polymerase) without PFAM.</p>
      <p>In addition to the protein description, the database stores the virus taxonomy associated to all the taxa, referring to tNCBI TaxIDs. For each cluster, the taxonomic information is summarized by a Last Common Ancestor (LCA) that corresponds to the taxon in the tree of life to which all the sequence taxa belong; this LCA can be close to the root of the tree (Viruses), but is usually specific to a family.</p>
      <p>Finally, the database also provides the length (number of amino acids of the multiple sequences alignment) and the number of sequences in each cluster.</p>
      <p>This database is available in SQLite format, and to provide more direct access, flat text files are proposed. A text file for each cluster, identified with its cluster number, contains all the information related to it.</p>
    </sec>
  </sec>
  <sec>
    <title>Software availability</title>
    <p>The different steps explained above are performed using a Snakemake pipeline
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup>, available at Institut Pasteur’s Gitlab.</p>
    <list list-type="bullet">
      <list-item>
        <p>Pipeline available from
<ext-link ext-link-type="uri" xlink:href="https://gitlab.pasteur.fr/tbigot/rvdb-prot/">https://gitlab.pasteur.fr/tbigot/rvdb-prot/</ext-link>.</p>
      </list-item>
      <list-item>
        <p>Archived source code at time of publication:
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.4001989">https://doi.org/10.5281/zenodo.4001989</ext-link>
<sup><xref rid="ref-12" ref-type="bibr">12</xref></sup>
</p>
      </list-item>
      <list-item>
        <p>Licence: GNU GPL v3.0</p>
      </list-item>
    </list>
    <p>Several tools are needed to run the pipeline, including: Python, Mafft, Golden, HMMER, Snakemake, Silix, Blast+. The versions of these tools compatible with the pipeline are listed in the README file.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <sec>
      <title>Underlying data</title>
      <p>Database files are available at
<ext-link ext-link-type="uri" xlink:href="https://rvdb-prot.pasteur.fr/">https://rvdb-prot.pasteur.fr/</ext-link>. Release 19.0 described in this manuscript is also available from Zenodo.</p>
      <p>Zenodo: U-RVDBv19.0
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.4002051">https://doi.org/10.5281/zenodo.4002051</ext-link>
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup>.</p>
      <p>This project contains the following underlying data:</p>
      <list list-type="bullet">
        <list-item>
          <p>U-RVDBv19.0-prot.fasta (fasta file containing protein features of the original database: -prot.fasta)</p>
        </list-item>
        <list-item>
          <p>U-RVDBv19.0-prot.fasta-prot.hmm (the HMM profiles, generated with and for hmmer 3.2.1 (from 2019, 3.1b2 before))</p>
        </list-item>
        <list-item>
          <p>U-RVDBv19.0-prot.fasta-prot-hmm.sqlite (SQLite db containing annotations (please find a documentation below))</p>
        </list-item>
        <list-item>
          <p>U-RVDBv19.0-prot.fasta-annot.txt (a directory of annotations with plain text files (one per protein family))</p>
        </list-item>
      </list>
      <p>Data are available under the terms of the
<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/legalcode">Creative Commons Attribution 4.0 International license</ext-link> (CC-BY 4.0).</p>
      <p><xref rid="T1" ref-type="table">Table 1</xref> shows some summary metrics for the entries of this release and the different resources.</p>
      <table-wrap id="T1" orientation="portrait" position="anchor">
        <label>Table 1. </label>
        <caption>
          <title>Metrics for release 19.0.</title>
        </caption>
        <table frame="hsides" rules="groups" content-type="article-table">
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Nucleic sequences</td>
              <td align="center" rowspan="1" colspan="1">RVDB</td>
              <td align="right" rowspan="1" colspan="1">3 084 319</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Proteins</td>
              <td align="center" rowspan="1" colspan="1">RVDB-prot</td>
              <td align="right" rowspan="1" colspan="1">4 705 359</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Unique proteins</td>
              <td align="center" rowspan="1" colspan="1">RVDB-prot</td>
              <td align="right" rowspan="1" colspan="1">674 970</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Clusters</td>
              <td align="center" rowspan="1" colspan="1">RVDB-prot HMM</td>
              <td align="right" rowspan="1" colspan="1">13 201</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Updates are manually curated each time a new release of the main database (nucleic RVDB) is announced, i.e., four times a year. The following older versions are also available online: 18.0 (2020–03), 17.0 (2019–11), 16.0 (2019–06), 15.1 (2019–02), 14.0 (2018–09), 13.0 (2018–06), 12.2(2018–03), 11.5 (2017-–0), 10.2 (2017–04).</p>
      <p><bold>Usage</bold> HMMER can be used to search for all profiles in a fasta sequence file (sequences.fasta):
<monospace>hmmsearch U-RVDBv15.1-prot.fasta-prot.hmm sequences.fasta &gt; result.out.</monospace> Additional options are available in HMMER User’s Guide.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Peter Skewes-Cox, Jr., author of vFAM database for kindly providing his scripts which were an inspiration for the earlier versions of RVDB-prot. We thank Natalia Pietrosemoli for her help in the editing of the manuscript. This work used the computational and storage services (TARS cluster) provided by the IT department at Institut Pasteur, Paris.</p>
  </ack>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="journal"><collab>UniProt Consortium</collab>:
<article-title>UniProt: a worldwide hub of protein knowledge.</article-title><source><italic toggle="yes">Nucleic Acids Res.</italic></source><year>2019</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D506</fpage>–<lpage>D515</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gky1049</pub-id><!--<pub-id pub-id-type="pmcid">6323992</pub-id>--><?supplied-pmid 30395287?><pub-id pub-id-type="pmid">30395287</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodacre</surname><given-names>N</given-names></name><name><surname>Aljanahi</surname><given-names>A</given-names></name><name><surname>Nandakumar</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>A Reference Viral Database (RVDB) To Enhance Bioinformatics Analysis of High-Throughput Sequencing for Novel Virus Detection.</article-title><source><italic toggle="yes">mSphere.</italic></source><year>2018</year>;<volume>3</volume>(<issue>2</issue>): pii: e00069-18.
<pub-id pub-id-type="doi">10.1128/mSphereDirect.00069-18</pub-id><!--<pub-id pub-id-type="pmcid">5853486</pub-id>--><?supplied-pmid 29564396?><pub-id pub-id-type="pmid">29564396</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group>:
<article-title>Accelerated Profile HMM Searches.</article-title><source><italic toggle="yes">PLoS Comput Biol.</italic></source><year>2011</year>;<volume>7</volume>(<issue>10</issue>):<fpage>e1002195</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1002195</pub-id><!--<pub-id pub-id-type="pmcid">3197634</pub-id>--><?supplied-pmid 22039361?><pub-id pub-id-type="pmid">22039361</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bigot</surname><given-names>T</given-names></name><name><surname>Temmam</surname><given-names>S</given-names></name><name><surname>Pérot</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>RVDB-prot, a reference viral protein database and its HMM profiles.</article-title><source><italic toggle="yes">Zenodo.</italic></source>Fileset.<year>2020</year><pub-id pub-id-type="doi">10.5281/zenodo.4002051</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skewes-Cox</surname><given-names>P</given-names></name><name><surname>Sharpton</surname><given-names>TJ</given-names></name><name><surname>Pollard</surname><given-names>KS</given-names></name><etal/></person-group>:
<article-title>Profile hidden Markov models for the detection of viruses within metagenomic sequence data.</article-title><source><italic toggle="yes">PLoS One.</italic></source><year>2014</year>;<volume>9</volume>(<issue>8</issue>):<fpage>e105067</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0105067</pub-id><!--<pub-id pub-id-type="pmcid">4139300</pub-id>--><?supplied-pmid 25140992?><pub-id pub-id-type="pmid">25140992</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Köster</surname><given-names>J</given-names></name><name><surname>Rahmann</surname><given-names>S</given-names></name></person-group>:
<article-title>Snakemake--a scalable bioinformatics workflow engine.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>2012</year>;<volume>28</volume>(<issue>19</issue>):<fpage>2520</fpage>–<lpage>2522</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id><?supplied-pmid 22908215?><pub-id pub-id-type="pmid">22908215</pub-id></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Godzik</surname><given-names>A</given-names></name></person-group>:
<article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences.</article-title><source><italic toggle="yes">Bioinformatics.</italic></source><year>2006</year>;<volume>22</volume>(<issue>13</issue>):<fpage>1658</fpage>–<lpage>1659</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id><?supplied-pmid 16731699?><pub-id pub-id-type="pmid">16731699</pub-id></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Gish</surname><given-names>W</given-names></name><name><surname>Miller</surname><given-names>W</given-names></name><etal/></person-group>:
<article-title>Basic local alignment search tool.</article-title><source><italic toggle="yes">J Mol Biol.</italic></source><year>1990</year>;<volume>215</volume>(<issue>3</issue>):<fpage>403</fpage>–<lpage>410</lpage>.
<pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id><?supplied-pmid 2231712?><pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miele</surname><given-names>V</given-names></name><name><surname>Penel</surname><given-names>S</given-names></name><name><surname>Duret</surname><given-names>L</given-names></name></person-group>:
<article-title>Ultra-fast sequence clustering from similarity networks with SiLiX.</article-title><source><italic toggle="yes">BMC Bioinformatics.</italic></source><year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>116</fpage>.
<pub-id pub-id-type="doi">10.1186/1471-2105-12-116</pub-id><!--<pub-id pub-id-type="pmcid">3095554</pub-id>--><?supplied-pmid 21513511?><pub-id pub-id-type="pmid">21513511</pub-id></mixed-citation>
    </ref>
    <ref id="ref-10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katoh</surname><given-names>K</given-names></name><name><surname>Misawa</surname><given-names>K</given-names></name><name><surname>Kuma</surname><given-names>K</given-names></name><etal/></person-group>:
<article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform.</article-title><source><italic toggle="yes">Nucleic Acids Res.</italic></source><year>2002</year>;<volume>30</volume>(<issue>14</issue>):<fpage>3059</fpage>–<lpage>3066</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkf436</pub-id><!--<pub-id pub-id-type="pmcid">135756</pub-id>--><?supplied-pmid 12136088?><pub-id pub-id-type="pmid">12136088</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>El-Gebali</surname><given-names>S</given-names></name><name><surname>Mistry</surname><given-names> J</given-names></name><name><surname>Bateman</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>The Pfam protein families database in 2019.</article-title><source><italic toggle="yes">Nucleic Acids Res.</italic></source><year>2019</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D427</fpage>–<lpage>D432</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gky995</pub-id><!--<pub-id pub-id-type="pmcid">6324024</pub-id>--><?supplied-pmid 30357350?><pub-id pub-id-type="pmid">30357350</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bigot</surname><given-names>T</given-names></name></person-group>:
<article-title>RVDB-prot pipeline v19.0.1 (Version 15.1.0).</article-title><source><italic toggle="yes">Zenodo.</italic></source><year>2020</year><pub-id pub-id-type="doi">10.5281/zenodo.4001989</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report70931" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.29158.r70931</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Perriere</surname>
          <given-names>Guy</given-names>
        </name>
        <xref ref-type="aff" rid="r70931a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6850-6265</contrib-id>
      </contrib>
      <aff id="r70931a1"><label>1</label>Laboratoire de Biométrie et Biologie Evolutive, CNRS, UMR5558, Universite Claude Bernard - Lyon 1, Villeurbanne, 69622, France</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2020 Perriere G</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d38e1085" ext-link-type="doi" xlink:href="10.12688/f1000research.18776.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>I have no other comments to add as the authors adressed all the concerns I raised in my previous review.</p>
    <p>Are sufficient details of methods and materials provided to allow replication by others?</p>
    <p>Partly</p>
    <p>Is the rationale for creating the dataset(s) clearly described?</p>
    <p>Yes</p>
    <p>Are the datasets clearly presented in a useable and accessible format?</p>
    <p>Yes</p>
    <p>Are the protocols appropriate and is the work technically sound?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>Phylogeny, molecular evolution, comparative genomics, sequence databases</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report70930" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.29158.r70930</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>le Mercier</surname>
          <given-names>Philippe</given-names>
        </name>
        <xref ref-type="aff" rid="r70930a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8528-090X</contrib-id>
      </contrib>
      <aff id="r70930a1"><label>1</label>Swiss-Prot Group, CMU, Swiss Institute of Bioinformatics, Geneva, Switzerland</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2020 le Mercier P</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d38e1165" ext-link-type="doi" xlink:href="10.12688/f1000research.18776.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>No further comments.</p>
    <p>Are sufficient details of methods and materials provided to allow replication by others?</p>
    <p>Partly</p>
    <p>Is the rationale for creating the dataset(s) clearly described?</p>
    <p>Yes</p>
    <p>Are the datasets clearly presented in a useable and accessible format?</p>
    <p>Yes</p>
    <p>Are the protocols appropriate and is the work technically sound?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>Virus proteomics</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report47713" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20570.r47713</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Perriere</surname>
          <given-names>Guy</given-names>
        </name>
        <xref ref-type="aff" rid="r47713a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6850-6265</contrib-id>
      </contrib>
      <aff id="r47713a1"><label>1</label>Laboratoire de Biométrie et Biologie Evolutive, CNRS, UMR5558, Universite Claude Bernard - Lyon 1, Villeurbanne, 69622, France</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Perriere G</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d38e1245" ext-link-type="doi" xlink:href="10.12688/f1000research.18776.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>This is an interesting resource that can be of use for people dealing with comparative genomics in viruses. There are some points that need to be clarified before this paper can be indexed though.
<list list-type="order"><list-item><p>In order to ease reproducibility, the parameters used for the different programs (e.g. HMMER, SiLiX) of the pipeline should be provided.</p></list-item><list-item><p>Why is it required to locally translate the Coding DNA Sequences (CDS) from the original RVDB nucleotide database instead of downloading them from the resource?</p></list-item><list-item><p>I have a question for the taxonomic assignation to the Last Common Ancestor (LCA) when building the clusters. How are handled the possible contradictions within a cluster? More exactly, what is done exactly if sequences that belong to distantly related taxa are clustered together? If a strict LCA rule is applied, then it would be possible to have a really inprecise assignation (something like "virus" and that's it). </p></list-item></list>
</p>
    <p>Are sufficient details of methods and materials provided to allow replication by others?</p>
    <p>Partly</p>
    <p>Is the rationale for creating the dataset(s) clearly described?</p>
    <p>Yes</p>
    <p>Are the datasets clearly presented in a useable and accessible format?</p>
    <p>Yes</p>
    <p>Are the protocols appropriate and is the work technically sound?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>Phylogeny, molecular evolution, comparative genomics, sequence databases</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <sub-article id="comment5868-47713" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Bigot</surname>
            <given-names>Thomas</given-names>
          </name>
          <aff>Institut Pasteur, Paris, France</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>26</day>
        <month>8</month>
        <year>2020</year>
      </pub-date>
    </front-stub>
    <body>
      <p>We would like to thank the Reviewer. Please find below our line-by-line responses.</p>
      <p>
        <bold>In order to ease reproducibility, the parameters used for the different programs (e.g. HMMER, SiLiX) of the pipeline should be provided.</bold>
      </p>
      <p> Done. Parameters are now specified in the new version of the manuscript. Actually, for both of these programs, we use default parameters.</p>
      <p>
        <bold>Why is it required to locally translate the Coding DNA Sequences (CDS) from the original RVDB nucleotide database instead of downloading them from the resource?</bold>
      </p>
      <p> We have clarified this point in the new version: actually, we use translations provided in the entry of each nucleic sequence. They are provided in the raw data of the original database (Genbank, RefSeq) along with the accession number. What we do amounts to retrieve all protein sequences</p>
      <p> corresponding to a nucleic sequence from protein database with accession numbers, but doing it directly from the nucleic database is faster.</p>
      <p>
        <bold>I have a question for the taxonomic assignation to the Last Common Ancestor (LCA) when building the clusters. How are handled the possible contradictions within a cluster? More exactly, what is done exactly if sequences that belong to distantly related taxa are clustered together? If a strict LCA rule is applied, then it would be possible to have a really inprecise assignation (something like "virus" and that's it).</bold>
      </p>
      <p> Indeed, we use naïve LCA assignation, and it can lead to imprecise assignation (some clusters can be tagged as Viruses). As we do not have other information about the cluster we characterize, we chose not to avoid this possibility. We have added a precision about this case in the new version of the manuscript: “For each cluster, the taxonomic information is summarized by a Last Common Ancestor (LCA) that corresponds to the taxon in the tree of life to which all the sequence taxa belong;
<underline>this LCA can be close to the root of the tree (Viruses), but is usually specific to a family</underline>.”</p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report47715" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20570.r47715</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>le Mercier</surname>
          <given-names>Philippe</given-names>
        </name>
        <xref ref-type="aff" rid="r47715a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8528-090X</contrib-id>
      </contrib>
      <aff id="r47715a1"><label>1</label>Swiss-Prot Group, CMU, Swiss Institute of Bioinformatics, Geneva, Switzerland</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 le Mercier P</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d38e1403" ext-link-type="doi" xlink:href="10.12688/f1000research.18776.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>In this article, the authors present a RVDB-prot, a reference viral protein database and its HMM profiles. The purpose of this approach is providing a complete reference database of viral proteins to identify new sequences. Their database is based on nucleotide Reference Viral Database (RVDB). The rationale of this work  is that protein sequences can be better than nucleotides for searching distant homologs.</p>
    <p> In brief, their approach was as follows: RVDB database was converted to proteins, thereby creating a new dataset of 3,899,699 proteins. The protein were clustered, and these clusters used to create HMM. Words frequently present  in sequence names of a cluster were used to annotate HMM profiles. The software, pipeline and final database are all available.</p>
    <p> The final data are of good quality, will hopefully  be maintained along with RVDB and offer a new approach for protein virus reference.</p>
    <p> While the article is well written and the method is well described, there are a number of issues that need to be addressed:
<list list-type="bullet"><list-item><p>The database is described as facilitating sequence assignation. This seems a bit vague, a sentence describing possible applications could help. </p></list-item><list-item><p> The introduction may describe better the current state of research in the field. UniProtKB should be cited in “existing databases” for viral proteins, and authors may add citations of its use in virus detection. (ex: UniRef90 used with success to create synthetic human virome
<sup><xref rid="rep-ref-47715-1" ref-type="bibr">1</xref></sup> (PMID: 26045439)). This would also highlight new potential applications for RVDB-prot.  </p></list-item><list-item><p>UniProtKB provides data for 3,972,271 viral proteins, a bit more than RVDB-Prot (3,899,699). RVDB-prot data is based similarity gathering of sequences with viral RefSeq, which has the advantage to ignore any taxonomical issues. On the other hand, many RefSeq are provisional, and those are not free or errors. The authors may discuss the advantage of their method over existing protein dataset.</p></list-item><list-item><p> Similarly, UniRef90 contains 577,105 clusters of proteins, which could be compared to the 489,207 unique proteins of RVDB-prot. Further discussion may help understanding the advantages of these two datasets.  </p></list-item><list-item><p>The paper could provide more details on parameters used for defining clusters with Silix.</p></list-item></list>  </p>
    <p> Minor remark:</p>
    <p> The naming system may be perfected. Although imaginative and automatic, it seems to be limited. For example cluster 77 in the -prot-hmm-txt.zip (v 15.1) contains 398 sequences, which are obviously rep proteins for ssDNA viruses circo, gemini and their satellites, but the names fished out by author’s method are not clear. This can be problematic for sequence assignation.</p>
    <p> Keywords for cluster 77:</p>
    <p> protein 329</p>
    <p> replication 296</p>
    <p> virus 183</p>
    <p> alphasatellite 154</p>
    <p> associated 138</p>
    <p> putative 120</p>
    <p> viral 103</p>
    <p> CRESS 78</p>
    <p> leaf 50</p>
    <p> curl 49</p>
    <p> initiator 49</p>
    <p> Rep 41</p>
    <p> yellow 39</p>
    <p> Circoviridae 39</p>
    <p> Actually, the name used to create RVDB-pro keywords is not clearly defined. The name of GenBank protein entry are not very consistent and this may explain these problems. Maybe using pfam or any other method of identification over the clusters may help naming them in a more consistent way.</p>
    <p>Are sufficient details of methods and materials provided to allow replication by others?</p>
    <p>Partly</p>
    <p>Is the rationale for creating the dataset(s) clearly described?</p>
    <p>Yes</p>
    <p>Are the datasets clearly presented in a useable and accessible format?</p>
    <p>Yes</p>
    <p>Are the protocols appropriate and is the work technically sound?</p>
    <p>Yes</p>
    <p>Reviewer Expertise:</p>
    <p>Virus proteomics</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="rep-ref-47715-1">
        <label>1</label>
        <mixed-citation publication-type="journal">
:
<article-title>Viral immunology. Comprehensive serological profiling of human populations using a synthetic human virome.</article-title>
<source><italic toggle="yes">Science</italic></source>.<year>2015</year>;<volume>348</volume>(<issue>6239</issue>) :
<elocation-id>10.1126/science.aaa0698</elocation-id>
<fpage>aaa0698</fpage>
<pub-id pub-id-type="doi">10.1126/science.aaa0698</pub-id>
<?supplied-pmid 26045439?><pub-id pub-id-type="pmid">26045439</pub-id></mixed-citation>
      </ref>
    </ref-list>
  </back>
  <sub-article id="comment5867-47715" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Bigot</surname>
            <given-names>Thomas</given-names>
          </name>
          <aff>Institut Pasteur, Paris, France</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>26</day>
        <month>8</month>
        <year>2020</year>
      </pub-date>
    </front-stub>
    <body>
      <p>We would like to thank the Reviewer. Please find below our line-by-line responses.</p>
      <p>
        <bold>The database is described as facilitating sequence assignation. This seems a bit vague, a sentence describing possible applications could help.</bold>
      </p>
      <p> We have added the following sentence to exemplify possible applications: “When trying to characterize sequences present in a metagenomics sample, searching first for related sequences in a viral database can lead to identify rapidly a known virus (high identity between the query sequence and the one in the database), or identify potential new species (low identity with any known sequence). Such hits must be further characterized on more comprehensive databases to increase the robustness of taxonomic assignations.”</p>
      <p>
        <bold>The introduction may describe better the current state of research in the field. UniProtKB should be cited in “existing databases” for viral proteins, and authors may add citations of its use in virus detection. (ex: UniRef90 used with success to create synthetic human virome1 (PMID: 26045439)). This would also highlight new potential applications for RVDB-prot. UniProtKB provides data for 3,972,271 viral proteins, a bit more than RVDB-Prot (3,899,699). RVDB-prot data is based similarity gathering of sequences with viral RefSeq, which has the advantage to ignore any taxonomical issues. On the other hand, many RefSeq are provisional, and those are not free or errors. The authors may discuss the advantage of their method over existing protein dataset.</bold>
      </p>
      <p> We have updated the introduction, introducing UniProtKB viral sequences: “UniProtKB11 contains numerous viral sequences (: 4 497 049 in total, including 17 008 (0.38%) reviewed ones) that could, as for NCBI/nr, increase computation time when thousands of sequences have to be analyzed concomitantly, which is routinely practiced in metagenomics analyses.” We have</p>
      <p> also updated the description of RefSeq (with updated contents) and better exemplified the benefit of RVDB over these two databases.</p>
      <p>
        <bold>Similarly, UniRef90 contains 577,105 clusters of proteins, which could be compared to the 489,207 unique proteins of RVDB-prot. Further discussion may help understanding the advantages of these two datasets.</bold>
      </p>
      <p> We stressed on the first asset of RVDB: the curation that is done on the sequences is unique and allows to raise confidence in the fact that all the sequences of the database are real viral sequences.</p>
      <p>
        <bold>The paper could provide more details on parameters used for defining clusters with Silix.</bold>
      </p>
      <p> Done. We used the default parameters of Silix.</p>
      <p>
        <bold>The naming system may be perfected. Although imaginative and automatic, it seems to be limited. For example cluster 77 in the -prot-hmm-txt.zip (v 15.1) contains 398 sequences, which are obviously rep proteins for ssDNA viruses circo, gemini and their satellites, but the names fished out by author’s method are not clear. This can be problematic for sequence assignation. Actually, the name used to create RVDB-pro keywords is not clearly defined. The name of GenBank protein entry are not very consistent and this may explain these problems. Maybe using pfam or any other method of identification over the clusters may help naming them in a more consistent way.</bold>
      </p>
      <p> We are grateful for this remark which helped us make the naming system clear. Indeed, the pipeline does now query PFAM to annotate sequences. As explained in the new version of the manuscript, for each cluster, we query PFAM with every sequences of this cluster, using --cut_ga option of HMMER (this option makes HMMER trust PFAM GA bitscore cutoff defined for each cluster). We kept the original system (using sequences descriptions) despite the fact they are inaccurate, since sometimes, we do not find homologs clusters in PFAM.</p>
    </body>
  </sub-article>
</sub-article>
