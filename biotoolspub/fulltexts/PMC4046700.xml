<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4046700</article-id>
    <article-id pub-id-type="pmid">24564718</article-id>
    <article-id pub-id-type="publisher-id">5682</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2164-15-S1-S9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Proceedings</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Spectral probabilities of top-down tandem mass spectra</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Xiaowen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff29"/>
        <xref ref-type="aff" rid="Aff30"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Segar</surname>
          <given-names>Matthew W</given-names>
        </name>
        <xref ref-type="aff" rid="Aff29"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Shuai Cheng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff31"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Sangtae</given-names>
        </name>
        <xref ref-type="aff" rid="Aff32"/>
      </contrib>
      <aff id="Aff29"><label/>Department of BioHealth Informatics, Indiana University-Purdue University Indianapolis, 535 W. Michigan Street, 46202 Indianapolis, IN USA </aff>
      <aff id="Aff30"><label/>Center for Computational Biology and Bioinformatics, Indiana University School of Medicine, 410 West 10th Street, HS 5000, 46202 Indianapolis, IN USA </aff>
      <aff id="Aff31"><label/>Department of Computer Science, City University of Hong Kong, 83 Tat Chee Avenue, Kowloon, Hong Kong SAR, China </aff>
      <aff id="Aff32"><label/>Biological Sciences Division, Pacific Northwest National Laboratory, 902 Battelle Boulevard, 99352 Richland, WA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>1</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>1</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <issue>Suppl 1</issue>
    <elocation-id>S9</elocation-id>
    <permissions>
      <copyright-statement>© Liu et al.; licensee BioMed Central Ltd. 2014</copyright-statement>
      <license license-type="open-access">
        <license-p>This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>In mass spectrometry-based proteomics, the statistical significance of a peptide-spectrum or protein-spectrum match is an important indicator of the correctness of the peptide or protein identification. In bottom-up mass spectrometry, probabilistic models, such as the generating function method, have been successfully applied to compute the statistical significance of peptide-spectrum matches for short peptides containing no post-translational modifications. As top-down mass spectrometry, which often identifies intact proteins with post-translational modifications, becomes available in many laboratories, the estimation of statistical significance of top-down protein identification results has come into great demand.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>In this paper, we study an extended generating function method for accurately computing the statistical significance of protein-spectrum matches with post-translational modifications. Experiments show that the extended generating function method achieves high accuracy in computing spectral probabilities and false discovery rates.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>The extended generating function method is a non-trivial extension of the generating function method for bottom-up mass spectrometry. It can be used to choose the correct protein-spectrum match from several candidate protein-spectrum matches for a spectrum, as well as separate correct protein-spectrum matches from incorrect ones identified from a large number of tandem mass spectra.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>mass spectrometry</kwd>
      <kwd>spectral probabilities</kwd>
      <kwd>dynamic programming</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd 2014</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Peptide and protein identification in mass spectrometry (MS)-based proteomics involves searching tandem mass spectrometry (MS/MS) spectra against a protein database using a search engine. In bottom-up MS, most search engines calculate a similarity score between a spectrum and a peptide and report a best-scoring peptide-spectrum match (PSM) for each spectrum [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. A PSM is <italic>correct</italic> if the spectrum is generated from the matched peptide. It is vital to distinguish correct PSMs from those incorrect ones.</p>
    <p>Two main approaches have been proposed to address this problem. In the first approach, a large data set of MS/MS spectra is searched against a concatenated target-decoy protein database to find a best-scoring PSM for each spectrum, and the PSM is reported if its score exceeds a prespecified threshold. The false discovery rate (FDR) of the reported PSMs is estimated based on the fact that the number of decoy hits and the number of incorrect target hits are approximately the same [<xref ref-type="bibr" rid="CR6">6</xref>]. This approach is simple and powerful when a large population of PSMs is reported. However, it fails to decide the correctness of single PSMs. In addition, it is unable to compute accurate FDRs when the target protein database is small (e.g., a database with only one protein) or when only a small number of PSMs are reported [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p>In the second approach, the statistical significance (<italic>E</italic>-value or <italic>p</italic>-value) of a PSM is computed for determining the correctness of the PSM. Due to the complexity of MS/MS spectra, many statistical models have limited accuracy. By contrast, Kim <italic>et al</italic>. proposed a probabilistic method for computing <italic>spectral probabilities</italic> and statistical significance of PSMs [<xref ref-type="bibr" rid="CR8">8</xref>]. This method achieves high accuracy, but it is not obvious how to extend it to PSMs with post-translational modifications (PTMs).</p>
    <p>With the rapid developments in instrumentation, top-down MS, which analyzes intact proteins or long peptides, has become available in many laboratories. More than a thousand proteins can be identified in a single top-down MS experiment [<xref ref-type="bibr" rid="CR9">9</xref>] and many methods have been proposed for identification of proteoforms using top-down tandem mass spectra [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. Although the evaluation of PSMs in bottom-up MS has been intensively studied, no systematic studies have been carried out for evaluating protein-spectrum matches (PrSMs) in top-down MS. Similar to bottom-up MS, there is now an increasing demand to accurately estimate the statistical significance of <italic>single</italic> PrSMs. For instance, a top-down MS/MS spectrum can be matched to two different proteins: one contains a PTM; the other does not. Comparing the <italic>E</italic>-values of the two PrSMs can determine which one is better. Meng <italic>et al</italic>. developed a Poisson model for the problem, but the model does not include PTMs [<xref ref-type="bibr" rid="CR18">18</xref>]. As top-down MS/MS spectra are often mapped to proteoforms with PTMs, accurate estimation of statistical significance of PrSMs with PTMs is useful and challenging. We proposed a method for <italic>E</italic>-value computation of PrSMs by breaking a protein into several sub-proteins without PTMs, but it is extremely time consuming [<xref ref-type="bibr" rid="CR17">17</xref>]. In this paper, we study an extended generating function method for accurately computing <italic>spectral probabilities</italic> and statistical significance of PrSMs in top-down MS. Our method naturally extends the generating function method in bottom-up MS [<xref ref-type="bibr" rid="CR8">8</xref>]. Spectral probabilities reported by the extended generating function method are further utilized for estimating FDRs of identified PrSMs using a method proposed in [<xref ref-type="bibr" rid="CR7">7</xref>], in which decoy databases are not needed. Experiments show that the extended generating function method achieves high accuracy in computing spectral probabilities and FDRs.</p>
  </sec>
  <sec id="Sec2" sec-type="methods">
    <title>Methods</title>
    <p>A top-down MS/MS spectrum generated from a protein consists of a precursor mass, corresponding to the molecular mass of the protein, and a list of peaks, corresponding to fragment ions of the protein. Each peak represents the mass-to-charge ratio and the abundance of the fragment ion. The <italic>residue mass</italic> of a spectrum <italic>S</italic> is defined as M(<italic>S</italic>) = <italic>PrecursorMass − WaterMass</italic>, where <italic>PrecursorMass</italic> is the precursor mass of the spectrum, and <italic>WaterMass</italic> is the mass of a water molecule. Because top-down MS/MS spectra are very complex, and the charge states of most fragment ions are high, high mass resolution and high mass accuracy spectra are absolutely required. The first step in top-down spectral interpretation is usually spectral deconvolution, which converts a complex top-down spectrum to a list of monoisotopic neutral masses (a deconvoluted spectrum) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. The neutral masses are further converted to a list of <italic>prefix residue masses (PRMs)</italic> corresponding to the masses of protein prefixes [<xref ref-type="bibr" rid="CR21">21</xref>]. For a collision-induced dissociation (CID) spectrum, the PRM spectrum is generated as follows: (1) the residue mass of the experimental spectrum is added to the PRM spectrum; (2) for each neutral mass <italic>x</italic> extracted from the experimental spectrum, two masses <italic>x</italic> and <italic>PrecursorMass − ×</italic> are added to the PRM spectrum. If mass <italic>x</italic> corresponds to a protein suffix (prefix), then mass <italic>PrecursorMass − ×</italic> corresponds to a protein prefix (suffix) [<xref ref-type="bibr" rid="CR22">22</xref>]. The proposed extended generating function method can be applied to all types of spectra, such as CID and electron-transfer dissociation (ETD) spectra, because all these types of spectra can be converted to PRM spectra. All masses in PRM spectra are discretized by scaling the masses with a constant and rounding the values to integers [<xref ref-type="bibr" rid="CR23">23</xref>]. For highly accurate top-down spectra, a scaling constant 274.335215 is used (e.g. mass(<italic>G</italic>) = 57.021464 × 274.335215 = 15642.995586 <italic>≈</italic> 15643) to reduce the rounding error to 2.5 parts per million (ppm) [<xref ref-type="bibr" rid="CR22">22</xref>]. In the following analysis, we assume that only PRM spectra with integer masses are studied and peak intensities are ignored.</p>
    <sec id="Sec3">
      <title>Scores of PrSMs</title>
      <p>A PRM spectrum <italic>S</italic> is represented as an ordered list of integer masses, in which the largest one is M(<italic>S</italic>). Let <inline-formula id="IEq1"><inline-graphic xlink:href="12864_2014_5682_IEq1_HTML.gif"/></inline-formula> be the set of the 20 standard amino acids with integer residue masses M(<italic>r</italic>) for <inline-formula id="IEq2"><inline-graphic xlink:href="12864_2014_5682_IEq2_HTML.gif"/></inline-formula> (the residue masses of amino acids are discretized using the same discretization method for PRM spectra). The residue mass of <italic>r</italic> is also denoted as <italic>‖r‖</italic>. The <italic>residue mass</italic> M(<italic>P</italic>) of a protein <italic>P</italic> is the sum of the residue masses of all amino acids of the protein. It differs from the molecular mass of the protein by the mass of a water molecule. A protein <italic>P</italic> with <italic>m</italic> amino acids is associated with an ordered list of integer masses <italic>p</italic><sub>1</sub><italic>&lt; p</italic><sub>2</sub><italic>&lt;</italic>. . . <italic>&lt; p</italic><sub><italic>m</italic></sub>, where <italic>p</italic><sub><italic>i</italic></sub> is the sum of the residue masses of the first <italic>i</italic> amino acids and <italic>p</italic><sub><italic>m</italic></sub> = M(<italic>P</italic>).</p>
      <p>If the residue masses of spectrum <italic>S</italic> and protein <italic>P</italic> are the same value <italic>N</italic> , the <italic>mass count score</italic> of <italic>S</italic> and <italic>P</italic> is the number of shared masses (except for the residue mass <italic>N</italic>) in <italic>S</italic> and <italic>P</italic>, denoted by CScore(<italic>S</italic>, <italic>P</italic>). The <italic>mass shift</italic> of a PTM is the mass difference between the modified form (with the PTM) and the unmodified form of an amino acid residue. When a PTM occurs at the <italic>i</italic>th amino acid of <italic>P</italic> and the mass shift <italic>d</italic> of the PTM is positive, the modified form of <italic>P</italic> is denoted by <italic>Q</italic><sub><italic>i</italic></sub><sub>,</sub><sub><italic>d</italic></sub>(<italic>P</italic>) = {<italic>p</italic><sub>1</sub>, <italic>p</italic><sub>2</sub>, . . ., <italic>p</italic><sub><italic>i−</italic></sub><sub>1</sub>, <italic>p</italic><sub><italic>i</italic></sub> + <italic>d</italic>, . . ., <italic>p</italic><sub><italic>m</italic></sub> + <italic>d</italic>}. When the mass shift of the PTM is a negative value <italic>−d</italic>, <italic>Q</italic><sub><italic>i</italic></sub><sub>,</sub><sub><italic>−d</italic></sub>(<italic>P</italic>) = {<italic>p</italic><sub>1</sub>, <italic>p</italic><sub>2</sub>, . . ., <italic>p</italic><sub><italic>i−</italic></sub><sub>1</sub>, <italic>p</italic><sub><italic>i</italic></sub><italic>− d</italic>, . . ., <italic>p</italic><sub><italic>m</italic></sub><italic>− d</italic>}. In addition, if a mass in <italic>p</italic><sub><italic>i</italic></sub><italic>− d</italic>, . . ., <italic>p</italic><sub><italic>m</italic></sub><italic>− d</italic> is negative or not greater than <italic>p</italic><sub><italic>i−</italic></sub><sub>1</sub>, the mass is removed from <italic>Q</italic><sub><italic>i</italic></sub><sub>,</sub><sub><italic>−d</italic></sub>(<italic>P</italic>). Let <inline-formula id="IEq3"><inline-graphic xlink:href="12864_2014_5682_IEq3_HTML.gif"/></inline-formula> be the set of all modified proteins of <italic>P</italic> with a PTM of mass shift <italic>d</italic>. When the protein is not ambiguous, we use shortened notations <inline-formula id="IEq4"><inline-graphic xlink:href="12864_2014_5682_IEq4_HTML.gif"/></inline-formula>. To identify an experimental PRM spectrum <italic>S</italic> generated from protein <italic>P</italic> with a PTM, one can find the mass shift <italic>d</italic> of the PTM by comparing the residue masses of <italic>S</italic> and <italic>P</italic> , and compute the mass count score between <italic>S</italic> and each of the modified proteins in <inline-formula id="IEq5"><inline-graphic xlink:href="12864_2014_5682_IEq5_HTML.gif"/></inline-formula> to find the best match. The <italic>PTM mass count score</italic> of <italic>S</italic> and <italic>P</italic> is defined as <inline-formula id="IEq6"><inline-graphic xlink:href="12864_2014_5682_IEq6_HTML.gif"/></inline-formula> CScore(<italic>S</italic>, <italic>Q</italic>), where <italic>d</italic> = M(<italic>S</italic>) <italic>−</italic> M(<italic>P</italic>).</p>
    </sec>
    <sec id="Sec4">
      <title>Random proteins</title>
      <p>Let Pr(<italic>r</italic>) be the probability that an amino acid <inline-formula id="IEq7"><inline-graphic xlink:href="12864_2014_5682_IEq2_HTML.gif"/></inline-formula> is observed at a position in a random protein. In practice, the frequencies of amino acids in the Swiss-Prot database [<xref ref-type="bibr" rid="CR24">24</xref>] can be used to estimate Pr(<italic>r</italic>). The probability that a random protein <italic>P</italic> with amino acids <italic>r</italic><sub>1</sub><italic>r</italic><sub>2</sub> . . . <italic>r</italic><sub><italic>m</italic></sub> is observed is<disp-formula id="Equa"><graphic xlink:href="12864_2014_5682_Equa_HTML.gif" position="anchor"/></disp-formula></p>
      <p>where <italic>L</italic> represents the length of the random protein. To simplify computation, a uniform probability Pr(<italic>L</italic> = <italic>m</italic>) = 1<italic>/MaxLength</italic> is chosen, where <italic>MaxLength</italic> is the length of the longest protein in the Swiss-Prot database. Despite the difference between the uniform distribution and the distribution of protein length in the target protein database, experimental results showed the uniform distribution does not introduce large errors into the computation of spectral probabilities.</p>
    </sec>
    <sec id="Sec5">
      <title>Spectral probabilities</title>
      <p>Let <inline-formula id="IEq8"><inline-graphic xlink:href="12864_2014_5682_IEq7_HTML.gif"/></inline-formula> be the set of negative/positive mass shifts of allowed PTMs. Any number in <inline-formula id="IEq9"><inline-graphic xlink:href="12864_2014_5682_IEq8_HTML.gif"/></inline-formula> is a valid mass shift. Let <italic>S</italic> be an experimental PRM spectrum and <italic>P</italic> a random protein. The residue mass difference between <italic>S</italic> and <italic>P</italic> is a random variable <italic>D</italic> = M(<italic>S</italic>) <italic>−</italic> M(<italic>P</italic> ). The <italic>spectral probability</italic> of <italic>S</italic> with respect to a threshold <italic>t</italic> and one PTM is the probability that the residue mass difference <inline-formula id="IEq10"><inline-graphic xlink:href="12864_2014_5682_IEq9_HTML.gif"/></inline-formula> and PScore(<italic>S</italic>, <italic>P</italic> ) <italic>≥ t</italic>:<disp-formula id="Equ1"><label>1</label><graphic xlink:href="12864_2014_5682_Equ1_HTML.gif" position="anchor"/></disp-formula></p>
      <p>where 1 in SpecProb(<italic>S</italic>, <italic>t</italic>, 1) represents one PTM. From the definition of PScore(<italic>S</italic>, <italic>P</italic>),<disp-formula id="Equ2"><label>2</label><graphic xlink:href="12864_2014_5682_Equ2_HTML.gif" position="anchor"/></disp-formula></p>
      <p>Computing SpecProb(<italic>S</italic>, <italic>t</italic>, 1) accurately and efficiently is a problem that has not been solved. In the following subsections, we propose two upper bounds of SpecProb(<italic>S</italic>, <italic>t</italic>, 1). The two upper bounds can be calculated accurately and efficiently using dynamic programming algorithms. The second upper bound is better than the first one and is used for estimating SpecProb(<italic>S</italic>, <italic>t</italic>, 1). Since the second upper bound is larger than SpecProb(<italic>S</italic>, <italic>t</italic>, 1), a constant <italic>K</italic> is introduced for correcting errors in estimated spectral probabilities. In practice, the value of <italic>K</italic> can be estimated from training data sets.</p>
    </sec>
    <sec id="Sec6">
      <title>The first upper bound of spectral probabilities</title>
      <p>Based on Equation (<xref rid="Equ2" ref-type="">2</xref>) and the union bound of probabilities,<disp-formula id="Equ3"><label>3</label><graphic xlink:href="12864_2014_5682_Equ3_HTML.gif" position="anchor"/></disp-formula></p>
      <p>Let <italic>q</italic> denote the right hand part of the above inequality. The value of <italic>q</italic> is an upper bound of SpecProb(<italic>S</italic>, <italic>t</italic>, 1). Next, we describe a dynamic programming algorithm for computing the value of <italic>q</italic>. The algorithm is an extension of the generating function method in [<xref ref-type="bibr" rid="CR8">8</xref>]. In this algorithm, a spectrum <italic>S</italic> with a residue mass <italic>N</italic> is represented as a 0/1 vector <italic>S</italic> = <italic>s</italic><sub>1</sub><italic>s</italic><sub>2</sub> . . . <italic>s</italic><sub><italic>N</italic></sub>, where <italic>s</italic><sub><italic>i</italic></sub> = 1 if the spectrum has a prefix residue mass <italic>i</italic> and 0 otherwise. For example, a spectrum with a PRM list {2, 5, 8, 10} (10 is the residue mass of the spectrum) is represented as 0100100100. We first study the case where all mass shifts are positive; negative mass shifts will be discussed at the end of this subsection. A three dimensional table <italic>T</italic> (<italic>i</italic>, <italic>j</italic>, <italic>k</italic>) is computed to acquire the upper bound, where <italic>i</italic> is the number of PTMs in modified proteins. Let <italic>S</italic>[1 : <italic>j</italic>] be the subspectrum <italic>s</italic><sub>1</sub><italic>s</italic><sub>2</sub> . . . <italic>s</italic><sub><italic>j</italic></sub> of <italic>S</italic>. The residue mass of <italic>S</italic>[1 : <italic>j</italic>] is <italic>j</italic>. The value <italic>T</italic> (0, <italic>j</italic>, <italic>k</italic>) is the probability that M(<italic>P</italic>) = <italic>j</italic> and the mass count score CScore(<italic>S</italic>[1 : <italic>j</italic>], <italic>P</italic>) = <italic>k</italic>. Let <inline-formula id="IEq11"><inline-graphic xlink:href="12864_2014_5682_IEq10_HTML.gif"/></inline-formula> be set of all proteins with a residue mass <italic>j</italic>. We define a function: <italic>f</italic>(<italic>S</italic>, <italic>P</italic>, <italic>k</italic>) = 1 if CScore(<italic>S</italic>, <italic>P</italic>) = <italic>k</italic>; 0 otherwise. Then,<disp-formula id="Equ4"><label>4</label><graphic xlink:href="12864_2014_5682_Equ4_HTML.gif" position="anchor"/></disp-formula></p>
      <p>Suppose <italic>P</italic> contains <italic>m</italic> amino acids and the residue mass of <italic>P</italic> is <italic>j</italic>. If the last amino acid of <italic>P</italic> is <italic>r</italic>, then <italic>j − ‖r‖</italic> is the prefix residue mass of the first <italic>m −</italic> 1 amino acids of <italic>P</italic>, where <italic>‖r‖</italic> is the residue mass of <italic>r</italic>. In the vector representation of <italic>S</italic>, if <italic>S</italic> contains a prefix residue mass <italic>j − ‖r‖</italic>, <italic>s</italic><sub><italic>j−‖r‖</italic></sub> = 1; otherwise, <italic>s</italic><sub><italic>j−‖r‖</italic></sub> = 0. The recurrence function for computing <italic>T</italic>(0, <italic>j</italic>, <italic>k</italic>) was given in [<xref ref-type="bibr" rid="CR8">8</xref>]:<disp-formula id="Equ5"><label>5</label><graphic xlink:href="12864_2014_5682_Equ5_HTML.gif" position="anchor"/></disp-formula></p>
      <p>Let <italic>D</italic><sub><italic>j</italic></sub> = <italic>j −</italic> M(<italic>P</italic> ), the random variable representing the difference between <italic>j</italic> and the residue mass of random protein <italic>P</italic>. The value <italic>T</italic>(1, <italic>j</italic>, <italic>k</italic>) is the sum of probabilities<disp-formula id="Equ6"><label>6</label><graphic xlink:href="12864_2014_5682_Equ6_HTML.gif" position="anchor"/></disp-formula></p>
      <p>Suppose the residue mass of protein <italic>P</italic> is <italic>j − d</italic>, that is, <inline-formula id="IEq12"><inline-graphic xlink:href="12864_2014_5682_IEq11_HTML.gif"/></inline-formula>. Let <italic>m</italic> be the number of amino acids in <italic>P</italic> and <italic>Q</italic><sub><italic>m</italic></sub><sub>,</sub><sub><italic>d</italic></sub> the modified protein of <italic>P</italic> whose PTM is on the last amino acid. Because the first <italic>m−</italic>1 masses of <italic>Q</italic><sub><italic>m</italic></sub><sub>,</sub><sub><italic>d</italic></sub> are unchanged compared with <italic>P</italic>,<disp-formula id="Equb"><graphic xlink:href="12864_2014_5682_Equb_HTML.gif" position="anchor"/></disp-formula></p>
      <p>Combined with Equation (<xref rid="Equ4" ref-type="">4</xref>),<disp-formula id="Equ7"><label>7</label><graphic xlink:href="12864_2014_5682_Equ7_HTML.gif" position="anchor"/></disp-formula></p>
      <p>Let <italic>r</italic> be the last amino acid of <italic>P</italic> and <italic>P</italic>' the protein containing the first <italic>m −</italic> 1 amino acids of <italic>P</italic>. All the <italic>m −</italic> 1 masses in <italic>Q</italic><sub><italic>l</italic></sub><sub>,</sub><sub><italic>d</italic></sub>(<italic>P</italic>'), 1 <italic>≤ l ≤ m −</italic> 1, are the same to the first <italic>m −</italic> 1 masses in <italic>Q</italic><sub><italic>l</italic></sub><sub>,</sub><sub><italic>d</italic></sub>(<italic>P</italic>). While the <italic>m −</italic> 1th mass <italic>j − ‖r‖</italic> in <italic>Q</italic><sub><italic>l</italic></sub><sub>,</sub><sub><italic>d</italic></sub>(<italic>P</italic>) is included in the computation of mass count scores, the mass <italic>j − ‖r‖</italic> in <italic>Q</italic><sub><italic>l</italic></sub><sub>,</sub><sub><italic>d</italic></sub>(<italic>P</italic>') is not included because it is the residue mass. Thus,<disp-formula id="Equc"><graphic xlink:href="12864_2014_5682_Equc_HTML.gif" position="anchor"/></disp-formula></p>
      <p>It follows<disp-formula id="Equ8"><label>8</label><graphic xlink:href="12864_2014_5682_Equ8_HTML.gif" position="anchor"/></disp-formula></p>
      <p>Combining the fact that <italic>Pr</italic>(<italic>P</italic>) = <italic>Pr</italic>(<italic>P</italic>')<italic>Pr</italic>(<italic>r</italic>) and Equations (<xref rid="Equ6" ref-type="">6</xref>) and (<xref rid="Equ8" ref-type="">8</xref>),<disp-formula id="Equ9"><label>9</label><graphic xlink:href="12864_2014_5682_Equ9_HTML.gif" position="anchor"/></disp-formula></p>
      <p>With Equations (<xref rid="Equ6" ref-type="">6</xref>), (<xref rid="Equ7" ref-type="">7</xref>) and (<xref rid="Equ9" ref-type="">9</xref>), the recurrence function for <italic>T</italic>(1, <italic>j</italic>, <italic>k</italic>) is<disp-formula id="Equ10"><label>10</label><graphic xlink:href="12864_2014_5682_Equ10_HTML.gif" position="anchor"/></disp-formula></p>
      <p>When PTMs with negative mass shifts <italic>d</italic> are allowed, <italic>j − d</italic> in Equation (<xref rid="Equ10" ref-type="">10</xref>) is larger than <italic>j</italic>. The value <italic>T</italic>(1, <italic>j − d</italic>, <italic>k</italic>) has not been computed when <italic>T</italic>(1, <italic>j</italic>, <italic>k</italic>) is computed, making Equation (<xref rid="Equ10" ref-type="">10</xref>) invalid. To avoid this problem, a short amino acid sequence <italic>g</italic> is introduced to guarantee that <italic>j − d −</italic> M(<italic>g</italic>) <italic>&lt; j</italic>. Let <inline-formula id="IEq13"><inline-graphic xlink:href="12864_2014_5682_IEq12_HTML.gif"/></inline-formula> be the set of all amino acid sequences <italic>g</italic> = <italic>r</italic><sub>1</sub><italic>r</italic><sub>2</sub> . . . <italic>r</italic><sub><italic>l</italic></sub> satisfying M(<italic>g</italic>) <italic>&gt; −d</italic> and M(<italic>r</italic><sub>1</sub><italic>r</italic><sub>2</sub> . . . <italic>r</italic><sub><italic>l−</italic></sub><sub>1</sub>) <italic>≤ −d</italic> (<italic>d</italic> is negative). Equation (<xref rid="Equ10" ref-type="">10</xref>) is modified to<disp-formula id="Equ11"><label>11</label><graphic xlink:href="12864_2014_5682_Equ11_HTML.gif" position="anchor"/></disp-formula></p>
      <p>where <italic>‖g‖</italic> is the residue mass of <italic>g</italic>, and <inline-formula id="IEq14"><inline-graphic xlink:href="12864_2014_5682_IEq13_HTML.gif"/></inline-formula> for a sequence <italic>g</italic> = <italic>r</italic><sub>1</sub><italic>r</italic><sub>2</sub> . . . <italic>r</italic><sub><italic>l</italic></sub>. The value of <italic>q</italic> is <inline-formula id="IEq15"><inline-graphic xlink:href="12864_2014_5682_IEq14_HTML.gif"/></inline-formula>, where <italic>N</italic> and <italic>n</italic> are the residue mass and the number of masses of <italic>S</italic>, respectively. The time complexity for computing <italic>T</italic>(0, <italic>j</italic>, <italic>k</italic>) and <italic>T</italic>(1, <italic>j</italic>, <italic>k</italic>) is <italic>O</italic>(<italic>N · t · z</italic>), where <italic>z</italic> is the sum of the sizes of <inline-formula id="IEq16"><inline-graphic xlink:href="12864_2014_5682_IEq15_HTML.gif"/></inline-formula> and all <inline-formula id="IEq17"><inline-graphic xlink:href="12864_2014_5682_IEq12_HTML.gif"/></inline-formula>, <inline-formula id="IEq18"><inline-graphic xlink:href="12864_2014_5682_IEq16_HTML.gif"/></inline-formula>.</p>
    </sec>
    <sec id="Sec7">
      <title>The second upper bound of spectral probabilities</title>
      <p>The only difference between two modified proteins <italic>Q</italic><sub><italic>i</italic></sub><sub>,</sub><sub><italic>d</italic></sub> and <italic>Q</italic><sub><italic>i</italic></sub><sub>+1,</sub><sub><italic>d</italic></sub> is the <italic>i</italic>th mass. If <italic>p</italic><sub><italic>i</italic></sub> in <italic>P</italic> (which is not changed in <italic>Q</italic><sub><italic>i</italic></sub><sub>+1,</sub><sub><italic>d</italic></sub>) does not equal any mass in <italic>S</italic>, then CScore(<italic>S</italic>, <italic>Q</italic><sub><italic>i</italic></sub><sub>+1,</sub><sub><italic>d</italic></sub>) <italic>≤</italic> CScore(<italic>S</italic>, <italic>Q</italic><sub><italic>i</italic></sub>,<sub><italic>d</italic></sub>). Based on this observation, if <italic>p</italic><sub><italic>i</italic></sub> does not equal any mass in <italic>S</italic>, <italic>Q</italic><sub><italic>i</italic></sub><sub>+1,</sub><sub><italic>d</italic></sub> is removed from <inline-formula id="IEq19"><inline-graphic xlink:href="12864_2014_5682_IEq17_HTML.gif"/></inline-formula>. In this way, a new set <inline-formula id="IEq20"><inline-graphic xlink:href="12864_2014_5682_IEq18_HTML.gif"/></inline-formula> is acquired containing <italic>Q</italic><sub>1,<italic>d</italic></sub>and all <italic>Q</italic><sub><italic>i</italic></sub>,<sub><italic>d</italic></sub> satisfying that <italic>p</italic><sub><italic>i−</italic></sub><sub>1</sub> equals a mass in <italic>S</italic>. It follows that <inline-formula id="IEq21"><inline-graphic xlink:href="12864_2014_5682_IEq19_HTML.gif"/></inline-formula>. From Equation (<xref rid="Equ1" ref-type="">1</xref>) and the union bound of probabilities,<disp-formula id="Equd"><graphic xlink:href="12864_2014_5682_Equd_HTML.gif" position="anchor"/></disp-formula></p>
      <p>Let <italic>q</italic>' denote the right hand part of the above inequality. Compared with <italic>q</italic>, the value of <italic>q</italic>' is a better upper bound for SpecProb(<italic>S</italic>, <italic>t</italic>, 1). Similar to the method for computing <italic>q</italic>, we fill out a three dimensional array <italic>T</italic>(<italic>i</italic>, <italic>j</italic>, <italic>k</italic>) for computing <italic>q</italic>'. The recurrence function for filling out <italic>T</italic>(0, <italic>j</italic>, <italic>k</italic>) is the same to Equation (<xref rid="Equ5" ref-type="">5</xref>). We change the definition of <italic>T</italic>(1, <italic>j</italic>, <italic>k</italic>) by replacing <inline-formula id="IEq22"><inline-graphic xlink:href="12864_2014_5682_IEq17_HTML.gif"/></inline-formula> with <inline-formula id="IEq23"><inline-graphic xlink:href="12864_2014_5682_IEq18_HTML.gif"/></inline-formula> in Equation (<xref rid="Equ6" ref-type="">6</xref>). To compute <italic>T</italic>(1, <italic>j</italic>, <italic>k</italic>), the second and third terms of the right-hand part of Equation (<xref rid="Equ11" ref-type="">11</xref>) should be changed so that only the probabilities for the modified proteins in <inline-formula id="IEq24"><inline-graphic xlink:href="12864_2014_5682_IEq18_HTML.gif"/></inline-formula> are summed up.</p>
      <p>Similar to the proof of Equation (<xref rid="Equ7" ref-type="">7</xref>), consider a random protein <inline-formula id="IEq25"><inline-graphic xlink:href="12864_2014_5682_IEq20_HTML.gif"/></inline-formula>. Let <italic>Q</italic><sub><italic>m</italic></sub>,<sub><italic>d</italic></sub> be the modified protein of <italic>P</italic> whose PTM is on the last amino acid, and <italic>r</italic> the last amino acid of <italic>P</italic>. If <inline-formula id="IEq26"><inline-graphic xlink:href="12864_2014_5682_IEq21_HTML.gif"/></inline-formula>, then <italic>j − d − ‖r‖</italic> is a mass in <italic>S</italic> or <italic>j − d − ‖r‖</italic> = 0 (in the extreme case that <italic>P</italic> contains only one amino acid, <italic>j − d − ‖r‖</italic> = 0), and vice versa. Therefore, if <italic>j − d − ‖r‖</italic> = 0 or <italic>s</italic><sub><italic>j−d−‖r‖</italic></sub> = 1, then Pr(<italic>P</italic> ) <italic>· f</italic>(<italic>S</italic>[1 : <italic>j</italic>], <italic>Q</italic><sub><italic>m</italic></sub>,<sub><italic>d</italic></sub>, <italic>k</italic>) is included in the computation of <italic>T</italic>(1, <italic>j</italic>, <italic>k</italic>).</p>
      <p>For a positive mass shift <italic>d</italic>, we define <inline-formula id="IEq27"><inline-graphic xlink:href="12864_2014_5682_IEq22_HTML.gif"/></inline-formula> as the set of amino acids <italic>r</italic> ∈ <italic>R</italic> satisfying that <italic>j − d − ‖r‖</italic> = 0 or the element <italic>s</italic><sub><italic>j−d−‖r‖</italic></sub> = 1. For a negative mass shift <italic>d</italic>, we introduce a set <inline-formula id="IEq28"><inline-graphic xlink:href="12864_2014_5682_IEq23_HTML.gif"/></inline-formula> of amino acid sequences <italic>g</italic> = <italic>r</italic><sub>1</sub><italic>r</italic><sub>2</sub> . . . <italic>r</italic><sub><italic>l</italic></sub> satisfying: (1) M(<italic>g</italic>) <italic>&gt; −d</italic>, (2) M(<italic>r</italic><sub>1</sub><italic>r</italic><sub>2</sub> . . . <italic>r</italic><sub><italic>l−</italic></sub><sub>1</sub>) <italic>≤ −d</italic>, and (3) <italic>j − d − ‖g‖</italic> = 0 or the element <italic>s</italic><sub><italic>j−d−‖g‖</italic></sub> = 1. Then Equation (<xref rid="Equ11" ref-type="">11</xref>) is changed to:<disp-formula id="Equ12"><label>12</label><graphic xlink:href="12864_2014_5682_Equ12_HTML.gif" position="anchor"/></disp-formula></p>
      <p>and <inline-formula id="IEq29"><inline-graphic xlink:href="12864_2014_5682_IEq24_HTML.gif"/></inline-formula>. The time complexity for computing <italic>T</italic>(0, <italic>j</italic>, <italic>k</italic>) and <italic>T</italic>(1, <italic>j</italic>, <italic>k</italic>) is similar to the method in the previous subsection.</p>
      <p>Since the scores CScore(<italic>S</italic>, <italic>Q</italic>) for <inline-formula id="IEq30"><inline-graphic xlink:href="12864_2014_5682_IEq25_HTML.gif"/></inline-formula> are not independent, <italic>q</italic>' is usually larger than the spectral probability SpecProb(<italic>S</italic>, <italic>t</italic>, 1). To estimate SpecProb(<italic>S</italic>, <italic>t</italic>, 1) more accurately, <italic>q</italic>' is multiplied by a constant value <italic>K</italic> for correction:<disp-formula id="Equ13"><label>13</label><graphic xlink:href="12864_2014_5682_Equ13_HTML.gif" position="anchor"/></disp-formula></p>
    </sec>
    <sec id="Sec8">
      <title><italic>P</italic>-values and <italic>E</italic>-values</title>
      <p>Let <inline-formula id="IEq31"><inline-graphic xlink:href="12864_2014_5682_IEq26_HTML.gif"/></inline-formula>, where <italic>N</italic> is the residue mass of <italic>S</italic>. From table <italic>T</italic>(0, <italic>j</italic>, <italic>k</italic>) described in the previous subsection, we can compute the probability that the residue mass difference <italic>D</italic> between <italic>S</italic> and <italic>P</italic> is in <inline-formula id="IEq32"><inline-graphic xlink:href="12864_2014_5682_IEq27_HTML.gif"/></inline-formula>:<disp-formula id="Equ14"><label>14</label><graphic xlink:href="12864_2014_5682_Equ14_HTML.gif" position="anchor"/></disp-formula></p>
      <p>Using Equations (<xref rid="Equ13" ref-type="">13</xref>) and (<xref rid="Equ14" ref-type="">14</xref>), the <italic>conditional spectral probability</italic> of <italic>S</italic> with respect to threshold <italic>t</italic> and one PTM is<disp-formula id="Equ15"><label>15</label><graphic xlink:href="12864_2014_5682_Equ15_HTML.gif" position="anchor"/></disp-formula></p>
      <p>Intact proteins may have N or C-terminal truncations, e.g., the removal of a signal peptide. If a top-down MS/MS spectrum is matched to an intact protein without N- or C-terminal truncations, the PrSM is called a <italic>complete</italic> PrSM. A PrSM matched to an intact protein with an N-/C-terminal truncation is called a <italic>suffix</italic>/<italic>prefix</italic> PrSM. An <italic>internal</italic> PrSM corresponds to an intact protein with both N- and C-terminal truncations.</p>
      <p>Similar to the <italic>E</italic>-values defined in BLAST [<xref ref-type="bibr" rid="CR25">25</xref>], the <italic>E</italic>-value of a PrSM describes the number of hits one can "expect" to see by chance when searching the spectrum against a protein database of a particular size. Suppose a complete PrSM contains one mass shift (PTM) in <inline-formula id="IEq33"><inline-graphic xlink:href="12864_2014_5682_IEq27_HTML.gif"/></inline-formula> and its PTM mass count score is <italic>t</italic>. We count the number <italic>Z</italic> of proteins in the target database with a residue mass in <inline-formula id="IEq34"><inline-graphic xlink:href="12864_2014_5682_IEq28_HTML.gif"/></inline-formula>. The <italic>E</italic>-value of the complete PrSM is estimated as <italic>Z ·</italic> CSP(<italic>S</italic>, <italic>t</italic>, 1). The <italic>p</italic>-value of the PrSM is estimated as 1 <italic>−</italic> (1 <italic>−</italic> CSP(<italic>S</italic>, <italic>t</italic>, 1))<sup><italic>Z</italic></sup>.</p>
      <p>For prefix, suffix and internal PrSMs, we count the numbers <italic>Z</italic><sub><italic>p</italic></sub>, <italic>Z</italic><sub><italic>s</italic></sub>, and <italic>Z</italic><sub><italic>i</italic></sub> of prefixes/ suffixes/internal sub-proteins in the target database with a residue mass in <inline-formula id="IEq35"><inline-graphic xlink:href="12864_2014_5682_IEq28_HTML.gif"/></inline-formula>. Because some prefixes/suffixes/internal sub-proteins are not independent, a constant factor <italic>C</italic><sub><italic>p</italic></sub>/<italic>C</italic><sub><italic>s</italic></sub>/<italic>C</italic><sub><italic>i</italic></sub> is multiplied in the computation of <italic>E</italic>-values of prefix/suffix/internal PrSMs for correction. For example, if a prefix PrSM contains one mass shift (PTM) in <inline-formula id="IEq36"><inline-graphic xlink:href="12864_2014_5682_IEq27_HTML.gif"/></inline-formula> and its PTM mass count score is <italic>t</italic>, the <italic>E</italic>-value of the PrSM is estimated as <italic>C</italic><sub><italic>p</italic></sub><italic>· Z</italic><sub><italic>p</italic></sub><italic>·</italic> CSP(<italic>S</italic>, <italic>t</italic>, 1).</p>
    </sec>
    <sec id="Sec9">
      <title>Multiple PTMs</title>
      <p>The dynamic programming algorithm for computing the second upper bound can be extended to estimate <italic>E</italic>-values of PrSMs with multiple PTMs. When multiple PTMs are allowed, we replace <italic>T</italic>(0, <italic>j</italic>, <italic>k</italic>) and <italic>T</italic>(1, <italic>j</italic>, <italic>k</italic>) in Equation (<xref rid="Equ12" ref-type="">12</xref>) by <italic>T</italic>(<italic>i</italic>, <italic>j</italic>, <italic>k</italic>) and <italic>T</italic>(<italic>i −</italic> 1, <italic>j</italic>, <italic>k</italic>) to estimate spectral probabilities with respect to <italic>i</italic> PTMs:<disp-formula id="Equ16"><label>16</label><graphic xlink:href="12864_2014_5682_Equ16_HTML.gif" position="anchor"/></disp-formula></p>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="results">
    <title>Results</title>
    <p>The extended generating function method, TD-GF (Top-Down Generating Function), was implemented in JAVA and tested on a desktop with a 3.3GHz (AMD Opteron 6204) CPU and 16 GB memory.</p>
    <sec id="Sec11">
      <title>Data sets</title>
      <p>A <italic>Salmonella typhimurium</italic> (ST) data set [<xref ref-type="bibr" rid="CR13">13</xref>] was used to test TD-GF. A protein mixture of ST was analyzed using an LTQ-Orbitrap (Thermo Fisher Scientific). MS and MS/MS spectra were collected at a resolution of 60,000 and 30,000, respectively. The experiment was repeated using gas-phase fractionation. A total of 14,041 collision-induced dissociation (CID) MS/MS spectra were acquired. The detailed experiment procedure can be found in [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
      <p>The performance of TD-GF on proteoform identification was tested on an <italic>Escherichia coli</italic> (EC) data set. An EC cell lysate was separated by an intact protein reversed phase liquid-chromatography (RPLC) system and analyzed by an LTQ-Orbitrap Velos (Thermo Fisher Scientific). MS and MS/MS spectra was collected at a resolution of 60,000. A total of 3,704 higher-energy C-trap dissociation (HCD) MS/MS spectra were obtained.</p>
    </sec>
    <sec id="Sec12">
      <title>Spectral probabilities for PrSMs with one PTM</title>
      <p>The accuracy of TD-GF was evaluated using two approaches based on conditional spectral probabilities (defined in Equation (<xref rid="Equ15" ref-type="">15</xref>)) and FDRs.</p>
      <sec id="Sec13">
        <title>Evaluation based on conditional spectral probabilities</title>
        <p>To evaluate TD-GF, we generated a set of PrSMs with "correct" conditional spectral probabilities and compared the "correct" conditional spectral probabilities with those reported by TD-GF.</p>
        <p><italic>Selection of PrSMs</italic> Previous analysis results in [<xref ref-type="bibr" rid="CR17">17</xref>] showed that most PrSMs identified in the ST data set contained no PTMs. To increase the number of identified PrSMs with one PTM, a mutated ST protein database was generated by adding a glycine residue to the middle of each protein sequence in the ST proteome. When the mutated ST protein database is used, a PrSM without PTMs can be identified as a PrSM with one PTM.</p>
        <p>All MS/MS spectra in the ST data set were deconvoluted using MS-Deconv [<xref ref-type="bibr" rid="CR20">20</xref>] and searched against the mutated ST proteome using MS-Align+ [<xref ref-type="bibr" rid="CR17">17</xref>]. The error tolerances for precursor masses and fragment masses were set to 15 ppm, and carbamidomethylation was set as the fixed PTM. By restricting the search space to only complete PrSMs with one PTM, MS-Align+ identified 4,291 PrSMs. For each of 4,291 PrSMs, TD-GF was employed to compute the conditional spectral probability, which was used only for selecting PrSMs, not for evaluating TD-GF. The parameter <italic>K</italic> in Equation (<xref rid="Equ13" ref-type="">13</xref>) was set to 1. Since blind PTM search was used in MS-Align+, the allowed mass shifts were set to <inline-formula id="IEq37"><inline-graphic xlink:href="12864_2014_5682_IEq29_HTML.gif"/></inline-formula> and <inline-formula id="IEq38"><inline-graphic xlink:href="12864_2014_5682_IEq30_HTML.gif"/></inline-formula>, where <italic>α</italic> is the mass of a tryptophan (W) residue. The running time for computing conditional spectral probabilities was 726 minutes (about 12 hours). For 203 of the 4,291 complete PrSMs, the conditional spectral probabilities reported by TD-GF were in [10<sup><italic>−5</italic></sup>, 10<sup><italic>−4</italic></sup>]. The 203 PrSMs were selected for computing "correct" conditional spectral probabilities.</p>
        <p><italic>Computation of "correct" conditional spectral probabilities</italic> For each of the 203 PrSMs (spectra), a random database of 10<sup>6</sup> proteins was generated. In the random database, the residue masses of all proteins are in <inline-formula id="IEq39"><inline-graphic xlink:href="12864_2014_5682_IEq31_HTML.gif"/></inline-formula>, where <italic>N</italic> is the residue mass of the spectrum. The PTM mass count score between the spectrum and each protein in the database was computed; and the number <italic>x</italic> of proteins satisfying that the PTM mass count score <italic>≥ t</italic> was counted. The conditional spectral probability of the PrSM with respect to one PTM and threshold <italic>t</italic> was estimated as <italic>x/</italic>10<sup>6</sup>. Since the above method follows the definition of conditional spectral probabilities, the results are treated as "correct" conditional spectral probabilities. Finally, one PrSM was removed from the list of 203 PrSMs because the estimated conditional spectral probability (using a random database) was 0.</p>
        <p><italic>Evaluation of TD-GF</italic> The 202 PrSMs were randomly divided into a training data set (101 PrSMs) and a test data set (101 PrSMs). The training data set was used to estimated the value of <italic>K</italic> in Equation (<xref rid="Equ13" ref-type="">13</xref>). We set <italic>K</italic> = 1 (the value of <italic>K</italic> will be determined later) and used TD-GF to compute the conditional spectral probabilities for the training PrSMs. Let <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> be the conditional spectral probabilities of a PrSM estimated by the random database-based method and TD-GF, respectively. The error of <italic>p</italic><sub>2</sub> is defined as <italic>e</italic> = <italic>|</italic> log(<italic>p</italic><sub>1</sub>) <italic>−</italic> log(<italic>p</italic><sub>2</sub>)<italic>|</italic> (base 10). To minimize the average error of the conditional spectral probabilities reported by TD-GF, the best value of log(<italic>K</italic>) is the average of the log ratio <inline-formula id="IEq40"><inline-graphic xlink:href="12864_2014_5682_IEq32_HTML.gif"/></inline-formula>. Using the training data set, <italic>K</italic> was set to the best value 0.55. In practice, the default values of <italic>K</italic> are learned from various types of training data, such as CID and ETD data, and are provided so that the users do not need to estimate <italic>K</italic> for their own data sets. With <italic>K</italic> = 0.55, TD-GF was employed to compute the conditional spectral probabilities for the test PrSMs. The errors of these conditional spectral probabilities were obtained by comparing them with the "correct" ones (Figure <xref rid="Fig1" ref-type="fig">1</xref>). The errors for 98 test PrSMs (97%) were <italic>≤</italic> 0.5. When the error is 0.5, there is about a three fold difference between the conditional spectral probabilities reported by the two methods. The results show that the spectral probabilities estimated by TD-GF are accurate for most of the test PrSMs.<fig id="Fig1"><label>Figure 1</label><caption><p><bold>A comparison of the conditional spectral probabilities (for PrSMs with one PTM) estimated by the random database-based method and TD-GF</bold>. For each of the 101 test PrSMs, the error of the conditional spectral probability reported by TD-GF is computed. For each cut-off of <italic>e</italic>, the number of PrSMs with an error <italic>&lt; e</italic> is counted.</p></caption><graphic xlink:href="12864_2014_5682_Fig1_HTML" id="d30e2621"/></fig></p>
      </sec>
      <sec id="Sec14">
        <title>Evaluation based on FDRs</title>
        <p>With the spectral probabilities reported by TD-GF, the "estimated" FDR of a set of identified PrSMs for a cut-off <italic>p</italic>-value can be computed using the functions in [<xref ref-type="bibr" rid="CR7">7</xref>]. For the same cut-off <italic>p</italic>-value, the "correct" FDR can be obtained by the target-decoy approach. Because the "estimated" FDR is based on the spectral probabilities reported by TD-GF, if the "estimated" FDR is similar to the "correct" FDR, then the spectral probabilities reported by TD-GF are accurate.</p>
        <p>Using all the 4,291 complete PrSMs with one PTM, we computed "estimated" FDRs for cut-off <italic>p</italic>-values in {0.0001, 0.0002, . . ., 1.0000} based on spectral probabilities. In the target-decoy approach, all spectra were searched against a concatenated target and shuffled decoy protein database. Because the FDR reported by the target-decoy approach was 0 when the cut-off <italic>p</italic>-value was smaller than 8.27 × 10<sup><italic>−4</italic></sup>, we compared only the FDRs for cut-off <italic>p</italic>-values greater than 8.27 × 10<sup><italic>−4</italic></sup> (Figure <xref rid="Fig2" ref-type="fig">2</xref>). The FDRs estimated based spectral probabilities were consistent with those reported by the target-decoy approach. For example, the target-decoy approach and the spectral probability approach reported cut-off <italic>p</italic>-values 0.0327 and 0.0262 for 1% FDR, respectively. The difference between the two <italic>p</italic>-values is only 0.0065, which is evidence that the spectral probabilities reported by TD-GF are accurate.<fig id="Fig2"><label>Figure 2</label><caption><p><bold>A comparison of the FDRs of PrSMs with one PTM estimated by the target-decoy approach and computed based on spectral probabilities</bold>. For a given cut-off <italic>p</italic>-value, the two reported FDRs are compared, and <italic>−</italic> log(FDR) (base 10) is plotted against <italic>−</italic> log(cut-off <italic>p</italic>-value) (base 10).</p></caption><graphic xlink:href="12864_2014_5682_Fig2_HTML" id="d30e2688"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec15">
      <title>Prefix, suffix and internal PrSMs</title>
      <p>In this subsection, we describe the methods for estimating parameters <italic>C</italic><sub><italic>p</italic></sub>, <italic>C</italic><sub><italic>s</italic></sub> and <italic>C</italic><sub><italic>i</italic></sub> introduced in Section Methods. A substring <italic>a</italic><sub><italic>i</italic></sub><italic>a</italic><sub><italic>i</italic></sub><sub>+1</sub> . . . <italic>a</italic><sub><italic>j</italic></sub> of a string <italic>S</italic> = <italic>a</italic><sub>1</sub><italic>a</italic><sub>2</sub> . . . <italic>a</italic><sub><italic>n</italic></sub> is denoted by <italic>S</italic>[<italic>i</italic> : <italic>j</italic>]. To estimate the parameter <italic>C</italic><sub><italic>p</italic></sub> for prefix PrSMs, a new random protein database was generated for each of the selected 202 PrSMs: (1) a total of 1,000 long random protein sequences with 1,200 amino acids each were generated, and (2) prefixes <italic>S</italic>[1 : 201], . . ., <italic>S</italic>[1 : 1200] were extracted from each of the 1,000 long protein sequences. In total, 10<sup>6</sup> prefixes were added to the random protein database. The conditional spectral probabilities estimated using the new random databases are different from those using the random databases in Subsection "Computation of correct conditional spectral probabilities" because the protein sequences in the new random databases are not independent. Parameter <italic>C</italic><sub><italic>p</italic></sub> was estimated as the average ratio 0.693 between the probabilities computed based on the new databases and the random databases in Subsection "Computation of correct conditional spectral probabilities" for the 202 PrSMs. Parameter <italic>C</italic><sub><italic>s</italic></sub> can be set to the same to <italic>C</italic><sub><italic>p</italic></sub>.</p>
      <p>To estimated the parameter <italic>C</italic><sub><italic>i</italic></sub> for internal PrSMs, a third type of random protein databases were used: (1) a total of 4 long random protein sequences with 1200 amino acids each were generated, and (2) 2.5 × 10<sup>5</sup> substrings <italic>S</italic>[<italic>i</italic> : <italic>j</italic>] (1 <italic>≤ i ≤</italic> 500, <italic>i</italic>+201 <italic>≤ j ≤ i</italic> + 700) of the each long protein sequence were added to the random database. Using the same method for computing <italic>C</italic><sub><italic>p</italic></sub>, parameter <italic>C</italic><sub><italic>i</italic></sub> was estimated as 0.508.</p>
    </sec>
    <sec id="Sec16">
      <title>Spectral probabilities for PrSMs with two PTMs</title>
      <p>Similar to PrSMs with one PTM, a mutated protein database was created to increase the number of identified PrSMs with two PTMs. Two glycine residues were added each protein in the ST protein database: one is at the one-third position of the protein; the other at the two-thirds position. MS-Align+ identified 2,404 complete PrSMs with two PTMs, and TD-GF was used to compute the spectral probabilities for the 2,404 PrSMs. The running time for computing spectral probabilities was 1,317 minutes (about 22 hours). Because it is extreme slow to find the best PrSM with two PTMs by searching a spectrum against a large random protein database with 10<sup>6</sup> proteins, the evaluation method based on conditional spectral probabilities was not used. Only the evaluation method based on FDRs was applied. With all the 2,404 identified PrSMs, FDRs based on spectral probabilities and based on the target-decoy approach were computed for cut-off <italic>p</italic>-values in {0.0001, 0.0002, . . ., 1.0000}. When the cut-off <italic>p</italic>-value is smaller than 0.016 (<italic>−</italic> log <italic>p</italic>-value <italic>&gt;</italic>1.80), the FDRs estimated by the two methods are similar. For 1% FDR, the target-decoy approach and the spectral probability approach estimated similar cut-off <italic>p</italic>-values 0.0164 and 0.0116, respectively. However, the FDRs based on spectral probabilities are not consistent with the "correct" FDRs (reported by the target-decoy approach) when the cut-off <italic>p</italic>-value is larger than 0.016 (Figure <xref rid="Fig3" ref-type="fig">3</xref>). One possible reason is that the filtering method implemented in MS-Align+ fails to keep the best PrSMs when their <italic>p</italic>-values are not small enough. From the above analysis, the spectral probabilities estimated by TD-GF are accurate when they are smaller than 0.016.<fig id="Fig3"><label>Figure 3</label><caption><p><bold>A comparison of the FDRs of PrSMs with two PTMs estimated by the target-decoy approach and computed based on spectral probabilities</bold>. For a given cut-off <italic>p</italic>-value, the two reported FDRs are compared, and <italic>−</italic> log(FDR) (base 10) is plotted against <italic>−</italic> log(cut-off <italic>p</italic>-value) (base 10).</p></caption><graphic xlink:href="12864_2014_5682_Fig3_HTML" id="d30e2896"/></fig></p>
    </sec>
    <sec id="Sec17">
      <title>Comparison with ProSightPC</title>
      <p>All MS/MS spectra in the EC data set were deconvoluted by MS-Deconv [<xref ref-type="bibr" rid="CR20">20</xref>]. The EC proteome database was downloaded from the Swiss-Prot database; a combined protein database was generated by concatenating the EC proteome database and a shuffled decoy database. To test the performance of TD-GF on proteoform identification, MS-Align+ coupled with TD-GF was applied to search the deconvoluted spectra against the combined database. The error tolerances for precursor masses and fragment masses were set as 15 ppm and two unknown PTMs were allowed. Using 1% spectrum-level FDR, 1,478 spectra were identified.</p>
      <p>ProSightPC [<xref ref-type="bibr" rid="CR10">10</xref>] was also applied to analyze the EC data set. ProSightPC provides several search modes for top-down spectral identification, including the absolute mass mode and the biomarker mode. Since some spectra in the EC data set were generated from truncated proteins, the biomarker mode was chosen for the analysis of the EC data set. The error tolerances for precursor masses and fragment masses were set as 15 ppm. ProSightPC identified 627 spectra with 1% spectrum-level FDR. All the 627 spectra were identified by MS-Align+ coupled with TD-GF. The test results show that MS-Align+ coupled with TD-GF outperformed the biomarker mode of ProSightPC.</p>
    </sec>
  </sec>
  <sec id="Sec18" sec-type="conclusions">
    <title>Conclusions</title>
    <p>The experiments showed that the extended generating function method achieves high accuracy in computing spectral probabilities of PrSMs with PTMs. It is a non-trivial extension of the generating function method proposed in [<xref ref-type="bibr" rid="CR8">8</xref>]. With accurate spectral probabilities and <italic>E</italic>-values, one can easily choose the correct PrSM from several candidate PrSMs for a spectrum, as well as separate correct PrSMs from incorrect ones identified from a large number of spectra. In addition, it provides a way to evaluate single PrSMs efficiently.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that there are no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors' contributions</bold>
      </p>
      <p>XL, SL, and SK designed the TD-GF method. XL implemented the TD-GF method in JAVA. XL and MS did the experiments on tandem mass spectrometry data sets. XL and SL wrote the manuscript. All authors have read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by a startup fund provided by Indiana University-Purdue University Indianapolis.</p>
    <p>
      <bold>Declarations</bold>
    </p>
    <p>Publication of this article was funded by a startup fund provided by Indiana University-Purdue University Indianapolis.</p>
    <p>This article has been published as part of <italic>BMC Genomics</italic> Volume 15 Supplement 1, 2014: Selected articles from the Twelfth Asia Pacific Bioinformatics Conference (APBC 2014): Genomics. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/bmcgenomics/supplements/15/S1">http://www.biomedcentral.com/bmcgenomics/supplements/15/S1</ext-link>.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eng</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>McCormack</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Yates</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>An approach to correlate tandem mass spectral data of peptides with amino acid sequences in a protein database</article-title>
        <source>Journal of the American Society for Mass Spectrometry</source>
        <year>1994</year>
        <volume>5</volume>
        <fpage>976</fpage>
        <lpage>989</lpage>
        <pub-id pub-id-type="doi">10.1016/1044-0305(94)80016-2</pub-id>
        <?supplied-pmid 24226387?>
        <pub-id pub-id-type="pmid">24226387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perkins</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Pappin</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Creasy</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Cottrell</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Probability-based protein identification by searching sequence databases using mass spectrometry data</article-title>
        <source>Electrophoresis</source>
        <year>1999</year>
        <volume>20</volume>
        <fpage>3551</fpage>
        <lpage>3567</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1522-2683(19991201)20:18&lt;3551::AID-ELPS3551&gt;3.0.CO;2-2</pub-id>
        <?supplied-pmid 10612281?>
        <pub-id pub-id-type="pmid">10612281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geer</surname>
            <given-names>LY</given-names>
          </name>
          <name>
            <surname>Markey</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Kowalak</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maynard</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Bryant</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Open mass spectrometry search algorithm</article-title>
        <source>Journal of Proteome Research</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>958</fpage>
        <lpage>964</lpage>
        <pub-id pub-id-type="doi">10.1021/pr0499491</pub-id>
        <?supplied-pmid 15473683?>
        <pub-id pub-id-type="pmid">15473683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Craig</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Beavis</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>A method for reducing the time required to match protein sequences with tandem mass spectra</article-title>
        <source>Rapid Communication of Mass Spectrometry</source>
        <year>2003</year>
        <volume>17</volume>
        <fpage>2310</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1002/rcm.1198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mischerikow</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bandeira</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wich</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mohammed</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Heck</surname>
            <given-names>AJR</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>The generating function of CID, ETD, and CID/ETD pairs of tandem mass spectra: Applications to database search</article-title>
        <source>Molecular &amp; Cellular Proteomics</source>
        <year>2010</year>
        <volume>9</volume>
        <fpage>2840</fpage>
        <lpage>2852</lpage>
        <pub-id pub-id-type="doi">10.1074/mcp.M110.003731</pub-id>
        <pub-id pub-id-type="pmid">20829449</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elias</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Gygi</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Target-decoy search strategy for mass spectrometry-based proteomics</article-title>
        <source>Methods in Molecular Biology</source>
        <year>2010</year>
        <volume>604</volume>
        <fpage>55</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-60761-444-9_5</pub-id>
        <?supplied-pmid 20013364?>
        <pub-id pub-id-type="pmid">20013364</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bandeira</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Keich</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Target-decoy approach and false discovery rate: when things may go wrong</article-title>
        <source>Journal of the American Society for Mass Spectrometry</source>
        <year>2011</year>
        <volume>22</volume>
        <fpage>1111</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1007/s13361-011-0139-3</pub-id>
        <?supplied-pmid 21953092?>
        <pub-id pub-id-type="pmid">21953092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Spectral probabilities and generating functions of tandem mass spectra: a strike against decoy databases</article-title>
        <source>Journal of Proteome Research</source>
        <year>2008</year>
        <volume>7</volume>
        <fpage>3354</fpage>
        <lpage>3363</lpage>
        <pub-id pub-id-type="doi">10.1021/pr8001244</pub-id>
        <?supplied-pmid 18597511?>
        <pub-id pub-id-type="pmid">18597511</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tran</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Zamdborg</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ahlf</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Catherman</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Tipton</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Vellaichamy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kellie</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sweet</surname>
            <given-names>SMM</given-names>
          </name>
          <name>
            <surname>Early</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Siuti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>LeDuc</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Compton</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Kelleher</surname>
            <given-names>NL</given-names>
          </name>
        </person-group>
        <article-title>Mapping intact protein isoforms in discovery mode using top-down proteomics</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>480</volume>
        <fpage>254</fpage>
        <lpage>258</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10575</pub-id>
        <?supplied-pmid 22037311?>
        <pub-id pub-id-type="pmid">22037311</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zamdborg</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>LeDuc</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Glowacz</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Y-B</given-names>
          </name>
          <name>
            <surname>Viswanathan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Spaulding</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Early</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Bluhm</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Babai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kelleher</surname>
            <given-names>NL</given-names>
          </name>
        </person-group>
        <article-title>ProSight PTM 2.0: improved protein identification and characterization for top down mass spectrometry</article-title>
        <source>Nucleic Acids Research</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>701</fpage>
        <lpage>706</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkm371</pub-id>
        <pub-id pub-id-type="pmid">17178748</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tolić</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hixson</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Purvine</surname>
            <given-names>SO</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>De novo sequencing of unique sequence tags for discovery of post-translational modifications of proteins</article-title>
        <source>Analytical Chemistry</source>
        <year>2008</year>
        <volume>80</volume>
        <fpage>7742</fpage>
        <lpage>7754</lpage>
        <pub-id pub-id-type="doi">10.1021/ac801123p</pub-id>
        <?supplied-pmid 18783246?>
        <pub-id pub-id-type="pmid">18783246</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frank</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Pesavento</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Mizzen</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Kelleher</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Interpreting top-down mass spectra using spectral alignment</article-title>
        <source>Analytical Chemistry</source>
        <year>2008</year>
        <volume>80</volume>
        <fpage>2499</fpage>
        <lpage>2505</lpage>
        <pub-id pub-id-type="doi">10.1021/ac702324u</pub-id>
        <?supplied-pmid 18302345?>
        <pub-id pub-id-type="pmid">18302345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsai</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Scherl</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>MacKay</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Shaffer</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Langridge-Smith</surname>
            <given-names>PRR</given-names>
          </name>
          <name>
            <surname>Goodlett</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Precursor ion independent algorithm for top-down shotgun proteomics</article-title>
        <source>Journal of the American Society for Mass Spectrometry</source>
        <year>2009</year>
        <volume>20</volume>
        <fpage>2154</fpage>
        <lpage>2166</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jasms.2009.07.024</pub-id>
        <?supplied-pmid 19773183?>
        <pub-id pub-id-type="pmid">19773183</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karabacak</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tiwari</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hayward</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Easterling</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Agar</surname>
            <given-names>JN</given-names>
          </name>
        </person-group>
        <article-title>Sensitive and specific identification of wild type and variant proteins from 8 to 669 kDa using top-down mass spectrometry</article-title>
        <source>Molecular &amp; Cellular Proteomics</source>
        <year>2009</year>
        <volume>8</volume>
        <fpage>846</fpage>
        <lpage>856</lpage>
        <pub-id pub-id-type="doi">10.1074/mcp.M800099-MCP200</pub-id>
        <pub-id pub-id-type="pmid">19074999</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fagerquist</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Garbus</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Boyle</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Harden</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Web-based software for rapid top-down proteomic identification of protein biomarkers, with implications for bacterial identification</article-title>
        <source>Applied and Environmental Microbiology</source>
        <year>2009</year>
        <volume>75</volume>
        <fpage>4341</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.00079-09</pub-id>
        <?supplied-pmid 19411427?>
        <pub-id pub-id-type="pmid">19411427</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kellie</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Ahlf</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Ntai</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Catherman</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Zamdborg</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Vellaichamy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Kelleher</surname>
            <given-names>NL</given-names>
          </name>
        </person-group>
        <article-title>The emerging process of top down mass spectrometry for protein analysis: biomarkers, protein-therapeutics, and achieving high throughput</article-title>
        <source>Molecular BioSystems</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>1532</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1039/c000896f</pub-id>
        <?supplied-pmid 20711533?>
        <pub-id pub-id-type="pmid">20711533</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Sirotkin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tsai</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Ting</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Goodlett</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Protein identification using top-down spectra</article-title>
        <source>Molecular &amp; cellular proteomics</source>
        <year>2012</year>
        <volume>11</volume>
        <fpage>111</fpage>
        <lpage>008524</lpage>
        <pub-id pub-id-type="doi">10.1074/mcp.M111.008524</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cargile</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Forbes</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Kelleher</surname>
            <given-names>NL</given-names>
          </name>
        </person-group>
        <article-title>Informatics and multiplexing of intact protein identification in bacteria and the archaea</article-title>
        <source>Nature Biotechnology</source>
        <year>2001</year>
        <volume>19</volume>
        <fpage>952</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1001-952</pub-id>
        <?supplied-pmid 11581661?>
        <pub-id pub-id-type="pmid">11581661</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horn</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Zubarev</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>McLafferty</surname>
            <given-names>FW</given-names>
          </name>
        </person-group>
        <article-title>Automated reduction and interpretation of high resolution electrospray mass spectra of large molecules</article-title>
        <source>Journal of the American Society for Mass Spectrometry</source>
        <year>2000</year>
        <volume>11</volume>
        <fpage>330</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="doi">10.1016/S1044-0305(99)00157-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Inbar</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dorrestein</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Wynne</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Souda</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Whitelegge</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Deconvolution and database search of complex tandem mass spectra of intact proteins: A combinatorial approach</article-title>
        <source>Molecular &amp; Cellular Proteomics</source>
        <year>2010</year>
        <volume>9</volume>
        <fpage>2772</fpage>
        <lpage>2782</lpage>
        <pub-id pub-id-type="doi">10.1074/mcp.M110.002766</pub-id>
        <pub-id pub-id-type="pmid">20855543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tanner</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Frank</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L-C</given-names>
          </name>
          <name>
            <surname>Zandi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mumby</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>InsPecT: identification of posttranslationally modified peptides from tandem mass spectra</article-title>
        <source>Analytical Chemistry</source>
        <year>2005</year>
        <volume>77</volume>
        <fpage>4626</fpage>
        <lpage>4639</lpage>
        <pub-id pub-id-type="doi">10.1021/ac050102d</pub-id>
        <?supplied-pmid 16013882?>
        <pub-id pub-id-type="pmid">16013882</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Hengel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tolić</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pasa-Tolić</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Identification of ultramodified proteins using top-down spectra</article-title>
        <source>Journal of Proteome Research</source>
        <year>2013</year>
        <volume>12</volume>
        <fpage>5830</fpage>
        <lpage>5838</lpage>
        <pub-id pub-id-type="doi">10.1021/pr400849y</pub-id>
        <?supplied-pmid 24188097?>
        <pub-id pub-id-type="pmid">24188097</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Mammana</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Speeding up tandem mass spectral identification using indexes</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1692</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts244</pub-id>
        <?supplied-pmid 22543365?>
        <pub-id pub-id-type="pmid">22543365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Apweiler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Natale</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Barker</surname>
            <given-names>WC</given-names>
          </name>
          <name>
            <surname>Boeckmann</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ferro</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gasteiger</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Magrane</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Mazumder</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>O'Donovan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Redaschi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Suzek</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>The Universal Protein Resource (UniProt): an expanding universe of protein information</article-title>
        <source>Nucleic Acids Residue</source>
        <year>2006</year>
        <volume>34</volume>
        <issue>Database</issue>
        <fpage>187</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkj161</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>Journal of Molecular Biology</source>
        <year>1990</year>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>10</lpage>
        <?supplied-pmid 2231712?>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
