<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10868303</article-id>
    <article-id pub-id-type="pmid">38291951</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae034</article-id>
    <article-id pub-id-type="publisher-id">btae034</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GeNLP: a web tool for NLP-based exploration and prediction of microbial gene function</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3039-4376</contrib-id>
        <name>
          <surname>Miller</surname>
          <given-names>Danielle</given-names>
        </name>
        <aff><institution>The Shmunis School of Biomedicine and Cancer Research, George S. Wise Faculty of Life Sciences, Tel-Aviv University</institution>, Tel-Aviv 6997801, <country country="IL">Israel</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0009-0006-3133-4769</contrib-id>
        <name>
          <surname>Arias</surname>
          <given-names>Ofir</given-names>
        </name>
        <aff><institution>The Shmunis School of Biomedicine and Cancer Research, George S. Wise Faculty of Life Sciences, Tel-Aviv University</institution>, Tel-Aviv 6997801, <country country="IL">Israel</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6219-1880</contrib-id>
        <name>
          <surname>Burstein</surname>
          <given-names>David</given-names>
        </name>
        <aff><institution>The Shmunis School of Biomedicine and Cancer Research, George S. Wise Faculty of Life Sciences, Tel-Aviv University</institution>, Tel-Aviv 6997801, <country country="IL">Israel</country></aff>
        <xref rid="btae034-cor1" ref-type="corresp"/>
        <!--davidbur@tauex.tau.ac.il-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae034-cor1">Corresponding author. The Shmunis School of Biomedicine and Cancer Research, George S. Wise Faculty of Life Sciences, Tel-Aviv University, Tel-Aviv 6997801, Israel. E-mail: <email>davidbur@tauex.tau.ac.il</email> (D.B.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-01-30">
      <day>30</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>2</issue>
    <elocation-id>btae034</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>08</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>07</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae034.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>GeNLP is a web application that enables exploring microbial gene “semantics” and predictions of uncharacterized gene families based on their genomic context. It utilizes a pre-trained language model to uncover gene relationships and allows users to access and utilize the data as well as make their own predictions through an interactive interface.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The web application is accessible from all browsers at: <ext-link xlink:href="http://gnlp.bursteinlab.org/" ext-link-type="uri">http://gnlp.bursteinlab.org/</ext-link>. All source codes are freely available from GitHub under the MIT license here: <ext-link xlink:href="https://github.com/burstein-lab/genomic-nlp-server" ext-link-type="uri">https://github.com/burstein-lab/genomic-nlp-server</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Israel Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003977</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>355/23</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Language models have emerged as a valuable tool for various biological data analysis tasks, including the analysis of genomic and protein sequences (<xref rid="btae034-B1" ref-type="bibr">Bepler and Berger 2021</xref>, <xref rid="btae034-B6" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btae034-B7" ref-type="bibr">Madani <italic toggle="yes">et al.</italic> 2023</xref>). These models are able to infer complex contextual patterns and relationships by processing large amounts of data allowing recent research to demonstrate their effectiveness in performing tasks, such as gene prediction, functional annotation, and gene family classification. By treating gene families as “words” and genomes as “sentences,” we have recently used Natural Language Processing (NLP) techniques to generate numerical representations of genes, termed “embeddings,” based on their genomic context, namely—the coding and non-coding regions that surround the gene itself. The genomic context of a gene holds important information about its function, particularly in prokaryotes, where co-localization of genes within the genome is correlated with co-function (<xref rid="btae034-B12" ref-type="bibr">Overbeek <italic toggle="yes">et al.</italic> 1999</xref>, <xref rid="btae034-B14" ref-type="bibr">Shmakov <italic toggle="yes">et al.</italic> 2018</xref>). As a result, genes that share a similar function are expected to have a shared genomic context. This means that these genes are likely to be located in close proximity to each other within the genome or have similar arrangements of regulatory elements and genetic features. Consequently, when we represent these genes using embeddings, which capture the semantic representation of their characteristics, we expect to observe similarities in their embeddings, reflecting their “semantic” resemblance. Thus, the embedding representations can be used to explore functional relationships between genes and predict multiple features, such as protein structure, gene function, and more (<xref rid="btae034-B1" ref-type="bibr">Bepler and Berger 2021</xref>, <xref rid="btae034-B4" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btae034-B2" ref-type="bibr">Brandes <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btae034-B6" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>).</p>
    <p>Here, we present GeNLP, a web application aimed to allow users to explore the “semantic relationships” between thousands of microbial gene families without requiring any programming expertise. This web server is based on a model (<xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>) adapted from word2vec (<xref rid="btae034-B9" ref-type="bibr">Mikolov <italic toggle="yes">et al.</italic> 2013</xref>), which was trained on all assembled metagenomes and genomes (excluding green plants, fungi, and animals) publicly available on NCBI’s GenBank Whole Genome Shotgun (WGS) database (<xref rid="btae034-B13" ref-type="bibr">Sayers <italic toggle="yes">et al.</italic> 2021</xref>) and all assembled metagenomes from EMBL-EBI’s MGnify database (<xref rid="btae034-B11" ref-type="bibr">Mitchell <italic toggle="yes">et al.</italic> 2020</xref>). From WGS genomes a representative subset based on Uniprot’s non-redundant (NR) proteomes was used to mitigate redundancies. Consequently, a substantial portion of the dataset primarily consists of metagenomic sequences for which taxonomic mappings are not known. As a preprocess, genetic data were clustered into 563 589 gene families based on sequence similarity and mapped to the KEGG orthology (<xref rid="btae034-B5" ref-type="bibr">Kanehisa 2019</xref>). However, due to the nature of the data, many gene families have no annotation in any existing database. Gene families with a significant hit to the KEGG dataset were assigned an identifier based on the KEGG Ortholog (KO) group they belong to, whereas gene families with no mapping were given a serial identifier. In order to maintain consistency, the KEGG proteins used for mapping KOs were subjected to subclustering, employing identical parameters utilized for clustering gene families without KO hits. This procedure aimed to refine and consolidate gene families based on sequence similarity, fostering a more precise representation. Genes that had sufficient occurrences in the genomic and metagenomic datasets to produce a meaningful context signature were included. The model was then extended to predict one of 10 major functional categories (namely, amino sugar and nucleotide sugar metabolism, benzoate degradation, energy metabolism, oxidative phosphorylation, porphyrin and chlorophyll metabolism, prokaryotic defense, ribosome, secretion systems, two-component systems, and other), based on KEGG’s functional ontology, taking into consideration KEGG’s hierarchy (<xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>). The classification was performed using the pre-trained gene families embedding as input to a fully connected deep neural network. Prediction scores were derived from a combination of the softmax function-based classification score and the model’s accuracy in predicting the specific function, as measured by area under the precision–recall curve (AUPR). To ensure precision, a prediction was considered to have high confidence if it passed the threshold (<italic toggle="yes">t</italic> = 0.9) for the AUPR-weighted score and (<italic toggle="yes">t</italic>'=0.99) for the unweighted score.</p>
    <p>Aiming to make the data and results of our NLP-based approach more accessible to the scientific community, we have developed GeNLP, a user-friendly web application that provides easy access and utilizes our model via an intuitive interface. Researchers can submit sequence data queries, run the model, browse through the embedding space, and view the results, all through their web browser. This convenient platform eliminates the need to execute the entire pipeline for gene prediction and simplifies individual analysis. Users can swiftly retrieve predictions assigned to their sequences by the model and further investigate genes that may be associated with them.</p>
  </sec>
  <sec>
    <title>2 The GeNLP web application</title>
    <p>GeNLP is an interactive web application that enables the visualization and exploration of microbial gene families based on their genomic context. Utilizing our pre-trained language model (<xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>), the platform allows users to uncover gene relationships and make predictions for unknown gene functions. The web service, available at <ext-link xlink:href="http://gnlp.bursteinlab.org/" ext-link-type="uri">http://gnlp.bursteinlab.org/</ext-link>, provides access to the data and functionality of the GeNLP application. The source code, implemented in Python, Vue, and TypeScript, is readily available on GitHub (<ext-link xlink:href="https://github.com/burstein-lab/genomic-nlp-server" ext-link-type="uri">https://github.com/burstein-lab/genomic-nlp-server</ext-link>). We offer a comprehensive, step-by-step tutorial, guiding users through the application, complemented by a concise demonstration, and provide this content both as <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> accompanying the manuscript and available on the <ext-link xlink:href="https://github.com/burstein-lab/genomic-nlp-server/wiki" ext-link-type="uri">web server’s wiki</ext-link> in its GitHub repository. To facilitate usage and maintenance, the web application has been implemented using Docker and requires no external installations. The GeNLP application offers two primary modes of operation: (i) a static explanatory mode for inspecting the gene embedding space and (ii) a custom predictive mode for querying user-provided data (<xref rid="btae034-F1" ref-type="fig">Fig. 1</xref>). Through the application, users can delve into the complex network of genes, exploring both known and unknown genes, and gain a deeper understanding of their relationships and functions. For known genes, the application enables users to uncover genes with similar embedding and their functions, as well as locate multiple known genes that belong to the same KO group or share similar functions. Furthermore, the application can reveal genes with multiple “semantic meanings,” i.e. genes that have various genomic contexts and play a part in different pathways or complexes. For unknown genes, the GeNLP application offers the opportunity to explore their predicted functions by the pre-trained model (out of the abovementioned 10 functional categories) and provides their proximity in the embedding space to known genes that may share similar functions. In addition, each gene family contains information regarding its gene count and the taxonomic distribution of the genomes encoding for it. Users can also explore the spatial distribution of multiple selected genes in the gene embedding space. This allows for a more comprehensive analysis of the gene network and enables the discovery of new relationships and functions. Our application currently relies on gene contextual embedding computed using an adapted version of word2vec (<xref rid="btae034-B9" ref-type="bibr">Mikolov <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>). As more informative approaches for gene representation are developed or major updates to the KEGG orthology database are released, the embedding space in the web application will be recomputed and the interface updated accordingly.</p>
    <fig position="float" id="btae034-F1">
      <label>Figure 1.</label>
      <caption>
        <p>GeNLP overview. The left panel presents the sequence search mode workflow. The right panel demonstrates the explanatory mode features.</p>
      </caption>
      <graphic xlink:href="btae034f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3 Gene exploration—gene space viewer</title>
    <p>This mode offers a user-friendly and interactive approach to explore a vast genetic landscape comprising 563,589 gene families (representing a total of 360,039,110 genes), most of which are unannotated. The main layout presents a comprehensive map of gene families sourced from NCBI’s GenBank WGS and EMBL-EBI’s MGnify databases. The model’s context-based embedding, represented by a 300D vector, is projected into two dimensions for visualization using the UMAP algorithm. It is important to note that the 2D distances obtained through the UMAP dimension reduction (<xref rid="btae034-B8" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic> 2020</xref>) may exhibit distortions compared to the original 300D cosine distances in the embedding space. Gene families are color-coded based on functional groups derived from the KEGG ontology or are in grey if they are not assigned to any KO group. Upon sufficient zoom-in, users can access an interactive mode, enabling them to obtain quick information about each gene, including its name, function, and description, by clicking on a point in the space. For genes lacking KEGG annotation, the predicted functional category obtained by our model is noted, along with its confidence, and annotation based on the NCBI NR database, if available. Additionally, the interactive mode offers several features per point: the gene count in the family, a “Neighbors” bar plot, a “Function prediction” dot plot, and a “Tax map” donut plot. The “Neighbors” bar plot displays the 10 closest genes in the high-dimensional embedding space, based on cosine distance, clicking on one of the bars will lead the user to the corresponding gene family. The “Function prediction” plot highlights for unknown genes the prediction scores across 10 functional categories as mentioned above. The “Tax map” depicts the taxonomic distribution at the order level within a gene family, based on genes from assembled genomes. The donut plot showcases the top 10 orders, including an “Other” category if the gene family is represented in more than 10 distinct orders. Given that a significant portion of genes originated from metagenomic databases that lack well-defined taxonomic origin, the plot indicates the percentage of genes within the gene family with a known taxonomic mapping in NCBI’s GenBank WGS database. The results displayed in the “Neighbors” and “Function prediction” plots, as well as a representative gene sequence, can be downloaded for each family.</p>
    <p>For ease of use, this mode also enables the following six search modes, each allowing for direct typing or a dropdown menu with all options.</p>
    <list list-type="order">
      <list-item>
        <p>KEGG ortholog: searches by KO group identifier. Presents the gene family or families assigned to a KO.</p>
      </list-item>
      <list-item>
        <p>Functional category: highlights specific functional groups as defined by the KEGG ontology. For example, selecting of “Prokaryotic Defense System” will present all known genes related to this functional category.</p>
      </list-item>
      <list-item>
        <p>Gene description: searches genes according to their product description. This mode can be used only for annotated KOs with an existing description in KEGG.</p>
      </list-item>
      <list-item>
        <p>Gene name: searches genes by their short name as assigned by KEGG.</p>
      </list-item>
      <list-item>
        <p>Neighbors: given a gene family identifier, highlights the 10 closest gene families in the high-dimensional embedding space, obtained by the pre-trained model.</p>
      </list-item>
      <list-item>
        <p>Model word: searches by KO subcluster or hypothetical identifier (used for unannotated genes). This information is derived directly from the corpus used to train the model, it includes all 563,589 gene families and can be utilized to follow-up investigations that were previously conducted on GeNLP.</p>
      </list-item>
    </list>
    <sec>
      <title>3.1 Gene function prediction</title>
      <p>The “Sequence” search mode allows users to submit a sequence query in FASTA format either by uploading a file or directly pasting protein sequences into the search box. If a family with sufficient similarity is found (<italic toggle="yes">E</italic>-value &lt; 10<sup>−4</sup>), the web server will provide information for the best hits to the proteins provided, along with the <italic toggle="yes">E</italic>-values and percent identity. The sequences are mapped to our gene family database using the DIAMOND (<xref rid="btae034-B3" ref-type="bibr">Buchfink <italic toggle="yes">et al.</italic> 2015</xref>) tool and assigned an identifier based on the best hit satisfying the <italic toggle="yes">E</italic>-value threshold. If no such hit is identified, a message is displayed indicating that no significant hit was found for the given protein sequence. This might occur for rare microbial genes that are not well represented in genomic/metagenomic databases. When a significant hit is found, the identifier corresponding to the most similar gene in our database, which can be either a gene assigned a KEGG orthology or a cluster of unknown genes, is reported. It is important to note that this process is subject to the running time of DIAMOND, and may take several minutes, depending on the length and number of the submitted sequences. Once the predictions are generated, they, along with the corresponding gene family identifier and additional information, are available for downloading. These identifiers can later be used for self-exploration using the space viewer feature, as described in the previous section. This feature allows users to quickly and easily obtain predictions for specific genes and offers a convenient means of discovering genes with similar contextual signatures. The major advantage of this approach lies in its ability to provide insights into gene function that are not based on sequence homology but rather on the genomic context in which these genes are found across numerous organisms. Thus, users can infer function for genes lacking sequence similarity to any annotated gene. For genes with existing annotations, it facilitates rapid exploration of other genes with similar genomic context, and therefore, potentially similar functions. Furthermore, it enables the identification of previously unknown functions that a given gene may have according to the different genomic contexts in which it was found. Our approach broadens the scope of gene analysis, offering a more comprehensive understanding of gene functionalities beyond conventional sequence-based searches.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae034_Supplementary_Data</label>
      <media xlink:href="btae034_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We wish to thank Dr. Karin Mittelman and Ella Rannon for testing the web server and for their valuable comments on the manuscript.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Israel Science Foundation [grant number 355/23]. This study was also supported by fellowships to D.M. from the Edmond J. Safra Center for Bioinformatics at Tel-Aviv University and the Azrieli Foundation.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>No new data were generated or analyzed in support of this research.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae034-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bepler</surname><given-names>T</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B.</given-names></string-name></person-group><article-title>Learning the protein language: evolution, structure, and function</article-title>. <source>Cell Syst</source><year>2021</year>;<volume>12</volume>:<fpage>654</fpage>–<lpage>69.e3</lpage>.<pub-id pub-id-type="pmid">34139171</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brandes</surname><given-names>N</given-names></string-name>, <string-name><surname>Ofer</surname><given-names>D</given-names></string-name>, <string-name><surname>Peleg</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>ProteinBERT: a universal deep-learning model of protein sequence and function</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>2102</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">35020807</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname><given-names>B</given-names></string-name>, <string-name><surname>Xie</surname><given-names>C</given-names></string-name>, <string-name><surname>Huson</surname><given-names>DH</given-names></string-name></person-group><etal>et al</etal><article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat Methods</source><year>2015</year>;<volume>12</volume>:<fpage>59</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">25402007</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source><year>2021</year>;<volume>596</volume>:<fpage>583</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M.</given-names></string-name></person-group><article-title>Toward understanding the origin and evolution of cellular organisms</article-title>. <source>Protein Sci</source><year>2019</year>;<volume>28</volume>:<fpage>1947</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">31441146</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Z</given-names></string-name>, <string-name><surname>Akin</surname><given-names>H</given-names></string-name>, <string-name><surname>Rao</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>. <source>Science</source><year>2023</year>;<volume>379</volume>:<fpage>1123</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">36927031</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Madani</surname><given-names>A</given-names></string-name>, <string-name><surname>Krause</surname><given-names>B</given-names></string-name>, <string-name><surname>Greene</surname><given-names>ER</given-names></string-name></person-group><etal>et al</etal><article-title>Large language models generate functional protein sequences across diverse families</article-title>. <source>Nat Biotechnol</source><year>2023</year>;<volume>41</volume>:<fpage>1099</fpage>–<lpage>106</lpage>.<pub-id pub-id-type="pmid">36702895</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Saul</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>UMAP: Uniform manifold approximation and projection</article-title>. <source>JOSS</source><year>2018</year>;<volume>3</volume>:<fpage>861</fpage>. <ext-link xlink:href="https://orcid.org/10.21105/joss.00861" ext-link-type="uri">https://orcid.org/10.21105/joss.00861</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae034-B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Mikolov</surname><given-names>T</given-names></string-name>, <string-name><surname>Sutskever</surname><given-names>I</given-names></string-name>, <string-name><surname>Chen</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal> Distributed representations of words and phrases and their compositionality. In: <italic toggle="yes">Advances in Neural Information Processing Systems</italic>, Lake Tahoe, Nevada, USA. USA: <publisher-name>Curran Associates, Inc</publisher-name>., <year>2013</year>.</mixed-citation>
    </ref>
    <ref id="btae034-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname><given-names>D</given-names></string-name>, <string-name><surname>Stern</surname><given-names>A</given-names></string-name>, <string-name><surname>Burstein</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Deciphering microbial gene function using natural language processing</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>5731</fpage>.<pub-id pub-id-type="pmid">36175448</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mitchell</surname><given-names>AL</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>A</given-names></string-name>, <string-name><surname>Beracochea</surname><given-names> M</given-names></string-name></person-group><etal>et al</etal><article-title>MGnify: the microbiome analysis resource in 2020</article-title>. <source>Nucleic Acids Res</source><year>2020</year>;<volume>48</volume>:<fpage>D570</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31696235</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Overbeek</surname><given-names>R</given-names></string-name>, <string-name><surname>Fonstein</surname><given-names>M</given-names></string-name>, <string-name><surname>D'Souza</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>The use of gene clusters to infer functional coupling</article-title>. <source>Proc Natl Acad Sci USA</source><year>1999</year>;<volume>96</volume>:<fpage>2896</fpage>–<lpage>901</lpage>.<pub-id pub-id-type="pmid">10077608</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sayers</surname><given-names>EW</given-names></string-name>, <string-name><surname>Cavanaugh</surname><given-names>M</given-names></string-name>, <string-name><surname>Clark</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>GenBank</article-title>. <source>Nucleic Acids Res</source><year>2021</year>;<volume>49</volume>:<fpage>D92</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">33196830</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shmakov</surname><given-names>SA</given-names></string-name>, <string-name><surname>Makarova</surname><given-names>KS</given-names></string-name>, <string-name><surname>Wolf</surname><given-names>YI</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic prediction of genes functionally linked to CRISPR-Cas systems by gene neighborhood analysis</article-title>. <source>Proc Natl Acad Sci USA</source><year>2018</year>;<volume>115</volume>:<fpage>E5307</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">29784811</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10868303</article-id>
    <article-id pub-id-type="pmid">38291951</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae034</article-id>
    <article-id pub-id-type="publisher-id">btae034</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GeNLP: a web tool for NLP-based exploration and prediction of microbial gene function</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3039-4376</contrib-id>
        <name>
          <surname>Miller</surname>
          <given-names>Danielle</given-names>
        </name>
        <aff><institution>The Shmunis School of Biomedicine and Cancer Research, George S. Wise Faculty of Life Sciences, Tel-Aviv University</institution>, Tel-Aviv 6997801, <country country="IL">Israel</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0009-0006-3133-4769</contrib-id>
        <name>
          <surname>Arias</surname>
          <given-names>Ofir</given-names>
        </name>
        <aff><institution>The Shmunis School of Biomedicine and Cancer Research, George S. Wise Faculty of Life Sciences, Tel-Aviv University</institution>, Tel-Aviv 6997801, <country country="IL">Israel</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6219-1880</contrib-id>
        <name>
          <surname>Burstein</surname>
          <given-names>David</given-names>
        </name>
        <aff><institution>The Shmunis School of Biomedicine and Cancer Research, George S. Wise Faculty of Life Sciences, Tel-Aviv University</institution>, Tel-Aviv 6997801, <country country="IL">Israel</country></aff>
        <xref rid="btae034-cor1" ref-type="corresp"/>
        <!--davidbur@tauex.tau.ac.il-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae034-cor1">Corresponding author. The Shmunis School of Biomedicine and Cancer Research, George S. Wise Faculty of Life Sciences, Tel-Aviv University, Tel-Aviv 6997801, Israel. E-mail: <email>davidbur@tauex.tau.ac.il</email> (D.B.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-01-30">
      <day>30</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>2</issue>
    <elocation-id>btae034</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>08</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>07</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae034.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>GeNLP is a web application that enables exploring microbial gene “semantics” and predictions of uncharacterized gene families based on their genomic context. It utilizes a pre-trained language model to uncover gene relationships and allows users to access and utilize the data as well as make their own predictions through an interactive interface.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The web application is accessible from all browsers at: <ext-link xlink:href="http://gnlp.bursteinlab.org/" ext-link-type="uri">http://gnlp.bursteinlab.org/</ext-link>. All source codes are freely available from GitHub under the MIT license here: <ext-link xlink:href="https://github.com/burstein-lab/genomic-nlp-server" ext-link-type="uri">https://github.com/burstein-lab/genomic-nlp-server</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Israel Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003977</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>355/23</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Language models have emerged as a valuable tool for various biological data analysis tasks, including the analysis of genomic and protein sequences (<xref rid="btae034-B1" ref-type="bibr">Bepler and Berger 2021</xref>, <xref rid="btae034-B6" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btae034-B7" ref-type="bibr">Madani <italic toggle="yes">et al.</italic> 2023</xref>). These models are able to infer complex contextual patterns and relationships by processing large amounts of data allowing recent research to demonstrate their effectiveness in performing tasks, such as gene prediction, functional annotation, and gene family classification. By treating gene families as “words” and genomes as “sentences,” we have recently used Natural Language Processing (NLP) techniques to generate numerical representations of genes, termed “embeddings,” based on their genomic context, namely—the coding and non-coding regions that surround the gene itself. The genomic context of a gene holds important information about its function, particularly in prokaryotes, where co-localization of genes within the genome is correlated with co-function (<xref rid="btae034-B12" ref-type="bibr">Overbeek <italic toggle="yes">et al.</italic> 1999</xref>, <xref rid="btae034-B14" ref-type="bibr">Shmakov <italic toggle="yes">et al.</italic> 2018</xref>). As a result, genes that share a similar function are expected to have a shared genomic context. This means that these genes are likely to be located in close proximity to each other within the genome or have similar arrangements of regulatory elements and genetic features. Consequently, when we represent these genes using embeddings, which capture the semantic representation of their characteristics, we expect to observe similarities in their embeddings, reflecting their “semantic” resemblance. Thus, the embedding representations can be used to explore functional relationships between genes and predict multiple features, such as protein structure, gene function, and more (<xref rid="btae034-B1" ref-type="bibr">Bepler and Berger 2021</xref>, <xref rid="btae034-B4" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btae034-B2" ref-type="bibr">Brandes <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btae034-B6" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>).</p>
    <p>Here, we present GeNLP, a web application aimed to allow users to explore the “semantic relationships” between thousands of microbial gene families without requiring any programming expertise. This web server is based on a model (<xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>) adapted from word2vec (<xref rid="btae034-B9" ref-type="bibr">Mikolov <italic toggle="yes">et al.</italic> 2013</xref>), which was trained on all assembled metagenomes and genomes (excluding green plants, fungi, and animals) publicly available on NCBI’s GenBank Whole Genome Shotgun (WGS) database (<xref rid="btae034-B13" ref-type="bibr">Sayers <italic toggle="yes">et al.</italic> 2021</xref>) and all assembled metagenomes from EMBL-EBI’s MGnify database (<xref rid="btae034-B11" ref-type="bibr">Mitchell <italic toggle="yes">et al.</italic> 2020</xref>). From WGS genomes a representative subset based on Uniprot’s non-redundant (NR) proteomes was used to mitigate redundancies. Consequently, a substantial portion of the dataset primarily consists of metagenomic sequences for which taxonomic mappings are not known. As a preprocess, genetic data were clustered into 563 589 gene families based on sequence similarity and mapped to the KEGG orthology (<xref rid="btae034-B5" ref-type="bibr">Kanehisa 2019</xref>). However, due to the nature of the data, many gene families have no annotation in any existing database. Gene families with a significant hit to the KEGG dataset were assigned an identifier based on the KEGG Ortholog (KO) group they belong to, whereas gene families with no mapping were given a serial identifier. In order to maintain consistency, the KEGG proteins used for mapping KOs were subjected to subclustering, employing identical parameters utilized for clustering gene families without KO hits. This procedure aimed to refine and consolidate gene families based on sequence similarity, fostering a more precise representation. Genes that had sufficient occurrences in the genomic and metagenomic datasets to produce a meaningful context signature were included. The model was then extended to predict one of 10 major functional categories (namely, amino sugar and nucleotide sugar metabolism, benzoate degradation, energy metabolism, oxidative phosphorylation, porphyrin and chlorophyll metabolism, prokaryotic defense, ribosome, secretion systems, two-component systems, and other), based on KEGG’s functional ontology, taking into consideration KEGG’s hierarchy (<xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>). The classification was performed using the pre-trained gene families embedding as input to a fully connected deep neural network. Prediction scores were derived from a combination of the softmax function-based classification score and the model’s accuracy in predicting the specific function, as measured by area under the precision–recall curve (AUPR). To ensure precision, a prediction was considered to have high confidence if it passed the threshold (<italic toggle="yes">t</italic> = 0.9) for the AUPR-weighted score and (<italic toggle="yes">t</italic>'=0.99) for the unweighted score.</p>
    <p>Aiming to make the data and results of our NLP-based approach more accessible to the scientific community, we have developed GeNLP, a user-friendly web application that provides easy access and utilizes our model via an intuitive interface. Researchers can submit sequence data queries, run the model, browse through the embedding space, and view the results, all through their web browser. This convenient platform eliminates the need to execute the entire pipeline for gene prediction and simplifies individual analysis. Users can swiftly retrieve predictions assigned to their sequences by the model and further investigate genes that may be associated with them.</p>
  </sec>
  <sec>
    <title>2 The GeNLP web application</title>
    <p>GeNLP is an interactive web application that enables the visualization and exploration of microbial gene families based on their genomic context. Utilizing our pre-trained language model (<xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>), the platform allows users to uncover gene relationships and make predictions for unknown gene functions. The web service, available at <ext-link xlink:href="http://gnlp.bursteinlab.org/" ext-link-type="uri">http://gnlp.bursteinlab.org/</ext-link>, provides access to the data and functionality of the GeNLP application. The source code, implemented in Python, Vue, and TypeScript, is readily available on GitHub (<ext-link xlink:href="https://github.com/burstein-lab/genomic-nlp-server" ext-link-type="uri">https://github.com/burstein-lab/genomic-nlp-server</ext-link>). We offer a comprehensive, step-by-step tutorial, guiding users through the application, complemented by a concise demonstration, and provide this content both as <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> accompanying the manuscript and available on the <ext-link xlink:href="https://github.com/burstein-lab/genomic-nlp-server/wiki" ext-link-type="uri">web server’s wiki</ext-link> in its GitHub repository. To facilitate usage and maintenance, the web application has been implemented using Docker and requires no external installations. The GeNLP application offers two primary modes of operation: (i) a static explanatory mode for inspecting the gene embedding space and (ii) a custom predictive mode for querying user-provided data (<xref rid="btae034-F1" ref-type="fig">Fig. 1</xref>). Through the application, users can delve into the complex network of genes, exploring both known and unknown genes, and gain a deeper understanding of their relationships and functions. For known genes, the application enables users to uncover genes with similar embedding and their functions, as well as locate multiple known genes that belong to the same KO group or share similar functions. Furthermore, the application can reveal genes with multiple “semantic meanings,” i.e. genes that have various genomic contexts and play a part in different pathways or complexes. For unknown genes, the GeNLP application offers the opportunity to explore their predicted functions by the pre-trained model (out of the abovementioned 10 functional categories) and provides their proximity in the embedding space to known genes that may share similar functions. In addition, each gene family contains information regarding its gene count and the taxonomic distribution of the genomes encoding for it. Users can also explore the spatial distribution of multiple selected genes in the gene embedding space. This allows for a more comprehensive analysis of the gene network and enables the discovery of new relationships and functions. Our application currently relies on gene contextual embedding computed using an adapted version of word2vec (<xref rid="btae034-B9" ref-type="bibr">Mikolov <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>). As more informative approaches for gene representation are developed or major updates to the KEGG orthology database are released, the embedding space in the web application will be recomputed and the interface updated accordingly.</p>
    <fig position="float" id="btae034-F1">
      <label>Figure 1.</label>
      <caption>
        <p>GeNLP overview. The left panel presents the sequence search mode workflow. The right panel demonstrates the explanatory mode features.</p>
      </caption>
      <graphic xlink:href="btae034f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3 Gene exploration—gene space viewer</title>
    <p>This mode offers a user-friendly and interactive approach to explore a vast genetic landscape comprising 563,589 gene families (representing a total of 360,039,110 genes), most of which are unannotated. The main layout presents a comprehensive map of gene families sourced from NCBI’s GenBank WGS and EMBL-EBI’s MGnify databases. The model’s context-based embedding, represented by a 300D vector, is projected into two dimensions for visualization using the UMAP algorithm. It is important to note that the 2D distances obtained through the UMAP dimension reduction (<xref rid="btae034-B8" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic> 2020</xref>) may exhibit distortions compared to the original 300D cosine distances in the embedding space. Gene families are color-coded based on functional groups derived from the KEGG ontology or are in grey if they are not assigned to any KO group. Upon sufficient zoom-in, users can access an interactive mode, enabling them to obtain quick information about each gene, including its name, function, and description, by clicking on a point in the space. For genes lacking KEGG annotation, the predicted functional category obtained by our model is noted, along with its confidence, and annotation based on the NCBI NR database, if available. Additionally, the interactive mode offers several features per point: the gene count in the family, a “Neighbors” bar plot, a “Function prediction” dot plot, and a “Tax map” donut plot. The “Neighbors” bar plot displays the 10 closest genes in the high-dimensional embedding space, based on cosine distance, clicking on one of the bars will lead the user to the corresponding gene family. The “Function prediction” plot highlights for unknown genes the prediction scores across 10 functional categories as mentioned above. The “Tax map” depicts the taxonomic distribution at the order level within a gene family, based on genes from assembled genomes. The donut plot showcases the top 10 orders, including an “Other” category if the gene family is represented in more than 10 distinct orders. Given that a significant portion of genes originated from metagenomic databases that lack well-defined taxonomic origin, the plot indicates the percentage of genes within the gene family with a known taxonomic mapping in NCBI’s GenBank WGS database. The results displayed in the “Neighbors” and “Function prediction” plots, as well as a representative gene sequence, can be downloaded for each family.</p>
    <p>For ease of use, this mode also enables the following six search modes, each allowing for direct typing or a dropdown menu with all options.</p>
    <list list-type="order">
      <list-item>
        <p>KEGG ortholog: searches by KO group identifier. Presents the gene family or families assigned to a KO.</p>
      </list-item>
      <list-item>
        <p>Functional category: highlights specific functional groups as defined by the KEGG ontology. For example, selecting of “Prokaryotic Defense System” will present all known genes related to this functional category.</p>
      </list-item>
      <list-item>
        <p>Gene description: searches genes according to their product description. This mode can be used only for annotated KOs with an existing description in KEGG.</p>
      </list-item>
      <list-item>
        <p>Gene name: searches genes by their short name as assigned by KEGG.</p>
      </list-item>
      <list-item>
        <p>Neighbors: given a gene family identifier, highlights the 10 closest gene families in the high-dimensional embedding space, obtained by the pre-trained model.</p>
      </list-item>
      <list-item>
        <p>Model word: searches by KO subcluster or hypothetical identifier (used for unannotated genes). This information is derived directly from the corpus used to train the model, it includes all 563,589 gene families and can be utilized to follow-up investigations that were previously conducted on GeNLP.</p>
      </list-item>
    </list>
    <sec>
      <title>3.1 Gene function prediction</title>
      <p>The “Sequence” search mode allows users to submit a sequence query in FASTA format either by uploading a file or directly pasting protein sequences into the search box. If a family with sufficient similarity is found (<italic toggle="yes">E</italic>-value &lt; 10<sup>−4</sup>), the web server will provide information for the best hits to the proteins provided, along with the <italic toggle="yes">E</italic>-values and percent identity. The sequences are mapped to our gene family database using the DIAMOND (<xref rid="btae034-B3" ref-type="bibr">Buchfink <italic toggle="yes">et al.</italic> 2015</xref>) tool and assigned an identifier based on the best hit satisfying the <italic toggle="yes">E</italic>-value threshold. If no such hit is identified, a message is displayed indicating that no significant hit was found for the given protein sequence. This might occur for rare microbial genes that are not well represented in genomic/metagenomic databases. When a significant hit is found, the identifier corresponding to the most similar gene in our database, which can be either a gene assigned a KEGG orthology or a cluster of unknown genes, is reported. It is important to note that this process is subject to the running time of DIAMOND, and may take several minutes, depending on the length and number of the submitted sequences. Once the predictions are generated, they, along with the corresponding gene family identifier and additional information, are available for downloading. These identifiers can later be used for self-exploration using the space viewer feature, as described in the previous section. This feature allows users to quickly and easily obtain predictions for specific genes and offers a convenient means of discovering genes with similar contextual signatures. The major advantage of this approach lies in its ability to provide insights into gene function that are not based on sequence homology but rather on the genomic context in which these genes are found across numerous organisms. Thus, users can infer function for genes lacking sequence similarity to any annotated gene. For genes with existing annotations, it facilitates rapid exploration of other genes with similar genomic context, and therefore, potentially similar functions. Furthermore, it enables the identification of previously unknown functions that a given gene may have according to the different genomic contexts in which it was found. Our approach broadens the scope of gene analysis, offering a more comprehensive understanding of gene functionalities beyond conventional sequence-based searches.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae034_Supplementary_Data</label>
      <media xlink:href="btae034_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We wish to thank Dr. Karin Mittelman and Ella Rannon for testing the web server and for their valuable comments on the manuscript.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Israel Science Foundation [grant number 355/23]. This study was also supported by fellowships to D.M. from the Edmond J. Safra Center for Bioinformatics at Tel-Aviv University and the Azrieli Foundation.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>No new data were generated or analyzed in support of this research.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae034-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bepler</surname><given-names>T</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B.</given-names></string-name></person-group><article-title>Learning the protein language: evolution, structure, and function</article-title>. <source>Cell Syst</source><year>2021</year>;<volume>12</volume>:<fpage>654</fpage>–<lpage>69.e3</lpage>.<pub-id pub-id-type="pmid">34139171</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brandes</surname><given-names>N</given-names></string-name>, <string-name><surname>Ofer</surname><given-names>D</given-names></string-name>, <string-name><surname>Peleg</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>ProteinBERT: a universal deep-learning model of protein sequence and function</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>2102</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">35020807</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname><given-names>B</given-names></string-name>, <string-name><surname>Xie</surname><given-names>C</given-names></string-name>, <string-name><surname>Huson</surname><given-names>DH</given-names></string-name></person-group><etal>et al</etal><article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat Methods</source><year>2015</year>;<volume>12</volume>:<fpage>59</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">25402007</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source><year>2021</year>;<volume>596</volume>:<fpage>583</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M.</given-names></string-name></person-group><article-title>Toward understanding the origin and evolution of cellular organisms</article-title>. <source>Protein Sci</source><year>2019</year>;<volume>28</volume>:<fpage>1947</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">31441146</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Z</given-names></string-name>, <string-name><surname>Akin</surname><given-names>H</given-names></string-name>, <string-name><surname>Rao</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>. <source>Science</source><year>2023</year>;<volume>379</volume>:<fpage>1123</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">36927031</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Madani</surname><given-names>A</given-names></string-name>, <string-name><surname>Krause</surname><given-names>B</given-names></string-name>, <string-name><surname>Greene</surname><given-names>ER</given-names></string-name></person-group><etal>et al</etal><article-title>Large language models generate functional protein sequences across diverse families</article-title>. <source>Nat Biotechnol</source><year>2023</year>;<volume>41</volume>:<fpage>1099</fpage>–<lpage>106</lpage>.<pub-id pub-id-type="pmid">36702895</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Saul</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>UMAP: Uniform manifold approximation and projection</article-title>. <source>JOSS</source><year>2018</year>;<volume>3</volume>:<fpage>861</fpage>. <ext-link xlink:href="https://orcid.org/10.21105/joss.00861" ext-link-type="uri">https://orcid.org/10.21105/joss.00861</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae034-B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Mikolov</surname><given-names>T</given-names></string-name>, <string-name><surname>Sutskever</surname><given-names>I</given-names></string-name>, <string-name><surname>Chen</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal> Distributed representations of words and phrases and their compositionality. In: <italic toggle="yes">Advances in Neural Information Processing Systems</italic>, Lake Tahoe, Nevada, USA. USA: <publisher-name>Curran Associates, Inc</publisher-name>., <year>2013</year>.</mixed-citation>
    </ref>
    <ref id="btae034-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname><given-names>D</given-names></string-name>, <string-name><surname>Stern</surname><given-names>A</given-names></string-name>, <string-name><surname>Burstein</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Deciphering microbial gene function using natural language processing</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>5731</fpage>.<pub-id pub-id-type="pmid">36175448</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mitchell</surname><given-names>AL</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>A</given-names></string-name>, <string-name><surname>Beracochea</surname><given-names> M</given-names></string-name></person-group><etal>et al</etal><article-title>MGnify: the microbiome analysis resource in 2020</article-title>. <source>Nucleic Acids Res</source><year>2020</year>;<volume>48</volume>:<fpage>D570</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31696235</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Overbeek</surname><given-names>R</given-names></string-name>, <string-name><surname>Fonstein</surname><given-names>M</given-names></string-name>, <string-name><surname>D'Souza</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>The use of gene clusters to infer functional coupling</article-title>. <source>Proc Natl Acad Sci USA</source><year>1999</year>;<volume>96</volume>:<fpage>2896</fpage>–<lpage>901</lpage>.<pub-id pub-id-type="pmid">10077608</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sayers</surname><given-names>EW</given-names></string-name>, <string-name><surname>Cavanaugh</surname><given-names>M</given-names></string-name>, <string-name><surname>Clark</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>GenBank</article-title>. <source>Nucleic Acids Res</source><year>2021</year>;<volume>49</volume>:<fpage>D92</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">33196830</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shmakov</surname><given-names>SA</given-names></string-name>, <string-name><surname>Makarova</surname><given-names>KS</given-names></string-name>, <string-name><surname>Wolf</surname><given-names>YI</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic prediction of genes functionally linked to CRISPR-Cas systems by gene neighborhood analysis</article-title>. <source>Proc Natl Acad Sci USA</source><year>2018</year>;<volume>115</volume>:<fpage>E5307</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">29784811</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10868303</article-id>
    <article-id pub-id-type="pmid">38291951</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae034</article-id>
    <article-id pub-id-type="publisher-id">btae034</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GeNLP: a web tool for NLP-based exploration and prediction of microbial gene function</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3039-4376</contrib-id>
        <name>
          <surname>Miller</surname>
          <given-names>Danielle</given-names>
        </name>
        <aff><institution>The Shmunis School of Biomedicine and Cancer Research, George S. Wise Faculty of Life Sciences, Tel-Aviv University</institution>, Tel-Aviv 6997801, <country country="IL">Israel</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0009-0006-3133-4769</contrib-id>
        <name>
          <surname>Arias</surname>
          <given-names>Ofir</given-names>
        </name>
        <aff><institution>The Shmunis School of Biomedicine and Cancer Research, George S. Wise Faculty of Life Sciences, Tel-Aviv University</institution>, Tel-Aviv 6997801, <country country="IL">Israel</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6219-1880</contrib-id>
        <name>
          <surname>Burstein</surname>
          <given-names>David</given-names>
        </name>
        <aff><institution>The Shmunis School of Biomedicine and Cancer Research, George S. Wise Faculty of Life Sciences, Tel-Aviv University</institution>, Tel-Aviv 6997801, <country country="IL">Israel</country></aff>
        <xref rid="btae034-cor1" ref-type="corresp"/>
        <!--davidbur@tauex.tau.ac.il-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae034-cor1">Corresponding author. The Shmunis School of Biomedicine and Cancer Research, George S. Wise Faculty of Life Sciences, Tel-Aviv University, Tel-Aviv 6997801, Israel. E-mail: <email>davidbur@tauex.tau.ac.il</email> (D.B.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-01-30">
      <day>30</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>2</issue>
    <elocation-id>btae034</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>08</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>07</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae034.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>GeNLP is a web application that enables exploring microbial gene “semantics” and predictions of uncharacterized gene families based on their genomic context. It utilizes a pre-trained language model to uncover gene relationships and allows users to access and utilize the data as well as make their own predictions through an interactive interface.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The web application is accessible from all browsers at: <ext-link xlink:href="http://gnlp.bursteinlab.org/" ext-link-type="uri">http://gnlp.bursteinlab.org/</ext-link>. All source codes are freely available from GitHub under the MIT license here: <ext-link xlink:href="https://github.com/burstein-lab/genomic-nlp-server" ext-link-type="uri">https://github.com/burstein-lab/genomic-nlp-server</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Israel Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003977</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>355/23</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Language models have emerged as a valuable tool for various biological data analysis tasks, including the analysis of genomic and protein sequences (<xref rid="btae034-B1" ref-type="bibr">Bepler and Berger 2021</xref>, <xref rid="btae034-B6" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btae034-B7" ref-type="bibr">Madani <italic toggle="yes">et al.</italic> 2023</xref>). These models are able to infer complex contextual patterns and relationships by processing large amounts of data allowing recent research to demonstrate their effectiveness in performing tasks, such as gene prediction, functional annotation, and gene family classification. By treating gene families as “words” and genomes as “sentences,” we have recently used Natural Language Processing (NLP) techniques to generate numerical representations of genes, termed “embeddings,” based on their genomic context, namely—the coding and non-coding regions that surround the gene itself. The genomic context of a gene holds important information about its function, particularly in prokaryotes, where co-localization of genes within the genome is correlated with co-function (<xref rid="btae034-B12" ref-type="bibr">Overbeek <italic toggle="yes">et al.</italic> 1999</xref>, <xref rid="btae034-B14" ref-type="bibr">Shmakov <italic toggle="yes">et al.</italic> 2018</xref>). As a result, genes that share a similar function are expected to have a shared genomic context. This means that these genes are likely to be located in close proximity to each other within the genome or have similar arrangements of regulatory elements and genetic features. Consequently, when we represent these genes using embeddings, which capture the semantic representation of their characteristics, we expect to observe similarities in their embeddings, reflecting their “semantic” resemblance. Thus, the embedding representations can be used to explore functional relationships between genes and predict multiple features, such as protein structure, gene function, and more (<xref rid="btae034-B1" ref-type="bibr">Bepler and Berger 2021</xref>, <xref rid="btae034-B4" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btae034-B2" ref-type="bibr">Brandes <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btae034-B6" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>).</p>
    <p>Here, we present GeNLP, a web application aimed to allow users to explore the “semantic relationships” between thousands of microbial gene families without requiring any programming expertise. This web server is based on a model (<xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>) adapted from word2vec (<xref rid="btae034-B9" ref-type="bibr">Mikolov <italic toggle="yes">et al.</italic> 2013</xref>), which was trained on all assembled metagenomes and genomes (excluding green plants, fungi, and animals) publicly available on NCBI’s GenBank Whole Genome Shotgun (WGS) database (<xref rid="btae034-B13" ref-type="bibr">Sayers <italic toggle="yes">et al.</italic> 2021</xref>) and all assembled metagenomes from EMBL-EBI’s MGnify database (<xref rid="btae034-B11" ref-type="bibr">Mitchell <italic toggle="yes">et al.</italic> 2020</xref>). From WGS genomes a representative subset based on Uniprot’s non-redundant (NR) proteomes was used to mitigate redundancies. Consequently, a substantial portion of the dataset primarily consists of metagenomic sequences for which taxonomic mappings are not known. As a preprocess, genetic data were clustered into 563 589 gene families based on sequence similarity and mapped to the KEGG orthology (<xref rid="btae034-B5" ref-type="bibr">Kanehisa 2019</xref>). However, due to the nature of the data, many gene families have no annotation in any existing database. Gene families with a significant hit to the KEGG dataset were assigned an identifier based on the KEGG Ortholog (KO) group they belong to, whereas gene families with no mapping were given a serial identifier. In order to maintain consistency, the KEGG proteins used for mapping KOs were subjected to subclustering, employing identical parameters utilized for clustering gene families without KO hits. This procedure aimed to refine and consolidate gene families based on sequence similarity, fostering a more precise representation. Genes that had sufficient occurrences in the genomic and metagenomic datasets to produce a meaningful context signature were included. The model was then extended to predict one of 10 major functional categories (namely, amino sugar and nucleotide sugar metabolism, benzoate degradation, energy metabolism, oxidative phosphorylation, porphyrin and chlorophyll metabolism, prokaryotic defense, ribosome, secretion systems, two-component systems, and other), based on KEGG’s functional ontology, taking into consideration KEGG’s hierarchy (<xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>). The classification was performed using the pre-trained gene families embedding as input to a fully connected deep neural network. Prediction scores were derived from a combination of the softmax function-based classification score and the model’s accuracy in predicting the specific function, as measured by area under the precision–recall curve (AUPR). To ensure precision, a prediction was considered to have high confidence if it passed the threshold (<italic toggle="yes">t</italic> = 0.9) for the AUPR-weighted score and (<italic toggle="yes">t</italic>'=0.99) for the unweighted score.</p>
    <p>Aiming to make the data and results of our NLP-based approach more accessible to the scientific community, we have developed GeNLP, a user-friendly web application that provides easy access and utilizes our model via an intuitive interface. Researchers can submit sequence data queries, run the model, browse through the embedding space, and view the results, all through their web browser. This convenient platform eliminates the need to execute the entire pipeline for gene prediction and simplifies individual analysis. Users can swiftly retrieve predictions assigned to their sequences by the model and further investigate genes that may be associated with them.</p>
  </sec>
  <sec>
    <title>2 The GeNLP web application</title>
    <p>GeNLP is an interactive web application that enables the visualization and exploration of microbial gene families based on their genomic context. Utilizing our pre-trained language model (<xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>), the platform allows users to uncover gene relationships and make predictions for unknown gene functions. The web service, available at <ext-link xlink:href="http://gnlp.bursteinlab.org/" ext-link-type="uri">http://gnlp.bursteinlab.org/</ext-link>, provides access to the data and functionality of the GeNLP application. The source code, implemented in Python, Vue, and TypeScript, is readily available on GitHub (<ext-link xlink:href="https://github.com/burstein-lab/genomic-nlp-server" ext-link-type="uri">https://github.com/burstein-lab/genomic-nlp-server</ext-link>). We offer a comprehensive, step-by-step tutorial, guiding users through the application, complemented by a concise demonstration, and provide this content both as <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> accompanying the manuscript and available on the <ext-link xlink:href="https://github.com/burstein-lab/genomic-nlp-server/wiki" ext-link-type="uri">web server’s wiki</ext-link> in its GitHub repository. To facilitate usage and maintenance, the web application has been implemented using Docker and requires no external installations. The GeNLP application offers two primary modes of operation: (i) a static explanatory mode for inspecting the gene embedding space and (ii) a custom predictive mode for querying user-provided data (<xref rid="btae034-F1" ref-type="fig">Fig. 1</xref>). Through the application, users can delve into the complex network of genes, exploring both known and unknown genes, and gain a deeper understanding of their relationships and functions. For known genes, the application enables users to uncover genes with similar embedding and their functions, as well as locate multiple known genes that belong to the same KO group or share similar functions. Furthermore, the application can reveal genes with multiple “semantic meanings,” i.e. genes that have various genomic contexts and play a part in different pathways or complexes. For unknown genes, the GeNLP application offers the opportunity to explore their predicted functions by the pre-trained model (out of the abovementioned 10 functional categories) and provides their proximity in the embedding space to known genes that may share similar functions. In addition, each gene family contains information regarding its gene count and the taxonomic distribution of the genomes encoding for it. Users can also explore the spatial distribution of multiple selected genes in the gene embedding space. This allows for a more comprehensive analysis of the gene network and enables the discovery of new relationships and functions. Our application currently relies on gene contextual embedding computed using an adapted version of word2vec (<xref rid="btae034-B9" ref-type="bibr">Mikolov <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btae034-B10" ref-type="bibr">Miller <italic toggle="yes">et al.</italic> 2022</xref>). As more informative approaches for gene representation are developed or major updates to the KEGG orthology database are released, the embedding space in the web application will be recomputed and the interface updated accordingly.</p>
    <fig position="float" id="btae034-F1">
      <label>Figure 1.</label>
      <caption>
        <p>GeNLP overview. The left panel presents the sequence search mode workflow. The right panel demonstrates the explanatory mode features.</p>
      </caption>
      <graphic xlink:href="btae034f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3 Gene exploration—gene space viewer</title>
    <p>This mode offers a user-friendly and interactive approach to explore a vast genetic landscape comprising 563,589 gene families (representing a total of 360,039,110 genes), most of which are unannotated. The main layout presents a comprehensive map of gene families sourced from NCBI’s GenBank WGS and EMBL-EBI’s MGnify databases. The model’s context-based embedding, represented by a 300D vector, is projected into two dimensions for visualization using the UMAP algorithm. It is important to note that the 2D distances obtained through the UMAP dimension reduction (<xref rid="btae034-B8" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic> 2020</xref>) may exhibit distortions compared to the original 300D cosine distances in the embedding space. Gene families are color-coded based on functional groups derived from the KEGG ontology or are in grey if they are not assigned to any KO group. Upon sufficient zoom-in, users can access an interactive mode, enabling them to obtain quick information about each gene, including its name, function, and description, by clicking on a point in the space. For genes lacking KEGG annotation, the predicted functional category obtained by our model is noted, along with its confidence, and annotation based on the NCBI NR database, if available. Additionally, the interactive mode offers several features per point: the gene count in the family, a “Neighbors” bar plot, a “Function prediction” dot plot, and a “Tax map” donut plot. The “Neighbors” bar plot displays the 10 closest genes in the high-dimensional embedding space, based on cosine distance, clicking on one of the bars will lead the user to the corresponding gene family. The “Function prediction” plot highlights for unknown genes the prediction scores across 10 functional categories as mentioned above. The “Tax map” depicts the taxonomic distribution at the order level within a gene family, based on genes from assembled genomes. The donut plot showcases the top 10 orders, including an “Other” category if the gene family is represented in more than 10 distinct orders. Given that a significant portion of genes originated from metagenomic databases that lack well-defined taxonomic origin, the plot indicates the percentage of genes within the gene family with a known taxonomic mapping in NCBI’s GenBank WGS database. The results displayed in the “Neighbors” and “Function prediction” plots, as well as a representative gene sequence, can be downloaded for each family.</p>
    <p>For ease of use, this mode also enables the following six search modes, each allowing for direct typing or a dropdown menu with all options.</p>
    <list list-type="order">
      <list-item>
        <p>KEGG ortholog: searches by KO group identifier. Presents the gene family or families assigned to a KO.</p>
      </list-item>
      <list-item>
        <p>Functional category: highlights specific functional groups as defined by the KEGG ontology. For example, selecting of “Prokaryotic Defense System” will present all known genes related to this functional category.</p>
      </list-item>
      <list-item>
        <p>Gene description: searches genes according to their product description. This mode can be used only for annotated KOs with an existing description in KEGG.</p>
      </list-item>
      <list-item>
        <p>Gene name: searches genes by their short name as assigned by KEGG.</p>
      </list-item>
      <list-item>
        <p>Neighbors: given a gene family identifier, highlights the 10 closest gene families in the high-dimensional embedding space, obtained by the pre-trained model.</p>
      </list-item>
      <list-item>
        <p>Model word: searches by KO subcluster or hypothetical identifier (used for unannotated genes). This information is derived directly from the corpus used to train the model, it includes all 563,589 gene families and can be utilized to follow-up investigations that were previously conducted on GeNLP.</p>
      </list-item>
    </list>
    <sec>
      <title>3.1 Gene function prediction</title>
      <p>The “Sequence” search mode allows users to submit a sequence query in FASTA format either by uploading a file or directly pasting protein sequences into the search box. If a family with sufficient similarity is found (<italic toggle="yes">E</italic>-value &lt; 10<sup>−4</sup>), the web server will provide information for the best hits to the proteins provided, along with the <italic toggle="yes">E</italic>-values and percent identity. The sequences are mapped to our gene family database using the DIAMOND (<xref rid="btae034-B3" ref-type="bibr">Buchfink <italic toggle="yes">et al.</italic> 2015</xref>) tool and assigned an identifier based on the best hit satisfying the <italic toggle="yes">E</italic>-value threshold. If no such hit is identified, a message is displayed indicating that no significant hit was found for the given protein sequence. This might occur for rare microbial genes that are not well represented in genomic/metagenomic databases. When a significant hit is found, the identifier corresponding to the most similar gene in our database, which can be either a gene assigned a KEGG orthology or a cluster of unknown genes, is reported. It is important to note that this process is subject to the running time of DIAMOND, and may take several minutes, depending on the length and number of the submitted sequences. Once the predictions are generated, they, along with the corresponding gene family identifier and additional information, are available for downloading. These identifiers can later be used for self-exploration using the space viewer feature, as described in the previous section. This feature allows users to quickly and easily obtain predictions for specific genes and offers a convenient means of discovering genes with similar contextual signatures. The major advantage of this approach lies in its ability to provide insights into gene function that are not based on sequence homology but rather on the genomic context in which these genes are found across numerous organisms. Thus, users can infer function for genes lacking sequence similarity to any annotated gene. For genes with existing annotations, it facilitates rapid exploration of other genes with similar genomic context, and therefore, potentially similar functions. Furthermore, it enables the identification of previously unknown functions that a given gene may have according to the different genomic contexts in which it was found. Our approach broadens the scope of gene analysis, offering a more comprehensive understanding of gene functionalities beyond conventional sequence-based searches.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae034_Supplementary_Data</label>
      <media xlink:href="btae034_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We wish to thank Dr. Karin Mittelman and Ella Rannon for testing the web server and for their valuable comments on the manuscript.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Israel Science Foundation [grant number 355/23]. This study was also supported by fellowships to D.M. from the Edmond J. Safra Center for Bioinformatics at Tel-Aviv University and the Azrieli Foundation.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>No new data were generated or analyzed in support of this research.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae034-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bepler</surname><given-names>T</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B.</given-names></string-name></person-group><article-title>Learning the protein language: evolution, structure, and function</article-title>. <source>Cell Syst</source><year>2021</year>;<volume>12</volume>:<fpage>654</fpage>–<lpage>69.e3</lpage>.<pub-id pub-id-type="pmid">34139171</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brandes</surname><given-names>N</given-names></string-name>, <string-name><surname>Ofer</surname><given-names>D</given-names></string-name>, <string-name><surname>Peleg</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>ProteinBERT: a universal deep-learning model of protein sequence and function</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>2102</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">35020807</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname><given-names>B</given-names></string-name>, <string-name><surname>Xie</surname><given-names>C</given-names></string-name>, <string-name><surname>Huson</surname><given-names>DH</given-names></string-name></person-group><etal>et al</etal><article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat Methods</source><year>2015</year>;<volume>12</volume>:<fpage>59</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">25402007</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source><year>2021</year>;<volume>596</volume>:<fpage>583</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M.</given-names></string-name></person-group><article-title>Toward understanding the origin and evolution of cellular organisms</article-title>. <source>Protein Sci</source><year>2019</year>;<volume>28</volume>:<fpage>1947</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">31441146</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Z</given-names></string-name>, <string-name><surname>Akin</surname><given-names>H</given-names></string-name>, <string-name><surname>Rao</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>. <source>Science</source><year>2023</year>;<volume>379</volume>:<fpage>1123</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">36927031</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Madani</surname><given-names>A</given-names></string-name>, <string-name><surname>Krause</surname><given-names>B</given-names></string-name>, <string-name><surname>Greene</surname><given-names>ER</given-names></string-name></person-group><etal>et al</etal><article-title>Large language models generate functional protein sequences across diverse families</article-title>. <source>Nat Biotechnol</source><year>2023</year>;<volume>41</volume>:<fpage>1099</fpage>–<lpage>106</lpage>.<pub-id pub-id-type="pmid">36702895</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Saul</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>UMAP: Uniform manifold approximation and projection</article-title>. <source>JOSS</source><year>2018</year>;<volume>3</volume>:<fpage>861</fpage>. <ext-link xlink:href="https://orcid.org/10.21105/joss.00861" ext-link-type="uri">https://orcid.org/10.21105/joss.00861</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae034-B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Mikolov</surname><given-names>T</given-names></string-name>, <string-name><surname>Sutskever</surname><given-names>I</given-names></string-name>, <string-name><surname>Chen</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal> Distributed representations of words and phrases and their compositionality. In: <italic toggle="yes">Advances in Neural Information Processing Systems</italic>, Lake Tahoe, Nevada, USA. USA: <publisher-name>Curran Associates, Inc</publisher-name>., <year>2013</year>.</mixed-citation>
    </ref>
    <ref id="btae034-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname><given-names>D</given-names></string-name>, <string-name><surname>Stern</surname><given-names>A</given-names></string-name>, <string-name><surname>Burstein</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Deciphering microbial gene function using natural language processing</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>5731</fpage>.<pub-id pub-id-type="pmid">36175448</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mitchell</surname><given-names>AL</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>A</given-names></string-name>, <string-name><surname>Beracochea</surname><given-names> M</given-names></string-name></person-group><etal>et al</etal><article-title>MGnify: the microbiome analysis resource in 2020</article-title>. <source>Nucleic Acids Res</source><year>2020</year>;<volume>48</volume>:<fpage>D570</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31696235</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Overbeek</surname><given-names>R</given-names></string-name>, <string-name><surname>Fonstein</surname><given-names>M</given-names></string-name>, <string-name><surname>D'Souza</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>The use of gene clusters to infer functional coupling</article-title>. <source>Proc Natl Acad Sci USA</source><year>1999</year>;<volume>96</volume>:<fpage>2896</fpage>–<lpage>901</lpage>.<pub-id pub-id-type="pmid">10077608</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sayers</surname><given-names>EW</given-names></string-name>, <string-name><surname>Cavanaugh</surname><given-names>M</given-names></string-name>, <string-name><surname>Clark</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>GenBank</article-title>. <source>Nucleic Acids Res</source><year>2021</year>;<volume>49</volume>:<fpage>D92</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">33196830</pub-id></mixed-citation>
    </ref>
    <ref id="btae034-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shmakov</surname><given-names>SA</given-names></string-name>, <string-name><surname>Makarova</surname><given-names>KS</given-names></string-name>, <string-name><surname>Wolf</surname><given-names>YI</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic prediction of genes functionally linked to CRISPR-Cas systems by gene neighborhood analysis</article-title>. <source>Proc Natl Acad Sci USA</source><year>2018</year>;<volume>115</volume>:<fpage>E5307</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">29784811</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
