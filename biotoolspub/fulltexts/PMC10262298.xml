<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10262298</article-id>
    <article-id pub-id-type="pmid">33772587</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab205</article-id>
    <article-id pub-id-type="publisher-id">btab205</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ZEAL: protein structure alignment based on shape similarity</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7859-8047</contrib-id>
        <name>
          <surname>Ljung</surname>
          <given-names>Filip</given-names>
        </name>
        <xref rid="btab205-cor1" ref-type="corresp"/>
        <!--filip.persson@gmail.com-->
        <aff><institution>Division of Biochemistry and Structural Biology, Department of Chemistry, Lund University</institution>, Lund SE-22100, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>André</surname>
          <given-names>Ingemar</given-names>
        </name>
        <xref rid="btab205-cor1" ref-type="corresp"/>
        <!--ingemar.andre@biochemistry.lu.se-->
        <aff><institution>Division of Biochemistry and Structural Biology, Department of Chemistry, Lund University</institution>, Lund SE-22100, <country country="SE">Sweden</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab205-cor1">To whom correspondence should be addressed. <email>filip.persson@gmail.com</email> or <email>ingemar.andre@biochemistry.lu.se</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-03-27">
      <day>27</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>18</issue>
    <fpage>2874</fpage>
    <lpage>2881</lpage>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>20</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab205.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Most protein-structure superimposition tools consider only Cartesian coordinates. Yet, much of biology happens on the surface of proteins, which is why proteins with shared ancestry and similar function often have comparable surface shapes. Superposition of proteins based on surface shape can enable comparison of highly divergent proteins, identify convergent evolution and enable detailed comparison of surface features and binding sites.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present ZEAL, an interactive tool to superpose global and local protein structures based on their shape resemblance using 3D (Zernike-Canterakis) functions to represent the molecular surface. In a benchmark study of structures with the same fold, we show that ZEAL outperforms two other methods for shape-based superposition. In addition, alignments from ZEAL were of comparable quality to the coordinate-based superpositions provided by TM-align. For comparisons of proteins with limited sequence and backbone-fold similarity, where coordinate-based methods typically fail, ZEAL can often find alignments with substantial surface-shape correspondence. In combination with shape-based matching, ZEAL can be used as a general tool to study relationships between shape and protein function. We identify several categories of protein functions where global shape similarity is significantly more likely than expected by random chance, when comparing proteins with little similarity on the fold level. In particular, we find that global surface shape similarity is particular common among DNA binding proteins.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>ZEAL can be used online at <ext-link xlink:href="https://andrelab.org/zeal" ext-link-type="uri">https://andrelab.org/zeal</ext-link> or as a standalone program with command line or graphical user interface. Source files and installers are available at <ext-link xlink:href="https://github.com/Andre-lab/ZEAL" ext-link-type="uri">https://github.com/Andre-lab/ZEAL</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/100010663</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020 research and innovation programme</institution>
          </institution-wrap>
        </funding-source>
        <award-id>771820</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Protein structure evolves substantially slower than sequence, which means that functionally related proteins can adopt similar structures despite low sequence identity. Comparison of protein structure through superposition is therefore a powerful complement to sequence alignments in studying evolutionary relatedness between highly divergent protein sequences. However, in the presence of mutations, insertions, deletions and topological permutations it can be challenging to identify optimal superpositions. On the other hand, the geometrical shape of proteins is often conserved under such rearrangements. This can be rationalized by the fact that much of biology happens on the surface of proteins, such as catalysis and binding. Aligning proteins using surface shape can consequently provide an alternative approach to standard coordinate-based superposition. Additionally, shape-based alignment may also be used to find examples of evolutionary unrelated proteins where functional constraints results in similar global shapes or local similarity due to the presence of functional sites on the surface.</p>
    <p>The detection of shape equivalence is often carried out by comparison of shape descriptors. Shape descriptors are low-dimensional representations of geometric shape that are invariant to transformations such as rotation and translation. For proteins, Zernike-Canterakis shape descriptors (ZCDs) (<xref rid="btab205-B4" ref-type="bibr">Canterakis, 1999</xref>; <xref rid="btab205-B22" ref-type="bibr">Novotni and Klein, 2003</xref>) has been used to compare protein shapes (<xref rid="btab205-B9" ref-type="bibr">Grandison <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btab205-B31" ref-type="bibr">Sael <italic toggle="yes">et al.</italic>, 2008</xref>) and electron-density maps (<xref rid="btab205-B30" ref-type="bibr">Sael and Kihara, 2010</xref>) combined with protein docking (<xref rid="btab205-B7" ref-type="bibr">Esquivel-Rodríguez and Kihara, 2012</xref>), as well as shape comparisons of ligands (<xref rid="btab205-B10" ref-type="bibr">Gunasekaran <italic toggle="yes">et al.</italic>, 2009</xref>) and binding pockets (<xref rid="btab205-B5" ref-type="bibr">Chikhi <italic toggle="yes">et al.</italic>, 2010</xref>). Recently, a less compressed descriptor based on Zernike-Canterkis (ZC)functions was presented with impressive results in a shape retrieval benchmark of protein structures (<xref rid="btab205-B12" ref-type="bibr">Guzenko <italic toggle="yes">et al.</italic>, 2020</xref>). The Kihara lab has pioneered the use of ZCDs to identify proteins with similar surface shape and have shown how this approach can be used to identify protein pairs with low sequence and structural similarity but matching molecular surfaces (<xref rid="btab205-B13" ref-type="bibr">Han <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab205-B31" ref-type="bibr">Sael <italic toggle="yes">et al.</italic>, 2008</xref>). For instance, both the human and <italic toggle="yes">E.coli</italic> DNA topoisomerase I were found to have similar global shape despite low sequence and backbone conformation similarity.</p>
    <p>While shape descriptors like ZCDs can detect the shape equivalence between functionally related—but non-homologous—proteins, it does not provide the superposition between them. Due to the low sequence and structural similarity, coordinate-based superposition methods such as CE (<xref rid="btab205-B35" ref-type="bibr">Shindyalov and Bourne, 1998</xref>), DALI (<xref rid="btab205-B16" ref-type="bibr">Holm and Sander, 1993</xref>) and TM-align (<xref rid="btab205-B42" ref-type="bibr">Zhang and Skolnick, 2005</xref>) fails to provide a meaningful solution in such cases and may not identify the functional and evolutionary link between the proteins.</p>
    <p>Several methods have been developed for alignment of molecular surfaces in the context of binding pocket analysis (<xref rid="btab205-B2" ref-type="bibr">Angaran <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btab205-B17" ref-type="bibr">Konc and Janezic, 2012</xref>), virtual screening (<xref rid="btab205-B23" ref-type="bibr">Hawkins <italic toggle="yes">et al.</italic>, 2007</xref>; <xref rid="btab205-B15" ref-type="bibr">Hofbauer <italic toggle="yes">et al.</italic>, 2004</xref>; <xref rid="btab205-B32" ref-type="bibr">Sastry <italic toggle="yes">et al.</italic>, 2011</xref>), molecular docking (<xref rid="btab205-B19" ref-type="bibr">Macindoe <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btab205-B24" ref-type="bibr">Pierce <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab205-B34" ref-type="bibr">Schneidman-Duhovny <italic toggle="yes">et al.</italic>, 2005</xref>). But no general tool has been presented for local or global shape-based superposition of proteins <italic toggle="yes">per se</italic>. In this work, we present with zeal an interactive graphical software for shape-based alignment of proteins that we refer to as ZEAL (short for ZErnike-based protein shape ALignment). ZEAL uses ZC functions to parametrically describe the shape of the molecular surface as a series expansion, and provides an optimal superposition between two proteins by maximizing the correlation between the expansion coefficients (ZC moments). In conjunction with shape matching from ZCDs, ZEAL provides an approach for interactive protein shape comparison and analysis.</p>
    <p>In order to benchmark ZEAL we repurposed two methods for surface-based shape alignment developed for small molecule alignment and protein-protein docking, and applied them to superposition of homologous structures. Comparisons show that ZEAL outperforms these alternative methods. Furthermore, alignments from ZEAL were of comparable quality to the coordinate-based superpositions provided by TM-align. When protein pairs with low sequence and structural identity are analyzed, ZEAL still provides high quality superposition while coordinate-based methods fail.</p>
    <p>Shape-based matching and alignment can be used as a general tool to study relationships between shape and protein function. In this study, we develop a statistical approach to identify global shapes that are significantly linked with certain functions. With this methodology we show that many DNA-binding proteins share common global shapes while having completely different folds. ZEAL enables a detailed comparison of shape equivalence for these types of shape matches.</p>
    <p>Coordinate-based alignment methods are often blazingly fast, which makes them the method of choice in superposition of close structural homologs. Shape-based alignment on the other hand provide unique opportunities for comparison of remote homologs with divergent structure and topological permutations, and proteins resulting from convergent evolution and functional surfaces. We also demonstrate here that shape-based alignment can be used as a method for studying the relationship between global shape and protein function and to identify building blocks in the design of protein assemblies.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Representing the protein shape</title>
      <p>The concept of shape is not well defined at the molecular level, but can be described as a density in space (approximating the electron density) or, typically, as the shell of the surface (the molecular skin) constructed using van der Waals (vdW) radii of atoms and a spherical probe that traces out a surface of the regions accessible or excluded to solvent. The later, solvent-excluded surface is also known as the molecular or Conolly surface. Because proteins have evolved in the presence of water, the solvent-probe has a radius of 1.4 Å to approximate the size of a water molecule. In ZEAL, all of these shape representation types are available. The density representation is achieved using Gaussian atoms as described in <xref rid="btab205-B8" ref-type="bibr">Grant <italic toggle="yes">et al.</italic> (1996)</xref>, and the surfaces (vdW, solvent accessible/excluded) are obtained using an Euclidean distance transform (EDT) approach as implemented in EDTsurf (<xref rid="btab205-B40" ref-type="bibr">Xu and Zhang, 2010</xref>). However, in this work, we only present results using the molecular (solvent-excluded) surface. Because our algorithm for generating the molecular surfaces differs slightly from that of EDTsurf, we outline the main steps in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref>. For reasons that will become clear below, the EDT method integrates naturally with the algorithm for ZC moment computations as the molecular surface is mapped to a grid directly. The sampling resolution and thickness of the surface, both affecting the shape representation in ZC space, can easily be controlled by specifying the grid size <italic toggle="yes">L</italic> (resolution) and the interval of isovalues (Euclidean distances)that should define the surface and its thickness . In the work presented here, we use a 64<sup>3</sup> grid and a thickness of 2 grid units for the molecular surface.</p>
      <sec>
        <label>2.1.1</label>
        <title>Parameterization</title>
        <p>The protein shape can be described through a series expansion as
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mi>n</mml:mi><mml:mo>∞</mml:mo></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the shape function of the protein (the molecular surface for instance), scaled to fit inside the unit sphere (<inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) where the ZC functions (also called 3D Zernike functions) <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> lives (<xref rid="btab205-B4" ref-type="bibr">Canterakis, 1999</xref>). These are defined as
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mo>θ</mml:mo><mml:mo>,</mml:mo><mml:mo>ϕ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a radial function and <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mo>θ</mml:mo><mml:mo>,</mml:mo><mml:mo>ϕ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is an angular function, the spherical harmonics that live on the surface of the unit sphere. The integers <italic toggle="yes">n</italic>, <italic toggle="yes">l</italic>, <italic toggle="yes">m</italic> are labels for the members of the collection of ZC functions that form the basis set in <xref rid="E1" ref-type="disp-formula">Equation 1</xref>, and the functions themself are restricted so that <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be an even number. The expansion coefficients <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> in <xref rid="E1" ref-type="disp-formula">Equation 1</xref> are called moments because they are the projections of the protein shape <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> onto the basis set. The (complex) moments encode non-redundant information about the shape (ZC functions are orthogonal) and are obtained by integrating the ZC functions <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> over the shape <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> inside the unit sphere
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>≡</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:mn>4</mml:mn><mml:mo>π</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:math></disp-formula>where the bar is the complex conjugate of <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>In practice, the moments in <xref rid="E3" ref-type="disp-formula">Equation 3</xref> can be computed efficiently using geometrical moments and performing the integration over a <italic toggle="yes">L</italic><sup>3</sup> cubic grid in which the shape has been mapped onto (<xref rid="btab205-B22" ref-type="bibr">Novotni and Klein, 2003</xref>). We implement this algorithm to compute the ZC moments and employ the same 64<sup>3</sup> grid, with 2 grid-unit thick surfaces, that was shown by the authors to give the best shape-retrieval performance. However, our implementation of the EDTsurf algorithm (<xref rid="btab205-B39" ref-type="bibr">Xu and Zhang, 2009</xref>) provides a straightforward way to adjust these parameters, and the resulting shape representation <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can be plugged into the Novotni and Klein algorithm directly without any prior surface triangulation.</p>
        <p>Before computing the geometric moments, the voxelized shape is normalized so to fit in the unit sphere. Because ZC functions have poor resolution close to the boundary (<xref rid="btab205-B3" ref-type="bibr">Callahan and De Graef, 2012</xref>) we scale the object such that the maximum distance from the geometric center, <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, corresponds to 70% of the unit sphere radius, i.e. scaling by the factor <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0.7</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. We note that the default scaling factor used in the C++ library from <xref rid="btab205-B22" ref-type="bibr">Novotni and Klein (2003)</xref> use <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">R<sub>g</sub></italic> is the radius of gyration—the root-mean squared distance to the center of mass. This scaling does not guarantee full embedding of the object within the unit sphere, so the object function has to be defined as zero for values outside the boundary for correct normalization.</p>
        <p>Obviously, the sum in <xref rid="E1" ref-type="disp-formula">Equation 1</xref> has to be truncated at some order <italic toggle="yes">n </italic>=<italic toggle="yes"> N</italic>; <xref rid="btab205-F1" ref-type="fig">Figure 1</xref> shows the level of shape information captured in the ZC moments computed up to orders <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> 10, 15, 20, 25 and 30 for the molecular surface of nuclear protein EBNA1 (PDB ID code 1B3T). The number of moments that have to be computed for a given order <italic toggle="yes">N</italic> is <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>. At <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>20, most of the salient shape features are captured in the 1771 ZC moments. This is the default order in ZEAL, but can be changed by the user.</p>
        <fig position="float" id="btab205-F1">
          <label>Fig. 1.</label>
          <caption>
            <p>The shape information (reconstructions) of the molecular surface (bottom right) for the nuclear protein EBNA1 (PDB ID code 1B3T) encoded in ZC expansions up to order <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>10, 15, 20, 25 and 30 from a 64×64×64 grid. At <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>20, most of the salient features are captured and this is the default expansion order in ZEAL</p>
          </caption>
          <graphic xlink:href="btab205f1" position="float"/>
        </fig>
        <p>Note: Figure Replacement Requested.</p>
        <p>Note: Figure Replacement Requested.</p>
        <p>Note: Figure Replacement Requested.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Shape matching</title>
      <p>The ZC moments in <xref rid="E3" ref-type="disp-formula">Equation 3</xref> can be used to compare the shape similarity between two objects by finding the rotation that maximizes the correlation between the vector <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, containing the ZC moments <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">nml</mml:mi></mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> for the fixed protein A, and the vector <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">B</mml:mi><mml:mo>|</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:mo>γ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> containing the ZC moments <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">nml</mml:mi></mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> for the protein B rotated with Euler angles <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:mo>γ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This can be viewed as minimizing the angle <italic toggle="yes">θ</italic> between the vectors—they are correlated if they point in the same direction (small <italic toggle="yes">θ</italic>). Because the vectors are in the complex space <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">C</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> (<inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">C</mml:mi></mml:mrow><mml:mrow><mml:mn>1771</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>20), both the angle and its cosine are in general complex. A geometrically meaningful (real) angle, the Euclidean angle <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, is defined by
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>E</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Re</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">B</mml:mi><mml:mo>|</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:mo>γ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>〉</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">B</mml:mi><mml:mo>|</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:mo>γ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Re</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where we take the real (Re) part of the Hermitian (complex) inner product, and where <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> denote the complex conjugate of moments <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> respectively. Since the complex vector space is isomorphic to the real vector space (<xref rid="btab205-B33" ref-type="bibr">Scharnhorst, 2001</xref>), the Euclidean angle of vectors in <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">C</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is the angle in <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Note that the inner product might not vanish for <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>π</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (<xref rid="btab205-B20" ref-type="bibr">Marsh, 2017</xref>). It is possible to also define the Hermitian angle between complex vectors, in which case one takes the modulus (absolute value) of the Hermitian inner product. However, with that interpretation of the angle, parallel vectors in <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">C</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> can be orthogonal in <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. We will refer to <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mtext>cos</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, i.e the ZC moment correlation, as the ZEAL-score. Thus, shapes with ZEAL-score equal to 1 have moment vectors pointing in the same direction and consequently the same shape (in ZC space).</p>
      <p>For shape comparisons alone, there is a simpler way than finding the rotation that maximizes the ZEAL-score for two shapes. This is done by collecting the ZC moments to <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> dimensional vectors <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:msub><mml:mo>Ω</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mo>Ω</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mo>Ω</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mo>Ω</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mo>Ω</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:math></inline-formula> and compute the length of these vectors (which is rotationally invariant):
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munderover><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p>
      <p>By forming the ZC shape-descriptor vector (ZCD) <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>31</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> one can compare the resemblance of two shapes by calculating the Euclidean distance <italic toggle="yes">d<sub>E</sub></italic> between their ZCDs. For order 20, the shape information is then compactly contained in a ZCD with 121 (real) numbers, and the similarity between proteins A and B above given by</p>
      <p><inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>121</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The maximum <italic toggle="yes">d<sub>E</sub></italic> for judging if shapes are similar has be determined empirically. We find that <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0.025</mml:mn></mml:mrow></mml:math></inline-formula> (for unnormalized ZCDs) represents a descent cut-off for proteins with similar shape.</p>
    </sec>
    <sec>
      <title>2.3 Shape alignment</title>
      <p>As alluded to before, the ZEAL-score can be used to find the transformation that gives maximum shape overlap between two structures. If the shapes are similar, the transformation can (to a good approximation) be reduced to a rotational search by placing the centroid for each shape at the origin. If we parameterize the rotation using Euler angles <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:mo>γ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and adopt the <italic toggle="yes">zyz</italic> convention, the rotation with maximum ZEAL-score is bounded by <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>γ</mml:mo><mml:mo>≤</mml:mo><mml:mn>2</mml:mn><mml:mo>π</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mo>β</mml:mo><mml:mo>≤</mml:mo><mml:mo>π</mml:mo></mml:mrow></mml:math></inline-formula>. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref> shows the ZEAL-score (A) and heavy atom RMSD (B) as a function of the two Euler angles <italic toggle="yes">α</italic> and <italic toggle="yes">β</italic> for two copies of nuclear protein EBNA1 (PDB ID code 1B3T), one rotated so that the correct alignment lies on this 2D angle grid. As expected, the global maximum (ZEAL-score = 1) is the rotation that results in perfect shape superposition. But the shape-correlation landscape is highly non-convex with many local maxima, corresponding to fair alignments in terms of shape overlap. For orientations close to the maximum (ZEAL-score <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mo>≥</mml:mo></mml:math></inline-formula> 0.75), the score and RMSD are strongly correlated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S2C and S3</xref>).</p>
      <p>In general, finding the rotation with the maximum ZEAL-score in an exhaustive search is prohibitively expensive; each new rotation requires the ZC moments to be recomputed from a rotated molecular surface. While the maximum overlap among ZC moments can be searched for using a sophisticated fast Fourier transform (FFT) method (<xref rid="btab205-B18" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2013</xref>), this still requires the use of local search methods after selecting candidate solutions (referred to as ‘peak picking’) from the FFT search since the global maximum might not lie on the FFT grid. As a trade off between accuracy and speed, we use a machine learning method known as surrogate modeling where an internal model (i.e. a surrogate) of the objective function is constructed, which is then used to find better points to evaluate. We use the surrogate optimization algorithm implemented in <xref rid="btab205-B21" ref-type="bibr">MATLAB (2020)</xref>, with the ZEAL-score as the objective function bounded by the Euler angles. In short, the algorithm cycles between two phases: (i) Constructing the surrogate model by interpolating ZEAL-scores evaluated from random Euler angles using cubic radial basis functions (<xref rid="btab205-B11" ref-type="bibr">Gutmann, 2001</xref>); (ii) Searching for the maximum ZEAL-score by evaluating the surrogate model at thousands of sample points such that the search balances between refining an existing solution and searching in places that have not yet been evaluated in the hunt for a better global maximum (controlled by a merit function with cyclical weights (<xref rid="btab205-B25" ref-type="bibr">Regis and Shoemaker, 2007</xref>)). Unlike other optimization algorithms, there is no notion of convergence here. The algorithm continues alternating between the two phases until it reaches a stopping criteria, such as the number of ZEAL-score evaluations or a time limit. This algorithm is very robust as demonstrated when performing self-alignment trials of five structures where one copy is randomly rotated relative an un-rotated copy 20 times (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>): the average RMSD before and after ZEAL alignment is 22 and 0.03 Å respectively. As will be shown, high-quality superpositions can be expected for shape matches within 500 ZEAL-score evaluations—the default stopping criteria in ZEAL—and, on average, a ZEAL-score above 0.8.</p>
    </sec>
    <sec>
      <title>2.4 Single-chain and same-shape dataset</title>
      <p>Our set of single-chain structures for evaluating the performance of ZEAL, and finding proteins with similar function and shape, is based on a PISCES (<xref rid="btab205-B38" ref-type="bibr">Wang and Dunbrack, 2003</xref>) culled list containing 23 004 structures with a maximum 90% pairwise sequence identity, a minimum resolution of 2.0 Å and a maximum crystallographic R-factor of 0.25. From this list, 18 965 structures could be mapped to unique entries in the UniprotKB (<xref rid="btab205-B37" ref-type="bibr">UniProt Consortium, 2018</xref>) from which we retrieve the following annotations: Protein names; Length; DNA-binding; EC number and Keywords;. We will refer to this set as the <italic toggle="yes">S1</italic> set of single chain structures.</p>
      <p>We compute the ZCD for all structures using the (EDT-generated) molecular surface, with <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.4</mml:mn></mml:mrow></mml:math></inline-formula> Å, mapped to a 64<sup>3</sup> grid, a two-voxel thick molecular surface, ZC moments computed up to order 20 and a normalization distance of 70% of the embedding unit sphere. We also compute the radius of gyration <italic toggle="yes">R<sub>g</sub></italic> for all structures to allow shapes to be filtered based on their compactness.</p>
      <p>To find pairs of structures with similar shape (shape matches), we then compute the Euclidean distance <italic toggle="yes">d<sub>E</sub></italic> between all ZCDs of the <italic toggle="yes">S1p</italic> <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mn>18</mml:mn><mml:mo> </mml:mo><mml:mn>965</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>18</mml:mn><mml:mo> </mml:mo><mml:mn>965</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> unique (and non-identical) pairs of structures and select those with <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0.025</mml:mn></mml:mrow></mml:math></inline-formula>. This resulted in a total of 161 490 shape matches which we will call the same-shape (<italic toggle="yes">S2</italic>) dataset.</p>
    </sec>
    <sec>
      <title>2.5 Benchmark</title>
      <p>Irrespective of method, a shape-based alignment of two proteins with the same backbone orientation (same fold) has to be comparable to alignments generated by conventional main-chain oriented tools, since the structures are expected to have similar global shape. By the same token, proteins with different backbone folds, but similar global shape (shape twins) should have a superposition that clearly makes the shape resemblance apparent. In the first case, alignments of same-fold proteins are a testament to the robustness of the underlying algorithm. And in the second case, given a robust algorithm, superposition of structures with completely different folds are a testament of the possible advantage of shape over conventional tools in such cases.</p>
      <p>We therefore evaluate the performance of ZEAL for these cases, i.e. alignment of same-fold proteins and superposition of shape-twin proteins, using 1000 computations of the ZEAL-score as a stopping criterion for the surrogate optimization algorithm. As a gold standard for alignment of proteins with the same fold, we use TM-align (<xref rid="btab205-B42" ref-type="bibr">Zhang and Skolnick, 2005</xref>) and compare the C<sub><italic toggle="yes">α</italic></sub> RMSD for the alignments. We also include HEX (<xref rid="btab205-B27" ref-type="bibr">Ritchie and Kemp, 1999</xref>) and MS3align (<xref rid="btab205-B36" ref-type="bibr">Shivashankar <italic toggle="yes">et al.</italic>, 2016</xref>) which are two other available tools to perform alignments based on shape (described below). Because RMSD is not uniquely defined, it is computed using the same corresponding residues as those mapped by TM-align. Consequently, a lower RMSD for ZEAL may be available by finding a different mapping that minimize RMSD. By the same token, we use the ZEAL-score as the measure of shape overlap, and we compute the ZC moments using the same normalization scheme for all superposed structures generated by the different methods.</p>
      <sec>
        <label>2.5.1</label>
        <title>Datasets</title>
        <p>Alignments by ZEAL (and the ZCDs) are size invariant due to the normalization step in the moment computation. Contrary to <xref rid="btab205-B31" ref-type="bibr">Sael <italic toggle="yes">et al.</italic> (2008)</xref>, we note that shape matches with very different sizes is not a rare event. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref> shows the 2D cumulative distribution of the percent difference in residue length and radius of gyration in the <italic toggle="yes">S2</italic> set. Approximately 13% of shape matches have a length that differs by more than 100%, and approximately 7% have a radius of gyration that differs by more than 50%. To exclude the effect of any size difference in the benchmark, we prepare a subset of <italic toggle="yes">S2</italic> called the same-shape-and-size (<italic toggle="yes">S3</italic>) dataset as follows. The <italic toggle="yes">S2</italic> set is restricted to shape-matches that do not differ by more than 10% in chain-length and radius of gyration (<italic toggle="yes">R<sub>g</sub></italic>), resulting in 27 122 shape matches of similar size. From this, we also exclude the 390 shape matches with chain lengths less than 50 residues, and the 9 shape matches with a sequence identity greater than 90% as reported by TM-align. This resulted in 26 723 shape matches (16% of <italic toggle="yes">S2</italic>) of similar size and compactness—the <italic toggle="yes">S3</italic> set.</p>
        <p>To identify pairs of structures with similar backbone- fold we use the TM-score (<xref rid="btab205-B41" ref-type="bibr">Zhang and Skolnick, 2004</xref>, <xref rid="btab205-B42" ref-type="bibr">2005</xref>) as a proxy for structural similarity. Based on a large set of non-homologous proteins, it has been shown that protein pairs with TM-scores &gt; 0.9 have the same fold, while those who are not in the same fold have a TM-score &lt; 0.5 (<xref rid="btab205-B40" ref-type="bibr">Xu and Zhang, 2010</xref>). A TM-score &lt; 0.2 corresponds to random structurally similarity. We used the stand-alone version of TM-align (version 20190818) (<xref rid="btab205-B42" ref-type="bibr">Zhang and Skolnick, 2005</xref>) to obtain TM-scores, the sequence alignment and the C<inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow/><mml:mo>α</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> RMSD for all structures in the <italic toggle="yes">S3 dataset</italic>.</p>
        <p>The benchmark analysis pertains to two sets comprising 100 shape matches each, selected from the <italic toggle="yes">S3</italic> dataset based on the TM-scores reported by TM-align: (i) the high TM-score (same fold) dataset with TM-score &gt; 0.9 for all structures and (ii) the low TM-score (shape twins) dataset with TM-score &lt; 0.3 for all structures. This results in 1600 and 10 678 pairs for the high TM-score set and low TM-score dataset respectively. We then randomly select 100 pairs from each set, such that a structure in the created benchmark dataset is unique (i.e. occurs only once among shape matches). Data and PDB ID codes for all pairs are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S3 and S4</xref> for the high and low TM-score benchmark dataset respectively.</p>
      </sec>
      <sec>
        <label>2.5.2</label>
        <title>HEX</title>
        <p>Although a tool developed primarily for docking proteins or ligands, HEX allow structures to be aligned as well (referred to as ‘molecular matching’ in the Hex 8.0.0 user manual). However, to the best of our knowledge, the alignment performance has never been benchmarked. HEX can be considered a cousin to ZEAL; it represents the protein shape by an expansion using spherical polar Fourier (SPF) basis functions (<xref rid="btab205-B28" ref-type="bibr">Ritchie <italic toggle="yes">et al.</italic>, 2008</xref>), which have a radial term and an angular term, the spherical harmonics just like the ZC functions. As for ZEAL, the optimal superposition is a rotational search after translating the structures so that their center of mass coincide, but the optimal rotation is found on a sampling grid on which the correlation of the SPF-moments are computed efficiently with FFT-based methods. This makes alignment fast but with the drawback of reduced accuracy. We use the default settings for the search grid and a correlation order of 10 as recommended in the manual (all parameters are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). The search in HEX oversamples the search space, so many similar—but wrong—solutions may be found, which is why solutions have to be clustered and then ranked. The correct superposition may be among the top solutions, but here we always use the solution ranked as number one.</p>
      </sec>
      <sec>
        <label>2.5.3</label>
        <title>MS3align</title>
        <p>Whereas ZEAL and HEX are parameter-based methods, MS3align (<xref rid="btab205-B36" ref-type="bibr">Shivashankar <italic toggle="yes">et al.</italic>, 2016</xref>) uses the triangulated molecular surface itself to extract the so-called landmark points; protrusions and grooves are identified with local curvature analysis and the rigid-body transformation that minimizes the RMS distance between these points is searched for. The performance of MS3align is affected by the choice of four parameters: <italic toggle="yes">R<sub>c</sub></italic> and <italic toggle="yes">T<sub>s</sub></italic> control the quality of the landmark points, <italic toggle="yes">T<sub>mrd</sub></italic> and <italic toggle="yes">T<sub>ms</sub></italic> control how these landmark points are aligned. The parameters have to be chosen such that they pick up the expected size of features one is interest in. Thus, the exact choice of these parameters depends on the dataset being studied and might require manual tuning to identify relevant landmark points. Here, we set <italic toggle="yes">R<sub>c</sub></italic> = 3 Å, <italic toggle="yes">T<sub>mrd</sub></italic> = 5 Å and <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>. MS3align does not compute molecular surfaces and therefore requires triangulated surfaces as input. We generated triangulated molecular surfaces with EDTsurf (<xref rid="btab205-B39" ref-type="bibr">Xu and Zhang, 2009</xref>), using a 1.4 Å probe radius and a scale factor of 1, and converted the triangle mesh (in PLY format) to the OFF file-format expected by MS3align. Shape matching with MS3align is size-dependent, so to not bias the result against this method the <italic toggle="yes">S3</italic> set compares proteins of similar size.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Software and availability</title>
    <p>ZEAL has been developed in <xref rid="btab205-B21" ref-type="bibr">MATLAB (2020)</xref>, R2020a (version 9.8.0), and can be used online at <ext-link xlink:href="https://andrelab.org/zeal" ext-link-type="uri">https://andrelab.org/zeal</ext-link> or as a standalone program with command line or graphical user interface. Source files and installers are available at <ext-link xlink:href="https://github.com/Andre-lab/ZEAL" ext-link-type="uri">https://github.com/Andre-lab/ZEAL</ext-link></p>
  </sec>
  <sec>
    <title>4 Results and discussion</title>
    <p>While ZEAL can be run as a command line tool for large scale analysis, its primary use case is as an interactive graphical software for shape alignment and comparison. The graphical user interface facilitate easy setting of parameters related to voxelization and surface generation, selection of atoms to include in shape matching through a JSmol interface (<xref rid="btab205-B14" ref-type="bibr">Hanson <italic toggle="yes">et al.</italic>, 2013</xref>) and the choice of a range of molecular representations. Some of these features are highlighted in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S14</xref>.</p>
    <sec>
      <title>4.1 Shape-based alignment of same-fold proteins</title>
      <p>To investigate the potential of superposing proteins by optimizing complementarity of surface shape, we applied ZEAL to a benchmark set of protein pairs with the same fold and compare them to alignments provided by TM-align. ZEAL is also compared to two alternative approaches for shape alignment, HEX and MS3align. <xref rid="btab205-F2" ref-type="fig">Figure 2</xref> shows the RMSD (A) and ZEAL-score (B) distributions for the 100 same-fold protein pairs in the high TM-score set (TM-score &gt; 0.9) aligned using TM-align, ZEAL, HEX and MS3align. Two examples of the corresponding alignments are visualized in <xref rid="btab205-F2" ref-type="fig">Figure 2C</xref>, and six additional ones in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>. Summarizing statistics are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>. The inset in <xref rid="btab205-F2" ref-type="fig">Figure 2A</xref> shows the RMSD difference compared to TM-align (ΔRMSD<sub>TM</sub>) as a cumulative distribution, i.e. the fraction of alignments with RMSD difference less than ΔRMSD<sub>TM.</sub> For ZEAL, 90% of the alignments have ΔRMSD<sub>TM</sub> &lt; 1 Å, whereas this is only true for 62% and 35% using HEX and MS3align respectively. MS3align failed for 20 out of the 100 pairs. It is possible that MS3align could have faired better using a different choice of parameters. For ZEAL, only one alignment had ΔRMSD<sub>TM</sub> &gt; 2.8 Å, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>E shows that these structures have axial symmetry; the ZEAL-score is the same as that from TM-align (0.9), but the ΔRMSD<sub>TM</sub> is off by 26 Å which means that there may not be enough information about the shape in ZC space to distinguish the alignment found by TM-align. In such situations, a higher order for the ZC moments may be necessary to encapsulate more information about the shape in the ZC moments. Indeed, using moments up to order 30 gives much better agreement (Supplementary Figure S6); ΔRMSD<sub>TM</sub> = 1.1 Å, and a higher ZEAL-score than TM-align (0.82 versus 0.81). However, only a slight improvement over order 20 is obtained when employing this high expansion order on the entire benchmark set (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S9</xref>). We also note that the scaling factor in the object normalization step is not critical for the shape-alignment performance of ZEAL (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S8</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S10</xref>).</p>
      <fig position="float" id="btab205-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Benchmark results for the high TM-score (same fold) set (TMscore &gt; 0.9) where TM-align is considered the target to beat by ZEAL, HEX and MS3align. (<bold>A</bold>) The probability density functions (PDF) of the backbone <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>α</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> RMSD using the residue mapping from TM-align. The PDFs were estimated (kernel density) from the corresponding histograms shown individually for each method (top). The inset shows the associated cumulative distribution function (CDF) for the RMSD difference relative TM-align. (<bold>B</bold>) The corresponding ZEAL-score (shape correlation) PDF, estimated from the histograms (top). The inset shows the complementary CDF. (<bold>C</bold>) Alignments of (top) 3A8G-A (green) &amp; 4OB0-A and (bottom) 4AAJ-A (green) &amp; 5LHF-A</p>
        </caption>
        <graphic xlink:href="btab205f2" position="float"/>
      </fig>
      <p>In terms of computational speed, HEX is the winner among the shape aligners and finishes the search within a few seconds (single core, Intel<sup>®</sup> Xeon<sup>®</sup> CPU E5-2697 v4 @ 2.30 GHz). For the high TM-score set, ZEAL requires on average (standard deviation) 58 (±67) s to find the maximum ZEAL-score identified in an initial reconnaissance search (1000 ZEAL-score evaluations in the surrogate optimization algorithm). This corresponds to 259 (±234) ZEAL-score evaluations. MS3align is often slowest, requiring 180 (±377) s (the 20 failed cases not included).</p>
      <p>The results for ZEAL clearly demonstrate that shape-based superposition can perform on par with state-of-art structure-based alignment methods like TM-align without direct guidance of the Cartesian coordinates and sequence. Computational speed of ZEAL could be substantially increased by using an FFT-based approach, but this comes at the price of lower accuracy.</p>
    </sec>
    <sec>
      <title>4.2 Shape-based alignment of shape-twin proteins</title>
      <p>A key advantage of the shape-based superposition approach is for studies of pairs of evolutionary related proteins with highly divergent sequence and structure, but also in identifying shape similarity (local or global) between unrelated proteins. By their nature, highly divergent homologs and examples of convergent evolution are difficult to identify and validate. We can, however, benchmark the ability of ZEAL to align structurally dissimilar proteins with similar global shape (shape twins), some of which may arise due to remote homology or functional constraints. On a set of proteins with similar shape and size but low structural similarity (TM-score &lt; 0.3) ZEAL is the only method investigated here that consistently finds the rotation with maximum shape overlap among the 100 structure pairs in this benchmark. <xref rid="btab205-F3" ref-type="fig">Figure 3A</xref> shows the ZEAL-score distributions and the complementary cumulative distribution function (CCDF) in the inset, with summarizing statistics presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>. The CCDF gives the probability (one-sided <italic toggle="yes">P</italic>-value) to observe a ZEAL-score higher than a particular level. For ZEAL, the fraction of alignments with ZEAL-score higher than 0.75 is 91%, while this is only true for 10%, 17% and 7% of the cases using TM-align, HEX and MS3align respectively. <xref rid="btab205-F3" ref-type="fig">Figure 3B</xref> shows cartoon and surface representations for two examples from this dataset, with 6 additional examples shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7</xref>. Clearly, the superpositions from ZEAL achieves an orientation that makes the shape resemblance apparent in all cases. Note, however, that an excellent shape alignment between two proteins does not guarantee that the comparison is meaningful, and that homology exists. Nonetheless, structural comparison can provide insight even for non-homologous proteins. For example, in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S8</xref> we show how shape-alignment of TIM barrels can be used to compare the relative placement of structural elements on the outside of the central beta-barrel.</p>
      <fig position="float" id="btab205-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Benchmark results for the low TM-score (shape twins) set (TMscore &lt; 0.3) using TM-align, ZEAL, HEX and MS3align. (<bold>A</bold>) The ZEAL-score probability distribution functions (PDF) estimated (kernel density) from the corresponding histograms shown individually for each method (top). (<bold>B</bold>) Alignments of (top) 3BX4-A (green) &amp; 5N07-A and (bottom) 5MOK-A (green) &amp; 2HO1-A</p>
        </caption>
        <graphic xlink:href="btab205f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>4.3 Correlation between global surface shape and function</title>
      <p>In the so called twilight zone, the evolutionary signal between sequence and structure similarity fades. This zone is operationally defined as when the protein sequence similarity is less than 25 ± 5%, at which case the rule of thumb no longer holds that the proteins are very likely to have similar structure in terms of the main chain orientation (<xref rid="btab205-B6" ref-type="bibr">Chung and Subbiah, 1996</xref>; <xref rid="btab205-B29" ref-type="bibr">Rost, 1999</xref>). However, because structure is more conserved through evolution than sequence, tools like TM-align can still probe the evolutionary signal by finding similarities in the overall secondary structure, such as domains or folds. On the other hand, proteins on the borderline to the twilight zone may still share a common ancestor, but with different structures. Take for instance the example of Glutathione S-transferase from whiteleg shrimp (PDB ID code 5AN1) and the Adenosine Phosphorylase from the soil bacterium <italic toggle="yes">B. cereus</italic> (PDB ID code 3UAW). Both are transferases with similar global shape but different structures with TM-scores of 0.28 and 0.29. A protein-BLAST sequence alignment (<xref rid="btab205-B1" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic>, 1990</xref>) reveals a 22% identity (query coverage 43%) with low probability of that similarity occurring by chance (E-value 0.001). A structural alignment from TM-align (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S11</xref>) is not conclusive to corroborate any evolutionary links since no part of the structures are aligned, including the groove of the active sites containing the ligands. Superposing the global shapes using ZEAL results in an alignment where the active sites are much closer in space (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S11</xref>), facilitating a structural comparison of the proteins. It is difficult to prove that the similarity of overall shape and co-alignment of the active sites is a result of divergent evolution from an ancestor. Nonetheless, examples like these highlight an interesting evolutionary scenario in which the evolutionary signal may be largely lost in sequence and backbone structure, but ancestry is manifested in similarity between surface shape due to conservation of binding surfaces. Alternatively, this could also reflect convergent evolution.</p>
      <p>In the exploratory work by the Kihara lab (<xref rid="btab205-B31" ref-type="bibr">Sael <italic toggle="yes">et al.</italic>, 2008</xref>), a few examples of functionally related proteins were presented that all have similar global surface (as measured by ZCDs) but with low sequence and backbone conformational similarity. This type of analysis can be aided by ZEAL, since superpositions can reveal matches in surface shape relevant for biological function. Also, since the superposition reflects the shape information captured by the ZC moments used for the shape matching <italic toggle="yes">per se</italic> (via ZCDs), the shape analysis is an apples to apples comparison. Previous studies have therefore provided anecdotal evidence that global surface shape can be critical for function, but such conclusions must be validated by a more comprehensive statistical analysis. Here, we provide a general approach to quantify the degree of coupling between shape and function similarity that goes beyond the main chain orientation of proteins.</p>
      <p>We start from the <italic toggle="yes">S1p</italic> set of <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:mn>18</mml:mn><mml:mo> </mml:mo><mml:mn>965</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>18</mml:mn><mml:mo> </mml:mo><mml:mn>965</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> unique (and non-identical) pairs of structures and define the following two sets: <bold>A</bold> <italic toggle="yes">protein pairs with similar shape and dissimilar structures</italic> (defined as <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0.025</mml:mn></mml:mrow></mml:math></inline-formula> and TM-score &lt; 0.3) and <bold>B</bold> <italic toggle="yes">protein pairs with similar function</italic> (defined as sharing a given keyword in the UniprotKB annotation).</p>
      <p>We compute the associated probabilities <italic toggle="yes">P</italic>(<italic toggle="yes">A</italic>), <italic toggle="yes">P</italic>(<italic toggle="yes">B</italic>) and <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>∩</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (details given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S4</xref>) of a protein pair belonging to set <italic toggle="yes">A</italic>, <italic toggle="yes">B</italic> or the intersection of the two (<inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:mo>∩</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula>). If shape is independent of function (beyond the secondary structure), then the ratio <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mo>κ</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>∩</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> will be equal to one. If <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mo>κ</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, this suggests that global shape intrinsically encodes information about function beyond protein architecture and fold.</p>
      <p><xref rid="btab205-T1" ref-type="table">Table 1</xref> presents <italic toggle="yes">κ</italic> for the keywords ‘kinase’, ‘calcium’, ‘DNA-binding’ and ‘zinc-finger’, together with 95% bootstrap percentile confidence intervals and one-sided <italic toggle="yes">P</italic>-values for the null hypothesis <italic toggle="yes">κ</italic> equals 1. The permutation and bootstrap distributions are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S12 and S13</xref>, respectively.A detailed description of the significance testing is given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S4</xref>, and statistics for 28 selected keywords with <italic toggle="yes">κ</italic> significantly larger than 1 are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S9</xref>. For kinases and calcium proteins, <italic toggle="yes">κ</italic> is not significantly different from 1 and no correlation between global shape and function can be established. For DNA-binding and zinc-finger, however, <italic toggle="yes">κ</italic> is 1.83 and 2.48 respectively with <italic toggle="yes">P</italic>-values <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mo>≪</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>. <xref rid="btab205-F4" ref-type="fig">Figure 4</xref> shows ZEAL-processed structures for three DNA-binders (A–C) and two that are also Zinc-fingers (D, E). All pairs have at least one structure forming a complex with DNA, and the superposed structures reveals possible DNA-binding interfaces for the pair members lacking DNA-complexes. Taken together, this suggest that for some classes of proteins, such as those that bind DNA or have zinc-finger domains, functional and global shape similarity might be the result of convergent (or divergent) evolution where geometrical constraints, such as the cylindrical shape of DNA, sets an evolutionary boundary beyond the exact packing of amino acids into folds.</p>
      <fig position="float" id="btab205-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>A selection of shape matches and their ZEAL-alignments in the 2S set that are all annotated with the keyword ‘DNA-binding’ (<bold>A–C</bold>) and ‘zinc-finger’ (<bold>D, E</bold>) in UniprotKB, and with TM-scores under 0.3. DNA structures in the PDB entries are shown in green. (A) Ecl18kI restriction endonuclease [2GB7 chain A] (orange) and BsoBI restriction endonuclease [1DC1 chain A] (blue). (B) Psp operon transcriptional activator [4QOS chain A] (orange) and TATA-binding protein [1VTO chain A] (blue). (C) Endonuclease V isoform X2 [6OZI chain A] (orange) and CRISPR-associated protein three HD domain [3SK9 chain A] (blue). (D) RLD2 BRX domain [6L0V chain E] (orange) and CpG-binding protein [3QMD chain A] (blue). (E) Roquin-2 [4ZLD chain A] (orange) and Avian sarcoma virus integrase [1CXQ chain A] (blue)</p>
        </caption>
        <graphic xlink:href="btab205f4" position="float"/>
      </fig>
      <table-wrap position="float" id="btab205-T1">
        <label>Table 1.</label>
        <caption>
          <p>The shape-function independence ratio <italic toggle="yes">κ</italic> for selected keywords, with confidence intervals (CI) estimated from bootstrap resamples and <italic toggle="yes">P</italic>-values estimated from permutation tests</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Keyword</th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">κ</italic>
              </th>
              <th rowspan="1" colspan="1">95 % CI</th>
              <th rowspan="1" colspan="1"><italic toggle="yes">P</italic>-value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Kinase</td>
              <td rowspan="1" colspan="1">0.97</td>
              <td rowspan="1" colspan="1">0.74 1.04</td>
              <td rowspan="1" colspan="1">0.79</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Calcium</td>
              <td rowspan="1" colspan="1">0.89</td>
              <td rowspan="1" colspan="1">0.86 1.08</td>
              <td rowspan="1" colspan="1">0.60</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">DNA-binding</td>
              <td rowspan="1" colspan="1">1.83</td>
              <td rowspan="1" colspan="1">1.67 1.99</td>
              <td rowspan="1" colspan="1">7.1 × <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Zinc-finger</td>
              <td rowspan="1" colspan="1">2.48</td>
              <td rowspan="1" colspan="1">2.05 2.88</td>
              <td rowspan="1" colspan="1">5.5 × <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>While the global shape seems to be important for some functional classes of proteins, the role of shape on local parts of the protein surface is much more apparent. For instance, the DNA-binding protein with PDB ID code 4KIS (chain A) contains a zinc-finger domain (residues 270–310) that binds to DNA. A shape match to this region is the DNA-binding domain of SKN-1 (PDB ID code 1SKN, chain P). The structures are very different as reflected in their low TM-scores (0.17). While ZEAL does not support automatic local shape matching yet, it is possible in the standalone version to interactively (or by commands) select a region of interest (ROI) in JSmol (<xref rid="btab205-B14" ref-type="bibr">Hanson <italic toggle="yes">et al.</italic>, 2013</xref>) (embedded) and have ZEAL superpose the structures using the ROI. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S14</xref> shows snapshots of the GUI and the ROI-selection of the Zinc-finger of 4KIS, the ZEAL-score optimization search window, with the final superposition in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S15</xref>.</p>
    </sec>
    <sec>
      <title>4.4 Protein design</title>
      <p>ZEAL could also be used as an aid in the <italic toggle="yes">de novo</italic> design of protein assemblies. Consider the dimeric proteins shown in <xref rid="btab205-F5" ref-type="fig">Figure 5</xref>; one heteromer (A) and one homomer complexed with DNA (B). After finding shape matches (shown in blue) in the <italic toggle="yes">S1</italic> set to the A chains (shown in orange) in these structures, the ZEAL superpositions clearly show that the orientation of the shape matches have a surface complementarity close to the native assembly. A <italic toggle="yes">de novo</italic> protein assembly could be designed by taking the ZEAL-oriented shape-match and use computational design methods to improve the interface of the novel assembly.</p>
      <fig position="float" id="btab205-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Dimeric proteins with their shape matches (blue) superposed using ZEAL. (<bold>A</bold>) Heteromer 6LE5 (chain A in orange and chain B in grey) with shape match 1MW7 chain A. (<bold>B</bold>) Homomer 5ONDA (chain A in orange and chain B in grey) in complex with DNA (green) with shape match 4I4K chain A</p>
        </caption>
        <graphic xlink:href="btab205f5" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>We have presented ZEAL, a tool to perform protein structure superposition based on shape, such as the molecular surface. For structural homologs, it delivers accuracy on par with TM-align, and for shape homologs, it consistently finds the optimal shape overlap given enough ZEAL-score evaluations (typically less than 300). We have also given an example how ZEAL can be used as a tool for investigating protein function. By combining shape-based matching and superposition we establish a quantitative support for links between shape and function beyond evolutionary related systems. The applications of shape alignment goes beyond the examples studied in this work. We have outlined how ZEAL could be used in computational protein design but also anticipate that the methodology could be employed in the rapidly emerging field of cryo-electron microscopy to place proteins in electron density. Shape-based alignment have a number of limitations. Speed considerations makes coordinate-based alignment the method of choice when comparing structurally similar proteins. Comparison of multidomain proteins with different domain orientations typically requires superposition of one domain at a time. And fundamentally, alignment of closely related proteins with dissimilar shape would fail with this approach.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab205_supplementary_data</label>
      <media xlink:href="btab205_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank all members of the Andre-Lab for help with testing the ZEAL software. They also thank Robert M. Hanson for help with JSmol functionality. Computing resources at High Performance Computing Center North (HPC2N) were allocated by the Swedish National Infrastructure for Computing (SNIC).</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme [771820].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab205-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>S.F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1990</year>) 
<article-title>Basic local alignment search tool</article-title>. <source>J. Mol. Biol</source>., <volume>215</volume>, <fpage>403</fpage>–<lpage>410</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Angaran</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) 
<article-title>MolLoc: a web tool for the local structural alignment of molecular surfaces</article-title>. <source>Nucleic Acids Res</source>., <volume>37</volume>, <fpage>W565</fpage>–<lpage>W570</lpage>.<pub-id pub-id-type="pmid">19465382</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Callahan</surname><given-names>P.G.</given-names></string-name>, <string-name><surname>De Graef</surname><given-names>M.</given-names></string-name></person-group> (<year>2012</year>) 
<article-title>Precipitate shape fitting and reconstruction by means of 3D Zernike functions</article-title>. <source>Modell. Simul. Mater. Sci. Eng</source>., <volume>20</volume>, <fpage>015003</fpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Canterakis</surname><given-names>N.</given-names></string-name></person-group> (<year>1999</year>) 
<article-title>3D Zernike moments and Zernike affine invariants for 3D image analysis and recognition</article-title>. In: <italic toggle="yes">Proceedings of the 11th Scandinavian Conference on Image Analysis</italic>, Kangerlusssuaq, Greenland, pp. <fpage>85</fpage>–<lpage>93</lpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chikhi</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>Real-time ligand binding pocket database search using local surface descriptors</article-title>. <source>Proteins Struct. Funct. Bioinf</source>., <volume>78</volume>, <fpage>2007</fpage>–<lpage>2028</lpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chung</surname><given-names>S.Y.</given-names></string-name>, <string-name><surname>Subbiah</surname><given-names>S.</given-names></string-name></person-group> (<year>1996</year>) 
<article-title>A structural explanation for the twilight zone of protein sequence homology</article-title>. <source>Structure</source>, <volume>4</volume>, <fpage>1123</fpage>–<lpage>1127</lpage>.<pub-id pub-id-type="pmid">8939745</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Esquivel-Rodríguez</surname><given-names>J.</given-names></string-name>, <string-name><surname>Kihara</surname><given-names>D.</given-names></string-name></person-group> (<year>2012</year>) 
<article-title>Fitting multimeric protein complexes into electron microscopy maps using 3D zernike descriptors</article-title>. <source>J. Phys. Chem. B</source>, <volume>116</volume>, <fpage>6854</fpage>–<lpage>6861</lpage>.<pub-id pub-id-type="pmid">22417139</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grant</surname><given-names>J.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1996</year>) 
<article-title>A fast method of molecular shape comparison: a simple application of a Gaussian description of molecular shape</article-title>. <source>J. Comput. Chem</source>., <volume>17</volume>, <fpage>1653</fpage>–<lpage>1666</lpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grandison</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) 
<article-title>The application of 3D zernike moments for the description of “Model-Free” molecular structure, functional motion, and structural reliability</article-title>. <source>J. Comput. Biol</source>., <volume>16</volume>, <fpage>487</fpage>–<lpage>500</lpage>.<pub-id pub-id-type="pmid">19254186</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Gunasekaran</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <part-title>Ligand electron density shape recognition using 3D Zernike descriptors</part-title>. In: <source>Lecture Notes in Computer Science (Including Subseries Lecture Notes in Artificial Intelligence and Lecture Notes in Bioinformatics), volume 5780 LNBI</source>. 
<publisher-name>Springer</publisher-name>, 
<publisher-loc>Berlin, Heidelberg</publisher-loc>, pp. <fpage>125</fpage>–<lpage>136</lpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gutmann</surname><given-names>H.-M.</given-names></string-name></person-group> (<year>2001</year>) 
<article-title>A radial basis function method for global optimization</article-title>. <source>J. Global Optim</source>., <volume>19</volume>, <fpage>201</fpage>–<lpage>227</lpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guzenko</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) 
<article-title>Real time structural search of the Protein Data Bank</article-title>. <source>PLoS Comput. Biol</source>., <volume>16</volume>, <fpage>e1007970</fpage>.<pub-id pub-id-type="pmid">32639954</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>A global map of the protein shape universe</article-title>. <source>PLOS Comput. Biol</source>., <volume>15</volume>, <fpage>e1006969</fpage>.<pub-id pub-id-type="pmid">30978181</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hanson</surname><given-names>R.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) JSmol and the next-generation web-based representation of 3D molecular structure as applied to proteopedia. Isr. J. Chem., <volume>53</volume>, <fpage>207</fpage>–<lpage>216</lpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hawkins</surname><given-names> P.C.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) <italic toggle="yes">Comparison of Shape-Matching and Docking as Virtual Screening Tools</italic>. <italic toggle="yes">J. Med. Chem.</italic>, <volume>50</volume>, <fpage>74</fpage>–<lpage>82</lpage></mixed-citation>
    </ref>
    <ref id="btab205-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hofbauer</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2004</year>) 
<article-title>SURFCOMP: a novel graph-based approach to molecular surface comparison</article-title>. <source>J. Chem. Inf. Comput. Sci</source>., <volume>44</volume>, <fpage>837</fpage>–<lpage>847</lpage>.<pub-id pub-id-type="pmid">15154748</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Holm</surname><given-names>L.</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C.</given-names></string-name></person-group> (<year>1993</year>) Protein structure comparison by alignment of distance matrices. J Mol Biol., <volume>233</volume>, <fpage>123</fpage>–<lpage>138</lpage></mixed-citation>
    </ref>
    <ref id="btab205-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Konc</surname><given-names>J.</given-names></string-name>, <string-name><surname>Janezic</surname><given-names>D.</given-names></string-name></person-group> (<year>2012</year>) 
<article-title>ProBiS-2012: web server and web services for detection of structurally similar binding sites in proteins</article-title>. <source>Nucleic Acids Res</source>., <volume>40</volume>, <fpage>W214</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">22600737</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Three-dimensional single-particle imaging using angular correlations from X-ray laser data</article-title>. <source>Acta Crystallogr. Sect. A Found. Crystallogr</source>., <volume>69</volume>, <fpage>365</fpage>–<lpage>373</lpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Macindoe</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>HexServer: an FFT-based protein docking server powered by graphics processors</article-title>. <source>Nucleic Acids Res</source>., <volume>38</volume>, <fpage>W445</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">20444869</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B20">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Marsh</surname><given-names>A.</given-names></string-name></person-group> (<year>2017</year>) <italic toggle="yes">Mathematics for Physics: An Illustrated Handbook. World Scientific Publishing Co. Pte. Ltd., Singapore</italic>.</mixed-citation>
    </ref>
    <ref id="btab205-B21">
      <mixed-citation publication-type="book">MATLAB (<year>2020</year>) <source>Version 9.8 (R2020a)</source>. 
<publisher-name>The MathWorks Inc</publisher-name>., 
<publisher-loc>Natick, Massachusetts</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab205-B22">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Novotni</surname><given-names>M.</given-names></string-name>, <string-name><surname>Klein</surname><given-names>R.</given-names></string-name></person-group> (<year>2003</year>) 3D zernike descriptors for content based shape retrieval. In: <italic toggle="yes">Proceedings of the eighth ACM Symposium on Solid Modeling and Applications</italic>, Seattle, WA, USA, pp. <fpage>216</fpage>–<lpage>225</lpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pierce</surname><given-names>B.G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>ZDOCK server: interactive docking prediction of protein–protein complexes and symmetric multimers</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1771</fpage>–<lpage>1773</lpage>.<pub-id pub-id-type="pmid">24532726</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Regis</surname><given-names>R.G.</given-names></string-name>, <string-name><surname>Shoemaker</surname><given-names>C.A.</given-names></string-name></person-group> (<year>2007</year>) 
<article-title>A stochastic radial basis function method for the global optimization of expensive functions</article-title>. <source>INFORMS J. Comput</source>., <volume>19</volume>, <fpage>497</fpage>–<lpage>509</lpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ritchie</surname><given-names>D.W.</given-names></string-name>, <string-name><surname>Kemp</surname><given-names>G.J.</given-names></string-name></person-group> (<year>1999</year>) Fast computation, rotation, and comparison of low resolution spherical harmonic molecular surfaces. J. Comput. Chem., <volume>20</volume>, <fpage>383</fpage>–<lpage>395</lpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ritchie</surname><given-names>D.W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) 
<article-title>Accelerating and focusing protein-protein docking correlations using multi-dimensional rotational FFT generating functions</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>1865</fpage>–<lpage>1873</lpage>.<pub-id pub-id-type="pmid">18591193</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B29">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Rost</surname><given-names>B.</given-names></string-name></person-group> (<year>1999</year>) Twilight zone of protein sequence alignments. <italic toggle="yes">Protein Eng.,</italic> 12, 85-94</mixed-citation>
    </ref>
    <ref id="btab205-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sael</surname><given-names>L.</given-names></string-name>, <string-name><surname>Kihara</surname><given-names>D.</given-names></string-name></person-group> (<year>2010</year>) 
<article-title>Improved protein surface comparison and application to low-resolution protein structure data</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>S2</fpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sael</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) 
<article-title>Fast protein tertiary structure retrieval based on global surface shape similarity</article-title>. <source>Proteins Struct. Funct. Bioinf</source>., <volume>72</volume>, <fpage>1259</fpage>–<lpage>1273</lpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sastry</surname><given-names>G.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>Rapid shape-based ligand alignment and virtual screening method based on atom/feature-pair similarities and volume overlap scoring</article-title>. <source>J. Chem. Inf. Model</source>., <volume>51</volume>, <fpage>2455</fpage>–<lpage>2466</lpage>.<pub-id pub-id-type="pmid">21870862</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scharnhorst</surname><given-names>K.</given-names></string-name></person-group> (<year>2001</year>) 
<article-title>Angles in complex vector spaces</article-title>. <source>Acta Appl. Math</source>., <volume>69</volume>, <fpage>95</fpage>–<lpage>103</lpage>.</mixed-citation>
    </ref>
    <ref id="btab205-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schneidman-Duhovny</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2005</year>) 
<article-title>PatchDock and SymmDock: servers for rigid and symmetric docking</article-title>. <source>Nucleic Acids Res</source>., <volume>33</volume>, <fpage>W363</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">15980490</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B35">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Shindyalov</surname><given-names>I.N.</given-names></string-name>, <string-name><surname>Bourne</surname><given-names>P.E.</given-names></string-name></person-group> (<year>1998</year>) Protein structure alignment by incremental combinatorial extension (CE) of the optimal path. <italic toggle="yes">Protein Eng., 11, 739-47.</italic></mixed-citation>
    </ref>
    <ref id="btab205-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shivashankar</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>MS3ALIGN: an efficient molecular surface aligner using the topology of surface curvature</article-title>. <source>BMC Bioinformatics</source>, <volume>17</volume>, <fpage>26</fpage>.<pub-id pub-id-type="pmid">26753741</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B37">
      <mixed-citation publication-type="journal">UniProt Consortium. (<year>2018</year>) 
<article-title>UniProt: the universal protein knowledgebase</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>2699</fpage>–<lpage>2699</lpage>.<pub-id pub-id-type="pmid">29425356</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>G.</given-names></string-name>, <string-name><surname>Dunbrack</surname><given-names>R.L.</given-names></string-name></person-group> (<year>2003</year>) 
<article-title>PISCES: a protein sequence culling server</article-title>. <source>Bioinformatics</source>, <volume>19</volume>, <fpage>1589</fpage>–<lpage>1591</lpage>.<pub-id pub-id-type="pmid">12912846</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>D.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group> (<year>2009</year>) 
<article-title>Generating triangulated macromolecular surfaces by euclidean distance transform</article-title>. <source>PLoS One</source>, <volume>4</volume>, <fpage>e8140</fpage>.<pub-id pub-id-type="pmid">19956577</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>J.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group> (<year>2010</year>) 
<article-title>How significant is a protein structure similarity with TM-score = 0.5?</article-title>  <source>Bioinformatics</source>, <volume>26</volume>, <fpage>889</fpage>–<lpage>895</lpage>.<pub-id pub-id-type="pmid">20164152</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Skolnick</surname><given-names>J.</given-names></string-name></person-group> (<year>2004</year>) 
<article-title>Scoring function for automated assessment of protein structure template quality</article-title>. <source>Proteins Struct. Funct. Genet</source>., <volume>57</volume>, <fpage>702</fpage>–<lpage>710</lpage>.<pub-id pub-id-type="pmid">15476259</pub-id></mixed-citation>
    </ref>
    <ref id="btab205-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Skolnick</surname><given-names>J.</given-names></string-name></person-group> (<year>2005</year>) 
<article-title>TM-align: a protein structure alignment algorithm based on the TM-score</article-title>. <source>Nucleic Acids Res</source>., <volume>33</volume>, <fpage>2302</fpage>–<lpage>2309</lpage>.<pub-id pub-id-type="pmid">15849316</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
